o FUP.
Ocultar:
El parámetro se oculta siempre en llamadas de bloques
en KOP o FUP.
En este caso, el cuadro de llamada dispone de una flecha
pequeña en el margen inferior. Haciendo clic en la flecha
se muestra y conecta el parámetro.
Ocultar cuando no se haya asignado ningún parámetro
El parámetro se oculta en llamadas de bloques en KOP o
FUP, a menos que esté conectado. Cuando se asigna un
parámetro actual se muestra el parámetro en el cuadro de
llamada.

7830

Parámetro actual
predefinido

Define un parámetro que debe utilizarse como parámetro
actual durante la llamada del bloque.

Mostrar cuando el
parámetro actual
asignado y el pará‐
metro actual predefi‐
nido no sean idénti‐
cos

El parámetro se oculta en llamadas de bloques en KOP o
FUP, siempre que el parámetro actual predefinido esté
asignado. Sin embargo, al asignar otro parámetro actual
se muestra el parámetro.
Esta opción solo está activa si se ha seleccionado la op‐
ción "Ocultar" y se ha definido un parámetro actual pre‐
definido.

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de la interfaz del bloque
9.6 Editar las propiedades de variables y constantes locales
Grupo

Propiedad

Descripción

Atributos definidos
por el usuario

CFC_Configurable

Parametrizable
Identifica si un parámetro es parametrizable en CFC.

CFC_ForTest

Para test
Identifica si un parámetro está registrado para el modo
Test de CFC.

CFC_Visible

Visible
Identifica si un parámetro es visible en CFC.

CFC_Interconnecta‐ Interconectable
ble
Identifica si un parámetro es interconectable en CFC.
CFC_EnableTa‐
gReadback

Activar la lectura de variables del PLC

CFC_Enumeration‐
Texts

Textos de enumeraciones

Indica si un parámetro es relevante para la función de
CFC "Leer esquema de PLC".
Asigna un parámetro a una enumeración en CFC.

CFC_EngineeringU‐ Unidad de ingeniería
nit
Asigna un parámetro a una unidad en CFC.
CFC_LowLimit

Límite inferior
Define el valor límite inferior del parámetro en CFC.

CFC_HighLimit

Límite superior
Define el valor límite superior del parámetro en CFC.

Consulte también
Remanencia de las variables locales (Página 7789)
Cambiar las propiedades de variables y constantes locales (Página 7831)
Palabras clave (Página 95)
Ocultar parámetros en la llamada del bloque (Página 7804)
Declarar parámetros actuales predefinidos (Página 7805)

9.6.2

Cambiar las propiedades de variables y constantes locales

Editar las propiedades de un elemento en la interfaz tabular del bloque
Para editar las propiedades de un elemento en la interfaz del bloque, proceda del siguiente
modo:
1. Abra la interfaz del bloque.
2. Seleccione el elemento deseado en la tabla.
3. Modifique las entradas en las columnas.

Programación del PLC
Manual de programación y manejo, 11/2019

7831

Declaración de la interfaz del bloque
9.6 Editar las propiedades de variables y constantes locales

Editar las propiedades de varios elementos en la interfaz tabular del bloque
Algunas propiedades también pueden activarse y desactivarse simultáneamente para varios
elementos seleccionados.
Para cambiar una de estas propiedades para varios elementos, proceda del siguiente modo:
1. Abra la interfaz del bloque.
2. Mantenga pulsada la tecla <ctrl>.
3. En la columna deseada, seleccione sucesivamente las celdas cuyos valores desee
cambiar.
4. Elija los comandos "Activar <propiedad>" o "Desactivar <propiedad>" del menú contextual.

Editar las propiedades en la ventana de propiedades
Para editar las propiedades de una variable o constante en particular, proceda del siguiente
modo:
1. Seleccione la variable o la constante.
Las propiedades del elemento se visualizan en la ventana de inspección.
2. Modifique las entradas deseadas en la ventana de inspección.

Cambiar el nombre de variables directamente en el editor de programación
Para cambiar el nombre de uno o varios elementos, proceda del siguiente modo:
1. Seleccione uno o varios elementos en el programa.
2. Elija el comando "Cambiar nombre de la variable" del menú contextual.
Se abre el cuadro de diálogo "Cambiar nombre de la variable". Muestra una tabla de
declaración con los elementos seleccionados.
3. Modifique las entradas de la columna "Nombre".
4. Confirme las entradas realizadas haciendo clic en el botón "Modificar".

Editar el tipo de datos o el comentario en el editor de programación
Para editar el tipo de datos o el comentario de una variable en el editor de programación,
proceda del siguiente modo:
1. Seleccione el nombre de la variable.
2. Elija el comando "Reasignar variable" del menú contextual.
Se abre el cuadro de diálogo "Reasignar variable". En él se visualiza una tabla de
declaración.
3. Modifique la entrada en la columna "Tipo de datos" o "Comentario".
4. Haga clic en el botón "Modificar" para confirmar la entrada.

7832

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de la interfaz del bloque
9.6 Editar las propiedades de variables y constantes locales

Repercusión en el programa
En caso de modificar el nombre, el tipo de datos o la dirección de una variable o constante, se
actualizan automáticamente todas las ubicaciones de las variables en el programa.

Nota
Si se modifica la interfaz de un bloque, puede ocurrir que el programa resulte incoherente. Las
incoherencias se actualizan automáticamente si es posible.
Si no es posible una actualización automática, las llamadas incoherentes se marcan en color
rojo. En ese caso, las incoherencias deben actualizarse manualmente.
Consulte también:
Actualizar llamadas de bloque en KOP (Página 7966)
Actualizar llamadas de bloque en FUP (Página 8027)

Consulte también
Descripción de la interfaz de bloque (Página 7783)
Propiedades de variables y constantes locales (Página 7829)
Remanencia de las variables locales (Página 7789)
Principios básicos de los valores de arranque (Página 7853)
Variables (Página 102)
Palabras clave (Página 95)
Actualizar la interfaz del bloque (Página 7834)
Edición de la tabla de la interfaz de bloque (Página 7806)
Reglas de la declaración de la interfaz del bloque (Página 7785)

9.6.3

Editar comentarios multilingües en la interfaz del bloque
Los comentarios de la interfaz del bloque se pueden editar en todos los idiomas de proyecto
que se han activado en la configuración de idiomas del proyecto. Encontrará más información
sobre la activación de idiomas del proyecto en AUTOHOTSPOT.
Tenga en cuenta que los textos no deben tener más de 32767 caracteres Unicode después de
traducirlos.
No es posible introducir comentarios en varios idiomas en la interfaz de bloque textual.

Programación del PLC
Manual de programación y manejo, 11/2019

7833

Declaración de la interfaz del bloque
9.7 Actualizar la interfaz del bloque

Requisitos
● Se han activado varios idiomas de proyecto.
● La interfaz del bloque está abierta y contiene al menos un comentario.
● El bloque no tiene protección de know-how.

Procedimiento
Para editar un comentario en todos los idiomas del proyecto, haga lo siguiente:
1. Haga clic en el comentario cuya traducción desee editar.
Si desea editar al mismo tiempo las traducciones de varios comentarios, seleccione todos
los comentarios deseados.
2. Abra la ficha "Propiedades" de la ventana de inspección.
3. Abra la ficha subordinada "Textos".
En la ficha "Textos" se muestran los comentarios seleccionados en los idiomas de proyecto
activos y, si están disponibles, las traducciones de los comentarios.
4. Las traducciones se pueden editar directamente en la tabla de la ficha "Textos".
5. Para editar las traducciones con un editor externo, puede exportar los textos mostrados al
formato OOXML con los botones "Exportar/importar textos del proyecto".
Nota
Editar todos los textos del proyecto en la tabla global "Textos del proyecto"
Las traducciones en los distintos idiomas del proyecto también se pueden editar en la tabla
global "Textos del proyecto". La tabla se encuentra en "Idiomas y recursos > Textos del
proyecto" del árbol del proyecto. Contiene todos los textos del proyecto que pueden traducirse.
Encontrará más información sobre la traducción de textos en AUTOHOTSPOT.

9.7

Actualizar la interfaz del bloque

Introducción
Si modifica o borra tipos de datos PLC o multiinstancias que se utilizan en la interfaz del bloque,
la interfaz se volverá incoherente. Para corregir esta incoherencia se debe actualizar la
interfaz.

7834

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de la interfaz del bloque
9.7 Actualizar la interfaz del bloque
Existen dos posibilidades de actualizar la interfaz del bloque:
● Actualización explícita de la interfaz del bloque.
Los tipos de datos PLC y multiinstancias que se utilizan se actualizan. Los bloque de datos
instancia pertenecientes al bloque no se actualizan implícitamente.
● Actualización implícita durante la compilación.
Todos los tipos de datos PLC y multiinstancias que se utilizan, así como los bloques de
datos instancia correspondientes, se actualizan.

Actualización explícita de la interfaz del bloque
Para actualizar la interfaz del bloque explícitamente, proceda del siguiente modo:
1. Abra la interfaz del bloque.
2. Elija el comando "Actualizar interfaz" del menú contextual.

Actualización implícita durante la compilación
Para actualizar implícitamente durante la compilación todos los usos de los tipos de datos PLC
y las multiinstancias, así como los bloques de datos instancia, proceda del siguiente modo:
1. Abra el árbol del proyecto.
2. Seleccione la carpeta "Bloques de programa".
3. En el menú contextual, elija el comando "Compilar > Software (compilar todos los bloques)".

Consulte también
Declarar variables basadas en un tipo de datos PLC (Página 7800)
Principios básicos de los valores de arranque (Página 7853)
Variables (Página 102)
Palabras clave (Página 95)
Propiedades de variables y constantes locales (Página 7829)
Remanencia de las variables locales (Página 7789)
Actualizar llamadas de bloque en KOP (Página 7966)
Declarar multiinstancias (Página 7802)
Edición de la tabla de la interfaz de bloque (Página 7806)
Reglas de la declaración de la interfaz del bloque (Página 7785)

Programación del PLC
Manual de programación y manejo, 11/2019

7835

Declaración de la interfaz del bloque
9.8 Ampliar una interfaz de bloque

9.8

Ampliar una interfaz de bloque

Descripción
Para modificar con posterioridad programas de PLC que ya se han puesto en servicio y que
funcionan sin problemas en una instalación, las CPU de la serie S7-1500 y la mayoría de las
CPU de la serie S7-1200 a partir de V4 permiten ampliar las interfaces de bloques de función
durante el funcionamiento.
Los bloques modificados pueden cargarse sin necesidad de pasar la CPU a STOP y sin influir
en los valores de las variables ya cargadas.
De ese modo es posible realizar cambios en el programa con facilidad. El proceso controlado
no se ve afectado por esta carga (cargar sin reinicializar).

Modo de funcionamiento
Cada bloque de función dispone de forma predeterminada de una reserva de memoria. En un
primer momento, la reserva no se utiliza. Si después de compilar y cargar el bloque comprueba
que quiere cargar modificaciones de la interfaz, active la reserva de memoria. Todas las
variables declaradas después se cargan en la reserva de memoria. La siguiente carga no
influirá en los valores de las variables ya cargadas, por lo que el funcionamiento en curso no
se verá afectado.
Para modificar el programa más tarde, mientras la instalación no esté funcionando, se dispone
además de la posibilidad de modificar el formato de memoria de uno o varios bloques en un
único paso. Todas las variables de la reserva de memoria se mueven al área de memoria
habitual. La reserva de memoria se libera de nuevo para otras ampliaciones de interfaz.

Requisitos
La función "Cargar sin reinicializar" está disponible si se cumplen los siguientes requisitos:
● El proyecto está disponible en formato "TIA Portal V12" o en una versión superior.
● Trabaja con una CPU que admite "Cargar sin reinicializar".
● Los bloques se crearon en KOP, FUP, AWL o SCL.
● Los bloques han sido creados por el usuario, es decir, no son bloques suministrados.
● Se trata de bloques de acceso optimizado.

Pasos fundamentales
Para ampliar la interfaz de un bloque de función y cargar a continuación el bloque sin
reinicializar, proceda del siguiente modo:
1. Todos los bloques tienen de forma predeterminada una reserva de memoria de 100 bytes.
En caso necesario, el tamaño de la reserva puede adaptarse.
2. Active la reserva de memoria.
3. Amplíe la interfaz del bloque.

7836

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de la interfaz del bloque
9.8 Ampliar una interfaz de bloque
4. Compile el bloque.
5. Vuelva a cargar el bloque en la CPU de la forma acostumbrada.
Encontrará descripciones detalladas de cada uno de los pasos en el capítulo "Cargar bloques
(S7-1200/1500) ".
Nota
La función "Cargar sin reinicializar" solo está disponible con plena funcionalidad en las CPU de
las series S7-1500 y S7-1200 V4.
No obstante, todas las familias de CPU ofrecen los siguientes métodos para ampliar la interfaz
de bloques de función y cargar variables de nueva declaración sin ninguna repercusión:
● En la sección "Temp" se pueden agregar variables nuevas y cargarlas sin influir en el
proceso.
● En la sección "IOut" se pueden crear variables nuevas de un tipo de datos estructurado y
cargarlas sin influir en el proceso.

Programación del PLC
Manual de programación y manejo, 11/2019

7837

Declaración de la interfaz del bloque
9.8 Ampliar una interfaz de bloque

7838

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.1

10

Principios básicos de la programación de bloques de datos
Un bloque de datos (DB) sirve para guardar valores que se escriben durante la ejecución del
programa.
Al contrario que los bloques lógicos, los de datos solo contienen declaraciones de variables.
No contienen ni segmentos ni instrucciones. Las declaraciones de variables definen la
estructura del bloque de datos.

Tipos de bloques de datos
Existen dos tipos de bloques de datos, a saber:
● Bloques de datos globales
Un bloque de datos global no está asignado a ningún bloque lógico. Se puede acceder a los
valores de un bloque de datos global desde cualquier bloque lógico. Un bloque de datos
global contiene únicamente variables estáticas.
La estructura del bloque de datos global puede definirse libremente. En la tabla de
declaración del bloque de datos se declaran los elementos de datos que debe contener el
bloque de datos global.
● Bloques de datos de instancia
Un bloque de datos de instancia es aquel que está asignado directamente a un bloque de
función (FB). La estructura de un bloque de datos de instancia no puede definirse
libremente, sino que está determinada por la declaración de interfaz del bloque de función.
El bloque de datos de instancia contiene exactamente los parámetros de bloque y las
variables declaradas en él.
No obstante, en el bloque de datos de instancia pueden definirse valores específicos de la
instancia, p. ej. valores de arranque para las variables declaradas.

Bloques de datos ARRAY (S7-1500)
Los bloques de datos ARRAY son bloques de datos globales que constan de un ARRAY. Dicho
ARRAY puede basarse en cualquier tipo de datos. Puede ser un ARRAY de un tipo de datos
PLC (UDT), por ejemplo. El DB no contiene otros elementos más que el ARRAY. Gracias a su
estructura plana, los bloques de datos ARRAY facilitan el acceso a los elementos ARRAY y su
transmisión a bloques llamados.
Los bloques de datos ARRAY se utilizan para direccionar los ARRAY de forma indirecta: en
tiempo de ejecución es posible determinar qué DB ARRAY se leerá o escribirá, así como su
tamaño.
La sección "Transferencia" de la Task Card "Instrucciones" permite direccionar bloques de
datos ARRAY.

Programación del PLC
Manual de programación y manejo, 11/2019

7839

Programación de bloques de datos
10.1 Principios básicos de la programación de bloques de datos

Nota
Remanencia de bloques de datos ARRAY
Los bloques de datos ARRAY y sus componentes no se pueden ajustar como remanentes.
Consulte también:
Ejemplo de uso de bloques de datos ARRAY (Página 43)

Tipos de datos PLC como plantillas para bloques de datos globales
Los tipos de datos PLC pueden usarse como plantilla para la creación de bloques de datos
globales con la misma estructura de datos. La estructura se define solo una vez como tipo de
datos PLC y a continuación se generan los bloques de datos requeridos a través de la
asignación del tipo de datos PLC.

Tipos de datos del sistema como plantillas para bloques de datos globales
Los tipos de datos del sistema también pueden servir como plantilla para la creación de
bloques de datos globales con la misma estructura de datos. Los tipos de datos del sistema ya
tienen una estructura definida de manera fija. El tipo de datos del sistema se inserta solo una
vez en el programa y a continuación, a través de la asignación del tipo de datos del sistema,
se generan otros bloques de datos con la misma estructura.

Tipos de acceso
Existen dos métodos diferentes para acceder a valores de datos contenidos en bloque de
datos:
● Bloques de datos con acceso optimizado (solo S7-1200)
Los bloques de datos con acceso optimizado carecen de una estructura definida. En la
declaración se asigna a los elementos de datos un nombre simbólico, pero no una dirección
fija dentro del bloque. A los valores de datos de estos bloques se accede a través del
nombre simbólico.
Para los bloques de datos ARRAY, el atributo "Acceso optimizado al bloque" siempre está
activado.
● Bloques de datos con acceso estándar (todas las familias de CPU)
Los bloques de datos con acceso estándar tienen una estructura fija. En la declaración se
asigna a los elementos de datos un nombre simbólico y también una dirección fija dentro
del bloque. Se puede acceder a los valores de datos de estos bloques por medio del
nombre simbólico o la dirección.
Los bloques de datos con acceso estándar se ajustan a los límites de WORD. Esto significa
que ocupan siempre una WORD (16 bits) o un múltiplo de esta. Si es necesario, durante la
compilación se agregan al bloque de datos variables que rellenan el bloque hasta el
siguiente límite de WORD.
No se admiten bloques de datos ARRAY con acceso estándar.

7840

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.2 Estructura de la tabla de declaración de bloques de datos

Remanencia de los valores de datos
Para evitar pérdidas de datos en caso de un fallo de alimentación, los valores de datos pueden
depositarse en un área de memoria remanente.

Consulte también
Crear bloques de datos (Página 7730)
Bloques de datos globales (DB) (Página 41)
Bloques de datos instancia (Página 52)
Bloques con acceso optimizado (Página 54)

10.2

Estructura de la tabla de declaración de bloques de datos

Estructura de la tabla de declaración de bloques de datos
La siguiente figura muestra la estructura de la tabla de declaración para bloques de datos. La
representación varía según el tipo de bloque y acceso.

Representación de valores específicos de instancia
En los bloques de datos de instancia se pueden adoptar valores ya definidos provenientes de
la interfaz del bloque de función asignado, o bien definir valores de arranque específicos de la
instancia. Los valores que se adoptan desde el bloque de función se representan en color gris.
Los valores en gris se pueden reemplazar por valores específicos de instancia. Los valores
que ya se han modificado específicamente por instancia no aparecen en gris.

Programación del PLC
Manual de programación y manejo, 11/2019

7841

Programación de bloques de datos
10.2 Estructura de la tabla de declaración de bloques de datos

Significado de las columnas
En la siguiente tabla se explica el significado de las distintas columnas. Las columnas pueden
mostrarse u ocultarse según convenga. El número de columnas visualizadas varía en función
de la familia de CPU.
Columna

Explicación
Símbolo en el que se puede hacer clic para mover o copiar la variable. Ésta
puede arrastrarse hasta un programa mediante Drag & Drop y utilizarse allí
como operando.

Nombre

Nombre de la variable.

Tipo de datos

Tipo de datos de la variable.

Offset

Dirección relativa de la variable.
Esta columna sólo es visible en los bloques de datos con acceso estándar.
Nota:
Muchas instrucciones de las librerías de sistema SIMATIC tienen la propie‐
dad "Acceso optimizado al bloque" y por tanto no ocupan direcciones de
memoria fijas. Para estas instrucciones no se muestra ningún offset aunque
se utilicen como multiinstancia en un bloque de acceso estándar.

Valor predeterminado

Valor que se ha predeterminado para la variable en la interfaz de un bloque
lógico de orden superior o un tipo de datos PLC.
Los valores que contiene la columna "Valores predeterminados" pueden mo‐
dificarse sólo en el bloque lógico de orden superior o en el tipo de datos PLC.
En el bloque de datos, los valores sólo se muestran.

Valor de arranque

Valor que debe adoptar la variable durante el arranque.
Al crear el bloque de datos, los valores predeterminados definidos en un
bloque lógico se utilizan como valores de arranque. Estos valores aplicados
pueden sustituirse aquí por valores de arranque específicos de la instancia.
La indicación de un valor de arranque es opcional. Si no se especifica ningún
valor, la variable adopta el valor predeterminado durante el arranque. Si tam‐
poco se ha definido ningún valor predeterminado, se utiliza el valor estándar
válido para el tipo de datos. Por ejemplo, el valor estándar de BOOL es "FAL‐
SE".

Valor de observación

Valor de datos actual en la CPU.
Esta columna se visualiza si existe una conexión online y se hace clic en el
botón "Observar todo".

7842

Instantánea

Muestra los valores que se han cargado desde el dispositivo.

Remanencia

Marca la variable como remanente. Los valores de las variables remanentes
se conservan incluso tras desconectar la alimentación.

Visible en HMI Engi‐
neering

Indica si la variable está visible de forma predeterminada en la lista desple‐
gable de HMI.

Accesible desde HMI /
OPC UA / Web API

Indica si HMI / OPC UA / Web API puede acceder a esta variable en tiempo
de ejecución.

Escribible desde HMI /
OPC UA / Web API

Indica si la variable puede escribirse desde HMI / OPC UA / Web API en
tiempo de ejecución.

Valor de ajuste

Los valores de ajuste son valores que requieren un ajuste fino en la puesta en
marcha. Tras la puesta en marcha, los valores de estas variables pueden
transferirse como valores de arranque al programa offline y guardarse allí.

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.3 Crear bloques de datos
Columna

Explicación

Supervisión

Muestra si para la variable se ha creado una supervisión para el diagnóstico
de proceso.

Comentario

Comentario para documentar la variable.

Consulte también
Editar las propiedades de las variables en bloques de datos (Página 7857)
Utilizar valores de ajuste durante la puesta en marcha (Página 7882)
Crear bloques de datos (Página 7730)
Programar la estructura de datos de bloques de datos globales (Página 7847)
Principios básicos de los valores de arranque (Página 7853)
Definir valores de arranque (Página 7853)
Ajustar remanencia (Página 7855)

10.3

Crear bloques de datos

Requisitos
La carpeta "Bloques de programa" del árbol del proyecto está abierta.

Procedimiento
Para crear un bloque de datos, proceda del siguiente modo:
1. Haga doble clic en el comando "Agregar nuevo bloque".
Se abre el cuadro de diálogo "Agregar nuevo bloque".
2. Haga clic en el botón "Bloque de datos (DB)".
3. Seleccione el tipo de bloque de datos. Existen las posibilidades siguientes:
– Para crear un bloque de datos global, seleccione la entrada de la lista "DB global".
– Para crear un bloque de datos ARRAY, seleccione la entrada de la lista "DB ARRAY".
– Para crear un bloque de datos instancia, seleccione de la lista el bloque de función al
que desea asignar el bloque de datos instancia. En la lista solo aparecen bloques de
función que se han creado con anterioridad para la CPU.
– Para crear un bloque de datos basado en un tipo de datos PLC, seleccione en la lista el
tipo de datos en cuestión. En la lista solo aparecen tipos de datos PLC que se han
creado con anterioridad para la CPU.
– Para crear un bloque de datos basado en un tipo de datos de sistema, seleccione en la
lista el tipo de datos en cuestión. En la lista solo se muestran los tipos de datos del
sistema que se han insertado con anterioridad en bloques de programa de la CPU.
4. Introduzca un nombre para el bloque de datos.

Programación del PLC
Manual de programación y manejo, 11/2019

7843

Programación de bloques de datos
10.3 Crear bloques de datos
5. Introduzca las propiedades del nuevo bloque de datos.
6. Si se ha seleccionado como "tipo" un bloque de datos ARRAY, introduzca el tipo de datos
ARRAY y el límite superior de ARRAY.
El límite superior de ARRAY puede modificarse en todo momento en la ventana de
propiedades del bloque generado. El tipo de datos ARRAY no puede modificarse a
posteriori.
7. Si en "Tipo" se ha seleccionado un bloque que contiene supervisiones, asigne un bloque de
función ProDiag a dichas supervisiones.
8. Haga clic en "Más información" para introducir más propiedades del nuevo bloque de datos.
Se abre un área con campos de entrada adicionales.
9. Introduzca todas las propiedades deseadas.
10.Active la casilla de verificación "Agregar y abrir" si el bloque debe abrirse inmediatamente
después de crearse.
11.Confirme la entrada realizada con "Aceptar".

Resultado
Se crea el nuevo bloque de datos. Este se encuentra entonces en la carpeta "Bloques de
programa" del árbol del proyecto.
Nota
Remanencia de bloques de datos ARRAY
Los bloques de datos ARRAY y sus componentes no se pueden ajustar como remanentes.

Consulte también
Bloques de datos ARRAY globales (DB) (Página 43)
Principios básicos de la programación de bloques de datos (Página 7839)
Bloques de datos globales (DB) (Página 41)
Bloques de datos instancia (Página 52)
Tipos de datos de sistema (Página 360)
Utilizar bloques de librerías (Página 7731)

7844

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.4 Actualizar bloques de datos

10.4

Actualizar bloques de datos

Introducción
Las modificaciones en la interfaz de un bloque de función o un tipo de datos PLC pueden
provocar que los bloques de datos correspondientes se vuelvan incoherentes. Estas
incoherencias se marcan en color rojo tanto en la tabla de declaración como en el punto de
llamada del bloque. Para corregir las incoherencias es necesario actualizar los bloques de
datos.
Existen tres posibilidades de actualizar bloques de datos:
● Actualización explícita en la tabla de declaración de los bloques de datos.
Se actualiza el bloque de datos. Se adoptan las modificaciones procedentes de la interfaz
del bloque de función asignado y las de los tipos de datos PLC utilizados.
● Actualización explícita en el editor de programación.
Se actualizan las llamadas de bloque del bloque abierto. También se adaptan los bloques
de datos instancia respectivos.
● Actualización implícita durante la compilación.
Se actualizan todas las llamadas de bloque en el programa, así como los tipos de datos
PLC utilizados y los bloques de datos instancia respectivos.

Actualización explícita en la tabla de declaración de los bloques de datos
Para actualizar explícitamente un bloque de datos en particular, proceda del siguiente modo:
1. Abra el bloque de datos.
2. Elija "Actualizar interfaz" en el menú contextual.

Actualización explícita en el editor de programación
Para actualizar todas las llamadas de bloque o una determinada en un bloque, proceda del
siguiente modo:
1. Abra el bloque en el editor de programación.
2. Haga clic con el botón derecho del ratón en la instrucción que contiene la llamada de bloque.
3. Elija el comando "Actualizar" del menú contextual.
4. Se abre el cuadro de diálogo "Sincronización de la interfaz". En él se visualizan las
diferencias entre la interfaz utilizada y la interfaz modificada del bloque llamado.
5. Si desea actualizar la llamada de bloque, haga clic en "Aceptar". Para cancelar la
actualización, haga clic en "Cancelar".

Programación del PLC
Manual de programación y manejo, 11/2019

7845

Programación de bloques de datos
10.5 Ampliar bloques de datos

Actualización implícita durante la compilación
Para actualizar implícitamente todas las llamadas de bloque, las ubicaciones de los tipos de
datos PLC y los bloques de datos instancia durante la compilación, proceda del siguiente
modo:
1. Abra el árbol del proyecto.
2. Seleccione la carpeta "Bloques de programa".
3. En el menú contextual, elija el comando "Compilar > Software (compilar todos los bloques)".

Consulte también
Modificar propiedades de las variables en bloques de datos de instancia (Página 7861)

10.5

Ampliar bloques de datos

Descripción
Para modificar con posterioridad programas de PLC que ya se han puesto en servicio y que
funcionan sin problemas en una instalación, las CPU de la serie S7-1500 y la mayoría de las
CPU de la serie S7-1200 a partir de V4 permiten ampliar los bloques de datos globales durante
el funcionamiento.
Los bloques modificados pueden cargarse sin necesidad de pasar la CPU a STOP y sin influir
en los valores de las variables ya cargadas.
De ese modo es posible realizar cambios en el programa con facilidad. El proceso controlado
no se ve afectado por esta carga (cargar sin reinicializar).

Modo de funcionamiento
Cada bloque de datos dispone de forma predeterminada de una reserva de memoria. En un
primer momento, la reserva no se utiliza. Si compila y carga el bloque y después se da cuenta
de que desea cargar cambios de interfaz con posterioridad, entonces active la reserva de
memoria. Todas las variables declaradas después se cargan en la reserva de memoria. Al
realizar la carga a continuación, los valores de las variables ya cargadas no se ven afectados.
Para modificar el programa más tarde, mientras la instalación no esté funcionando, se dispone
además de la posibilidad de modificar el formato de memoria de uno o varios bloques en un
único paso. Todas las variables de la reserva de memoria se mueven al área de memoria
habitual. La reserva de memoria se libera de nuevo para otras ampliaciones de interfaz.

Requisitos
La función "Cargar sin reinicializar" está disponible si se cumplen los siguientes requisitos:
● El proyecto está disponible en formato "TIA Portal V12" o en una versión superior.
● Trabaja con una CPU que admite "Cargar sin reinicializar".
● Los bloques se crearon en KOP, FUP, AWL o SCL.

7846

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.6 Programar la estructura de datos de bloques de datos globales
● Los bloques han sido creados por el usuario, es decir, no son bloques suministrados.
● Se trata de bloques de acceso optimizado.

Pasos fundamentales
Para ampliar un bloque de datos y cargar a continuación el bloque sin reinicializar, siga los
siguientes pasos.
1. Todos los bloques tienen de forma predeterminada una reserva de memoria de 100 bytes.
En caso necesario, el tamaño de la reserva puede adaptarse.
2. Active la reserva de memoria.
3. Amplíe la interfaz del bloque.
4. Compile el bloque.
5. Vuelva a cargar el bloque en la CPU de la forma acostumbrada.

Referencia
Encontrará descripciones detalladas de cada uno de los pasos en el capítulo "Cargar bloques
(S7-1200/1500) ".

10.6

Programar la estructura de datos de bloques de datos globales

10.6.1

Declarar variables del tipo de datos simple

Requisitos
Hay un bloque de datos global abierto.
Nota
Las estructuras de bloques de datos de instancia y bloques de datos basados en un tipo de
datos PLC no se pueden modificar directamente, puesto que están definidas por el bloque de
función o el tipo de datos PLC.
El tipo de bloque de datos está introducido en las propiedades del bloque.

Programación del PLC
Manual de programación y manejo, 11/2019

7847

Programación de bloques de datos
10.6 Programar la estructura de datos de bloques de datos globales

Procedimiento
Para declarar una variable de un tipo de datos simple, proceda del siguiente modo:
1. Introduzca un nombre de variable en la columna "Nombre".
2. Haga clic en el botón para la selección del tipo de datos de la columna "Tipo de datos".
Se abre una lista de los tipos de datos permitidos.
3. Seleccione el tipo de datos que desee utilizar.
4. Opcionalmente: Modifique las propiedades de las variables que se visualizan en las otras
columnas.
5. Repita los pasos 1 a 4 para todas las variables que desea declarar.

Consulte también
Mostrar y editar propiedades de bloques (Página 7747)
Declarar variables del tipo de datos ARRAY (Página 7848)
Declarar variables del tipo de datos STRUCT (Página 7850)
Editar la tabla de declaración de bloques de datos (Página 7865)
Definir valores de arranque (Página 7853)
Ajustar remanencia (Página 7855)
Funciones online y de diagnóstico para bloques de datos (Página 7869)

10.6.2

Declarar variables del tipo de datos ARRAY

Requisitos
Hay un bloque de datos global abierto.

Procedimiento
Para declarar una variable del tipo de datos ARRAY, proceda del siguiente modo:
1. Introduzca un nombre de variable en la columna "Nombre".
2. Introduzca el tipo de datos "Array" en la columna "Tipo de datos". Se dispone de la ayuda
de la función de autocompletar.
Se abre el cuadro de diálogo "Array".
3. Indique el tipo de datos de los elementos Array en el campo de entrada "Tipo de datos".

7848

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.6 Programar la estructura de datos de bloques de datos globales
4. A continuación, indique los límites inferior y superior de cada dimensión en el campo
"Límites de matriz".
Ejemplo de un ARRAY unidimensional:
ARRAY [0..3] of Bool
Ejemplo de un ARRAY tridimensional:
ARRAY[0..3, 0..15, 0..33] of Bool
Ejemplo de un ARRAY unidimensional con constantes locales como límites de ARRAY
ARRAY[#My_local_const1..#My_local_const2] of Bool
Ejemplo de un ARRAY unidimensional con constantes globales como límites de ARRAY
ARRAY["My_global_const1".."My_global_const1"] of Bool
5. Confirme la entrada.
6. Opcionalmente: Modifique las propiedades de las variables que se visualizan en las otras
columnas.
Se crea la variable, pero permanece contraída. Para expandir el ARRAY, haga clic en el
triángulo situado delante de la variable. Tenga en cuenta que los ARRAYs de más de 10000
elementos no pueden expandirse para garantizar una mayor claridad.

Introducir los valores de arranque de elementos ARRAY
Para preseleccionar los valores de arranque de los distintos elementos de un ARRAY, proceda
del siguiente modo:
1. Haga clic en el triángulo situado delante de la variable del tipo de datos ARRAY.
El ARRAY se expande y cada uno de sus elementos aparece en una fila.
2. Introduzca los valores deseados en la columna "Valor de arranque".

Comentar ARRAYs
Para introducir un comentario para todo el ARRAY, introdúzcalo en la fila superior de la
declaración ARRAY. El comentario se utiliza como ajuste predeterminado para todos los
elementos ARRAY subordinados.
Para asignar comentarios específicos a los diferentes elementos de un ARRAY, proceda del
siguiente modo:
1. Haga clic en el triángulo situado delante de la variable del tipo de datos ARRAY.
El ARRAY se expande y cada uno de sus elementos aparece en una fila.
2. Introduzca los valores que desee en la columna "Comentario".

Visualizar los ARRAYs en modo avanzado
En la vista "Modo avanzado", los ARRAYs se muestran expandidos de forma predeterminada.
Para activar el modo avanzado, proceda del siguiente modo:
1. Haga clic en el botón "Modo avanzado" de la barra de herramientas.

Programación del PLC
Manual de programación y manejo, 11/2019

7849

Programación de bloques de datos
10.6 Programar la estructura de datos de bloques de datos globales

Nota
Restricción en la vista "Modo avanzado"
Dependiendo del tamaño de la memoria de trabajo del equipo existen los siguientes límites
máximos para el modo avanzado:
● Memoria de trabajo < 8 GB: Como máximo se visualizan 10.000 líneas.
● Memoria de trabajo >= 8 GB: Como máximo se visualizan 40.000 líneas.

Consulte también
Definir valores de arranque (Página 7853)
Ajustar remanencia (Página 7855)
Editar la tabla de declaración de bloques de datos (Página 7865)
ARRAY (Página 293)
Utilizar la función automática de autocompletar (Página 7682)

10.6.3

Declarar variables del tipo de datos STRUCT

Requisitos
Hay un bloque de datos global abierto.

Procedimiento
Para declarar una variable del tipo de datos STRUCT, proceda del siguiente modo:
1. Introduzca un nombre de variable en la columna "Nombre".
2. Introduzca "Struct" en la columna "Tipo de datos". Al introducirlo, se dispone de la función
de autocompletar.
Debajo de las nuevas variables se inserta una fila vacía sangrada.
3. Inserte el primer elemento de estructura en la fila vacía.
Debajo del elemento se inserta nuevamente una fila vacía.
4. Seleccione un tipo de datos para el elemento de estructura.
5. Opcionalmente: Modifique las propiedades del elemento de estructura que se visualizan en
las otras columnas de la interfaz del bloque.
6. Repita los pasos 4 a 7 para todos los demás elementos de estructura.
No es necesario finalizar explícitamente la estructura. La estructura termina con el último
elemento introducido.
7. Para insertar una nueva variable después de la estructura, deje una fila vacía al final de la
estructura e introduzca la nueva variable en la segunda fila vacía.

7850

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.6 Programar la estructura de datos de bloques de datos globales

Resultado
Se crea la variable del tipo de datos STRUCT.

Introducir los valores de arranque de los elementos de estructuras
Para predeterminar los valores de arranque de los distintos elementos de una estructura,
proceda del siguiente modo:
1. Haga clic en el triángulo situado delante de la variable del tipo de datos STRUCT.
La estructura se expande y los elementos de estructura individuales se muestran en sus
propias filas.
Tenga en cuenta que, por motivos de mayor claridad, las estructuras de gran tamaño no
pueden expandirse.
2. Introduzca los valores deseados en la columna "Valor de arranque".
Nota
S7-1500: Máximo 252 estructuras en un bloque de datos
En un bloque de datos se permite un máximo de 252 estructuras. Si necesita más estructuras,
tendrá que reestructurar el programa. Por ejemplo se pueden crear las estructuras en varios
bloques de datos globales.

Consulte también
Principios básicos de STRUCT (Página 288)
Definir valores de arranque (Página 7853)
Ajustar remanencia (Página 7855)
Editar la tabla de declaración de bloques de datos (Página 7865)
Utilizar la función automática de autocompletar (Página 7682)

10.6.4

Declaración de variables del tipo de datos STRING

Requisitos
Hay un bloque de datos global abierto.

Procedimiento
Para declarar una variable del tipo de datos STRING, proceda del siguiente modo:
1. Seleccione la sección de declaración deseada en la interfaz.
2. Introduzca un nombre de variable en la columna "Nombre".

Programación del PLC
Manual de programación y manejo, 11/2019

7851

Programación de bloques de datos
10.6 Programar la estructura de datos de bloques de datos globales
3. Introduzca "STRING" en la columna "Tipo de datos". Al introducirlo, se dispone de la
función de autocompletar.
4. Opcionalmente: Indique la longitud máxima de la cadena de caracteres entre corchetes a
continuación de la palabra clave STRING. Si no indica una longitud máxima, STRING
tendrá una longitud estándar de 254 caracteres.
Ejemplo de un STRING de longitud máxima 4:
STRING[4]
Ejemplo de un STRING cuya longitud máxima se define mediante una constante local:
STRING[#My_local_const1]
Ejemplo de un STRING cuya longitud máxima se define mediante una constante global:
STRING["My_global_const1"]

Resultado
Se crea la variable del tipo de datos STRING.

10.6.5

Declarar variables basadas en un tipo de datos PLC

Requisitos
● Hay un bloque de datos global abierto.
● En la CPU actual está declarado un tipo de datos PLC.

Procedimiento
Para declarar una variable basada en el tipo de datos PLC, proceda del siguiente modo:
1. Introduzca un nombre de variable en la columna "Nombre".
2. Introduzca el tipo de datos PLC en la columna "Tipo de datos". Al introducirlo, se dispone
de la función de autocompletar.
3. La variable se crea.
4. Opcionalmente: Modifique las propiedades de las variables que se visualizan en las otras
columnas de la tabla.
Si en la declaración del tipo de datos PLC ya se han definido valores predeterminados o
comentarios para las variables de un tipo de datos PLC, se mostrarán en gris. Esos valores
se pueden modificar en la interfaz del bloque.
Los valores modificados se representan en negro y solo son válidos para el lugar de uso
específico.
Nota
Si modifica o borra tipos de datos PLC utilizados en el bloque de datos, este se volverá
incoherente. Para corregir esta incoherencia es necesario volver a compilar el programa.

7852

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.7 Definir valores de arranque

Consulte también
Descripción de la interfaz de bloque (Página 7783)
Editar la tabla de declaración de bloques de datos (Página 7865)
Utilizar la función automática de autocompletar (Página 7682)

10.7

Definir valores de arranque

10.7.1

Principios básicos de los valores de arranque

Definición de "Valor de arranque"
El valor de arranque de una variable es un valor definido por el usuario que la variable debe
adoptar tras un arranque de la CPU.
Las variables remanentes constituyen un caso particular. Sus valores adoptan el valor de
arranque definido sólo después de un "Arranque en frío". Tras un "Rearranque completo (en
caliente)" se conservan los valores y no se ponen al valor de arranque.

Definición de "Valor predeterminado"
La estructura de los bloques de datos puede derivarse de elementos de orden superior:
● Un bloque de datos de instancia se basa p. ej. en la interfaz de un bloque lógico de orden
superior.
● Un bloque de datos global puede basarse en un tipo de datos PLC predefinido.
En este caso, se puede definir un valor predeterminado para cada variable en el elemento de
orden superior. Al crear el bloque de datos, se utilizan estos valores predeterminados como
valores de arranque. Estos valores aplicados pueden sustituirse luego en el bloque de datos
por valores de arranque específicos de la instancia.
La indicación de un valor de arranque es opcional. Si no se especifica ningún valor, la variable
adopta el valor predeterminado durante el arranque. Si tampoco se ha definido ningún valor
predeterminado, se utiliza el valor estándar válido para el tipo de datos. Por ejemplo, el valor
estándar de BOOL es "FALSE".

Consulte también
Definir valores de arranque (Página 7854)
Estructura de la tabla de declaración de bloques de datos (Página 7841)
Declarar variables y constantes locales en la interfaz del bloque (Página 7793)
Aplicar valores del programa online como valores de arranque (Página 7885)

Programación del PLC
Manual de programación y manejo, 11/2019

7853

Programación de bloques de datos
10.7 Definir valores de arranque

10.7.2

Definir valores de arranque

Definir valores de arranque
Para definir valores de arranque para las variables de un bloque de datos, proceda del
siguiente modo:
1. Abra el bloque de datos.
La columna "Valor predeterminado" muestra los valores predeterminados definidos para
las variables en la interfaz de un bloque lógico de orden superior o en un tipo de datos PLC.
2. Para mostrar todos los elementos de tipos de datos estructurados, haga clic en el botón
"Modo avanzado".
3. Introduzca los valores iniciales deseados en la columna "Valor de arranque". El valor se
debe corresponder con el tipo de datos de la variable y no puede exceder el rango de
valores del tipo de datos.
Los valores de arranque se han definido. Durante el arranque, la variable adopta el valor
definido, siempre que no haya sido declarada como remanente.

Inicializar una variable al valor predeterminado
Para poner una variable al valor predeterminado para la que se ha definido un valor de
arranque, proceda del siguiente modo:
1. Seleccione un valor modificado en la tabla.
2. Borre el valor.
Se introduce el valor predeterminado. Este se representa desactivado.

Inicializar todas las variables al valor predeterminado
Para poner todas las variables al valor predeterminado para la que se ha definido un valor de
arranque, proceda del siguiente modo:
1. Elija el botón "Resetear valores de arranque" en la barra de herramientas.
Los valores predeterminados se transfieren a la columna "Valor de arranque". Los valores
de arranque protegidos contra escritura no se sobrescriben.

Consulte también
Principios básicos de los valores de arranque (Página 7853)
Aplicar valores del programa online como valores de arranque (Página 7885)
Editar la tabla de declaración de bloques de datos (Página 7865)

7854

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.8 Ajustar remanencia

10.8

Ajustar remanencia

10.8.1

Remanencia de variables en bloques de datos

Comportamiento remanente
Para impedir la pérdida de datos en caso de un corte de alimentación, algunos datos pueden
marcarse como remanentes. Entonces se guardarán en un área de memoria remanente. Las
posibilidades de ajuste de la remanencia dependen del tipo de bloque de datos y del tipo de
acceso a bloques configurado.

Consulte también
Ajustar la remanencia en un bloque de datos de instancia (Página 7855)
Ajustar la remanencia en un bloque de datos global (Página 7856)

10.8.2

Ajustar la remanencia en un bloque de datos de instancia

Introducción
La posibilidad de modificar el comportamiento remanente en un bloque de datos instancia
depende del tipo de acceso del bloque de función de orden superior:
● Bloque de función con acceso estándar
Los datos instancia se pueden definir en conjunto como remanentes o no remanentes. Los
ajustes de remanencia individuales no son posibles para algunas variables.
● Bloque de función con acceso optimizado
En el bloque de datos instancia se pueden definir los ajustes de remanencia de las variables
marcadas en la interfaz del bloque con "Ajustar en IDB". El comportamiento remanente de
estas variables tampoco puede ajustarse individualmente. Los ajustes de remanencia
repercuten en todas las variables marcadas en la interfaz del bloque con "Ajustar en IDB".

Ajustar la remanencia con acceso estándar
Para ajustar la remanencia de forma centralizada de todas las variables en bloques de datos
con acceso estándar, proceda del siguiente modo:
1. Abra el bloque de datos instancia.
2. Active la casilla de verificación en la columna "Remanencia" de una variable.
Todas las variables se definen como remanentes.
3. Para inicializar la configuración de remanencia de todas las variables, desactive la casilla
de verificación en la columna "Remanencia" de una variable.
Todas las variables se definen como no remanentes.

Programación del PLC
Manual de programación y manejo, 11/2019

7855

Programación de bloques de datos
10.8 Ajustar remanencia

Ajustar la remanencia con acceso optimizado
Para ajustar el comportamiento remanente en los bloques de datos con acceso optimizado de
las variables marcadas con "Ajustar en IDB", proceda del siguiente modo:
1. Abra el bloque de datos instancia.
2. Active la casilla de verificación en la columna "Remanencia" de una variable.
Todas las variables marcadas en la interfaz del bloque con "Ajustar en IDB" se definen
como remanentes.
3. Para inicializar la configuración de remanencia de las variables, desactive la casilla de
verificación en la columna "Remanencia" de una variable.
Todas las variables marcadas en la interfaz del bloque con "Ajustar en IDB" se definen
como no remanentes.

Consulte también
Fundamentos del acceso a bloques (Página 54)
Remanencia de variables en bloques de datos (Página 7855)
Editar la tabla de declaración de bloques de datos (Página 7865)

10.8.3

Ajustar la remanencia en un bloque de datos global

Introducción
La posibilidad de modificar el comportamiento remanente en un bloque de datos global
depende del tipo de acceso:
● Bloque de datos global con acceso estándar
Los datos se pueden definir en conjunto como remanentes o no remanentes. Los ajustes
de remanencia individuales no son posibles para algunas variables.
● Bloque de datos global con acceso optimizado
Los ajustes de remanencia de las variables se pueden definir individualmente. En variables
de tipos de datos estructurados, los ajustes de remanencia se aplican a todos los
elementos de las variables.
Nota
Remanencia de bloques de datos ARRAY
Los bloques de datos ARRAY y sus componentes no se pueden ajustar como remanentes.

7856

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.9 Editar las propiedades de las variables en bloques de datos

Ajustar la remanencia con acceso estándar
Para ajustar la remanencia de forma centralizada de todas las variables en bloques de datos
con acceso estándar, proceda del siguiente modo:
1. Abra el bloque de datos global.
2. Active la casilla de verificación en la columna "Remanencia" de una variable.
Todas las variables se definen como remanentes.
3. Para inicializar la configuración de remanencia de todas las variables, desactive la casilla
de verificación en la columna "Remanencia" de una variable.
Todas las variables se definen como no remanentes.

Ajustar la remanencia con acceso optimizado
Para ajustar individualmente la remanencia de las variables en un bloque de datos con acceso
optimizado, proceda del siguiente modo:
1. Abra el bloque de datos global.
2. Active la casilla de verificación de la columna "Remanencia" para la variable para la que
desea configurar el comportamiento remanente.
La variable seleccionada se define como remanente.
3. Para inicializar la configuración de remanencia de las variables, desactive la casilla de
verificación en la columna "Remanencia" de una variable.
Todas las variables seleccionadas se definen como no remanentes.

Consulte también
Fundamentos del acceso a bloques (Página 54)
Remanencia de variables en bloques de datos (Página 7855)
Editar la tabla de declaración de bloques de datos (Página 7865)

10.9

Editar las propiedades de las variables en bloques de datos

10.9.1

Propiedades de variables en bloques de datos

Propiedades
Las propiedades de una variable se muestran en la ventana de inspección al seleccionar la
variable en la tabla de declaración o en una ubicación (lugar de uso) en el editor de programas.

Programación del PLC
Manual de programación y manejo, 11/2019

7857

Programación de bloques de datos
10.9 Editar las propiedades de las variables en bloques de datos

Nota
Propiedades de elementos ARRAY
Si en el programa utiliza accesos ARRAY con índice variable
como #Program_Alarm_1[#myIndex], en el momento de la programación todavía no se
conocerá qué elemento ARRAY se utilizará en tiempo de ejecución. Por eso, si selecciona un
acceso ARRAY de este tipo en el editor de programas, en la ventana de inspección siempre se
mostrarán las propiedades del primer elemento ARRAY.
La siguiente tabla muestra una vista general de las propiedades de las variables en los bloques
de datos:
Grupo

Propiedad

Descripción

General

Nombre

Nombre de la variable.

Tipo de datos

Tipo de datos de la variable.

Valor predeterminado

Valor que se ha predeterminado para la variable en la
interfaz de un bloque lógico de orden superior o un tipo de
datos PLC.
Los valores que contiene la columna "Valores predeter‐
minados" pueden modificarse sólo en el bloque lógico de
orden superior o en el tipo de datos PLC. En el bloque de
datos, los valores sólo se muestran.

Valor de arranque

Valor que debe adoptar la variable al arrancar la CPU.
Al crear el bloque de datos, los valores predeterminados
definidos en un bloque lógico se utilizan como valores de
arranque. Estos valores aplicados pueden sustituirse aquí
por valores de arranque específicos de la instancia.
La indicación de un valor de arranque es opcional. Si no
se especifica ningún valor, la variable adopta el valor pre‐
determinado durante el arranque. Si tampoco se ha defi‐
nido ningún valor predeterminado, se utiliza el valor es‐
tándar válido para el tipo de datos. Por ejemplo, el valor
estándar de BOOL es "FALSE".

Comentario

7858

Comentario acerca de la variable.

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.9 Editar las propiedades de las variables en bloques de datos
Grupo

Propiedad

Descripción

Atributos

Remanencia

Marca la variable como remanente.
Los valores de las variables remanentes se conservan
incluso tras desconectar la alimentación.
Este atributo solo está disponible en la interfaz de bloques
de función con acceso optimizado.

Visible en HMI Enginee‐ Indica si la variable está visible de forma predeterminada
ring
en la lista desplegable de HMI.
Escribible desde HMI /
OPC UA / Web API

Indica si la variable puede escribirse desde HMI / OPC
UA / Web API en tiempo de ejecución.

Accesible desde HMI /
OPC UA / Web API

Indica si HMI / OPC UA / Web API puede acceder a esta
variable en tiempo de ejecución.
No obstante, tenga en cuenta que con el atributo "Acce‐
sible desde HMI /OPC UA / Web API" no se consigue una
protección de acceso general para la variable. El acceso
en modo de escritura o lectura a través de otras aplica‐
ciones puede ser posible aunque el atributo no esté acti‐
vado.

Visibilidad con llamadas Mostrar:
de bloques en KOP/FUP El parámetro es visible siempre en llamadas de bloques
en KOP o FUP.
Ocultar:
El parámetro se oculta siempre en llamadas de bloques
en KOP o FUP. En este caso, el cuadro de llamada dis‐
pone de una flecha pequeña en el margen inferior. Ha‐
ciendo clic en la flecha se muestra y conecta el parámetro.
Ocultar cuando no se haya asignado ningún parámetro
El parámetro se oculta en llamadas de bloques en KOP o
FUP, a menos que esté conectado. Cuando se asigna un
parámetro actual se muestra el parámetro en el cuadro de
llamada.
Parámetro actual prede‐ Define un parámetro que debe utilizarse como parámetro
finido
actual durante la llamada del bloque.
Mostrar cuando el pará‐
metro actual asignado y
el parámetro actual pre‐
definido no sean idénti‐
cos

El parámetro se oculta en llamadas de bloques en KOP o
FUP, siempre que el parámetro actual predefinido esté
asignado. Sin embargo, al asignar otro parámetro actual
se muestra el parámetro.
Esta opción solo está activa si se ha seleccionado la op‐
ción "Ocultar" y se ha definido un parámetro actual pre‐
definido.

Programación del PLC
Manual de programación y manejo, 11/2019

7859

Programación de bloques de datos
10.9 Editar las propiedades de las variables en bloques de datos
Grupo

Propiedad

Atributos defini‐ CFC_Visible
dos por el usua‐
rio
CFC_Configurable

Descripción
Visible
Identifica si un parámetro está visible en CFC.
Parametrizable
Identifica si un parámetro es parametrizable en CFC.

CFC_ForTest

Para test
Identifica si un parámetro está registrado para el modo
Test de CFC.

CFC_Interconnectable

Interconectable
Identifica si un parámetro es interconectable en CFC.

CFC_EnableTagRead‐
back

Activar la lectura de variables del PLC

CFC_Enumeration‐
Texts

Textos de enumeraciones

CFC_EngineeringUnit

Unidad de ingeniería

Indica si un parámetro es relevante para la función de
CFC "Leer esquema de PLC".
Asigna un parámetro a una enumeración en CFC.
Asigna un parámetro a una unidad en CFC.

CFC_LowLimit

Límite inferior
Define el valor límite inferior del parámetro en CFC.

CFC_HighLimit

Límite superior Define el valor límite superior del paráme‐
tro en CFC.

Consulte también
Modificar propiedades de las variables en bloques de datos de instancia (Página 7861)
Modificar propiedades de las variables en bloques de datos globales (Página 7862)
Ajustar remanencia (Página 7855)
Definir valores de arranque (Página 7853)

7860

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.9 Editar las propiedades de las variables en bloques de datos

10.9.2

Modificar propiedades de las variables en bloques de datos de instancia

Propiedades de variables específicas de instancia
Existen dos posibilidades para definir las propiedades de las variables:
● Las propiedades de las variables se adoptan desde la interfaz del bloque de función
asignado.
Las propiedades que se adoptan desde el bloque de función se representan en color gris
en las columnas de la tabla de declaración. Las propiedades "Nombre" y "Tipo de datos"
siempre se adoptan.
● Estas definen las propiedades específicas de la instancia.
Algunas propiedades se pueden modificar específicamente para cada instancia. Un valor
modificable es el comentario, por ejemplo. Las propiedades que se han modificado de
forma específica de la instancia no aparecen en color gris en las columnas de la tabla de
declaración. Las modificaciones específicas de instancia se mantienen aunque la interfaz
del bloque de función de orden superior se modifique y el bloque de datos instancia se
actualice después.

Editar las propiedades de un elemento en la tabla de declaración
Para editar las propiedades de un elemento, proceda del siguiente modo:
1. Abra el bloque de datos instancia.
2. Seleccione el elemento deseado en la tabla.
3. Modifique las entradas en las columnas.

Editar las propiedades de varios elementos en la tabla de declaración
Algunas propiedades también pueden activarse y desactivarse simultáneamente para varios
elementos seleccionados.
Para cambiar una de estas propiedades para varios elementos, proceda del siguiente modo:
1. Abra el bloque de datos.
2. Mantenga pulsada la tecla CTRL.
3. En la columna deseada, seleccione sucesivamente las celdas cuyos valores desee
cambiar.
4. Elija los comandos "Activar <propiedad>" o "Desactivar <propiedad>" del menú contextual.

Editar las propiedades en la ventana de propiedades
Para editar las propiedades de una variable en particular, proceda del siguiente modo:
1. Seleccione una variable de la tabla.
2. Elija el comando "Propiedades" del menú contextual.
Se abre la ventana de propiedades. Muestra las propiedades de la variable en las áreas
"General" y "Atributos".

Programación del PLC
Manual de programación y manejo, 11/2019

7861

Programación de bloques de datos
10.9 Editar las propiedades de las variables en bloques de datos
3. Seleccione el área deseada en la navegación local.
4. Modifique las entradas en los campos de entrada.

Inicializar propiedades individuales al valor predeterminado
Para inicializar propiedades individuales de variables al valor definido en el bloque de función
como valor predeterminado, proceda del siguiente modo:
1. Seleccione en la tabla un valor modificado específico de instancia.
2. Borre el valor.
El valor específico de instancia se borra y se introduce el valor predeterminado obtenido en
la interfaz del bloque de función. El valor predeterminado se representa en color gris.

Consulte también
Actualizar bloques de datos (Página 7845)
Propiedades de variables en bloques de datos (Página 7857)
Editar la tabla de declaración de bloques de datos (Página 7865)

10.9.3

Modificar propiedades de las variables en bloques de datos globales

Introducción
Existen dos posibilidades para definir las propiedades de las variables:
● Las propiedades de las variables se adoptan desde el tipo de datos PLC.
Las propiedades que se adoptan desde el tipo de datos PLC se representan en color gris
en las columnas de la tabla de declaración. Las propiedades "Nombre" y "Tipo de datos"
siempre se adoptan.
● Se definen propiedades específicas.
Algunas propiedades se pueden modificar en el bloque de datos global. Algunos valores
modificables son "Comentario" o "Visible en HMI". Las propiedades que se han modificado
no aparecen en color gris en las columnas de la tabla de declaración. Las modificaciones
se mantienen aunque el tipo de datos PLC se modifique y el bloque de datos global se
actualice después.

Editar las propiedades de un elemento en la tabla de declaración
Para editar las propiedades de un elemento, proceda del siguiente modo:
1. Abra el bloque de datos global.
2. Seleccione el elemento deseado en la tabla.
3. Modifique las entradas en las columnas.

7862

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.9 Editar las propiedades de las variables en bloques de datos

Editar las propiedades de varios elementos en la tabla de declaración
Algunas propiedades también pueden activarse y desactivarse simultáneamente para varios
elementos seleccionados.
Para cambiar una de estas propiedades para varios elementos, proceda del siguiente modo:
1. Abra el bloque de datos.
2. Mantenga pulsada la tecla CTRL.
3. En la columna deseada, seleccione sucesivamente las celdas cuyos valores desee
cambiar.
4. Elija los comandos "Activar <propiedad>" o "Desactivar <propiedad>" del menú contextual.

Editar las propiedades en la ventana de propiedades
Para editar las propiedades de una variable en particular, proceda del siguiente modo:
1. Seleccione una variable de la tabla.
2. Elija el comando "Propiedades" del menú contextual.
Se abre la ventana de propiedades. Muestra las propiedades de la variable en las áreas
"General" y "Atributos".
3. Seleccione el área deseada en la navegación local.
4. Modifique las entradas en los campos de entrada.

Inicializar propiedades individuales al valor predeterminado
Para inicializar propiedades individuales de variables al valor definido en el tipo de datos PLC
como valor predeterminado, proceda del siguiente modo:
1. Seleccione un valor modificado en la tabla.
2. Borre el valor.
Se introduce el valor predeterminado obtenido en el tipo de datos PLC. El valor
predeterminado se representa en color gris.

Consulte también
Propiedades de variables en bloques de datos (Página 7857)
Editar la tabla de declaración de bloques de datos (Página 7865)

10.9.4

Editar comentarios multilingües en el bloque de datos
Los comentarios de un bloque de datos se pueden editar en todos los idiomas del proyecto que
se han activado en la configuración de idiomas del proyecto. Encontrará más información
sobre la activación de idiomas del proyecto en AUTOHOTSPOT.
Tenga en cuenta que los textos no deben tener más de 32767 caracteres Unicode después de
traducirlos.

Programación del PLC
Manual de programación y manejo, 11/2019

7863

Programación de bloques de datos
10.9 Editar las propiedades de las variables en bloques de datos

Requisitos
● Se han activado varios idiomas de proyecto.
● El bloque de datos está abierto y contiene al menos un comentario.
● El bloque no tiene protección de know-how.

Procedimiento
Para editar un comentario en todos los idiomas del proyecto, haga lo siguiente:
1. Haga clic en el comentario cuya traducción desee editar.
Si desea editar al mismo tiempo las traducciones de varios comentarios, seleccione todos
los comentarios deseados.
En los bloques de datos de instancia únicamente pueden seleccionarse aquellos
comentarios que se hayan modificado en las instancias. Estos comentarios se reconocen
porque no se visualizan en gris. Los comentarios en gris solo se pueden seleccionar y editar
en el bloque de función correspondiente.
2. Abra la ficha "Propiedades" de la ventana de inspección.
3. Abra la ficha subordinada "Textos".
En la ficha "Textos" se muestran los comentarios seleccionados en los idiomas de proyecto
activos y, si están disponibles, las traducciones de los comentarios.
4. Las traducciones se pueden editar directamente en la tabla de la ficha "Textos".
5. Para editar las traducciones con un editor externo, puede exportar los textos mostrados al
formato OOXML con los botones "Exportar/importar textos del proyecto".
Nota
Editar todos los textos del proyecto en la tabla global "Textos del proyecto"
Las traducciones en los distintos idiomas del proyecto también se pueden editar en la tabla
global "Textos del proyecto". La tabla se encuentra en "Idiomas y recursos > Textos del
proyecto" del árbol del proyecto. Contiene todos los textos del proyecto que pueden traducirse.
Encontrará más información sobre la traducción de textos en AUTOHOTSPOT.

7864

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.10 Editar la tabla de declaración de bloques de datos

10.10

Editar la tabla de declaración de bloques de datos

10.10.1

Insertar filas en la tabla

Procedimiento
Para insertar una fila encima de la fila seleccionada, proceda del siguiente modo:
1. Seleccione la fila sobre la cual desea insertar una fila nueva.
2. Haga clic en el botón "Insertar fila" de la barra de herramientas de la tabla.

Resultado
Se inserta una fila nueva sobre la seleccionada.

10.10.2

Agregar filas en la tabla

Procedimiento
Para agregar una fila nueva detrás de la fila seleccionada, proceda del siguiente modo:
1. Seleccione la fila tras la que desea insertar la fila nueva.
2. Haga clic en el botón "Agregar fila" de la barra de herramientas de la tabla.

Resultado
Se inserta una fila nueva y vacía detrás de la fila seleccionada.

10.10.3

Borrar variables

Requisitos
Hay un bloque de datos global abierto.

Programación del PLC
Manual de programación y manejo, 11/2019

7865

Programación de bloques de datos
10.10 Editar la tabla de declaración de bloques de datos

Procedimiento
Para borrar una variable, proceda del siguiente modo:
1. Seleccione la fila que contiene la variable que desea borrar. También puede seleccionar
varias filas simultáneamente manteniendo pulsada la tecla <Ctrl> y haciendo clic
consecutivamente en las filas que desea seleccionar, o bien manteniendo pulsada la tecla
<Mayús> y haciendo clic en la primera y en la última fila.
2. Elija el comando "Borrar" del menú contextual.
Nota
La estructura de los bloques de datos instancia y globales basados en un tipo de datos PLC no
se puede modificar directamente, puesto que la estructura de estos bloques está definida en
el objeto de orden superior.
El tipo de bloque de datos está introducido en las propiedades del bloque.
Consulte también: Mostrar y editar propiedades de bloques (Página 7747)

10.10.4

Rellenar celdas consecutivas automáticamente
Es posible transferir el contenido de una o varias celdas de la tabla a las celdas situadas
debajo, rellenando así las celdas consecutivas automáticamente.
Si se rellenan automáticamente las celdas de la columna "Nombre", cada uno de los nombres
se complementará con un número correlativo. Por ejemplo, el nombre "Motor" se transforma
en "Motor_1".
Es posible definir como área de origen una celda individual o varias celdas, o bien filas
completas.
Si la tabla abierta contiene menos filas de las que deben rellenarse, en primer lugar se deben
insertar más filas vacías.

Requisitos
● La tabla está abierta.
● Se dispone de filas de declaración suficientes.

Procedimiento
Para rellenar celdas consecutivas automáticamente, proceda del siguiente modo:
1. Seleccione las celdas cuyo contenido desea transferir.
2. Haga clic en el símbolo de rellenar situado en la esquina inferior derecha de la celda.
El puntero del ratón adopta la forma de una cruz con puntas de flecha.
3. Con el botón del ratón pulsado, arrastre el puntero hacia abajo hasta situarlo sobre las
celdas que desea rellenar automáticamente.

7866

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.10 Editar la tabla de declaración de bloques de datos
4. Suelte el botón del ratón.
Las celdas se rellenan automáticamente.
5. Si ya existen entradas en las celdas que van a rellenarse automáticamente, aparece un
cuadro de diálogo. En este diálogo puede indicarse si se quieren sobrescribir las entradas
existentes o si se quieren insertar nuevas filas para las variables nuevas.

10.10.5

Navegar hasta las definiciones
Es posible utilizar tipos de datos PLC (UDT) como elementos en un bloque de datos o bien
generar un bloque de datos completo basado en un tipo de datos PLC. Para ver el punto de
definición del tipo de datos PLC, existe la posibilidad de navegar hasta él.

Procedimiento
Para navegar hasta la definición de un tipo de datos PLC, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en un elemento de bloque de datos basado en un
tipo de datos PLC.
O bien
Haga clic en la entrada "Static" de un bloque de datos basado en un tipo de datos PLC.
2. Elija el comando "Ir a definición" del menú contextual.

Resultado
Se abrirá la tabla de declaración en la que se definió el tipo de datos PLC y se mostrará el punto
de definición.

10.10.6

Mostrar y ocultar las columnas de la tabla
Las columnas de las tablas pueden mostrase u ocultarse según necesidad.

Procedimiento
Para mostrar u ocultar las columnas de una tabla, proceda del siguiente modo:
1. Haga clic en el encabezado de una columna.
2. Elija el comando "Mostrar/ocultar" del menú contextual.
Aparece una selección de las columnas disponibles.
3. Para mostrar una columna, active la casilla de verificación correspondiente.
4. Para ocultar una columna, desactive la casilla de verificación correspondiente.
5. Para mostrar u ocultar varias columnas, haga clic en "Más" y active o desactive la casilla de
verificación de las columnas en cuestión en el cuadro de diálogo "Mostrar/ocultar".

Programación del PLC
Manual de programación y manejo, 11/2019

7867

Programación de bloques de datos
10.10 Editar la tabla de declaración de bloques de datos

10.10.7

Editar variables con editores externos
Para editar variables individuales en editores de tablas, p. ej., en Excel, éstas se pueden copiar
y pegar para exportarlas o importarlas.

Nota
Restricciones en la visualización y copia de elementos ARRAY
Dependiendo del tamaño de la memoria de trabajo de su equipo existen los siguientes límites
máximos para la visualización y copia de elementos ARRAY del editor de bloques de datos a
una tabla Excel:
● Memoria de trabajo < 8 GB: Como máximo se visualizan y se copian 10.000 elementos.
● Memoria de trabajo >= 8 GB: Como máximo se visualizan y se copian 40.000 elementos.

Requisitos
Hay un bloque de datos y un editor externo abiertos.

Procedimiento
Para exportar variables PLC y volverlas a importar individualmente con Drag & Drop, proceda
del siguiente modo:
1. Para mostrar todos los elementos de tipos de datos estructurados, haga clic en el botón
"Modo avanzado".
2. Seleccione una o más variables.
3. Elija el comando "Copiar" del menú contextual.
4. Cambie al editor externo y pegue la variable copiada.
5. Edite las variables de la forma necesaria.
6. Copie las variables en el editor externo.
7. Cambie nuevamente a la tabla de declaración.
8. Elija el comando "Pegar" del menú contextual.

7868

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

10.11

Funciones online y de diagnóstico para bloques de datos

10.11.1

Editar bloques de datos en modo online

Introducción
Cuando se carga un bloque de datos en la CPU, existen dos versiones del bloque:
● una versión offline en el proyecto en la programadora
● una versión online en la CPU
Los bloques de datos pueden estar solo en la memoria de carga, solo en la memoria de
trabajo o bien en ambas áreas de memoria.

Valores de arranque y valores actuales de variables
Los valores de las variables de las versiones offline y online de un bloque de datos son
diferentes, ya que las variables del bloque online pueden ser modificadas por el programa de
usuario en tiempo de ejecución.
Al declarar un bloque de datos, se asigna un valor de arranque a las variables. El valor de
arranque es el valor que debe adoptar la variable cuando el bloque de datos se llama por
primera vez. La variable se "inicializa", por tanto, con el valor de arranque.
Los valores de arranque de las variables se declaran en la versión offline del bloque. Cuando
el bloque de datos se carga en la CPU, se transfiere a la memoria de carga con los valores de
arranque. Desde allí el bloque de datos se carga en la memoria de trabajo de la CPU. Al cargar
el bloque por primera vez, las variables se inicializan en la memoria de trabajo con los valores
de arranque declarados. A partir de entonces pueden ser modificadas por el programa de
usuario. Los valores de las variables de la memoria de trabajo se denominan "Valores
actuales".

Programación del PLC
Manual de programación y manejo, 11/2019

7869

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

Cargar bloques de datos modificados
Cuando se realizan cambios en un bloque de datos después de cargarlo por primera vez, se
edita la versión offline del bloque. Dependiendo de las circunstancias, la carga posterior del
bloque de datos afectará de forma diferente a los valores actuales.
● Cargar cambios en el estado operativo "RUN":
– Si no ha realizado ningún cambio en la estructura del bloque de datos, los valores
actuales de todas las variables se conservan. El programa continúa ejecutándose "sin
discontinuidades". Los posibles cambios en los valores de arranque existentes en el
bloque de datos offline se escriben en la memoria de carga. No se transfieren a la CPU
hasta la siguiente transición de "STOP" a "RUN".
– Si ha modificado la estructura del bloque de datos, se vuelven a inicializar todas las
variables con sus valores de arranque. La inicialización de las variables puede tener
efectos no deseados en el proceso, ya que es posible que este y el programa dejen de
estar sincronizados.
Esto puede evitarse utilizando la reserva de memoria del bloque. Esta memoria permite
cargar bloques de datos en "RUN" sin reinicialización. De este modo es posible realizar
cargas a posteriori sin discontinuidades, incluso habiendo modificado la estructura del
bloque de datos y, por ejemplo, agregado nuevas variables.
Consulte también: Principios básicos para cargar ampliaciones de bloque sin
reinicializar (Página 8385)
● Cargar cambios en el estado operativo "STOP":
– Los valores de arranque de las variables no remanentes se depositan en la memoria de
carga de la CPU. En la siguiente transición de "STOP" a "RUN", el programa arrancará
con los valores de arranque nuevos.
– Las variables remanentes no se reinicializan. Después de un proceso de carga en
"STOP", los valores actuales se conservan.
Para reinicializar también las variables remanentes al cargar en "STOP", seleccione en
el árbol del proyecto los bloques que desea cargar y elija el comando "Compilar >
Software (compilar todos los bloques)" del menú contextual. A continuación, elija el
comando "Cargar e inicializar programa PLC en dispositivo" del menú "Online". Los
bloques online se borran y se sobrescriben con los bloques nuevos. Con ello se
inicializan todas las variables, incluidas las remanentes.

Editar valores actuales con funciones online y de diagnóstico
Para influir en los valores actuales directamente en modo online sin necesidad de volver a
cargar bloques de datos se pueden utilizar las funciones online y de diagnostico del TIA Portal.
Consulte también: Relación de las funciones online y de diagnóstico en bloques de datos
(Página 7871)

7870

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

Cargar bloques de datos desde un dispositivo
Los bloques de datos también se pueden cargar desde un dispositivo. Esto puede resultar muy
útil, p. ej. cuando en caso de intervención del servicio técnico el proyecto offline ya no existe.
Tenga en cuenta que ambas familias de CPU tratan los valores de las variables de distinto
modo al cargar bloques desde un dispositivo.
● S7-1200/1500
Las CPU de las series S7-1200 y S7-1500 guardan en la memoria de carga los valores de
arranque con los que se cargó un bloque de datos en la CPU. Si carga un bloque de datos
de una CPU S7-1200/1500, estos valores de arranque de la memoria de carga se aplicarán
nuevamente al bloque de datos offline. Aunque haya modificado valores durante el
funcionamiento en la memoria de carga con la instrucción "WRIT_DBL", en el bloque de
datos offline se aplicarán los valores que se cargaron originalmente en el dispositivo.
● S7-300/400
Las CPU de la serie S7-300/400 también guardan en la memoria de carga los valores de
arranque con los que se cargó un bloque de datos en la CPU. Sin embargo, los valores no
se pueden leer en la memoria de carga. Al cargar un bloque de datos de un dispositivo, se
cargan los valores de observación actuales de la CPU y se registran en la columna "Valores
de arranque" del bloque de datos offline.

Consulte también
Cargar bloques para S7-1200/1500 (Página 8368)

10.11.2

Relación de las funciones online y de diagnóstico en bloques de datos

Relación de las funciones
En el editor de bloques de datos existen diferentes métodos para editar bloques de datos en
modo online. Estas funciones acceden directamente a los valores actuales de las variables del
programa online. Los valores actuales son los valores que las variables adoptan en el
momento actual durante la ejecución del programa en la memoria de trabajo de la CPU.
La tabla siguiente ofrece una relación de las funciones online y de diagnóstico. En los capítulos
siguientes encontrará descripciones detalladas de las diferentes funciones.

Botón

-

Función

Descripción

Observar varia‐
bles online (Pági‐
na 7873)

Muestra los valores actuales que las variables adoptan actual‐
mente en la CPU.

X

X

Forzar valores ac‐
tuales individual‐
mente (Pági‐
na 7873)

Fuerza variables individuales en la tabla de declaración a valores
específicos una sola vez y de forma inmediata. La CPU utiliza
entonces esos valores como valores actuales en el programa
online.

X

X

Programación del PLC
Manual de programación y manejo, 11/2019

S7-300/ S7-1200/1500
400

7871

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos
Botón

Función

Descripción

Crear una instan‐
tánea de los valo‐
res actuales (Pá‐
gina 7876)

Guarda en el proyecto offline una instantánea de los valores ac‐
tuales presentes en el momento actual. La instantánea siempre
registra los valores actuales de todas las variables del bloque de
datos.

X

X

Reinicializar los
Carga la instantánea en la CPU en forma de valores actuales. La
valores actuales
CPU utiliza entonces esos valores como valores actuales en el
con una instantá‐ programa online.
nea (Página 7878)

-

S7-1200 a partir
de V4.1

Copiar las instan‐
táneas como valo‐
res de arranque
(Página 7880)

X

X

X

X

Reinicializar los
valores actuales
con valores de
arranque (Pági‐
na 7874)

S7-300/ S7-1200/1500
400

Copia la instantánea en los valores de arranque del programa
offline. En la siguiente transición de STOP a RUN, el programa
arrancará con los valores de arranque nuevos.

S7-1500 a partir
de V1.7

Se pueden copiar todos los valores de arranque o solo los de las
variables marcadas como "Valor de ajuste".
Reinicializa los valores actuales de variables. Al hacerlo, los va‐
lores de arranque se escriben directamente en la memoria de
trabajo de la CPU.
Se pueden copiar todos los valores actuales o solo los de las
variables marcadas como "Valor de ajuste".

PELIGRO
Peligro por modificación de valores de variables
La modificación de los valores de variables con la instalación en funcionamiento puede
producir incoherencias entre el programa y el proceso real. Como consecuencia pueden
producirse daños materiales y personales graves.
● Asegúrese de que la instalación se encuentra en un estado seguro antes de sobrescribir
los valores actuales.
● Asegúrese de que las instantáneas se creen cuando la instalación se encuentre en un
estado seguro.
● Seleccione variables concretas como valores de ajuste para editar sus valores actuales en
el programa online.
● Asegúrese de que el programa no está leyendo ni escribiendo los datos en cuestión
durante la transferencia.
● Dado el caso, utilice en su lugar la función "Forzar variable" en la tabla de observación o
en el editor de bloques de datos.

Consulte también
Inicializar valores de ajuste en el programa online (Página 7884)
Aplicar valores del programa online como valores de arranque (Página 7885)
Editar bloques de datos en modo online (Página 7869)

7872

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos
Utilizar valores de ajuste durante la puesta en marcha (Página 7882)
Definir valores de arranque (Página 7853)

10.11.3

Observar variables
Los valores actuales que adoptan las variables actualmente en la CPU pueden observarse
directamente en la tabla de declaración.

Requisitos
● Existe una conexión online.
● El bloque de datos está cargado en la CPU.
● La ejecución del programa está activa (CPU en "RUN").
● El bloque de datos está abierto.

Procedimiento
Para observar los valores, proceda del siguiente modo:
1. Inicie la observación haciendo clic en el botón "Observar todos".
En la tabla aparece la columna adicional "Valor de observación". En ella se visualizan los
valores de datos actuales.
Consulte también: Estructura de la tabla de declaración de bloques de datos (Página 7841)
2. Para finalizar la observación, vuelva a hacer clic en el botón "Observar todos".

Consulte también
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)

10.11.4

Forzar variables
Se puede forzar una única variable del bloque de datos a un valor determinado. La CPU utiliza
entonces ese valor como valor actual en el programa online.

PELIGRO
Peligro por modificación de valores de variables
La modificación de los valores de variables con la instalación en marcha puede causar graves
daños materiales y personales en caso de mal funcionamiento o errores del programa.
Asegúrese de que no puedan darse situaciones de peligro antes de forzar las variables.

Programación del PLC
Manual de programación y manejo, 11/2019

7873

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

Requisitos
● Existe una conexión online con la CPU.
● El bloque de datos cuyas variables se van a forzar es idéntico offline y online.
● El bloque de datos está abierto.

Procedimiento
Para forzar una única variable en el bloque de datos, proceda del siguiente modo:
1. Inicie la observación haciendo clic en el botón "Observar todos".
En la tabla aparece la columna adicional "Valor de observación". En ella se visualizan los
valores de datos actuales.
2. Haga doble clic en la variable que debe forzarse.
– Si se trata de una variable booleana, se abre el cuadro de diálogo "Cambiar valor".
Confirme este cuadro de diálogo con "Aceptar".
Si selecciona la opción "No mostrar más este aviso" en este cuadro de diálogo, a partir
de este momento podrá cambiar el valor haciendo doble clic sobre él.
– Si se trata de una variable no booleana, se abre el cuadro de diálogo "Forzar valor".
Introduzca el valor que desee en el campo de entrada "Valor de forzado" y confirme con
"Aceptar".
Si existe una instantánea, el valor ya estará registrado como ajuste predeterminado.

Resultado
Al ejecutar la petición de forzado, la variable adopta una vez el valor indicado. La petición se
ejecuta inmediatamente y no se vincula al siguiente punto de control de ciclo.

Consulte también
Introducción al forzado de variables (Página 8595)
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)

10.11.5

Cargar valores de arranque como valores actuales
Los valores de arranque del programa offline pueden cargarse en la CPU como valores
actuales. En ese caso los valores de arranque se cargan directamente en la memoria de
trabajo de la CPU. Las variables del bloque online se reinicializan y la CPU utiliza los valores
nuevos como valores actuales en el programa online. No se distingue entre valores
remanentes y no remanentes. Se pueden copiar todos los valores actuales o solo los de las
variables marcadas como "Valor de ajuste".
Así se pone el proceso controlado rápidamente en un estado definido.
Los siguientes tipos de bloques de datos no pueden reinicializarse:
● bloques de datos que forman parte de un proyecto de referencia
● bloques de datos de seguridad

7874

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos
● bloques de datos creados por la CPU
● bloques de datos con el atributo "Depositar sólo en la memoria de carga"
● bloques de datos que solo están disponibles online
Esta función se puede ejecutar tanto en estado operativo "RUN" como en estado operativo
"STOP".
PELIGRO
Peligro por modificación de valores de variables
La modificación de los valores de variables con la instalación en funcionamiento puede
producir incoherencias entre el programa y el proceso real. Como consecuencia pueden
producirse daños materiales y personales graves.
Si el volumen de datos que se quiere transferir es muy elevado, posiblemente los valores se
transferirán en varios ciclos. Si el programa accede a variables antes de que se hayan
transferido todos los valores, existe riesgo de que se creen combinaciones de valores
incoherentes y que se procesen posteriormente.
La copia de los valores de tipos de datos simples también puede desarrollarse a lo largo de
varios ciclos. Estos valores serán potencialmente no válidos hasta que no se hayan
transferido por completo. Si el programa accede a esos valores antes de que se hayan
transferido por completo, pueden darse estados peligrosos.
Para evitar que se produzcan estados peligrosos, observe lo siguiente:
● Asegúrese de que la instalación se encuentra en un estado seguro antes de sobrescribir
los valores actuales.
● Seleccione variables concretas como valores de ajuste para editar sus valores actuales en
el programa online.
● Asegúrese de que el programa no está leyendo ni escribiendo los datos en cuestión
durante la transferencia.
● Dado el caso, utilice en su lugar la función "Forzar variable" en la tabla de observación o
en el editor de bloques de datos.

Requisitos
● Se utiliza un S7-1200 a partir de V4.1 o un S7-1500 a partir de V1.7.
● Existe una conexión online con la CPU.
● Los bloques de datos cuyos valores actuales desea reinicializar son idénticos offline y
online.

Reinicializar los valores actuales de un bloque abierto
Para reinicializar todos los valores actuales o solo los valores de ajuste de un bloque con
valores de arranque, proceda del siguiente modo:
1. Abra el bloque de datos.
2. Haga clic en el botón "Cargar valores de arranque como valores actuales > Todos los
valores".

Programación del PLC
Manual de programación y manejo, 11/2019

7875

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos
O:
1. Abra el bloque de datos.
2. Haga clic en el botón "Cargar valores de arranque como valores actuales > Solo valores de
ajuste".

Reinicializar los valores actuales de varios bloques
Para reinicializar todos los valores actuales de varios bloques en un solo paso, proceda del
siguiente modo:
1. Seleccione varios bloques o toda la carpeta de bloques en el árbol del proyecto.
2. Elija el comando "Cargar valores de arranque como valores actuales" del menú contextual.

Resultado
Los valores actuales del programa online se reinicializan con los valores de arranque.
El número máximo de variables inicializables depende de la CPU. Si el número de variables es
demasiado elevado se muestra un mensaje. En ese caso, las variables pueden insertarse en
una tabla de observación e inicializarse con la función "Forzar" de dicha tabla.

Consulte también
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)

10.11.6

Crear una instantánea de los valores actuales
Los valores actuales de las variables de uno o más bloques de datos se pueden guardar como
instantánea. Los valores actuales son los valores que las variables adoptan en el momento
actual durante la ejecución del programa en la memoria de trabajo de la CPU.
No se pueden crear instantáneas de bloques que solo se guardan en la memoria de carga y
que no están integrados en el programa.
Para crear una instantánea básicamente existen las siguientes posibilidades:
● Crear una instantánea de un bloque de datos abierto
● Crear una instantánea de varios bloques de datos seleccionados
Al cargar un bloque o un programa desde el dispositivo también se genera automáticamente
una instantánea.

7876

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

PRECAUCIÓN
Generar una instantánea
Los valores de la instantánea pueden proceder de varios ciclos.

Requisitos
● Existe una conexión online con la CPU.
● Los bloques de datos de los que desea crear una instantánea son idénticos offline y online.

Procedimiento
Para crear una instantánea de un bloque de datos abierto, proceda del siguiente modo:
1. Abra el bloque de datos.
2. Haga clic en el botón "Instantánea de los valores actuales".
Para crear una instantánea de varios bloques seleccionados, proceda del siguiente modo:
1. Seleccione los bloques en el árbol del proyecto.
Puede seleccionar los bloques individualmente, o bien seleccionar en el árbol del proyecto
dispositivos, grupos o carpetas que contengan bloques de datos.
2. En el menú contextual, elija el comando "Instantánea de los valores actuales" o elija el
comando de menú "Online > Instantánea de los valores actuales".

Resultado
● Los valores de observación actuales se adoptan en la columna "Instantánea".
● Cuando finaliza el proceso, aparece un mensaje en la ventana de inspección.
● La etiqueta de fecha y hora de la instantánea se indica sobre la tabla de declaración.
Nota
Cambios de estructura en el bloque de datos
Si después de crear una instantánea se modifica la estructura del bloque de datos, es posible
que algunos valores de la instantánea queden invalidados. Si, por ejemplo, se modifica el tipo
de datos de una variable, se invalida el valor de dicha variable. En la columna "Instantánea" no
se indica ningún valor para la variable.

Consulte también
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)

Programación del PLC
Manual de programación y manejo, 11/2019

7877

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

10.11.7

Cargar instantáneas como valores actuales
Las instantáneas del programa offline pueden cargarse en la CPU como valores actuales. Al
hacerlo, los valores de la instantánea se cargan directamente en la memoria de trabajo de la
CPU. Las variables del bloque online se reinicializan y la CPU utiliza los valores nuevos como
valores actuales en el programa online.
Así se pone el proceso controlado rápidamente en un estado definido.
Los siguientes tipos de bloques de datos no pueden reinicializarse con instantáneas:
● bloques de datos que forman parte de un proyecto de referencia
● bloques de datos de seguridad
● bloques de datos creados por la CPU
● bloques de datos con el atributo "Depositar sólo en la memoria de carga"
● bloques de datos que solo están disponibles online
PELIGRO
Peligro por modificación de valores de variables
La modificación de los valores de variables con la instalación en funcionamiento puede
producir incoherencias entre el programa y el proceso real. Como consecuencia pueden
producirse daños materiales y personales graves.
● Asegúrese de que la instalación se encuentra en un estado seguro antes de sobrescribir
los valores actuales.
● Asegúrese de que las instantáneas se creen cuando la instalación se encuentre en un
estado seguro.
● Seleccione variables concretas como valores de ajuste para editar sus valores actuales en
el programa online.
● Asegúrese de que el programa no está leyendo ni escribiendo los datos en cuestión
durante la transferencia.
● Dado el caso, utilice en su lugar la función "Forzar variable" en la tabla de observación o
en el editor de bloques de datos.

Dependencias con el estado operativo de la CPU
Esta función se puede ejecutar tanto en estado operativo "RUN" como en estado operativo
"STOP". La tabla siguiente muestra las reacciones de la CPU en los diferentes estados
operativos:

7878

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

Acción

Reacción del sistema

Sobrescribir valores actua‐ Los valores de todas las variables del DB
les en estado operativo
se sobrescriben mientras se ejecuta el
"RUN"
programa. No se distingue entre valores
remanentes y no remanentes.

Consecuencias para el programa online
La modificación de los valores actuales puede pro‐
vocar incoherencias entre el programa y el proceso
real.
Si el volumen de datos que se quiere transferir es
muy elevado, posiblemente los valores se transferi‐
rán en varios ciclos. Si el programa accede a varia‐
bles antes de que se hayan transferido todos los va‐
lores, existe riesgo de que se creen combinaciones
de valores incoherentes y que se procesen poste‐
riormente.
La copia de los valores de tipos de datos simples
también puede desarrollarse a lo largo de varios ci‐
clos. Estos valores serán potencialmente no válidos
hasta que no se hayan transferido por completo. Si el
programa accede a esos valores antes de que se
hayan transferido por completo, pueden darse esta‐
dos peligrosos.

Sobrescribir valores actua‐ Solo se sobrescriben con la instantánea
les en estado operativo
los valores actuales de las variables re‐
"STOP"
manentes. Las variables no remanentes
se inicializan con sus valores de arran‐
que al pasar de "STOP" a "RUN". Los
valores de la instantánea no se tienen en
cuenta.

Dado que solo se transfieren los datos remanentes
de la instantánea, existe riesgo de que se formen y
procesen combinaciones de valores incoherentes.

Requisitos
● Se utiliza un S7-1200 a partir de V4.1 o un S7-1500 a partir de V1.7.
● Existe una conexión online con la CPU.
● Los bloques de datos cuyos valores actuales desea reinicializar son idénticos offline y
online.
● Se ha creado una instantánea de los bloques de datos.

Reinicializar los valores actuales de un bloque abierto
Para reinicializar todos los valores actuales de un bloque con instantáneas, proceda del
siguiente modo:
1. Abra el bloque de datos.
2. Haga clic en el botón "Cargar instantáneas como valores actuales".

Programación del PLC
Manual de programación y manejo, 11/2019

7879

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

Reinicializar los valores actuales de varios bloques
Para reinicializar los valores actuales de varios bloques en un solo paso, proceda del siguiente
modo:
1. Seleccione varios bloques o toda la carpeta de bloques en el árbol del proyecto.
2. Elija el comando "Cargar instantáneas como valores actuales" del menú contextual.

Resultado
Los valores actuales del programa online se sobrescriben con los valores de la instantánea.
Las variables para las que no existe ninguna instantánea se reinicializan con sus valores de
arranque.

Consulte también
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)

10.11.8

Copiar la instantánea en los valores de arranque
La instantánea se puede copiar en los valores de arranque del programa offline. En la siguiente
transición de "STOP" a "RUN", el programa arrancará con los valores de arranque nuevos.
Se pueden copiar todos los valores de arranque, los valores de arranque de las variables
remanentes o solo los de las variables marcadas como "Valor de ajuste".
Asegúrese de copiar siempre los valores de la instantánea. Aquí no se comprueba si todos los
valores provienen de un mismo ciclo.
Los valores de arranque protegidos contra escritura no se sobrescriben.
Para adoptar los valores, por lo general existen las siguientes posibilidades:
● Aplicar los valores de un bloque de datos abierto
En un bloque de datos abierto es posible aplicar como valores de arranque todos los
valores o bien solo los valores de las variables marcadas como "Valor de ajuste".
● Aplicar los valores de varios bloques en el árbol del proyecto
En el árbol del proyecto se pueden aplicar como valores de arranque todos los valores,
todos los valores de ajuste o todos los valores remanentes.

7880

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

PELIGRO
Peligro por modificación de los valores de arranque
Los valores de arranque modificados se utilizan en la siguiente operación de carga para
inicializar los valores de las variables en el programa online. La modificación de los valores de
variables con la instalación en funcionamiento puede producir incoherencias entre el
programa y el proceso real. Como consecuencia pueden producirse daños materiales y
personales graves.
● Asegúrese de que la instalación se encuentra en un estado seguro antes de sobrescribir
los valores actuales.
● Asegúrese de que las instantáneas se creen cuando la instalación se encuentre en un
estado seguro.
● Seleccione variables concretas como valores de ajuste para editar sus valores actuales en
el programa online.
● Asegúrese de que el programa no está leyendo ni escribiendo los datos en cuestión
durante la transferencia.
● Dado el caso, utilice en su lugar la función "Forzar variable" en la tabla de observación o
en el editor de bloques de datos.

Requisitos
Se ha creado una instantánea para el bloque de datos.

Procedimiento
Para aplicar las instantáneas como valores de arranque en un bloque de datos, proceda del
siguiente modo:
1. Abra un bloque de datos.
2. Haga clic en el botón "Copiar instantáneas como valores de arranque > Todos los valores"
de la barra de herramientas.
O:
1. Abra un bloque de datos.
2. Haga clic en el botón "Copiar instantáneas como valores de arranque > Solo valores de
ajuste" de la barra de herramientas.
Para aplicar los valores de observación de varios bloques de datos en el árbol del proyecto,
proceda del siguiente modo:
1. Marque los bloques en el árbol del proyecto.
2. Elija a continuación uno de los comandos siguientes del menú contextual:
– "Copiar las instantáneas como valores de arranque > Todos los valores"
– "Copiar las instantáneas como valores de arranque > Solo valores de ajuste"
– "Copiar las instantáneas como valores de arranque > Solo valores remanentes"
Programación del PLC
Manual de programación y manejo, 11/2019

7881

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

Resultado
Los valores se incorporan de la columna "Instantánea" a la columna "Valor de arranque". Los
valores de arranque nuevos se guardan en el programa offline.
Nota
Aplicar valores de variables individuales
También es posible transferir valores de variables individuales de la columna "Instantánea" a
la columna "Valores de arranque". Para ello, copie los valores utilizando los comandos
"Copiar" y "Pegar" del menú contextual y péguelos en la columna "Valor de arranque". Tenga
en cuenta que solo se copian los valores que se encuentran en el área visible de la tabla en
estos momentos.

Consulte también
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)

10.11.9

Utilizar valores de ajuste durante la puesta en marcha

10.11.9.1

Principios básicos para adaptar los valores de ajuste durante la puesta en marcha

Introducción
Durante la puesta en marcha de una instalación, a menudo es necesario ajustar valores de
datos para adaptar el programa de forma óptima a las condiciones locales. Con esta finalidad
se pueden utilizar las funciones online y de diagnóstico de la tabla de declaración para bloques
de datos.
Para poder utilizar estas funciones, defina primero determinadas variables como "Valores de
ajuste" en el programa. Los valores de ajuste son valores que requieren un ajuste fino durante
la puesta en marcha.
La tabla siguiente muestra una relación de las funciones para ajustar valores en la puesta en
marcha. En los capítulos siguientes encontrará descripciones detalladas de las diferentes
funciones.
Además se dispone también de las funciones generales para observar y forzar el bloque de
datos:
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)

7882

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

Botón

Función

Descripción

Inicializar los valores de ajuste en es‐
tado operativo "RUN" (Página 7884)

Esta función permite modificar online los valores de variables indivi‐
duales con el fin de determinar rápidamente los valores óptimos.

Aplicar valores del programa online co‐ Si se determinan los valores de variables óptimos, estos pueden adop‐
mo valores de arranque en el progra‐ tarse en el programa offline como valores de arranque. De esta forma,
ma offline (Página 7885)
se garantiza que el programa arranque con valores optimizados des‐
pués de la siguiente carga.

Consulte también
Marcar datos como valores ajustables (Página 7883)

10.11.9.2

Marcar datos como valores ajustables
Determinadas variables pueden marcarse como "Valores de ajuste" en el programa. Los
valores de ajuste son valores que requieren un ajuste fino en la puesta en marcha.

Reglas
En los siguientes tipos de bloque es posible marcar variables como "Valor de ajuste":
● En bloques de función (FB), pero solo en la sección "Static"
● En bloques de datos globales (DB)
● En tipos de datos PLC (UDT)
No obstante, el ajuste solo es efectivo en tipos de datos PLC cuando el UDT se utiliza en
la sección "Static" de un bloque de función o datos.
En los siguientes tipos de bloque no es posible definir valores de ajuste:
● En bloques de datos basados en un tipo de datos PLC y en bloques de datos de instancia.
Estos heredan el ajuste de FB o UDT de orden superior.
● No es posible marcar variables de bloques de datos ARRAY como "Valor de ajuste".
● En el punto de llamada de una multiinstancia tampoco es posible marcar variables como
"Valor de ajuste". Es necesario realizar el ajuste en la interfaz del bloque de función llamado
como multiinstancia.
● En los bloques con protección de know-how no puede modificarse la marca "Valor de
ajuste". Para ello es preciso eliminar primero la protección de know-how.

Requisitos
Están abiertos un bloque de función, un bloque de datos global o un tipo de datos PLC (UDT).

Programación del PLC
Manual de programación y manejo, 11/2019

7883

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

Procedimiento
Para marcar una variable como "Valor de ajuste", proceda del siguiente modo:
1. Seleccione una variable de la sección "Static".
2. Active la casilla de verificación en la columna "Valor de ajuste".
– El elemento superior de una estructura o un tipo de datos PLC no puede definirse como
"Valor de ajuste". Es necesario realizar el ajuste para cada uno de los elementos
subordinados por separado.
– En los ARRAY solo se puede marcar como "Valor de ajuste" el elemento de orden
superior. Los elementos subordinados heredan el ajuste.
– En los ARRAY of STRUCT solo es posible marcar como "Valores de ajuste" los
elementos por debajo de la primera estructura. Los elementos de otras estructuras
heredan el ajuste.

Resultado
Las variables están marcadas como Valores de ajuste. Durante la puesta en marcha, estas
variables pueden inicializarse online. Para ello, no es necesario poner la CPU en el estado
operativo "STOP", sino que puede permanecer en "RUN". Asimismo, los valores de variables
actuales pueden transferirse como valores de arranque al programa offline y guardarse allí.

Consulte también
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)
Funciones online y de diagnóstico para bloques de datos (Página 7869)
Definir valores de arranque (Página 7853)

10.11.9.3

Inicializar valores de ajuste en el programa online

Principios básicos para inicializar valores de ajuste
Todas las variables marcadas como "Valor de ajuste" pueden inicializarse con valores nuevos
en el programa online. Para ello, los valores de arranque del programa offline se cargan en el
programa online. La CPU permanece en el estado operativo "RUN". Todas las variables
marcadas como Valor de ajuste se inicializan una vez en el siguiente punto de control del ciclo.
Esto es válido tanto para variables remanentes como para no remanentes. A continuación se
sigue procesando el programa con los nuevos valores de variables.
El número máximo de variables inicializables depende de la CPU: En las CPU de la serie
S7-300/400 se pueden inicializar como máximo 35 valores de ajuste, mientras que en las CPU
de la serie S7-1200/1500 la cantidad máxima es de 200 valores de ajuste. Sin embargo,
dependiendo de los tipos de datos utilizados, la cantidad máxima será menor.

7884

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos
Si el número de valores de ajuste marcados es demasiado elevado, aparece un mensaje. En
ese caso, las variables pueden insertarse en una tabla de observación e inicializarse con la
función "Forzar" de dicha tabla.
PELIGRO
Peligro por modificación de valores de variables
La modificación de los valores de variables con la instalación en marcha puede causar graves
daños materiales y personales en caso de mal funcionamiento o errores del programa.
Asegúrese de que no pueden darse estados peligrosos antes de reinicializar los valores de
ajuste.

Requisitos
● Existe una conexión online con la CPU.
● La estructura del bloque de datos es idéntica tanto offline como online.
● Una o varias variables están marcadas como "valor de ajuste".

Procedimiento
Para inicializar todos los valores de ajuste del bloque de datos, proceda del siguiente modo:
1. Abra un bloque de datos global o un bloque de datos de instancia.
2. Introduzca los valores deseados en la columna "Valor de arranque". Los valores de
arranque deben corresponderse con el tipo de datos indicado.
3. Haga clic en el botón "Cargar valores de arranque como valores actuales > Solo valores de
ajuste".

Resultado
Los valores de ajuste del programa online se inicializan en el siguiente punto de control del
ciclo con los valores de arranque del programa offline.

Consulte también
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)

10.11.9.4

Aplicar valores del programa online como valores de arranque
Para aplicar valores de variables del programa online como valores de arranque en el
programa offline, genere primero una instantánea de los valores de variables del programa
online. Seguidamente, aplíquelos al programa offline. Asegúrese de copiar siempre los valores
de la instantánea. Aquí no se comprueba si todos los valores provienen de un mismo ciclo.
Los valores de arranque protegidos contra escritura no se sobrescriben.

Programación del PLC
Manual de programación y manejo, 11/2019

7885

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos
Para adoptar los valores, por lo general existen las siguientes posibilidades:
● Aplicar los valores de ajuste de un bloque de datos abierto
● Aplicar los valores de ajuste de varios bloques en el árbol del proyecto

Requisitos
● Existe una conexión online con la CPU.
● Como mínimo un bloque de datos está cargado en la CPU.

Procedimiento
Para aplicar todos los valores de ajuste como valores de arranque en un bloque de datos,
proceda del siguiente modo:
1. Abra el bloque de datos.
2. Inicie la observación haciendo clic en el botón "Observar todos".
En la tabla aparece la columna "Valor de observación". En ella se visualizan los valores de
datos actuales.
3. Haga clic en el botón "Instantánea de los valores actuales" de la barra de herramientas.
Los valores actuales se adoptan en la columna "Instantánea".
4. Haga clic en el botón "Copiar instantáneas como valores de arranque > Solo valores de
ajuste" de la barra de herramientas.
Los valores se incorporan de la columna "Instantánea" a la columna "Valores de arranque".
Para aplicar los valores de observación de varios bloques de datos en el árbol del proyecto,
proceda del siguiente modo:
1. Marque los bloques en el árbol del proyecto.
2. En el menú contextual, elija el comando "Instantánea de los valores actuales".
Los valores actuales de todos los bloques marcados se adoptan en la columna
"Instantánea".
Cuando finaliza el proceso, aparece un mensaje en la ventana de inspección.
3. A continuación elija el comando "Aplicar instantáneas como valores de arranque > Solo
valores de ajuste" del menú contextual.
Los valores se incorporan de la columna "Instantánea" a la columna "Valor de arranque".

7886

Programación del PLC
Manual de programación y manejo, 11/2019

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

Resultado
Los valores de arranque nuevos se guardan en el programa offline.
Nota
Aplicar valores de variables individuales
También es posible transferir de la columna "Instantánea" a la columna "Valores de arranque"
aquellos valores de variables individuales que no se han marcado previamente como Valor de
ajuste. Para ello, copie los valores utilizando los comandos "Copiar" y "Pegar" del menú
contextual y péguelos en la columna "Valor de arranque". Tenga en cuenta que solo se copian
los valores que se encuentran en el área visible de la tabla en estos momentos.

Consulte también
Principios básicos de los valores de arranque (Página 7853)
Definir valores de arranque (Página 7854)
Relación de las funciones online y de diagnóstico en bloques de datos (Página 7871)
Funciones online y de diagnóstico para bloques de datos (Página 7869)

Programación del PLC
Manual de programación y manejo, 11/2019

7887

Programación de bloques de datos
10.11 Funciones online y de diagnóstico para bloques de datos

7888

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.1

11

Sinopsis de las tablas de variables PLC

Introducción
Las tablas de variables PLC contienen la definición de las variables PLC y constantes
simbólicas válidas en toda la CPU. Para toda CPU que se crea en el proyecto se genera
automáticamente una tabla de variables PLC. Además, se pueden crear tablas de variables
propias para ordenar y agrupar las variables y constantes.
En el árbol del proyecto hay una carpeta "Variables PLC" para cada CPU del proyecto. En ella
se encuentran las tablas siguientes:
● Tabla "Todas las variables"
● Tabla de variables estándar
● Opcionalmente: Otras tablas de variables personalizadas

Todas las variables
La tabla "Todas las variables" muestra una vista general de todas las variables PLC,
constantes de usuario y constantes de sistema de la CPU. Esta tabla no puede borrarse ni
moverse.

Tabla de variables estándar
Hay una tabla de variables estándar para cada CPU del proyecto. Ésta no puede borrarse ni
moverse, ni es posible cambiar su nombre. La tabla de variables estándar contiene variables
PLC, constantes de usuario y constantes de sistema. Todas las variables PLC pueden
declararse en la tabla de variables estándar, o se pueden crear otras tablas de variables
personalizadas según necesidad.

Tablas de variables personalizadas
Para cada CPU pueden crearse varias tablas de variables personalizadas para agrupar
variables según las necesidades. A las tablas de variables personalizadas se les puede
cambiar el nombre, pueden reunirse en grupos o borrarse. Las tablas de variables
personalizadas pueden contener variables PLC y constantes de usuario.

Programación del PLC
Manual de programación y manejo, 11/2019

7889

Declaración de variables PLC
11.2 Estructura de la tablas de variables PLC

Consulte también
Estructura de la tablas de variables PLC (Página 7890)
Variables (Página 102)
Principios básicos de las constantes (Página 103)

11.2

Estructura de la tablas de variables PLC

Introducción
Todas las tablas de variables PLC contienen una ficha para variables y otra para constantes
de usuario. La tabla de variables estándar y la tabla "Todas las variables" contienen además
una ficha "Constantes de sistema".

Estructura de la ficha "Variables"
En la ficha "Variables" se declaran las variables PLC globales que se requieren en el programa.
La figura siguiente muestra la estructura de la ficha. El número de columnas visualizadas
puede variar.

En la siguiente tabla se explica el significado de las distintas columnas. El número de columnas
visualizadas puede variar. Las columnas pueden mostrarse u ocultarse según convenga.
Columna

Explicación
Símbolo en el que se puede hacer clic para arrastrar la variable
mediante Drag & Drop hasta un programa y utilizarla allí como ope‐
rando.

Nombre

Nombre de la variable, unívoco en toda la CPU.

Tipo de datos

Tipo de datos de la variable.

Dirección

Dirección de la variable.

Remanencia

Marca la variable como remanente.
Los valores de las variables remanentes se conservan incluso tras
desconectar la alimentación.

7890

Visible en HMI Engineering

Indica si la variable está visible en la selección de operandos de HMI
mediante un ajuste predeterminado.

Accesible desde HMI / OPC UA /
Web API

Indica si HMI / OPC UA / Web API puede acceder a esta variable en
tiempo de ejecución.

Escribible desde HMI / OPC UA /
Web API

Indica si la variable puede escribirse desde HMI / OPC UA / Web API
en tiempo de ejecución.

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.2 Estructura de la tablas de variables PLC
Columna

Explicación

Supervisión

Muestra si para la variable se ha creado una supervisión para el
diagnóstico de proceso.

Valor de observación

Valor de datos actual en la CPU.
Esta columna se visualiza solo si existe una conexión online y se
hace clic en el botón "Observar todo".

Tabla de variables

Muestra en qué tabla de variables se encuentra la declaración de
variables.
Esta columna solo se encuentra en la tabla "Todas las variables".

Comentario

Comentario para documentar la variable.

Estructura de las fichas "Constantes de usuario" y "Constantes de sistema"
En la ficha "Constantes de usuario" se definen las constantes simbólicas válidas en toda la
CPU. En la ficha "Constantes de sistema" se visualizan las constantes que requiere el sistema.
Las constantes de sistema pueden ser, p. ej., identificadores de hardware que sirven para
identificar módulos.
La siguiente figura muestra la estructura de las dos fichas. El número de columnas mostradas
puede variar.

En la siguiente tabla se explica el significado de las distintas columnas. Las columnas pueden
mostrarse u ocultarse según convenga.
Columna

Explicación
Símbolo en el que se puede hacer clic para arrastrar la variable
mediante Drag & Drop hasta un segmento y utilizarla allí como ope‐
rando.

Nombre

Nombre de la constante, unívoco en toda la CPU.

Tipo de datos

Tipo de datos de la constante.

Valor

Valor de la constante.

Tabla de variables

Muestra en qué tabla de variables se encuentra la declaración de
constantes.
Esta columna solo se encuentra en la tabla "Todas las variables".

Comentario

Comentario para documentar la constante.

Consulte también
Tipos de datos de hardware (Página 363)
Variables (Página 102)

Programación del PLC
Manual de programación y manejo, 11/2019

7891

Declaración de variables PLC
11.3 Reglas para variables PLC
Principios básicos de las constantes (Página 103)
Sinopsis de las tablas de variables PLC (Página 7889)
Mostrar y ocultar las columnas de la tabla (Página 7920)

11.3

Reglas para variables PLC

11.3.1

Nombres de variables PLC permitidos

Caracteres permitidos
Para los nombres de las variables PLC rigen las siguientes reglas:
● Se admiten letras, cifras y caracteres especiales.
● No se recomienda utilizar palabras clave reservadas.
● No está permitido utilizar comillas en el nombre de variable.

Nombres de variable unívocos
Los nombres de las variables PLC tienen que ser unívocos en toda la CPU, aunque las
variables se encuentren en tablas de variables diferentes de una CPU. Un nombre ya utilizado
para un bloque, otra variable PLC o una constante en la CPU no se puede utilizar para una
variable PLC nueva. En la verificación de univocidad no se distingue entre mayúsculas y
minúsculas.
Si vuelve a introducir un nombre ya asignado, se añadirá automáticamente un número
correlativo al segundo nombre. Por ejemplo, si introduce por segunda vez el nombre "Motor",
la segunda entrada se transformará en "Motor(1)".

Nombres de tabla unívocos
Los nombres de las tablas de variables PLC también deben ser unívocos en toda la CPU. Al
crear tablas de variables PLC personalizadas se propone automáticamente un nombre
unívoco.
Nota
Encontrará más información sobre los caracteres admisibles en nombres de variables en el
Siemens Industry Online Support, en los artículos siguientes:
¿Cuándo hay que utilizar identificadores u operandos "entre comillas" en STEP 7 (TIA Portal)?
https://support.industry.siemens.com/cs/ww/es/view/10947785 (https://
support.industry.siemens.com/cs/ww/es/view/109477857)

7892

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.3 Reglas para variables PLC

Consulte también
Variables (Página 102)
Palabras clave (Página 95)
Direcciones y tipos de datos admisibles para variables PLC (Página 7893)
Introducir la declaración de variables PLC (Página 7899)

11.3.2

Direcciones y tipos de datos admisibles para variables PLC
Las direcciones de las variables PLC constan de la indicación del área de operandos y la
dirección dentro de ella.
Las direcciones deben ser unívocas en toda la CPU. Si introduce una dirección ya asignada a
una variable diferente, la dirección se destacará en color amarillo en ambas ubicaciones y
aparecerá un aviso de error.

Áreas de operandos
La tabla siguiente muestra las posibles áreas de operandos. Los tipos de datos disponibles
dependen de la CPU utilizada:
Área de operandos

Significado

Tipo de datos Formato

Nemóni‐
cos inter‐
naciona‐
les

Nemóni‐
cos ale‐
manes

I

E

Bit de entrada

BOOL

I

E

Entrada (64
bits)

LWORD,
LINT, ULINT,
LTIME,
LTOD, LDT,
LREAL, tipo
de datos PLC
(solo
S7-1200/150
0)

I x.0

Byte de entra‐ BYTE,
da
CHAR, SINT,
USINT, tipo
de datos PLC
(solo
S7-1200/150
0)

IB x

I x.y

Área de direcciones:
S7-1200

S7-300/400

S7-1500

0.0..1023.7

0.0..65535.7

0.0..32767.7

-

-

0.0..32760.0

0..1023

0..65535

0..32767

E x.y

IB

EB

Programación del PLC
Manual de programación y manejo, 11/2019

E x.0

EB y

7893

Declaración de variables PLC
11.3 Reglas para variables PLC
Área de operandos
Nemóni‐
cos inter‐
naciona‐
les

Nemóni‐
cos ale‐
manes

IW

EW

ID

Q

ED

A

Significado

Tipo de datos Formato

Palabra de
entrada

WORD, INT,
UINT, DATE,
WCHAR,
S5TIME, tipo
de datos PLC
(solo
S7-1200/150
0)

IW x

Palabra doble
de entrada

DWORD,
DINT,
UDINT,
REAL, TIME,
TOD, tipo de
datos PLC
(solo
S7-1200/150
0)

ID x

Bit de salida

BOOL

Área de direcciones:
S7-1200

S7-300/400

S7-1500

0..1022

0..65534

0..32766

0..1020

0..65532

0..32764

0.0..1023.7

0.0..65535.7

0.0..32767.7

-

-

0.0..32760.0

0..1023

0..65535

0..32767

0..1022

0..65534

0..32766

EW y

ED y

Q x.y
A x.y

Q

QB

QW

7894

A

AB

AW

LWORD,
LINT, ULINT,
LTIME,
LTOD, LDT,
LREAL, tipo
de datos PLC
(solo
S7-1200/150
0)

Q x.0

Byte de salida BYTE,
CHAR, SINT,
USINT, tipo
de datos PLC
(solo
S7-1200/150
0)

QB x

Palabra de sa‐ WORD, INT,
lida
UINT, DATE,
WCHAR,
S5TIME, tipo
de datos PLC
(solo
S7-1200/150
0)

QW x

Salida (64
bits)

A x.0

AB y

AW y

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.3 Reglas para variables PLC
Área de operandos
Nemóni‐
cos inter‐
naciona‐
les

Nemóni‐
cos ale‐
manes

QD

AD

Significado

Palabra doble
de salida

Tipo de datos Formato

DWORD,
DINT,
UDINT,
REAL, TIME,
TOD, tipo de
datos PLC
(solo
S7-1200/150
0)

QD x

Área de direcciones:
S7-1200

S7-300/400

S7-1500

0..1020

0..65532

0..32764

AD y

M

M

Bit de marcas

BOOL

M x.y

0.0..8191.7

0.0..65535.7

0.0..16383.7

M

M

Marca (64
bits)

LREAL

M x.0

0.0..8184.0

-

0.0..16376.0

M

M

Marca (64
bits)

LWORD,
LINT, ULINT,
LTIME,
LTOD, LDT

M x.0

-

-

0.0..16376.0

MB

MB

Byte de mar‐
cas

BYTE,
CHAR, SINT,
USINT

MB x

0..8191

0..65535

0..16383

MW

MW

Palabra de
marcas

WORD, INT,
UINT, DATE,
WCHAR,
S5TIME

MW x

0..8190

0..65534

0..16382

MD

MD

Palabra doble
de marcas

DWORD,
DINT,
UDINT,
REAL, TIME,
TOD

MD x

0..8188

0..65532

0..16380

T

T

Función de
tiempo (solo
en
S7-300/400)

Temporiza‐
dores

Tn

-

0..65535

0..2047

C

Z

Función de
contaje (solo
en
S7-300/400)

Contadores

Zn

-

0..65535

0..2047

Programación del PLC
Manual de programación y manejo, 11/2019

Cn

7895

Declaración de variables PLC
11.4 Crear y gestionar tablas de variables PLC

Direcciones
La siguiente tabla muestra las posibles direcciones de las variables:
Tipo de datos Dirección

Ejemplo

BOOL

Las variables del tipo BOOL se direccionan con un número de byte y
un número de bit. Para cada área de operando, la numeración de los
bytes empieza por 0. La numeración de los bits va del 0 al 7.

Q 1.0

BYTE,
CHAR, SINT,
USINT

Las variables del tipo de datos BYTE, CHAR, SINT y USINT se di‐
reccionan con un número de byte.

MB 1

WORD, INT,
UINT, DATE,
WCHAR,
S5TIME

Las variables del tipo de datos WORD, INT, UINT, DATE, S5TIME
constan de dos bytes. Estas se direccionan con el número del byte
más bajo.

IW 1

DWORD,
DINT,
UDINT,
REAL, TIME,
TOD

Las variables del tipo de datos DWORD, DINT, UDINT, REAL, TIME,
TOD constan de cuatro bytes. Estas se direccionan con el número del
byte más bajo.

QD 1

LWORD,
LINT, ULINT,
LTIME,
LTOD, LDT,
LREAL

Las variables del tipo de datos LWORD, LINT, ULINT, LTIME, LTOD, I 1.0
LDT, LREAL se componen de ocho bytes. Se direccionan con el nú‐
mero del byte más bajo en el número de bit 0.

Nemónicos utilizados
Las direcciones que se introducen en la tabla de variables PLC se adaptan automáticamente
a los nemónicos utilizados.

Consulte también
Ajustar los nemónicos (Página 7668)
Variables (Página 102)
Nombres de variables PLC permitidos (Página 7892)
Vista general de los tipos de datos válidos (Página 241)
Introducir la declaración de variables PLC (Página 7899)

11.4

Crear y gestionar tablas de variables PLC

11.4.1

Crear tablas de variables PLC
En una CPU se pueden crear varias tablas de variables PLC personalizadas. Todas las tablas
de variables deben tener un nombre unívoco en toda la CPU.

7896

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.4 Crear y gestionar tablas de variables PLC

Requisitos
La vista del proyecto está abierta.

Procedimiento
Para crear una tabla de variables PLC nueva, proceda del siguiente modo:
1. Abra la carpeta "Variables PLC" en el árbol del proyecto.
2. Haga doble clic en el comando "Agregar nueva tabla de variables".
Se abre el cuadro de diálogo "Agregar nueva tabla de variables".
3. Introduzca un nombre unívoco en toda la CPU para la nueva tabla de variables.
4. Opcionalmente: active la opción "publicado", si la nueva tabla de variables se encuentra en
una Software Unit y quiere permitir el acceso desde otras Software Units.
5. Confirme las entradas con "Aceptar".

Resultado
Se crea una nueva tabla de variables PLC. En esta tabla puede declarar variables y constantes.

Consulte también
Sinopsis de las tablas de variables PLC (Página 7889)
Estructura de la tablas de variables PLC (Página 7890)
Declarar variables PLC (Página 7899)
Declarar constantes globales (Página 7908)
Exportar e importar variables PLC (Página 7920)

11.4.2

Abrir la tabla de variables PLC

Procedimiento
Para abrir la tabla de variables PLC de una CPU, proceda del siguiente modo:
1. En el árbol del proyecto, abra la carpeta "Variables PLC" situada debajo de la CPU.
2. Haga doble clic en la tabla de variables PLC de la carpeta.
3. Seleccione la ficha deseada en la esquina superior derecha.

Resultado
Se abre la tabla de variables PLC perteneciente a la CPU. En ella pueden declararse las
variables y constantes necesarias.

Programación del PLC
Manual de programación y manejo, 11/2019

7897

Declaración de variables PLC
11.4 Crear y gestionar tablas de variables PLC

Consulte también
Sinopsis de las tablas de variables PLC (Página 7889)
Estructura de la tablas de variables PLC (Página 7890)
Declarar variables PLC (Página 7899)
Declarar constantes globales (Página 7908)

11.4.3

Copiar o mover tablas de variables PLC

Copiar tablas de variables PLC
Para copiar tablas de variables PLC, proceda del siguiente modo:
1. Seleccione la tabla de variables PLC que desea copiar.
2. Elija el comando "Copiar" del menú contextual.
3. Sitúe el cursor de inserción en la posición en la que desea insertar la tabla de variables PLC.
La tabla de variables PLC se puede insertar en la misma Software Unit o en una diferente,
o bien fuera de una Software Unit, en la carpeta "Variables PLC" de una CPU.
4. Elija el comando "Pegar" del menú contextual.
– Si inserta la tabla de variables PLC en la misma CPU, la copia se insertará con la
extensión "_<número correlativo>".
– Si inserta la tabla de variables PLC en una CPU diferente y ya existe una tabla de
variables PLC con el mismo nombre, se abrirá el cuadro de diálogo "Pegar". Seleccione
la opción deseada y confírmela con "Aceptar".
También es posible copiar la tabla de variables PLC mediante la función Drag & Drop con la
tecla <Ctrl> pulsada.

Mover tablas de variables PLC
Para mover tablas de variables, proceda del siguiente modo:
1. Seleccione la tabla de variables PLC que desea mover.
2. Arrastre la tabla de variables PLC a la nueva posición.

11.4.4

Agrupar tablas de variables PLC
Las tablas de variables personalizadas de una CPU pueden reunirse en grupos. Sin embargo,
la tabla de variables estándar y la tabla "Todas las variables" no pueden moverse a un grupo.

7898

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.5 Declarar variables PLC

Requisitos
En la carpeta "Variables PLC" de la CPU se encuentran varias tablas de variables
personalizadas.

Procedimiento
Para agrupar varias tablas de variables PLC, proceda del siguiente modo:
1. En el árbol del proyecto, seleccione la carpeta "Variables PLC" situada debajo de la CPU.
2. Elija el comando de menú "Insertar > Grupo".
Se inserta un grupo nuevo con el nombre estándar "Grupo_x".
3. Seleccione el grupo recién insertado en el árbol del proyecto.
4. Elija el comando "Cambiar nombre" del menú contextual.
5. Asígnele al grupo un nombre unívoco en toda la CPU.
6. Arrastre al nuevo grupo con Drag & Drop las tablas que se van a agrupar.

Resultado
Las tablas de variables se reúnen en el nuevo grupo.

Consulte también
Sinopsis de las tablas de variables PLC (Página 7889)
Estructura de la tablas de variables PLC (Página 7890)
Declarar variables PLC (Página 7899)
Declarar constantes globales (Página 7908)

11.5

Declarar variables PLC

11.5.1

Introducir la declaración de variables PLC

11.5.1.1

Declarar variables en la tabla de variables PLC

Requisitos
La ficha "Variables" de una tabla de variables PLC está abierta.

Programación del PLC
Manual de programación y manejo, 11/2019

7899

Declaración de variables PLC
11.5 Declarar variables PLC

Procedimiento
Para definir variables PLC, proceda del siguiente modo:
1. Introduzca un nombre de variable en la columna "Nombre".
2. Introduzca el tipo de datos deseado en la columna "Tipo de datos". Al introducirlo, se
dispone de la función de autocompletar.
Las direcciones que concuerdan con el tipo de datos se completan automáticamente.
3. Opcionalmente: En la columna "Dirección" haga clic en el botón de dirección e introduzca
un identificador del operando, un tipo de operando, una dirección y un número de bit en el
siguiente diálogo.
4. Opcionalmente: Desactive las opciones para HMI y OPC UA.
5. Opcionalmente: Introduzca un comentario en la columna "Comentario".
6. Repita los pasos 1 a 5 para todas las variables necesarias.
Consulte también: Direcciones y tipos de datos admisibles para variables PLC
(Página 7893)

Comprobación de sintaxis
Cada vez que se efectúa una entrada se comprueba la sintaxis automáticamente. Si hay
errores, se destacan en color rojo. No es necesario corregir estos errores inmediatamente,
sino que es posible continuar con la edición y efectuar las correcciones necesarias en un
momento posterior. No obstante, si la declaración de variables contiene errores de sintaxis y
la variable se utiliza en el programa, éste no se puede compilar.

Consulte también
Exportar e importar variables PLC (Página 7920)
Utilizar la función automática de autocompletar (Página 7682)
Nombres de variables PLC permitidos (Página 7892)
Declarar variables PLC en el editor de programación (Página 7900)
Editar tablas de variables PLC (Página 7917)
Estructura de la tablas de variables PLC (Página 7890)

11.5.1.2

Declarar variables PLC en el editor de programación

Requisitos
● El editor de programación está abierto.

7900

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.5 Declarar variables PLC

Procedimiento
Para declarar operandos como variables PLC globales, proceda del siguiente modo:
1. Inserte una instrucción en el programa.
Las cadenas de caracteres "<???>", "<??.?>" o "..." representan comodines de operandos.
2. Reemplace un comodín de operando con el nombre de la variable PLC que se va a crear.
3. Seleccione el nombre de la variable.
Si desea declarar más variables PLC, seleccione los nombres de todas las variables que
desea declarar.
4. Elija el comando "Definir variable" del menú contextual.
Se abre el cuadro de diálogo "Definir variable". Éste muestra una tabla de declaración en
la que ya figura el nombre de la variable.
5. En la columna "Sección", haga clic en el botón de dirección y seleccione una de las
entradas siguientes:
– Global Memory
– Global Input
– Global Output
– Global Timer
– Global Counter
6. Introduzca la dirección, el tipo de datos y el comentario en las respectivas columnas.
Consulte también: Direcciones y tipos de datos admisibles para variables PLC
(Página 7893)
7. Si la CPU contiene varias tablas de variables PLC, se puede especificar en la columna
"Tabla de variables PLC" en qué tabla se debe insertar la variable. Si no se indica nada en
la columna, la nueva variable se insertará en la tabla de variables estándar.
8. Haga clic en el botón "Definir" para finalizar la entrada.

Resultado
La declaración de variables se escribe en la tabla de variables PLC con validez para todos los
bloques de la CPU.

Consulte también
Nombres de variables PLC permitidos (Página 7892)
Declarar variables en la tabla de variables PLC (Página 7899)
Utilizar la función automática de autocompletar (Página 7682)

Programación del PLC
Manual de programación y manejo, 11/2019

7901

Declaración de variables PLC
11.5 Declarar variables PLC

11.5.2

Ajustar la remanencia de variables PLC

11.5.2.1

Comportamiento remanente de variables PLC

Variables PLC remanentes
Toda CPU dispone de un área de memoria cuyo contenido permanece inalterado incluso tras
desconectar la tensión de alimentación. Dicha área se denomina área de memoria remanente.
Para evitar pérdidas de datos en caso de un fallo de alimentación, pueden depositarse
determinadas variables PLC en esta área de memoria. El ajuste de remanencia de las
variables PLC se define en la tabla de variables PLC (S7-1200/S7-1500) o en las propiedades
de la CPU (S7-300/S7-400).
En función de la familia de CPU, el área de memoria remanente puede alojar diferentes tipos
de variables PLC. La tabla siguiente ofrece una vista general de las posibilidades de las
diferentes CPU:
Tipo de CPU

Marcas remanentes

Temporizadores SIMATIC re‐ Contadores SIMATIC rema‐
manentes
nentes

Serie S7-300/400

✓

✓

✓

Serie S7-1200

✓

-

-

Serie S7-1500

✓

✓

✓

Consulte también
Ajustar el comportamiento remanente de variables PLC (Página 7902)
Ajustar el comportamiento remanente de variables PLC (Página 7903)

11.5.2.2

Ajustar el comportamiento remanente de variables PLC

Introducción
Para las familias de CPU S7-1200/S7-1500, cree la remanencia de las variables PLC en la
tabla de variables PLC. Si en la columna "Remanencia" de la tabla de variables PLC aparece
una marca de verificación, significa que se ha ajustado el comportamiento remanente para la
variable en cuestión.

Requisitos
La ficha "Variables" de la tabla de variables PLC está abierta.

7902

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.5 Declarar variables PLC

Procedimiento
Para definir el ancho del área de memoria remanente para variables PLC de una CPU S7-1200/
S7-1500, proceda del siguiente modo:
1. Haga clic en el botón "Remanencia" de la barra de herramientas.
Se abre el cuadro de diálogo "Memoria remanente".
2. Defina el ancho del área de memoria remanente:
– Introduzca el número de bytes de marcas remanentes.
Ejemplo: si indica "2", los bytes de marcas MB 0 y MB 1 serán remanentes.
– Introduzca el número de temporizadores remanentes. Cada temporizador S7 ocupa dos
bytes.
Ejemplo: si indica "2", los temporizadores S7 T 0 y T 1 serán remanentes.
– Introduzca el número de contadores remanentes. Cada contador S7 ocupa dos bytes.
– Ejemplo: si indica "2", los contadores S7 C 0 y C 1 serán remanentes.
3. Haga clic en el botón "Aceptar".

Resultado
Se define el ancho del área de memoria remanente. Todas las variables direccionadas en esta
área de memoria se marcan como remanentes. En la columna "Remanencia" de la tabla de
variables se activa automáticamente una marca de verificación para todas las variables que se
encuentren en el área de memoria remanente.

Consulte también
Comportamiento remanente de variables PLC (Página 7902)

11.5.2.3

Ajustar el comportamiento remanente de variables PLC

Introducción
Para las familias de CPU S7-300/400, cree la remanencia de las variables PLC en los ajustes
de la CPU.

Programación del PLC
Manual de programación y manejo, 11/2019

7903

Declaración de variables PLC
11.6 Agrupar variables PLC en estructuras para entradas y salidas

Procedimiento
Para definir el ancho del área de memoria remanente para variables PLC de una CPU
S7-300/400, proceda del siguiente modo:
1. Seleccione la CPU en el árbol del proyecto.
2. Seleccione el comando de menú "Propiedades".
3. Seleccione el apartado "Remanencia".
– Introduzca el número de bytes de marcas remanentes.
Ejemplo: si indica "2", los bytes de marcas MB 0 y MB 1 serán remanentes.
– Introduzca el número de temporizadores remanentes. Cada temporizador S7 ocupa dos
bytes.
Ejemplo: si indica "2", los temporizadores S7 T 0 y T 1 serán remanentes.
– Introduzca el número de contadores remanentes. Cada contador S7 ocupa dos bytes.
Ejemplo: si indica "2", los contadores S7 C 0 y C 1 serán remanentes.

Resultado
Se define el ancho del área de memoria remanente. Todas las variables que hay en esta área
de memoria se declaran como remanentes.

Consulte también
Comportamiento remanente de variables PLC (Página 7902)

11.6

Agrupar variables PLC en estructuras para entradas y salidas

11.6.1

Información importante sobre variables PLC estructuradas

Uso de variables PLC estructuradas (S7-1200 a partir de V4/S7-1500)
Para que el programa tenga un diseño más claro es posible agrupar varias direcciones de
entrada o de salida en una variable PLC de nivel superior. La variable PLC de nivel superior
representa una estructura que contiene diferentes entradas o salidas relacionadas
lógicamente. Al llamar el bloque se transfiere la variable de nivel superior, con lo que solo se
requiere un parámetro de entrada o salida para todas las entradas o salidas relacionadas.

Modo de funcionamiento
Para crear una variable PLC estructurada se define primero un tipo de datos PLC (UDT). En
él se deben declarar los elementos de datos necesarios y definir sus nombres y tipos de datos.
Seguidamente se cambia a la tabla de variables PLC, donde se crea la variable PLC de nivel
superior. Seleccione su tipo de datos PLC como tipo de datos para la variable. Ahora, el
sistema reserva un número concreto de direcciones de entrada o salida a partir de la dirección

7904

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.6 Agrupar variables PLC en estructuras para entradas y salidas
inicial de la variable de nivel superior. El número de direcciones reservadas depende de la
longitud del tipo de datos PLC.
Si se llama un bloque que requiere las entradas o salidas reservadas para procesar el
programa, hay que transferir la variable de nivel superior como parámetro de bloque.
En el código del programa es posible direccionar las diferentes variables PLC como elementos
de estructura.
En los siguientes capítulos encontrará una descripción detallada de los distintos pasos a
seguir:

Ejemplo de aplicación
Existe la posibilidad de utilizar variables PLC estructuradas para agrupar entradas o salidas de
un módulo de función. La figura siguiente muestra la representación esquemática de un motor.
Para cada una de las tres entradas se ha creado un componente en el tipo de datos PLC
"Datatype_Motor".
Las áreas de memoria de las variables declaradas no deben solaparse. En el ejemplo se ve
que el componente "Speed" es del tipo de datos "Integer", con lo que debe empezar en una
dirección de palabra. Por ese motivo se ha rellenado la primera palabra de entrada con la
variable de relleno "Dummy". De este modo, "Speed" está en la segunda palabra de entrada.

0RWRU
2Q
2II
6SHHG

La figura siguiente muestra la variable PLC de nivel superior "Motor" basada en el tipo de datos
"Datatype_Motor". Mediante la declaración de "Motor" se reservan las direcciones IW0 e IW1
en el módulo de entrada.

La figura siguiente muestra la transferencia de la variable PLC "Motor" como parámetro de
entrada del bloque "Motor_Control".

Programación del PLC
Manual de programación y manejo, 11/2019

7905

Declaración de variables PLC
11.6 Agrupar variables PLC en estructuras para entradas y salidas

En el bloque "Motor_Control" se pueden direccionar los diferentes componentes de la variable.
Direccionamiento

Significado

"Motor"

Direccionamiento de la variable PLC de nivel superior.

"Motor".On

Direccionamiento de un componente de una variable
PLC estructurada.

"Motor".On:P

Direccionamiento de una entrada o salida de periferia (PE o PA).

Reglas para utilizar variables PLC estructuradas
A la hora de crear y utilizar variables PLC estructuradas tenga en cuenta las reglas siguientes:
● Las variables PLC estructuradas pueden utilizarse en las áreas de operandos "entradas" y
"salidas".
● En el área de marcas no se admiten variables PLC estructuradas.
● Desde HMI no es posible direccionar variables PLC estructuradas.
Al crear el tipo de datos PLC que debe utilizarse como base para una variable PLC tenga en
cuenta las reglas siguientes:
● Las áreas de memoria de los diferentes elementos no deben solaparse.
Consulte también: Direcciones y tipos de datos admisibles para variables PLC
(Página 7893)
● No agrupe las entradas y salidas en un tipo de datos PLC, sino genere distintos tipos de
datos PLC para entradas y salidas.
● No agrupe entradas o salidas de diferentes módulos en un tipo de datos PLC, pues no
queda garantizado que las memorias imagen de proceso de los módulos se actualicen de
forma síncrona.
● En los tipos de datos PLC subordinados se admiten todos los tipos de datos a excepción de
"STRING" y "WSTRING".

Consulte también
Crear variables PLC estructuradas (Página 7907)
Direccionar variables globales (Página 109)

7906

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.6 Agrupar variables PLC en estructuras para entradas y salidas

11.6.2

Crear variables PLC estructuradas

Reglas
A la hora de crear variables PLC estructuradas tenga en cuenta las reglas siguientes:
● Utilice tipos de datos PLC separados para las áreas de operandos "entradas" y "salidas".
● En el área de marcas no se admiten variables PLC estructuradas.
● No agrupe entradas o salidas de diferentes módulos en un tipo de datos PLC, pues no
queda garantizado que las memorias imagen de proceso de los módulos se actualicen de
forma síncrona.

Procedimiento
Para crear una variable PLC estructurada, proceda del siguiente modo:
1. Haga doble clic en el comando "Agregar nuevo tipo de datos" de la carpeta "Tipos de datos
PLC" en el árbol del proyecto.
Se crea y se abre una tabla de declaración nueva para la creación de un tipo de datos PLC.
2. Declare todos los componentes necesarios en el tipo de datos PLC. Se admiten tipos de
datos a excepción de "STRING" y "WSTRING".
3. Seleccione el tipo de datos PLC en el árbol del proyecto y elija el comando "Compilar >
Software (solo cambios)" del menú contextual.
El tipo de datos PLC se compila y puede utilizarse a continuación en la tabla de variables
PLC.
El programa debe compilarse de nuevo cuando se realizan cambios en los tipos de datos
PLC existentes. De este modo se actualizan todas las ubicaciones del tipo de datos PLC.
4. Abra una tabla de variables PLC dentro de la misma CPU.
5. Declare una variable nueva o seleccione una existente.
6. Seleccione el tipo de datos PLC en la columna "Tipo de datos" y asígnelo a la variable PLC.
La variable PLC adopta la estructura del tipo de datos PLC. Automáticamente se asigna
una dirección adecuada. Las variables PLC estructuradas empiezan siempre en
direcciones de palabra.
En la tabla se representa solo el elemento de estructura más alto sin sus elementos
subordinados.

Programación del PLC
Manual de programación y manejo, 11/2019

7907

Declaración de variables PLC
11.7 Declarar constantes globales

Nota
Reglas de asignación y valores predeterminados
● Al declarar el tipo de datos PLC tenga en cuenta que las áreas de memoria de las diferentes
variables no deben solaparse. Así, por ejemplo, las variables del tipo de datos "Integer"
deben empezar en un límite de palabra. En caso necesario, inserte "variables de relleno"
para impedir solapamientos.
Consulte también: Direcciones y tipos de datos admisibles para variables PLC
(Página 7893)
● No es posible asignar valores predeterminados a los diferentes componentes. Los valores
introducidos en la columna "Valor predeterminado" no se evalúan. Por este motivo, es
posible que algunas variables de los tipos de datos "DT" y "DTL" contengan valores no
válidos.

Consulte también
Información importante sobre variables PLC estructuradas (Página 7904)
Direccionar variables globales (Página 109)
Declarar variables PLC (Página 7899)

11.7

Declarar constantes globales

11.7.1

Reglas para constantes de usuario globales

Caracteres permitidos
Los nombres de las constantes globales pueden constar de los siguientes caracteres:
● Se admiten letras, cifras y caracteres especiales.
● No se permiten las comillas.

Nombres de constante unívocos
Los nombres de las constantes globales tienen que ser unívocos en toda la CPU, aunque las
constantes se encuentren en tablas de variables diferentes de una CPU. Un nombre ya
utilizado para un bloque, una variable PLC u otra constante en la CPU no se puede utilizar para
una constante nueva. En la verificación de univocidad no se distingue entre mayúsculas y
minúsculas.
Si vuelve a introducir un nombre ya asignado, se añadirá automáticamente un número
correlativo al segundo nombre. Por ejemplo, si introduce por segunda vez el nombre "Motor",
la segunda entrada se transformará en "Motor(1)".

7908

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.7 Declarar constantes globales

Tipos de datos permitidos
Para las constantes se permiten todos los tipos de datos soportados por la CPU, excepto los
tipos de datos estructurados.

Valores permitidos
Se puede elegir, como valor de constante, cualquier valor situado dentro del rango de valores
del tipo de datos indicado. Encontrará indicaciones sobre los rangos de valores en el capítulo
"Tipos de datos".
Consulte también: Vista general de los tipos de datos válidos (Página 241)

Consulte también
Principios básicos de las constantes (Página 103)
Declarar constantes globales (Página 7910)
Constantes (Página 103)

11.7.2

Reglas para constantes de sistema globales

Definición
Las constantes de sistema son constantes globales unívocas en toda la CPU que el sistema
necesita y crea automáticamente. Las constantes de sistema sirven, p. ej., para direccionar e
identificar objetos de hardware.

Reglas
Las constantes de sistema se asignan automáticamente al insertar componentes en la vista de
dispositivos o redes y se introducen en la tabla de variables estándar (ficha "Constantes de
sistema"). Para cada módulo y cada submódulo se crea una constante de sistema. Así, p. ej.,
incluso un contador integrado obtiene una constante de sistema. Las constantes de sistema
están formadas por un nombre simbólico y un identificador de hardware numérico, y no pueden
modificarse.

Nombres de constantes de sistema
Los nombres de las constantes de sistema tienen una estructura jerárquica. Constan de un
máximo de cuatro niveles jerárquicos, cada uno de ellos separado por un signo "∼". De esta
forma, mediante el nombre es posible reconocer la "ruta" del módulo de hardware en cuestión.

Ejemplo
Una constante de sistema con el nombre "Local~PROFINET_interface_1~Port_1"
designa el puerto 1 de la interfaz PROFINET 1 de la CPU local.

Programación del PLC
Manual de programación y manejo, 11/2019

7909

Declaración de variables PLC
11.7 Declarar constantes globales

Consulte también
Instrucciones para convertir direcciones (Página 2943)

11.7.3

Declarar constantes globales

Introducción
Las constantes se declaran en la ficha "Constantes de usuario" de una tabla de variables PLC.
Para declarar una constante es preciso introducir un nombre simbólico, un tipo de datos y un
valor fijo. Se puede elegir, como valor de constante, cualquier valor situado dentro del rango
de valores del tipo de datos indicado. Encontrará indicaciones sobre los rangos de valores en
el capítulo "Tipos de datos".
Consulte también: Vista general de los tipos de datos válidos (Página 241)

Procedimiento
Para declarar constantes, proceda del siguiente modo:
1. Abra una tabla de variables PLC.
2. Abra la ficha "Constantes de usuario".
Se abre la tabla de constantes.
3. Introduzca un nombre de constante en la columna "Nombre".
4. Introduzca el tipo de datos deseado en la columna "Tipo de datos". Al introducirlo, se
dispone de la función de autocompletar.
5. En la columna "Valor", introduzca un valor de constante permitido para el tipo de datos
seleccionado.
6. Si tiene observaciones sobre la constante, introduzca un comentario en la columna
"Comentario". La introducción de un comentario es opcional.
7. Si desea declarar más constantes, ponga el cursor en la fila siguiente y repita los pasos 3
a 6.

Comprobación de sintaxis
Cada vez que se efectúa una entrada se comprueba la sintaxis automáticamente. Si hay
errores, se destacan en color rojo. No es necesario corregir estos errores inmediatamente,
sino que es posible continuar con la edición y efectuar las correcciones necesarias en un
momento posterior. No obstante, si la declaración de variables contiene errores de sintaxis y
la constante se utiliza en el programa, este no se puede compilar.

Consulte también
Abrir la tabla de variables PLC (Página 7897)
Insertar filas en la tabla de variables PLC (Página 7917)

7910

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.8 Editar propiedades
Estructura de la tablas de variables PLC (Página 7890)
Reglas para constantes de usuario globales (Página 7908)
Utilizar la función automática de autocompletar (Página 7682)
Constantes (Página 103)

11.8

Editar propiedades

11.8.1

Editar las propiedades de variables PLC

11.8.1.1

Propiedades de variables PLC

Resumen
La tabla siguiente muestra una vista general de las propiedades de variables PLC. La
representación de las propiedades puede variar en función del tipo de CPU.
Grupo

Propiedad

Descripción

General

Nombre

Nombre unívoco en la CPU.

Tipo de datos

Tipo de datos de la variable.

Dirección

Dirección de la variable.

Remanente

Indica si la variable se encuentra en el área de memoria
remanente.

Comentario

Comentario acerca de la variable.

Fecha de creación

Fecha de creación de la variable (no modificable).

Última modificación

Fecha de modificación de la variable (no modificable).

Historial
Utilización

Visible en HMI Enginee‐ Indica si la variable está visible de forma predeterminada
ring
en la lista desplegable de HMI.
Accesible desde HMI /
OPC UA / Web API

Indica si HMI / OPC UA / Web API puede acceder a esta
variable en tiempo de ejecución.

Escribible desde HMI /
OPC UA / Web API

Indica si la variable puede escribirse desde HMI / OPC
UA / Web API en tiempo de ejecución.

Consulte también
Editar las propiedades de variables PLC (Página 7912)

Programación del PLC
Manual de programación y manejo, 11/2019

7911

Declaración de variables PLC
11.8 Editar propiedades

11.8.1.2

Editar las propiedades de variables PLC

Editar las propiedades en una tabla de variables PLC
Para editar las propiedades de una o más variables, proceda del siguiente modo:
1. En el árbol del proyecto, haga doble clic en la tabla de variables PLC en la que se
encuentran las variables.
Se abre la tabla de variables PLC.
2. Modifique las entradas en las columnas.

Editar las direcciones en el editor de programación
Para editar la dirección de una variable en el editor de programación, proceda del siguiente
modo:
1. Seleccione el nombre de la variable.
2. Elija el comando "Reasignar variable" del menú contextual.
Se abre el cuadro de diálogo "Reasignar variable". En él se visualiza una tabla de
declaración.
3. Introduzca la dirección nueva en la columna "Dirección".
4. Haga clic en el botón "Modificar" para confirmar la entrada.

Editar nombres en el editor de programación
Para editar el nombre de una variable en el editor de programación, proceda del siguiente
modo:
1. Seleccione el nombre de la variable.
2. Elija el comando "Cambiar nombre de la variable" del menú contextual.
Se abre el cuadro de diálogo "Cambiar nombre de la variable". En él se visualiza una tabla
de declaración.
3. Introduzca el nuevo nombre en la columna "Nombre".
4. Haga clic en el botón "Modificar" para confirmar la entrada.

Repercusión en el programa
En caso de modificar el nombre, el tipo de datos o la dirección de una variable, se actualizan
automáticamente todas las ubicaciones de las variables en el programa.

Consulte también
Propiedades de variables PLC (Página 7911)

7912

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.8 Editar propiedades

11.8.2

Editar propiedades de las constantes globales

11.8.2.1

Propiedades de las constantes globales

Vista general
La siguiente tabla proporciona una vista general de las propiedades de las constantes:
Grupo

Propiedad

Descripción

General

Nombre

Nombre unívoco en la tabla

Tipo de datos

Tipo de datos de la constante

Valor

Valor que se ha determinado para la constante.
Este valor debe ser compatible con el tipo de datos indi‐
cado.
Consulte también: Vista general de los tipos de datos vá‐
lidos (Página 241)

Comentario
Historial

11.8.2.2

Comentario acerca de la constante

Fecha de creación

Fecha de creación de la constante (no modificable)

Última modificación

Fecha de modificación de la constante (no modificable)

Editar propiedades de las constantes globales

Editar las propiedades en una tabla de variables PLC
Para editar las propiedades de una o más constantes, proceda del siguiente modo:
1. En el árbol del proyecto, haga doble clic en la tabla de variables PLC en la que se
encuentran las constantes.
Se abre la tabla de variables PLC.
2. Abra la ficha "Constantes de usuario".
3. Modifique las entradas de las columnas "Nombre", "Tipo de datos", "Valor" o "Comentario".

Repercusión en el programa
En caso de modificar el nombre, el tipo de datos o el valor de una constante, se actualizan
automáticamente todas las ubicaciones de las constantes en el programa.

Programación del PLC
Manual de programación y manejo, 11/2019

7913

Declaración de variables PLC
11.8 Editar propiedades

11.8.3

Editar propiedades de tablas de variables PLC

11.8.3.1

Propiedades de tablas de variables PLC

Sinopsis
La tabla siguiente muestra una vista general de las propiedades de las tablas de variables PLC.
Grupo

Propiedad

Descripción

General

Nombre

Nombre unívoco en la CPU.

Acceso

Solo para tablas de variables PLC en Software Units:
Muestra si también se puede acceder a las variables y
constantes de esta taba de variables PLC desde otras
Software Units.

Consulte también
Editar propiedades de tablas de variables PLC (Página 7914)

11.8.3.2

Editar propiedades de tablas de variables PLC

Editar las propiedades de una tabla de variables PLC
Para editar las propiedades de una tabla de variables PLC, proceda del siguiente modo:
1. Seleccione la tabla de variables PLC en el árbol del proyecto.
2. Elija el comando "Propiedades" del menú contextual.
Se abre el cuadro de diálogo "Propiedades".
3. Modifique las propiedades de la tabla de variables PLC.

Consulte también
Propiedades de tablas de variables PLC (Página 7914)

11.8.4

Editar comentarios multilingües en la tabla de variables PLC
Los comentarios de una tabla de variables PLC se pueden editar en todos los idiomas del
proyecto que se han activado en la configuración de idiomas del proyecto. Encontrará más
información sobre la activación de idiomas del proyecto en AUTOHOTSPOT.
Tenga en cuenta que los textos no deben tener más de 32767 caracteres Unicode después de
traducirlos.

7914

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.9 Observar variables PLC

Requisitos
● Se han activado varios idiomas de proyecto.
● Una tabla de variables PLC está abierta y contiene al menos un comentario.
● El bloque no tiene protección de know-how.

Procedimiento
Para editar un comentario en todos los idiomas del proyecto, haga lo siguiente:
1. Haga clic en el comentario cuya traducción desee editar.
Si desea editar al mismo tiempo las traducciones de varios comentarios, seleccione todos
los comentarios deseados.
Los comentarios de un tipo de datos PLC (UDT) no pueden seleccionarse en la tabla de
variables PLC. Estos comentarios solo pueden editarse en el tipo de datos PLC.
2. Abra la ficha "Propiedades" de la ventana de inspección.
3. Abra la ficha subordinada "Textos".
En la ficha "Textos" se muestran los comentarios seleccionados en los idiomas de proyecto
activos y, si están disponibles, las traducciones de los comentarios.
4. Las traducciones se pueden editar directamente en la tabla de la ficha "Textos".
5. Para editar las traducciones con un editor externo, puede exportar los textos mostrados al
formato OOXML con los botones "Exportar/importar textos del proyecto".
Nota
Editar todos los textos del proyecto en la tabla global "Textos del proyecto"
Las traducciones en los distintos idiomas del proyecto también se pueden editar en la tabla
global "Textos del proyecto". La tabla se encuentra en "Idiomas y recursos > Textos del
proyecto" del árbol del proyecto. Contiene todos los textos del proyecto que pueden traducirse.
Encontrará más información sobre la traducción de textos en AUTOHOTSPOT.

11.9

Observar variables PLC

11.9.1

Observar variables PLC
Los valores de datos que adoptan actualmente las variables en la CPU pueden observarse
directamente en la tabla de variables PLC.

Programación del PLC
Manual de programación y manejo, 11/2019

7915

Declaración de variables PLC
11.9 Observar variables PLC

Requisitos
Existe o es posible una conexión online con la CPU.

Procedimiento
Para observar los valores de datos, proceda del siguiente modo:
1. Abra una tabla de variables PLC.
2. Inicie la observación haciendo clic en el botón "Observar todos".
– Si todavía no hay ninguna conexión online con la CPU, se establece.
– La observación se inicia con el ajuste de disparo "Permanente".
– En la tabla aparece la columna adicional "Valor de observación". En ella se visualizan
los valores de datos actuales.
– Si en estos momentos se está forzando permanentemente una variable, se muestra el
símbolo de forzado permanente de variables.
3. Para finalizar la observación, vuelva a hacer clic en el botón "Observar todos".
Nota
Procesamiento de variables PLC mientras se observan variables
Si ya se ha iniciado la observación de variables y se procesa la tabla de variables PLC, p. ej.
agregando variables nuevas, la observación reinicia una vez finalizado el procesamiento.

Nota
Además, existe la posibilidad de copiar las variables PLC en una tabla de observación o de
forzado permanente para observarlas, forzarlas o forzarlas de manera permanente.

Consulte también
Estructura de la tablas de variables PLC (Página 7890)
Introducción al test con la tabla de observación (Página 8573)
Introducción al test con la tabla de forzado permanente (Página 8603)
Copiar entradas de la tabla de variables PLC (Página 7917)

7916

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.10 Editar tablas de variables PLC

11.10

Editar tablas de variables PLC

11.10.1

Insertar filas en la tabla de variables PLC

Procedimiento
Para insertar una fila encima de la fila seleccionada, proceda del siguiente modo:
1. Seleccione la fila sobre la cual desea insertar una fila nueva.
2. Haga clic en el botón "Insertar fila" de la barra de herramientas de la tabla.

Resultado
Se inserta una fila nueva sobre la seleccionada.

11.10.2

Copiar entradas de la tabla de variables PLC
Las variables PLC se pueden copiar dentro de una tabla o en otras tablas.

Procedimiento
Para copiar una variable, proceda del siguiente modo:
1. Seleccione la variable que desea copiar.
También puede seleccionar varias variables simultáneamente manteniendo pulsada la
tecla <Ctrl> y haciendo clic consecutivamente en las variables que desea seleccionar, o
bien en la primera y en la última.
2. Elija el comando "Copiar" del menú contextual.
3. Sitúe el cursor de inserción en la posición en la que desea insertar la variable.
4. Elija el comando "Pegar" del menú contextual.
O bien:
1. Seleccione la variable.
2. Mantenga pulsado el botón izquierdo del ratón.
3. Pulse simultáneamente la tecla <Ctrl>.
4. Arrastre la variable hasta el destino deseado.

Resultado
● La variable se copia en el destino.
● Si ocurre un conflicto de nombres, el nombre de la variable se complementará
automáticamente con un número. Por ejemplo, "Variable" se transformará en "Variable(1)".
● Todas las demás propiedades de la variable se conservan.
Programación del PLC
Manual de programación y manejo, 11/2019

7917

Declaración de variables PLC
11.10 Editar tablas de variables PLC

11.10.3

Borrar entradas de la tabla de variables PLC

Procedimiento
Para borrar variables, proceda del siguiente modo:
1. Seleccione la fila que contiene la variable que desea borrar. También puede seleccionar
varias filas simultáneamente manteniendo pulsada la tecla <Ctrl> y haciendo clic
consecutivamente en las filas que desea seleccionar, o bien en la primera y en la última.
2. Elija el comando "Borrar" del menú contextual.

11.10.4

Ordenar las filas de las tablas de variables PLC
Las filas de las tablas se pueden ordenar de forma alfanumérica por nombre, tipo de datos o
dirección.

Procedimiento
Para ordenar las filas de una tabla, proceda del siguiente modo:
1. Seleccione la columna por la cual desea ordenar.
2. Haga clic en el encabezado de la columna.
La columna se ordena de forma ascendente.
Una flecha hacia arriba indica el sentido de ordenación.
3. Para invertir el sentido de ordenación, haga clic en la flecha.
La columna se ordena de forma descendente. Una flecha hacia abajo indica el sentido de
ordenación.
4. Para restablecer la ordenación original, haga clic por tercera vez en el encabezado de la
columna.

11.10.5

Rellenar celdas automáticamente en la tabla de variables PLC
Es posible transferir el contenido de una o varias celdas de la tabla a las celdas situadas
debajo, rellenando así las celdas consecutivas automáticamente.
Si se rellenan automáticamente las celdas de la columna "Nombre", cada uno de los nombres
se complementará con un número correlativo. Por ejemplo, el nombre "Motor" se transforma
en "Motor_1".
Si se rellenan automáticamente las celdas de la columna "Dirección", las direcciones
aumentarán en función del tipo de datos indicado.

7918

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.10 Editar tablas de variables PLC

Procedimiento
Para rellenar celdas consecutivas automáticamente, proceda del siguiente modo:
1. Seleccione las celdas cuyo contenido desea transferir.
2. Haga clic en el símbolo de rellenar situado en la esquina inferior derecha de la celda.
El puntero del ratón adopta la forma de una cruz con puntas de flecha.
3. Con el botón del ratón pulsado, arrastre el puntero hacia abajo hasta situarlo sobre las
celdas que desea rellenar automáticamente.
4. Suelte el botón del ratón.
Las celdas se rellenan automáticamente. Si ya existen entradas en las celdas que se van
a rellenar automáticamente, aparece un cuadro de diálogo en el que se puede indicar si se
desean sobrescribir las entradas existentes o insertar nuevas filas para las variables
nuevas.

11.10.6

Navegar a la vista de dispositivos
Desde una tabla de variables PLC se puede navegar hasta el editor de dispositivos y redes y
visualizar la entrada o salida configurada en la vista de dispositivos.

Requisitos
● La variable está declarada como entrada o salida en una tabla de variables PLC.
● Hay un módulo de entradas o de salidas configurado en el editor de hardware y redes.

Procedimiento
Para ver una variable PLC en la vista de dispositivos, haga lo siguiente:
1. Seleccione la variable en la tabla de variables PLC.
2. Elija el comando "Ir a vista de dispositivos" del menú contextual.
Se abre el editor de dispositivos y redes y se muestra la entrada o la salida para la que se
declaró la variable.

11.10.7

Navegar hasta las definiciones
Es posible utilizar tipos de datos PLC (UDT) en una tabla de variables PLC. Para ver el punto
de definición del tipo de datos PLC, existe la posibilidad de navegar hasta él.

Procedimiento
Para navegar hasta la definición de un tipo de datos PLC, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en una variable PLC basada en un tipo de datos
PLC.
2. Elija el comando "Ir a definición" del menú contextual.

Programación del PLC
Manual de programación y manejo, 11/2019

7919

Declaración de variables PLC
11.10 Editar tablas de variables PLC

Resultado
Se abrirá la tabla de declaración en la que se definió el tipo de datos PLC y se mostrará el punto
de definición.

11.10.8

Mostrar y ocultar las columnas de la tabla
Las columnas de las tablas pueden mostrase u ocultarse según necesidad.

Procedimiento
Para mostrar u ocultar las columnas de una tabla, proceda del siguiente modo:
1. Haga clic en el encabezado de una columna.
2. Elija el comando "Mostrar/ocultar" del menú contextual.
Aparece una selección de las columnas disponibles.
3. Para mostrar una columna, active la casilla de verificación correspondiente.
4. Para ocultar una columna, desactive la casilla de verificación correspondiente.
5. Para mostrar u ocultar varias columnas, haga clic en "Más" y active o desactive la casilla de
verificación de las columnas en cuestión en el cuadro de diálogo "Mostrar/ocultar".

11.10.9

Exportar e importar variables PLC

11.10.9.1

Principios básicos para exportar e importar variables PLC

Introducción
Existe la posibilidad de exportar tablas de variables PLC para así poderlas editar con
aplicaciones externas. También es posible importar al TIA Portal tablas de variables PLC que
se editaron externamente.
Para la importación y exportación se soportan los formatos siguientes:
● XLSX (Excel)
● XML
● SDF
Durante la exportación se puede indicar qué elementos se desean exportar:
● Variables y/o constantes
● Todos los elementos o solo los elementos que se utilizan realmente en el programa en la
CPU actual.

7920

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.10 Editar tablas de variables PLC

Sobrescribir variables PLC y constantes existentes durante la importación
Durante la importación se sobrescriben las entradas ya existentes cuando tienen el mismo
nombre que las entradas que se importarán.

Conexión con objetos existentes
Cuando en el proyecto existen ya referencias a variables PLC o constantes, dichas referencias
se actualizan automáticamente durante la importación. La actualización se realiza tomando
como base el nombre de las variables PLC y constantes.

Consulte también
Formato del archivo de exportación (*.xlsx) (Página 7921)
Exportación de variables PLC (Página 7923)
Importación de variables PLC (Página 7924)

11.10.9.2

Formato del archivo de exportación (*.xlsx)

Introducción
Al exportar tablas de variables PLC se genera un formato XSLX estandarizado que puede
editarse con editores de tablas externos.
Dicho formato también es el previsto para la importación de tablas.
El archivo de exportación tiene dos hojas:
● El nombre de la primera hoja es "PLCTags".
● El nombre de la segunda hoja es "TagTableProperties".

Formato de la hoja "PLCTags"
Esta hoja puede contener las columnas mostradas. El orden de las columnas puede variar. No
tienen que existir todas las columnas, pero la tabla no debe contener columnas adicionales.
Los valores que faltan se marcan con la indicación <no value> durante la importación.
Los títulos de columnas también tienen un nombre fijo que debe ser en inglés.
La siguiente tabla indica los contenidos previstos en las columnas individuales:
Elemento

Significado

Name

Nombre de la variable

Path

Grupo y nombre de la tabla de variables PLC

Data Type

La notación del tipo de datos se corresponde con
la notación utilizada en la tabla de variables PLC.

Logical Address

La dirección puede estar indicada en nemotécnica
alemana o internacional.

Programación del PLC
Manual de programación y manejo, 11/2019

7921

Declaración de variables PLC
11.10 Editar tablas de variables PLC
Elemento

Significado

Comment

Comentario de libre elección

Hmi Visible

El valor previsto es TRUE o FALSE.

Hmi Accessible

El valor previsto es TRUE o FALSE.

Hmi Writeable

El valor previsto es TRUE o FALSE.

Formato de la hoja "TagTableProperties"
Esta hoja contiene las columnas mostradas. Los títulos de columnas tienen un nombre fijo que
debe ser en inglés.
La siguiente tabla indica los contenidos previstos en las diferentes columnas:
Elemento

Explicación

Path

Grupo y nombre de la tabla de variables PLC

BelongsToUnit

Software Unit en la que se ha creado la variable
PLC.

Accessibility

Estado de publicación de la tabla de variables PLC

Consulte también
Principios básicos para exportar e importar variables PLC (Página 7920)
Exportación de variables PLC (Página 7923)
Importación de variables PLC (Página 7924)

11.10.9.3

Formato del archivo de exportación (*.xml)

Introducción
Al exportar tablas de variables PLC se genera un formato xml estandarizado. Dicho formato
también es el previsto para la importación de archivos xml.

Ejemplo de un archivo de exportación xml
El ejemplo siguiente muestra una tabla de variables PLC exportada con el formato *.xml:

7922

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.10 Editar tablas de variables PLC

11.10.9.4

Formato del archivo de exportación (*.sdf)

Introducción
Al exportar tablas de variables PLC se genera un formato sdf estandarizado. Las columnas
están separadas por coma.
Dicho formato también es el previsto para la importación de archivos sdf.

Ejemplo de un archivo de exportación sdf
El ejemplo siguiente muestra una tabla de variables PLC exportada con el formato *.sdf:

Las entradas se interpretan del modo siguiente:

11.10.9.5

Exportación de variables PLC
Existen las siguientes posibilidades de exportar variables y constantes PLC:
● Exportar los elementos de una sola tabla de variables PLC.
● Exportar todas las variables y constantes PLC de una CPU desde la tabla "Todas las
variables".

Requisitos
Está abierta una sola tabla de variables PLC o la tabla "Todas las variables".

Procedimiento
Para exportar variables PLC y constantes, proceda del siguiente modo:
1. Haga clic en el botón "Exportar" de la tabla de variables PLC.
Se abre el cuadro de diálogo "Exportación".
2. Haga clic en el botón de selección situado en "Ruta del archivo de exportación".
Se abre el cuadro de diálogo "Guardar como".
Programación del PLC
Manual de programación y manejo, 11/2019

7923

Declaración de variables PLC
11.10 Editar tablas de variables PLC
3. Indique el nombre del archivo de exportación y seleccione la ruta en la que se debe
depositar.
4. Seleccione el tipo de archivo *.xlsx, *.sdf o *.xml.
5. Haga clic en el botón "Guardar".
6. Seleccione ahora las opciones de exportación:
– Elija si quiere exportar variables y/o constantes.
– Elija si desea exportar todos los elementos de la tabla o solo aquellos que se utilizan
realmente en el programa en la CPU actual.
7. Haga clic en el botón "Aceptar".

Resultado
Se crea el archivo de exportación. Los errores y las advertencias que se producen durante la
exportación se muestran en la ficha "Información" de la ventana de inspección.

Consulte también
Principios básicos para exportar e importar variables PLC (Página 7920)
Formato del archivo de exportación (*.xlsx) (Página 7921)
Importación de variables PLC (Página 7924)

11.10.9.6

Importación de variables PLC

Requisitos
Está abierta la tabla de variables PLC desde la que se han exportado las variables. Puede ser
una sola tabla de variables PLC o la tabla "Todas las variables".

Procedimiento
Para importar variables PLC, proceda del siguiente modo:
1. Haga clic en el botón "Importar".
Se abre el cuadro de diálogo "Importación".
2. Seleccione el archivo que desea importar.
3. Indique si quiere importar variables y/o constantes.
4. Haga clic en el botón "Aceptar".

Resultado
Las variables del archivo de importación se importan a la tabla de variables PLC abierta. Las
entradas ya existentes se sobrescriben cuando tienen el mismo nombre que las entradas que
se importarán.

7924

Programación del PLC
Manual de programación y manejo, 11/2019

Declaración de variables PLC
11.10 Editar tablas de variables PLC
Cuando en el proyecto existen ya referencias a variables PLC o constantes, dichas referencias
se actualizan automáticamente durante la importación. La actualización se realiza tomando
como base el nombre de las variables PLC y constantes.
Si el archivo de importación contiene información sobre Software Units, pero la CPU no
soporta Software Units, todas las variables PLC se importan a la tabla de variables PLC
abierta. Los datos relacionados con las Software Units se ignoran durante la importación.
Los errores y las advertencias que se producen durante la importación se muestran en el
informe de importación.

Consulte también
Principios básicos para exportar e importar variables PLC (Página 7920)
Formato del archivo de exportación (*.xlsx) (Página 7921)
Exportación de variables PLC (Página 7923)

11.10.9.7

Editar variables PLC individuales con editores externos
Para editar variables PLC de forma individual en editores externos al TIA Portal, se pueden
exportar y volver a importar mediante "Copiar y Pegar". Sin embargo, las variables
estructuradas no se pueden copiar en un editor.

Requisitos
Hay una tabla de variables PLC y un editor externo abiertos.

Procedimiento
Para exportar variables PLC y volverlas a importar individualmente, proceda del siguiente
modo:
1. Seleccione una o más variables PLC.
2. Elija el comando "Copiar" del menú contextual.
3. Cambie al editor externo y pegue la variable copiada.
4. Edite las variables de la forma necesaria.
5. Copie las variables en el editor externo.
6. Cambie nuevamente a la tabla de variables PLC.
7. Elija el comando "Pegar" del menú contextual.

Programación del PLC
Manual de programación y manejo, 11/2019

7925

Declaración de variables PLC
11.10 Editar tablas de variables PLC

Nota
Además existe la posibilidad de exportar o importar las variables PLC como datos masivos.
Consulte también: Exportar e importar variables PLC (Página 7920)

7926

Programación del PLC
Manual de programación y manejo, 11/2019

Declarar tipos de datos PLC (UDT)
12.1

12

Estructura de la tabla de declaración para los tipos de datos PLC

Estructura de la tabla de declaración para los tipos de datos PLC
La siguiente figura muestra la estructura de la tabla de declaración para tipos de datos PLC.

Significado de las columnas
En la siguiente tabla se explica el significado de las distintas columnas. Las columnas pueden
mostrarse u ocultarse según convenga. El número de columnas visualizadas varía en función
de la familia de CPU.
Columna

Significado
Símbolo en el que se puede hacer clic para mover o copiar la variable.

Nombre

Nombre de la variable.

Tipo de datos

Tipo de datos de la variable.

Valor predetermi‐
nado

Valor predeterminado para la variable en la declaración del tipo de datos PLC.
La indicación del valor predeterminado es opcional. Si no se especifica ningún
valor, se utilizará el valor predefinido para el tipo de datos indicado. Por ejemplo,
el valor predefinido para BOOL es "false".

Visible en HMI En‐ Indica si la variable está visible en la lista desplegable de HMI de forma predeter‐
gineering
minada.
Accesible desde
HMI / OPC UA /
Web API

Indica si HMI / OPC UA / Web API puede acceder a esta variable en tiempo de
ejecución.

Escribible desde
HMI / OPC UA /
Web API

Indica si la variable puede escribirse desde HMI / OPC UA / Web API en tiempo de
ejecución.

Valor de ajuste

Los valores de ajuste son valores que requieren un ajuste fino en la puesta en
marcha. Tras la puesta en marcha, los valores de estas variables pueden trans‐
ferirse como valores de arranque al programa offline y guardarse allí.

Comentario

Comentario para documentar la variable.

Programación del PLC
Manual de programación y manejo, 11/2019

7927

Declarar tipos de datos PLC (UDT)
12.2 Tipos de datos PLC en el árbol del proyecto

Consulte también
Crear tipos de datos PLC (Página 7929)
Mostrar y ocultar las columnas de la tabla (Página 7941)
Principios básicos de los tipos de datos PLC (UDT) (Página 283)
Utilizar valores de ajuste durante la puesta en marcha (Página 7882)

12.2

Tipos de datos PLC en el árbol del proyecto

Carpeta "Tipos de datos PLC"
El árbol del proyecto contiene la carpeta "Tipos de datos PLC" en la que se pueden crear y
gestionar los tipos de datos PLC (UDT) siguientes:
● Tipos de datos PLC creados por el usuario
Los tipos de datos PLC que ha creado el usuario se encuentran directamente en la carpeta,
desde la que se pueden abrir, eliminar o renombrar.
● Tipos de datos de sistema
Los tipos de datos PLC generados por el sistema se encuentran en la subcarpeta "Tipos de
datos de sistema". Esta carpeta se crea la primera vez que se crea un bloque de datos
basado en un tipo de datos de sistema o se arrastra al programa una instrucción que utiliza
un tipo de datos de sistema. Si en el programa ya no se utiliza el tipo de datos de sistema,
se elimina automáticamente durante la compilación. La carpeta "Tipos de datos de sistema"
se borra cuando ya no contiene ningún tipo de datos.
Nota
Visibilidad de tipos de datos de sistema en el árbol del proyecto
Tenga en cuenta que no todos los tipos de datos de sistema son visibles en el árbol del
proyecto. Los tipos de datos de sistema internos como, p. ej., "IEC_COUNTER", no se
muestran en la carpeta "Tipos de datos de sistema".

Mover o copiar tipos de datos PLC
Los tipos de datos PLC se pueden mover o copiar entre la carpeta "Tipos de datos de sistema"
y otras carpetas. Deben tenerse en cuenta las reglas siguientes:
● Mover o copiar cualquier tipo de datos PLC a la carpeta "Tipos de datos de sistema":
Los tipos de datos PLC de la carpeta "Tipos de datos de sistema" que no sean necesarios
para la ejecución del programa de usuario se eliminarán en el próximo proceso de
compilación. El resultado puede ser que se borre el tipo de datos PLC que ha desplazado.
● Mover tipos de datos de la carpeta "Tipos de datos de sistema":
Los tipos de datos de sistema se pueden mover de la carpeta "Tipos de datos de sistema"
a la carpeta superior "Tipos de datos PLC", pero no copiar. El sistema no administra los
tipos de datos que no se encuentren en la carpeta "Tipos de datos de sistema". Por
consiguiente, no se borran automáticamente si ya no se utilizan en el programa.

7928

Programación del PLC
Manual de programación y manejo, 11/2019

Declarar tipos de datos PLC (UDT)
12.3 Crear tipos de datos PLC

Consulte también
Principios básicos de los tipos de datos PLC (UDT) (Página 283)
Crear tipos de datos PLC (Página 7929)
Estructura de la tabla de declaración para los tipos de datos PLC (Página 7927)

12.3

Crear tipos de datos PLC

Requisitos
La carpeta "Tipos de datos PLC" del árbol del proyecto está abierta.

Procedimiento
Para crear un tipo de datos PLC, proceda del siguiente modo:
1. Haga doble clic en el comando "Agregar nuevo tipo de datos" de la carpeta "Tipos de datos
PLC".
Para crear un tipo de datos PLC se crea y se abre una tabla de declaración nueva.
2. Seleccione el tipo de datos PLC y elija el comando "Cambiar nombre" del menú contextual.
3. Introduzca un nombre para el tipo de datos PLC.
Se crea el nuevo tipo de datos PLC. Éste se encuentra en la carpeta "Tipos de datos PLC" del
árbol del proyecto.

Comentar un tipo de datos PLC
Para introducir un comentario para un tipo de datos PLC, proceda del siguiente modo:
1. En el árbol del proyecto, haga clic con el botón derecho del ratón en el tipo de datos PLC.
2. Elija el comando "Propiedades" del menú contextual.
Se abre el cuadro de diálogo con las propiedades del tipo de datos PLC.
3. Seleccione la entrada "Información" en la navegación local.
4. Introduzca el comentario en el campo de entrada "Comentario".
5. Confirme la entrada realizada con "Aceptar".

Consulte también
Estructura de la tabla de declaración para los tipos de datos PLC (Página 7927)
Principios básicos de los tipos de datos PLC (UDT) (Página 283)

Programación del PLC
Manual de programación y manejo, 11/2019

7929

Declarar tipos de datos PLC (UDT)
12.5 Borrar tipos de datos PLC

12.4

Copiar o mover tipos de datos PLC

Copiar tipos de datos PLC
Para copiar un tipo de datos PLC, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el tipo de datos PLC que desea copiar.
2. Elija el comando "Copiar" del menú contextual.
3. En el árbol del proyecto, haga clic con el botón derecho del ratón en la carpeta "Tipos de
datos PLC" en la que desea insertar el tipo de datos PLC copiado.
4. Elija el comando "Pegar" del menú contextual.
– Si inserta el tipo de datos PLC en la misma CPU, la copia se insertará con la extensión
"_<número correlativo>".
– Si inserta el tipo de datos PLC en una CPU diferente y ya existe un tipo de datos PLC con
el mismo nombre, se abrirá el cuadro de diálogo "Pegar". Seleccione la opción deseada
y confírmela con "Aceptar".
También es posible copiar el tipo de datos PLC mediante la función de Drag & Drop con la tecla
<Ctrl> pulsada.

Mover tipos de datos PLC
Para mover un tipo de datos PLC, proceda del siguiente modo:
1. Seleccione el tipo de datos PLC que desea mover.
2. Arrastre el tipo de datos PLC hasta la posición nueva mediante Drag & Drop.

12.5

Borrar tipos de datos PLC

Requisitos
El tipo de datos PLC que desea borrar no está abierto.

Procedimiento
Para borrar un tipo de datos PLC, proceda del siguiente modo:
1. Abra la carpeta "Tipos de datos PLC" en el árbol del proyecto.
2. Seleccione el tipo de datos PLC que se desea borrar. También se pueden seleccionar
varios tipos de datos PLC simultáneamente manteniendo pulsada la tecla <Ctrl> y haciendo
clic consecutivamente en los tipos de datos que se desea seleccionar, o bien en el primero
y en el último.
3. Elija el comando "Borrar" del menú contextual.

7930

Programación del PLC
Manual de programación y manejo, 11/2019

Declarar tipos de datos PLC (UDT)
12.6 Renumerar tipos de datos PLC

Nota
Si se borra un tipo de datos PLC, los bloques que lo utilizan se vuelven incoherentes. Estas
incoherencias se marcan en el bloque utilizado con color rojo. Para corregir las incoherencias
es necesario actualizar los bloques.

Consulte también
Actualizar la interfaz del bloque (Página 7834)
Actualizar bloques de datos (Página 7845)
Principios básicos de los tipos de datos PLC (UDT) (Página 283)

12.6

Renumerar tipos de datos PLC
Por motivos de rendimiento, los tipos de datos PLC se procesan internamente con números.
Si se producen conflictos numéricos, se resuelven automáticamente. Sin embargo, esto no es
posible con tipos de datos PLC utilizados por bloques con protección de know-how. Al cambiar
el número del tipo de datos PLC es necesario volver a compilar el bloque, lo que en un bloque
con protección de know-how deriva en la solicitud de la contraseña. Esto se puede eludir
creando un esquema numérico propio para los tipos de datos PLC propios. Utilice para ello
números superiores a 5000.

Procedimiento
Para cambiar el número predeterminado de un tipo de datos PLC, proceda del siguiente modo:
1. Abra la librería del proyecto en la Task Card "Librerías".
2. Arrastre el tipo de datos PLC compilable mediante Drag & Drop a la carpeta "Tipos".
Se abre el cuadro de diálogo "Agregar tipo".
3. Introduzca las propiedades del tipo nuevo.
4. Confirme con "Aceptar".
5. En la librería del proyecto, haga clic con el botón derecho del ratón en el tipo de datos PLC
y elija el comando "Editar tipo" del menú contextual.
6. Confirme la selección de la instancia con "Aceptar".
Se abre la vista de librería.
7. Cierre la vista de librería.
Después del nombre del tipo de datos PLC ahora se indica el estado "En test".
8. Haga clic con el botón derecho del ratón en el tipo de datos PLC y elija el comando
"Propiedades" del menú contextual.
9. Seleccione el grupo "General" en la navegación local.
El número del tipo de datos PLC se puede editar a continuación.
10.Cambie el número del tipo de datos PLC.

Programación del PLC
Manual de programación y manejo, 11/2019

7931

Declarar tipos de datos PLC (UDT)
12.7 Programar la estructura de los tipos de datos PLC
11.Confirme con "Aceptar".
12.En la librería del proyecto, haga clic con el botón derecho del ratón en el tipo de datos PLC
y elija el comando "Validar versión" del menú contextual.
El tipo de datos PLC tiene un número nuevo. El número asignado se conserva aunque se
anule la tipificación del tipo de datos PLC.

12.7

Programar la estructura de los tipos de datos PLC

12.7.1

Declarar variables del tipo de datos simple

Requisitos
Hay un tipo de datos PLC abierto.

Procedimiento
Para declarar una variable, proceda del siguiente modo:
1. Introduzca un nombre de variable en la columna "Nombre".
2. Introduzca el tipo de datos deseado en la columna "Tipo de datos". Al introducirlo, se
dispone de la función de autocompletar.
3. Opcionalmente: Modifique las propiedades de las variables que se visualizan en las otras
columnas.
4. Repita los pasos 1 a 3 para todas las variables que deban declararse.

Consulte también
Editar la tabla de declaración para tipos de datos PLC (Página 7939)

12.7.2

Declarar variables del tipo de datos ARRAY

Requisitos
Hay un tipo de datos PLC abierto.

7932

Programación del PLC
Manual de programación y manejo, 11/2019

Declarar tipos de datos PLC (UDT)
12.7 Programar la estructura de los tipos de datos PLC

Procedimiento
Para declarar una variable del tipo de datos ARRAY, proceda del siguiente modo:
1. Introduzca un nombre de variable en la columna "Nombre".
2. Introduzca el tipo de datos "Array" en la columna "Tipo de datos". Se dispone de la ayuda
de la función de autocompletar.
Se abre el cuadro de diálogo "Array".
3. Indique el tipo de datos de los elementos Array en el campo de entrada "Tipo de datos".
4. A continuación, indique los límites inferior y superior de cada dimensión en el campo
"Límites de matriz".
Ejemplo de un ARRAY unidimensional:
[0..3]
Ejemplo de un ARRAY tridimensional:
[0..3, 0..15, 0..33]
5. Confirme la entrada.
6. Opcionalmente: Modifique las propiedades de las variables que se visualizan en las otras
columnas.
Se crea la variable, pero permanece contraída. Para expandir el ARRAY, haga clic en el
triángulo situado delante de la variable. Tenga en cuenta que los ARRAYs de más de 10000
elementos no pueden expandirse para garantizar una mayor claridad.

Introducir valores predeterminados de elementos ARRAY
Para preseleccionar los valores predeterminados de los distintos elementos de un ARRAY,
proceda del siguiente modo:
1. Haga clic en el triángulo situado delante de la variable del tipo de datos ARRAY.
El ARRAY se expande y cada uno de sus elementos aparece en una fila.
2. Introduzca los valores deseados en la columna "Valor predeterminado".

Comentar ARRAYs
Para introducir un comentario para todo el ARRAY, introdúzcalo en la fila superior de la
declaración ARRAY. El comentario se utiliza como ajuste predeterminado para todos los
elementos ARRAY subordinados.
Para asignar comentarios específicos a los diferentes elementos de un ARRAY, proceda del
siguiente modo:
1. Haga clic en el triángulo situado delante de la variable del tipo de datos ARRAY.
El ARRAY se expande y cada uno de sus elementos aparece en una fila.
2. Introduzca los valores que desee en la columna "Comentario".

Programación del PLC
Manual de programación y manejo, 11/2019

7933

Declarar tipos de datos PLC (UDT)
12.7 Programar la estructura de los tipos de datos PLC

Visualizar los ARRAYs en modo avanzado
En la vista "Modo avanzado", los ARRAYs se muestran expandidos de forma predeterminada.
Para activar el modo avanzado, proceda del siguiente modo:
1. Haga clic en el botón "Modo avanzado" de la barra de herramientas.
Nota
Restricción en la vista "Modo avanzado"
Dependiendo del tamaño de la memoria de trabajo del equipo existen los siguientes límites
máximos para el modo avanzado:
● Memoria de trabajo < 8 GB: Como máximo se visualizan 10.000 líneas.
● Memoria de trabajo >= 8 GB: Como máximo se visualizan 40.000 líneas.

Consulte también
Estructura de la tabla de declaración para los tipos de datos PLC (Página 7927)
ARRAY (Página 293)
Utilizar la función automática de autocompletar (Página 7682)

12.7.3

Declarar variables del tipo de datos STRUCT

Requisitos
Hay un tipo de datos PLC abierto.

Procedimiento
Para declarar una variable del tipo de datos STRUCT, proceda del siguiente modo:
1. Introduzca un nombre de variable en la columna "Nombre".
2. Introduzca "Struct" en la columna "Tipo de datos". Al introducirlo, se dispone de la función
de autocompletar.
Debajo de las nuevas variables se inserta una fila vacía sangrada.
3. Inserte el primer elemento de estructura en la fila vacía.
Debajo del elemento se inserta nuevamente una fila vacía.
4. Seleccione un tipo de datos para el elemento de estructura.
5. Opcionalmente: Modifique las propiedades del elemento de estructura que se visualizan en
las otras columnas.

7934

Programación del PLC
Manual de programación y manejo, 11/2019

Declarar tipos de datos PLC (UDT)
12.7 Programar la estructura de los tipos de datos PLC
6. Repita los pasos 3 a 5 para todos los demás elementos de estructura.
No es necesario finalizar explícitamente la estructura. La estructura termina con el último
elemento introducido.
7. Para insertar una nueva variable después de la estructura, deje una fila vacía al final de la
estructura e introduzca la nueva variable en la segunda fila vacía.

Resultado
Se crea la variable del tipo de datos STRUCT.

Consulte también
Principios básicos de STRUCT (Página 288)
Estructura de la tabla de declaración para los tipos de datos PLC (Página 7927)
Utilizar la función automática de autocompletar (Página 7682)

12.7.4

Declarar variables basadas en otro tipo de datos PLC

Requisitos
● Hay un bloque de datos global abierto.
● En la CPU actual está declarado un tipo de datos PLC.

Procedimiento
Para declarar una variable basada en otro tipo de datos PLC, proceda del siguiente modo:
1. Introduzca un nombre de variable en la columna "Nombre".
2. Introduzca el tipo de datos PLC en la columna "Tipo de datos". Al introducirlo, se dispone
de la función de autocompletar.
La variable se crea.
3. Opcionalmente: Modifique las propiedades de las variables que se visualizan en las otras
columnas de la tabla.
Si en la declaración del tipo de datos PLC ya se han definido valores predeterminados o
comentarios para las variables de un tipo de datos PLC, se mostrarán en gris. Esos valores
se pueden modificar aquí.
Los valores modificados se representan en negro y solo son válidos para el lugar de uso
específico.
Nota
Si modifica o borra tipos de datos PLC utilizados en el bloque de datos, este se volverá
incoherente. Para corregir esta incoherencia es necesario volver a compilar el programa.

Programación del PLC
Manual de programación y manejo, 11/2019

7935

Declarar tipos de datos PLC (UDT)
12.8 Editar propiedades de variables en tipos de datos PLC

Consulte también
Estructura de la tabla de declaración para los tipos de datos PLC (Página 7927)
Utilizar la función automática de autocompletar (Página 7682)

12.8

Editar propiedades de variables en tipos de datos PLC

12.8.1

Propiedades de variables en tipos de datos PLC

Propiedades
La siguiente tabla muestra una vista general de las propiedades de las variables en los tipos
de datos PLC:
Grupo

Propiedad

Descripción

General

Nombre

Nombre de la variable.

Tipo de datos

Tipo de datos de la variable.

Valor predeterminado

Valor que se ha predeterminado para la variable en la
interfaz de un bloque lógico de orden superior o un tipo de
datos PLC.
Los valores que contiene la columna "Valores predeter‐
minados" pueden modificarse sólo en el bloque lógico de
orden superior o en el tipo de datos PLC. En el bloque de
datos, los valores sólo se muestran.

Atributos

7936

Valor de arranque

Irrelevante en los tipos de datos PLC

Comentario

Comentario acerca de la variable.

Remanencia

Irrelevante en los tipos de datos PLC

Programación del PLC
Manual de programación y manejo, 11/2019

Declarar tipos de datos PLC (UDT)
12.8 Editar propiedades de variables en tipos de datos PLC
Grupo

Propiedad

Descripción

Atributos defini‐
dos por el usua‐
rio

CFC_Visible

Visible
Identifica si un parámetro está visible en CFC.

CFC_Configurable

Parametrizable
Identifica si un parámetro es parametrizable en CFC.

CFC_ForTest

Para test
Identifica si un parámetro está registrado para el modo
Test de CFC.

CFC_Interconnectable

Interconectable
Identifica si un parámetro es interconectable en CFC.

CFC_EnableTagRead‐
back

Activar la lectura de variables del PLC

CFC_Enumeration‐
Texts

Textos de enumeraciones

CFC_EngineeringUnit

Unidad de ingeniería

Indica si un parámetro es relevante para la función de
CFC "Leer esquema de PLC".
Asigna un parámetro a una enumeración en CFC.
Asigna un parámetro a una unidad en CFC.

CFC_LowLimit

Límite inferior
Define el valor límite inferior del parámetro en CFC.

CFC_HighLimit

Límite superior
Define el valor límite superior del parámetro en CFC.

Consulte también
Modificar propiedades de variables en tipos de datos PLC (Página 7937)
Estructura de la tabla de declaración para los tipos de datos PLC (Página 7927)

12.8.2

Modificar propiedades de variables en tipos de datos PLC

Editar propiedades generales en la tabla de declaración
Para editar las propiedades generales de una o varias variables, proceda del siguiente modo:
1. Abra el tipo de datos PLC.
2. Modifique las entradas en las columnas.

Editar las propiedades detalladas en la ventana de propiedades
Para editar propiedades detalladas de una variable en particular, proceda del siguiente modo:
1. Seleccione una variable de la tabla.
2. Elija el comando "Propiedades" del menú contextual.
La ventana de inspección muestra las propiedades de las variables en las áreas "General"
y "Atributos".

Programación del PLC
Manual de programación y manejo, 11/2019

7937

Declarar tipos de datos PLC (UDT)
12.8 Editar propiedades de variables en tipos de datos PLC
3. Seleccione el área deseada en la navegación local.
4. Modifique las entradas en los campos de entrada.

Consulte también
Actualizar la interfaz del bloque (Página 7834)
Actualizar bloques de datos (Página 7845)

12.8.3

Editar comentarios multilingües en el tipo de datos PLC
Los comentarios de un tipo de datos PLC se pueden editar en todos los idiomas del proyecto
que se han activado en la configuración de idiomas del proyecto. Encontrará más información
sobre la activación de idiomas del proyecto en AUTOHOTSPOT.
Tenga en cuenta que los textos no deben tener más de 32767 caracteres Unicode después de
traducirlos.

Requisitos
● Se han activado varios idiomas de proyecto.
● El tipo de datos PLC está abierto y contiene al menos un comentario.
● El tipo de datos no tiene protección de know-how.

Procedimiento
Para editar un comentario en todos los idiomas del proyecto, haga lo siguiente:
1. Haga clic en el comentario cuya traducción desee editar.
Si desea editar al mismo tiempo las traducciones de varios comentarios, seleccione todos
los comentarios deseados.
2. Abra la ficha "Propiedades" de la ventana de inspección.
3. Abra la ficha subordinada "Textos".
En la ficha "Textos" se muestran los comentarios seleccionados en los idiomas de proyecto
activos y, si están disponibles, las traducciones de los comentarios.
4. Las traducciones se pueden editar directamente en la tabla de la ficha "Textos".
5. Para editar las traducciones con un editor externo, puede exportar los textos mostrados al
formato OOXML con los botones "Exportar/importar textos del proyecto".

7938

Programación del PLC
Manual de programación y manejo, 11/2019

Declarar tipos de datos PLC (UDT)
12.9 Editar la tabla de declaración para tipos de datos PLC

Nota
Editar todos los textos del proyecto en la tabla global "Textos del proyecto"
Las traducciones en los distintos idiomas del proyecto también se pueden editar en la tabla
global "Textos del proyecto". La tabla se encuentra en "Idiomas y recursos > Textos del
proyecto" del árbol del proyecto. Contiene todos los textos del proyecto que pueden traducirse.
Encontrará más información sobre la traducción de textos en AUTOHOTSPOT.

12.9

Editar la tabla de declaración para tipos de datos PLC

12.9.1

Insertar filas en la tabla

Procedimiento
Para insertar una fila encima de la fila seleccionada, proceda del siguiente modo:
1. Seleccione la fila sobre la cual desea insertar una fila nueva.
2. Haga clic en el botón "Insertar fila" de la barra de herramientas de la tabla.

Resultado
Se inserta una fila nueva sobre la seleccionada.

12.9.2

Agregar filas en la tabla

Procedimiento
Para agregar una fila nueva detrás de la fila seleccionada, proceda del siguiente modo:
1. Seleccione la fila tras la que desea insertar la fila nueva.
2. Haga clic en el botón "Agregar fila" de la barra de herramientas de la tabla.

Resultado
Se inserta una fila nueva y vacía detrás de la fila seleccionada.

Programación del PLC
Manual de programación y manejo, 11/2019

7939

Declarar tipos de datos PLC (UDT)
12.9 Editar la tabla de declaración para tipos de datos PLC

12.9.3

Borrar variables

Procedimiento
Para borrar variables, proceda del siguiente modo:
1. Seleccione la fila que contiene la variable que desea borrar. También puede seleccionar
varias filas simultáneamente manteniendo pulsada la tecla <Ctrl> y haciendo clic
consecutivamente en las filas que desea seleccionar, o bien en la primera y en la última.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Actualizar la interfaz del bloque (Página 7834)
Actualizar bloques de datos (Página 7845)

12.9.4

Rellenar celdas consecutivas automáticamente
Es posible transferir el contenido de una o varias celdas de la tabla a las celdas situadas
debajo, rellenando así las celdas consecutivas automáticamente.
Si se rellenan automáticamente las celdas de la columna "Nombre", cada uno de los nombres
se complementará con un número correlativo. Por ejemplo, el nombre "Motor" se transforma
en "Motor_1".
Es posible definir como área de origen una celda individual o varias celdas, o bien filas
completas.
Si la tabla abierta contiene menos filas de las que deben rellenarse, en primer lugar se deben
insertar más filas vacías.

Requisitos
● La tabla está abierta.
● Se dispone de filas de declaración suficientes.

Procedimiento
Para rellenar celdas consecutivas automáticamente, proceda del siguiente modo:
1. Seleccione las celdas cuyo contenido desea transferir.
2. Haga clic en el símbolo de rellenar situado en la esquina inferior derecha de la celda.
El puntero del ratón adopta la forma de una cruz con puntas de flecha.
3. Con el botón del ratón pulsado, arrastre el puntero hacia abajo hasta situarlo sobre las
celdas que desea rellenar automáticamente.

7940

Programación del PLC
Manual de programación y manejo, 11/2019

Declarar tipos de datos PLC (UDT)
12.9 Editar la tabla de declaración para tipos de datos PLC
4. Suelte el botón del ratón.
Las celdas se rellenan automáticamente.
5. Si ya existen entradas en las celdas que van a rellenarse automáticamente, aparece un
cuadro de diálogo. En este diálogo puede indicarse si se quieren sobrescribir las entradas
existentes o si se quieren insertar nuevas filas para las variables nuevas.

12.9.5

Mostrar y ocultar las columnas de la tabla
Las columnas de las tablas pueden mostrase u ocultarse según necesidad.

Procedimiento
Para mostrar u ocultar las columnas de una tabla, proceda del siguiente modo:
1. Haga clic en el encabezado de una columna.
2. Elija el comando "Mostrar/ocultar" del menú contextual.
Aparece una selección de las columnas disponibles.
3. Para mostrar una columna, active la casilla de verificación correspondiente.
4. Para ocultar una columna, desactive la casilla de verificación correspondiente.
5. Para mostrar u ocultar varias columnas, haga clic en "Más" y active o desactive la casilla de
verificación de las columnas en cuestión en el cuadro de diálogo "Mostrar/ocultar".

Programación del PLC
Manual de programación y manejo, 11/2019

7941

Declarar tipos de datos PLC (UDT)
12.9 Editar la tabla de declaración para tipos de datos PLC

7942

Programación del PLC
Manual de programación y manejo, 11/2019

13

Creación de programas KOP
13.1

Principios básicos de KOP

13.1.1

Lenguaje de programación KOP

Sinopsis del lenguaje de programación KOP (Esquema de contactos)
KOP es un lenguaje de programación gráfico. Su representación es similar a los esquemas de
circuitos.
El programa se mapea en uno o varios segmentos. Un segmento contiene en el margen
izquierdo una barra de alimentación de la que parten los circuitos. Las consultas de las señales
binarias se disponen en los circuitos en forma de contactos. Si los elementos se disponen en
serie en un circuito, se crea una conexión en serie. Si se disponen en ramas paralelas, se crea
una conexión en paralelo. Las funciones complejas se representan mediante cuadros.

Ejemplo de segmentos en KOP
La figura siguiente muestra un segmento KOP con dos contactos normalmente abiertos, un
contacto normalmente cerrado y una bobina:
6HJPHQWR
$UUDQTXH

3DUR

%RELQD

%RELQD

13.1.2

Vista general de los elementos KOP

Elementos KOP
Un programa KOP consta de distintos elementos que pueden conectarse en serie o en paralelo
a la barra de alimentación de un segmento. Es preciso asignar variables a la mayoría de los
elementos del programa.
Desde la barra de alimentación parte por lo menos un circuito. La programación del segmento
comienza en el margen izquierdo del circuito. La barra de alimentación se puede ampliar con
varios circuitos y ramas.
La figura siguiente muestra elementos de un segmento KOP a título de ejemplo:

Programación del PLC
Manual de programación y manejo, 11/2019

7943

Creación de programas KOP
13.1 Principios básicos de KOP











1) Barra de alimentación
2) Circuito
3) Rama
4) Contacto
5) Bobina
6) Cuadro

Barra de alimentación
Todo segmento KOP comprende una barra de alimentación que contiene por lo menos un
circuito. Un segmento se puede ampliar insertando circuitos adicionales. En los distintos
circuitos es posible programar conexiones en paralelo con ayuda de ramas.

Contactos
Los contactos sirven para establecer o deshacer una conexión conductora entre dos
elementos. La corriente fluye de izquierda a derecha. Los contactos permiten consultar el
estado lógico o el valor de un operando y controlar el flujo de corriente en función del resultado.
Los siguientes tipos de contactos están disponibles en un programa KOP:
● Contacto normalmente abierto:
Los contactos normalmente abiertos transmiten la corriente si el estado lógico de un
operando binario indicado es "1".
● Contactos normalmente cerrados:
Los contactos normalmente cerrados transmiten la corriente si el estado lógico de un
operando binario indicado es "0".
● Contactos con función adicional:
Los contactos con función adicional transmiten la corriente si se cumple una condición
determinada. Estos contactos también permiten realizar una función adicional, p. ej. una
evaluación de flancos o una comparación.

7944

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.1 Principios básicos de KOP

Bobinas
Las bobinas permiten controlar operandos binarios. En función del estado lógico del resultado
lógico, las bobinas pueden activar o desactivar un operando binario.
Los siguientes tipos de bobinas están disponibles en un programa KOP:
● Bobinas simples:
Las bobinas simples activan un operando binario cuando fluye corriente hasta la bobina. Un
ejemplo de una bobina simple es la instrucción "Asignación".
● Bobinas con función adicional:
Además de la evaluación del resultado lógico, estas bobinas ofrecen funciones adicionales.
Por ejemplo, las bobinas de evaluación de flancos y control del programa son bobinas con
función adicional.

Cuadros
Los cuadros son elementos KOP con funciones complejas. El cuadro vacío es una excepción
al respecto. Un cuadro vacío es un comodín en el que puede seleccionarse la instrucción
deseada.
Los siguientes tipos de cuadros están disponibles en un programa KOP:
● Cuadros sin mecanismo EN/ENO:
Un cuadro se ejecuta en función del estado lógico de sus entradas. No es posible consultar
el estado de errores de ejecución.
● Cuadros con mecanismo EN/ENO:
Un cuadro se ejecuta únicamente si la entrada de habilitación "EN" tiene el estado lógico
"1". Si el cuadro se ejecuta correctamente, la salida de habilitación "ENO" tendrá el estado
lógico "1". Si ocurren errores durante la ejecución, se desactiva la salida de habilitación
"ENO".
Las llamadas de bloques lógicos también se representan en el segmento como cuadros con
mecanismo EN/ENO.

Consulte también
Reglas para utilizar elementos KOP (Página 7955)
Mecanismo EN/ENO (Página 152)

Programación del PLC
Manual de programación y manejo, 11/2019

7945

Creación de programas KOP
13.2 Configuración de KOP

13.2

Configuración de KOP

13.2.1

Sinopsis de la configuración de KOP

Sinopsis
La tabla siguiente muestra los ajustes que se pueden efectuar:
Grupo

Ajuste

Descripción

Fuente

Tamaño de fuente

Tamaño de fuente en el editor de pro‐
gramación

Vista

Formato

Compacto o ancho
Cambia la distancia vertical entre los
operandos y otros objetos (p. ej. ope‐
randos y contacto). El cambio efectuado
se visualiza sólo tras volver a abrir el
bloque.

Campo de operando

Ancho máximo

Número máximo de caracteres que pue‐
den introducirse horizontalmente en el
campo del operando. Con este ajuste, el
diseño de los segmentos se calcula nue‐
vamente.
Tenga en cuenta que el ancho de las
cajas visualizadas también puede variar
en función de la longitud de los nombres
de los parámetros formales.

Altura máxima

Número máximo de caracteres que pue‐
den introducirse verticalmente en el
campo del operando. Con este ajuste, el
diseño de los segmentos se calcula nue‐
vamente.

Consulte también
Modificar la configuración (Página 7946)

13.2.2

Modificar la configuración

Procedimiento
Para modificar la configuración, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Modifique la configuración.

7946

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.3 Trabajar con segmentos

Resultado
El cambio se aplica sin necesidad de guardarlo explícitamente.

Consulte también
Sinopsis de la configuración de KOP (Página 7946)

13.3

Trabajar con segmentos

13.3.1

Utilizar segmentos

Función
El programa de usuario se crea en el bloque, dentro de segmentos. Para poder programar un
bloque lógico, este debe contener como mínimo un segmento. El programa de usuario también
se puede dividir en varios segmentos para facilitar la claridad.
En los bloques KOP y FUP también existe la posibilidad de insertar segmentos para los
lenguajes de programación textuales SCL y AWL para, posteriormente, utilizar instrucciones
en dichos lenguajes. En función de la CPU utilizada es posible insertar segmentos para los
siguientes lenguajes de programación:
● S7-300/400: segmentos AWL
● S7-1200: segmentos SCL
● S7-1500: segmentos AWL y SCL
El editor de programación siempre se adapta al segmento activo en cada momento. Esto
significa que durante la programación de un segmento SCL, por ejemplo, están disponibles
tanto las instrucciones SCL como las funciones SCL.
Nota
En segmentos SCL dentro de bloques KOP o FUP no es posible utilizar la instrucción "Saltar
(GOTO)".

Mecanismo EN/ENO en bloques programados en distintos lenguajes
El mecanismo EN/ENO se puede emplear también en bloques programados en distintos
lenguajes. Cada lenguaje de programación refleja el estado de error de distinto modo:
● SCL posee una variable "ENO" que almacena el estado de error y que puede consultarse.
El acceso directo a esta variable solo es posible en SCL.
● KOP/FUP/AWL no tienen ninguna variable especial para "ENO". Sin embargo, en AWL se
puede leer el estado de error en el bit BR y en KOP/FUP puede consultarse en la bobina
RET.

Programación del PLC
Manual de programación y manejo, 11/2019

7947

Creación de programas KOP
13.3 Trabajar con segmentos
Para leer el estado de error de todo el bloque se aplican las reglas siguientes:
● El último segmento del bloque es un segmento KOP/FUP:
si no utiliza ninguna bobina RET, el estado de error es "TRUE" de forma estándar.
● El último segmento del bloque es un segmento AWL:
el bit BR determina el estado de error. El bit BR puede ser procesado por el registro BR en
los segmentos AWL.
● El último segmento del bloque es un segmento SCL:
la variable "ENO" determina el estado de error del bloque.

Consulte también
Insertar segmentos (Página 7948)
Insertar título del segmento (Página 7952)
Introducir el comentario del segmento (Página 7953)
Navegar en segmentos (Página 7954)

13.3.2

Insertar segmentos
En un bloque KOP o FUP puede insertarse un segmento del mismo lenguaje de programación
o bien un segmento de un lenguaje de programación textual. Sin embargo, hay que tener en
cuenta que no todos los tipos de CPU son compatibles con todos los lenguajes textuales.

Requisitos
Hay un bloque KOP o FUP abierto.

Insertar un segmento KOP o FUP
Para insertar un segmento nuevo, proceda del siguiente modo:
1. Seleccione el segmento debajo del cual desea insertar un segmento nuevo.
2. Elija el comando "Insertar segmento" del menú contextual.

Insertar un segmento AWL o SCL
Para insertar un segmento nuevo, proceda del siguiente modo:
1. Seleccione el segmento debajo del cual desea insertar un segmento nuevo.
2. Elija el comando "Insertar segmento AWL" o "Insertar segmento SCL" del menú contextual.

Resultado
Se inserta un nuevo segmento vacío en el bloque en el lenguaje de programación
correspondiente.

7948

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.3 Trabajar con segmentos

Consulte también
Utilizar segmentos (Página 7947)
Seleccionar segmentos (Página 7949)
Copiar e insertar segmentos (Página 7950)
Borrar segmentos (Página 7950)
Contraer y expandir segmentos (Página 7951)
Insertar título del segmento (Página 7952)
Introducir el comentario del segmento (Página 7953)
Navegar en segmentos (Página 7954)

13.3.3

Seleccionar segmentos

Requisitos
Existe un segmento.

Seleccionar un segmento
Para seleccionar un segmento, proceda del siguiente modo:
1. Haga clic en la barra de título del segmento que desea seleccionar.

Seleccionar varios segmentos
Para seleccionar varios segmentos individuales, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Ctrl>.
2. Haga clic en todos los segmentos que desea seleccionar.
Para seleccionar varios segmentos consecutivos, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Mayús>.
2. Haga clic en el primer segmento que desea seleccionar.
3. Haga clic en el último segmento que desea seleccionar.
Se seleccionan el primer y último segmento, así como todos los segmentos que se
encuentran entre éstos.

Consulte también
Utilizar segmentos (Página 7947)
Insertar segmentos (Página 7948)
Copiar e insertar segmentos (Página 7950)
Borrar segmentos (Página 7950)

Programación del PLC
Manual de programación y manejo, 11/2019

7949

Creación de programas KOP
13.3 Trabajar con segmentos
Contraer y expandir segmentos (Página 7951)
Insertar título del segmento (Página 7952)
Introducir el comentario del segmento (Página 7953)
Navegar en segmentos (Página 7954)

13.3.4

Copiar e insertar segmentos
Los segmentos copiados pueden insertarse en el mismo bloque o en un bloque diferente. Los
segmentos creados en KOP o FUP también pueden insertarse en los bloques de cada uno de
los lenguajes de programación diferentes.

Requisitos
Existe un segmento.

Procedimiento
Para copiar e insertar un segmento, proceda del siguiente modo:
1. Seleccione el o los segmentos que desea copiar.
2. Elija el comando "Copiar" del menú contextual.
3. Seleccione el segmento debajo del cual desea insertar el segmento copiado.
4. Elija el comando "Pegar" del menú contextual.

Consulte también
Utilizar segmentos (Página 7947)
Insertar segmentos (Página 7948)
Seleccionar segmentos (Página 7949)
Borrar segmentos (Página 7950)
Contraer y expandir segmentos (Página 7951)
Insertar título del segmento (Página 7952)
Introducir el comentario del segmento (Página 7953)
Navegar en segmentos (Página 7954)

13.3.5

Borrar segmentos

Requisitos
Existe un segmento.

7950

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.3 Trabajar con segmentos

Procedimiento
Para borrar un segmento, proceda del siguiente modo:
1. Seleccione el segmento que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Utilizar segmentos (Página 7947)
Insertar segmentos (Página 7948)
Seleccionar segmentos (Página 7949)
Copiar e insertar segmentos (Página 7950)
Contraer y expandir segmentos (Página 7951)
Insertar título del segmento (Página 7952)
Introducir el comentario del segmento (Página 7953)
Navegar en segmentos (Página 7954)

13.3.6

Contraer y expandir segmentos

Requisitos
Existe un segmento.

Expandir y contraer un segmento
Para abrir un segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia la derecha situada en la barra de título del segmento.
Para cerrar un segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia abajo situada en la barra de título del segmento.

Expandir y contraer todos los segmentos
Para expandir o contraer todos los segmentos, proceda del siguiente modo:
1. Haga clic en el botón "Abrir todos los segmentos" o "Cerrar todos los segmentos" de la barra
de herramientas.

Consulte también
Utilizar segmentos (Página 7947)
Insertar segmentos (Página 7948)

Programación del PLC
Manual de programación y manejo, 11/2019

7951

Creación de programas KOP
13.3 Trabajar con segmentos
Seleccionar segmentos (Página 7949)
Copiar e insertar segmentos (Página 7950)
Borrar segmentos (Página 7950)
Insertar título del segmento (Página 7952)
Introducir el comentario del segmento (Página 7953)
Navegar en segmentos (Página 7954)

13.3.7

Insertar título del segmento
El título de segmento es la cabecera de un segmento. La longitud del título del segmento está
limitada a una línea. Puede introducir el título manualmente o definirlo de forma automática. Si
elige el ajuste automático, puede aplicarlo a segmentos individuales o establecer en la
configuración que el título del segmento debe definirse de forma automática.
Para la inserción automática del título del segmento se evalúa el comentario del operando de
una de las siguientes instrucciones del segmento:
● Asignación
● Activar salida
● Desactivar salida
Para ello, se utiliza la instrucción que aparece primero en el segmento.
El título del segmento solo se inserta automáticamente si se cumplen las siguientes
condiciones:
● El segmento todavía no tiene ningún título.
● El operando de la instrucción que se utiliza para el comentario tiene un comentario.
Nota
Al insertar el título del segmento de forma automática, tenga en cuenta las siguientes
limitaciones:
● Si modifica el comentario del operando con posterioridad, el título del segmento no se
actualiza.
● Si cambia el operando de la instrucción, el título del segmento no se actualiza.
● El título del segmento solo se define mediante las instrucciones de escritura citadas antes.
● Si el operando es del tipo de datos Array, se utiliza el comentario del Array y no los
comentarios de los elementos Array.
● No se tienen en cuenta los comentarios de operandos no válidos.

7952

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.3 Trabajar con segmentos

Introducir el título del segmento manualmente
Para introducir un título de segmento, proceda del siguiente modo:
1. Haga clic en la barra de título del segmento.
2. Introduzca el título de segmento.

Definir el título del segmento automáticamente
Para establecer que el título del segmento debe definirse fundamentalmente de forma
automática, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Active la casilla de verificación "Establecer título del segmento automáticamente" en el
grupo "Configuración avanzada".
Desde este momento, los títulos de los segmentos se definirán automáticamente si se
cumplen las condiciones anteriores.
Para definir automáticamente un título de segmento concreto, proceda del siguiente modo:
1. Haga clic en la barra de título de un segmento con el botón derecho del ratón y seleccione
"Segmento <Número del segmento>".
2. Elija el comando "Establecer título del segmento automáticamente" del menú contextual.
El título del segmento seleccionado se define a partir del comentario del operando si se
cumplen las condiciones anteriores.

Consulte también
Utilizar segmentos (Página 7947)
Insertar segmentos (Página 7948)
Seleccionar segmentos (Página 7949)
Copiar e insertar segmentos (Página 7950)
Borrar segmentos (Página 7950)
Contraer y expandir segmentos (Página 7951)
Introducir el comentario del segmento (Página 7953)
Navegar en segmentos (Página 7954)

13.3.8

Introducir el comentario del segmento
Los comentarios de segmentos sirven para documentar el contenido del programa en los
distintos segmentos. Por ejemplo, es posible describir la función del segmento, o bien llamar
la atención sobre peculiaridades.

Programación del PLC
Manual de programación y manejo, 11/2019

7953

Creación de programas KOP
13.3 Trabajar con segmentos

Requisitos
Existe un segmento.

Procedimiento
Para introducir un comentario de segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia la derecha antepuesta al título del segmento.
2. Si el área de comentarios no resulta visible, haga clic en el botón "Activar/desactivar
comentarios de segmento" de la barra de herramientas.
Se abre el área de comentarios.
3. En el área de comentario, haga clic en "Comentario".
El texto "Comentario" aparece seleccionado.
4. Introduzca el comentario del segmento.

Consulte también
Utilizar segmentos (Página 7947)
Insertar segmentos (Página 7948)
Seleccionar segmentos (Página 7949)
Copiar e insertar segmentos (Página 7950)
Borrar segmentos (Página 7950)
Contraer y expandir segmentos (Página 7951)
Insertar título del segmento (Página 7952)
Navegar en segmentos (Página 7954)

13.3.9

Navegar en segmentos
Existe la posibilidad de navegar en un bloque directamente hasta una posición determinada.

Procedimiento
Para navegar en un bloque hasta una posición determinada, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la sección de lógica de la ventana de
programación.
2. Elija el comando "Ir a > Segmento/línea" del menú contextual.
Se abre el cuadro diálogo "Ir a".
3. Introduzca el segmento hasta el que desea navegar.
4. Introduzca el número de la fila del segmento hasta el que desea navegar.
5. Confirme la entrada realizada con "Aceptar".

7954

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP

Resultado
Si es posible, se muestra la fila correspondiente. En caso de que el segmento o la fila deseados
no existan, se visualiza el último segmento existente, o bien, la última fila existente en el
segmento deseado.

Consulte también
Utilizar segmentos (Página 7947)
Insertar segmentos (Página 7948)
Seleccionar segmentos (Página 7949)
Copiar e insertar segmentos (Página 7950)
Borrar segmentos (Página 7950)
Contraer y expandir segmentos (Página 7951)
Insertar título del segmento (Página 7952)
Introducir el comentario del segmento (Página 7953)

13.4

Insertar elementos KOP

13.4.1

Reglas para utilizar elementos KOP

Reglas
Tenga en cuenta las reglas siguientes al insertar elementos KOP:
● Todo segmento KOP se debe finalizar con una bobina o un cuadro. Sin embargo, los
siguientes elementos KOP no se pueden utilizar para finalizar un segmento:
– Cuadros de comparación
– Instrucciones de evaluación de flancos positivos o negativos
● El punto inicial de la rama para una conexión de cuadro debe ser siempre la barra de
alimentación. No obstante, en la rama que precede al cuadro pueden existir operaciones
lógicas u otros cuadros.
● En ramas paralelas con combinaciones previas sólo pueden insertarse contactos. El
contacto para negar el resultado lógico (-|NOT|-) es una excepción. Tanto dicho contacto
como las bobinas y los cuadros se pueden utilizar en ramas paralelas si éstas parten
directamente de la barra de alimentación.
● A los contactos normalmente cerrados y normalmente abiertos no se les puede asignar
constantes, p. ej. con TRUE o FALSE. En cambio, es posible utilizar operandos del tipo de
datos BOOL.
● En un segmento sólo se puede insertar una instrucción de salto.

Programación del PLC
Manual de programación y manejo, 11/2019

7955

Creación de programas KOP
13.4 Insertar elementos KOP
● Sólo se puede insertar una etiqueta por segmento.
● Las instrucciones con evaluación de flancos ascendentes o descendentes no se pueden
colocar en el extremo izquierdo del circuito, ya que requieren una operación lógica previa.

Reglas de posicionamiento para CPU S7-1200/1500
La siguiente tabla muestra las instrucciones que sólo pueden posicionarse al final del
segmento:
Instrucción
Nombre

Operación lógica previa necesa‐
ria

SET_BF

Activar mapa de bits

No

RESET_BF

Desactivar mapa de bits

No

JMP

Saltar si RLO = 1

No

JMPN

Saltar si RLO = 0

Sí

JMP_LIST

Definir lista de saltos

No

SWITCH

Distribuidor de saltos

No

RET

Retroceder

No

Nemónicos

Reglas de posicionamiento para CPU S7-300/400
La siguiente tabla muestra las instrucciones que sólo pueden posicionarse al final del
segmento:
Instrucción

7956

Nemónicos Nombre

Operación lógica previa necesa‐
ria

S

Activar salida

Sí

R

Desactivar salida

Sí

SP

Arrancar temporizador como impulso

Sí

SE

Arrancar temporizador como impulso prolongado

Sí

SD

Arrancar temporizador como retardo a la conexión

Sí

SS

Arrancar temporizador como retardo a la conexión con
memoria

Sí

SF

Arrancar temporizador como retardo a la desconexión Sí

SC

Poner contador al valor inicial

Sí

CU

Contador ascendente

Sí

CD

Contador descendente

Sí

JMP

Saltar si RLO = 1

No

JMPN

Saltar si RLO = 0

Sí

RET

Retroceder

No

OPN

Abrir bloque de datos global

No

OPNI

Abrir bloque de datos de instancia

No

CALL

Llamar bloque

No

SAVE

Guardar RLO en bit BR

No

MCRA

Activar área MCR

No

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP

Nemónicos Nombre

Instrucción

Operación lógica previa necesa‐
ria

MCRD

Desactivar área MCR

No

MCR<

Abrir áreas MCR

No

MCR>

Cerrar áreas MCR

No

Nota
Llamada de bloques con entradas binarias en CPU S7-300/400
La siguiente FAQ describe las particularidades de la llamada de bloques con entradas binarias:
FAQ 13988019: ¿Qué hay que tener en cuenta a la hora de programar llamadas FB/FC
anidadas con entradas binarias? (Página 7957)

Consulte también
Vista general de los elementos KOP (Página 7943)
FAQ 13988019 (https://support.industry.siemens.com/cs/de/de/view/13988019)
Mecanismo EN/ENO (Página 152)

13.4.2

Interconexiones no permitidas en KOP

Circulación de corriente de derecha a izquierda
No se pueden programar ramas que puedan causar un flujo invertido de la corriente.
,

,

,

,

,

,

4

)OXMRGHFRUULHQWHQRSHUPLWLGR
,

,

Cortocircuito
No se pueden programar ramas que causen un cortocircuito.
,

,

,

4

&RUWRFLUFXLWRQRSHUPLWLGR

Programación del PLC
Manual de programación y manejo, 11/2019

7957

Creación de programas KOP
13.4 Insertar elementos KOP

Operaciones lógicas
Para las operaciones lógicas rigen las siguientes normas:
● Sólo las entradas booleanas pueden ir precedidas de una operación lógica.
● Sólo la primera salida booleana se puede combinar mediante una operación lógica.
● Existe sólo un circuito lógico completo por segmento. Los circuitos no interconectados
pueden conectarse.

Consulte también
Reglas para utilizar elementos KOP (Página 7955)

13.4.3

Insertar elementos KOP mediante la Task Card "Instrucciones"

Requisitos
Existe un segmento.

Procedimiento
Para insertar un elemento KOP en un segmento mediante la Task Card "Instrucciones",
proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. Navegue hasta el elemento KOP que desea insertar.
3. Arrastre el elemento hasta la posición deseada del segmento mediante Drag & Drop.
Si el elemento ejerce de bloque de función (FB) internamente en el sistema, se abre el
cuadro de diálogo "Opciones de llamada". Este cuadro de diálogo permite especificar si los
datos del elemento insertado deben guardarse en una instancia individual, en una
multiinstancia o en una instancia de parámetro. Si se selecciona "Instancia individual", el
nuevo bloque de datos de instancia se encuentra, después de crearse, en la carpeta
"Recursos de programa" del árbol del proyecto, bajo "Bloques de programa > Bloques de
sistema". Las multiinstancias se encuentran en la sección "Static" de la interfaz del bloque
y las instancias de parámetro, en la sección "InOut".

7958

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP
O bien:
1. Seleccione la posición del segmento en la que desea insertar el elemento.
2. Abra la Task Card "Instrucciones".
3. Haga doble clic en el elemento que desea insertar.
Si el elemento ejerce de bloque de función (FB) internamente en el sistema, se abre el
cuadro de diálogo "Opciones de llamada". Este cuadro de diálogo permite especificar si los
datos del elemento insertado deben guardarse en una instancia individual, en una
multiinstancia o en una instancia de parámetro. Si se selecciona "Instancia individual", el
nuevo bloque de datos de instancia se encuentra, después de crearse, en la carpeta
"Recursos de programa" del árbol del proyecto, bajo "Bloques de programa > Bloques de
sistema". Las multiinstancias se encuentran en la sección "Static" de la interfaz del bloque
y las instancias de parámetro, en la sección "InOut".

Resultado
El elemento KOP seleccionado se inserta con comodines para los parámetros.

Consulte también
Instancias individuales (Página 62)
Multiinstancias (Página 64)
Instancias de parámetro (Página 67)

13.4.4

Insertar elementos KOP mediante un cuadro vacío

Requisitos
Existe un segmento.

Procedimiento
Para insertar un elemento KOP en un segmento mediante un cuadro vacío, proceda del
siguiente modo:
1. Abra la Task Card "Instrucciones".
2. En la paleta "Instrucciones básicas", navegue hasta "General > Cuadro vacío".
3. Arrastre el elemento "Cuadro vacío" hasta la posición deseada del segmento mediante
Drag & Drop.

Programación del PLC
Manual de programación y manejo, 11/2019

7959

Creación de programas KOP
13.4 Insertar elementos KOP
4. Sitúe el puntero del ratón sobre el triángulo de la esquina superior derecha del cuadro vacío.
Se abre una lista desplegable.
5. Seleccione el elemento KOP deseado de la lista desplegable.
Si el elemento ejerce de bloque de función (FB) internamente en el sistema, se abre el
cuadro de diálogo "Opciones de llamada". Este cuadro de diálogo permite especificar si los
datos del elemento insertado deben guardarse en una instancia individual, en una
multiinstancia o en una instancia de parámetro. Si se selecciona "Instancia individual", el
nuevo bloque de datos de instancia se encuentra, después de crearse, en la carpeta
"Recursos de programa" del árbol del proyecto, bajo "Bloques de programa > Bloques de
sistema". Las multiinstancias se encuentran en la sección "Static" de la interfaz del bloque
y las instancias de parámetro, en la sección "InOut".

Resultado
El cuadro vacío se transforma en el elemento KOP correspondiente. Para los parámetros se
insertan comodines.

Consulte también
Instancias individuales (Página 62)
Multiinstancias (Página 64)
Instancias de parámetro (Página 67)

13.4.5

Seleccionar el tipo de datos de un elemento KOP

13.4.5.1

Seleccionar un tipo de datos

Introducción
Algunas instrucciones pueden ejecutarse con varios tipos de datos diferentes. Si en el
programa se utiliza alguna de estas instrucciones, en la ubicación concreta del programa es
preciso definir un tipo de datos permitido para la instrucción en cuestión. Para algunas
instrucciones es necesario seleccionar los tipos de datos para las entradas y para las salidas
por separado.
Nota
El sistema predetermina el tipo de datos permitido (BOOL) para las variables de la entrada de
habilitación EN y la salida de habilitación ENO. Este tipo de datos no se puede modificar.
Los tipos de datos admisibles para una instrucción se indican en la lista desplegable
correspondiente. Seleccionando una entrada de la lista desplegable se determina el tipo de
datos de la instrucción. Si el tipo de datos de un operando difiere del tipo de datos de la
instrucción y no puede convertirse de forma implícita, el operando se muestra en color rojo y
aparece una ventana desplegable con el mensaje de error correspondiente.

7960

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP

Selección de un tipo de datos de instrucciones matemáticas
Algunas instrucciones matemáticas ofrecen la posibilidad de ajustar automáticamente el tipo
de datos adecuado respecto a los tipos de datos de los operandos. En la lista desplegable para
seleccionar el tipo de datos, dichas instrucciones tienen, además de los tipos de datos
propiamente dichos, la entrada "Auto". Si se selecciona esta entrada y se activa el primer
operando, el tipo de datos del operando se utiliza como tipo de datos para la instrucción. La
entrada de la lista desplegable cambia a "Auto (<tipo de datos>)", p. ej. "Auto (Real)". Si se
activan otros operandos, el tipo de datos de la instrucción, ajustado automáticamente, se
adapta según los criterios siguientes:
● Transfieren variables del mismo tipo de datos al resto de operandos:
El tipo de datos de la instrucción no se modifica.
● Transfieren al resto de operandos variables cuyo tipo de datos es inferior al tipo de datos
de la instrucción:
El tipo de datos de la instrucción no se modifica. Para los operandos del tipo de datos
inferior se realiza, si es necesario, una conversión implícita.
● Transfieren a otro operando una variable cuyo tipo de datos es superior al tipo de datos de
la instrucción:
El tipo de datos de la instrucción cambia al tipo de datos superior. Para los operandos que
difieren del tipo de datos de la instrucción recién ajustado se realiza, si es necesario, una
conversión implícita.
Cualquier modificación del tipo de datos de un operando puede provocar otros cambios en el
tipo de datos de la instrucción. De este modo, es posible que otros operandos también se
conviertan de forma implícita. Los operandos para los que se realiza una conversión implícita
se marcan con un cuadrado gris.
Nota
Tenga en cuenta también la información relativa a la conversión de tipos de datos de su
dispositivo y, particularmente en este caso, las indicaciones en materia de verificación CEI.
Consulte también: Conversión de tipos de datos (Página 506)

Consulte también
Definir el tipo de datos de una instrucción (Página 7961)

13.4.5.2

Definir el tipo de datos de una instrucción

Introducción
Algunas instrucciones pueden ejecutarse con varios tipos de datos diferentes. Si se insertan
este tipo de instrucciones en el programa, es preciso definir el tipo de datos adecuado para
ellas en la ubicación concreta del programa.

Programación del PLC
Manual de programación y manejo, 11/2019

7961

Creación de programas KOP
13.4 Insertar elementos KOP

Definir el tipo de datos mediante la lista desplegable
Para definir el tipo de datos de una instrucción mediante la lista desplegable, proceda del
siguiente modo:
1. Arrastre la instrucción mediante Drag & Drop hasta la posición deseada del programa.
En la lista desplegable de la instrucción insertada se visualiza la entrada "???" (no definida).
2. Haga clic en el triángulo situado en la esquina superior de la lista desplegable.
Ésta se abre y se visualizan los tipos de datos admisibles para la instrucción.
3. Seleccione un tipo de datos de la lista desplegable.
Aparece el tipo de datos seleccionado.
4. Si la instrucción dispone de dos listas desplegables, seleccione el tipo de datos de las
entradas en la lista desplegable izquierda y el de las salidas en la derecha.

Definir el tipo de datos asignando variables
Para definir el tipo de datos de una instrucción asignando variables, proceda del siguiente
modo:
1. Arrastre la instrucción mediante Drag & Drop hasta la posición deseada del programa.
En la lista desplegable de la instrucción insertada se visualiza la entrada "???" (no definida).
2. Introduzca en una entrada o salida una variable válida cuyo tipo de datos deba adoptarse
como tipo de datos de la instrucción.
El tipo de datos de la variable aparece en la lista desplegable.
3. Si deben definirse tipos de datos tanto para las entradas como para las salidas de la
instrucción, indique sendas variables válidas en una entrada y una salida. La variable
indicada en la entrada determina el tipo de datos de las entradas y, la indicada en la salida,
el tipo de datos de las salidas de la instrucción.

Definir automáticamente el tipo de datos de instrucciones matemáticas
Para definir automáticamente el tipo de datos de las instrucciones matemáticas, proceda del
siguiente modo:
1. Arrastre la instrucción matemática mediante Drag & Drop hasta la posición deseada del
programa.
En la lista desplegable de la instrucción insertada se visualiza la entrada "???" (no definida).
2. Seleccione la entrada "Auto" en la lista desplegable.
3. Indique una variable válida en una entrada o salida.
El tipo de datos de la variable se adoptará como tipo de datos de la instrucción. La entrada
de la lista desplegable cambia a "Auto (<tipo de datos>)".
Consulte también: Seleccionar un tipo de datos (Página 7960)

Consulte también
Seleccionar un tipo de datos (Página 7960)

7962

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP

13.4.6

Utilizar Favoritos en KOP

13.4.6.1

Agregar elementos KOP a los favoritos

Requisitos
● Hay un bloque abierto.
● La Task Card "Instrucciones" tiene configurado el modo multipaleta, o bien los Favoritos se
muestran también en el editor.

Procedimiento
Para agregar instrucciones a los Favoritos, proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. Maximice la paleta "Instrucciones básicas".
3. En la paleta "Instrucciones básicas", navegue hasta la instrucción que desea agregar a los
Favoritos.
4. Arrastre la instrucción hasta la paleta "Favoritos" o hasta el área de Favoritos del editor de
programación mediante Drag & Drop.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Quitar elementos KOP de los favoritos (Página 7964)
Sinopsis del editor de programación (Página 7657)

13.4.6.2

Insertar elementos KOP mediante Favoritos

Requisitos
● Hay un bloque abierto.
● Existen Favoritos.

Programación del PLC
Manual de programación y manejo, 11/2019

7963

Creación de programas KOP
13.4 Insertar elementos KOP

Procedimiento
Para insertar una instrucción en un programa desde los Favoritos, proceda del siguiente modo:
1. Arrastre la instrucción deseada mediante Drag & Drop desde los Favoritos hasta la posición
deseada.
O bien:
1. Marque el punto del programa en el que quiere insertar la instrucción.
2. En los Favoritos, haga clic en la instrucción que desea insertar.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Quitar elementos KOP de los favoritos (Página 7964)
Sinopsis del editor de programación (Página 7657)

13.4.6.3

Quitar elementos KOP de los favoritos

Requisitos
Hay un bloque lógico abierto.

Procedimiento
Para eliminar instrucciones de los Favoritos, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la instrucción que desea eliminar.
2. Elija el comando "Eliminar instrucción" del menú contextual.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Agregar elementos KOP a los favoritos (Página 7963)
Insertar elementos KOP mediante Favoritos (Página 7963)
Sinopsis del editor de programación (Página 7657)

7964

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP

13.4.7

Insertar llamadas de bloque en KOP

13.4.7.1

Insertar llamadas de bloque mediante Drag & Drop
Las llamadas de funciones (FC) y bloques de función (FB) existentes pueden insertarse desde
el árbol del proyecto mediante Drag & Drop. Al llamar bloques de función desde otros bloques
de función, es posible hacerlo como instancia individual, multiinstancia o instancia de
parámetro.
Consulte también: Principios básicos de las instancias (Página 61)

Requisitos
● Existe un segmento.
● El bloque que se debe llamar existe.

Insertar una llamada de una función (FC)
Para insertar una llamada de una función (FC) mediante Drag & Drop en un segmento, proceda
del siguiente modo:
1. Arrastre la función desde el árbol del proyecto hasta el segmento deseado.

Insertar una llamada de un bloque de función (FB)
Para insertar una llamada de un bloque de función (FB), proceda del siguiente modo:
1. Arrastre el bloque de función desde el árbol del proyecto hasta el segmento deseado.
Se abre el cuadro de diálogo "Opciones de llamada".
2. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Si hace clic en el botón "Instancia individual", introduzca seguidamente un nombre en el
campo de entrada "Nombre" para el bloque de datos que se debe asignar al bloque de
función.
Si se llama un bloque que contenga supervisiones, asigne un bloque de función ProDiag
a dichas supervisiones en el campo de entrada "FB ProDiag".
– Si hace clic en el botón "Multiinstancia", introduzca seguidamente en el campo de
entrada "Nombre de la interfaz" el nombre de la variable con el que el bloque de función
llamado se debe introducir como variable estática en la interfaz del bloque que efectúa
la llamada.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.
3. Confirme las entradas con "Aceptar".

Programación del PLC
Manual de programación y manejo, 11/2019

7965

Creación de programas KOP
13.4 Insertar elementos KOP

Resultado
La función o el bloque de función se inserta con sus respectivos parámetros. Los valores de
estos parámetros pueden asignarse más tarde.
Consulte también: Transferencia de parámetros en la llamada de un bloque (Página 80)
Nota
Si al llamar un bloque de función especifica un bloque de datos de instancia que no existe aún,
éste se creará.

Consulte también
Actualizar llamadas de bloque en KOP (Página 7966)
Cambiar el tipo de instancia (Página 7969)
Instancias individuales (Página 62)
Multiinstancias (Página 64)
Llamadas de bloque (Página 59)

13.4.7.2

Actualizar llamadas de bloque en KOP
Si cambian los parámetros de interfaz de un bloque llamado, la llamada no podrá ejecutarse
correctamente. Actualice las llamadas de bloque con objeto de evitar llamadas incoherentes.

7966

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP
Las llamadas de bloque se pueden actualizar de distinta manera:
● Actualización explícita de todas las llamadas de bloque incoherentes en el editor de
programación.
Se actualizan las llamadas de bloque incoherentes del bloque abierto. Para ello se llevan
a cabo las acciones siguientes:
– Se agregan parámetros nuevos.
– Se eliminan parámetros borrados si no están conectados.
– Los parámetros a los que se ha cambiado el nombre adoptan el nombre nuevo.
● Actualización explícita de una llamada de bloque en el editor de programación.
Se muestra el cuadro de diálogo "Sincronización de interfaces". En este cuadro de diálogo
existe la posibilidad de cambiar la conexión de los operandos de la nueva interfaz.
Seguidamente se actualiza la llamada incoherente de este bloque. Para ello se llevan a
cabo las acciones siguientes:
– Se agregan parámetros nuevos.
– Se eliminan parámetros borrados si no están conectados.
– Los parámetros a los que se ha cambiado el nombre adoptan el nombre nuevo.
● Actualización implícita durante la compilación.
Se actualizan todas las llamadas de bloque en el programa, así como los tipos de datos
PLC utilizados. Tenga en cuenta que si se llaman funciones (FC) antes del siguiente
proceso de compilación deberán asignarse parámetros actuales a todos los parámetros
formales nuevos.

Actualizar todas las llamadas de bloque incoherentes en el editor de programación
Para actualizar todas las llamadas de bloque en un bloque, proceda del siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic en el botón "Actualizar llamadas de bloque incoherentes" de la barra de
herramientas.

Actualizar una llamada de bloque determinada en el editor de programación
Para actualizar una llamada de bloque determinada en el editor de programación, proceda del
siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic con el botón derecho del ratón en la llamada de bloque que desea actualizar.
3. Elija el comando "Actualizar" del menú contextual.
Se abre el cuadro de diálogo "Sincronización de la interfaz". En él se visualizan las
diferencias entre la interfaz utilizada y la interfaz modificada del bloque llamado.

Programación del PLC
Manual de programación y manejo, 11/2019

7967

Creación de programas KOP
13.4 Insertar elementos KOP
4. De ser necesario modifique la conexión de los operandos. Para ello existen las
posibilidades siguientes:
– Es posible pasar un operando de la interfaz antigua a la nueva bien con la función
Drag&Drop bien con la función de cortar o copiar y pegar.
– Es posible borrar un operando.
– Es posible cambiar el nombre de un operando.
– Es posible indicar un operando nuevo mediante la función de autocompletar.
5. Haga clic en "Aceptar" para actualizar la llamada de bloque. Si desea cancelar la
actualización, haga clic en "Cancelar".
Nota
Tenga en cuenta que el comando "Actualizar llamada de bloque" no estará disponible si
previamente ha actualizado todas las llamadas de bloque en el editor con el comando
"Actualizar llamadas de bloque incoherentes".

Actualizar llamadas de bloque durante la compilación
Para actualizar implícitamente todas las llamadas de bloque y usos de tipos de datos PLC
durante la compilación, proceda del siguiente modo:
1. Abra el árbol del proyecto.
2. Seleccione la carpeta "Bloques de programa".
3. En el menú contextual, elija el comando "Compilar > Software (compilar todos los bloques)".

Consulte también
Insertar llamadas de bloque mediante Drag & Drop (Página 7965)
Cambiar el tipo de instancia (Página 7969)
Llamadas de bloque (Página 59)

13.4.7.3

Modificar una llamada de bloque
En una llamada de bloque se puede modificar el bloque llamado. No obstante, recuerde que
al hacerlo no se generan nuevos bloques de datos de instancia, p. ej. al cambiar de una función
(FC) a un bloque de función (FB).

7968

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP

Procedimiento
Para cambiar el bloque llamado en una llamada de bloque, proceda del siguiente modo:
1. Dentro de la llamada del bloque, haga clic en el nombre del bloque llamado y pulse la tecla
<F2>. O haga doble clic en el nombre del bloque llamado.
Se abre un campo de entrada y el nombre del bloque llamado actualmente aparece
seleccionado.
2. Introduzca el nombre del bloque que desea llamar o seleccione un bloque con la función de
autocompletar.
3. Para llamar un FB, cree, dado el caso, un bloque de datos de instancia nuevo e indíquelo
como operando.

13.4.7.4

Cambiar el tipo de instancia

Tipo de instancia
Los bloques de función se pueden llamar de maneras diferentes, a saber:
● Como instancia individual
● Como multiinstancia
● Como instancia de parámetro
Consulte también: Principios básicos de las instancias (Página 61)
El tipo de instancia definido se puede modificar en todo momento.

Requisitos
El programa de usuario contiene una llamada de bloque.

Procedimiento
Para cambiar el tipo de instancia de un bloque de función, proceda del siguiente modo:
1. Abra el bloque lógico y seleccione la llamada de bloque.
2. Elija el comando "Cambiar instancia" del menú contextual.
Se abre el cuadro de diálogo "Opciones de llamada".

Programación del PLC
Manual de programación y manejo, 11/2019

7969

Creación de programas KOP
13.4 Insertar elementos KOP
3. Haga clic en el botón "Instancia individual", "Multiinstancia" o "Instancia de parámetro".
– Si selecciona el tipo de instancia "Instancia individual", introduzca un nombre para el
bloque de datos que debe asignarse al bloque de función.
– Si selecciona el tipo de instancia "Multiinstancia", introduzca en el campo de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si se selecciona el tipo de instancia "Instancia de parámetro", introduzca seguidamente
en el campo de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/
salida (InOut) al que debe transferirse la instancia en tiempo de ejecución.
4. Confirme las entradas con "Aceptar".
Nota
Las instancias anteriores no se borran automáticamente.

Consulte también
Insertar llamadas de bloque mediante Drag & Drop (Página 7965)
Actualizar llamadas de bloque en KOP (Página 7966)
Instancias (Página 61)
Llamadas de bloque (Página 59)

13.4.8

Insertar instrucciones KOP complejas

13.4.8.1

Utilizar la instrucción "Calcular"

Requisitos
Existe un segmento.

Procedimiento
Para utilizar la instrucción "Calcular", proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. En la paleta "Instrucciones básicas", navegue hasta "Funciones matemáticas >
CALCULATE".
3. Arrastre el elemento hasta la posición deseada del segmento mediante Drag & Drop.
La instrucción "Calcular" se inserta con una expresión comodín y signos de interrogación
para el tipo de datos.
4. Introduzca el tipo de datos para el cálculo.

7970

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP
5. Introduzca los operandos para el cálculo.
Nota
El cálculo se lleva a cabo con las entradas de la instrucción "Calcular". Por ello, si desea
utilizar constantes debe insertar también las entradas correspondientes para las
constantes.
6. Haga clic en el botón "Editar instrucción "Calcular"" para reemplazar la expresión comodín
por la expresión correcta.
Se abre el cuadro de diálogo "Editar instrucción "Calcular"".
7. Introduzca la expresión deseada en el campo de texto "OUT:= ".
Nota
En el área "Ejemplo" dispone de un ejemplo de expresión válida y de las posibles
instrucciones que se pueden utilizar.
P. ej., para determinar un valor mediante el teorema de Pitágoras introduzca la expresión
"OUT := SQRT (SQR (IN1) + SQR (IN2))".
8. Confirme las entradas con "Aceptar".

Consulte también
CALCULATE: Calcular (Página 766)

13.4.9

Utilizar comentarios libres

13.4.9.1

Principios básicos de la utilización de comentarios libres en KOP

Introducción
Los comentarios libres permiten comentar el código fuente de los lenguajes de programación
gráficos, de manera similar a los comentarios de línea de los lenguajes textuales.
Los comentarios libres pueden utilizarse para los elementos siguientes:
● Cuadros
● Bobinas

Marcar el código de programa como comentario
Para desactivar instrucciones individuales o partes enteras del programa en los lenguajes de
programación KOP y FUP, hay que activar un bit de forma paralela a la instrucción o en serie
con un bloque de instrucción. En KOP y FUP no es posible marcar líneas como comentarios
como en AWL y SCL.

Programación del PLC
Manual de programación y manejo, 11/2019

7971

Creación de programas KOP
13.4 Insertar elementos KOP
Encontrará ejemplos sobre el marcado de líneas de código como comentario en todos los
lenguajes de programación en el Siemens Industry Online Support, en la FAQ con la ID:
109482004 (https://support.industry.siemens.com/cs/ww/es/view/109482004)

Consulte también
Insertar comentarios libres (Página 7972)
Editar comentarios libres (Página 7972)
Borrar comentarios libres (Página 7974)

13.4.9.2

Insertar comentarios libres

Requisitos
Existe un segmento con instrucciones.

Procedimiento
Para añadir un comentario libre relativo a una instrucción, proceda del siguiente modo:
1. Si es preciso, pulse el botón "Mostrar/ocultar comentarios libres" de la barra de
herramientas.
2. Haga clic con el botón derecho del ratón en la instrucción para la que desea insertar un
comentario libre.
3. Elija el comando "Insertar comentario" del menú contextual.
Se abre un cuadro de comentario con un comentario estándar. El cuadro de comentario
está unido con la instrucción correspondiente por medio de una flecha.
4. Introduzca el comentario deseado en el cuadro de comentario.

Consulte también
Principios básicos de la utilización de comentarios libres en KOP (Página 7971)
Editar comentarios libres (Página 7972)
Borrar comentarios libres (Página 7974)

13.4.9.3

Editar comentarios libres

Introducción
Los comentarios libres pueden editarse como se indica a continuación:
● Modificar el texto del comentario
● Modificar la posición y el tamaño del cuadro de comentario

7972

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.4 Insertar elementos KOP
● Acoplar el comentario a un elemento diferente
● Mostrar y ocultar comentarios libres

Modificar el texto del comentario
Para modificar el texto de un comentario libre, proceda del siguiente modo:
1. Haga clic en el cuadro de comentario.
2. Introduzca el texto deseado.

Modificar la posición del cuadro de comentario
Para modificar la posición del cuadro de comentario, proceda del siguiente modo:
1. Haga clic en el cuadro de comentario y mantenga oprimido el botón del ratón.
2. Arrastre el cuadro de comentario hasta la posición deseada.

Modificar el tamaño del cuadro de comentario
Para modificar el tamaño del cuadro de comentario, proceda del siguiente modo:
1. Haga clic en el cuadro de comentario.
2. Arrastre el controlador de tamaño de la esquina inferior derecha del cuadro de comentario
hasta alcanzar el tamaño deseado.

Acoplar el comentario a un elemento diferente
Para acoplar un comentario libre a un elemento diferente, proceda del siguiente modo:
1. Haga clic en la punta de la flecha que une el cuadro de comentario con la instrucción y
mantenga oprimido el botón del ratón.
2. Arrastre la flecha hasta el elemento al que desea acoplar el comentario. Los puntos de
inserción posibles se identifican con un cuadrado verde.
3. Suelte el botón del ratón.

Mostrar y ocultar comentarios libres
Para mostrar y ocultar los comentarios libres, proceda del siguiente modo:
1. Haga clic en el botón "Mostrar/ocultar comentarios libres" de la barra de herramientas.

Consulte también
Principios básicos de la utilización de comentarios libres en KOP (Página 7971)
Insertar comentarios libres (Página 7972)
Borrar comentarios libres (Página 7974)

Programación del PLC
Manual de programación y manejo, 11/2019

7973

Creación de programas KOP
13.5 Editar elementos KOP

13.4.9.4

Borrar comentarios libres

Procedimiento
Para borrar un comentario libre, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el comentario libre que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Principios básicos de la utilización de comentarios libres en KOP (Página 7971)
Insertar comentarios libres (Página 7972)
Editar comentarios libres (Página 7972)

13.5

Editar elementos KOP

13.5.1

Seleccionar elementos KOP
Se pueden seleccionar varios elementos individuales o todos los elementos de un segmento.

Requisitos
Existen elementos KOP.

Seleccionar varios elementos KOP individuales
Para seleccionar varios elementos KOP individuales, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Ctrl>.
2. Haga clic en los elementos KOP que desea seleccionar.
3. Suelte la tecla <Ctrl>.

Seleccionar todos los elementos KOP de un segmento
Para seleccionar todos los elementos KOP de un segmento, proceda del siguiente modo:
1. Haga clic en el segmento cuyos elementos desea seleccionar.
2. Elija el comando "Seleccionar todo" del menú "Edición" o utilice la combinación de teclas
<Ctrl+E>.

7974

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.5 Editar elementos KOP

Consulte también
Copiar elementos KOP (Página 7975)
Cortar elementos KOP (Página 7976)
Insertar elementos KOP desde el portapapeles (Página 7976)
Reemplazar elementos KOP (Página 7977)
Insertar entradas y salidas adicionales en los elementos KOP (Página 7978)
Quitar entradas y salidas (Página 7979)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 155)
Borrar elementos KOP (Página 7980)

13.5.2

Copiar elementos KOP

Requisitos
Existe un elemento KOP.

Procedimiento
Para copiar un elemento KOP, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el elemento KOP que desea copiar.
2. Elija el comando "Copiar" del menú contextual.

Resultado
El elemento KOP se copia y se guarda en el portapapeles.

Consulte también
Seleccionar elementos KOP (Página 7974)
Cortar elementos KOP (Página 7976)
Insertar elementos KOP desde el portapapeles (Página 7976)
Reemplazar elementos KOP (Página 7977)
Insertar entradas y salidas adicionales en los elementos KOP (Página 7978)
Quitar entradas y salidas (Página 7979)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 155)
Borrar elementos KOP (Página 7980)

Programación del PLC
Manual de programación y manejo, 11/2019

7975

Creación de programas KOP
13.5 Editar elementos KOP

13.5.3

Cortar elementos KOP

Requisitos
Existe un elemento KOP.

Cortar
Para cortar un elemento KOP, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el elemento KOP que desea cortar.
2. Seleccione el comando "Cortar" del menú contextual.

Resultado
El elemento KOP se corta y se guarda en el portapapeles.

Consulte también
Seleccionar elementos KOP (Página 7974)
Copiar elementos KOP (Página 7975)
Insertar elementos KOP desde el portapapeles (Página 7976)
Reemplazar elementos KOP (Página 7977)
Insertar entradas y salidas adicionales en los elementos KOP (Página 7978)
Quitar entradas y salidas (Página 7979)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 155)
Borrar elementos KOP (Página 7980)

13.5.4

Insertar elementos KOP desde el portapapeles

Requisitos
Existe un elemento KOP.

Procedimiento
Para insertar un elemento KOP desde el portapapeles, proceda del siguiente modo:
1. Copie o corte un elemento KOP.
2. Haga clic con el botón derecho del ratón en la posición del segmento en la que desea
insertar el elemento.
3. Elija el comando "Pegar" del menú contextual.

7976

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.5 Editar elementos KOP

Consulte también
Seleccionar elementos KOP (Página 7974)
Copiar elementos KOP (Página 7975)
Cortar elementos KOP (Página 7976)
Reemplazar elementos KOP (Página 7977)
Insertar entradas y salidas adicionales en los elementos KOP (Página 7978)
Quitar entradas y salidas (Página 7979)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 155)
Borrar elementos KOP (Página 7980)

13.5.5

Reemplazar elementos KOP
Los elementos KOP se pueden reemplazar muy fácilmente por otros del mismo tipo. La ventaja
es que los parámetros se conservan, por lo que no es necesario introducirlos de nuevo. Por
ejemplo, es posible sustituir un contacto normalmente abierto por uno normalmente cerrado o
un flipflop de desactivación/activación por uno de activación/desactivación.

Requisitos
Existe un segmento con un elemento KOP como mínimo.

Procedimiento
Para reemplazar un elemento KOP por otro, proceda del siguiente modo:
1. Seleccione el elemento KOP que desea reemplazar.
2. Sitúe el puntero del ratón sobre el triángulo de la esquina superior derecha del elemento
KOP.
Se abre una lista desplegable.
3. Seleccione el elemento KOP de la lista desplegable por el que desea reemplazar el
elemento KOP actual.

Consulte también
Seleccionar elementos KOP (Página 7974)
Copiar elementos KOP (Página 7975)
Cortar elementos KOP (Página 7976)
Insertar elementos KOP desde el portapapeles (Página 7976)
Insertar entradas y salidas adicionales en los elementos KOP (Página 7978)
Quitar entradas y salidas (Página 7979)

Programación del PLC
Manual de programación y manejo, 11/2019

7977

Creación de programas KOP
13.5 Editar elementos KOP
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 155)
Borrar elementos KOP (Página 7980)

13.5.6

Insertar entradas y salidas adicionales en los elementos KOP

Introducción
Mediante entradas adicionales es posible añadir elementos KOP que realicen instrucciones
aritméticas conmutativas. Estos elementos son p. ej. las instrucciones "Sumar" (ADD) y
"Multiplicar" (MUL). Los cuadros de las instrucciones "Copiar valor" (MOVE) y "Desmultiplexar"
(DEMUX) se pueden ampliar mediante salidas adicionales.

Requisitos
Existe un elemento KOP que permite insertar entradas o salidas adicionales.

Insertar una entrada adicional
Para insertar una entrada adicional en el cuadro de un elemento KOP, proceda del siguiente
modo:
1. Haga clic con el botón derecho del ratón en una entrada existente del elemento KOP.
2. Elija el comando "Insertar entrada" del menú contextual.
El cuadro del elemento KOP se complementa con una entrada adicional.
O bien:
1. Haga clic en el asterisco amarillo junto a la última entrada del cuadro de instrucción.
El cuadro del elemento KOP se complementa con una entrada adicional.

Insertar una salida adicional
Para insertar una salida adicional en el cuadro de un elemento KOP, proceda del siguiente
modo:
1. Haga clic con el botón derecho del ratón en una salida existente del elemento KOP.
2. Elija el comando "Insertar salida" del menú contextual.
El cuadro del elemento KOP se complementa con una salida adicional.
O bien:
1. Haga clic en el asterisco amarillo junto a la última entrada del cuadro de instrucción.
El cuadro del elemento KOP se complementa con una salida adicional.

Consulte también
Insertar elementos KOP (Página 7955)
Seleccionar elementos KOP (Página 7974)

7978

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.5 Editar elementos KOP
Copiar elementos KOP (Página 7975)
Cortar elementos KOP (Página 7976)
Insertar elementos KOP desde el portapapeles (Página 7976)
Reemplazar elementos KOP (Página 7977)
Quitar entradas y salidas (Página 7979)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 155)
Borrar elementos KOP (Página 7980)

13.5.7

Quitar entradas y salidas

Introducción
Las entradas y salidas que se han insertado adicionalmente para una instrucción pueden
quitarse nuevamente.

Requisitos
Existe un elemento KOP en el que se han insertado entradas o salidas adicionales.

Quitar una entrada
Para quitar una entrada, proceda del siguiente modo:
1. Seleccione la entrada que desea quitar.
2. Elija el comando "Borrar" del menú contextual.
La entrada del elemento KOP se quita.

Quitar una salida
Para quitar una salida, proceda del siguiente modo:
1. Seleccione la salida que desea quitar.
2. Elija el comando "Borrar" del menú contextual.
La salida del elemento KOP se quita.

Consulte también
Insertar elementos KOP (Página 7955)
Seleccionar elementos KOP (Página 7974)
Copiar elementos KOP (Página 7975)
Cortar elementos KOP (Página 7976)

Programación del PLC
Manual de programación y manejo, 11/2019

7979

Creación de programas KOP
13.5 Editar elementos KOP
Insertar elementos KOP desde el portapapeles (Página 7976)
Reemplazar elementos KOP (Página 7977)
Insertar entradas y salidas adicionales en los elementos KOP (Página 7978)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 155)
Borrar elementos KOP (Página 7980)

13.5.8

Borrar elementos KOP

Requisitos
Existe un elemento KOP.

Procedimiento
Para borrar un elemento KOP, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el elemento KOP que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Insertar elementos KOP (Página 7955)
Seleccionar elementos KOP (Página 7974)
Copiar elementos KOP (Página 7975)
Cortar elementos KOP (Página 7976)
Insertar elementos KOP desde el portapapeles (Página 7976)
Reemplazar elementos KOP (Página 7977)
Insertar entradas y salidas adicionales en los elementos KOP (Página 7978)
Quitar entradas y salidas (Página 7979)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 155)

7980

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.6 Cablear operandos en instrucciones KOP

13.6

Cablear operandos en instrucciones KOP

13.6.1

Cablear operandos
Cuando se inserta un elemento KOP, las cadenas de caracteres "<???>", "<??.?>" y "..." se
insertan como comodines de los parámetros. Las cadenas de caracteres "<???>" y "<??.?>"
representadas en color rojo identifican los parámetros que se deben cablear. La secuencia de
caracteres "..." representada en color negro identifica los parámetros que se pueden cablear.
"<??.?>" significa comodín de operación booleana o lógica. Además, los parámetros de los
elementos KOP pueden tener los siguientes tipos de conexiones:
● Conexiones de color naranja: En esta conexión solo es posible interconectar variables o
constantes.
● Conexiones de color negro: Entrada o salida booleana en la que pueden interconectarse
también otros elementos anteriores o posteriores, respectivamente.
Nota
Al situar el puntero del ratón sobre el comodín se muestra el tipo de datos esperado.

Requisitos
Existe un elemento KOP.

Procedimiento
Para cablear los parámetros de un elemento KOP, proceda del siguiente modo:
1. Haga doble clic en el comodín del parámetro.
Se abre un campo de entrada y el comodín aparece seleccionado.
2. Introduzca el parámetro correspondiente.
Nota
Si introduce la dirección absoluta de un parámetro ya definido, ésta se sustituirá por el
nombre simbólico del parámetro tan pronto como confirme la entrada. Si el parámetro no se
ha definido aún, en la tabla de variables PLC se introduce una variable nueva con esta
dirección absoluta y el nombre estándar "Tag_<n>". Cuando confirme la entrada, la
dirección absoluta se sustituirá por el nombre simbólico "Tag_<n>".
3. Confirme el parámetro pulsando la tecla Intro.
4. Si todavía no ha definido el parámetro, puede hacerlo mediante el menú contextual
directamente en el editor de programación.
Consulte también:
Declarar variables PLC en el editor de programación (Página 7900)
Declarar variables locales en el editor de programación (Página 7794)

Programación del PLC
Manual de programación y manejo, 11/2019

7981

Creación de programas KOP
13.6 Cablear operandos en instrucciones KOP
O mediante Drag & Drop desde la tabla de variables PLC:
1. En el árbol del proyecto, seleccione la carpeta "Variables PLC" y abra la tabla de variables
PLC.
2. Si está abierta la tabla de variables PLC, arrastre el símbolo desde la primera columna de
la variable deseada hasta la respectiva posición del programa. Si la tabla de variables PLC
no está abierta, abra la vista detallada. Arrastre la variable deseada desde la vista detallada
hasta la respectiva posición del programa.
O mediante Drag & Drop desde la interfaz del bloque:
1. Abra la interfaz del bloque.
2. Arrastre el operando deseado desde la interfaz del bloque hasta la ventana de
instrucciones.

Resultado
● Si la sintaxis es correcta, el parámetro se representará en color negro. El editor salta al
siguiente comodín.
● Si hay un error de sintaxis, no se saldrá del campo de entrada y aparecerá un aviso de error
correspondiente en la barra de estado. Si pulsa nuevamente la tecla Intro, el campo de
entrada se cerrará y la entrada errónea se representará en rojo y en cursiva.

Consulte también
Utilizar y direccionar operandos (Página 95)
Utilizar la función automática de autocompletar (Página 7682)

13.6.2

Cablear parámetros ocultos

Introducción
Si una instrucción contiene parámetros ocultos, aparece una flecha pequeña en el margen
inferior del cuadro de la instrucción. Los parámetros ocultos se reconocen porque se muestran
en fuente blanca.
Los parámetros ocultos se pueden mostrar y asignar en todo momento.

Mostrar u ocultar parámetros ocultos
Para mostrar u ocultar parámetros ocultos, proceda del siguiente modo:
1. Para mostrar los parámetros ocultos, haga clic en la flecha hacia abajo situada en el
margen inferior del cuadro de la instrucción.
2. Para ocultar los parámetros ocultos, haga clic en la flecha hacia arriba situada en el margen
inferior del cuadro de la instrucción.

7982

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.6 Cablear operandos en instrucciones KOP

Asignar parámetros ocultos
Para asignar parámetros ocultos, proceda del siguiente modo:
1. Asigne los parámetros ocultos de la misma manera que los parámetros visibles.
Al asignar el parámetro es posible que cambie su visibilidad:
– El parámetro se vuelve visible al seleccionar la opción "Ocultar cuando no se haya
asignado ningún parámetro" en las propiedades.
– El parámetro se mantiene oculto al seleccionar la opción "Ocultar" en las propiedades.

Consulte también
Ocultar parámetros en la llamada del bloque (Página 7804)

13.6.3

Mostrar u ocultar informaciones de variables

Introducción
Se puede mostrar la siguiente información sobre las variables empleadas en el editor de
programación:
● Nombre de la variable
● Dirección de la variable
● Comentarios simples o jerárquicos para la documentación de variables
La información se recoge de la interfaz del bloque en el caso de las variables locales y de DB,
y de la tabla de variables PLC en el caso de las variables válidas para toda la CPU.
Es posible visualizar la información de las variables para todos los bloques o solo para bloques
abiertos individuales. Si selecciona la información de variables para todos los bloques, se
muestra la información de las variables de todos los bloques abiertos actuales y futuros. La
información de las variables se puede volver a ocultar en cualquier momento. Si se ha ocultado
la información de las variables de todos los bloques, se puede volver a mostrar en bloques
abiertos individualmente.
Si selecciona la visualización de la información de variables con comentarios jerárquicos, en
las variables estructuradas también se mostrarán los comentarios de los niveles de estructura
de orden superior. En este caso, la información se muestra entre paréntesis después del
comentario de la variable, y los comentarios de los distintos niveles se separan con un punto.
Si en un nivel de estructura no hay ningún comentario de variable, el comentario en cuestión
no se visualiza, lo que se reconoce por los dos puntos seguidos.
La información de variable puede visualizarse agrupada debajo de un segmento KOP/FUP o
bien directamente en el operando correspondiente. Igual que para mostrar y ocultar la
información de variable, esto puede ajustarse en la configuración para todos los bloques o bien
modificarse específicamente para un bloque abierto.

Programación del PLC
Manual de programación y manejo, 11/2019

7983

Creación de programas KOP
13.6 Cablear operandos en instrucciones KOP

Mostrar u ocultar información de variables para todos los bloques
Para mostrar u ocultar la información de variables para todos los bloques, proceda del
siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Si desea visualizar la información de las variables, seleccione en la lista desplegable
"Información de la variable" bien la opción "Mostrar", bien la opción "Información de la
variable con comentarios jerárquicos", según si desea ver comentarios simples o
jerárquicos.
4. En la lista desplegable "Posición de la información de variable (KOP/FUP)", especifique si
la información de variable debe visualizarse debajo de un segmento KOP/FUP o bien en el
operando.
La información de variable se muestra para todos los bloques abiertos en la posición
seleccionada. Si se abren más bloques, la información de variable también se muestra para
dichos bloques.
5. Si desea ocultar la información de variable, seleccione la opción "Ocultar" en la lista
desplegable "Información de variable".
La información de variable se oculta para todos los bloques abiertos. Si se abren más
bloques, la información de variable también se oculta para dichos bloques.

Mostrar u ocultar información de variables para un bloque abierto
Para mostrar u ocultar la información de variables para un bloque abierto, proceda del
siguiente modo:
1. Para mostrar información de variables, seleccione en la lista desplegable "Información
sobre la variable." bien la opción "Mostrar información de la variable", bien la opción
"Información de la variable con comentarios jerárquicos", según si desea visualizar
comentarios simples o jerárquicos.
2. Para especificar la posición de la información de variable, haga clic en el botón "Posición de
la información de variable (KOP/FUP)" de la barra de herramientas del editor de
programación. Cada vez que se hace clic en el botón cambia la posición. Otra posibilidad
consiste en hacer clic en la flecha pequeña situada junto al botón "Posición de la
información de variable (KOP/FUP)" para abrir una lista desplegable. Seguidamente,
seleccione la posición en la lista desplegable.
La información de variable se muestra en la posición seleccionada.
3. Para ocultar la información de las variables, seleccione la opción "Ocultar información de la
variable" en la lista desplegable "Muestra información sobre la variable".
La información de variable se oculta.

7984

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.7 Ramas en KOP

13.7

Ramas en KOP

13.7.1

Principios básicos de las ramas en KOP

Definición
En el lenguaje de programación Esquema de contactos (KOP) se utilizan ramas para
programar conexiones en paralelo. Las ramas se insertan en el circuito principal. En una rama
se pueden insertar varios contactos, creando así una conexión en paralelo de conexiones en
serie. Esto permite programar esquemas de contactos complejos.
La figura siguiente muestra un ejemplo de la utilización de ramas:
6

02725
5

6

6

El MOTOR tiene el estado lógico 1 si se cumple una de las condiciones siguientes:
● S2 o S4 tienen el estado lógico 1.
● S5 tiene el estado lógico 0.

Consulte también
Reglas para ramas en KOP (Página 7985)
Insertar ramas en segmentos KOP (Página 7986)
Cerrar ramas en segmentos KOP (Página 7987)
Borrar ramas en segmentos KOP (Página 7987)

13.7.2

Reglas para ramas en KOP

Reglas
Para las ramas paralelas rigen las reglas siguientes:
● Solo se puede insertar una rama paralela si ya existe un elemento KOP en la rama principal.
● Las ramas paralelas se abren hacia abajo o se conectan directamente a la barra de
alimentación y se cierran hacia arriba.

Programación del PLC
Manual de programación y manejo, 11/2019

7985

Creación de programas KOP
13.7 Ramas en KOP
● Las ramas paralelas se abren detrás del elemento KOP seleccionado.
● Las ramas paralelas se cierran detrás del elemento KOP seleccionado.
● Para borrar una rama paralela deben borrarse todos sus elementos KOP. Al borrar el último
elemento KOP de la rama, se borrará también el resto de la misma.
● Solo se puede insertar una bobina en una conexión en paralelo si esta última empieza
directamente en la barra de alimentación.

Consulte también
Principios básicos de las ramas en KOP (Página 7985)
Insertar ramas en segmentos KOP (Página 7986)
Borrar ramas en segmentos KOP (Página 7987)
Cerrar ramas en segmentos KOP (Página 7987)

13.7.3

Insertar ramas en segmentos KOP
En un segmento pueden crearse varias ramas.

Requisitos
● Existe un segmento.
● El segmento contiene elementos.

Procedimiento
Para insertar una rama nueva en un segmento, proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. En la paleta "Instrucciones básicas", navegue hasta "General > Abrir rama".
3. Arrastre el elemento hasta la posición deseada del segmento mediante Drag & Drop.
Para insertar una rama directamente en la barra de alimentación, arrastre el elemento hasta
la barra.

Consulte también
Principios básicos de las ramas en KOP (Página 7985)
Reglas para ramas en KOP (Página 7985)
Borrar ramas en segmentos KOP (Página 7987)

7986

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.7 Ramas en KOP

13.7.4

Cerrar ramas en segmentos KOP
Las ramas se deben volver a cerrar en los puntos adecuados. En caso necesario, las ramas se
disponen de manera que no se crucen.

Requisitos
Existe una rama.

Procedimiento
Para cerrar una rama abierta, proceda del siguiente modo:
1. Seleccione la rama abierta.
2. Pulse y mantenga oprimido el botón izquierdo del ratón.
Al mover el puntero del ratón aparece una línea discontinua.
3. Arrastre la línea discontinua hasta una posición apropiada del segmento. Las conexiones
permitidas se identifican mediante líneas verdes.
4. Suelte el botón izquierdo del ratón.

Consulte también
Principios básicos de las ramas en KOP (Página 7985)
Reglas para ramas en KOP (Página 7985)

13.7.5

Borrar ramas en segmentos KOP

Requisitos
Existe una rama.

Procedimiento
Para borrar una rama, proceda del siguiente modo:
1. Seleccione la línea que conecta la rama con la rama principal.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Principios básicos de las ramas en KOP (Página 7985)
Reglas para ramas en KOP (Página 7985)
Insertar ramas en segmentos KOP (Página 7986)

Programación del PLC
Manual de programación y manejo, 11/2019

7987

Creación de programas KOP
13.8 Cruces en KOP

13.8

Cruces en KOP

13.8.1

Principios básicos de los cruces en KOP

Definición
Un cruce es una posición de un segmento KOP en la que se cierra una rama al mismo tiempo
que se abre otra rama.
ಯ7DJ,QBಯ

ಯ7DJ,QBಯ

ಯ7DJ,QBಯ

ಯ7DJ,QBಯ

ಯ7DJ2XWಯ

&UXFH

"TagOut" tiene el estado lógico 1 si se cumplen las dos condiciones siguientes:
● "TagIn_1" o "TagIn_3" presentan el estado lógico 1
● "TagIn_2" o "TagIn_4" presentan el estado lógico 0

13.8.2

Insertar cruces
Los cruces se pueden insertar en un segmento KOP creando conexiones entre la rama
principal y una rama adicional, o bien entre diferentes ramas.

Requisitos
Existe una rama.

Procedimiento
Para insertar un cruce en un segmento KOP, proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. En la paleta "Instrucciones básicas", navegue hasta "General > Abrir rama".
3. Arrastre el elemento y suéltelo detrás de la rama existente.
4. Inserte un elemento cualquiera en la rama abierta.
5. Detrás del elemento insertado, haga clic en la flecha de la rama abierta.
6. Mantenga pulsado el botón izquierdo del ratón y arrastre la línea de conexión discontinua
hasta la rama principal.
7. Suelte el botón izquierdo del ratón.

7988

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.8 Cruces en KOP

Consulte también
Cambiar la posición de cruces (Página 7989)
Borrar cruces (Página 7989)
Insertar ramas en segmentos KOP (Página 7986)

13.8.3

Cambiar la posición de cruces

Requisitos
Existe un cruce.

Procedimiento
Para cambiar la posición de un cruce, proceda del siguiente modo:
1. Seleccione la línea de conexión que define los cruces en las respectivas ramas.
2. Elija el comando "Borrar" del menú contextual.
3. Abra la Task Card "Instrucciones".
4. En la paleta "Instrucciones básicas", navegue hasta "General > Abrir rama".
5. Arrastre el elemento mediante Drag & Drop hasta la posición del segmento en la que desea
insertar el cruce nuevo.
6. Haga clic en la flecha de la rama abierta.
7. Mantenga pulsado el botón izquierdo del ratón y arrastre la línea de conexión discontinua
hasta la rama secundaria en la que desea insertar el cruce nuevo.
8. Suelte el botón izquierdo del ratón.

Consulte también
Insertar cruces (Página 7988)
Borrar cruces (Página 7989)

13.8.4

Borrar cruces

Requisitos
Existe un cruce.

Programación del PLC
Manual de programación y manejo, 11/2019

7989

Creación de programas KOP
13.9 Circuitos en KOP

Procedimiento
Para borrar un cruce, proceda del siguiente modo:
1. Seleccione la línea de conexión que define los cruces en las respectivas ramas.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Insertar cruces (Página 7988)
Cambiar la posición de cruces (Página 7989)

13.9

Circuitos en KOP

13.9.1

Principios básicos de los circuitos en KOP

Utilización de circuitos
El programa se mapea en uno o varios segmentos. Un segmento contiene en el margen
izquierdo una barra de alimentación de la que pueden partir uno o varios circuitos. Las
consultas de las señales binarias se disponen en los circuitos en forma de contactos. Si los
elementos se disponen en serie en un circuito, se crea una conexión en serie. Si se disponen
en ramas paralelas, se crea una conexión en paralelo. Un circuito se termina con una bobina
o un cuadro en los que se escribe el resultado lógico.
La figura siguiente muestra un ejemplo de utilización de varios circuitos en un segmento:
ಯ,QWBDUUDQTXHBL]Tಯ

ಯ02725B21ಯ
6

ಯ,QWBDUUDQTXHBGHUಯ
ಯ,QWBSDUDGDBL]Tಯ

ಯ02725B21ಯ
5

ಯ,QWBSDUDGDBGHUಯ

Reglas
Observe las reglas siguientes si utiliza varios circuitos:
● No se permiten las conexiones entre los circuitos.
● Sólo se permite una instrucción de salto por segmento. Las reglas de posicionamiento de
instrucciones de salto conservan su validez.

7990

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.9 Circuitos en KOP

Procesamiento de circuitos
Los circuitos y segmentos se procesan de arriba abajo y de izquierda a derecha. Esto significa
que primero se procesa la primera instrucción del primer circuito del primer segmento. Luego
se procesan todas las demás instrucciones de este circuito. A continuación se procesan todos
los demás circuitos del primer segmento. Una vez procesados todos los circuitos, se procesa
el siguiente segmento.

Diferencias entre las ramas y los circuitos
La diferencia entre las ramas y los circuitos es que estos últimos son ramas independientes
que también pueden encontrarse en un segmento diferente. En cambio, las ramas permiten
programar una conexión en paralelo.

Consulte también
Insertar un circuito (Página 7991)
Borrar un circuito (Página 7991)

13.9.2

Insertar un circuito

Requisitos
● Un bloque está abierto.
● Existe un segmento.

Procedimiento
Para insertar un circuito nuevo en un segmento, proceda del siguiente modo:
1. Inserte una bobina cualquiera en la barra de alimentación.
Se inserta un circuito nuevo y la bobina se posiciona al final del circuito.
2. Inserte instrucciones adicionales en el circuito nuevo.

Consulte también
Principios básicos de los circuitos en KOP (Página 7990)
Borrar un circuito (Página 7991)

13.9.3

Borrar un circuito

Requisitos
Existe un circuito.

Programación del PLC
Manual de programación y manejo, 11/2019

7991

Creación de programas KOP
13.10 Ejemplos de programación KOP

Procedimiento
Para borrar un circuito, proceda del siguiente modo:
1. Pulse y mantenga oprimido el botón izquierdo del ratón y trace un marco alrededor del
circuito. Vigile que se seleccionen todas las instrucciones del circuito. Alternativamente,
pulse y mantenga oprimida la tecla <Mayús> y seleccione la primera y última instrucción del
circuito.
2. Haga clic con el botón derecho del ratón en una de las instrucciones del circuito.
3. Elija el comando "Borrar" del menú contextual.

Consulte también
Principios básicos de los circuitos en KOP (Página 7990)
Insertar un circuito (Página 7991)

13.10

Ejemplos de programación KOP

13.10.1

Ejemplo de control de una cinta transportadora

Control de una cinta transportadora
La figura siguiente muestra una cinta transportadora que se pone en marcha eléctricamente.
Al comienzo de la cinta transportadora se encuentran dos pulsadores, S1 para MARCHA y S2
para PARO. Al final de la cinta transportadora se encuentran otros dos pulsadores, S3 para
MARCHA y S4 para PARO. La cinta transportadora puede ponerse en marcha o pararse desde
cualquiera de ambos extremos.
6
6

20DUFKD
23DUR

6 20DUFKD
6 23DUR

02725B21

7992

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.10 Ejemplos de programación KOP

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Descripción

Marcha_izquierda (S1)

Input

BOOL

Pulsador de marcha en
el extremo izquierdo de
la cinta transportadora

Paro_izquierda (S2)

Input

BOOL

Pulsador de paro en el
extremo izquierdo de la
cinta transportadora

Marcha_derecha (S3)

Input

BOOL

Pulsador de marcha en
el extremo derecho de
la cinta transportadora

Paro_derecha (S4)

Input

BOOL

Pulsador de paro en el
extremo derecho de la
cinta transportadora

MOTOR_ON

Output

BOOL

Conectar el motor de la
cinta transportadora

Los segmentos siguientes muestran la programación KOP para solucionar la tarea:
Segmento 1:
El motor de la cinta transportadora se conecta cuando se acciona el pulsador de marcha "S1"
o "S3".
ಯ0DUFKDBL]TXLHUGDರ

ಯ02725B21ರ
6

ಯ0DUFKDBGHUHFKDರ

Segmento 2:
El motor de la cinta transportadora se desconecta cuando se acciona el pulsador de paro "S2"
o "S4".
ಯ3DURBL]TXLHUGDರ

ಯ02725B21ರ
5

ಯ3DURBGHUHFKDರ

Consulte también
Principios básicos de KOP (Página 7943)
Configuración de KOP (Página 7946)
Trabajar con segmentos (Página 7947)
Insertar elementos KOP (Página 7955)
Programación del PLC
Manual de programación y manejo, 11/2019

7993

Creación de programas KOP
13.10 Ejemplos de programación KOP
Editar elementos KOP (Página 7974)
Cablear operandos en instrucciones KOP (Página 7981)
Ramas en KOP (Página 7985)
Cruces en KOP (Página 7988)
Circuitos en KOP (Página 7990)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 7994)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 7996)
Ejemplo de cálculo de una ecuación (Página 7999)
Ejemplo de control de la temperatura ambiente (Página 8001)

13.10.2

Ejemplo de detección del sentido de marcha de una cinta transportadora

Detección del sentido de marcha de una cinta transportadora
El sentido de marcha detectado de la cinta transportadora se indica con una flecha DERECHA
o una flecha IZQUIERDA. Si se está transportando otro objeto desde la derecha a BF1 o desde
la izquierda a BF2, primero se desconectará la flecha indicada hasta que, tras pasar por las dos
barreras fotoeléctricas, se detecte nuevamente el sentido de marcha y pueda indicarse la
flecha correspondiente. Para solucionar la tarea se requieren además dos marcas de flanco
que detecten el cambio de señal en las dos barreras fotoeléctricas de "0" a "1".
%)

%)

Realización
La tabla siguiente muestra la definición de las variables utilizadas:

7994

Nombre

Declaración

Tipo de datos

Descripción

BF1

Input

BOOL

Barrera fotoeléctrica 1

BF2

Input

BOOL

Barrera fotoeléctrica 2

DERECHA

Output

BOOL

Indicador de desplaza‐
miento a la derecha

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.10 Ejemplos de programación KOP
Nombre

Declaración

Tipo de datos

Descripción

IZQUIERDA

Output

BOOL

Indicador de desplaza‐
miento a la izquierda

MF1

Input

BOOL

Marca de flancos 1

MF2

Input

BOOL

Marca de flancos 2

Los segmentos siguientes muestran la programación KOP para solucionar la tarea:
Segmento 1:
Si el estado lógico de la barrera fotoeléctrica "BF1" cambia de "0" a "1" (flanco de señal
ascendente) y, simultáneamente, el estado lógico de "BF2" es "0", el objeto se desplaza hacia
la izquierda sobre la cinta transportadora.
ಯ%)ಯ

ಯ%)ಯ

3
ಯ0)ಯ

ಯ,=48,(5'$ಯ
6
ಯ'(5(&+$ಯ
5

Segmento 2:
Si el estado lógico de la barrera fotoeléctrica "BF2" cambia de "0" a "1" (flanco de señal
ascendente) y, simultáneamente, el estado lógico de "BF1" es "0", el objeto se desplaza hacia
la derecha sobre la cinta transportadora.
ಯ%)ಯ
3
ಯ0)ಯ

ಯ%)ಯ

ಯ'(5(&+$ಯ
6
ಯ,=48,(5'$ಯ
5

Consulte también
Principios básicos de KOP (Página 7943)
Configuración de KOP (Página 7946)
Trabajar con segmentos (Página 7947)
Insertar elementos KOP (Página 7955)
Editar elementos KOP (Página 7974)
Cablear operandos en instrucciones KOP (Página 7981)
Ramas en KOP (Página 7985)
Cruces en KOP (Página 7988)
Circuitos en KOP (Página 7990)
Ejemplo de control de una cinta transportadora (Página 7992)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 7996)
Ejemplo de cálculo de una ecuación (Página 7999)
Ejemplo de control de la temperatura ambiente (Página 8001)

Programación del PLC
Manual de programación y manejo, 11/2019

7995

Creación de programas KOP
13.10 Ejemplos de programación KOP

13.10.3

Ejemplo de detección del nivel de llenado de una zona de almacén

Detección del nivel de llenado de una zona de almacén
La figura siguiente muestra un sistema con dos cintas transportadoras y una zona de almacén
temporal situada entre ambas. La cinta transportadora 1 transporta paquetes a la zona de
almacén. Una barrera fotoeléctrica situada al final de la cinta 1 junto a la zona de almacén
determina cuántos paquetes se transportan a dicha zona. La cinta transportadora 2 transporta
paquetes desde esta zona de almacén temporal a una plataforma de carga, desde la que los
paquetes se cargan en camiones. Una barrera fotoeléctrica situada al final de la zona de
almacén determina cuántos paquetes deben transportarse desde allí hasta la plataforma de
carga. Cinco indicadores luminosos indican el nivel de llenado de la zona de almacén temporal.
&RQVRODGHLQGLFDGRUHV

=RQDGHDOPDF«Q =RQDGHDOPDF«Q
YDF¯D
QRYDF¯D

3DTXHWHV
HQWUDQWHV

=RQDGHDOPDF«Q
OOHQDDO

=RQDGHDOPDF«Q
OOHQDDO

=RQDGHDOPDF«Q
OOHQD

3DTXHWHV
VDOLHQWHV

=RQDGHDOPDF«Q
WHPSRUDO
SDUD
SDTXHWHV

&LQWDWUDQVSRUWDGRUD

&LQWDWUDQVSRUWDGRUD

%DUUHUDIRWRHO«FWULFD

%DUUHUDIRWRHO«FWULFD

Realización
La tabla siguiente muestra la definición de las variables utilizadas:

7996

Nombre

Declaración

Tipo de datos

Descripción

BF1

Input

BOOL

Barrera fotoeléctrica 1

BF2

Input

BOOL

Barrera fotoeléctrica 2

RESET

Input

BOOL

Inicializar contador

LOAD

Input

BOOL

Adaptar el valor actual
del contador al valor del
parámetro PV.

CAPACIDAD MAX AL‐
MACEN

Input

INT

Número máximo posi‐
ble de paquetes en al‐
macén

PAQUETES

Output

INT

Número de paquetes
en la zona de almacén
(valor de contaje actual)

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.10 Ejemplos de programación KOP
Nombre

Declaración

Tipo de datos

Descripción

PAQUETES_ZA

Output

BOOL

Se activa si el valor ac‐
tual del contador es ma‐
yor o igual al valor de la
variable "CAPACIDAD
MAX ALMACEN".

ALM_VACIO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén vacía

ALM_NO_VACIO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén no vacía

ALM_LLENO_50%

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena al
50 %

ALM_LLENO_90%

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena al
90 %

ALM_LLENO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena

VOLUMEN_50

Input

INT

Valor de comparación:
50 paquetes

VOLUMEN_90

Input

INT

Valor de comparación:
90 paquetes

VOLUMEN_100

Input

INT

Valor de comparación:
100 paquetes

Los segmentos siguientes muestran la programación KOP para activar los indicadores
luminosos:
Segmento 1:
Cuando un paquete se transporta a la zona de almacén, el estado lógico de "BF1" cambia de
"0" a "1" (flanco ascendente). Cuando se produce un flanco ascendente en "BF1", el contador
ascendente se activa y el valor de contaje actual de "PAQUETES" aumenta en uno.
Cuando un paquete se transporta de la zona de almacén a la plataforma de carga, el estado
lógico de "BF2" cambia de "0" a "1" (flanco ascendente). Cuando se produce un flanco
ascendente en "BF2", el contador descendente se activa y el valor actual de "PAQUETES" se
reduce en uno.
Si no hay paquetes en la zona de almacén ("PAQUETES" = "0"), la variable "ALM_VACIO"
adopta el estado lógico "1" y se enciende el indicador luminoso "Zona de almacén vacía".
El valor de contaje actual puede ponerse a "0" si la variable "RESET" adopta el estado lógico
"1".
Cuando la variable "LOAD" adopta el estado lógico "1", el valor actual del contador se pone al
valor de la variable "CAPACIDAD MAX ALMACEN". Mientras el valor de contaje actual sea
mayor o igual al valor de la variable "CAPACIDAD MAX ALMACEN", la variable
"PAQUETES_ZA" devolverá el estado lógico "1".

Programación del PLC
Manual de programación y manejo, 11/2019

7997

Creación de programas KOP
13.10 Ejemplos de programación KOP
ಯ&78'B'%ಯ
&78'
ಯ%)ಯ
%)
5(6(7
/2$'
&$3$&,'$'
0$;$/0$&(1

&8

,17

3$48(7(6B=$

48

&'

4'

$/0B9$&,2

5

&9

3$48(7(6

/'
39

Segmento 2:
Mientras haya paquetes en la zona de almacén, la variable "ALM_NO_VACIO" adoptará el
estado lógico "1" y se encenderá el indicador luminoso "Zona de almacén no vacía".
ರ$/0B9$&,2ರ

ರ$/0B12B9$&,2ರ

Segmento 3:
Si el número de paquetes que se encuentran en la zona de almacén es mayor o igual a 50, se
enciende el indicador luminoso del aviso "Zona de almacén llena al 50 %".
3$48(7(6
!
,17
92/80(1B

$/0B//(12B

3$48(7(6

,17
92/80(1B

Segmento 4:
Si el número de paquetes que se encuentran en la zona de almacén es mayor o igual a 90, se
enciende el indicador luminoso del aviso "Zona de almacén llena al 90 %".
3$48(7(6
!
,17
92/80(1B

Segmento 5:

3$48(7(6

$/0B//(12B

3$48(7(6

,17
92/80(1B

$/0B//(12

! de paquetes que se encuentran en la zona de almacén alcanza 100, se enciende
Si el número
,17luminoso del aviso "Zona de almacén llena".
el indicador
92/80(1B

7998

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.10 Ejemplos de programación KOP

Consulte también
Principios básicos de KOP (Página 7943)
Configuración de KOP (Página 7946)
Trabajar con segmentos (Página 7947)
Insertar elementos KOP (Página 7955)
Editar elementos KOP (Página 7974)
Cablear operandos en instrucciones KOP (Página 7981)
Ramas en KOP (Página 7985)
Cruces en KOP (Página 7988)
Circuitos en KOP (Página 7990)
Ejemplo de control de una cinta transportadora (Página 7992)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 7994)
Ejemplo de cálculo de una ecuación (Página 7999)
Ejemplo de control de la temperatura ambiente (Página 8001)

13.10.4

Ejemplo de cálculo de una ecuación

Cálculo de una ecuación
El siguiente programa de ejemplo muestra cómo se resuelven ecuaciones del siguiente tipo
con el lenguaje de programación KOP:
X= ((A + B) x C) / D
En principio, pueden convertirse utilizando operaciones matemáticas. Para ello están
disponibles las instrucciones "ADD", "MUL" y "DIV". En caso de utilizar una CPU de la serie
S7-1200 o S7-1500, también existe la opción de utilizar alternativamente la instrucción
"CALCULATE". Dependiendo del tipo de datos seleccionado, para esta instrucción existen
distintas operaciones matemáticas que puede combinar entre sí.

Conversión mediante las instrucciones "ADD", "MUL" y "DIV"
Debe calcularse la siguiente ecuación:
RESULT = ((A + B) x 15) / E
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Tipo de datos

Comentario

A

INT

Primer sumando

B

INT

Segundo sumando

C

INT

Primer resultado intermedio

15

INT

Multiplicador

Programación del PLC
Manual de programación y manejo, 11/2019

7999

Creación de programas KOP
13.10 Ejemplos de programación KOP
Nombre

Tipo de datos

Comentario

D

INT

Segundo resultado intermedio

E

INT

Divisor

RESULT

INT

Resultado final

El segmento siguiente muestra la programación KOP para calcular la ecuación:

(1
ಯ$ಯ

,1

ಯ%ಯ

,1

',9
,17

08/
,17

$''
,17
(1

(12
287

ಯ&ಯ

,1

ಯ&ಯ ಯಯ

,1

(1

(12
287

ಯ'ಯ

,1

ಯ'ಯ ಯ(ಯ

,1

(12
287

ಯ5(68/7ಯ

El valor del operando "A" se suma al valor del operando "B". La suma se almacena en el
operando "C". El valor del operando "C" se multiplica por "15". El resultado de la multiplicación
se almacena en el operando "D". A continuación, el valor almacenado en el operando "D" se
divide por el valor del operando "E". El resultado final se almacena en el operando "RESULT".

Conversión mediante la instrucción "CALCULATE" (solo S7-1200/1500)
Debe calcularse la siguiente ecuación:
RESULT = ((5 + 10) x 4) / 6
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Comentario

Valor

A

Input

INT

Primer sumando

5

B

Input

INT

Segundo sumando 10

C

Input

INT

Multiplicador

4

D

Input

INT

Divisor

6

RESULT

Output

INT

Resultado final

10

Para programar la ecuación utilizando la instrucción "CALCULATE", proceda del siguiente
modo:
1. Arrastre la instrucción "CALCULATE" desde la Task Card "Instrucciones" hasta un
segmento KOP.
2. En la lista desplegable "<???>" puede seleccionar el tipo de datos INT para la instrucción.
3. Interconecte las variables declaradas en la interfaz del bloque con las entradas o salidas del
cuadro de la instrucción.
4. Haga clic en el símbolo de "calculadora" en el borde superior derecho del cuadro de la
instrucción para introducir la ecuación que quiere resolver.
Se abre el cuadro de diálogo "Editar instrucción Calcular".
5. Introduzca la expresión siguiente en el campo "OUT:=".
((IN1 + IN2) * IN4) / IN3
La ecuación se muestra en el cuadro de la instrucción.
El siguiente segmento muestra el resultado en el lenguaje de programación KOP:

8000

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.10 Ejemplos de programación KOP
&$/&8/$7(
,17

ಯ7DJB,QSXWಯ

ಯ7DJB2XWSXWಯ
(12

(1

,1,1 ,1 ,1
ಯ$ಯ

,1

ಯ%ಯ

,1

ಯ&ಯ

,1

ಯ'ಯ

,1

287

ಯ5(68/7ಯ

Si la entrada "Tag_Input" devuelve el estado lógico "1", se ejecuta la instrucción. El valor del
operando "A" se suma al valor del operando "B". La suma intermedia se multiplica por "C" y
seguidamente se divide por el valor del operando "D". El resultado final se almacena en el
operando "RESULT".

Consulte también
Principios básicos de KOP (Página 7943)
Configuración de KOP (Página 7946)
Trabajar con segmentos (Página 7947)
Insertar elementos KOP (Página 7955)
Editar elementos KOP (Página 7974)
Cablear operandos en instrucciones KOP (Página 7981)
Ramas en KOP (Página 7985)
Cruces en KOP (Página 7988)
Circuitos en KOP (Página 7990)
Ejemplo de control de una cinta transportadora (Página 7992)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 7994)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 7996)
Ejemplo de control de la temperatura ambiente (Página 8001)

13.10.5

Ejemplo de control de la temperatura ambiente

Controlar la temperatura ambiente
La temperatura de una cámara de enfriamiento debe mantenerse por debajo de los cero
grados centígrados. Las posibles fluctuaciones de la temperatura se controlan mediante un
sensor. Si la temperatura aumenta por encima de los cero grados centígrados, el sistema de
enfriamiento se conecta por un tiempo preseleccionado. Durante la fase de enfriamiento se
enciende un indicador "Sistema de enfriamiento iniciado".
Programación del PLC
Manual de programación y manejo, 11/2019

8001

Creación de programas KOP
13.10 Ejemplos de programación KOP
El sistema de enfriamiento y el indicador luminoso se apagan cuando se cumple una de las
condiciones siguientes:
● El sensor indica un descenso de la temperatura por debajo de los cero grados centígrados.
● El tiempo de enfriamiento preseleccionado ha transcurrido.
● Se acciona el pulsador "PARO".
Si ha transcurrido el tiempo de enfriamiento preseleccionado y la temperatura de la cámara de
enfriamiento es aún demasiado elevada, el sistema de enfriamiento se puede reiniciar
mediante el pulsador "RESET".
6723
6,67(0$(1)5

6(1625'(
7(03(5$7

,1',&$'25

5(6(7

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Comentario

Sensor

Input

BOOL

Señal del sensor de
temperatura

RESET

Input

BOOL

Reset

STOP

Input

BOOL

El sistema de enfria‐
miento se desconecta.

TiempoEnfrMax

-

TIME

Tiempo de enfriamiento
preseleccionado
Esta variable está defi‐
nida en el bloque de da‐
tos "DB_Enfriar".

TiempoEnfrAct

-

TIME

Tiempo de enfriamiento
transcurrido actualmen‐
te
Esta variable está defi‐
nida en el bloque de da‐
tos "DB_Enfriar".

SistemaEnfr

8002

Output

BOOL

El sistema de enfria‐
miento se conecta.

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas KOP
13.10 Ejemplos de programación KOP
Nombre

Declaración

Tipo de datos

Comentario

Indicador

Output

BOOL

El indicador luminoso
del aviso "Sistema de
enfriamiento iniciado"
se enciende.

TempVariable

Temp

BOOL

Variable temporal
Esta variable guarda el
estado lógico del tempo‐
rizador CEI TP.

El segmento siguiente muestra la programación KOP para controlar la temperatura ambiente:
Segmento 1:
73B'%
73
7LPH

6HQVRU 5(6(7

'%B(QIULDU
7LHPSR(QIU0D[

7HPS9DULDEOH

,1

4

37

(7

'%B(QIULDU
7LHPSR(QIU$FW

Segmento 2:

ಯ7HPS9DULDEOHರ

ಯ6723ರ

ಯ6HQVRUರ ಯ6LVWHPD(QIUರ

ಯ,QGLFDGRUರ

Si la temperatura de la cámara de enfriamiento aumenta por encima de los cero grados
centígrados, el estado lógico del operando "Sensor" cambia de "0" a "1" (flanco de señal
ascendente). Con un flanco de señal ascendente en la entrada IN de la función de
temporización se inicia el tiempo de enfriamiento preseleccionado y la "TempVariable" recibe
el estado lógico "1". El estado lógico "1" de la "TempVariable" hace que en el segmento 2 se
conecte el sistema de enfriamiento y se encienda el indicador luminoso. Las salidas "Sensor",
"SistemaEnfr" e "Indicador" tienen que programarse en el segmento 2, ya que en la salida Q
de la función de temporización sólo se puede programar una bobina.
Si la temperatura de la cámara de enfriamiento desciende por debajo de los cero grados
centígrados, el estado lógico del sensor cambia nuevamente a "0". Con ello se apagan el
sistema de enfriamiento y el indicador luminoso.
Si el sensor no indica ningún descenso de la temperatura, el sistema de enfriamiento y el
indicador luminoso se apagan a más tardar al transcurrir el tiempo de enfriamiento
preseleccionado. En este caso, el proceso de enfriamiento se puede reiniciar mediante el
pulsador "RESET". Al pulsar y soltar el pulsador se genera otro flanco ascendente en la
entrada IN, con lo que se reinicia el sistema de enfriamiento.
El sistema de enfriamiento y el indicador luminoso se pueden apagar en todo momento con el
pulsador "PARO".

Programación del PLC
Manual de programación y manejo, 11/2019

8003

Creación de programas KOP
13.10 Ejemplos de programación KOP

Consulte también
Principios básicos de KOP (Página 7943)
Configuración de KOP (Página 7946)
Trabajar con segmentos (Página 7947)
Insertar elementos KOP (Página 7955)
Editar elementos KOP (Página 7974)
Cablear operandos en instrucciones KOP (Página 7981)
Ramas en KOP (Página 7985)
Cruces en KOP (Página 7988)
Circuitos en KOP (Página 7990)
Ejemplo de control de una cinta transportadora (Página 7992)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 7994)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 7996)
Ejemplo de cálculo de una ecuación (Página 7999)

8004

Programación del PLC
Manual de programación y manejo, 11/2019

14

Creación de programas FUP
14.1

Principios básicos de FUP

14.1.1

Lenguaje de programación FUP

Resumen del lenguaje de programación FUP (Diagrama de funciones)
FUP es un lenguaje de programación gráfico. Su representación es similar a los diagramas de
circuitos electrónicos.
El programa se mapea en uno o varios segmentos. Un segmento contiene uno o varios
circuitos lógicos. Las consultas de las señales binarias se combinan lógicamente mediante
cuadros. Para representar la lógica se utilizan los símbolos lógicos gráficos del álgebra
booleana.

Ejemplo de segmentos en FUP
La figura siguiente muestra un segmento FUP con cuadros de operaciones lógicas Y y O, así
como una asignación:
6HJPHQWR
2SHUDQGR
2SHUDQGR

! 

6DOLGD

6WRS

Consulte también
Trabajar con segmentos (Página 8009)

14.1.2

Vista general de los elementos FUP

Elementos FUP
Un programa FUP consta de distintos elementos conectados unos con otros a través del flujo
de señales binarias. Es preciso asignar variables a la mayoría de los elementos del programa.
Un segmento FUP se programa de izquierda a derecha.
La figura siguiente muestra elementos de un segmento FUP a título de ejemplo:

Programación del PLC
Manual de programación y manejo, 11/2019

8005

Creación de programas FUP
14.1 Principios básicos de FUP











1) Función binaria
2) Cuadro simple
3) Cuadro complejo

Funciones binarias
Las funciones binarias sirven para consultar los operandos binarios y combinar lógicamente
sus estados lógicos. Las operaciones lógicas "Y", "O" y "O-exclusiva" son algunos ejemplos de
funciones binarias.

Cuadros simples
Los cuadros simples sirven para controlar operandos binarios, evaluar flancos o ejecutar
funciones de salto en el programa. Generalmente, los cuadros simples tienen sólo una entrada.

Cuadros complejos
Los cuadros complejos son elementos del programa con funciones complejas. El cuadro vacío
es una excepción al respecto. Un cuadro vacío es un comodín en el que puede seleccionarse
la instrucción deseada.

8006

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.2 Configuración de FUP
Los siguientes tipos de cuadros están disponibles en un programa FUP:
● Cuadros complejos sin mecanismo EN/ENO:
El cuadro se ejecuta independientemente del estado lógico de sus entradas. No es posible
consultar el estado de errores de ejecución.
● Cuadros complejos con mecanismo EN/ENO:
Un cuadro se ejecuta únicamente si la entrada de habilitación "EN" tiene el estado lógico
"1". Si el cuadro se ejecuta correctamente, la salida de habilitación "ENO" tendrá el estado
lógico "1". Si ocurre un error durante el procesamiento, se desactiva la salida de habilitación
"ENO".
Si la entrada de habilitación EN no está interconectada, el cuadro se ejecuta siempre.
Las llamadas de bloques lógicos también se representan en el segmento como cuadros
complejos con mecanismo EN/ENO.

Consulte también
Mecanismo EN/ENO (Página 152)

14.2

Configuración de FUP

14.2.1

Resumen de la configuración de FUP

Sinopsis
La tabla siguiente muestra los ajustes que se pueden efectuar:
Grupo

Ajuste

Descripción

Fuente

Tamaño de fuente

Tamaño de fuente en el editor de pro‐
gramación

Vista

Formato

Compacto o ancho
Cambia la distancia vertical entre los
operandos y otros objetos (p. ej. ope‐
randos y contacto). El cambio efectuado
se visualiza sólo tras volver a abrir el
bloque.

Programación del PLC
Manual de programación y manejo, 11/2019

8007

Creación de programas FUP
14.2 Configuración de FUP
Grupo

Ajuste

Descripción

Campo de operando

Ancho máximo

Número máximo de caracteres que pue‐
den introducirse horizontalmente en el
campo del operando. Con este ajuste, el
diseño de los segmentos se calcula nue‐
vamente.
Tenga en cuenta que el ancho de las
cajas visualizadas también puede variar
en función de la longitud de los nombres
de los parámetros formales.

Altura máxima

Número máximo de caracteres que pue‐
den introducirse verticalmente en el
campo del operando. Con este ajuste, el
diseño de los segmentos se calcula nue‐
vamente.

Consulte también
Modificar la configuración (Página 8008)

14.2.2

Modificar la configuración

Procedimiento
Para modificar la configuración, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Modifique la configuración.

Resultado
El cambio se aplica sin necesidad de guardarlo explícitamente.

Consulte también
Resumen de la configuración de FUP (Página 8007)

8008

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.3 Trabajar con segmentos

14.3

Trabajar con segmentos

14.3.1

Utilizar segmentos

Función
El programa de usuario se crea en el bloque, dentro de segmentos. Para poder programar un
bloque lógico, este debe contener como mínimo un segmento. El programa de usuario también
se puede dividir en varios segmentos para facilitar la claridad.
En los bloques KOP y FUP también existe la posibilidad de insertar segmentos para los
lenguajes de programación textuales SCL y AWL para, posteriormente, utilizar instrucciones
en dichos lenguajes. En función de la CPU utilizada es posible insertar segmentos para los
siguientes lenguajes de programación:
● S7-300/400: segmentos AWL
● S7-1200: segmentos SCL
● S7-1500: segmentos AWL y SCL
El editor de programación siempre se adapta al segmento activo en cada momento. Esto
significa que durante la programación de un segmento SCL, por ejemplo, están disponibles
tanto las instrucciones SCL como las funciones SCL.
Nota
En segmentos SCL dentro de bloques KOP o FUP no es posible utilizar la instrucción "Saltar
(GOTO)".

Mecanismo EN/ENO en bloques programados en distintos lenguajes
El mecanismo EN/ENO se puede emplear también en bloques programados en distintos
lenguajes. Cada lenguaje de programación refleja el estado de error de distinto modo:
● SCL posee una variable "ENO" que almacena el estado de error y que puede consultarse.
El acceso directo a esta variable solo es posible en SCL.
● KOP/FUP/AWL no tienen ninguna variable especial para "ENO". Sin embargo, en AWL se
puede leer el estado de error en el bit BR y en KOP/FUP puede consultarse en la bobina
RET.
Para leer el estado de error de todo el bloque se aplican las reglas siguientes:
● El último segmento del bloque es un segmento KOP/FUP:
si no utiliza ninguna bobina RET, el estado de error es "TRUE" de forma estándar.
● El último segmento del bloque es un segmento AWL:
el bit BR determina el estado de error. El bit BR puede ser procesado por el registro BR en
los segmentos AWL.
● El último segmento del bloque es un segmento SCL:
la variable "ENO" determina el estado de error del bloque.

Programación del PLC
Manual de programación y manejo, 11/2019

8009

Creación de programas FUP
14.3 Trabajar con segmentos

Consulte también
Insertar título del segmento (Página 8013)
Introducir el comentario del segmento (Página 8015)
Navegar en segmentos (Página 8016)

14.3.2

Insertar segmentos
En un bloque KOP o FUP puede insertarse un segmento del mismo lenguaje de programación
o bien un segmento de un lenguaje de programación textual. Sin embargo, hay que tener en
cuenta que no todos los tipos de CPU son compatibles con todos los lenguajes textuales.

Requisitos
Hay un bloque KOP o FUP abierto.

Insertar un segmento KOP o FUP
Para insertar un segmento nuevo, proceda del siguiente modo:
1. Seleccione el segmento debajo del cual desea insertar un segmento nuevo.
2. Elija el comando "Insertar segmento" del menú contextual.

Insertar un segmento AWL o SCL
Para insertar un segmento nuevo, proceda del siguiente modo:
1. Seleccione el segmento debajo del cual desea insertar un segmento nuevo.
2. Elija el comando "Insertar segmento AWL" o "Insertar segmento SCL" del menú contextual.

Resultado
Se inserta un nuevo segmento vacío en el bloque en el lenguaje de programación
correspondiente.

Consulte también
Insertar título del segmento (Página 8013)
Introducir el comentario del segmento (Página 8015)
Navegar en segmentos (Página 8016)

8010

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.3 Trabajar con segmentos

14.3.3

Seleccionar segmentos

Requisitos
Existe un segmento.

Seleccionar un segmento
Para seleccionar un segmento, proceda del siguiente modo:
1. Haga clic en la barra de título del segmento que desea seleccionar.

Seleccionar varios segmentos
Para seleccionar varios segmentos individuales, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Ctrl>.
2. Haga clic en todos los segmentos que desea seleccionar.
Para seleccionar varios segmentos consecutivos, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Mayús>.
2. Haga clic en el primer segmento que desea seleccionar.
3. Haga clic en el último segmento que desea seleccionar.
Se seleccionan el primer y último segmento, así como todos los segmentos que se
encuentran entre éstos.

Consulte también
Utilizar segmentos (Página 8009)
Insertar segmentos (Página 8010)
Insertar título del segmento (Página 8013)
Introducir el comentario del segmento (Página 8015)
Navegar en segmentos (Página 8016)

14.3.4

Copiar e insertar segmentos
Los segmentos copiados pueden insertarse en el mismo bloque o en un bloque diferente. Los
segmentos creados en KOP o FUP también pueden insertarse en los bloques de cada uno de
los lenguajes de programación diferentes.

Requisitos
Existe un segmento.

Programación del PLC
Manual de programación y manejo, 11/2019

8011

Creación de programas FUP
14.3 Trabajar con segmentos

Procedimiento
Para copiar e insertar un segmento, proceda del siguiente modo:
1. Seleccione el o los segmentos que desea copiar.
2. Elija el comando "Copiar" del menú contextual.
3. Seleccione el segmento debajo del cual desea insertar el segmento copiado.
4. Elija el comando "Pegar" del menú contextual.

Consulte también
Utilizar segmentos (Página 8009)
Insertar segmentos (Página 8010)
Seleccionar segmentos (Página 8011)
Insertar título del segmento (Página 8013)
Introducir el comentario del segmento (Página 8015)
Navegar en segmentos (Página 8016)

14.3.5

Borrar segmentos

Requisitos
Existe un segmento.

Procedimiento
Para borrar un segmento, proceda del siguiente modo:
1. Seleccione el segmento que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Utilizar segmentos (Página 8009)
Insertar segmentos (Página 8010)
Seleccionar segmentos (Página 8011)
Copiar e insertar segmentos (Página 8011)
Insertar título del segmento (Página 8013)
Introducir el comentario del segmento (Página 8015)
Navegar en segmentos (Página 8016)

8012

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.3 Trabajar con segmentos

14.3.6

Contraer y expandir segmentos

Requisitos
Existe un segmento.

Expandir y contraer un segmento
Para abrir un segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia la derecha situada en la barra de título del segmento.
Para cerrar un segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia abajo situada en la barra de título del segmento.

Expandir y contraer todos los segmentos
Para expandir o contraer todos los segmentos, proceda del siguiente modo:
1. Haga clic en el botón "Abrir todos los segmentos" o "Cerrar todos los segmentos" de la barra
de herramientas.

Consulte también
Utilizar segmentos (Página 8009)
Insertar segmentos (Página 8010)
Seleccionar segmentos (Página 8011)
Copiar e insertar segmentos (Página 8011)
Borrar segmentos (Página 8012)
Insertar título del segmento (Página 8013)
Introducir el comentario del segmento (Página 8015)
Navegar en segmentos (Página 8016)

14.3.7

Insertar título del segmento
El título de segmento es la cabecera de un segmento. La longitud del título del segmento está
limitada a una línea. Puede introducir el título manualmente o definirlo de forma automática. Si
elige el ajuste automático, puede aplicarlo a segmentos individuales o establecer en la
configuración que el título del segmento debe definirse de forma automática.
Para la inserción automática del título del segmento se evalúa el comentario del operando de
una de las siguientes instrucciones del segmento:
● Asignación
● Activar salida
● Desactivar salida

Programación del PLC
Manual de programación y manejo, 11/2019

8013

Creación de programas FUP
14.3 Trabajar con segmentos
Para ello, se utiliza la instrucción que aparece primero en el segmento.
El título del segmento solo se inserta automáticamente si se cumplen las siguientes
condiciones:
● El segmento todavía no tiene ningún título.
● El operando de la instrucción que se utiliza para el comentario tiene un comentario.
Nota
Al insertar el título del segmento de forma automática, tenga en cuenta las siguientes
limitaciones:
● Si modifica el comentario del operando con posterioridad, el título del segmento no se
actualiza.
● Si cambia el operando de la instrucción, el título del segmento no se actualiza.
● El título del segmento solo se define mediante las instrucciones de escritura citadas antes.
● Si el operando es del tipo de datos Array, se utiliza el comentario del Array y no los
comentarios de los elementos Array.
● No se tienen en cuenta los comentarios de operandos no válidos.

Introducir el título del segmento manualmente
Para introducir un título de segmento, proceda del siguiente modo:
1. Haga clic en la barra de título del segmento.
2. Introduzca el título de segmento.

Definir el título del segmento automáticamente
Para establecer que el título del segmento debe definirse fundamentalmente de forma
automática, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Active la casilla de verificación "Establecer título del segmento automáticamente" en el
grupo "Configuración avanzada".
Desde este momento, los títulos de los segmentos se definirán automáticamente si se
cumplen las condiciones anteriores.
Para definir automáticamente un título de segmento concreto, proceda del siguiente modo:
1. Haga clic en la barra de título de un segmento con el botón derecho del ratón y seleccione
"Segmento <Número del segmento>".
2. Elija el comando "Establecer título del segmento automáticamente" del menú contextual.
El título del segmento seleccionado se define a partir del comentario del operando si se
cumplen las condiciones anteriores.

8014

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.3 Trabajar con segmentos

Consulte también
Utilizar segmentos (Página 8009)
Insertar segmentos (Página 8010)
Seleccionar segmentos (Página 8011)
Copiar e insertar segmentos (Página 8011)
Borrar segmentos (Página 8012)
Contraer y expandir segmentos (Página 8013)
Introducir el comentario del segmento (Página 8015)
Navegar en segmentos (Página 8016)

14.3.8

Introducir el comentario del segmento
Los comentarios de segmentos sirven para documentar el contenido del programa en los
distintos segmentos. Por ejemplo, es posible describir la función del segmento, o bien llamar
la atención sobre peculiaridades.

Requisitos
Existe un segmento.

Procedimiento
Para introducir un comentario de segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia la derecha antepuesta al título del segmento.
2. Si el área de comentarios no resulta visible, haga clic en el botón "Activar/desactivar
comentarios de segmento" de la barra de herramientas.
Se abre el área de comentarios.
3. En el área de comentario, haga clic en "Comentario".
El texto "Comentario" aparece seleccionado.
4. Introduzca el comentario del segmento.

Consulte también
Utilizar segmentos (Página 8009)
Insertar segmentos (Página 8010)
Seleccionar segmentos (Página 8011)
Copiar e insertar segmentos (Página 8011)
Borrar segmentos (Página 8012)
Contraer y expandir segmentos (Página 8013)

Programación del PLC
Manual de programación y manejo, 11/2019

8015

Creación de programas FUP
14.3 Trabajar con segmentos
Insertar título del segmento (Página 8013)
Navegar en segmentos (Página 8016)

14.3.9

Navegar en segmentos
Existe la posibilidad de navegar en un bloque directamente hasta una posición determinada.

Procedimiento
Para navegar en un bloque hasta una posición determinada, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la sección de lógica de la ventana de
programación.
2. Elija el comando "Ir a > Segmento/línea" del menú contextual.
Se abre el cuadro diálogo "Ir a".
3. Introduzca el segmento hasta el que desea navegar.
4. Introduzca el número de la fila del segmento hasta el que desea navegar.
5. Confirme la entrada realizada con "Aceptar".

Resultado
Si es posible, se muestra la fila correspondiente. En caso de que el segmento o la fila deseados
no existan, se visualiza el último segmento existente, o bien, la última fila existente en el
segmento deseado.

Consulte también
Utilizar segmentos (Página 8009)
Insertar segmentos (Página 8010)
Seleccionar segmentos (Página 8011)
Copiar e insertar segmentos (Página 8011)
Borrar segmentos (Página 8012)
Contraer y expandir segmentos (Página 8013)
Insertar título del segmento (Página 8013)
Introducir el comentario del segmento (Página 8015)

8016

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.4 Insertar elementos FUP

14.4

Insertar elementos FUP

14.4.1

Reglas para utilizar elementos FUP

Reglas
Tenga en cuenta las reglas siguientes al insertar elementos FUP:
● Un segmento FUP puede constar de varios elementos. Todos los elementos de un circuito
lógico deben estar conectados entre sí según IEC 61131-3.
● A los cuadros con operaciones lógicas binarias (p. ej. Y, O) se pueden añadir cuadros
estándar (flipflops, contadores, temporizadores, operaciones aritméticas, etc.) como
salida. Los cuadros de comparación son una excepción.
● Sólo las entradas booleanas de una instrucción pueden ir precedidas de una operación
lógica.
● Sólo la última salida booleana de una instrucción se puede combinar mediante una
operación lógica.
● Es posible cablear la entrada de habilitación EN y/o la salida de habilitación ENO de
cuadros, pero no es absolutamente necesario.
● A las operaciones lógicas binarias no se pueden asignar constantes, p. ej. con TRUE o
FALSE. Utilice variables del tipo de datos BOOL en su lugar.
● En un segmento sólo se puede insertar una instrucción de salto.
● Sólo se puede insertar una etiqueta por segmento.
● Las instrucciones con evaluación de flancos positivos o negativos no se pueden colocar en
el extremo izquierdo del segmento, ya que requieren una operación lógica previa.

Reglas de posicionamiento para CPU S7-1200/1500
La siguiente tabla muestra las instrucciones que sólo pueden posicionarse al final del
segmento:
Instrucción
Nombre

Operación lógica previa necesa‐
ria

SET_BF

Activar mapa de bits

No

RESET_BF

Desactivar mapa de bits

No

JMP

Saltar si RLO = 1

No

JMPN

Saltar si RLO = 0

Sí

JMP_LIST

Definir lista de saltos

No

SWITCH

Distribuidor de saltos

No

RET

Retroceder

No

Nemónicos

Programación del PLC
Manual de programación y manejo, 11/2019

8017

Creación de programas FUP
14.4 Insertar elementos FUP

Reglas de posicionamiento para CPU S7-300/400
La siguiente tabla muestra las instrucciones que sólo pueden posicionarse al final del
segmento:

Nemónicos Nombre

Instrucción

Operación lógica previa necesa‐
ria

S

Activar salida

Sí

R

Desactivar salida

Sí

SP

Arrancar temporizador como impulso

Sí

SE

Arrancar temporizador como impulso prolongado

Sí

SD

Arrancar temporizador como retardo a la conexión

Sí

SS

Arrancar temporizador como retardo a la conexión con
memoria

Sí

SF

Arrancar temporizador como retardo a la desconexión Sí

SC

Poner contador al valor inicial

Sí

CU

Contador ascendente

Sí

CD

Contador descendente

Sí

JMP

Saltar si RLO = 1

No

JMPN

Saltar si RLO = 0

Sí

RET

Retroceder

No

OPN

Abrir bloque de datos global

No

OPNI

Abrir bloque de datos de instancia

No

CALL

Llamar bloque

No

SAVE

Guardar RLO en bit BR

No

MCRA

Activar área MCR

No

MCRD

Desactivar área MCR

No

MCR<

Abrir áreas MCR

No

MCR>

Cerrar áreas MCR

No

Nota
Llamada de bloques con entradas binarias en CPU S7-300/400
La siguiente FAQ describe las particularidades de la llamada de bloques con entradas binarias:
FAQ 13988019: ¿Qué hay que tener en cuenta a la hora de programar llamadas FB/FC
anidadas con entradas binarias? (https://support.industry.siemens.com/cs/de/de/view/
13988019)

14.4.2

Insertar elementos FUP mediante la Task Card "Instrucciones"

Requisitos
Existe un segmento.

8018

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.4 Insertar elementos FUP

Procedimiento
Para insertar un elemento FUP en un segmento mediante la Task Card "Instrucciones",
proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. Navegue hasta el elemento FUP que desea insertar.
3. Arrastre el elemento hasta la posición deseada del segmento mediante Drag & Drop.
Si el elemento ejerce de bloque de función (FB) internamente en el sistema, se abre el
cuadro de diálogo "Opciones de llamada". Este cuadro de diálogo permite especificar si los
datos del elemento insertado deben guardarse en una instancia individual, en una
multiinstancia o en una instancia de parámetro. Si se selecciona "Instancia individual", el
nuevo bloque de datos de instancia se encuentra, después de crearse, en la carpeta
"Recursos de programa" del árbol del proyecto, bajo "Bloques de programa > Bloques de
sistema". Las multiinstancias se encuentran en la sección "Static" de la interfaz del bloque
y las instancias de parámetro, en la sección "InOut".
O bien:
1. Seleccione la posición del segmento en la que desea insertar el elemento.
2. Abra la Task Card "Instrucciones".
3. Haga doble clic en el elemento que desea insertar.
Si el elemento ejerce de bloque de función (FB) internamente en el sistema, se abre el
cuadro de diálogo "Opciones de llamada". Este cuadro de diálogo permite especificar si los
datos del elemento insertado deben guardarse en una instancia individual, en una
multiinstancia o en una instancia de parámetro. Si se selecciona "Instancia individual", el
nuevo bloque de datos de instancia se encuentra, después de crearse, en la carpeta
"Recursos de programa" del árbol del proyecto, bajo "Bloques de programa > Bloques de
sistema". Las multiinstancias se encuentran en la sección "Static" de la interfaz del bloque
y las instancias de parámetro, en la sección "InOut".

Resultado
El elemento FUP seleccionado se inserta con comodines para los parámetros.

Consulte también
Reglas para utilizar elementos FUP (Página 8017)
Instancias individuales (Página 62)
Multiinstancias (Página 64)
Instancias de parámetro (Página 67)

14.4.3

Insertar elementos FUP mediante un cuadro vacío

Requisitos
Existe un segmento.

Programación del PLC
Manual de programación y manejo, 11/2019

8019

Creación de programas FUP
14.4 Insertar elementos FUP

Procedimiento
Para insertar un elemento FUP en un segmento mediante un cuadro vacío, proceda del
siguiente modo:
1. Abra la Task Card "Instrucciones".
2. En la paleta "Instrucciones básicas", navegue hasta "General > Cuadro vacío".
3. Arrastre el elemento "Cuadro vacío" hasta la posición deseada del segmento mediante
Drag & Drop.
4. Sitúe el puntero del ratón sobre el triángulo de la esquina superior derecha del cuadro vacío.
Se abre una lista desplegable.
5. Seleccione el elemento FUP deseado de la lista desplegable.
Si el elemento ejerce de bloque de función (FB) internamente en el sistema, se abre el
cuadro de diálogo "Opciones de llamada". Este cuadro de diálogo permite especificar si los
datos del elemento insertado deben guardarse en una instancia individual, en una
multiinstancia o en una instancia de parámetro. Si se selecciona "Instancia individual", el
nuevo bloque de datos de instancia se encuentra, después de crearse, en la carpeta
"Recursos de programa" del árbol del proyecto, bajo "Bloques de programa > Bloques de
sistema". Las multiinstancias se encuentran en la sección "Static" de la interfaz del bloque
y las instancias de parámetro, en la sección "InOut".

Resultado
El cuadro vacío se transforma en el elemento FUP correspondiente. Para los parámetros se
insertan comodines.

Consulte también
Instancias individuales (Página 62)
Multiinstancias (Página 64)
Instancias de parámetro (Página 67)

8020

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.4 Insertar elementos FUP

14.4.4

Seleccionar el tipo de datos de un elemento FUP

14.4.4.1

Seleccionar un tipo de datos

Introducción
Algunas instrucciones pueden ejecutarse con varios tipos de datos diferentes. Si en el
programa se utiliza alguna de estas instrucciones, en la ubicación concreta del programa es
preciso definir un tipo de datos permitido para la instrucción en cuestión. Para algunas
instrucciones es necesario seleccionar los tipos de datos para las entradas y para las salidas
por separado.
Nota
El sistema predetermina el tipo de datos permitido (BOOL) para las variables de la entrada de
habilitación EN y la salida de habilitación ENO. Este tipo de datos no se puede modificar.
Los tipos de datos admisibles para una instrucción se indican en la lista desplegable
correspondiente. Seleccionando una entrada de la lista desplegable se determina el tipo de
datos de la instrucción. Si el tipo de datos de un operando difiere del tipo de datos de la
instrucción y no puede convertirse de forma implícita, el operando se muestra en color rojo y
aparece una ventana desplegable con el mensaje de error correspondiente.

Selección de un tipo de datos de instrucciones matemáticas
Algunas instrucciones matemáticas ofrecen la posibilidad de ajustar automáticamente el tipo
de datos adecuado respecto a los tipos de datos de los operandos. En la lista desplegable para
seleccionar el tipo de datos, dichas instrucciones tienen, además de los tipos de datos
propiamente dichos, la entrada "Auto". Si se selecciona esta entrada y se activa el primer
operando, el tipo de datos del operando se utiliza como tipo de datos para la instrucción. La
entrada de la lista desplegable cambia a "Auto (<tipo de datos>)", p. ej. "Auto (Real)". Si se
activan otros operandos, el tipo de datos de la instrucción, ajustado automáticamente, se
adapta según los criterios siguientes:
● Transfieren variables del mismo tipo de datos al resto de operandos:
El tipo de datos de la instrucción no se modifica.
● Transfieren al resto de operandos variables cuyo tipo de datos es inferior al tipo de datos
de la instrucción:
El tipo de datos de la instrucción no se modifica. Para los operandos del tipo de datos
inferior se realiza, si es necesario, una conversión implícita.
● Transfieren a otro operando una variable cuyo tipo de datos es superior al tipo de datos de
la instrucción:
El tipo de datos de la instrucción cambia al tipo de datos superior. Para los operandos que
difieren del tipo de datos de la instrucción recién ajustado se realiza, si es necesario, una
conversión implícita.
Cualquier modificación del tipo de datos de un operando puede provocar otros cambios en el
tipo de datos de la instrucción. De este modo, es posible que otros operandos también se

Programación del PLC
Manual de programación y manejo, 11/2019

8021

Creación de programas FUP
14.4 Insertar elementos FUP
conviertan de forma implícita. Los operandos para los que se realiza una conversión implícita
se marcan con un cuadrado gris.
Nota
Tenga en cuenta también la información relativa a la conversión de tipos de datos de su
dispositivo y, particularmente en este caso, las indicaciones en materia de verificación CEI.
Consulte también: Conversión de tipos de datos (Página 506)

Consulte también
Definir el tipo de datos de una instrucción (Página 8022)

14.4.4.2

Definir el tipo de datos de una instrucción

Introducción
Algunas instrucciones pueden ejecutarse con varios tipos de datos diferentes. Si se insertan
este tipo de instrucciones en el programa, es preciso definir el tipo de datos adecuado para
ellas en la ubicación concreta del programa.

Definir el tipo de datos mediante la lista desplegable
Para definir el tipo de datos de una instrucción mediante la lista desplegable, proceda del
siguiente modo:
1. Arrastre la instrucción mediante Drag & Drop hasta la posición deseada del programa.
En la lista desplegable de la instrucción insertada se visualiza la entrada "???" (no definida).
2. Haga clic en el triángulo situado en la esquina superior de la lista desplegable.
Ésta se abre y se visualizan los tipos de datos admisibles para la instrucción.
3. Seleccione un tipo de datos de la lista desplegable.
Aparece el tipo de datos seleccionado.
4. Si la instrucción dispone de dos listas desplegables, seleccione el tipo de datos de las
entradas en la lista desplegable izquierda y el de las salidas en la derecha.

8022

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.4 Insertar elementos FUP

Definir el tipo de datos asignando variables
Para definir el tipo de datos de una instrucción asignando variables, proceda del siguiente
modo:
1. Arrastre la instrucción mediante Drag & Drop hasta la posición deseada del programa.
En la lista desplegable de la instrucción insertada se visualiza la entrada "???" (no definida).
2. Introduzca en una entrada o salida una variable válida cuyo tipo de datos deba adoptarse
como tipo de datos de la instrucción.
El tipo de datos de la variable aparece en la lista desplegable.
3. Si deben definirse tipos de datos tanto para las entradas como para las salidas de la
instrucción, indique sendas variables válidas en una entrada y una salida. La variable
indicada en la entrada determina el tipo de datos de las entradas y, la indicada en la salida,
el tipo de datos de las salidas de la instrucción.

Definir automáticamente el tipo de datos de instrucciones matemáticas
Para definir automáticamente el tipo de datos de las instrucciones matemáticas, proceda del
siguiente modo:
1. Arrastre la instrucción matemática mediante Drag & Drop hasta la posición deseada del
programa.
En la lista desplegable de la instrucción insertada se visualiza la entrada "???" (no definida).
2. Seleccione la entrada "Auto" en la lista desplegable.
3. Indique una variable válida en una entrada o salida.
El tipo de datos de la variable se adoptará como tipo de datos de la instrucción. La entrada
de la lista desplegable cambia a "Auto (<tipo de datos>)".
Consulte también: Seleccionar un tipo de datos (Página 8021)

Consulte también
Seleccionar un tipo de datos (Página 8021)

14.4.5

Emplear favoritos en FUP

14.4.5.1

Agregar elementos FUP a los Favoritos

Requisitos
● Hay un bloque abierto.
● La Task Card "Instrucciones" tiene configurado el modo multipaleta, o bien los Favoritos se
muestran también en el editor.

Programación del PLC
Manual de programación y manejo, 11/2019

8023

Creación de programas FUP
14.4 Insertar elementos FUP

Procedimiento
Para agregar instrucciones a los Favoritos, proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. Maximice la paleta "Instrucciones básicas".
3. En la paleta "Instrucciones básicas", navegue hasta la instrucción que desea agregar a los
Favoritos.
4. Arrastre la instrucción hasta la paleta "Favoritos" o hasta el área de Favoritos del editor de
programación mediante Drag & Drop.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Quitar elementos FUP de los Favoritos (Página 8025)
Sinopsis del editor de programación (Página 7657)

14.4.5.2

Insertar elementos FUP mediante Favoritos

Requisitos
● Hay un bloque abierto.
● Existen Favoritos.

Procedimiento
Para insertar una instrucción en un programa desde los Favoritos, proceda del siguiente modo:
1. Arrastre la instrucción deseada mediante Drag & Drop desde los Favoritos hasta la posición
deseada.
O bien:
1. Marque el punto del programa en el que quiere insertar la instrucción.
2. En los Favoritos, haga clic en la instrucción que desea insertar.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

8024

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.4 Insertar elementos FUP

Consulte también
Sinopsis del editor de programación (Página 7657)
Quitar elementos FUP de los Favoritos (Página 8025)

14.4.5.3

Quitar elementos FUP de los Favoritos

Requisitos
Hay un bloque lógico abierto.

Procedimiento
Para eliminar instrucciones de los Favoritos, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la instrucción que desea eliminar.
2. Elija el comando "Eliminar instrucción" del menú contextual.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Agregar elementos FUP a los Favoritos (Página 8023)
Insertar elementos FUP mediante Favoritos (Página 8024)
Sinopsis del editor de programación (Página 7657)

14.4.6

Insertar llamadas de bloque en FUP

14.4.6.1

Insertar llamadas de bloque mediante Drag & Drop
Las llamadas de funciones (FC) y bloques de función (FB) existentes pueden insertarse desde
el árbol del proyecto mediante Drag & Drop. Al llamar bloques de función desde otros bloques
de función, es posible hacerlo como instancia individual, multiinstancia o instancia de
parámetro.
Consulte también: Principios básicos de las instancias (Página 61)

Programación del PLC
Manual de programación y manejo, 11/2019

8025

Creación de programas FUP
14.4 Insertar elementos FUP

Requisitos
● Existe un segmento.
● El bloque que se debe llamar existe.

Insertar una llamada de una función (FC)
Para insertar una llamada de una función (FC) mediante Drag & Drop en un segmento, proceda
del siguiente modo:
1. Arrastre la función desde el árbol del proyecto hasta el segmento deseado.

Insertar una llamada de un bloque de función (FB)
Para insertar una llamada de un bloque de función (FB), proceda del siguiente modo:
1. Arrastre el bloque de función desde el árbol del proyecto hasta el segmento deseado.
Se abre el cuadro de diálogo "Opciones de llamada".
2. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Si hace clic en el botón "Instancia individual", introduzca seguidamente un nombre en el
campo de entrada "Nombre" para el bloque de datos que se debe asignar al bloque de
función.
Si se llama un bloque que contenga supervisiones, asigne un bloque de función ProDiag
a dichas supervisiones en el campo de entrada "FB ProDiag".
– Si hace clic en el botón "Multiinstancia", introduzca seguidamente en el campo de
entrada "Nombre de la interfaz" el nombre de la variable con el que el bloque de función
llamado se debe introducir como variable estática en la interfaz del bloque que efectúa
la llamada.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.
3. Confirme las entradas con "Aceptar".

Resultado
La función o el bloque de función se inserta con sus respectivos parámetros. Los valores de
estos parámetros pueden asignarse más tarde.
Consulte también: Transferencia de parámetros en la llamada de un bloque (Página 80)
Nota
Si al llamar un bloque de función especifica un bloque de datos de instancia que no existe aún,
éste se creará.

8026

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.4 Insertar elementos FUP

Consulte también
Actualizar llamadas de bloque en FUP (Página 8027)
Cambiar el tipo de instancia (Página 8029)
Instancias individuales (Página 62)
Multiinstancias (Página 64)

14.4.6.2

Actualizar llamadas de bloque en FUP
Si cambian los parámetros de interfaz de un bloque llamado, la llamada no podrá ejecutarse
correctamente. Actualice las llamadas de bloque con objeto de evitar llamadas incoherentes.
Las llamadas de bloque se pueden actualizar de distinta manera:
● Actualización explícita de todas las llamadas de bloque incoherentes en el editor de
programación.
Se actualizan las llamadas de bloque incoherentes del bloque abierto. Para ello se llevan
a cabo las acciones siguientes:
– Se agregan parámetros nuevos.
– Se eliminan parámetros borrados si no están conectados.
– Los parámetros a los que se ha cambiado el nombre adoptan el nombre nuevo.
● Actualización explícita de una llamada de bloque en el editor de programación.
Se muestra el cuadro de diálogo "Sincronización de interfaces". En este cuadro de diálogo
existe la posibilidad de cambiar la conexión de los operandos de la nueva interfaz.
Seguidamente se actualiza la llamada incoherente de este bloque. Para ello se llevan a
cabo las acciones siguientes:
– Se agregan parámetros nuevos.
– Se eliminan parámetros borrados si no están conectados.
– Los parámetros a los que se ha cambiado el nombre adoptan el nombre nuevo.
● Actualización implícita durante la compilación.
Se actualizan todas las llamadas de bloque en el programa, así como los tipos de datos
PLC utilizados. Tenga en cuenta que si se llaman funciones (FC) antes del siguiente
proceso de compilación deberán asignarse parámetros actuales a todos los parámetros
formales nuevos.

Actualizar todas las llamadas de bloque incoherentes en el editor de programación
Para actualizar todas las llamadas de bloque en un bloque, proceda del siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic en el botón "Actualizar llamadas de bloque incoherentes" de la barra de
herramientas.

Programación del PLC
Manual de programación y manejo, 11/2019

8027

Creación de programas FUP
14.4 Insertar elementos FUP

Actualizar una llamada de bloque determinada en el editor de programación
Para actualizar una llamada de bloque determinada en el editor de programación, proceda del
siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic con el botón derecho del ratón en la llamada de bloque que desea actualizar.
3. Elija el comando "Actualizar" del menú contextual.
Se abre el cuadro de diálogo "Sincronización de la interfaz". En él se visualizan las
diferencias entre la interfaz utilizada y la interfaz modificada del bloque llamado.
4. De ser necesario modifique la conexión de los operandos. Para ello existen las
posibilidades siguientes:
– Es posible pasar un operando de la interfaz antigua a la nueva bien con la función
Drag&Drop bien con la función de cortar o copiar y pegar.
– Es posible borrar un operando.
– Es posible cambiar el nombre de un operando.
– Es posible indicar un operando nuevo mediante la función de autocompletar.
5. Haga clic en "Aceptar" para actualizar la llamada de bloque. Si desea cancelar la
actualización, haga clic en "Cancelar".
Nota
Tenga en cuenta que el comando "Actualizar llamada de bloque" no estará disponible si
previamente ha actualizado todas las llamadas de bloque en el editor con el comando
"Actualizar llamadas de bloque incoherentes".

Actualizar llamadas de bloque durante la compilación
Para actualizar implícitamente todas las llamadas de bloque y usos de tipos de datos PLC
durante la compilación, proceda del siguiente modo:
1. Abra el árbol del proyecto.
2. Seleccione la carpeta "Bloques de programa".
3. En el menú contextual, elija el comando "Compilar > Software (compilar todos los bloques)".

Consulte también
Insertar llamadas de bloque mediante Drag & Drop (Página 8025)
Cambiar el tipo de instancia (Página 8029)
Llamadas de bloque (Página 59)

8028

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.4 Insertar elementos FUP

14.4.6.3

Modificar una llamada de bloque
En una llamada de bloque se puede modificar el bloque llamado. No obstante, recuerde que
al hacerlo no se generan nuevos bloques de datos de instancia, p. ej. al cambiar de una función
(FC) a un bloque de función (FB).

Procedimiento
Para cambiar el bloque llamado en una llamada de bloque, proceda del siguiente modo:
1. Dentro de la llamada del bloque, haga clic en el nombre del bloque llamado y pulse la tecla
<F2>. O haga doble clic en el nombre del bloque llamado.
Se abre un campo de entrada y el nombre del bloque llamado actualmente aparece
seleccionado.
2. Introduzca el nombre del bloque que desea llamar o seleccione un bloque con la función de
autocompletar.
3. Para llamar un FB, cree, dado el caso, un bloque de datos de instancia nuevo e indíquelo
como operando.

14.4.6.4

Cambiar el tipo de instancia

Tipo de instancia
Los bloques de función se pueden llamar de maneras diferentes, a saber:
● Como instancia individual
● Como multiinstancia
● Como instancia de parámetro
Consulte también: Principios básicos de las instancias (Página 61)
El tipo de instancia definido se puede modificar en todo momento.

Requisitos
El programa de usuario contiene una llamada de bloque.

Procedimiento
Para cambiar el tipo de instancia de un bloque de función, proceda del siguiente modo:
1. Abra el bloque lógico y seleccione la llamada de bloque.
2. Elija el comando "Cambiar instancia" del menú contextual.
Se abre el cuadro de diálogo "Opciones de llamada".

Programación del PLC
Manual de programación y manejo, 11/2019

8029

Creación de programas FUP
14.4 Insertar elementos FUP
3. Haga clic en el botón "Instancia individual", "Multiinstancia" o "Instancia de parámetro".
– Si selecciona el tipo de instancia "Instancia individual", introduzca un nombre para el
bloque de datos que debe asignarse al bloque de función.
– Si selecciona el tipo de instancia "Multiinstancia", introduzca en el campo de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si se selecciona el tipo de instancia "Instancia de parámetro", introduzca seguidamente
en el campo de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/
salida (InOut) al que debe transferirse la instancia en tiempo de ejecución.
4. Confirme las entradas con "Aceptar".
Nota
Las instancias anteriores no se borran automáticamente.

Consulte también
Insertar llamadas de bloque mediante Drag & Drop (Página 8025)
Actualizar llamadas de bloque en FUP (Página 8027)
Instancias (Página 61)

14.4.7

Insertar instrucciones FUP complejas

14.4.7.1

Utilizar la instrucción "Calcular"

Requisitos
Existe un segmento.

Procedimiento
Para utilizar la instrucción "Calcular", proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. En la paleta "Instrucciones básicas", navegue hasta "Funciones matemáticas >
CALCULATE".
3. Arrastre el elemento hasta la posición deseada del segmento mediante Drag & Drop.
La instrucción "Calcular" se inserta con una expresión comodín y signos de interrogación
para el tipo de datos.
4. Introduzca el tipo de datos para el cálculo.

8030

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.4 Insertar elementos FUP
5. Introduzca los operandos para el cálculo.
Nota
El cálculo se lleva a cabo con las entradas de la instrucción "Calcular". Por ello, si desea
utilizar constantes debe insertar también las entradas correspondientes para las
constantes.
6. Haga clic en el botón "Editar instrucción "Calcular"" para reemplazar la expresión comodín
por la expresión correcta.
Se abre el cuadro de diálogo "Editar instrucción "Calcular"".
7. Introduzca la expresión deseada en el campo de texto "OUT:= ".
Nota
En el área "Ejemplo" dispone de un ejemplo de expresión válida y de las posibles
instrucciones que se pueden utilizar.
P. ej., para determinar un valor mediante el teorema de Pitágoras introduzca la expresión
"OUT := SQRT (SQR (IN1) + SQR (IN2))".
8. Confirme las entradas con "Aceptar".

Consulte también
CALCULATE: Calcular (Página 1142)

14.4.8

Utilizar comentarios libres

14.4.8.1

Principios básicos de la utilización de comentarios libres en FUP

Introducción
Los comentarios libres permiten comentar el código fuente de los lenguajes de programación
gráficos, de manera similar a los comentarios de línea de los lenguajes textuales.
Los comentarios libres pueden utilizarse para todos los cuadros no binarios.

Marcar el código de programa como comentario
Para desactivar instrucciones individuales o partes enteras del programa en los lenguajes de
programación KOP y FUP, hay que activar un bit de forma paralela a la instrucción o en serie
con un bloque de instrucción. En KOP y FUP no es posible marcar líneas como comentarios
como en AWL y SCL.
Encontrará ejemplos sobre el marcado de líneas de código como comentario en todos los
lenguajes de programación en el Siemens Industry Online Support, en la FAQ con la ID:
109482004 (https://support.industry.siemens.com/cs/ww/es/view/109482004)

Programación del PLC
Manual de programación y manejo, 11/2019

8031

Creación de programas FUP
14.4 Insertar elementos FUP

Consulte también
Insertar comentarios libres (Página 8032)
Editar comentarios libres (Página 8032)
Borrar comentarios libres (Página 8034)

14.4.8.2

Insertar comentarios libres

Requisitos
Existe un segmento con instrucciones.

Procedimiento
Para añadir un comentario libre relativo a una instrucción, proceda del siguiente modo:
1. Si es preciso, pulse el botón "Mostrar/ocultar comentarios libres" de la barra de
herramientas.
2. Haga clic con el botón derecho del ratón en la instrucción para la que desea insertar un
comentario libre.
3. Elija el comando "Insertar comentario" del menú contextual.
Se abre un cuadro de comentario con un comentario estándar. El cuadro de comentario
está unido con la instrucción correspondiente por medio de una flecha.
4. Introduzca el comentario deseado en el cuadro de comentario.

Consulte también
Principios básicos de la utilización de comentarios libres en FUP (Página 8031)
Editar comentarios libres (Página 8032)
Borrar comentarios libres (Página 8034)

14.4.8.3

Editar comentarios libres

Introducción
Los comentarios libres pueden editarse como se indica a continuación:
● Modificar el texto del comentario
● Modificar la posición y el tamaño del cuadro de comentario
● Acoplar el comentario a un elemento diferente
● Mostrar y ocultar comentarios libres

8032

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.4 Insertar elementos FUP

Modificar el texto del comentario
Para modificar el texto de un comentario libre, proceda del siguiente modo:
1. Haga clic en el cuadro de comentario.
2. Introduzca el texto deseado.

Modificar la posición del cuadro de comentario
Para modificar la posición del cuadro de comentario, proceda del siguiente modo:
1. Haga clic en el cuadro de comentario y mantenga oprimido el botón del ratón.
2. Arrastre el cuadro de comentario hasta la posición deseada.

Modificar el tamaño del cuadro de comentario
Para modificar el tamaño del cuadro de comentario, proceda del siguiente modo:
1. Haga clic en el cuadro de comentario.
2. Arrastre el controlador de tamaño de la esquina inferior derecha del cuadro de comentario
hasta alcanzar el tamaño deseado.

Acoplar el comentario a un elemento diferente
Para acoplar un comentario libre a un elemento diferente, proceda del siguiente modo:
1. Haga clic en la punta de la flecha que une el cuadro de comentario con la instrucción y
mantenga oprimido el botón del ratón.
2. Arrastre la flecha hasta el elemento al que desea acoplar el comentario. Los puntos de
inserción posibles se identifican con un cuadrado verde.
3. Suelte el botón del ratón.

Mostrar y ocultar comentarios libres
Para mostrar y ocultar los comentarios libres, proceda del siguiente modo:
1. Haga clic en el botón "Mostrar/ocultar comentarios libres" de la barra de herramientas.

Consulte también
Principios básicos de la utilización de comentarios libres en FUP (Página 8031)
Insertar comentarios libres (Página 8032)
Borrar comentarios libres (Página 8034)

Programación del PLC
Manual de programación y manejo, 11/2019

8033

Creación de programas FUP
14.5 Editar elementos FUP

14.4.8.4

Borrar comentarios libres

Procedimiento
Para borrar un comentario libre, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el comentario libre que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Principios básicos de la utilización de comentarios libres en FUP (Página 8031)
Insertar comentarios libres (Página 8032)
Editar comentarios libres (Página 8032)

14.5

Editar elementos FUP

14.5.1

Seleccionar elementos FUP
Se pueden seleccionar varios elementos individuales o todos los elementos de un segmento.

Requisitos
Existen elementos FUP.

Seleccionar varios elementos FUP individuales
Para seleccionar varios elementos FUP individuales, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Ctrl>.
2. Haga clic en los elementos FUP que desea seleccionar.
3. Suelte la tecla <Ctrl>.

Seleccionar todos los elementos FUP de un segmento
Para seleccionar todos los elementos FUP de un segmento, proceda del siguiente modo:
1. Haga clic en el segmento cuyos elementos desea seleccionar.
2. Elija el comando "Seleccionar todo" del menú "Edición" o utilice la combinación de teclas
<Ctrl+E>.

8034

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.5 Editar elementos FUP

Consulte también
Copiar elementos FUP (Página 8035)
Cortar elementos FUP (Página 8036)
Insertar elementos FUP desde el portapapeles (Página 8036)
Reemplazar elementos FUP (Página 8037)
Insertar entradas y salidas adicionales en los elementos FUP (Página 8038)
Quitar entradas y salidas de una instrucción (Página 8039)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 160)
Borrar elementos FUP (Página 8040)

14.5.2

Copiar elementos FUP

Requisitos
Existe un elemento FUP.

Procedimiento
Para copiar un elemento FUP, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el elemento FUP que desea copiar.
2. Elija el comando "Copiar" del menú contextual.

Resultado
El elemento FUP se copia y se guarda en el portapapeles.

Consulte también
Seleccionar elementos FUP (Página 8034)
Cortar elementos FUP (Página 8036)
Insertar elementos FUP desde el portapapeles (Página 8036)
Reemplazar elementos FUP (Página 8037)
Insertar entradas y salidas adicionales en los elementos FUP (Página 8038)
Quitar entradas y salidas de una instrucción (Página 8039)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 160)
Borrar elementos FUP (Página 8040)

Programación del PLC
Manual de programación y manejo, 11/2019

8035

Creación de programas FUP
14.5 Editar elementos FUP

14.5.3

Cortar elementos FUP

Requisitos
Existe un elemento FUP.

Cortar
Para cortar un elemento FUP, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el elemento FUP que desea cortar.
2. Seleccione el comando "Cortar" del menú contextual.

Resultado
El elemento FUP se corta y se guarda en el portapapeles.

Consulte también
Seleccionar elementos FUP (Página 8034)
Copiar elementos FUP (Página 8035)
Insertar elementos FUP desde el portapapeles (Página 8036)
Reemplazar elementos FUP (Página 8037)
Insertar entradas y salidas adicionales en los elementos FUP (Página 8038)
Quitar entradas y salidas de una instrucción (Página 8039)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 160)
Borrar elementos FUP (Página 8040)

14.5.4

Insertar elementos FUP desde el portapapeles

Requisitos
Existe un elemento FUP.

Procedimiento
Para insertar un elemento FUP desde el portapapeles, proceda del siguiente modo:
1. Copie o corte un elemento FUP.
2. Haga clic con el botón derecho del ratón en la posición del segmento en la que desea
insertar el elemento.
3. Elija el comando "Pegar" del menú contextual.

8036

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.5 Editar elementos FUP

Consulte también
Seleccionar elementos FUP (Página 8034)
Copiar elementos FUP (Página 8035)
Cortar elementos FUP (Página 8036)
Reemplazar elementos FUP (Página 8037)
Insertar entradas y salidas adicionales en los elementos FUP (Página 8038)
Quitar entradas y salidas de una instrucción (Página 8039)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 160)
Borrar elementos FUP (Página 8040)

14.5.5

Reemplazar elementos FUP
Los elementos FUP se pueden reemplazar muy fácilmente por otros del mismo tipo. La ventaja
es que los parámetros se conservan, por lo que no es necesario introducirlos de nuevo. Por
ejemplo, es posible sustituir una operación lógica O por una Y, un flipflop de desactivación/
activación por uno de activación/desactivación, así como funciones de comparación o
instrucciones de salto.

Requisitos
Existe un segmento con un elemento FUP como mínimo.

Procedimiento
Para reemplazar un elemento FUP por otro, proceda del siguiente modo:
1. Seleccione el elemento FUP que desea reemplazar.
Si existen elementos compatibles con el elemento FUP seleccionado, aparecerá un
triángulo en la esquina superior derecha del elemento.
2. Sitúe el puntero del ratón sobre el triángulo del elemento FUP.
Se abre una lista desplegable.
3. Seleccione el elemento FUP de la lista desplegable por el que desea reemplazar el
elemento FUP actual.

Consulte también
Seleccionar elementos FUP (Página 8034)
Copiar elementos FUP (Página 8035)
Cortar elementos FUP (Página 8036)
Insertar elementos FUP desde el portapapeles (Página 8036)
Insertar entradas y salidas adicionales en los elementos FUP (Página 8038)

Programación del PLC
Manual de programación y manejo, 11/2019

8037

Creación de programas FUP
14.5 Editar elementos FUP
Quitar entradas y salidas de una instrucción (Página 8039)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 160)
Borrar elementos FUP (Página 8040)

14.5.6

Insertar entradas y salidas adicionales en los elementos FUP

Introducción
Algunos elementos FUP que realizan operaciones aritméticas o binarias se pueden ampliar
con entradas adicionales. Estos elementos son p. ej. las instrucciones "Sumar" (ADD) y
"Multiplicar" (MUL), así como las operaciones lógicas Y u O. Los cuadros de las instrucciones
"Copiar valor" (MOVE) y "Desmultiplexar" (DEMUX) se pueden ampliar mediante salidas
adicionales.
El nombre de las entradas y salidas nuevas está formado por el tipo del elemento insertado y
un número correlativo. Así pues, el nombre de una entrada nueva podría ser , p. ej., "IN2", y el
nombre de una salida nueva, p. ej., "OUT2".

Requisitos
Existe un elemento FUP que permite insertar entradas o salidas adicionales.

Insertar una entrada adicional
Para insertar una entrada adicional en el cuadro de un elemento FUP, proceda del siguiente
modo:
1. Haga clic con el botón derecho del ratón en una entrada existente del elemento FUP.
2. Elija el comando "Insertar entrada" del menú contextual.
El cuadro del elemento FUP se complementa con una entrada adicional.
O bien:
1. Haga clic en el asterisco amarillo junto a la última entrada del cuadro de instrucción.
El cuadro del elemento FUP se complementa con una entrada adicional.

Insertar una salida adicional
Para insertar una salida adicional en el cuadro de un elemento FUP, proceda del siguiente
modo:
1. Haga clic con el botón derecho del ratón en una salida existente del elemento FUP.
2. Elija el comando "Insertar salida" del menú contextual.
El cuadro del elemento FUP se complementa con una salida adicional.
O bien:
1. Haga clic en el asterisco amarillo junto a la última salida del cuadro de instrucciones.
El cuadro del elemento FUP se complementa con una salida adicional.

8038

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.5 Editar elementos FUP

Consulte también
Insertar elementos FUP (Página 8017)
Seleccionar elementos FUP (Página 8034)
Copiar elementos FUP (Página 8035)
Cortar elementos FUP (Página 8036)
Insertar elementos FUP desde el portapapeles (Página 8036)
Reemplazar elementos FUP (Página 8037)
Quitar entradas y salidas de una instrucción (Página 8039)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 160)
Borrar elementos FUP (Página 8040)

14.5.7

Quitar entradas y salidas de una instrucción

Introducción
Las entradas y salidas que se han insertado adicionalmente para una instrucción pueden
quitarse nuevamente.

Requisitos
Existe un elemento FUP en el que se han insertado entradas o salidas adicionales.

Quitar una entrada
Para quitar una entrada, proceda del siguiente modo:
1. Seleccione la entrada que desea quitar.
2. Elija el comando "Borrar" del menú contextual.
La entrada del elemento FUP se quita.

Quitar una salida
Para quitar una salida, proceda del siguiente modo:
1. Seleccione la salida que desea quitar.
2. Elija el comando "Borrar" del menú contextual.
La salida del elemento FUP se quita.

Programación del PLC
Manual de programación y manejo, 11/2019

8039

Creación de programas FUP
14.5 Editar elementos FUP

Consulte también
Insertar elementos FUP (Página 8017)
Seleccionar elementos FUP (Página 8034)
Copiar elementos FUP (Página 8035)
Cortar elementos FUP (Página 8036)
Insertar elementos FUP desde el portapapeles (Página 8036)
Reemplazar elementos FUP (Página 8037)
Insertar entradas y salidas adicionales en los elementos FUP (Página 8038)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 160)
Borrar elementos FUP (Página 8040)

14.5.8

Borrar elementos FUP

Requisitos
Existe un elemento FUP.

Procedimiento
Para borrar un elemento FUP, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el elemento FUP que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Insertar elementos FUP (Página 8017)
Seleccionar elementos FUP (Página 8034)
Copiar elementos FUP (Página 8035)
Cortar elementos FUP (Página 8036)
Insertar elementos FUP desde el portapapeles (Página 8036)
Reemplazar elementos FUP (Página 8037)
Insertar entradas y salidas adicionales en los elementos FUP (Página 8038)
Quitar entradas y salidas de una instrucción (Página 8039)
Activar y desactivar el mecanismo EN/ENO en KOP y FUP (Página 160)

8040

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.6 Cablear operandos en instrucciones FUP

14.6

Cablear operandos en instrucciones FUP

14.6.1

Cablear operandos
Cuando se inserta un elemento FUP, las cadenas de caracteres "<???>", "<??.?>" y "..." se
insertan como comodines de los parámetros. Las cadenas de caracteres "<???>" y "<??.?>"
representadas en color rojo identifican los parámetros que se deben cablear. La secuencia de
caracteres "..." representada en color negro identifica los parámetros que se pueden cablear.
"<??.?>" significa comodín de operación booleana o lógica. Además, los parámetros de los
elementos FUP pueden tener los siguientes tipos de conexiones:
● Conexiones de color naranja: En esta conexión solo es posible interconectar variables o
constantes.
● Conexiones de color negro: Entrada o salida booleana en la que pueden interconectarse
también otros elementos anteriores o posteriores, respectivamente.
Nota
Al situar el puntero del ratón sobre el comodín se muestran los tipos de datos posibles en un
tooltip.

Requisitos
Existe un elemento FUP.

Procedimiento
Para cablear los parámetros de un elemento FUP, proceda del siguiente modo:
1. Haga clic en el comodín del parámetro.
Aparece un campo de entrada.
2. Introduzca el parámetro correspondiente, p. ej. una variable PLC, una variable local o una
constante.
Nota
Si introduce la dirección absoluta de un parámetro ya definido, ésta se sustituirá por el
nombre simbólico del parámetro tan pronto como confirme la entrada. Si el parámetro no se
ha definido aún, en la tabla de variables PLC se introducirá una nueva variable con esta
dirección absoluta y el nombre estándar "Tag_1". Cuando confirme la entrada, la dirección
absoluta se sustituirá por el nombre simbólico "Tag_1".
3. Confirme el parámetro pulsando la tecla Intro.
4. Si todavía no ha definido el parámetro, puede hacerlo mediante el menú contextual
directamente en el editor de programación.
Consulte también: "Declarar variables PLC en el editor de programación (Página 7900)".

Programación del PLC
Manual de programación y manejo, 11/2019

8041

Creación de programas FUP
14.6 Cablear operandos en instrucciones FUP
O mediante Drag & Drop desde la tabla de variables PLC:
1. En el árbol del proyecto, seleccione la carpeta "Variables PLC" y abra la tabla de variables
PLC.
2. Si está abierta la tabla de variables PLC, arrastre la variable deseada hasta la respectiva
posición del programa. Si la tabla de variables PLC no está abierta, abra la vista detallada.
Arrastre la variable deseada desde la vista detallada hasta la respectiva posición del
programa.
O mediante Drag & Drop desde la interfaz del bloque:
1. Abra la interfaz del bloque.
2. Arrastre el operando deseado desde la interfaz del bloque hasta la respectiva posición del
programa.

Resultado
● Si la sintaxis es correcta, el parámetro se representará en color negro.
● Si hay un error de sintaxis, no se saldrá del campo de entrada y aparecerá un mensaje de
error correspondiente en la ficha "Información > Sintaxis" de la ventana de inspección.

Consulte también
Utilizar y direccionar operandos (Página 95)
Utilizar la función automática de autocompletar (Página 7682)

14.6.2

Cablear parámetros ocultos

Introducción
Si una instrucción contiene parámetros ocultos, aparece una flecha pequeña en el margen
inferior del cuadro de la instrucción. Los parámetros ocultos se reconocen porque se muestran
en fuente blanca.
Los parámetros ocultos se pueden mostrar y asignar en todo momento.

Mostrar u ocultar parámetros ocultos
Para mostrar u ocultar parámetros ocultos, proceda del siguiente modo:
1. Para mostrar los parámetros ocultos, haga clic en la flecha hacia abajo situada en el
margen inferior del cuadro de la instrucción.
2. Para ocultar los parámetros ocultos, haga clic en la flecha hacia arriba situada en el margen
inferior del cuadro de la instrucción.

8042

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.6 Cablear operandos en instrucciones FUP

Asignar parámetros ocultos
Para asignar parámetros ocultos, proceda del siguiente modo:
1. Asigne los parámetros ocultos de la misma manera que los parámetros visibles.
Al asignar el parámetro es posible que cambie su visibilidad:
– El parámetro se vuelve visible al seleccionar la opción "Ocultar cuando no se haya
asignado ningún parámetro" en las propiedades.
– El parámetro se mantiene oculto al seleccionar la opción "Ocultar" en las propiedades.

Consulte también
Ocultar parámetros en la llamada del bloque (Página 7804)

14.6.3

Mostrar u ocultar informaciones de variables

Introducción
Se puede mostrar la siguiente información sobre las variables empleadas en el editor de
programación:
● Nombre de la variable
● Dirección de la variable
● Comentarios simples o jerárquicos para la documentación de variables
La información se recoge de la interfaz del bloque en el caso de las variables locales y de DB,
y de la tabla de variables PLC en el caso de las variables válidas para toda la CPU.
Es posible visualizar la información de las variables para todos los bloques o solo para bloques
abiertos individuales. Si selecciona la información de variables para todos los bloques, se
muestra la información de las variables de todos los bloques abiertos actuales y futuros. La
información de las variables se puede volver a ocultar en cualquier momento. Si se ha ocultado
la información de las variables de todos los bloques, se puede volver a mostrar en bloques
abiertos individualmente.
Si selecciona la visualización de la información de variables con comentarios jerárquicos, en
las variables estructuradas también se mostrarán los comentarios de los niveles de estructura
de orden superior. En este caso, la información se muestra entre paréntesis después del
comentario de la variable, y los comentarios de los distintos niveles se separan con un punto.
Si en un nivel de estructura no hay ningún comentario de variable, el comentario en cuestión
no se visualiza, lo que se reconoce por los dos puntos seguidos.
La información de variable puede visualizarse agrupada debajo de un segmento KOP/FUP o
bien directamente en el operando correspondiente. Igual que para mostrar y ocultar la
información de variable, esto puede ajustarse en la configuración para todos los bloques o bien
modificarse específicamente para un bloque abierto.

Programación del PLC
Manual de programación y manejo, 11/2019

8043

Creación de programas FUP
14.6 Cablear operandos en instrucciones FUP

Mostrar u ocultar información de variables para todos los bloques
Para mostrar u ocultar la información de variables para todos los bloques, proceda del
siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Si desea visualizar la información de las variables, seleccione en la lista desplegable
"Información de la variable" bien la opción "Mostrar", bien la opción "Información de la
variable con comentarios jerárquicos", según si desea ver comentarios simples o
jerárquicos.
4. En la lista desplegable "Posición de la información de variable (KOP/FUP)", especifique si
la información de variable debe visualizarse debajo de un segmento KOP/FUP o bien en el
operando.
La información de variable se muestra para todos los bloques abiertos en la posición
seleccionada. Si se abren más bloques, la información de variable también se muestra para
dichos bloques.
5. Si desea ocultar la información de variable, seleccione la opción "Ocultar" en la lista
desplegable "Información de variable".
La información de variable se oculta para todos los bloques abiertos. Si se abren más
bloques, la información de variable también se oculta para dichos bloques.

Mostrar u ocultar información de variables para un bloque abierto
Para mostrar u ocultar la información de variables para un bloque abierto, proceda del
siguiente modo:
1. Para mostrar información de variables, seleccione en la lista desplegable "Información
sobre la variable." bien la opción "Mostrar información de la variable", bien la opción
"Información de la variable con comentarios jerárquicos", según si desea visualizar
comentarios simples o jerárquicos.
2. Para especificar la posición de la información de variable, haga clic en el botón "Posición de
la información de variable (KOP/FUP)" de la barra de herramientas del editor de
programación. Cada vez que se hace clic en el botón cambia la posición. Otra posibilidad
consiste en hacer clic en la flecha pequeña situada junto al botón "Posición de la
información de variable (KOP/FUP)" para abrir una lista desplegable. Seguidamente,
seleccione la posición en la lista desplegable.
La información de variable se muestra en la posición seleccionada.
3. Para ocultar la información de las variables, seleccione la opción "Ocultar información de la
variable" en la lista desplegable "Muestra información sobre la variable".
La información de variable se oculta.

8044

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.7 Ramas en FUP

14.7

Ramas en FUP

14.7.1

Principios básicos de las ramas en FUP

Definición
El lenguaje de programación Diagrama de funciones (FUP) permite programar ramas
paralelas. Para ello se utilizan ramas que se insertan entre los cuadros. En la rama pueden
insertarse cuadros adicionales para programar diagramas de funciones complejos.
La figura siguiente muestra un ejemplo de la utilización de ramas:
6

! 

6
6

ಯ,=48,(5'2ಯ
5
ಯ'(5(&+2ಯ
6

Consulte también
Reglas para ramas en FUP (Página 8045)
Insertar ramas en segmentos FUP (Página 8046)
Borrar ramas en segmentos FUP (Página 8046)

14.7.2

Reglas para ramas en FUP

Reglas
Para la utilización de ramas en FUP rigen las siguientes reglas:
● Las ramas se abren hacia abajo.
● Las ramas sólo pueden insertarse entre dos elementos FUP.
● Para borrar una rama deben borrarse todos los elementos FUP, incluyendo la rama en sí.
● Si se borra la conexión entre dos ramas, los elementos FUP de la rama rota quedan
situados libremente en el segmento.

Programación del PLC
Manual de programación y manejo, 11/2019

8045

Creación de programas FUP
14.7 Ramas en FUP

Consulte también
Principios básicos de las ramas en FUP (Página 8045)
Insertar ramas en segmentos FUP (Página 8046)
Borrar ramas en segmentos FUP (Página 8046)

14.7.3

Insertar ramas en segmentos FUP

Requisitos
Existe un segmento.

Procedimiento
Para insertar una rama nueva en un segmento, proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. En la paleta "Instrucciones básicas", navegue hasta "General > Cerrar rama".
3. Arrastre el elemento mediante Drag & Drop y suéltelo en la posición deseada sobre una
línea de conexión entre dos cuadros.

Consulte también
Reglas para ramas en FUP (Página 8045)
Principios básicos de las ramas en FUP (Página 8045)
Borrar ramas en segmentos FUP (Página 8046)

14.7.4

Borrar ramas en segmentos FUP

Requisitos
Existe una rama.

Procedimiento
Para borrar una rama, proceda del siguiente modo:
1. Seleccione la línea que conecta la rama con la rama principal.
2. Elija el comando "Borrar" del menú contextual.

8046

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.8 Circuitos lógicos en FUP

Resultado
La rama se borra. Los cuadros que estaban conectados a la rama borrada se disponen
libremente en el segmento.

Consulte también
Reglas para ramas en FUP (Página 8045)
Principios básicos de las ramas en FUP (Página 8045)
Insertar ramas en segmentos FUP (Página 8046)

14.8

Circuitos lógicos en FUP

14.8.1

Principios básicos de los circuitos lógicos en FUP

Utilización de circuitos lógicos
El programa de usuario se representa en uno o varios segmentos. En los segmentos pueden
encontrarse uno o varios circuitos lógicos, en los que las señales binarias están dispuestas en
forma de cuadros.
La figura siguiente muestra un ejemplo de la utilización de varios circuitos lógicos en un
segmento:
ಯ,QWBDUUDQTXHBL]Tಯ

! 

6

ಯ,QWBDUUDQTXHBGHUಯ

ಯ,QWBSDUDGDBL]Tಯ
ಯ,QWBSDUDGDBGHUಯ

ಯ02725B21ಯ

! 

ಯ02725B21ಯ
5

Reglas
Observe las reglas siguientes al utilizar circuitos lógicos:
● No se permiten conexiones entre los circuitos lógicos.
● Sólo se permite una instrucción de salto por segmento. Las reglas de posicionamiento de
instrucciones de salto conservan su validez.

Programación del PLC
Manual de programación y manejo, 11/2019

8047

Creación de programas FUP
14.8 Circuitos lógicos en FUP

Procesamiento de circuitos lógicos
Los circuitos lógicos y segmentos se procesan de arriba abajo y de izquierda a derecha. Esto
significa que primero se procesa la primera instrucción del primer circuito lógico del primer
segmento. Luego se procesan todas las demás instrucciones de dicho circuito. A continuación
se procesan todos los demás circuitos lógicos del primer segmento. Una vez procesados todos
los circuitos lógicos, se procesa el siguiente segmento.
Si se utilizan saltos, se rodea el procesamiento regular de los circuitos lógicos y la instrucción
se ejecuta en la meta de salto.

Diferencias entre las ramas y los circuitos lógicos
La diferencia entre las ramas y los circuitos lógicos es que éstos son ramas independientes
que también pueden encontrarse en un segmento diferente. En cambio, las ramas permiten
programar una conexión en paralelo y tienen una operación lógica precedente común.

Consulte también
Insertar un circuito lógico (Página 8048)
Borrar un circuito lógico (Página 8049)

14.8.2

Insertar un circuito lógico

Requisitos
● Un bloque está abierto.
● Existe un segmento.

Procedimiento
Para insertar un circuito lógico nuevo en un segmento, proceda del siguiente modo:
1. Inserte una instrucción cualquiera en un segmento, de manera que no tenga conexión
alguna con las instrucciones existentes.
Se inserta un circuito lógico nuevo.
2. Inserte una asignación al final del circuito lógico nuevo.
3. Inserte instrucciones adicionales en el circuito lógico nuevo.

Consulte también
Principios básicos de los circuitos lógicos en FUP (Página 8047)
Borrar un circuito lógico (Página 8049)

8048

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.8 Circuitos lógicos en FUP

14.8.3

Borrar un circuito lógico

Requisitos
Existe un circuito lógico.

Procedimiento
Para borrar un circuito lógico, proceda del siguiente modo:
1. Pulse y mantenga oprimido el botón izquierdo del ratón y trace un marco alrededor del
circuito lógico. Vigile que se seleccionen todas las instrucciones del circuito lógico.
Alternativamente, pulse y mantenga oprimida la tecla <Mayús> y seleccione la primera y
última instrucción del circuito lógico.
2. Haga clic con el botón derecho del ratón en una de las instrucciones del circuito lógico.
3. Elija el comando "Borrar" del menú contextual.

Consulte también
Principios básicos de los circuitos lógicos en FUP (Página 8047)
Insertar un circuito lógico (Página 8048)

Programación del PLC
Manual de programación y manejo, 11/2019

8049

Creación de programas FUP
14.9 Ejemplos de programación FUP

14.9

Ejemplos de programación FUP

14.9.1

Ejemplo de control de una cinta transportadora

Control de una cinta transportadora
La figura siguiente muestra una cinta transportadora que se pone en marcha eléctricamente.
Al comienzo de la cinta transportadora se encuentran dos pulsadores, S1 para MARCHA y S2
para PARO. Al final de la cinta transportadora se encuentran otros dos pulsadores, S3 para
MARCHA y S4 para PARO. La cinta transportadora puede ponerse en marcha o pararse desde
cualquiera de ambos extremos.
6
6

20DUFKD
23DUR

6 20DUFKD
6 23DUR

02725B21

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Descripción

Marcha_izquierda (S1)

Input

BOOL

Pulsador de marcha en
el extremo izquierdo de
la cinta transportadora

Paro_izquierda (S2)

Input

BOOL

Pulsador de paro en el
extremo izquierdo de la
cinta transportadora

Marcha_derecha (S3)

Input

BOOL

Pulsador de marcha en
el extremo derecho de
la cinta transportadora

Paro_derecha (S4)

Input

BOOL

Pulsador de paro en el
extremo derecho de la
cinta transportadora

MOTOR_ON

Output

BOOL

Conectar el motor de la
cinta transportadora

Los segmentos siguientes muestran la programación FUP para solucionar la tarea:
Segmento 1:

8050

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.9 Ejemplos de programación FUP
El motor de la cinta transportadora se conecta cuando se acciona el pulsador de marcha "S1"
o "S3".
ಯ0DUFKDBL]TXLHUGDರ

! 

ಯ02725B21ರ
6

ಯ0DUFKDBGHUHFKDರ

Segmento 2:
El motor de la cinta transportadora se desconecta cuando se acciona el pulsador de paro "S2"
o "S4".
ಯ3DURBL]TXLHUGDರ

! 

ಯ02725B21ರ

ಯ3DURBGHUHFKDರ

5

Consulte también
Principios básicos de FUP (Página 8005)
Configuración de FUP (Página 8007)
Trabajar con segmentos (Página 8009)
Insertar elementos FUP (Página 8017)
Editar elementos FUP (Página 8034)
Cablear operandos en instrucciones FUP (Página 8041)
Ramas en FUP (Página 8045)
Circuitos lógicos en FUP (Página 8047)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 8052)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 8054)
Ejemplo de cálculo de una ecuación (Página 8058)
Ejemplo de control de la temperatura ambiente (Página 8060)

Programación del PLC
Manual de programación y manejo, 11/2019

8051

Creación de programas FUP
14.9 Ejemplos de programación FUP

14.9.2

Ejemplo de detección del sentido de marcha de una cinta transportadora

Detección del sentido de marcha de una cinta transportadora
El sentido de marcha detectado de la cinta transportadora se indica con una flecha DERECHA
o una flecha IZQUIERDA. Si se está transportando otro objeto desde la derecha a BF1 o desde
la izquierda a BF2, primero se desconectará la flecha indicada hasta que, tras pasar por las dos
barreras fotoeléctricas, se detecte nuevamente el sentido de marcha y pueda indicarse la
flecha correspondiente. Para solucionar la tarea se requieren además dos marcas de flanco
que detecten el cambio de señal en las dos barreras fotoeléctricas de "0" a "1".
%)

%)

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Descripción

BF1

Input

BOOL

Barrera fotoeléctrica 1

BF2

Input

BOOL

Barrera fotoeléctrica 2

DERECHA

Output

BOOL

Indicador de desplaza‐
miento a la derecha

IZQUIERDA

Output

BOOL

Indicador de desplaza‐
miento a la izquierda

MF1

Input

BOOL

Marca de flancos 1

MF2

Input

BOOL

Marca de flancos 2

Los segmentos siguientes muestran la programación FUP para solucionar la tarea:
Segmento 1:
Si el estado lógico de la barrera fotoeléctrica "BF1" cambia de "0" a "1" (flanco de señal
ascendente) y, simultáneamente, el estado lógico de "BF2" es "0", el objeto se desplaza hacia
la izquierda sobre la cinta transportadora.

8052

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.9 Ejemplos de programación FUP
ಯ%)ಯ
3
ಯ0)ಯ
ಯ%)ಯ

ಯ,=48,(5'$ಯ
6
ಯ'(5(&+$ಯ
5

Segmento 2:
Si el estado lógico de la barrera fotoeléctrica "BF2" cambia de "0" a "1" (flanco de señal
ascendente) y, simultáneamente, el estado lógico de "BF1" es "0", el objeto se desplaza hacia
la derecha sobre la cinta transportadora.
ಯ%)ಯ
3
ಯ0)ಯ
ಯ%)ಯ

ಯ'(5(&+$ಯ
6
ಯ,=48,(5'$ಯ
5

Consulte también
Principios básicos de FUP (Página 8005)
Configuración de FUP (Página 8007)
Trabajar con segmentos (Página 8009)
Insertar elementos FUP (Página 8017)
Editar elementos FUP (Página 8034)
Cablear operandos en instrucciones FUP (Página 8041)
Ramas en FUP (Página 8045)
Circuitos lógicos en FUP (Página 8047)
Ejemplo de control de una cinta transportadora (Página 8050)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 8054)
Ejemplo de cálculo de una ecuación (Página 8058)
Ejemplo de control de la temperatura ambiente (Página 8060)

Programación del PLC
Manual de programación y manejo, 11/2019

8053

Creación de programas FUP
14.9 Ejemplos de programación FUP

14.9.3

Ejemplo de detección del nivel de llenado de una zona de almacén

Detección del nivel de llenado de una zona de almacén
La figura siguiente muestra un sistema con dos cintas transportadoras y una zona de almacén
temporal situada entre ambas. La cinta transportadora 1 transporta paquetes a la zona de
almacén. Una barrera fotoeléctrica situada al final de la cinta transportadora 1 junto a la zona
de almacén determina cuántos paquetes se transportan a dicha zona. La cinta transportadora
2 transporta paquetes desde esta zona de almacén temporal a una plataforma de carga, desde
la que los paquetes se cargan en camiones. Una barrera fotoeléctrica situada al final de la zona
de almacén determina cuántos paquetes deben transportarse desde allí hasta la plataforma de
carga. Cinco indicadores luminosos indican el nivel de llenado de la zona de almacén temporal.
&RQVRODGHLQGLFDGRUHV

=RQDGHDOPDF«Q =RQDGHDOPDF«Q
YDF¯D
QRYDF¯D

3DTXHWHV
HQWUDQWHV

=RQDGHDOPDF«Q
OOHQDDO

=RQDGHDOPDF«Q
OOHQDDO

=RQDGHDOPDF«Q
OOHQD

3DTXHWHV
VDOLHQWHV

=RQDGHDOPDF«Q
WHPSRUDO
SDUD
SDTXHWHV

&LQWDWUDQVSRUWDGRUD

&LQWDWUDQVSRUWDGRUD

%DUUHUDIRWRHO«FWULFD

%DUUHUDIRWRHO«FWULFD

Realización
La tabla siguiente muestra la definición de las variables utilizadas:

8054

Nombre

Declaración

Tipo de datos

Descripción

BF1

Input

BOOL

Barrera fotoeléctrica 1

BF2

Input

BOOL

Barrera fotoeléctrica 2

RESET

Input

BOOL

Inicializar contador

LOAD

Input

BOOL

Adaptar el valor actual
del contador al valor del
parámetro PV.

CAPACIDAD MAX AL‐
MACEN

Input

INT

Número máximo posi‐
ble de paquetes en al‐
macén

PAQUETES

Output

INT

Número de paquetes
en la zona de almacén
(valor de contaje actual)

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.9 Ejemplos de programación FUP
Nombre

Declaración

Tipo de datos

Descripción

PAQUETES_ZA

Output

BOOL

Se activa si el valor ac‐
tual del contador es ma‐
yor o igual al valor de la
variable "CAPACIDAD
MAX ALMACEN".

ALM_VACIO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén vacía

ALM_NO_VACIO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén no vacía

ALM_LLENO_50%

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena al
50 %

ALM_LLENO_90%

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena al
90 %

ALM_LLENO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena

VOLUMEN_50

Input

INT

Valor de comparación:
50 paquetes

VOLUMEN_90

Input

INT

Valor de comparación:
90 paquetes

VOLUMEN_100

Input

INT

Valor de comparación:
100 paquetes

Los segmentos siguientes muestran la programación FUP para activar los indicadores
luminosos:
Segmento 1:
Cuando un paquete se transporta a la zona de almacén, el estado lógico de "BF1" cambia de
"0" a "1" (flanco ascendente). Cuando se produce un flanco ascendente en "BF1", el contador
ascendente se activa y el valor de contaje actual de "PAQUETES" aumenta en uno.
Cuando un paquete se transporta de la zona de almacén a la plataforma de carga, el estado
lógico de "BF2" cambia de "0" a "1" (flanco ascendente). Cuando se produce un flanco
ascendente en "BF2", el contador descendente se activa y el valor actual de "PAQUETES" se
reduce en uno.
Si no hay paquetes en la zona de almacén ("PAQUETES" = "0"), la variable "ALM_VACIO"
adopta el estado lógico "1" y se enciende el indicador luminoso "Zona de almacén vacía".
El valor de contaje actual puede ponerse a "0" si la variable "RESET" adopta el estado lógico
"1".
Cuando la variable "LOAD" adopta el estado lógico "1", el valor actual del contador se pone al
valor de la variable "CAPACIDAD MAX ALMACEN". Mientras el valor de contaje actual sea
mayor o igual al valor de la variable "CAPACIDAD MAX ALMACEN", la variable
"PAQUETES_ZA" devolverá el estado lógico "1".

Programación del PLC
Manual de programación y manejo, 11/2019

8055

Creación de programas FUP
14.9 Ejemplos de programación FUP
ಯ&78'B'%ಯ
&78'
,17
ಯ%)ಯ

&8

%)

&'

ರ5(6(7ರ
ರ/2$'ರ
ರ&$3$&,'$'
0$;$/0$&(1ರ

5

4'

/'

&9

39

48

$/0B9$&,2
3$48(7(6

3$48(7(6B=$

Segmento 2:
Mientras haya paquetes en la zona de almacén, la variable "ALM_NO_VACIO" adoptará el
estado lógico "1" y se encenderá el indicador luminoso "Zona de almacén no vacía".
ರ$/0B12B9$&,2ರ
ರ$/0B9$&,2ರ

Segmento 3:
Si el número de paquetes que se encuentran en la zona de almacén es mayor o igual a 50, se
enciende el indicador luminoso del aviso "Zona de almacén llena al 50 %".
!
,17
3$48(7(6

,1

92/80(1B

,1


,17
3$48(7(6
92/80(1B

,1

$/0B//(12B

,1

Segmento 4:
Si el número de paquetes que se encuentran en la zona de almacén es mayor o igual a 90, se
enciende el indicador luminoso del aviso "Zona de almacén llena al 90 %".

8056

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.9 Ejemplos de programación FUP
!
,17
3$48(7(6

,1

92/80(1B

,1


,17
3$48(7(6

,1

92/80(1B

,1

$/0B//(12B

Segmento 5:
Si el número de paquetes que se encuentran en la zona de almacén alcanza 100, se enciende
el indicador luminoso del aviso "Zona de almacén llena".
!
,17
3$48(7(6

,1

92/80(1B

,1

$/0B//(12

Consulte también
Principios básicos de FUP (Página 8005)
Configuración de FUP (Página 8007)
Trabajar con segmentos (Página 8009)
Insertar elementos FUP (Página 8017)
Editar elementos FUP (Página 8034)
Cablear operandos en instrucciones FUP (Página 8041)
Ramas en FUP (Página 8045)
Circuitos lógicos en FUP (Página 8047)
Ejemplo de control de una cinta transportadora (Página 8050)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 8052)
Ejemplo de cálculo de una ecuación (Página 8058)
Ejemplo de control de la temperatura ambiente (Página 8060)

Programación del PLC
Manual de programación y manejo, 11/2019

8057

Creación de programas FUP
14.9 Ejemplos de programación FUP

14.9.4

Ejemplo de cálculo de una ecuación

Cálculo de una ecuación compleja
El siguiente programa de ejemplo muestra cómo se resuelven ecuaciones del siguiente tipo
con el lenguaje de programación FUP:
X= ((A + B) x C) / D
En principio, pueden convertirse utilizando operaciones matemáticas. Para ello están
disponibles las instrucciones "ADD", "MUL" y "DIV". En caso de utilizar una CPU de la serie
S7-1200 o S7-1500, también existe la opción de utilizar alternativamente la instrucción
"CALCULATE". Dependiendo del tipo de datos seleccionado, para esta instrucción existen
distintas operaciones matemáticas que puede combinar entre sí.

Conversión mediante las instrucciones "ADD", "MUL" y "DIV"
Debe calcularse la siguiente ecuación:
RESULT = ((A + B) x 15) / E
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Tipo de datos

Comentario

A

INT

Primer sumando

B

INT

Segundo sumando

C

INT

Primer resultado intermedio

15

INT

Multiplicador

D

INT

Segundo resultado intermedio

E

INT

Divisor

RESULT

INT

Resultado final

El segmento siguiente muestra la programación FUP para calcular la ecuación:
$''
,17
(1
ಯ$ಯ

,1

287

ಯ%ಯ

,1

(12

08/
,17

ಯ&ಯ
(1
ಯ&ಯ

,1

287

ಯಯ

,1

(12

',9
,17

ಯ'ಯ
(1
ಯ'ಯ

,1

287

ಯ(ಯ

,1

(12

ಯ5(68/7ಯ

El valor del operando "A" se suma al valor del operando "B". La suma se almacena en el
operando "C". El valor del operando "C" se multiplica por "15". El resultado de la multiplicación
se almacena en el operando "D". A continuación, el valor almacenado en el operando "D" se
divide por el valor del operando "E". El resultado final se almacena en el operando "RESULT".

8058

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.9 Ejemplos de programación FUP

Conversión mediante la instrucción "CALCULATE" (solo S7-1200/1500)
Debe calcularse la siguiente ecuación:
RESULT = ((5 + 10) x 4) / 6
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Comentario

Valor

A

Input

INT

Primer sumando

5

B

Input

INT

Segundo sumando 10

C

Input

INT

Multiplicador

4

D

Input

INT

Divisor

6

RESULT

Output

INT

Resultado final

10

Para programar la ecuación utilizando la instrucción "CALCULATE", proceda del siguiente
modo:
1. Arrastre la instrucción "CALCULATE" desde la Task Card "Instrucciones" hasta un
segmento FUP.
2. En la lista desplegable "<???>" puede seleccionar el tipo de datos INT para la instrucción.
3. Interconecte las variables declaradas en la interfaz del bloque con las entradas o salidas del
cuadro de la instrucción.
4. Haga clic en el símbolo de "calculadora" en el borde superior derecho del cuadro de la
instrucción para introducir la ecuación que quiere resolver.
Se abre el cuadro de diálogo "Editar instrucción Calcular".
5. Introduzca la expresión siguiente en el campo "OUT:=".
((IN1 + IN2) * IN4) / IN3
La ecuación se muestra en el cuadro de la instrucción.
El siguiente segmento muestra el resultado en el lenguaje de programación FUP:
&$/&8/$7(
,17
ಯ7DJB,QSXWಯ

(1
,1,1 ,1 ,1

ಯ$ಯ

,1

ಯ%ಯ

,1

ಯ&ಯ

,1

287

ಯ5(68/7ಯ

ಯ'ಯ

,1

(12

ಯ7DJB2XWSXWಯ

Si la entrada "Tag_Input" devuelve el estado lógico "1", se ejecuta la instrucción. El valor del
operando "A" se suma al valor del operando "B". La suma intermedia se multiplica por "C"
y seguidamente se divide por el valor del operando "D". El resultado final se almacena en
el operando "RESULT".

Programación del PLC
Manual de programación y manejo, 11/2019

8059

Creación de programas FUP
14.9 Ejemplos de programación FUP

Consulte también
Principios básicos de FUP (Página 8005)
Configuración de FUP (Página 8007)
Trabajar con segmentos (Página 8009)
Insertar elementos FUP (Página 8017)
Editar elementos FUP (Página 8034)
Cablear operandos en instrucciones FUP (Página 8041)
Ramas en FUP (Página 8045)
Circuitos lógicos en FUP (Página 8047)
Ejemplo de control de una cinta transportadora (Página 8050)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 8052)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 8054)
Ejemplo de control de la temperatura ambiente (Página 8060)

14.9.5

Ejemplo de control de la temperatura ambiente

Controlar la temperatura ambiente
La temperatura de una cámara de enfriamiento debe mantenerse por debajo de los cero
grados centígrados. Las posibles fluctuaciones de la temperatura se controlan mediante un
sensor. Si la temperatura aumenta por encima de los cero grados centígrados, el sistema de
enfriamiento se conecta por un tiempo preseleccionado. Durante la fase de enfriamiento se
enciende un indicador "Sistema de enfriamiento iniciado".
El sistema de enfriamiento y el indicador luminoso se apagan cuando se cumple una de las
condiciones siguientes:
● El sensor indica un descenso de la temperatura por debajo de los cero grados centígrados.
● El tiempo de enfriamiento preseleccionado ha transcurrido.
● Se acciona el pulsador "PARO".
Si ha transcurrido el tiempo de enfriamiento preseleccionado y la temperatura de la cámara de
enfriamiento es aún demasiado elevada, el sistema de enfriamiento se puede reiniciar
mediante el pulsador "RESET".

8060

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.9 Ejemplos de programación FUP

6723

6,67(0$'(
(1)5,$0,(172

,1',&$'25

5(6(7

6(1625'(
7(03(5$785$

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Comentario

Sensor

Input

BOOL

Señal del sensor de
temperatura

RESET

Input

BOOL

Reset

STOP

Input

BOOL

El sistema de enfria‐
miento se desconecta.

TiempoEnfrMax

-

TIME

Tiempo de enfriamiento
preseleccionado
Esta variable está defi‐
nida en el bloque de da‐
tos "DB_Enfriar".

TiempoEnfrAct

-

TIME

Tiempo de enfriamiento
transcurrido actualmen‐
te
Esta variable está defi‐
nida en el bloque de da‐
tos "DB_Enfriar".

SistemaEnfr

Output

BOOL

El sistema de enfria‐
miento se conecta.

Indicador

Output

BOOL

El indicador luminoso
del aviso "Sistema de
enfriamiento iniciado"
se enciende.

TempVariable

Temp

BOOL

Variable temporal
Esta variable guarda el
estado lógico del tempo‐
rizador CEI TP.

El segmento siguiente muestra la programación FUP para controlar la temperatura ambiente:
Segmento 1:

Programación del PLC
Manual de programación y manejo, 11/2019

8061

Creación de programas FUP
14.9 Ejemplos de programación FUP
ಯ73B'%ಯ
73
7LPH

ರ6HQVRUರ
ರ5HVHWರ

,1

(7

ರ'%B(QIULDUರ
7LHPSR(QIU$FW
ಯ7HPS9DULDEOHಯ

ರ'%B(QIULDUರ
7LHPSR(QIU0D[

37

4

Segmento 2:
ಯ7HPS9DULDEOHರ
ಯ6HQVRUರ

ಯ6LVWHPD(QIUರ ಯ,QGLFDGRUರ

ಯ6WRSರ

Si la temperatura de la cámara de enfriamiento aumenta por encima de los cero grados
centígrados, el estado lógico del operando "Sensor" cambia de "0" a "1" (flanco de señal
ascendente). Con un flanco de señal ascendente en la entrada IN de la función de
temporización se inicia el tiempo de enfriamiento preseleccionado y la "TempVariable" recibe
el estado lógico "1". El estado lógico "1" de la "TempVariable" hace que en el segmento 2 se
conecte el sistema de enfriamiento y se encienda el indicador luminoso. Las salidas "Sensor",
"SistemaEnfr" e "Indicador" tienen que programarse en el segmento 2, ya que en la salida Q
de la función de temporización sólo se puede programar una bobina.
Si la temperatura de la cámara de enfriamiento desciende por debajo de los cero grados
centígrados, el estado lógico del sensor cambia nuevamente a "0". Con ello se apagan el
sistema de enfriamiento y el indicador luminoso.
Si el sensor no indica ningún descenso de la temperatura, el sistema de enfriamiento y el
indicador luminoso se apagan a más tardar al transcurrir el tiempo de enfriamiento
preseleccionado. En este caso, el proceso de enfriamiento se puede reiniciar mediante el
pulsador "RESET". Al pulsar y soltar el pulsador se genera otro flanco ascendente en la
entrada IN, con lo que se reinicia el sistema de enfriamiento.
El sistema de enfriamiento y el indicador luminoso se pueden apagar en todo momento con el
pulsador "PARO".

Consulte también
Principios básicos de FUP (Página 8005)
Configuración de FUP (Página 8007)
Trabajar con segmentos (Página 8009)
Insertar elementos FUP (Página 8017)
Editar elementos FUP (Página 8034)
Cablear operandos en instrucciones FUP (Página 8041)
Ramas en FUP (Página 8045)
Circuitos lógicos en FUP (Página 8047)

8062

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas FUP
14.9 Ejemplos de programación FUP
Ejemplo de control de una cinta transportadora (Página 8050)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 8052)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 8054)
Ejemplo de cálculo de una ecuación (Página 8058)

Programación del PLC
Manual de programación y manejo, 11/2019

8063

Creación de programas FUP
14.9 Ejemplos de programación FUP

8064

Programación del PLC
Manual de programación y manejo, 11/2019

15

Crear programas AWL
15.1

Bases de AWL

15.1.1

Lenguaje de programación AWL

Vista general del lenguaje de programación AWL (lista de instrucciones)
AWL es un lenguaje de programación basado en un texto con el que se podrán programar
bloques lde código.
El programa AWL se divide en segmentos. Cada segmento puede tener una o varias líneas.
La numeración de las líneas comienza en cada segmento con 1 y continuará de manera
ascendente con cada nueva línea. En las líneas del segmento se programarán las
instrucciones individuales de AWL, pudiéndose indicar sólo una instrucción AWL por línea.
Cada instrucción representa una prescripción de trabajo para la CPU. La CPU ejecuta las
instrucciones de arriba abajo.
El siguiente ejemplo muestra la programación de AWL de un segmento:
AWL

Explicación

A "Tag_Input_1"

// Consultar si el estado lógico del operando es "1" y
combinar el resultado lógicamente con Y con el RLO actual

A

// Consultar si el estado lógico del operando es "1" y
combinar el resultado lógicamente con Y con el RLO actual

"Tag_Input_2"

S "Tag_Output"

15.1.2

// Poner el operando a "1" si el RLO es "1"

Intercambio de datos en AWL

Intercambio de datos S7-300/400
El intercambio de información entre las diferentes áreas de memoria se efectúa en AWL
mediante acumuladores para las CPU de la serie S7-300/400. Los acumuladores son registros
especiales en el procesador que sirven de memoria intermedia. Todas las CPU S7-300/400
tienen dos memorias intermedias que son el acumulador 1 (ACU 1) y el acumulador 2 (ACU 2).
Las CPU S7-400 y la CPU S7-318 tienen adicionalmente dos memorias intermedias más que
son los acumuladores 3 (ACU 3) y 4 (ACU 4).

Programación del PLC
Manual de programación y manejo, 11/2019

8065

Crear programas AWL
15.1 Bases de AWL

Intercambio de datos S7-1500
Las CPU de la serie S7-1500 ya no tienen registros en el procesador, pero pueden emular los
registros de direcciones, ACU 1, el ACU 2, la palabra de estado y los registros de bloques de
datos DB y DI. Los datos se intercambian, principalmente, a través de la interfaz del bloque,
bloques de datos globales o variables PLC. Si a pesar de todo se utilizan los acumuladores
para el intercambio de datos, la ejecución del programa se ralentiza.
Al realizar la programación en AWL para S7-1500, deberán tenerse en cuenta las siguientes
indicaciones generales en lo que respecta a los registros:
● Los contenidos de los registros, de los acumuladores y de la palabra de estado solo están
disponibles en segmentos AWL. Si un segmento KOP o FUP sigue a un segmento AWL,
desde el segmento KOP o FUP no se podrá acceder a los contenidos de registro que antes
se habían colocado en AWL. No obstante, en un segmento AWL posterior los contenidos
de registro vuelven a estar disponibles.
El bit RLO es una excepción: al realizar un cambio de idioma se pone en "indefinido" y en
los siguientes segmentos ya no estará disponible.
● Los valores de los registros, acumuladores y de la palabra de estado no se transfieren a los
bloques llamados. La única excepción son las instrucciones "CC" y "UC". Si utiliza "UC" o
"CC", para transferir al bloque llamado parámetros a través de registros, de la palabra de
estado o de acumuladores, active la opción "Alimentación de parámetros a través de
registros" en las propiedades del bloque llamado. Tenga en cuenta que esta opción solo
está disponible para bloques AWL con acceso estándar y que el bloque no puede tener
parámetros formales. Si esta opción está activada, los contenidos de registro pueden
transferirse entre bloques. También en este caso el bit RLO es una excepción: al salir del
bloque se pone en "indefinido" y ya no estará disponible tras una llamada de bloque.
● Después de cada acceso a un bloque de datos indicando una dirección totalmente
especificada (p. ej. %DB10.DBW10), el registro de bloques de datos DB se pone a "0". Un
acceso posterior parcialmente especificado provoca un error durante la compilación.
● Para transferir una información de error al bloque invocante, se puede utilizar el bit BR. La
información de error primero debe guardarse en el bloque llamado con la instrucción
"SAVE" en el bit BR. A continuación se puede leer el bit BR en el bloque invocante.
● Si se direcciona simbólicamente un parámetro formal local desde la interfaz de bloque en
S7-1500 (p. ej. con la instrucción L #myIn), siempre se accede al bloque de datos que se
ha indicado como instancia en la llamada del bloque. Las instrucciones OPNDI, L AR2,
+AR2, TDB y TAR cambian el contenido del registro DI o de direccionamiento, pero los
registros ya no se evalúan en el direccionamiento de parámetros formales locales.

Cargar y transferir
Al intercambiar los datos, se indentificará la dirección del flujo de la información. Cuando se
transfieren los datos desde un área de memoria al acumulador 1, se habla de cargar los datos.
La transferencia de datos desde el acumulador 1 al área de memoria se denominará
"Transferir". Para cargar y transferir en AWL se emplearán las instrucciones de carga y
transferencia.
Es necesario cargar y transferir en especial a la hora de procesar los valores digitales. Por ej.
cuando se suman dos valores, éstos se deberán cargar en la memoria intermedia y se
ejecutará la correspondiente instrucción sumadora. Primero se cargará el primer valor
acumulativo en el acumulador 1. Al cargar el segundo sumando se desplazará al acumulador
2 el primer valor que se encuentra en el acumulador 1. Después de ejecutar la instrucción

8066

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.1 Bases de AWL
sumadora (por ej. I+) se guardará la suma en el acumulador 1. Será posible transferir la suma
a cualquier operando gracias a la instrucción de transferencia.
Todos los acumuladores tienen una longitud de 32 bits y están organizados en bytes. La
transferencia de datos entre las áreas de memoria y el acumulador 1 puede realizarse en
bytes, palabras, o palabras dobles.

Intercambio de datos entre los acumuladores
Se podrán intercambiar datos entre los acumuladores individuales. Para ello se emplearán las
instrucciones para acumuladores "TAK", "PUSH" y "POP". Estas permiten transferir datos
entre los acumuladores disponibles e intercambiar bytes en el acumulador 1. Tenga en cuenta
que en el S7-1500 ya no se dispone de las instrucciones para acumuladores "ENT" y "LEAVE".

Consulte también
Alimentación de parámetros a través de registros en la llamada de bloques en AWL
(Página 8067)
Carga (Página 5437)
Transferir (Página 5446)
Acumulador (Página 5534)

15.1.3

Alimentación de parámetros a través de registros

15.1.3.1

Alimentación de parámetros a través de registros en la llamada de bloques en AWL
En AWL pueden realizarse llamadas de bloques mediante las siguientes instrucciones:
● CALL: Llamar bloque
● UC: Llamada incondicional
● CC: Llamada condicional
En la llamada de bloque, se transfieren generalmente valores entre el bloque llamado y el
bloque invocante. Las posibilidades del intercambio de datos difieren según la familia de CPU.
Consulte también: Intercambio de datos en AWL (Página 8065)

Valores transferidos del bloque invocante al bloque llamado
La siguiente tabla muestra los registros, acumuladores y bits de estado disponibles en el
bloque llamado directamente después de una llamada de bloque y antes de procesarse el
primer segmento:

Programación del PLC
Manual de programación y manejo, 11/2019

8067

Crear programas AWL
15.1 Bases de AWL

S7-300/400

S7-1500

UC/CC

CALL

UC/CC
con opción "Alimenta‐
ción de parámetros a
través de registros"

CALL

Bit de estado OS

0

0

0

0

Bit de estado OV

W

W

W

0

Bit de estado CC0

W

W

W

0

Bit de estado CC1

W

W

W

0

BR

W

W

W

1

RLO

W

W

W

U

Acu 1

W

W

W

U

Acu 2

W

W

W

U

Registro de direccio‐
nes 1

W

W

W

0

Registro de direccio‐
nes 2

W

Call FC: W
Call FB: offset de ins‐
tancia

W

Call FC: 0
Call FB: offset de ins‐
tancia

Registro DB

W

W

W

U

Registro DI

W

Call FC: W
Call FB: número DB de
instancia

W

Call FC: U
Call FB: número DB de
instancia

Leyenda:
0 = registro se pone a "0" en el cambio de bloque.
1 = registro de pone a "1" en el cambio de bloque.
W = contenido del registro puede activarse en el bloque invocante y leerse en el bloque
llamado.
U = contenido del registro no se transfiere al bloque llamado. El contenido es indefinido, el
acceso provoca un error al compilar.
Offset de instancia = offset en DB de instancia
Número DB de instancia = número del DB de instancia

Valores devueltos del bloque llamado al bloque invocante
La siguiente tabla muestra los registros, acumuladores y bits de estado disponibles en el
bloque invocante directamente después de procesarse la llamada de bloque:
S7-300/400

S7-1500

UC/CC

CALL

UC/CC
con opción "Alimenta‐
ción de parámetros a
través de registros"

CALL

Bit de estado OS

0

0

0

0

Bit de estado OV

W

W

W

-

Bit de estado CC0

W

W

W

-

Bit de estado CC1

W

W

W

-

8068

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.1 Bases de AWL
S7-300/400

S7-1500

BR

W

W

W

W

RLO

W

W1

W

U

Acu 1

W

W1

W

-

Acu 2

W

W1

W

-

Registro de direccio‐
nes 1

W

W1

W

-

Registro de direccio‐
nes 2

W

Call FC: W
Call FB: -

W

-

Registro DB

-

X

-

-

Registro DI

-

X

-

-

Leyenda:
0 = registro se pone a "0" en el cambio de bloque.
1 = registro se pone a "1" en el cambio de bloque.
W = contenido del registro puede activarse en el bloque llamado y leerse en el bloque
invocante.
W1 = los parámetros de salida y de entrada/salida del bloque llamado pueden modificar el valor
devuelto.
- = el contenido del registro no se devuelve al bloque invocante, la llamada de bloque no
modifica el contenido.
U = el contenido del registro no se transfiere al bloque llamado. El contenido es indefinido, el
acceso provoca un error al compilar.
X = contenido del registro no se devuelve al bloque invocante. Sin embargo, los parámetros del
bloque llamado pueden modificar implícitamente el valor.

Consulte también
Activar alimentación de parámetros a través de registros (Página 8069)

15.1.3.2

Activar alimentación de parámetros a través de registros

Requisitos
● La opción "Acceso optimizado al bloque" está desactivada.
● La interfaz del bloque no contiene parámetros.

Procedimiento
Para activar la alimentación de parámetros a través de registros, proceda del siguiente modo:
1. Abra la carpeta "Bloques de programa" del árbol del proyecto.
2. Haga clic con el botón derecho del ratón en el bloque para el que desea permitir la
alimentación de parámetros a través de registros.

Programación del PLC
Manual de programación y manejo, 11/2019

8069

Crear programas AWL
15.2 Configuración de AWL
3. Elija el comando "Propiedades" del menú contextual.
4. Se abre el diálogo de propiedades del bloque.
5. Haga clic en "Atributos" en la navegación local.
6. Active la opción "Alimentación de parámetros a través de registros".
7. Confirme las entradas con "Aceptar".

Consulte también
Alimentación de parámetros a través de registros en la llamada de bloques en AWL
(Página 8067)
Intercambio de datos en AWL (Página 8065)

15.2

Configuración de AWL

15.2.1

Vista general de configuraciones de AWL

Sinopsis
La siguiente tabla muestra la configuración que usted puede realizar para AWL:
Grupo

Ajuste

Descripción

Vista

Ajuste de líneas con Intro

Añade un ajuste de líneas al pulsar la
tecla Intro.

Consulte también
Modificar la configuración (Página 8070)

15.2.2

Modificar la configuración

Procedimiento
Para modificar la configuración, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Modifique la configuración.

8070

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.3 Trabajar con segmentos

Resultado
El cambio se aplica sin necesidad de guardarlo explícitamente.

Consulte también
Vista general de configuraciones de AWL (Página 8070)

15.3

Trabajar con segmentos

15.3.1

Utilizar segmentos

Función
El programa de usuario se crea en el bloque, dentro de segmentos. Para poder programar un
bloque lógico, éste debe contener como mínimo un segmento. El programa de usuario también
se puede dividir en varios segmentos para facilitar la claridad.

Consulte también
Insertar segmentos (Página 8071)
Seleccionar segmentos (Página 8072)
Copiar e insertar segmentos (Página 8073)
Borrar segmentos (Página 8074)
Contraer y expandir segmentos (Página 8074)
Insertar título del segmento (Página 8075)
Introducir el comentario del segmento (Página 8077)
Navegar en segmentos (Página 8078)

15.3.2

Insertar segmentos

Requisitos
Un bloque está abierto.

Programación del PLC
Manual de programación y manejo, 11/2019

8071

Crear programas AWL
15.3 Trabajar con segmentos

Procedimiento
Para insertar un segmento nuevo, proceda del siguiente modo:
1. Seleccione el segmento debajo del cual desea insertar un segmento nuevo.
2. Elija el comando "Insertar segmento" del menú contextual.

Resultado
Se inserta un nuevo segmento vacío en el bloque.

Consulte también
Utilizar segmentos (Página 8071)
Seleccionar segmentos (Página 8072)
Copiar e insertar segmentos (Página 8073)
Borrar segmentos (Página 8074)
Contraer y expandir segmentos (Página 8074)
Insertar título del segmento (Página 8075)
Introducir el comentario del segmento (Página 8077)
Navegar en segmentos (Página 8078)

15.3.3

Seleccionar segmentos

Requisitos
Existe un segmento.

Seleccionar un segmento
Para seleccionar un segmento, proceda del siguiente modo:
1. Haga clic en la barra de título del segmento que desea seleccionar.

Seleccionar varios segmentos
Para seleccionar varios segmentos individuales, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Ctrl>.
2. Haga clic en todos los segmentos que desea seleccionar.

8072

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.3 Trabajar con segmentos
Para seleccionar varios segmentos consecutivos, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Mayús>.
2. Haga clic en el primer segmento que desea seleccionar.
3. Haga clic en el último segmento que desea seleccionar.
Se seleccionan el primer y último segmento, así como todos los segmentos que se
encuentran entre éstos.

Consulte también
Utilizar segmentos (Página 8071)
Insertar segmentos (Página 8071)
Copiar e insertar segmentos (Página 8073)
Borrar segmentos (Página 8074)
Contraer y expandir segmentos (Página 8074)
Insertar título del segmento (Página 8075)
Introducir el comentario del segmento (Página 8077)
Navegar en segmentos (Página 8078)

15.3.4

Copiar e insertar segmentos
Los segmentos copiados pueden insertarse en el mismo bloque o en un bloque diferente. Los
segmentos creados en KOP o FUP también pueden insertarse en los bloques de cada uno de
los lenguajes de programación diferentes.

Requisitos
Existe un segmento.

Procedimiento
Para copiar e insertar un segmento, proceda del siguiente modo:
1. Seleccione el o los segmentos que desea copiar.
2. Elija el comando "Copiar" del menú contextual.
3. Seleccione el segmento debajo del cual desea insertar el segmento copiado.
4. Elija el comando "Pegar" del menú contextual.

Consulte también
Utilizar segmentos (Página 8071)
Insertar segmentos (Página 8071)

Programación del PLC
Manual de programación y manejo, 11/2019

8073

Crear programas AWL
15.3 Trabajar con segmentos
Seleccionar segmentos (Página 8072)
Borrar segmentos (Página 8074)
Contraer y expandir segmentos (Página 8074)
Insertar título del segmento (Página 8075)
Introducir el comentario del segmento (Página 8077)
Navegar en segmentos (Página 8078)

15.3.5

Borrar segmentos

Requisitos
Existe un segmento.

Procedimiento
Para borrar un segmento, proceda del siguiente modo:
1. Seleccione el segmento que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Utilizar segmentos (Página 8071)
Insertar segmentos (Página 8071)
Seleccionar segmentos (Página 8072)
Copiar e insertar segmentos (Página 8073)
Contraer y expandir segmentos (Página 8074)
Insertar título del segmento (Página 8075)
Introducir el comentario del segmento (Página 8077)
Navegar en segmentos (Página 8078)

15.3.6

Contraer y expandir segmentos

Requisitos
Existe un segmento.

8074

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.3 Trabajar con segmentos

Expandir y contraer un segmento
Para abrir un segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia la derecha situada en la barra de título del segmento.
Para cerrar un segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia abajo situada en la barra de título del segmento.

Expandir y contraer todos los segmentos
Para expandir o contraer todos los segmentos, proceda del siguiente modo:
1. Haga clic en el botón "Abrir todos los segmentos" o "Cerrar todos los segmentos" de la barra
de herramientas.

Consulte también
Utilizar segmentos (Página 8071)
Insertar segmentos (Página 8071)
Seleccionar segmentos (Página 8072)
Copiar e insertar segmentos (Página 8073)
Borrar segmentos (Página 8074)
Insertar título del segmento (Página 8075)
Introducir el comentario del segmento (Página 8077)
Navegar en segmentos (Página 8078)

15.3.7

Insertar título del segmento
El título de segmento es la cabecera de un segmento. La longitud del título del segmento está
limitada a una línea. Puede introducir el título manualmente o definirlo de forma automática. Si
elige el ajuste automático, puede aplicarlo a segmentos individuales o establecer en la
configuración que el título del segmento debe definirse de forma automática.
Para la inserción automática del título del segmento se evalúa el comentario del operando de
una de las siguientes instrucciones del segmento:
● Asignación
● Activar salida
● Desactivar salida
Para ello, se utiliza la instrucción que aparece primero en el segmento.
El título del segmento solo se inserta automáticamente si se cumplen las siguientes
condiciones:
● El segmento todavía no tiene ningún título.
● El operando de la instrucción que se utiliza para el comentario tiene un comentario.

Programación del PLC
Manual de programación y manejo, 11/2019

8075

Crear programas AWL
15.3 Trabajar con segmentos

Nota
Al insertar el título del segmento de forma automática, tenga en cuenta las siguientes
limitaciones:
● Si modifica el comentario del operando con posterioridad, el título del segmento no se
actualiza.
● Si cambia el operando de la instrucción, el título del segmento no se actualiza.
● El título del segmento solo se define mediante las instrucciones de escritura citadas antes.
● Si el operando es del tipo de datos Array, se utiliza el comentario del Array y no los
comentarios de los elementos Array.
● No se tienen en cuenta los comentarios de operandos no válidos.

Introducir el título del segmento manualmente
Para introducir un título de segmento, proceda del siguiente modo:
1. Haga clic en la barra de título del segmento.
2. Introduzca el título de segmento.

Definir el título del segmento automáticamente
Para establecer que el título del segmento debe definirse fundamentalmente de forma
automática, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Active la casilla de verificación "Establecer título del segmento automáticamente" en el
grupo "Configuración avanzada".
Desde este momento, los títulos de los segmentos se definirán automáticamente si se
cumplen las condiciones anteriores.
Para definir automáticamente un título de segmento concreto, proceda del siguiente modo:
1. Haga clic en la barra de título de un segmento con el botón derecho del ratón y seleccione
"Segmento <Número del segmento>".
2. Elija el comando "Establecer título del segmento automáticamente" del menú contextual.
El título del segmento seleccionado se define a partir del comentario del operando si se
cumplen las condiciones anteriores.

Consulte también
Utilizar segmentos (Página 8071)
Insertar segmentos (Página 8071)
Seleccionar segmentos (Página 8072)
Copiar e insertar segmentos (Página 8073)

8076

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.3 Trabajar con segmentos
Borrar segmentos (Página 8074)
Contraer y expandir segmentos (Página 8074)
Introducir el comentario del segmento (Página 8077)
Navegar en segmentos (Página 8078)

15.3.8

Introducir el comentario del segmento
Los comentarios de segmentos sirven para documentar el contenido del programa en los
distintos segmentos. Por ejemplo, es posible describir la función del segmento, o bien llamar
la atención sobre peculiaridades.

Requisitos
Existe un segmento.

Procedimiento
Para introducir un comentario de segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia la derecha antepuesta al título del segmento.
2. Si el área de comentarios no resulta visible, haga clic en el botón "Activar/desactivar
comentarios de segmento" de la barra de herramientas.
Se abre el área de comentarios.
3. En el área de comentario, haga clic en "Comentario".
El texto "Comentario" aparece seleccionado.
4. Introduzca el comentario del segmento.

Consulte también
Utilizar segmentos (Página 8071)
Insertar segmentos (Página 8071)
Seleccionar segmentos (Página 8072)
Copiar e insertar segmentos (Página 8073)
Borrar segmentos (Página 8074)
Contraer y expandir segmentos (Página 8074)
Insertar título del segmento (Página 8075)
Navegar en segmentos (Página 8078)

Programación del PLC
Manual de programación y manejo, 11/2019

8077

Crear programas AWL
15.3 Trabajar con segmentos

15.3.9

Navegar en segmentos
Existe la posibilidad de navegar en un bloque directamente hasta una posición determinada.

Procedimiento
Para navegar en un bloque hasta una posición determinada, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la sección de lógica de la ventana de
programación.
2. Elija el comando "Ir a > Segmento/línea" del menú contextual.
Se abre el cuadro diálogo "Ir a".
3. Introduzca el segmento hasta el que desea navegar.
4. Introduzca el número de la fila del segmento hasta el que desea navegar.
5. Confirme la entrada realizada con "Aceptar".

Resultado
Si es posible, se muestra la fila correspondiente. En caso de que el segmento o la fila deseados
no existan, se visualiza el último segmento existente, o bien, la última fila existente en el
segmento deseado.

Consulte también
Utilizar segmentos (Página 8071)
Insertar segmentos (Página 8071)
Seleccionar segmentos (Página 8072)
Copiar e insertar segmentos (Página 8073)
Borrar segmentos (Página 8074)
Contraer y expandir segmentos (Página 8074)
Insertar título del segmento (Página 8075)
Introducir el comentario del segmento (Página 8077)

8078

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL

15.4

Añadir instrucciones AWL

15.4.1

Reglas sobre AWL

Reglas
Con la entrada incremental de instrucciones AWL se deberán observan las siguientes reglas:
● La instrucción consiste en la entrada de una marca opcional de salto, de una operación, de
un operando y de un comentario opcional. Ejemplo:
M001: U E1.0 //Comentario
● Cada instrucción está en una línea.
● Por cada bloque se puede introducir un máximo de 999 segmentos.
● Al introducir operandos o direcciones absolutas no habrá ninguna diferencia entre
mayúsculas y minúsculas.
● Si desea recibir ayuda para abrir el bloque, deberá programar el bloque abierto antes que
el bloque que desea abrir.
Las instrucciones no admisibles se marcarán en rojo. La transferencia del contenido de un
almacenador a una memoria intermedia y la ventana de inspección nos indican que debemos
corregir errores.

Operaciones de salto
En operaciones de salto asegúrese de que la meta siempre es el inicio de una cadena lógica
y de que se encuentra dentro de otro nivel de paréntesis (no aplicable para la CPU 318-2). La
meta no puede estar dentro de una cadena lógica o de un nivel de paréntesis.

Consulte también
Introducir manualmente las instrucciones AWL (Página 8082)
Insertar instrucciones AWL empleando la Task Card "Instrucciones" (Página 8083)
Insertar comentarios (Página 8097)
Insertar operandos (Página 8086)
Emplear favoritos en AWL (Página 8088)
Insertar llamadas de bloque en AWL (Página 8090)

Programación del PLC
Manual de programación y manejo, 11/2019

8079

Crear programas AWL
15.4 Añadir instrucciones AWL

15.4.2

Instrucciones de la librería global "Long Functions"

Descripción
La tabla siguiente muestra las instrucciones incluidas en la librería global "Long Functions":

8080

Instrucción

Significado

ABS_LINT

Calcular valor absoluto con el tipo de datos LINT

ABS_LREAL

Calcular valor absoluto con el tipo de datos LREAL

ACOS_LREAL

Calcular valor de arcocoseno con el tipo de datos
LREAL

ADD_LINT

Sumar con el tipo de datos LINT

ADD_LREAL

Sumar con el tipo de datos LREAL

ADD_ULINT

Sumar con el tipo de datos ULINT

AND_LWORD

Operación lógica Y con el tipo de datos LWORD

ASIN_LREAL

Calcular valor de arcoseno con el tipo de datos
LREAL

ATAN_LREAL

Calcular valor de arcotangente con el tipo de datos
LREAL

COS_LREAL

Calcular valor de coseno con el tipo de datos
LREAL

DINT_to_LINT

Conversión del tipo de datos DINT a LINT

DIV_LINT

Dividir con el tipo de datos LINT

DIV_LREAL

Dividir con el tipo de datos LREAL

DIV_ULINT

Dividir con el tipo de datos ULINT

EQ_LINT

Comparar si es igual al tipo de datos LINT

EQ_LREAL

Comparar si es igual al tipo de datos LREAL

EQ_LWORD

Comparar si es igual al tipo de datos LWORD

EQ_ULINT

Comparar si es igual al tipo de datos ULINT

EXP_LREAL

Calcular valor exponencial con el tipo de datos
LREAL

GE_LINT

Comparar si es mayor o igual al tipo de datos LINT

GE_LREAL

Comparar si es mayor o igual al tipo de datos
LREAL

GE_ULINT

Comparar si es mayor o igual al tipo de datos
ULINT

GT_LINT

Comparar si es mayor que el tipo de datos LINT

GT_LREAL

Comparar si es mayor que el tipo de datos LREAL

GT_ULINT

Comparar si es mayor que el tipo de datos ULINT

LE_LINT

Comparar si es menor o igual al tipo de datos LINT

LE_LREAL

Comparar si es menor o igual al tipo de datos
LREAL

LE_ULINT

Comparar si es menor o igual al tipo de datos
ULINT

LINT_to_DINT

Conversión del tipo de datos LINT a DINT

LINT_to_LREAL

Conversión del tipo de datos LINT a LREAL

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL
Instrucción

Significado

LINT_to_ULINT

Conversión del tipo de datos LINT a ULINT

LN_LREAL

Calcular logaritmo natural con el tipo de datos
LREAL

LREAL_to_LINT

Conversión del tipo de datos LREAL a LINT

LREAL_to_REAL

Conversión del tipo de datos LREAL a REAL

LREAL_to_ULINT

Conversión del tipo de datos LREAL a ULINT

LT_LINT

Comparar si es menor que el tipo de datos LINT

LT_LREAL

Comparar si es menor que el tipo de datos LREAL

LT_ULINT

Comparar si es menor que el tipo de datos ULINT

LWORD_to_ULINT

Conversión del tipo de datos LWORD a ULINT

LWORD_to_WORD

Conversión del tipo de datos LWORD a WORD

MOVE_LINT

Copiar valor con el tipo de datos LINT

MOVE_LREAL

Copiar valor con el tipo de datos LREAL

MOVE_LWORD

Copiar valor con el tipo de datos LWORD

MOVE_ULINT

Copiar valor con el tipo de datos ULINT

MUL_LINT

Multiplicar con el tipo de datos LINT

MUL_LREAL

Multiplicar con el tipo de datos LREAL

MUL_ULINT

Multiplicar con el tipo de datos ULINT

NE_LINT

Comparar si es diferente del tipo de datos LINT

NE_LREAL

Comparar si es diferente del tipo de datos LREAL

NE_LWORD

Comparar si es diferente del tipo de datos LWORD

NE_ULINT

Comparar si es diferente del tipo de datos ULINT

NEG_LINT

Generar complemento a dos con el tipo de datos
LINT

NEG_LREAL

Generar complemento a dos con el tipo de datos
LREAL

OR_LWORD

Operación lógica O con el tipo de datos LWORD

RDN_LREAL

Redondear número con el tipo de datos LREAL

REAL_to_LREAL

Conversión del tipo de datos REAL a LREAL

SIN_LREAL

Calcular valor de seno con el tipo de datos LREAL

SQR_LREAL

Calcular cuadrado con el tipo de datos LREAL

SQRT_LREAL

Calcular raíz cuadrada con el tipo de datos LREAL

SUB_LINT

Restar con el tipo de datos LINT

SUB_LREAL

Restar con el tipo de datos LREAL

SUB_ULINT

Restar con el tipo de datos ULINT

TAN_LREAL

Calcular valor de tangente con el tipo de datos
LREAL

TRUNC_LREAL

Truncar a entero con el tipo de datos LREAL

UDINT_to_ULINT

Conversión del tipo de datos UDINT a ULINT

ULINT_to_LINT

Conversión del tipo de datos ULINT a LINT

ULINT_to_LREAL

Conversión del tipo de datos ULINT a LREAL

ULINT_to_LWORD

Conversión del tipo de datos ULINT a LWORD

ULINT_to_UDINT

Conversión del tipo de datos ULINT a UDINT

Programación del PLC
Manual de programación y manejo, 11/2019

8081

Crear programas AWL
15.4 Añadir instrucciones AWL
Instrucción

Significado

WORD_to_LWORD

Conversión del tipo de datos WORD a LWORD

XOR_LWORD

O-exclusiva con el tipo de datos LWORD

Consulte también
Introducir manualmente las instrucciones AWL (Página 8082)
Insertar instrucciones AWL empleando la Task Card "Instrucciones" (Página 8083)
Insertar operandos (Página 8086)

15.4.3

Introducir manualmente las instrucciones AWL
Al crear un nuevo segmento, ya sea de manera automática o manual, aparece un campo de
entrada de dos líneas dentro del segmento. En este campo de entrada se introducirán las
instrucciones AWL.
Nota
S7-1500: Las instrucciones de la Task Card "Instrucciones" que utilizan registros y
acumuladores emulados no pueden utilizar variables con una longitud de 64 bits como
operandos, p. ej. LInt. Si desea emplear variables de 64 bits, utilice las instrucciones de la
librería global "Long Functions".

Requisitos
Existe un segmento.

Procedimiento
Para introducir las instrucciones AWL en un segmento, se deberá proceder de la siguiente
manera:
1. Pulsar dentro de un segmento en la primera línea vacía del campo de entrada.
2. Introduzca la instrucción.
3. Deje un espacio.
4. Introduzca el operando.
Nota
Mediante Drag & Drop podrá insertar un operando ya definido, procedente de la tabla de
variables del PLC o de la vista detallada.
5. Introduzca un comentario de línea. Este paso es opcional.
6. Confirme la instrucción con la tecla Intro.
7. Repita los pasos 2 a 6 hasta que haya insertado todas las instrucciones necesarias.

8082

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL

Resultado
Después de confirmar la instrucción con la tecla Intro, el editor programador llevará a cabo las
siguientes acciones:
● Comprobación de sintaxis: Las entradas erróneas aparecerán en rojo y en cursiva después
de la comprobación. Además aparece un mensaje de error detallado en la ficha "Sintaxis"
de la ventana de información.
● Cambio de mayúsculas y minúsculas: Las instrucciones se cambiarán en letras
mayúsculas.
● Si ha introducido direcciones absolutas en la programación simbólica, se cambiarán a
nombres simbólicos. Si no hay ningún nombre simbólico, se insertará "Tag_< Número>".
● Llamada de bloque: Se insertarán y visualizarán los parámetros necesarios.
● En el campo de entrada se insertará otra línea.

Consulte también
Instrucciones de la librería global "Long Functions" (Página 8080)
Reglas sobre AWL (Página 8079)
Insertar instrucciones AWL empleando la Task Card "Instrucciones" (Página 8083)
Insertar operandos (Página 8086)
Emplear favoritos en AWL (Página 8088)
Insertar llamadas de bloque en AWL (Página 8090)
Insertar comentarios (Página 8097)

15.4.4

Insertar instrucciones AWL empleando la Task Card "Instrucciones"
Al crear un nuevo segmento, ya sea de manera automática o manual, aparece un campo de
entrada de dos líneas dentro del segmento. En este campo de entrada se introducen las
instrucciones AWL.
Nota
S7-1500: Las instrucciones de la Task Card "Instrucciones" que utilizan registros y
acumuladores emulados no pueden utilizar variables con una longitud de 64 bits como
operandos, p. ej. LInt. Si desea emplear variables de 64 bits, utilice las instrucciones de la
librería global "Long Functions".

Requisitos
Existe un segmento.

Programación del PLC
Manual de programación y manejo, 11/2019

8083

Crear programas AWL
15.4 Añadir instrucciones AWL

Procedimiento
Para insertar en un segmento las instrucciones AWL empleando la Task Card "Instrucciones",
deberá proceder de la siguiente manera:
1. Abra la Task Card "Instrucciones".
2. Para insertar la instrucción se deberá seleccionar uno de los siguientes pasos:
– Navegue hasta al elemento AWL que desea insertar y arrástrelo mediante Drag & Drop
al lugar deseado del segmento.
– Marque el lugar del segmento en el que desea insertar el elemento y haga doble clic en
el segmento a insertar.
3. Introduzca los operandos necesarios.
Nota
Es posible insertar un operando ya definido mediante Drag & Drop desde la tabla de
variables PLC, desde un bloque de datos, desde la vista detallada o desde la interfaz del
bloque.
4. Introduzca un comentario de línea. Este paso es opcional.
5. Repita los pasos 2 a 4 hasta que haya insertado todas las instrucciones necesarias.

Resultado
Después de confirmar la instrucción con la tecla Intro, el editor programador llevará a cabo las
siguientes acciones:
● Comprobación de sintaxis: Las entradas erróneas aparecerán en rojo y en cursiva después
de la comprobación. Además aparecerá un mensaje detallado de errores en la ventana de
información.
● Cambio de mayúsculas y minúsculas: Las instrucciones se cambiarán en letras
mayúsculas.
● Si ha introducido direcciones absolutas en la programación simbólica, se cambiarán a
nombres simbólicos. Si no hay ningún nombre simbólico, se insertará "Tag_< Número>".
● Llamada de bloque: Se insertan y visualizan los parámetros necesarios.
● En el campo de entrada se inserta otra línea.

Consulte también
Instrucciones de la librería global "Long Functions" (Página 8080)
Reglas sobre AWL (Página 8079)
Introducir manualmente las instrucciones AWL (Página 8082)
Insertar operandos (Página 8086)
Emplear favoritos en AWL (Página 8088)
Insertar llamadas de bloque en AWL (Página 8090)
Insertar comentarios (Página 8097)

8084

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL

15.4.5

Seleccionar el tipo de datos de una instrucción AWL

15.4.5.1

Seleccionar un tipo de datos

Introducción
Algunas instrucciones pueden ejecutarse con varios tipos de datos diferentes. Si en el
programa se utiliza alguna de estas instrucciones, en la ubicación concreta del programa es
preciso definir un tipo de datos permitido para la instrucción en cuestión.
Los tipos de datos admisibles para una instrucción se indican en la lista desplegable
correspondiente. Seleccionando una entrada de la lista desplegable se determina el tipo de
datos de la instrucción. Si el tipo de datos de un operando difiere del tipo de datos de la
instrucción y no puede convertirse de forma implícita, el operando se muestra en color rojo y
aparece una ventana desplegable con el mensaje de error correspondiente.

15.4.5.2

Definir el tipo de datos de una instrucción

Introducción
Algunas instrucciones pueden ejecutarse con varios tipos de datos diferentes. Si se insertan
este tipo de instrucciones en el programa, es preciso definir el tipo de datos adecuado para
ellas en la ubicación concreta del programa.

Procedimiento
Para definir el tipo de datos de una instrucción mediante la lista desplegable, proceda del
siguiente modo:
1. Arrastre la instrucción mediante Drag & Drop hasta la posición deseada del programa.
En la lista desplegable de la instrucción insertada se visualiza la entrada "???" (no definida).
2. Haga clic en el triángulo situado en la esquina superior de la lista desplegable.
Ésta se abre y se visualizan los tipos de datos admisibles para la instrucción.
3. Seleccione un tipo de datos de la lista desplegable.
Aparece el tipo de datos seleccionado.

Programación del PLC
Manual de programación y manejo, 11/2019

8085

Crear programas AWL
15.4 Añadir instrucciones AWL

15.4.6

Insertar operandos
Los operandos de una instrucción AWL se pueden insertar manualmente o bien arrastrarlos
mediante Drag & Drop desde la tabla de variables PLC, desde un bloque de datos, desde la
vista detallada o desde la interfaz del bloque.
Nota
S7-1500: Las instrucciones de la Task Card "Instrucciones" que utilizan registros y
acumuladores emulados no pueden utilizar variables con una longitud de 64 bits como
operandos, p. ej. LInt. Si desea emplear variables de 64 bits, utilice las instrucciones de la
librería global "Long Functions".

Procedimiento
Para insertar manualmente los operandos de una instrucción AWL, se deberá proceder de la
siguiente manera:
1. Ponga el cursor a la derecha al lado de la operación.
2. Deje un espacio y a continuación inserte el operando.
Nota
Si en la programación simbólica introduce la dirección absoluta de un parámetro ya
definido, esta dirección absoluta se sustituirá por el nombre simbólico del parámetro en
cuanto confirme la entrada. Si el parámetro no se ha definido aún, en la tabla de variables
PLC se introducirá una nueva variable con esta dirección absoluta y el nombre estándar
"Tag_1". Cuando confirme la entrada, la dirección absoluta se sustituirá por el nombre
simbólico "Tag_1".
3. Confirme el parámetro pulsando la tecla Intro.
4. Si todavía no ha definido el parámetro, puede hacerlo mediante el menú contextual
directamente en el editor programador.
Consulte también: "Declarar directamente el contenido de variables en el editor
programador (Página 7900)"
O mediante Drag & Drop desde la tabla de variables PLC:
1. En el árbol del proyecto, seleccione la carpeta "Variables PLC" y abra la tabla de variables
PLC.
2. Si está abierta la tabla de variables PLC, arrastre el símbolo desde la primera columna de
la variable deseada hasta la respectiva posición del programa. Si la tabla de variables PLC
no está abierta, abra la vista detallada. Arrastre la variable deseada desde la vista detallada
hasta la respectiva posición del programa.
O mediante Drag & Drop desde la interfaz del bloque:
1. Abra la interfaz del bloque.
2. Arrastre el operando deseado desde la interfaz del bloque hasta la ventana de
instrucciones.

8086

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL

Consulte también
Instrucciones de la librería global "Long Functions" (Página 8080)
Reglas sobre AWL (Página 8079)
Introducir manualmente las instrucciones AWL (Página 8082)
Insertar instrucciones AWL empleando la Task Card "Instrucciones" (Página 8083)
Emplear favoritos en AWL (Página 8088)
Insertar llamadas de bloque en AWL (Página 8090)
Insertar comentarios (Página 8097)
Utilizar y direccionar operandos (Página 95)
Utilizar la función automática de autocompletar (Página 7682)

15.4.7

Mostrar u ocultar informaciones de variables

Introducción
Al margen de la representación absoluta o simbólica de los operandos, podrá mostrar u ocultar
los comentarios sencillos o jerárquicos para documentar las variables. Esta información se
recoge de la interfaz del bloque en el caso de las variables locales y las variables DB, y de la
tabla de variables PLC en el caso de las variables válidas para toda la CPU.
Es posible visualizar la información de las variables para todos los bloques o solo para bloques
abiertos individuales. Si selecciona la información de variables para todos los bloques, se
muestra la información de las variables de todos los bloques abiertos actuales y futuros.
La información de las variables se puede volver a ocultar en cualquier momento. Si se ha
ocultado la información de las variables de todos los bloques, se puede volver a ver para
bloques abiertos individualmente.
Si se selecciona la visualización de información de variables con comentarios jerárquicos, en
el caso de las variables estructuradas también se muestran los comentarios de los niveles de
estructura de orden superior. En ese caso, esa información se muestra entre paréntesis
después del comentario de la variable, y los comentarios de los diferentes niveles se separan
con un punto. Si en un nivel de estructura no hay ningún comentario para una variable, el
comentario en cuestión no se visualiza, lo que puede reconocerse por dos puntos seguidos.

Mostrar u ocultar información de variables para todos los bloques
Para mostrar u ocultar la información de variables para todos los bloques, proceda del
siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.

Programación del PLC
Manual de programación y manejo, 11/2019

8087

Crear programas AWL
15.4 Añadir instrucciones AWL
3. Para visualizar la información de las variables, seleccione las opciones "Mostrar" o
"Información de la variable con jerarquía" en la lista desplegable "Información de la
variable", en función de si desea visualizar los comentarios sencillos o jerárquicos.
4. Para ocultar la información de las variables, seleccione la opción "Ocultar" en la lista
desplegable "Información de la variable".
La información de las variables se muestra u oculta para todos los bloques abiertos. Si abre
más bloques, la información de las variables se mostrará u ocultará dependiendo del ajuste
seleccionado.

Mostrar u ocultar información de variables para un bloque abierto
Para mostrar u ocultar la información de variables para un bloque abierto, proceda del
siguiente modo:
1. Para visualizar la información de las variables, seleccione las opciones "Mostrar
información de la variable" o "Información de la variable con jerarquía" en la lista
desplegable "Muestra información sobre la variable", en función de si desea visualizar los
comentarios sencillos o jerárquicos.
2. Para ocultar la información de las variables, seleccione la opción "Ocultar información de la
variable" en la lista desplegable "Muestra información sobre la variable".
Se muestra u oculta la información sobre las variables.

15.4.8

Emplear favoritos en AWL

15.4.8.1

Insertar elementos AWL en favoritos

Requisitos
● Hay un bloque abierto.
● La Task Card "Instrucciones" tiene configurado el modo multipaleta, o bien los Favoritos se
muestran también en el editor.

Procedimiento
Para agregar instrucciones a los Favoritos, proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. Maximice la paleta "Instrucciones básicas".
3. En la paleta "Instrucciones básicas", navegue hasta la instrucción que desea agregar a los
Favoritos.
4. Arrastre la instrucción hasta la paleta "Favoritos" o hasta el área de Favoritos del editor de
programación mediante Drag & Drop.

8088

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL

Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Insertar instrucciones AWL empleando favoritos (Página 8089)
Eliminar instrucciones AWL retirándolas de favoritos (Página 8090)
Sinopsis del editor de programación (Página 7657)

15.4.8.2

Insertar instrucciones AWL empleando favoritos

Requisitos
● Hay un bloque abierto.
● Existen Favoritos.

Procedimiento
Para insertar una instrucción en un programa desde los Favoritos, proceda del siguiente modo:
1. Arrastre la instrucción deseada mediante Drag & Drop desde los Favoritos hasta la posición
deseada.
O bien:
1. Marque el punto del programa en el que quiere insertar la instrucción.
2. En los Favoritos, haga clic en la instrucción que desea insertar.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Sinopsis del editor de programación (Página 7657)
Insertar elementos AWL en favoritos (Página 8088)
Introducir manualmente las instrucciones AWL (Página 8082)
Insertar instrucciones AWL empleando la Task Card "Instrucciones" (Página 8083)
Eliminar instrucciones AWL retirándolas de favoritos (Página 8090)

Programación del PLC
Manual de programación y manejo, 11/2019

8089

Crear programas AWL
15.4 Añadir instrucciones AWL

15.4.8.3

Eliminar instrucciones AWL retirándolas de favoritos

Requisitos
Hay un bloque lógico abierto.

Procedimiento
Para eliminar instrucciones de los Favoritos, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la instrucción que desea eliminar.
2. Elija el comando "Eliminar instrucción" del menú contextual.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Insertar elementos AWL en favoritos (Página 8088)
Insertar instrucciones AWL empleando favoritos (Página 8089)
Sinopsis del editor de programación (Página 7657)

15.4.9

Insertar llamadas de bloque en AWL

15.4.9.1

Insertar manualmente llamadas de bloque
Podrá insertar llamadas para funciones (FC) y bloques de función (FB). Los bloques de función
pueden llamarse como instancia individual, multiinstancia o instancia de parámetro.
Consulte también: Principios básicos de las instancias (Página 61)

Requisitos
Existe un segmento.

8090

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL

Insertar una llamada de una función (FC)
Para llamar una función en un segmento AWL, se deberá proceder de la siguiente manera:
1. Inserte "CALL <Nombre de la función que se desea abrir>".
Sustituya el fichero "<Nombre de la función que se desea abrir>" por el nombre de la función
que quiere llamar.
2. Confirme las entradas con la tecla Intro.
– Si ya existe la función, se insertarán en la llamada todos los parámetros de función.
– Si todavía no existe la función, usted mismo deberá insertar los parámetros.

Insertar una llamada de un bloque de función (FB)
Para insertar una llamada de un bloque de función (FB), proceda del siguiente modo:
1. Introduzca "CALL <Nombre del bloque de función que se desea llamar>, <Nombre del
bloque de datos de instancia>".
Sustituya el fichero "<Nombre del bloque de función que se desea abrir>" por el nombre del
bloque de función que quiere llamar. Es opcional la entrada del bloque de datos de
instancia.
2. Confirme las entradas con la tecla Intro.
Si no se indica el bloque de datos de instancia o si el bloque indicado no existe, se abrirá
el cuadro de diálogo "Opciones de llamada". En este caso ejecute los pasos 3 y 4.
3. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Después de hacer clic en el botón de "Instancia individual", deberá indicar un nombre en
el cuadro de texto "Nombre" para el bloque de datos al cual se deberá asignar la llamada.
Si se llama un bloque que contenga supervisiones, asigne un bloque de función ProDiag
a dichas supervisiones en el campo de entrada "FB ProDiag".
– Después de hacer clic en el botón de "Multiinstancia", deberá indicar en el campo de
entrada "Nombre en la interfaz" el nombre de la variable con el que registrará el bloque
abierto de función como variable estática en la interfaz del bloque que se desea llamar.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.
4. Confirme las entradas con "Aceptar".

Resultado
Al llamar las funciones existentes y los módulos de función existentes con el bloque de datos
de instancia, se insertarán en la llamada los parámetros de la función o del bloque de función.
A continuación usted deberá suministrar estos parámetros.
Consulte también: Transferencia de parámetros en la llamada de un bloque (Página 80)
Si al llamar un bloque de función especifica un bloque de datos de instancia que no existe aún,
éste se creará.

Programación del PLC
Manual de programación y manejo, 11/2019

8091

Crear programas AWL
15.4 Añadir instrucciones AWL

Consulte también
Insertar llamadas de bloque mediante Drag & Drop (Página 8092)
Actualizar las llamadas de bloque en AWL (Página 8093)
Cambiar el tipo de instancia (Página 8095)
Alimentación de parámetros a través de registros en la llamada de bloques en AWL
(Página 8067)

15.4.9.2

Insertar llamadas de bloque mediante Drag & Drop
Las llamadas de funciones (FC) y bloques de función (FB) existentes pueden insertarse desde
el árbol del proyecto mediante Drag & Drop. Los bloques de función pueden llamarse como
instancia individual, multiinstancia o instancia de parámetro.
Consulte también: Principios básicos de las instancias (Página 61)

Requisitos
● Existe un segmento.
● La función (FC) o el bloque de función (FB) que se va a llamar está disponible.

Insertar una llamada de una función (FC)
Para llamar una función en un segmento AWL empleando Drag & Drop, se deberá proceder de
la siguiente manera:
1. Arrastre la función desde el árbol del proyecto hasta el segmento.

8092

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL

Insertar una llamada de un bloque de función (FB)
Para insertar una llamada de un bloque de función (FB), proceda del siguiente modo:
1. Arrastre el bloque de función desde el árbol del proyecto hasta el segmento.
Se abre el cuadro de diálogo "Opciones de llamada".
2. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Después de hacer clic en el botón "Instancia individual", indique un nombre en el campo
de entrada "Nombre" para el bloque de datos de instancia al cual se deberá asignar la
llamada.
Si se llama un bloque que contenga supervisiones, asigne un bloque de función ProDiag
a dichas supervisiones en el campo de entrada "FB ProDiag".
– Si hace clic en el botón "Multiinstancia", introduzca a continuación en el cuadro de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.
3. Confirme las entradas con "Aceptar".

Resultado
La función o el bloque de función se inserta con sus respectivos parámetros. A continuación
usted deberá suministrar estos parámetros.
Consulte también: Transferencia de parámetros en la llamada de un bloque (Página 80)
Si al llamar un bloque de función especifica un bloque de datos de instancia que no existe aún,
éste se creará.

Consulte también
Insertar manualmente llamadas de bloque (Página 8090)
Actualizar las llamadas de bloque en AWL (Página 8093)
Cambiar el tipo de instancia (Página 8095)

15.4.9.3

Actualizar las llamadas de bloque en AWL
Si cambian los parámetros de interfaz de un bloque llamado, la llamada no podrá ejecutarse
correctamente. Actualice las llamadas de bloque con objeto de evitar llamadas incoherentes.

Programación del PLC
Manual de programación y manejo, 11/2019

8093

Crear programas AWL
15.4 Añadir instrucciones AWL
Las llamadas de bloque se pueden actualizar de distinta manera:
● Actualización explícita de todas las llamadas de bloque incoherentes en el editor de
programación.
Se actualizan las llamadas de bloque incoherentes del bloque abierto. Para ello se llevan
a cabo las acciones siguientes:
– Se agregan parámetros nuevos.
– Se eliminan parámetros borrados si no están conectados.
– Los parámetros a los que se ha cambiado el nombre adoptan el nombre nuevo.
● Actualización explícita de una llamada de bloque en el editor de programación.
Se muestra el cuadro de diálogo "Sincronización de interfaces". En este cuadro de diálogo
existe la posibilidad de cambiar la conexión de los operandos de la nueva interfaz.
Seguidamente se actualiza la llamada incoherente de este bloque. Para ello se llevan a
cabo las acciones siguientes:
– Se agregan parámetros nuevos.
– Se eliminan parámetros borrados si no están conectados.
– Los parámetros a los que se ha cambiado el nombre adoptan el nombre nuevo.
● Actualización implícita durante la compilación.
Se actualizan todas las llamadas de bloque en el programa, así como los tipos de datos
PLC utilizados. Tenga en cuenta que si se llaman funciones (FC) antes del siguiente
proceso de compilación deberán asignarse parámetros actuales a todos los parámetros
formales nuevos.

Actualizar todas las llamadas de bloque incoherentes en el editor de programación
Para actualizar todas las llamadas de bloque en un bloque, proceda del siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic en el botón "Actualizar llamadas de bloque incoherentes" de la barra de
herramientas.

Actualizar una llamada de bloque determinada en el editor de programación
Para actualizar una llamada de bloque determinada en el editor de programación, proceda del
siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic con el botón derecho del ratón en la llamada de bloque que desea actualizar.
3. Elija el comando "Actualizar" del menú contextual.
Se abre el cuadro de diálogo "Sincronización de la interfaz". En él se visualizan las
diferencias entre la interfaz utilizada y la interfaz modificada del bloque llamado.

8094

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL
4. De ser necesario modifique la conexión de los operandos. Para ello existen las
posibilidades siguientes:
– Es posible pasar un operando de la interfaz antigua a la nueva bien con la función
Drag&Drop bien con la función de cortar o copiar y pegar.
– Es posible borrar un operando.
– Es posible cambiar el nombre de un operando.
– Es posible indicar un operando nuevo mediante la función de autocompletar.
5. Haga clic en "Aceptar" para actualizar la llamada de bloque. Si desea cancelar la
actualización, haga clic en "Cancelar".
Nota
Tenga en cuenta que el comando "Actualizar llamada de bloque" no estará disponible si
previamente ha actualizado todas las llamadas de bloque en el editor con el comando
"Actualizar llamadas de bloque incoherentes".

Actualizar llamadas de bloque durante la compilación
Para actualizar implícitamente todas las llamadas de bloque y usos de tipos de datos PLC
durante la compilación, proceda del siguiente modo:
1. Abra el árbol del proyecto.
2. Seleccione la carpeta "Bloques de programa".
3. En el menú contextual, elija el comando "Compilar > Software (compilar todos los bloques)".

Consulte también
Insertar manualmente llamadas de bloque (Página 8090)
Insertar llamadas de bloque mediante Drag & Drop (Página 8092)
Cambiar el tipo de instancia (Página 8095)
Llamadas de bloque (Página 59)

15.4.9.4

Cambiar el tipo de instancia

Tipo de instancia
Los bloques de función se pueden llamar de maneras diferentes, a saber:
● Como instancia individual
● Como multiinstancia
● Como instancia de parámetro
Consulte también: Principios básicos de las instancias (Página 61)

Programación del PLC
Manual de programación y manejo, 11/2019

8095

Crear programas AWL
15.4 Añadir instrucciones AWL
El tipo de instancia definido se puede modificar en todo momento.

Requisitos
El programa de usuario contiene una llamada de bloque.

Procedimiento
Para cambiar el tipo de instancia de un bloque de función, proceda del siguiente modo:
1. Abra el bloque lógico y seleccione la llamada de bloque.
2. Elija el comando "Cambiar instancia" del menú contextual.
Se abre el cuadro de diálogo "Opciones de llamada".
3. Haga clic en el botón "Instancia individual", "Multiinstancia" o "Instancia de parámetro".
– Si selecciona el tipo de instancia "Instancia individual", introduzca un nombre para el
bloque de datos que debe asignarse al bloque de función.
– Si selecciona el tipo de instancia "Multiinstancia", introduzca en el campo de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si se selecciona el tipo de instancia "Instancia de parámetro", introduzca seguidamente
en el campo de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/
salida (InOut) al que debe transferirse la instancia en tiempo de ejecución.
4. Confirme las entradas con "Aceptar".
Nota
Las instancias anteriores no se borran automáticamente.

Consulte también
Insertar manualmente llamadas de bloque (Página 8090)
Insertar llamadas de bloque mediante Drag & Drop (Página 8092)
Actualizar las llamadas de bloque en AWL (Página 8093)
Instancias (Página 61)

8096

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.4 Añadir instrucciones AWL

15.4.10

Insertar comentarios

Comentar el código de programa
Tiene varias posibilidades para comentar los programas AWL:
● Comentario de línea
Los comentarios de línea comienzan con "//" y se extienden hasta el final de la línea.
● Sección de comentario dentro de una línea
Una sección de comentario se inicia con "(*" y se cierra con "*)". Puede haber una sección
de comentario en cualquier posición de la línea, pero no debe abarcar más de una línea.

Requisitos
Existe un segmento.

Insertar comentarios de línea
Para insertar un comentario de línea en una línea de instrucción, se deberá proceder de la
siguiente manera:
1. Inserte al final de la línea de instrucción "//".
2. Introduzca el comentario.

Insertar una sección de comentario en una línea
Para insertar una sección de comentario eb una línea de instrucción, proceda del siguiente
modo:
1. Introduzca "(*" en la línea de instrucción en el lugar que desee.
2. Introduzca el comentario detrás de "(*".
3. Introduzca "*)" detrás del comentario.

Desactivar una o varias líneas mediante comentarios
Para desactivar código del programa mediante comentarios, proceda del siguiente modo:
1. Seleccione las líneas de código que desea comentar.
2. Haga clic en el botón "Marcar la selección como comentario" del editor.
3. En las líneas marcadas se inserta "//" al principio de la línea. El código siguiente se
interpreta como comentario. Si se desactivan líneas que ya tienen un comentario de línea,
también se inserta "//". Si a continuación se vuelven a activar las líneas, se mantendrán los
comentarios iniciales.

Programación del PLC
Manual de programación y manejo, 11/2019

8097

Crear programas AWL
15.5 Procesar instrucciones AWL

Activar líneas de comentario
Para volver a activar líneas de comentario como código, proceda del siguiente modo:
1. Seleccione las líneas de código que desea activar.
2. Haga clic en el botón "Eliminar comentario" del editor.
3. Se elimina el identificador "//" de los comentarios de líneas al principio de la línea.

Resultado
Los comentarios se formatearán con un resalte.

Consulte también
Reglas sobre AWL (Página 8079)
Introducir manualmente las instrucciones AWL (Página 8082)
Insertar instrucciones AWL empleando la Task Card "Instrucciones" (Página 8083)
Insertar operandos (Página 8086)
Emplear favoritos en AWL (Página 8088)
Insertar llamadas de bloque en AWL (Página 8090)

15.5

Procesar instrucciones AWL

15.5.1

Seleccionar instrucciones AWL
Podrá seleccionar instrucciones individuales o todas las instrucciones del segmento.

Requisitos
Hay instrucciones AWL.

Seleccionar instrucciones AWL individuales
Para seleccionar instrucciones AWL individuales, se deberá proceder de la siguiente manera:
1. Ponga la marca de insertar delante del primer signo que desea marcar.
2. Pulse y mantenga pulsada la tecla izquierda del ratón.
3. Desplace el puntero del ratón detrás del último signo que desea marcar.
4. Suelte la tecla izquierda del ratón.

8098

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.5 Procesar instrucciones AWL

Seleccionar todas las instrucciones AWL del segmento
Para seleccionar todas las instrucciones del segmento, se deberá proceder de la siguiente
manera:
1. Haga clic en el segmento cuyas instrucciones desea seleccionar.
2. Elija la instrucción de "Seleccionar todo" en el menú "Editar" o emplee la combinación de
teclas <Strg+A>.

Consulte también
Copiar instrucciones AWL (Página 8099)
Cortar instrucciones AWL (Página 8100)
Insertar instrucciones AWL procedentes del portapapeles (Página 8100)
Borrar instrucciones AWL (Página 8101)

15.5.2

Copiar instrucciones AWL

Requisitos
Hay una instrucción AWL.

Procedimiento
Para copiar una instrucción AWL, se deberá proceder de la siguiente manera:
1. Marque la instrucción AWL que desee copiar.
2. Elija el comando "Copiar" del menú contextual.

Resultado
La instrucción AWL se copia y se guarda en el portapapeles.

Consulte también
Seleccionar instrucciones AWL (Página 8098)
Cortar instrucciones AWL (Página 8100)
Insertar instrucciones AWL procedentes del portapapeles (Página 8100)
Borrar instrucciones AWL (Página 8101)

Programación del PLC
Manual de programación y manejo, 11/2019

8099

Crear programas AWL
15.5 Procesar instrucciones AWL

15.5.3

Cortar instrucciones AWL

Requisitos
Hay una instrucción AWL.

Procedimiento
Para cortar una instrucción AWL, se deberá proceder de la siguiente manera:
1. Marque la instrucción AWL que desee cortar.
2. Elija el comando "Cortar" del menú contextual.

Resultado
La instrucción AWL se corta y se guarda en el portapapeles.

Consulte también
Seleccionar instrucciones AWL (Página 8098)
Copiar instrucciones AWL (Página 8099)
Insertar instrucciones AWL procedentes del portapapeles (Página 8100)
Borrar instrucciones AWL (Página 8101)

15.5.4

Insertar instrucciones AWL procedentes del portapapeles

Requisitos
Hay una instrucción AWL.

Procedimiento
Para insertar una instrucción AWL procedente del portapapeles, se deberá proceder de la
siguiente manera:
1. Copiar una instrucción AWL o cortar una instrucción AWL.
2. Haga clic en el lugar del segmento en el que desee insertar la instrucción AWL.
3. Elija el comando "Insertar" del menú contextual.

8100

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.5 Procesar instrucciones AWL

Consulte también
Seleccionar instrucciones AWL (Página 8098)
Copiar instrucciones AWL (Página 8099)
Cortar instrucciones AWL (Página 8100)
Borrar instrucciones AWL (Página 8101)

15.5.5

Borrar instrucciones AWL

Requisitos
Hay una instrucción AWL.

Procedimiento
Para borrar una instrucción AWL, se deberá proceder de la siguiente manera:
1. Marque la instrucción AWL que desee borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Seleccionar instrucciones AWL (Página 8098)
Copiar instrucciones AWL (Página 8099)
Cortar instrucciones AWL (Página 8100)
Insertar instrucciones AWL procedentes del portapapeles (Página 8100)

Programación del PLC
Manual de programación y manejo, 11/2019

8101

Crear programas AWL
15.6 Ejemplos de programación AWL

15.6

Ejemplos de programación AWL

15.6.1

Ejemplo de control de una cinta transportadora

Control de una cinta transportadora
La figura siguiente muestra una cinta transportadora que se pone en marcha eléctricamente.
Al comienzo de la cinta transportadora se encuentran dos pulsadores, S1 para MARCHA y S2
para PARO. Al final de la cinta transportadora se encuentran otros dos pulsadores, S3 para
MARCHA y S4 para PARO. La cinta transportadora puede ponerse en marcha o pararse desde
cualquiera de ambos extremos.
6
6

20DUFKD
23DUR

6 20DUFKD
6 23DUR

02725B21

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Operando

Declaración

Tipo de datos

Descripción

Marcha_izquierda (S1)

Input

BOOL

Pulsador de marcha en
el extremo izquierdo de
la cinta transportadora

Paro_izquierda (S2)

Input

BOOL

Pulsador de paro en el
extremo izquierdo de la
cinta transportadora

Marcha_derecha (S3)

Input

BOOL

Pulsador de marcha en
el extremo derecho de
la cinta transportadora

Paro_derecha (S4)

Input

BOOL

Pulsador de paro en el
extremo derecho de la
cinta transportadora

MOTOR_ON

Output

BOOL

Conectar el motor de la
cinta transportadora

El siguiente programa AWL muestra cómo realizar la tarea:
AWL
O #S1

8102

Explicación
// Consultar si el pulsador de marcha S1 es "1"

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.6 Ejemplos de programación AWL
AWL

Explicación

O #S3

// Consultar si el pulsador de marcha S3 es "1"

S #MOTOR_ON

// Si uno de los pulsadores de marcha (S1 o S3) devuelve el estado lógico "1", se pone en marcha el motor de la cinta transportadora.

O #S2

// Consultar si el pulsador de paro S2 es "1"

O #S4

// Consultar si el pulsador de paro S4 es "1"

R #MOTOR_ON

// Si uno de los pulsadores de paro (S2 o S4) devuelve el estado
lógico "1", se para el motor de la cinta transportadora.

Consulte también
Bases de AWL (Página 8065)
Configuración de AWL (Página 8070)
Trabajar con segmentos (Página 8071)
Añadir instrucciones AWL (Página 8079)
Procesar instrucciones AWL (Página 8098)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 8104)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 8106)
Ejemplo de cálculo de una ecuación (Página 8108)
Ejemplo de calentamiento de una caldera (Página 8110)
Ejemplo de una cadena secuencial (Página 8112)

Programación del PLC
Manual de programación y manejo, 11/2019

8103

Crear programas AWL
15.6 Ejemplos de programación AWL

15.6.2

Ejemplo de detección del sentido de marcha de una cinta transportadora

Detección del sentido de marcha de una cinta transportadora
El sentido de marcha detectado de la cinta transportadora se indica con una flecha DERECHA
o una flecha IZQUIERDA. Si se está transportando otro objeto desde la derecha a BF1 o desde
la izquierda a BF2, primero se desconectará la flecha indicada hasta que, tras pasar por las dos
barreras fotoeléctricas, se detecte nuevamente el sentido de marcha y pueda indicarse la
flecha correspondiente. Para solucionar la tarea se requieren además dos marcas de flanco
que detecten el cambio de señal en las dos barreras fotoeléctricas de "0" a "1".
%)

%)

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Descripción

S1

Input

BOOL

Barrera fotoeléctrica 1

S2

Input

BOOL

Barrera fotoeléctrica 2

TM1

Input

BOOL

Marca de flancos 1

TM2

Input

BOOL

Marca de flancos 2

DERECHA

Output

BOOL

Indicador de desplaza‐
miento a la derecha

IZQUIERDA

Output

BOOL

Indicador de desplaza‐
miento a la izquierda

El siguiente programa AWL muestra cómo realizar el ejemplo:
AWL

Explicación

A #S1

// Consultar si la barrera fotoeléctrica "S1" es "1"

FP #TM1

// Consultar si hay flanco ascendente

AN #S2

// Consultar si la barrera fotoeléctrica "S2" es "0"

S #IZQUIERDA

// Si el estado lógico de la barrera fotoeléctrica "S1" cambia
de "0" a "1" (flanco ascendente) y al mismo tiempo el estado
lógico de la barrera fotoeléctrica "S2" es "0", el objeto se
desplaza hacia la izquierda sobre la cinta transportadora.
// Se enciende el indicador de desplazamiento a la izquierda

A #S2

8104

// Consultar si la barrera fotoeléctrica "S2" es "1"

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.6 Ejemplos de programación AWL
AWL

Explicación

FP #TM2

// Consultar si hay flanco ascendente

AN #S1

// Consultar si la barrera fotoeléctrica "S1" es "0"

S #DERECHA

// Si el estado lógico de la barrera fotoeléctrica "S2" cambia
de "0" a "1" (flanco ascendente) y al mismo tiempo el estado
lógico de "S1" es "0", el objeto se desplaza hacia la derecha
sobre la cinta transportadora.
// Se enciende el indicador de desplazamiento a la derecha

AN #S1

// Consultar si la barrera fotoeléctrica "S1" es "0"

AN #S2

// Consultar si la barrera fotoeléctrica "S2" es "0"

R #IZQUIERDA

// El indicador de desplazamiento hacia la izquierda se apaga
cuando el estado lógico de ambas barreras fotoeléctricas es "0".

R #DERECHA

// El indicador de desplazamiento hacia la derecha se apaga
cuando el estado lógico de ambas barreras fotoeléctricas es "0".

Consulte también
Bases de AWL (Página 8065)
Configuración de AWL (Página 8070)
Trabajar con segmentos (Página 8071)
Añadir instrucciones AWL (Página 8079)
Procesar instrucciones AWL (Página 8098)
Ejemplo de control de una cinta transportadora (Página 8102)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 8106)
Ejemplo de cálculo de una ecuación (Página 8108)
Ejemplo de calentamiento de una caldera (Página 8110)
Ejemplo de una cadena secuencial (Página 8112)

Programación del PLC
Manual de programación y manejo, 11/2019

8105

Crear programas AWL
15.6 Ejemplos de programación AWL

15.6.3

Ejemplo de detección del nivel de llenado de una zona de almacén

Detección del nivel de llenado de una zona de almacén
La figura siguiente muestra un sistema con dos cintas transportadoras y una zona de almacén
temporal situada entre ambas. La cinta transportadora 1 transporta paquetes a la zona de
almacén. Una barrera fotoeléctrica situada al final de la cinta transportadora 1 junto a la zona
de almacén determina cuántos paquetes se transportan a dicha zona. La cinta transportadora
2 transporta paquetes desde la zona de almacén temporal a una plataforma de carga, desde
la que los paquetes se cargan en camiones. Una barrera fotoeléctrica situada al final de la zona
de almacén determina cuántos paquetes deben transportarse desde allí hasta la plataforma de
carga. Cinco indicadores luminosos indican el nivel de llenado de la zona de almacén temporal.
&RQVRODGHLQGLFDGRUHV

=RQDGHDOPDF«Q =RQDGHDOPDF«Q
YDF¯D
QRYDF¯D

3DTXHWHV
HQWUDQWHV

=RQDGHDOPDF«Q
OOHQDDO

=RQDGHDOPDF«Q
OOHQDDO

=RQDGHDOPDF«Q
OOHQD

3DTXHWHV
VDOLHQWHV

=RQDGHDOPDF«Q
WHPSRUDO
SDUD
SDTXHWHV

&LQWDWUDQVSRUWDGRUD

&LQWDWUDQVSRUWDGRUD

%DUUHUDIRWRHO«FWULFD

%DUUHUDIRWRHO«FWULFD

Realización
La tabla siguiente muestra la definición de las variables utilizadas:

8106

Nombre

Tipo de datos

Dirección

Descripción

PACKAGECOUNT

COUNTER

C1

Número de paquetes
en la zona de almacén
(valor de contaje actual)

Nombre

Sección

Tipo de datos

Descripción

LS1

Input

BOOL

Barrera fotoeléctrica 1

LS2

Input

BOOL

Barrera fotoeléctrica 2

ALM_VACIO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén vacía

ALM_NO_VACIO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén no vacía

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.6 Ejemplos de programación AWL
Nombre

Sección

Tipo de datos

Descripción

ALM_LLENO_50%

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena al
50%

ALM_LLENO_90%

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena al
90%

ALM_LLENO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena

El siguiente programa AWL muestra cómo realizar el ejemplo:
AWL

Explicación

A #LS1

// Consultar si la barrera fotoeléctrica "LS1" es "1".

CU "PACKAGECOUNT"

// Cuando se produce un flanco de señal ascendente en la barrera
fotoeléctrica "LS1", se incrementa en uno el valor de contaje
del contador "PACKAGECOUNT".

A #LS2

// Consultar si la barrera fotoeléctrica "LS2" es "1".

CD "PACKAGECOUNT"

// Cuando se produce un flanco de señal ascendente en la barrera
fotoeléctrica "LS2", se reduce en uno el valor de contaje del
contador "PACKAGECOUNT".

AN "PACKAGECOUNT"

// Consultar si el valor de contaje es "0".

= #ALM_VACIO

// Cuando el valor de contaje es "0", se enciende el indicador
luminoso "Zona de almacén vacía"

A "PACKAGECOUNT"

// Consultar si el valor de contaje es "1".

= #ALM_NO_VACIO

// Cuando el valor de contaje es "0", se enciende el indicador
luminoso "Zona de almacén vacía".

L 50

// Cargar el valor de comparación "50" en el acumulador 1.

L "PACKAGECOUNT"

// Desplazar el valor de comparación al acumulador 2.
// Cargar el valor de contaje actual en el acumulador 1.

<=I

// Comparar valores

= #"ALM_LLENO_50%"

// Si el valor de contaje es mayor o igual a "50" se enciende el
indicador luminoso "Zona de almacén llena al 50%"

L 90

// Desplazar el valor de contaje al acumulador 2.
// Cargar el valor de comparación "90" en el acumulador 1.

>=I

// Comparar valores

= #"ALM_LLENO_90%"

// Si el valor de contaje es mayor o igual a "90" se enciende el
indicador luminoso "Zona de almacén llena al 90%".

L "PACKAGECOUNT"

// Cargar el valor de contaje actual en el acumulador 1.

L 100

// Desplazar el valor de contaje al acumulador 2.
// Cargar el valor de comparación "100" en el acumulador 1.

>=I

// Comparar valores

= #ALM_LLENO

// Si el valor de contaje es mayor o igual a "100" se enciende
el indicador luminoso "Zona de almacén llena".

Consulte también
Bases de AWL (Página 8065)
Configuración de AWL (Página 8070)
Programación del PLC
Manual de programación y manejo, 11/2019

8107

Crear programas AWL
15.6 Ejemplos de programación AWL
Trabajar con segmentos (Página 8071)
Añadir instrucciones AWL (Página 8079)
Procesar instrucciones AWL (Página 8098)
Ejemplo de control de una cinta transportadora (Página 8102)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 8104)
Ejemplo de cálculo de una ecuación (Página 8108)
Ejemplo de calentamiento de una caldera (Página 8110)
Ejemplo de una cadena secuencial (Página 8112)

15.6.4

Ejemplo de cálculo de una ecuación

Cálculo de una ecuación
El ejemplo de programación siguiente muestra cómo obtener con tres operaciones aritméticas
el mismo resultado que la siguiente ecuación:
RESULT = ((A + B) x C) /D

Realización
La tabla siguiente muestra la declaración de los operandos utilizados en la tabla de variables
PLC:
Nombre

Tipo de datos

Comentario

A

INT

Primer sumando

B

INT

Segundo sumando

C

INT

Multiplicador

D

INT

Divisor

RESULT

INT

Resultado final

El siguiente programa AWL muestra cómo realizar el ejemplo:
AWL

Explicación

L "A"

// Cargar el valor del operando "A" en el acumulador 1

L "B"

// Desplazar el valor del operando "A" al acumulador 2
// Cargar el valor del operando "B" en el acumulador 1

+I

// Sumar los valores de los acumuladores 1 y 2
// Guardar suma en el acumulador 1

L "C"

// Desplazar la suma al acumulador 2
// Cargar el valor del operando "C" en el acumulador 1

*I

// Multiplicar los valores de los acumuladores 1 y 2
// Guardar el producto en el acumulador 1

8108

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.6 Ejemplos de programación AWL
AWL
L "D"

Explicación
// Desplazar el producto al acumulador 2
// Cargar el valor del operando "D" en el acumulador 1

/I

// Dividir el valor del acumulador 2 por el valor del acumulador
1
// Guardar el resultado en el acumulador 1

T "RESULT"

// Transferir el resultado al operando "RESULT"

Consulte también
Bases de AWL (Página 8065)
Configuración de AWL (Página 8070)
Trabajar con segmentos (Página 8071)
Añadir instrucciones AWL (Página 8079)
Procesar instrucciones AWL (Página 8098)
Ejemplo de control de una cinta transportadora (Página 8102)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 8104)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 8106)
Ejemplo de calentamiento de una caldera (Página 8110)
Ejemplo de una cadena secuencial (Página 8112)

Programación del PLC
Manual de programación y manejo, 11/2019

8109

Crear programas AWL
15.6 Ejemplos de programación AWL

15.6.5

Ejemplo de calentamiento de una caldera

Calentamiento de una caldera
La imagen siguiente muestra una caldera que se calienta con un interruptor de arranque. Al
pulsar el interruptor de marcha, se inicia el proceso de calentamiento. El tiempo de
calentamiento se establece mediante selectores digitales. El tiempo se indica en segundos en
formato BCD.
6HOHFWRUGLJLWDOSDUDDMXVWDUHOWLHPSRGHFDOHQWDPLHQWR

&DOGHUD







;;;;



,%












,%

%LW
,:
%\WH

,QWHUUDUUDQTXH,

Realización
La tabla siguiente muestra la declaración de los operandos utilizados en la tabla de variables
PLC:
Nombre

Tipo de datos

Dirección

Comentario

DURATION

WORD

EW0

Tiempo de calentamien‐
to en segundos
● I1.0 a I1.3: Selector
de unidades
● I1.4 a I1.7: Selector
de decenas
● I0.0 a I0.3: Selector
de centenas

HEATING

8110

TIMER

T1

Temporizador que
arranca con el tiempo
de calentamiento prese‐
leccionado.

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.6 Ejemplos de programación AWL
La tabla siguiente muestra la declaración de los operandos utilizados en la interfaz del bloque
lógico:
Nombre

Sección

Tipo de datos

Comentario

START

Input

BOOL

Interruptor de arranque

START_HEATING

Output

BOOL

Inicio del proceso de ca‐
lentamiento

El siguiente programa AWL muestra cómo realizar el ejemplo:
AWL

Explicación

A "HEATING"

// Consultar si el temporizador ha arrancado

= #START_HEATING

// Iniciar proceso de calentamiento

BEC

// Si RLO=1 finalizar la ejecución del bloque
// De este modo se impide que rearranque el temporizador "HEATING" cuando se pulse el pulsador de arranque

L "DURATION"

// Cargar el tiempo de calentamiento en el acumulador 1

AW W#16#0FFF

// Poner los bits de entrada I0.4 a I0.7 a "0"

OW W#16#4000

// Ajustar segundos en los bits I1.2 e I1.3 del acumulador 1

A #START

// Consultar si el pulsador de arranque es "1"

SE "HEATING"

// Cuando se produzca un flanco de señal ascendente en el interruptor de arranque, iniciar el proceso de calentamiento como
impulso prolongado

Consulte también
Bases de AWL (Página 8065)
Configuración de AWL (Página 8070)
Trabajar con segmentos (Página 8071)
Añadir instrucciones AWL (Página 8079)
Procesar instrucciones AWL (Página 8098)
Ejemplo de control de una cinta transportadora (Página 8102)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 8104)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 8106)
Ejemplo de cálculo de una ecuación (Página 8108)
Ejemplo de una cadena secuencial (Página 8112)

Programación del PLC
Manual de programación y manejo, 11/2019

8111

Crear programas AWL
15.6 Ejemplos de programación AWL

15.6.6

Ejemplo de una cadena secuencial

Programación de una cadena secuencial
La imagen siguiente muestra una estación para despaletizar envases de vidrio. Los palets se
transportan sobre una cinta transportadora a la estación. Cuando un palet llega con envases
de vidrio a la estación, la cinta transportadora se detiene y un brazo robótico se desplaza desde
su posición inicial (P0) hasta alcanzar la posición sobre el palet (P2). Si el brazo robótico se
encuentra sobre el palet, se abren las garras y el brazo desciende. La posición actual del brazo
y el estado de las garras son registrados por sensores. El desarrollo descrito del movimiento
del brazo robótico se realiza en este ejemplo mediante una cadena secuencial. También
pueden programarse los pasos sucesivos para retirar los envases y transportarlos a otra cinta
transportadora.
3

3
3

3

Realización
La tabla siguiente muestra la declaración de los operandos utilizados en la tabla de variables
PLC:
Nombre

Tipo de datos

Comentario

NUMBER

INT

Número de etapa

Tag_Error

BOOL

Operando que se activa si el nú‐
mero de la etapa es mayor que 3
o si una etapa no ha sido ejecu‐
tada.

La tabla siguiente muestra la declaración de los operandos utilizados en la interfaz del bloque
lógico:

8112

Nombre

Sección

Tipo de datos

Comentario

POS_0

Input

BOOL

Brazo en posición ini‐
cial (P0)

POS_1

Input

BOOL

Brazo en posición 1 (P1)

POS_2

Input

BOOL

Brazo en posición 2 (P2)

GRIPPER_OPEN

Input

BOOL

Garras abiertas

OUT_POS_1

Output

BOOL

Desplazar el brazo a la
posición 1

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas AWL
15.6 Ejemplos de programación AWL
Nombre

Sección

Tipo de datos

Comentario

OUT_POS_2

Output

BOOL

Desplazar el brazo a la
posición 2

OUT_GRIPPER

Output

BOOL

Abrir las garras

OUT_POS_3

Output

BOOL

Desplazar el brazo a la
posición 3

El siguiente programa AWL muestra cómo realizar el ejemplo:
AWL

Explicación

L "NUMBER"

// Cargar el número de etapa en el acumulador 1.

JL END

// Principio de la lista de saltos

JU POSITION_0

// Si el acumulador 1 contiene el valor "0", saltar a
la etiqueta "POSITION_0".

JU POSITION_1

// Si el acumulador 1 contiene el valor "1", saltar a
la etiqueta "POSITION_1".

JU POSITION_2

// Si el acumulador 1 contiene el valor "2", saltar a
la etiqueta "POSITION_2".

JU POSITION_3

// Si el acumulador 1 contiene el valor "3", saltar a
la etiqueta "POSITION_3".

END: JU ERROR

// Fin de la lista de saltos
// Si el número de etapa es mayor que 3, saltar a la
etiqueta "ERROR".

POSITION_0: A #POS_0

// Etiqueta "POSITION_0"
// Consultar si el brazo se encuentra en la posición
inicial (P0).

= #OUT_POS_1

// Si se cumple la condición, activar la salida
"OUT_POS_1" y desplazar el brazo a la posición 1 (P1).

JCN ERROR

// Si el RLO es "0", saltar a la etiqueta "ERROR".

JC NEXT

// Si el RLO es "1", saltar a la etiqueta "NEXT".

POSITION_1: A #POS_1

// Etiqueta "POSITION_1"
// Consultar si el brazo se encuentra en la posición 1
(P1).

= #OUT_POS_2

// Si se cumple la condición, activar la salida
"OUT_POS_2" y desplazar el brazo a la posición 2 (P2).

JCN ERROR

// Si el RLO es "0", saltar a la etiqueta "ERROR".

JC NEXT

// Si el RLO es "1", saltar a la etiqueta "NEXT".

POSITION_2: A #POS_2

// Etiqueta "POSITION_2"
// Consultar si el brazo se encuentra en la posición 2
(P2).

= #OUT_GRIPPER

// Si se cumple la condición, activar la salida
"OUT_GRIPPER" y abrir las garras.

JCN ERROR

// Si el RLO es "0", saltar a la etiqueta "ERROR".

JC NEXT

// Si el RLO es "1", saltar a la etiqueta "NEXT".

POSITION_3: A #POS_2

// Etiqueta "POSITION_3"
// Consultar si el brazo se encuentra en la posición 2
(P2).

A #GRIPPER_OPEN

Programación del PLC
Manual de programación y manejo, 11/2019

// Consultar si las garras están abiertas

8113

Crear programas AWL
15.6 Ejemplos de programación AWL
AWL

Explicación

= #OUT_POS_3

// Si se cumple la condición, activar la salida
"OUT_POS_3" y desplazar el brazo a la posición 3 (P3).

JCN ERROR

// Si el RLO es "0", saltar a la etiqueta "ERROR".

JC NEXT

// Si el RLO es "1", saltar a la etiqueta "NEXT".

NEXT: INC 1

// Etiqueta "NEXT"
// Incrementar el número de etapa en el acumulador 1.

T "NUMBER"

// Transferir el número de etapa al operando "NUMBER".

L 3

// Desplazar el número de etapa al acumulador 2.
// Cargar el valor 3 en el acumulador 1.

>I

// Consultar si el número de la etapa actual es mayor
que 3.

JC RESET_NUMBER

// Si el resultado de la consulta es "1", saltar a la
etiqueta "RESET_NUMBER" y continuar allí el procesamiento del programa.

BEU

// Finalizar bloque

RESET_NUMBER: L 0

// Etiqueta "RESET_NUMBER"
// Cargar el valor "0" en el acumulador 1.

T "NUMBER"

// Asignar el valor "0" al operando "NUMBER" (número
de etapa).

BEU

// Finalizar bloque

ERROR: NOT

// Etiqueta "ERROR"

= "Tag_Error"

// Asignar el RLO negado al operando "Tag_Error".

BEU

// Finalizar bloque

Consulte también
Bases de AWL (Página 8065)
Configuración de AWL (Página 8070)
Trabajar con segmentos (Página 8071)
Añadir instrucciones AWL (Página 8079)
Procesar instrucciones AWL (Página 8098)
Ejemplo de control de una cinta transportadora (Página 8102)
Ejemplo de detección del sentido de marcha de una cinta transportadora (Página 8104)
Ejemplo de detección del nivel de llenado de una zona de almacén (Página 8106)
Ejemplo de cálculo de una ecuación (Página 8108)
Ejemplo de calentamiento de una caldera (Página 8110)

8114

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1

Principios básicos de SCL

16.1.1

Lenguaje de programación SCL

16

Lenguaje de programación SCL
SCL (Structured Control Language) es un lenguaje de programación de alto nivel que se
orienta a PASCAL. Este lenguaje se basa en la norma DIN EN-61131-3 (internacional: IEC
1131-3).
Esta norma estandariza los lenguajes de programación para autómatas programables. El
lenguaje de programación SCL cumple el PLCopen Basis Level del lenguaje ST (texto
estructurado) definido en esta norma.

Elementos del lenguaje
Además de incluir elementos típicos del PLC, como entradas, salidas, temporizadores o
marcas, SCL incluye elementos de lenguajes de programación de alto nivel:
● Expresiones
● Asignaciones de valor
● Operadores

Control del programa
SCL ofrece instrucciones prácticas para el control del programa que permiten realizar, por
ejemplo, ramas, bucles o saltos del programa.

Campo de aplicación
Por estos motivos, SCL es especialmente adecuado para los siguientes campos de aplicación:
● Gestión de datos
● Optimización de procesos
● Gestión de recetas
● Tareas matemáticas/estadísticas

Programación del PLC
Manual de programación y manejo, 11/2019

8115

Creación de programas SCL
16.1 Principios básicos de SCL

16.1.2

Expresiones

Descripción
Las expresiones se calculan durante la ejecución del programa y devuelven un valor. Una
expresión se compone de operandos (p. ej., de constantes, variables o llamadas de función)
y, opcionalmente, de operadores (p. ej., *, /, + ó -). Las expresiones se pueden combinar entre
sí mediante operadores o estar anidadas las unas en las otras.

Orden de evaluación
La evaluación de la expresión se lleva a cabo en un orden determinado por los siguientes
factores:
● Prioridad de los operadores implicados
● Orden izquierda-derecha
● Paréntesis
No utilice en una expresión llamadas de funciones que influyan en las variables globales o
estáticas.

Tipos de expresiones
En función del operador, se pueden distinguir los siguientes tipos de expresiones:
● Expresiones aritméticas
Las expresiones aritméticas están compuestas por un valor numérico o bien combinan dos
valores o expresiones con operadores aritméticos.
● Expresiones de comparación
Las expresiones de comparación comparan los valores de dos operandos y devuelven un
valor booleano. El resultado es TRUE si se cumple la comparación y FALSE si no se
cumple.
● Expresiones lógicas
Las expresiones lógicas combinan dos operandos mediante operadores lógicos (AND, OR,
XOR) o niegan operandos (NOT).

Uso de expresiones
El resultado de una expresión se puede usar de diferente manera:
● como asignación de valor a una variable
● como condición de una instrucción de control
● como parámetro para llamar un bloque o una instrucción

Consulte también
Operadores y su jerarquía (Página 8126)
Expresiones aritméticas (Página 8117)

8116

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL
Expresiones de comparación (Página 8120)
Expresiones lógicas (Página 8125)

16.1.3

Expresiones aritméticas

Descripción
Las expresiones aritméticas están compuestas por un valor numérico o bien combinan dos
valores o expresiones con operadores aritméticos.
Los operadores aritméticos pueden procesar los tipos de datos compatibles con la CPU
utilizada. Si dos operandos intervienen en la operación, el tipo de datos del resultado se
determina según los criterios siguientes:
● Si ambos operandos son enteros con signo y tienen longitudes diferentes, el resultado
obtiene el tipo de datos del entero más largo (p. ej. INT + DINT = DINT).
● Si ambos operandos son enteros sin signo y tienen longitudes diferentes, el resultado
obtiene el tipo de datos del entero más largo (p. ej. USINT + UDINT = UDINT).
● Si un operando es un entero con signo y el otro operando es un entero sin signo, el resultado
obtiene el siguiente tipo de datos superior con signo que cubre el entero sin signo (p. ej.
SINT + USINT = INT).
Una operación en que intervengan este tipo de operandos solo se puede ejecutar si no está
ajustada la verificación CEI.
● Si un operando es un entero y el otro operando es un número en coma flotante, el resultado
obtiene el tipo de datos del número en coma flotante (p. ej. INT + REAL = REAL).
● Si ambos operandos son números en coma flotante y tienen longitudes diferentes, el
resultado obtiene el tipo de datos del número en coma flotante más largo (p. ej. REAL +
LREAL = LREAL).
● El tipo de datos del resultado de una operación en que intervienen operandos del tipo de
datos de los grupos "Temporizadores" y "Fecha y hora" figura en la tabla que aparece en
el apartado "Tipos de datos de las expresiones aritméticas".
Si la verificación CEI está activada, no es posible utilizar los tipos de datos de los grupos
"Temporizadores" y "Fecha y hora".

Tipos de datos de las expresiones aritméticas
En la siguiente tabla se muestran los tipos de datos que se pueden utilizar en expresiones
aritméticas:
Operación

Operador

1.er operando

Potencia

**

Entero/número en co‐ Entero/número en coma
ma flotante
flotante

Número en coma flo‐
tante

Más unario

+

Entero/número en co‐ ma flotante

Entero/número en co‐
ma flotante

TIME, LTIME

TIME, LTIME

Programación del PLC
Manual de programación y manejo, 11/2019

2.º operando

Resultado

8117

Creación de programas SCL
16.1 Principios básicos de SCL
Operación

Operador

1.er operando

2.º operando

Resultado

Menos unario -

Entero/número en co‐ ma flotante

Entero/número en co‐
ma flotante

TIME, LTIME

TIME, LTIME

Multiplicación *

Entero/número en co‐ Entero/número en coma
ma flotante
flotante

Entero/número en co‐
ma flotante

TIME, LTIME

TIME, LTIME

Entero

División

/

Entero/número en co‐ Entero/número en coma
ma flotante
flotante (distinto de 0)

Entero/número en co‐
ma flotante

TIME, LTIME

Entero

TIME, LTIME

Función mó‐
dulo

MOD

Entero

Entero

Entero

Suma

+

Entero/número en co‐ Entero/número en coma
ma flotante
flotante

Entero/número en co‐
ma flotante

TIME

TIME

TIME

TIME

DINT

TIME

LTIME

TIME, LTIME

LTIME

LTIME

LINT

LTIME

TOD

TIME

TOD

TOD

DINT

TOD

LTOD

TIME, LTIME

LTOD

LTOD

LINT

LTOD

DATE

LTOD

DTL

DATE

TOD

● S7-300/400: DT
● S7-1200/1500:
DTL

8118

DT

TIME

DT

LDT

TIME, LTIME

LDT

DTL

TIME, LTIME

DTL

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL
Operación

Operador

1.er operando

Resta

-

Entero/número en co‐ Entero/número en coma
ma flotante
flotante

2.º operando

Resultado
Entero/número en co‐
ma flotante

TIME

TIME

TIME

TIME

DINT

TIME

LTIME 1)

TIME, LTIME

LTIME

LTIME

LINT

LTIME

TOD

TIME

TOD

TOD

DINT

TOD

TOD

TOD

TIME

LTOD

TIME, LTIME

LTOD

LTOD

LINT

LTOD

LTOD

LTOD

LTIME

DATE

DATE

● S7-300/400/1200:
TIME
● S7-1500: LTIME

DT

TIME

DT

DT

DT

TIME

LDT

TIME, LTIME

LDT

DTL

TIME, LTIME

DTL

DTL

DTL

● S7-1200: TIME
● S7-1500: LTIME

1)

Dentro de las expresiones no es posible combinar nanosegundos y milisegundos.

Encontrará más información sobre los tipos de datos válidos en "Consulte también".

Ejemplo
El siguiente ejemplo muestra una expresión aritmética:
SCL
"MyTag1":= "MyTag2" * "MyTag3";

Consulte también
Expresiones (Página 8116)
Operadores y su jerarquía (Página 8126)

Programación del PLC
Manual de programación y manejo, 11/2019

8119

Creación de programas SCL
16.1 Principios básicos de SCL

16.1.4

Expresiones de comparación

Descripción
Las expresiones de comparación comparan los valores o tipos de datos de dos operandos y
devuelven un valor booleano. El resultado es TRUE si se cumple la comparación y FALSE si
no se cumple.
Los operadores de comparación pueden procesar los tipos de datos compatibles con la CPU
utilizada. El tipo de datos del resultado es siempre BOOL.
Para formar expresiones de comparación se deben respetar las reglas siguientes:
● Todas las variables son comparables en los grupos siguientes de tipos de datos:
– Enteros/números en coma flotante
– Números binarios
– Cadenas de caracteres
● En los siguientes tipos de datos/grupos de tipos de datos solo son comparables las
variables del mismo tipo:
– TIME, LTIME
– Fecha y hora
– Tipos de datos PLC
– ARRAY
– STRUCT
– Variable a la que apunta ANY.
– Variable a la que apunta VARIANT.
● La comparación de STRINGS se realiza según la codificación de caracteres en el juego de
caracteres ajustado en Windows. La comparación de WSTRINGS se realiza según la
codificación de caracteres en UTF-16. Para la comparación se utilizan la longitud de la
variable y el valor numérico de cada carácter.
● No se permite usar las variables S5 TIME como operandos de comparaciones. Resulta
necesario efectuar una conversión explícita de S5TIME a TIME o LTIME.

Comparación de números en coma flotante
Si se comparan números en coma flotante, los operandos que comparar deben ser del mismo
tipo de datos, independientemente del ajuste de la verificación CEI.
Los patrones de bits especiales de números en coma flotante no válidos (NaN) que se generan
en caso de resultados indefinidos (p. ej. raíz de -1) no pueden compararse. Es decir, si uno de
los dos operandos tiene el valor NaN, tanto la expresión de comparación "==: Igual" como "<>:
Diferente" dan como resultado FALSE.

8120

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL

Comparación de cadenas de caracteres
En una comparación de cadenas de caracteres, los distintos caracteres se comparan según su
codificación (p. ej. 'a' es mayor que 'A'). La comparación se realiza de izquierda a derecha. El
primer carácter diferente es el decisivo para el resultado de la comparación.
La tabla siguiente muestra ejemplos de comparación "==" de cadenas de caracteres:
<Operando1>

<Operando2>

RLO de la instrucción

'AA'

'AA'

1

'Hello World'

'HelloWorld'

0

'AA'

'aa'

0

'aa'

'aaa'

0

La tabla siguiente muestra ejemplos de comparación "<>" de cadenas de caracteres:
<Operando1>

<Operando2>

RLO de la instrucción

'AA'

'aa'

1

'Hello World'

'HelloWorld'

1

'AA'

'AA'

0

'aa'

'aaa'

1

También es posible comparar caracteres individuales de una cadena de caracteres. El número
del carácter que se va a comparar se indica entre corchetes al lado del nombre del operando.
Si se indica "MyString[2]", se compara p. ej. el segundo carácter de la cadena de caracteres
"MyString".

Comparación de temporizadores, fecha y hora
Los patrones de bits de temporizadores, fechas y horas no válidos, p. ej.
DT#2015-13-33-25:62:99.999_999_999, no pueden compararse. Es decir, si uno de los dos
operandos tiene un valor no válido, tanto la instrucción "==: Igual" como "<>: Diferente" dan
como resultado FALSE.
No es posible comparar directamente todos los temporizadores entre sí, como p. ej. S5TIME.
En este caso se convierten implícitamente a otro temporizador para poder compararlos, p. ej.
a TIME.
Para comparar fechas y horas de diferentes tipos de datos entre sí, el valor del tipo de datos
de fecha u hora más pequeño se convierte implícitamente al mayor. De ese modo se
comparan, por ejemplo, ambos tipos de datos de fecha y hora DATE y DTL a partir de DTL.
Si se produce un error en las conversiones implícitas, la comparación dará el resultado FALSE.

Comparación de variables del tipo de datos WORD con variables del tipo de datos S5TIME
Cuando se compara una variable del tipo de datos WORD con una variable del tipo de datos
S5TIME, ambas variables se convierten al tipo de datos TIME. La variable WORD se interpreta
como un valor S5TIME. En caso de que no fuera posible convertir una de las dos variables, la
comparación no se realizará y el resultado será FALSE. Si la conversión es correcta, la
comparación se realizará en función de la instrucción de comparación seleccionada.

Programación del PLC
Manual de programación y manejo, 11/2019

8121

Creación de programas SCL
16.1 Principios básicos de SCL

Comparación de estructuras
Nota
Disponibilidad de la comparación de estructuras
La posibilidad de comparar estructuras está disponible con CPU de la serie S7-1200 a partir de
la versión de firmware >= 4.2 y con CPU de la serie S7-1500 a partir de la versión de firmware
>= 2.0.
Es posible comparar entre sí los valores de dos operandos estructurados cuando las dos
variables tienen el mismo tipo de datos de estructura. Si se comparan estructuras, los
operandos que comparar deben ser del mismo tipo de datos, independientemente del ajuste
de la verificación CEI. Esto no es aplicable a comparaciones en las que uno de los dos
operandos es un VARIANT o un ANY. Si el tipo de datos no se conoce aún en el momento de
crear el programa, puede emplearse VARIANT. En este caso, será posible también comparar
el operando con una variable estructurada de cualquier tipo de datos. También pueden
compararse entre sí dos variables del tipo de datos VARIANT o ANY.
Para comparar estructuras, seleccione el tipo de datos VARIANT en la lista desplegable del
cuadro de la instrucción. Son posibles variables de los siguientes tipos de datos:
● Tipo de datos PLC (UDT)
● STRUCT (la estructura del tipo de datos STRUCT debe estar contenida en un tipo de datos
PLC o las dos estructuras que van a compararse son dos elementos de un ARRAY of
STRUCT. No se permiten bloque de datos de instancia ni variables de estructuras
anónimas.)
● Variable a la que apunta ANY.
● Variable a la que apunta VARIANT.
Para poder comparar entre sí dos variables del tipo de datos ARRAY deben cumplirse los
siguientes requisitos:
● Los elementos deben tener el mismo tipo de datos en cada caso.
● Los dos ARRAY deben tener la misma dimensión.
● Todas las dimensiones deben tener el mismo número de elementos. Los límites concretos
de ARRAY no tienen que coincidir necesariamente.
Nota
ARRAY of BOOL
Si se comparan entre sí dos operandos del tipo de datos ARRAY of BOOL y el número de
elementos no es divisible entre 8, se comparan también los bits de relleno. Esto puede influir
en el resultado de la comparación.

8122

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL
La tabla siguiente muestra un ejemplo de comparación de estructuras con "==: Igual":
<Operando1>
Variable del tipo de da‐
tos A <Tipo de datos
PLC>

<Operando2>
Valor de la va‐
riable

Variable del tipo de
datos A <Tipo de da‐
tos PLC>

RLO de la ins‐
trucción
Valor de la varia‐
ble

BOOL

FALSE

BOOL

FALSE

INT

2

INT

2

<Operando1>
Variable del tipo de da‐
tos A <Tipo de datos
PLC>

<Operando2>
Valor de la va‐
riable

Variable del tipo de
datos B <Tipo de da‐
tos PLC>

RLO de la ins‐
trucción
Valor de la varia‐
ble

BOOL

FALSE

BOOL

TRUE

INT

2

INT

3

<Operando1>
Variable del tipo de da‐
tos A <Tipo de datos
PLC>

Valor de la va‐
riable

1

0

<Operando2>

RLO de la ins‐
trucción

VARIANT (recibe da‐ Valor de la varia‐
tos de la variable del ble
tipo de datos A)

1

BOOL

FALSE

BOOL

FALSE

INT

2

INT

2

La tabla siguiente muestra un ejemplo de comparación de estructuras con "<>: Diferente":
<Operando1>
Variable del tipo de da‐
tos A <Tipo de datos
PLC>

<Operando2>
Valor de la va‐
riable

Variable del tipo de
datos A <Tipo de da‐
tos PLC>

RLO de la ins‐
trucción
Valor de la varia‐
ble

BOOL

FALSE

BOOL

FALSE

INT

2

INT

2

<Operando1>
Variable del tipo de da‐
tos A <Tipo de datos
PLC>

<Operando2>
Valor de la va‐
riable

Variable del tipo de
datos B <Tipo de da‐
tos PLC>

RLO de la ins‐
trucción
Valor de la varia‐
ble

BOOL

FALSE

BOOL

TRUE

INT

2

INT

3

Programación del PLC
Manual de programación y manejo, 11/2019

0

1

8123

Creación de programas SCL
16.1 Principios básicos de SCL

<Operando1>
Variable del tipo de da‐
tos A <Tipo de datos
PLC>

Valor de la va‐
riable

<Operando2>

RLO de la ins‐
trucción

VARIANT (recibe da‐ Valor de la varia‐
tos de la variable del ble
tipo de datos A)

0

BOOL

FALSE

BOOL

FALSE

INT

2

INT

2

Tipos de datos de las expresiones de comparación
En la siguiente tabla se muestran los tipos de datos/grupos de tipos de datos que se pueden
utilizar en expresiones de comparación:
Operación

Operador

Comparación de
=, <>
igualdad, desigual‐
dad

1.er operando

2.º operando

Resultado

Entero/número en
coma flotante

Entero/número en
coma flotante

BOOL

Secuencias de bits Secuencias de bits BOOL
Secuencia de ca‐
racteres

Secuencia de ca‐
racteres

BOOL

TIME, LTIME

TIME, LTIME

BOOL

Fecha y hora

Fecha y hora

BOOL

VARIANT/ANY

VARIANT/ANY

BOOL

VARIANT/ANY
Un tipo de datos
cualquiera (aun‐
que debe coincidir
con el tipo de da‐
tos que suministra
datos a VARIANT)

BOOL

VARIANT/ANY

BOOL

Un tipo de datos
cualquiera

Tipo de datos PLC Tipo de datos PLC BOOL

Comparación de
menor, menor o
igual, mayor, ma‐
yor o igual

<, <=, >, >=

ARRAY of <tipo de
datos> con límites
de ARRAY fijos y
variables

ARRAY of <tipo de BOOL
datos> con límites
de ARRAY fijos y
variables

STRUCT

STRUCT

BOOL

Entero/número en
coma flotante

Entero/número en
coma flotante

BOOL

Secuencias de
bits

Secuencias de bits BOOL

(solo
S7-1200/1500)

8124

(solo
S7-1200/1500)

Secuencia de ca‐
racteres

Secuencia de ca‐
racteres

BOOL

TIME, LTIME

TIME, LTIME

BOOL

Fecha y hora

Fecha y hora

BOOL

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL

Ejemplo
El ejemplo siguiente muestra una expresión de comparación:
SCL
IF a > b THEN c:= a;
IF A > 20 AND B < 20 THEN C:= TRUE;
IF A<>(B AND C) THEN C:= FALSE;

Nota
La comparación en STRING y DT se realiza en el S7-300/400 internamente mediante
instrucciones avanzadas. Para estas funciones no se admiten los siguientes operandos:
● Parámetro de una FC.
● Parámetro de entrada/salida de un FB del tipo STRUCT o ARRAY
Nota
Comparación de los dos tipos de datos de hardware HW_IO y HW_DEVICE
Si desea comparar los dos tipos de datos, primero deberá crear una variable del tipo HW_ANY
en la sección "Temp" de la interfaz del bloque y después copiar el LADDR (del tipo de datos
HW_DEVICE) a la variable. A continuación se pueden comparar HW_ANY y HW_IO.

Consulte también
Expresiones (Página 8116)
Operadores y su jerarquía (Página 8126)

16.1.5

Expresiones lógicas

Descripción
Las expresiones lógicas combinan dos operandos mediante operadores lógicos (AND, OR,
XOR) o niegan operandos (NOT).
Los operadores lógicas pueden procesar los tipos de datos compatibles con la CPU utilizada.
El resultado de una expresión lógica es del tipo de datos BOOL si ambos operandos son del
tipo de datos BOOL. Si al menos uno de los dos operandos es una secuencia de bits, el
resultado también es una secuencia de bits y está determinado por el tipo del operando de
mayor valor. Si, por ejemplo, se combina un operando del tipo BYTE con un operando del tipo
WORD, el resultado es del tipo WORD.
Para combinar un operando de tipo BOOL con una secuencia de bits, primero debe convertirse
explícitamente en una secuencia de bits.

Programación del PLC
Manual de programación y manejo, 11/2019

8125

Creación de programas SCL
16.1 Principios básicos de SCL

Tipos de datos de las expresiones lógicas
En la siguiente tabla se muestran los tipos de datos que puede utilizar en expresiones lógicas:
Operación

Operador

1.er operando

2.º operando

Resultado

Negación (gene‐
rar complemento a
1)

NOT

BOOL

-

BOOL

Secuencia de bits

-

Secuencia de bits

BOOL

BOOL

BOOL

Secuencia de bits

Secuencia de bits

Secuencia de bits

BOOL

BOOL

BOOL

Operación lógica Y AND o &
Operación lógica
O

OR

Operación lógica
O-exclusiva

XOR

Secuencia de bits

Secuencia de bits

Secuencia de bits

BOOL

BOOL

BOOL

Secuencia de bits

Secuencia de bits

Secuencia de bits

Ejemplo
El siguiente ejemplo muestra una expresión lógica:
SCL
IF "MyTag1" AND NOT "MyTag2" THEN c := a;
MyTag := ALPHA OR BETA;

Consulte también
Expresiones (Página 8116)
Operadores y su jerarquía (Página 8126)
Ejemplos de programación SCL (Página 8183)

16.1.6

Operadores y su jerarquía

Operadores y su orden de evaluación
Las expresiones se pueden combinar entre sí mediante operadores o estar anidadas las unas
en las otras.
El orden de evaluación de las expresiones depende de la jerarquía de los operadores y los
paréntesis. Rigen las reglas siguientes:
● Los operadores aritméticos se evalúan antes de los operadores de comparación y estos
antes de los operadores lógicos.
● Los operadores de la misma jerarquía se evalúan por orden de aparición de izquierda a
derecha.
● Las asignaciones de valor se evalúan de derecha a izquierda.
● Primero se evalúan las operaciones entre paréntesis.

8126

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL
La tabla siguiente ofrece una vista general de los operadores y su jerarquía:
Operador

Operación

Jerarquía

+ (Página 8117)

Más unario

2

- (Página 8117)

Menos unario

2

** (Página 8117)

Potencia

3

* (Página 8117)

Multiplicación

4

/ (Página 8117)

División

4

MOD (Página 8117)

Función módulo

4

+ (Página 8117)

Suma

5

- (Página 8117)

Resta

5

+= (Página 8117), -= (Pági‐ Asignaciones de valor combinadas
na 8117), *= (Pági‐
na 8117), /= (Página 8117)

11

Expresiones aritméticas

Expresiones de comparación
< (Página 8120)

Menor

6

> (Página 8120)

Mayor

6

<= (Página 8120)

Menor o igual

6

>= (Página 8120)

Mayor o igual

6

= (Página 8120)

Igual

7

<> (Página 8120)

Diferente

7

NOT (Página 8125)

Negación

3

AND (Página 8125) o &
(Página 8125)

Y booleano

8

XOR (Página 8125)

O-exclusiva

9

OR (Página 8125)

O booleano

10

Expresiones lógicas

Expresiones de referencia
REF (Página 316)

Referenciar

^ (Página 320)

Desreferenciar

1

?= (Página 325)

Intento de asignación

11

( ) (Página 8116)

Paréntesis

1

:= (Página 8127)

Asignación

11

Otras operaciones

16.1.7

Asignaciones de valor

Definición
Con una asignación de valor asigna el valor de una expresión a una variable. En la parte
izquierda de la asignación se encuentra la variable que adopta el valor de la expresión que se
encuentra a la derecha.

Programación del PLC
Manual de programación y manejo, 11/2019

8127

Creación de programas SCL
16.1 Principios básicos de SCL
Como expresión se puede introducir también el nombre de una función. La función es llamada
por la asignación de valor y devuelve su valor de función a la variable que se encuentra a la
izquierda.
El tipo de datos de la asignación de valor está definido por el tipo de datos de la variable que
se encuentra a la izquierda. El tipo de datos de la expresión que se encuentra a la derecha
debe se compatible con este tipo de datos.
Las asignaciones de valor se pueden programar de distinta manera:
● Asignaciones de valor simples
En las asignaciones de valor simples se asigna una expresión o una variable a una única
variable:
Ejemplo: a := b;
● Asignaciones de valor múltiples
En las asignaciones de valor múltiples es posible realizar varias asignaciones con una
única instrucción.
Ejemplo: a := b := c;
La notación correspondiente es la siguiente:
b := c;
a := b;
● Asignaciones de valor combinadas
En las asignaciones de valor combinadas pueden combinarse los operadores "+", "-", "*" y
"/" con el operador de la asignación:
Ejemplo: a += b;
La notación correspondiente es la siguiente:
a := a + b;
Las asignaciones de valor combinadas también pueden asignarse repetidas veces:
a += b += c *= d;
Esto equivale a la siguiente secuencia de asignaciones:
c := c * d;
b := b + c;
a := a + b;

Asignaciones de valor para los tipos de datos STRUCT o PLC
Es posible asignar toda una estructura a otra estructura si ambas presentan una estructura
idéntica y si coinciden tanto los tipos de datos como los nombres de sus elementos.
A un elemento individual de la estructura se le puede asignar una variable, una expresión u otro
elemento de la estructura.

Asignaciones de valor para el tipo de datos ARRAY
Es posible asignar todo un ARRAY a otro ARRAY si coinciden los tipos de datos de los
elementos del ARRAY así como los límites de los ARRAY.
A un elemento individual de un ARRAY se le puede asignar una variable, una expresión u otro
elemento de ARRAY.

8128

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL

Asignaciones de valor del tipo de datos STRING
Es posible asignar un STRING a otro STRING.
A un elemento individual de STRING se le puede asignar otro elemento de STRING.

Asignación de valores para el tipo de datos WSTRING (S7-1200/1500)
Es posible asignar un WSTRING a otro WSTRING.
A un elemento individual de WSTRING se le puede asignar otro elemento de WSTRING.

Asignaciones de valor para el tipo de datos ANY
Las variables con el tipo de datos ANY pueden asignarse solo a los siguientes objetos:
● Parámetros de entrada o datos locales temporales de FB que tengan también el tipo de
datos ANY.
● Datos locales temporales de FC que tengan también el tipo de datos ANY.
Tenga en cuenta, que el puntero ANY permite apuntar solo a las áreas de memoria con el tipo
de acceso "estándar".

Asignaciones de valor para el tipo de datos POINTER
En SCL no puede utilizarse POINTER en asignaciones de valor.

Ejemplos
La tabla siguiente muestra ejemplos de asignaciones de valor simples:
SCL
"MyTag1" := "MyTag2";

(* Asignación de una variable*)

"MyTag1" := "MyTag2" * "MyTag3";

(* Asignación de una expresión*)

"MyTag" := "MyFC"();

(* Llamada de una función que asigna su
valor de función a la variable "MyTag"*)

#MyStruct.MyStructElement := "MyTag";

(* Asignación de una variable a un elemento de la estructura*)

#MyArray[2] := "MyTag";

(* Asignación de una variable a un elemento de ARRAY*)

"MyTag" := #MyArray[1,4];

(* Asignación de un elemento de ARRAY a
una variable*)

#MyString[2] := #MyOtherString[5];

(* Asignación de un elemento de STRING
a otro elemento de STRING*)

La tabla siguiente muestra ejemplos de asignaciones de valor múltiples:
SCL
"MyTag1" := "MyTag2" := "MyTag3";

(* Asignación de una variable*)

"MyTag1" := "MyTag2" := "MyTag3" *
"MyTag4";

(* Asignación de una expresión*)

Programación del PLC
Manual de programación y manejo, 11/2019

8129

Creación de programas SCL
16.1 Principios básicos de SCL
SCL
"MyTag1" := "MyTag2" := "MyTag3 :=
"MyFC"();

(* Llamada de una función que asigna su
valor a las variables "MyTag1", "MyTag1"
y "MyTag1"*)

#MyStruct.MyStructElement1 :=
#MyStruct.MyStructElement2 := "MyTag";

(* Asignación de una variable a dos elementos de estructura*)

#MyArray[2] := #MyArray[32] := "MyTag";

(* Asignación de una variable a dos elementos de ARRAY*)

"MyTag1" := "MyTag2" := #MyArray[1,4];

(* Asignación de un elemento de ARRAY a
dos variables*)

#MyString[2] := #MyString[3]:= #MyOtherString[5];

(* Asignación de un elemento de STRING a
dos elementos de STRING*)

La tabla siguiente muestra ejemplos de asignaciones de valor combinadas:
SCL
"MyTag1" += "MyTag2";

(* "MyTag1" y "MyTag2" se suman y el resultado de la suma se asigna a "MyTag1".*)

"MyTag1" -= "MyTag2" += "MyTag3";

(* "MyTag2" y "MyTag3" se suman. El resultado de la suma se asigna a "MyTag2" y,
seguidamente, se resta de "MyTag1". El resultado se asigna a "MyTag1".*)

#MyArray[2] += #MyArray[32] += "MyTag";

(* El elemento de ARRAY "MyArray[32]" se
suma a "MyTag". El resultado se asigna a
"MyArray[32]". A continuación, los dos
elementos de ARRAY se suman y el resultado se asigna al elemento de ARRAY "MyArray[2]". Los tipos de datos deben ser
compatibles.*)

#MyStruct.MyStructElement1 /=
#MyStruct.MyStructElement2 *= "MyTag";

(* El elemento de estructura "MyStructElement2" se multiplica por "MyTag". El resultado se asigna a "MyStructElement2".
Seguidamente, el elemento de estructura
"MyStructElement1" se divide por "MyStructElement2" y el resultado se asigna a
"MyStructElement1". Los tipos de datos deben ser compatibles.*)

Consulte también
Operadores y su jerarquía (Página 8126)
Direccionar operandos (Página 109)

8130

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL

16.1.8

Calcular en SCL con números en coma flotante (REAL y LREAL)

Representación de la precisión de números en coma flotante
El tipo de datos REAL se indica y calcula con una precisión de 6 decimales en el programa, por
ejemplo. Al calcular números en coma flotante (REAL y LREAL) debe tenerse en cuenta por lo
general que esta precisión se aplica a cada paso de cálculo.
Cuando se suman y restan números en coma flotante, los exponentes se igualan. Con ello, la
base y los exponentes son iguales al sumar y restar y solo se suman las mantisas. Encontrará
más información sobre la estructura de un número en coma flotante en "Consulte también".

Ejemplo de programación
En el siguiente ejemplo de programación debe realizarse un cálculo que consiste en sumar dos
operandos del tipo de datos REAL y restar otro. En el siguiente paso de cálculo se divide la
constante 1 entre el resultado anterior. Para ello se crean un bloque de datos global en el que
se declaran los operandos y una función en la que se programan las operaciones de cálculo.
Fórmulas de cálculo
y = a + b - c
Z = 1/y

Los operandos se almacenan con los valores siguientes:
Operando

Valor

Valor REAL

a

100 000 000

1.000000*108

b

1

1.000000*100

c

100 000 000

1.000000*108

Procedimiento
Cree el bloque de datos "DB_GlobalData":
1. Haga doble clic en el comando "Agregar nuevo bloque".
Se abre el cuadro de diálogo "Agregar nuevo bloque".
2. Haga clic en el botón "Bloque de datos (DB)".
3. Introduzca el nombre "DB_GlobalData".
4. Seleccione "DB global" como tipo del bloque de datos.

Programación del PLC
Manual de programación y manejo, 11/2019

8131

Creación de programas SCL
16.1 Principios básicos de SCL
5. Haga clic en "Aceptar".
6. Cree las variables siguientes en el bloque de datos e indique los valores de arranque
correspondientes:

El valor de arranque de las dos variables es de 100000000.0 y se convierte en 1.0E+8
conforme al tipo de datos REAL.
Cree una función SCL y llámela "FC_Calculate".
1. Declare la interfaz del bloque de la manera siguiente:

2. Escriba las fórmulas siguientes en el código del programa y pase a online para ver el
resultado:
SCL
#y := "DB_GlobalData".a + "DB_GlobalData".b - "DB_GlobalData".c;
#z := 1/#y;

Como puede verse, el resultado en el operando #y = 0, aunque en realidad se esperaba el
número 1 como resultado.

8132

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL
Este resultado erróneo se debe a lo siguiente:
1. En el primer paso de cálculo se suman los operandos a + b. Los valores REAL de los dos
operandos (a = 1.000000*108 y b = 1.000000*100) tienen el aspecto siguiente después de
igualar los exponentes:
a = 1.000000*108 y b = 0.00000001*108. Las dos últimas cifras del segundo número
(operando b) se cortan porque no pueden representarse debido a que la precisión está
ajustada en 6 decimales. Por tanto, se suma un 0 en lugar de un 1 al operando a.
2. En el segundo paso de cálculo se resta el operando c del resultado del paso de cálculo
anterior (resultado intermedio = 1.000000*108 - c = 1.000000*108 da 0.000000e0).
3. Cuando en el próximo paso se calcula el operando z, se está intentando dividir entre cero.

1. Solución posible
Para evitar que suceda lo anterior basta con cambiar la fórmula de cálculo. Escriba en su lugar
la fórmula siguiente:
Fórmulas de cálculo
y = a - c + b
Z = 1/y

Puesto que, en este caso, tras el primer paso de cálculo (operando a - c) el resultado es
0.000000e0, en el segundo paso de cálculo (resultado intermedio + b) la suma del número
REAL hace que el resultado sea correcto (y = 0.000000*100·+ 1.000000*100 = 1.000000*100).

Es recomendable comprobar cuál es la mejor opción para realizar el cálculo antes de
programarlo.

Programación del PLC
Manual de programación y manejo, 11/2019

8133

Creación de programas SCL
16.1 Principios básicos de SCL

2. Solución posible
Para calcular las fórmulas siguientes utilice el tipo de datos LREAL en lugar del tipo de datos
REAL. Puesto que el tipo de datos se procesa con una precisión de 15 decimales, el problema
no llega a producirse.
1. En el bloque de datos global "DB_GlobalData" cree tres variables nuevas con los mismos
valores y con el tipo de datos LREAL todas ellas.

2. En la interfaz de bloque de la FC "FC_Calculate" declare también dos variables nuevas con
el tipo de datos LREAL.

3. Utilice las nuevas variables LREAL para las fórmulas en el código del programa y pase a
online para ver el resultado:
SCL
#y_LREAL := "DB_GlobalData".a_LREAL + "DB_GlobalData".b_LREAL "DB_GlobalData".c_LREAL;
#z_LREAL := 1/#y_LREAL;

8134

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL

Consulte también
REAL (Página 261)
LREAL (Página 262)
Números en coma flotante no válidos (Página 263)

16.1.9

Calcular en SCL con constantes

Interpretación de constantes con tipo y sin tipo
Las constantes son datos que tienen un valor fijo que no cambia durante el tiempo de ejecución
del programa. Las constantes pueden ser leídas por diferentes elementos del programa
durante su ejecución, pero no se pueden sobrescribir. Para el valor de una constante hay
notaciones definidas según el tipo y formato de datos. Básicamente se distingue entre notación
con tipo y notación sin tipo.
En las funciones matemáticas es recomendable no mezclar constantes con tipo y sin tipo, pues
en este caso pueden producirse conversiones indeseadas y, por consiguiente, obtenerse
valores erróneos.

Programación del PLC
Manual de programación y manejo, 11/2019

8135

Creación de programas SCL
16.1 Principios básicos de SCL

Ejemplo de programación
En el siguiente ejemplo de programación se ve una operación de cálculo con una constante
con tipo y otra sin tipo.
1. Cree un bloque de función SCL y llámelo "FB_MathsFunctions".
2. Declare la variable "Variable_DINT" en la sección "Temp" de la interfaz del bloque.

3. Escriba el siguiente código de programa:
Variable_DINT := INT#1 +50000;
En esta operación de cálculo deben sumarse la constante con tipo INT#1 y la constante sin
tipo 50000. La constante sin tipo 50000 se subraya en amarillo en el software para señalizar
que el valor de la constante está fuera del rango admisible para el tipo de datos INT.

Pase a online para ver el resultado.
1. Compile el bloque de función SCL "FB_MathsFunctions" ejecutando el comando "Compilar
> Software (solo cambios)" con el botón derecho del ratón.
2. Cargue el bloque con el comando "Cargar en dispositivo > Software (solo cambios)".
3. Pase a online y observe el bloque.

El tipo de datos de la constante con tipo define el tipo de datos de la suma. Esto significa
que la suma se ejecuta en el área del tipo de datos INT. En el primer paso, la constante sin
tipo 50000 se convierte de forma implícita al tipo de datos INT. Sin embargo, la conversión
da un valor negativo (-15536). Dicho valor se suma a continuación a la constante con tipo
(INT#1). El resultado es -15535. Puesto que la variable en la que debe escribirse el
resultado de la suma está declarada con el tipo de datos DINT, el número -15535 se
convierte implícitamente al tipo de datos DINT y se escribe en la variable "Variable_DINT".
Aún así, el resultado es negativo.

8136

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.1 Principios básicos de SCL

1. solución posible
Una manera de evitar este resultado indeseado consiste en hacer que las dos constantes
tengan tipo. En este caso, el tipo de datos más largo determina la operación de cálculo.
1. En el bloque de función SCL "FB_MathsFunctions" escriba el siguiente código de programa:

En esta operación de cálculo deben sumarse la constante con tipo INT#1 y la constante con
tipo DINT#50000.
Pase a online para ver el resultado.
1. Compile el bloque de función SCL "FB_MathsFunctions" ejecutando el comando "Compilar
> Software (solo cambios)" con el botón derecho del ratón.
2. Cargue el bloque con el comando "Cargar en dispositivo > Software (solo cambios)".
3. Pase a online y observe el bloque.

La constante INT#1 se convierte al tipo de datos DINT y la suma de las dos constantes se
ejecuta en el área del tipo de datos DINT.

2. solución posible
Otra manera de evitar este resultado indeseado consiste en hacer que las dos constantes no
tengan tipo. En este caso, ambas se interpretan como el tipo de datos más ancho posible de
la CPU actual. Esto significa que, en una CPU de la serie S7-1500, las dos constantes se
interpretarán como tipo de datos LINT.
1. En el bloque de función SCL "FB_MathsFunctions" escriba el siguiente código de programa:

En esta operación de cálculo deben sumarse la constante sin tipo 1 y la constante sin tipo
50000.

Programación del PLC
Manual de programación y manejo, 11/2019

8137

Creación de programas SCL
16.2 Configuración de SCL
Pase a online para ver el resultado.
1. Compile el bloque de función SCL "FB_MathsFunctions" ejecutando el comando "Compilar
> Software (solo cambios)" con el botón derecho del ratón.
2. Cargue el bloque con el comando "Cargar en dispositivo > Software (solo cambios)".
3. Pase a online y observe el bloque.

Las constantes 1 y 50000 se interpretan como tipo de datos LINT y el resultado de la suma
se convierte de nuevo al tipo de datos DINT.

Consulte también
Principios básicos de las constantes (Página 103)
Vista general de los tipos de datos válidos (Página 241)

16.2

Configuración de SCL

16.2.1

Sinopsis de la configuración de SCL

Sinopsis
Las tablas siguientes muestran los ajustes que se pueden efectuar en SCL:

8138

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.2 Configuración de SCL

Configuración del editor
Grupo

Ajuste

Descripción

Vista

Representación de los operandos

Representación de los operandos en el editor de programa‐
ción. Existen las opciones siguientes:
● Simbólica y absoluta
● Simbólica

Información de variables

En el editor de programación se visualiza información adicional
de las variables utilizadas. Si selecciona la opción "Información
de la variable con comentarios jerárquicos", en las variables
estructuradas se mostrarán también los comentarios de los ni‐
veles superiores de la estructura.

Resaltar palabras clave

Notación en la que se muestran las palabras clave del lenguaje
de programación. Se puede elegir entre mayúsculas y minús‐
culas o una notación conforme a las convenciones del lenguaje
de programación Pascal.

Justificar parámetros actuales a la iz‐
quierda

Alínea los parámetros actuales a la izquierda en una llamada
de bloque Solo tiene efecto si está activada la opción "Smart"
en los ajustes, bajo "General > Editores de scripts/textos >
Sangría".

Ajuste predeterminado para bloques nuevos
Al crear bloques, se utilizan los siguientes ajustes como valores estándar. Estos ajustes se
pueden modificar posteriormente en las propiedades del bloque.
Grupo

Ajuste

Descripción

Compilar

Crear información avanzada de estado

Permite observar todas las variables de un bloque. Sin embar‐
go, la cantidad de memoria que requiere el programa y los
tiempos de ejecución aumentan con esta opción.

Comprobar límites de ARRAY1)

Comprueba en el tiempo de ejecución si los índices del campo
se encuentran en el rango declarado para un ARRAY. Si un
índice del campo supera el rango admisible, la salida de habi‐
litación ENO del bloque se pone a "0".

Asignar ENO automáticamente

Comprueba en el tiempo de ejecución si se han producido
errores al procesar determinadas instrucciones. Si se produce
un error en el tiempo de ejecución, la salida de habilitación ENO
del bloque se pone a "0".

Vista

Define si la interfaz de los bloques recién creados debe mos‐
trarse en forma de tabla o de texto.

Interfaz del blo‐
que

1)
Para las CPU de las series S7-300/400 vale: si se rebasan por exceso los límites de ARRAY, la salida de habilitación ENO
devuelve FALSE.

Para las CPU de las series S7-1200/1500 vale: si se rebasan por exceso los límites de ARRAY, la salida de habilitación ENO
no devuelve FALSE. Véase "Direccionar componentes de ARRAY (Página 299)" para las posibilidades de consulta de
errores.

Consulte también
Modificar la configuración (Página 8140)
Mecanismo EN/ENO (Página 152)

Programación del PLC
Manual de programación y manejo, 11/2019

8139

Creación de programas SCL
16.3 La ventana de programación de SCL

16.2.2

Modificar la configuración

Procedimiento
Para modificar la configuración, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Modifique la configuración.

Resultado
El cambio se aplica sin necesidad de guardarlo explícitamente.

Consulte también
Sinopsis de la configuración de SCL (Página 8138)

16.3

La ventana de programación de SCL

16.3.1

Vista general de la ventana de programación

Función
La ventana de programación es el área de trabajo en la que se introduce el programa SCL.
La figura siguiente muestra la ventana de programación de SCL:










8140

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.3 La ventana de programación de SCL
La ventana de programación incluye las áreas siguientes:
Rango

① Barra lateral

② Números de línea
③ Vista de esquema
④ Área del código
⑤ Visualización de los operandos absolu‐
tos

Significado
En la barra lateral se pueden insertar marcadores y pun‐
tos de parada.
A la izquierda se muestran los números de línea junto al
código del programa.
La vista de esquema marca las secciones de código re‐
lacionadas.
En el área del código se edita el programa SCL.
En esta tabla se muestra la asignación de los operandos
simbólicos a las direcciones absolutas.

Consulte también
Ajuste de la ventana de programación (Página 8141)
Formatear un código SCL (Página 8143)
Expandir y contraer secciones de código (Página 8144)
Navegar hasta las definiciones (Página 8145)
Uso de marcadores (Página 8146)

16.3.2

Ajuste de la ventana de programación

Introducción
La visualización de la ventana de programación y del código de programa se puede ajustar de
la siguiente manera:
● Ajuste del tipo, tamaño y color de la fuente
● Ajuste del ancho de tabulación
● Visualización de los números de línea
● Mostrar u ocultar los operandos absolutos

Ajuste del tipo, tamaño y color de la fuente
Para ajustar el tipo, tamaño y color de la fuente, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "General > Editores scripts/textos".
3. Ajuste el tipo y tamaño de fuente deseado o seleccione los colores de la fuente para los
diferentes elementos del lenguaje.

Programación del PLC
Manual de programación y manejo, 11/2019

8141

Creación de programas SCL
16.3 La ventana de programación de SCL

Ajuste del ancho de tabulación
Para que la visualización del programa sea más clara, se insertan sangrías en las líneas en
función de la sintaxis. El ancho de la sangría se define con el ancho de tabulación.
Para ajustar el ancho de tabulación, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "General > Editores scripts/textos".
3. Ajuste el ancho de tabulación.

Visualización de los números de línea
Para mostrar los números de línea, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "General > Editores scripts/textos".
3. Active la opción "Mostrar números de línea".

Mostrar y ocultar los operandos absolutos
En caso necesario, puede ver la asignación de operandos simbólicos y absolutos en una tabla
junto al código del programa.
Para mostrar u ocultar los operandos absolutos, proceda del siguiente modo:
1. Haga clic en el botón "Operandos absolutos/simbólicos" de la barra de herramientas.
Aparecen los operandos absolutos.
2. Para desplazar el visor, haga clic en la tabla y arrástrelo hasta la posición deseada mientras
mantiene pulsado el botón del ratón.
3. Para modificar el ancho de la tabla, haga clic en el borde derecho o izquierdo de la tabla y
arrastre hacia la derecha o la izquierda mientras mantiene pulsado el botón del ratón.

Consulte también
Vista general de la ventana de programación (Página 8140)
Formatear un código SCL (Página 8143)
Expandir y contraer secciones de código (Página 8144)
Navegar hasta las definiciones (Página 8145)
Uso de marcadores (Página 8146)

8142

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.3 La ventana de programación de SCL

16.3.3

Formatear un código SCL

Introducción
Para proporcionar una estructura más clara al programa, es posible activar o desactivar
manualmente la sangría de líneas o formatear secciones de código. Al formatear secciones de
código observe los siguientes puntos:
● Se formatea según los ajustes generales de sangría, pero se sangra siempre la línea o
sección como mínimo. Si ha seleccionado el ajuste "Smart", se eliminarán asimismo
espacios innecesarios de la instrucción SCL.
● Solo pueden formatearse secciones de código sintácticamente correctas.
● Si coloca una marca de inserción en la primera o la última línea de una instrucción para el
control del programa, p. ej. en una instrucción IF en la línea con el "IF", se formateará toda
la instrucción.
● Si selecciona texto, solo se formateará el texto seleccionado.
Además puede ajustarse que los parámetros actuales de las llamadas de bloques se alíneen
siempre a la izquierda. Para ello debe estar ajustada la opción para sangría "Smart".

Anulación y aplicación individual de sangrías
Para anular y aplicar sangrías en líneas individuales, proceda del siguiente modo:
1. Haga clic en la línea en la que desea aplicar o anular la sangría.
2. Seleccione en la barra de herramientas del editor del programa el botón "Aplicar sangría"
o "Anular sangría".
Nota
El ancho de la sangría se define en "Herramientas > Configuración".

Formatear secciones de código
Para formatear secciones de código, proceda del siguiente modo:
1. Seleccione el texto que desea formatear o sitúe la marca de inserción en la línea en
cuestión.
2. Seleccione el botón "Formatear automáticamente el texto seleccionado" en la barra de
herramientas del editor de programación.

Programación del PLC
Manual de programación y manejo, 11/2019

8143

Creación de programas SCL
16.3 La ventana de programación de SCL

Alinear parámetros actuales de llamadas de bloques a la izquierda.
Para alinear los parámetros actuales de llamadas de bloque a la izquierda, proceda del
siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "General > Editores de scripts/textos" en la navegación local.
3. Active la opción "Smart" en "Sangría".
4. En la navegación local, seleccione el grupo "Programación PLC > SCL (Structured Control
Language)".
5. Active la casilla de verificación "Justificar parámetros actuales a la izquierda" en "Vista".
En las llamadas de bloques que se inserten a partir de entonces, los parámetros actuales
se alinearán a la izquierda. Para alinear a la izquierda los parámetros actuales de llamadas
de bloques existentes, seleccione las llamadas de bloque y haga clic en el botón
"Formatear automáticamente el texto seleccionado" en la barra de herramientas del editor
de programación.

Consulte también
Vista general de la ventana de programación (Página 8140)
Ajuste de la ventana de programación (Página 8141)
Expandir y contraer secciones de código (Página 8144)
Navegar hasta las definiciones (Página 8145)
Uso de marcadores (Página 8146)

16.3.4

Expandir y contraer secciones de código

Introducción
Las instrucciones SCL pueden abarcar varias líneas. Ejemplos de ello son las instrucciones de
control del programa o las llamadas de bloque.
Estas instrucciones relacionadas se marcan del siguiente modo:
● Una vista de esquema entre el número de la línea y el código del programa marca toda la
sección de código.
● Si marca la palabra clave de apertura, se marca automáticamente la palabra clave de cierre.
Para mejorar la claridad, en la vista de esquema es posible expandir y contraer secciones de
código relacionadas. La vista de esquema seleccionada se conserva aún después de cerrar el
bloque o el proyecto de forma que, al volver a abrir el bloque, las secciones de código se
muestran del mismo modo que cuando se cerró.

8144

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.3 La ventana de programación de SCL

Procedimiento
Para expandir o contraer las secciones de código, proceda del siguiente modo:
1. Haga clic en el símbolo menos de la vista de esquema.
La sección de código se contrae.
2. Haga clic en el símbolo más de la vista de esquema.
La sección de código se expande.

Consulte también
Vista general de la ventana de programación (Página 8140)
Ajuste de la ventana de programación (Página 8141)
Formatear un código SCL (Página 8143)
Navegar hasta las definiciones (Página 8145)
Uso de marcadores (Página 8146)

16.3.5

Navegar hasta las definiciones
En el código del programa pueden utilizarse elementos definidos en otros editores, p. ej.
variables o bloques de datos (DB) de bloques de función (FB) llamados. Para ver los puntos de
definición en los editores correspondientes, existe la posibilidad de navegar hasta ellos.

Procedimiento
Para navegar hasta la definición de un elemento del código, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el elemento del código.
2. Elija el comando "Ir a > Definición" del menú contextual.
Se abrirá el editor en el que se definió el elemento del código y se mostrará el punto de
definición.
O bien:
1. Pulse y mantenga pulsada la tecla <Ctrl>.
2. Sitúe el puntero del ratón sobre el código del programa.
Al mover el puntero del ratón por encima de un elemento del código cuya definición pueda
visualizarse, el elemento aparece subrayado y su nombre se convierte en un enlace.
3. Haga clic en el enlace.
Se abrirá el editor en el que se definió el elemento del código y se mostrará el punto de
definición.

Consulte también
Vista general de la ventana de programación (Página 8140)
Ajuste de la ventana de programación (Página 8141)

Programación del PLC
Manual de programación y manejo, 11/2019

8145

Creación de programas SCL
16.3 La ventana de programación de SCL
Formatear un código SCL (Página 8143)
Expandir y contraer secciones de código (Página 8144)
Uso de marcadores (Página 8146)

16.3.6

Uso de marcadores

16.3.6.1

Principios básicos de los marcadores

Función
Los marcadores permiten marcar puntos del programa en programas extensos para
encontrarlos fácilmente con el fin de retocarlos posteriormente. Los marcadores se muestran
en la barra lateral de la ventana de programación. Mediante comandos de menú se navega
entre varios marcadores de un bloque.
Los marcadores se guardan con el proyecto y, por tanto, están disponibles para todas las
personas que editen el bloque. Sin embargo, no se cargan en dispositivos.
Durante la comparación de bloques, los marcadores no se evalúan.

Consulte también
Inserción de marcadores (Página 8146)
Navegación por marcadores (Página 8147)
Borrado de marcadores (Página 8148)

16.3.6.2

Inserción de marcadores

Requisitos
El bloque SCL está abierto.

Procedimiento
Para activar un marcador, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la línea deseada de la barra lateral.
2. Elija el comando "Marcadores > Activar" del menú contextual.
O bien:
1. Haga clic en la línea en la que desea colocar el marcador.
2. Haga clic en el botón "Activar/borrar marcadores" de la barra de herramientas.

8146

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.3 La ventana de programación de SCL
O bien:
1. Mantenga pulsada la tecla <Ctrl>.
2. Haga clic en la línea de la barra lateral en la que quiere activar el marcador.

Resultado
Se inserta un marcador en el código del programa.

Consulte también
Principios básicos de los marcadores (Página 8146)
Navegación por marcadores (Página 8147)
Borrado de marcadores (Página 8148)

16.3.6.3

Navegación por marcadores

Requisitos
En un bloque se han activado varios marcadores.

Procedimiento
Para navegar entre marcadores, proceda del siguiente modo:
1. Inserte la marca de inserción en el código del programa.
2. Seleccione en el menú "Edición" el comando "Ir a > Marcador siguiente" o "Ir a > Marcador
anterior".
O bien:
1. Inserte la marca de inserción en el código del programa.
2. Haga clic en el botón "Ir al marcador siguiente" o "Ir al marcador anterior" de la barra de
herramientas del editor de programas.
O bien:
1. Haga clic en la barra lateral.
2. Elija el comando "Marcadores > Siguiente " o "Marcadores > Anterior" del menú contextual.

Resultado
Se resalta la línea con el marcador.

Programación del PLC
Manual de programación y manejo, 11/2019

8147

Creación de programas SCL
16.3 La ventana de programación de SCL

Consulte también
Principios básicos de los marcadores (Página 8146)
Inserción de marcadores (Página 8146)
Borrado de marcadores (Página 8148)

16.3.6.4

Borrado de marcadores
Es posible borrar marcadores individuales o todos los marcadores del bloque o la CPU.

Borrado de marcadores individuales
Para borrar un marcador individual, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la línea de la barra lateral en la que desea borrar
el marcador.
2. Elija el comando "Marcadores > Borrar" del menú contextual.
O bien:
1. Haga clic en la línea en la que desea borrar el marcador.
2. Elija el comando "Marcador > Borrar" del menú "Edición".
O bien:
1. Haga clic en la línea en la que desea borrar el marcador.
2. Haga clic en el botón "Activar/borrar marcadores" de la barra de herramientas.

Borrado de todos los marcadores de un bloque
Para borrar todos los marcadores de un bloque, proceda del siguiente modo:
1. Haga clic en la barra lateral con el botón derecho del ratón.
2. Elija el comando "Marcadores > Borrar todos del bloque" del menú contextual.
O bien:
1. Elija el comando "Marcadores > Borrar todos del bloque" del menú "Edición".

Consulte también
Principios básicos de los marcadores (Página 8146)
Inserción de marcadores (Página 8146)
Navegación por marcadores (Página 8147)

8148

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

16.4

Entrada de instrucciones SCL

16.4.1

Reglas sobre las instrucciones SCL

Instrucciones en SCL
SCL conoce los siguientes tipos de instrucciones:
● Asignaciones de valor
Las asignaciones de valor sirven para asignar a una variable un valor constante, el
resultado de una expresión o el valor de otra variable.
● Instrucciones para el control del programa
Las instrucciones para el control del programa sirven para realizar ramas, bucles o saltos
del programa.
● Otras instrucciones de la Task Card "Instrucciones"
La Task Card "Instrucciones" ofrece una amplia selección de instrucciones estándar que
pueden utilizarse en el programa SCL.
● Llamadas de bloque
Las llamadas de bloque sirven para editar los subprogramas que han sido trasvasados a
otros bloques y para posprocesar sus resultados.

Reglas
Al introducir instrucciones SCL, es necesario observar las reglas siguientes:
● Las instrucciones SCL pueden abarcar varias líneas.
● Todas las instrucciones acaban con un punto y coma (;).
● No se distingue entre mayúsculas y minúsculas.
● Los comentarios sólo sirven como documentación del programa. No influyen en la
ejecución del programa.

Ejemplos
En los siguientes ejemplos se muestran los diferentes tipos de instrucciones:
SCL
// Ejemplo de una asignación de valor
"MyTag":= 0;
// Ejemplo de una llamada de bloque
"MyDB"();
// Ejemplo de una instrucción para el control del programa
WHILE "Counter" < 10 DO
"MyTAG" := "MyTag" + 2;
END_WHILE;

Programación del PLC
Manual de programación y manejo, 11/2019

8149

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Consulte también
Principios básicos de SCL (Página 8115)

16.4.2

Entrada manual de instrucciones SCL

Requisitos
Hay un bloque SCL abierto.

Procedimiento
Para introducir una instrucción SCL, proceda del siguiente modo:
1. Introduzca la sintaxis de la instrucción mediante el teclado.
Al introducirla, se dispone de la función de autocompletar. Ofrece todas las instrucciones y
operandos que están permitidos en la posición actual.
2. Seleccione con la función de autocompletar la instrucción o el operando deseados.
Si selecciona una instrucción que requiere que se indiquen operandos, en el programa se
insertarán comodines para los operandos. Los comodines de los operandos se resaltan en
color amarillo. Se selecciona el primer comodín.
3. Sustituya el comodín por un operando.
4. Navegue con la tecla <TAB> por todos los comodines y sustitúyalos por operandos.
Nota
Es posible arrastrar un operando ya definido desde la tabla de variables PLC o la interfaz del
bloque al programa mediante la función Drag & Drop. Para sustituir un operando ya insertado,
deje el puntero del ratón brevemente sobre el operando que desea sustituir antes de soltar el
botón del ratón. De ese modo el operando se marca y al soltar el botón del ratón se sustituye
por el nuevo.

Resultado
Se inserta la instrucción.
El editor de programación realiza una comprobación de la sintaxis. Las entradas incorrectas se
muestran en color rojo y cursiva. Asimismo, se muestra un mensaje de error detallado en la
ventana de inspección.

Consulte también
Utilizar la función automática de autocompletar en los lenguajes de programación textuales
(Página 7684)
Ampliar y reducir una lista de parámetros (Página 8177)

8150

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL
Encerrar el código de programa con elementos de estructura (Página 8152)
Conversión de los tipos de datos en el S7-1200 (Página 506)

16.4.3

Inserción de instrucciones SCL desde la Task Card "Instrucciones"
La Task Card "Instrucciones" ofrece una amplia selección de instrucciones que pueden
utilizarse en el programa SCL. En la Task Card "Instrucciones" también están disponibles las
instrucciones específicas de SCL para el control del programa.

Requisitos
Hay un bloque SCL abierto.

Procedimiento
Para insertar una instrucción SCL en un programa mediante la Task Card "Instrucciones",
proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. Para insertar la instrucción, elija uno de los siguientes pasos:
– Navegue hasta la instrucción SCL que quiere insertar y arrástrela mediante Drag & Drop
a la línea deseada del código de programa. El punto de inserción se marca con un
rectángulo verde.
– Marque el punto del código de programa en el que quiere insertar la instrucción y haga
doble clic en la instrucción que quiere insertar.
La instrucción inserta en el programa. Los comodines de los operandos se resaltan en color
amarillo. Un amarillo más claro identifica a los parámetros opcionales cuya interconexión
no es obligatoria Un amarillo más oscuro identifica a los parámetros cuya interconexión es
obligatoria Se selecciona el primer comodín.
3. Sustituya el comodín por un operando. También puede arrastrar una variable de la interfaz
o la tabla de variables PLC mediante Drag & Drop hasta el comodín.
4. Navegue con la tecla <TAB> por todos los comodines y sustitúyalos por operandos.

Resultado
Se inserta la instrucción.
El editor de programación realiza una comprobación de la sintaxis. Las entradas incorrectas se
muestran en color rojo y cursiva. Asimismo, se muestra un mensaje de error detallado en la
ventana de inspección.

Programación del PLC
Manual de programación y manejo, 11/2019

8151

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Consulte también
Utilizar la función automática de autocompletar en los lenguajes de programación textuales
(Página 7684)
Ampliar y reducir una lista de parámetros (Página 8177)
Encerrar el código de programa con elementos de estructura (Página 8152)
Conversión de los tipos de datos en el S7-1200 (Página 506)

16.4.4

Encerrar el código de programa con elementos de estructura
Existe la posibilidad de encerrar el código de programa utilizando los siguientes elementos de
estructura:
● Áreas:
– REGION
● Estructuras de control
– IF ... THEN
– CASE ... OF ...
– FOR ... TO ... DO ...
– WHILE ... DO ...
● Secciones de comentario
– (* *)

Procedimiento
Para encerrar el código de programa con un elemento de estructura, proceda del siguiente
modo:
1. Seleccione el código de programa que desea encerrar con un elemento de estructura.
2. Haga clic con el botón derecho del ratón en el código de programa seleccionado.
3. Seleccione el elemento de estructura deseado con el comando "Rodear con" del menú
contextual.
4. Otra posibilidad consiste en seleccionar también el elemento de estructura en los favoritos
o en la Task Card "Instrucciones", dentro de la paleta "Instrucciones básicas > Control del
programa".

Consulte también
Entrada manual de instrucciones SCL (Página 8150)
Inserción de instrucciones SCL desde la Task Card "Instrucciones" (Página 8151)
Inserción de comentarios (Página 8179)

8152

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

16.4.5

Trabajar con áreas

16.4.5.1

Uso de áreas

Función
SCL permite estructurar el código del programa en áreas. De este forma el programa gana
claridad, pues se agrupan las partes del programa relacionadas y se pueden expandir o
contraer las áreas según sea necesario. Para navegar rápidamente por las áreas se dispone
de una vista general de áreas. Esta se muestra junto a la ventana de programación y puede
mostrarse u ocultarse según sea necesario.
La figura siguiente muestra la vista general de las áreas y la ventana de programación:

La vista general de las áreas muestra también las áreas en las que todavía existen errores de
sintaxis. De este modo es posible navegar rápidamente hasta los puntos del código que
contienen errores y solucionarlos.
Para agrupar una parte del programa en un área, enciérrela entre las palabras clave "REGION"
y "END_REGION". En función de los ajustes realizados para resaltar palabras clave, la
notación de las mismas puede ser también "region" y "end_region" o "Region" y "End_Region".
Las palabras clave se convierten automáticamente a la notación que corresponde al ajuste
actual. Para buscar palabras clave "REGION" y "END_REGION" relacionadas, haga clic en
"REGION" o en "END_REGION". Al hacerlo, ambas palabras clave se resaltan en color.

Programación del PLC
Manual de programación y manejo, 11/2019

8153

Creación de programas SCL
16.4 Entrada de instrucciones SCL
Es posible asignar un nombre a cada área. Esto tiene las ventajas siguientes:
● El nombre es visible incluso cuando el área está contraída. De este modo se conserva
siempre una visión de conjunto del código del programa.
● Las áreas se identifican con más facilidad en la vista general de las áreas y es más fácil
navegar hacia las diferentes áreas.
● Si inserta el nombre como comentario multilingüe, podrá traducir el nombre a otros idiomas
del proyecto. Para ello, encierre el nombre entre las secuencias de caracteres "(/* " y "*/)".
Sin embargo, el nombre solo puede insertarse como nombre no traducible o como
comentario multilingüe. Observe las indicaciones siguientes:
– No está permitido mezclar nombres normales con nombres como comentarios
multilingües.
– El nombre como comentario multilingüe no puede abarcar varias líneas.
– Las áreas también pueden copiarse si tienen un comentario multilingüe como nombre.
Si ya existen traducciones para el mismo, estas también se aplican a la copia del área.
Si a continuación se cambia el nombre del área, este cambia en el idioma de edición
actual.
Consulte también: Trabajar con proyectos multilingües
La indicación de un nombre es opcional.

Sintaxis
Utilice la siguiente sintaxis para agrupar partes del programa en áreas:

REGION <nombre> o (/*<nombre como comentario multilingüe/)
<Instrucciones>
END_REGION

Tenga en cuenta las indicaciones siguientes al utilizar áreas:
● Las palabras clave "REGION" y "END_REGION" deben estar al principio de una línea. Solo
se admiten espacios delante de las palabras clave.
● Todos los caracteres posteriores a la palabra clave "END_REGION" se consideran
comentario, por lo que no afectan a la ejecución del programa.

8154

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL
● Todas las instrucciones deben estar encerradas en un área.
● Dentro de instrucciones CASE, las instrucciones pueden encerrarse en áreas. Sin
embargo, es necesario que las constantes utilizadas para la comparación de la instrucción
CASE estén fuera de las áreas. No está permitido que las áreas abarquen varias ramas.
El ejemplo siguiente muestra un uso permitido de áreas dentro de una instrucción CASE:
CASE <Expression> OF
<Constant1> : REGION <Instructions1> END_REGION
<Constant2> : REGION <Instructions2> END_REGION
ELSE REGION <Instructions0> END_REGION
END_CASE
Los ejemplos siguientes muestran usos no permitidos de áreas dentro de instrucciones
CASE:
CASE <Expression> OF
REGION <Constant1> : <Instructions1> END_REGION
<Constant2> : REGION <Instructions2> END_REGION
ELSE <Instructions0>
END_CASE
CASE <Expression> OF
<Constant1> : <Instructions1> REGION
<Constant2> : END_REGION <Instructions2>
ELSE <Instructions0>
END_CASE
En estos casos, las constantes se interpretan dentro de un área como marcas de salto, a
las que se puede acceder con GOTO pero que son ignoradas por las instrucciones CASE.
Existe la posibilidad de anidar las áreas. Sin embargo, al hacerlo hay que asegurarse de que
las áreas estén completamente encerradas dentro de otras áreas:

REGION <Nombre>
<Instrucciones>
REGION <Nombre>
<Instrucciones>
END_REGION
<Instrucciones>
REGION <Nombre>
REGION
<Instrucciones>
END_REGION
REGION <Nombre>
<Instrucciones>
END_REGION
END_REGION
END_REGION

Consulte también
Insertar áreas (Página 8156)
Copiar y pegar áreas (Página 8157)
Navegar por las áreas (Página 8158)
Borrar áreas (Página 8160)

Programación del PLC
Manual de programación y manejo, 11/2019

8155

Creación de programas SCL
16.4 Entrada de instrucciones SCL

16.4.5.2

Insertar áreas
Existen las posibilidades siguientes de insertar áreas en el código de programa:
● Insertar las áreas manualmente utilizando el teclado.
● Insertar las áreas desde la Task Card "Instrucciones". Al hacerlo es posible insertar áreas
vacías o bien rodear de áreas el código de programa existente.
● Insertar las áreas mediante los favoritos. Al hacerlo es posible insertar áreas vacías o bien
rodear de áreas el código de programa existente.

Insertar las áreas manualmente utilizando el teclado
Para insertar manualmente un área en el código del programa utilizando el teclado, proceda
del siguiente modo:
1. Sitúe el cursor en la posición en la que desea insertar un área.
2. Introduzca la palabra clave "REGION".
Nota
En función de los ajustes realizados para resaltar palabras clave, la notación de las mismas
puede ser también "region" y "end_region" o "Region" y "End_Region". Las palabras clave
se convierten automáticamente a la notación que corresponde al ajuste actual.
3. Introduzca el nombre del área como tal o como comentario multilingüe. Este paso es
opcional.
4. Mueva el cursor hasta el final del área.
5. Introduzca la palabra clave "END_REGION".
El código del programa se agrupa en un área que puede expandirse y contraerse. La nueva
área se muestra en la vista general de áreas. Si no se ha asignado ningún nombre, en la
vista general de áreas se mostrará con el nombre "Sin nombre".

Insertar las áreas desde la Task Card "Instrucciones".
Para insertar un área en el código del programa desde la Task Card "Instrucciones", proceda
del siguiente modo:
1. Sitúe el cursor en la posición en la que desea insertar un área vacía o bien seleccione el
código de programa que desea rodear de un área.
2. Abra la Task Card "Instrucciones".
3. Navegue hasta "Control del programa > REGION".

8156

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL
4. Utilizando la función Drag&Drop, arrastre la instrucción "REGION" hasta la posición del
código de programa en la que desea insertar un área o bien inserte la instrucción "REGION"
haciendo doble clic.
El resultado es que se inserta un área vacía o se encierra el código de programa
seleccionado en un área. La nueva área se muestra en la vista general de áreas con el
comodín "_name_" por nombre.
5. Sustituya el comodín "_name_" por el nombre deseado, como texto normal o como
comentario multilingüe. Si no quiere asignar ningún nombre, borre el comodín. En este
caso, el área nueva se mostrará en la vista general de áreas con el nombre "desconocido".

Insertar áreas mediante los favoritos
Para insertar un área en el código de programa mediante los favoritos, proceda del siguiente
modo:
1. Sitúe el cursor en la posición en la que desea insertar un área vacía o bien seleccione el
código de programa que desea rodear de un área.
2. En la paleta "Favoritos" o en la barra de favoritos del editor de programación, haga clic en
la instrucción "REGION".
El resultado es que se inserta un área vacía o se encierra el código de programa
seleccionado en un área. La nueva área se muestra en la vista general de áreas con el
comodín "_name_" por nombre.
3. Sustituya el comodín "_name_" por el nombre deseado, como texto normal o como
comentario multilingüe. Si no quiere asignar ningún nombre, borre el comodín. En este
caso, el área nueva se mostrará en la vista general de áreas con el nombre "desconocido".

Consulte también
Uso de áreas (Página 8153)
Copiar y pegar áreas (Página 8157)
Navegar por las áreas (Página 8158)
Borrar áreas (Página 8160)

16.4.5.3

Copiar y pegar áreas
Las áreas y su contenido también pueden copiarse y pegarse en el código del programa.

Procedimiento
Para copiar áreas y su contenido, proceda del siguiente modo:
1. Abra la vista general de áreas.
2. Haga clic con el botón derecho del ratón en el área que desea copiar y elija el comando
"Copiar" del menú contextual.
3. Sitúe el cursor en la posición del código del programa en la que desea insertar el área.

Programación del PLC
Manual de programación y manejo, 11/2019

8157

Creación de programas SCL
16.4 Entrada de instrucciones SCL
4. Inserte el área en el código del programa utilizando el comando "Pegar" del menú
contextual o la combinación de teclas <Ctrl+V>.
El área copiada inserta en el código del programa con el contenido expandido.
Adicionalmente se inserta el área en la vista general de áreas.
5. Asigne un nombre nuevo al área insertada, si fuera necesario.
O bien:
1. Seleccione el área en la ventana del programa. No importa si el área está expandida o
contraída.
2. Copie el área utilizando el comando "Copiar" del menú contextual o la combinación de
teclas <Ctrl+C>.
3. Sitúe el cursor en la posición del código del programa en la que desea insertar el área.
4. Inserte el área en el código del programa utilizando el comando "Pegar" del menú
contextual o la combinación de teclas <Ctrl+V>.
El área copiada inserta en el código del programa con el contenido expandido.
Adicionalmente se inserta el área en la vista general de áreas.
5. Asigne un nombre nuevo al área insertada, si fuera necesario.

Consulte también
Uso de áreas (Página 8153)
Insertar áreas (Página 8156)
Navegar por las áreas (Página 8158)
Borrar áreas (Página 8160)

16.4.5.4

Navegar por las áreas
Para navegar rápidamente por las áreas se dispone de una vista general de áreas. Esta
muestra todas las áreas que hay en el código del programa. También ofrece las siguientes
funciones:
● Sincronizar la visualización de las áreas en la vista general de áreas y en la ventana de
programación:
Existe la posibilidad de especificar si, cuando se expanden o contraen áreas, esta acción
debe afectar únicamente a la vista general de áreas, a la ventana de programación o bien
a ambas.
● Expandir o contraer un área individual:
Las diferentes áreas pueden expandirse o contraerse en la vista general de áreas o bien en
la ventana de programación. Si se ha activado la sincronización, el área se expandirá o
contraerá en las dos ventanas.
● Expandir o contraer todas las áreas
Es posible expandir o contraer todas las áreas a la vez en la vista general de áreas o bien
en la ventana de programación. Si se ha activado la sincronización, las áreas se expandirán
o contraerán en las dos ventanas.

8158

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Sincronizar la visualización de las áreas en la vista general de áreas y en la ventana de programación
Para definir la sincronización de la visualización de áreas en la vista general de áreas y en la
ventana de programación, proceda del siguiente modo:
1. Abra la vista general de áreas.
2. Para activar la sincronización de la visualización, haga clic en el botón "Activar/Desactivar
sincronización" de la barra de herramientas de la vista general de áreas.
Ahora, el botón de la sincronización está activado.
3. Para desactivar la sincronización de la visualización, haga clic en el botón "Activar/
Desactivar sincronización" de la barra de herramientas de la vista general de áreas.
Ahora, el botón de la sincronización está desactivado.

Expandir o contraer un área individual
Para expandir o contraer un área individual, proceda del siguiente modo:
1. Abra la vista general de áreas.
2. En la vista general de áreas, haga clic con el botón derecho del ratón en el área que desea
expandir o contraer.
3. En el menú contextual, elija el comando "Expandir" o "Contraer".
O bien:
1. Abra la vista general de áreas.
2. En la vista general de áreas, seleccione el área que desea expandir o contraer.
3. Pulse la combinación de teclas <Ctrl+Mayús+Num+> para expandir o <Ctrl+Mayús+Num> para contraer.
O bien:
1. En la ventana de programación, coloque el cursor en el área que desea expandir o contraer.
2. Pulse la combinación de teclas <Ctrl+Mayús+Num+> para expandir o <Ctrl+Mayús+Num> para contraer.
En función del ajuste de sincronización, el área se expandirá o contraerá en la vista general de
áreas, en la ventana de programación o en ambas.

Expandir o contraer todas las áreas
Para expandir o contraer todas las áreas a la vez, proceda del siguiente modo:
1. Abra la vista general de áreas.
2. Para expandir todas las áreas, haga clic en el botón "Expandir todos" de la barra de
herramientas de la vista general de áreas.
3. Para contraer todas las áreas, haga clic en el botón "Contraer todos" de la barra de
herramientas de la vista general de áreas.
O bien:
1. Abra la vista general de áreas.
2. Seleccione un área cualquiera en la vista general de áreas.

Programación del PLC
Manual de programación y manejo, 11/2019

8159

Creación de programas SCL
16.4 Entrada de instrucciones SCL
3. Para expandir todas las áreas, pulse la combinación de teclas <Ctrl+Mayús+Num*>.
4. Para contraer todas las áreas, pulse la combinación de teclas <Ctrl+Mayús+Num/>.
O bien:
1. Sitúe el cursor en la ventana de programación.
2. Para expandir todas las áreas, pulse la combinación de teclas <Ctrl+Mayús+Num*>.
3. Para contraer todas las áreas, pulse la combinación de teclas <Ctrl+Mayús+Num/>.
En función del ajuste de sincronización, todas las áreas se expandirán o contraerán en la vista
general de áreas, en la ventana de programación o en ambas.

Consulte también
Uso de áreas (Página 8153)
Insertar áreas (Página 8156)
Copiar y pegar áreas (Página 8157)
Borrar áreas (Página 8160)

16.4.5.5

Borrar áreas
Las áreas pueden volver a borrarse del código del programa en cualquier momento.

Procedimiento
Para borrar un área, proceda del siguiente modo:
1. Elimine del código del programa la palabra clave "REGION" y el nombre del área, si es que
había asignado uno.
2. Elimine del código del programa la palabra clave correspondiente "END_REGION".
El área se borrará del código del programa y de la vista general de áreas.
Nota
En cuanto haya borrado la palabra clave "REGION" o "END_REGION" del código del
programa, reconocerá la palabra clave correspondiente porque estará marcada con una
línea roja indicando un error de sintaxis.

Consulte también
Uso de áreas (Página 8153)
Insertar áreas (Página 8156)
Copiar y pegar áreas (Página 8157)
Navegar por las áreas (Página 8158)

8160

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

16.4.6

Definir el tipo de datos de una instrucción SCL

16.4.6.1

Principios básicos de los tipos de datos de instrucciones SCL

Introducción
Las instrucciones SCL que se emplean para programar los bloques utilizan tipos de datos
determinados para determinar el valor de la función. Entre ellas hay instrucciones SCL para las
que solo puede emplearse un tipo de datos concreto. En estas instrucciones no es posible
cambiar el tipo de datos. No obstante, la mayoría de las instrucciones SCL puede trabajar con
distintos tipos de datos. Se distinguen los dos tipos de instrucciones siguientes:
● Instrucciones en las que el tipo de datos del valor de la función queda determinado por el
tipo de datos de los parámetros de entrada. La mayoría de instrucciones son de este tipo.
● Instrucciones en las que el tipo de datos está predeterminado. Son las instrucciones que se
listan en la tabla inferior.
En el segundo grupo es necesario modificar el tipo de datos predeterminado cuando este
difiere del tipo de datos del parámetro de entrada utilizado. En principio es posible modificar el
tipo de datos con la sintaxis siguiente:
_<tipo de datos>

Instrucciones SCL con tipo de datos predeterminado
La tabla siguiente muestra las instrucciones SCL con tipos de datos predeterminados:
Instrucción

Tipo de datos predeterminado

CEIL

DINT

DECO

DWORD

FLOOR

DINT

NORM_X

REAL

PEEK

BYTE

SCALE_X

INT

TRUNC

DINT

CONCAT

STRING

T_DIFF

TIME

Consulte también
Modificar el tipo de datos de una instrucción SCL (Página 8162)
Ejemplo de modificación del tipo de datos de una instrucción SCL (Página 8163)

Programación del PLC
Manual de programación y manejo, 11/2019

8161

Creación de programas SCL
16.4 Entrada de instrucciones SCL

16.4.6.2

Modificar el tipo de datos de una instrucción SCL

Procedimiento
Para insertar una instrucción SCL y modificar a continuación su tipo de datos, proceda del
siguiente modo:
1. Arrastre la instrucción mediante Drag & Drop hasta la posición deseada del programa.
2. Indique los operandos para la instrucción.
El tipo de datos del valor de función se define de acuerdo con los parámetros de entrada o
bien se utiliza el tipo de datos predeterminado de la instrucción.
3. Complemente el nombre de la instrucción con "_<tipo de datos>".
"<tipo de datos>" es el tipo de datos que se requiere para la instrucción.

Consulte también
Principios básicos de los tipos de datos de instrucciones SCL (Página 8161)
Ejemplo de modificación del tipo de datos de una instrucción SCL (Página 8163)

16.4.6.3

Tipo de datos de temporizadores y contadores CEI
Los temporizadores y contadores CEI son bloques de función internos del sistema que
requieren un bloque de datos de instancia. El bloque de datos de instancia se puede crear
como instancia individual o como multiinstancia. El tipo de datos del bloque de datos de
instancia depende de la instrucción correspondiente. Sin embargo, en las CPU de las series
S7-1200 y S7-1500 es posible ejecutar las instrucciones con distintos tipos de datos para
adaptarlas a sus necesidades.
Si el tipo de datos ajustado para el bloque de datos de instancia no coincide con el tipo de datos
de los parámetros de entrada, se lleva a cabo una conversión implícita, si es posible. Si la
conversión no es posible, aparece un mensaje de error.

Procedimiento
Para modificar eltipo d edatos del bloque de datos de instancia de temporizadores o
contadores CEI, proceda del siguiente modo:
1. Abra el bloque en el que vaya a llamar al temporizador o contador CEI.
Dependiendo del tipo de instancia del bloque de datos de instancia, aparecerá un
rectángulo con borde verde delante (multiinstancia) o detrás (instancia individual) del
nombre del bloque de datos de instancia.
2. Haga clic en el rectángulo con el borde verde.
Se abrirá una lista desplegable con los tipos de datos posibles para el bloque de datos de
instancia.
3. Seleccione el tipo de datos que desee utilizar.

8162

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

16.4.6.4

Ejemplo de modificación del tipo de datos de una instrucción SCL

Modificación del tipo de datos predeterminado de la instrucción "Descodificar" (DECO)
Si se inserta la instrucción "Descodificar" en el programa, el tipo de datos DWORD ya estará
predeterminado.
"Tag_Result" := DECO(IN := "Tag_Value");
Para modificar el tipo de datos de DWORD a BYTE posteriormente, modifique el código de
programa del siguiente modo:
"Tag_Result_BYTE" := DECO_BYTE(IN := "Tag_Value");

Consulte también
Principios básicos de los tipos de datos de instrucciones SCL (Página 8161)
Modificar el tipo de datos de una instrucción SCL (Página 8162)

16.4.7

Mostrar u ocultar informaciones de variables

Introducción
Al margen de la representación absoluta o simbólica de los operandos, podrá mostrar u ocultar
los comentarios sencillos o jerárquicos para documentar las variables. Esta información se
recoge de la tabla de variables PLC.
Es posible visualizar la información de las variables para todos los bloques o solo para bloques
abiertos individuales. Si selecciona la información de variables para todos los bloques, se
muestra la información de las variables de todos los bloques abiertos actuales y futuros.
La información de las variables se puede volver a ocultar en cualquier momento. Si se ha
ocultado la información de las variables de todos los bloques, se puede volver a ver para
bloques abiertos individualmente.
Si se selecciona la visualización de información de variables con comentarios jerárquicos, en
el caso de las variables estructuradas también se muestran los comentarios de los niveles de
estructura de orden superior. En ese caso, esa información se muestra entre paréntesis
después del comentario de la variable, y los comentarios de los diferentes niveles se separan
con un punto. Si en un nivel de estructura no hay ningún comentario para una variable, el
comentario en cuestión no se visualiza, lo que puede reconocerse por dos puntos seguidos.

Mostrar u ocultar información de variables para todos los bloques
Para mostrar u ocultar la información de variables para todos los bloques, proceda del
siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.

Programación del PLC
Manual de programación y manejo, 11/2019

8163

Creación de programas SCL
16.4 Entrada de instrucciones SCL
3. Para visualizar la información de las variables, seleccione las opciones "Mostrar" o
"Información de la variable con jerarquía" en la lista desplegable "Información de la
variable", en función de si desea visualizar los comentarios sencillos o jerárquicos.
4. Para ocultar la información de las variables, seleccione la opción "Ocultar" en la lista
desplegable "Información de la variable".
La información de las variables se muestra u oculta para todos los bloques abiertos. Si abre
más bloques, la información de las variables se mostrará u ocultará dependiendo del ajuste
seleccionado.

Mostrar u ocultar información de variables para un bloque abierto
Para mostrar u ocultar la información de variables para un bloque abierto, proceda del
siguiente modo:
1. Para visualizar la información de las variables, seleccione las opciones "Mostrar
información de la variable" o "Información de la variable con jerarquía" en la lista
desplegable "Muestra información sobre la variable", en función de si desea visualizar los
comentarios sencillos o jerárquicos.
2. Para ocultar la información de las variables, seleccione la opción "Ocultar información de la
variable" en la lista desplegable "Muestra información sobre la variable".
Se muestra u oculta la información sobre las variables.

16.4.8

Utilizar Favoritos en SCL

16.4.8.1

Agregar instrucciones SCL a los Favoritos

Requisitos
● Hay un bloque abierto.
● La Task Card "Instrucciones" tiene configurado el modo multipaleta, o bien los Favoritos se
muestran también en el editor.

Procedimiento
Para agregar instrucciones a los Favoritos, proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. Maximice la paleta "Instrucciones básicas".
3. En la paleta "Instrucciones básicas", navegue hasta la instrucción que desea agregar a los
Favoritos.
4. Arrastre la instrucción hasta la paleta "Favoritos" o hasta el área de Favoritos del editor de
programación mediante Drag & Drop.

8164

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Sinopsis del editor de programación (Página 7657)
Inserción de instrucciones de SCL mediante Favoritos (Página 8165)
Eliminación de instrucciones SCL de los Favoritos (Página 8166)

16.4.8.2

Inserción de instrucciones de SCL mediante Favoritos

Requisitos
● Hay un bloque abierto.
● Existen Favoritos.

Procedimiento
Para insertar una instrucción en un programa desde los Favoritos, proceda del siguiente modo:
1. Arrastre la instrucción deseada mediante Drag & Drop desde los Favoritos hasta la posición
deseada.
O bien:
1. Marque el punto del programa en el que quiere insertar la instrucción.
2. En los Favoritos, haga clic en la instrucción que desea insertar.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Sinopsis del editor de programación (Página 7657)
Agregar instrucciones SCL a los Favoritos (Página 8164)
Eliminación de instrucciones SCL de los Favoritos (Página 8166)

Programación del PLC
Manual de programación y manejo, 11/2019

8165

Creación de programas SCL
16.4 Entrada de instrucciones SCL

16.4.8.3

Eliminación de instrucciones SCL de los Favoritos

Requisitos
Hay un bloque lógico abierto.

Procedimiento
Para eliminar instrucciones de los Favoritos, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la instrucción que desea eliminar.
2. Elija el comando "Eliminar instrucción" del menú contextual.
Nota
Para mostrar los Favoritos en el editor de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Sinopsis del editor de programación (Página 7657)
Agregar instrucciones SCL a los Favoritos (Página 8164)
Inserción de instrucciones de SCL mediante Favoritos (Página 8165)

8166

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

16.4.9

Inserción de llamadas de bloque en SCL

16.4.9.1

Principios básicos de la llamada de bloque en SCL

Llamada de bloques de función
Sintaxis de una llamada
Para llamar un bloque de función como instancia individual o multiinstancia se utiliza la
siguiente sintaxis:
● Instancia individual:
– Si el bloque de función procede del proyecto:
<NombreDB> (lista de parámetros)
– Si el bloque de función procede de la Task Card "Instrucciones":
<NombreDB>.<NombreInstrucción> (lista de parámetros)
o
<NombreInstrucción> (lista de parámetros)
● Multiinstancia
<#NombreInstancia> (lista de parámetros)

Llamada como instancia individual o multiinstancia
Los bloques de función se pueden llamar como instancia individual o como multiinstancia.
● Llamada como instancia individual
El bloque de función llamado almacena sus datos en un bloque de datos propio.
● Llamada como multiinstancia
El bloque de función llamado almacena sus datos en el bloque de datos de instancia del
bloque de función que lo llama.
Encontrará más información sobre los tipos de llamada en "Consulte también".

Llamadas de bloque recursivas
Existe la posibilidad de llamar un bloque de forma recursiva. Eso significa que un bloque puede
llamarse a sí mismo. Recuerde que la profundidad de llamada está limitada a 24 y que no
pueden utilizarse multiinstancias.

Lista de parámetros
Si llama otro bloque lógico desde un bloque SCL, deberá indicar los parámetros actuales de
los parámetros formales del bloque llamado.
La entrada de los parámetros es análoga a una asignación de valor. Mediante esta asignación
de valor, asigna un valor (parámetro actual) a los parámetros que ha definido en el bloque
llamado.

Programación del PLC
Manual de programación y manejo, 11/2019

8167

Creación de programas SCL
16.4 Entrada de instrucciones SCL
Los parámetros formales del bloque lógico llamado se listan entre paréntesis directamente
después de la llamada. Los parámetros de entrada y de entrada/salida tienen el identificador
de asignación ":=", mientras que los parámetros de salida tienen el identificador de asignación
"=>". Un comodín detrás del parámetro indica el tipo de datos necesario y el tipo de parámetro.

Reglas sobre la transferencia de valores de parámetros
Se aplican las siguientes reglas a la transferencia de valores de parámetros:
● Como parámetros actuales se pueden usar constantes, variables y expresiones.
● Se puede elegir cualquier orden para las asignaciones.
● El tipo de datos de los parámetros formal y actual debe coincidir. Para el parámetro actual
también pueden utilizarse tipos de datos con los que sea posible una conversión implícita
al tipo de datos del parámetro formal.
● Las asignaciones individuales se han de separar mediante una coma.
● Si el bloque llamado solo tiene un parámetro, es suficiente con indicar el parámetro actual
entre paréntesis. No es necesario indicar el parámetro formal.

Consulte también
Inserción manual de llamadas de bloque (Página 8172)
Insertar llamadas de bloque mediante Drag & Drop (Página 8174)
Ejemplos de la llamada de un bloque de función en SCL (Página 8170)
Llamadas de bloque (Página 59)
Utilizar y direccionar operandos (Página 95)

Llamada de funciones
Sintaxis de una llamada
Para llamar una función se utiliza la siguiente sintaxis:
<nombre de la función> (lista de parámetros);
//Llamada estándar
<operando>:=<nombre de la función> (lista de parámetros); // Llamada
en una expresión

Valor de función
Las funciones que devuelven un valor de retorno se pueden utilizar en SCL en cualquier
expresión en lugar de un operando. Por eso en SCL el valor de retorno también se denomina
"valor de función".
Las posibilidades de llamada de funciones en SCL dependen de si la función devuelve un valor
de función al bloque que efectúa la llamada.
El valor de función se define en el parámetro RET_VAL. Si el parámetro RET_VAL es del tipo
de datos VOID, la función no devuelve ningún valor al bloque que efectúa la llamada. Si el

8168

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL
parámetro RET_VAL es de otro tipo de datos, la función devuelve un valor de función de este
tipo de datos.
Para el parámetro RET_VAL se admiten en SCL todos los tipos de datos excepto ANY,
ARRAY, STRUCT y VARIANT, así como los tipos de parámetros TIMER y COUNTER.

Posibilidades de llamada
Existen dos llamadas de función posibles en SCL:
● Llamada estándar de funciones con y sin valor de función
En una llamada estándar los resultados de la función están disponibles como parámetros
de salida y de entrada/salida.
● Llamada en una expresión de funciones con valor de función
Las funciones que devuelven un valor de función se pueden utilizar en cualquier expresión
en lugar de utilizar un operando (p. ej. en una asignación de valor).
La función calcula el valor de función, que tiene el mismo nombre de la función, y lo
transmite al bloque que efectúa la llamada. Allí el valor sustituye a la llamada de función.
Después de la llamada, los resultados de la función están disponibles como valor de
función o como parámetro de salida y de entrada/salida.

Llamadas de bloque recursivas
Existe la posibilidad de llamar un bloque de forma recursiva. Eso significa que un bloque puede
llamarse a sí mismo. Recuerde que la profundidad de llamada está limitada a 24 y que no
pueden utilizarse multiinstancias.

Lista de parámetros
Si llama otro bloque lógico desde un bloque SCL, tiene que indicar los parámetros actuales de
los parámetros formales del bloque llamado.
La entrada de los parámetros es análoga a una asignación de valor. Mediante esta asignación
de valor, asigna un valor (parámetro actual) a los parámetros que ha definido en el bloque
llamado.
Los parámetros formales del bloque lógico llamado se listan entre paréntesis directamente
después de la llamada. Los parámetros de entrada y de entrada/salida tienen el identificador
de asignación ":=", mientras que los parámetros de salida tienen el identificador de asignación
"=>". Un comodín sobre fondo gris detrás del parámetro indica el tipo de datos necesario y el
tipo de parámetro.

Reglas sobre la transferencia de valores de parámetros
Se aplican las siguientes reglas para la transferencia de valores a los parámetros de funciones:
● Todos los parámetros de la función deben recibir valores.
● Se puede elegir cualquier orden para las asignaciones.
● Como parámetros actuales se pueden usar constantes, variables y expresiones.

Programación del PLC
Manual de programación y manejo, 11/2019

8169

Creación de programas SCL
16.4 Entrada de instrucciones SCL
● El tipo de datos de los parámetros formal y actual debe coincidir. Para el parámetro actual
también pueden utilizarse tipos de datos con los que sea posible una conversión implícita
al tipo de datos del parámetro formal.
● Las asignaciones individuales se han de separar mediante una coma.
● Si el bloque llamado solo tiene un parámetro, es suficiente con indicar el parámetro actual
entre paréntesis. No es necesario indicar el parámetro formal.
● Cuando se llaman funciones en SCL, no se puede utilizar el mecanismo de habilitación
mediante EN. En su lugar, utilice una instrucción IF para la llamada condicional de
funciones.

Consulte también
Inserción manual de llamadas de bloque (Página 8172)
Insertar llamadas de bloque mediante Drag & Drop (Página 8174)
Ejemplos de la llamada de funciones en SCL (Página 8171)
Llamadas de bloque (Página 59)
Utilizar y direccionar operandos (Página 95)

Ejemplos de la llamada de un bloque de función en SCL
Llamada como instancia individual
El siguiente ejemplo muestra la llamada de un FB como instancia individual:
SCL
// Llamada como instancia individual
"MyDB" (MyInput:=10, MyInout:= "Tag1");

Resultado
Después de ejecutar la llamada, en el bloque de datos "MyDB" queda disponible el valor
determinado en "Tag1" para el parámetro de entrada/salida "MyInout".

Llamada como multiinstancia
En el siguiente ejemplo se muestra la llamada de un FB como multiinstancia:
SCL
// Llamada como multiinstancia
#MyFB (MyInput:= 10, MyInout:= "Tag1");

8170

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Resultado
Después de ejecutar el bloque "#MyFB" queda disponible el valor determinado para el
parámetro de entrada/salida "MyInout""#MyFB" en "Tag1" en el bloque de datos del bloque
lógico que efectúa la llamada.

Consulte también
Llamada de bloques de función (Página 8167)
Inserción manual de llamadas de bloque (Página 8172)
Insertar llamadas de bloque mediante Drag & Drop (Página 8174)
Llamadas de bloque (Página 59)
Utilizar y direccionar operandos (Página 95)

Ejemplos de la llamada de funciones en SCL
Llamada estándar
El siguiente ejemplo muestra una llamada de función estándar:
SCL
// Llamada de función estándar
"MyFC" (MyInput := 10, MyInOut := "Tag1");

Resultado
Después de ejecutar el bloque "MyFC", queda disponible el valor determinado en "Tag1" para
el parámetro de entrada/salida "MyInOut" en el bloque invocante, donde debe procesarse.

Llamada en una asignación de valor
El siguiente ejemplo muestra una llamada de función en una asignación de valor:
SCL
(*Llamada en una asignación de valor; se ha definido un valor de función
para "MyFC" *)
#MyOperand := "MyFC" (MyInput1 := 3, MyInput2 := 2, MyInput3 := 8.9,
MyInOut := "Tag1");

Resultado
El valor de función de "MyFC" se transmite a "#MyOperand".

Programación del PLC
Manual de programación y manejo, 11/2019

8171

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Llamada en una expresión aritmética
El siguiente ejemplo muestra una llamada de función en una expresión aritmética:
SCL
(*Llamada en una expresión aritmética; se ha definido un valor de función
para "MyFC" *)
#MyOperand := "Tag2" + "MyFC" (MyInput1 := 3, MyInput2 := 2, MyInput3 :=
8.9);

Resultado
El valor de función de "MyFC" se suma a "Tag2" y el resultado se transmite a "MyOperand".

Consulte también
Llamada de funciones (Página 8168)
Inserción manual de llamadas de bloque (Página 8172)
Insertar llamadas de bloque mediante Drag & Drop (Página 8174)

16.4.9.2

Inserción manual de llamadas de bloque
Podrá insertar llamadas para funciones (FC) y bloques de función (FB). Los bloques de función
pueden llamarse como instancia individual, multiinstancia o instancia de parámetro.
Consulte también: Principios básicos de las instancias (Página 61)

Insertar una llamada de una función (FC)
Para insertar una llamada de función, proceda del siguiente modo:
1. Introduzca el nombre de la función.
2. Confirme las entradas con la tecla Intro.
3. Pulse la combinación de teclas <Ctrl+BloqMayús+Barra espaciadora> o seleccione el
comando "Copiar" del menú contextual. Como alternativa también puede hacer clic en el
botón "Amplía/reduce la lista de parámetros de llamadas de bloque".
La sintaxis de la llamada de función, junto con la lista de parámetros, se inserta en el
programa SCL. Los comodines de los parámetros actuales se resaltan en color amarillo. Se
selecciona el primer comodín.
4. Sustituya el comodín por un parámetro actual. También puede arrastrar una variable de la
interfaz o la tabla de variables PLC mediante Drag & Drop hasta el comodín.
5. Navegue con la tecla <TAB> por los demás comodines y sustitúyalos por parámetros
actuales. Con <BloqueMayús + TAB> se puede navegar hasta el comodín anterior.

8172

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Insertar una llamada de un bloque de función (FB)
Para insertar una llamada de un bloque de función (FB), proceda del siguiente modo:
1. Introduzca el nombre del bloque de función.
2. Introduzca un paréntesis de apertura "(".
Se abre el cuadro de diálogo "Opciones de llamada".
3. Confirme las entradas con "Aceptar".
La sintaxis de la llamada del bloque de función, junto con la lista de parámetros, se inserta
en el programa SCL. Los comodines de los parámetros actuales se resaltan en color
amarillo. Se selecciona el primer comodín.
4. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Después de hacer clic en el botón de "Instancia individual", deberá indicar un nombre en
el cuadro de texto "Nombre" para el bloque de datos al cual se deberá asignar la llamada.
Si se llama un bloque que contenga supervisiones, asigne un bloque de función ProDiag
a dichas supervisiones en el campo de entrada "FB ProDiag".
– Si hace clic en el botón "Multiinstancia", introduzca a continuación en el cuadro de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.
5. Sustituya el comodín por un parámetro actual. También puede arrastrar una variable de la
interfaz o la tabla de variables PLC mediante Drag & Drop hasta el comodín.
6. Navegue con la tecla <TAB> por los demás comodines y sustitúyalos por parámetros
actuales. Con <BloqueMayús + TAB> se puede navegar hasta el comodín anterior.

Resultado
Se inserta la llamada de bloque.
Si al llamar un bloque de función especifica un bloque de datos de instancia que no existe aún,
éste se creará.

Consulte también
Actualización de llamadas de bloque (Página 8175)
Ampliar y reducir una lista de parámetros (Página 8177)
Principios básicos de la llamada de bloque en SCL (Página 8167)
Llamadas de bloque (Página 59)
Utilizar la función automática de autocompletar en los lenguajes de programación textuales
(Página 7684)

Programación del PLC
Manual de programación y manejo, 11/2019

8173

Creación de programas SCL
16.4 Entrada de instrucciones SCL

16.4.9.3

Insertar llamadas de bloque mediante Drag & Drop
Las llamadas de funciones (FC) y bloques de función (FB) existentes pueden insertarse desde
el árbol del proyecto mediante Drag & Drop.
Los bloques de función pueden llamarse como instancia individual, multiinstancia o instancia
de parámetro.
Consulte también: Principios básicos de las instancias (Página 61)

Requisitos
La función (FC) o el bloque de función (FB) que se va a llamar está disponible.

Insertar una llamada de una función (FC)
Para insertar una llamada de función mediante Drag & Drop, proceda del siguiente modo:
1. Arrastre la función desde el árbol del proyecto hasta el programa.
La sintaxis de la llamada de función, junto con la lista de parámetros, se inserta en el
programa SCL. Los comodines de los parámetros actuales se resaltan en color amarillo. Se
selecciona el primer comodín.
2. Sustituya el comodín por un parámetro actual. También puede arrastrar una variable de la
interfaz o la tabla de variables PLC mediante Drag & Drop hasta el comodín.
3. Navegue con la tecla <TAB> por los demás comodines y sustitúyalos por parámetros
actuales. Con <BloqueMayús + TAB> se puede navegar hasta el comodín anterior.

Insertar una llamada de un bloque de función (FB)
Para insertar una llamada de un bloque de función (FB) mediante Drag & Drop, proceda del
siguiente modo:
1. Arrastre el bloque de función desde el árbol del proyecto hasta el programa.
Se abre el cuadro de diálogo "Opciones de llamada".
2. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Después de hacer clic en el botón de "Instancia individual", deberá indicar un nombre en
el cuadro de texto "Nombre" para el bloque de datos al cual se deberá asignar la llamada.
Si se llama un bloque que contenga supervisiones, asigne un bloque de función ProDiag
a dichas supervisiones en el campo de entrada "FB ProDiag".
– Si hace clic en el botón "Multiinstancia", introduzca a continuación en el cuadro de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.

8174

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL
3. Confirme las entradas con "Aceptar".
La sintaxis de la llamada del bloque de función, junto con la lista de parámetros, se inserta
en el programa SCL. Los comodines de los parámetros actuales se resaltan en color
amarillo. Se selecciona el primer comodín.
4. Sustituya el comodín por un parámetro actual. También puede arrastrar una variable de la
interfaz o la tabla de variables PLC mediante Drag & Drop hasta el comodín.
5. Navegue con la tecla <TAB> por los demás comodines y sustitúyalos por parámetros
actuales. Con <BloqueMayús + TAB> se puede navegar hasta el comodín anterior.

Resultado
Se inserta la llamada de bloque.
Si al llamar un bloque de función especifica un bloque de datos de instancia que no existe aún,
éste se creará.

Consulte también
Actualización de llamadas de bloque (Página 8175)
Ampliar y reducir una lista de parámetros (Página 8177)
Principios básicos de la llamada de bloque en SCL (Página 8167)
Llamadas de bloque (Página 59)
Utilizar la función automática de autocompletar en los lenguajes de programación textuales
(Página 7684)

16.4.9.4

Actualización de llamadas de bloque
Si cambian los parámetros de interfaz de un bloque llamado, la llamada no podrá ejecutarse
correctamente. Actualice las llamadas de bloque con objeto de evitar llamadas incoherentes.

Programación del PLC
Manual de programación y manejo, 11/2019

8175

Creación de programas SCL
16.4 Entrada de instrucciones SCL
Las llamadas de bloque se pueden actualizar de distinta manera:
● Actualización explícita de todas las llamadas de bloque incoherentes en el editor de
programación.
Se actualizan las llamadas de bloque incoherentes del bloque abierto. Para ello se llevan
a cabo las acciones siguientes:
– Se agregan parámetros nuevos. Sin embargo, tenga en cuenta que en los bloques de
función (FB) se ocultan los parámetros y que los parámetros reciben sus valores del
bloque de datos de instancia (DB). En caso necesario se pueden visualizar los
parámetros con el comando de menú contextual "Mostrar todos los parámetros".
– Los parámetros borrados no se eliminan. Dado el caso, amplíe la lista de parámetros
para eliminar los parámetros borrados manualmente.
– Los parámetros cuyo nombre ha cambiado adoptan el nombre nuevo.
● Actualización explícita de una llamada de bloque en el editor de programación.
La llamada incoherente de este bloque se actualiza en los puntos de llamada. Para ello se
llevan a cabo las acciones siguientes:
– Se agregan parámetros nuevos.
– Los parámetros borrados no se eliminan. Dado el caso, amplíe la lista de parámetros
para eliminar los parámetros borrados manualmente.
– Los parámetros cuyo nombre ha cambiado adoptan el nombre nuevo.
● Actualización implícita durante la compilación.
Se actualizan todas las llamadas de bloque del programa, así como los tipos de datos PLC
utilizados. Tenga en cuenta que antes del proceso de compilación es necesario eliminar
manualmente los parámetros borrados y que al llamar funciones los parámetros formales
nuevos deberán dotarse de parámetros actuales.

Actualizar todas las llamadas de bloque incoherentes en el editor de programación
Para actualizar todas las llamadas de bloque en un bloque, proceda del siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic en el botón "Actualizar llamadas de bloque incoherentes" de la barra de
herramientas.
Se actualizan todas las llamadas incoherentes. Si es necesario, dote de parámetros
actuales a los nuevos parámetros formales de funciones (FC).

Actualizar una llamada de bloque determinada en el editor de programación
Para actualizar una llamada de bloque determinada en el editor de programación, proceda del
siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic con el botón derecho del ratón en la llamada de bloque que desea actualizar.
3. Elija el comando "Actualizar llamada de bloque" del menú contextual.
4. Si se han complementado parámetros, indique los valores para los parámetros de bloque
nuevos.

8176

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Nota
Tenga en cuenta que el comando "Actualizar llamada de bloque" no estará disponible si
previamente ha actualizado todas las llamadas de bloque en el editor con el comando
"Actualizar llamadas de bloque incoherentes".

Actualizar llamadas de bloque durante la compilación
Para actualizar implícitamente todas las llamadas de bloque y usos de tipos de datos PLC
durante la compilación, proceda del siguiente modo:
1. Abra el árbol del proyecto.
2. Seleccione la carpeta "Bloques de programa".
3. En el menú contextual, elija el comando "Compilar > Software (compilar todos los bloques)".

Consulte también
Inserción manual de llamadas de bloque (Página 8172)
Insertar llamadas de bloque mediante Drag & Drop (Página 8174)
Ampliar y reducir una lista de parámetros (Página 8177)

16.4.10

Ampliar y reducir una lista de parámetros
Si en SCL se llaman bloques o se insertan instrucciones que son bloques de función internos
del sistema, la sintaxis se inserta en el programa SCL, incluida la lista de parámetros con los
comodines para los parámetros actuales. Para una mejor claridad del código de programa, de
la lista de parámetros se retiran los parámetros opcionales no cableados al ejecutar otras
instrucciones. Sin embargo, se pueden volver a incluir en cualquier momento. Del mismo
modo, también es posible reducir explícitamente la lista de parámetros una vez finalizado el
cableado de los parámetros.

Ampliación de la lista de parámetros
Para ampliar la lista de parámetros, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la llamada de bloque o la instrucción.
2. En el menú contextual, elija el comando "Ampliar lista de parámetros" o pulse la
combinación de teclas <Ctrl+Mayús+Barra espaciadora>.
La lista de parámetros vuelve a mostrarse completa.

Programación del PLC
Manual de programación y manejo, 11/2019

8177

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Reducción de la lista de parámetros
Para reducir la lista de parámetros, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la llamada de bloque o la instrucción.
2. En el menú contextual, elija el comando "Reducir lista de parámetros" o pulse la
combinación de teclas <Ctrl+Mayús+Barra espaciadora>.
Todos los parámetros opcionales no cableados se ocultan.

Consulte también
Entrada manual de instrucciones SCL (Página 8150)
Inserción de instrucciones SCL desde la Task Card "Instrucciones" (Página 8151)
Inserción manual de llamadas de bloque (Página 8172)
Insertar llamadas de bloque mediante Drag & Drop (Página 8174)

16.4.11

Insertar pragmas
Existe la posibilidad de asignar el código del programa a determinadas valideces mediante
pragmas. Para ello, el código de programa debe encerrarse con palabras clave de pragma y
asignarse como mínimo un parámetro. También existe la opción de asignar otros parámetros
para definir el contenido. Tenga en cuenta que el carácter "$" sirve de secuencia de escape en
las constantes de string, por lo que no puede utilizarse como carácter normal para el nombre
del parámetro.
La sintaxis general para pragmas es la siguiente:

{PRAGMA_BEGIN 'Param1', 'Param2', ... , 'ParamN'}
//Código del programa
{PRAGMA_END}

También es posible anidar pragmas dentro de otros pragmas. Sin embargo, al hacerlo hay que
asegurarse de que los pragmas estén completamente encerrados dentro de otros pragmas.
Los pragmas pueden expandirse o contraerse según sea necesario.
Nota
Por el momento, los pragmas solo se evalúan en SiVArc. Para ello hay que asignar el
parámetro "SIVARC" y otro parámetro.
Para más información al respecto, consulte la ayuda de SiVArc.

Procedimiento
Para insertar un pragma, proceda del siguiente modo:
1. Sitúe el cursor en la posición en la que desea insertar un pragma.
2. Introduzca "{ PRAGMA_BEGIN".

8178

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.4 Entrada de instrucciones SCL
3. Introduzca por lo menos un parámetro entre comillas simples.
4. Introduzca todos los demás parámetros que desee entre comillas simples. Este paso es
opcional.
5. Introduzca "}".
6. Sitúe el cursor al final del código del programa que desee encerrar con el pragma.
7. Introduzca "{ PRAGMA_END}".
El código del programa se agrupa en un pragma.

16.4.12

Inserción de comentarios

Comentar el código de programa
Existen diferentes posibilidades para comentar programas SCL:
● Comentario de línea
Los comentarios de línea comienzan con "//" y se extienden hasta el final de la línea.
● Sección de comentario
Una sección de comentario se inicia con "(*" y se cierra con "*)". Esta sección puede abarcar
varias líneas.
● Comentarios multilingües
Los comentarios multilingües son comentarios que pueden traducirse a otros idiomas del
proyecto. Un comentario multilingüe se inicia con "(/*" y se cierra con "*/)", lo que lo
convierte en una unidad. Esto significa que, en cualquier caso, solo se puede marcar o
seleccionar el comentario entero y no partes por separado. Los comentarios multilingües no
pueden anidarse unos dentro de otros, pero pueden utilizarse dentro de comentarios de
líneas y secciones de comentarios. A diferencia de ello, no es posible emplear comentarios
de líneas o secciones de comentarios sencillas dentro de comentarios multilingües, ya que
todo lo incluido entre "(/*" y "*/)" se interpreta como texto normal.
Encontrará más información sobre "Multilingüe" en los siguientes capítulos:
– "Trabajar con proyectos multilingües"
– Edición de textos de proyectos multilingües en bloques (Página 7671)

Insertar comentarios de líneas
Para insertar un comentario de línea, proceda del siguiente modo:
1. Introduzca "//" en el punto en el que quiere poner el comentario. No tiene que ser el principio
de la línea.
2. Introduzca el texto del comentario.

Programación del PLC
Manual de programación y manejo, 11/2019

8179

Creación de programas SCL
16.4 Entrada de instrucciones SCL

Insertar sección de comentario
Para insertar una sección de comentario, proceda del siguiente modo:
1. Introduzca "(*" en el punto en el que quiere poner el comentario. No tiene que ser el principio
de la línea.
2. Introduzca el texto del comentario.
3. Cierre el comentario con "*)".
Como alternativa, también puede convertir a posteriori un código de programa existente en
una sección de comentarios:
1. Seleccione el código de programa que desea convertir en una sección de comentarios.
2. Haga clic con el botón derecho del ratón en el código de programa seleccionado.
3. Seleccione la entrada "(* *)" con el comando "Rodear con" del menú contextual. También
puede seleccionar la instrucción "(* *)" en la Task Card "Instrucciones", dentro de la paleta
"Instrucciones básicas > Control del programa".

Insertar comentario multilingüe
Para insertar un comentario multilingüe, proceda del siguiente modo:
1. Introduzca "(/*" en el punto en el que quiere poner el comentario multilingüe. No tiene que
ser el principio de la línea.
El editor insertará automáticamente el fin de comentario "*/)".
2. Introduzca el texto del comentario.

Desactivar una o varias líneas mediante comentarios
Para desactivar código del programa mediante comentarios, proceda del siguiente modo:
1. Seleccione las líneas de código que desea comentar.
2. Haga clic en el botón "Comenta las líneas seleccionadas" del editor.
En las líneas marcadas se inserta "//" al principio de la línea. El código siguiente se
interpreta como comentario. Si se desactivan líneas que ya tienen un comentario de línea,
también se inserta "//". Si a continuación se vuelven a activar las líneas, se mantendrán los
comentarios iniciales. Si la fila marcada solo contiene un comentario multilingüe, dicha fila
no se marca como comentario y no se inserta "//" al principio de la fila. En cambio, si
después del comentario multilingüe hay más código, la fila se marca como comentario a
partir del código. En este caso, "//" se inserta justo delante del código.

Activar líneas de comentario
Para volver a activar líneas de comentario como código, proceda del siguiente modo:
1. Seleccione las líneas de código que desea activar.
2. Haga clic en el botón "Eliminar comentario" del editor.
Se elimina el identificador "//" de los comentarios de líneas al principio de la línea.

8180

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.5 Edición de instrucciones SCL

Ejemplo
En el siguiente código se muestra la utilización de los distintos tipos de comentario:
(*************************************************************************************
Aquí se incluye una descripción de las siguientes instrucciones
**************************************************************************************)
IF "MyVal1" > 0 THEN //ninguna división entre 0
"MyReal" := "MyVal2" (* valor de entrada *) / "MyVal1" (* valor medido *);
END_IF;
(/*Conversión de tipos de datos*/)
//"MyInt" := REAL_TO_INT("MyReal2");
"MyInt" := REAL_TO_INT("MyReal");

Consulte también
(*...*): Insertar sección de comentario (Página 1968)
Encerrar el código de programa con elementos de estructura (Página 8152)
(/*...*/): Insertar comentario multilingüe (Página 1969)
(/*...*/): Insertar comentario multilingüe (Página 5630)

16.5

Edición de instrucciones SCL

16.5.1

Selección de instrucciones
Es posible seleccionar instrucciones individuales o todas las instrucciones de un bloque.

Requisitos
Hay un bloque SCL abierto.

Selección de instrucciones individuales
Para seleccionar instrucciones individuales, proceda del siguiente modo:
1. Inserte la marca de inserción delante del primer carácter que quiere marcar.
2. Pulse y mantenga oprimido el botón izquierdo del ratón.
3. Desplace el puntero del ratón detrás del último carácter que quiere marcar.
4. Suelte el botón izquierdo del ratón.

Programación del PLC
Manual de programación y manejo, 11/2019

8181

Creación de programas SCL
16.5 Edición de instrucciones SCL

Selección de todas las instrucciones de un programa
Para seleccionar todas las instrucciones, proceda del siguiente modo:
1. Seleccione en el menú "Edición" el comando "Seleccionar todo" o use la combinación de
teclas <Ctrl+A>.
Nota
Si marca la palabra clave de apertura de una instrucción, se marca automáticamente la palabra
clave de cierre.

16.5.2

Copiar, cortar y pegar instrucciones

Copiar instrucciones
Para copiar una instrucción, proceda del siguiente modo:
1. Marque la instrucción que quiere copiar.
2. Elija el comando "Copiar" del menú contextual.

Cortar instrucciones
Para cortar una instrucción, proceda del siguiente modo:
1. Marque la instrucción que quiere cortar.
2. Seleccione el comando "Cortar" del menú contextual.

Insertar instrucciones desde el portapapeles
Para insertar una instrucción desde el portapapeles, proceda del siguiente modo:
1. Copie o corte una instrucción.
2. Haga clic en la posición en la que desea insertar la instrucción.
3. Elija el comando "Pegar" del menú contextual.

16.5.3

Borrado de instrucciones

Requisitos
Hay un bloque SCL abierto.

8182

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.6 Ejemplos de programación SCL

Procedimiento
Para borrar una instrucción, proceda del siguiente modo:
1. Marque la instrucción que quiere borrar.
2. Elija el comando "Borrar" del menú contextual.

16.6

Ejemplos de programación SCL

16.6.1

Ejemplo de control de una cinta transportadora

Control de una cinta transportadora
La figura siguiente muestra una cinta transportadora que se pone en marcha eléctricamente.
Al comienzo de la cinta transportadora se encuentran dos pulsadores, S1 para MARCHA y S2
para PARO. Al final de la cinta transportadora se encuentran otros dos pulsadores, S3 para
MARCHA y S4 para PARO. La cinta transportadora puede ponerse en marcha o pararse desde
cualquiera de ambos extremos.
6
6

20DUFKD
23DUR

6 20DUFKD
6 23DUR

02725B21

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Operando

Declaración

Tipo de datos

Descripción

Marcha_izquierda (S1)

Input

BOOL

Pulsador de marcha en
el extremo izquierdo de
la cinta transportadora

Paro_izquierda (S2)

Input

BOOL

Pulsador de paro en el
extremo izquierdo de la
cinta transportadora

Marcha_derecha (S3)

Input

BOOL

Pulsador de marcha en
el extremo derecho de
la cinta transportadora

Programación del PLC
Manual de programación y manejo, 11/2019

8183

Creación de programas SCL
16.6 Ejemplos de programación SCL
Operando

Declaración

Tipo de datos

Descripción

Paro_derecha (S4)

Input

BOOL

Pulsador de paro en el
extremo derecho de la
cinta transportadora

MOTOR_ON

Output

BOOL

Conectar el motor de la
cinta transportadora

MOTOR_OFF

Output

BOOL

Desconectar el motor
de la cinta transportado‐
ra

El siguiente programa SCL muestra cómo realizar la tarea:
SCL
IF "Marcha_izquierda_S1" OR "Marcha_derecha_S3" THEN
"MOTOR_ON" := 1;
"MOTOR_OFF" := 0;
END_IF;
IF "Paro_izquierda_S2" OR "Paro_derecha_S4" THEN
"MOTOR_ON" := 0;
"MOTOR_OFF" := 1;
END_IF;

El motor de la cinta transportadora se enciende cuando se acciona el pulsador de marcha
"Marcha_izquierda_S1" o "Marcha_derecha_S3". El motor de la cinta transportadora se apaga
cuando se acciona el pulsador de paro "Paro_izquierda_S2" o "Paro_derecha_S4".

Consulte también
Expresiones lógicas (Página 8125)
Principios básicos de SCL (Página 8115)
Configuración de SCL (Página 8138)
La ventana de programación de SCL (Página 8140)
Entrada de instrucciones SCL (Página 8149)
Edición de instrucciones SCL (Página 8181)

8184

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.6 Ejemplos de programación SCL

16.6.2

Ejemplo de detección del sentido de marcha de una cinta transportadora

Detección del sentido de marcha de una cinta transportadora
El sentido de marcha detectado de la cinta transportadora se indica con una flecha DERECHA
o una flecha IZQUIERDA. Si se está transportando otro objeto desde la derecha a BF1 o desde
la izquierda a BF2, primero se desconectará la flecha indicada hasta que, tras pasar por las dos
barreras fotoeléctricas, se detecte nuevamente el sentido de marcha y pueda indicarse la
flecha correspondiente. Para solucionar la tarea se requieren además dos marcas de flanco
que detecten el cambio de señal en las dos barreras fotoeléctricas de "0" a "1".
%)

%)

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Descripción

Barrera fotoeléctrica
BF1

Input

BOOL

Barrera fotoeléctrica 1

Barrera fotoeléctrica
BF2

Input

BOOL

Barrera fotoeléctrica 2

DERECHA

Output

BOOL

Indicador de desplaza‐
miento a la derecha

IZQUIERDA

Output

BOOL

Indicador de desplaza‐
miento a la izquierda

Marca auxiliar BF1

Input

BOOL

Marca de flancos 1

Marca auxiliar BF2

Input

BOOL

Marca de flancos 2

El siguiente programa SCL muestra cómo realizar el ejemplo:
SCL
// Código para marcha a la izquierda
IF "Barrera fotoeléctrica BF1" = 1 AND "Marca auxiliar BF2" = 0 THEN
"Marca auxiliar BF1" := 1; // activar marca auxiliar para BF1 setzen
"IZQ" := 0; // desactivar indicador flecha izquierda
"DCHA" := 0; // desactivar indicador flecha derecha
END_IF;

Programación del PLC
Manual de programación y manejo, 11/2019

8185

Creación de programas SCL
16.6 Ejemplos de programación SCL
SCL
IF "Marca auxiliar BF1" = 1 AND "Barrera fotoeléctrica BF2" = 1 THEN // La cinta
transportadora se mueve a la izquierda
"IZQ" = 1;
"DCHA" := 0;
END_IF;
IF "IZQ" = 1 AND "Barrera fotoeléctrica BF2" = 0 THEN // desactivar marca auxiliar para BF1
"Marca auxiliar BF1" := 0;
END_IF;

SCL
// Código para marcha a la derecha
IF "Barrera fotoeléctrica BF2" = 1 AND "Marca auxiliar BF1" = 0 THEN
"Marca auxiliar BF2" := 1; // activar marca auxiliar para BF2 setzen
"IZQ" := 0; // desactivar indicador flecha izquierda
"DCHA" := 0; // desactivar indicador flecha derecha
END_IF;
IF "Marca auxiliar BF2" = 1 AND "Barrera fotoeléctrica BF1" = 1 THEN // La cinta
transportadora se mueve a la derecha
"IZQ" := 0;
"DCHA" := 1;
END_IF;
IF "DCHA" = 1 AND "Barrera fotoeléctrica BF1" = 0 THEN // desactivar marca auxiliar para BF2
"Marca auxiliar BF2" := 0;
END_IF;

Si el estado lógico de la barrera fotoeléctrica "BF1"es "1" y, simultáneamente, el estado lógico
de la barrera fotoeléctrica "BF2" es "0", el objeto se desplaza hacia la izquierda sobre la cinta
transportadora. Si el estado lógico de la barrera fotoeléctrica "BF2"es "1" y, simultáneamente,
el estado lógico de la barrera fotoeléctrica "BF1" es "0", el objeto se desplaza hacia la derecha
sobre la cinta transportadora. Los indicadores de desplazamiento hacia la izquierda se apagan
cuando el estado lógico de ambas barreras fotoeléctricas es "0".

Consulte también
Expresiones lógicas (Página 8125)
Principios básicos de SCL (Página 8115)
Configuración de SCL (Página 8138)
La ventana de programación de SCL (Página 8140)
Entrada de instrucciones SCL (Página 8149)
Edición de instrucciones SCL (Página 8181)

8186

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.6 Ejemplos de programación SCL

16.6.3

Ejemplo de detección del nivel de llenado de una zona de almacén

Detección del nivel de llenado de una zona de almacén
La figura siguiente muestra un sistema con dos cintas transportadoras y una zona de almacén
temporal situada entre ambas. La cinta transportadora 1 transporta paquetes a la zona de
almacén. Una barrera fotoeléctrica situada al final de la cinta transportadora 1 junto a la zona
de almacén determina cuántos paquetes se transportan a dicha zona. La cinta transportadora
2 transporta paquetes desde esta zona de almacén temporal a una plataforma de carga, desde
la que los paquetes se cargan en camiones. Una barrera fotoeléctrica situada al final de la zona
de almacén determina cuántos paquetes deben transportarse desde allí hasta la plataforma de
carga. Cinco indicadores luminosos indican el nivel de llenado de la zona de almacén temporal.
&RQVRODGHLQGLFDGRUHV

=RQDGHDOPDF«Q =RQDGHDOPDF«Q
YDF¯D
QRYDF¯D

3DTXHWHV
HQWUDQWHV

=RQDGHDOPDF«Q
OOHQDDO

=RQDGHDOPDF«Q
OOHQDDO

3DTXHWHV
VDOLHQWHV

=RQDGHDOPDF«Q
WHPSRUDO
SDUD
SDTXHWHV

&LQWDWUDQVSRUWDGRUD

=RQDGHDOPDF«Q
OOHQD

&LQWDWUDQVSRUWDGRUD

%DUUHUDIRWRHO«FWULFD

%DUUHUDIRWRHO«FWULFD

Realización
La tabla siguiente muestra la definición de las variables utilizadas:
Nombre

Declaración

Tipo de datos

Descripción

BF1

Input

BOOL

Barrera fotoeléctrica 1

BF2

Input

BOOL

Barrera fotoeléctrica 2

RESET

Input

BOOL

Inicializar contador

LOAD

Input

BOOL

Adaptar el valor actual
del contador al valor del
parámetro PV.

CAPACIDAD MAX AL‐
MACEN

Input

INT

Número máximo posi‐
ble de paquetes en al‐
macén

PAQUETES

Output

INT

Número de paquetes
en la zona de almacén
(valor de contaje actual)

Programación del PLC
Manual de programación y manejo, 11/2019

8187

Creación de programas SCL
16.6 Ejemplos de programación SCL
Nombre

Declaración

Tipo de datos

Descripción

PAQUETES_ZA

Output

BOOL

Se activa si el valor ac‐
tual del contador es ma‐
yor o igual al valor de la
variable "CAPACIDAD
MAX ALMACEN".

ALM_VACIO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén vacía

ALM_NO_VACIO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén no vacía

ALM_LLENO_50%

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena al
50 %

ALM_LLENO_90%

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena al
90 %

ALM_LLENO

Output

BOOL

Indicador luminoso: Zo‐
na de almacén llena

VOLUMEN_50

Input

INT

Valor de comparación:
50 paquetes

VOLUMEN_90

Input

INT

Valor de comparación:
90 paquetes

VOLUMEN_100

Input

INT

Valor de comparación:
100 paquetes

El siguiente programa SCL muestra cómo realizar el ejemplo:
Cuando un paquete se transporta a la zona de almacén, el estado lógico de "BF1" cambia de
"0" a "1" (flanco de señal ascendente). Cuando se produce un flanco ascendente en "BF1", el
contador ascendente se activa y el valor de contaje actual de "PAQUETES" aumenta en uno.
Cuando un paquete se transporta de la zona de almacén a la plataforma de carga, el estado
lógico de "BF2" cambia de "0" a "1" (flanco ascendente). Cuando se produce un flanco
ascendente en "BF2", el contador descendente se activa y el valor actual de "PAQUETES" se
reduce en uno.
Si no hay paquetes en la zona de almacén ("PAQUETES" = "0"), la variable "ALM_VACIO"
adopta el estado lógico "1" y se enciende el indicador luminoso "Zona de almacén vacía".
El valor de contaje actual puede ponerse a "0" si la variable "RESET" adopta el estado lógico
"1".
Cuando la variable "LOAD" adopta el estado lógico "1", el valor actual del contador se pone al
valor de la variable "CAPACIDAD MAX ALMACEN". Mientras el valor de contaje actual sea
mayor o igual al valor de la variable "CAPACIDAD MAX ALMACEN", la variable
"PAQUETES_ZA" devolverá el estado lógico "1".
SCL
"VOLUMEN_50" := 5; // inicializar el valor de comparación a 50 paquetes (para el test solo
5 paquetes)
"VOLUMEN_90" := 9; // inicializar el valor de comparación a 90 paquetes (para el test solo
9 paquetes)
"VOLUMEN_100" := 10; // inicializar el valor de comparación a 100 paquetes (para el test
solo 10 paquetes)

8188

Programación del PLC
Manual de programación y manejo, 11/2019

Creación de programas SCL
16.6 Ejemplos de programación SCL
SCL
"CAPACIDAD MAX ALMACEN" := 10; // inicializar la cantidad máxima de existencias en almacén
a 100 paquetes (para el test solo 10 paquetes)
"IEC_Counter_0_DB".CTUD(CU := "BF1",
CD := "BF2",
R := "RESET",
LD := "LOAD",
PV := "CAPACIDAD MAX ALMACEN",
QU := "PAQUETES_ZA",
QD => "ALM_VACIO",
CV => "PAQUETES");

Mientras haya paquetes en la zona de almacén, el indicador luminoso "Zona de almacén no
vacía" permanecerá iluminado.
SCL
"ALM_NO_VACIO" := NOT "ALM_VACIO"

Cuando el número de paquetes que se encuentran en la zona de almacén es menor que 50%,
se apagan los indicadores luminosos del aviso "Zona de almacén llena al 50 %", "Zona de
almacén llena al 90%" y "Zona de almacén llena".
SCL
IF "PAQUETES" < "VOLUMEN_50" THEN
"ALM_LLENO_50% := 0;
"ALM_LLENO_90% := 0;
"ALM_LLENO" := 0;
END_IF;

Si el número de paquetes que se encuentran en la zona de almacén es mayor o igual a 50%,
se encenderá el indicador luminoso para el aviso "Zona de almacén llena al 50 %".
SCL
IF "PAQUETES" >= "VOLUMEN_50" AND "PAQUETES" <= "VOLUMEN_90" THEN
"ALM_LLENO_50% := 1;
"ALM_LLENO_90% := 0;
"ALM_LLENO" := 0;
END_IF;

Si el número de paquetes que se encuentran en la zona de almacén es mayor o igual a 90%,
se encenderá el indicador luminoso para el aviso "Zona de almacén llena al 90%". El indicador
de lleno al 50% también permanece encendido.
SCL
IF "PAQUETES" >= "VOLUMEN_90" AND "PAQUETES" <= "VOLUME_100" THEN
"ALM_LLENO_50% := 1;
"ALM_LLENO_90% := 1;
"ALM_LLENO" := 0;
END_IF;

Programación del PLC
Manual de programación y manejo, 11/2019

8189

Creación de programas SCL
16.6 Ejemplos de programación SCL
Si el número de paquetes que se encuentran en la zona de almacén alcanza el 100%, se
enciende el indicador luminoso para el aviso "Zona de almacén llena". Los indicadores de lleno
al 50% y al 90% también permanecen encendidos.
SCL
IF "PAQUETES" >= "VOLUMEN_100" THEN
"ALM_LLENO_50% := 1;
"ALM_LLENO_90% := 1;
"ALM_LLENO" := 1;
END_IF;

Consulte también
Principios básicos de SCL (Página 8115)
Configuración de SCL (Página 8138)
La ventana de programación de SCL (Página 8140)
Entrada de instrucciones SCL (Página 8149)
Edición de instrucciones SCL (Página 8181)

8190

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1

Principios básicos de GRAPH

17.1.1

Lenguaje de programación GRAPH

17

Resumen
GRAPH es un lenguaje de programación gráfico para crear controles secuenciales. Permite
programar controles secuenciales de manera clara y rápida utilizando cadenas secuenciales.
El proceso se descompone en etapas individuales con un alcance funcional delimitable y se
organiza en las cadenas secuenciales. En las etapas individuales se determinan las acciones
que se deben ejecutar. El paso entre las etapas lo forman las transiciones. Estas contienen
condiciones para pasar a la etapa siguiente.

Bloques del control secuencial
Un control secuencial controla el proceso en un orden predeterminado y en función de ciertas
condiciones. La complejidad del control secuencial depende de la tarea de automatización. Un
control secuencial está formado siempre por tres bloques como mínimo:
● Bloque de función GRAPH
En el bloque de función GRAPH se describen las diferentes etapas y transiciones del
control secuencial dentro de una o varias cadenas secuenciales.
● Bloque de datos de instancia
El bloque de datos de instancia contiene los datos y parámetros del control secuencial. Está
asignado al bloque de función GRAPH y puede ser generado por el sistema
automáticamente.
● Bloque lógico que efectúa la llamada
Para que el bloque de función GRAPH pueda ejecutarse dentro del ciclo, debe ser llamado
por un bloque lógico de nivel superior. Dicho bloque puede ser un bloque de organización
(OB), una función (FC) u otro bloque de función (FB). El bloque de función GRAPH se llama
siempre como instancia individual.
La figura siguiente muestra la colaboración entre los bloques en un control secuencial:

Programación del PLC
Manual de programación y manejo, 11/2019

8191

Crear programas GRAPH
17.1 Principios básicos de GRAPH


2%)%)&



0\)%

0\'%



&RPHQWDULR

&$//0\)%
0\'%
6
7
6
7

① Bloque que efectúa la llamada
② Bloque de función GRAPH
③ Bloque de datos de instancia
El ciclo de un bloque de función GRAPH está definido por el ciclo del bloque que efectúa la
llamada. En cada ciclo del bloque de función GRAPH se ejecutan en primer lugar las
instrucciones permanentes anteriores. Seguidamente se procesan las acciones de las etapas
activas. Por último se ejecutan las instrucciones permanentes posteriores.
Nota
Tenga en cuenta las indicaciones siguientes:
● Las instrucciones permanentes se ejecutan en cada ciclo, aunque no haya ninguna etapa
activa.
● Debido a su funcionalidad, los bloques GRAPH requieren un tiempo de ejecución mayor en
la CPU. Esto se debe a los siguientes factores:
- diagnóstico implícito adicional
- codificación integrada de la secuencia
- modos de operación implementados para la ejecución de la cadena secuencial

Consulte también
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)

8192

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Acciones (Página 8201)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.2

Cadenas secuenciales

17.1.2.1

Principios básicos de las cadenas secuenciales

Introducción
Dentro de un bloque de función GRAPH es posible programar el programa en forma de
cadenas secuenciales. Las cadenas secuenciales pueden procesar tareas independientes,
aunque también es posible descomponer una tarea compleja en varias cadenas secuenciales.
Si las cadenas secuenciales procesan tareas independientes se procesarán paralelamente en
la secuencia del programa. Si se utilizan varias cadenas secuenciales para descomponer una
tarea compleja en segmentos más pequeños, habrá que enlazar las cadenas secuenciales
relacionadas con saltos.
En una cadena secuencial, el programa se divide en etapas individuales. En casos sencillos,
las etapas se procesan linealmente una tras otra. No obstante, el uso de ramas alternativas o
simultáneas permite generar también cadenas secuenciales con estructuras más complejas.
El procesamiento del programa empieza siempre con una etapa definida como etapa inicial.
Una cadena secuencial puede tener una o varias etapas iniciales. Las etapas iniciales pueden
ocupar cualquier posición dentro de la cadena secuencial.
Cuando una etapa está activa se ejecutan sus acciones. También existe la posibilidad de que
varias etapas estén activas al mismo tiempo, p. ej. dentro de una rama simultánea. Mientras
una etapa está activa se comprueban continuamente las condiciones de la transición
siguiente. En cuanto se cumplen todas las condiciones y no hay ningún error de supervisión
pendiente, la transición pasa a la etapa siguiente. Ahora, esta es la etapa activa. Una cadena
secuencial puede terminarse con un salto o con un fin de cadena. Con un salto se pasa a
cualquier otra etapa de la misma cadena secuencial o de otra distinta. Esto permite procesar
cíclicamente la cadena secuencial.

Principio de procesamiento de una cadena secuencial
El procesamiento de una cadena secuencial empieza activando la o las etapas iniciales de la
cadena. Solo se admiten varias etapas iniciales en ramas simultáneas. Mientras una etapa
está activa se ejecutan sus acciones. Para ello se tienen en cuenta las condiciones de interlock
para las diferentes acciones. Una vez que se han ejecutado todas las acciones posibles, se
comprueba ante todo si hay algún error de supervisión pendiente. En caso negativo y si
además se cumple la transición siguiente, se activa la próxima etapa de la cadena. En caso de
haber un error de supervisión o de que no se cumpla la transición, la etapa en cuestión se
mantiene activa hasta que se haya solucionado el error o se cumpla la transición, según
corresponda. Al final de una cadena secuencial existe la posibilidad de procesar cíclicamente
la cadena secuencial mediante saltos o bien de finalizarla con un fin de cadena.

Programación del PLC
Manual de programación y manejo, 11/2019

8193

Crear programas GRAPH
17.1 Principios básicos de GRAPH

Consulte también
Elementos de una cadena secuencial (Página 8194)
Programar la estructura de una cadena secuencial (Página 8257)
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.2.2

Elementos de una cadena secuencial

Resumen
La tabla siguiente muestra los posibles elementos de una cadena secuencial y sus símbolos:
Símbolo

Nombre
Etapa y transición (Página 8198)
Etapa (Página 8198)
Transición (Página 8198)
Rama simultánea
Rama alternativa
Cerrar rama
Salto a etapa
Fin de cadena

Rama simultánea
Las ramas simultáneas permiten programar ramas Y. Esto significa que con una transición se
activan varias etapas cuyas acciones se ejecutarán a continuación. Por ese motivo, las ramas
simultáneas empiezan siempre con una etapa.
Las transiciones posteriores de las ramas simultáneas se encuentran en la rama principal, de
modo que las diferentes ramas simultáneas pueden cerrarse en diferentes puntos de la rama
principal. Tenga en cuenta que las ramas que se agrupan en una transición no se conmutarán
hasta la etapa siguiente, cuando se hayan ejecutado por completo todas las ramas.
Es posible programar un máximo de 249 ramas simultáneas en una cadena secuencial.
La figura siguiente muestra la representación gráfica de una rama simultánea:

8194

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH

Rama alternativa
Las ramas alternativas permiten programar ramas O. Esto significa que, después de una
etapa, se insertan ramas que empiezan con una transición. En función de la transición que se
cumpla primero se ejecutará la rama correspondiente. Si se cumplen varias transiciones a la
vez, la rama que se procese dependerá del modo de operación ajustado:
● Modo automático o semiautomático: la transición situada más a la izquierda recibe la
prioridad máxima y se procesa la rama correspondiente.
● Modo manual: la primera transición en cumplirse recibe la prioridad máxima y se procesa
la rama correspondiente.
Si, no obstante, está activado el ajuste de test "Procesar todas las transiciones", en ambos
casos se procesará la rama con el número de transición más bajo.
Es posible programar un máximo de 125 ramas alternativas en una cadena secuencial.
La figura siguiente muestra la representación gráfica de una rama alternativa:

Programación del PLC
Manual de programación y manejo, 11/2019

8195

Crear programas GRAPH
17.1 Principios básicos de GRAPH

Cerrar rama
El elemento "Cerrar rama" permite cerrar ramas simultáneas o alternativas y llevarlas a su
rama raíz. Esto debe hacerse cuando la rama no se cierra con un salto o un fin de cadena.

Salto a etapa
Con un salto se prosigue la ejecución del programa en una etapa cualquiera dentro del bloque
de función GRAPH. Los saltos pueden insertarse al final de la rama principal, de una rama
alternativa o de una rama simultánea, de modo que sea posible procesar la cadena secuencial
cíclicamente. El salto y su destino se representan en la cadena secuencial en forma de flecha,
de modo que en el destino del salto se indica la transición de origen y en el salto la etapa de
destino.
Nota
Se deben evitar saltos desde una transición hasta la etapa inmediatamente anterior. Si, a
pesar de todo, es necesario un salto de este tipo, inserte una etapa vacía con una transición
sin condiciones.
La figura siguiente muestra la representación gráfica de un salto:

8196

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH

7
6
6WHS
7
7UDQV
6
6WHS
7
7UDQV
6

Fin de cadena
Las cadenas secuenciales o ramas pueden cerrarse con el elemento "Fin de cadena". Con él
finaliza la cadena secuencial o rama. En una rama simultánea, sin embargo, el fin de cadena
debe ir precedido de una transición. El elemento "Fin de cadena" se representa en la cadena
secuencial con un punto negro.
La figura siguiente muestra la representación gráfica de un fin de cadena:

Nota
Si todas las ramas de una cadena secuencial se cierran con un fin de cadena, es posible volver
a iniciar la cadena secuencial con el parámetro "INIT_SQ" o con el botón "Inicializar" de la Task
Card "Test" en la paleta "Control secuencial".

Consulte también
Principios básicos de las cadenas secuenciales (Página 8193)
Programar la estructura de una cadena secuencial (Página 8257)
Lenguaje de programación GRAPH (Página 8191)
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)

Programación del PLC
Manual de programación y manejo, 11/2019

8197

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Avisos de interlock y supervisión (Página 8212)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.3

Etapas y transiciones

17.1.3.1

Principios básicos de las etapas

Introducción
Las etapas sirven para dividir las tareas de automatización complejas en tareas más pequeñas
y claras que, seguidamente, se llevan a cabo por medio de acciones. Las diferentes etapas se
organizan en cadenas secuenciales, de modo que al ejecutar el programa cada etapa se
procesa en el orden especificado. Cada etapa debe tener un nombre y un número unívocos.
Las acciones de una etapa se ejecutan cuando la etapa se activa. Para ello es necesario que
una de las etapas sea la inicial o bien que se cumpla la transición precedente. Una etapa
también puede llamarse con una acción controlada por evento. Adicionalmente es posible
programar condiciones de interlock y supervisión en una etapa.
La etapa con la que debe empezar el procesamiento de la cadena secuencial se define
libremente. Para ello se especifica una etapa cualquiera como etapa inicial. En las ramas
simultáneas es posible definir varias etapas como iniciales. En caso de operación cíclica de
una cadena secuencial, la etapa inicial recibe el mismo tratamiento que cualquier otra etapa
mientras no se efectúe una inicialización de la cadena secuencial con el parámetro "INIT_SQ".
Cuando se reinicializa la cadena secuencial se activan todas las etapas iniciales, siempre que
haya un flanco de señal ascendente en "INIT_SQ". Todas las demás etapas quedan
desactivadas. En la navegación y la vista de cadena, las etapas iniciales están marcadas con
un marco para identificarlas fácilmente.
Una etapa en la que no se programan acciones es una etapa vacía. Puesto que una etapa
vacía no tiene que procesar acciones, la cadena secuencial pasa inmediatamente a la
transición siguiente. Esto permite programar dos transiciones consecutivas.
Los nombres y números de las etapas pueden modificarse en cualquier momento. Además,
existe la posibilidad de documentar etapas utilizando comentarios.

Consulte también
Elementos de una etapa (Página 8199)
Principios básicos de las transiciones (Página 8200)
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Programar la estructura de una cadena secuencial (Página 8257)
Cadenas secuenciales (Página 8193)

8198

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Acciones (Página 8201)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.3.2

Elementos de una etapa
En una etapa es posible programar los componentes siguientes:
● Interlock
● Supervisión
● Acciones

Interlock
Un interlock permite programar condiciones de las que depende la ejecución de las diferentes
acciones. Las acciones de una etapa enlazadas con el interlock solo se ejecutan si se cumple
la condición del interlock. Si la condición del interlock no se cumple, hay un fallo. Para estos
casos es posible definir avisos que se mostrarán cuando corresponda. Sin embargo, el fallo no
influye en la transición a la etapa siguiente. Tenga en cuenta además que al desactivar la etapa
se cancela automáticamente el interlock. También existe la opción de que el operador tenga
que acusar un aviso de interlock para cerrar el aviso.
Además, es posible no programar condiciones en el interlock pero enlazar el interlock con
acciones de todos modos. En ese caso, el interlock siempre se cumple.

Supervisión
Una supervisión permite programar condiciones con las que se supervisa una etapa completa.
Si se cumple la condición significa que hay un fallo y la etapa permanece activa. En ese caso,
la cadena secuencial no pasa a la etapa siguiente, sino que se queda en la etapa activa hasta
que se ha eliminado el fallo. También en la supervisión es posible definir avisos y activar la
obligación de acuse.

Acciones
En las etapas se programan acciones que controlan entradas o salidas, activan y desactivan
otras etapas de la cadena secuencial o llaman bloques, por ejemplo. Por consiguiente, las
acciones incluyen instrucciones para controlar el proceso.
Se distingue entre acciones estándar y acciones controladas por evento. Las acciones
estándar se ejecutan mientras la etapa está activa. Las acciones controladas por evento son
las que se han enlazado con un evento.

Consulte también
Principios básicos de las etapas (Página 8198)
Principios básicos de las transiciones (Página 8200)
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)

Programación del PLC
Manual de programación y manejo, 11/2019

8199

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Programar la estructura de una cadena secuencial (Página 8257)
Cadenas secuenciales (Página 8193)
Acciones (Página 8201)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.3.3

Principios básicos de las transiciones

Introducción
Las transiciones están entre las etapas y contienen las condiciones para continuar con la
siguiente etapa. Es decir, la cadena secuencial solo pasa a las etapas siguientes cuando se
cumplen las condiciones de la transición. Durante el proceso se desactivan las etapas
correspondientes a la transición y se activan las etapas posteriores. Si no se cumplen las
condiciones, las etapas correspondientes a la transición se mantienen activas. Cada transición
debe tener un nombre y un número unívocos. Las condiciones de una transición se programan
en KOP o FUP.
Una transición en la que no se programan condiciones es una transición vacía. En ese caso,
la cadena secuencial pasa inmediatamente a las etapas siguientes.
Los nombres y números de las transiciones pueden modificarse.

Consulte también
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Elementos de una etapa (Página 8199)
Programar la estructura de una cadena secuencial (Página 8257)
Cadenas secuenciales (Página 8193)
Acciones (Página 8201)
Interfaz de un bloque de función GRAPH (Página 8213)

8200

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH

17.1.4

Acciones

17.1.4.1

Principios básicos de las acciones

Introducción
Las acciones permiten controlar entradas o salidas, activar y desactivar otras etapas de la
cadena secuencial o llamar bloques, por ejemplo. Las acciones se ejecutan cuando se activa
la etapa correspondiente (acciones estándar) o cuando se produce un evento relacionado con
la acción (acciones controladas por evento). En las acciones también pueden utilizarse
temporizadores y contadores.
La tabla siguiente muestra ejemplos de programación de acciones:

Interlock

Evento

-(C)-

S1

Identificador

Acción

Descripción

N

MyTag1

Acción compuesta por
instrucción y operando
sin interlock

N

MyTag2

Acción compuesta por
instrucción y operando
con interlock

S

MyTag3

Acción compuesta por
evento, instrucción y
operando sin interlock

Las acciones se ejecutan en orden descendente cuando la etapa está activa o se produce el
evento.
La figura siguiente muestra un ejemplo del orden de procesamiento de las acciones de una
etapa:

/DHWDSDHVW£DFWLYD
(WDSD

6
(WDSD

2UGHQGH
SURFHVDPLHQWR

1

0\7DJ

&

6

5

0\7DJ

&

6

1

0\7DJ









① Interlock
② Evento opcional
③ Identificador

Programación del PLC
Manual de programación y manejo, 11/2019

8201

Crear programas GRAPH
17.1 Principios básicos de GRAPH

④ Operando, asignación o llamada de bloque
Una acción consta de los componentes siguientes:
● Interlock (opcional)
Es posible enlazar una acción con un interlock para influir en su ejecución.
● Evento (opcional)
Un evento define cuándo debe ejecutarse una acción. Para algunos identificadores es
obligatorio indicar un evento.
● Identificador (obligatorio)
El identificador define el tipo de acciones que debe ejecutarse, p. ej. la activación o
desactivación de un operando.
● Acción (obligatorio)
La acción determina el operando con el que se ejecuta la misma.

Consulte también
Acciones estándar (Página 8202)
Acciones controladas por evento (Página 8204)
Llamadas de bloque (Página 8207)
Temporizadores (Página 8208)
Contadores (Página 8209)
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Programar acciones (Página 8278)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.4.2

Acciones estándar

Introducción
Las acciones estándar se ejecutan mientras una etapa está activa. La tabla siguiente muestra
las posibles acciones estándar con sus identificadores:

8202

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH

Identificador

Tipo de datos del ope‐ Significado
rando

N – Activar mientras la
etapa esté activa

BOOL

Mientras la etapa está activa, el estado lógico del operando es "1".

FB, FC, SFB, SFC

Mientras la etapa está activa se efectúa la llamada del bloque indicado.
La etapa también se considera activa en el ciclo en el que aparece el
evento S1.

S - Poner a 1

BOOL

En cuanto la etapa se activa, el operando se pone a "1" y permanece
posteriormente en "1".

R - Poner a 0

BOOL

En cuanto la etapa se activa, el operando se pone a "0" y permanece
posteriormente en "0".

D - Retardo a la conexión BOOL y Time/
DWORD

n segundos después de la activación de la etapa, el operando se pone a
"1" y permanece en "1" mientras dura la activación de la etapa. No es
aplicable si el tiempo de activación de la etapa es inferior a n segundos.
El tiempo puede indicarse como constante o como variable PLC del tipo
de datos TIME/DWORD.

L - Activar por tiempo li‐
mitado

BOOL y Time/
DWORD

Cuando la etapa está activa, el operando se pone a "1" durante n segun‐
dos. Después, el operando vuelve a ponerse a "0". El operando también
se pone a "0" cuando el tiempo de activación de la etapa es inferior a la
duración.
El tiempo puede indicarse como constante o como variable PLC del tipo
de datos TIME/DWORD.

Todas estas acciones estándar pueden asociarse a un interlock. Si una acción está enlazada
con un interlock, dicha acción solo se ejecutará cuando se cumplan las condiciones del
interlock.
La tabla siguiente muestra algunos ejemplos de uso de constantes de tiempo:

Identificador

Acción

Descripción

D

"MyTag", T#2s

2 segundos después de la activación de la etapa, el operando "MyTag" se
pone a "1" y permanece en "1" mientras dura la activación de la etapa. No
es aplicable si la duración de la activación de la etapa es inferior a 2
segundos. Con la desactivación de la etapa, el operando se pone a "0"
(sin memoria).

L

"MyTag", T#20s

Cuando la etapa está activa, el operando "MyTag" se pone a "1" durante
20 segundos. Después, el operando se pone a "0" (sin memoria). El ope‐
rando también se pone a "0" cuando el tiempo de activación de la etapa
es inferior a 20 segundos.

Consulte también
Principios básicos de las acciones (Página 8201)
Acciones controladas por evento (Página 8204)
Llamadas de bloque (Página 8207)
Temporizadores (Página 8208)
Contadores (Página 8209)

Programación del PLC
Manual de programación y manejo, 11/2019

8203

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Programar acciones (Página 8278)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.4.3

Acciones controladas por evento

Introducción
Existe la posibilidad de enlazar una acción con un evento para que la ejecución de dicha acción
dependa de determinadas condiciones. Las acciones con los identificadores "D", "L" y "TF" no
pueden enlazarse con eventos. Si una acción está asociada a un evento, el estado lógico del
evento se detecta mediante evaluación de flancos. Es decir, las instrucciones solo se ejecutan
en el mismo ciclo en el que se produce el evento.
La tabla siguiente muestra los eventos que pueden enlazarse con acciones:

Evento

Evaluación de señal

Descripción

S1

Flanco ascendente

La etapa se activa (estado lógico = "1")

S0

Flanco descendente

La etapa se desactiva (estado lógico = "0")

V1

Flanco ascendente

La supervisión se cumple, es decir, hay un fallo (estado lógico = "1")

V0

Flanco descendente

La supervisión ya no se cumple, es decir, se ha solucionado el fallo (estado lógico = "0")

L0

Flanco ascendente

El interlock se cumple, es decir, se ha solucionado el fallo (estado lógico = "1")

L1

Flanco descendente

El interlock no se cumple, es decir, hay un fallo (estado lógico = "0")

A1

Flanco ascendente

Se acusa un aviso.

R1

Flanco ascendente

Llegada de un registro.

Los estados lógicos de un evento se pueden utilizar para programar otras acciones. De ese
modo, no solo se pueden supervisar e influir las etapas individuales, sino todo el control
secuencial.
Las acciones para las que se utilizan los identificadores "ON" (activar etapa) y "OFF"
(desactivar etapa) deben enlazarse siempre con un evento. El evento determina cuándo se
activa o desactiva la etapa. Si una etapa se activa y desactiva en un mismo ciclo, la
desactivación tiene mayor prioridad.
Las acciones para las que se utilizan los eventos "S1", "V1", "A1" o "R1" pueden enlazarse
adicionalmente con un interlock. De ese modo se ejecutan únicamente si las condiciones del
interlock se cumplen.
La figura siguiente muestra un ejemplo de una etapa que contiene acciones controladas por
evento:

8204

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH

/DHWDSDHVW£DFWLYD
(WDSD
6
(WDSD

 & 

2UGHQGH
SURFHVDPLHQWR



6

5

0\7DJ

9

2))

0\6WHS

/

2))

6B$//







En cuanto la etapa "Step4" se activa y el interlock se cumple, "MyTag1" se pone a 0 y
permanece posteriormente en "0". Cuando se produce un error de supervisión se desactiva la
etapa "MyStep". Cuando se produce un interlock se desactivan todas las etapas.

Registro
Un registro es un evento que se lanza fuera del bloque y se consulta mediante un flanco de
señal ascendente en uno de los parámetros de entrada "REG_S" o "REG_EF". Si el registro se
efectúa a través del parámetro de entrada "REG_S", el evento se transmite únicamente a la
etapa activa que se muestra en el parámetro de salida "S_NO". Si el registro se efectúa a través
del parámetro de entrada "REG_EF", el evento se transmite a todas las etapas que se
encuentren activas.

Ejemplos de la evaluación de señales de eventos
La figura siguiente muestra la evaluación de señales de una etapa:
/DHWDSDHVW£DFWLYD
6

6

/DHWDSDQRHVW£DFWLYD
W

● S1: la etapa se activa
● S0: la etapa se desactiva
La figura siguiente muestra la evaluación de señales de una supervisión:

Programación del PLC
Manual de programación y manejo, 11/2019

8205

Crear programas GRAPH
17.1 Principios básicos de GRAPH
)DOOR

/DVXSHUYLVLµQVHFXPSOH
9

9

/DVXSHUYLVLµQQRVHFXPSOH

1RKD\IDOORV

W

● V1: se produce un error de supervisión
● V0: el error de supervisión se ha solucionado
La figura siguiente muestra la evaluación de señales de un interlock:
(OLQWHUORFNVHFXPSOH

1RKD\IDOORV
/

(OLQWHUORFNQRVHFXPSOH

/
)DOOR

W
● L1: el interlock ya no se cumple (fallo entrante)
● L0: el interlock se cumple (fallo saliente)
La figura siguiente muestra la evaluación de señales de un aviso y el registro:


$
5



W

● A1: se acusa un aviso
● R1: llega un registro (flanco ascendente en la entrada REG_EF / REG_S)

Consulte también
Principios básicos de las acciones (Página 8201)
Acciones estándar (Página 8202)
Llamadas de bloque (Página 8207)
Temporizadores (Página 8208)
Contadores (Página 8209)
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)

8206

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Programar acciones (Página 8278)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.4.4

Llamadas de bloque

Introducción
Dentro de las acciones es posible llamar otros bloques de función y otras funciones en los que
se ejecutan determinadas tareas parciales. Esto permite estructurar mejor el programa.

Llamada de bloques de función (FB)
Para la llamada se debe utilizar la sintaxis siguiente:
CALL "<NombreFB>", "<NombreDB>" (lista de parámetros)
La tabla siguiente muestra un ejemplo de llamada de un bloque de función:
Interlock

Evento

Identificador

Acción

N

CALL "FB_KOP", "FB_KOP_DB" (MyInOut := "MyTag2")

El bloque de función "FB_KOP" se llama con la instrucción "CALL". La instrucción "CALL" está
siempre asociada al identificador "N". Tras el nombre del bloque llamado se encuentra el
nombre del bloque de datos que contiene los datos y parámetros del bloque de función. En la
lista de parámetros se asigna la variable "MyTag2" al parámetro "MyInOut".

Llamada de funciones (FC)
Para llamar una función se utiliza la siguiente sintaxis:
CALL "<NombreFC>" (lista de parámetros)
La tabla siguiente muestra un ejemplo de llamada de una función:
Inter‐
lock

Evento

Identificador Acción
N

CALL "FC_KOP" (MyInput := "MyTag1")

La función "FC_KOP" se llama con la instrucción "CALL". En la lista de parámetros se asigna
la variable "MyTag1" al parámetro "MyInput".

Consulte también
Llamadas de bloque (Página 59)
Inserción manual de llamadas de bloque (Página 8304)
Insertar llamadas de bloque mediante Drag & Drop (Página 8306)
Actualizar llamadas de bloque en GRAPH (Página 8308)

Programación del PLC
Manual de programación y manejo, 11/2019

8207

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Principios básicos de las acciones (Página 8201)
Acciones estándar (Página 8202)
Acciones controladas por evento (Página 8204)
Temporizadores (Página 8208)
Contadores (Página 8209)
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Programar acciones (Página 8278)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.4.5

Temporizadores

Introducción
Dentro de las acciones existe la posibilidad de utilizar temporizadores. Excepto "TF", todos los
temporizadores dependen de un evento que determina el instante de activación del
temporizador. El temporizador "TF" es activado por la propia etapa.
En caso de utilizar los temporizadores "TL", "TD" y "TF" hay que indicar el tiempo. Utilice para
ello la sintaxis siguiente:
<Tiempo> = IWy, QWy, MWy, LWy, DBWy o DIWy; variable del tipo S5TIME
o WORD; constante S5T#
y = 0 ... 65534
Las constantes también se pueden introducir como datos de tiempo normales, p. ej. "5s".
En la siguiente tabla se muestran los temporizadores que se pueden utilizar en acciones:

8208

Evento

Identifica‐
dor

Descripción

S1, S0, L1, L0, V1, V0,
A1, R1

TL

Impulso prolongado:

S1, S0, L1, L0, V1, V0,
A1, R1

TD

el temporizador se inicia en cuanto se produce el evento defi‐
nido. Durante el tiempo indicado, el temporizador tiene el es‐
tado lógico "1". Una vez finalizado el temporizador, pasa al
estado lógico "0".
Retardo a la conexión con memoria:
el temporizador se inicia en cuanto se produce el evento defi‐
nido. Durante el tiempo indicado, el temporizador tiene el es‐
tado lógico "0". Una vez finalizado el temporizador, pasa al
estado lógico "1".

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Evento

Identifica‐
dor

Descripción

S1, S0, L1, L0, V1, V0,
A1, R1

TR

Detener temporizador e inicializar:

-

TF

el temporizador se detiene en cuanto se produce el evento
definido. El estado y el valor del temporizador se ponen a "0".
Retardo a la desconexión:
el estado del temporizador se pone a "1" en cuanto se activa la
etapa. Al desactivarse la etapa, el temporizador está activado
y no se pone a "0" hasta que finaliza el temporizador.

Consulte también
Principios básicos de las acciones (Página 8201)
Acciones estándar (Página 8202)
Acciones controladas por evento (Página 8204)
Llamadas de bloque (Página 8207)
Contadores (Página 8209)
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Programar acciones (Página 8278)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.4.6

Contadores

Introducción
Dentro de las acciones existe la posibilidad de utilizar contadores. Los contadores requieren
siempre un evento para determinar el instante de activación del contador. Esto significa que el
contador se activará cuando se produzca el evento correspondiente. Las acciones para las
que se utilizan los eventos S1, V1, A1 o R1 pueden enlazarse adicionalmente con un interlock.
De este modo se ejecutan únicamente si las condiciones del interlock se cumplen.
En la siguiente tabla se muestran los contadores que se pueden utilizar en acciones:

Programación del PLC
Manual de programación y manejo, 11/2019

8209

Crear programas GRAPH
17.1 Principios básicos de GRAPH

Evento

Identifica‐
dor

Tipo de datos del ope‐
rando

Significado

S1, S0, L1, L0, V1, V0,
A1, R1

CS

COUNTER

Poner contador al valor inicial:

S1, S0, L1, L0, V1, V0,
A1, R1

CU

S1, S0, L1, L0, V1, V0,
A1, R1

CD

S1, S0, L1, L0, V1, V0,
A1, R1

CR

El contador se pone al valor de contaje
indicado en cuanto se produce el even‐
to definido. El valor de contaje puede
indicarse como variable o constante
del tipo de datos WORD (C#0 a
C#999).
COUNTER

Contador ascendente:
El contador incrementa el valor de con‐
taje en "1" en cuanto se produce el
evento definido. El valor de contaje
puede seguir incrementándose hasta
alcanzar el límite de "999". Una vez al‐
canzado el valor límite, el valor de con‐
taje ya no se incrementa más al detec‐
tarse un flanco ascendente.

COUNTER

Contador descendente:
El contador decrementa el valor de
contaje en "1" en cuanto se produce el
evento definido. El valor de contaje
puede seguir decrementándose hasta
alcanzar el límite "0". Una vez alcan‐
zado el valor límite, el valor de contaje
ya no se decrementa más al detectar‐
se un flanco ascendente.

COUNTER

Poner contador a 0:
El contador se pone a "0" en cuanto se
produce el evento definido.

Consulte también
Principios básicos de las acciones (Página 8201)
Acciones estándar (Página 8202)
Acciones controladas por evento (Página 8204)
Llamadas de bloque (Página 8207)
Temporizadores (Página 8208)
Lenguaje de programación GRAPH (Página 8191)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Programar acciones (Página 8278)
Cadenas secuenciales (Página 8193)

8210

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Etapas y transiciones (Página 8198)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.5

Instrucciones permanentes

Introducción
Las instrucciones permanentes ofrecen la posibilidad de crear un código del programa que se
ejecute antes o después del procesamiento de la cadena secuencial. Esto permite programar
condiciones y llamadas de bloque que se procesen en cada ciclo con independencia de la
cadena secuencial.
Las instrucciones permanentes se crean en los lenguajes de programación KOP y FUP, con
un máximo de 32 instrucciones KOP o FUP en cada instrucción permanente. Dentro de un
bloque de función GRAPH es posible utilizar un máximo de 250 instrucciones permanentes
anteriores y 250 posteriores. El resultado lógico de las condiciones se transfiere a una
asignación que también dispone de las funciones de memoria "Activar" y "Desactivar". El
operando utilizado (p. ej. una marca) se puede consultar en un segmento de transición,
interlock y supervisión y en otros segmentos permanentes.

Consulte también
Vista "Instrucciones permanentes anteriores" (Página 8247)
Vista "Instrucciones permanentes posteriores" (Página 8252)
Lenguaje de programación GRAPH (Página 8191)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.6

Condiciones

Introducción
Las condiciones son estados binarios del proceso que, en forma de elementos KOP o FUP (p.
ej. contactos normalmente abiertos, contactos normalmente cerrados, operaciones lógicas Y,
operaciones lógicas O o comparadores), se combinan entre sí en el esquema de contactos o
en el diagrama de funciones según los principios de la lógica booleana. El resultado lógico
(RLO) puede influir sobre acciones individuales de una etapa, sobre la etapa entera, la
transición a la etapa siguiente o la cadena secuencial en su conjunto.

Programación del PLC
Manual de programación y manejo, 11/2019

8211

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Las condiciones permiten programar los componentes siguientes del programa GRAPH:
● Instrucciones permanentes
● Interlocks
● Supervisiones
● Transiciones
En cada segmento es posible programar un máximo de 32 instrucciones con un máximo de 32
operandos interconectados. Encontrará información adicional sobre las variables utilizadas
visualizando la información sobre las variables.

Consulte también
Lenguaje de programación GRAPH (Página 8191)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Instrucciones permanentes (Página 8211)
Avisos de interlock y supervisión (Página 8212)
Interfaz de un bloque de función GRAPH (Página 8213)

17.1.7

Avisos de interlock y supervisión

Introducción
Existe la posibilidad de detectar fallos acerca de interlocks y supervisiones. Para poder
solucionar estos fallos con rapidez es posible definir avisos que describan con detalle los fallos.
Para ello debe activarse primero la generación de avisos y adaptar seguidamente los textos de
aviso a las necesidades particulares. También es posible determinar que los avisos deban
acusarse.

Consulte también
Definir avisos (Página 8310)
Lenguaje de programación GRAPH (Página 8191)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Interfaz de un bloque de función GRAPH (Página 8213)

8212

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH

17.1.8

Interfaz de un bloque de función GRAPH

17.1.8.1

Principios básicos de la interfaz de un bloque de función GRAPH

Juegos de parámetros de interfaz
En los ajustes "Opciones > Configuración > Programación de PLC > GRAPH" puede elegirse
entre los siguientes juegos de parámetros de interfaz, que le proporcionan una cantidad
variable de parámetros de entrada y salida:
● Juego de parámetros de interfaz mínimo
El juego de parámetros de interfaz mínimo solo contiene el parámetro de entrada "INIT_SQ"
y no contiene parámetros de salida.
● Juego de parámetros de interfaz estándar
El juego de parámetros de interfaz estándar permite la operación de la cadena secuencial
en distintos modos de operación y ofrece la posibilidad de acusar avisos.
● Juego de parámetros de interfaz máximo
Con el juego de parámetros de interfaz máximo se dispone de posibilidades adicionales de
diagnóstico.
En todos los juegos de parámetros se pueden borrar o agregar manualmente parámetros
individuales.
Nota
A la hora de realizar la selección tenga en cuenta también el espacio de memoria disponible
en la CPU, pues al aumentar el número de parámetros aumenta también el espacio necesario
para el bloque de función GRAPH y el bloque de datos de instancia correspondiente.
Consulte también:
Parámetros de entrada (Página 8216)
Parámetros de salida (Página 8220)

Modelos de espacio de memoria para el bloque de datos instancia (S7-300/400)
Para CPUs de la serie S7-300/400 también es posible especificar el modelo de espacio de
memoria para el bloque de datos de instancia. Existen las siguientes posibilidades:
● bloque de datos estándar
● bloque de datos minimizado
Al seleccionar el modelo de memoria se define el número de parámetros estáticos.
Básicamente, la información sobre las etapas y transiciones individuales se almacena como
parámetros estáticos en ambos modelos de memoria. Para cada etapa y cada transición se
crea una estructura propia con información detallada. En un bloque de datos estándar se
obtiene información más detallada que en un bloque de datos minimizado, pero el bloque de
datos estándar requiere para ello una cantidad de espacio en memoria notablemente superior.

Programación del PLC
Manual de programación y manejo, 11/2019

8213

Crear programas GRAPH
17.1 Principios básicos de GRAPH
En un bloque de datos minimizado existen las restricciones siguientes:
● Algunos elementos de las estructuras de etapa y de transición no están disponibles.
● La opción "Saltar etapas" no está disponible.
● No hay avisos disponibles.
● Los números de etapa y de transición deben ser correlativos. Si no es así, las etapas y
transiciones se renumeran automáticamente durante la compilación.
● No se crean datos para el análisis de criterios.
Consulte también: Parámetros estáticos (Página 8224)

Acceso a los parámetros de interfaz
Por principio, en una CPU S7-1500 no es posible acceder en escritura a los parámetros de
interfaz internos de GRAPH Sin embargo, los siguientes componentes de la estructura
"RT_DATA > MOP" en la sección "Static" que gestionan los modos de operación sí permiten
un acceso en escritura:
● AUTO
● MAN
● TAP
● TOP
● LOCK
● SUP
● OFF
● INIT
● HALT
● TMS_HALT
● OPS_ZERO
● S_PREV
● S_NEXT
● S_ON
● S_OFF
● T_PUSH
● ACK
● IL_PERM
● T_PERM
● ILP_MAN
Estos parámetros reaccionan a un flanco de señal ascendente. Asimismo, en las CPU
S7-300/400 evite acceder en escritura a otros parámetros que los mencionados, pues en caso
contrario no queda asegurada una ejecución correcta de la cadena secuencial.

8214

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Consulte también: Otros parámetros estáticos (Página 8228)

Restablecer los requisitos de registro
Para el registro de errores y fallos mediante el parámetro de entrada "REG_EF", entre las
familias de CPU existen las diferencias siguientes a la hora de restablecer las solicitudes de
registro:
● S7-300/400
Las solicitudes de registro se mantienen hasta que se produce un error de interlock o
supervisión en una etapa. En este momento se dispara el evento "R1", se ejecuta la acción
vinculada y se restablecen las solicitudes de registro.
● S7-1500
Las solicitudes de registro se inicializan siempre, independientemente de si se produce un
error de interlock o de supervisión en el ciclo actual.

Consulte también
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Lenguaje de programación GRAPH (Página 8191)
Cadenas secuenciales (Página 8193)
Acciones (Página 8201)
Etapas y transiciones (Página 8198)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)

Programación del PLC
Manual de programación y manejo, 11/2019

8215

Crear programas GRAPH
17.1 Principios básicos de GRAPH

17.1.8.2

Parámetros de entrada

Resumen de los parámetros de entrada de un bloque de función GRAPH
Los parámetros de entrada de un bloque de función GRAPH reaccionan a un flanco de señal
ascendente. La tabla siguiente muestra una relación de los parámetros de entrada de un
bloque de función GRAPH:
Paráme‐
tro

Tipo de
datos

Descripción

Juego de pará‐
metros mínimo

Juego de pa‐
rámetros es‐
tándar

Juego de pará‐
metros máximo

OFF_SQ

BOOL

OFF_SEQUENCE:

-

x

x

x

x

x

-

x

x

-

-

x

-

-

x

-

-

x

-

-

x

-

-

x

desconectar cadena secuencial, es decir, desac‐
tivar todas las etapas
Tipo: Requisito
INIT_SQ

BOOL

INIT_SEQUENCE:
activar etapas iniciales, resetear cadena secuen‐
cial
Tipo: Requisito

ACK_EF

BOOL

ACKNOWLEDGE_ERROR_FAULT:
acusar una avería, forzar transición
Tipo: Requisito

REG_EF

BOOL

REGISTRATE_ERROR_FAULT:
registrar todos los errores y averías
Tipo: Requisito

ACK_S

BOOL

ACKNOWLEDGE_STEP:
acusar la etapa mostrada en el parámetro de sa‐
lida "S_NO"
Tipo: Requisito

REG_S

BOOL

REGISTRATE_STEP:
registrar la etapa mostrada en el parámetro de
salida "S_NO"
Tipo: Requisito

HALT_S
Q

BOOL

HALT_SEQUENCE:
detener/reactivar cadena secuencial
Tipo: estado, la reinicialización se produce con un
nuevo flanco ascendente

HALT_T
M

BOOL

HALT_TIMES:
detener/reactivar todos los tiempos de activación
de etapa y las operaciones en función del tiempo
(L y D) de la cadena secuencial
Tipo: estado, la reinicialización se produce con un
nuevo flanco ascendente

8216

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Paráme‐
tro

Tipo de
datos

ZE‐
RO_OP

BOOL

Descripción

Juego de pará‐
metros mínimo

Juego de pa‐
rámetros es‐
tándar

Juego de pará‐
metros máximo

ZERO_OPERANDS:

-

-

x

-

-

x

-

-

x

-

-

x

-

-

x

-

-

x

-

-

x

-

-

x

PREVIOUS_STEP:modo automático: retroceder página por las etapas actualmente activas, visua‐
lización del número de etapa en el parámetro de
salida "S_NO"

x

x

poner a cero todos los operandos con el identifi‐
cador N, D, L en etapas activas y no ejecutar las
instrucciones CALL en acciones/reactivar los ope‐
randos e instrucciones CALL
Tipo: estado, la reinicialización se produce con un
nuevo flanco ascendente

EN_IL

BOOL

ENABLE_INTERLOCKS:
desactivar interlock (la cadena secuencial se com‐
porta como si el interlock se cumpliera)/reactivarlo
Tipo: estado, la reinicialización se produce con un
nuevo flanco ascendente

EN_SV

BOOL

ENABLE_SUPERVISIONS:
desactivar supervisión (la cadena secuencial se
comporta como si el interlock no se cumpliera)/
reactivarlo
Tipo: estado, la reinicialización se produce con un
nuevo flanco ascendente

EN_ACK‐ BOOL
REQ

ENABLE_ACKNOWLEDGE_REQUIRED:
activar acuse obligatorio
Tipo: estado, la reinicialización se produce con un
nuevo flanco ascendente

EN_SSKI
P

BOOL

ENABLE_STEP_SKIPPING:
activar salto de etapa
Tipo: estado, la reinicialización se produce con un
nuevo flanco ascendente

DISP_SA
CT

BOOL

DISPLAY_ACTIVE_STEPS:
visualizar solo las etapas activas
Tipo: estado, la reinicialización se produce con un
flanco ascendente en DISP_SEF, DISP_SALL

DISP_SE
F

BOOL

DISPLAY_STEPS_WITH_ERROR_OR_FAULT:
visualizar solo las etapas con errores y averías
Tipo: estado, la reinicialización se produce con un
flanco ascendente en DISP_SACT, DISP_SALL

DISP_SA
LL

BOOL

DISPLAY_ALL_STEPS:
visualizar todas las etapas
Tipo: estado, la reinicialización se produce con un
flanco ascendente en DISP_SACT, DISP_SEF

S_PREV

BOOL

Modo manual: visualizar la etapa anterior en
"S_NO" (número más pequeño)
Tipo: Requisito

Programación del PLC
Manual de programación y manejo, 11/2019

8217

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Paráme‐
tro

Tipo de
datos

Descripción

Juego de pará‐
metros mínimo

Juego de pa‐
rámetros es‐
tándar

Juego de pará‐
metros máximo

S_NEXT

BOOL

NEXT_STEP:

-

x

x

-

x

x

-

x

x

-

x

x

-

x

x

-

x

x

-

-

x

-

x

x

-

x

x

modo Automático: avanzar página por las etapas
actualmente activas, visualización del número de
etapa en el parámetro de salida "S_NO"
Modo manual: visualizar la etapa siguiente en
"S_NO" (número más grande)
Tipo: Requisito
SW_AU‐
TO

BOOL

SWITCH_MODE_AUTOMATIC:
cambio de modo de operación: modo automático
Tipo: estado, la reinicialización se produce con un
flanco ascendente en SW_TAP, SW_TOP,
SW_MAN

SW_TAP

BOOL

SWITCH_MODE_TRANSITION:
cambio de modo de operación: modo semiauto‐
mático
Tipo: estado, la reinicialización se produce con un
flanco ascendente en SW_AUTO, SW_TOP,
SW_MAN

SW_TOP

BOOL

SWITCH_MODE_TRANSITION_OR_PUSH:
cambio de modo de operación: modo automático
o semiautomático
Tipo: estado, la reinicialización se produce con un
flanco ascendente en SW_AUTO, SW_TAP,
SW_MAN

SW_MAN BOOL

SWITCH_MODE_MANUAL:
cambio de modo de operación: modo manual, no
se lanza ninguna secuencia automática
Tipo: estado, la reinicialización se produce con un
flanco ascendente en SW_AUTO, SW_TAP,
SW_TOP

S_SEL

INT

STEP_SELECT:
elegir el número de etapa del parámetro de salida
"S_NO" en modo manual, activar/desactivar con
"S_ON", "S_OFF"
Tipo: N/A

S_SE‐
LOK

BOOL

S_ON

BOOL

STEP_SELECT_OK:
aplicar valor de "S_SEL" para el parámetro de sa‐
lida "S_NO"
Tipo: Requisito
STEP_ON:
Modo manual: activar la etapa visualizada
Tipo: Requisito

S_OFF

BOOL

STEP_OFF:
Modo manual: desactivar la etapa visualizada
Tipo: Requisito

8218

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Paráme‐
tro

Tipo de
datos

Descripción

Juego de pará‐
metros mínimo

Juego de pa‐
rámetros es‐
tándar

Juego de pará‐
metros máximo

T_PREV

BOOL

PREVIOUS_TRANSITION:

-

-

x

-

-

x

-

x

x

-

-

x

-

-

x

visualizar la anterior transición válida en el pará‐
metro de salida "T_NO"
Tipo: Requisito
T_NEXT

BOOL

NEXT_TRANSITION:
visualizar la siguiente transición válida en el pará‐
metro de salida "T_NO"
Tipo: Requisito

T_PUSH

BOOL

PUSH_TRANSITION:
la transición conmuta si la condición se cumple y
"T_PUSH" (flanco)
Requisitos: modo automático o modo manual
Tipo: Requisito

EN_LMO
DE

BOOL

ENABLE_LEARNING_MODE:
Activar modo de aprendizaje

(solo
S7-1500
a partir
de la ver‐
sión de
bloque
V2.0)
RE‐
SET_CRI
T

Tipo: estado, la reinicialización se produce con un
nuevo flanco ascendente

BOOL

RESET_CRITERIA:
Inicializar primeros valores de enclavamientos y
transiciones

(solo
S7-1500;
FB
GRAPH
a partir
de la ver‐
sión de
bloque
V5.0)

Tipo: Requisito

Consulte también
Inicializar primeros valores (Página 8315)
Principios básicos de la interfaz de un bloque de función GRAPH (Página 8213)
Parámetros de salida (Página 8220)
Parámetros estáticos (Página 8224)
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Lenguaje de programación GRAPH (Página 8191)

Programación del PLC
Manual de programación y manejo, 11/2019

8219

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)

17.1.8.3

Parámetros de salida

Resumen de los parámetros de salida de un bloque de función GRAPH
La tabla siguiente muestra una relación de los parámetros de salida de un bloque de función
GRAPH:
Parámetro

Tipo de
datos

Descripción

Juego de pa‐ Juego de pa‐ Juego de pará‐
rámetros mí‐ rámetros es‐ metros máximo
nimo
tándar

S_NO

INT

STEP_NUMBER:

-

x

x

-

x

x

-

x

x

-

-

x

-

-

x

-

-

x

-

-

x

muestra el número de eta‐
pa
S_MORE

BOOL

MORE_STEPS:

S_ACTIVE

BOOL

STEP_ACTIVE:

hay más etapas activas
la etapa visualizada está
activa
S_TIME

TIME

STEP_TIME:
tiempo de activación de la
etapa

S_TIMEOK

TIME

STEP_TIME_OK:
tiempo de activación de la
etapa sin errores

S_CRITLOC

DWORD

(S7-300/400
o S7-1500 a
partir de la
versión de
bloque V4.0)
S_CRITLO‐
CERR
(S7-300/400
o S7-1500 a
partir de la
versión de
bloque V4.0)

8220

STEP_CRITERIA_IN‐
TERLOCK:
bits de criterios de inter‐
lock

DWORD

S_CRITE‐
RIA_IL_LAST_ERROR:
bits de criterios de inter‐
lock con evento L1

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Parámetro

Tipo de
datos

Descripción

Juego de pa‐ Juego de pa‐ Juego de pará‐
rámetros mí‐ rámetros es‐ metros máximo
nimo
tándar

S_CRITSUP

DWORD

STEP_CRITERIA_SU‐
PERVISION:

-

-

x

-

-

x

-

-

x

-

-

x

TRANSITION_CRITERIA: -

-

x

-

x

(solo
S7-300/400)
S_STATE

bits de criterios de super‐
visión
WORD

STEP_STATE:
bits de estado de etapa
Encontrará más informa‐
ción sobre los diferentes
parámetros aquí: Paráme‐
tros estáticos de una eta‐
pa (Página 8224)

T_NO

INT

TRANSITION:
número de transición váli‐
do

T_MORE

BOOL

MORE_TRANSITIONS:
otras transiciones válidas
disponibles para visualiza‐
ción

T_CRIT

DWORD

Estado de los máx. 32 ele‐
mentos KOP/FUP de los
bits de criterios de transi‐
ción en el ciclo de ejecu‐
ción actual

(S7-300/400
o S7-1500 a
partir de la
versión de
bloque V4.0)

Aquí encontrará más infor‐
mación sobre el orden de
los bits de criterios en
DWORD: Ejemplo de or‐
den en la lista (Pági‐
na 8316).
T_CRITOLD

DWORD

(S7-300/400
o S7-1500 a
partir de la
versión de
bloque V4.0)

T_CRITE‐
RIA_LAST_CYCLE:

-

Estado de los máx. 32 ele‐
mentos KOP/FUP de los
bits de criterios de transi‐
ción del último ciclo
Aquí encontrará más infor‐
mación sobre el orden de
los bits de criterios en
DWORD: Ejemplo de or‐
den en la lista (Pági‐
na 8316).

Programación del PLC
Manual de programación y manejo, 11/2019

8221

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Parámetro

Tipo de
datos

Descripción

Juego de pa‐ Juego de pa‐ Juego de pará‐
rámetros mí‐ rámetros es‐ metros máximo
nimo
tándar

T_CRITFLT

DWORD

T_CRITE‐
RIA_LAST_FAULT:

-

-

x

-

-

x

-

-

x

-

x

x

-

-

x

-

-

x

-

-

x

-

-

x

-

-

x

-

-

x

(S7-300/400
o S7-1500 a
partir de la
versión de
bloque V4.0)

Estado de los máx. 32 ele‐
mentos KOP/FUP de los
bits de criterios de transi‐
ción con el evento V1 del
ciclo de ejecución, cuan‐
do se produjo el error de
supervisión en la etapa
anterior.
Aquí encontrará más infor‐
mación sobre el orden de
los bits de criterios en
DWORD: Ejemplo de or‐
den en la lista (Pági‐
na 8316).

ERROR

BOOL

INTERLOCK_ERROR:
error de interlock (cual‐
quier etapa)

FAULT

BOOL

SUPERVISION_FAULT:
error de supervisión (cual‐
quier etapa)

ERR_FLT

BOOL

IL_ERROR_OR_SV_FAU
LT:
Fallo agrupado

SQ_ISOFF

BOOL

SEQUENCE_IS_OFF:
la cadena secuencial está
desactivada (ninguna eta‐
pa activa)

SQ_HALTED BOOL

SEQUENCE_IS_HAL‐
TED:
cadena secuencial deteni‐
da

TM_HALTED BOOL

TIMES_ARE_HALTED:
temporizadores detenidos

OP_ZE‐
ROED

BOOL

OPERANDS_ARE_ZE‐
ROED:
operandos reseteados

IL_ENA‐
BLED

BOOL

INTERLOCK_IS_ENA‐
BLED:
el interlock se tiene en
cuenta

SV_ENA‐
BLED

BOOL

SUPERVISION_IS_ENA‐
BLED:
la supervisión se tiene en
cuenta

8222

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Parámetro

Tipo de
datos

Descripción

Juego de pa‐ Juego de pa‐ Juego de pará‐
rámetros mí‐ rámetros es‐ metros máximo
nimo
tándar

ACK‐
REQ_ENA‐
BLED

BOOL

ACKNOWLEDGE_RE‐
QUIRED_IS_ENABLED:

-

-

x

-

-

x

-

-

x

STEPS_WITH_ERROR_F AULT_WERE_DISPLA‐
YED:

-

x

-

x

-

x

x

-

x

x

-

x

x

-

x

x

-

-

x

acuse obligatorio activado

SSKIP_ENA‐ BOOL
BLED

STEP_SKIP‐
PING_IS_ENABLED:
salto de etapa activado

SACT_DISP

BOOL

ACTIVE_STEPS_WE‐
RE_DISPLAYED:
visualizar solo etapas acti‐
vas en "S_NO"

SEF_DISP

BOOL

visualizar solo las etapas
con errores y averías en
"S_NO"
SALL_DISP

BOOL

ALL_STEPS_WERE_DIS‐ PLAYED:
visualizar todas las eta‐
pas en "S_NO"

AUTO_ON

BOOL

AUTOMATIC_IS_ON:
visualización del modo de
operación automático

TAP_ON

BOOL

T_AND_PUSH_IS_ON:
visualización del modo se‐
miautomático

TOP_ON

BOOL

T_OR_PUSH_IS_ON:
visualización del modo se‐
miautomático

MAN_ON

BOOL

MANUAL_IS_ON:
visualización del modo
manual

LMO‐
DE_ENA‐
BLED

BOOL

(solo
S7-1500 a
partir de la
versión de
bloque V2.0)

LEARNING_MO‐
DE_IS_ENABLED:
Modo de aprendizaje acti‐
vado

Consulte también
Principios básicos de la interfaz de un bloque de función GRAPH (Página 8213)
Parámetros de entrada (Página 8216)
Parámetros estáticos (Página 8224)

Programación del PLC
Manual de programación y manejo, 11/2019

8223

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Lenguaje de programación GRAPH (Página 8191)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)

17.1.8.4

Parámetros estáticos

Parámetros estáticos de una etapa
Resumen de los parámetros estáticos de una etapa
La tabla siguiente muestra los parámetros que se crean en la sección "Static" de la interfaz del
bloque para cada etapa del bloque de función GRAPH:

8224

Componente

Descripción

Tipo de
datos

DB minimizado

DB estándar

S1

La etapa se activa

BOOL

x

x

L1

El interlock desaparece

BOOL

x

x

V1

La supervisión aparece

BOOL

x

x

R1

Reservado

BOOL

x

x

A1

El error se acusa

BOOL

x

x

S0

La etapa se desactiva

BOOL

x

x

L0

El interlock aparece

BOOL

x

x

V0

La supervisión desaparece

BOOL

x

x

X

La etapa está activa

BOOL

x

x

LA

El interlock no se cumple

BOOL

x

x

VA

La supervisión está pendiente

BOOL

x

x

RA

Reservado

BOOL

x

x

AA

Reservado

BOOL

x

x

SS

Interno del sistema

BOOL

x

x

LS

Resultado directo del interlock pro‐ BOOL
gramado

x

x

VS

Resultado directo de la supervisión
programada

BOOL

x

x

SNO

Número de etapa de usuario

INT

T

Tiempo total de activación de etapa TIME

-

x

x

x

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Componente

Descripción

Tipo de
datos

DB minimizado

DB estándar

U

Tiempo de activación de etapa sin
averías

TIME

-

x

T_MAX

Tiempo máximo de activación de
etapa

TIME

-

x

Tiempo de advertencia

TIME

-

x

Estado de los máx. 32 elementos
KOP/FUP en el interlock en el ciclo
de procesamiento actual

DWOR
D

-

x

Copia de CRIT_LOC si el interlock
desaparece

DWOR
D

-

x

DWOR
D

-

x

(solo
S7-300/400)

Estado de los máx. 32 elementos
KOP/FUP en la supervisión en el
ciclo de procesamiento actual

SM

Interno del sistema

BOOL

-

x

LP

Interno del sistema

BOOL

x

x

Interno del sistema

BOOL

x

x

Interno del sistema

BOOL

x

x

Interno del sistema

BOOL

x

x

H_IL_ERR

Interno del sistema

BYTE

-

x

H_SV_FLT

Interno del sistema

BYTE

-

x

RESERVED

Reservado

DWOR
D

-

x

(solo S7-1500
a partir de la
versión de blo‐
que V2.0)
T_WARN
(solo S7-1500
a partir de la
versión de blo‐
que V2.0)
CRIT_LOC
(S7-300/400)
(S7-1500 a par‐
tir de la versión
del bloque
V4.0)
CRIT_LOC_
ERR
(solo
S7-300/400)
(S7-1500 a par‐
tir de la versión
del bloque
V4.0)
CRIT_SUP

(solo
S7-300/400)
LN
(solo
S7-300/400)
VP
(solo
S7-300/400)
VN
(solo
S7-300/400)

(solo
S7-300/400)

Programación del PLC
Manual de programación y manejo, 11/2019

8225

Crear programas GRAPH
17.1 Principios básicos de GRAPH

Acceso a los componentes
Dado que los valores de los parámetros influyen en la ejecución de la cadena, el acceso de
escritura no resulta recomendable. El acceso de lectura se efectúa a través del nombre de
etapa seguido del nombre del elemento de estructura. Así, p. ej., algunos accesos posibles a
las condiciones y acciones son:
● SECAR.X
● SECAR.T

Consulte también
Inicializar primeros valores (Página 8315)
Principios básicos de la interfaz de un bloque de función GRAPH (Página 8213)
Parámetros de entrada (Página 8216)
Parámetros de salida (Página 8220)
Parámetros estáticos de una transición (Página 8226)
Otros parámetros estáticos (Página 8228)
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Lenguaje de programación GRAPH (Página 8191)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)

Parámetros estáticos de una transición
Resumen de los parámetros estáticos de una transición
La tabla siguiente muestra los parámetros que se crean en la sección "Static" de la interfaz del
bloque para cada transición del bloque de función GRAPH:
Componente

Descripción

Tipo de da‐ DB minimizado
tos

DB estándar

TV

La transición es válida

BOOL

x

x

TT

La transición se cumple

BOOL

x

x

TS

La transición conmuta

BOOL

x

x

CF_IV

La entrada "CRIT_FLT" no es
válida

BOOL

-

x

(solo
S7-300/400)

8226

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Componente

Descripción

Tipo de da‐ DB minimizado
tos

DB estándar

TNO

Visualización del número de
transición definido por el usua‐
rio

INT

-

x

CRIT

Estado de los máx. 32 elemen‐ DWORD
tos KOP/FUP de la transición
en el ciclo de procesamiento
actual

-

x

Estado de los máx. 32 elemen‐ DWORD
tos KOP/FUP de la transición
en el ciclo de procesamiento
anterior

-

x

-

x

(solo
S7-300/400)
(S7-1500 a partir
de la versión del
bloque V4.0)
CRIT_OLD
(solo
S7-300/400)
(S7-1500 a partir
de la versión del
bloque V4.0)
CRIT_FLT
(solo
S7-300/400)

Qué elemento de la transición
ha provocado finalmente la
transición.
Copia de "CRIT" si se produce
un error

DWORD

(S7-1500 a partir
de la versión del
bloque V4.0)

Acceso a los componentes
Dado que los valores de los parámetros influyen en la ejecución de la cadena, el acceso de
escritura no resulta recomendable. El acceso de lectura se efectúa a través del nombre de
transición seguido del nombre del elemento de estructura. Así, p. ej., algunos accesos posibles
a las condiciones y acciones son:
● VÁLVULA_ON.TT
● VÁLVULA_ON.CRIT

Consulte también
Principios básicos de la interfaz de un bloque de función GRAPH (Página 8213)
Parámetros de entrada (Página 8216)
Parámetros de salida (Página 8220)
Parámetros estáticos de una etapa (Página 8224)
Otros parámetros estáticos (Página 8228)
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Lenguaje de programación GRAPH (Página 8191)
Cadenas secuenciales (Página 8193)

Programación del PLC
Manual de programación y manejo, 11/2019

8227

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)

Otros parámetros estáticos
Resumen
En una CPU S7-1500, los siguientes datos estáticos están en la estructura "RT_DATA".
Los parámetros estáticos incluyen la información siguiente, además de los parámetros de
etapa y transición:
● Parámetros internos "VERSION", "S_DISPLAY", "S_SEL_OLD", "S_DISPIDX" y
"T_DISPIDX"
● Componente "MOP > Modo de operación"
● Componente "SQ_FLAGS > Marcas de cadena"
● Componente "Ciclos de tiempo"
Nota
Un bloque de datos instancia específico de GRAPH contiene otros parámetros más. No
obstante, estos están destinados únicamente al uso interno. No resulta recomendable utilizar
estos parámetros en el programa.

Parámetros internos
La tabla siguiente muestra los parámetros internos que se encuentran en la sección "Static".
Sirven para administrar los números de etapa y de transición:

8228

Compo‐
nente

Descripción

Tipo de
datos

Longitud en
bytes

DB minimizado

DB estándar

VERSION

Versión del bloque

STRIN
G[10]

2

x

x

S_DIS‐
PLAY

Copia del parámetro
de salida "S_NO"

INT

2

x

x

S_SEL_OL
D

Número de etapa de
parámetro de entrada
"S_SEL" del último ci‐
clo de la CPU

INT

2

x

x

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Compo‐
nente

Descripción

Tipo de
datos

Longitud en
bytes

DB minimizado

DB estándar

S_DIS‐
PIDX

Índice para la etapa en
el parámetro de salida
"S_NO"

BYTE

1

x

x

BYTE
T_DISPIDX Índice para la transi‐
ción en el parámetro de
salida "T_NO"

1

x

x

Modo de operación
La tabla siguiente muestra los componentes de la estructura "MOP" de la sección "Estático"
que administran los modos de operación:
Compo‐
nente

Descripción

Tipo de
datos

DB minimizado

DB estándar

AUTO

Cambio al modo automático

BOOL

x

x

MAN

Cambio al modo manual

BOOL

x

x

TAP

Cambio al modo de operación "Jog"

BOOL

x

x

TOP

Cambio al modo de operación "Auto‐
mático" o "Transición"

BOOL

x

x

ACK_S

Requisitos: acusar la etapa pendiente
en el parámetro de salida "S_NO"

BOOL

x

x

REG_S

Requisitos: registrar la etapa pendien‐
te en el parámetro de salida "S_NO"

BOOL

x

x

T_PREV

Requisitos: emitir la anterior transición
válida en el parámetro de salida
"T_NO"

BOOL

x

x

T_NEXT

Requisitos: emitir la siguiente transi‐
ción válida en el parámetro de salida
"T_NO"

BOOL

x

x

LOCK

Conectar/desconectar tratamiento de
interlock

BOOL

x

x

SUP

Conectar/desconectar tratamiento de
supervisión

BOOL

x

x

ACKREQ

Requisitos: acusar la etapa pendiente
en el parámetro de salida "S_NO"

BOOL

x

x

SSKIP

Estado: "Salto de etapa" activado

BOOL

x

x

OFF

Desactivar cadena secuencial

BOOL

x

x

INIT

Activar etapas iniciales

BOOL

x

x

HALT

Detener la cadena/dejar que prosiga

BOOL

x

x

TMS_HAL
T

Detener los temporizadores/dejar que
prosigan

BOOL

x

x

OPS_ZE‐
RO

Desconectar/conectar acciones

BOOL

x

x

SACT_DIS
P

Estado: visualizar solo las etapas acti‐
vas

BOOL

x

x

SEF_DISP

Estado: visualizar solo las etapas con
errores y averías

BOOL

x

x

Programación del PLC
Manual de programación y manejo, 11/2019

8229

Crear programas GRAPH
17.1 Principios básicos de GRAPH
Compo‐
nente

Descripción

Tipo de
datos

DB minimizado

DB estándar

SALL_DIS
P

Estado: visualizar todas las etapas

BOOL

x

x

S_PREV

Modo de operación "Automático": vi‐
sualizar la etapa anterior simultánea‐
mente activa en el parámetro de salida
"S_NO"

BOOL

x

x

BOOL

x

x

S_SELOK

BOOL
Requisitos: emitir en el parámetro de
salida "S_NO" el número de etapa pen‐
diente en el parámetro de entrada
"S_SEL"

x

x

S_ON

Modo de operación "Manual": activar la
etapa visualizada

BOOL

x

x

S_OFF

Modo de operación "Manual": desacti‐
var la etapa visualizada

BOOL

x

x

Modo de operación "Jog":

BOOL

x

x

Modo de operación "Manual": visuali‐
zar el número de etapa siguiente más
pequeño
S_NEXT

Modo de operación "Automático": vi‐
sualizar la etapa posterior simultánea‐
mente activa en el parámetro de salida
"S_NO"
Modo de operación "Manual": visuali‐
zar el número de etapa siguiente más
grande

T_PUSH

la transición conmuta si la condición
cumplida se aplica con "T_PUSH"
REG

Requisitos: registrar todos los errores
de interlock y de supervisión

BOOL

x

x

ACK

Acuse de la avería

BOOL

x

x

IL_PERM

Ejecución de interlock permanente

BOOL

x

x

T_PERM

Ejecución de transición permanente

BOOL

x

x

ILP_MAN

Ejecución de interlock permanente en
modo de operación "Manual"

BOOL

x

x

LMODE

El modo de aprendizaje está activo

BOOL

-

-

BOOL
RESET_CRITERIA: Inicializar prime‐
ros valores de enclavamientos y transi‐
ciones Tipo: Requisito

-

-

(solo
S7-1500 a
partir de la
versión de
bloque
V2.0)
RE‐
SET_CRIT
(solo
S7-1500 a
partir de la
versión de
bloque
V5.0)

8230

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH

Ciclos de reloj (solo S7-300/400)
La tabla siguiente muestra los componentes de la estructura "TICKS" de la sección "Estático"
que administran la información para el cálculo del tiempo de activación. Esta información solo
puede ser evaluada internamente por el sistema.
Compo‐
nente

Descripción

DELTA

Tipo de da‐
tos

DB minimizado

DB estándar

Diferencia de tiempo entre dos ci‐ TIME
clos

x

x

OLD

Estado de contador cíclico 10 ms
en el último ciclo

TIME

x

x

NEW

Estado de contador cíclico 10 ms
en este ciclo

TIME

x

x

Marcas de cadena
La tabla siguiente muestra los componentes de la estructura "SQ_FLAGS" de la sección
"Estático" que vigilan el estado interno de la cadena:
Compo‐
nente

Descripción

Tipo de da‐
tos

DB minimizado

DB estándar

ERR_FLT

Fallo agrupado

BOOL

x

x

ERROR

Error de interlock

BOOL

x

x

FAULT

Error de supervisión

BOOL

x

x

RT_FAIL

Error de tiempo de ejecución

BOOL

x

x

NO_SNO

La etapa seleccionada no existe

BOOL

x

x

NF_OFL

Demasiadas etapas que activar o
desactivar

BOOL

x

x

SA_OFL

Demasiadas etapas activas

BOOL

x

x

TV_OFL

Demasiadas transiciones válidas

BOOL

x

x

MSG_OFL

Demasiados avisos

BOOL

x

x

NO_SWI

No conmutar en este ciclo

BOOL

x

x

CYC_OP

Procesamiento cíclico de la cade‐ BOOL
na secuencial tras la inicialización

x

x

AS_MSG

Avisos activados o desactivados
en tiempo de ejecución por ins‐
trucción

BOOL

x

x

AS_SEND

Enviar avisos de "WR_USMSG" o BOOL
introducirlos únicamente en el bú‐
fer de diagnóstico

x

x

SQ_BUSY

Marca de flanco interna para eje‐ BOOL
cución de proceso

x

x

SA_BUSY

Marca de flanco interna para eje‐ BOOL
cución de proceso

x

x

AS_SIG

Marca de flanco para avisos de
"Alarm_S" y "Alarm_SQ"

x

x

Programación del PLC
Manual de programación y manejo, 11/2019

BOOL

8231

Crear programas GRAPH
17.1 Principios básicos de GRAPH

Acceso a los componentes
Dado que los valores de los parámetros influyen en la ejecución de la cadena, el acceso de
escritura no resulta recomendable. No obstante, el acceso de lectura es posible.

Consulte también
Principios básicos de la interfaz de un bloque de función GRAPH (Página 8213)
Parámetros de entrada (Página 8216)
Parámetros de salida (Página 8220)
Parámetros estáticos de una etapa (Página 8224)
Parámetros estáticos de una transición (Página 8226)
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Lenguaje de programación GRAPH (Página 8191)
Cadenas secuenciales (Página 8193)
Etapas y transiciones (Página 8198)
Acciones (Página 8201)
Instrucciones permanentes (Página 8211)
Condiciones (Página 8211)
Avisos de interlock y supervisión (Página 8212)

17.1.8.5

Ampliar el comportamiento estándar de GRAPH

Principios básicos de la ampliación del comportamiento estándar de GRAPH
Introducción
Los bloques de función GRAPH incluyen en la sección "Static" de la interfaz del bloque
parámetros internos, tanto visibles como invisibles. Son parámetros visibles:
● Área de datos interna "RT_DATA"
● Estructura de transición "Trans1"
● Estructura de etapa "Step1"
Son parámetros invisibles:
● Arrays de descripción y estado
Si es necesario, como ocurría en STEP 7 Classic, se puede acceder también a los parámetros
invisibles. Para ello debe utilizarse el bloque GRAPH a partir de la versión 4.0. Además del
bloque de función GRAPH se necesita un bloque de función SCL como ampliación. A cada uno
de los arrays dentro del bloque de ampliación se accede mediante offsets que están
disponibles en la estructura "RT_DATA".

8232

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.1 Principios básicos de GRAPH

Arrays
El bloque de ampliación de GRAPH permite acceder, entre otros, a los siguientes arrays:
Array

Descripción

SINI

Campo de las etapas iniciales

LSTT

Asignación de transición de salto inicial a etapa de salto final

ATAJ

Asignación de todas las transiciones alternativas de una agrupación alternativa

ATAB

Asignación de todas las transiciones alternativas de una ramificación alternativa

PSTT

Asignación de etapa inmediatamente precedente a transición

NSTT

Asignación de etapa inmediatamente siguiente a transición

ASSJ

Asignación de todas las etapas simultáneas de una agrupación simultánea

ASSB

Asignación de todas las etapas simultáneas de una ramificación simultánea

PTTS

Asignación de transición inmediatamente precedente a etapa

NTTS

Asignación de transición inmediatamente siguiente a etapa

SW_SQTS

Asignación de etapa a parte de secuencia

SWITCH

Datos para comportamiento de conmutación seguro

TVX

Campo de transiciones válidas

TTX

Campo de transiciones cumplidas

TSX

Campo de transiciones de conmutación

S00X

Campo de las etapas que desactivar (penúltimo ciclo precedente)

SOFFX

Campo_1 de las etapas que desactivar

SONX

Campo_1 de las etapas que activar

SAX

Campo de las etapas activas

SERRX

Campo de las etapas con fallo

SMX

Campo de las etapas seleccionadas

S0X

Campo_2 de las etapas que desactivar

S1X

Campo_2 de las etapas que activar

Crear bloque de función de ampliación y asignarlo a un bloque de función GRAPH
Para acceder a los parámetros internos de GRAPH existe la posibilidad de crear un bloque de
ampliación y asignarlo al bloque de función GRAPH. El bloque de ampliación puede utilizarse
como instancia individual o como multiinstancia

Requisitos
El proyecto actual es un proyecto V14 SP1.

Procedimiento
Para crear un bloque de ampliación y asignarlo a un bloque de función GRAPH, proceda del
siguiente modo:
1. Cree un bloque de función (FB) nuevo en el lenguaje de programación "GRAPH".
2. Abra las propiedades del bloque del bloque de función GRAPH nuevo.

Programación del PLC
Manual de programación y manejo, 11/2019

8233

Crear programas GRAPH
17.1 Principios básicos de GRAPH
3. En "General > Versión" ajuste la versión del bloque de función GRAPH a >= V4.0.
Nota
Nota sobre la compatibilidad del proyecto
Si el proyecto actual no es un proyecto V14 SP1, se mostrará el aviso correspondiente.
Para acceder a los parámetros internos de GRAPH a través del bloque de ampliación es
necesario actualizar el proyecto a la versión V14 SP1. No obstante, una vez actualizado el
proyecto ya no podrá procesarlo con una versión del TIA Portal anterior a V14 SP1.
4. Cree un bloque de función (FB) nuevo en el lenguaje de programación "SCL". A dicho
bloque de función se le puede dar un nombre cualquiera. El bloque de función sirve como
bloque de ampliación.
5. En la sección "InOut" de la interfaz de bloque del bloque de ampliación introduzca los
siguientes parámetros de entrada/salida:
– "io_RT_Data", tipo de datos "G7_RTDataPlus_V4" (p. ej., para la versión de bloque V4.0)
– "io_G7T", tipo de datos "Array[*] of G7_TransitionPlus_V4" (p. ej., para la versión de
bloque V4.0)
– "io_G7S", tipo de datos "Array[*] of G7_StepPlus_V4" (p. ej., para la versión de bloque
V4.0)
– "io_G7Arrays", tipo de datos "Array[*] of USInt"
6. Abra las propiedades de bloque del bloque de función GRAPH.
7. En "Atributos > Nombre del bloque de ampliación" introduzca el nombre del bloque de
función SCL.
8. Cree para el bloque de ampliación una instancia individual o una multiinstancia:
– Instancia individual:
Cree un bloque de datos de instancia del mismo tipo que el bloque de ampliación. En la
sección "InOut" de la interfaz del bloque de función GRAPH introduzca un parámetro
cuyo tipo de datos sea el bloque de ampliación.
Nota
Si desea emplear un bloque de ampliación para varios bloques de función GRAPH,
introduzca el bloque de ampliación en los atributos de los correspondientes bloques de
función GRAPH. No obstante, para cada bloque de función GRAPH cree un bloque de
datos de instancia propio del bloque de ampliación. Para definir comportamientos
diferentes para los distintos bloques de función GRAPH es posible utilizar la sección
"Static" de la interfaz del bloque de ampliación.
– Multiinstancia:
En la sección "Static" de la interfaz del bloque de función GRAPH introduzca un
parámetro cuyo tipo de datos sea el bloque de ampliación.
9. Al llamar al bloque de función GRAPH en otro bloque cualquiera se creará
automáticamente el bloque de datos de instancia para el bloque de función GRAPH.
10.Si se ha instanciado el bloque de ampliación como instancia individual, proporcione el
bloque de datos de instancia del bloque de ampliación al correspondiente parámetro de
llamada del bloque que ha definido en la sección "InOut" del bloque de función GRAPH.

8234

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.2 Configuración de GRAPH

Resultado
De este modo el bloque de ampliación está preparado, lo que permite acceder en su interior a
los parámetros internos de GRAPH. Los distintos arrays de descripción y estado están dentro
del array colectivo "io_G7Arrays". A ellos se accede a través de los offsets. Uno de tales
accesos podría ser, p. ej., así:
#t_NumberOfActiveSteps :=
#io_G7Arrays[#io_RT_DATA.OFFSETS.SAX_OFFSET] - 1;

17.2

Configuración de GRAPH

17.2.1

Sinopsis de la configuración de GRAPH

Sinopsis
La tabla siguiente muestra los ajustes que se pueden efectuar:
Ajuste

Descripción

Vista

Grupo

Área

Longitud de los nombres de eta‐
pas y transiciones

Especifica si los nombres de las etapas y
transiciones deben visualizarse en una o
dos líneas. El ajuste "Mostrar dos filas" per‐
mite ver también nombres largos.

Cargar

Desactivar cadena antes de car‐ Antes de cargar el bloque de datos de ins‐
gar el DB
tancia se desactivan todas las etapas acti‐
vas.

Programación del PLC
Manual de programación y manejo, 11/2019

8235

Crear programas GRAPH
17.2 Configuración de GRAPH
Grupo
Ajuste predeterminado
para vigilancias de tiem‐
po

Área

Ajuste

Descripción

Tiempo de activación de la etapa
sin interrupciones (U)

Tiempo de activación para la vigilancia de
tiempo de una etapa mediante la instrucción
"Superior al tiempo de activación ininterrum‐
pido de la etapa" (CMP>U)

Tiempo de activación de la etapa
(T)

Tiempo de activación para la vigilancia de
tiempo de una etapa mediante la instrucción
"Superior al tiempo de activación de la eta‐
pa" (CMP>T).

Tiempo máximo de activación de
etapa (T_MAX)

Determina el tiempo máximo que puede ha‐
ber transcurrido desde la activación de una
etapa. Este tiempo puede vigilarse con la
instrucción "Superior al tiempo máximo de
activación de etapa" (CMP>T_MAX).
También puede hacer que el sistema deter‐
mine este valor.
Consulte también: Principios básicos de la
vigilancia del tiempo de etapa (Página 8289)
Este ajuste solo es relevante para las CPU
de la serie S7-1500.

Tiempo de advertencia
(T_WARN)

Determina el tiempo tras cuyo transcurso
desde la activación de una etapa debe emi‐
tirse una advertencia. Este tiempo puede vi‐
gilarse con la instrucción "Superior al tiempo
de advertencia" (CMP>T_WARN).
También puede hacer que el sistema deter‐
mine este valor.
Consulte también: Principios básicos de la
vigilancia del tiempo de etapa (Página 8289)
Este ajuste solo es relevante para las CPU
de la serie S7-1500.

8236

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.2 Configuración de GRAPH
Grupo

Área

Ajuste

Descripción

Ajuste predeterminado
para bloques nuevos

Editor

Lenguaje en segmentos

Selección del lenguaje de programación pa‐
ra programar las condiciones.

Interfaz

Parámetros mínimos de interfaz

Inserta el juego de parámetros mínimo al
crear bloques de función GRAPH nuevos.

Parámetros de interfaz estándar

Inserta el juego de parámetros estándar al
crear bloques de función GRAPH nuevos.

Parámetros máximos de interfaz Inserta el número máximo de parámetros en
la interfaz del bloque al crear bloques de
función GRAPH.
Compilar

Generar DB minimizado

Genera durante la compilación un bloque de
datos de instancia con un juego reducido de
parámetros estáticos. De todas formas, esto
provoca restricciones en el funcionamiento.
Este ajuste puede volver a modificarse pos‐
teriormente para bloques individuales.
Consulte también: Principios básicos de la
interfaz de un bloque de función GRAPH
(Página 8213)

Propiedades
de cadena

Saltar etapas

Salta las etapas en las que la transición si‐
guiente se cumple con la simple activación
de la etapa. En este caso no se activa la eta‐
pa. Este ajuste puede modificarse posterior‐
mente para bloques individuales.

Acuse obligatorio de errores de
supervisión

Determina que los errores de supervisión
deban acusarse antes de seguir procesando
la cadena secuencial.

Permite el procesamiento permanente de to‐
Procesamiento permanente de
todos los interlocks en modo ma‐ dos los interlocks en modo manual.
nual

Propiedades
de avisos

Sincronización

Programación del PLC
Manual de programación y manejo, 11/2019

Bloqueo de selección de modo

Impide el cambio manual del modo de ope‐
ración mediante la Task Card "Test". Este
ajuste puede modificarse posteriormente pa‐
ra bloques individuales.

Asignar ENO automáticamente

Muestra el operando adicional "ENO" al eje‐
cutar un test con el estado del programa en
las CPU de la serie S7-1500.

Activar avisos

Activa los avisos de Interlock y Supervisión
para bloques de función GRAPH nuevos.
Este ajuste puede modificarse posteriormen‐
te para bloques individuales.

Transición anterior cumplida

Al buscar posibles puntos de sincronización,
marca las etapas cuya transición anterior se
ha cumplido. No se cumple la siguiente tran‐
sición.

Interlock cumplido

Al buscar posibles puntos de sincronización,
marca las etapas cuyo interlock se ha cum‐
plido. Se cumple la siguiente transición.

8237

Crear programas GRAPH
17.2 Configuración de GRAPH

Consulte también
Sinopsis de las propiedades de bloques (Página 7740)
Modificar la configuración (Página 8238)
Definir el lenguaje de programación en segmentos (Página 8240)
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Modificar ajustes para parámetros internos (Página 8244)

17.2.2

Modificar la configuración

Procedimiento
Para modificar la configuración, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. En la navegación local, seleccione el grupo "Programación PLC > GRAPH".
3. Modifique la configuración.

Resultado
El cambio se aplica sin necesidad de guardarlo explícitamente.

Consulte también
Sinopsis de la configuración de GRAPH (Página 8235)
Definir el lenguaje de programación en segmentos (Página 8240)
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Modificar ajustes para parámetros internos (Página 8244)

8238

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.2 Configuración de GRAPH

17.2.3

Versiones de GRAPH

17.2.3.1

Vista general de las versiones de GRAPH

Sinopsis
La tabla siguiente muestra las versiones disponibles para los bloques de función GRAPH y su
funcionalidad:
Versión

Descripción

V1.0

Contiene la funcionalidad básica para bloques de función GRAPH.

V2.0

Además de la funcionalidad básica ofrece el modo de aprendizaje para determinar los
valores de "T_MAX" y "T_Warn".

V3.0 *

Incluye la funcionalidad de V1.0 y V2.0, además de ampliar el volumen de funciones del
visor de código PLC y mejorar el procesamiento de avisos.

V4.0 *

Requisitos para la activación de la adquisición de primeros valores. Hay dos parámetros
estáticos nuevos para "STEPx" y tres parámetros nuevos para "Transx". Estos son nece‐
sarios para guardar el estado lógico de operandos o bien el resultado de comparadores a
partir de una etapa o una transición.
Ampliación del comportamiento estándar de GRAPH.

V5.0 *

Requisitos para:
● Necesario para compilar los nombres de etapas y transiciones de GRAPH.
● Requisitos para restablecer los primeros valores de enclavamientos y transiciones

V6.0 *

Permite subcategorías multilingües para errores de enclavamiento y supervisión y adver‐
tencias GRAPH.

* Solo para S7-1500 a partir del firmware V2.0:

En proyectos creados con el TIA Portal V15.1, el FB GRAPH se crea automáticamente con la
versión 6.0.

Consulte también
Definir la versión del bloque de función GRAPH (Página 8239)

17.2.3.2

Definir la versión del bloque de función GRAPH
Para un bloque de función GRAPH pueden utilizarse varias versiones. Dependiendo de la
versión que esté ajustada, se dispondrá de diferentes funciones. La versión puede definirse en
el árbol del proyecto o en la ventana de inspección.

Programación del PLC
Manual de programación y manejo, 11/2019

8239

Crear programas GRAPH
17.2 Configuración de GRAPH

Definir la versión del bloque de función GRAPH en el árbol del proyecto
Para definir la versión para un bloque de función GRAPH, proceda del siguiente modo:
1. En el árbol del proyecto, haga clic con el botón derecho del ratón en el bloque de función
GRAPH.
2. Elija el comando "Propiedades" del menú contextual.
Se abre un cuadro de diálogo con las propiedades del bloque.
3. Seleccione la entrada "General" en la navegación local.
4. En el área "Bloque", seleccione la versión que desea utilizar en la lista desplegable
"Versión".
5. Confirme la selección con "Aceptar".

Definir la versión del bloque de función GRAPH en la ventana de inspección
Para definir la versión para un bloque de función GRAPH en la ventana de inspección, proceda
del siguiente modo:
1. Abra el bloque de función GRAPH cuya versión desea cambiar.
2. Abra la ficha "Propiedades" en la ventana de inspección.
3. Seleccione la entrada "General" en la navegación local de la ventana de inspección.
4. En el área "Bloque", seleccione la versión que desea utilizar en la lista desplegable
"Versión".

Consulte también
Vista general de las versiones de GRAPH (Página 8239)

17.2.4

Definir el lenguaje de programación en segmentos
Para bloques de función GRAPH no es posible cambiar el lenguaje de programación del
bloque. Sin embargo, es posible definir el lenguaje de programación de los segmentos para
condiciones. Puede elegir entre KOP y FUP. El lenguaje de programación se define en el árbol
del proyecto o en la ventana de inspección.

Definir el lenguaje de programación para segmentos en el árbol del proyecto
Para definir el lenguaje de programación para segmentos en el árbol del proyecto, proceda del
siguiente modo:
1. En el árbol del proyecto, haga clic con el botón derecho del ratón en el bloque de función
GRAPH.
2. Elija el comando "Propiedades" del menú contextual.
Se abre el cuadro de diálogo con las propiedades del bloque.
3. Seleccione la entrada "General" en la navegación local.

8240

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.2 Configuración de GRAPH
4. En el área "Bloque", seleccione el lenguaje de programación que desea utilizar en la lista
desplegable "Lenguaje en segmentos".
5. Confirme la selección con "Aceptar".

Definir el lenguaje de programación para segmentos en la ventana de inspección
Para definir el lenguaje de programación para segmentos en la ventana de inspección,
proceda del siguiente modo:
1. Abra el bloque de función GRAPH cuyo lenguaje de programación desea cambiar.
2. Abra la ficha "Propiedades" en la ventana de inspección.
3. Seleccione la entrada "General" en la navegación local de la ventana de inspección.
4. En el área "Bloque", seleccione el lenguaje de programación que desea utilizar en la lista
desplegable "Lenguaje en segmentos".

Consulte también
Sinopsis de la configuración de GRAPH (Página 8235)
Modificar la configuración (Página 8238)
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Modificar ajustes para parámetros internos (Página 8244)

17.2.5

Definir el juego de parámetros de interfaz
El juego de parámetros de interfaz para bloques de función GRAPH se define de uno de los
siguientes modos:
● globalmente para todos los bloques de función GRAPH nuevos
● localmente para un bloque de función GRAPH abierto
El ajuste local tiene prioridad frente al ajuste global.
Nota
En todo momento se pueden borrar o agregar manualmente parámetros individuales de
entrada y salida en la interfaz del bloque.

Programación del PLC
Manual de programación y manejo, 11/2019

8241

Crear programas GRAPH
17.2 Configuración de GRAPH

Definir el juego de parámetros de interfaz globalmente para todos los bloques de función GRAPH
nuevos
Para definir el juego de parámetros de interfaz globalmente para todos los bloques de función
GRAPH nuevos, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. En la navegación local, seleccione el grupo "Programación PLC > GRAPH".
3. Si desea utilizar el juego de parámetros de interfaz mínimo, active la opción "Parámetros de
interfaz mínimos".
4. Si desea utilizar el juego de parámetros de interfaz estándar, active la opción "Parámetros
de interfaz estándar".
5. Si desea utilizar el juego de parámetros de interfaz máximo, active la opción "Parámetros
de interfaz máximos".

Definir el juego de parámetros de interfaz localmente para un bloque de función GRAPH abierto
Para definir el juego de parámetros de interfaz localmente para un bloque de función GRAPH
abierto, proceda del siguiente modo:
1. Si desea utilizar el juego de parámetros de interfaz mínimo, seleccione el comando
"Parámetros de interfaz mínimos" del menú "Edición > Parámetros de interfaz".
2. Si desea utilizar el juego de parámetros de interfaz estándar, seleccione el comando
"Parámetros de interfaz estándar" del menú "Edición > Parámetros de interfaz".
3. Si desea utilizar el juego de parámetros de interfaz máximo, seleccione el comando
"Parámetros de interfaz máximos" del menú "Edición > Parámetros de interfaz".
La interfaz del bloque de función GRAPH se adapta.

Consulte también
Principios básicos de la interfaz de un bloque de función GRAPH (Página 8213)
Sinopsis de la configuración de GRAPH (Página 8235)
Modificar la configuración (Página 8238)
Definir el lenguaje de programación en segmentos (Página 8240)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)
Modificar ajustes para parámetros internos (Página 8244)

17.2.6

Definir el modelo de espacio de memoria para el bloque de datos
El modelo de espacio de memoria para bloques de función GRAPH se define de uno de los
siguientes modos:
● globalmente para todos los bloques de función GRAPH nuevos
● localmente para un bloque de función GRAPH abierto

8242

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.2 Configuración de GRAPH
El ajuste local tiene prioridad frente al ajuste global.
Nota
Los parámetros específicos de GRAPH que no están disponibles en el bloque de datos
minimizado no se pueden insertar manualmente en la interfaz del bloque.

Definir el modelo de espacio de memoria globalmente para todos los bloques de función GRAPH nuevos
Para definir el modelo de espacio de memoria globalmente para todos los bloques de función
GRAPH nuevos, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. En la navegación local, seleccione el grupo "Programación PLC > GRAPH".
3. Si desea utilizar un bloque de datos minimizado, active la opción "Generar DB minimizado".
4. Si desea utilizar un bloque de datos con el modelo de espacio de memoria estándar,
desactive la opción "Generar DB minimizado".

Definir el modelo de espacio de memoria localmente para un bloque de función GRAPH abierto
Para definir el modelo de espacio de memoria localmente para un bloque de función GRAPH
abierto, proceda del siguiente modo:
1. Abra la ficha "Propiedades" en la ventana de inspección.
2. Seleccione la entrada "Atributos" en la navegación local de la ventana de inspección.
3. Si desea utilizar un bloque de datos minimizado, active la opción "Generar DB minimizado"
en el grupo "Compilar".
4. Si desea utilizar un bloque de datos con el modelo de espacio de memoria estándar,
desactive la opción "Generar DB minimizado" en el grupo "Compilar".
La interfaz del bloque GRAPH se adapta.

Consulte también
Principios básicos de la interfaz de un bloque de función GRAPH (Página 8213)
Sinopsis de la configuración de GRAPH (Página 8235)
Modificar la configuración (Página 8238)
Definir el lenguaje de programación en segmentos (Página 8240)
Definir el juego de parámetros de interfaz (Página 8241)
Modificar ajustes para parámetros internos (Página 8244)

Programación del PLC
Manual de programación y manejo, 11/2019

8243

Crear programas GRAPH
17.2 Configuración de GRAPH

17.2.7

Modificar ajustes para parámetros internos
Los parámetros internos de un bloque GRAPH pueden declararse visibles y accesibles desde
HMI. En las CPU de la serie S7-1500, los parámetros internos pueden declararse además
remanentes. Si los parámetros internos se declaran remanentes, sus valores se conservan
incluso tras un cambio de estado operativo de "STOP" a "RUN", p. ej., después de un corte de
alimentación. Como consecuencia, la cadena secuencial permanece en el estado actual y,
después del cambio a "RUN", continúa con la ejecución en el punto en el que se interrumpió.
Los parámetros que haya declarado el propio usuario en la interfaz de un bloque GRAPH no
se ven afectados por estos ajustes.

Declarar parámetros internos visibles y accesibles desde HMI
Para declarar todos los parámetros internos de un bloque GRAPH visibles y accesibles desde
HMI, proceda del siguiente modo:
1. Abra el bloque GRAPH cuyo ajuste desea modificar.
2. Active la casilla de verificación "Parámetros internos visibles/accesibles desde HMI" en el
menú "Edición". Desactive esta casilla de verificación si desea quitar este ajuste.

Declarar parámetros internos remanentes (S7-1500)
Para declarar remanentes todos los parámetros internos de un bloque GRAPH, proceda del
siguiente modo:
1. Abra el bloque GRAPH cuyo ajuste desea modificar.
2. Active la casilla de verificación "Parámetros internos remanentes" en el menú "Edición".
Desactive esta casilla de verificación si desea quitar este ajuste.
Nota
Particularidades de las CPU del S7-1500 con una versión de firmware inferior a la V1.5
Si declara como remanentes los parámetros internos de un bloque GRAPH, el control
secuencial permanecerá en el estado actual y, después del cambio a "RUN", continuará con
la ejecución en el punto en el que se interrumpió. Tenga en cuenta que al activar el nuevo
parámetro "Parámetros internos remanentes" en un bloque GRAPH, no deben utilizarse
supervisiones.

Establecer que los datos sean remanentes en el área estándar (S7-300/400)
Para establecer que los datos sean remanentes en el área estándar, proceda del siguiente
modo:
1. Abra la carpeta "Bloques de programa" en el árbol del proyecto.
2. Haga clic en el bloque de datos de instancia del bloque GRAPH con el botón derecho del
ratón.
3. Elija el comando "Propiedades" del menú contextual.
Se abre el cuadro de diálogo de propiedades del bloque.

8244

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.3 La ventana de programación de GRAPH
4. Haga clic en "Atributos" en la navegación local.
5. Active la casilla de verificación "Establecer que los datos sean remanentes en el área
estándar".
6. Confirme sus entradas con "Aceptar".

Consulte también
Sinopsis de la configuración de GRAPH (Página 8235)
Modificar la configuración (Página 8238)
Definir el lenguaje de programación en segmentos (Página 8240)
Definir el juego de parámetros de interfaz (Página 8241)
Definir el modelo de espacio de memoria para el bloque de datos (Página 8242)

17.3

La ventana de programación de GRAPH

17.3.1

Vista general de la ventana de programación

Función
La ventana de programación es el área en la que se crea el programa GRAPH. Además del
área de trabajo propiamente dicha, contiene un área de navegación que facilita el acceso a
todas las áreas del bloque de función GRAPH.
Las tareas siguientes se realizan en la ventana de programación:
● programar instrucciones permanentes anteriores y posteriores
● programar las cadenas secuenciales
● definir los avisos de interlock y supervisión
En función de lo que debe programarse es posible cambiar entre las vistas siguientes:
● Instrucciones permanentes anteriores (Página 8247)
● Vista de cadena (Página 8248)
● Vista de etapa individual (Página 8250)
● Instrucciones permanentes posteriores (Página 8252)
● Vista de avisos (Página 8253)
El área de trabajo así como las instrucciones y los Favoritos ofrecidos varían en función de la
vista.

Programación del PLC
Manual de programación y manejo, 11/2019

8245

Crear programas GRAPH
17.3 La ventana de programación de GRAPH

Estructura de la ventana de programación
La figura siguiente muestra la ventana de programación de GRAPH en la vista de cadena:







① Navegación
② Barra de herramientas de navegación
③ Área de trabajo
Navegación
La navegación contiene las paletas siguientes, desde las que se abren las vistas que se
indican a continuación:
● Instrucciones permanentes anteriores
● Vista de cadena
● Instrucciones permanentes posteriores
● Vista de avisos

8246

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.3 La ventana de programación de GRAPH
Adicionalmente, la navegación muestra vistas generales gráficas sobre las instrucciones
permanentes y las cadenas secuenciales, y ofrece posibilidades de edición básicas por medio
del menú contextual.
Haciendo doble clic en una etapa dentro de la navegación se cambia entre las vistas de cadena
y etapa individual.

Barra de herramientas de navegación
Mediante la barra de herramientas de navegación pueden realizarse las siguientes acciones:
● Aumentar o reducir el tamaño de los elementos dentro de la navegación
Utilizando los botones de ampliación y reducción se aumentan y reducen los elementos
gráficos de las instrucciones permanentes y cadenas dentro de la navegación. El factor de
zoom puede ajustarse individualmente para cada paleta. Al cerrar el bloque de función
GRAPH se rechaza el cambio del factor de zoom. Si desea conservar el factor de zoom
debe pulsar el botón "Memorizar disposición".
● Sincronizar la navegación
Cuando el botón está activo, la navegación y el área de trabajo se sincronizan entre sí, de
forma que siempre se muestran los mismos elementos. Si desactiva el botón, podrán
mostrarse diferentes objetos en la navegación y en el área de trabajo.

Área de trabajo
En el área de trabajo se programan los componentes individuales de la cadena secuencial.
Esto permite ver el programa GRAPH desde diferentes vistas. Dichas vistas pueden escalarse
utilizando la función de zoom.

17.3.2

Vista "Instrucciones permanentes anteriores"

Función de la vista "Instrucciones permanentes anteriores"
En la vista "Instrucciones permanentes anteriores" se programan instrucciones que se
ejecutan antes de procesar la cadena secuencial.

Programación del PLC
Manual de programación y manejo, 11/2019

8247

Crear programas GRAPH
17.3 La ventana de programación de GRAPH

Estructura de la vista "Instrucciones permanentes anteriores"
La figura siguiente muestra un ejemplo de la vista "Instrucciones permanentes anteriores"
utilizando el lenguaje de programación FUP:

Consulte también
Instrucciones permanentes (Página 8211)
Vista general de la ventana de programación (Página 8245)
Vista de cadena (Página 8248)
Vista de etapa individual (Página 8250)
Vista "Instrucciones permanentes posteriores" (Página 8252)

17.3.3

Vista de cadena

Función de la vista de cadena
La vista de cadena muestra una vista general de la estructura de la cadena secuencial y
permite ampliarla con los elementos siguientes:
● etapas
● transiciones
● operaciones de salto
● ramas
● fines de cadena
Además, es posible ampliar etapas y transiciones con un clic del ratón para visualizar o editar
acciones de una etapa y condiciones de una transición.

8248

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.3 La ventana de programación de GRAPH

Estructura de la vista de cadena
La figura siguiente muestra un ejemplo de la vista de cadena:










① Botón para ampliar o reducir una etapa
② Etapa en la vista avanzada
③ Botón para reducir una etapa
④ Botón para ampliar una transición
⑤ Transición en la vista avanzada
⑥ Botón para reducir una transición
Consulte también
Vista general de la ventana de programación (Página 8245)
Vista "Instrucciones permanentes anteriores" (Página 8247)
Vista de etapa individual (Página 8250)
Vista "Instrucciones permanentes posteriores" (Página 8252)

Programación del PLC
Manual de programación y manejo, 11/2019

8249

Crear programas GRAPH
17.3 La ventana de programación de GRAPH

17.3.4

Vista de etapa individual

Función de la vista de etapa individual
La vista de etapa individual ofrece la posibilidad de programar los elementos siguientes de una
etapa:
● Interlock
● Supervisión
● Acciones
● Transición
Además, es posible definir el título de la etapa e introducir un comentario sobre la misma.
Nota
Las acciones de la etapa y la transición correspondiente puede programarse también en la
vista de cadena.

8250

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.3 La ventana de programación de GRAPH

Estructura de la vista de etapa individual
La figura siguiente muestra una etapa en la vista de etapa individual:











① Título de la etapa
② Comentario sobre la etapa
③ Interlock
④ Supervisión

Programación del PLC
Manual de programación y manejo, 11/2019

8251

Crear programas GRAPH
17.3 La ventana de programación de GRAPH

⑤ Acciones
⑥ Transición
Consulte también
Elementos de una etapa (Página 8199)
Vista general de la ventana de programación (Página 8245)
Vista "Instrucciones permanentes anteriores" (Página 8247)
Vista de cadena (Página 8248)
Vista "Instrucciones permanentes posteriores" (Página 8252)

17.3.5

Vista "Instrucciones permanentes posteriores"

Función de la vista "Instrucciones permanentes posteriores"
En la vista "Instrucciones permanentes posteriores" se programan instrucciones que se
ejecutan después de procesar la cadena secuencial.

Estructura de la vista "Instrucciones permanentes posteriores"
La figura siguiente muestra un ejemplo de la vista "Instrucciones permanentes posteriores"
utilizando el lenguaje de programación KOP:

Consulte también
Instrucciones permanentes (Página 8211)
Vista general de la ventana de programación (Página 8245)
Vista "Instrucciones permanentes anteriores" (Página 8247)
Vista de cadena (Página 8248)
Vista de etapa individual (Página 8250)

8252

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.3 La ventana de programación de GRAPH

17.3.6

Visor de avisos

Función del visor de avisos
En el visor de avisos se realizan las tareas siguientes:
● Activar visor de avisos
● Definir criterios de habilitación de la categoría
● Seleccionar discriminadores
● Seleccionar categoría y subcategorías para enclavamientos
● Seleccionar categoría y subcategorías para supervisiones
● Seleccionar categoría y subcategorías para advertencias GRAPH

Estructura del visor de avisos
La figura siguiente muestra el visor de avisos de un bloque de función GRAPH:











Programación del PLC
Manual de programación y manejo, 11/2019

8253

Crear programas GRAPH
17.3 La ventana de programación de GRAPH

Numeración

Significado

1

Las categorías permiten repartir los fa‐ Encontrará más información sobre las cate‐
llos que se producen en diferentes ni‐ gorías aquí: Categorías (Página 8710)
veles de urgencia, como p. ej. error,
advertencia, etc.

2

El criterio de habilitación de la catego‐ Encontrará más información sobre el criterio
ría permite definir un criterio de habili‐ de habilitación aquí: Utilizar el criterio de ha‐
tación (variable global booleana) para bilitación de la categoría (Página 8704)
el bloque de función ProDiag y para
cada categoría incluida en él, de forma
que se activen o desactiven las super‐
visiones de dicha categoría.

3

El discriminador permite definir las su‐ Encontrará más información sobre los dis‐
pervisiones que deben visualizarse en criminadores aquí: Configurar discriminado‐
un dispositivo HMI.
res (Página 8706)

4

Estructura de los textos de aviso de las
supervisiones GRAPH
La flecha verde permite saltar directa‐
mente a la configuración global de su‐
pervisiones de ProDiag, donde se defi‐
ne la estructura de los textos de aviso.

Información adicional

Encontrará más información sobre la crea‐
ción de la estructura de textos de aviso
aquí: Estructura de un aviso de supervisión
GRAPH (Página 8722)

5

Para los enclavamientos se puede de‐ Encontrará más información aquí:
finir una categoría y dos subcatego‐
Programar interlocks (Página 8286)
rías. Puede elegir entre 8 categorías
como máximo.

6

Para las supervisiones se puede defi‐
nir una categoría y dos subcategorías.
Puede elegir entre 8 categorías como
máximo.

7

Encontrará más información aquí:
Programar supervisiones (Página 8288)

Para las advertencias GRAPH emiti‐
Encontrará más información aquí: Utilizar la
das por la instrucción "T_WARN" se
vigilancia del tiempo de etapa (Página 8289)
puede definir una categoría y dos sub‐
categorías. Puede elegir entre 8 cate‐
gorías como máximo.

Consulte también
Definir avisos (Página 8310)
Vista general de la ventana de programación (Página 8245)
Vista "Instrucciones permanentes anteriores" (Página 8247)
Vista de cadena (Página 8248)
Vista de etapa individual (Página 8250)
Vista "Instrucciones permanentes posteriores" (Página 8252)

8254

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.4 Utilizar Favoritos en GRAPH

17.4

Utilizar Favoritos en GRAPH

17.4.1

Agregar elementos GRAPH a los Favoritos

Requisitos
● Hay un bloque de función GRAPH abierto en una de las vistas siguientes:
– Instrucciones permanentes anteriores
– Vista de cadena
– Vista de etapa individual
– Instrucciones permanentes posteriores
● La Task Card "Instrucciones" tiene configurado el modo multipaleta, o bien los Favoritos se
muestran también en la ventana de programación GRAPH.

Procedimiento
Para agregar instrucciones a los Favoritos, proceda del siguiente modo:
1. Abra la Task Card "Instrucciones".
2. Maximice la paleta "Instrucciones básicas".
3. En la paleta "Instrucciones básicas", navegue hasta la instrucción que desea agregar a los
Favoritos.
4. Arrastre la instrucción hasta la paleta "Favoritos" o hasta el área de Favoritos de la ventana
de programación GRAPH mediante Drag & Drop.
Nota
Para mostrar los Favoritos en la ventana de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Insertar elementos GRAPH mediante Favoritos (Página 8256)
Quitar elementos GRAPH de los Favoritos (Página 8257)

Programación del PLC
Manual de programación y manejo, 11/2019

8255

Crear programas GRAPH
17.4 Utilizar Favoritos en GRAPH

17.4.2

Insertar elementos GRAPH mediante Favoritos

Requisitos
● Hay un bloque de función GRAPH abierto en una de las vistas siguientes:
– Instrucciones permanentes anteriores
– Vista de cadena
– Vista de etapa individual
– Instrucciones permanentes posteriores
● Existen Favoritos.

Procedimiento
Para insertar una instrucción en un programa desde los Favoritos, proceda del siguiente modo:
1. Arrastre la instrucción deseada mediante Drag & Drop desde los Favoritos hasta la posición
deseada.
O:
1. Marque el punto del programa en el que quiere insertar la instrucción.
2. En los Favoritos, haga clic en la instrucción que desea insertar.
Nota
Para mostrar los Favoritos en la ventana de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Agregar elementos GRAPH a los Favoritos (Página 8255)
Quitar elementos GRAPH de los Favoritos (Página 8257)

8256

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

17.4.3

Quitar elementos GRAPH de los Favoritos

Requisitos
● Hay un bloque de función GRAPH abierto en una de las vistas siguientes:
– Instrucciones permanentes anteriores
– Vista de cadena
– Vista de etapa individual
– Instrucciones permanentes posteriores
● Existen Favoritos.

Procedimiento
Para eliminar instrucciones de los Favoritos, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la instrucción que desea eliminar dentro del
área de Favoritos.
2. Elija el comando "Eliminar instrucción" del menú contextual.
Nota
Para mostrar los Favoritos en la ventana de programación, haga clic en el botón "Mostrar
Favoritos también en el editor" de la barra de herramientas del editor de programación.

Consulte también
Agregar elementos GRAPH a los Favoritos (Página 8255)
Insertar elementos GRAPH mediante Favoritos (Página 8256)

17.5

Programar la estructura de una cadena secuencial

17.5.1

Insertar cadenas secuenciales
Si se abre un bloque de función GRAPH, la paleta "Cadenas" se expande en la navegación. En
un bloque de función GRAPH nuevo ya existe una cadena secuencial con una etapa y una
transición. Es posible insertar más cadenas secuenciales en todo momento.

Requisitos
Hay un bloque de función GRAPH abierto.

Programación del PLC
Manual de programación y manejo, 11/2019

8257

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Procedimiento
Para insertar una nueva cadena secuencial, proceda del siguiente modo:
1. En la navegación, haga clic con el botón derecho del ratón en la barra de título de la paleta
"Cadenas" o en la barra de título de una cadena secuencial ya existente.
2. Elija el comando "Insertar cadena" del menú contextual.
La nueva cadena secuencial se insertará después de la seleccionada. Si no hay ninguna
cadena secuencial seleccionada, se insertará delante de la primera.

Consulte también
Principios básicos de las cadenas secuenciales (Página 8193)
Elementos de una cadena secuencial (Página 8194)
Cambiar el nombre de cadenas secuenciales (Página 8258)
Comentar cadenas secuenciales (Página 8259)
Insertar elementos en una cadena secuencial (Página 8260)
Finalizar cadenas secuenciales (Página 8260)
Borrar cadenas secuenciales (Página 8261)
Utilizar etapas y transiciones (Página 8262)
Utilizar ramas (Página 8272)
Utilizar saltos (Página 8275)

17.5.2

Cambiar el nombre de cadenas secuenciales

Requisitos
Hay un bloque de función GRAPH abierto en la vista de cadena.

Procedimiento
Para cambiar el nombre de una cadena secuencial, proceda del siguiente modo:
1. Haga clic en la barra de título de la cadena secuencial dentro de la vista de cadena.
De manera estándar aparece el comodín "<Nueva cadena>".
2. Introduzca el nuevo nombre para la cadena secuencial.

Consulte también
Principios básicos de las cadenas secuenciales (Página 8193)
Elementos de una cadena secuencial (Página 8194)
Insertar cadenas secuenciales (Página 8257)

8258

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial
Comentar cadenas secuenciales (Página 8259)
Insertar elementos en una cadena secuencial (Página 8260)
Finalizar cadenas secuenciales (Página 8260)
Borrar cadenas secuenciales (Página 8261)
Utilizar etapas y transiciones (Página 8262)
Utilizar ramas (Página 8272)
Utilizar saltos (Página 8275)

17.5.3

Comentar cadenas secuenciales

Requisitos
Hay un bloque de función GRAPH abierto en la vista de cadena.

Procedimiento
Para introducir un comentario sobre una cadena secuencial, proceda del siguiente modo:
1. Haga clic en el área de comentario de la cadena secuencial dentro de la vista de cadena.
De manera estándar aparece el comodín "Comentario".
2. Introduzca un comentario sobre la cadena secuencial.

Consulte también
Principios básicos de las cadenas secuenciales (Página 8193)
Elementos de una cadena secuencial (Página 8194)
Insertar cadenas secuenciales (Página 8257)
Cambiar el nombre de cadenas secuenciales (Página 8258)
Insertar elementos en una cadena secuencial (Página 8260)
Finalizar cadenas secuenciales (Página 8260)
Borrar cadenas secuenciales (Página 8261)
Utilizar etapas y transiciones (Página 8262)
Utilizar ramas (Página 8272)
Utilizar saltos (Página 8275)

Programación del PLC
Manual de programación y manejo, 11/2019

8259

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

17.5.4

Insertar elementos en una cadena secuencial

Requisitos
Hay una cadena secuencial abierta en la vista de cadena.

Procedimiento
Para insertar elementos en una cadena secuencial, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la posición de la cadena secuencial en la que
desea insertar el elemento nuevo.
2. En el submenú "Insertar elemento" del menú contextual, elija el elemento que desea
insertar. Solo será posible seleccionar los elementos que se admiten en la posición
seleccionada.
O:
1. Abra la paleta "Instrucciones básicas" de la Task Card "Instrucciones".
2. Abra la carpeta "Estructura Graph".
3. Arrastre el elemento que desea insertar hasta la posición deseada de la cadena secuencial
mediante Drag & Drop. Tenga en cuenta que no es posible insertar todos los elementos en
todas las posiciones. Las posiciones permitidas se muestran con un pequeño cuadrado
verde.

Consulte también
Principios básicos de las cadenas secuenciales (Página 8193)
Elementos de una cadena secuencial (Página 8194)
Insertar cadenas secuenciales (Página 8257)
Cambiar el nombre de cadenas secuenciales (Página 8258)
Comentar cadenas secuenciales (Página 8259)
Finalizar cadenas secuenciales (Página 8260)
Borrar cadenas secuenciales (Página 8261)
Utilizar etapas y transiciones (Página 8262)
Utilizar ramas (Página 8272)
Utilizar saltos (Página 8275)

17.5.5

Finalizar cadenas secuenciales
Todas las cadenas secuenciales deben finalizarse con un salto a otra etapa dentro de la misma
cadena secuencial u otra distinta o bien con el elemento "fin de cadena". Con un salto a otra
etapa se consigue un procesamiento cíclico de la cadena secuencial.

8260

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Requisitos
Hay una cadena secuencial abierta en la vista de cadena.

Procedimiento
Para finalizar una cadena, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la flecha doble situada al final de la cadena
secuencial.
2. En el submenú "Insertar elemento" del menú contextual, elija el elemento "Fin de cadena".
O:
1. Haga clic con el botón derecho del ratón en la flecha doble situada al final de la cadena
secuencial.
2. En el submenú "Insertar elemento" del menú contextual, elija el elemento "Salto".
Se abre una vista general de todas las etapas existentes del bloque de función GRAPH.
3. Elija una etapa como destino de salto.

Consulte también
Principios básicos de las cadenas secuenciales (Página 8193)
Elementos de una cadena secuencial (Página 8194)
Insertar cadenas secuenciales (Página 8257)
Cambiar el nombre de cadenas secuenciales (Página 8258)
Comentar cadenas secuenciales (Página 8259)
Insertar elementos en una cadena secuencial (Página 8260)
Borrar cadenas secuenciales (Página 8261)
Utilizar etapas y transiciones (Página 8262)
Utilizar ramas (Página 8272)
Utilizar saltos (Página 8275)

17.5.6

Borrar cadenas secuenciales
Las cadenas secuenciales pueden volver a borrarse en cualquier momento. Sin embargo, en
el bloque de función GRAPH debe permanecer una cadena secuencial como mínimo. Al borrar
cadenas secuenciales tenga en cuenta que es posible que también se borren destinos de
saltos.

Programación del PLC
Manual de programación y manejo, 11/2019

8261

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Procedimiento
Para borrar una cadena secuencial, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la barra de título de la cadena secuencial dentro
de la navegación.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Principios básicos de las cadenas secuenciales (Página 8193)
Elementos de una cadena secuencial (Página 8194)
Insertar cadenas secuenciales (Página 8257)
Cambiar el nombre de cadenas secuenciales (Página 8258)
Comentar cadenas secuenciales (Página 8259)
Insertar elementos en una cadena secuencial (Página 8260)
Finalizar cadenas secuenciales (Página 8260)
Utilizar etapas y transiciones (Página 8262)
Utilizar ramas (Página 8272)
Utilizar saltos (Página 8275)

17.5.7

Utilizar etapas y transiciones

17.5.7.1

Insertar etapas y transiciones
Cuando se inserta un bloque de función GRAPH nuevo en el proyecto, ya contiene una cadena
secuencial con una etapa y una transición. Es posible insertar más etapas y transiciones en la
cadena secuencial.
Tenga en cuenta las reglas siguientes al insertar etapas y transiciones:
● Las etapas y transiciones deben intercalarse siempre. Esto significa que no puede haber
dos etapas o dos transiciones consecutivas.
● Por consiguiente, solo es posible insertar etapas y transiciones al final de una rama o en
lugares en los que falta una etapa o una transición.
● Una rama simultánea debe empezar siempre con una etapa.
● Una rama alternativa debe empezar siempre con una transición.
● Es posible insertar una etapa y una transición conjuntamente como pareja. Puesto que de
este modo queda garantizado que la etapa está seguida por una transición, puede hacerse
en cualquier lugar de la cadena secuencial.

8262

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Requisitos
Hay un bloque de función GRAPH abierto en la vista de cadena.

Insertar etapa
Para insertar una etapa, proceda del siguiente modo:
1. En la cadena secuencial, haga clic con el botón derecho del ratón en un lugar en el que esté
permitido insertar una etapa.
2. Elija el comando "Insertar elemento > Etapa" del menú contextual.
O:
1. Arrastre mediante Drag & Drop el elemento "Etapa" desde los Favoritos o la Task Card
"Instrucciones" hasta la posición correspondiente de la cadena secuencial.

Insertar transición
Para insertar una transición, proceda del siguiente modo:
1. En la cadena secuencial, haga clic con el botón derecho del ratón en un lugar en el que esté
permitido insertar una transición.
2. Elija el comando "Insertar elemento > Transición" del menú contextual.
O:
1. Arrastre mediante Drag & Drop el elemento "Transición" desde los Favoritos o la Task Card
"Instrucciones" hasta la posición correspondiente de la cadena secuencial.

Insertar etapa y transición conjuntamente como pareja
Para insertar una etapa y una transición conjuntamente como pareja, proceda del siguiente
modo:
1. Haga clic con el botón derecho del ratón en la posición de la cadena secuencial en la que
desea insertar la etapa y la transición.
2. Elija el comando "Insertar elemento > Etapa y transición" del menú contextual.
O:
1. Arrastre mediante Drag & Drop el elemento "Etapa y transición" desde los Favoritos o la
Task Card "Instrucciones" hasta la posición correspondiente de la cadena secuencial.

Consulte también
Etapas y transiciones (Página 8198)
Establecer y desmarcar una etapa inicial (Página 8264)
Renumerar las etapas y transiciones (Página 8265)
Renombrar las etapas y transiciones (Página 8267)
Comentar etapas (Página 8268)

Programación del PLC
Manual de programación y manejo, 11/2019

8263

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial
Copiar y pegar etapas y transiciones (Página 8269)
Saltar etapas (Página 8270)
Borrar etapas y transiciones (Página 8270)

17.5.7.2

Establecer y desmarcar una etapa inicial
Cuando se inserta un bloque de función GRAPH nuevo en el proyecto, ya contiene una cadena
secuencial con una etapa y una transición. La etapa está establecida de manera estándar
como etapa inicial. Esto significa que el procesamiento de la cadena secuencial debe empezar
siempre con esta etapa. En cualquier momento es posible definir otra etapa como inicial. En
las ramas simultáneas también se admiten varias etapas iniciales. El número máximo de
etapas iniciales es de 250. Una etapa inicial puede convertirse de nuevo en una etapa normal
desmarcándola.

Requisitos
Hay un bloque de función GRAPH abierto en la vista de cadena.

Establecer la etapa inicial
Para establecer una etapa como inicial, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la etapa que desea establecer como inicial.
2. En el menú contextual, active la casilla de verificación "Etapa inicial".

Desmarcar etapa inicial
Para desmarcar una etapa inicial y convertirla de nuevo en una etapa normal, proceda del
siguiente modo:
1. Haga clic con el botón derecho del ratón en la etapa que desea establecer como inicial.
2. En el menú contextual, desactive la casilla de verificación "Etapa inicial".

Consulte también
Etapas y transiciones (Página 8198)
Insertar etapas y transiciones (Página 8262)
Renumerar las etapas y transiciones (Página 8265)
Renombrar las etapas y transiciones (Página 8267)
Comentar etapas (Página 8268)
Copiar y pegar etapas y transiciones (Página 8269)
Saltar etapas (Página 8270)
Borrar etapas y transiciones (Página 8270)

8264

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

17.5.7.3

Renumerar las etapas y transiciones
Cuando se insertan etapas y transiciones en la cadena secuencial, estas reciben como
número el siguiente valor libre. Es posible modificar este número posteriormente. Para ello
existen las dos posibilidades siguientes:
● Asignar manualmente números nuevos a las etapas y transiciones que desee renumerar.
Al hacerlo, tenga en cuenta que no puede haber números duplicados.
● Realizar la renumeración con la ayuda del programa. Esto permite renumerar
automáticamente todas las etapas y transiciones de una rama, una cadena secuencial o un
bloque. Tenga en cuenta las siguientes diferencias:
– Renumerar dentro de una rama:
Dentro de la rama se renumeran todas las etapas o transiciones a partir de la etapa o
transición seleccionada. La renumeración finaliza cuando empieza una rama nueva.
– Renumerar dentro de una cadena secuencial:
Se renumeran todas las etapas o transiciones dentro de la cadena secuencial. Las
primera etapa o transición de la cadena secuencial obtiene el número inicial que se ha
introducido. Tenga en cuenta que al realizar la renumeración es posible que también se
cambien los números de etapas en otras cadenas secuenciales para que no se den
números duplicados.
– Renumerar dentro de un bloque:
Se renumeran todas las etapas o transiciones dentro del bloque GRAPH. Las primera
etapa o transición dentro de la primera cadena secuencial del bloque obtiene el número
inicial que se ha introducido.
También es posible renumerar solo las etapas o solo las transiciones.
Nota
Sin embargo, tenga en cuenta que esta opción no está disponible para bloques de función
GRAPH que tienen activado el atributo "Generar DB minimizado".

Requisitos
Hay un bloque de función GRAPH abierto en la vista de cadena.

Renumerar manualmente las etapas y transiciones
Para renumerar manualmente las etapas y transiciones, proceda del siguiente modo:
1. Seleccione la etapa cuyo número desea cambiar.
2. Haga clic en el número de la etapa.
3. Introduzca el nuevo número.

Programación del PLC
Manual de programación y manejo, 11/2019

8265

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Renumerar etapas y transiciones dentro de una rama con la ayuda del programa
Para renumerar las etapas y transiciones dentro de una rama con la ayuda del programa,
proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la etapa o transición a partir de la que desea
renumerar la rama.
2. Elija el comando "Renumerar" del menú contextual.
Se abre el cuadro de diálogo "Renumerar".
3. Si desea renumerar las etapas, active la casilla de verificación "Etapas" e introduzca el
número que debe recibir la etapa seleccionada.
4. Si desea renumerar las transiciones, active la casilla de verificación "Transiciones" e
introduzca el número que debe recibir la transición posterior a la etapa seleccionada.
5. Seleccione el botón de opción "Rama" en el área "Renumerar a".
6. Confirme con "Aceptar".

Renumerar etapas y transiciones dentro de una cadena secuencial con la ayuda del programa
Para renumerar las etapas y transiciones dentro de una cadena secuencial con la ayuda del
programa, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en una etapa o transición dentro de la cadena
secuencial para la que desea realizar la renumeración.
2. Elija el comando "Renumerar" del menú contextual.
Se abre el cuadro de diálogo "Renumerar".
3. Si desea renumerar las etapas, active la casilla de verificación "Etapas" e introduzca el
número que debe recibir la primera etapa de la cadena secuencial.
4. Si desea renumerar las transiciones, active la casilla de verificación "Transiciones" e
introduzca el número que debe recibir la primera transición de la cadena secuencial.
5. Seleccione el botón de opción "Cadena" en el área "Renumerar a".
6. Confirme con "Aceptar".

Renumerar etapas y transiciones dentro de un bloque de función GRAPH con la ayuda del programa
Para renumerar las etapas y transiciones dentro de un bloque de función GRAPH con la ayuda
del programa, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en una etapa o transición dentro del bloque de
función GRAPH para el que desea realizar la renumeración.
2. Elija el comando "Renumerar" del menú contextual.
Se abre el cuadro de diálogo "Renumerar".
3. Si desea renumerar las etapas, active la casilla de verificación "Etapas" e introduzca el
número que debe recibir la primera etapa del bloque de función GRAPH.
4. Si desea renumerar las transiciones, active la casilla de verificación "Transiciones" e
introduzca el número que debe recibir la primera transición del bloque de función GRAPH.

8266

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial
5. Seleccione el botón de opción "Bloque" en el área "Renumerar a".
6. Confirme con "Aceptar".

Consulte también
Etapas y transiciones (Página 8198)
Insertar etapas y transiciones (Página 8262)
Establecer y desmarcar una etapa inicial (Página 8264)
Renombrar las etapas y transiciones (Página 8267)
Comentar etapas (Página 8268)
Copiar y pegar etapas y transiciones (Página 8269)
Saltar etapas (Página 8270)
Borrar etapas y transiciones (Página 8270)

17.5.7.4

Renombrar las etapas y transiciones
Cuando se insertan etapas y transiciones en la cadena secuencial, en un principio reciben el
nombre "Step<número de etapa>" y "Trans<número de transición>". Los nombres pueden
modificarse para que el programa sea más claro. Al hacerlo, tenga en cuenta que no puede
haber nombres duplicados.

Requisitos
Hay un bloque de función GRAPH abierto en la vista de cadena.

Renombrar una etapa
Para renombrar una etapa, proceda del siguiente modo:
1. Seleccione la etapa cuyo nombre desea cambiar.
2. Haga clic en el nombre de la etapa.
3. Introduzca un nombre nuevo.

Renombrar una transición
Para cambiar el nombre de una transición, proceda del siguiente modo:
1. Haga doble clic en el nombre la transición que desee cambiar.
2. Introduzca un nombre nuevo.

Consulte también
Etapas y transiciones (Página 8198)
Insertar etapas y transiciones (Página 8262)

Programación del PLC
Manual de programación y manejo, 11/2019

8267

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial
Establecer y desmarcar una etapa inicial (Página 8264)
Renumerar las etapas y transiciones (Página 8265)
Comentar etapas (Página 8268)
Copiar y pegar etapas y transiciones (Página 8269)
Saltar etapas (Página 8270)
Borrar etapas y transiciones (Página 8270)

17.5.7.5

Comentar etapas
Existe la posibilidad de comentar etapas. Esto permite describir la finalidad de la etapa o bien
llamar la atención sobre peculiaridades, por ejemplo.

Requisitos
Hay una etapa abierta en la vista de etapa individual.

Procedimiento
Para comentar una etapa, proceda del siguiente modo:
1. En el área de comentario, haga clic en "Comentario".
Se borra el texto "Comentario" y aparece una marca de inserción.
2. Introduzca el comentario.

Consulte también
Etapas y transiciones (Página 8198)
Insertar etapas y transiciones (Página 8262)
Establecer y desmarcar una etapa inicial (Página 8264)
Renumerar las etapas y transiciones (Página 8265)
Renombrar las etapas y transiciones (Página 8267)
Copiar y pegar etapas y transiciones (Página 8269)
Saltar etapas (Página 8270)
Borrar etapas y transiciones (Página 8270)

8268

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

17.5.7.6

Copiar y pegar etapas y transiciones
Es posible copiar etapas y transiciones y pegarlas en la misma cadena secuencial u otra
distinta. De este modo se reduce el trabajo de programación cuando una etapa nueva debe
realizar tareas similares a las de una etapa ya existente. No obstante, tenga en cuenta las
particularidades siguientes:
● Al copiar etapas y transiciones también debe observarse la secuencia de etapa y transición.
Por este motivo se insertan comodines ("Missing Step", "Missing Transition") si hubiera dos
etapas o transiciones consecutivas después del proceso de inserción.
● Se cambian el nombre y el número del elemento insertado para evitar que estén duplicados.

Requisitos
Hay un bloque de función GRAPH abierto en la vista de cadena.

Copiar etapas y transiciones
Para copiar una etapa o una transición, proceda del siguiente modo:
1. Para copiar una etapa, haga clic con el botón derecho del ratón en la etapa que desea
copiar. Para copiar una transición, haga clic con el botón derecho del ratón en la transición
que desea copiar.
2. Elija el comando "Copiar" del menú contextual.

Insertar etapas y transiciones
Para insertar una etapa o una transición, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la posición de la cadena secuencial en la que
desea insertar la etapa o la transición.
2. Elija el comando "Pegar" del menú contextual.
3. Sustituya los comodines por elementos válidos, si fuera el caso.

Consulte también
Etapas y transiciones (Página 8198)
Insertar etapas y transiciones (Página 8262)
Establecer y desmarcar una etapa inicial (Página 8264)
Renumerar las etapas y transiciones (Página 8265)
Renombrar las etapas y transiciones (Página 8267)
Comentar etapas (Página 8268)
Saltar etapas (Página 8270)
Borrar etapas y transiciones (Página 8270)

Programación del PLC
Manual de programación y manejo, 11/2019

8269

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

17.5.7.7

Saltar etapas
Existe la posibilidad de impedir que se ejecuten etapas en las que las transiciones anterior y
posterior se validan al mismo tiempo. Sin embargo, en las CPUs de la serie S7-300/400 tenga
en cuenta que esta opción no puede utilizarse junto con la opción "Generar DB minimizado".

Procedimiento
Para saltar etapas para las que las transiciones anterior y posterior se validan al mismo tiempo,
proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. En la navegación local, seleccione el grupo "Programación PLC > GRAPH".
3. Active la opción "Saltar etapas" en "Propiedades de cadena".

Consulte también
Etapas y transiciones (Página 8198)
Insertar etapas y transiciones (Página 8262)
Establecer y desmarcar una etapa inicial (Página 8264)
Renumerar las etapas y transiciones (Página 8265)
Renombrar las etapas y transiciones (Página 8267)
Comentar etapas (Página 8268)
Copiar y pegar etapas y transiciones (Página 8269)
Borrar etapas y transiciones (Página 8270)

17.5.7.8

Borrar etapas y transiciones
Es posible eliminar de nuevo etapas y transiciones de la cadena secuencial. No obstante,
tenga en cuenta las particularidades siguientes:
● Al borrar etapas y transiciones también debe observarse la secuencia de etapa y transición.
Por este motivo se insertan comodines ("Missing Step", "Missing Transition") si hubiera dos
etapas o transiciones consecutivas después del proceso de borrado.
● No es posible borrar todas las etapas de una cadena secuencial, pues esta debe tener
siempre una etapa como mínimo.

Requisitos
Hay un bloque de función GRAPH abierto en la vista de cadena.

8270

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Procedimiento
Para borrar una etapa o una transición, proceda del siguiente modo:
1. Para borrar una etapa, haga clic con el botón derecho del ratón en la etapa que desea
borrar. Para borrar una transición, haga clic con el botón derecho del ratón en la transición
que desea borrar.
2. Elija el comando "Borrar" del menú contextual.
3. Sustituya los comodines por elementos válidos, si fuera el caso.

Consulte también
Etapas y transiciones (Página 8198)
Insertar etapas y transiciones (Página 8262)
Establecer y desmarcar una etapa inicial (Página 8264)
Renumerar las etapas y transiciones (Página 8265)
Renombrar las etapas y transiciones (Página 8267)
Comentar etapas (Página 8268)
Copiar y pegar etapas y transiciones (Página 8269)
Saltar etapas (Página 8270)

17.5.7.9

Mostrar y editar las traducciones de los nombres de etapas y transiciones
Es posible visualizar los nombres de las etapas y transiciones en todos los idiomas del
proyecto que se han activado en la configuración de los idiomas del proyecto y cuyas
traducciones ya estén disponibles. Encontrará más información sobre la activación de idiomas
del proyecto en AUTOHOTSPOT.
Si se modifica el nombre de la etapa o transición directamente en el editor de programación y
no se cambian los nombres en la ficha "Textos", el nombre se adaptará automáticamente en
todos los idiomas del proyecto. Esto resulta ventajoso, por ejemplo, cuando se utilizan nombre
de etapas y transiciones neutros para los diferentes idiomas.
Nota
Cambios de nombre en la ficha "Textos"
Si se modifica el nombre de la etapa o de la transición en la ficha "Textos", las modificaciones
no se mostrarán en el editor de programación. Los nombres de etapas y transiciones que se
muestran en el editor de programación no son traducibles. Corresponden a los nombres de los
elementos de interfaz de bloque en la sección "Static" del bloque GRAPH, y los nombres de
elementos de la interfaz de bloque no son traducibles.
Las traducciones de los nombres de etapa y transiciones se muestran tanto en los textos de
aviso como en los visualizadores. En el editor de programación se mantiene el nombre de
etapa y de transición predeterminado.

Programación del PLC
Manual de programación y manejo, 11/2019

8271

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Requisitos
Se ha creado por lo menos una etapa y una transición en un FB GRAPH de la versión 5.0 y el
FB GRAPH está abierto.

Procedimiento
Para visualizar el nombre de una etapa o transición en todos los idiomas del proyecto, proceda
del siguiente modo:
1. Haga clic en la etapa o transición cuyas traducciones desee visualizar.
Si desea visualizar al mismo tiempo las traducciones de varias etapas o transiciones, debe
marcar las etapas y transiciones correspondientes.
Si desea visualizar al mismo tiempo las traducciones de todas las etapas o transiciones,
haga clic en el FB GRAPH fuera de la cadena de etapas.
2. Abra la ficha "Propiedades" de la ventana de inspección.
3. Abra la ficha "Textos".
Si los nombres de las etapas y transiciones solo se muestran en el idioma actual de la
interfaz de usuario, significa que no se han seleccionado idiomas del proyecto o que
todavía no existen traducciones. Las traducciones se introducen directamente en la ficha
"Textos" de la tabla, aunque las traducciones en los distintos idiomas del proyecto se
pueden introducir también en la tabla global "Textos del proyecto". La tabla se encuentra en
el árbol del proyecto, en "Idiomas y recursos > Textos del proyecto".
Encontrará más información sobre la traducción de textos en AUTOHOTSPOT.

Resultado
En la ficha subordinada "Textos" se muestran los nombres de las etapas y transiciones
marcadas en los idiomas del proyecto deseados y, siempre que estén disponibles, las
traducciones de los nombres.

17.5.8

Utilizar ramas

17.5.8.1

Crear ramas alternativas

Requisitos
Hay una cadena secuencial abierta en la vista de cadena.

8272

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Procedimiento
Para crear una rama alternativa, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la etapa tras la cual desea insertar una rama
alternativa.
2. En el submenú "Insertar elemento" del menú contextual, elija el comando "Abrir rama
alternativa".
O:
1. Abra la paleta "Instrucciones básicas" de la Task Card "Instrucciones".
2. Abra la carpeta "Estructura Graph".
3. Arrastre el elemento "Rama alternativa" hasta la posición deseada de la cadena secuencial
mediante Drag & Drop. Las posiciones permitidas se muestran con un cuadrado verde.

Consulte también
Elementos de una cadena secuencial (Página 8194)
Crear una rama simultánea (Página 8273)
Cerrar ramas (Página 8274)
Borrar ramas (Página 8275)

17.5.8.2

Crear una rama simultánea

Requisitos
Hay una cadena secuencial abierta en la vista de cadena.

Procedimiento
Para crear una rama simultánea, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la transición tras la cual desea insertar una rama
simultánea.
2. En el submenú "Insertar elemento" del menú contextual, elija el comando "Abrir rama
simultánea".
O:
1. Abra la paleta "Instrucciones básicas" de la Task Card "Instrucciones".
2. Abra la carpeta "Estructura Graph".
3. Arrastre el elemento "Rama simultánea" hasta la posición deseada de la cadena secuencial
mediante Drag & Drop. Las posiciones permitidas se muestran con un cuadrado verde.

Programación del PLC
Manual de programación y manejo, 11/2019

8273

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Consulte también
Elementos de una cadena secuencial (Página 8194)
Crear ramas alternativas (Página 8272)
Cerrar ramas (Página 8274)
Borrar ramas (Página 8275)

17.5.8.3

Cerrar ramas
Las ramas simultáneas y alternativas se cierran del siguiente modo:
● Pueden reagruparse con su rama matriz.
● Pueden cerrarse con un fin de cadena.
● Pueden cerrarse con un salto.
Sin embargo, en una rama simultánea solo es posible insertar un fin de cadena o un salto tras
una transición.

Requisitos
Hay una rama alternativa o simultánea.

Reagrupar ramas con la rama matriz
Para reagrupar una rama abierta con su rama matriz, proceda del siguiente modo:
1. Seleccione la flecha doble situada al final de la rama.
2. Pulse y mantenga pulsado el botón izquierdo del ratón.
Al mover el puntero del ratón aparece una línea discontinua.
3. Arrastre la línea discontinua hasta una posición apropiada del segmento. Las posiciones
permitidas se muestran con un cuadrado verde.
4. Suelte el botón izquierdo del ratón.

Cerrar ramas con un fin de cadena
Para cerrar una rama con un fin de cadena, proceda del siguiente modo:
1. En caso necesario, inserte una transición al final de la rama en una rama simultánea.
2. Haga clic con el botón derecho del ratón en la flecha doble situada al final de la rama.
3. En el submenú "Insertar elemento" del menú contextual, elija el elemento "Fin de cadena".

Cerrar ramas con un salto
Para cerrar una rama con un salto, proceda del siguiente modo:
1. En caso necesario, inserte una transición al final de la rama en una rama simultánea.
2. Haga clic con el botón derecho del ratón en la flecha doble situada al final de la rama.

8274

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial
3. En el submenú "Insertar elemento" del menú contextual, elija el elemento "Salto".
Se abre una vista general de todas las etapas existentes del bloque de función GRAPH.
4. Elija una etapa como destino de salto.

Consulte también
Elementos de una cadena secuencial (Página 8194)
Crear ramas alternativas (Página 8272)
Crear una rama simultánea (Página 8273)
Borrar ramas (Página 8275)

17.5.8.4

Borrar ramas

Requisitos
Hay una rama alternativa o simultánea.

Procedimiento
Para borrar una rama, proceda del siguiente modo:
1. Seleccione la rama que desea borrar.
2. Haga clic con el botón derecho del ratón en la rama seleccionada.
3. Elija el comando "Borrar" del menú contextual.

Consulte también
Elementos de una cadena secuencial (Página 8194)
Crear ramas alternativas (Página 8272)
Crear una rama simultánea (Página 8273)
Cerrar ramas (Página 8274)

17.5.9

Utilizar saltos

17.5.9.1

Insertar saltos
Los saltos solo pueden insertarse al final de una cadena secuencial o una rama. En una rama
simultánea, el último elemento debe ser una transición.

Requisitos
Hay una cadena secuencial abierta en la vista de cadena.
Programación del PLC
Manual de programación y manejo, 11/2019

8275

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial

Procedimiento
Para insertar un salto en una cadena secuencial o una rama, proceda del siguiente modo:
1. En caso necesario, inserte una transición al final de la rama en una rama simultánea.
2. Haga clic con el botón derecho del ratón en la flecha doble situada al final de la cadena
secuencial o rama.
3. En el submenú "Insertar elemento" del menú contextual, elija el elemento "Salto".
Se abre una vista general de todas las etapas existentes del bloque de función GRAPH.
4. Elija una etapa como destino de salto.

Resultado
El salto se inserta. El salto y su destino se representan en la cadena secuencial en forma de
flecha, de modo que en el destino del salto se indica la transición de origen y en el salto la etapa
de destino.

Consulte también
Elementos de una cadena secuencial (Página 8194)
Cambiar destino de salto (Página 8276)
Navegar hasta el destino de salto (Página 8277)
Borrar saltos (Página 8277)

17.5.9.2

Cambiar destino de salto
El destino de un salto se puede modificar a posteriori.

Requisitos
● Hay un bloque de función GRAPH abierto en la vista de cadena.
● Se ha creado un salto.

Procedimiento
Para cambiar el destino de salto a posteriori, proceda del siguiente modo:
1. Haga doble clic en el número de etapa del destino de salto actual.
Se abre una vista general de todas las etapas existentes del bloque de función GRAPH.
2. Elija una etapa como nuevo destino de salto.

Consulte también
Elementos de una cadena secuencial (Página 8194)
Insertar saltos (Página 8275)

8276

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.5 Programar la estructura de una cadena secuencial
Navegar hasta el destino de salto (Página 8277)
Borrar saltos (Página 8277)

17.5.9.3

Navegar hasta el destino de salto
Desde un salto es posible navegar hasta la etapa definida como destino del salto.

Requisitos
● Hay un bloque de función GRAPH abierto en la vista de cadena.
● Se ha creado un salto.

Procedimiento
Para navegar desde un salto hasta la etapa definida como destino, proceda del siguiente modo:
1. Haga clic en el salto con el botón derecho del ratón.
2. Elija el comando "Ir a > Destino de salto" del menú contextual.

Consulte también
Elementos de una cadena secuencial (Página 8194)
Insertar saltos (Página 8275)
Cambiar destino de salto (Página 8276)
Borrar saltos (Página 8277)

17.5.9.4

Borrar saltos

Requisitos
● Hay un bloque de función GRAPH abierto en la vista de cadena.
● Se ha creado un salto.

Procedimiento
Para borrar un salto, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el salto que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Elementos de una cadena secuencial (Página 8194)
Insertar saltos (Página 8275)

Programación del PLC
Manual de programación y manejo, 11/2019

8277

Crear programas GRAPH
17.6 Programar acciones
Cambiar destino de salto (Página 8276)
Navegar hasta el destino de salto (Página 8277)

17.6

Programar acciones

17.6.1

Insertar acciones

Introducción
Existe la posibilidad de definir acciones que se ejecutan al procesar la etapa. Para comentar
acciones o adaptar llamadas de bloque puede activarse una entrada de varias líneas. El ajuste
predeterminado es la entrada de una línea. Las acciones se insertan en la vista de etapa
individual o en la vista de cadena.
Para tener una visión más clara de las acciones programadas es posible visualizar
descripciones de los eventos e identificadores.
En las acciones se asigna a un operando el valor de otro operando o de una expresión
matemática o bien el resultado de una instrucción. Utilice para ello la sintaxis siguiente:
● Asignar el valor de un operando: A:=B
● Asignar el valor de una expresión matemática: A:=B<operador>C
Están disponibles los siguientes operandos: + (suma), - (resta), * (multiplicación), /
(división), % (módulo), AND (operación lógica Y), OR (operación lógica O), XOR (operación
lógica O exclusiva)
● Asignar el resultado de una instrucción: A:=<instrucción>(B)
Las instrucciones disponibles se encuentran en la Task Card "Instrucciones".
Asegúrese de que los tipos de datos de los operandos sean compatibles entre sí.

Insertar acciones en la vista de etapa individual
Para insertar una acción en la vista de etapa individual, proceda del siguiente modo:
1. Abra la vista de etapa individual.
2. Si las acciones están contraídas, haga clic en la flecha situada delante de "Acciones".
La flecha hacia la derecha se convierte en una flecha hacia abajo y aparece la tabla con las
acciones.
3. Si desea activar la entrada de varias líneas, haga clic con el botón derecho del ratón en la
fila de la nueva acción y active el comando "Permitir entrada de varias líneas" del menú
contextual.
4. Si desea enlazar la nueva acción con un interlock, haga clic en la celda de la columna
"Interlock" y elija la entrada "-(C)- - Interlock" de la lista desplegable.
5. Si desea enlazar la nueva acción con un evento, haga clic en la celda de la columna
"Evento" y elija el evento correspondiente de la lista desplegable.

8278

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.6 Programar acciones
6. Haga clic en la celda de la columna "Identificador" y elija el identificador de la nueva acción
en la lista desplegable.
7. Introduzca la acción que debe ejecutarse en la columna "Acción". Existen las siguientes
posibilidades:
– Reemplazar los comodines con los operandos o valores que desee utilizar para la
acción. Estos se insertan con la función Drag & Drop o autocompletar.
– Utilizar instrucciones de la Task Card "Instrucciones". Para ello, arrástrelas mediante
Drag & Drop desde la Task Card hasta la columna "Acción".
– Arrastrar bloques mediante Drag & Drop desde el árbol del proyecto hasta la columna
"Acción" para abrirlos.
Nota
Al efectuar llamadas de instrucciones que dependen del tipo de datos se debe indicar un
tipo de datos. El tipo de datos puede introducirse manualmente o bien seleccionarse de una
lista desplegable haciendo clic en el pequeño rectángulo verde situado debajo del tipo de
datos existente.

Insertar acciones en la vista de cadena
Para insertar una acción en la vista de cadena, proceda del siguiente modo:
1. Abra la vista de cadena.
2. Amplíe la etapa en la que deben insertarse acciones. Para ello, haga clic en el botón situado
en el extremo superior derecho de la etapa o seleccione la etapa y pulse <Intro>.
3. Si desea activar la entrada de varias líneas, haga clic con el botón derecho del ratón en la
fila de la nueva acción y active el comando "Permitir entrada de varias líneas" del menú
contextual.
4. Si desea enlazar la nueva acción con un interlock, haga clic en la celda de la columna
"Interlock" y elija la entrada "-(C)- - Interlock" de la lista desplegable.
5. Si desea enlazar la nueva acción con un evento, haga clic en la celda de la columna
"Evento" y elija el evento correspondiente de la lista desplegable.

Programación del PLC
Manual de programación y manejo, 11/2019

8279

Crear programas GRAPH
17.6 Programar acciones
6. Haga clic en la celda de la columna "Identificador" y elija el identificador de la nueva acción
en la lista desplegable.
7. Introduzca la acción que debe ejecutarse en la columna "Acción". Existen las siguientes
posibilidades:
– Reemplazar los comodines con los operandos o valores que desee utilizar para la
acción. Estos se insertan con la función Drag & Drop o autocompletar.
– Utilizar instrucciones de la Task Card "Instrucciones". Para ello, arrástrelas mediante
Drag & Drop desde la Task Card hasta la columna "Acción".
– Arrastrar bloques mediante Drag & Drop desde el árbol del proyecto hasta la columna
"Acción" para abrirlos.
Nota
Al efectuar llamadas de instrucciones que dependen del tipo de datos se debe indicar un
tipo de datos. El tipo de datos puede introducirse manualmente o bien seleccionarse de una
lista desplegable haciendo clic en el pequeño rectángulo verde situado debajo del tipo de
datos existente.

Mostrar la descripción de los eventos
Para visualizar la descripción de los eventos, proceda del siguiente modo:
1. Haga clic en la tabla de acciones con el botón derecho del ratón.
2. Active el comando "Mostrar descripción de los eventos" del menú contextual.

Mostrar la descripción de los identificadores
Para visualizar la descripción de los identificadores, proceda del siguiente modo:
1. Haga clic en la tabla de acciones con el botón derecho del ratón.
2. Active el comando "Mostrar descripción de los identificadores" del menú contextual.

Consulte también
Modificar acciones (Página 8283)
Copiar, cortar y pegar acciones (Página 8284)
Desplazar acciones (Página 8285)
Borrar acciones (Página 8286)
Acciones (Página 8201)

8280

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.6 Programar acciones

17.6.2

Definir el tipo de datos de una instrucción GRAPH

17.6.2.1

Principios básicos de los tipos de datos de instrucciones GRAPH

Introducción
El uso de instrucciones GRAPH puede llevarse a cabo mediante uno de los dos mecanismos
siguientes:
● Como llamada de bloque
En las instrucciones que se inserten como llamada de bloque en el programa, es posible
seleccionar el tipo de datos de una lista desplegable.
● Como función interna de GRAPH
Las funciones internas de GRAPH se asignan directamente a una variable. Para ello, el
operando debe ser de un tipo de datos compatible con la función. La siguiente tabla
muestra una relación de los tipos de datos admisibles de las funciones internas de GRAPH.

Funciones internas de GRAPH
La siguiente tabla muestra las funciones internas de GRAPH y sus tipos de datos:
Funcionamiento

S7-300/400

S7-1500

BCD_TO_INT

WORD

WORD

BCD_TO_DINT

DWORD

DWORD

INT_TO_BCD

INT

INT

DINT_TO_BCD

DINT

DINT

INT_TO_DINT

INT

INT

DINT_TO_REAL

DINT

DINT

ROUND

REAL

REAL, LREAL

TRUNC

REAL

REAL, LREAL

CEIL

REAL

REAL, LREAL

FLOOR

REAL

REAL, LREAL

NEG

INT, DINT, REAL

SINT, INT, DINT, REAL, LINT, LREAL

ABS

REAL

SINT, INT, DINT, LINT, REAL, LREAL

SQR

REAL

REAL, LREAL

SQRT

REAL

REAL, LREAL

LN

REAL

REAL, LREAL

EXP

REAL

REAL, LREAL

SIN

REAL

REAL, LREAL

COS

REAL

REAL, LREAL

TAN

REAL

REAL, LREAL

ASIN

REAL

REAL, LREAL

ACOS

REAL

REAL, LREAL

ATAN

REAL

REAL, LREAL

Programación del PLC
Manual de programación y manejo, 11/2019

8281

Crear programas GRAPH
17.6 Programar acciones
Funcionamiento

S7-300/400

S7-1500

NOT

WORD, DWORD

USINT, UINT, UDINT, ULINT, SINT,
INT, DINT, LINT, BYTE, WORD,
DWORD, LWORD

RLDA

DWORD

-

RRDA

DWORD

-

SWAP

WORD, DWORD

WORD, DWORD, LWORD

AND

BYTE, WORD, DWORD

BYTE, WORD, DWORD, LWORD

OR

BYTE, WORD, DWORD

BYTE, WORD, DWORD, LWORD

XOR

BYTE, WORD, DWORD

BYTE, WORD, DWORD, LWORD

SHL

WORD, DWORD

BYTE, USINT, SINT, WORD, UINT,
INT, DWORD, UDINT, DINT, LWORD,
ULINT, LINT

SHR

WORD, DWORD

BYTE, WORD, DWORD, USINT,
UINT, UDINT, SINT, INT, DINT,
LWORD, ULINT, LINT

ROL

DWORD

BYTE, WORD, DWORD, LWORD

ROR

DWORD

BYTE, WORD, DWORD, LWORD

MOD

DINT

USINT, UINT, UDINT, SINT, INT,
DINT, ULINT, LINT

-: Función no disponible

17.6.2.2

Modificar el tipo de datos de una instrucción GRAPH
Las instrucciones GRAPH que se insertan en el programa mediante una llamada de bloque, se
insertan con un tipo de datos predeterminado. Este tipo de datos se puede modificar si es
necesario. Los tipos de datos modificables aparecen marcados con un rectángulo verde bajo
la inicial del tipo de datos. En las funciones internas de GRAPH se puede modificar el
operando.

Modificar el tipo de datos de una instrucción llamada
Para modificar el tipo de datos de una instrucción llamada, proceda del siguiente modo:
1. Haga clic en el tipo de datos de la instrucción.
Se abrirá la lista desplegable para seleccionar el tipo de datos.
2. Haga clic en el tipo de datos que desea utilizar.

Modificar el tipo de datos de una función interna de GRAPH
Para modificar el tipo de datos de una función interna de GRAPH, proceda del siguiente modo:
1. Indique como operando un valor o una variable. Tenga en cuenta el rango admisible para
el operando.

8282

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.6 Programar acciones
O bien:
1. Mantenga pulsado el botón derecho del ratón y arrastre una variable del tipo de datos
admisible por encima del operando.
2. Espere a que aparezca un marco verde en torno al operando.
3. Suelte el botón del ratón.

17.6.3

Modificar acciones
Es posible realizar los cambios siguientes en acciones:
● enlazar la acción con un interlock o deshacer el enlace con un interlock
● enlazar la acción con un evento o deshacer/modificar el enlace con un evento
● cambiar el identificador de la acción
● modificar la acción, p. ej. sustituir operandos o utilizar otra instrucción
Tenga en cuenta que determinados identificadores de acciones requieren el uso de eventos y
que en estos identificadores no es posible deshacer el enlace con un evento.

Requisitos
Hay un bloque de función GRAPH abierto en la vista de etapa individual.

Procedimiento
Para modificar una acción, proceda del siguiente modo:
1. Si desea enlazar una acción con un interlock, haga clic en la celda de la columna "Interlock"
y elija la entrada "-(C)- - Interlock" de la lista desplegable.
2. Si desea deshacer el enlace con un interlock, haga clic en la celda de la columna "Interlock"
y elija la entrada " - Ninguna condición" de la lista desplegable.
3. Si desea enlazar la acción con un evento o modificar el evento enlazado, haga clic en la
celda de la columna "Evento" y elija el evento correspondiente de la lista desplegable.
4. Si desea deshacer el enlace con un evento, haga clic en la celda de la columna "Evento" y
elija la entrada " - Ningún evento" de la lista desplegable. Si el identificador de la acción
requiere un evento, el fondo de la celda se marcará en rojo y se mostrará "<???>". En ese
caso, vuelva a asignar un evento o seleccione otro identificador.

Programación del PLC
Manual de programación y manejo, 11/2019

8283

Crear programas GRAPH
17.6 Programar acciones
5. Si desea modificar el identificador de la acción, haga clic en la celda de la columna
"Identificador" y elija el nuevo identificador de la acción en la lista desplegable.
6. Si desea modificar la acción, haga clic en la acción dentro de la columna "Acción" y realice
uno de los cambios siguientes:
– Cambie el o los operandos de la acción.
– Para cambiar el tipo de datos de un operando, haga clic en el pequeño rectángulo verde
y elija el nuevo tipo de datos de la lista desplegable.
– Para utilizar otra instrucción, borre la acción existente y arrastre otra instrucción desde
la Task Card "Instrucciones" hasta la columna "Acción". Introduzca los operandos.
– Para llamar otro bloque, borre la acción existente y arrastre un bloque mediante Drag &
Drop desde el árbol del proyecto hasta la columna "Acción" para llamarlo.

Consulte también
Insertar acciones (Página 8278)
Copiar, cortar y pegar acciones (Página 8284)
Desplazar acciones (Página 8285)
Borrar acciones (Página 8286)
Acciones (Página 8201)

17.6.4

Copiar, cortar y pegar acciones

Requisitos
Hay un bloque de función GRAPH abierto en la vista de etapa individual.

Copiar acciones
Para copiar una acción, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la primera celda de la acción que desea copiar.
2. Elija el comando "Copiar" del menú contextual.

Cortar acciones
Para cortar una acción, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la primera celda de la acción que desea cortar.
2. Elija el comando "Cortar" del menú contextual.

8284

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.6 Programar acciones

Pegar acciones desde el portapapeles
Para pegar una acción desde el portapapeles, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la posición en la que desea insertar la acción.
2. Elija el comando "Pegar" del menú contextual.

Consulte también
Insertar acciones (Página 8278)
Modificar acciones (Página 8283)
Desplazar acciones (Página 8285)
Borrar acciones (Página 8286)
Acciones (Página 8201)

17.6.5

Desplazar acciones
Las acciones se pueden desplazar dentro de la tabla de acciones.

Requisitos
Hay un bloque de función GRAPH abierto en la vista de etapa individual.

Procedimiento
Para desplazar una acción dentro de la tabla de acciones, proceda del siguiente modo:
1. Haga clic en la primera celda de la acción que desea desplazar y mantenga pulsado el
botón del ratón.
La acción se selecciona.
2. Arrastre la acción hasta la posición deseada mediante Drag & Drop.

Consulte también
Insertar acciones (Página 8278)
Modificar acciones (Página 8283)
Copiar, cortar y pegar acciones (Página 8284)
Borrar acciones (Página 8286)
Acciones (Página 8201)

Programación del PLC
Manual de programación y manejo, 11/2019

8285

Crear programas GRAPH
17.7 Programar condiciones

17.6.6

Borrar acciones

Requisitos
Hay un bloque de función GRAPH abierto en la vista de etapa individual.

Procedimiento
Para borrar una acción, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la primera celda de la acción que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Insertar acciones (Página 8278)
Modificar acciones (Página 8283)
Copiar, cortar y pegar acciones (Página 8284)
Desplazar acciones (Página 8285)
Acciones (Página 8201)

17.7

Programar condiciones

17.7.1

Programar interlocks
En el segmento de interlock es posible utilizar un máximo de 32 instrucciones con un máximo
de 32 operandos interconectados. En KOP, las instrucciones pueden insertarse tanto en un
circuito como en la barra de alimentación.

Requisitos
Hay un bloque de función GRAPH abierto en la vista de etapa individual.

Procedimiento
Para programar interlocks, proceda del siguiente modo:
1. Abra el segmento de interlock haciendo clic en la pequeña flecha situada delante de
"Interlock -(c)-".
2. Abra la Task Card "Instrucciones".
3. Navegue hasta la instrucción que desea insertar.

8286

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.7 Programar condiciones
4. Arrastre la instrucción hasta la posición deseada del segmento mediante Drag & Drop.
5. En la columna "Interlock" de la tabla de acciones, haga clic en la celda de la acción que
desea enlazar con el interlock y elija la entrada "-(C)- - Interlock" de la lista desplegable.
O:
1. Abra el segmento de interlock haciendo clic en la pequeña flecha situada delante de
"Interlock -(c)-".
2. Abra la Task Card "Instrucciones".
3. En la paleta "Instrucciones básicas", navegue hasta "KOP/FUP > General > Cuadro vacío".
4. Arrastre el elemento "Cuadro vacío" hasta la posición deseada del segmento mediante
Drag & Drop.
5. Haga clic en "??".
Se abre un campo de texto.
6. Haga clic en el botón para la función automática de autocompletar o pulse la combinación
de teclas <Ctrl+I>.
Se abre la función automática de autocompletar. Contiene solo los elementos admisibles
en función del contexto.
7. Seleccione el elemento deseado de la lista desplegable.
8. En la columna "Interlock" de la tabla de acciones, haga clic en la celda de la acción que
desea enlazar con el interlock y elija la entrada "-(C)- - Interlock" de la lista desplegable.

Consulte también
Condiciones (Página 8211)
Insertar condiciones de supervisión (Página 8288)
Programar transiciones (Página 8293)
Programar instrucciones permanentes (Página 8295)
Mostrar u ocultar informaciones de variables (Página 8303)
Definir el lenguaje de programación en segmentos (Página 8240)

Programación del PLC
Manual de programación y manejo, 11/2019

8287

Crear programas GRAPH
17.7 Programar condiciones

17.7.2

Programar supervisiones

17.7.2.1

Insertar condiciones de supervisión
En el segmento de supervisión es posible utilizar un máximo de 32 instrucciones con un
máximo de 32 operandos interconectados. En KOP, las instrucciones pueden insertarse tanto
en un circuito como en la barra de alimentación.
Nota
Para las CPU de la serie S7-1500 es posible programar una supervisión del tiempo de etapa.
Para ello se dispone de las dos instrucciones "Superior al tiempo máximo de activación de
etapa" (CMP>T_MAX) y "Superior al tiempo de advertencia" (CMP>T_WARN), y de una
bobina de advertencia (-(w)-). Los valores de comparación para las dos instrucciones se
pueden especificar manualmente o bien hacer que el sistema los determine mediante el modo
de aprendizaje.

Requisitos
Hay un bloque de función GRAPH abierto en la vista de etapa individual.

Procedimiento
Para programar supervisiones, proceda del siguiente modo:
1. Abra el segmento de supervisión haciendo clic en la pequeña flecha situada delante de
"Supervisión -(v)-".
2. Abra la Task Card "Instrucciones".
3. Navegue hasta la instrucción que desea insertar.
4. Arrastre la instrucción hasta la posición deseada del segmento mediante Drag & Drop.
O:
1. Abra el segmento de supervisión haciendo clic en la pequeña flecha situada delante de
"Supervisión -(v)-".
2. Abra la Task Card "Instrucciones".
3. En la paleta "Instrucciones básicas", navegue hasta "KOP/FUP > General > Cuadro vacío".
4. Arrastre el elemento "Cuadro vacío" hasta la posición deseada del segmento mediante
Drag & Drop.
5. Haga clic en "??".
Se abre un campo de texto.
6. Haga clic en el botón para la función automática de autocompletar o pulse la combinación
de teclas <Ctrl+I>.
Se abre la función automática de autocompletar. Contiene solo los elementos admisibles
en función del contexto.
7. Seleccione el elemento deseado de la lista desplegable.

8288

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.7 Programar condiciones

Consulte también
Condiciones (Página 8211)
Programar interlocks (Página 8286)
Programar transiciones (Página 8293)
Programar instrucciones permanentes (Página 8295)
Mostrar u ocultar informaciones de variables (Página 8303)
Definir el lenguaje de programación en segmentos (Página 8240)

17.7.2.2

Utilizar la vigilancia del tiempo de etapa

Principios básicos de la vigilancia del tiempo de etapa
Introducción
Las condiciones de supervisión permiten vigilar el tiempo de activación de etapa, es decir, el
tiempo que ha pasado desde que se activó la etapa. Para ello se especifica el tiempo máximo
"T_MAX" y se usa como valor de comparación. Para ejecutar la comparación se dispone de la
instrucción "Superior al tiempo máximo de activación de etapa" (CMP>T_MAX). Si se
sobrepasa el tiempo máximo de activación de etapa se dispara un error de supervisión y se
emite un aviso de supervisión, si es que está activado. Para recibir un aviso antes de que se
produzca el error de supervisión, se especifica un tiempo de advertencia "T_WARN" y se vigila
además mediante una condición de supervisión. Para ello se utiliza la instrucción "Superior al
tiempo de advertencia" (CMP>T_WARN) y una bobina de advertencia.
En un principio, para los valores "T_MAX" y "T_WARN" se utilizan los valores definidos en
"Programación PLC > GRAPH > Preajuste para vigilancias de tiempo". Los tiempos de
"T_MAX" y "T_WARN" se pueden modificar de distinta manera:
● Manualmente en el cuadro de diálogo "Definir tiempo" (Página 8291)
● Mediante el modo de aprendizaje de la interfaz (Página 8292)
● Con el modo de aprendizaje durante el test (Página 8538)
Si se usa el modo de aprendizaje, el tiempo de activación de las etapas se mide durante la
ejecución del programa. Cuanto más tiempo esté activado el modo de aprendizaje, con tanto
mayor precisión puede determinarse el tiempo de activación. Los tiempos de "T_MAX" y
"T_WARN" resultan de las sumas de los tiempos determinados y los valores umbral aditivos
que pueden especificarse.
Si los tiempos se determinan mediante el modo de aprendizaje durante el test, es posible
resetear los tiempos aprendidos si es necesario. De este modo "T_MAX" y "T_WARN"
recuperan sus valores predeterminados en el bloque de datos de instancia.
Nota
Para bloques GRAPH con una versión anterior a 2.0 no está disponible el modo de aprendizaje
para determinar "T_MAX" y "T_WARN". La versión se puede modificar en las propiedades del
bloque GRAPH, en "General > Bloque":

Programación del PLC
Manual de programación y manejo, 11/2019

8289

Crear programas GRAPH
17.7 Programar condiciones

Consulte también
Programar la vigilancia del tiempo de etapa (Página 8290)
CMP>T_MAX: Superior al tiempo máximo de activación de etapa (Página 2216)
CMP>T_WARN: Superior al tiempo de advertencia (Página 2218)
CMP>T_MAX: Superior al tiempo máximo de activación de etapa (Página 2229)
CMP>T_WARN: Superior al tiempo de advertencia (Página 2231)

Programar la vigilancia del tiempo de etapa
Requisitos
● Se ha activado el visor de avisos para el bloque de función GRAPH.
Consulte también: Activar y desactivar el visor de avisos (Página 8310)
● Se han definido los textos de aviso para el bloque de función GRAPH.
Consulte también: Editar avisos (Página 8310)
● El bloque de función GRAPH está abierto en la vista de etapa individual.

Procedimiento
Para programar una vigilancia del tiempo de etapa que contenga una supervisión y una
advertencia, proceda del siguiente modo:
1. Abra el segmento de supervisión haciendo clic en la pequeña flecha situada delante de
"Supervisión -(V)-".
2. Abra la Task Card "Instrucciones".
3. Inserte la instrucción "CMP>T_MAX" en el circuito con la bobina de supervisión "-(V)-".
4. Inserte la instrucción "CMP>T_WARN" en un circuito nuevo.
5. Inserte la instrucción "-(W)-" en el circuito nuevo.
6. Determine los tiempos para "T_MAX" y "T_WARN" manualmente o bien mediante el modo
de aprendizaje.

Resultado
Si el tiempo de activación de etapa es mayor que el tiempo definido para "T_WARN" se
muestra una advertencia. Si también se sobrepasa el tiempo de "T_MAX", se emite un aviso
de supervisión.

Consulte también
Principios básicos de la vigilancia del tiempo de etapa (Página 8289)
Definir manualmente los tiempos de T_MAX y T_WARN (Página 8291)
Determinar tiempos para T_MAX y T_WARN mediante el modo de aprendizaje de la interfaz.
(Página 8292)

8290

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.7 Programar condiciones
Determinar tiempos para T_MAX y T_WARN durante el test (Página 8538)
CMP>T_MAX: Superior al tiempo máximo de activación de etapa (Página 2216)
CMP>T_WARN: Superior al tiempo de advertencia (Página 2218)
CMP>T_MAX: Superior al tiempo máximo de activación de etapa (Página 2229)
CMP>T_WARN: Superior al tiempo de advertencia (Página 2231)

Definir manualmente los tiempos de T_MAX y T_WARN
Requisitos
● El bloque de función GRAPH está abierto en la vista de etapa individual.
● Para la etapa se ha programado una vigilancia del tiempo de etapa.

Procedimiento
Para definir manualmente los tiempos de "T_MAX" y "T_WARN", proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el segmento de supervisión.
2. Elija el comando "Definir tiempo" del menú contextual.
Se abre el cuadro de diálogo "Definir tiempo".
3. Introduzca los tiempos para "T_MAX" y "T_WARN".
4. Confirme las entradas realizadas con "Aceptar".
Los tiempos introducidos se aplican en la interfaz de bloque como valores predeterminados
para los parámetros de etapa estáticos "T_MAX" y "T_WARN".

Consulte también
Principios básicos de la vigilancia del tiempo de etapa (Página 8289)
Programar la vigilancia del tiempo de etapa (Página 8290)
Determinar tiempos para T_MAX y T_WARN mediante el modo de aprendizaje de la interfaz.
(Página 8292)
CMP>T_MAX: Superior al tiempo máximo de activación de etapa (Página 2216)
CMP>T_WARN: Superior al tiempo de advertencia (Página 2218)
CMP>T_MAX: Superior al tiempo máximo de activación de etapa (Página 2229)
CMP>T_WARN: Superior al tiempo de advertencia (Página 2231)

Programación del PLC
Manual de programación y manejo, 11/2019

8291

Crear programas GRAPH
17.7 Programar condiciones

Determinar tiempos para T_MAX y T_WARN mediante el modo de aprendizaje de la interfaz.
Los tiempos de "T_MAX" y "T_WARN" pueden determinarse directamente mediante la llamada
del bloque de función GRAPH. Sin embargo, deben considerarse las restricciones siguientes
frente al uso del modo de aprendizaje durante el test, que se inicia en la Task Card "Test":
● Los valores determinados solo se guardan en el bloque de datos de instancia online.
● Los tiempos aprendidos no pueden resetearse.
Para que "T_MAX" y "T_WARN" sean mayores que los tiempos de activación aprendidos,
existe la posibilidad de definir valores umbral aditivos que se sumen a los tiempos aprendidos.
Introduzca para la advertencia un valor menor que para la supervisión de modo que la
advertencia se muestre antes que la supervisión.

Requisitos
El bloque de función GRAPH se llama en el programa.

Definir valores umbral aditivos
Para definir valores umbral aditivos, haga lo siguiente:
1. Inserte la instrucción "MOVE" en el bloque que llama el bloque de función GRAPH.
2. Introduzca en el parámetro "IN" el valor umbral aditivo para la supervisión en porcentaje.
3. Introduzca en el parámetro "OUT1" el parámetro estático "RT_DATA > TRESHOLD_SUP"
del bloque de datos de instancia.
4. Inserte otra instrucción "MOVE".
5. Introduzca en el parámetro "IN" el valor umbral aditivo para la advertencia en porcentaje.
6. Introduzca en el parámetro "OUT1" el parámetro estático "RT_DATA >
TRESHOLD_WARN" del bloque de datos de instancia.
Los valores umbral aditivos se tienen en cuenta a la hora de calcular "T_MAX" y "T_WARN"
en el modo de aprendizaje.

Activar modo de aprendizaje
Para activar el modo de aprendizaje desde la interfaz, proceda del siguiente modo:
1. Ajuste el juego de parámetros de interfaz a "Parámetros de interfaz máximos" o inserte
manualmente los dos parámetros en la interfaz del bloque de función GRAPH:
– Parámetro de entrada "EN_LMODE"
– Parámetro de salida "LMODE_ENABLED"
2. Abra el bloque que efectúa la llamada.
3. Enlace el parámetro de entrada "EN_LMODE" con una variable.
4. Cargue el bloque en el dispositivo.
5. Haga clic en la barra de herramientas en "Activar/desactivar observación" para iniciar el test
con el estado del programa para el bloque invocante.

8292

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.7 Programar condiciones
6. Haga clic con el botón derecho del ratón en la variable que ha enlazado con el parámetro
de entrada "EN_LMODE".
7. Elija el comando "Forzar > Forzar a 1" del menú contextual para obtener un flanco
ascendente para el parámetro de entrada "EN_LMODE".
El estado lógico de "LMODE_ENABLED" se pone a "1" y se activa el modo de aprendizaje.
8. Espere hasta que cada etapa del bloque de función GRAPH haya estado activa como
mínimo una vez.
9. De nuevo, haga clic con el botón derecho del ratón en la variable que ha enlazado con el
parámetro de entrada "EN_LMODE".
10.Elija el comando "Forzar > Forzar a 0" del menú contextual para resetear el parámetro de
entrada "EN_LMODE".
11.De nuevo, haga clic con el botón derecho del ratón en la variable que ha enlazado con el
parámetro de entrada "EN_LMODE".
12.Elija el comando "Forzar > Forzar a 1" del menú contextual para obtener un flanco
ascendente para el parámetro de entrada "EN_LMODE".
El modo de aprendizaje se desactiva. Los tiempos aprendidos se aplican en el bloque de
datos de instancia online del bloque de función GRAPH.

Consulte también
Principios básicos de la vigilancia del tiempo de etapa (Página 8289)
Programar la vigilancia del tiempo de etapa (Página 8290)
Definir manualmente los tiempos de T_MAX y T_WARN (Página 8291)
CMP>T_MAX: Superior al tiempo máximo de activación de etapa (Página 2216)
CMP>T_WARN: Superior al tiempo de advertencia (Página 2218)
CMP>T_MAX: Superior al tiempo máximo de activación de etapa (Página 2229)
CMP>T_WARN: Superior al tiempo de advertencia (Página 2231)

17.7.3

Programar transiciones
En el segmento de transición es posible utilizar un máximo de 32 instrucciones con un máximo
de 32 operandos interconectados. En KOP, las instrucciones pueden insertarse tanto en un
circuito como en la barra de alimentación. Las transiciones se programan en la vista de etapa
individual o en la vista de cadena.

Programar transiciones en la vista de etapa individual
Para programar transiciones en la vista de etapa individual, proceda del siguiente modo:
1. Abra la vista de etapa individual.
2. Abra el segmento de transición haciendo clic en la pequeña flecha situada delante de
"<número de transición> - <nombre de transición>".
3. Abra la Task Card "Instrucciones".

Programación del PLC
Manual de programación y manejo, 11/2019

8293

Crear programas GRAPH
17.7 Programar condiciones
4. Navegue hasta la instrucción que desea insertar.
5. Arrastre la instrucción hasta la posición deseada del segmento mediante Drag & Drop.
O:
1. Abra el segmento de transición haciendo clic en la pequeña flecha situada delante de
"<número de transición> - <nombre de transición>".
2. Abra la Task Card "Instrucciones".
3. En la paleta "Instrucciones básicas", navegue hasta "KOP/FUP > General > Cuadro vacío".
4. Arrastre el elemento "Cuadro vacío" hasta la posición deseada del segmento mediante
Drag & Drop.
5. Haga clic en "??".
Se abre un campo de texto.
6. Haga clic en el botón para la función automática de autocompletar o pulse la combinación
de teclas <Ctrl+I>.
Se abre la función automática de autocompletar. Contiene solo los elementos admisibles
en función del contexto.
7. Seleccione el elemento deseado de la lista desplegable.

Programar transiciones en la vista de cadena
Para programar transiciones en la vista de cadena, proceda del siguiente modo:
1. Abra la vista de cadena.
2. Amplíe la transición que desea programar. Para ello, haga clic en el botón situado junto a
la transición o seleccione la transición y pulse <Intro>.
3. Abra la Task Card "Instrucciones".
4. Navegue hasta la instrucción que desea insertar.
5. Arrastre la instrucción hasta la posición deseada del segmento mediante Drag & Drop.
O:
1. Abra la Task Card "Instrucciones".
2. En la paleta "Instrucciones básicas", navegue hasta "KOP/FUP > General > Cuadro vacío".
3. Arrastre el elemento "Cuadro vacío" hasta la posición deseada del segmento mediante
Drag & Drop.
4. Haga clic en "??".
Se abre un campo de texto.
5. Haga clic en el botón para la función automática de autocompletar o pulse la combinación
de teclas <Ctrl+I>.
Se abre la función automática de autocompletar. Contiene solo los elementos admisibles
en función del contexto.
6. Seleccione el elemento deseado de la lista desplegable.

8294

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.7 Programar condiciones

Consulte también
Condiciones (Página 8211)
Programar interlocks (Página 8286)
Insertar condiciones de supervisión (Página 8288)
Programar instrucciones permanentes (Página 8295)
Mostrar u ocultar informaciones de variables (Página 8303)
Definir el lenguaje de programación en segmentos (Página 8240)

17.7.4

Programar instrucciones permanentes

17.7.4.1

Trabajar con segmentos

Utilizar segmentos
Función
Las instrucciones permanentes se programan dentro de los segmentos en un bloque de
función GRAPH. Para poder programar una instrucción permanente debe haber como mínimo
un segmento. El programa también se puede dividir en varios segmentos para facilitar la
claridad.

Consulte también
Insertar segmentos (Página 8295)
Seleccionar segmentos (Página 8296)
Copiar e insertar segmentos (Página 8297)
Borrar segmentos (Página 8298)
Contraer y expandir segmentos (Página 8298)
Insertar título del segmento (Página 8299)
Navegar en segmentos (Página 8300)

Insertar segmentos
Requisitos
Un bloque está abierto.

Programación del PLC
Manual de programación y manejo, 11/2019

8295

Crear programas GRAPH
17.7 Programar condiciones

Procedimiento
Para insertar un segmento nuevo, proceda del siguiente modo:
1. Seleccione el segmento debajo del cual desea insertar un segmento nuevo.
2. Elija el comando "Insertar segmento" del menú contextual.

Resultado
Se inserta un nuevo segmento vacío en el bloque.

Consulte también
Utilizar segmentos (Página 8295)
Seleccionar segmentos (Página 8296)
Copiar e insertar segmentos (Página 8297)
Borrar segmentos (Página 8298)
Contraer y expandir segmentos (Página 8298)
Insertar título del segmento (Página 8299)
Navegar en segmentos (Página 8300)

Seleccionar segmentos
Requisitos
Existe un segmento.

Seleccionar un segmento
Para seleccionar un segmento, proceda del siguiente modo:
1. Haga clic en la barra de título del segmento que desea seleccionar.

Seleccionar varios segmentos
Para seleccionar varios segmentos individuales, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Ctrl>.
2. Haga clic en todos los segmentos que desea seleccionar.
Para seleccionar varios segmentos consecutivos, proceda del siguiente modo:
1. Pulse y mantenga oprimida la tecla <Mayús>.
2. Haga clic en el primer segmento que desea seleccionar.
3. Haga clic en el último segmento que desea seleccionar.
Se seleccionan el primer y último segmento, así como todos los segmentos que se
encuentran entre éstos.

8296

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.7 Programar condiciones

Consulte también
Utilizar segmentos (Página 8295)
Insertar segmentos (Página 8295)
Copiar e insertar segmentos (Página 8297)
Borrar segmentos (Página 8298)
Contraer y expandir segmentos (Página 8298)
Insertar título del segmento (Página 8299)
Navegar en segmentos (Página 8300)

Copiar e insertar segmentos
Los segmentos copiados pueden insertarse en el mismo bloque o en un bloque diferente. Los
segmentos creados en KOP o FUP también pueden insertarse en los bloques de cada uno de
los lenguajes de programación diferentes.

Requisitos
Existe un segmento.

Procedimiento
Para copiar e insertar un segmento, proceda del siguiente modo:
1. Seleccione el o los segmentos que desea copiar.
2. Elija el comando "Copiar" del menú contextual.
3. Seleccione el segmento debajo del cual desea insertar el segmento copiado.
4. Elija el comando "Pegar" del menú contextual.

Consulte también
Utilizar segmentos (Página 8295)
Insertar segmentos (Página 8295)
Seleccionar segmentos (Página 8296)
Borrar segmentos (Página 8298)
Contraer y expandir segmentos (Página 8298)
Insertar título del segmento (Página 8299)
Navegar en segmentos (Página 8300)

Programación del PLC
Manual de programación y manejo, 11/2019

8297

Crear programas GRAPH
17.7 Programar condiciones

Borrar segmentos
Requisitos
Existe un segmento.

Procedimiento
Para borrar un segmento, proceda del siguiente modo:
1. Seleccione el segmento que desea borrar.
2. Elija el comando "Borrar" del menú contextual.

Consulte también
Utilizar segmentos (Página 8295)
Insertar segmentos (Página 8295)
Seleccionar segmentos (Página 8296)
Copiar e insertar segmentos (Página 8297)
Contraer y expandir segmentos (Página 8298)
Insertar título del segmento (Página 8299)
Navegar en segmentos (Página 8300)

Contraer y expandir segmentos
Requisitos
Existe un segmento.

Expandir y contraer un segmento
Para abrir un segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia la derecha situada en la barra de título del segmento.
Para cerrar un segmento, proceda del siguiente modo:
1. Haga clic en la flecha hacia abajo situada en la barra de título del segmento.

Expandir y contraer todos los segmentos
Para expandir o contraer todos los segmentos, proceda del siguiente modo:
1. Haga clic en el botón "Abrir todos los segmentos" o "Cerrar todos los segmentos" de la barra
de herramientas.

8298

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.7 Programar condiciones

Consulte también
Utilizar segmentos (Página 8295)
Insertar segmentos (Página 8295)
Seleccionar segmentos (Página 8296)
Copiar e insertar segmentos (Página 8297)
Borrar segmentos (Página 8298)
Insertar título del segmento (Página 8299)
Navegar en segmentos (Página 8300)

Insertar título del segmento
El título de segmento es la cabecera de un segmento. La longitud del título del segmento está
limitada a una línea. Puede introducir el título manualmente o definirlo de forma automática. Si
elige el ajuste automático, puede aplicarlo a segmentos individuales o establecer en la
configuración que el título del segmento debe definirse de forma automática.
Para la inserción automática del título del segmento se evalúa el comentario del operando de
una de las siguientes instrucciones del segmento:
● Asignación
● Activar salida
● Desactivar salida
Para ello, se utiliza la instrucción que aparece primero en el segmento.
El título del segmento solo se inserta automáticamente si se cumplen las siguientes
condiciones:
● El segmento todavía no tiene ningún título.
● El operando de la instrucción que se utiliza para el comentario tiene un comentario.
Nota
Al insertar el título del segmento de forma automática, tenga en cuenta las siguientes
limitaciones:
● Si modifica el comentario del operando con posterioridad, el título del segmento no se
actualiza.
● Si cambia el operando de la instrucción, el título del segmento no se actualiza.
● El título del segmento solo se define mediante las instrucciones de escritura citadas antes.
● Si el operando es del tipo de datos Array, se utiliza el comentario del Array y no los
comentarios de los elementos Array.
● No se tienen en cuenta los comentarios de operandos no válidos.

Programación del PLC
Manual de programación y manejo, 11/2019

8299

Crear programas GRAPH
17.7 Programar condiciones

Introducir el título del segmento manualmente
Para introducir un título de segmento, proceda del siguiente modo:
1. Haga clic en la barra de título del segmento.
2. Introduzca el título de segmento.

Definir el título del segmento automáticamente
Para establecer que el título del segmento debe definirse fundamentalmente de forma
automática, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Active la casilla de verificación "Establecer título del segmento automáticamente" en el
grupo "Configuración avanzada".
Desde este momento, los títulos de los segmentos se definirán automáticamente si se
cumplen las condiciones anteriores.
Para definir automáticamente un título de segmento concreto, proceda del siguiente modo:
1. Haga clic en la barra de título de un segmento con el botón derecho del ratón y seleccione
"Segmento <Número del segmento>".
2. Elija el comando "Establecer título del segmento automáticamente" del menú contextual.
El título del segmento seleccionado se define a partir del comentario del operando si se
cumplen las condiciones anteriores.

Consulte también
Utilizar segmentos (Página 8295)
Insertar segmentos (Página 8295)
Seleccionar segmentos (Página 8296)
Copiar e insertar segmentos (Página 8297)
Borrar segmentos (Página 8298)
Contraer y expandir segmentos (Página 8298)
Navegar en segmentos (Página 8300)

Navegar en segmentos
Existe la posibilidad de navegar en un bloque directamente hasta una posición determinada.

8300

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.7 Programar condiciones

Procedimiento
Para navegar en un bloque hasta una posición determinada, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la sección de lógica de la ventana de
programación.
2. Elija el comando "Ir a > Segmento/línea" del menú contextual.
Se abre el cuadro diálogo "Ir a".
3. Introduzca el segmento hasta el que desea navegar.
4. Introduzca el número de la fila del segmento hasta el que desea navegar.
5. Confirme la entrada realizada con "Aceptar".

Resultado
Si es posible, se muestra la fila correspondiente. En caso de que el segmento o la fila deseados
no existan, se visualiza el último segmento existente, o bien, la última fila existente en el
segmento deseado.

Consulte también
Utilizar segmentos (Página 8295)
Insertar segmentos (Página 8295)
Seleccionar segmentos (Página 8296)
Copiar e insertar segmentos (Página 8297)
Borrar segmentos (Página 8298)
Contraer y expandir segmentos (Página 8298)
Insertar título del segmento (Página 8299)

17.7.4.2

Insertar instrucciones permanentes
Al desplegar una paleta para instrucciones permanentes anteriores o posteriores, esta
contiene por defecto un segmento vacío como mínimo. En cada segmento es posible utilizar
un máximo de 32 instrucciones con un máximo de 32 operandos interconectados. En KOP, las
instrucciones pueden insertarse tanto en un circuito como en la barra de alimentación. Dentro
de un bloque de función GRAPH es posible utilizar un máximo de 250 instrucciones
permanentes anteriores y 250 posteriores.

Requisitos
Hay un bloque de función GRAPH abierto en la vista de cadena.

Programación del PLC
Manual de programación y manejo, 11/2019

8301

Crear programas GRAPH
17.7 Programar condiciones

Procedimiento
Para programar instrucciones permanentes, proceda del siguiente modo:
1. Abra la paleta "Instrucciones permanentes anteriores" o "Instrucciones permanentes
posteriores" en la navegación.
2. Haga clic en un segmento.
En el área de trabajo se abre la vista de instrucciones permanentes anteriores o posteriores.
3. Abra la Task Card "Instrucciones".
4. Navegue hasta la instrucción que desea insertar.
5. Arrastre la instrucción hasta la posición deseada del segmento mediante Drag & Drop.
O:
1. Abra la Task Card "Instrucciones".
2. En la paleta "Instrucciones básicas", navegue hasta "General > Cuadro vacío".
3. Arrastre el elemento "Cuadro vacío" hasta la posición deseada del segmento mediante
Drag & Drop.
4. Haga clic en "??".
Se abre un campo de texto.
5. Haga clic en el botón para la función automática de autocompletar o pulse la combinación
de teclas <Ctrl+I>.
Se abre la función automática de autocompletar. Contiene solo los elementos admisibles
en función del contexto.
6. Seleccione el elemento deseado de la lista desplegable.

Consulte también
Condiciones (Página 8211)
Programar interlocks (Página 8286)
Insertar condiciones de supervisión (Página 8288)
Programar transiciones (Página 8293)
Mostrar u ocultar informaciones de variables (Página 8303)
Definir el lenguaje de programación en segmentos (Página 8240)

8302

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.7 Programar condiciones

17.7.5

Mostrar u ocultar informaciones de variables

Introducción
Para instrucciones permanentes, interlocks, supervisiones y transiciones está disponible la
información siguiente sobre las variables utilizadas en la ventana de programación:
● Nombre de la variable
● Dirección de la variable
● Comentarios simples o jerárquicos para la documentación de variables
La información se recoge de la interfaz del bloque en el caso de las variables locales y de DB,
y de la tabla de variables PLC en el caso de las variables válidas para toda la CPU.
Es posible visualizar la información de las variables para todos los bloques o solo para bloques
abiertos individuales. Si selecciona la información de variables para todos los bloques, se
muestra la información de las variables de todos los bloques abiertos actuales y futuros. La
información de las variables se puede volver a ocultar en cualquier momento. Si se ha ocultado
la información de las variables de todos los bloques, se puede volver a mostrar en bloques
abiertos individualmente.
Si selecciona la visualización de la información de variables con comentarios jerárquicos, en
las variables estructuradas también se mostrarán los comentarios de los niveles de estructura
de orden superior. En este caso, la información se muestra entre paréntesis después del
comentario de la variable, y los comentarios de los distintos niveles se separan con un punto.
Si en un nivel de estructura no hay ningún comentario de variable, el comentario en cuestión
no se visualiza, lo que se reconoce por los dos puntos seguidos.
La información de variable puede visualizarse agrupada debajo de un segmento KOP/FUP o
bien directamente en el operando correspondiente. Igual que para mostrar y ocultar la
información de variable, esto puede ajustarse en la configuración para todos los bloques o bien
modificarse específicamente para un bloque abierto.

Mostrar u ocultar información de variables para todos los bloques
Para mostrar u ocultar la información de variables para todos los bloques, proceda del
siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC" en la navegación local.
3. Si desea visualizar la información de las variables, seleccione en la lista desplegable
"Información de la variable" bien la opción "Mostrar", bien la opción "Información de la
variable con comentarios jerárquicos", según si desea ver comentarios simples o
jerárquicos.

Programación del PLC
Manual de programación y manejo, 11/2019

8303

Crear programas GRAPH
17.8 Insertar llamadas de bloque en GRAPH
4. En la lista desplegable "Posición de la información de variable (KOP/FUP)", especifique si
la información de variable debe visualizarse debajo de un segmento KOP/FUP o bien en el
operando.
La información de variable se muestra para todos los bloques abiertos en la posición
seleccionada. Si se abren más bloques, la información de variable también se muestra para
dichos bloques.
5. Si desea ocultar la información de variable, seleccione la opción "Ocultar" en la lista
desplegable "Información de variable".
La información de variable se oculta para todos los bloques abiertos. Si se abren más
bloques, la información de variable también se oculta para dichos bloques.

Mostrar u ocultar información de variables para un bloque abierto
Para mostrar u ocultar la información de variables para un bloque abierto, proceda del
siguiente modo:
1. Para mostrar información de variables, seleccione en la lista desplegable "Información
sobre la variable." bien la opción "Mostrar información de la variable", bien la opción
"Información de la variable con comentarios jerárquicos", según si desea visualizar
comentarios simples o jerárquicos.
2. Para especificar la posición de la información de variable, haga clic en el botón "Posición de
la información de variable (KOP/FUP)" de la barra de herramientas del editor de
programación. Cada vez que se hace clic en el botón cambia la posición. Otra posibilidad
consiste en hacer clic en la flecha pequeña situada junto al botón "Posición de la
información de variable (KOP/FUP)" para abrir una lista desplegable. Seguidamente,
seleccione la posición en la lista desplegable.
La información de variable se muestra en la posición seleccionada.
3. Para ocultar la información de las variables, seleccione la opción "Ocultar información de la
variable" en la lista desplegable "Muestra información sobre la variable".
La información de variable se oculta.

Consulte también
Programar interlocks (Página 8286)
Insertar condiciones de supervisión (Página 8288)
Programar transiciones (Página 8293)
Programar instrucciones permanentes (Página 8295)

17.8

Insertar llamadas de bloque en GRAPH

17.8.1

Inserción manual de llamadas de bloque
En las acciones y acciones permanentes es posible llamar otros bloques.

8304

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.8 Insertar llamadas de bloque en GRAPH

Insertar llamadas de bloque manualmente en una acción
Para insertar manualmente una llamada de bloque en una acción, proceda del siguiente modo:
1. Abra el bloque de función GRAPH en la vista de etapa individual.
2. Haga clic en la celda de la acción en la columna "Acción".
3. Introduzca "CALL <nombre del bloque que debe llamarse>" y confirme la entrada con la
tecla Intro.
4. Sustituya el "<nombre del bloque que debe llamarse>" por el nombre del bloque que quiere
llamar.
Si el bloque que debe llamarse es un bloque de función, se abre el cuadro de diálogo
"Opciones de llamada". En este caso ejecute los pasos 5 y 6.
5. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Después de hacer clic en el botón de "Instancia individual", deberá indicar un nombre en
el cuadro de texto "Nombre" para el bloque de datos al cual se deberá asignar la llamada.
– Si hace clic en el botón "Multiinstancia", introduzca a continuación en el cuadro de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.
6. Confirme la entrada realizada con "Aceptar".

Insertar una llamada de bloque manualmente en una instrucción permanente
Para insertar manualmente una llamada de bloque en una instrucción permanente, proceda
del siguiente modo:
1. Abra la vista "Instrucciones permanentes anteriores" o "Instrucciones permanentes
posteriores".
2. Haga clic con el botón derecho del ratón en la posición del segmento en la que desea
insertar la llamada de bloque.
3. Elija el comando "Insertar cuadro vacío" del menú contextual.
4. Haga clic en "??".
Se abre un campo de texto.
5. Introduzca el nombre del bloque que desea llamar o abra la función de autocompletar y
seleccione el bloque.
Si el bloque que debe llamarse es un bloque de función, se abre el cuadro de diálogo
"Opciones de llamada". En este caso ejecute los pasos 6 y 7.

Programación del PLC
Manual de programación y manejo, 11/2019

8305

Crear programas GRAPH
17.8 Insertar llamadas de bloque en GRAPH
6. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Después de hacer clic en el botón de "Instancia individual", deberá indicar un nombre en
el cuadro de texto "Nombre" para el bloque de datos al cual se deberá asignar la llamada.
– Si hace clic en el botón "Multiinstancia", introduzca a continuación en el cuadro de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.
7. Si se ha seleccionado un bloque que contiene supervisiones, asigne un bloque de función
ProDiag a dichas supervisiones.
8. Confirme la entrada realizada con "Aceptar".

Consulte también
Principios básicos de las instancias (Página 61)
Llamadas de bloque (Página 8207)
Insertar llamadas de bloque mediante Drag & Drop (Página 8306)
Actualizar llamadas de bloque en GRAPH (Página 8308)

17.8.2

Insertar llamadas de bloque mediante Drag & Drop
En las acciones y acciones permanentes es posible llamar otros bloques.

Insertar llamadas de bloque en una acción mediante Drag & Drop
Para insertar una llamada de bloque en una acción mediante Drag & Drop, proceda del
siguiente modo:
1. Abra el bloque de función GRAPH en la vista de etapa individual.
2. Arrastre el bloque que desea llamar desde el árbol del proyecto hasta la celda de la acción
en la columna "Acción".
Si el bloque que debe llamarse es un bloque de función, se abre el cuadro de diálogo
"Opciones de llamada". En este caso ejecute los pasos 3 y 4.

8306

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.8 Insertar llamadas de bloque en GRAPH
3. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Después de hacer clic en el botón de "Instancia individual", deberá indicar un nombre en
el cuadro de texto "Nombre" para el bloque de datos al cual se deberá asignar la llamada.
– Si hace clic en el botón "Multiinstancia", introduzca a continuación en el cuadro de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.
4. Confirme la entrada realizada con "Aceptar".

Insertar llamadas de bloque en una instrucción permanente mediante Drag & Drop
Para insertar una llamada de bloque en una instrucción permanente mediante Drag & Drop,
proceda del siguiente modo:
1. Abra la vista "Instrucciones permanentes anteriores" o "Instrucciones permanentes
posteriores".
2. Arrastre el bloque que desea llamar desde el árbol del proyecto hasta la posición del
segmento de la instrucción permanente en la que desea insertar la llamada de bloque.
Si el bloque que debe llamarse es un bloque de función, se abre el cuadro de diálogo
"Opciones de llamada". En este caso ejecute los pasos 3 y 4.
3. Indique en él si desea llamar el bloque como instancia individual, como multiinstancia o
como instancia de parámetro.
– Después de hacer clic en el botón de "Instancia individual", deberá indicar un nombre en
el cuadro de texto "Nombre" para el bloque de datos al cual se deberá asignar la llamada.
– Si hace clic en el botón "Multiinstancia", introduzca a continuación en el cuadro de texto
"Nombre de la interfaz" el nombre de la variable con el que el bloque de función llamado
se debe introducir como variable estática en la interfaz del bloque que efectúa la
llamada.
– Si hace clic en el botón "Instancia de parámetro", introduzca seguidamente en el campo
de entrada "Nombre en la interfaz" el nombre del parámetro de entrada/salida (InOut) al
que debe transferirse la instancia en tiempo de ejecución.
4. Si se ha seleccionado un bloque que contiene supervisiones, asigne un bloque de función
ProDiag a dichas supervisiones.
5. Confirme la entrada realizada con "Aceptar".

Consulte también
Principios básicos de las instancias (Página 61)
Llamadas de bloque (Página 8207)
Inserción manual de llamadas de bloque (Página 8304)
Actualizar llamadas de bloque en GRAPH (Página 8308)

Programación del PLC
Manual de programación y manejo, 11/2019

8307

Crear programas GRAPH
17.8 Insertar llamadas de bloque en GRAPH

17.8.3

Actualizar llamadas de bloque en GRAPH
Si cambian los parámetros de interfaz de un bloque llamado, la llamada no podrá ejecutarse
correctamente. Actualice las llamadas de bloque con objeto de evitar llamadas incoherentes.
Las llamadas de bloque se pueden actualizar de distinta manera:
● Actualización explícita de todas las llamadas de bloque incoherentes en el editor de
programación.
Se actualizan las llamadas de bloque incoherentes del bloque abierto. Para ello se llevan
a cabo las acciones siguientes:
– Se agregan parámetros nuevos. Sin embargo, tenga en cuenta que en los bloques de
función (FB) no se muestran los parámetros y que los parámetros reciben sus valores
del bloque de datos de instancia (DB).
– Los parámetros borrados no se eliminan.
– Los parámetros cuyo nombre ha cambiado adoptan el nombre nuevo.
● Actualización explícita de una llamada de bloque en el editor de programación.
Seguidamente se actualiza la llamada incoherente de este bloque. Para ello se llevan a
cabo las acciones siguientes:
– Se agregan parámetros nuevos. Sin embargo, tenga en cuenta que en los bloques de
función (FB) no se muestran los parámetros y que los parámetros reciben sus valores
del bloque de datos de instancia (DB).
– Los parámetros borrados no se eliminan.
– Los parámetros cuyo nombre ha cambiado adoptan el nombre nuevo.
● Actualización implícita durante la compilación.
Se actualizan todas las llamadas de bloque del programa, así como los tipos de datos PLC
utilizados. Tenga en cuenta que en la llamada de funciones (FC) antes del proceso de
compilación es necesario dotar de parámetros actuales a todos los parámetros formales
nuevos.

Actualizar todas las llamadas de bloque incoherentes en el editor de programación
Para actualizar todas las llamadas de bloque en un bloque, proceda del siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic en el botón "Actualizar llamadas de bloque incoherentes" de la barra de
herramientas.

Actualizar una llamada de bloque determinada en el editor de programación
Para actualizar una llamada de bloque determinada en el editor de programación, proceda del
siguiente modo:
1. Abra el bloque invocante en el editor de programación.
2. Haga clic con el botón derecho del ratón en la llamada de bloque que desea actualizar.

8308

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.8 Insertar llamadas de bloque en GRAPH
3. Elija el comando "Actualizar llamada de bloque" del menú contextual.
4. Si se han agregado parámetros para una función, indique los valores de los parámetros de
bloque nuevos.
Nota
Tenga en cuenta que el comando "Actualizar" solo está disponible si no se han actualizado ya
todas las llamadas de bloque en el editor con el comando "Actualizar llamadas de bloque
incoherentes".

Actualizar llamadas de bloque durante la compilación
Para actualizar implícitamente todas las llamadas de bloque y usos de tipos de datos PLC
durante la compilación, proceda del siguiente modo:
1. Abra el árbol del proyecto.
2. Seleccione la carpeta "Bloques de programa".
3. En el menú contextual, elija el comando "Compilar > Software (compilar todos los bloques)".

Consulte también
Llamadas de bloque (Página 8207)
Inserción manual de llamadas de bloque (Página 8304)
Insertar llamadas de bloque mediante Drag & Drop (Página 8306)

17.8.4

Modificar una llamada de bloque
En una llamada de bloque se puede modificar el bloque llamado. No obstante, recuerde que
al hacerlo no se generan nuevos bloques de datos de instancia, p. ej. al cambiar de una función
(FC) a un bloque de función (FB).

Procedimiento
Para cambiar el bloque llamado en una llamada de bloque, proceda del siguiente modo:
1. Dentro de la llamada del bloque, haga clic en el nombre del bloque llamado y pulse la tecla
<F2>. O haga doble clic en el nombre del bloque llamado.
Se abre un campo de entrada y el nombre del bloque llamado actualmente aparece
seleccionado.
2. Introduzca el nombre del bloque que desea llamar o seleccione un bloque con la función de
autocompletar.
3. Para llamar un FB, cree, dado el caso, un bloque de datos de instancia nuevo e indíquelo
como operando.

Programación del PLC
Manual de programación y manejo, 11/2019

8309

Crear programas GRAPH
17.9 Definir avisos

17.9

Definir avisos

17.9.1

Activar y desactivar el visor de avisos
Es posible activar o desactivar el visor de avisos globalmente para bloques de función GRAPH
nuevos o localmente para bloques individuales. El ajuste local de un bloque tiene prioridad
frente al ajuste global.

Activar o desactivar globalmente el visor de avisos
Para activar o desactivar el visor de avisos globalmente para bloques de función GRAPH
nuevos, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. En la navegación local, seleccione el grupo "Programación PLC > GRAPH".
3. Si desea activar el visor de avisos, active la casilla de verificación "Activar avisos" en el área
"Ajuste predeterminado para bloques nuevos > Propiedades de aviso". Si desea desactivar
el visor de avisos, desactive la casilla de verificación "Activar avisos".

Activar o desactivar localmente el visor de avisos
Para activar o desactivar el visor de avisos para un bloque de función GRAPH existente,
proceda del siguiente modo:
1. Abra el visor de avisos para el bloque de función GRAPH.
2. Si desea activar el visor de avisos, active la casilla de verificación "Activar avisos" en el área
"Avisos". Si desea desactivar el visor de avisos, desactive la casilla de verificación "Activar
avisos".

Consulte también
Avisos de interlock y supervisión (Página 8212)
Editar avisos (Página 8310)

17.9.2

Editar avisos
El aviso de enclavamientos, supervisiones y advertencias GRAPH (supervisiones del tiempo
de etapa) se define en la configuración general de las supervisiones. La categoría y las
subcategorías de enclavamientos, supervisiones y advertencias GRAPH se asignan a su vez
en la vista de avisos del bloque de función GRAPH.

8310

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.9 Definir avisos
Además, dentro de una etapa GRAPH es posible crear textos de aviso específicos de la etapa
para interlocks y supervisiones.
Nota
La vigilancia del tiempo de etapa solo está disponible para los bloques de función GRAPH de
S7-1500.

Editar avisos
Para editar los avisos de todos los bloques de función GRAPH, proceda del siguiente modo:
1. Haga doble clic en la entrada "Datos comunes > Configuración de supervisiones" del árbol
del proyecto.
Se abre la configuración de supervisiones de ProDiag.
2. En la navegación local, seleccione el grupo "Textos de aviso > Supervisiones de GRAPH".
3. Utilizando la función Drag&Drop, arrastre los campos de texto de aviso deseados desde el
campo "Campos de texto de aviso soportados" al marco de texto "Texto de aviso".
El orden de los diferentes campos de texto puede modificarse en todo momento.
4. Si desea borrar un campo de texto, haga clic en el campo de texto correspondiente con el
botón derecho del ratón y seleccione la opción "Borrar" del menú contextual.
5. Seleccione un separador adecuado para los campos de texto.
o bien:
1. Abra el visor de avisos para el bloque de función GRAPH.
2. Haga clic en la flecha verde "Ir a la configuración de supervisiones" situada a la derecha del
texto de aviso.
3. A partir de aquí se aplica el procedimiento descrito a partir del paso 3 anterior.

Seleccionar categorías y subcategorías
Para seleccionar las categorías y subcategorías para enclavamientos, supervisiones y
advertencias GRAPH, haga lo siguiente:
1. Abra el bloque de función GRAPH.
2. Abra la vista de avisos del bloque de función GRAPH.
3. En las listas desplegables de las categorías o subcategorías, elija la entrada deseada para
enclavamientos, supervisiones y advertencias GRAPH, respectivamente.

Editar el aviso de interlock de una etapa individual
Para editar el aviso de interlock de una etapa individual, proceda del siguiente modo:
1. Abra la etapa en la vista de etapa individual.
2. Seleccione el interlock "-(C)-".

Programación del PLC
Manual de programación y manejo, 11/2019

8311

Crear programas GRAPH
17.10 Adquirir primeros valores
3. Abra la ventana de inspección y cambie a la ficha "Propiedades", si fuera necesario.
4. Introduzca el texto de aviso deseado en el campo de texto "Texto de aviso".
El texto se adjuntará al final del aviso GRAPH con el campo de texto de aviso "<Step
specific field>".

Editar el aviso de supervisión de una etapa individual
Para editar el aviso de supervisión de una etapa individual, proceda del siguiente modo:
1. Abra la etapa en la vista de etapa individual.
2. Seleccione la supervisión "-(v)-".
3. Abra la ventana de inspección y cambie a la ficha "Propiedades", si fuera necesario.
4. Introduzca el texto de aviso deseado en el campo de texto "Texto de aviso".
El texto se adjuntará al final del aviso GRAPH con el campo de texto de aviso "<Step
specific field>". En un S7-1500 el texto también se emplea como texto específico de la
etapa para la vigilancia del tiempo de etapa si esta se usa como condición de supervisión.

Consulte también
Avisos de interlock y supervisión (Página 8212)
Activar y desactivar el visor de avisos (Página 8310)
Estructura del editor de textos de aviso (Página 8719)
Crear textos de aviso (Página 8727)

17.10

Adquirir primeros valores

17.10.1

Sinopsis de la adquisición de primeros valores

Requisitos
Para activar la adquisición de primeros valores hay que seleccionar una versión >= 4.0 en el
bloque de función GRAPH.
Encontrará más información aquí: Activar la adquisición de primeros valores (Página 8314)

8312

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.10 Adquirir primeros valores

Descripción
Existe la posibilidad de seguir la ejecución del programa de usuario desde un dispositivo HMI.
Al hacerlo, los datos y valores del panel de operador se pueden comparar y actualizar
continuamente con la CPU. Para cada bloque de función GRAPH se muestra siempre el
estado actual del programa en el panel de operador. Los valores actuales de los estados
lógicos de operandos booleanos y los resultados de comparadores de enclavamientos y
transiciones se registran continuamente a partir del momento en que se activa la adquisición
de primeros valores, incluso aunque no se produzcan errores.
Los estados lógicos se guardan en el bloque de datos de instancia GRAPH en cada ciclo. Es
posible registrar como máximo 32 estados lógicos por enclavamiento o transición. Los valores
actuales se guardan en los parámetros estáticos CRIT_LOC (etapa) o CRIT (transición) en un
DWORD y cada estado lógico ocupa un bit. En cuanto se produce un error de enclavamiento,
los valores del parámetro CRIT_LOC se copian en el parámetro CRIT_LOC_ERR. En cuanto
se produce un error de supervisión, los valores del parámetro CRIT se copian en el parámetro
CRIT_FLT en la siguiente transición. Estos primeros valores no vuelven a cambiar hasta que
se produce un nuevo error en la etapa activa.
El visor de código PLC permite visualizar los valores actuales. En cuanto se produce un error
es posible visualizar también los primeros valores y detectar inmediatamente los operandos
erróneos (análisis de criterios). Es posible conmutar entre la visualización de los valores
actuales y la visualización de los primeros valores.
Encontrará más información sobre la visualización en el dispositivo HMI aquí: "Visualizar
procesos > Usar funciones de diagnóstico > Supervisar máquinas e instalaciones con ProDiag"
Para que se visualicen los parámetros estáticos mencionados de las estructuras de etapa o de
transición es necesario seleccionar el juego de parámetros de interfaz máximo para la interfaz
del bloque.
Encontrará más información sobre el juego de parámetros de la interfaz aquí: Definir el juego
de parámetros de interfaz (Página 8241)
Encontrará más información sobre los parámetros estáticos de un bloque de función GRAPH
aquí: Parámetros estáticos (Página 8224)

Instrucciones soportadas
Para la adquisición de primeros valores se admiten todas las instrucciones soportadas en las
transiciones y los enclavamientos de un bloque de función GRAPH.
En las operaciones lógicas con bits se guarda el estado del operando y en los comparadores,
el resultado de la comparación.

Registro de los valores actuales o primeros valores
En cada ciclo del programa se registran el enclavamiento de las etapas activas y las
transiciones subsiguientes. Si se activan la propiedad de bloque "Ejecución permanente de
todos los interlocks en modo manual" o los ajustes de prueba "Procesar todos los interlocks"
o "Procesar todas las transiciones", se guardarán de cada ciclo todos los enclavamientos y
todas las transiciones de la cadena secuencial GRAPH. Posiblemente esto prolongará el
tiempo de ciclo.

Programación del PLC
Manual de programación y manejo, 11/2019

8313

Crear programas GRAPH
17.10 Adquirir primeros valores

Orden de evaluación en el dispositivo HMI en el visor de código PLC
Los estados lógicos en el correspondiente DWORD o en el listado de operandos de la tabla de
símbolos del visor de código PLC se registran en un orden definido fijo. Por ejemplo, en un
enclavamiento KOP se empieza siempre junto a la barra colectora en la parte superior
izquierda y se termina en la parte inferior derecha.
Nota
En la programación, tenga en cuenta el orden de evaluación
Este orden fijo se respeta también en el análisis de criterios en el dispositivo HMI al incluir los
operandos erróneos en la lista de la tabla de símbolos. Tenga en cuenta este orden de
evaluación al programar el enclavamiento o la transición.
Encontrará más información sobre el orden de la lista aquí: Ejemplo de orden en la lista
(Página 8316).

17.10.2

Activar la adquisición de primeros valores

Procedimiento
Para activar la adquisición de primeros valores, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el bloque de función GRAPH y seleccione
"Propiedades..." en el menú contextual.
Se abre el cuadro de diálogo de propiedades del bloque de función GRAPH.
2. En la ficha "General > Bloque", seleccione una versión >= V4.0.
3. Haga clic en la ficha "Atributos".
4. Active la "Adquisición de primeros valores".
5. Haga clic en "Aceptar".
6. Compile y cargue el programa de usuario.

Resultado
Una vez compilado el programa de usuario empieza la adquisición de primeros valores.

8314

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.10 Adquirir primeros valores

17.10.3

Inicializar primeros valores

Descripción
Cada bloque de función GRAPH contiene en su juego de parámetros de bloque los dos
parámetros estáticos del sistema "H_IL_ERR" y "H_SV_FLT" para cada una de las etapas. Si
ha activado la opción "Adquisición de primeros valores" en las propiedades del bloque de
función GRAPH, en caso de un error de enclavamiento se activará el bit 2 en el parámetro
"H_IL_ERR" (Interlock) y en caso de un error de supervisión se ajustará a TRUE el bit 5 del
parámetro "H_SV_FLT" (Transition) en cuanto aparezca un evento de este tipo en la etapa
activa. Eso permite visualizar los primeros valores en el dispositivo HMI con el visor de código
PLC.
A partir de la versión 5.0 del bloque de función GRAPH, es posible utilizar el parámetro de
entrada "RESET_CRIT" para volver a poner el estado lógico de ambos parámetros estáticos
"H_IL_ERR" y "H_SV_FLT" en FALSE después del análisis de criterios. Esta posibilidad debe
utilizarse principalmente cuando se modifique la programación de los enclavamientos y
transiciones y ya no se necesiten los primeros valores porque han quedado obsoletos. Los
estados lógicos no se inicializan de nuevo automáticamente a FALSE al modificar la
programación.

Procedimiento
Para inicializar los estados lógicos de ambos parámetros estáticos del sistema, proceda del
siguiente modo:
1. Asegúrese de que la versión del bloque de función GRAPH es >= 5.0.
2. Seleccionar el juego de parámetros máximo:
– Si desea crear un bloque de función GRAPH nuevo, seleccione primero del juego de
parámetros de bloque máximo en los ajustes generales de GRAPH.
– Si quiere modificar el juego de parámetros de un bloque de función GRAPH existente,
abra el bloque, haga clic en la interfaz y seleccione en la barra de menús "Edición >
Parámetros de interfaz > Parámetros de interfaz máximos". O también puede crear el
parámetro RESET_CRIT manualmente en la sección IN.
3. Al llamar al bloque de función GRAPH, interconecte el parámetro de entrada
"RESET_CRIT" en el programa de usuario.

Resultado
En cuanto en el parámetro de entrada "RESET_CRIT" haya un flanco de señal positivo, el
estado lógico de los dos parámetros estáticos del sistema "H_IL_ERR" y "H_SV_FLT" se
inicializará a FALSE en todas las etapas GRAPH programadas y el visor de código PLC ya no
mostrará más eventos obsoletos en el dispositivo HMI.

Consulte también
Principios básicos de la interfaz de un bloque de función GRAPH (Página 8213)
Sinopsis de la adquisición de primeros valores (Página 8312)

Programación del PLC
Manual de programación y manejo, 11/2019

8315

Crear programas GRAPH
17.10 Adquirir primeros valores
Parámetros de entrada (Página 8216)
Parámetros estáticos de una etapa (Página 8224)

17.10.4

Ejemplo de orden en la lista
Los valores actuales o los primeros valores y la lista de operandos de la tabla de símbolos del
visor de código PLC se registran siguiendo el mismo orden definido fijo.
Los ejemplos siguientes le permiten ver cómo funcionan el registro de los estados lógicos
dentro de un enclavamiento KOP y la lista de operandos en el dispositivo HMI.

Registro de todos los estados lógicos
Los estados lógicos se escriben en el parámetro estático CRIT_LOC o en el parámetro de
salida T_CRIT en el orden siguiente:





ಯ7DJBಯ

ಯ7DJBಯ

ಯ7DJBಯ

ಯ7DJBಯ

ಯ7DJBಯ

ಯ7DJBಯ



)%*5$3+
9

'%GHLQVWDQFLD
*5$3+

':25' HVWDGRVOµJLFRV FULWHULRV

%LW %LW


,QWHUORFN
F

%LW

%LW

%LW

%LW

%LW

%LW

%LW

%LW

%LW

%LW









7DJB

7DJB

7DJB

7DJB

7DJB

7DJB



En el dispositivo HMI todos los operandos se muestran en una lista en el mismo orden que en
la tabla de símbolos del visor de código PLC:

8316

Nombre del
símbolo

Operando

Comentario

Tag_1

p. ej. %M2xy

Modo automático / manual

Tag_3

Conectar motor

Tag_2

Enclavamiento_1

Tag_1

Modo automático / manual

Tag_5

Pulsador manual

Tag_4

Barrera fotoeléctrica

Programación del PLC
Manual de programación y manejo, 11/2019

Crear programas GRAPH
17.10 Adquirir primeros valores

Lista de los operandos en caso de fallo
Si en el enclavamiento se producen fallos, los operandos erróneos se marcan en color y en la
tabla de símbolos se muestra tan solo la lista de los operandos erróneos:


ಯ7DJBಯ

ಯ7DJBಯ

ಯ7DJBಯ

ಯ7DJBಯ


ಯ7DJBಯ

ಯ7DJBಯ

,QWHUORFN
F


Lista de los operandos erróneos en la tabla de símbolos del visor de código PLC:
Nombre del
símbolo

Operando

Comentario

Tag_2

p. ej. %M2xy

Enclavamiento_1

Tag_1

Modo automático / manual

Tag_5

Pulsador manual

Tag_4

Barrera fotoeléctrica

Programación optimizada del enclavamiento en caso de fallo
Con el fin de detectar rápidamente a primera vista que la barrera fotoeléctrica es la
responsable del error, se recomienda, en este ejemplo, programar primero el operando
"Tag_4: Barrera fotoeléctrica":


ಯ7DJBಯ



ಯ7DJBಯ

ಯ7DJBಯ

ಯ7DJBಯ

ಯ7DJBಯ

ಯ7DJBಯ

,QWHUORFN
F


De este modo la información sobre la barrera fotoeléctrica abierta se representa en la primera
línea de la tabla de símbolos:
Nombre del
símbolo

Operando

Comentario

Tag_4

p. ej. %M2xy

Barrera fotoeléctrica

Tag_2

Enclavamiento_1

Tag_1

Modo automático / manual

Tag_5

Pulsador manual

Programación del PLC
Manual de programación y manejo, 11/2019

8317

Crear programas GRAPH
17.10 Adquirir primeros valores

8318

Programación del PLC
Manual de programación y manejo, 11/2019

18

Configurar avisos
18.1

Introducción a la configuración de avisos

Sinopsis
En los sistemas de automatización, los avisos permiten detectar rápidamente errores durante
la ejecución del proceso, localizarlos con precisión y solucionarlos. De esta forma es posible
reducir sustancialmente los tiempos de parada de una instalación.
Antes de poder visualizar avisos, es necesario configurarlos.
Es posible crear avisos dependientes de eventos y asignarles textos y atributos, así como
editarlos, traducirlos y visualizarlos en visualizadores.
En la siguiente tabla se muestra una relación de los tipos de aviso con una breve descripción
de su función.
Tipo de aviso

Descripción

Avisos de programa

Los avisos de programa sirven para notificar eventos síncro‐
nos y cada uno de ellos está asignado a un bloque. Se crean
en el editor de programas y se editan en el editor de avisos.

Avisos de diagnóstico del sistema

Los avisos de diagnóstico del sistema son eventos de módulo
que dependen de la configuración y se activan o desactivan
en la configuración hardware. En el editor de avisos pueden
visualizarse pero no editarse.

Avisos de diagnóstico de usuario

Los avisos de diagnóstico de usuario permiten registrar una
entrada de usuario en el búfer de diagnóstico y enviar un
aviso al respecto. Están asignados a una CPU. Se crean en
el editor de avisos y pueden editarse aquí.

18.2

Asignación de números de aviso

Asignación de números
Los avisos se identifican con un número único en toda la CPU. De este modo no es necesario
volver a compilar tras copiar programas enteros. Una excepción constituye la copia de bloques
individuales. En este caso, es necesario volver a compilar para integrar el número de aviso (ID)
modificado en el programa.

Programación del PLC
Manual de programación y manejo, 11/2019

8319

Configurar avisos
18.4 Bloques de aviso disponibles

18.3

Componentes de un aviso

Sinopsis
El modo en que se visualice un aviso dependerá del método, del bloque de aviso utilizado y del
visualizador.
La tabla siguiente muestra una relación de los posibles componentes:
Componente

Descripción

Sello de tiempo

Se genera en el sistema de automatización al producirse el evento de aviso.

Estado del aviso

Son posibles: aparecido, aparecido con acuse, desaparecido, desaparecido
sin acuse, desaparecido con acuse.

Valor asociado

Algunos avisos pueden acompañarse de un valor asociado que puede ser
evaluado por la instrucción de aviso utilizada.

Imagen

En caso de caída del sistema, los avisos producidos pueden visualizarse
posteriormente en dispositivos HMI.

Número de aviso

Número (ID) unívoco en la CPU que es asignado por el sistema y que iden‐
tifica un aviso.

Textos de aviso

Son configurados por el usuario.

ID de grupo

Es posible acusar un grupo de avisos conjuntamente asignando el mismo
valor a sus avisos.
Encontrará información sobre la configuración de avisos en la Ayuda en pan‐
talla de WinCC.

18.4

Bloques de aviso disponibles

S7-300/400: Vista general de los bloques de aviso
Es posible elegir entre los siguientes bloques de aviso:
● ALARM
● ALARM_8
● ALARM_8P
● NOTIFY
● ALARM_S
● ALARM_SQ
● AR_SEND (para enviar ficheros; no es posible configurar textos ni atributos de aviso)
● NOTIFY_8P
● ALARM_DQ

8320

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.4 Bloques de aviso disponibles
● ALARM_D
● ALARM_T

S7-300/400: ¿Cuándo se utilizan los bloques de aviso?
La siguiente tabla le ayudará a seleccionar el bloque de aviso apropiado para una determinada
aplicación. La elección del bloque de aviso depende de los siguientes factores:
● Del número de canales disponibles en el bloque y, con ello, el número de señales que se
supervisan en cada llamada de bloque.
● De la posibilidad de acusar avisos.
● De la posibilidad de incluir valores asociados.
● De los visualizadores que se utilicen.
● Del alcance de la CPU.
Bloque
de aviso

Canales

Acuse

Valores
asociados

Particularidades

ALARM *)

1

sí

hasta 10

Envía un aviso en caso
de flanco entrante o sa‐
liente, respectivamen‐
te.

ALARM_8 *)

8

sí

-

Envía un aviso en caso
de flanco entrante o sa‐
liente de una o varias
señales.

ALARM_8P *)

8

sí

hasta 10

como ALARM_8

NOTIFY

1

no

hasta 10

como ALARM

NOTIFY_8P

8

no

hasta 10

como ALARM

AR_SEND

1

-

-

Sirve para enviar un fi‐
chero; no es posible
configurar textos ni atri‐
butos de aviso.

ALARM_SQ

1

sí

1

Se genera un aviso
con cada llamada de
bloque y al cambiar la
señal con respecto a la
llamada anterior.

ALARM_S

1

no

1

como ALARM_SQ

ALARM_DQ

1

sí

1

como ALARM_SQ

ALARM_D

1

no

1

como ALARM_SQ

ALARM_T

-

-

-

Reservado para fines
de test del sistema

*) Si está activada la notificación de avisos disparada por acuse, el aviso no se mostrará en el visor de avisos.

Programación del PLC
Manual de programación y manejo, 11/2019

8321

Configurar avisos
18.5 Plantilla y avisos

S7-1500: Vista general de los bloques de aviso
Se dispone del siguiente bloque de aviso:
● Program_Alarm
La selección de la categoría de aviso correspondiente determina si el bloque requiere o no
acuse. El ajuste predeterminado es que el bloque no requiere acuse.
Bloque
de aviso

Canales

Acuse

Valores
asociados

Particularidades

Program_Alarm

1

posible

hasta 10

Envía un aviso con se‐
llo de tiempo en caso
de flanco entrante o sa‐
liente, respectivamen‐
te (v. Crear avisos de
programa (Pági‐
na 8335)).

18.5

Plantilla y avisos
Con ayuda de los editores de programación es posible crear un tipo de aviso (es decir, un FB
como plantilla para DB de instancia) o, más adelante, avisos (es decir, DB de instancia a partir
de la plantilla del tipo de aviso) en varios pasos de trabajo.

El bloque de aviso puede ser un FB o un DB de instancia.
● En un FB se crea un tipo de aviso que sirve de plantilla para avisos. Todas las entradas que
se realicen para el tipo de aviso se aplicarán automáticamente a los avisos derivados de la
misma. Si se asigna un DB de instancia al FB, se generarán automáticamente avisos según
el tipo de aviso para el DB de instancia y se asignarán números de aviso.
● En un de DB de instancia se pueden modificar los avisos generados a partir del tipo de aviso
específicamente para cada instancia si no están bloqueados.
La diferencia visible es que en el caso de los avisos se asignan números de aviso, mientras que
en el caso de los tipos de avisoi no se asignan. Los tipos de aviso y sus instancias se disponen
uno bajo el otro en el editor de avisos. En el ajuste predeterminado, la tabla que contiene las
instancias de aviso está contraída.

Modificación de los datos en el tipo de aviso
Si se modifican datos a posteriori en el tipo de aviso, estas modificaciones se aplicarán
automáticamente a las instancias.
Excepciones: Estos datos se han modificado previamente en la instancia o se han bloqueado
o desbloqueado datos a posteriori en el tipo de aviso.
Nota
Si se copian instancias a otro programa sin copiar el tipo de aviso, la instancia no se mostrará
completa. En tal caso también habrá que copiar el tipo de aviso al nuevo programa.

8322

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.6 Parámetros formales, tipos de datos de avisos y bloques de aviso

Restablecimiento de datos específicos de la instancia al valor del tipo de aviso
Si se han sobrescrito atributos o textos en la instancia del aviso, el símbolo de tipo se mostrará
junto al atributo en el editor de avisos. Por cada atributo puede determinarse si se volverá a
utilizar el valor del tipo de aviso. En tal caso no se muestra ningún símbolo de tipo.

Consulte también
Editar un tipo de aviso (Página 8329)
Crear un DB de instancia y editar instancias de aviso (Página 8329)
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)
Crear categorías (Página 8352)
Editar categorías (Página 8353)
Trabajar con el editor de avisos (Página 8326)

18.6

Parámetros formales, tipos de datos de avisos y bloques de aviso

Parámetros formales como entrada de número de aviso (S7-300/400)
Por cada aviso de programa o grupo de avisos de programa se requiere en el programa un
parámetro formal (nombre del aviso) que se especifica como parámetro STATIC en la vista
general de variables del programa. El parámetro formal se utiliza como entrada de números de
aviso y constituye la base de un aviso.

Suministro del tipo de datos adecuado al parámetro formal (S7-300/400)
Al parámetro formal debe asignársele un tipo de datos de aviso apropiado para el bloque de
aviso utilizado.

Tipos de datos de avisos y sus bloques de aviso
La siguiente tabla muestra los tipos de datos de avisos con sus bloques de aviso y sus
propiedades. Los valores de los tipos de datos llevan el mismo nombre que los bloques de
aviso (excepción: véase la tabla) y tienen el prefijo "C_".
Sistema SIMATIC

Tipo de datos

Bloque de aviso

Propiedades

S7-400

C_Alarm_8

ALARM_8

8 canales, con acuse, sin
valores asociados

S7-400

C_Alarm_8p

ALARM_8P

8 canales, con acuse,
hasta 10 valores asocia‐
dos por canal

S7-400

C_Notify

NOTIFY

1 canal, sin acuse, hasta
10 valores asociados

Programación del PLC
Manual de programación y manejo, 11/2019

8323

Configurar avisos
18.7 Estructura del editor de avisos

18.7

Sistema SIMATIC

Tipo de datos

Bloque de aviso

Propiedades

S7-400

C_Alarm

ALARM

1 canal, con acuse, hasta
10 valores asociados

S7-300/400

C_Alarm_s

ALARM_S

1 canal, sin acuse, hasta
1 valor asociado

S7-300/400

C_Alarm_s

ALARM_SQ

1 canal, con acuse, hasta
1 valor asociado

S7-400

C_Ar_Send

AR_SEND

Sirve para enviar un fiche‐
ro

S7-400

C_Notify_8p

NOTIFY_8P

8 canales, sin acuse, has‐
ta 10 valores asociados

S7-300/400

C_Alarm_s

ALARM_DQ

1 canal, con acuse, hasta
1 valor asociado

S7-300/400

C_Alarm_s

ALARM_D

1 canal, sin acuse posi‐
ble, hasta 1 valor asocia‐
do

S7-1500

Program_Alarm

Program_Alarm

1 canal, posibilidad de
acuse por parametriza‐
ción, hasta 10 valores
asociados

Estructura del editor de avisos

Estructura del editor de avisos
La figura siguiente muestra a modo de ejemplo los componentes del editor de avisos:

8324

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.7 Estructura del editor de avisos











1

Representación tabular de los avisos en el área de trabajo, véase: Trabajar con el editor
de avisos (Página 8326)

2

Ficha "Avisos de programa": los avisos del programa se pueden editar aquí. Véase
Principios básicos del área de trabajo

3

Ficha "Avisos de sistema" Los avisos de sistema solo pueden verse, no editarse. La
configuración de estos avisos se lleva a cabo en las propiedades del aparato (comando
"Ir a dispositivo" del menú contextual) y en el árbol del proyecto, en "Datos comunes >
Ajustes de diagnóstico del sistema".

4

La tabla "Instancias de aviso" contiene las instancias (los DB de instancia) derivadas del
tipo de aviso (FB). Dicha tabla está contraída por defecto.

5

Ventana de inspección
Ficha "Avisos de diagnóstico de usuario": aquí se pueden crear y editar avisos de diag‐
nóstico personalizados.
En las CPU S7-1500, la ficha no está disponible.
Memorizar disposición: la disposición actual se restablece cuando vuelven a abrirse los
avisos de PLC.

Los parámetros, textos y atributos necesarios se pueden introducir y modificar tanto en la tabla
como en la ventana de inspección. Las columnas de la tabla pueden clasificarse en orden
ascendente o descendente.

Programación del PLC
Manual de programación y manejo, 11/2019

8325

Configurar avisos
18.9 Crear y editar avisos

18.8

Trabajar con el editor de avisos
A continuación se describe un procedimiento básico para trabajar con el editor de avisos.

Mostrar/ocultar instancias de aviso
La primera vez que se abre el editor de avisos, la tabla que contiene las instancias de aviso
está contraída. La división entre las dos tablas puede cambiarse con el ratón. Para ello, haga
clic entre las dos áreas y, sin soltar el botón del ratón, desplace la línea divisoria a izquierda o
derecha para modificar la división. El Speedy Splitter (las dos teclas de flecha pequeñas)
permiten minimizar o maximizar el área de tabla con un solo clic, así como restablecer la última
división seleccionada.

Clasificar tablas en orden ascendente o descendente
Para clasificar una tabla en orden ascendente o descendente de una columna, proceda del
siguiente modo:
1. Haga clic en el encabezado de una columna para clasificarla en orden ascendente.
2. Vuelva a hacer clic en el encabezado de la misma columna para clasificarla en orden
descendente.
3. Vuelva a hacer clic por tercera vez en el encabezado de la misma columna para anular la
clasificación.

Copiar y pegar celdas
Existe la posibilidad de seleccionar una o varias celdas e insertarlas en otro lugar. Los datos
se comprueban y, si son válidos, se activa el comando "Copiar" del menú contextual. En el
lugar de inserción vuelven a comprobarse los datos y, si son válidos, se activa el comando
"Pegar" del menú contextual. Si los datos no son válidos, estos comandos del menú contextual
están atenuados.

18.9

Crear y editar avisos

18.9.1

Crear avisos de programa

Requisitos
Se ha creado un bloque de función.

8326

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.9 Crear y editar avisos

Procedimiento
Para crear un aviso de programa, proceda del siguiente modo:
1. En la carpeta "Bloques de programa" del árbol del proyecto, seleccione el bloque de función
(FB) para el que desee crear un aviso de programa y abra este bloque haciendo doble clic.
2. En la Task Card "Instrucciones", haga clic en "Instrucciones avanzadas" > "Avisos" y
arrastre el bloque de aviso deseado (p. ej. "Alarm_S") hasta la ventana de instrucciones o
el segmento (según sea el lenguaje del bloque).
Resultado: En la sección de instrucciones del FB se muestran las entradas del bloque de
aviso llamado, en este caso el bloque ALARM_S.
3. Rellene la interfaz del bloque. Por cada bloque de aviso que se llame en el FB deberán
declararse variables en el FB que efectúa la llamada. Para ello, introduzca por ejemplo las
siguientes variables:
– En el parámetro "STATIC", un nombre para la entrada del bloque de aviso, p. ej.
"Aviso01" y el tipo de datos (C_Alarm_s).
– Asigne a la variable "EV_ID" el nombre asignado a la entrada del bloque de aviso, en
este caso, "Aviso01" e ID_16#eeee.
Nota
Si en lugar de un bloque de aviso existente en la CPU se llama un FB con multiinstancias
en el que también haya avisos configurados, en el bloque que efectúa la llamada también
habrá que configurar los avisos del FB con multiinstancias.
4. Repita los pasos 2 y 3 para todas las llamadas de bloques de aviso en este FB.

18.9.2

Editar avisos de programa en el editor de avisos

Requisitos
Se ha creado un aviso de programa.

Procedimiento
Para editar avisos de programa, proceda del siguiente modo:
1. Haga doble clic en "Supervisiones y avisos del PLC" en el árbol del proyecto. Seleccione la
ficha "Avisos". Se abre el editor de avisos.
2. Introduzca los textos y atributos deseados en las columnas correspondientes.

Programación del PLC
Manual de programación y manejo, 11/2019

8327

Configurar avisos
18.9 Crear y editar avisos

Consulte también
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)

18.9.3

Editar avisos de programa en el editor de programación

Requisitos
Se ha creado un aviso de programa.

Procedimiento
Para editar avisos de programa, proceda del siguiente modo:
1. Seleccione la fila correspondiente en la interfaz del bloque.
2. Cambie a la ficha "Aviso" de la ventana de inspección.
3. Introduzca los textos y atributos deseados en los campos correspondientes.

18.9.4

Borrar avisos de programa

Procedimiento
Para borrar un aviso de programa, proceda del siguiente modo:
1. Abra el bloque que contenga el aviso que desee borrar.
2. En la ventana de instrucciones o el segmento (según sea el lenguaje del bloque) elimine el
bloque de aviso que se insertó en el momento de crearlo.
3. Seleccione la fila correspondiente en la interfaz de bloque y elija el comando "Borrar" del
menú contextual.

Resultado
Se borra el aviso.

8328

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.9 Crear y editar avisos

18.9.5

Editar un tipo de aviso

Procedimiento
Para editar un tipo de aviso, proceda del siguiente modo:
1. Seleccione el bloque de aviso deseado.
2. Introduzca los textos deseados o seleccione los atributos deseados.
Si ha seleccionado un bloque de aviso de varios canales (p. ej. "ALARM_8"), podrá asignar
a cada subaviso sus propios textos y asignarles atributos en parte propios.
Nota
Para editar subavisos debe encontrarse en el editor de avisos.
3. Si no desea que los textos o atributos se puedan cambiar en la instancia, bloquéelos en el
tipo.

Consulte también
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)

18.9.6

Crear un DB de instancia y editar instancias de aviso

Requisitos
Previamente se debe haber creado un FB y haber creado al menos un aviso en él.

Procedimiento
Para asignar bloques de datos de instancia (DB) a un tipo de aviso y editar los avisos de dichos
DB para cada instancia, proceda del siguiente modo:
1. En el árbol del proyecto, haga doble clic en "Agregar nuevo bloque"; en el cuadro de diálogo
que se abrirá, haga clic en el botón "Bloque de datos (DB)" y seleccione en la lista
desplegable de "Tipo" el bloque de función (tipo de aviso) al que desee asignar el bloque de
datos de instancia.
2. Haga doble clic en "Supervisiones y avisos del PLC" en el árbol del proyecto. Seleccione la
ficha "Avisos" para abrir la configuración de avisos.
3. Introduzca las modificaciones deseadas para la instancia de aviso correspondiente.

Resultado
Con ello finaliza la configuración de avisos del DB de instancia creado.

Programación del PLC
Manual de programación y manejo, 11/2019

8329

Configurar avisos
18.9 Crear y editar avisos

Consulte también
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)

18.9.7

Crear avisos de diagnóstico de usuario
Los avisos de diagnóstico de usuario están asignados a una CPU. Se crean y editan en el
editor de avisos.

Requisitos
Se ha creado un bloque de función.

Procedimiento
Para crear un aviso de diagnóstico de usuario, proceda del siguiente modo:
1. En la carpeta "Bloques de programa" del árbol del proyecto, seleccione el bloque de función
(FB) para el que desee crear un aviso de diagnóstico de usuario y abra este bloque
haciendo doble clic.
2. En la ventana de instrucciones del FB, inserte una configuración para el aviso de
diagnóstico de usuario entrante y saliente llamando dos veces el bloque de aviso
"WR_USMSG" (una vez para un flanco descendente y otra para uno ascendente).
3. Haga doble clic en "Supervisiones y avisos del PLC" en el árbol del proyecto. Seleccione la
ficha "Avisos" para abrir el editor de avisos.
4. En el editor de avisos, seleccione la ficha "Avisos de diagnóstico de usuario".
5. Haga clic en la tabla y seleccione en el menú contextual el comando "Insertar nuevo aviso".

Resultado
Se ha creado un aviso de diagnóstico de usuario.

18.9.8

Editar avisos de diagnóstico de usuario

Requisitos
Se ha creado un aviso de diagnóstico de usuario.
El editor de avisos está abierto.

8330

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.9 Crear y editar avisos

Procedimiento
Para editar un aviso de diagnóstico de usuario, proceda del siguiente modo:
1. Introduzca los textos y atributos deseados en las columnas correspondientes.

18.9.9

Borrar avisos de diagnóstico de usuario
Es posible borrar un aviso marcado. Los textos configurados para dicho aviso se borrarán y el
número de aviso quedará disponible.

Procedimiento
Para borrar un aviso de diagnóstico de usuario, proceda del siguiente modo:
1. En la ventana de instrucciones del FB, elimine los bloques de aviso que se insertaron en el
momento de crearse.
2. Seleccione la fila correspondiente en el editor de avisos y elija el comando "Borrar" del
menú contextual.

Resultado
El aviso se borra. Ya no aparece en la tabla.

18.9.10

Insertar valores asociados en los avisos
Para agregar información actualizada (p. ej., del proceso) a los avisos, es posible agregar
valores asociados en cualquier punto del texto de un aviso.

Procedimiento
Para insertar un valor asociado en un aviso, proceda del siguiente modo:

SFB de alarma del S7-400 (p. ej. Alarm, Alarm_8P)
Hay 10 valores asociados cuya longitud máxima es de 12 bytes en cada caso. No es posible
direccionarlos internamente.
1. Cree un bloque con la siguiente estructura:
@<N.º del valor asociado><Tipo de elemento>%<Indicación de formato>@.
2. Inserte este bloque en aquel punto del texto del aviso en el que quiera que aparezca el valor
asociado.

Programación del PLC
Manual de programación y manejo, 11/2019

8331

Configurar avisos
18.9 Crear y editar avisos

SFC de alarma del S7-300/400 (p. ej. Alarm_S)
Hay un valor asociado cuya longitud máxima es de 12 bytes. Es posible direccionarlo
internamente utilizando el índice y el tipo de elemento.
1. Cree un bloque con la siguiente estructura:
@<Índice><Tipo de elemento>%<Indicación de formato>@.
Índice: Índice en el valor asociado. El índice se interpreta como índice de matriz
(empezando por 1).
El offset de byte se calcula con la siguiente fórmula:
Offset = ((índice - 1) * ancho de datos (tipo de elemento))
Utilice en lo posible solo Y,W,X, R como tipo de elemento. El tipo de elemento solo es
necesario para determinar el ancho. El modo de representación se define al indicar el
formato.
2. Inserte este bloque en aquel punto del texto del aviso en el que quiera que aparezca el valor
asociado.

Consulte también
Estructura de los valores asociados (Página 8332)
Ejemplos de valores asociados (Página 8333)

18.9.11

Estructura de los valores asociados
Los valores asociados están formados por los siguientes componentes:

Tipo de elemento
Con ello se configura de forma unívoca el tipo de datos del valor asociado:
Tipo de elemento

Tipo de datos

Y

BYTE

W

WORD

X

DWORD

I

Integer

D

DINT

B

BOOL

C

CHAR

R

REAL

O

LREAL

El tipo de elemento sólo convierte en unívoco el tipo de datos transferido desde el sistema de
automatización. No se utiliza como Casting Operator.

8332

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.9 Crear y editar avisos

Formato
Determine el formato de visualización del valor asociado en el visualizador. El formato irá
precedido del carácter "%". Existen los siguientes formatos para los textos de aviso:
Formato

Descripción

%[i]X

Hexadecimal con i posiciones

%[i]u

Número decimal sin signo con i posiciones

%[i]d

Número decimal con signo con i posiciones

%[i]b

Número binario con i posiciones

%[i][.y]f

Número en coma flotante con signo e y posiciones
tras el punto decimal e i posiciones totales

%[i]s

Cadena de caracteres (ANSI String) con i posicio‐
nes
Los caracteres se imprimen hasta el primer byte 0
(00Hex).

%t#<Nombre de la lista de textos>

Acceso a la lista de textos

Aunque el número de posiciones [i] sea demasiado pequeño, el valor se emitirá con su longitud
total.
Si el número de posiciones [i] es demasiado grande, delante del valor se visualizará un número
apropiado de caracteres de relleno.
Si el número de posiciones [i] es demasiado grande (en caso de números decimales o en coma
flotante) y si se emite un signo, se reduce el número de caracteres de relleno en una posición.
Lo mismo es aplicable al punto o la coma en números en coma flotante.
Ejemplo: Valor=1234.567 Formato=%8.3f Salida=1234.567; es decir, no se emite ningún
carácter de relleno aunque solo haya 7 cifras.
Nota
Tenga en cuenta que se puede introducir "[i]" de forma opcional, debiendo omitir para ello los
paréntesis cuadrados.

Consulte también
Insertar valores asociados en los avisos (Página 8331)
Ejemplos de valores asociados (Página 8333)

18.9.12

Ejemplos de valores asociados

Ejemplos de valores asociados:
@1I%6d@: El valor del valor asociado 1 se representa como número decimal con un máximo
de 6 posiciones.

Programación del PLC
Manual de programación y manejo, 11/2019

8333

Configurar avisos
18.9 Crear y editar avisos
@2R%6f@: El valor "5.4" p. ej. a partir del valor asociado 2 se representa como número en
coma fija "5.4" (comenzando con tres espacios en blanco).
@2R%2f@: El valor "5.4" p. ej. a partir del valor asociado 2 se representa como número en
coma fija "5.4" (no se corta aunque el número de posiciones sea demasiado pequeño).
@1W%t#Textbib1@: El valor asociado 1 del tipo WORD es el índice con el que se referenciará
en la librería de textos Textbib1 el texto que se insertará.
Ejemplos de indicaciones de formato y valores emitidos:
Valor=255 Formato=%5X

Salida="16#000FF"

Valor=123 Formato=%5u Salida=" 123"
Valor=-200 Formato=%4d Salida="-200"
Valor=19

Formato=%8b Salida="2#00010011"

Valor=1234.567 Formato=%8.3f Salida="1234.567"; es decir, no se emite ningún espacio
aunque tan solo haya 7 cifras
Nota
Si se desea transferir a los bloques ALARM_S más de un valor asociado, es posible transferir
una matriz con una longitud máxima de 12 bytes. Puede tratarse, p. ej., de un máximo de 12
bytes o Char, un máximo de 6 Word o Int, o bien un máximo de 3 DWord, Real o DInt.

Consulte también
Insertar valores asociados en los avisos (Página 8331)
Estructura de los valores asociados (Página 8332)

18.9.13

Borrar valores asociados
Es posible borrar valores asociados borrando el comodín que representa el valor asociado en
el texto de aviso.

Procedimiento:
Para borrar valores asociados, proceda de la manera siguiente:
1. En el texto de aviso, busque el comodín equivalente al valor asociado que desee borrar.
El comodín comienza con el carácter "@", seguido del índice y el tipo de elemento por el
que se puede reconocer el valor asociado, así como un formato, y finaliza con el carácter
"@".
2. Borre del texto de aviso el comodín que haya encontrado.

8334

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.10 Crear y editar avisos

18.10

Crear y editar avisos

18.10.1

Crear avisos de programa

Requisitos
Se ha creado un bloque de función.

Procedimiento
Para crear un aviso de programa, proceda del siguiente modo:
1. En la carpeta "Bloques de programa" del árbol del proyecto, seleccione el bloque de función
(FB) para el que desee crear un aviso de programa y abra este bloque haciendo doble clic.
2. Inserte en la ventana de instrucciones o en el segmento (según sea el lenguaje del bloque)
del FB la llamada para el bloque de aviso seleccionado ("Program_Alarm"). La encontrará
en la Task Card "Instrucciones", apartado "Instrucciones avanzadas" > "Avisos". La
información necesaria se introduce automáticamente en la sección "Static" de la interfaz del
bloque.
3. En caso necesario, modifique el nombre del aviso en el cuadro de diálogo que se muestra.
Resultado: En la sección de instrucciones del FB se muestran las variables de entrada del
bloque de aviso llamado, en este caso el bloque Program_Alarm.
4. Repita los pasos 2 a 3 para todas las llamadas de bloques de aviso en este FB.
Tenga en cuenta que al crear avisos en las CPU S7-1500 es necesario indicar la categoría de
aviso. Esta especifica si el aviso requiere acuse o no. Los avisos que no requieren acuse
pueden tener solo fines informativos.
Según esto existen tres tipos de avisos:
● El aviso debe acusarse y tiene el estado "entrante" o "saliente".
● El aviso no tiene que ser acusado y tiene el estado "entrante" o "saliente".
● El aviso tiene solo fines informativos y no tiene estado. Debe haber una marca en la
columna "Solo información". Este tipo de aviso solo tiene el estado "entrante" en el fichero
de avisos; en un flanco saliente no se indica nada.
En HMI este tipo de aviso se muestra en "Avisos del controlador".
Nota
El ajuste estándar es "sin acuse".

Consulte también
Crear categorías (Página 8352)

Programación del PLC
Manual de programación y manejo, 11/2019

8335

Configurar avisos
18.10 Crear y editar avisos

18.10.2

Editar avisos de programa en el editor de avisos

Requisitos
Se ha creado un aviso de programa.

Procedimiento
Para editar avisos de programa, proceda del siguiente modo:
1. Haga doble clic en "Supervisiones y avisos del PLC" en el árbol del proyecto. Seleccione la
ficha "Avisos". Se abre el editor de avisos.
2. Introduzca los textos y atributos deseados en las columnas correspondientes.

Consulte también
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)

18.10.3

Editar avisos de programa en el editor de programación

Requisitos
Se ha creado un aviso de programa.

Procedimiento
Para editar avisos de programa, proceda del siguiente modo:
1. Seleccione la fila correspondiente en la interfaz del bloque.
2. Cambie a la ficha "Aviso" de la ventana de inspección.
3. Introduzca los textos y atributos deseados en los campos correspondientes.

Bloque de aviso "Program_Alarm"
Si se utiliza el bloque de aviso "Program_Alarm", en la ventana de inspección aparecerá la
ficha adicional "Configuración". En los canales de entrada vacíos SD_1 a SD_10 se pueden
introducir valores asociados adicionales que, por ejemplo, no aparecen en los textos.
Para ello, haga clic en el campo de selección situado junto al parámetro y seleccione el valor
deseado.

8336

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.10 Crear y editar avisos

Consulte también
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)

18.10.4

Borrar avisos de programa

Procedimiento
Para borrar un aviso de programa, proceda del siguiente modo:
1. Abra el bloque que contenga el aviso que desee borrar.
2. Seleccione la fila correspondiente en la interfaz de bloque y elija el comando "Borrar" del
menú contextual.
3. En la ventana de instrucciones o el segmento (según sea el lenguaje del bloque) elimine el
bloque de aviso.

Resultado
El aviso se borra.

18.10.5

Editar un tipo de aviso

Procedimiento
Para editar un tipo de aviso, proceda del siguiente modo:
1. Seleccione el bloque de aviso deseado.
2. Introduzca los textos deseados o seleccione los atributos deseados.

Consulte también
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)

18.10.6

Crear un DB de instancia y editar instancias de aviso

Requisitos
Previamente se debe haber creado un FB y haber creado al menos un aviso en él.

Programación del PLC
Manual de programación y manejo, 11/2019

8337

Configurar avisos
18.10 Crear y editar avisos

Procedimiento
Para asignar bloques de datos de instancia (DB) a un tipo de aviso y editar los avisos de dichos
DB para cada instancia, proceda del siguiente modo:
1. En el árbol del proyecto, haga doble clic en "Agregar nuevo bloque"; en el cuadro de diálogo
que se abrirá, haga clic en el botón "Bloque de datos (DB)" y seleccione en la lista
desplegable de "Tipo" el bloque de función (tipo de aviso) al que desee asignar el bloque de
datos de instancia.
2. Haga doble clic en "Supervisiones y avisos del PLC" en el árbol del proyecto. Seleccione la
ficha "Avisos" para abrir la configuración de avisos.
3. Introduzca las modificaciones deseadas para la instancia de aviso correspondiente.

Resultado
Con ello finaliza la configuración de avisos del DB de instancia creado.

Consulte también
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)

18.10.7

Insertar valores asociados en los avisos
Para agregar información actualizada (p. ej. del proceso) a los avisos, es posible insertar
valores asociados en diferentes puntos de un texto de aviso.

Procedimiento con menú contextual
Para insertar un valor asociado en un aviso, proceda del siguiente modo:
1. Abra el menú contextual en el punto deseado y seleccione el comando de menú
correspondiente para insertar una palabra clave, una variable o una entrada de una lista de
textos.
2. En el cuadro de diálogo que aparece, introduzca los parámetros deseados y confirme las
entradas.

8338

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.10 Crear y editar avisos

Nota
Los valores asociados pueden configurarse tanto en el editor de avisos como en el editor de
bloques. Si trabaja en el editor de avisos, debería haber abierto el bloque para el que se
configura el aviso en el editor de bloques. En caso contrario, en el campo de selección
"Variable" solo se pueden interconectar o mostrar variables ya configuradas, pero no agregar
o crear variables nuevas.
Si desea introducir valores asociados en el editor de avisos deberá encontrarse en modo de
edición (haga doble clic en el campo deseado) para visualizar el menú contextual adecuado.

Resultado
El valor asociado se integra en el aviso.
En caso de producirse un error de sintaxis, el texto se marca con fondo rojo y debe corregirse.
No todas las combinaciones de variable y formato son posibles.
Al introducir variables y entradas en listas de textos, los campos "Dirección" y "Parámetros de
aviso" se rellenan automáticamente. De todas formas, no se ven hasta que vuelve a abrirse el
cuadro de diálogo. Si el editor de bloques está abierto, el valor asociado se agrega
automáticamente en el canal de entrada SD_1 a SD_10.
Nota
Si se han configurado varios idiomas de proyecto, los valores asociados se copian en todos los
idiomas del proyecto. Los cambios que se realicen en cada caso se aplican automáticamente
a todos los idiomas del proyecto. Al traducir los textos asegúrese de que se mantiene el mismo
orden en todos los idiomas.
La copia de datos incrustados entre distintos bloques Program_Alarm da lugar a errores a
menos que ambos bloques presenten una disposición idéntica de variables SD del mismo tipo
de datos y formato.

Procedimiento sin menú contextual
Se pueden insertar valores asociados en cualquier punto de un texto de aviso o de información.
Para ello, proceda del siguiente modo:
1. Inserte su bloque "Program_Alarm" en el programa del PLC.
2. Asigne a la entrada SD del bloque "Program_Alarm" la variable cuyo valor quiera que
aparezca en el texto de aviso del "Program_Alarm" o en el texto informativo
correspondiente.
3. Haga doble clic en "Supervisiones y avisos del PLC" en el árbol del proyecto. Seleccione la
ficha "Avisos" > "Avisos del programa".
4. Seleccione el nuevo "Program_Alarm" e inserte la referencia al valor asociado deseado en
la forma "@número SD%indicación de formato@" en el punto que desee del texto de aviso
o informativo.

Programación del PLC
Manual de programación y manejo, 11/2019

8339

Configurar avisos
18.10 Crear y editar avisos

Nota
Si se han configurado varios idiomas de proyecto, los valores asociados no se copian en todos
los idiomas del proyecto. Para ello hay que volver a insertar los valores asociados en la
notación clásica para cada idioma. Aquí no existe ninguna especificación de que los valores
asociados deban estar en el mismo orden en cada idioma.

Consulte también
Ejemplos de valores asociados (Página 8342)
Ajustes al introducir valores asociados (Página 8340)
Particularidades con valores asociados (Página 8341)
Uso de los valores asociados (Página 8739)

18.10.8

Ajustes al introducir valores asociados
Los valores asociados pueden insertarse en avisos tanto en el editor de avisos como en el
editor de bloques. Si trabaja en el editor de avisos, debería haber abierto el bloque para el que
se configura el aviso en el editor de bloques. De este modo, en el campo de selección
"Variable" se muestran los parámetros que pueden aplicarse posteriormente. Si el editor de
bloques está cerrado solo se mostrarán los parámetros ya utilizados.

Introducir una palabra clave
En la lista desplegable se presentan las palabras clave que pueden definirse en el texto.

Introducir una entrada en la lista de textos como valor asociado
Seleccione la lista de textos deseada de la lista desplegable. En el campo de selección
"Variable" seleccione la variable que dispone del índice para la lista de textos en el tiempo de
ejecución del programa.

Introducir una variable como valor asociado
Seleccione la variable deseada en el campo de selección "Variable". El programa completa
automáticamente la dirección y los parámetros de aviso. En el apartado "Formato" debe definir
el tipo de visualización adecuado para la variable especificada, la longitud mínima y, dado el
caso, el número de decimales.

8340

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.10 Crear y editar avisos

Nota
Los proyectos creados con una versión anterior del TIA Portal pueden contener aún la notación
manual en valores asociados incrustados. Esta se corresponde con la sintaxis @<número del
valor asociado>%<formato>@. Encontrará información sobre el parámetro "Formato"
en Estructura de valores asociados (Página 8332).
En proyectos nuevos, es recomendable utilizar solo los cuadros de diálogo descritos
anteriormente para introducir valores asociados.
Si en el programa utiliza accesos ARRAY con índice variable como
#Program_Alarm_1[#myIndex], en el momento de la programación todavía no se conoce qué
elemento ARRAY se utilizará en tiempo de ejecución. Por eso, si selecciona un acceso ARRAY
de este tipo en el editor de programas, en la ventana de inspección siempre se mostrarán las
propiedades del primer elemento del ARRAY.

Consulte también
Palabras clave para textos de aviso (Página 8343)
Insertar valores asociados en los avisos (Página 8338)

18.10.9

Particularidades con valores asociados

Actualización de proyectos anteriores
Los proyectos creados con una versión anterior del TIA Portal pueden contener valores
asociados incrustados con diferentes estructuras en los distintos idiomas del proyecto. Por
ejemplo, los valores asociados pueden tener un orden diferente o faltar en uno de los idiomas.
Al actualizar uno de estos proyectos se unifica el orden de los valores asociados. La
actualización se rige por el idioma de referencia configurado en el proyecto original. En tal caso
es recomendable revisar y corregir los textos traducidos.

Importación de una lista de textos traducida < V14
Puede suceder que haya exportado, compilado y reimportado una lista de textos con una
versión anterior. Si se intenta importar un archivo antiguo en un proyecto actual (p. ej. por tener
igual nombre), se rechaza por incompatibilidad de archivos.

Programación del PLC
Manual de programación y manejo, 11/2019

8341

Configurar avisos
18.10 Crear y editar avisos

18.10.10

Ejemplos de valores asociados

Ejemplos de valores asociados que se introducen a través del menú contextual:
Palabra clave:
<Palabra clave: CpuName>
El nombre de la CPU se introduce como valor asociado.
Variable:
<Variable: #Temperature>
El valor de la variable "#Temperature" se muestra en este lugar del texto de aviso.
Entrada en la lista de textos:
<Lista de textos: USER_1: "tag_1">
El contenido de la variable "tag_1" se utiliza como índice para la lista de textos "USER_1". La
entrada de la lista de textos se muestra en este lugar del texto de aviso.

Ejemplos de valores asociados que se introducen sin menú contextual:
@1%6d@: El valor del valor asociado 1 (SD_1) se representa como número decimal con un
máximo de 6 cifras.
@2%6f@: El valor "5.4", por ejemplo, del valor asociado 2 (SD_2) se representa como número
en coma fija "5.4" (comenzando con tres espacios en blanco).
@2%2f@: El valor "5.4", por ejemplo, del valor asociado 2 (SD_2) se representa como número
en coma fija "5.4" (no se corta cuando el número de cifras es más pequeño).
@10%t#LibTextos1@: El valor asociado 10 (SD_10) se representa con el texto que se va a
introducir de la librería de textos "<LibTextos1".
Ejemplos de indicaciones de formato y valores emitidos:
Valor=255 Formato=%5X Salida="16#000FF"
Valor=123 Formato=%5u Salida=" 123"
Valor=-200 Formato=%4d Salida="-200"
Valor=19 Formato=%8b Salida="2#00010011"
Valor=1234.567 Formato=%8.3f Salida="1234.567"; es decir, no se muestra ningún espacio
vacío aunque tan solo haya 7 cifras

Consulte también
Insertar valores asociados en los avisos (Página 8338)

8342

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.11 Textos y atributos

18.10.11

Borrar valores asociados

Procedimiento:
Para borrar valores asociados, proceda de la manera siguiente:
1. Abra la ficha "Configuración" del editor de programación.
2. Seleccione el valor asociado deseado y bórrelo.
3. Borre el valor asociado también de los textos del editor de avisos.
O bien:
1. Seleccione el canal de entrada deseado en el editor de programación.
2. Borre el valor asociado.
3. Borre el valor asociado también de los textos del editor de avisos.

18.11

Textos y atributos

18.11.1

Palabras clave para textos de aviso

Relación de palabras clave para textos de aviso
Puede seleccionar o introducir las siguientes palabras clave en textos de evento, textos
informativos o textos adicionales, para que el sistema de ingeniería las sustituya por sus
valores reales. Con S7-300/S7-400 solo es posible la notación manual, con S7-1500 se puede
utilizar tanto la notación manual como el método de selección desde el menú contextual.

Nombre del PLC
Nombre del PLC configurado.
Ejemplo S7-1500: <Palabra clave: CpuName> = "PLC_1"
Ejemplo S7-300/S7-400/S7-1500: $$CpuName$$ = "PLC_1"
Nota
Si está trabajando con un sistema R/H, la palabra clave se sustituye por el nombre de la
estación R/H.

Nombre del DB de instancia
Ubicación de la instancia de aviso, normalmente un bloque de datos.

Programación del PLC
Manual de programación y manejo, 11/2019

8343

Configurar avisos
18.11 Textos y atributos
Ejemplo S7-1500: <Palabra clave: Instance> = "Block_3_DB"
Ejemplo S7-300/S7-400/S7-1500: $$Instance$$ = "Block_3_DB"

Anidamiento de FB para el aviso
Si se utilizan bloques anidados en el proyecto, se mostrará en todas las multiinstancias la ruta
de variables del bloque que define el aviso. La ruta conduce al bloque de función a partir del
que se generó el bloque de datos.
Ejemplo S7-1500: <Palabra clave: Path> = "myFB2\myFB1"
Ejemplo S7-300/S7-400/S7-1500: $$Path$$ = "myFB2\myFB1"
Nota
En el caso de los bloques no anidados, la palabra clave "Path" se sustituye por una cadena
vacía.

Nombre del aviso
Nombre del aviso.
Ejemplo S7-1500: <Palabra clave: Name> = "myAlarm"
Ejemplo S7-300/S7-400/S7-1500: $$Name$$ = "myAlarm"
Nota
Las palabras clave no se pueden introducir en listas de textos.

18.11.2

Introducir textos
Los textos de las instancias de aviso se pueden introducir manualmente o se pueden utilizar
valores predeterminados que se introducen en los textos del tipo de aviso. Para ello, haga clic
en la fila correspondiente e introduzca el texto. Si desea proteger el texto contra escritura, haga
clic en la opción correspondiente de la columna. Los textos pueden contener saltos de línea.
Nota
Uso del carácter @ en el cuadro de texto
El carácter @ solo debe utilizarse para declarar valores asociados, p. ej. @4%6d@. Si el
carácter @ se utiliza también en el texto libre de un cuadro de texto, es posible que en
determinadas circunstancias no puedan resolverse los valores asociados que hay en el texto
libre del aviso.

8344

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.11 Textos y atributos

Plantilla de texto del tipo de aviso
Todos los textos del tipo de aviso están disponibles como plantilla al crear los textos de aviso.
Si el tipo de aviso ya contiene un texto general, todas las instancias de dicho tipo contendrán
los mismos atributos y textos. En caso necesario, pueden modificarse en la instancia del aviso.

Texto de evento
Es posible visualizar textos de evento en todos los visualizadores.

Texto informativo
El texto informativo es un texto que puede crearse adicionalmente para determinados
visualizadores.

Textos adicionales
Los textos adicionales son textos que pueden visualizar determinados visualizadores.

18.11.3

Principios básicos para bloquear/desbloquear textos y atributos
Existe la posibilidad de bloquear textos y atributos en el tipo de aviso para que no puedan
modificarse en las instancias de aviso. A partir de la versión V13 SP1, los símbolos de bloqueo
no se muestran en el ajuste predeterminado y se colocan automáticamente en los avisos que
se crean.

Bloqueo de los datos en el tipo de aviso
Para facilitar la creación de avisos, utilice los tipos de aviso como plantilla.
● Si se introducen datos (atributos y textos) para el tipo de aviso, es posible determinar si se
deberán bloquear o no. En caso de datos bloqueados, junto al campo de entrada aparecerá
el símbolo de un eslabón cerrado. En el caso de los atributos no bloqueados, el eslabón
estará abierto.
● Los datos bloqueados en el tipo de aviso no se pueden modificar en los avisos específicos
de la instancia. Los datos sólo se visualizan.
● No obstante, si es necesario realizar modificaciones, es necesario regresar al tipo de aviso,
quitar el bloqueo y realizar los cambios.
Nota
Si en el editor de avisos se modifican instancias de aviso en las que los textos o atributos del
tipo de aviso no estén bloqueados, aparecerá un símbolo del tipo delante de la columna
correspondiente. Al hacer clic en dicho símbolo, los textos o atributos modificados se
restablecen al valor del tipo de aviso.

Programación del PLC
Manual de programación y manejo, 11/2019

8345

Configurar avisos
18.11 Textos y atributos

Consulte también
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)

18.11.4

Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo

Mostrar/ocultar símbolos de bloqueo

Procedimiento
Para mostrar u ocultar los símbolos de bloqueo, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se muestra la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Avisos de PLC" en la navegación local, haga clic en la casilla de
verificación "Mostrar/ocultar símbolos de enclavamiento" y ponga o elimine la marca de
verificación. Al poner la marca de verificación se muestran los símbolos de enclavamiento,
y al quitar la marca de verificación se ocultan los símbolos.

Resultado
El cambio se aplica sin necesidad de guardarlo explícitamente.

Nota
Dicha opción está desactivada por defecto.

Activar/eliminar el bloqueo para avisos de programa nuevos

Procedimiento
Para activar o eliminar el bloqueo en avisos de programa nuevos, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se muestra la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Avisos de PLC" en la navegación local, haga clic en la casilla de
verificación "Activar bloqueos al crear un aviso de programa" y ponga o elimine la marca de
verificación.

8346

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.11 Textos y atributos

Nota
Dicha opción está activada por defecto.

18.11.5

Inhibir textos

Opción "Bloqueado" en el tipo de aviso
Los textos solo se pueden bloquear en los tipos de aviso. El símbolo junto al campo de entrada
indica que están bloqueados. Los textos bloqueados están protegidos contra escritura en
todas las instancias de aviso derivadas del tipo en cuestión.

Requisitos
Los símbolos de bloqueo están activados.
Nota
Se puede elegir cualquier orden para el procedimiento que se explica a continuación.

Bloqueo de textos
Para bloquear textos, proceda del siguiente modo:
● Comience por editar los tipos de aviso.
● Haga clic en el símbolo a la izquierda del campo de entrada que desee bloquear.
Resultado: El símbolo se convierte en un eslabón cerrado.

Desbloquear textos
Para desbloquar textos, proceda del siguiente modo:
● Comience por editar el tipo de aviso.
● Haga clic en el símbolo a la izquierda del campo de entrada que desee desbloquear.
Resultado: El símbolo se convierte en un eslabón abierto.

Consulte también
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)
Introducir textos (Página 8344)

Programación del PLC
Manual de programación y manejo, 11/2019

8347

Configurar avisos
18.11 Textos y atributos

18.11.6

Inhibir atributos

Bloqueo de atributos en el tipo de aviso
Solo es posible bloquear atributos en las los tipos de aviso. El símbolo junto al campo de
entrada indica que están bloqueados. Los atributos bloqueados están protegidos contra
escritura en todas las instancias de aviso derivadas del tipo de aviso en cuestión.

Requisitos
Los símbolos de bloqueo están activados.
Nota
Se puede elegir cualquier orden para el procedimiento que se explica a continuación.

Bloqueo de atributos
Para bloquear atributos, proceda del siguiente modo:
● Comience por editar los tipos de aviso.
● En la tabla, haga clic en el símbolo a la izquierda del campo de entrada que desee bloquear.
Resultado: El símbolo se convierte en un eslabón cerrado.

Desbloqueo de atributos
Para desbloquear atributos, proceda del siguiente modo:
● Comience por editar el tipo de aviso.
● En la tabla, haga clic en el símbolo a la izquierda del campo de entrada que desee
desbloquear.
Resultado: El símbolo se convierte en un eslabón abierto.

Consulte también
Principios básicos para bloquear/desbloquear textos y atributos (Página 8345)
Mostrar/ocultar bloqueos para avisos nuevos y símbolos de bloqueo (Página 8346)

8348

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.12 Listas de textos para avisos

18.12

Listas de textos para avisos

18.12.1

Principios básicos de las listas de textos para avisos
Es posible adaptar las listas de textos existentes (listas de textos definidas por el usuario y por
el sistema) a las distintas necesidades, así como editar textos y atributos. Los textos se pueden
exportar, traducir al idioma o idiomas del proyecto deseados y luego importarlos nuevamente.
Nota
Tenga en cuenta que el botón "Exportar" solo está activo si hay por lo menos una lista de textos
de aviso de PLC seleccionada.
Si un bloque que emite avisos y hace referencia a una lista de textos se copia a otro programa,
también habrá que copiar las correspondientes listas de textos, o bien crear otra lista de textos
con el mismo nombre y contenido o modificar el valor asociado en el texto de aviso.
Nota
Tenga en cuenta que los nombres de las listas de textos no pueden contener ninguno de los
siguientes caracteres especiales:
\/:*?"<>|@
Si hace referencia a una lista de textos que contenga uno de estos caracteres, se indicará un
error de sintaxis. El texto está marcado sobre fondo rojo y debe corregirse.
El capítulo "Trabajar con listas de textos" incluye información detallada sobre las listas de
textos.

Consulte también
Principios básicos para exportar e importar textos de aviso (Página 8357)

18.12.2

Editar listas de textos para avisos

Requisitos
● Se ha creado un aviso de diagnóstico definido por el usuario.

Programación del PLC
Manual de programación y manejo, 11/2019

8349

Configurar avisos
18.12 Listas de textos para avisos

Procedimiento
Para editar las listas de textos definidas por el usuario, proceda del siguiente modo:
1. Haga doble clic en "Listas de textos de aviso del PLC" del árbol del proyecto debajo del
dispositivo.
Se abrirá el editor de listas de textos.
2. Seleccione en la tabla la lista de textos que desee editar.
3. Modifique los valores deseados.
Se pueden modificar textos creados anteriormente o insertar nuevos textos en una lista de
textos existente.
Nota
Tenga en cuenta que las listas de textos de avisos no pueden contener ninguno de los
siguientes caracteres especiales:
\/:*?"<>|@
Si hace referencia a una lista de textos que contenga uno de estos caracteres, se indicará un
error de sintaxis. El texto está marcado sobre fondo rojo y debe corregirse.

18.12.3

Integrar en avisos los textos de listas de textos
En un aviso se pueden integrar textos de distintas listas de textos. Los textos pueden ubicarse
libremente, por lo que también se garantiza el uso en avisos en otros idiomas.

Procedimiento en el S7-300/400
Para integrar en avisos los textos de las listas de textos, proceda del siguiente modo:
1. Haga doble clic en "Supervisiones y avisos del PLC" en el árbol del proyecto. Seleccione la
ficha "Avisos". Se abre el editor de avisos.
2. En el lugar del aviso en el que quiere que aparezca el texto de la lista de textos, introduzca
un valor asociado con el formato @[índice][tipo de datos]%t#[lista de textos]@. El tipo de
datos debe ser del tipo WORD (W).
Nota
S7-300/400: [Índice] = p. ej. 1, siendo 1 el primer valor asociado del aviso.

8350

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.12 Listas de textos para avisos

Procedimiento en el S7-1500
Para integrar en avisos los textos de las listas de textos, proceda del siguiente modo:
1. Haga doble clic en "Supervisiones y avisos del PLC" en el árbol del proyecto. Seleccione la
ficha "Avisos". Se abre el editor de avisos.
2. Vaya al lugar del aviso en el que deba aparecer el texto de la lista de textos y, en el menú
contextual, seleccione la opción para insertar una lista de textos.
3. Seleccione la lista de textos deseada de la lista desplegable. Seguidamente, en el campo
de selección "Variable" elija la variable que incorporará el índice de la entrada en la lista de
textos dentro del sistema de automatización.
Nota
Si trabaja en el editor de avisos, debería haber abierto el bloque para el que se configura
el aviso en el editor de bloques.
Si desea introducir valores asociados en el editor de avisos deberá encontrarse en modo
de edición (haga doble clic en el campo deseado) para visualizar el menú contextual
adecuado.

Consulte también
Estructura de los valores asociados (Página 8332)

18.12.4

Ejemplo de integración en avisos de los textos de las listas de textos
S7-300/400: texto de aviso configurado: La presión es @2W%t#USER_1@.
S7-1500: texto de aviso configurado: La presión ha aumentado <lista de textos: USER_1:
"tag_1">.
Lista de textos con el nombre "USER_1":
Índice

español

inglés

1734

excesiva

too high

1735

insuficiente

too low

Premisa: el valor asociado de la variable "tag_1" recibe el valor 1734.
Resultado: se muestra el siguiente texto de aviso en el panel de operador en tiempo de
ejecución (si está ajustado "español" como idioma de proyecto): La presión es excesiva.
Premisa: el valor asociado de la variable "tag_1" recibe el valor 1735.
Resultado: se muestra el siguiente texto de aviso en el panel de operador en tiempo de
ejecución (si está ajustado "español" como idioma de proyecto): La presión es insuficiente.

Consulte también
Integrar en avisos los textos de listas de textos (Página 8350)

Programación del PLC
Manual de programación y manejo, 11/2019

8351

Configurar avisos
18.13 Categorías

18.13

Categorías

18.13.1

Crear categorías
Las categorías se pueden configurar libremente. Es posible crearlas y editarlas en el editor de
categorías. Seguidamente se puede asignar una categoría a un aviso en el editor de avisos.
El sistema ya ha creado dos categorías de avisos, "Acknowledgment" (para avisos con acuse)
y "No acknowledgment" (para avisos sin acuse). En ellas solo es posible modificar el nombre
de visualización.
En total es posible crear 16 categorías de avisos, a las que se pueden asignar las prioridades
correspondientes. La propiedad "Con acuse" de las categorías indica si los avisos
correspondientes son de acuse obligado, es decir, si requieren confirmación.

Requisitos
En el árbol del proyecto se ha abierto la carpeta "Datos comunes".

Procedimiento
Para crear una categoría, proceda del siguiente modo:
1. Haga doble clic en la entrada "Categorías" del árbol del proyecto.
Se abrirá el editor de categorías.
2. Elija el comando "Insertar nueva categoría" del menú contextual.
Resultado: se ha creado una categoría nueva con un nombre asignado automáticamente.
3. Asigne un nombre distinto a la nueva categoría en la columna "Nombre" en caso de ser
necesario.
El nombre es neutro para todos los idiomas.
4. Dado el caso, indique en la columna "Nombre de visualización" el nombre que se
visualizará. Este nombre es traducible.
5. En la columna "Con acuse", indique si los avisos de esta categoría deben confirmarse o no.
6. Dado el caso, ajuste una prioridad. Esto solo es posible en las categorías definidas por el
usuario.
La prioridad se aplica al tipo de aviso.
Nota
Tenga en cuenta que al crear avisos en las CPU S7-1500 es necesario indicar la categoría de
aviso. Esta especifica si el aviso requiere acuse o no.
S7-1500: Las alarmas de programa en las que se ha seleccionado la opción "Solo información"
deben activarse el menor tiempo posible. De este modo se impide un archivado repetido
(fichero de avisos) al descargar después de haber modificado el texto de la alarma de
programa.

8352

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.13 Categorías

18.13.2

Editar categorías
En cualquier momento pueden modificarse los ajustes (nombre, nombre de visualización,
prioridad o acuse) de una categoría, incluso si dicha categoría ya tiene asignados avisos. Los
cambios se aplicarán automáticamente en los avisos (siempre que no se hayan sobrescrito los
ajustes en el aviso).

Copiar categorías
Para copiar categorías, proceda de la siguiente manera:
1. Marque la fila con la categoría que quiere copiar.
2. Elija el comando "Copiar" del menú contextual.
3. Elija el comando "Pegar" del menú contextual.

Resultado
La categoría copiada se almacenará con un nuevo nombre en la última posición de la tabla.
El nombre de la nueva categoría se compone de lo siguiente:
<Nombre antiguo>_<n.º>
N.º: número natural más bajo disponible

Nota
● Tenga en cuenta que al crear avisos en las CPU S7-1500 es necesario indicar la categoría
de aviso. Esta especifica si el aviso requiere acuse o no.
● En las categorías creadas por el sistema solo es posible cambiar el nombre de
visualización.

18.13.3

Borrar categorías
Puesto que el número máximo de categorías que pueden crearse es de 16, puede ser
necesario borrar categorías que ya no se necesitan.

Procedimiento
Para borrar una categoría, proceda del siguiente modo:
1. Haga doble clic en la entrada "Categorías" del árbol del proyecto.
Se abrirá el editor de categorías.
2. Seleccione la categoría deseada y haga clic en el símbolo "Borrar" de la barra de
herramientas.

Programación del PLC
Manual de programación y manejo, 11/2019

8353

Configurar avisos
18.13 Categorías

Resultado
La categoría se ha borrado.
Nota
Las categorías creadas por el sistema no pueden borrarse.

18.13.4

Prioridad de la categoría de aviso
En avisos de programa y avisos de diagnóstico de usuario es posible definir una prioridad (0
a 16) para cada tipo de aviso. Habitualmente la prioridad de una categoría de aviso se
especifica o modifica en el editor de categorías de aviso, pero puede modificarse
posteriormente en el editor de avisos para avisos concretos. El bloque asignado al aviso no
puede estar protegido contra escritura. Al crear avisos nuevos, la prioridad ajustada de manera
estándar es "0".

Modificación de la prioridad en el tipo de aviso y en los avisos
Si se modifican datos a posteriori en el tipo de aviso, estas modificaciones se aplicarán
automáticamente a las instancias. Excepción: los datos se han modificado previamente en la
instancia.
La tabla siguiente muestra una relación de las posibles acciones y sus repercusiones:

Situación inicial

Acción

Resultado

No existe ningún tipo de aviso.

Se crea el tipo de aviso.

La prioridad de la categoría de aviso en
el editor de categorías de avisos es
idéntica a la prioridad del tipo de aviso
en la columna "Prioridad" del editor de
avisos.

El tipo de aviso ya existe, la prioridad no
cambia.

Cambia la categoría de aviso en el tipo
de aviso.

La prioridad de la categoría de aviso en
el editor de categorías de avisos es
idéntica a la prioridad del tipo de aviso
en la columna "Prioridad" del editor de
avisos.

El tipo de aviso ya existe, la prioridad no
cambia.

La prioridad de la categoría de aviso
cambia en el editor de categorías de
aviso.

La prioridad de la categoría de aviso en
el editor de categorías de avisos es
idéntica a la prioridad del tipo de aviso
en la columna "Prioridad" del editor de
avisos.

El tipo de aviso ya existe, la prioridad no
cambia.

La categoría de aviso se borra en el edi‐ La prioridad del tipo de aviso cambia a
tor de categorías de aviso.
"0" y se marca como "no válida".

El tipo de aviso ya existe, la prioridad no
cambia.

La prioridad cambia en el tipo de aviso. La prioridad de la categoría de aviso en
el editor de categorías de aviso es dis‐
tinta de la prioridad del tipo de aviso en
la columna "Prioridad" del editor de avi‐
sos.

8354

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.13 Categorías
Situación inicial

Acción

Resultado

El tipo de aviso ya existe, la prioridad del Cambia la categoría de aviso de la ins‐
tipo de aviso ha cambiado.
tancia.

La prioridad de la categoría de aviso en
el editor de categorías de aviso es dis‐
tinta de la prioridad de la instancia en la
columna "Prioridad" del editor de avisos.

El aviso (instancia) ya existe, la priori‐
dad del tipo de aviso ha cambiado.

Se modifica la prioridad de la categoría
de aviso.

La prioridad de la categoría de aviso en
el editor de categorías de aviso es dis‐
tinta de la prioridad de la instancia en la
columna "Prioridad" del editor de avisos.

El aviso (instancia) ya existe, la priori‐
dad del tipo de aviso ha cambiado.

La categoría de aviso se borra en el edi‐ Se muestra la prioridad en el tipo de avi‐
tor de categorías de aviso.
so, la categoría de aviso se marca como
"no válida".

El aviso (instancia) ya existe, la priori‐
dad del tipo de aviso ha cambiado.

La prioridad del tipo de aviso cambia al La prioridad de la categoría de aviso es
mismo valor que la prioridad de la cate‐ idéntica a la de la columna "Prioridad"
goría de aviso.
en el editor de avisos, pero no están
acopladas (*).

El aviso (instancia) ya existe, la priori‐
dad del tipo de aviso ha cambiado.

La prioridad del tipo de aviso retoma la
prioridad de la categoría de aviso.

La prioridad de la categoría de aviso es
idéntica a la prioridad en la columna
"Prioridad" en el editor de avisos.

Si la prioridad se cambia a posteriori en el aviso, el valor se marca con un asterisco (*).
Para los valores modificados puede restablecerse en cualquier momento la prioridad de la
categoría de aviso. Para ello, en la lista desplegable seleccione la entrada "Restablecer al valor
del tipo de aviso".

18.13.5

Exportar e importar categorías

18.13.5.1

Principios básicos para exportar e importar categorías

Descripción
Las categorías de aviso de un proyecto pueden exportarse e importarse a otro proyecto. La
ventaja de esto es que evita tener que crear las categorías individualmente para cada
proyecto.
Las categorías de aviso se guardan en un archivo de datos (*.dat).

18.13.5.2

Exportar categorías de aviso

Requisitos
Hay un proyecto abierto.

Programación del PLC
Manual de programación y manejo, 11/2019

8355

Configurar avisos
18.13 Categorías

Procedimiento
Para exportar las categorías de aviso, proceda del siguiente modo:
1. En el árbol del proyecto haga clic en la carpeta "Datos comunes" y haga doble clic en la
entrada "Categorías".
2. En el editor de categorías haga clic en el icono "Exportar ajustes de categorías" de la barra
de herramientas. Se abre el cuadro de diálogo "Guardar como".
3. Seleccione la ruta en la que se debe depositar el archivo de exportación.
4. Haga clic en el botón "Guardar".

Resultado
En la ubicación seleccionada se crea un archivo .dat.

18.13.5.3

Importar categorías de aviso

Requisitos
El proyecto al que se van a exportar las categorías está abierto.

Procedimiento
Para importar las categorías, proceda del siguiente modo:
1. En el árbol del proyecto haga clic en la carpeta "Datos comunes" y haga doble clic en la
entrada "Categorías".
2. En el editor de categorías haga clic en el icono "Importar ajustes de categorías" de la barra
de herramientas. Se abre el cuadro de diálogo "Abrir".
3. Seleccione la ruta en la que está depositado el archivo que debe importarse.
4. Seleccione el archivo .dat que desee.
5. Haga clic en el botón "Abrir".
Nota
El icono "Importar" se muestra en gris si el proyecto abierto está protegido contra escritura (p.
ej. proyecto de referencia).
Si se producen errores durante la importación, aparecerá un mensaje y el proceso se
interrumpirá.

Resultado
Se muestran las categorías de aviso.

8356

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.14 Importar y exportar textos de aviso

18.14

Importar y exportar textos de aviso

18.14.1

Principios básicos para exportar e importar textos de aviso

Introducción
Los textos de aviso del programa del tipo de aviso pueden exportarse en un formato XLSX
estandarizado y editarse con editores de tablas externos (p. ej. para compilar). También es
posible importar al TIA Portal los textos de aviso que se editaron con editores de tablas
externos.

Formato del archivo de exportación
Los títulos de las columnas tienen nombres fijos que no deben cambiarse. El orden de las
columnas dentro de una hoja de tabla puede variar. El número de columnas varía en función
de la selección realizada durante la exportación. Cada aviso obtiene una fila propia en el
archivo.
La siguiente tabla indica los contenidos previstos en las columnas individuales:

Columna

Explicación

Relevante para la tra‐
ducción

Location

Nombre del bloque al que está asignado el aviso.

no

Alarm name

Nombre del aviso

no

"Alarm text" - English (United Sta‐
tes) / [en-US] / Event text

Texto de evento del aviso

"Info text" - English (United States) /
[en-US] / Info text

Texto informativo del aviso

"Additional text" - English (United
States) / [en-US] / Additional text

Texto complementario del aviso

El nombre del campo
contiene un código de
idioma. Para la impor‐
tación es necesario
que los textos de aviso
estén provistos de un
código de idioma.

sí
sí
sí

Si el texto del aviso in‐
cluye un valor asocia‐
do, al texto se le añade
una expresión con una
ID de referencia en
S7-1500. Ejemplo: text
<field ref="0" />. La ID
permite asignar el va‐
lor asociado a un texto
de aviso.
FieldInfo (solo para S7-1500)

Especifica si el texto del aviso contiene valores asociados.
Los ajustes están separados por un punto y coma (";").

no

Ejemplo de valores asociados en S7-1500:
Variable: <ref id = 0; type = AlarmTag; Tag = Tag1; Dis‐
playType = Decimal; Length = 5;>
Lista de textos: <ref id = 1; type = CommonTextList; TextList
= Textlist1; Tag = tag 2; Length = 5;>

Programación del PLC
Manual de programación y manejo, 11/2019

8357

Configurar avisos
18.14 Importar y exportar textos de aviso

Ejemplo de S7-300/400
La figura siguiente muestra a modo de ejemplo un extracto de un archivo de información de
S7-300/400.

Nota
Tenga en cuenta que en el ejemplo anterior las palabras clave (incluidas en $$ y @) tampoco
deben traducirse.

Ejemplo de S7-1500
La figura siguiente muestra a modo de ejemplo un extracto de un archivo de información de
S7-1500.

Traducción de textos de aviso en un editor de tablas externo
Los textos se traducen en la columna correspondiente con el código de idioma indicado para
el idioma al que deben traducirse. Al traducir los textos asegúrese de que en todos los idiomas
se mantiene el mismo orden de los valores asociados, pues en caso contrario no se podrán
volver a importar los textos.

Consulte también
Exportar textos de aviso (Página 8359)
Importar textos de aviso (Página 8359)
Particularidades con valores asociados (Página 8341)

8358

Programación del PLC
Manual de programación y manejo, 11/2019

Configurar avisos
18.14 Importar y exportar textos de aviso

18.14.2

Exportar textos de aviso

Requisitos
El editor de avisos está abierto.

Procedimiento
Para exportar textos de aviso, proceda del siguiente modo:
1. En la ficha "Avisos de programa", haga clic en el símbolo "Exportar" de la barra de
herramientas. Se abrirá el cuadro de diálogo "Exportar textos de aviso".
2. Seleccione la ruta en la que se debe depositar el archivo de exportación.
3. Seleccione los idiomas deseados.
4. Elija también si deben exportarse textos de eventos, textos informativos y/o textos
complementarios.
5. Haga clic en el botón "Aceptar".
Nota
● En el cuadro de diálogo de exportación se muestran todos los idiomas de proyecto
seleccionados en el TIA Portal. Existe la posibilidad de agregar más idiomas en el editor de
idiomas del proyecto para que aparezcan en esta selección. En el ajuste predeterminado
están seleccionados todos los idiomas de proyecto disponibles; es posible desmarcar los
idiomas que no son relevantes para el proceso de traducción actual.
● Exporte los datos sólo a un área protegida con los debidos mecanismos de acceso.

Consulte también
Principios básicos para exportar e importar textos de aviso (Página 8357)

18.14.3

Importar textos de aviso

Requisitos
El editor de avisos está abierto.

Programación del PLC
Manual de programación y manejo, 11/2019

8359

Configurar avisos
18.14 Importar y exportar textos de aviso

Procedimiento
Para importar textos de aviso, proceda del siguiente modo:
1. En la ficha "Avisos de programa", haga clic en el símbolo "Importar" de la barra de
herramientas. Se abrirá el cuadro de diálogo "Importar textos de aviso".
2. Seleccione la ruta en la que está depositado el archivo que debe importarse y haga clic en
el botón "Importar".
3. Seleccione el o los idiomas deseados en el cuadro de diálogo que aparece a continuación.
4. Haga clic en el botón "Aceptar".
Nota
● No es necesario utilizar en la importación los mismos ajustes que para la exportación.
● Importe archivos únicamente de fuentes de confianza.

Consulte también
Principios básicos para exportar e importar textos de aviso (Página 8357)

8360

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.1

19

Fundamentos sobre la compilación y carga de programas de PLC

Compilación y carga de programas de PLC
Para que el programa de PLC que se ha creado pueda funcionar en el sistema de
automatización, primero hay que compilar los datos del programa generados offline y después
hay que cargarlos en un dispositivo. Los datos del programa pueden cargarse en dispositivos
y Memory Cards.
Compilación del programa de PLC
Los bloques siempre se compilan al completo para mantener la coherencia del programa.
Encontrará más información sobre la compilación del programa de PLC aquí: Principios
básicos de la compilación de bloques (Página 8362)
Carga del programa de PLC
Los datos del programa se cargan íntegramente la primera vez que se realiza la carga. En los
procesos de carga posteriores se cargan únicamente los cambios.
Al cargar en el dispositivo también se cargan todos los cambios en bloques, tipos de datos PLC
y variables PLC para garantizar una carga coherente.

Nota
Cargar en dispositivo
● En las siguientes descripciones referentes al proceso de carga, cuando se habla de
"bloques" se hace referencia a todo el programa de PLC, incluidos los tipos de datos PLC
y las variables PLC.

Durante la operación de carga, toda información necesaria para reconstruir el programa
(incluida la información simbólica como, p. ej., nombres y comentarios para bloques lógicos y
de datos) también se carga en hasta tres idiomas de proyecto configurados. Por esta razón, si
modifica el idioma del proyecto, es necesario realizar una nueva operación de carga.
La información simbólica no se carga en la memoria de trabajo, sino en la memoria de carga.
Una vez se han cargado los datos de un dispositivo, la información simbólica también vuelve
a estar disponible en el programa, de forma que mejora la lectura del código del programa. No
obstante, tenga en cuenta que no es posible reemplazar el almacenamiento de datos en un
proyecto offline cargando desde y hacia un dispositivo, puesto que este proceso no permite
reproducir, p. ej., las tablas de observación o el multilingüismo de proyectos.

Programación del PLC
Manual de programación y manejo, 11/2019

8361

Compilación y carga de programas de PLC
19.2 Compilar bloques
Los datos de bloques con protección de know-how solo pueden mostrarse por completo
después de realizar la carga desde un dispositivo con una contraseña correcta.
A partir de TIA Portal V15, al realizar la carga las variables PLC se depositan acorde con las
tablas de variables configuradas offline.
Encontrará más información sobre la carga del programa de PLC aquí:
Introducción a la carga de bloques (Página 8368) (S7-1200/1500)
Introducción a la carga de bloques (Página 8392) (S7-300/400)
Introducción a la carga de variables PLC (Página 8407) (S7-1200/1500)

Consulte también
Principios básicos de la compilación de bloques (Página 8362)
Introducción a la carga de bloques (Página 8392)
Introducción a la carga de bloques (Página 8368)
Introducción a la carga de variables PLC (Página 8407)
Compilación y carga de Software Units (Página 7717)

19.2

Compilar bloques

19.2.1

Principios básicos de la compilación de bloques

Introducción
Para que la CPU pueda procesar el programa de usuario, este se debe compilar primero. Cada
vez que se modifica el programa es preciso compilarlo de nuevo.
Durante la compilación se llevan a cabo las siguientes operaciones:
● Se buscan errores de sintaxis en el programa de usuario.
● Las instrucciones no necesarias se eliminan del programa de usuario.
● Se comprueban todas las llamadas de bloque en los bloques compilados. En caso de
modificaciones en las interfaces de los bloques llamados, se muestran los errores en la
ficha "Compilar" de la ventana de información. Estos errores se deben corregir en primer
lugar.

8362

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.2 Compilar bloques
● En el programa de usuario, los números de bloques deben ser unívocos. Si hay varios
bloques con el mismo número, durante la compilación se cambia automáticamente el
número de los bloques que presentan conflictos. En los siguientes casos no se cambia el
número de un bloque:
– El bloque se ha seleccionado para la compilación individualmente o bien como parte de
una selección múltiple.
– En las propiedades del bloque se ha ajustado una asignación de números "manual".
Los conflictos de números que no pueden solucionarse mediante el cambio automático de
número deben corregirse manualmente. Tenga en cuenta al respecto los avisos de la
ventana de inspección.
Nota
Cambio de número de bloques con protección de know-how
Para CPU de las series S7-1500 y S7-1200 (a partir de V4) no es posible cambiar
automática o manualmente el número de bloques con protección de know-how sin una
contraseña. Además, la protección de know-how debe haberse activado con una versión
del TIA Portal igual o superior a V13 SP1.
● A continuación, el programa de usuario se compila a un código legible por la CPU.

Vías de compilación
La compilación puede iniciarse en las siguientes ventanas o editores:
● Compilar bloques en el árbol del proyecto
Permite compilar bloques individuales, o bien compilar simultáneamente varios o todos los
bloques de la carpeta "Bloques de programa".
● Compilar bloques en el editor de programación
Permite compilar un solo bloque abierto.
● Compilar bloques en la estructura de llamadas o de dependencias
Permite compilar bloques individuales.
Consulte también: Estructura de llamadas (Página 8465), estructura de dependencias
(Página 8472)

Programación del PLC
Manual de programación y manejo, 11/2019

8363

Compilación y carga de programas de PLC
19.2 Compilar bloques

Opciones de compilación
Si se compilan bloques desde el árbol del proyecto, se ofrecen las siguientes opciones
adicionales:
● Software (solo cambios)
Se compilan todos los cambios de programa de los bloques seleccionados. Si se ha
seleccionado una carpeta de bloques, todos los cambios de programa se compilan en los
bloques contenidos en ella.
● Software (compilar todos los bloques)
Todos los bloques se compilan por completo. Se recomienda elegir esta opción en la
primera compilación y al realizar cambios mayores.
● Software (inicializar reserva de memoria)
Todas las variables declaradas en el área de reserva de las interfaces de los bloques
seleccionados se mueven al área estándar de las interfaces. La reserva de memoria se
libera para otras ampliaciones de interfaz.
Nota
Esta opción solo está disponible en CPU de las series S7-1500 y S7-1200 a partir de V4.

Comprobación de coherencia
Si se modifican interfaces de bloques llamados o los tipos de datos PLC utilizados, se pueden
presentar incoherencias entre los bloques invocantes y llamados o entre los tipos de datos
PLC y los bloques de datos globales que utilizan estos tipos de datos PLC.
Para evitar tales incoherencias en el programa de usuario, el sistema realiza una
comprobación de coherencia automática antes de cada proceso de compilación. Se comparan
los sellos de tiempo y, dependiendo del resultado de la comparación, el proceso de
compilación se realiza o se cancela:
● La compilación correcta del bloque invocante solo es posible si los sellos de tiempo de las
interfaces de los bloques llamados son más antiguos que los del bloque invocante.
● La compilación correcta de un bloque de datos global basado en un tipo de datos PLC solo
es posible si el sello de tiempo del bloque de datos global es más reciente que el del tipo de
datos PLC utilizado.
● La compilación correcta de un bloque de datos instancia solo es posible si los sellos de
tiempo de las interfaces del bloque de datos instancia y del bloque de función asignado son
idénticos.
Si se cancela el proceso de compilación, aparece un mensaje en la ventana de inspección.
Actualice primero las llamadas de bloque en los bloques respectivos, los tipos de datos PLC
en los bloques de datos globales e inicie nuevamente el proceso de compilación. La
comprobación de coherencia también determina los bloques con protección de know-how para
los que no se realiza el proceso de compilación. También encontrará los avisos
correspondientes en la ventana de inspección.

8364

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.2 Compilar bloques
Si se inicia inmediatamente un proceso de carga en vez de uno de compilación, los bloques
seleccionados se compilan automáticamente y los bloques de datos globales se actualizan
implícitamente. Existen las siguientes diferencias en las familias de CPU:
● S7-1200/1500: En un proceso de carga también se cargan todos los bloques implicados, de
modo que no pueden producirse incoherencias.
● S7-300/400: Solo se carga el bloque seleccionado.

Consulte también
Compilar bloques en el árbol del proyecto (Página 8365)
Compilar bloques en el editor de programación (Página 8366)
Solucionar errores de compilación (Página 8367)
Sellos de tiempo de bloques (Página 7745)
Actualizar llamadas de bloque en KOP (Página 7966)
Actualizar llamadas de bloque en FUP (Página 8027)
Actualizar las llamadas de bloque en AWL (Página 8093)

19.2.2

Compilar bloques en el árbol del proyecto
En el árbol del proyecto es posible compilar uno, varios o todos los bloques.
En las CPU de las series S7-1500 y S7-1200 V4, la compilación permite reinicializar además
el formato de memoria de los bloques con reserva de memoria. Encontrará la descripción de
la reserva de memoria en el capítulo "Cargar bloques (S7-1200/1500) > Cargar cambios de
bloque sin reinicializar".

Requisitos
El árbol del proyecto está abierto.

Compilar uno o varios bloques en el árbol del proyecto
Para compilar uno o varios bloques en el árbol del proyecto, proceda del siguiente modo:
1. Abra la carpeta "Bloques de programa" del árbol del proyecto.
2. Seleccione los bloques que desea compilar.
3. Elija el comando "Compilar > Software (solo cambios)" del menú contextual.

Programación del PLC
Manual de programación y manejo, 11/2019

8365

Compilación y carga de programas de PLC
19.2 Compilar bloques

Compilar todos los bloques en el árbol del proyecto
Para compilar todos los bloques de la carpeta "Bloques de programa" en el árbol del proyecto,
proceda del siguiente modo:
1. Seleccione la carpeta "Bloques de programa" del árbol del proyecto.
2. Para la compilación se puede elegir una de las opciones siguientes:
– Si desea compilar únicamente los cambios efectuados desde la última compilación, elija
el comando "Compilar > Software (solo cambios)" del menú contextual.
– Si desea compilar los bloques por completo, elija el comando "Compilar > Software
(compilar bloques por completo)" del menú contextual.

Reinicializar el formato de memoria (S7-1500/S7-1200 V4)
Para reinicializar el formato de la memoria de bloques, proceda del siguiente modo:
1. Seleccione toda la carpeta "Bloques de programa" o bloques individuales dentro de ella.
2. En el menú contextual, elija el comando "Compilar > Software (inicializar reserva de
memoria)".

Resultado
Si la comprobación de coherencia ha finalizado correctamente, se genera el código para los
bloques. Se borran los bloques de datos instancia generados por el sistema y que ya no son
necesarios.
El aviso que aparece en la ventana de inspección en "Información > Compilar" indica si la
compilación se ha realizado correctamente.

Consulte también
Principios básicos de la compilación de bloques (Página 8362)
Compilar bloques en el editor de programación (Página 8366)
Solucionar errores de compilación (Página 8367)
Buscar errores de sintaxis en el programa (Página 7689)

19.2.3

Compilar bloques en el editor de programación
Nota
Recuerde que el bloque también se vuelve a compilar aunque no se hayan realizado cambios,
con lo que cambiarán los sellos de tiempo del bloque.

8366

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.2 Compilar bloques

Requisitos
El bloque que se desea compilar está abierto.

Procedimiento
Para compilar un bloque en el editor de programación, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la ventana de instrucciones del editor de
programación.
2. Elija el comando "Compilar" del menú contextual.

Resultado
Se genera el código del bloque. Se borran los bloques de datos instancia generados por el
sistema y que ya no son necesarios.
El aviso que aparece en la ventana de inspección en "Información > Compilar" indica si la
compilación se ha realizado correctamente.

Consulte también
Principios básicos de la compilación de bloques (Página 8362)
Compilar bloques en el árbol del proyecto (Página 8365)
Solucionar errores de compilación (Página 8367)

19.2.4

Solucionar errores de compilación
En la ventana de inspección se indica bajo "Información > Compilar" si la compilación se ha
realizado correctamente, o bien si se han detectado errores en el programa. Si ocurren errores,
es preciso solucionarlos y reiniciar luego la compilación.

Procedimiento
Para solucionar errores de compilación, proceda del siguiente modo:
1. En la ventana de inspección, elija "Información > Compilar" para abrir la lista de errores.
2. Si aparece, haga clic en el signo de interrogación azul situado junto al texto de error para
obtener indicaciones sobre cómo solucionar el error.
3. Haga doble clic en el error que desea corregir.
Se selecciona el error en cuestión.
4. Corrija el error.
5. Reinicie la compilación.

Programación del PLC
Manual de programación y manejo, 11/2019

8367

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Consulte también
Principios básicos de la compilación de bloques (Página 8362)
Compilar bloques en el editor de programación (Página 8366)
Compilar bloques en el árbol del proyecto (Página 8365)

19.3

Cargar bloques para S7-1200/1500

19.3.1

Introducción a la carga de bloques

Cargar bloques en un dispositivo
Para que la CPU pueda procesar el programa de usuario, los datos del programa se deben
compilar primero y cargar luego en el dispositivo.
Los datos del programa pueden cargarse en dispositivos y Memory Cards.
La carga en y desde dispositivo puede iniciarse por distintas vías:
● con los comandos del menú "Online"
● con el menú contextual
● con el botón "Cargar" de la barra de herramientas
La carga puede iniciarse en el árbol del proyecto desde los siguientes objetos:
● desde dispositivos
● desde la carpeta "Bloques de programa"
● desde bloques individuales
● desde la carpeta "Tipos de datos PLC"
● desde la carpeta "Variables PLC"
Dependiendo del objeto y del comando seleccionados en cada caso, desde el menú "Online"
podrán cargarse los siguientes componentes:
● Cargar en dispositivo
Tanto la configuración hardware como el software se cargan en el destino si hay diferencias
entre las versiones online y offline.
● Carga avanzada en dispositivo
Tanto la configuración hardware como el software se cargan en el destino si hay diferencias
entre las versiones online y offline. En la carga avanzada se pueden seleccionar
adicionalmente un dispositivo de destino y los ajustes para el mismo.

8368

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
● Cargar el programa de PLC en el dispositivo e inicializar
Se carga en el destino el programa de PLC con todos los bloques, tipos de datos PLC y
variables PLC y todos los valores se inicializan a sus valores de arranque. Recuerde que
lo mismo ocurre con los valores remanentes. La CPU pasa a "STOP".
● Cargar el programa de usuario en la Memory Card
Todo el programa se carga en una Memory Card insertada.
Dependiendo del objeto y del comando seleccionados en cada caso, desde el menú contextual
podrán cargarse los siguientes componentes:
● Hardware y software (solo cambios)
Tanto la configuración hardware como el software se cargan en el destino si hay diferencias
entre las versiones online y offline.
● Configuración hardware
Solo se carga en el destino la configuración hardware.
● Software (solo cambios)
Solo se cargan en el destino los objetos que difieren online y offline.
● Software (cargar por completo)
Todo el software se carga en el destino.

Nota
No existe ninguna configuración hardware válida
Si no se encuentra ninguna configuración hardware válida durante la carga del software en la
CPU, también se cargará el hardware existente al "Cargar en dispositivo".
Tenga en cuenta que, en ese caso, durante la carga se cargarán componentes de hardware
aunque haya ejecutado el comando para la carga del software.

Nota
Para evitar incoherencias entre los bloques que llaman y los bloques llamados, cuando se
realizan modificaciones globales (p. ej. cambios de la interfaz de un bloque) siempre se
compilan y cargan todos los bloques afectados.

Nota
S7-1500
En las CPU de la serie S7-1500, la memoria de carga se encuentra en la SIMATIC Memory
Card. Por lo tanto, es imprescindible insertar una SIMATIC Memory Card para el
funcionamiento de la CPU.

Programación del PLC
Manual de programación y manejo, 11/2019

8369

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Cargar bloques de un dispositivo
Los bloques de un dispositivo se pueden cargar en el proyecto. Esto es necesario, p. ej., para
modificar bloques que solo existen en este dispositivo. En este proceso existe la posibilidad de
cargar en el proyecto todos los bloques existentes (bloques de organización y de función,
funciones y bloques de datos) y las variables PLC globales o bien cargar los bloques
individualmente.

Cargar bloques en una Memory Card o de una Memory Card
Las Memory Cards son tarjetas de memoria enchufables que sirven, p. ej. en una CPU de la
serie S7-1200, para sustituir la memoria de carga de un dispositivo. En las CPU de la serie
S7-1500, contienen la memoria de carga. Para los dispositivos de las series S7-1200 y
S7-1500 solo pueden utilizarse SIMATIC Memory Cards de Siemens.
Para poder utilizar la Memory Card como memoria de carga, el programa de usuario o los
distintos bloques deben cargarse en una Memory Card. Los bloques también se pueden volver
a cargar en el proyecto desde una Memory Card.
Nota
S7-1200
Tenga en cuenta las indicaciones siguientes al cargar en o de una Memory Card:
● Si la CPU no contiene todavía ningún programa y se inserta en ella una Memory Card vacía,
el programa de la PG/el PC se cargará en la Memory Card y no en la CPU.
● Si antes de arrancar la CPU se inserta en ella una Memory Card vacía, el programa
contenido en la CPU se transferirá automáticamente a la Memory Card. A continuación, se
borra el programa de la CPU.
● Si se inserta una Memory Card en una CPU que también contiene un programa antes de
arrancarla, se ejecutará el programa de la Memory Card y no el de la CPU. El programa de
la CPU se borra.

Cargar bloques de función GRAPH
Si se carga un bloque de función GRAPH junto con su bloque de datos de instancia, el
procesamiento de la cadena secuencial empieza de nuevo por la etapa inicial. Esto puede
provocar problemas en la sincronización de la cadena secuencial con el proceso. Dichos
problemas se evitan desactivando la cadena secuencial antes de la carga.

Cargar cambios de bloque sin reinicializar
Con frecuencia surge la necesidad de modificar o ampliar a posteriori un programa de PLC que
ya se ha puesto en servicio y que funciona correctamente en una instalación. El proceso debe
afectar al funcionamiento lo menos posible.
Por ello, las CPU S7-1500 ofrecen la posibilidad de ampliar las interfaces de bloques de
función o datos durante el funcionamiento y cargar los bloques modificados sin necesidad de
pasar la CPU a STOP y sin que los valores de las variables ya cargadas se vean afectados. De
ese modo es posible realizar cambios en el programa con facilidad. El proceso controlado no
se ve afectado por esta carga (cargar sin reinicializar).

8370

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Repercusiones de una operación de carga en los valores de variables de un bloque de datos
Cuando se cargan bloques de datos en un dispositivo en el estado operativo STOP, la
siguiente transición del dispositivo a RUN afecta a los valores actuales de las variables del
siguiente modo:
● Las variables que no están marcadas como remanentes reciben sus valores de arranque
definidos.
● Las variables remanentes de las CPU S7-1200 solo conservan sus valores si se cumplen
las siguientes condiciones:
– El bloque de datos se ha cargado con el comando "Cargar en dispositivo > Software
(solo cambios)".
– No se ha modificado la estructura del bloque de datos.
De lo contrario, también las variables remanentes recibirán sus valores de arranque
definidos.
● Las variables remanentes de las CPU S7-1500 solo conservan sus valores si se cumplen
las siguientes condiciones:
– El bloque de datos se ha cargado con el comando "Cargar en dispositivo > Software
(solo cambios)".
– No se ha modificado la estructura del bloque de datos o se ha modificado dentro de la
reserva de memoria.
De lo contrario, también las variables remanentes recibirán sus valores de arranque
definidos.

Cargar bloques con sincronización
En el contexto de los equipos de ingeniería, puede darse el caso de que varios usuarios con
varios sistemas de ingeniería trabajen en un proyecto y accedan a una CPU S7-1500 en
paralelo. Para garantizar la coherencia dentro de dicho proyecto es necesario sincronizar los
datos modificados antes de cargarlos para que no se sobrescriban accidentalmente.
Así pues, si durante la carga se detectan diferencias entre la gestión de datos online y offline
dentro del proyecto común y estas diferencias han sido causadas por otro sistema de
ingeniería, en el proceso de carga se ofrece automáticamente una sincronización de los datos
que van a cargarse.
En ese caso, en el cuadro de diálogo "Sincronización" se muestran los datos que deben
sincronizarse con el estado actual (comparación online/offline) y las acciones posibles.
Existen las siguientes opciones de sincronización:
Caso de aplicación

Recomendación

Sincronización

Uno o varios bloques son más nuevos
en la CPU (online) que en el sistema de
ingeniería (offline).

Antes de la carga, estos bloques debe‐
rían cargarse primero de la CPU al sis‐
tema de ingeniería.

La sincronización automática es posible:

Uno o varios bloques se crean de nuevo
y solo existen en la CPU (online).

Antes de la carga, estos bloques debe‐
rían cargarse primero de la CPU al sis‐
tema de ingeniería.

Programación del PLC
Manual de programación y manejo, 11/2019

Los bloques del sistema de ingeniería
se actualizan antes de la carga.
La sincronización automática es posible:
Los nuevos bloques se agregan al sis‐
tema de ingeniería antes de la carga.

8371

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
Caso de aplicación

Recomendación

Se han borrado uno o varios bloques en
la CPU.

Estos bloques también deberían borrar‐ La sincronización automática no es po‐
se en el sistema de ingeniería antes de sible.
la carga.
Los bloques borrados en la CPU debe‐
rían borrarse manualmente en el pro‐
yecto offline del sistema de ingeniería.

Estos bloques con modificaciones con‐
currentes deben adaptarse de forma
Esto ocurre cuando otro usuario ha mo‐ manual. En este caso, decida qué cam‐
bios desea aplicar.
dificado y cargado en la CPU bloques
en los que usted también ha realizado Si deben conservarse los bloques de la
correcciones.
CPU, debe aceptar estos bloques antes
de la carga de la CPU a su sistema de
ingeniería.
Uno o varios bloques son diferentes en
la CPU y en el sistema de ingeniería.

Sincronización

La sincronización automática no es po‐
sible:
Los bloques afectados de la CPU o el
sistema de ingeniería deben adaptarse
de forma manual. Esto implica que se
sobrescribirá una de las versiones de
bloque existentes (online u offline).

Si deben aceptarse los bloques modifi‐
cados por usted, puede continuar con la
carga sin sincronización.
Se detectan diferencias en la configura‐ Las diferencias en la configuración hard‐
ción hardware de la CPU (online) y del ware deben resolverse de forma ma‐
sistema de ingeniería (offline).
nual. En este caso, decida qué configu‐
ración hardware desea aplicar.

La sincronización automática no es po‐
sible:
La configuración hardware debe ajus‐
tarse de forma manual.

Si debe conservarse la configuración
Esto implica que se sobrescribirá una
hardware existente en la CPU, debe
de las configuraciones hardware exis‐
aceptarla antes de cargarla en su siste‐ tentes (online u offline).
ma de ingeniería.
Si debe aplicarse la configuración hard‐
ware que ha modificado, puede conti‐
nuar con la carga sin sincronización.

El comando "Forzar la carga en dispositivo" permite cargar bloques sin sincronización, si lo
desea.

Cargar datos I&M en dispositivos PROFINET IO y sus módulos
Al realizar la carga en un dispositivo, además de los componentes citados anteriormente
pueden cargarse también datos I&M en dispositivos PROFINET IO y sus módulos.

19.3.2

Cargar bloques en un dispositivo en estado operativo "RUN"

Principios básicos de la carga de bloques en estado operativo "RUN"
Al cargar bloques modificados en un dispositivo, no siempre es necesario conmutar el
dispositivo al estado operativo "STOP". Es por ello que el sistema de ingeniería verifica si el
dispositivo debe ponerse en STOP para poder realizar el proceso de carga. El resultado de
esta prueba se muestra en el cuadro de diálogo "Cargar vista preliminar".
Si se requiere un cambio al estado operativo "STOP", el proceso de carga solo podrá continuar
tras parar la CPU.

8372

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
Si se cumplen los requisitos, un programa modificado o partes de él también se podrán cargar
en la CPU en estado operativo "RUN".
En programas muy complejos pueden superarse volúmenes que impidan la carga en "RUN".
En ese caso primero tendrá que crear las condiciones necesarias para poder cargar en "RUN".
Recomendaciones:
● Utilice una Memory Card con suficiente capacidad.
● Seleccione una CPU con suficiente memoria de trabajo.
● Dado el caso, reduzca el número de objetos que cargar (bloques, constantes, variables,
tipos de datos).
Si no puede cargar todos los objetos de una sola vez proceda en varios pasos y cargue
cantidades menores de objetos.

Nota
Si se realiza un proceso de carga en el estado operativo "RUN", los parámetros actuales no se
sobrescriben. Los cambios no se aplican a los parámetros actuales hasta el siguiente cambio
de estado operativo de "STOP" a "RUN".

Cargar cambios en "RUN"
La tabla siguiente muestra qué modificaciones de programa y configuración también pueden
cargarse en estado operativo "RUN", clasificados por familias de CPU y teniendo en cuenta las
versiones de firmware de las CPU.
Explicaciones relativas a la tabla:
● "RUN": La modificación no solo puede cargarse en la CPU en estado operativo "STOP",
sino también en estado operativo "RUN".
● "RUN (< 57)": La CPU puede integrar en un ciclo de programa hasta 56 objetos o bloques
nuevos o modificados. Si carga más objetos o bloques, se integrarán en varios ciclos de
programa consecutivos. Para cargar todos los objetos o bloques de forma coherente,
ponga la CPU en estado operativo "STOP". En CPU S7-300 con la opción de
parametrización "Modo proceso/modo Test" el número cambia según el ajuste.
● "RUN (Init)": La modificación puede cargarse en estado operativo "RUN"; los bloques de
datos cargados se reinicializan.
● "STOP": la modificación solo puede cargarse en estado operativo "STOP".
● "STOP (Reset)": la modificación solo puede cargarse en estado operativo "STOP"; se
reinician todos los datos, incluidos los datos remanentes.

Programación del PLC
Manual de programación y manejo, 11/2019

8373

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

S7-300
Acción/tipo de modificación

S7-400

S7-1200 a partir
de V4.0

S7-1500

Es posible cargar en estado operativo ...

STOP
Propiedades modificadas de componen‐
tes HW. También se incluyen modificacio‐
nes en los comentarios de la configuración
hardware.

STOP

STOP

STOP

Componentes HW agregados

STOP

STOP

STOP

Listas de textos nuevas o modificadas (avi‐ RUN
sos)

RUN

STOP

RUN (a partir de
V1.1)

Los comentarios modificados (nuevos,
modificados, borrados) con excepción de
los comentarios en la configuración hard‐
ware

-

RUN

RUN

Cargar número de bloques sincrónamente RUN (<17)

RUN (<57)

RUN (<21)

RUN (todos)

Cargar el programa de PLC en el disposi‐
tivo e inicializar

STOP (Reset)

STOP (Reset)

STOP (Reset)

STOP (Reset)

Nuevo OB

RUN

RUN

STOP

RUN

OB modificado: Modificaciones de código

RUN

RUN

RUN

RUN

OB con propiedades modificadas

RUN

RUN

STOP

RUN

OB borrado

RUN

RUN

STOP

RUN

FB/FC/DB/tipo de datos de usuario nuevo
(UDT)

RUN

RUN

RUN

RUN

FB/FC/DB/tipo de datos de usuario borra‐
do (UDT)

RUN

RUN

RUN

RUN

STOP

-

(p. ej. cambio en el tiempo de ciclo)

FB/FC modificado: modificación de código RUN

RUN

RUN

RUN

FB/FC modificado: modificación de inter‐
faz*

STOP

STOP

RUN

RUN

DB modificado: Propiedad modificada
(Atributo "Depositar sólo en la memoria de
carga" modificado)

STOP

STOP

RUN (Init)

RUN (Init)

RUN (Init)
DB modificado (reserva de memoria no
activada): nombre o tipo de variables mo‐
dificado, variables agregadas o borradas **

RUN (Init)

RUN (Init)

RUN (Init)

DB modificado (reserva de memoria acti‐
vada): nuevas variables agregadas**

-

RUN

RUN

Tipo de datos de usuario modificado (UDT) STOP

STOP

RUN (Init)

RUN (Init)

Nuevas variables PLC agregadas (tempo‐ RUN
rizadores, contadores, marcas)

RUN

RUN

RUN

8374

-

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
S7-300

S7-400

S7-1200 a partir
de V4.0

S7-1500

STOP

STOP

STOP

-

-

STOP

Acción/tipo de modificación

Es posible cargar en estado operativo ...

Ajustes de remanencia modificados (tem‐
porizadores, contadores, marcas, área
DB)

STOP

Objetos tecnológicos Motion Control Modi‐ ficaciones de ciclo de reloj MC-Servo, cam‐
bio de libre a cíclico (y viceversa). Modifi‐
caciones en la interfaz HW del TO (obj.
tecnol.)

* Si la modificación de la interfaz da lugar a cambios estructurales en el DB de instancia, consulte "DB modificado..."
** Para conocer el efecto de la carga de modificaciones de bloques de datos en su contenido consulte el apartado "Cargar
bloques de datos en la CPU"

Cargar modificaciones en "RUN" con versiones de firmware anteriores de la CPU
La tabla siguiente muestra qué modificaciones se pueden cargar en estado operativo "RUN"
con versiones de firmware anteriores de la CPU.
S7-1200

S7-1200

V1.0 - 2.1

V2.2 - V3.0

Acción/tipo de modificación

Es posible cargar en estado operativo ...

Propiedades modificadas de componentes HW.

STOP

STOP

Componentes HW agregados

STOP

STOP

Listas de textos nuevas o modificadas (avisos)

STOP

STOP

También se incluyen modificaciones en los comentarios de la configu‐
ración hardware.

Los comentarios modificados (nuevos, modificados, borrados) con ex‐ STOP
cepción de los comentarios en la configuración hardware.

RUN

Cargar número de bloques sincrónamente

STOP

RUN (<11)

Cargar el programa de PLC en el dispositivo e inicializar

STOP (Reset)

STOP (Reset)

Nuevo OB

STOP

STOP

OB modificado: Modificaciones de código

STOP

RUN

OB con propiedades modificadas (p. ej. cambio en el tiempo de ciclo)

STOP

STOP

OB borrado

STOP

STOP

FB/FC/DB/tipo de datos de usuario nuevo (UDT)

STOP

RUN

FB/FC/DB/tipo de datos de usuario borrado (UDT)

STOP

RUN

FB/FC modificado: modificación de código

STOP

RUN

FB/FC modificado: modificación de interfaz*

STOP

STOP

DB modificado: Propiedad modificada (Atributo "Depositar sólo en la
memoria de carga" modificado)

STOP

STOP

DB modificado (reserva de memoria no activada): nombre o tipo de
variables modificado, variables agregadas o borradas

STOP

STOP

Programación del PLC
Manual de programación y manejo, 11/2019

8375

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Acción/tipo de modificación

S7-1200

S7-1200

V1.0 - 2.1

V2.2 - V3.0

Es posible cargar en estado operativo ...

Tipo de datos de usuario modificado (UDT)

STOP

STOP

Nuevas variables PLC agregadas (temporizadores, contadores, mar‐
cas)

STOP

STOP

Ajustes de remanencia modificados (temporizadores, contadores, mar‐ STOP
cas, área DB)

STOP

Cargar bloques de datos en la CPU
Dependiendo de las condiciones existentes, la carga de bloques de datos nuevos o
modificados influirá en los valores actuales del bloque de datos:
Cargar bloques de datos nuevos
Cargar bloques de datos modificados estruc‐
turalmente (reserva de memoria no activada)
Cargar bloques de datos modificados estruc‐
turalmente (reserva de memoria activada)

Cargar bloques de datos con modificaciones
sencillas (sin cambios estructurales)

Los valores actuales de los bloques de datos
nuevos son los valores de arranque.
Los valores actuales de variables agregadas
en los bloques de datos modificados son los
valores de arranque.
Los siguientes valores actuales se conservan:
● Valores actuales de variables fuera de la
reserva de memoria
● Valores actuales de variables no
modificadas dentro de la reserva de
memoria.
Los valores actuales de variables agregadas
dentro de la reserva de memoria son los valo‐
res de arranque.
Se conservan los valores actuales.

Información adicional
En "Consulte también" encontrará más información sobre la carga de ampliaciones de bloques
sin reinicialización y sobre la carga de valores modificados en bloques de datos.

Consulte también
Cargar bloques en un dispositivo desde el editor de programación (Página 8377)
Cargar bloques en un dispositivo desde el árbol del proyecto (Página 8378)

8376

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

19.3.3

Cargar bloques en un dispositivo desde el editor de programación

Requisitos
El bloque que se desea cargar está abierto.

Procedimiento
Para cargar un bloque en un dispositivo desde el editor de programación, proceda del siguiente
modo:
1. Haga clic con el botón derecho del ratón en la ventana de instrucciones del editor de
programación.
2. Elija el comando "Cargar en dispositivo" del menú contextual.
– Si hasta ahora no se ha establecido ninguna conexión online, aparece el cuadro de
diálogo "Carga avanzada". En este caso, ajuste todos los parámetros necesarios para
la conexión y haga clic en "Cargar".
– Los parámetros de conexión utilizados preferentemente se pueden guardar en
"Opciones > Configuración > Online y diagnóstico" como ajuste predeterminado.
Durante la primera carga con nuevos parámetros de conexión, aparecerá
automáticamente una consulta sobre si dichos parámetros deben guardarse como
ajuste predeterminado. Haga clic en "Sí" para guardar los parámetros de conexión
actuales como ajuste predeterminado.
– Existe la posibilidad de visualizar todos los dispositivos compatibles activando la opción
correspondiente y haciendo clic en el comando "Iniciar búsqueda". El cuadro de diálogo
"Carga avanzada" también se puede abrir explícitamente desde el menú "Online".
Consulte también: Establecer y deshacer una conexión online
– Si se ha definido la conexión online, se compilan los datos del proyecto en caso de ser
necesario y se abre el cuadro de diálogo "Cargar vista preliminar". En él se muestran
avisos y se proponen las acciones necesarias para la carga.
3. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar" se activará tan pronto como sea posible la carga.
Nota
Acciones
Si lleva a cabo las acciones propuestas con la instalación en marcha, pueden producirse
graves daños materiales y personales en caso de fallos de funcionamiento o errores del
programa.
Antes de iniciar la ejecución de las acciones, asegúrese de que no pueden presentarse
estados peligrosos.
Nota
Para evitar incoherencias entre los bloques invocantes y los bloques llamados, al realizar
modificaciones globales, p. ej., modificaciones de la interfaz de un bloque, pueden cargarse
siempre todos los bloques afectados. Para ello, elija la acción "Carga coherente".

Programación del PLC
Manual de programación y manejo, 11/2019

8377

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
4. Haga clic en "Cargar".
Si es necesario realizar una sincronización, el sistema muestra automáticamente el cuadro
de diálogo "Sincronización". En él se muestran avisos y se proponen las acciones
necesarias para la sincronización. Existe la posibilidad de ejecutar estas acciones o forzar
la carga sin sincronización haciendo clic en "Forzar la carga en dispositivo". En caso de
haber ejecutado las acciones propuestas, el sistema le preguntará si desea continuar con
la carga. Haga clic en "Continuar carga" para que se cargue el bloque. A continuación se
abre el cuadro de diálogo "Cargar resultados", que muestra el estado y las acciones
después del proceso de carga.
5. Si quiere arrancar los módulos directamente después de cargar, active la casilla de
verificación "Arrancar módulo".
6. Cierre el diálogo "Cargar resultados" haciendo clic en "Finalizar".

Resultado
El código del bloque se carga en el dispositivo. Si los cambios afectan a otros bloques, estos
también se compilan y se cargan en el dispositivo. Los bloques que existen solo online en el
dispositivo se borran. Los bloques de datos de la CPU existentes se conservan. Cargando
todos los bloques afectados y borrando los bloques que no se necesitan en el dispositivo se
evitan incoherencias entre los bloques del programa de usuario.
Los mensajes que aparecen en la ventana de inspección bajo "Información > General" indican
si la carga se ha realizado correctamente.

Consulte también
Cargar bloques en un dispositivo desde el árbol del proyecto (Página 8378)
Cargar bloques en un dispositivo en estado operativo "RUN" (Página 8372)

19.3.4

Cargar bloques en un dispositivo desde el árbol del proyecto
Desde el árbol del proyecto es posible cargar uno, varios o todos los bloques en un dispositivo.

Cargar uno o más bloques en un dispositivo desde el árbol del proyecto
Para cargar uno o varios bloques en un dispositivo desde el árbol del proyecto, proceda del
siguiente modo:
1. Abra la carpeta "Bloques de programa" en el árbol del proyecto.
2. Seleccione los bloques que desea cargar.

8378

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
3. Elija el comando "Cargar en dispositivo > Software (solo cambios)" del menú contextual.
– Si hasta ahora no se ha establecido ninguna conexión online, aparece el cuadro de
diálogo "Carga avanzada". En este caso, ajuste todos los parámetros necesarios para
la conexión y haga clic en "Cargar".
– Los parámetros de conexión utilizados preferentemente se pueden guardar en
"Opciones > Configuración > Online y diagnóstico" como ajuste predeterminado. Al
cargar los parámetros de conexión por primera vez también aparecerá una pregunta al
respecto. Responda con "Sí" para guardar los parámetros de conexión como ajuste
predeterminado.
– Existe la posibilidad de visualizar todos los dispositivos compatibles activando la opción
correspondiente y haciendo clic en el comando "Iniciar búsqueda". El cuadro de diálogo
"Carga avanzada" también se puede abrir explícitamente desde el menú "Online".
Consulte también: Establecer y deshacer una conexión online
– Si se ha definido la conexión online, se compilan los datos del proyecto en caso de ser
necesario y se abre el cuadro de diálogo "Cargar vista preliminar". En él se muestran
avisos y se proponen las acciones necesarias para la carga.
4. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
Nota
Si lleva a cabo las acciones propuestas con la instalación en marcha, pueden producirse
graves daños materiales y personales en caso de fallos de funcionamiento o errores del
programa.
Antes de iniciar la ejecución de las acciones, asegúrese de que no pueden presentarse
estados peligrosos.
El botón "Cargar" se activará tan pronto como sea posible la carga.
5. Haga clic en "Cargar".
Si es necesario realizar una sincronización, el sistema muestra automáticamente el cuadro
de diálogo "Sincronización". En él se muestran avisos y se proponen las acciones
necesarias para la sincronización. Existe la posibilidad de ejecutar estas acciones o forzar
la carga sin sincronización haciendo clic en "Forzar la carga en dispositivo". En caso de
haber ejecutado las acciones propuestas, el sistema le preguntará si desea continuar con
la carga. Haga clic en "Continuar carga" para que se cargue el bloque. A continuación se
abre el cuadro de diálogo "Cargar resultados", que muestra el estado y las acciones
después del proceso de carga.
6. Si los módulos se deben rearrancar directamente después de la carga, active la casilla de
verificación "Arrancar todos".
7. Cierre el diálogo "Cargar resultados" haciendo clic en "Finalizar".

Cargar todos los bloques en un dispositivo desde el árbol del proyecto
Para cargar en un dispositivo todos los bloques de la carpeta "Bloques de programa" desde el
árbol del proyecto, proceda del siguiente modo:
1. Seleccione la carpeta "Bloques de programa" del árbol del proyecto.
2. Elija el comando "Cargar en dispositivo" del menú contextual.

Programación del PLC
Manual de programación y manejo, 11/2019

8379

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
3. Si desea cargar únicamente los cambios efectuados desde la última carga, seleccione la
opción "Software (solo cambios)". Para cargar por completo todos los bloques e inicializar
todos los valores a los valores de arranque, elija la opción "Cargar programa de PLC en
dispositivo e inicializar".
– Si hasta ahora no se ha establecido ninguna conexión online, aparece el cuadro de
diálogo "Carga avanzada". En este caso, ajuste todos los parámetros necesarios para
la conexión y haga clic en "Cargar". Existe la posibilidad de visualizar todos los
dispositivos compatibles activando la opción correspondiente y haciendo clic en el
comando "Iniciar búsqueda". El cuadro de diálogo "Carga avanzada" también se puede
abrir explícitamente desde el menú "Online".
Consulte también: Establecer y deshacer una conexión online
– Si se ha definido la conexión online, se compilan los datos del proyecto en caso de ser
necesario y se abre el cuadro de diálogo "Cargar vista preliminar". En él se muestran
avisos y se proponen las acciones necesarias para la carga.
4. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
Nota
Si lleva a cabo las acciones propuestas con la instalación en marcha, pueden producirse
graves daños materiales y personales en caso de fallos de funcionamiento o errores del
programa.
Antes de iniciar la ejecución de las acciones, asegúrese de que no pueden presentarse
estados peligrosos.
El botón "Cargar" se activará tan pronto como sea posible la carga.
5. Haga clic en "Cargar".
Si es necesario realizar una sincronización, el sistema muestra automáticamente el cuadro
de diálogo "Sincronización". En él se muestran avisos y se proponen las acciones
necesarias para la sincronización. Existe la posibilidad de ejecutar estas acciones o forzar
la carga sin sincronización haciendo clic en "Forzar la carga en dispositivo". En caso de
haber ejecutado las acciones propuestas, el sistema le preguntará si desea continuar con
la carga. Haga clic en "Continuar carga" para que se cargue el bloque. A continuación se
abre el cuadro de diálogo "Cargar resultados", que muestra el estado y las acciones
después del proceso de carga.
6. Si quiere arrancar los módulos directamente después de cargar, active la casilla de
verificación "Arrancar módulo".
7. Cierre el diálogo "Cargar resultados" haciendo clic en "Finalizar".

Resultado
El código de los bloques se carga en el dispositivo. Si los cambios afectan a otros bloques,
estos también se compilan y se cargan en el dispositivo. Los bloques que existen solo online
en el dispositivo se borran. Cargando todos los bloques afectados y borrando los bloques que
no se necesitan en el dispositivo se evitan incoherencias entre los bloques del programa de
usuario.
Los mensajes que aparecen en la ventana de inspección bajo "Información > General" indican
si la carga se ha realizado correctamente.

8380

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Consulte también
Cargar bloques en un dispositivo desde el editor de programación (Página 8377)
Cargar bloques en un dispositivo en estado operativo "RUN" (Página 8372)

19.3.5

Cargar bloques de un dispositivo
En el proyecto pueden cargarse todos los bloques de un dispositivo o solo algunos de forma
individual.
Nota
Tenga en cuenta las indicaciones siguientes:
● Al cargar bloques individuales, asegúrese de no cargar también variables ni otros bloques
necesarios a los que se remita. Durante la operación de carga, las referencias a variables
y bloques se vuelven a asignar en la medida de los posible a partir de los nombres. Una vez
finalice la operación de carga, compruebe si dichas asignaciones son correctas.
● Al cargar del dispositivo a un proyecto vacío no se cargarán las posibles estructuras de
carpetas existentes para bloques y objetos de librerías.
● S7-1500: al cargar bloques de función GRAPH de un dispositivo al proyecto no se cargan
los textos de aviso específicos de etapa para los avisos de interlock y supervisión.
● S7-1500: Los valores de arranque modificados con la instrucción "WRIT_DBL: Escribir en
un bloque de datos de la memoria de carga" se vuelven a perder al ejecutar la acción
"Cargar de dispositivo".

Requisitos
Las versiones online y offline de los bloques que se desean cargar son diferentes o los bloques
solo existen online.

Cargar todos los bloques de un dispositivo
Para cargar todos los bloques de un dispositivo, proceda del siguiente modo:
1. Establezca una conexión online con el dispositivo del que desea cargar los bloques.
Consulte también: Establecer y deshacer una conexión online
2. En el árbol del proyecto, seleccione la carpeta del dispositivo del cual desea cargar bloques.
3. Elija el comando "Cargar de dispositivo" del menú "Online".
Se abre el cuadro de diálogo "Vista preliminar para cargar del dispositivo". En él se
muestran avisos y se proponen las acciones necesarias para la carga.
4. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar de dispositivo" se activa tan pronto como sea posible la carga.
5. Haga clic en el botón "Cargar de dispositivo".
La carga se lleva a cabo.

Programación del PLC
Manual de programación y manejo, 11/2019

8381

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Cargar bloques individuales de un dispositivo
Para cargar bloques de un dispositivo individualmente, proceda del siguiente modo:
1. Establezca una conexión online con el dispositivo del que desea cargar los bloques.
Consulte también: Establecer y deshacer una conexión online
2. Seleccione en el árbol del proyecto los bloques que desea cargar desde el dispositivo.
3. Elija el comando "Cargar de dispositivo" del menú "Online".
Se abre el cuadro de diálogo "Vista preliminar para cargar del dispositivo". En él se
muestran avisos y se proponen las acciones necesarias para la carga.
4. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar de dispositivo" se activa tan pronto como sea posible la carga.
5. Haga clic en el botón "Cargar de dispositivo".
La carga se lleva a cabo.

Resultado
Los bloques se cargan al proyecto desde el dispositivo. Se pueden editar normalmente,
compilarse nuevamente y cargarse de nuevo en el dispositivo.

19.3.6

Cargar bloques en una Memory Card

Requisitos
● La Memory Card está identificada como tarjeta de programa.
● Está abierta la carpeta "Bloques de programa" de la Memory Card.

Procedimiento
Para cargar bloques en una Memory Card, proceda del siguiente modo:
1. Abra la carpeta "Bloques de programa" del dispositivo en el árbol del proyecto.
2. Seleccione los bloques que desea cargar en la Memory Card.
3. En el árbol del proyecto, arrastre los bloques hasta la carpeta "Bloques de programa" de la
Memory Card. También es posible copiar los bloques e insertarlos en la Memory Card.
En caso necesario, los bloques se compilan. A continuación se abre el cuadro de diálogo
"Vista preliminar Carga". En él se muestran avisos y se proponen las acciones necesarias
para la carga.
4. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
5. El botón "Cargar" se activará tan pronto como sea posible la carga.

8382

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
6. Haga clic en el botón "Cargar".
Si es necesario realizar una sincronización, el sistema muestra automáticamente el cuadro
de diálogo "Sincronización". En él se muestran avisos y se proponen las acciones
necesarias para la sincronización. Existe la posibilidad de ejecutar estas acciones o forzar
la carga sin sincronización haciendo clic en "Forzar la carga en dispositivo". En caso de
haber ejecutado las acciones propuestas, el sistema le preguntará si desea continuar con
la carga. Haga clic en "Continuar carga" para que se cargue el bloque. A continuación se
abre el cuadro de diálogo "Resultados de la carga", que muestra el estado y las acciones
después del proceso de carga.
7. Haga clic en el botón "Finalizar".
O bien:
1. Seleccione en el árbol del proyecto los bloques que desea cargar.
2. Elija el comando "Lector de tarjetas/Memoria USB > Escribir en Memory Card" del menú
"Proyecto".
Se abre el cuadro de diálogo "Seleccionar Memory Card".
3. Seleccione una Memory Card compatible con la CPU.
En la parte inferior del cuadro de diálogo se activa un botón con una marca de verificación
verde.
4. Haga clic en el botón con la marca de verificación verde.
En caso necesario, los datos del proyecto se compilarán. A continuación se abre el cuadro
de diálogo "Vista preliminar Carga". En él se muestran avisos y se proponen las acciones
necesarias para la carga.
5. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar" se activará tan pronto como sea posible la carga.
6. Haga clic en el botón "Cargar".
Si es necesario realizar una sincronización, el sistema muestra automáticamente el cuadro
de diálogo "Sincronización". En él se muestran avisos y se proponen las acciones
necesarias para la sincronización. Existe la posibilidad de ejecutar estas acciones o forzar
la carga sin sincronización haciendo clic en "Forzar la carga en dispositivo". En caso de
haber ejecutado las acciones propuestas, el sistema le preguntará si desea continuar con
la carga. Haga clic en "Continuar carga" para que se cargue el bloque. A continuación se
abre el cuadro de diálogo "Resultados de la carga", que muestra el estado y las acciones
después del proceso de carga.
7. Haga clic en el botón "Finalizar".

Resultado
Los bloques se cargan en la Memory Card. Si los cambios afectan a otros bloques, estos
también se cargarán en la Memory Card. Los bloques existentes solo en la Memory Card se
borran. Cargando todos los bloques afectados y borrando los bloques que no se necesitan en
la Memory Card se evitan incoherencias entre los bloques del programa de usuario.
Los mensajes que aparecen en la ventana de inspección bajo "Información > General" indican
si la carga se ha realizado correctamente.

Programación del PLC
Manual de programación y manejo, 11/2019

8383

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Consulte también
Cargar bloques de una Memory Card (Página 8384)

19.3.7

Cargar bloques de una Memory Card
Solo es posible cargar todos los bloques de una Memory Card en el proyecto.

Requisitos
Se muestra la Memory Card.
Consulte también: Acceder a Memory Cards

Procedimiento
Para cargar bloques desde una Memory Card en el proyecto, proceda del siguiente modo:
1. En el árbol del proyecto arrastre la carpeta de la Memory Card a la carpeta del dispositivo
en el proyecto. También se puede copiar la Memory Card e insertarse en el dispositivo.
Se abre el cuadro de diálogo "Vista preliminar para cargar del dispositivo". En él se
muestran avisos y se proponen las acciones necesarias para la carga.
2. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar de dispositivo" se activa tan pronto como sea posible la carga.
3. Haga clic en el botón "Cargar de dispositivo".

Consulte también
Cargar bloques en una Memory Card (Página 8382)

19.3.8

Desactivar la cadena secuencial antes de cargar un bloque de datos GRAPH
La cadena secuencial puede desactivarse globalmente antes de cargar un bloque de datos de
instancia de o bien durante el proceso de carga.

Desactivar la cadena secuencial globalmente
Para desactivar globalmente la cadena secuencial para cada proceso de carga de un bloque
de datos de instancia, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. En la navegación local, seleccione el grupo "Programación PLC > GRAPH".
3. Active la casilla de verificación "Desactivar cadena antes de cargar el DB".
En procesos de carga futuros, la cadena secuencial se desactivará antes de cargar el
bloque de datos de instancia.

8384

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Desactivar la cadena secuencial durante el proceso de carga
Para desactivar la cadena secuencial durante el proceso de carga, proceda del siguiente
modo:
1. Cargue el bloque de función GRAPH en el dispositivo.
Durante el proceso de carga se muestra el cuadro de diálogo "Cargar vista preliminar". En
él se muestran avisos y se proponen acciones necesarias para la carga. Si hay que cargar
el bloque de datos de instancia junto con el bloque de función GRAPH, se mostrará la
acción "Desactivar cadena antes de cargar el DB" en el cuadro de diálogo "Cargar vista
preliminar".
2. Active la casilla de verificación "Desactivar cadena antes de cargar el DB".

19.3.9

Cargar ampliaciones de bloque sin reinicializar

19.3.9.1

Principios básicos para cargar ampliaciones de bloque sin reinicializar

Descripción
Para modificar con posterioridad programas de PLC que ya se han puesto en servicio y que
funcionan sin problemas en una instalación, las CPU de las series S7-1200 a partir de V4 y
S7-1500 permiten ampliar la interfaz de bloques de función o de datos durante el
funcionamiento.
Los bloques modificados pueden cargarse sin necesidad de pasar la CPU a STOP y sin influir
en los valores de las variables ya cargadas.
De ese modo es posible realizar cambios en el programa con facilidad. El proceso controlado
no se ve afectado por esta carga (cargar sin reinicializar).

Modo de funcionamiento
Cada bloque de función o datos dispone de forma predeterminada de una reserva de memoria
que puede utilizarse para realizar cambios de interfaz con posterioridad. En un primer
momento, la reserva no se utiliza. Si compila y carga el bloque y después se da cuenta de que
desea cargar cambios de interfaz con posterioridad, entonces active la reserva de memoria.
Todas las variables declaradas después se cargan en la reserva de memoria. Al realizar la
carga a continuación, los valores de las variables ya cargadas no se ven afectados.
Para modificar el programa más tarde, mientras la instalación no esté funcionando, se dispone
además de la posibilidad de restablecer el formato de memoria de uno o varios bloques en un
único paso. Todas las variables de la reserva de memoria se mueven al área de memoria
habitual. La reserva de memoria se libera de nuevo para otras ampliaciones de interfaz.

Programación del PLC
Manual de programación y manejo, 11/2019

8385

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Requisitos
La función "Cargar sin reinicializar" está disponible si se cumplen los siguientes requisitos:
● El proyecto está disponible en formato "TIA Portal V12" o en una versión superior.
● Se trabaja con una CPU de la serie S7-1200 a partir de V4 o S7-1500.
● Los bloques se crearon en KOP, FUP, AWL o SCL.
● Los bloques fueron creados por el usuario, es decir, no son bloques suministrados.
● Se trata de bloques de "acceso optimizado".
Los siguientes bloques de datos no ofrecen la posibilidad de cargar ampliaciones de bloques
sin reinicializar:
● Bloques GRAPH
● Bloques de datos ARRAY
● Bloques ProDiag
Nota
Limitación en caso de utilización de la reserva de memoria
No es posible asignar el contenido de un bloque de datos global a un bloque de datos con la
misma estructura, p. ej., mediante una casilla de desplazamiento, si uno de los dos DB
contiene una reserva de memoria.

Pasos fundamentales
Para ampliar la interfaz de un bloque de función o un bloque de datos y cargar a continuación
el bloque sin reinicializar, siga los siguientes pasos. En los siguientes capítulos encontrará una
descripción detallada de los distintos pasos:
1. Todos los bloques tienen de forma predeterminada una reserva de memoria de 100 bytes
en la memoria no remanente. En caso necesario es posible adaptar el tamaño de la reserva
de memoria o definir una reserva de memoria en la memoria remanente.
2. Active la reserva de memoria.
3. Amplíe la interfaz del bloque.
4. Compile el bloque.
5. Vuelva a cargar el bloque en la CPU de la forma acostumbrada.

Sinopsis de los ajustes de la reserva de memoria
La vista general del árbol del proyecto ofrece una sinopsis de los ajustes de la reserva de
memoria para todos los bloques de programa:

8386

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
Para ver la vista general, proceda del siguiente modo:
1. Seleccione la carpeta "Bloques de programa" en el árbol del proyecto.
2. Haga clic en el botón "Maximiza/minimiza la vista general".

Consulte también
Inicializar valores de ajuste en el programa online (Página 7884)
Ajustar la reserva de memoria para ampliaciones de bloque (Página 8387)
Activar la reserva de memoria (Página 8388)
Desactivar la reserva de memoria (Página 8389)
Ampliación de una interfaz de bloque o un bloque de datos (Página 8390)
Inicialización de la reserva de memoria (Página 8391)

19.3.9.2

Ajustar la reserva de memoria para ampliaciones de bloque

Introducción
Cada bloque de función o datos dispone de forma predeterminada de una reserva de 100
bytes. Dicha reserva no se encuentra en el área de memoria remanente del bloque. De forma
predeterminada, no se prevé una reserva en la memoria remanente, puesto que la memoria
remanente de la CPU está limitada.
El valor predeterminado de 100 bytes que es válido para todos los bloques recién creados del
proyecto, se puede modificar. Al mismo tiempo, también es posible personalizar el tamaño de
la reserva de memoria para cada bloque y definir una reserva en la memoria remanente para
los diferentes bloques.

Ajustar el tamaño de la reserva de memoria para bloques nuevos
Para ajustar el tamaño de la reserva de memoria de todos los bloques recién creados en el
proyecto, proceda del siguiente modo:
1. Elija el comando "Configuración" del menú "Opciones".
Se abre la ventana "Configuración" en el área de trabajo.
2. Seleccione el grupo "Programación PLC > General" en la navegación local.
3. En el campo de entrada "Reserva de memoria" del grupo "Reserva de memoria para la
carga sin reinicializar", introduzca el número de bytes que desea prever para ampliar la
interfaz del bloque más adelante.
Los bloques de función recién creados y los bloques de datos globales obtienen ahora una
reserva de memoria del tamaño indicado. Los bloques ya existentes no se ven afectados
por la modificación.
Nota
El ajuste solo es válido para los bloques que soportan la función "Cargar sin reinicializar".
El resto de bloques no se ve afectado por el ajuste.

Programación del PLC
Manual de programación y manejo, 11/2019

8387

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Ajustar el tamaño de la reserva de memoria para un bloque existente
Para ajustar el tamaño de la reserva de memoria para un bloque existente, proceda del
siguiente modo:
1. Seleccione el bloque en el árbol del proyecto.
2. Elija el comando "Propiedades" del menú contextual.
Se abre el cuadro de diálogo "Propiedades".
3. Seleccione el grupo "Cargar sin reinicializar" en la navegación local.
4. Introduzca el número de bytes deseado en el campo de entrada "Reserva de memoria".
5. Para definir una reserva en la memoria remanente, active la casilla de verificación "Activar
la carga sin reinicializar para variables remanentes" e introduzca el número de bytes
deseado en el campo de entrada "Reserva en la memoria remanente".
Nota
Tenga en cuenta las indicaciones siguientes:
● Si ya ha activado la reserva de memoria para el bloque actual, el tamaño de la reserva
de memoria no podrá cambiarse.
● Los elementos de datos se ordenan en la memoria en función de determinadas reglas
que permiten un acceso lo más rápido posible durante la ejecución del programa. Por
esta razón, al añadir un elemento de datos nuevo, en algunos casos la memoria
disponible se reduce en una proporción mayor al tamaño real del elemento de datos en
cuestión.
Puede suceder, por ejemplo, que el área de memoria disponible se reduzca cuatro bytes
al agregar un elemento del tipo "WORD" y un elemento del tipo "BYTE", puesto que
todos los elementos de datos se ajustan a un límite de WORD.

Consulte también
Principios básicos para cargar ampliaciones de bloque sin reinicializar (Página 8385)

19.3.9.3

Activar la reserva de memoria

Introducción
Cada bloque de función o datos dispone de forma predeterminada de una reserva de memoria.
Sin embargo, en un primer momento la reserva no se utiliza. Si compila y carga el bloque y
después se da cuenta de que desea cargar cambios de interfaz con posterioridad, entonces
active la reserva de memoria. Todas las variables declaradas después se cargan en la reserva
de memoria.

Requisitos
● El bloque está compilado.
● El bloque dispone de una reserva de memoria.

8388

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Procedimiento
Para activar la reserva de memoria para un bloque de función o un bloque de datos global,
proceda del siguiente modo:
1. Abra el bloque.
2. Seleccione el botón "Conservar valores actuales" en la barra de herramientas.

Resultado
● A partir de este momento, todas las variables recién declaradas se guardarán en la reserva
de memoria, de forma que puedan cargarse en el proceso en curso sin repercusiones.
● Las variables existentes ya no podrán borrarse. Tampoco será posible modificar sus
propiedades, a excepción de "Valor predeterminado", "Valor de arranque" y "Comentario".
● Las constantes locales que se utilizan como límites de ARRAY, ya no se pueden modificar
porque una modificación del valor de una constante repercutiría en la estructura de la
memoria del bloque.

Consulte también
Principios básicos para cargar ampliaciones de bloque sin reinicializar (Página 8385)

19.3.9.4

Desactivar la reserva de memoria

Introducción
Para modificar el formato de memoria de un bloque con posterioridad, mientras la instalación
no esté funcionando, puede desactivarse la reserva de memoria. Entonces todas las variables
de la reserva de memoria se mueven al área de memoria habitual. La reserva de memoria
permanece inalterada y se libera de nuevo para otras ampliaciones de interfaz. De ese modo
vuelve a tener el tamaño definido en las propiedades del bloque.
Nota
Tenga en cuenta que es necesario compilar y cargar el bloque de nuevo después de desactivar
la reserva de memoria. Una vez se ha desactivado la reserva de memoria, no es posible
"Cargar sin reinicializar".

Requisitos
La reserva de memoria del bloque está activada.

Programación del PLC
Manual de programación y manejo, 11/2019

8389

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500

Procedimiento
Para desactivar la reserva de memoria para un bloque de función o un bloque de datos global,
proceda del siguiente modo:
1. Abra el bloque.
2. Seleccione el botón "Conservar valores actuales" en la barra de herramientas.

Resultado
Todas las variables que hasta ahora se encontraban en la reserva de memoria se mueven del
área de reserva al área habitual. Por esta razón es necesario compilar y cargar el bloque de
nuevo. Al cargar, los valores de las variables se reinicializan en la CPU.

Consulte también
Principios básicos para cargar ampliaciones de bloque sin reinicializar (Página 8385)

19.3.9.5

Ampliación de una interfaz de bloque o un bloque de datos

Introducción
Tras activar la reserva de memoria de un bloque de función o un bloque de datos global,
pueden agregarse nuevas variables.

Requisitos
La reserva de memoria está activada.

Procedimiento
Para declarar variables adicionales, proceda del siguiente modo:
1. Seleccione una sección de declaración, p. ej. "Input", "Output", "InOut" o "Static".
2. Declare una o varias variables de la forma habitual e introduzca sus propiedades en las
columnas. En la columna "Remanencia" de un FB solo es posible escoger entre los ajustes
"Remanente" y "No remanente". El ajuste "Ajustar en IDB" no está disponible en la reserva
de memoria.
Nota
No es posible añadir variables dentro de una variable de un tipo de datos estructurado.
Dentro de una estructura ya existente, p. ej., no se pueden declarar elementos nuevos.
Pero sí se pueden crear nuevas estructuras dentro de la reserva de memoria.

8390

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.3 Cargar bloques para S7-1200/1500
3. Compile los bloques modificados, p. ej. seleccionándolos en el árbol del proyecto y
eligiendo el comando "Compilar > Software (solo cambios)" del menú contextual.
Al compilar, las nuevas variables declaradas se insertan en la reserva de memoria. Si la
reserva de memoria no dispone del suficiente espacio, se cancelará el proceso de
compilación y aparecerá un mensaje de error.
4. Cargue los bloques modificados, p. ej. seleccionándolos en el árbol del proyecto y eligiendo
el comando "Cargar > Software (solo cambios)" del menú contextual.
Si se cargan ampliaciones de bloque, solo se inicializarán las nuevas variables insertadas
con los valores de arranque definidos. Las variables que ya existen online no se vuelven a
inicializar.

Consulte también
Principios básicos para cargar ampliaciones de bloque sin reinicializar (Página 8385)

19.3.9.6

Inicialización de la reserva de memoria

Introducción
Para modificar el programa con posterioridad, mientras la instalación no esté funcionando
existe la posibilidad de restablecer la reserva de memoria de uno o varios bloques en un único
paso. En ese caso todas las variables de la reserva de memoria se mueven al área de memoria
regular. La reserva de memoria se libera de nuevo para otras ampliaciones de interfaz.

Requisitos
● La reserva de memoria del bloque está activada.
● La reserva de memoria contiene variables.

Procedimiento
Para inicializar la reserva de memoria de uno o varios bloques, proceda del siguiente modo:
1. Seleccione toda la carpeta "Bloques de programa" o bloques individuales dentro de ella.
2. En el menú contextual, elija el comando "Compilar > Software (inicializar reserva de
memoria)".

Programación del PLC
Manual de programación y manejo, 11/2019

8391

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400

Resultado
Todas las variables de los bloques seleccionados que hasta ahora se encontraban en la
reserva de memoria se mueven del área de reserva al área habitual. El bloque se compila de
nuevo. Las variables se reinicializan al realizar la siguiente carga. La reserva de memoria del
bloque ajustada permanece inalterada y continúa estando activa.
PELIGRO
Reinicialización en la carga siguiente
Si se reinicializa una reserva de memoria, en la siguiente carga se vuelven a inicializar todas
las variables que antes se encontraban en la reserva de memoria. Eso afecta tanto a las
variables remanentes como a las no remanentes.
La modificación de los valores de variable con la instalación en marcha puede provocar
graves daños materiales y personales. Por ese motivo, tras inicializar la reserva de memoria
es imprescindible comprobar detalladamente el programa en un entorno de prueba antes de
ponerlo en marcha.

Consulte también
Principios básicos para cargar ampliaciones de bloque sin reinicializar (Página 8385)

19.4

Cargar bloques para S7-300/400

19.4.1

Introducción a la carga de bloques

Cargar bloques en un dispositivo
Para que la CPU pueda procesar el programa de usuario, los datos del programa se deben
compilar primero y cargar luego en el dispositivo.
Los datos del programa pueden cargarse en dispositivos y Memory Cards.
La carga en y desde dispositivo puede iniciarse por distintas vías:
● con los comandos del menú "Online"
● con el menú contextual
● con el botón "Cargar" de la barra de herramientas
La carga puede iniciarse en el árbol del proyecto desde los siguientes objetos:
● desde dispositivos
● desde la carpeta "Bloques de programa"

8392

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400
● desde bloques individuales
● desde la carpeta "Tipos de datos PLC"
Dependiendo del objeto y del comando seleccionados en cada caso, desde el menú "Online"
podrán cargarse los siguientes componentes:
● Cargar en dispositivo
Tanto la configuración hardware como el software se cargan en el destino si hay diferencias
entre las versiones online y offline.
● Carga avanzada en dispositivo
Tanto la configuración hardware como el software se cargan en el destino si hay diferencias
entre las versiones online y offline. En la carga avanzada se pueden seleccionar
adicionalmente un dispositivo de destino y los ajustes para el mismo.
● Cargar el programa de PLC en el dispositivo e inicializar
Se carga en el destino el programa de PLC con todos los bloques y tipos de datos PLC y
todos los valores se inicializan a sus valores de arranque. Recuerde que lo mismo ocurre
con los valores remanentes. La CPU pasa a "STOP".
● Cargar el programa de usuario en la Memory Card
Todo el programa se carga en una Memory Card insertada.
Dependiendo del objeto y del comando seleccionados en cada caso, desde el menú contextual
podrán cargarse los siguientes componentes:
● Hardware y software (solo cambios)
Tanto la configuración hardware como el software se cargan en el destino si hay diferencias
entre las versiones online y offline.
● Configuración hardware
Solo se carga en el destino la configuración hardware.
● Software (solo cambios)
Solo se cargan en el destino los objetos que difieren online y offline.
● Software (cargar por completo)
Todo el software se carga en el destino.

Nota
No existe ninguna configuración hardware válida
Si no se encuentra ninguna configuración hardware válida durante la carga del software en la
CPU, también se cargará el hardware existente al "Cargar en dispositivo".
Tenga en cuenta que, en ese caso, durante la carga se cargarán componentes de hardware
aunque haya ejecutado el comando para la carga del software.

Programación del PLC
Manual de programación y manejo, 11/2019

8393

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400

Nota
Carga de más de 16 bloques en el estado operativo RUN
Si al efectuar la carga en RUN deben cargarse más bloques de lo que permite la capacidad de
la CPU para una operación de carga, es posible cargar los bloques de forma asíncrona a lo
largo de varios ciclos. En este caso, seleccione esta opción en la lista desplegable del cuadro
de diálogo "Vista preliminar Carga".
Tenga en cuenta que para obtener un estado coherente en la CPU primero debe finalizar la
carga asíncrona.

Nota
Carga de bloques con protección de know-how
Si carga un bloque con protección de know-how en un dispositivo, no se cargará la información
de restauración. Esto significa que un bloque con know-how protegido no se podrá volver a
abrir si se carga del dispositivo.

Nota
Cargar de CPU S7-300/400
Tenga en cuenta que al cargar de un dispositivo pueden perderse eventualmente mensajes de
alarma, lo que puede ocasionar errores durante la compilación.

Cargar programas de PLC de un dispositivo
Los datos de programa cargados en un dispositivo pueden volver a cargarse en el proyecto.
También se incluyen los bloques y tipos de datos PLC existentes.
Esto es necesario, p. ej., para modificar bloques que solo existen en este dispositivo. Se
pueden cargar en el proyecto todos los bloques existentes (bloques de organización, bloques
de función, funciones, bloques de datos) y los tipos de datos PLC o bien bloques individuales.

Nota
Cargar de CPU S7-300/400
Tenga en cuenta que al cargar de un dispositivo puede perderse eventualmente información
de alarma, lo que puede ocasionar errores durante la compilación.

8394

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400

Cargar bloques en una Memory Card o de una Memory Card
Las Memory Cards son tarjetas de memoria enchufables que sirven, por ejemplo, para ampliar
la memoria de una CPU y guardar los datos en el caso de que se produzca un corte de
corriente. Dependiendo de la CPU empleada se pueden utilizar diferentes tipos de tarjetas de
memoria. Para mayor información sobre las tarjetas de memoria compatibles con la CPU
utilizada, consulte el capítulo "Funcionamiento de la CPU S7-300/400" en "Información
adicional sobre configuraciones".

Cargar bloques de función GRAPH
Si se carga un bloque de función GRAPH junto con su bloque de datos de instancia, el
procesamiento de la cadena secuencial empieza de nuevo por la etapa inicial. Esto puede
provocar problemas en la sincronización de la cadena secuencial con el proceso. Dichos
problemas se evitan desactivando la cadena secuencial antes de la carga.

Repercusiones de una operación de carga en los valores de variables de un bloque de datos
Cuando se cargan bloques de datos en un dispositivo en el estado operativo STOP, la
siguiente transición del dispositivo a RUN afecta a los valores actuales de las variables del
siguiente modo:
● Las variables de bloques de datos no remanentes reciben sus valores de arranque
definidos.
● Las variables de bloques de datos remanentes únicamente conservan sus valores si se
cumplen las siguientes condiciones:
– El bloque de datos se ha cargado con el comando "Cargar en dispositivo > Software
(solo cambios)".
– No se ha modificado la estructura del bloque de datos.
De lo contrario, las variables de los bloques de datos remanentes también reciben sus
valores de arranque definidos.

Cargar datos I&M en dispositivos PROFINET IO y sus módulos
Al realizar la carga en un dispositivo, además de los componentes citados anteriormente
pueden cargarse también datos I&M en dispositivos PROFINET IO y sus módulos.

19.4.2

Cargar bloques en un dispositivo en modo operativo "RUN"

Principios básicos de la carga de bloques en el estado operativo RUN
Para cargar bloques modificados en un dispositivo, no siempre es necesario que este cambie
al estado operativo STOP. Durante un proceso de carga, el sistema de ingeniería comprueba
si el dispositivo debe pararse antes de la carga. El resultado de esta comprobación se muestra
en el cuadro de diálogo "Vista preliminar, Carga".

Programación del PLC
Manual de programación y manejo, 11/2019

8395

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400
Si se requiere un cambio al estado operativo STOP, el proceso de carga solo podrá continuar
tras parar la CPU.
Si se cumplen los requisitos, un programa modificado o partes de él también se podrán cargar
en la CPU en estado operativo RUN.
Por regla general existen las restricciones siguientes para un proceso de carga en el estado
operativo RUN:
● Dependiendo del dispositivo empleado es posible restringir el número y el tipo de los
bloques que se pueden cargar en el estado operativo RUN.
● Tiene la opción de cargar los bloques en RUN a lo largo de varios ciclos. Esto solo es
posible con el comando "Cargar > Software (solo cambios)".
● No es posible cargar todos los bloques con el comando "Cargar programa de PLC en
dispositivo e inicializar".
● Si ha modificado la configuración hardware del dispositivo que desea utilizar como destino
del proceso de carga, no será posible realizar la carga en el estado operativo RUN.
Nota
Si se realiza un proceso de carga en el estado operativo RUN, los parámetros actuales no se
sobrescriben. Los cambios no se aplican a los parámetros actuales hasta el siguiente cambio
de estado operativo de STOP a RUN.

Cargar modificaciones en el estado operativo RUN
La tabla siguiente muestra qué modificaciones de programa o configuración pueden cargarse
en estado operativo RUN, clasificados por familias de CPU y teniendo en cuenta las versiones
de firmware de las CPU.
Explicaciones relativas a la tabla:
● RUN: La modificación no solo puede cargarse en la CPU en estado operativo STOP, sino
también en estado operativo RUN.
● RUN (<57): La CPU puede integrar en un ciclo de programa hasta 56 objetos o bloques
nuevos o modificados. Si carga más objetos o bloques, se integrarán en varios ciclos de
programa consecutivos. Para cargar todos los objetos o bloques de forma coherente, pase
la CPU al estado operativo STOP. En CPU S7-300 con la opción de parametrización "Modo
proceso/modo Test" el número cambia según el ajuste.
● RUN (Init): La modificación puede cargarse en estado operativo RUN; los bloques de datos
cargados se reinicializan.
● STOP: La modificación solo puede cargarse en estado operativo STOP.
● STOP (Reset): La modificación solo puede cargarse en estado operativo STOP; se
inicializan todos los datos, incluidos los datos remanentes.

8396

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400

S7-300
Acción/tipo de modificación

S7-400

S7-1200 a partir
de V4.0

S7-1500

Es posible cargar en estado operativo ...

STOP
Propiedades modificadas de componen‐
tes HW. También se incluyen modificacio‐
nes en los comentarios de la configuración
hardware.

STOP

STOP

STOP

Componentes HW agregados

STOP

STOP

STOP

Listas de textos nuevas o modificadas (avi‐ RUN
sos)

RUN

STOP

RUN (a partir de
V1.1)

Los comentarios modificados (nuevos,
modificados, borrados) con excepción de
los comentarios en la configuración hard‐
ware

-

RUN

RUN

Cargar número de bloques sincrónamente RUN (<17)

RUN (<57)

RUN (<21)

RUN (todos)

Cargar el programa de PLC en el disposi‐
tivo e inicializar

STOP (Reset)

STOP (Reset)

STOP (Reset)

STOP (Reset)

Nuevo OB

RUN

RUN

STOP

RUN

OB modificado: Modificaciones de código

RUN

RUN

RUN

RUN

OB con propiedades modificadas

RUN

RUN

STOP

RUN

OB borrado

RUN

RUN

STOP

RUN

FB/FC/DB/tipo de datos de usuario nuevo
(UDT)

RUN

RUN

RUN

RUN

FB/FC/DB/tipo de datos de usuario borra‐
do (UDT)

RUN

RUN

RUN

RUN

STOP

-

(p. ej. cambio en el tiempo de ciclo)

FB/FC modificado: modificación de código RUN

RUN

RUN

RUN

FB/FC modificado: modificación de inter‐
faz*

STOP

STOP

RUN

RUN

DB modificado: Propiedad modificada
(Atributo "Depositar sólo en la memoria de
carga" modificado)

STOP

STOP

RUN (Init)

RUN (Init)

RUN (Init)
DB modificado (reserva de memoria no
activada): nombre o tipo de variables mo‐
dificado, variables agregadas o borradas **

RUN (Init)

RUN (Init)

RUN (Init)

DB modificado (reserva de memoria acti‐
vada): nuevas variables agregadas**

-

RUN

RUN

Tipo de datos de usuario modificado (UDT) STOP

STOP

RUN (Init)

RUN (Init)

Nuevas variables PLC agregadas (tempo‐ RUN
rizadores, contadores, marcas)

RUN

RUN

RUN

Programación del PLC
Manual de programación y manejo, 11/2019

-

8397

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400
S7-300

S7-400

S7-1200 a partir
de V4.0

S7-1500

STOP

STOP

STOP

-

-

STOP

Acción/tipo de modificación

Es posible cargar en estado operativo ...

Ajustes de remanencia modificados (tem‐
porizadores, contadores, marcas, área
DB)

STOP

Objetos tecnológicos Motion Control Modi‐ ficaciones de ciclo de reloj MC-Servo, cam‐
bio de libre a cíclico (y viceversa). Modifi‐
caciones en la interfaz HW del TO (obj.
tecnol.)

* Si la modificación de la interfaz da lugar a cambios estructurales en el DB de instancia, consulte "DB modificado..."
** Para conocer el efecto de la carga de modificaciones de bloques de datos sobre su contenido consulte el apartado "Cargar
bloques de datos en la CPU"

Cargar modificaciones en RUN con versiones de firmware anteriores de la CPU
La tabla siguiente muestra qué modificaciones se pueden cargar en estado operativo RUN con
versiones de firmware anteriores de la CPU.
S7-1200

S7-1200

V1.0 - 2.1

V2.2 - V3.0

Acción/tipo de modificación

Es posible cargar en estado operativo ...

Propiedades modificadas de componentes HW.

STOP

STOP

Componentes HW agregados

STOP

STOP

Listas de textos nuevas o modificadas (avisos)

STOP

STOP

También se incluyen modificaciones en los comentarios de la configu‐
ración hardware.

Los comentarios modificados (nuevos, modificados, borrados) con ex‐ STOP
cepción de los comentarios en la configuración hardware.

RUN

Cargar número de bloques sincrónamente

STOP

RUN (<11)

Cargar el programa de PLC en el dispositivo e inicializar

STOP (Reset)

STOP (Reset)

Nuevo OB

STOP

STOP

OB modificado: Modificaciones de código

STOP

RUN

OB con propiedades modificadas (p. ej. cambio en el tiempo de ciclo)

STOP

STOP

OB borrado

STOP

STOP

FB/FC/DB/tipo de datos de usuario nuevo (UDT)

STOP

RUN

FB/FC/DB/tipo de datos de usuario borrado (UDT)

STOP

RUN

FB/FC modificado: modificación de código

STOP

RUN

FB/FC modificado: modificación de interfaz*

STOP

STOP

DB modificado: Propiedad modificada (Atributo "Depositar sólo en la
memoria de carga" modificado)

STOP

STOP

DB modificado (reserva de memoria no activada): nombre o tipo de
variables modificado, variables agregadas o borradas

STOP

STOP

8398

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400

Acción/tipo de modificación

S7-1200

S7-1200

V1.0 - 2.1

V2.2 - V3.0

Es posible cargar en estado operativo ...

Tipo de datos de usuario modificado (UDT)

STOP

STOP

Nuevas variables PLC agregadas (temporizadores, contadores, mar‐
cas)

STOP

STOP

Ajustes de remanencia modificados (temporizadores, contadores, mar‐ STOP
cas, área DB)

STOP

Cargar bloques de datos en la CPU
Dependiendo de las condiciones existentes, la carga de bloques de datos nuevos o
modificados influirá en los valores actuales del bloque de datos:
Cargar bloques de datos nuevos
Cargar bloques de datos modificados estruc‐
turalmente (reserva de memoria no activada)
Cargar bloques de datos modificados estruc‐
turalmente (reserva de memoria activada)

Cargar bloques de datos con modificaciones
sencillas (sin cambios estructurales)

Los valores actuales de los bloques de datos
nuevos son los valores de arranque.
Los valores actuales de variables agregadas
en los bloques de datos modificados son los
valores de arranque.
Los siguientes valores actuales se conservan:
● Valores actuales de variables fuera de la
reserva de memoria
● Valores actuales de variables no
modificadas dentro de la reserva de
memoria.
Los valores actuales de variables agregadas
dentro de la reserva de memoria son los valo‐
res de arranque.
Se conservan los valores actuales.

Información adicional
En "Consulte también" encontrará más información sobre la carga de ampliaciones de bloques
sin reinicialización y sobre la carga de valores modificados en bloques de datos.

Consulte también
Cargar bloques en un dispositivo desde el editor de programas (Página 8400)
Cargar bloques en el dispositivo desde el árbol de proyectos (Página 8401)

Programación del PLC
Manual de programación y manejo, 11/2019

8399

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400

19.4.3

Cargar bloques en un dispositivo desde el editor de programas

Requisitos
El bloque que se desea cargar está abierto.

Procedimiento
Para cargar un bloque del editor de programación en el dispositivo, proceda del siguiente
modo:
1. Haga clic con el botón derecho del ratón en la ventana de instrucciones del editor de
programación.
2. Elija el comando "Cargar en dispositivo" del menú contextual.
– Si hasta ahora no se ha establecido ninguna conexión online, aparecerá el cuadro de
diálogo "Carga avanzada". En este caso, ajuste todos los parámetros necesarios para
la conexión y haga clic en "Cargar".
– Los parámetros de conexión utilizados preferentemente se pueden guardar en
"Opciones > Configuración > Online y diagnóstico" como ajuste predeterminado.
Durante la primera carga con nuevos parámetros de conexión, aparecerá
automáticamente una consulta sobre si dichos parámetros deben guardarse como
ajuste predeterminado. Haga clic en "Sí" para guardar los parámetros de conexión
actuales como ajuste predeterminado.
– Existe la posibilidad de visualizar todos los dispositivos compatibles activando la opción
correspondiente y haciendo clic en el comando "Iniciar búsqueda". El diálogo "Carga
avanzada" también se puede abrir explícitamente desde el menú "Online".
Consulte también: Establecer y deshacer una conexión online
– Si el dispositivo ya estaba conectado online, los datos de proyecto se compilan en caso
necesario y se abre el cuadro de diálogo "Vista preliminar Carga". En él se muestran
avisos y se proponen las acciones necesarias para la carga.
3. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar" se activará tan pronto como sea posible la carga.
Nota
Si lleva a cabo las acciones propuestas con la instalación en marcha, pueden producirse
graves daños materiales y personales en caso de fallos de funcionamiento o errores del
programa.
Antes de iniciar la ejecución de las acciones, asegúrese de que no pueden presentarse
estados peligrosos.
Nota
Para evitar incoherencias entre los bloques que llaman y los bloques llamados, al realizar
modificaciones globales, p. ej. modificaciones de la interfaz del bloque, pueden cargarse
siempre todos los bloques afectados. Para ello, elija la acción "Carga coherente".

8400

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400
4. Haga clic en "Cargar".
Si es necesario realizar una sincronización, el sistema muestra automáticamente el cuadro
de diálogo "Sincronización". En él se muestran avisos y se proponen las acciones
necesarias para la sincronización. Existe la posibilidad de ejecutar estas acciones o forzar
la carga sin sincronización haciendo clic en "Forzar la carga en dispositivo". En caso de
haber ejecutado las acciones propuestas, el sistema le preguntará si desea continuar con
la carga. Haga clic en "Continuar carga" para que se cargue el bloque. A continuación se
abre el cuadro de diálogo "Cargar resultados", que muestra el estado y las acciones
después del proceso de carga.
5. Si los módulos se deben rearrancar directamente después de la carga, active la casilla de
verificación "Arrancar todos".
6. Cierre el diálogo "Cargar resultados" haciendo clic en "Finalizar".

Resultado
En el dispositivo se carga el código del bloque. Si ha seleccionado "Carga coherente" se
compilan los bloques afectados por las modificaciones y también se cargan en el dispositivo.
Los avisos que aparecen en la ventana de inspección bajo "Información > General" indican si
la carga se ha realizado correctamente.

Consulte también
Cargar bloques en el dispositivo desde el árbol de proyectos (Página 8401)
Cargar bloques en un dispositivo en modo operativo "RUN" (Página 8395)

19.4.4

Cargar bloques en el dispositivo desde el árbol de proyectos
Desde el árbol del proyecto es posible cargar uno, varios o todos los bloques en un dispositivo.

Cargar uno o más bloques en un dispositivo desde el árbol del proyecto
Para cargar uno o varios bloques en un dispositivo desde el árbol del proyecto, proceda del
siguiente modo:
1. Abra la carpeta "Bloques de programa" del árbol del proyecto.
2. Seleccione los bloques que desea cargar.
3. Elija el comando "Cargar en dispositivo > Software (solo cambios)" del menú contextual.
– Si hasta ahora no se ha establecido ninguna conexión online, aparecerá el cuadro de
diálogo "Carga avanzada". En este caso, ajuste todos los parámetros necesarios para
la conexión y haga clic en "Cargar". El diálogo "Carga avanzada" también se puede abrir
explícitamente desde el menú "Online".
Consulte también: Establecer y deshacer una conexión online
– Si el dispositivo ya estaba conectado online, los datos de proyecto se compilan en caso
necesario y se abre el cuadro de diálogo "Vista preliminar Carga". En él se muestran
avisos y se proponen las acciones necesarias para la carga.

Programación del PLC
Manual de programación y manejo, 11/2019

8401

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400
4. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar" se activará tan pronto como sea posible la carga.
Nota
Si lleva a cabo las acciones propuestas con la instalación en marcha, pueden producirse
graves daños materiales y personales en caso de fallos de funcionamiento o errores del
programa.
Antes de iniciar la ejecución de las acciones, asegúrese de que no pueden presentarse
estados peligrosos.
Nota
Para evitar incoherencias entre los bloques que llaman y los bloques llamados, al realizar
modificaciones globales, p. ej. modificaciones de la interfaz del bloque, pueden cargarse
siempre todos los bloques afectados. Para ello, elija la acción "Carga coherente".
5. Haga clic en "Cargar".
Los bloques se cargan y aparece el cuadro de diálogo "Cargar resultados". Este diálogo
muestra el estado y las acciones después del proceso de carga.
6. Cierre el diálogo "Cargar resultados" haciendo clic en "Finalizar".

Cargar todos los bloques en un dispositivo desde el árbol del proyecto
Para cargar en un dispositivo todos los bloques de la carpeta "Bloques de programa" desde el
árbol del proyecto, proceda del siguiente modo:
1. Seleccione la carpeta "Bloques de programa" en el árbol del proyecto.
2. Elija el comando "Cargar en dispositivo" del menú contextual.
3. Si desea cargar únicamente los cambios efectuados desde la última carga, seleccione la
opción "Software (solo cambios)". Para cargar por completo todos los bloques e inicializar
todos los valores a los valores de arranque, elija la opción "Cargar programa de PLC en
dispositivo e inicializar".
– Si hasta ahora no se ha establecido ninguna conexión online, aparecerá el cuadro de
diálogo "Carga avanzada". En este caso, ajuste todos los parámetros necesarios para
la conexión y haga clic en "Cargar". El diálogo "Carga avanzada" también se puede abrir
explícitamente desde el menú "Online".
Consulte también: Establecer y deshacer una conexión online
– Si se ha definido la conexión online, se compilan los datos del proyecto en caso de ser
necesario y se abre el cuadro de diálogo "Cargar vista preliminar". En él se muestran
avisos y se proponen las acciones necesarias para la carga.

8402

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400
4. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar" se activará tan pronto como sea posible la carga.
Nota
Si lleva a cabo las acciones propuestas con la instalación en marcha, pueden producirse
graves daños materiales y personales en caso de fallos de funcionamiento o errores del
programa.
Antes de iniciar la ejecución de las acciones, asegúrese de que no pueden presentarse
estados peligrosos.
Nota
Para evitar incoherencias entre los bloques que llaman y los bloques llamados, al realizar
modificaciones globales, p. ej. modificaciones de la interfaz del bloque, pueden cargarse
siempre todos los bloques afectados. Para ello, elija la acción "Carga coherente".
5. Haga clic en "Cargar".
Los bloques se cargan y aparece el cuadro de diálogo "Cargar resultados". Este diálogo
muestra el estado y las acciones después del proceso de carga.
6. Cierre el diálogo "Cargar resultados" haciendo clic en "Finalizar".

Resultado
El código de los bloques se carga en el dispositivo. Si los cambios afectan a otros bloques,
éstos también se compilan y se cargan en el dispositivo. Los bloques que existen sólo online
en el dispositivo se borran. Cargando todos los bloques afectados y borrando los bloques que
no se necesitan en el dispositivo se evitan incoherencias entre los bloques del programa de
usuario.
Los avisos que aparecen en la ventana de inspección bajo "Información > General" indican si
la carga se ha realizado correctamente.

Consulte también
Cargar bloques en un dispositivo desde el editor de programas (Página 8400)
Cargar bloques en un dispositivo en modo operativo "RUN" (Página 8395)

19.4.5

Cargar bloques desde un dispositivo
Se pueden cargar desde el dispositivo al proyecto todos los bloques o bien bloques sueltos.
Nota
Si bien es posible cargar bloques SCL y bloques de función GRAPH desde un S7-300/400, no
podrán editarse después de la carga.

Programación del PLC
Manual de programación y manejo, 11/2019

8403

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400

Requisitos
No coincide la versión online y offline de los bloques que se van a cargar o los bloques solo
existen online.

Cargar todos los bloques desde un dispositivo
Para cargar todos los bloques desde un dispositivo, proceda del siguiente modo:
1. Establezca una conexión online con el dispositivo desde el que desea cargar bloques.
Consulte también: Establecer y deshacer una conexión online
2. En el árbol del proyecto, seleccione la carpeta del dispositivo desde la que desee cargar los
bloques.
3. Seleccione en el menú "Online" el comando "Cargar de dispositivo".
Se abre el diálogo "Vista preliminar para cargar del dispositivo". En él se muestran avisos
y se proponen las acciones necesarias para la carga.
4. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar de dispositivo" se activará tan pronto como sea posible la carga.
5. Haga clic en el botón "Cargar de dispositivo".
La carga se lleva a cabo.

Cargar bloques individuales desde un dispositivo
Para cargar bloques sueltos desde un dispositivo, proceda del siguiente modo:
1. Establezca una conexión online con el dispositivo desde el que desea cargar bloques.
Consulte también: Establecer y deshacer una conexión online
2. En el árbol del proyecto, seleccione los bloques que desea cargar desde el dispositivo.
3. Seleccione en el menú "Online" el comando "Cargar de dispositivo".
La carga se lleva a cabo.

Resultado
Los bloques se cargan en el proyecto desde el dispositivo. Los bloques se pueden editar,
compilar y cargar de nuevo en el dispositivo.

19.4.6

Cargar bloques en una Memory Card

Requisitos
Está abierta la carpeta "Bloques de programa" de la Memory Card.

8404

Programación del PLC
Manual de programación y manejo, 11/2019

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400

Procedimiento
Para cargar bloques en una Memory Card, proceda del siguiente modo:
1. Abra la carpeta "Bloques de programa" del dispositivo en el árbol de proyectos.
2. Seleccione los bloques que desea cargar en la Memory Card.
3. En el árbol del proyecto, arrastre los bloques hasta la carpeta "Bloques de programa" de la
Memory Card. También es posible copiar los bloques e insertarlos en la Memory Card.
En caso necesario, los bloques se compilan. A continuación se abre el cuadro de diálogo
"Vista preliminar Carga". En él se muestran avisos y se proponen las acciones necesarias
para la carga.
4. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar" se activará tan pronto como sea posible la carga.
Nota
Si lleva a cabo las acciones propuestas con la instalación en marcha, pueden producirse
graves daños materiales y personales en caso de fallos de funcionamiento o errores del
programa.
Antes de iniciar la ejecución de las acciones, asegúrese de que no pueden presentarse
estados peligrosos.
5. Haga clic en el botón "Cargar".
La carga se lleva a cabo.
O:
1. Seleccione en el árbol del proyecto los bloques que desea cargar.
2. Elija el comando "Lector de tarjetas/memoria USB > Escribir en Memory Card" del menú
"Proyecto".
Se abre el diálogo "Seleccionar Memory Card".
3. Seleccione una Memory Card compatible con la CPU.
En la parte inferior del cuadro de diálogo se activa un botón con una marca de verificación
verde.
4. Haga clic en el botón con la marca de verificación verde.
Los datos de proyecto se compilan en caso necesario. A continuación se abre el cuadro de
diálogo "Vista preliminar Carga". En él se muestran avisos y se proponen las acciones
necesarias para la carga.
5. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar" se activará tan pronto como sea posible la carga.
6. Haga clic en el botón "Cargar".
La carga se lleva a cabo.

Resultado
Los bloques seleccionados se cargan en la Memory Card. Los avisos que aparecen en la
ventana de inspección bajo "Información > General" indican si la carga se ha realizado
correctamente.

Programación del PLC
Manual de programación y manejo, 11/2019

8405

Compilación y carga de programas de PLC
19.4 Cargar bloques para S7-300/400

Consulte también
Cargar bloques de una Memory Card (Página 8406)

19.4.7

Cargar bloques de una Memory Card
Solo es posible cargar en el proyecto todos los bloques de una Memory Card. Recuerde que
al cargar de una Memory Card no se cargará información simbólica.

Requisitos
Se muestra la Memory Card.
Consulte también: Acceso a Memory Cards

Procedimiento
Para cargar bloques desde una Memory Card en el proyecto, proceda del siguiente modo:
1. En el árbol del proyecto, arrastre la carpeta de la Memory Card a la carpeta del dispositivo
en el proyecto. También se puede copiar la Memory Card e insertarse en el dispositivo.
Se abre el diálogo "Vista preliminar para cargar del dispositivo". En él se muestran avisos
y se proponen las acciones necesarias para la carga.
2. Verifique los avisos y, dado el caso, active las acciones en la columna "Acción".
El botón "Cargar de dispositivo" se activará tan pronto como sea posible la carga.
3. Haga clic en el botón "Cargar de dispositivo".

Consulte tam