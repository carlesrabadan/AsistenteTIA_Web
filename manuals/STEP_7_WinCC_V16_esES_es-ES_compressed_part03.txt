34

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar librerías globales
6.9 Cerrar una librería global

Guardar modificaciones
Para guardar una librería global, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la librería global que desea guardar.
2. Elija el comando "Guardar librería" del menú contextual.

Guardar una librería global con un nombre diferente
Para guardar una librería global con un nombre diferente, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la librería global que desea guardar con otro
nombre.
2. Elija el comando "Guardar librería como" del menú contextual.
Se abre el diálogo "Guardar librería global como".
3. Seleccione la ubicación e introduzca el nombre de archivo.
4. Confirme las entradas realizadas con "Guardar".
La librería se guarda en la ubicación indicada con el nuevo nombre elegido. La librería
original se conserva.

Consulte también
Trabajar con ficheros de librerías globales (Página 37)
Archivar librerías globales (Página 38)
Principios básicos de las librerías (Página 7)
Crear librería global (Página 29)
Abrir una librería global (Página 31)
Mostrar las propiedades de las librerías globales (Página 33)
Cerrar una librería global (Página 35)
Borrar una librería global (Página 36)

6.9

Cerrar una librería global
Las librerías globales son independientes de los proyectos. Esto implica que no se cierran
junto con el proyecto. Por tanto, las librerías globales deben cerrarse explícitamente.

Requisitos
Se visualiza la Task Card "Librerías" o se abre la vista de librería.

Uso de librerías
Manual de programación y manejo, 11/2019

35

Utilizar librerías globales
6.10 Borrar una librería global

Procedimiento
Para cerrar una librería global abierta, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la librería global que desea cerrar.
2. Elija el comando "Cerrar librería" del menú contextual.
Si se han realizado cambios en la librería global, elija si desea guardar los cambios o no.
La librería global se cerrará.

Consulte también
Crear librería global (Página 29)
Abrir una librería global (Página 31)
Mostrar las propiedades de las librerías globales (Página 33)
Guardar una librería global (Página 34)
Principios básicos de las librerías (Página 7)
Borrar una librería global (Página 36)

6.10

Borrar una librería global
Si una librería global ya no es necesaria, es posible borrarla. Las librerías suministradas por
Siemens no pueden borrarse.

Requisitos
Se visualiza la Task Card "Librerías" o se abre la vista de librería.

Procedimiento
Para borrar una librería global, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la librería global que desea borrar.
2. Elija el comando "Borrar" del menú contextual.
3. Confirme la consulta de seguridad con "Sí".

Resultado
Los librería global se eliminará de la paleta "Librerías globales". Todo el directorio de la librería
global se borrará del sistema de archivos.

Consulte también
Principios básicos de las librerías (Página 7)
Crear librería global (Página 29)
Abrir una librería global (Página 31)

36

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar librerías globales
6.11 Archivar y desarchivar librerías globales
Mostrar las propiedades de las librerías globales (Página 33)
Guardar una librería global (Página 34)
Cerrar una librería global (Página 35)

6.11

Archivar y desarchivar librerías globales

6.11.1

Trabajar con ficheros de librerías globales
Si desea hacer una copia de seguridad de librerías globales en un disco duro externo o si
desea enviar librerías globales por correo electrónico, por ejemplo, reduzca el espacio
necesario de memoria de la librería con la función de archivado.

Maneras de reducir el tamaño del proyecto
Existen dos formas de reducir el espacio de memoria necesario de librerías globales:
● Creación de un fichero comprimido de librerías globales
Los ficheros de librerías globales son archivos comprimidos que contienen una librería
global completa, incluida toda la estructura de carpetas de la librería. Antes de convertir el
directorio con la librería global en un archivo comprimido se reducen todos los archivos a
sus componentes más esenciales para reducir aún más el espacio de memoria necesario.
Así, los ficheros comprimidos de librerías globales son especialmente adecuados para el
envío por correo electrónico.
Los ficheros comprimidos de librerías globales de la versión de producto actual tienen la
extensión ".zal16".
Para abrir un fichero comprimido de una librería global es necesario desarchivar el fichero.
El archivo comprimido se descomprime en la ubicación que haya seleccionado, con la
estructura de carpetas completa y todos los archivos.
● Librerías globales minimizadas
Se puede renunciar a la compresión adicional en un archivo comprimido y elaborar en su
lugar una copia del directorio de la librería global. Los archivos contenidos se reducen a los
componentes esenciales. Con ello se minimiza el espacio de memoria necesario. Se
mantiene el volumen de funciones completo de la librería global, que se puede cargar de la
manera habitual.
Las librerías globales minimizadas son especialmente adecuadas para la archivación, p. ej.
en un soporte de datos externo.

Consulte también
Archivar librerías globales (Página 38)
Desarchivar librerías globales (Página 39)

Uso de librerías
Manual de programación y manejo, 11/2019

37

Utilizar librerías globales
6.11 Archivar y desarchivar librerías globales

6.11.2

Archivar librerías globales
Las librerías globales pueden archivarse en forma de archivos comprimidos o
descomprimidos. Para ello, las librerías globales que deben archivarse no tienen que estar
abiertas en el TIA Portal.
El espacio de memoria necesario para librerías globales puede reducirse comprimiéndolas en
archivos comprimidos.

Procedimiento
Para archivar una librería global, proceda del siguiente modo:
1. Elija el comando "Archivar..." del menú "Proyecto".
Otra posibilidad consiste en elegir el comando "Archivar librería" en el menú contextual de
la librería global que desea archivar.
Se abre el cuadro de diálogo "Archivar".
2. En el campo "Ruta de origen" elija un archivo de librería con la extensión ".al16".
3. Para crear un archivo comprimido de un fichero, elija la opción "Archivar como archivo
comprimido".
4. Si no desea archivar datos restaurables, seleccione la opción "Descartar datos
restaurables".
5. Para poder agregar la fecha y la hora automáticamente, seleccione la opción "Agregar
fecha y hora al nombre de destino".
6. En el campo "Ruta de destino", seleccione la ubicación en la que desea guardar el archivo
comprimido o el nuevo directorio de la librería global.
El directorio no puede estar en un directorio de proyecto ni dentro del directorio de una
librería global.
El directorio predeterminado puede ajustarse en "Opciones > Configuración > General >
Ajustes de archivación > Ubicación de ficheros de librería".
7. Haga clic en "Archivar".

Resultado
Se crea un fichero de la librería global. Las librerías globales comprimidas tienen la extensión
".zal16". El archivo contiene el directorio completo de la librería global. Los diferentes archivos
de la librería global se han reducido además a sus componentes esenciales para ahorrar
espacio en la memoria.
En las librerías globales sin comprimir solo se crea una copia del directorio original de la librería
global en la ubicación deseada.

Consulte también
Trabajar con ficheros de librerías globales (Página 37)
Desarchivar librerías globales (Página 39)

38

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar librerías globales
6.11 Archivar y desarchivar librerías globales

6.11.3

Desarchivar librerías globales
Antes de poder utilizar una librería global archivada debe desarchivarla. Al hacerlo, la librería
global se descomprime y a continuación se abre en el TIA Portal.

Procedimiento
Para descomprimir el fichero de una librería global, proceda del siguiente modo:
1. Elija el comando "Librerías globales > Abrir librería" del menú "Opciones".
Se abre el cuadro de diálogo "Abrir librería global".
2. Seleccione la entrada "Librerías comprimidas" en la lista desplegable "Tipo de archivo".
3. Seleccione el archivo comprimido.
4. Si desea cargar la librería global con protección contra escritura, active la casilla de
verificación "Abrir con protección contra escritura".
5. Haga clic en "Abrir".
6. Se abre el diálogo "Seleccionar directorio de destino".
7. Seleccione el directorio de destino en el que desea descomprimir la librería global
archivada.
8. Haga clic en "Seleccionar carpeta".

Resultado
La librería global se descomprime en el directorio seleccionado y se abre inmediatamente.

Consulte también
Trabajar con ficheros de librerías globales (Página 37)
Archivar librerías globales (Página 38)
Abrir una librería global (Página 31)
Compatibilidad de las librerías globales (Página 30)

Uso de librerías
Manual de programación y manejo, 11/2019

39

Utilizar librerías globales
6.12 Utilizar librerías de empresa globales

6.12

Utilizar librerías de empresa globales

6.12.1

Principios básicos de las librerías de empresa

Introducción
Las librerías de empresa son librerías globales proporcionadas por un administrador y
asignadas al TIA Portal. El administrador puede en todo momento asignar nuevas librerías o
modificar las existentes. Las librerías nuevas se cargan automáticamente en el TIA Portal tras
confirmación por parte del usuario. En cuanto hay una versión nueva disponible de una librería
de empresa, las librerías de empresa existentes se actualizan igualmente a la última versión,
tras confirmación por parte del usuario.
Las librerías de empresa están en la paleta "Librerías globales" de la Task Card "Librerías",
igual que las librerías globales normales.

Preparación de librerías de empresa
Las librerías de empresa pueden guardarse en cualquier directorio del disco duro del PC o bien
en una unidad de red. Para integrar librerías corporativas en el TIA Portal debe utilizarse un
archivo XML. En el archivo XML están guardados los directorios y nombres de las librerías de
empresa asignadas. El archivo XML debe estar guardado en el directorio siguiente del disco
duro del PC:
C:\ProgramData\Siemens\Automation\Portal V16\CorporateSettings\
El archivo XML debe tener el nombre "CorporateSettings.xml".
El archivo de configuración lo copia el propio usuario en el directorio correspondiente o bien se
asigna al usuario desde la red empresarial. La configuración válida se aplica automáticamente
al iniciar el TIA Portal. Mientras el TIA Portal esté abierto, se vigilará continuamente el
directorio con los archivos de configuración. Si el archivo de configuración ha cambiado,
recibirá una petición para aplicar la nueva configuración. Es posible rechazar dicha petición un
máximo de dos veces. La siguiente petición aparece al cabo de tres horas en cada caso. A la
tercera petición tendrá que aplicar la nueva configuración. El administrador del proyecto
prepara un archivo de configuración modificado cuando se agregan o eliminan librerías de
empresa, por ejemplo.
Cuando se accede a librerías de empresa en una unidad de red, se requiere únicamente un
acceso de red para su actualización. Las librerías de empresa que se guardan localmente se
cargan automáticamente tras un rearranque completo. Si no dispone de acceso de red solo
podrá utilizar las copias locales de las librerías de empresa.

Posibilidades como administrador del proyecto
Puede asignar de forma automatizada el archivo de configuración o las librerías de empresa
a los PC de los miembros del equipo, o hacerles llegar actualizaciones. Esta función no forma
parte del TIA Portal y requiere una infraestructura de TI correspondiente en su empresa. Si
desea administrar el archivo de configuración de forma centralizada, hable con el responsable
de TI de su empresa.

40

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar librerías globales
6.12 Utilizar librerías de empresa globales
Para transferir librerías corporativas a colaboradores del equipo del proyecto puede utilizarse
la función de archivación para librerías globales. Sin embargo, antes de utilizar las librerías
corporativas en el TIA Portal debe desarchivarlas.
La figura siguiente muestra a modo de ejemplo cómo se distribuyen librerías corporativas a
diferentes empleados de la empresa:
Equipo del colaborador

Infraestructura TI de la empresa

$UFKLYRGHFRQILJXUDFLµQ;0/
&?3URJUDP'DWD?6LHPHQV?$XWRPDWLRQ?
3RUWDO9?&RUSRUDWH6HWWLQJV?
&RUSRUDWH6HWWLQJV[PO
/LEUHU¯DVGHVFRPSULPLGDV

$UFKLYRGHFRQILJXUDFLµQ;0/
&RUSRUDWH6HWWLQJV[PO
/LEUHU¯DVDUFKLYDGDV
6DPSOHOLEUDU\]DO
6DPSOHOLEUDU\]DO
6DPSOHOLEUDU\]DO

8QVFULSWGHGLVWULEXFLµQ
FRSLDHODUFKLYRGH
FRQILJXUDFLµQ;0/\ODV
OLEUHU¯DVDUFKLYDGDV/DV
OLEUHU¯DVDUFKLYDGDVVH
GHVFRPSULPHQWDPEL«QFRQ
HOVFULSW

Consulte también
Trabajar con ficheros de librerías globales (Página 37)
Archivar librerías globales (Página 38)
Desarchivar librerías globales (Página 39)

6.12.2

Creación de un archivo de configuración para librerías de empresa
Para que las librerías de empresa estén disponibles en el TIA Portal, utilice un archivo de
configuración en formato XML. El archivo de configuración contiene los directorios y nombres
de archivo de las librerías que deben cargarse. El archivo XML es el mismo que se utiliza para
configurar la documentación definida por el usuario.
A continuación se explica cómo crear el archivo de configuración XML y dónde debe guardarse.

Uso de librerías
Manual de programación y manejo, 11/2019

41

Utilizar librerías globales
6.12 Utilizar librerías de empresa globales

Procedimiento
Para poner a disposición un archivo de configuración para librerías de empresa, proceda del
siguiente modo:
1. Cree un archivo de configuración XML con el contenido indicado a continuación. Utilice la
codificación "UTF-8".
2. Reemplace las rutas indicadas en el ejemplo inferior para la sección
"<CorporateLibraryPaths>" por las rutas en las que están guardadas sus librerías.
3. Guarde el archivo XML con el nombre "CorporateSettings.xml".
4. Guarde el archivo en el siguiente directorio del PC:
C:\ProgramData\Siemens\Automation\Portal V16\CorporateSettings\

42

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar librerías globales
6.12 Utilizar librerías de empresa globales

Contenido del archivo de configuración XML
El archivo de configuración XML debe tener el contenido siguiente:
XML
<?xml version="1.0" encoding="utf-8"?>
<Document>
<Settings.Settings ID="0">
<ObjectList>
<Settings.General ID="1" AggregationName="General">
<!-- En este punto se encuentran los ajustes para librerías de empresa globales, si las
hubiera. -->
<!-- Sección para librerías de empresa -->
<AttributeList>
<CorporateLibraryPaths>
<!-- Ejemplo de dos entradas -->
<Item>F:\CorporateLibraries\Corporate_Library_1\Corporate_Library_1.al16</
Item>
<Item>F:\CorporateLibraries\Corporate_Library_2\CorporateLibraries.al16</
Item>
<!-- Introduzca aquí todas las demás librerías globales, si las hubiera. -->
</CorporateLibraryPaths>
</AttributeList>
<!-- Sección para librerías de empresa -->
<ObjectList>
<!-- Sección para documentación definida por el usuario -->
<Settings.UserDocumentation ID="2" AggregationeName="UserDocumentation">
<!-- En la siguiente sección se especifican los valores para visualizar la
documentación definida por el usuario. -->
<AttributeList>
<!-- Activa o desactiva la visualización del informe de accesos. -->
<DisplayLogInformation>
<Value>true</Value>
</DisplayLogInformation>
<!-- Activa o desactiva la búsqueda de documentación definida por el usuario en un
directorio centralizado. -->
<EnableLookupFromCentralStorageLocation>
<Value>true</Value>
</EnableLookupFromCentralStorageLocation>
<!-- Especifica el directorio centralizado para la documentación definida por el
usuario. -->
<CentralStorageLocation>
<Value>D:\CorporateDocumentation\UserDocumentation\</Value>
</CentralStorageLocation>
</AttributeList>
</Settings.UserDocumentation>
<!-- Sección para documentación definida por el usuario Fin -->
</ObjectList>
</Settings.General>
</ObjectList>
</Settings.Settings>
</Document>

Uso de librerías
Manual de programación y manejo, 11/2019

43

Utilizar librerías globales
6.12 Utilizar librerías de empresa globales

Resultado
Una vez que se ha guardado el archivo de configuración XML en el directorio correspondiente,
recibirá en el TIA Portal la petición de cargar la librería de empresa.

44

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar plantillas maestras
7.1

7

Principios básicos de las plantillas maestras
Las plantillas maestras se utilizan para crear de forma estándar elementos utilizados
frecuentemente. Basándose en una plantilla maestra es posible crear cuantos elementos se
necesiten e insertarlos en el proyecto. Los elementos heredan las propiedades de la plantilla
maestra.
Las plantillas maestras se almacenan en la librería del proyecto o en una librería global. Las
plantillas maestras de la librería del proyecto solo pueden utilizarse dentro del proyecto. Si se
crea la plantilla maestra en una librería global, puede utilizarse en diferentes proyectos.
En la librería pueden crearse, por ejemplo, los siguientes elementos como plantillas maestras:
● Dispositivos con su configuración
● Tablas de variables o variables individuales
● Perfiles de instrucción
● Tablas de observación
● Elementos de los ajustes de la documentación, p. ej. portadas y marcos
● Bloques y grupos que contienen varios bloques
● Tipos de datos PLC (UDT) y grupos que contienen varios tipos de datos PLC
● Listas de textos
● Categorías
● Objetos tecnológicos
En muchos casos los objetos que se agregan como plantillas maestras contienen más
elementos. Así, por ejemplo, una CPU puede contener bloques. Si los elementos contenidos
son utilizaciones de una versión de tipo, en la librería se crean automáticamente las versiones
utilizadas de los tipos. A continuación, los elementos contenidos se utilizan como instancia y
se asocian al tipo.

Consulte también
Agregar plantillas maestras (Página 46)
Uso de plantillas maestras (Página 48)
Principios básicos de los tipos (Página 49)
Filtrar plantillas maestras (Página 47)

Uso de librerías
Manual de programación y manejo, 11/2019

45

Utilizar plantillas maestras
7.2 Agregar plantillas maestras

7.2

Agregar plantillas maestras
Guarde los objetos que desee utilizar reiteradamente como plantilla maestra en la librería del
proyecto o en una librería global. Al crear plantillas maestras están disponibles las siguientes
posibilidades:
● Seleccione uno o más elementos y cree plantillas maestras individuales a partir de estos
● Seleccione varios elementos y cree una plantilla maestra individual que contenga todos los
elementos seleccionados.

Requisitos
● Se visualiza la Task Card "Librerías".
● Si se agrega un dispositivo como plantilla maestra, el dispositivo debe cumplir los requisitos
siguientes:
– El dispositivo está compilado y en estado coherente.
– El dispositivo no contiene instancias de prueba de un tipo.
● Cuando se agrega la plantilla maestra a una librería global, esta está abierta con derechos
de escritura.

Creación de una plantilla maestra a partir de uno o más elementos
Para generar una plantilla maestra a partir de uno o más elementos, proceda del siguiente
modo:
1. Abra la librería en la Task Card "Librerías".
2. Seleccione los elementos que desee.
3. Arrastre los elementos mediante Drag&Drop a la carpeta "Plantillas maestras" o a cualquier
subcarpeta de "Plantillas maestras".
Alternativa:
1. Seleccione los elementos que desee.
2. copie los elementos en el portapapeles y péguelos en el lugar deseado.
Los elementos se insertan en la librería como plantillas maestras individuales.
Automáticamente se generará un tipo a partir de cada objeto que pueda haber dentro (p. ej.
bloques referenciados).

Creación de una plantiílla maestra individual a partir de varios elementos
Para crear una plantilla maestra individual para todos los elementos a partir de varios
elementos, proceda del siguiente modo:
1. Abra la librería en la Task Card "Librerías".
2. Copie en el portapapeles los elementos que desea crear como plantillas maestras.
3. En la librería, haga clic con el botón derecho del ratón en la carpeta "Plantillas maestras" o
en cualquier subcarpeta.
4. Elija el comando "Insertar como plantilla maestra única" del menú contextual.

46

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar plantillas maestras
7.3 Filtrar plantillas maestras
Alternativa:
1. Seleccione los elementos que desee.
2. Arrastre los elementos mediante Drag&Drop a la carpeta "Plantillas maestras" o a cualquier
subcarpeta de "Plantillas maestras". Mantenga pulsada mientras tanto la tecla <Alt>.
Los elementos se insertan en la librería como plantillas maestras individuales. La plantilla
maestra individual contiene todos los elementos seleccionados. Automáticamente se
generará un tipo a partir de cada objeto que pueda haber dentro (p. ej. bloques
referenciados).
Nota
Evitar estructuras complejas de plantillas maestras
Para evitar conflictos de nombre y conflictos de estructura de carpetas en el uso posterior de
las plantillas maestras, evite plantillas maestras complejas. Las plantillas maestras complejas
son, p. ej., las que se componen de varios elementos y carpetas interconectadas.

Consulte también
Principios básicos de las plantillas maestras (Página 45)
Uso de plantillas maestras (Página 48)
Principios básicos de las librerías (Página 7)
Agregar tipos a la librería del proyecto (Página 54)

7.3

Filtrar plantillas maestras
Para mejorar la claridad en caso de haber un gran número de plantillas maestras es posible
filtrar la visualización según la clase de plantilla maestra.

Requisitos
Se visualiza la Task Card "Librerías" o se abre la vista de librería.

Procedimiento
Para filtrar la vista, proceda del siguiente modo:
1. Abra la carpeta "Plantillas maestras" en la librería del proyecto o en una librería global.
2. Seleccione en la lista desplegable de la barra de herramientas la clase de objetos que
desea visualizar en "Plantillas maestras".

Resultado
Solo se visualizará la clase de plantillas maestras seleccionadas. Para regresar a una vista no
filtrada, ponga el filtro a "Todos".

Uso de librerías
Manual de programación y manejo, 11/2019

47

Utilizar plantillas maestras
7.4 Uso de plantillas maestras

Consulte también
Principios básicos de las librerías (Página 7)
Crear carpetas en una librería (Página 97)
Principios básicos de las plantillas maestras (Página 45)
Uso de plantillas maestras (Página 48)
Utilizar la vista de elementos (Página 14)

7.4

Uso de plantillas maestras
Las plantillas maestras se encuentran en la librería del proyecto o en una librería global. Las
plantillas maestras se pueden insertar en el proyecto de una en una o varias simultáneamente.
Si inserta varias plantillas maestras a la vez, asegúrese de que todas ellas son compatibles con
la ubicación deseada.

Requisitos
Se visualiza la Task Card "Librerías".

Procedimiento
Para insertar plantillas maestras en el proyecto, proceda del siguiente modo:
1. Abra la carpeta "Plantillas maestras" o cualquier otra subcarpeta de "Plantillas maestras"
en una librería.
2. Arrastre las plantillas maestras deseadas o carpetas enteras hasta el lugar de uso
(ubicación) mediante Drag&Drop.
O:
1. Abra la vista de elementos.
2. Arrastre las plantillas maestras deseadas o carpetas enteras hasta el lugar de uso desde
la paleta "Elementos" mediante Drag&Drop.

Resultado
Se inserta una copia de las plantillas maestras. Si una selección múltiple contenía plantillas
maestras que no eran compatibles, no se generará ninguna copia de ellas en el proyecto.

Consulte también
Principios básicos de las plantillas maestras (Página 45)
Agregar plantillas maestras (Página 46)
Filtrar plantillas maestras (Página 47)
Principios básicos de las librerías (Página 7)
Utilizar la vista de elementos (Página 14)

48

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.1

8

Principios básicos de los tipos

Utilización de tipos
Los tipos son elementos necesarios para la ejecución de programas de usuario. Los tipos
pueden versionarse y perfeccionarse de forma centralizada.
Es posible depositar como tipo los elementos siguientes en la librería del proyecto o en la
librería global:
● Funciones (FC)
● Bloques de función (FB)
● Tipos de datos PLC (UDT)
● Faceplates
● Imágenes
● Estilos
● Funciones definidas por el usuario
En una misma CPU no puede utilizarse repetidas veces la misma versión de un tipo. Si hay
diferentes versiones de un tipo, todos ellos también pueden utilizarse en una misma CPU. En
un proyecto existe la posibilidad de derivar un número cualquiera de instancias, en función del
número de CPU utilizadas. Después de ello, las instancias estarán asociadas a la versión del
tipo en la librería. Al utilizar tipos de una librería global, el tipo también se creará en la librería
del proyecto. Si en la librería del proyecto ya existe el tipo, en caso necesario se completará
con las versiones del tipo que falten. A partir de entonces la instancia solo estará enlazada con
la versión de tipo respectiva en la librería del proyecto.
Los tipos y sus instancias se marcan con un triángulo negro. La figura siguiente muestra una
instancia marcada con un triángulo negro y un bloque de programa común:

Principios básicos del versionamiento de tipos
Mediante el versionamiento de tipos existe la posibilidad de desarrollar tipos de forma
centralizada y luego extender la versión más reciente a los proyectos en forma de
actualización. Así, las correcciones de errores y las ampliaciones funcionales pueden
integrarse fácilmente en los proyectos existentes. Si se ha creado una versión nueva de una
librería global, los proyectos existentes se actualizan en un proceso automático. De esta
manera se minimizan los errores y se reduce el trabajo necesario para mantener grandes
soluciones de automatización con muchos proyectos individuales.

Uso de librerías
Manual de programación y manejo, 11/2019

49

Utilizar tipos y sus versiones
8.1 Principios básicos de los tipos
El versionamiento hace que el proceso de desarrollo de los distintos tipos sea más
comprensible. Antes de habilitar una versión es posible probar en un entorno de prueba si los
cambios realizados en un tipo se han integrado correctamente en el proyecto existente.
Cuando se haya asegurado de que todo funciona perfectamente, habilite una versión para la
utilización productiva. El historial de las distintas instancias puede verse en cualquier momento
en el proyecto y es posible determinar de qué versión se deriva la instancia.
Además, el TIA Portal comprueba automáticamente si hay objetos relacionados con las
distintas versiones de un tipo. Pueden ser objetos relacionados, por ejemplo, tipos de datos
PLC (UDT) referenciados en un bloque, u otros bloques. Al crearse un tipo o al copiarse entre
librerías se tienen en cuenta todos los objetos relacionados. Para que no se produzcan
incoherencias en el proyecto, antes de la habilitación se comprueba la coherencia de las
versiones de los tipos.

Versiones de tipos
Cada tipo tiene asignadas versiones. El número de versión se visualiza en la Task Card
"Librerías" y en la vista de librería junto con el tipo respectivo. También es posible visualizar la
versión de un tipo junto a las instancias en el árbol del proyecto. Para ello, visualice la columna
"Versión" en el árbol del proyecto. De esta forma es posible ver en qué versión se utiliza una
instancia en el proyecto.
El número de versión consta de tres partes separadas por puntos. Las dos primeras partes se
pueden determinar libremente. Ambas admiten también números de 1 a 999. La tercera parte
es el número de versión interno. Este se incrementa automáticamente en uno tan pronto como
se edita una instancia correspondiente a la versión. Si se habilita la versión, el número de
versión interno se pone a 1.
Nota
Ajuste de librería: "Desactivar la edición del número de versión de tipo"
Con el ajuste de librería "Desactivar la edición del número de versión de tipo" se impide que el
usuario pueda asignar el número de versión de tipo con las acciones "Validar versión" y
"Asignar versión". Si se activa este ajuste de la librería, el usuario ya no podrá modificar el
número de versión de tipo. El número de versión (Build) sigue incrementándose
automáticamente al validar o asignar una versión. Una vez alcanzado el límite superior de
número de versión (Build) en un bloque (999), se incrementa el número de versión del bloque
siguiente.
Las versiones de tipos pueden tener tres estados:
● En proceso (faceplates y tipos de datos de usuario HMI)
● En prueba (todas las clases de tipos excepto los faceplates y tipos de datos de usuario HMI)
● Habilitado
La figura siguiente muestra un tipo con dos versiones. Una versión tiene el estado "en prueba"
y la otra está validada:

50

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.2 Estado de las versiones de tipo
Si utiliza funciones (FC) o bloques de función (FB) como tipos en la librería del proyecto, tenga
en cuenta los siguientes puntos al compilar el bloque si usa instrucciones de distinta versión:
● Se pueden volver a compilar bloques con protección de know-how sin contraseña si las
interfaces de las versiones de los bloques son idénticas.
● Los bloques sin protección de know-how pueden volver a compilarse si todos los
parámetros actuales siguen recibiendo valores y si con la nueva versión no se agregan
nuevos parámetros actuales que deberían recibir valores.
● Si el tipo no puede compilarse con otra versión de instrucción, se requiere una nueva
versión del tipo que contenga las adaptaciones necesarias.

Consulte también
Estado de las versiones de tipo (Página 51)
Principios básicos de las plantillas maestras (Página 45)
Agregar tipos a la librería del proyecto (Página 54)
Uso de tipos de la librería del proyecto (Página 59)
Editar elementos de librería (Página 99)
Duplicado de tipos (Página 58)

8.2

Estado de las versiones de tipo
Las versiones de los tipos pueden tener tres estados diferentes. Los estados se reconocen por
la instancia o en la librería.

Estado "en proceso"
Solo tienen el estado "en proceso" las versiones de faceplates y de tipos de datos de usuario
HMI. Si una versión se está procesando aparece "en proceso" al lado de la versión en la librería.
Si se crea un tipo nuevo o una versión nueva de un tipo habilitado, el tipo se pondrá al estado
"en proceso".
Los tipos que tienen el estado "en proceso" se editan en la vista de librería. No es necesario
que exista relación con una instancia en el proyecto. La compatibilidad del tipo se comprueba
mediante una prueba de coherencia al realizar la habilitación.

Estado "en prueba"
Todos los tipos excepto los faceplates y los tipos de datos de usuario HMI pueden tener el
estado "en prueba". Si una versión se está probando aparece "en prueba" al lado de la
instancia y en la librería. Una versión en test está enlazada con una instancia de prueba en el
proyecto. De esta manera es posible probar los efectos de los cambios en un entorno de test
incluyendo todas las funciones online antes de habilitar un tipo para su uso durante el
funcionamiento.

Uso de librerías
Manual de programación y manejo, 11/2019

51

Utilizar tipos y sus versiones
8.3 Mostrar versión de tipo habilitada

Estado "Habilitado"
El estado "Habilitado" está disponible para todos los tipos sin importar la ubicación. Cuando se
habilita una versión, el símbolo de la versión se identifica en la librería con un sello.

Las versiones habilitadas se pueden abrir en su instancia en modo de solo lectura. Si se desea
editar una versión habilitada es necesario crear primero una versión nueva "en proceso" o en
"en prueba".

Consulte también
Principios básicos de los tipos (Página 49)
Uso de tipos de la librería del proyecto (Página 59)
Crear una versión de test de un tipo (Página 61)
Editar la versión de prueba de un tipo (Página 63)
Crear una versión en proceso de un tipo (Página 63)
Comprobar la coherencia de una versión (Página 64)
Rechazar versiones (Página 65)
Habilitar versiones (Página 66)
Asignar una versión (Página 75)
Actualizar un proyecto a las últimas versiones (Página 68)
Deshacer la conexión entre la instancia y el tipo (Página 70)
Filtrar la visualización de tipos (Página 25)

8.3

Mostrar versión de tipo habilitada
Si desea visualizar una versión habilitada pero no desea editarla, abra la instancia en modo de
solo lectura. Todos los tipos con excepción de los faceplates y los tipos de datos de usuario
HMI pueden abrirse directamente en la instancia. Los faceplates y los tipos de datos de usuario
HMI solo pueden abrirse en la Task Card "Librerías" o en la vista de librería.

Requisitos
La versión validada tiene una instancia en el proyecto, excepto si el tipo es un faceplate o un
tipo de datos de usuario HMI.

52

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.4 Mostrar propiedades de un tipo o de una versión

Abrir una versión de tipo en una instancia
Para abrir una versión habilitada de un tipo en modo de solo lectura a partir de una instancia,
proceda del siguiente modo:
1. Seleccione la versión habilitada en la instancia del árbol del proyecto.
2. Haga clic en la instancia con el botón derecho del ratón y elija el comando "Abrir" del menú
contextual.
Se abre la instancia en modo de solo lectura.

Abrir una versión de tipo en la Task Card "Librerías" o en la vista de librería
Para abrir una versión habilitada de un tipo en la Task Card "Librerías" o en la vista de librería,
proceda del siguiente modo:
1. Seleccione la versión.
2. Haga clic en la versión con el botón derecho del ratón y elija el comando "Abrir" del menú
contextual.
Si se trata de un faceplate o de un tipo de datos de usuario HMI, se abre directamente en
la vista de librería. En este caso, no ejecute los demás pasos. Si se trata de otro tipo, se abre
el cuadro de diálogo "Abrir tipo".
3. En la lista de instancias seleccione la instancia con la versión que desea visualizar.
4. Confirme con "Aceptar".
Se abre la instancia en modo de solo lectura.

8.4

Mostrar propiedades de un tipo o de una versión
Las propiedades de un tipo o de una versión se pueden visualizar.

Procedimiento
Para mostrar las propiedades de un tipo o una versión e introducir un comentario, proceda del
siguiente modo:
1. Seleccione un tipo o la versión de un tipo en la Task Card "Librerías" o en la vista de librería.
2. Haga clic en el tipo o en una de sus versiones con el botón derecho del ratón y elija el
comando "Propiedades" del menú contextual.
Se abre el cuadro de diálogo "Propiedades".
3. En caso necesario, introduzca un comentario sobre el tipo en el campo "Comentario" o
modifique un comentario existente.

Uso de librerías
Manual de programación y manejo, 11/2019

53

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto

Propiedades visibles y modificables
La tabla siguiente muestra las propiedades que se pueden visualizar o modificar en un tipo o
una versión:
Propiedad

Descripción

Versión

Tipos

Nombre

nombre del tipo

-

Visible y modi‐
ficable

Versión

Número de versión

Visible

-

Última modifica‐ Si crea, habilita o duplica un tipo o si le asigna una versión, la acción en
ción
cuestión se registrará como un cambio en el tipo. La fecha y la hora de
la modificación se registran en el campo "Última modificación".

Visible

-

Autor

Como autor se indica el usuario que ha creado la versión.

Visible

-

Librería original

Se muestran el proyecto y la librería desde la que se ha generado la
versión actual del tipo. Esta información es importante, por ejemplo,
para encontrar el original del tipo después de haberlo copiado de otra
librería.

Visible

-

GUID de la ver‐ Con esta GUID es posible identificar de forma unívoca el tipo o su ver‐ Visible
sión o GUID del sión, por ejemplo si existen tipos o versiones con una denominación
tipo
idéntica dentro de la librería del proyecto o la librería global. La GUID no
puede modificarse y se asigna automáticamente.
Comentario

Visible

Visible y modi‐
Visible y, en
ficable
versiones en
los estados "en
prueba" o "en
proceso", edi‐
table

Comentario sobre el tipo o la versión

8.5

Trabajar con tipos en la librería del proyecto

8.5.1

Agregar tipos a la librería del proyecto
En la librería del proyecto es posible crear tipos a partir de distintos elementos para reutilizarlos
en el proyecto. Pueden crearse los siguientes elementos, por ejemplo:
● Bloques de programa (FC/FB)
● Tipos de datos PLC (UDT)
● Faceplates
● Tipo de datos de usuario HMIT
● Imágenes
● Estilos
Si se agrega un elemento como tipo a la librería del proyecto y dicho elemento depende de
otros elementos, entonces los elementos dependientes también se crearán como tipo
automáticamente.

54

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto
Después de agregar un tipo a la librería del proyecto, el tipo está asociado al elemento
agregado del proyecto. De este modo, el elemento del proyecto es la instancia del tipo.

Requisitos
● Se visualiza la Task Card "Librerías".
● Los elementos que se desean agregar como tipo están compilados.
● Los elementos tienen un estado coherente.
● En los bloques se cumplen todos los demás requisitos que se describen en el capítulo
"Requisitos para bloques (Página 56)"

Procedimiento
Para agregar un elemento ya existente como tipo a la librería del proyecto, proceda del
siguiente modo:
1. Abra la librería del proyecto en la Task Card "Librerías".
2. Arrastre uno o varios elementos mediante Drag & Drop a la carpeta "Tipos" o a cualquier
subcarpeta de "Tipos".
Alternativa: copie los elementos del árbol de proyecto en el portapapeles y péguelos en la
carpeta deseada de la librería del proyecto.
Se abre el cuadro de diálogo "Agregar tipo".
3. Introduzca las propiedades del nuevo tipo:
– Introduzca un nombre para el nuevo tipo en el campo "Nombre del tipo".
– Introduzca un número de versión para el nuevo tipo en el campo "Versión".
– En el campo "Autor" introduzca el nombre del autor responsable del tipo.
– Introduzca un comentario acerca del tipo en el campo "Comentario".
4. Confirme con "Aceptar".
Se creará el tipo nuevo con una versión habilitada. La versión está asociada al elemento
(instancia) agregado.
Nota
Configurar el nombre del autor
En la configuración puede introducir un nombre de usuario. Si agrega tipos a la librería, crea
y comparte versiones de tipo o crea copias maestras, el usuario registrado en la
configuración se indicará como autor en las propiedades.

Consulte también
Principios básicos de los tipos (Página 49)
Duplicado de tipos (Página 58)
Requisitos para bloques (Página 56)
Referenciado de objetos dentro de un bloque (Página 57)

Uso de librerías
Manual de programación y manejo, 11/2019

55

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto
Principios básicos de las librerías (Página 7)
Agregar plantillas maestras (Página 46)

8.5.2

Requisitos para bloques

Bloques admisibles para crear un tipo
A partir de los bloques siguientes es posible crear tipos en la librería del proyecto:
● Bloques de función (FB)
● Funciones (FC)
● Tipos de datos PLC (UDT)

Coherencia y compilación
Para generar un tipo a partir de un bloque, este debe ser coherente y estar compilado. Cuando
se crea un tipo, automáticamente se comprueba la coherencia del bloque y, en caso necesario,
se compila.

Requisitos para el bloque
Para generar un tipo a partir de un bloque, este debe cumplir los siguientes requisitos:
● El bloque concuerda con el tipo de la CPU.
Un bloque que no concuerda con una CPU se reconoce por el símbolo de incompatibilidad
situado a la derecha del bloque en el árbol del proyecto. Esto sucede, p. ej., cuando se copia
un bloque de una CPU S7-1500 a una CPU S7-300. Un bloque de una CPU S7-1500 no es
compatible con una CPU S7-300 y no puede compilarse. Por este motivo no es posible
generar un tipo a partir del bloque.
● El bloque no es un bloque de datos de sistema.
● El bloque no contiene ninguna llamada de una instancia individual de un bloque de datos
de instancia ni tampoco la llamada de un bloque de datos dentro de un bloque AWL con la
instrucción "OPN".

56

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto

Particularidades de los bloques con protección de know-how
Tampoco es posible generar tipos a partir de bloques con protección de know-how. Además,
deben tenerse en cuenta los requisitos siguientes para bloques con protección de know-how:
● Habilitación del bloque para utilizarlo como tipo
Los bloques con protección de know-how deben habilitarse para utilizarse en una librería.
El ajuste correspondiente se realiza en las propiedades del bloque.
● El bloque no contiene accesos a bloques de datos, variables PLC o constantes PLC.
Puesto que no es posible generar tipos a partir de bloques de datos, variables PLC o
constantes PLC, tampoco pueden crearse tipos a partir de bloques con protección de knowhow con accesos a los objetos citados. La instancia de un bloque con protección de knowhow no es operativa sin los bloques de datos, variables PLC o constantes PLC
correspondientes.
● Si en la Task Card "Librerías" o en la vista de librerías edita la versión de test de un tipo,
puede configurar una protección de know-how en las propiedades del bloque.
La protección de know-how puede eliminarse en las propiedades del bloque en el árbol del
proyecto.

Consulte también
Agregar tipos a la librería del proyecto (Página 54)
Referenciado de objetos dentro de un bloque (Página 57)

8.5.3

Referenciado de objetos dentro de un bloque
Hay muchos casos en los que se referencian otros objetos dentro de un tipo. Por ejemplo, se
llama una variable o un bloque de datos dentro de un bloque. En consecuencia, entre el bloque
y los objetos referenciados se establece una dependencia. En ese caso, el bloque solo será
coherente si todos los objetos dependientes también están disponibles.

Referenciado de otros tipos
Si en un bloque se llaman otros bloques de programa, faceplates, tipos de datos PLC (UDT)
o tipos de datos de usuario HMI, estos objetos dependientes se guardarán automáticamente
también como tipo en la librería del proyecto. Si más adelante se reutiliza el bloque de
referencia como instancia en el proyecto, los objetos a los que se hace referencia también
crearán una instancia. Con ello, el TIA Portal hace de forma automática que el bloque sea
siempre coherente y que el programa de usuario se pueda ejecutar.

Uso de librerías
Manual de programación y manejo, 11/2019

57

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto

Referenciado de otros objetos
En bloques sin protección de know-how se permiten accesos a bloques de datos, variables
PLC o constantes PLC. Por eso, a partir de estos bloques pueden generarse tipos. Sin
embargo, mientras p. ej. los bloques de función referenciados en un bloque también se crean
automáticamente como tipo en la librería del proyecto, esto no sucede en el caso de accesos
a bloques de datos, variables PLC y constantes PLC. Cuando se referencian bloques de datos,
variables PLC o constantes PLC en un bloque, simplemente se crea el bloque propiamente
dicho como tipo. Los objetos referenciados no se crean como tipo. Si se referencian objetos
que no pueden crearse como tipos, tenga en cuenta lo siguiente:
● Uso del bloque en otro lugar
Si se crea una instancia del tipo del bloque en un lugar distinto del original (p. ej., en otra
CPU), los objetos referenciados faltarán en el lugar de uso posterior. Por este motivo deben
volver a crearse objetos referenciados en el lugar de uso posterior (p. ej., bloques de datos
o tablas de variables). Asegúrese de que los objetos referenciados tengan el mismo
nombre correcto también en el lugar de uso posterior.
● Cambios de nombre a posteriori en objetos referenciados
Si cambia a posteriori el nombre de los objetos referenciados, el bloque ya no será
coherente. El objeto referenciado (p. ej., una variable) ya no se encontrará. En versiones ya
validadas del tipo ya no se podrá corregir la llamada del objeto. En ese caso, cree una
versión nueva del tipo y corrija el nombre del objeto llamado. Actualice a continuación todas
las instancias del tipo del proyecto a la versión más reciente.

Consulte también
Requisitos para bloques (Página 56)
Agregar tipos a la librería del proyecto (Página 54)
Comprobar la coherencia de una versión (Página 64)
Actualizar un proyecto a las últimas versiones (Página 68)
Visualizar relaciones entre objetos de librerías (Página 27)

8.5.4

Duplicado de tipos
Los tipos de la librería del proyecto se pueden duplicar. Si duplica un tipo, valdrá lo siguiente
para el duplicado:
● El duplicado se crea en la misma carpeta.
● El duplicado se crea a partir de la versión más alta del tipo.
● El duplicado no posee ninguna instancia en el proyecto.

Requisitos
El tipo está habilitado.

58

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto

Procedimiento
Para duplicar un tipo en la librería del proyecto, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el tipo.
2. Elija el comando "Duplicar tipo" del menú contextual.
Se abre el cuadro de diálogo "Duplicar tipo".
3. Introduzca las propiedades del tipo nuevo:
– Introduzca un nombre para el tipo nuevo en el campo "Nombre del tipo".
– Introduzca un número de versión para el tipo nuevo en el campo "Versión".
– En el campo "Autor" introduzca el nombre del autor responsable del tipo.
– Introduzca un comentario acerca del tipo en el campo "Comentario".
4. Confirme con "Aceptar".
Se creará el tipo nuevo con una versión habilitada.

Consulte también
Agregar tipos a la librería del proyecto (Página 54)
Editar elementos de librería (Página 99)

8.5.5

Uso de tipos de la librería del proyecto
Los tipos de la librería del proyecto pueden utilizarse todas las veces que se quiera dentro de
un proyecto. La utilización de un tipo siempre está enlazada con una versión del tipo en
cuestión en la librería del proyecto. Si el tipo posee elementos dependientes, estos también se
crearán como uso en la ubicación adecuada del proyecto. Son elementos dependientes, p. ej.,
tipos de datos PLC referenciados en un bloque.
Solo es posible asignar una versión del mismo tipo a un dispositivo. En caso necesario pueden
crearse usos de varios tipos a la vez.
Los usos de un tipo en el árbol del proyecto se llaman instancias.

Ubicaciones posibles para versiones de tipo
Para utilizar un tipo, cree un uso de una versión determinada del tipo en una ubicación
adecuada del proyecto. Las ubicaciones adecuadas son:
● Carpeta del árbol del proyecto
En una carpeta del árbol del proyecto se puede crear una instancia de un tipo. La carpeta
debe ser adecuada para la clase de tipo. Si se trata, p. ej., de un tipo de datos de usuario,
la instancia solo podrá crearse en la carpeta "Tipos de datos PLC".
● Editor
En un editor adecuado se puede generar un uso a partir de un tipo. Así, p. ej., a partir del
tipo de un bloque de función se puede crear un uso en otro bloque. El tipo del bloque de
función se abrirá así desde otro bloque.

Uso de librerías
Manual de programación y manejo, 11/2019

59

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto

Posibilidades de crear un uso
Existen dos posibilidades de crear usos de tipos:
● Arrastrar un tipo mediante Drag & Drop desde la librería del proyecto hasta la ubicación
Se generan usos a partir de los tipos y sus elementos dependientes y se insertan en la
ubicación deseada. Los usos están enlazados con la correspondiente versión del tipo en la
librería del proyecto. Si los usos se generan en un editor, a partir de los tipos también se
generarán instancias en las ubicaciones correspondientes del árbol del proyecto. De
manera estándar, la estructura de carpetas de la librería se reproduce en el árbol del
proyecto. Si no se ha decidido conscientemente por otra carpeta en el árbol del proyecto,
encontrará las instancias en las mismas carpetas que en la librería.
● Copiar y pegar usos de tipos
Es posible copiar usos de tipos en el portapapeles y pegarlos después en otra ubicación.
Se habrá creado así otro uso de la versión del tipo. El uso seguirá enlazado con la misma
versión del tipo en la librería del proyecto. Al copiar el uso de un tipo en el portapapeles y
pegarlo en otro proyecto, todas las versiones necesarias del tipo se reproducen en la
librería de proyecto del otro proyecto.

Requisitos
● Las versiones deseadas están habilitadas.
● En el proyecto ya hay un dispositivo que soporta la clase de los tipos deseados.
● El dispositivo aún no tiene asignado otro uso de los mismos tipos.

Procedimiento
Para crear un uso de un tipo, proceda del siguiente modo:
1. En la librería del proyecto, seleccione las versiones de las cuales desea crear una instancia.
2. Arrastre las versiones de tipos mediante Drag & Drop desde la librería del proyecto hasta
la ubicación en el árbol del proyecto o un editor.
Alternativa: para utilizar automáticamente la versión más reciente, arrastre los tipos
propiamente dichos mediante Drag & Drop desde la librería del proyecto hasta la ubicación.
Arrastre p. ej. el tipo de un bloque de función mediante Drag & Drop a la carpeta de bloques
de una CPU en el árbol del proyecto. Para abrir el tipo p. ej. directamente desde otro bloque,
arrastre el tipo mediante Drag & Drop de la librería del proyecto a la ubicación dentro del
editor.
Alternativa:
1. Copie uno o varios usos en el portapapeles.
2. A continuación pegue los usos en una ubicación adecuada del mismo proyecto o en otro
proyecto.

Consulte también
Principios básicos de los tipos (Página 49)
Estado de las versiones de tipo (Página 51)
Mostrar tipos de una instancia (Página 61)

60

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto
Principios básicos de las librerías (Página 7)
Uso de plantillas maestras (Página 48)

8.5.6

Mostrar tipos de una instancia
Existe la posibilidad de saltar desde el árbol del proyecto hasta el tipo de la librería del proyecto
que pertenece a la instancia en el árbol del proyecto.

Procedimiento
Para saltar al tipo de la librería del proyecto, proceda del siguiente modo:
1. En el árbol del proyecto, haga clic en la instancia del tipo con el botón derecho del ratón.
2. Elija el comando "Ir a tipos" del menú contextual.
La versión de tipo referenciada del tipo correspondiente aparece en la librería del proyecto.

Consulte también
Uso de tipos de la librería del proyecto (Página 59)

8.5.7

Crear una versión de test de un tipo
Antes de habilitar un tipo para la utilización productiva es necesario probar el tipo dentro de un
proyecto y en una instalación de automatización. El test se lleva a cabo en un entorno de test
determinado. Este entorno de test puede ser una CPU, por ejemplo.
Para el test es necesario crear una versión en el estado "en prueba". Es posible crear una
versión en el estado "en prueba" para todas las clases de tipos, excepto para faceplates y tipos
de datos de usuario HMI. En cambio, para faceplates y tipos de datos de usuario HMI es
posible crear versiones en el estado "en proceso".
Existen dos posibilidades para crear una versión de test de un tipo y definir el entorno de test:
● En la Task Card "Librerías" o en la vista de librería
La versión nueva se genera en el estado "en prueba" en la Task Card "Librerías" o en la
vista de librería. La versión nueva se genera directamente a partir del tipo o de una versión
determinada del tipo.
● En una instancia del árbol del proyecto
También es posible crear la versión de test directamente en la instancia del árbol del
proyecto. Puesto que la instancia siempre se utiliza en una versión determinada del
proyecto, se genera una versión nueva del tipo a partir de la versión utilizada en la instancia.
También puede crear simultáneamente versiones de test de varios tipos.

Uso de librerías
Manual de programación y manejo, 11/2019

61

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto
Para una versión en el estado "en prueba" rigen las siguientes reglas:
● Únicamente es posible poner una sola versión de cada tipo en el estado "en prueba".
● Una versión en prueba solo puede estar enlazada con una sola instancia en el proyecto. Por
ello, no es posible copiar una instancia en el portapapeles, duplicarla o crear otro tipo a
partir de la instancia mientras esta tenga el estado "en prueba".

Requisitos
● Dentro del proyecto existe como mínimo una instancia del tipo en una versión cualquiera.
● Si desea crear una versión nueva a partir de una versión determinada del tipo, la instancia
debe utilizarse en esta versión en el proyecto.

Procedimiento
Para crear una versión de test nueva de un tipo o la versión de un tipo, proceda del siguiente
modo:
1. Seleccione el tipo, una versión del tipo o la instancia.
Si crea la versión de test directamente en la instancia, es posible seleccionar varios
elementos o carpetas utilizando la selección múltiple. Como mediante la instancia
seleccionada ya está definido el entorno de test, es posible omitir los pasos 3 y 4.
2. Haga clic con el botón derecho del ratón en el elemento seleccionado y elija el comando
"Editar tipo" del menú contextual.
Si se ha iniciado la edición en la Task Card "Librerías" o en la vista de librería, se abrirá el
cuadro de diálogo "Editar tipo". Si se ha iniciado la edición en la instancia en el árbol del
proyecto, la instancia de test se abrirá inmediatamente para su edición en la vista de librería.
3. En la lista, seleccione una instancia del tipo en el proyecto.
Si se ha iniciado la edición en el tipo, rige lo siguiente:
– La ubicación en la que se utiliza la instancia (p. ej. la CPU) sirve para editar
seguidamente el tipo como entorno de test.
– Mediante la selección de la instancia de test se especifica también la versión que se
editará.
Para la edición de una versión determinada rige lo siguiente:
Si el punto de partida es una versión determinada, solo es posible elegir en la lista
instancias que se utilicen en la misma versión.
4. Confirme con "Aceptar".

Resultado
Se crea una versión nueva del tipo. La versión nueva tiene el estado "en prueba" y se identifica
correspondientemente en la interfaz de usuario.

62

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto

Consulte también
Principios básicos de los tipos (Página 49)
Estado de las versiones de tipo (Página 51)
Principios básicos de las librerías (Página 7)

8.5.8

Editar la versión de prueba de un tipo
Si sigue editando una versión en estado "en prueba", no se creará una versión nueva. La
edición de la versión de prueba puede iniciarse en la instancia del árbol del proyecto, en la Task
Card "Librerías" o en la vista de librería.
Nota
Borrar y cambiar el nombre de los parámetros de interfaz
Es posible agregar nuevos parámetros. No obstante, si cambia el nombre de parámetros ya
existentes o los borra, estos dejan de recibir valores al llamar el bloque.

Procedimiento
Para editar la versión de prueba de un tipo, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la versión de prueba o en la instancia.
2. Elija el comando "Editar tipo" del menú contextual.
La instancia de prueba se abre y puede editarse.

Consulte también
Principios básicos de los tipos (Página 49)
Estado de las versiones de tipo (Página 51)
Principios básicos de las librerías (Página 7)
Comprobar la coherencia de una versión (Página 64)
Rechazar versiones (Página 65)
Habilitar versiones (Página 66)

8.5.9

Crear una versión en proceso de un tipo
Si se desea editar un tipo con faceplates o tipos de datos de usuario HMI, es necesario crear
una versión nueva del tipo en estado "en proceso". La edición de la versión nueva se lleva a
cabo en la vista de librería. Para comprobar la compatibilidad de los cambios se comprueba
automáticamente la coherencia del tipo antes de la habilitación.

Uso de librerías
Manual de programación y manejo, 11/2019

63

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto

Requisitos
La librería del proyecto está abierta en la Task Card "Librerías" o en la vista de librería.

Procedimiento
Para crear una versión nueva de un tipo en proceso, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en el tipo o en la versión del tipo.
2. Elija el comando "Editar tipo" del menú contextual.
Se creará una versión nueva "en proceso" y se abrirá en la vista de librería para su edición.

Consulte también
Principios básicos de los tipos (Página 49)
Estado de las versiones de tipo (Página 51)
Principios básicos de las librerías (Página 7)

8.5.10

Comprobar la coherencia de una versión
Al editar una versión de tipo es posible que se produzca por error un estado incoherente. Para
detectar a tiempo errores en el proceso de desarrollo, compruebe con frecuencia la
coherencia. De todas formas, esta prueba de coherencia siempre se lleva a cabo
automáticamente tan pronto se habilita una versión.
A continuación se explica cómo iniciar manualmente la prueba de coherencia de la versión de
un tipo.

Requisitos
● La librería del proyecto está abierta en la Task Card "Librerías" o en la vista de librería.
● La versión se encuentra en estado "en proceso" o "en prueba".

Procedimiento
Para comprobar la coherencia de la versión de un tipo, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la versión cuya coherencia desea comprobar.
2. Elija el comando "Comprobar coherencia" del menú contextual.
Se comprueba la coherencia. Se obtiene un aviso con el resultado de la prueba de
coherencia.

Consulte también
Habilitar versiones (Página 66)
Rechazar versiones (Página 65)

64

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto
Editar la versión de prueba de un tipo (Página 63)
Principios básicos de los tipos (Página 49)
Estado de las versiones de tipo (Página 51)
Principios básicos de las librerías (Página 7)

8.5.11

Rechazar versiones
Es posible rechazar las versiones de un tipo que tengan el estado "en prueba" o "en proceso"
si ya no se necesitan. También existe la posibilidad de seleccionar varios tipos o carpetas y
rechazar todas las versiones de test o procesamiento que haya dentro. Todos los usos de las
versiones borradas se restablecen al último estado habilitado.

Requisitos
● La versión que desea rechazar tiene el estado "en prueba" o "en proceso".
● Se encuentra en la vista de librería o está abierta la Task Card "Librerías".

Procedimiento
Para rechazar una versión, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la versión que desea descartar.
2. Elija el comando "Rechazar cambios y borrar versión" del menú contextual.
La versión se borra.
Alternativa en la vista de librería:
1. Mientras haya una versión abierta para su edición, haga clic en el botón "Rechazar cambios
y borrar versión" de la barra de herramientas.
La versión se borra.

Consulte también
Principios básicos de los tipos (Página 49)
Estado de las versiones de tipo (Página 51)
Principios básicos de las librerías (Página 7)
Comprobar la coherencia de una versión (Página 64)

8.5.12

Rechazar todas las versiones contenidas en una carpeta
Puede rechazar a la vez todas las versiones en el estado "en prueba" o "en proceso"
contenidas en una carpeta. Todos los usos de la versión borrada se restablecen al último
estado habilitado.

Uso de librerías
Manual de programación y manejo, 11/2019

65

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto

Requisitos
Se encuentra en la vista de librería o está abierta la Task Card "Librerías".

Rechazar la versión de un solo tipo
Para rechazar todas las versiones contenidas en una carpeta, haga lo siguiente:
1. Haga clic en la carpeta con el botón derecho del ratón.
2. Seleccione el comando "Rechazar todo" del menú contextual.
Se borrarán todas las versiones "en prueba" o "en proceso".

8.5.13

Habilitar versiones
Una vez finalizada la edición de una versión de tipo, habilite la versión para la utilización
productiva. Al realizar la habilitación se asigna un número a la versión. También es posible
habilitar varias versiones a la vez utilizando la selección múltiple.

Requisitos
● La Task Card "Librerías" está abierta o se encuentra en la vista de librería.
● Las versiones que desea habilitar tienen el estado "en prueba" o "en proceso".
● Las versiones tienen un estado coherente.
Se realiza una comprobación de coherencia en cuanto se inicia la habilitación. Si ocurren
errores que impiden la habilitación durante la prueba de coherencia, aparecerá un aviso
con recomendaciones para eliminar el error.

Procedimiento
Para habilitar versiones de tipos, proceda del siguiente modo:
1. Seleccione las versiones que desea habilitar.
2. Haga clic en la selección con el botón derecho del ratón.
3. Elija el comando "Habilitar versión" del menú contextual.
Se abre el cuadro de diálogo "Habilitar versión de tipo".
4. Modifique las propiedades de la versión en caso necesario:
– Introduzca un nombre para el tipo en el campo "Nombre". Si ha seleccionado varias
versiones para la habilitación, el campo "Nombre" no puede modificarse.
– En el campo "Versión" especifique un número de versión principal y uno intermedio para
la versión que se va a habilitar. Si ha seleccionado varias versiones para la habilitación,
el campo "Versión" no puede modificarse y para la habilitación se utiliza el último
número de versión en cada caso.
– En el campo "Autor" introduzca el autor de la versión que se va a habilitar.
– En el campo "Comentario" introduzca un comentario acerca de la versión que se va a
habilitar.

66

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto
5. Opcionalmente: Active la casilla de verificación "Borrar de la librería las versiones de tipo no
utilizadas" para borrar de la librería todas las versiones que no están enlazadas con una
instancia del proyecto. Las versiones que dependen de otros tipos o plantillas maestras no
se borran.
6. Confirme con "Aceptar".
Alternativa en la vista de librería:
1. Mientras esté abierta una versión para editar, haga clic en el botón "Habilitar versión" de la
barra de herramientas.
2. Continúe con los pasos 3 a 5 de la descripción que antecede.

Resultado
Las versiones seleccionadas se habilitan.
Las propiedades se aplican a los tipos en cuestión, las versiones que se van a habilitar y todas
las versiones posteriores. Los cambios no afectan a las versiones ya habilitadas.
Dado el caso, todas las instancias con la misma versión de partida se actualizarán a la versión
más reciente y se borrarán las versiones del tipo que no se utilizan.

Consulte también
Habilitar todas las versiones dentro de una carpeta (Página 67)
Principios básicos de los tipos (Página 49)
Estado de las versiones de tipo (Página 51)
Principios básicos de las librerías (Página 7)
Comprobar la coherencia de una versión (Página 64)
Asignar una versión (Página 75)
Agregar tipos a una librería global (Página 71)
Actualizar un proyecto a las últimas versiones (Página 68)

8.5.14

Habilitar todas las versiones dentro de una carpeta
Una vez finalizada la edición de todos los tipos de una carpeta es posible habilitar todas las
versiones a la vez.

Uso de librerías
Manual de programación y manejo, 11/2019

67

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto

Requisitos
● Se encuentra en la Task Card "Librerías" o en la vista de librería.
● La carpeta contiene versiones en estado "en prueba" o "en proceso".
● Todas las versiones "en prueba" o "en proceso" tienen un estado coherente.
Se realiza una comprobación de coherencia en cuanto se inicia la habilitación. Si ocurren
errores que impiden la habilitación durante la comprobación de coherencia, aparecerá un
aviso con recomendaciones para eliminar el error.

Procedimiento
Para habilitar todas las versiones de tipos de una carpeta, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en la carpeta deseada.
2. Elija el comando "Habilitar todo" del menú contextual.
Se abre el cuadro de diálogo "Habilitar versión de tipo".
3. Modifique las propiedades de la versión en caso necesario:
– En el campo "Autor" introduzca el autor de las versiones que se van a habilitar.
– En el campo "Comentario" introduzca un comentario acerca de las versiones que se van
a habilitar.
4. Active la casilla de verificación "Borrar de la librería las versiones de tipo no utilizadas" para
borrar de la librería todas las versiones que no están enlazadas con una instancia del
proyecto. Las versiones que dependen de otros tipos o plantillas maestras no se borran.
5. Confirme con "Aceptar".

Resultado
Se habilitan todas las versiones de tipos "en prueba" o "en proceso" dentro de la carpeta
seleccionada.
Las propiedades se aplican a las versiones que se van a habilitar y todas las versiones
posteriores. Los cambios no afectan a las versiones ya habilitadas.
Dado el caso se borran las versiones de tipos que no se utilizan en el proyecto.

Consulte también
Habilitar versiones (Página 66)

8.5.15

Actualizar un proyecto a las últimas versiones
Después de actualizar varios tipos en la librería del proyecto, es necesario actualizar todas las
instancias del proyecto a la versión más reciente de los tipos de la librería del proyecto. Si no
desea aplicar los cambios a todo el proyecto, limite la actualización a solo algunos dispositivos
del proyecto.

68

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto
Los siguientes elementos pueden seleccionarse como fuente de la actualización:
● Toda la librería del proyecto
● Carpetas individuales de la librería del proyecto
● Tipos individuales
Está permitido seleccionar varios tipos.
Nota
Borrar instancias de tipo no utilizadas del proyecto
De forma estándar, al actualizar el proyecto a las versiones más recientes, las instancias de
tipo que no se utilicen se borrarán del proyecto.
Para impedir que se borren del proyecto las instancias de tipo no utilizadas, marque la casilla
"Desactivar borrado de instancias de tipo no utilizadas en el proyecto" en los ajustes, en
"General > Ajustes de librería".

Requisitos
Se encuentra en la Task Card "Librerías" o en la vista de librería.

Procedimiento
Para actualizar instancias en un proyecto con los contenidos de la librería del proyecto,
proceda del siguiente modo:
1. Seleccione toda la librería del proyecto o algunos elementos de ella.
2. Haga clic con el botón derecho del ratón en los elementos deseados y elija el comando
"Actualizar tipos > Proyecto" del menú contextual.
Se abre el cuadro de diálogo "Actualizar tipos en el proyecto".
3. Seleccione todo el proyecto o algunos dispositivos para la actualización.
4. Elija las opciones para el proceso de actualización:
– La casilla de verificación "Actualizar instancias del proyecto" siempre está activa en este
proceso.
– Active la casilla de verificación "Borrar de la librería las versiones de tipo no utilizadas"
para borrar de la librería del proyecto todas las versiones anteriores de los tipos
actualizados.
5. Confirme con "Aceptar".
Se realiza la actualización.

Resultado
En el proyecto se efectúan las modificaciones siguientes:
● Dado el caso se borran de la librería del proyecto todas las versiones anteriores.
● Todas las instancias de los dispositivos seleccionados se actualizan a la última versión del
tipo asociado.

Uso de librerías
Manual de programación y manejo, 11/2019

69

Utilizar tipos y sus versiones
8.5 Trabajar con tipos en la librería del proyecto
● Si una CPU contiene instancias de bloques que no se llaman en el programa de usuario, las
instancias de los bloques se eliminarán de la CPU. Los tipos seguirán presentes en la
librería y pueden volver a utilizarse en el proyecto si fuera necesario.
● En el árbol del proyecto, bajo "Datos comunes", encontrará un informe del proceso de
actualización.

Consulte también
Actualizar un proyecto a la versión de tipo más reciente (Página 73)
Actualizar una librería con los tipos de otra librería (Página 81)
Principios básicos de los tipos (Página 49)
Principios básicos de las librerías (Página 7)
Estado de las versiones de tipo (Página 51)

8.5.16

Deshacer la conexión entre la instancia y el tipo
Las instancias de los tipos siempre están enlazadas con la versión del tipo correspondiente y
no pueden editarse como un objeto común. Al editar una instancia, se crea automáticamente
una versión nueva del tipo en la librería del proyecto y, de este modo, los cambios influyen en
todo el proyecto.
Si se deshace la conexión de la instancia con su tipo, a continuación el objeto se edita como
un objeto común en el árbol del proyecto.
Nota
Desactivar "Desconectar del tipo"
Si desea impedir que dentro del proyecto las instancias se desconecten de sus tipos, desactive
la opción "Desconectar del tipo".
Para ello, active la opción "Desactivar la entrada 'Desconectar del tipo' del menú contextual"
en "Opciones > Configuración > General > Ajustes de librería".

Requisitos
La instancia no debe tener el estado "en prueba".

Procedimiento
Para deshacer la conexión entre las instancias y sus versiones de tipos, proceda del siguiente
modo:
1. Seleccione una o varias instancias en el árbol del proyecto.
2. Haga clic en la selección con el botón derecho del ratón y elija el comando "Desconectar del
tipo" del menú contextual.
3. Se deshace la conexión con las versiones de tipos correspondientes.

70

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.6 Trabajar con tipos en las librerías globales

Consulte también
Principios básicos de los tipos (Página 49)
Principios básicos de las librerías (Página 7)
Estado de las versiones de tipo (Página 51)

8.6

Trabajar con tipos en las librerías globales

8.6.1

Agregar tipos a una librería global
Las librerías globales sirven de recurso central para trabajar en varios proyectos. Por ello, la
edición directa de tipos está reservada a los tipos de la librería del proyecto. Para trabajar en
los tipos es necesario utilizar la librería del proyecto. Una vez finalizada la edición de un tipo en
la librería del proyecto, es posible agregar el tipo a la librería global. El proceso de agregar tipos
desde la librería del proyecto es igual al proceso de copia habitual desde la librería del
proyecto.

Requisitos
● La Task Card "Librerías" o la vista de librería está abierta.
● La librería global a la que desea agregar tipos está abierta con derechos de escritura.

Procedimiento
Para agregar tipos a una librería global, proceda del siguiente modo:
1. Abra la carpeta deseada de la librería global en la Task Card "Librerías" o en la vista de
librería.
2. Arrastre uno o varios tipos mediante Drag&Drop desde la librería del proyecto hasta la
carpeta "Tipos" o cualquier subcarpeta de la librería global.
Alternativa:
1. Copie los tipos deseados de la librería del proyecto en el portapapeles.
2. Abra la librería global deseada en la paleta "Librería global" de la Task Card "Librerías".
3. Haga clic con el botón derecho del ratón en la carpeta "Tipos" o en cualquier subcarpeta de
"Tipos".
4. Elija el comando "Pegar" del menú contextual.

Resultado
Los tipos se insertan en la librería global. Los tipos dependientes como, por ejemplo, tipos de
datos de usuario HMI o variables, también se copian en la librería global, siempre y cuando aún
no existan en ella. Así se garantiza que todos los elementos necesarios para crear una
instancia se encuentren en la librería global.

Uso de librerías
Manual de programación y manejo, 11/2019

71

Utilizar tipos y sus versiones
8.6 Trabajar con tipos en las librerías globales
Si un tipo ya está presente en la librería global, el proceso descrito corresponde a una
actualización de la librería global. En este caso se agregarán a la librería global las últimas
versiones validadas del tipo.

Consulte también
Principios básicos de los tipos (Página 49)
Habilitar versiones (Página 66)
Asignar una versión (Página 75)
Actualizar un proyecto a la versión de tipo más reciente (Página 73)
Principios básicos de las librerías (Página 7)

8.6.2

Uso de tipos de una librería global
Para utilizar tipos de la librería global, cree un uso de una versión determinada del tipo en una
ubicación adecuada del proyecto. En caso necesario pueden crearse usos de varios tipos a la
vez. Los usos de un tipo en el árbol del proyecto se llaman instancias.

Ubicaciones posibles para versiones de tipo
Son ubicaciones adecuadas para tipos de librerías globales:
● Carpeta del árbol del proyecto
En una carpeta del árbol del proyecto se puede crear una instancia de un tipo. La carpeta
debe ser adecuada para la clase de tipo. Si se trata, p. ej., de un tipo de datos de usuario,
la instancia solo podrá crearse en la carpeta "Tipos de datos PLC".
● Editor
En un editor adecuado se puede generar un uso a partir de un tipo. Así, p. ej., a partir del
tipo de un bloque de función se puede crear un uso en otro bloque. El tipo del bloque de
función se abrirá así desde otro bloque.

Enlace del uso con la librería del proyecto
Los usos de los tipos de una librería global no están enlazados en el proyecto con el tipo de la
librería global. Por el contrario, al crear un uso se genera una copia del tipo y sus elementos
dependientes en la librería del proyecto. Los elementos dependientes pueden ser tipos de
datos PLC que se referencian en un bloque, por ejemplo. La copia del tipo y de los elementos
dependientes en la librería del proyecto contiene en cada caso la versión que se ha enlazado
con los usos. Si el tipo o un elemento dependiente ya existe en la librería del proyecto, solo se
complementará en la librería del proyecto, en su caso, la versión faltante.
El uso queda enlazado con la copia del tipo en la librería del proyecto. Solo es posible asignar
un tipo a un dispositivo una vez, independientemente de la versión.

72

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.6 Trabajar con tipos en las librerías globales

Requisitos
● En el proyecto ya hay un dispositivo que soporta la clase del tipo.
● El dispositivo aún no tiene asignada otra instancia del mismo tipo.

Procedimiento
Para utilizar la versión de un tipo en el proyecto, proceda del siguiente modo:
1. En la librería global, seleccione las versiones de las cuales desee crear un uso.
2. Arrastre las versiones deseadas de los tipos hasta la ubicación mediante Drag & Drop.
Alternativa: para utilizar automáticamente la versión más reciente, arrastre los tipos
propiamente dichos mediante Drag & Drop desde la librería hasta la ubicación.
Arrastre p. ej. el tipo de un bloque de función mediante Drag & Drop a la carpeta de bloques
de una CPU en el árbol del proyecto. Para abrir el tipo p. ej. directamente desde otro bloque,
arrastre el tipo mediante Drag & Drop desde la librería hasta la ubicación dentro del editor
de programación.

Resultado
Los tipos o las versiones individuales que faltan se complementan en la librería del proyecto.
Si un tipo todavía no está presente en la librería del proyecto, se deposita en la misma carpeta
que anteriormente en la librería global. Se crea un uso a partir de los tipos y sus elementos
dependientes y se inserta en la ubicación deseada. Los usos están enlazados con la
correspondiente versión del tipo en la librería del proyecto.
Si ha creado los usos en un editor, a partir de los tipos también se generarán instancias en las
ubicaciones correspondientes en el árbol del proyecto. La estructura de carpetas de la librería
se reproduce en el árbol del proyecto. Por ello, encontrará los usos en las mismas carpetas que
en la librería global.

Consulte también
Principios básicos de los tipos (Página 49)
Actualizar un proyecto a la versión de tipo más reciente (Página 73)
Principios básicos de las librerías (Página 7)
Utilizar la vista de elementos (Página 14)

8.6.3

Actualizar un proyecto a la versión de tipo más reciente
Las librerías globales suelen editarse de forma centralizada especialmente en grandes
empresas con muchos proyectos de automatización. Una vez finalizada una versión nueva, las
librerías globales actualizadas se ponen a disposición de los distintos proyectos. Si se obtiene
una versión más reciente de una librería global, se reemplazan las instancias obsoletas del
proyecto por la versión más reciente. Si no desea aplicar los cambios a todo el proyecto, limite
la actualización a solo algunos dispositivos del proyecto.

Uso de librerías
Manual de programación y manejo, 11/2019

73

Utilizar tipos y sus versiones
8.6 Trabajar con tipos en las librerías globales
Durante la actualización del proyecto o de los distintos dispositivos también se actualiza la
librería del proyecto con las versiones nuevas de los tipos en la librería global.
Los siguientes elementos pueden seleccionarse como origen de la actualización:
● El nodo raíz de librerías globales
● Carpetas individuales de una librería global
● Tipos individuales
Está permitido seleccionar varios tipos.
Nota
Borrar instancias de tipo no utilizadas del proyecto
De forma estándar, al actualizar el proyecto a las versiones más recientes, las instancias de
tipo que no se utilicen se borrarán del proyecto.
Para impedir que se borren del proyecto las instancias de tipo no utilizadas, marque la casilla
"Desactivar borrado de instancias de tipo no utilizadas en el proyecto" en los ajustes, en
"General > Ajustes de librería".

Requisitos
● Se encuentra en la Task Card "Librerías" o en la vista de librería.
● La librería global actualizada está abierta.

Procedimiento
Para actualizar instancias en un proyecto con los contenidos de una librería global, proceda del
siguiente modo:
1. Seleccione la librería global actualizada o algunos elementos de ella.
2. Haga clic con el botón derecho del ratón en la librería global o en los elementos deseados
y elija el comando "Actualizar tipos > Proyecto" del menú contextual.
Se abre el cuadro de diálogo "Actualizar tipos en el proyecto".
3. Seleccione todo el proyecto o algunos dispositivos para la actualización.
4. Elija las opciones para el proceso de actualización:
– La casilla de verificación "Actualizar instancias del proyecto" siempre está activa en este
proceso.
– Active la casilla de verificación "Borrar de la librería las versiones de tipo no utilizadas"
para borrar de la librería del proyecto todas las versiones anteriores de los tipos
actualizados.
5. Confirme con "Aceptar".
Se realiza la actualización.

74

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar tipos y sus versiones
8.7 Asignar una versión

Resultado
En el proyecto se han efectuado las modificaciones siguientes:
● La versión más reciente de los tipos seleccionados se encuentra en la librería del proyecto.
En caso necesario se han borrado todas las versiones anteriores.
● Todas las instancias dentro de los dispositivos seleccionados se han actualizado a la
versión más reciente del tipo enlazado.
● En el árbol del proyecto, bajo "Datos comunes", encontrará un informe del proceso de
actualización.

Consulte también
Actualizar un proyecto a las últimas versiones (Página 68)
Actualizar una librería con los tipos de otra librería (Página 81)
Principios básicos de los tipos (Página 49)
Principios básicos de las librerías (Página 7)
Agregar tipos a una librería global (Página 71)

8.7

Asignar una versión
Una librería es más clara si los tipos con contenido relacionado tienen el mismo número de
versión. El número de versión idéntico refleja el progreso. Tras concluir el trabajo con varios
tipos relacionados, puede asignarles el mismo número de versión.
Para asignar una versión común a varios tipos están disponibles las siguientes posibilidades
de selección:
● una o varias carpetas de una librería
● uno o varios tipos

Requisitos
● La Task Card "Librerías" o la vista de librería está abierta.
● La selección no puede contener tipos en estado "en test" o "en proceso".

Procedimiento
Para asignar la misma versión a varios tipos, proceda del siguiente modo:
1. Seleccione los tipos a los que desea asignar una versión común.
2. Elija el comando "Asignar versión" del menú contextual.
Se abre el cuadro de diálogo "Asignar versión".

Uso de librerías
Manual de programación y manejo, 11/2019

75

Utilizar tipos y sus versiones
8.7 Asignar una versión
3. Modifique las propiedades de la versión en caso necesario:
– Defina el número de versión nuevo en el campo "Versión". El número de versión debe
ser mayor que el número de versión más alto de todos los tipos seleccionados.
– En el campo "Autor" introduzca el nombre del responsable de la versión que se va a
habilitar.
– En el campo "Comentario" introduzca un comentario acerca de la versión que se va a
habilitar.
4. Confirme con "Aceptar".

Resultado
Las versiones de tipo seleccionadas se modifican del siguiente modo:
● Se crea una versión nueva de todos los tipos seleccionados con el número de versión
especificado.
● Las propiedades se aplican a todos los tipos seleccionados, a la versión nueva y a todas las
versiones posteriores. Los cambios no afectan a las versiones anteriores. Si no se cambian
las propiedades, estas adoptarán la última versión habilitada de cada tipo.
● El número de versión interno de tipos dependientes se incrementa al siguiente número
libre, siempre que los tipos dependientes no estuvieran incluidos en la selección. Si también
se había seleccionado un tipo dependiente, se asignará el número de versión determinado
por el usuario.
Se crea un informe de los cambios. Si se han versionado tipos en la librería del proyecto,
encontrará el informe en "Datos comunes > Informes" en el árbol del proyecto. Si se han
versionado tipos en una librería global, encontrará el informe en la carpeta "Datos comunes >
Informes" de la librería global.

Consulte también
Principios básicos de los tipos (Página 49)
Estado de las versiones de tipo (Página 51)
Principios básicos de las librerías (Página 7)
Habilitar versiones (Página 66)
Agregar tipos a una librería global (Página 71)
Mostrar los informes de las librerías globales (Página 34)

76

Uso de librerías
Manual de programación y manejo, 11/2019

Ingeniería multiusuario en librerías
9.1

9

Ingeniería multiusuario con elementos de librería
Los elementos de la librería del proyecto pueden utilizarse en el marco de la ingeniería
multiusuario.
Encontrará más información sobre el trabajo con ingeniería multiusuario en el capítulo
"AUTOHOTSPOT".

Selecciones para el check in
Los distintos elementos de la librería del proyecto se seleccionan para la ingeniería
multiusuario de la misma manera que en el árbol del proyecto. Los elementos de librería
pueden seleccionarse en las siguientes áreas del TIA Portal:
● Task Card "Librerías"
● Vista de librerías
● Administración de librerías
● En el lugar de uso (ubicación) correspondiente, p. ej., en instancias de tipo
Seleccione los elementos de librería siempre manualmente.
La figura siguiente muestra la Task Card "Librerías" con la columna de selección y los
elementos de librería seleccionados para la función de multiusuario:

Uso de librerías
Manual de programación y manejo, 11/2019

77

Ingeniería multiusuario en librerías
9.1 Ingeniería multiusuario con elementos de librería

Elementos de librería marcables
La tabla siguiente muestra los tipos de la librería del proyecto y de la instancia del proyecto que
pueden seleccionarse para el check in:
Tipo seleccionable en la librería

Instancia seleccionable

Bloques de función (FB)

Sí

Sí

PLC Block Library Type (FC)

Sí

Sí

Tipos de datos PLC (UDT)

Sí

Sí

HMI - Faceplates

Sí

Seleccionando la imagen en la
que se encuentra la instancia del
faceplate

HMI - Tipo de datos definido por
el usuario (UDT)

Sí

Seleccionando el objeto (p. ej.
una imagen o una variable HMI)
en el que se utiliza el UDT.

HMI - Estilo

Sí

No

HMI - Plantilla de formato

Sí

No disponible

HMI - Imagen

Sí

Sí

HMI - Script en C

Sí

Sí

HMI - Script en VB

Sí

Sí

Borrado de tipos en la sesión local
Si desea borrar tipos en la sección local tenga en cuenta lo siguiente:
● Habilite el tipo si todavía existe una versión en test o en proceso.
● Seleccione el tipo en la sesión local antes del borrado, para que el tipo se borre en el
proyecto de servidor asignado.
Aunque las distintas versiones sí que se pueden borrar en la sesión local, permanecen en el
proyecto de servidor. Dado que el borrado es una tarea administrativa, borre los tipos y sus
versiones en el proyecto de servidor.

Actualizar el proyecto
Si desea actualizar el proyecto, tenga en cuenta lo siguiente:
● Seleccione los tipos antes de actualizar el proyecto.
● Seleccione los tipos de datos de usuario HMI en el lugar de uso (ubicación) antes de
actualizar el proyecto.
● Si se actualiza el proyecto, las modificaciones de estilos HMI no se aplicarán en la sesión
local. Actualice los estilos HMI en la vista del proyecto de servidor.

78

Uso de librerías
Manual de programación y manejo, 11/2019

Ingeniería multiusuario en librerías
9.2 Check in de tipos y plantillas maestras

9.2

Check in de tipos y plantillas maestras
Los cambios en tipos y plantillas maestras se aplican en el proyecto de servidor multiusuario
igual que todos los demás objetos en la sesión local. Al realizar el check in de un tipo se realiza
el check in de todas las versiones del tipo. Cuando se efectúa el check in de una instancia,
automáticamente se hace el check in del tipo.

Actualización del proyecto de servidor
Los tipos y las plantillas maestras se identifican y se sincronizan en el proyecto de servidor con
ayuda de la GUID unívoca. En el check in de los tipos y plantillas maestras se aplicarán los
cambios de la sesión local al proyecto de servidor:
● Las propiedades del tipo o de la plantilla maestra, p. ej., el nombre, se aplicarán al proyecto
de servidor.
● Las versiones de tipos que falten se añadirán.
● La estructura de carpetas de la librería se aplica al proyecto de servidor. Sin embargo, las
carpetas vacías no se borran.
La actualización del proyecto de servidor puede generar conflictos. Los posibles conflictos se
solucionan de la siguiente manera:
● Conflictos de nombres
Se puede realizar el check in de dos tipos con nombre idéntico En ese caso los nombres de
los tipos afectados reciben automáticamente una extensión (<_1> etc.).
Dos instancias de tipo con nombre idéntico no están permitidas y provocan un error al
realizar el check in.
● Un tipo está en estado "en test" o "en proceso".
Si un tipo se encuentra en uno de los dos estados en el proyecto de servidor o en la sesión
local no será posible actualizar el proyecto de servidor. Antes de actualizar el proyecto de
servidor, valide todos los tipos seleccionados.
● Conflictos de versión
Si tanto en el proyecto de servidor como en la sesión local hay números de versión idénticos
pero las versiones tienen distinto contenido, se notificará con un mensaje. Cambie el
número de versión de modo que no esté repetido.
Encontrará más información sobre ingeniería multiusuario en el capítulo "AUTOHOTSPOT".

Uso de librerías
Manual de programación y manejo, 11/2019

79

Ingeniería multiusuario en librerías
9.2 Check in de tipos y plantillas maestras

80

Uso de librerías
Manual de programación y manejo, 11/2019

Actualizar los tipos de una librería
10.1

10

Actualizar una librería con los tipos de otra librería
Una librería existente puede actualizarse con los contenidos de otra librería. Para actualizar
librerías existen las siguientes posibilidades:
● actualización de una librería global con tipos de otra librería global o librería del proyecto
● actualización de la librería del proyecto con tipos de una librería global
Los siguientes elementos pueden seleccionarse como fuente de la actualización:
● Nodo raíz de la librería del proyecto
● Nodo raíz de librerías globales
● Carpeta "Tipos"
● Carpetas individuales de la carpeta "Tipos"
● Tipos individuales
Está permitido seleccionar varios tipos.
Durante la actualización se complementan tipos ya existentes con las versiones más recientes
en la librería de destino. Los tipos que aún no existen en la librería de destino se copian en la
misma con todas sus versiones.
Nota
Documentación personalizada al copiar tipos
La documentación personalizada no se copia en otra librería junto con un tipo. El propio
usuario debe copiar la documentación personalizada para tipos en el directorio adecuado.
Encontrará más ayuda sobre el uso de la documentación personalizada en el capítulo
"AUTOHOTSPOT".

Requisitos
Si desea actualizar una librería global, tiene que estar abierta con derechos de escritura.

Procedimiento
Para actualizar una librería con contenidos de otra librería, proceda del siguiente modo:
1. Seleccione en la librería la carpeta "Tipos" o diversos elementos de la misma como fuente
para la actualización.
2. Haga clic con el botón derecho del ratón sobre el origen y elija el comando "Actualizar tipos
> Librería" del menú contextual.
Se abre el cuadro de diálogo "Actualizar tipos en una librería".

Uso de librerías
Manual de programación y manejo, 11/2019

81

Actualizar los tipos de una librería
10.1 Actualizar una librería con los tipos de otra librería
3. Seleccione qué clase de librería desea actualizar:
– Elija "Actualizar librería del proyecto" para actualizar la librería del proyecto con tipos de
una librería global.
– Elija "Actualizar librería global" si desea actualizar una librería global.
4. Opcionalmente: seleccione en la lista desplegable la librería global que desea actualizar si
se trata de una librería global.
5. Seleccione las opciones para la actualización:
– La opción "Actualizar instancias del proyecto" siempre está desactivada para este
proceso.
– Active la casilla de verificación "Borrar de la librería las versiones de tipo no utilizadas"
si desea borrar de la librería todas las versiones del tipo que no estén asociadas a una
instancia del proyecto y que no tengan dependencias con otros tipos. No es posible
seleccionar la opción durante la actualización de una librería global, ya que los tipos de
una librería global nunca poseen una ubicación en el proyecto.
6. Confirme con "Aceptar".
Se realiza la actualización.

Resultado
En la librería de destino se han realizado las modificaciones siguientes:
● Los tipos aún no existentes en la librería de destino se han complementado con todas sus
versiones de tipo. Los tipos ya existentes en la librería de destino se han complementado
con las versiones de tipo más recientes. Si en la librería de destino ya existía una versión
actual de un tipo, la versión actual se ha copiado igualmente desde la librería de origen y
se le ha asignado automáticamente un número de versión más reciente.
● En caso necesario, se han borrado todas las versiones de los tipos de la librería del
proyecto si no se utilizaban en ninguna instancia del proyecto.
● Se ha creado un informe para el proceso de actualización que contiene todas las
modificaciones realizadas en la librería de destino.
Si se ha actualizado la librería del proyecto, encontrará el informe bajo "Datos comunes >
Informes" en el árbol del proyecto.
Si se ha actualizado una librería global, encontrará el informe subordinado a la librería
global en la carpeta "Datos comunes > Informes".

Consulte también
Actualizar un proyecto a las últimas versiones (Página 68)
Actualizar un proyecto a la versión de tipo más reciente (Página 73)
Mostrar los informes de las librerías globales (Página 34)
Principios básicos de las librerías (Página 7)

82

Uso de librerías
Manual de programación y manejo, 11/2019

Actualizar los tipos de una librería
10.2 Actualizar tipos en un proyecto existente

10.2

Actualizar tipos en un proyecto existente
La función "Actualización de tipos" permite actualizar en todo el proyecto las dependencias de
tipos a las últimas versiones de tipo existentes en un solo paso.
Si en la librería del proyecto se edita un tipo que hace referencia a otro tipo y se crea una
versión de tipo nueva, el tipo referenciado pasará automáticamente al estado "en prueba" o "en
proceso". De este modo se garantiza que todos los tipos sean actuales dentro del proyecto.
Si se edita un tipo fuera del proyecto y se crea una versión de tipo nueva, los tipos
referenciados no se actualizarán automáticamente. Para no tener que actualizar manualmente
estas dependencias a los diferentes tipos referenciados, se ofrece la función "Actualización de
tipos" en la administración de librerías.
Con esta función se identifican todos los tipos referenciados que dependen del tipo modificado
y se actualizan automáticamente dichos tipos. Todos los tipos actualizados reciben el
complemento "en prueba" o "en proceso" en la librería del proyecto. Después de la
actualización, esto permite ver rápidamente qué tipos están afectados por los cambios y
pueden comprobarse y volver a validarse selectivamente.

Requisitos
Se ha creado un proyecto que contiene bloques de programa, p. ej., que llaman otros bloques
de programa u objetos, como tipos de datos PLC (UDT). Esto genera dependencias entre los
diferentes objetos.
Se ha creado una librería del proyecto y los tipos que deben editarse se han guardado en una
librería global. Los tipos se han modificado dentro del proyecto y ahora deben volver a
integrarse en la librería del proyecto existente con las nuevas versiones de tipo. Actualice para
ello la librería del proyecto.



Uso de librerías
Manual de programación y manejo, 11/2019

83

Actualizar los tipos de una librería
10.2 Actualizar tipos en un proyecto existente
Para integrar las nuevas versiones de tipo en la librería del proyecto, proceda del siguiente
modo:
1. Abra la librería global sin protección contra escritura.
Los tipos editados tienen una versión de tipo más alta que los tipos incluidos en la librería
del proyecto.
2. Haga clic en la carpeta "Tipos" de la librería global y elija el comando "Actualizar tipos >
Proyecto" del menú contextual.
La librería del proyecto se actualiza y las nuevas versiones de tipo están incluidas en ella.
Encontrará más información sobre la actualización de librerías aquí: Actualizar una librería con
los tipos de otra librería (Página 81)
En este momento, las nuevas versiones de tipo están incluidas en la librería del proyecto, pero
todavía no están referenciadas en el proyecto.

Procedimiento
Para referenciar automáticamente las nuevas versiones de tipo en el proyecto, estas deben
actualizarse en la administración de librerías.
Proceda del siguiente modo:
1. Haga clic en la carpeta "Tipos" de la librería del proyecto y abra la administración de
librerías.
2. Seleccione la entrada "Tipos con nuevas versiones para actualizar otros tipos" en la lista
desplegable del área "Tipos".
Se muestran todos los tipos para los que existe una nueva versión de tipo en la librería del
proyecto.
3. Haga clic en la carpeta "Tipos" con el botón derecho del ratón y seleccione la entrada
"Mostrar tipos actualizables" del menú contextual.
En la ficha "Actualización de tipos" se muestran todos los tipos referenciados.
4. En "Tipos que actualizar" seleccione una de las dos entradas:
– Solo con entorno de prueba
Se muestran todos los tipos que referencian una instancia en el entorno de prueba.
– Compatibles con el entorno de prueba seleccionado
Se muestran todos los tipos que pueden referenciar una instancia en el entorno de
prueba. Sin embargo, la instancia todavía no se ha creado.
5. Seleccione un entorno de prueba.
Al seleccionar un entorno de prueba se especifica el entorno de prueba en el que deben
actualizarse los tipos.
6. Ahora se muestran todos los tipos que deben actualizarse.
Nota
Visualización de tipos
La visualización de los tipos depende de la carpeta seleccionada en la administración de
librerías y de los ajustes realizados en la ficha "Actualización de tipos".

84

Uso de librerías
Manual de programación y manejo, 11/2019

Actualizar los tipos de una librería
10.3 Ejemplo de actualización de tipos
7. Haga clic en "Iniciar".
Tras una actualización correcta se abre el cuadro de diálogo "Actualización de tipos".
Nota
Estado "Error"
Si uno de los tipos que deben actualizarse tiene el estado "Error", no será posible iniciar la
actualización de los tipos. En este caso existen dos posibilidades:
1. Solucione el error y reinicie la actualización.
2. Actualice la vista de los tipos que sí pueden actualizarse volviendo a seleccionar la
entrada deseada en la lista desplegable de "Tipos que actualizar".
Ahora, todos los tipos referenciados tienen el estado "en prueba" en el árbol del proyecto
y en la librería del proyecto.
8. Compruebe los tipos "en prueba" y valídelos a continuación. Para ello también puede
utilizarse la administración de librerías.
9. Seleccione en este caso la entrada "Tipos con cambios pendientes" de la lista desplegable
y valide todos los tipos que se muestran.

Resultado
Ahora, todos los tipos del proyecto hacen referencia a la versión de tipo actual.

10.3

Ejemplo de actualización de tipos

Descripción
Dispone de una librería de proyecto cuyos tipos están referenciados entre sí de manera
distinta.

La función "BlockWithArrayStarIn_FC" es llamada por los dos bloques de función.
La función "BlockWithArrayStarIn_FC" debe perfeccionarse por separado fuera de la librería
de proyecto.

Uso de librerías
Manual de programación y manejo, 11/2019

85

Actualizar los tipos de una librería
10.3 Ejemplo de actualización de tipos

Requisitos
Se ha creado la librería del proyecto con todos los tipos relevantes.

Procedimiento
Para perfeccionar el tipo "BlockWithArrayStarIn_FC" por separado fuera de la librería de
proyecto, haga lo siguiente:
1. Copie el tipo de la librería del proyecto a una librería global para poder transferirlo.

Transfiere la versión V0.0.1 para desarrollarla.
2. El tipo "BlockWithArrayStarIn_FC" se ha procesado y validado. Se ha creado la nueva
versión V2.0.0 y se ha devuelto la librería global con la nueva versión de tipo:

86

Uso de librerías
Manual de programación y manejo, 11/2019

Actualizar los tipos de una librería
10.3 Ejemplo de actualización de tipos
Para integrar la nueva versión de la función en la librería del proyecto existente, haga lo
siguiente:
1. Haga clic en la carpeta "Tipos" de la librería global "Global_Library".
2. Elija el comando "Actualizar tipos > Proyecto" del menú contextual.
Se abre el cuadro de diálogo "Actualizar tipos en el proyecto".
3. Haga clic en "Aceptar".
La nueva versión de tipo V2.0.0 se ha integrado en la librería del proyecto.

Nota
Referenciar versión de tipo actual
En este momento, la nueva versión de tipo solo está disponible en la librería del proyecto.
Las instancias del árbol del proyecto siguen haciendo referencia a la versión de tipo antigua
V0.0.1.

Uso de librerías
Manual de programación y manejo, 11/2019

87

Actualizar los tipos de una librería
10.3 Ejemplo de actualización de tipos
Para actualizar las instancias a la nueva versión de tipo en el árbol del proyecto con un solo
paso, haga lo siguiente:
1. Haga clic en la carpeta "Tipos" de la librería del proyecto y abra la administración de
librerías.
2. Seleccione la entrada "Tipos con nuevas versiones para actualizar otros tipos" en la lista
desplegable del área "Tipos".
Se muestra la función que tiene una nueva versión de tipo que todavía no se utiliza en el
árbol del proyecto.

3. Haga clic en la carpeta "Tipos" y seleccione la entrada "Mostrar tipos actualizables" del
menú contextual.
La ficha "Actualización de tipos" se abre y se muestran todos los tipos que dependen
directamente del tipo modificado.

4. Para filtrar los tipos que deben actualizarse de acuerdo con un entorno de prueba,
seleccione la entrada "Solo con entorno de prueba" en "Tipos que actualizar".

88

Uso de librerías
Manual de programación y manejo, 11/2019

Actualizar los tipos de una librería
10.3 Ejemplo de actualización de tipos
5. Seleccione el entorno de prueba "PLC S7-1500".

Todos los tipos que pueden actualizarse tienen el estado "OK".
Si uno o varios de los tipos tiene el estado "Error", no será posible iniciar la actualización.
Solucione primero el error y repita los pasos 1 - 5.
6. Haga clic en "Iniciar".
Nota
actualizar con versiones de tipo indirectamente dependientes y no instanciadas
Si quiere actualizar un tipo referenciado por una o varias versiones de tipo que no están
instanciadas en el proyecto, tenga en cuenta los efectos de las posibles opciones de
actualización en la administración de librerías.
Si ha elegido la opción "Solo con entorno de prueba" y ha configurado un entorno de
prueba, podrá actualizar el tipo. En el caso de las versiones de tipo no instanciadas aparece
una advertencia; estas versiones de tipo no se actualizan.
Si ha elegido la opción "Compatibles con el entorno de prueba seleccionado" y ha
configurado un entorno de prueba, no podrá actualizar el tipo. En el caso de las versiones
de tipo no instanciadas aparece un mensaje de error; estas versiones de tipo impiden la
actualización.

Resultado
Todos los tipos referenciados se han actualizado a una nueva versión en la librería del
proyecto y en el árbol del proyecto y a todos se les ha agregado el complemento "en prueba".

Compruebe las nuevas versiones y valídelas a continuación.

Uso de librerías
Manual de programación y manejo, 11/2019

89

Actualizar los tipos de una librería
10.3 Ejemplo de actualización de tipos

90

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar textos de librerías
11.1

11

Exportar textos de librería

Descripción
Es posible exportar los textos de los elementos de librería para traducirlos y luego importarlos
nuevamente. Los datos se exportan a un archivo Office Open XML con la extensión ".xlsx".
Este tipo de archivo se puede editar en Microsoft Excel o en otros programas de hojas de
cálculo.
Los datos se pueden exportar de las maneras siguientes:
● Exportar textos de tipos y plantillas maestras seleccionadas
Se pueden seleccionar tipos o copias maestras individuales y exportar únicamente los
textos del objeto seleccionado con ayuda del menú contextual.
También es posible seleccionar y exportar varios o todos los tipos o copias maestras
mediante selección múltiple.
● Exportar textos de todos los elementos de la librería del proyecto o de una librería global
Los botones de la barra de herramientas de las paletas "Librería del proyecto" o "Librerías
globales" permiten exportar todos los textos de una librería de proyecto o de una librería
global.
Si hay varias versiones de un tipo, se exportarán los textos de la versión más actual.
Nota
Restricción en la exportación de textos de librería
Si la última versión de un tipo todavía no está validada y tiene la extensión "en prueba" o "en
proceso", no se exportará ningún texto de librería.
Nota
Limitación de filas en Microsoft Excel
Recuerde que los programas de hojas de cálculo pueden tener una limitación del número de
filas procesable. Microsoft Excel 2003 soporta, por ejemplo, 65536 filas como máximo. Las
nuevas versiones de Microsoft Excel soportan más filas.

Definición de los idiomas de origen y de destino en una librería de proyecto
En la librería del proyecto la selección de los idiomas de origen y de destino posibles depende
de los idiomas que se hayan definido como idiomas de proyecto.
Encontrará más información aquí: AUTOHOTSPOT

Uso de librerías
Manual de programación y manejo, 11/2019

91

Utilizar textos de librerías
11.1 Exportar textos de librería

Definición de los idiomas de origen y de destino en una librería global
En una librería global el usuario puede definir personalmente los idiomas de la librería siempre
que esta no esté protegida contra escritura.
La selección de los posibles idiomas se puede visualizar haciendo doble clic en la subcarpeta
"Idiomas de librería" de la carpeta "Idiomas y recursos". En una librería protegida contra
escritura los idiomas de la librería se muestran en la vista de librería en modo de lectura.
Encontrará más información aquí: Definir idiomas de librería (Página 32)

Requisitos
Active los idiomas de destino deseados:
● Para una librería del proyecto en los idiomas del proyecto
● Para una librería global en los idiomas de la librería

Exportación de textos de elementos de librería
Para exportar los textos de los elementos de librería seleccionados, proceda del siguiente
modo:
1. Seleccione los elementos de librería que desee (un elemento de librería solo, varios a la
vez, o una librería completa).
2. Haga clic con el botón derecho del ratón y elija en el menú contextual "Exportar textos de
librería" o haga clic en el botón "Exportar textos de librería" de la barra de herramientas.
Se abrirá el cuadro de diálogo "Exportar".

3. Elija el Idioma de origen deseado.

92

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar textos de librerías
11.2 Importar textos de librería
4. Elija los idiomas de destino deseados.
Si quiere exportar todos los idiomas de destino, elija la opción "Seleccionar todo".
5. Asigne al archivo de exportación el nombre que desee.
6. Ajuste la ruta deseada a la ubicación del archivo de exportación.
7. Haga clic en "Exportar".

Resultado
La exportación se ha completado correctamente y el archivo ".xlsx" se ha creado en la
ubicación indicada.

Escriba las traducciones inglesas en la columna "en-US" para poder importarlas a
continuación.

11.2

Importar textos de librería

Descripción
Tras la traducción externa en un programa de hojas de cálculo, importe los textos al TIA Portal.
En la librería del proyecto o en una librería global los textos se pueden importar de los
siguientes modos:
● Con la entrada "Importar textos de librería" del menú contextual
● Con el botón "Importar textos de librería"
Independientemente de cuántos elementos de librería se hayan seleccionado, se importarán
todos los textos del archivo de importación para toda la librería. Los elementos de librería del
archivo de importación deben coincidir con los elementos de la librería a la que deben
importarse los textos. Los idiomas de destino que se desean importar deben estar activados
en el proyecto o en la librería global.

Uso de librerías
Manual de programación y manejo, 11/2019

93

Utilizar textos de librerías
11.2 Importar textos de librería
Si importa textos para copias maestras, los textos ya existentes se sobrescribirán con los
textos nuevos. Si importa textos para tipos, solo los textos de la versión más actual se
sobrescribirán con los textos nuevos.
Nota
Restricción en la importación de textos de librería
No es posible importar textos de librería cuando se da uno de los casos siguientes:
● Los textos de librería forman parte de una instancia de tipo incluida en una plantilla maestra.
● En la librería del proyecto hay una versión de un tipo que todavía no está validada y tiene
la extensión "en prueba" o "en proceso".
● La librería global está protegida contra escritura.
● Se trata de una librería del sistema.
Nota
Importar textos de librería para un proyecto multiusuario
Para que también se importen textos de librería de objetos no marcados, en un proyecto
multiusuario los textos de librería deben importarse en la vista del proyecto de servidor.

Requisitos
Se han introducido las traducciones al idioma de destino deseado en el archivo de exportación.

Si quiere importar los textos de librería a una librería de^l proyecto, es necesario que los
idiomas de destino deseados estén activados en los idiomas del proyecto.
Si quiere importar los textos de librería a una librería global, es necesario que los idiomas de
destino deseados estén activados en la librería global.

Importar todos los textos de una librería de proyecto o de una librería global
Para importar todos los textos de librería traducidos, proceda del siguiente modo:
1. Seleccione la librería del proyecto o una librería global.
2. Haga clic con el botón derecho del ratón y elija en el menú contextual "Importar textos de
librería" o haga clic en el botón "Importar textos de librería" de la barra de herramientas.
Se abrirá el cuadro de diálogo "Importar".
3. Seleccione el archivo que quiere importar.
4. También es posible importar el idioma de origen activando la opción "Importar idioma de
origen".
5. Haga clic en "Importar".
Después de la importación se abre el cuadro de diálogo "Importación finalizada".

94

Uso de librerías
Manual de programación y manejo, 11/2019

Utilizar textos de librerías
11.3 Definición de idiomas del proyecto de la librería del proyecto

Resultado
● La importación ha finalizado correctamente:
Tras una importación correcta, la versión de tipo más reciente contiene los textos
traducidos.
● La importación ha finalizado con advertencias:
El motivo del error se mostrará directamente en el cuadro de diálogo; si no, puede hacer clic
en el enlace "Haga clic aquí para ver el archivo de informe" para ver las causas del error.
● Error al importar:
Encontrará el informe con las causas del error en el enlace "Haga clic aquí para ver el
archivo de informe".

11.3

Definición de idiomas del proyecto de la librería del proyecto
Todos los idiomas del proyecto definidos también están disponibles en la librería del proyecto.
Puede definir y modificar los idiomas del proyecto de forma centralizada para toda la librería
del proyecto. En este caso, todos los cambios realizados en los idiomas del proyecto se aplican
en todos los tipos y plantillas maestras nuevos y existentes de la librería del proyecto.
No obstante, también puede cambiar los idiomas del proyecto para una sola versión de tipo,
sin que ello repercuta en el resto de la librería del proyecto.

Procedimiento
Para definir los idiomas del proyecto para toda la librería del proyecto, haga lo siguiente:
1. Abra o edite un tipo o una plantilla maestra.
2. Abra la Task Card "Tareas".
3. En "Idiomas y recursos", elija otro idioma del proyecto de entre los idiomas de edición
existentes o haga clic en "Agregar idioma de edición".
4. Si hace clic en "Agregar idioma de edición", se mostrará la lista de todos los idiomas de
proyecto disponibles.
5. Seleccione el idioma de edición deseado.

Procedimiento
Para definir los idiomas del proyecto para una sola versión de tipo, haga lo siguiente:
1. Seleccione la versión de tipo que corresponda en la librería del proyecto.
2. En la barra de menús, seleccione el comando "Herramientas > Idiomas del proyecto".
Se abre la lista de todos los idiomas de proyecto disponibles.
3. Seleccione el idioma de edición deseado.

Resultado
La librería del proyecto o la versión de tipo tienen los idiomas del proyecto o de edición
deseados.
Uso de librerías
Manual de programación y manejo, 11/2019

95

Utilizar textos de librerías
11.4 Actualización de los textos de librerías importados en las instancias del tipo

11.4

Actualización de los textos de librerías importados en las instancias
del tipo
Si exporta textos de versiones del tipo y después los importa a la misma versión del tipo, las
modificaciones que haya realizado no se mostrarán en las instancias del tipo. Debido a que las
versiones del tipo y la instancia son idénticas, p. ej., V 0.0.1, al actualizar el proyecto o la librería
no se detectarán las modificaciones del texto.

Mostrar en el proyecto los textos importados de la librería del proyecto
Para mostrar en el proyecto los textos importados de la librería del proyecto se dispone de las
siguientes opciones:
● Borre la instancia del proyecto y cree después otra instancia de la misma versión en el
proyecto con la función de arrastrar y colocar. Este procedimiento es necesario cuando se
quieren ver los textos importados en otro dispositivo u objeto del proyecto.
● Importe los textos modificados directamente a las instancias del proyecto. Cree para ello
versiones de test de los tipos en la librería del proyecto. Exporte los textos de las versiones
de test con la función "Exportar textos del proyecto" del menú "Herramientas". Una vez que
haya modificado los textos en el archivo de Microsoft Excel exportado, importe los textos
con la función "Importar textos del proyecto" del menú "Herramientas".

Mostrar los textos importados de las librerías globales
Las modificaciones de los textos importados de las librerías globales pueden mostrarse en la
librería del proyecto o en una instancia del proyecto. Cree para ello una nueva versión del
objeto importado, p. ej., V 0.0.2. Para ver los textos importados dispone de las siguientes
opciones:
● Para ver los textos importados en la librería del proyecto, actualice la librería. Para ello abra
el menú contextual del objeto y elija el comando de menú "Actualizar tipos > Librería".
● Para ver los textos importados en el proyecto, actualice el proyecto. Para ello abra el menú
contextual del objeto y elija el comando de menú "Actualizar tipos > Proyecto".

96

Uso de librerías
Manual de programación y manejo, 11/2019

Crear carpetas en una librería

12

Dentro de las librerías, los elementos de librería se guardan en las carpetas "Tipos" y "Plantillas
maestras" dependiendo de qué tipo sean. Para agregar más plantillas maestras y tipos, se
deben crear más carpetas debajo de "Tipos" y "Plantillas maestras".

Requisitos
● Se visualiza la Task Card "Librerías" o se abre la vista de librería.
● Si desea crear carpetas nuevas dentro de una librería global, esta debe estar abierta con
derechos de escritura.

Procedimiento
Para crear una carpeta nueva, proceda del siguiente modo:
1. Haga clic con el botón derecho del ratón en una carpeta cualquiera de la librería.
2. Elija el comando "Agregar carpeta" del menú contextual.
Se crea una carpeta nueva.
3. Introduzca un nombre para la carpeta.

Consulte también
Filtrar plantillas maestras (Página 47)
Trabajar con tipos en la librería del proyecto (Página 54)

Uso de librerías
Manual de programación y manejo, 11/2019

97

Crear carpetas en una librería

98

Uso de librerías
Manual de programación y manejo, 11/2019

Editar elementos de librería

13

Dentro de la Task Card "Librerías" o en la vista de librería es posible cortar, copiar, pegar,
desplazar, cambiar de nombre o borrar tipos, plantillas maestras y carpetas del modo habitual.
Las librerías globales deben estar abiertas con derechos de escritura para realizar los
procesos mencionados.
Nota
Documentación definida por el usuario para tipos y plantillas maestras
La documentación definida por el usuario no se ve afectada por las operaciones realizadas en
la librería. Si se mueve una plantilla maestra o un tipo a otra ubicación, debe moverse también
la documentación definida por el usuario correspondiente manualmente a la ubicación en
cuestión en el sistema de archivos.
Encontrará más ayuda sobre el uso de la documentación definida por el usuario en el capítulo
"AUTOHOTSPOT".

Copiar tipos
Si se copia un tipo en el portapapeles rigen las reglas siguientes:
● Los tipos siempre se copian en el portapapeles con todas las versiones correspondientes.
Sin embargo, solo se copian versiones que ya están habilitadas.
● Los tipos siempre se copian en el portapapeles con todos los elementos dependientes.
● Las plantillas maestras siempre se copian en el portapapeles junto con las versiones de
tipos utilizadas en ellas.

Copiar y pegar versiones de tipos
Si se copian versiones de tipos y se pegan en otra librería, los tipos deben existir ya en la
librería de destino.

Cortar elementos
Los elementos de librería cortados solo se pueden insertar en la misma librería. Las plantillas
maestras solo se pueden insertar en la carpeta "Plantillas maestras" o en cualquier subcarpeta
de la misma y los tipos solo se pueden insertar en la carpeta "Tipos" o en cualquier subcarpeta
de la misma.

Pegar tipos
El proceso de pegar tipos en otra librería es igual al de una actualización de la librería de
destino.

Uso de librerías
Manual de programación y manejo, 11/2019

99

Editar elementos de librería

Si se ha pegado un tipo en otra librería, rigen las reglas siguientes:
● Un tipo siempre se pega con todas sus versiones.
● Si el tipo ya existe en la librería de destino, las versiones que todavía no están disponibles
en el tipo se añaden a la librería de destino.
● Si en la librería de destino ya existe una versión en estado habilitado, no se insertará
nuevamente la misma versión.
● Si la misma versión ya existe en la librería de destino en estado en test o edición, se
reemplazará por la versión habilitada.
● Si un tipo necesita otros tipos, estos se insertan también en la ubicación correspondiente.

Pegar plantillas maestras
Al pegar plantillas maestras también se insertarán todas las versiones de tipos utilizadas allí.
Si los tipos correspondientes ya existen en la librería, solo se complementarán las versiones
faltantes de los diferentes tipos. Si aún no existe uno de los tipos utilizados, este se insertará
en el nivel más alto de la librería. El tipo contiene la versión de tipo que se utilizaba en la plantilla
maestra.

Desplazar elementos
Si desplaza un elemento de una librería a otra, el elemento no se desplaza realmente, sino que
se copia. Se aplican las mismas reglas expuestas en "Pegar tipos" y "Pegar plantillas
maestras".

Borrar tipos y versiones de tipo
Al borrar tipos o versiones de tipo se debe tener en cuenta lo siguiente:
● Un tipo o una versión de tipo solo puede borrarse si no existen dependencias con otros
tipos.
● Al borrar un tipo también se borran todas las versiones del tipo.
● Si se borran todas versiones de un tipo, también se borrará el tipo.
● Si se borra una versión que contiene instancias en el proyecto, también se borrarán las
instancias del proyecto.
● Si se borra un tipo que está guardado al mismo tiempo como plantilla maestra, se borrará
también la plantilla maestra.

Borrar instancias
Si se borra una instancia que tiene dependencias con otras instancias, se restablecerá durante
la próxima compilación. La instancia se enlaza nuevamente con la versión de tipo original. Así
se restablece otra vez la coherencia del proyecto.

100

Uso de librerías
Manual de programación y manejo, 11/2019

Editar elementos de librería

Consulte también
Principios básicos de las librerías (Página 7)
Deshacer la conexión entre la instancia y el tipo (Página 70)
Actualizar una librería con los tipos de otra librería (Página 81)
Duplicado de tipos (Página 58)

Uso de librerías
Manual de programación y manejo, 11/2019

101

Editar elementos de librería

102

Uso de librerías
Manual de programación y manejo, 11/2019

Armonizar nombres y estructura de rutas

14

Es posible armonizar el proyecto con una librería. Esto permite corregir los puntos siguientes:
● Nombres de las instancias:
Durante la fase de desarrollo de una librería pueden surgir instancias cuyos nombres se
han corregido automáticamente con una extensión ("_1", "_2", etc.). La extensión se crea
para evitar nombres duplicados en el proyecto. En la armonización, las instancias reciben
de nuevo el nombre del tipo al que corresponden.
● Estructura de rutas:
Al desarrollar en paralelo o al copiar instancias dependientes es posible que se pierda la
estructura original de rutas. Este hecho perjudica la claridad del proyecto. En la
armonización, la estructura de rutas dentro del proyecto se adapta a la estructura de rutas
de la librería.

Procedimiento
Para armonizar los nombres y la estructura de rutas, proceda del siguiente modo:
1. Abra la administración de librerías.
2. Haga clic en "Armonizar proyecto" de la barra de herramientas.
Se abre el cuadro de diálogo "Armonizar proyecto".
3. Seleccione el dispositivo con el que desea armonizar la librería.
4. Si desea restablecer la estructura de rutas, active la casilla de verificación "Armonizar rutas
entre proyecto y librería".
5. Si desea corregir los nombres, active la casilla de verificación "Armonizar nombres entre
proyecto y librería".
6. Confirme las entradas con "Aceptar".

Resultado
Los nombres y la estructura de rutas del proyecto se armonizan con la librería dependiendo de
los ajustes realizados.
Los cambios realizados en el proyecto se registran en un informe. Encontrará el informe en
"Datos comunes > Informes" del árbol del proyecto.

Consulte también
Principios básicos de las librerías (Página 7)
Sinopsis de la vista de librerías (Página 17)
Sinopsis de la administración de librerías (Página 21)

Uso de librerías
Manual de programación y manejo, 11/2019

103

Armonizar nombres y estructura de rutas

104

Uso de librerías
Manual de programación y manejo, 11/2019

Comparación de elementos de librerías

15

Introducción
Se pueden comparar dispositivos de librerías con dispositivos del proyecto actual, con
dispositivos de la misma librería o de otras distintas o de proyectos de referencia. No obstante,
recuerde que los proyectos de referencia están protegidos contra escritura. También es
posible comparar instancias de un dispositivo con su versión de tipo de una librería. En la
comparación con tipos no están disponibles todas las acciones Por ejemplo, no es posible que
una versión de tipo anterior de la librería sobrescriba una instancia de una versión más
reciente.
Al comparar elementos de librerías se puede cambiar en todo momento entre la comparación
automática y la manual. Con algunos elementos de la librería también es posible realizar una
comparación detallada. Para ello dispone también de la comparación rápida.

Procedimiento
Para comparar elementos de librerías con los datos de dispositivo de un proyecto, proceda del
siguiente modo:
1. En el árbol del proyecto seleccione el dispositivo cuyos datos desea comparar con un
elemento de librería y que permita una comparación offline/offline.
2. Elija el comando "Comparar > Offline/offline" del menú contextual.
Se abre el editor de comparación y el dispositivo seleccionado se muestra en el área
izquierda.
3. Abra la Task Card "Librerías".
4. Arrastre la librería del proyecto, una librería global o dispositivos desde allí hasta la
superficie de arrastre derecha del editor de comparación.
Los símbolos del área de estado y acción indican el estado de los objetos. Si se selecciona
un objeto, sus propiedades y las del objeto correspondiente del dispositivo asignado se
muestran sinópticamente en la comparación de propiedades.
5. Si es necesario, inicie una comparación detallada de los elementos que soportan la
comparación detallada.
Consulte también: Ejecución de una comparación detallada
Tenga en cuenta las posibles restricciones para algunos elementos. Encontrará
información al respecto en los productos en cuestión.
En todo momento es posible arrastrar a las superficies de arrastre otros dispositivos o librerías
para iniciar una nueva comparación.

Consulte también
Uso de la vista de librerías (Página 17)
Principios básicos de las librerías (Página 7)
Sinopsis de la Task Card "Librerías". (Página 11)

Uso de librerías
Manual de programación y manejo, 11/2019

105

Comparación de elementos de librerías

Sinopsis de la vista de librerías (Página 17)
Utilizar la vista de elementos (Página 14)
Utilizar librerías globales (Página 29)

106

Uso de librerías
Manual de programación y manejo, 11/2019

Limpiar librería

16

Es posible limpiar la librería del proyecto y las librerías globales para eliminar tipos o versiones
que no están asociados a ninguna instancia del proyecto. De este modo se aumenta la claridad
dentro de las librerías y se reduce el tamaño de la librería.

Limpiar librería del proyecto
Para limpiar la librería del proyecto, proceda del siguiente modo:
1. Abra la administración de librerías.
2. Haga clic en "Limpiar librería" de la barra de herramientas.
Se abre el cuadro de diálogo "Limpiar librería del proyecto".
3. Seleccione los tipos o versiones de tipo que se borrarán:
– Para conservar la versión con el número más alto aunque esta no tenga ninguna
instancia, seleccione la opción "Borrar versiones de tipo antiguas y conservar la versión
de tipo más reciente".
– Para borrar el tipo completo si no hay ninguna versión asociada a una instancia,
seleccione la opción "Borrar tipos completos".
4. Confirme la entrada realizada con "Aceptar".
De la librería del proyecto se eliminarán las versiones de tipo no utilizadas o tipos
completos, dependiendo de la elección efectuada.
Los cambios realizados se registran en un informe. Encontrará el informe en "Datos
comunes > Informes" del árbol del proyecto.

Limpiar librería global
Para limpiar una librería global, proceda del siguiente modo:
1. Abra la librería global sin protección contra escritura.
2. Abra la administración de librerías.
3. Haga clic en "Limpiar librería" de la barra de herramientas.
Se abre el cuadro de diálogo "Limpiar librería global".
4. Haga clic en "Aceptar".
Se borran las versiones de tipo no utilizadas. Se conserva siempre la versión más reciente
de un tipo.
Los cambios realizados se registran en un informe. Encontrará el informe en la carpeta
"Datos comunes > Informes" de la librería global.

Consulte también
Principios básicos de las librerías (Página 7)
Sinopsis de la vista de librerías (Página 17)

Uso de librerías
Manual de programación y manejo, 11/2019

107

Limpiar librería

Sinopsis de la administración de librerías (Página 21)
Mostrar los informes de las librerías globales (Página 34)

108

Uso de librerías
Manual de programación y manejo, 11/2019

Índice alfabético
A
Actualizar librería, 81
Actualizar tipos a la versión más reciente, 81
Administración de librerías
Abrir, 24
Filtrar por tipos no habilitados, 25
Sinopsis, 21
Visualizar instancias de versiones de tipo, 26
Visualizar referencias cruzadas de una
instancia, 26
Visualizar relaciones entre objetos de
librerías, 27

C
Comparación de objetos de librería, 8

E
Editar la versión de un tipo en prueba, 63

I
Instancia
Generar instancia, 60
Mostrar tipos asociados, 61

L
Librería
Abrir una versión de tipo habilitada, 53
Agregar plantilla maestra, 46
Armonizar nombres y estructura de rutas, 103
Borrar instancias, 100
Borrar tipos y versiones, 100
Comparación de elementos de librerías, 105
Copiar tipos en el portapapeles, 99
Cortar elementos de librería, 99
Cortar plantillas maestras, 99
Cortar tipos, 99
Crear carpetas, 97
Desplazar elementos de librería, 100
Limpiar, 107
Pegar plantillas maestras del portapapeles, 100
Pegar tipos del portapapeles, 99

Uso de librerías
Manual de programación y manejo, 11/2019

Plantillas maestras, 7
Principios básicos, 7
Tipos, 7
Utilización de tipos, 49
Utilizar la vista de filtro, 47
Utilizar plantillas maestras, 45, 48
Versión de tipo en prueba, 51
Versión de tipo habilitada, 52
Versionamiento de tipos, 49
Librería del proyecto, 7
Actualizar proyecto, 69
Agregar tipos, 55
Asignar una versión común a los tipos, 75
Comprobar la coherencia de una versión de
tipo, 64
Crear carpetas, 97
Duplicado de tipos, 58
Habilitar todas las versiones, 68
Habilitar versiones de tipos, 66
Limpiar, 107
Rechazar todas las versiones, 66
Rechazar versión de tipo, 65
Uso de tipos, 60
Utilizar la vista de filtro, 47
Librería global
Abrir, 31
Actualizar proyecto, 74
Agregar tipos, 71
Archivar, 38
Borrar, 36
Cerrar, 35
Crear, 29
Crear carpetas, 97
Guardar, 34
Limpiar, 107
Mostrar las propiedades, 33
Uso de tipos, 73
Utilizar la vista de filtro, 47
Visualizar informes, 34
Librería global con protección contra escritura
Crear, 30
Librería global protegida contra escritura
Crear, 30
Librerías
Mostrar columnas, 15
Librerías de empresa, 8
Librerías de usuario, 8
Librerías del sistema, 8

109

Índice alfabético

Librerías globales, 8
Archivar, 37
Compatibilidad con versiones anteriores del
producto, 31
Desarchivar, 39
Librerías de empresa, 8
Librerías de usuario, 8
Librerías del sistema, 8

M
Mostrar tipos de una instancia, 61

P
Proyecto
Armonizar, 103

T
Tipo
Creación de instancias, 73
Mostrar propiedades de un tipo, 53
Mostrar propiedades de una versión, 53
Tipos
Copiar usos, 60
Creación de instancias, 60
Pegar usos, 60
Uso de tipos, 60

V
Versionamiento de tipos
Versión en prueba, 51
Versión habilitada, 52
Vista de librería
Abrir, 20
Salir, 20
Sinopsis, 17

110

Uso de librerías
Manual de programación y manejo, 11/2019

Edición de dispositivos y redes
Manual de programación y manejo

11/2019

Configuración de dispositivos
y redes

1

Diagnosticar dispositivos y
redes

2

Notas jurídicas
Filosofía en la señalización de advertencias y peligros

Este manual contiene las informaciones necesarias para la seguridad personal así como para la prevención de
daños materiales. Las informaciones para su seguridad personal están resaltadas con un triángulo de advertencia;
las informaciones para evitar únicamente daños materiales no llevan dicho triángulo. De acuerdo al grado de peligro
las consignas se representan, de mayor a menor peligro, como sigue.
PELIGRO
Significa que, si no se adoptan las medidas preventivas adecuadas se producirá la muerte, o bien lesiones
corporales graves.
ADVERTENCIA
Significa que, si no se adoptan las medidas preventivas adecuadas puede producirse la muerte o bien lesiones
corporales graves.
PRECAUCIÓN
Significa que si no se adoptan las medidas preventivas adecuadas, pueden producirse lesiones corporales.
ATENCIÓN
Significa que si no se adoptan las medidas preventivas adecuadas, pueden producirse daños materiales.
Si se dan varios niveles de peligro se usa siempre la consigna de seguridad más estricta en cada caso. Si en una
consigna de seguridad con triángulo de advertencia de alarma de posibles daños personales, la misma consigna
puede contener también una advertencia sobre posibles daños materiales.

Personal cualificado

El producto/sistema tratado en esta documentación sólo deberá ser manejado o manipulado por personal
cualificado para la tarea encomendada y observando lo indicado en la documentación correspondiente a la misma,
particularmente las consignas de seguridad y advertencias en ella incluidas. Debido a su formación y experiencia,
el personal cualificado está en condiciones de reconocer riesgos resultantes del manejo o manipulación de dichos
productos/sistemas y de evitar posibles peligros.

Uso previsto de los productos de Siemens
Considere lo siguiente:
ADVERTENCIA
Los productos de Siemens sólo deberán usarse para los casos de aplicación previstos en el catálogo y la
documentación técnica asociada. De usarse productos y componentes de terceros, éstos deberán haber sido
recomendados u homologados por Siemens. El funcionamiento correcto y seguro de los productos exige que su
transporte, almacenamiento, instalación, montaje, manejo y mantenimiento hayan sido realizados de forma
correcta. Es preciso respetar las condiciones ambientales permitidas. También deberán seguirse las indicaciones
y advertencias que figuran en la documentación asociada.

Marcas registradas

Todos los nombres marcados con ® son marcas registradas de Siemens AG. Los restantes nombres y
designaciones contenidos en el presente documento pueden ser marcas registradas cuya utilización por terceros
para sus propios fines puede violar los derechos de sus titulares.

Exención de responsabilidad

Hemos comprobado la concordancia del contenido de esta publicación con el hardware y el software descritos. Sin
embargo, como es imposible excluir desviaciones, no podemos hacernos responsable de la plena concordancia. El
contenido de esta publicación se revisa periódicamente; si es necesario, las posibles correcciones se incluyen en
la siguiente edición.

Siemens AG
Digital Industries
Postfach 48 48
90026 NÜRNBERG
ALEMANIA

Ⓟ 11/2019 Sujeto a cambios sin previo aviso

Copyright © Siemens AG 2019.
Reservados todos los derechos

Índice
1

Configuración de dispositivos y redes ..........................................................................................................9
1.1
1.1.1
1.1.2
1.1.3
1.1.4
1.1.5
1.1.6
1.1.7
1.1.8
1.1.9
1.1.10
1.1.11
1.1.12
1.1.13
1.1.14
1.1.15
1.1.16
1.1.17
1.1.18

Editor de hardware y redes ......................................................................................................9
Resumen del editor de hardware y redes ................................................................................9
Resumen de los ajustes de la configuración hardware..........................................................10
Vista de redes ........................................................................................................................11
Vista de dispositivos...............................................................................................................14
Vista de dispositivos: objetos de la vista de dispositivos .......................................................17
Vista de dispositivos: ubicación de los módulos no enchufados............................................20
Vista topológica......................................................................................................................21
Ventana de inspección...........................................................................................................24
Ventana de inspección: representación de UDT....................................................................27
Catálogo de hardware............................................................................................................29
Examinar el catálogo de hardware.........................................................................................32
Activar el soporte del producto...............................................................................................34
Mostrar el soporte del producto para componentes de hardware..........................................34
Imprimir configuraciones de hardware y redes ......................................................................35
Imprimir: modificar los ajustes................................................................................................37
Imprimir: activar la vista preliminar del salto de página .........................................................37
Comandos de teclado: navegación en el editor .....................................................................38
Comandos de teclado: editar objetos.....................................................................................39

1.2
1.2.1
1.2.2
1.2.3
1.2.4
1.2.5
1.2.6
1.2.7
1.2.8
1.2.9
1.2.10
1.2.11
1.2.12
1.2.13
1.2.14
1.2.15
1.2.16
1.2.17
1.2.18
1.2.19
1.2.19.1
1.2.19.2

Configurar dispositivos...........................................................................................................40
Introducción a la configuración de hardware .........................................................................40
Agregar un dispositivo a la configuración de hardware .........................................................41
Agregar una CPU sin especificar ...........................................................................................43
Seleccionar una CPU.............................................................................................................44
Seleccionar módulos de seguridad ........................................................................................46
Rack: Principios básicos ........................................................................................................47
Rack: Reglas generales para los slots...................................................................................48
Rack: Enchufar módulo..........................................................................................................49
Seleccionar un componente de hardware..............................................................................52
Copiar un componente de hardware......................................................................................56
Desplazar un componente de hardware ................................................................................57
Sustituir un componente de hardware ...................................................................................59
Cambiar el nombre de un componente de hardware.............................................................59
Borrar un componente de hardware ......................................................................................61
Cambiar o actualizar componentes de hardware...................................................................62
Editar las propiedades y los parámetros................................................................................63
Direcciones de entrada y salida en la vista de direcciones....................................................65
Periferia descentralizada en el árbol del proyecto .................................................................69
Comparar dispositivos............................................................................................................71
Principios básicos de la comparación de dispositivos ...........................................................71
Realizar una comparación de dispositivos.............................................................................72

1.3
1.3.1
1.3.1.1

Configurar redes ....................................................................................................................73
Conectar dispositivos en red..................................................................................................73
Comunicación y redes............................................................................................................73

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

3

Índice

4

1.3.1.2
1.3.1.3
1.3.1.4
1.3.1.5
1.3.1.6
1.3.1.7
1.3.1.8
1.3.1.9
1.3.1.10
1.3.2
1.3.2.1
1.3.2.2
1.3.2.3
1.3.2.4
1.3.3
1.3.3.1
1.3.3.2
1.3.3.3
1.3.3.4
1.3.4
1.3.4.1
1.3.4.2
1.3.5
1.3.5.1
1.3.5.2
1.3.5.3

Conectar dispositivos en red en la vista de redes..................................................................74
Área de tabla de la vista general de redes.............................................................................78
Conectar dispositivos en red en la vista de dispositivos ........................................................78
Comprobar o modificar los parámetros de red o interfaz.......................................................80
Modificar conexiones en red ..................................................................................................81
Copiar, cortar o borrar subredes ............................................................................................82
Configuración de redes PROFINET/Industrial Ethernet.........................................................83
Configuración de red PROFIBUS ........................................................................................100
Configuración de red MPI ....................................................................................................107
Comunicación vía conexiones .............................................................................................108
Trabajar con conexiones......................................................................................................108
Conexiones - significado y selección ...................................................................................211
Configuración de conexiones...............................................................................................231
Tipos de conexión ................................................................................................................259
Mostrar y configurar topología .............................................................................................314
Sinopsis de la vista topológica .............................................................................................314
Iniciar la vista topológica ......................................................................................................317
Mostrar topología .................................................................................................................317
Configurar topología.............................................................................................................324
Industrial Ethernet Security ..................................................................................................333
Configuración de la seguridad .............................................................................................333
Configuración de la seguridad para SCALANCE S-600 ......................................................560
Secure communication.........................................................................................................744
Principios básicos de secure communication ......................................................................744
Ajustes globales de seguridad .............................................................................................764
Secure Open User Communication .....................................................................................773

1.4
1.4.1
1.4.1.1
1.4.1.2
1.4.1.3
1.4.1.4
1.4.1.5
1.4.1.6
1.4.1.7
1.4.1.8
1.4.1.9
1.4.1.10
1.4.1.11
1.4.1.12
1.4.1.13
1.4.1.14
1.4.1.15
1.4.1.16
1.4.1.17
1.4.2
1.4.2.1
1.4.2.2
1.4.2.3
1.4.2.4
1.4.2.5
1.4.2.6

Crear configuraciones ..........................................................................................................788
Configuración de sistemas de automatización.....................................................................788
Funcionamiento de las CPUs S7-300/400 ...........................................................................788
Funcionamiento de las CPU S7-1500..................................................................................987
Funcionamiento de las CPU S7-1500R/H..........................................................................1137
Principle of operation of SIMATIC Drive Controllers ..........................................................1184
Configuración de módulos centrales..................................................................................1240
Reglas para módulos .........................................................................................................1241
Reglas para módulos .........................................................................................................1242
Reglas para módulos .........................................................................................................1243
Seleccionar módulos centrales ..........................................................................................1252
Seleccionar módulos de seguridad ....................................................................................1254
Modificar las propiedades de los módulos centrales .........................................................1255
Acoplamiento de racks.......................................................................................................1256
Acoplamiento de racks.......................................................................................................1258
Direccionar módulos ..........................................................................................................1261
Conceptos de automatización flexibles..............................................................................1278
Uso de la comunicación OPC UA ......................................................................................1293
Configuración del servidor web..........................................................................................1457
Configuración de sistemas de automatización...................................................................1505
Funcionamiento de CPUs S7-1200....................................................................................1505
Direccionar módulos ..........................................................................................................1597
Signal Board.......................................................................................................................1601
Configuraciones para el servidor web................................................................................1602
Control de configuración (configuración futura) para dispositivos .....................................1638
Configuraciones adicionales ..............................................................................................1649

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Índice

1.4.3
1.4.3.1
1.4.3.2
1.4.4
1.4.4.1
1.4.5
1.4.5.1
1.4.6
1.4.6.1
1.4.7
1.4.7.1
1.4.8
1.4.8.1
1.4.8.2
1.4.8.3
1.4.8.4
1.4.8.5
1.4.8.6
1.4.8.7
1.4.8.8
1.4.8.9
1.4.8.10
1.4.8.11
1.4.8.12
1.4.9
1.4.9.1
1.4.9.2
1.4.9.3
1.4.9.4
1.4.9.5
1.4.9.6
1.4.9.7
1.4.9.8
1.4.10
1.4.10.1
1.4.10.2
1.4.10.3
1.4.10.4
1.4.11
1.4.11.1
1.4.11.2
1.4.12
1.4.12.1
1.4.12.2
1.4.13
1.4.13.1
1.4.13.2
1.4.13.3

Configuración de CP y aplicaciones para estaciones PC ..................................................1649
CP para estación PC 1.0....................................................................................................1649
Aplicaciones para estación PC 1.0 ....................................................................................1669
Configuraciones para acoplamientos punto a punto (S7-1500).........................................1700
Configuraciones para acoplamientos punto a punto..........................................................1700
Configuraciones para acoplamientos punto a punto (S7-300, S7-400) .............................1756
Configuraciones para acoplamientos punto a punto..........................................................1756
TeleControl.........................................................................................................................1885
Configuración de módulos de Telecontrol..........................................................................1885
SCALANCE X, W y M ........................................................................................................2184
Configuración de SCALANCE X/W/M................................................................................2184
Configuración de PROFIBUS DP.......................................................................................3002
Configurar la periferia descentralizada ..............................................................................3002
Principios básicos sobre la configuración de un sistema maestro DP...............................3002
Esclavos DP en el catálogo de hardware ..........................................................................3004
Acopladores DP/DP en el catálogo de hardware...............................................................3004
Configuraciones con PROFIBUS DP .................................................................................3005
Configurar sistemas de periferia descentralizada ..............................................................3009
Ejemplo: Configurar un ET 200S como esclavo DP ..........................................................3020
Configurar esclavos DP inteligentes ..................................................................................3031
Configurar la comunicación directa....................................................................................3043
Utilizar archivos GSD .........................................................................................................3051
Utilizar PROFIBUS DPV1 ..................................................................................................3055
Equidistancia y sincronismo...............................................................................................3067
Configuración de PROFIBUS DP.......................................................................................3086
Principios básicos sobre la configuración de un sistema maestro DP...............................3086
Esclavos DP en el catálogo de hardware ..........................................................................3086
Acopladores DP/DP en el catálogo de hardware...............................................................3087
Configuraciones con PROFIBUS DP .................................................................................3087
Configuración de sistemas de periferia descentralizada....................................................3089
Configurar esclavos DP inteligentes ..................................................................................3098
Configurar esclavos DP de la periferia descentralizada ....................................................3100
Utilizar archivos GSD .........................................................................................................3109
Configuración de PROFINET IO ........................................................................................3113
Información importante sobre PROFINET IO ....................................................................3113
Configurar PROFINET IO ..................................................................................................3119
Uso de archivos GSD.........................................................................................................3168
Configuraciones especiales PROFINET ............................................................................3174
Acoplamiento de bus con acoplador PN/PN ......................................................................3330
Campo de aplicación y función ..........................................................................................3330
Acoplar subredes Ethernet.................................................................................................3331
Integración de herramientas externas................................................................................3332
Integración de herramientas externas a S7 .......................................................................3332
Inicio de SIMATIC S7-PCT ................................................................................................3333
Cargar la configuración ......................................................................................................3334
Introducción a la carga de una configuración ....................................................................3334
Carga de una configuración en un dispositivo ...................................................................3334
Carga de una configuración en la PG/el PC ......................................................................3335

1.5
1.5.1
1.5.2
1.5.3

Mostrar avisos....................................................................................................................3346
Sinopsis del visor de avisos ...............................................................................................3346
Vista "Avisos actuales".......................................................................................................3347
Estructura de los avisos en la vista "Avisos actuales" .......................................................3347

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

5

Índice

2

1.5.4
1.5.5
1.5.6
1.5.7
1.5.8
1.5.9
1.5.10
1.5.11
1.5.12
1.5.13
1.5.14

Fichero de avisos ...............................................................................................................3348
Estructura de los avisos en el fichero de avisos ................................................................3348
Vaciar por completo el fichero de avisos ...........................................................................3349
Exportar el fichero ..............................................................................................................3349
Recibir avisos.....................................................................................................................3350
Congelar avisos .................................................................................................................3351
Acusar avisos.....................................................................................................................3351
Estado de los avisos ..........................................................................................................3351
Ordenar una tabla en el visor de avisos.............................................................................3352
Filtrar tablas en el visor de avisos......................................................................................3353
Manejo del teclado en el visor de avisos ...........................................................................3353

1.6
1.6.1
1.6.1.1
1.6.1.2
1.6.1.3
1.6.1.4
1.6.1.5
1.6.1.6
1.6.1.7
1.6.2
1.6.2.1
1.6.2.2
1.6.3
1.6.3.1
1.6.3.2
1.6.3.3
1.6.3.4
1.6.3.5
1.6.3.6
1.6.3.7
1.6.3.8
1.6.3.9
1.6.3.10
1.6.4
1.6.5
1.6.5.1
1.6.5.2

Información adicional sobre configuraciones .....................................................................3354
Módulos de comunicación y componentes de red .............................................................3354
Industrial Ethernet / PROFINET.........................................................................................3354
Industrial Ethernet ..............................................................................................................3420
CP PROFIBUS...................................................................................................................3435
CM/CP PROFIBUS ............................................................................................................3439
Ajustes de CP independientes de protocolo o de red ........................................................3440
Aclaración sobre conexiones .............................................................................................3442
IE/PB Link PN IO................................................................................................................3449
Sistemas de identificación..................................................................................................3453
Sistemas RFID ...................................................................................................................3453
Sistemas de lectura ópticos ...............................................................................................3481
Periferia descentralizada....................................................................................................3483
Sistemas de periferia descentralizada ...............................................................................3483
Configuración de variables HART......................................................................................3487
ET 200iSP ..........................................................................................................................3488
ET 200eco PN....................................................................................................................3502
ET 200SP...........................................................................................................................3508
ET 200AL ...........................................................................................................................3551
ET 200MP ..........................................................................................................................3567
ET 200M.............................................................................................................................3580
ET 200S .............................................................................................................................3590
ET 200pro ..........................................................................................................................3591
Routing IPv4 con CP 154x-1 / CM 1542-1 .........................................................................3599
Configuración IPv6.............................................................................................................3599
Protocolo IPv6....................................................................................................................3599
IPv6 en el CP 154x-1 .........................................................................................................3600

Diagnosticar dispositivos y redes ...........................................................................................................3601
2.1
2.1.1
2.1.1.1
2.1.1.2
2.1.1.3
2.1.1.4
2.1.1.5
2.1.2
2.1.2.1
2.1.2.2
2.1.2.3

6

Diagnosticar hardware .......................................................................................................3601
Resumen del diagnóstico de hardware..............................................................................3601
Posibilidades generales para diagnosticar el hardware.....................................................3601
Determinar los dispositivos defectuosos que están conectados online .............................3602
Mostrar el estado de diagnóstico y de comparación mediante iconos...............................3603
Iniciar la vista online y de diagnóstico................................................................................3611
Activar la Task Card "Herramientas online" .......................................................................3613
Mostrar valores actuales y no modificables de propiedades de módulos parametrizables..3613
Mostrar propiedades generales e información relevante para la instalación relacionadas
con un módulo....................................................................................................................3613
Mostrar los tiempos de ciclo parametrizados.....................................................................3615
Mostrar interfaces y propiedades de interfaces de un módulo ..........................................3615

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Índice

2.1.2.4
2.1.2.5
2.1.2.6
2.1.2.7
2.1.3
2.1.3.1
2.1.3.2
2.1.3.3
2.1.3.4
2.1.4
2.1.4.1
2.1.4.2
2.1.4.3
2.1.4.4
2.1.4.5
2.1.5
2.1.5.1
2.1.5.2
2.1.5.3
2.1.5.4
2.1.5.5
2.1.5.6
2.1.5.7
2.1.5.8
2.1.5.9
2.1.5.10
2.1.5.11
2.1.5.12
2.1.6
2.1.6.1
2.1.6.2
2.1.7
2.1.7.1
2.1.7.2
2.1.7.3
2.1.7.4
2.1.8
2.1.8.1
2.1.8.2
2.1.8.3

Mostrar controladores IO que accedan a módulos de un Shared Device..........................3617
Visualización de las propiedades del dominio Sync de un dispositivo PROFINET ...........3618
Visualización de las propiedades del dominio MRP de un dispositivo PROFINET ...........3619
Ver el firmware actual de un módulo..................................................................................3620
Mostrar valores actuales de propiedades de módulos dinámicas .....................................3620
Mostrar los tiempos de ciclo medidos ................................................................................3620
Mostrar el estado actual de los LEDs de una CPU............................................................3621
Mostrar el nivel de llenado de todos los tipos de memoria de una CPU............................3622
Visualización del nivel de llenado de todos los tipos de memoria de una CPU S7-1500 ..3623
Comprobar los fallos de un módulo ...................................................................................3624
Determinar el estado de diagnóstico de un módulo...........................................................3624
Efectuar un diagnóstico de comunicación de los puertos PROFINET...............................3625
Diagnosticar componentes de PROFINET IO....................................................................3626
Leer el búfer de diagnóstico de una CPU ..........................................................................3627
Guardar datos de servicio ..................................................................................................3631
Modificar las propiedades de un módulo o de la PG/el PC................................................3632
Cambiar el estado operativo de una CPU..........................................................................3632
Ejecutar un borrado total....................................................................................................3633
Determinar y ajustar la hora de una CPU ..........................................................................3634
Restablecer la configuración de fábrica de una CPU S7-1200..........................................3634
Restablecer la configuración de fábrica de una CPU S7-1500..........................................3635
Restablecer la configuración de fábrica de un dispositivo PROFINET IO .........................3636
Formateado de una Memory Card S7-1500 ......................................................................3637
Actualizar el firmware de un módulo ..................................................................................3638
Asignación de una dirección IP a un dispositivo PROFINET IO ........................................3641
Asignar nombre de dispositivo PROFINET........................................................................3643
Calibración de un módulo analógico S7-1500 ...................................................................3647
Cargar datos I&M en dispositivos PROFINET-IO y sus módulos ......................................3650
Diagnóstico en estado operativo STOP .............................................................................3652
Principios básicos del búfer de diagnóstico .......................................................................3652
Determinar la causa de STOP de una CPU.......................................................................3653
Accesos online en la vista online y de diagnóstico ............................................................3654
Ver el estado de la conexión online ...................................................................................3654
Definir interfaz PG/PC, establecer conexión online ...........................................................3654
Deshacer la conexión online ..............................................................................................3656
Realizar el test de parpadeo con un dispositivo conectado online ....................................3656
Comprobar fallos en subredes PROFIBUS DP..................................................................3657
Principios básicos del repetidor de diagnóstico .................................................................3657
Visualizar el estado del diagnóstico de segmento mediante iconos ..................................3658
Visualizar el estado del diagnóstico de segmento mediante gráficos y texto ....................3659

2.2
2.2.1
2.2.2
2.2.3
2.2.3.1
2.2.3.2
2.2.3.3
2.2.3.4
2.2.3.5

Diagnosticar conexiones ....................................................................................................3660
Vista general del diagnóstico de conexiones .....................................................................3660
Ver el estado de conexión mediante iconos ......................................................................3661
Diagnosticar conexiones detalladamente ..........................................................................3662
Diagnosticar conexiones detalladamente - Resumen........................................................3662
Determinación de recursos de conexión online con S7-1200............................................3663
Determinación de recursos de conexión online con S7-1500............................................3664
Determinar los detalles de conexión ..................................................................................3664
Determinar los detalles de dirección de una conexión.......................................................3665

2.3
2.3.1

Diagnosticar el servidor OPC UA.......................................................................................3666
Requisitos ..........................................................................................................................3666

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

7

Índice

2.3.2
2.3.3

Visualizar información de estado general del servidor OPC UA........................................3666
Visualizar información de estado de las sesiones OPC UA...............................................3667

2.4
2.4.1
2.4.2
2.4.3
2.4.4
2.4.5
2.4.6
2.4.7
2.4.8
2.4.9
2.4.9.1
2.4.9.2
2.4.9.3
2.4.9.4
2.4.10

Diagnóstico del sistema con 'Report System Errors' .........................................................3670
Introducción al diagnóstico del sistema con "Report System Errors" ................................3670
Principios básicos del diagnóstico del sistema ..................................................................3670
Módulos con posibilidades de diagnóstico limitadas..........................................................3671
Bloques de diagnóstico para notificar errores de sistema .................................................3673
Propiedades de los bloques...............................................................................................3673
OBs de error soportados....................................................................................................3674
DB de estado de diagnóstico .............................................................................................3676
Visualización de los ajustes del diagnóstico del sistema ...................................................3679
Configuración .....................................................................................................................3680
Configuración general ........................................................................................................3680
Ajustes de avisos ...............................................................................................................3680
Configuración del soporte de diagnóstico ..........................................................................3680
Ajustes para los bloques de diagnóstico del sistema.........................................................3681
Exportar e importar ajustes de diagnóstico de sistema .....................................................3682

2.5
2.5.1
2.5.2
2.5.3
2.5.4
2.5.4.1
2.5.4.2
2.5.5
2.5.5.1
2.5.5.2
2.5.5.3

Diagnóstico del sistema para PLC S7-1500 ......................................................................3682
Introducción........................................................................................................................3682
Principios básicos del diagnóstico del sistema ..................................................................3682
Visualización de los ajustes del diagnóstico del sistema ...................................................3682
Configuración .....................................................................................................................3683
Configuración general ........................................................................................................3683
Ajustes de avisos ...............................................................................................................3683
Exportar e importar ajustes de diagnóstico de sistema .....................................................3684
Principios básicos para exportar e importar ajustes de diagnóstico de sistema................3684
Exportar ajustes de diagnóstico de sistema.......................................................................3684
Importar ajustes de diagnóstico del sistema ......................................................................3684

2.6
2.6.1
2.6.1.1
2.6.1.2
2.6.1.3
2.6.1.4
2.6.2
2.6.2.1

Utilizar posibilidades de diagnóstico adicionales ...............................................................3685
Diagnosticar el hardware ...................................................................................................3685
Mostrar valores actuales y no modificables de propiedades de módulos parametrizables..3685
Mostrar valores actuales de propiedades de módulos dinámicas .....................................3690
Comprobar los fallos de un módulo ...................................................................................3693
Modificar las propiedades de un módulo o de la PG/el PC................................................3697
Diagnosticar conexiones ....................................................................................................3704
Diagnosticar conexiones detalladamente ..........................................................................3704

Índice alfabético......................................................................................................................................3707

8

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1

Editor de hardware y redes

1.1.1

Resumen del editor de hardware y redes

1

Función del editor de hardware y redes
Al hacer doble clic en la entrada "Dispositivos y redes" del árbol del proyecto se abre el editor
de hardware y redes. El editor de hardware y redes es el entorno de desarrollo integrado para
configurar, parametrizar y conectar dispositivos y módulos en red. Ofrece todo el soporte
necesario para realizar el proyecto de automatización.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

9

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Estructura del editor de hardware y redes
El editor de hardware y redes incluye los componentes siguientes:









①
②
③
④

Vista de dispositivos (Página 14), Vista de redes (Página 11), Vista topológica (Página 21): Área gráfica
Vista de dispositivos (Página 14), Vista de redes (Página 11), Vista topológica (Página 21): Área de tabla
Catálogo de hardware (Página 29)
Ventana de inspección (Página 24)

El editor de hardware y redes ofrece tres vistas distintas para su proyecto. Es posible cambiar
entre estas tres vistas en cualquier momento, en función de si deben crearse y editarse
dispositivos y módulos individuales, redes y configuraciones de dispositivos enteras o bien la
estructura topológica del proyecto.
Desde el catálogo de hardware se arrastran los dispositivos y módulos necesarios para el
sistema de automatización hasta la vista de dispositivos, redes o topología.
La ventana de inspección ofrece información sobre el objeto actualmente seleccionado.
También permite modificar los ajustes del objeto seleccionado.

1.1.2

Resumen de los ajustes de la configuración hardware
En "Opciones > Configuración > Configuración hardware" es posible realizar diferentes ajustes
para la configuración hardware.

10

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Resumen
La siguiente tabla muestra un resumen de los ajustes de la configuración hardware:

Grupo

Ajuste

Descripción

Información del Product
Support

Desactivado

Impide el acceso a Siemens Industry Online Support

Vía Internet

Permite acceder vía Internet a la información de producto de los
diferentes dispositivos del catálogo de hardware.

Vista topológica general

Asignar temporalmente
dirección IP

Si un dispositivo no posee una dirección IP válida, permite asignarle
una con carácter temporal para facilitar la detección de la topología.
En ausencia de una dirección IP válida, no es posible obtener infor‐
mación de la topología (LLDP) de un dispositivo.

Mostrar advertencia si la
opción está activada

Muestra una advertencia cuando se asigna una dirección IP temporal
a un dispositivo para la detección de la topología.

Descargar comentario
del módulo

Al cargar la configuración hardware en el dispositivo, transfiere tam‐
bién los comentarios que puedan existir. Los comentarios estarán
disponibles tras cargar el dispositivo en la programadora.

Descargar datos I&M

Si al cargar la configuración hardware o el software o ambos en un
dispositivo también desea poder cargar los datos I&M en el hardware
real, es preciso activar esta opción.

Compilación y descarga

Consulte también
Activar el soporte del producto (Página 34)
Mostrar el soporte del producto para componentes de hardware (Página 34)
Vista topológica (Página 21)

1.1.3

Vista de redes

Introducción
La vista de redes es una de las tres áreas de trabajo del editor de hardware y de redes. Aquí
se realizan las tareas siguientes:
● Configurar y parametrizar dispositivos
● Interconectar dispositivos
● Editar los nombres de los dispositivos

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

11

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Estructura
La figura siguiente muestra los componentes de la vista de redes:





①
②
③
④
⑤





Selector vista de redes/vista de dispositivos/vista topológica
Barra de herramientas de la vista de redes
Área gráfica de la vista de redes
Navegación general
Área de tabla de la vista de redes

La división entre el área gráfica y el área de tabla de la vista de redes se modifica con el ratón.
Un botón de la barra de herramientas permite cambiar la división entre horizontal y vertical.
Para cambiar la posición de la línea divisoria, haga clic entre el área gráfica y el área de tabla
y, sin soltar el botón del ratón, desplace la línea divisoria a izquierda o derecha para cambiar
su posición. El Speedy Splitter (las dos teclas de flecha pequeñas) permiten minimizar o
maximizar el área de tabla con un solo clic, así como restablecer la última división
seleccionada.

Barra de herramientas
La barra de herramientas ofrece las siguientes funciones:
Icono

Significado
Modo de conexión en red de los dispositivos.
Modo para crear conexiones. En la lista desplegable adyacente se selecciona el tipo de
conexión.
Modo para crear relaciones.
Abre el cuadro de diálogo para la asignación manual de nombres a dispositivos PRO‐
FINET. Es necesario que el dispositivo IO esté enchufado y que esté conectado online
con el sistema IO.
Visualización de direcciones de interfaces. Las direcciones de interfaces MPI, PROFI‐
BUS y Ethernet se editan directamente en la vista de redes: Para ello, seleccione la
dirección que desee y haga clic en el campo de dirección seleccionado o pulse [F2].

12

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
Icono

Significado
Activa la vista preliminar del salto de página. Se visualizan líneas punteadas allí donde
se insertará un salto de página al imprimir.
Cambia entre horizontal y vertical la división de las áreas gráfica y de tabla de la vista del
editor.
El símbolo de zoom permite expandir (+) o contraer (-) la imagen gradualmente o bien
rodear con un borde el área que se quiera ampliar.
Muestra los nombres de dispositivos completos en la vista gráfica, en caso de que por
su longitud se muestren cortados a derecha o izquierda y por tanto no se vean íntegra‐
mente.
Guarda la representación actual de la tabla. La disposición, el ancho y la visibilidad de
las columnas se almacenan en la vista de tabla.

Área gráfica
El área gráfica de la vista de redes muestra los dispositivos de red, así como las redes,
conexiones y relaciones. Aquí se insertan dispositivos desde el catálogo de hardware, se
conectan entre sí mediante las interfaces y se editan los ajustes de comunicación.
En el borde inferior del área gráfica se encuentran los elementos para el control de la imagen:
● El nivel de zoom se selecciona utilizando la lista desplegable. También es posible introducir
un valor directamente en el campo de la lista desplegable.
● El nivel de zoom también se puede ajustar con el control deslizante.
● El icono situado en el ángulo inferior derecho permite reenfocar la ventana del área gráfica.

Navegación general
Haga clic con el ratón en la navegación general para obtener una vista general de los objetos
creados en el área gráfica. Manteniendo pulsado el botón del ratón en la navegación general
se navega rápidamente a los objetos deseados y se visualizan en el área gráfica.

Área de tabla
El área de tabla de la vista de redes contiene diversas tablas relacionadas con los dispositivos
existentes, las conexiones y los ajustes de comunicación:
● Vista general de redes
● Conexiones
● Relaciones
● Comunicación E/S
● VPN
En el menú contextual de la barra de título de la tabla se puede modificar el aspecto de la tabla.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

13

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Consulte también
Agregar un dispositivo a la configuración de hardware (Página 41)
Mostrar el estado de diagnóstico y de comparación mediante iconos (Página 3603)
Conectar dispositivos en red en la vista de redes (Página 74)
Área de tabla de la vista general de redes (Página 78)

1.1.4

Vista de dispositivos

Introducción
La vista de dispositivos es una de las tres áreas de trabajo del editor de hardware y redes. Aquí
se realizan las tareas siguientes:
● Configurar y parametrizar dispositivos
● Configurar y parametrizar módulos
● Editar los nombres de los dispositivos y módulos

14

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Estructura
La figura siguiente muestra los componentes de la vista de dispositivos:








①
②
③
④
⑤

Selector vista de redes/vista de dispositivos/vista topológica
Barra de herramientas de la vista de dispositivos
Área gráfica de la vista de dispositivos
Navegación general
Área de tabla de la vista de dispositivos

La división entre el área gráfica y el área de tabla de la vista de dispositivos se puede mover
con el ratón. Un botón de la barra de herramientas permite cambiar la división entre horizontal
y vertical. Para cambiar la posición de la línea divisoria, haga clic entre el área gráfica y el área
de tabla y, sin soltar el botón del ratón, desplace la línea divisoria a izquierda o derecha para
cambiar su posición. El Speedy Splitter (las dos teclas de flecha pequeñas) permiten minimizar
o maximizar el área de tabla con un solo clic, así como restablecer la última división
seleccionada.

Barra de herramientas
En la vista de dispositivos se puede cambiar entre los dispositivos del proyecto utilizando la
lista desplegable de la barra de herramientas. Además de la lista desplegable, para
seleccionar dispositivos se dispone de las siguientes funciones:
Icono

Significado
Cambia a la vista de redes. En la vista de dispositivos se puede cambiar entre los
dispositivos disponibles utilizando la lista desplegable adyacente.
Visualización del área de módulos no enchufados

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

15

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
Icono

Significado
Abre el cuadro de diálogo para la asignación manual de nombres a dispositivos PRO‐
FINET. Es necesario que el dispositivo IO esté enchufado y que esté conectado online
con el sistema IO.
Visualización de la rotulación de módulos. La rotulación se puede editar directamente
en la vista de dispositivos: para ello, seleccione la rotulación que desee y a continua‐
ción haga clic en el campo de texto seleccionado o pulse [F2].
Activa la vista preliminar del salto de página. Se visualizan líneas punteadas allí donde
se insertará un salto de página al imprimir.
El símbolo de zoom permite expandir (+) o contraer (-) la vista gradualmente o bien
trazar un borde alrededor del área que se quiere ampliar.
A partir de un nivel de zoom del 200 % es posible distinguir las denominaciones de
direcciones de los canales E/S en los módulos de señales.
Cambia entre horizontal y vertical la división del área gráfica y de tabla de la vista del
editor.
Guarda la representación actual de la tabla. La disposición, el ancho y la visibilidad de
las columnas se almacenan en la vista de tabla.

Área gráfica
El área gráfica de la vista de dispositivos muestra los componentes de hardware y, en su caso,
los módulos correspondientes que están asignados unos a otros por medio de uno o varios
racks. En los dispositivos con racks es posible insertar otros objetos de hardware
arrastrándolos desde el catálogo de hardware hasta los slots de los racks.
En el borde inferior del área gráfica se encuentran los elementos para el control de la imagen:
● El nivel de zoom se selecciona utilizando la lista desplegable. También es posible introducir
un valor directamente en el campo de la lista desplegable.
● El nivel de zoom también se puede ajustar con el control deslizante.
● El icono situado en el ángulo inferior derecho permite reenfocar la ventana del área gráfica.

Navegación general
Haga clic con el ratón en la navegación general para obtener una vista general de los objetos
creados en el área gráfica. Manteniendo pulsado el botón del ratón en la navegación general
se navega rápidamente a los objetos deseados y se visualizan en el área gráfica.

Área de tabla
El área de tabla de la vista de dispositivos ofrece una vista general del hardware utilizado con
los principales datos técnicos y organizativos.
En el menú contextual de la barra de título de la tabla se puede modificar el aspecto de la tabla.

Consulte también
Rack: Principios básicos (Página 47)
Vista de redes (Página 11)

16

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
Vista de dispositivos: ubicación de los módulos no enchufados (Página 20)
Rack: Enchufar módulo (Página 49)
Vista de dispositivos: objetos de la vista de dispositivos (Página 17)
Mostrar el estado de diagnóstico y de comparación mediante iconos (Página 3603)

1.1.5

Vista de dispositivos: objetos de la vista de dispositivos
En la parte izquierda de la vista de dispositivos se muestra una imagen gráfica del rack y de los
dispositivos a él conectados. En la parte derecha de la vista de dispositivos se encuentra la
vista general de dispositivos. La vista general de dispositivos es una tabla que contiene las
principales informaciones sobre los módulos insertados en el rack. Ambas partes aparecen en
una ventana. El tamaño de sendas partes se puede modificar con un separador. Mediante este
separador se puede mostrar u ocultar una parte o la otra.

Estructura y contenido de la vista de dispositivos
En la vista gráfica de dispositivos se visualiza la configuración offline de los dispositivos en el
rack. La representación equivale a la configuración en el rack real.
En la vista general de dispositivos se muestra la asignación de los slots del rack en forma de
tabla. Cada fila de la tabla contiene información relacionada con la asignación de un slot.
La figura siguiente muestra la vista de dispositivos con la configuración de una CPU SIMATIC
S7-1200.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

17

Configuración de dispositivos y redes
1.1 Editor de hardware y redes







①
②
③

Vista gráfica con el rack equipado con CPU y los distintos módulos enchufados en los slots 1 a 4, así como 101 y 102.
Con el separador se puede modificar la división de la vista de dispositivos entre el área izquierda (vista gráfica) y el
área derecha (vista de dispositivos). Haciendo clic en las flechas puede cambiar rápidamente la división de las áreas.
Vista de dispositivos que muestra en forma de tabla los slots del rack y los componentes enchufados. Utilizando el
menú contextual de los encabezados de las columnas es posible mostrar otras columnas u ocultar columnas visibles.

Cada fila de la vista general de dispositivos representa un slot. Las distintas columnas
muestran las principales informaciones de cada slot:
Columna

18

Significado

Estado online

Representación simbólica del estado online

De seguridad (fail-sa‐
fe)

Representación simbólica de módulos de seguridad

Módulo

Denominación del módulo, editable a discreción

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
Columna

Significado

Rack

Número de rack

Slot

Número de slot

Dirección E

Dirección de entrada, editable

Dirección S

Dirección de salida, editable

Dirección de origen F

Dirección de origen F si se utiliza periferia F

Dirección de destino F Dirección de destino F si se utiliza periferia F
Tipo

Denominación del módulo en el catálogo

Referencia

Referencia del módulo

Firmware

Versión de firmware del módulo

Comentario

Comentario opcional

Visualización de los canales E/S
Si se ajusta en la vista de dispositivos un nivel de zoom mínimo de 200%, se muestran los
diferentes canales E/S de los módulos E/S. Si hay definidas variables PLC para los canales,
se muestran los nombres de las variables PLC.
La figura siguiente muestra los canales de entrada de un módulo de entradas digitales con las
dos variables PLC "Test1" y "Test2" con un nivel de zoom de 400%.

Es posible seleccionar cualquier canal E/S; en el caso de canales con variables PLC existen
las posibilidades siguientes:
● En la ventana de inspección, dentro de "Propiedades" verá las propiedades generales de
la variable PLC seleccionada.
● En la ventana de inspección, dentro de "Información > Referencias cruzadas" encontrará la
información sobre referencias cruzadas de la variable PLC seleccionada. La información
sobre referencias cruzadas también se puede abrir para la variable PLC seleccionada
desde el menú contextual.

Consulte también
Vista de dispositivos (Página 14)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

19

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

1.1.6

Vista de dispositivos: ubicación de los módulos no enchufados
En algunos casos, los módulos de una configuración de hardware no se asignan
temporalmente a ningún slot. Estos módulos no enchufados se desplazan al área de módulos
no enchufados, un área específica dentro de la vista de dispositivos.

Inclusión de módulos en el área
Al área de módulos no enchufados se desplazan automáticamente los módulos que, p. ej.,
debían asignarse a un dispositivo mediante una acción de copia pero el rack correspondiente
no dispone de ningún slot libre compatible.
En determinadas circunstancias, los módulos se incluyen automáticamente en el área de
módulos no enchufados:
● Un módulo se arrastra hasta un dispositivo en la vista de redes pero el rack no dispone de
ningún slot libre compatible.
● Un módulo se desplaza o copia del rack, catálogo de hardware o árbol del proyecto
directamente en el área de módulos no enchufados en la vista de dispositivos.
Los CPs y FMs que ocupan un recurso de red pueden desplazarse al área de módulos no
enchufados, pero pierden sus recursos de red ya asignados.
También puede agregar módulos al área de módulos no enchufados, por ejemplo mediante
arrastrar y soltar. Para ello el área debe estar abierta.

Uso del área de módulos no enchufados
El área de módulos no enchufados se abre con el botón correspondiente.
El área de módulos no enchufados está en la vista de dispositivos.

El área de módulos no enchufados se abre con el botón correspondiente de la barra de
herramientas de la vista de dispositivos (Página 14).
Icono

Significado
Abrir el área de módulos no enchufados

Nota
Para liberar slots, desplace módulos de la configuración al área e inserte los módulos
deseados del área en los slots que han quedado libres.
De este modo se retiran de la configuración los módulos que ya están parametrizados sin
necesidad de borrarlos.

20

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Tratamiento de módulos en el área
Los módulos del área se rigen por las reglas siguientes:
● Los módulos están en la carpeta "Módulos locales" del dispositivo correspondiente en el
árbol del proyecto.
● Los módulos conservan todos los ajustes y parámetros que se han realizado hasta el
momento.
● Los módulos no se tienen en cuenta al realizar la carga en el sistema de destino, por lo que
no se comprueba la coherencia de los módulos en el área de módulos no enchufados.
● En el menú contextual se puede, p. ej., copiar, cortar o eliminar los módulos.
ATENCIÓN
Módulos de comunicación en la ubicación
Al compilar la configuración, los CP o CM de la ubicación no pueden estar conectados a una
subred, ya que de lo contrario la compilación de la configuración provoca un error. Si un
módulo de conmutación de la ubicación está conectado a una subred, quítelo de la ubicación
y desconéctelo de la subred. Después podrá volver a moverlo a la ubicación.

1.1.7

Vista topológica

Introducción
La vista topológica es una de las tres áreas de trabajo del editor de hardware y redes. Aquí se
realizan las tareas siguientes:
● Mostrar la topología de Ethernet
● Configurar la topología Ethernet
● Determinar y minimizar diferencias entre la topología prevista y la topología real
● Editar los nombres de los dispositivos

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

21

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Estructura
La siguiente figura muestra una vista general de la vista topológica.








①
②
③
④
⑤

Selector vista de dispositivos/vista de redes/vista topológica
Barra de herramientas de la vista topológica
Área gráfica de la vista topológica
Navegación general
Área de tabla de la vista topológica (vista topológica general)

La división entre el área gráfica y el área de tabla de la vista topológica se mueve con el ratón.
Un botón de la barra de herramientas permite cambiar la división entre horizontal y vertical.
Para cambiar la posición de la línea divisoria, haga clic entre el área gráfica y el área de tabla
y, sin soltar el botón del ratón, desplace la línea divisoria a izquierda o derecha para cambiar
su posición. El Speedy Splitter (las dos teclas de flecha pequeñas) permiten minimizar o
maximizar el área de tabla con un solo clic, así como restablecer la última división
seleccionada.

Barra de herramientas
La barra de herramientas ofrece las siguientes funciones:
Icono

Significado
Abre el cuadro de diálogo para la asignación manual de nombres a dispositivos PRO‐
FINET. Es necesario que el dispositivo IO esté enchufado y que esté conectado online
con el sistema IO.
Cambia la posición de los dispositivos en la vista topológica, de modo la nueva posi‐
ción se parece lo máximo posible a la posición en la vista de redes.

22

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
Icono

Significado
Activa la vista preliminar del salto de página. Se visualizan líneas punteadas allí donde
se insertará un salto de página al imprimir.
El símbolo de zoom permite expandir (+) o contraer (-) la imagen gradualmente o bien
rodear con un borde el área que se quiera ampliar.
Cambia entre horizontal y vertical la división del área gráfica y de tabla de la vista del
editor.
Guarda la representación actual de la tabla. La disposición, el ancho y la visibilidad de
las columnas se almacenan en la vista de tabla.

Área gráfica
En el área gráfica de la vista topológica se visualizan los módulos Ethernet con los
correspondientes puertos e interconexiones de puertos. Aquí se pueden agregar otros objetos
de hardware con interfaces Ethernet. Véase: Agregar un dispositivo a la configuración de
hardware (Página 41)
En el borde inferior del área gráfica se encuentran los elementos para el control de la imagen:
● El nivel de zoom se selecciona utilizando la lista desplegable. También es posible introducir
un valor directamente en el campo de la lista desplegable.
● El nivel de zoom también se puede ajustar con el control deslizante.
● El icono situado en el ángulo inferior derecho permite reenfocar la ventana del área gráfica.

Navegación general
Haga clic con el ratón en la navegación general para obtener una vista general de los objetos
creados en el área gráfica. Manteniendo pulsado el botón del ratón en la navegación general
se navega rápidamente a los objetos deseados y se visualizan en el área gráfica.

Área de tabla
El área de tabla contiene las dos fichas siguientes:
● Ficha "Vista topológica general"
● Ficha "Comparación topológica"
En la ficha "Vista topológica general" se muestran los módulos Ethernet y PROFINET, así
como sus puertos e interconexiones de puertos en formato de tabla. Esta tabla corresponde a
la tabla de la vista general de la red en la vista de redes.
En la ficha "Comparación topológica" se determinan y minimizan diferencias entre la topología
prevista y la topología real

Consulte también
Mostrar el estado de diagnóstico y de comparación mediante iconos (Página 3603)
Resumen de los ajustes de la configuración hardware (Página 10)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

23

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

1.1.8

Ventana de inspección
Las propiedades y los parámetros visualizados del objeto seleccionado se editan dentro de la
ventana de inspección.

Estructura
La ventana de inspección incluye los componentes siguientes:





①
②
③
④

24



Conmutación entre diferentes áreas de información y trabajo
Conmutación entre distintas fichas de las áreas de información y trabajo
Navegación entre distintas informaciones y parámetros
Visualización de las informaciones y parámetros seleccionados

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Descripción de las funciones
La información y los parámetros de la ventana de inspección se dividen en distintos tipos de
información con diferentes fichas:
● Propiedades
En esta área existe la posibilidad de configurar el dispositivo. Es posible configurar los
ajustes del hardware, editar variables y constantes de sistema y administrar textos del
proyecto. Encontrará las fichas siguientes:
– General (consulte Propiedades y parámetros (Página 63))
– Variables IO (consulte AUTOHOTSPOT)
– Constantes de sistema (consulte AUTOHOTSPOT)
– Textos (consulte AUTOHOTSPOT)
● Información
En esta área encontrará información general sobre el dispositivo en el proyecto, así como
una lista de referencias cruzadas y avisos y notas sobre la compilación del dispositivo.
Encontrará las fichas siguientes:
– General
– Lista de referencias cruzadas (consulte Referencias cruzadas en la ventana de
inspección)
– Compilación (consulte Información acerca de la compilación)
● Diagnóstico
Cuando se cambia el dispositivo a online, aquí aparece información de diagnóstico sobre
el dispositivo y sus conexiones. También se muestran los correspondientes avisos de
diagnóstico. Encontrará las fichas siguientes:
– Información de dispositivos (consulte Diagnóstico de hardware (Página 3601))
– Información de la conexión (consulte Diagnóstico de la conexión (Página 3660))
– Visor de avisos (consulte Visor de avisos)
Para visualizar la información y los parámetros correspondientes haga clic en el área deseada.

Visualización de las propiedades del dispositivo
El área más importante para configurar un sistema de automatización es la de "Propiedades",
por lo que aquí se van a describir las distintas posibilidades de edición. Para obtener
información sobre las restantes áreas, utilice los enlaces mencionados anteriormente con
otras secciones del sistema de información.
Ficha "General"
Indica las propiedades y ajustes del dispositivo o módulo. Aquí pueden editarse los ajustes y
parámetros. En la parte izquierda de la ventana de inspección se encuentra la navegación
local, en la que la información y los parámetros aparecen clasificados en grupos. Si se hace clic
en el símbolo de flecha situado a la izquierda del nombre de grupo se abrirá el grupo con los
subgrupos existentes. Si se selecciona un grupo o subgrupo, la información y los parámetros
correspondientes aparecerán en la parte derecha de la ventana de inspección, donde también
pueden editarse.
Ficha "Variables IO"

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

25

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
Muestra las variables IO del dispositivo, del PLC y de los diferentes módulos. Es posible
asignar nombres a las variables, asignar las variables mediante una lista desplegable a las
tablas de variables definidas por el usuario y dotar las variables de comentarios. Las variables
IO también aparecen en la tabla de variables PLC.
Haciendo clic sobre los símbolos de variable en la tabla se pueden utilizar variables en otros
editores mediante la función Drag & Drop. De este modo es posible, por ejemplo, asignar una
variable a una instrucción en el editor de programación o copiar una variable en la tabla de
variables de otro dispositivo.
Nota
Utilizar la función de autocompletar
Si desea crear varias variables con nombres parecidos también puede hacer clic sobre el
nombre de una variable y arrastrar el borde, desde la esquina inferior derecha, hasta otros
campos situados por encima o por debajo. En todos los campos afectados se creará una
variable nueva. Para diferenciar las variables, se utiliza el nombre de la variable original
agregándole un número. Si el nombre de la variable ya termina en un número, se incrementa
el número:
Siguiendo el mismo método también es posible crear nuevas variables a través de la columna
de la tabla de variables o asignar otra tabla de variables a las variables ya existentes.
Seleccione una tabla de variables en la lista desplegable y arrastre el borde sobre varios
campos como se ha descrito anteriormente. Así se crearán nuevas variables en la tabla de
variables correspondiente.
Si estas acciones afectan a variables ya existentes, en un cuadro de diálogo se preguntará si
deben sobrescribirse las variables afectadas o si solo deben agregarse variables nuevas en
los campos vacíos. En ese segundo caso esto significa que, por ejemplo, en un área de nueve
campos en la que existan seis variables solo se agregarán tres variables y no se modificarán
las seis variables existentes.
Ficha "Constantes de sistema"
Indica las constantes globales utilizadas por el dispositivo con los identificadores de hardware,
por ejemplo de los módulos, submódulos e interfaces. Mediante la lista desplegable seleccione
si desea ver todas las constantes de sistema del dispositivo o solo las constantes de sistema
del hardware o del software.
En esclavos I o I-devices se muestran también las constantes de sistema del maestro DP o del
controlador IO correspondientes al esclavo I o al I-device.
Si se hace clic en el enlace de la columna en la que se muestra el uso de la constante, se abre
la vista del dispositivo correspondiente. Las constantes de sistema también aparecen en la
tabla de variables PLC.
Haciendo clic sobre los símbolos de constantes en la tabla se pueden utilizar constantes de
sistema en otros editores mediante la función Drag & Drop. De este modo es posible, por

26

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
ejemplo, asignar una constante de sistema a una instrucción en el editor de programación o
crear en otro dispositivo una constante de sistema como constante de usuario.
Ficha "Textos"
Indica el idioma de referencia y el origen de los textos del proyecto. Tenga en cuenta al
respecto el contenido restante del sistema de información.

Consulte también
Resumen del editor de hardware y redes (Página 9)
Información importante sobre identificadores de hardware (Página 1264)
Direccionamiento de módulos (Página 1597)
Direccionamiento de módulos (Página 1262)
Ventana de inspección: representación de UDT (Página 27)

1.1.9

Ventana de inspección: representación de UDT
En la ventana de inspección, en "Propiedades > Variables IO" se muestran estructuras de
datos definidas por el usuario y compuestas por varios elementos. La representación de estos
tipos de datos PLC llamados UDT (User Defined Structure) es distinta de la representación de
variables IO simples.

Representación de UDT en la tabla de variables IO
Las variables PLC estructuradas, que ocupan el área de direcciones de un módulo, se
muestran en columnas combinadas, junto con los elementos de datos que contienen. Las
áreas de direcciones asignadas se representan mediante líneas verticales, y las direcciones
individuales mediante pequeños rombos.
Dependiendo de cuál sea la asignación de las direcciones de canales de los módulos E/S a lo
largo del área de direcciones de los UDT, para la representación se utilizan los símbolos
siguientes:
Símbolo

Significado
Inicio del área de direcciones de un elemento de datos que recorre varios canales.
Se utiliza el área de direcciones de todo el canal.
Parte del área de direcciones de un elemento de datos que recorre varios canales.
Se utiliza el área de direcciones de todo el canal.
Fin del área de direcciones de un elemento de datos que recorre varios canales.
Se utiliza el área de direcciones de todo el canal.
Área de direcciones completa de un elemento de datos que recorre el área de direcciones de un canal utilizado
por completo.
Ejemplo: solo se utiliza íntegramente para un elemento de datos la palabra de entrada de un canal.
Inicio del área de direcciones de un elemento de datos que recorre varios canales.
El área de direcciones del canal se utiliza solo parcialmente.
Fin del área de direcciones de un elemento de datos que recorre varios canales.
El área de direcciones del canal se utiliza solo parcialmente.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

27

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
Símbolo

Significado
Área de direcciones completa de un elemento de datos. Solo se utiliza la primera parte de la dirección del canal.
Ejemplo: solo está asignado el primer byte de una palabra.
Área de direcciones completa de un elemento de datos. Solo se utiliza la segunda parte de la dirección del canal.
Ejemplo: solo está asignado el segundo byte de una palabra.
Dirección individual de un elemento de datos para un canal que solo tiene una dirección.
Ejemplo: acceso individual por bit a la dirección de canal de una entrada digital.
Dirección individual de un elemento de datos para un canal que tiene varias direcciones.
Ejemplo: acceso individual por bit a la dirección de canal de una entrada analógica.

Ejemplo de aplicación
En la figura siguiente se muestra una tabla de variables con un tipo de datos PLC UDT "Motor"
con los elementos de datos "Start", "Stop" y "Dummy" que contiene:

En un módulo de entrada DI32 con las direcciones de entrada I0.0 a I3.7, se ve la columna
combinada "Motor ("MotorUDT")" dentro de las variables IO de la ventana de inspección. Esta
columna combinada contiene una columna para el área de direcciones del UDT "Motor" y otra
para los elementos de datos "Motor.Dummy", "Motor.Start" y "Motor.Stop" contenidos en el
UDT. El elemento de datos "Status" comienza a partir de la dirección I4.0 y no se muestra para
ese módulo de entrada en las variables IO, puesto que el área de direcciones de los 32 canales
digitales solo va de I0.0 a I3.7. La variable "ErrorCode (Byte)" no forma parte de los UDT, por
lo que no se muestra en la columna combinada debajo del UDT "Motor", sino en una columna
independiente:

28

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

En este módulo el UDT "Motor" ocupa el área de direcciones de I0.0 a I3.7. Dentro de esta área
de direcciones la variable "Dummy" ocupa el área de direcciones I0.0 a I1.7, y las dos variables
"Start" y "Stop" ocupan las direcciones concretas I2.0 e I2.1. La variable "ErrorCode (Byte)",
que no pertenece al UDT, ocupa en una columna propia las direcciones I3.0 a I3.7.
Nota
La tabla de variables IO muestra solo los datos que están dentro del área de direcciones del
dispositivo seleccionado, en este caso el área de direcciones del módulo de entrada DI32. Si
se inserta otro módulo de entrada que tenga como mínimo 16 canales, con el área de
direcciones ampliada se continúa mostrando la asignación de direcciones a lo largo del UDT:
el área de direcciones del UDT "Motor" llega hasta la dirección I5.7, y el elemento de datos
"Status" que contiene va de la dirección I4.0 a I5.7. A su vez, el elemento de datos "Status"
ocupa desde I4.0 hasta I4.7 direcciones concretas para bits de estado concretos. Para
visualizar los bits de estado, a la columna combinada del UDT se le agrega otra columna.

Consulte también
Ventana de inspección (Página 24)

1.1.10

Catálogo de hardware
La Task Card "Catálogo de hardware" permite acceder fácilmente a los componentes de
hardware más diversos.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

29

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Estructura
La Task Card "Catálogo de hardware" consta de las paletas siguientes:






①
②
③

30

Paleta "Catálogo", función de búsqueda y filtro
Paleta "Catálogo", selección de componentes
Paleta "Información"

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Función de búsqueda y filtro
Las funciones de búsqueda y filtro de la paleta "Catálogo" permiten buscar cómodamente
determinados componentes de hardware. Después de introducir un texto de búsqueda existe
la posibilidad de iniciar la búsqueda hacia arriba o hacia abajo partiendo de la posición actual
en el catálogo.
La función de filtro permite limitar la visualización de los componentes HW según
determinados criterios. Por ejemplo, es posible limitar la visualización a objetos que se pueden
colocar también en el contexto actual o que contienen determinadas funciones. Los objetos
utilizables en el contexto actual son, p. ej., objetos que pueden conectarse en red en la vista
de redes, o bien los únicos módulos compatibles con el dispositivo en la vista de dispositivos.
Es posible crear perfiles de hardware que limiten los objetos que se visualizarán en el catálogo
de hardware. Así, por ejemplo, podría crearse un perfil de hardware para que solo se vean
determinados controladores y otro perfil que únicamente incluyera determinados dispositivos
de la periferia descentralizada. Se puede cambiar entre los perfiles de hardware creados.

Selección de componentes
La selección de componentes de la paleta "Catálogo" contiene los componentes de hardware
instalados en una estructura de árbol. Desde allí se arrastran los dispositivos o módulos
deseados al área de trabajo gráfica de la vista de dispositivos o redes.
Los componentes de hardware que están instalados pero que todavía no disponen de licencia
se visualizan atenuados. No es posible utilizar los componentes de hardware sin licencia.
Los componentes de hardware que pertenecen a diversos grupos de componentes temáticos
se presentan parcialmente como objeto enlazado. Si se hace clic en uno de estos
componentes de hardware enlazados, se abre la estructura del catálogo donde se encuentran
los respectivos componentes de hardware.

Información
En la paleta "Información" aparece información detallada del objeto seleccionado en el
catálogo:
● Representación esquemática
● Nombre
● Referencia
● Número de versión
● Descripción
● Type Identifier (identificador de tipo, solo si está activado)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

31

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Nota
Type Identifier
En el menú "Herramientas > Configuración > Configuración hardware" es posible activar la
visualización del atributo "Type Identifier". Si el Type Identifier está activado, los objetos de
hardware pueden identificarse unívocamente para su uso en entornos de desarrollo externos.
El Type Identifier se muestra en la paleta "Información" del catálogo de hardware, entre otros.

Consulte también
Examinar el catálogo de hardware (Página 32)
Resumen del editor de hardware y redes (Página 9)

1.1.11

Examinar el catálogo de hardware

Introducción
Para seleccionar los componentes de hardware deseados para una configuración, utilice la
Task Card "Catálogo de hardware". Utilice el catálogo de hardware para seleccionar los
componentes de hardware que pueden conectarse en red en la vista de redes y topológica así
como para seleccionar los módulos deseados en la vista de dispositivos.

Filtro contextual
El número de componentes HW visualizados y que debe encontrar la búsqueda se puede
limitar con la opción "Filtro" del catálogo de hardware.
Cuando se activa el filtro, los componentes disponibles en el catálogo de hardware se
muestran en función de la vista seleccionada y del dispositivo seleccionado. Al cambiar entre
las distintas vistas, la vista de los objetos filtrados se adapta al contexto actual. Si el filtro no
está activado se mostrará todo el catálogo de hardware en todas las vistas.
Ejemplo: Con el filtro activado en la vista de dispositivos de una CPU S7-1200, en el catálogo
de hardware solo aparecerán las CPU S7-1200 y los respectivos módulos.

Posibilidades de búsqueda
Con la función de búsqueda se buscan entradas determinadas en el catálogo de hardware.
Tenga en cuenta las reglas siguientes al introducir los términos de búsqueda:
● No se distingue entre mayúsculas y minúsculas.
● Los guiones y los espacios se ignoran.
● En la búsqueda se tienen en cuenta partes de un término buscado.
● Cuando hay varios términos de búsqueda hay que separarlos con un espacio.
● El asterisco "*" se utiliza como comodín.

32

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Nota
Uso de comodines en el catálogo de hardware
En la entrada del término de búsqueda el asterisco "*" se utiliza como comodín ("wildcard"). Por
ejemplo, si la entrada es "1A**0" se buscarán las entradas que contengan "1AD30" o "1AE40".
A la inversa, en el catálogo de hardware también hay módulos cuyas referencias incluyen
comodines. Además de asterisco, los comodines de las diversas referencias también pueden
incluir las letras minúsculas "x", "y" o "z". Por ejemplo, si en el campo de búsqueda se introduce
la referencia concreta "3RW4 422-1BC34", se mostrarán también artículos con las referencias
"3RW4 422-*BC**" o "3RW4 4xx-1By3z".
La búsqueda se inicia hacia arriba o hacia abajo en el catálogo de hardware partiendo del
objeto actualmente seleccionado.
Icono

Significado
Búsqueda hacia abajo
Búsqueda hacia arriba

Examinar el catálogo de hardware
Para examinar el catálogo de hardware, proceda del siguiente modo:
1. Haga clic con el ratón en el campo de entrada de la función de búsqueda
2. Introduzca un término de búsqueda. Se examinarán los elementos siguientes:
– Nombre del dispositivo o del módulo
– Referencia (MLFB)
– Descripción en la paleta "Información"
3. Haga clic en el botón "Búsqueda descendente" o "Búsqueda ascendente".
Nota
Para saber el sentido de búsqueda correcto, observe el lugar que ha seleccionado en el
catálogo de hardware. Para examinarlo todo, haga clic en el primer objeto del catálogo de
hardware e inicie la búsqueda pulsando "Búsqueda descendente" después de haber
introducido el término.
Como resultado aparece la primera coincidencia encontrada con el término de búsqueda.
Si desea seguir buscando para encontrar más resultados, vaya pulsando el botón
"Búsqueda descendente" o "Búsqueda ascendente".
Tenga en cuenta el filtro contextual del catálogo de hardware. Si está activado, la búsqueda
dentro del catálogo HW se limita únicamente a los componentes visualizados que pueden
insertarse.

Consulte también
Catálogo de hardware (Página 29)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

33

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

1.1.12

Activar el soporte del producto
Para cada dispositivo del catálogo de hardware existe información relacionada que está
almacenada en Siemens Industry Online Support. Dicha función está desactivada por defecto.
A continuación se explica cómo activarla.

Requisitos
El TIA Portal dispone de acceso a Internet.

Procedimiento
Para activar el acceso a Siemens Industry Online Support, proceda del siguiente modo:
1. En el menú "Herramientas", elija el comando "Configuración".
2. Abra el grupo "Configuración de hardware" en la navegación local.
3. Active la casilla de verificación "Vía Internet".

Resultado
Dentro del catálogo de hardware se accede al soporte del producto, las preguntas frecuentes
y los manuales desde el menú contextual de un módulo.

Consulte también
Mostrar el soporte del producto para componentes de hardware (Página 34)
Resumen de los ajustes de la configuración hardware (Página 10)

1.1.13

Mostrar el soporte del producto para componentes de hardware
En el catálogo de hardware se accede directamente a la información almacenada en Siemens
Industry Online Support para cada módulo. Se ofrecen los siguientes accesos directos a las
páginas respectivas de Siemens Industry Online Support:
● Información de soporte sobre el producto
● Preguntas frecuentes
● Manuales

Requisitos
● Hay acceso a Internet.
● El acceso al Product Support está activado en la configuración del TIA Portal.
Para saber cómo activar la función, consulte el capítulo "Activar soporte de producto
(Página 34)".

34

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Procedimiento
Para acceder a información de Siemens Industry Online Support sobre un módulo concreto,
proceda del siguiente modo:
1. Navegue hasta el módulo deseado en el catálogo de hardware.
2. Haga clic con el botón derecho del ratón en el módulo.
3. Elija una de las entradas siguientes del menú contextual:
– Información de soporte del producto
– Preguntas frecuentes
– Manuales

Resultado
Se abre el navegador predeterminado ajustado en el sistema operativo y se carga la página
pertinente de Siemens Industry Online Support.

Consulte también
Activar el soporte del producto (Página 34)
Resumen de los ajustes de la configuración hardware (Página 10)

1.1.14

Imprimir configuraciones de hardware y redes

Impresión de configuraciones de hardware y redes
En la documentación del proyecto es posible imprimir los elementos siguientes de la vista de
hardware y redes:
● Vista gráfica de redes
● Tabla general de las redes
● Vista gráfica de dispositivos
● Tabla general de los dispositivos
● Los parámetros del objeto seleccionado actualmente en el editor

Impresión de contenidos de un editor
Si se inicia la impresión dentro de un editor abierto y no se selecciona ningún módulo, se
imprimen siempre los contenidos del editor. Aquí se incluyen la representación gráfica del
editor así como la tabla perteneciente al editor. Sin embargo, es posible adaptar la impresión.
Es posible ajustar si debe imprimirse solo la vista gráfica, solo la tabla o ambas. Lea al respecto
el capítulo "Imprimir: modificar los ajustes (Página 37)".
Si el gráfico es mayor que el formato de página seleccionado, la impresión continúa en la
página siguiente. De esta manera no se pierden contenidos. Alternativamente, es posible

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

35

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
modificar el nivel de zoom de la representación gráfica para ajustar la impresión a una página.
La impresión se realiza siempre en el nivel de zoom actualmente seleccionado.
Para controlar si todos los contenidos se ajustan a una página, utilice la vista preliminar o active
la vista preliminar de salto de página. Con la vista preliminar de salto de página activada, en el
editor gráfico se visualizan líneas punteadas en el lugar donde después habrá un salto de
página.

Impresión de tablas muy grandes
Si una tabla es mayor que el área de impresión y no se puede imprimir completamente, los
contenidos de la tabla no se imprimen en forma de tabla sino como una relación de valores y
claves.
Ejemplo:
Nombre de objeto

Propiedad 1

Propiedad 2

Objeto A

Valor A1

Valor A2

Objeto B

Valor B1

Valor B2

En este caso, la impresión queda del siguiente modo:
Objeto A
Propiedad 1: Valor A1
Propiedad 2: Valor A2
Objeto B
Propiedad 1: Valor B1
Propiedad 2: Valor B2
También es posible ajustar este formato de impresión como estándar, de forma que las tablas
se impriman siempre como una relación de claves y valores. Lea al respecto el capítulo
"AUTOHOTSPOT".

Impresión de parámetros de módulos
Los parámetros de los módulos seleccionados se imprimen junto con los valores actuales en
forma de texto. Todos los parámetros de los respectivos módulos se imprimen igualmente. Así,
por ejemplo, si se ha seleccionado una CPU, se imprimirán los parámetros de la Signal Board,
si hay una insertada.
Se determina el alcance con que deben imprimirse los parámetros de módulos. En el cuadro
de diálogo "Imprimir", seleccione si quiere imprimir todas las propiedades y los parámetros de
un módulo, o si desea una impresión compacta. Si selecciona la forma compacta, se imprimen
solo las entradas incorporadas en el área "General" de las propiedades del módulo. Quedan
excluidos de aquí los comentarios sobre el módulo así como el autor y la descripción del

36

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes
módulo. En el modo compacto se imprimen además, por ejemplo, los siguientes parámetros
de un módulo:
● Indicaciones sobre el módulo
Nombre, slot de módulo, descripción breve, referencia, versión de firmware
● Nombre de la interfaz PROFINET
● Indicaciones sobre la subred
Nombre de la subred, ID de la subred S7

Consulte también
Imprimir: modificar los ajustes (Página 37)
Imprimir: activar la vista preliminar del salto de página (Página 37)

1.1.15

Imprimir: modificar los ajustes

Modificar el alcance de la impresión
Si se imprime desde un editor, es posible determinar si deben imprimirse tanto gráficos como
tablas o bien sólo uno de los dos. Por defecto se imprimen ambos.

Procedimiento
Para cambiar el alcance de la impresión, proceda del siguiente modo:
1. En el menú "Herramientas", elija el comando "Configuración".
2. Abra el grupo de parámetros "Configuración de impresión" en "General" de la navegación
local.
3. Desplácese hasta el grupo "Configuración hardware".
4. Active o desactive la casilla de verificación "Vista gráfica activa" según si desea imprimir los
gráficos de la vista de redes y dispositivos.
5. Active o desactive la casilla de verificación "Tabla activa" según si desea imprimir la tabla
perteneciente a un editor.

Consulte también
Imprimir configuraciones de hardware y redes (Página 35)

1.1.16

Imprimir: activar la vista preliminar del salto de página
En los editores gráficos es posible activar una vista preliminar de salto de página para la
impresión. Si la opción está activada, se visualizan líneas punteadas en los lugares del editor
gráfico donde se inserta un salto de página en la impresión posterior.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

37

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Procedimiento
Para activar la vista preliminar de salto de página, proceda del siguiente modo:
1. Seleccione el área gráfica de la vista correspondiente.
2. Haga clic en el símbolo "Mostrar saltos de página" en la barra de herramientas del editor
gráfico.
Dentro del editor gráfico se visualizan líneas punteadas en el lugar donde después habrá
un salto de página.
3. Para modificar el diseño del borde, elija el comando "Imprimir" del menú "Proyecto".
4. Para desactivar la vista preliminar de saltos de página, haga clic de nuevo en el símbolo
"Mostrar saltos de página" en la barra de herramientas del editor gráfico.

1.1.17

Comandos de teclado: navegación en el editor
En la vista de redes y dispositivos es posible navegar con combinaciones de teclas entre los
componentes del editor de hardware y redes.

Navegar entre elementos y funciones
Función

Combinación de teclas

Cambio al siguiente nivel de selección inferior

<Intro>

La tecla <Intro> permite cambiar, por ejemplo, de un rack seleccionado al nivel de
selección inferior de los dispositivos y módulos disponibles. Si hay un dispositivo se‐
leccionado, con la tecla <Intro> se cambia al nivel de selección inferior de las interfaces
visualizadas en el dispositivo.
<Esc>

Cambio al siguiente nivel de selección superior
La tecla <Esc> permite cambiar, por ejemplo, de una interfaz seleccionada al nivel de
selección superior de los dispositivos y módulos. Si hay un dispositivo seleccionado,
con la tecla <Esc> se cambia al nivel de selección superior de los racks.
Navegación entre objetos en el nivel de selección actual

<Flecha hacia arriba>

Las teclas de flecha permiten navegar entre los objetos en el nivel de selección actual.
Para cambiar el nivel de selección utilice las teclas <Intro> o <Esc>.

<Flecha hacia abajo>
<Flecha a la derecha>
<Flecha a la izquierda>

Cambia a la vista de dispositivos

<Ctrl+Mayús+D>

Cambia a la vista de redes

<Ctrl+Mayús+N>

Cambia a la vista topológica

<Ctrl+Mayús+T>

Cambiar entre elementos del editor

<Tab>

Con la tecla <Tab> se cambia de un elemento del editor al siguiente. Con <Mayús
+Tab> se cambia al elemento anterior. Así, por ejemplo, es posible cambiar entre la
vista gráfica, Speedy Splitter, la vista de tabla o fichas subordinadas.

<Mayús+Tab>

Cambiar entre fichas

<Ctrl+Tab>

Con las teclas <Ctrl+Tab> se cambia de una ficha a la siguiente de la derecha. Con
<Ctrl+Mayús+Tab> se cambia a la siguiente ficha de la izquierda. Así, por ejemplo, con
las teclas es posible cambiar entre la vista de dispositivos, redes y topológica.

<Ctrl+Mayús+Tab>

38

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.1 Editor de hardware y redes

Abrir elementos y funciones
Función

Combinación de teclas

Abrir la vista online y de diagnóstico

<Ctrl+D>

Con el dispositivo seleccionado, pulsando <Ctrl+D> se abre la vista online y de diag‐
nóstico para el dispositivo seleccionado.
Abrir el cuadro de diálogo para cargar en dispositivo

<Ctrl+L>

Con el dispositivo seleccionado, pulsando <Ctrl+L> se abre el cuadro de diálogo para
la carga avanzada en el dispositivo seleccionado.
Agregar un dispositivo

<Ctrl+N>

Con <Ctrl+N> se abre el cuadro de diálogo para agregar un dispositivo nuevo.
Abre la Task Card "Catálogo de hardware"

<Ctrl+Mayús+C>

Abre la Task Card "Herramientas online"

<Ctrl+Mayús+O>

1.1.18

Comandos de teclado: editar objetos
El editor de hardware y redes permite realizar algunas funciones de la vista de redes y
dispositivos utilizando combinaciones de teclado y ratón. El manejo del teclado en las tablas
responde al comportamiento habitual. Aquí se explica el manejo del teclado para el área de
trabajo gráfica de la vista de redes y dispositivos.

Manejo general del teclado
Función

Combinación de teclas

Ampliar la imagen al marco trazado

<Ctrl+espacio> + botón del ratón
pulsado

Trace un marco en la vista gráfica para cambiar el tamaño de la vista en correspon‐
dencia.
Desplazar la imagen

<espacio> + botón del ratón pulsado

Mueva el puntero del ratón para desplazar la vista.
Cancelar la operación actual

<Esc>

Soltar el conector

<Esc> o doble clic

Pulsando <Esc> o haciendo doble clic se sale del modo de conexión al arrastrar una
conexión.
Zoom a la vista gráfica

<Ctrl> + rodar rueda del ratón

El aumento o la reducción depende del sentido de giro.

Objetos seleccionados
Función

Combinación de teclas

Seleccionar objeto

Clic con el ratón

Cortar un objeto

<Ctrl+X>

El objeto seleccionado se copia en el portapapeles y se borra de la vista gráfica.
Copiar objeto

<Ctrl+C>

El objeto seleccionado se copia en el portapapeles.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

39

Configuración de dispositivos y redes
1.2 Configurar dispositivos
Función

Combinación de teclas

Pegar objeto

<Ctrl+V>

El objeto del portapapeles se pega en la selección.
Borrar objeto seleccionado

<Supr>

Seleccionar varios objetos 1

<Mayús> + clic con el ratón

Es posible agregar varios objetos a los seleccionados haciendo clic con el ratón en
cada uno de ellos. Otra posibilidad consiste en dibujar un marco alrededor de los
objetos que desea seleccionar con <Mayús> + botón del ratón pulsado.
<Ctrl> + clic con el ratón

Seleccionar varios objetos 2
Es posible agregar varios objetos a los seleccionados haciendo clic con el ratón en
cada uno de ellos. Otra posibilidad consiste en dibujar un marco alrededor de los
objetos que desea seleccionar con <Mayús> + botón del ratón pulsado. Manteniendo
pulsada la tecla <Ctrl> y haciendo clic con el ratón se desmarcan objetos selecciona‐
dos.

Botón del ratón pulsado

Desplazar selección
Manteniendo pulsado el botón del ratón es posible arrastrar dispositivos o módulos a
slots permitidos de un rack.

<Ctrl> + botón del ratón pulsado

Copiar selección
Con <Ctrl> y manteniendo pulsado el botón del ratón es posible arrastrar dispositivos
o módulos a slots permitidos de un rack. En este caso, los dispositivos o módulos se
copian.

1.2

Configurar dispositivos

1.2.1

Introducción a la configuración de hardware
Para crear un sistema de automatización, los diferentes componentes de hardware deben
configurarse, parametrizarse y conectarse entre sí. Las tareas correspondientes se realizan en
la vista de dispositivos y redes.

Configurar
Se entiende por "configurar" la disposición, el ajuste y la interconexión de dispositivos y
módulos dentro de la vista de dispositivos o redes. Los racks se representan mediante
símbolos. Al igual que los racks "reales", permiten insertar un número determinado de
módulos.
A cada módulo se le asigna automáticamente una dirección. Las direcciones se pueden
modificar posteriormente.
Al arrancar el sistema de automatización, la CPU compara la configuración teórica creada por
software con la configuración real de la instalación. Esto permite detectar y notificar
inmediatamente los posibles errores.

40

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Parametrizar
Se entiende por "parametrizar" el ajuste de las propiedades de los componentes utilizados. Se
parametrizan los componentes de hardware y los ajustes para el intercambio de datos:
● Propiedades de módulos parametrizables
● Ajustes para el intercambio de datos entre componentes
Al arrancar, los parámetros se cargan en la CPU y se transfieren desde ella a los módulos
correspondientes. Es muy fácil sustituir módulos, porque los parámetros creados se
transfieren automáticamente al módulo nuevo al arrancar.

Adaptar el hardware a las necesidades del proyecto
Es necesario configurar el hardware al crear, ampliar o modificar un proyecto de
automatización. Para ello se agregan componentes de hardware a la instalación, se conectan
con los componentes existentes y se adaptan sus propiedades a las tareas.
Las propiedades de los sistemas de automatización y módulos están preajustadas de modo
que en muchos casos no es necesario realizar ninguna parametrización. Sin embargo, la
parametrización es necesaria en los siguientes casos:
● Cuando hay que modificar parámetros predeterminados de un módulo.
● Cuando hay que utilizar funciones especiales.
● Cuando hay que configurar conexiones.

1.2.2

Agregar un dispositivo a la configuración de hardware

Introducción
Para agregar un dispositivo conectable en red a la configuración de hardware existen las
posibilidades siguientes en la vista de redes y topológica:
● Comando "Agregar nuevo dispositivo" en el árbol del proyecto
● Doble clic en el dispositivo en el catálogo de hardware
● Drag & Drop del catálogo de hardware a la vista de redes o topológica:
– Entrada de texto de la paleta "Catálogo"
– Gráfico preliminar de la paleta "Información"
● Comando "Insertar > Dispositivo" de la barra de menús de la vista de redes o topológica
● Menú contextual de un dispositivo en el catálogo de hardware para "Copiar" y "Pegar"
Junto con el dispositivo nuevo se crea un rack adecuado. El dispositivo seleccionado se inserta
en el primer slot admisible del rack.
Independientemente del modo elegido, el dispositivo agregado será visible tanto en el árbol del
proyecto como en la vista de redes o topológica del editor de hardware y redes.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

41

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Agregar un dispositivo desde el árbol del proyecto
Para agregar un dispositivo a la configuración de hardware desde el árbol del proyecto,
proceda del siguiente modo:
1. Haga clic en el comando "Agregar nuevo dispositivo" en el árbol del proyecto.
Se abrirá el cuadro de diálogo "Agregar nuevo dispositivo".
2. Visualice el dispositivo deseado en la estructura de árbol:
– Navegue hasta el dispositivo deseado en la estructura de árbol.
– Introduzca un nombre en el campo de entrada.
3. Seleccione el dispositivo deseado en la estructura de árbol.
En la parte derecha del cuadro de diálogo aparece información relacionada con el
dispositivo seleccionado.
4. En caso necesario, ajuste la versión de firmware a través de la lista desplegable del cuadro
de diálogo.
5. Seleccione la casilla de verificación "Abrir la vista de dispositivos" si desea pasar a la misma
después de agregar el dispositivo.
Allí podrá continuar inmediatamente con la configuración del dispositivo y la ocupación del
rack.
6. Haga clic en "Aceptar" para agregar el dispositivo seleccionado.
Se cerrará el cuadro de diálogo.

Agregar un dispositivo desde el catálogo de hardware
Para agregar un dispositivo a la configuración de hardware desde el catálogo de hardware,
proceda del siguiente modo:
1. Abra la vista de redes o la vista topológica.
2. Abra el catálogo de hardware.
3. Navegue hasta el dispositivo deseado en el catálogo de hardware.
4. Seleccione el dispositivo deseado haciendo clic con el ratón.
5. En caso necesario, ajuste la versión de firmware a través de la lista desplegable del
catálogo de hardware.
6. Arrastre el dispositivo a la vista de redes o topológica con Drag & Drop.

Ahora ha colocado el dispositivo en la vista de redes o topológica. El rectángulo mostrado
(también "estación") simboliza el dispositivo insertado con su rack y, dado el caso, los módulos
subordinados. Haciendo doble clic en el dispositivo o la estación se abre la vista de
dispositivos, donde aparece el rack nuevo con el dispositivo insertado. En los pasos siguientes
se configura el dispositivo en la vista de dispositivos y se asignan módulos al rack.

42

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Consulte también
Vista de redes (Página 11)
Agregar una CPU sin especificar (Página 43)
Vista topológica (Página 21)

1.2.3

Agregar una CPU sin especificar

Introducción
Si todavía no se ha seleccionado ninguna CPU pero ya se empieza a programar o debe
utilizarse un programa existente, existe la posibilidad de utilizar una CPU sin especificar. En las
CPU sin especificar también es posible realizar algunos ajustes. Las posibilidades de ajuste se
limitan a los parámetros que son comunes en todas las CPU de la misma familia.

Agregar una CPU sin especificar en la vista de portal
Para agregar una CPU sin especificar en la vista de portal, proceda del siguiente modo:
1. Haga clic en una de las posibilidades siguientes:
– "Dispositivos y redes > Agregar nuevo dispositivo"
– "Programación PLC" > botón "Dispositivo"
2. Seleccione para una familia de dispositivos una CPU sin especificar de la estructura de
árbol del cuadro de diálogo "Agregar nuevo dispositivo".
3. Haga clic en "Agregar".
Se agrega una CPU sin especificar y se abre su vista de dispositivos.

Otras posibilidades para agregar una CPU sin especificar
En la vista del proyecto, las CPU sin especificar se agregan igual que las CPU especificadas:
● En el árbol del proyecto con el botón "Agregar nuevo dispositivo"
● En la Task Card "Catálogo de hardware"
Estos métodos también permiten agregar varias CPU sin especificar.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

43

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Especificar CPUs sin especificar
Existen dos posibilidades para especificar CPUs sin especificar:
● Asigne una CPU existente a una CPU sin especificar mediante el cambio de módulo
(Página 59) utilizando la función Drag & Drop desde el catálogo de hardware.
● Con la CPU sin especificar seleccionada, elija el comando de menú "Online > Detección de
hardware" y asígnele una CPU determinada online. Para tal fin, adjudique una dirección IP
con el botón "Agregar dirección para PG/PC".
Nota
Si desea pasar a online tras realizar la detección de hardware, deberá cargar primero la
configuración detectada en su proyecto, pues de lo contrario se puede producir un error
debido a configuraciones incoherentes. En el caso de la CPU del proyecto y la CPU
realmente existente, las referencias son idénticas tras la detección de hardware, pero no lo
son sus parámetros. Los parámetros de la CPU del proyecto tienen valores
predeterminados, y los parámetros de la CPU realmente existente, los valores ajustados
por el usuario.
Las CPU F presentan el mismo comportamiento que tras un cambio de módulo con una
CPU sin funciones de seguridad. A diferencia de las CPU F del catálogo de hardware, tras
sustituir un módulo por una CPU sin especificar o tras una detección de hardware, la
funcionalidad F está desactivada y el nivel de protección está ajustado a "Acceso completo
(sin protección)".

Consulte también
Seleccionar una CPU (Página 44)
Agregar un dispositivo a la configuración de hardware (Página 41)
Configurar dispositivo IO a través de la detección de hardware (Página 3143)

1.2.4

Seleccionar una CPU

Introducción
En la vista de redes se selecciona una CPU del catálogo de hardware y se crea junto con un
rack. Los módulos deseados se arrastran del catálogo de hardware al dispositivo y se ordenan
automáticamente en el rack.

Selección de los componentes en el catálogo de hardware
En el catálogo de hardware, todos los componentes se visualizan en forma de carpeta. Al abrir
dicha carpeta, aparecen las diferentes versiones de los componentes de hardware
seleccionados junto con sus respectivas referencias.
Aquí se muestra a modo de ejemplo cómo crear una CPU con un rack en la vista de redes.

44

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Requisitos
● El catálogo de hardware está abierto.
● Se encuentra en la vista de redes.

Procedimiento
Para seleccionar una CPU del catálogo de hardware, proceda del siguiente modo:
1. En el catálogo de hardware, navegue hasta la carpeta que contiene las CPUs deseadas.
2. Abra la carpeta con el tipo de CPU que busca. Aparecerán todas las referencias del tipo de
CPU seleccionado.
3. Haga clic en la referencia de una CPU para obtener información acerca de la CPU
seleccionada en la paleta "Información".

4. Cree la CPU y un rack. Para ello existen las posibilidades siguientes:
– Arrastre la CPU desde el catálogo de hardware hasta la vista de redes con la función
Drag & Drop.
– Copie la CPU en la vista de redes con la función de copiar y pegar.
– Haga doble clic en la entrada de la CPU del catálogo de hardware.

Consulte también
Examinar el catálogo de hardware (Página 32)
Agregar un dispositivo a la configuración de hardware (Página 41)
Rack: Enchufar módulo (Página 49)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

45

Configuración de dispositivos y redes
1.2 Configurar dispositivos
Rack: Principios básicos (Página 47)
Agregar una CPU sin especificar (Página 43)

1.2.5

Seleccionar módulos de seguridad

Introducción
Los sistemas de automatización de seguridad (sistemas F) sirven para controlar procesos con
un estado seguro que se alcanza inmediatamente por desconexión. Los sistemas F controlan
procesos cuya desconexión inmediata no supone ningún peligro ni para las personas ni para
el medio ambiente.

Selección de los componentes F en el catálogo de hardware
En el catálogo de hardware, todos los componentes se visualizan en forma de carpetas. Los
componentes de hardware de seguridad se muestran con símbolos amarillos en el catálogo de
hardware, al contrario que los componentes que no son de seguridad, que se muestran en
color azul.
La figura siguiente muestra un extracto del catálogo de hardware con una CPU F (amarilla).
El color ayuda a identificar fácil y rápidamente los componentes F dentro del catálogo de
hardware.

Visualización de los componentes F en el editor de hardware y redes
Si se utilizan dispositivos de seguridad y dispositivos "normales" en las vistas gráficas del
editor de hardware y redes, es posible reconocer fácilmente los primeros por su identificación
amarilla.
La figura siguiente muestra dos CPU. La CPU F está marcada en amarillo:

En la vista de dispositivos también es posible distinguir los módulos de seguridad en racks o
dispositivos gracias a su identificación amarilla. Puesto que los módulos no aptos para redes
no aparecen en la vista de redes ni en la vista topológica, los dispositivos con componentes F
no aptos para redes se muestran con un símbolo especial en la vista de redes y en la vista
topológica.
La figura siguiente muestra una CPU "normal" y una CPU F en la vista de redes, y ambas
disponen de componentes F:

46

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

La identificación cromática de los dispositivos y módulos de seguridad permite identificar
rápidamente los componentes F incluso en las vistas gráficas del editor de hardware y redes.

1.2.6

Rack: Principios básicos

Introducción
Para asignar módulos a un dispositivo se necesita un rack, p. ej. un perfil soporte. Los módulos
se fijan al rack y se conectan con la CPU, una fuente de alimentación u otros módulos a través
del bus de fondo.

Crear un rack
Cuando se inserta un dispositivo en la vista de redes se crean automáticamente una estación
y un rack adecuado al dispositivo seleccionado. En la vista de dispositivos aparece el rack con
los slots disponibles. El número de slots disponibles depende del tipo de dispositivo utilizado.

Estructura de un rack
Un rack contiene siempre el dispositivo que se ha insertado en la vista de redes. El dispositivo
está asignado de forma fija a un slot que, a su vez, depende del tipo de dispositivo. A la derecha
y, dado el caso, también a la izquierda del dispositivo hay otros slots, encima de los cuales
aparece el número correspondiente si tienen un módulo insertado.
Encima de los dispositivos y módulos insertados se indica el nombre abreviado
correspondiente. Este nombre se activa y desactiva con el comando "Mostrar rotulación del
módulo" del menú "Ver" de la barra de menús o con el botón correspondiente de la barra de
herramientas de la vista de dispositivos (Página 14).
Símbolo

Significado
Mostrar rotulación del módulo

Al seleccionar módulos en el catálogo de hardware, se marcan todos los slots que pueden
alojar dichos módulos. De este modo se reconoce inmediatamente en qué slot puede
insertarse el módulo seleccionado.
En la figura siguiente se ha seleccionado un módulo de señales del catálogo de hardware en
un rack parcialmente ocupado de un S7-1200:

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

47

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Puesto que los slots 101-103 están reservados para módulos de comunicación, sólo se
muestran como disponibles los demás slots libres.
El grupo de slots anterior se abre y se cierra por medio de un símbolo de flecha situado encima
del slot ampliable. Si está cerrado, se muestran el primer y último número de slot del grupo.
La figura siguiente muestra el grupo de slots abierto:

No es posible cerrar los grupos de slots con módulos ya insertados.

Selección múltiple de módulos y slots
Existen varias posibilidades para seleccionar varios módulos o slots:
● Selección de varios módulos o slots manteniendo pulsada la tecla <Mayús> o <Ctrl>.
● Clic con el ratón fuera del rack y manteniendo pulsado el botón del ratón: trazar un marco
alrededor de los módulos o slots que deben seleccionarse.

1.2.7

Rack: Reglas generales para los slots

Introducción
En cada sistema de automatización y en cada módulo rigen unas reglas específicas para los
slots.
Al seleccionar un módulo del catálogo de hardware en la vista de dispositivos, en el rack se
marcan todos los slots posibles para el módulo seleccionado. Los módulos solo pueden
arrastrarse a los slots marcados.
Si se inserta, desplaza o sustituye un módulo, también se aplican las reglas para los slots.

48

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Coherencia
Algunas reglas para slots dependen de la configuración del entorno. Esto significa que, a
veces, es posible enchufar módulos en el rack aunque esto dé lugar a incoherencias en ese
momento. Al modificar la configuración, p. ej. en vistas a seleccionar otros módulos o a
configurar los parámetros de los módulos, es posible restablecer la coherencia de la
configuración.
En los casos en los que la inserción de un módulo provoca una incoherencia corregible se
permite dicha inserción. Al compilar la configuración se comprueba la coherencia. Si se
detectan incoherencias, se notifican en la ventana de inspección, en "Información".
Dependiendo de cuáles sean los resultados de la comprobación de coherencia debe revisarse
la configuración y restablecer la coherencia.

Reglas para la disposición de los módulos
Para los módulos insertados en los racks rigen las reglas siguientes:
● En un rack solo se insertan módulos.
● En un módulo solo se insertan módulos de interfaz.
● En un rack se permite utilizar solo módulos de la misma familia de productos o sistemas.
Además, para algunos módulos se aplican estas reglas especiales:
● Posibilidad de insertar solo en determinados slots
● Posibilidad de insertar en función de otros módulos, CPUs o ajustes
● Restricción del número de usos en un rack

1.2.8

Rack: Enchufar módulo

Introducción
Después de haber agregado dispositivos del catálogo de hardware en la configuración desde
la vista de redes, es posible asignar módulos a dichos dispositivos. Existen las posibilidades
siguientes para insertar un módulo en un rack en la vista de dispositivos:
● Si hay un slot válido libre, hacer doble clic en un módulo del catálogo de hardware.
● Drag&Drop del catálogo de hardware a un slot válido libre en el área gráfica o de tabla:
– Entrada de texto de la paleta "Catálogo"
– Gráfico preliminar de la paleta "Información"
● "Copiar" del menú contextual de un módulo en el catálogo de hardware y "Pegar" del menú
contextual en un slot válido libre en el área gráfica o de tabla.
Para acceder a la vista de dispositivos desde la vista de redes, haga doble clic en un dispositivo
o estación en la vista de redes o utilice la ficha Vista de dispositivos. En la vista de dispositivos
hay una representación del dispositivo seleccionado dentro de un rack. La representación

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

49

Configuración de dispositivos y redes
1.2 Configurar dispositivos
gráfica del rack en el software se corresponde con la instalación real, es decir, hay tantos slots
visibles como en la instalación real.
Nota
También es posible arrastrar un módulo hasta un rack en la vista de redes. Para ello, la función
de filtro del catálogo de hardware debe estar desactivada. El módulo se insertará
automáticamente en un slot permitido y libre. Si no hay ningún slot disponible, el módulo se
desplazará al área de módulos no enchufados (Página 20).

Ocupación de un rack
Disponga los módulos en un rack siguiendo las reglas para slots correspondientes.
Después de insertar un módulo en un rack que ya tiene una CPU insertada se comprueban
automáticamente las áreas de direcciones para que no se asignen por duplicado. De este
modo, cada módulo tiene un área de direcciones válida una vez insertado. Para ello, los
esclavos DP y dispositivos IO deben estar conectados en red con una CPU a través del
correspondiente sistema maestro DP o sistema IO.

Requisitos
● Se encuentra en la vista de dispositivos.
● El catálogo de hardware está abierto.

Agregar un módulo desde el catálogo de hardware
La inserción de un módulo del catálogo de hardware en un rack se muestra siguiendo el
ejemplo de un módulo de señales digitales. Proceda del siguiente modo:
1. Navegue hasta el módulo deseado en el catálogo de hardware.
Nota
Si se activa la función de filtro del catálogo de hardware, sólo aparecerán los módulos
compatibles con el tipo de dispositivo seleccionado.
2. Seleccione el módulo deseado.

50

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos
3. En caso necesario, ajuste la versión de firmware a través de la lista desplegable del
catálogo de hardware.
4. Arrastre el módulo de señales hasta un slot libre del rack con la función Drag & Drop.

Ahora se ha insertado el módulo de señales digitales en un slot del rack. Proceda del mismo
modo con los demás módulos.
Encima de los módulos insertados se visualiza su nombre. La rotulación del módulo se activa
y desactiva mediante "Ver > Mostrar rotulación del módulo" de la barra de menús.

Insertar módulo
Los módulos también pueden insertarse con Drag & Drop entre otros módulos ya insertados.
Para ello, arrastre un módulo hasta que esté entre dos módulos insertados manteniendo
pulsado el botón del ratón.

Aparece una marca de inserción. Al soltar el puntero del ratón, todos los módulos insertados
a la derecha de la marca de inserción se desplazarán un slot a la derecha. Si sobrara un
módulo, se desplazaría al área de módulos no enchufados. El módulo nuevo se insertará en
el slot que ha quedado libre.

Consulte también
Vista de dispositivos (Página 14)
Vista de dispositivos: ubicación de los módulos no enchufados (Página 20)
Rack: Reglas generales para los slots (Página 48)
Reglas para módulos (Página 1241)
Reglas para módulos (Página 1242)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

51

Configuración de dispositivos y redes
1.2 Configurar dispositivos

1.2.9

Seleccionar un componente de hardware
Los componentes de hardware y otros objetos de las vistas gráficas se seleccionan haciendo
clic con el botón izquierdo del ratón. Si se arrastra el ratón manteniendo pulsado el botón
izquierdo o se utiliza la combinación de botón izquierdo del ratón y las teclas <Mayús> o <Ctrl>,
también es posible seleccionar varios objetos.
Los objetos siguientes pueden seleccionarse en las vistas gráficas: dispositivos (con CPU,
racks y módulos), CPU, CP, módulos, subredes, conexiones y nodos.

Reglas
Los objetos de las vistas gráficas se seleccionan de los siguientes modos:
● Haciendo clic con el botón izquierdo del ratón en un objeto: el objeto se selecciona.
● Haciendo clic con el botón izquierdo del ratón en un objeto con la tecla <Ctrl> pulsada: el
objeto se agrega a la selección actual.
● Haciendo clic con el botón izquierdo del ratón en un objeto con la tecla <Mayús> pulsada:
todos los objetos situados entre el objeto seleccionado actualmente y el que se seleccionó
anteriormente se agregan a la selección.
● Marco de selección con el botón izquierdo del ratón pulsado para arrastrar varios objetos:
todos los objetos rodeados completamente por el marco se agregan a la selección.
La selección múltiple solo es posible con objetos de la misma categoría:
● Categoría 1: dispositivos, subredes, conexiones, interconexiones de puerto
● Categoría 2: CPU, CP, módulos de interfaz / módulos
● Categoría 3: interfaces, puertos, nodos
Comportamiento en caso de selección múltiple de objetos de diferentes categorías:
● Marco de selección: solo se agregan a la selección múltiple los objetos de la categoría más
alta
● Clic con el botón izquierdo del ratón y <Mayús> o <Ctrl>: el último objeto seleccionado de
una categoría nueva permanece seleccionado, mientras que los objetos seleccionados
anteriormente se eliminan de la selección.
Nota
Selección múltiple de distintos tipos de objetos
En una selección múltiple solo pueden incluirse categorías iguales de objetos. Así, por
ejemplo, pueden seleccionarse varias CPU o varios segmentos. Sin embargo, no es posible
agregar a una selección múltiple primero un dispositivo, después solo la CPU de un segundo
dispositivo y finalmente solo la interfaz de un tercer dispositivo.

52

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Selección múltiple de dispositivos mediante un marco de selección
Para seleccionar varios dispositivos en la vista de redes arrastrando un marco de selección,
proceda del siguiente modo:
1. Con el botón izquierdo del ratón presionado, trace un marco alrededor de todos los
dispositivos que deben incluirse en la selección:

2. Suelte el botón del ratón. Ahora, todos los dispositivos que están dentro del marco trazado
forman parte de la selección múltiple.

En el ejemplo anterior se ha trazado un marco de selección alrededor de dispositivos enteros.
Si se traza el marco de forma que no se rodean dispositivos enteros sino solo las CPU que
están dentro, no se agregará todo el dispositivo a la selección múltiple sino solo las CPU. Si se
traza el marco de selección de forma que se rodean algunos dispositivos enteros y algunas
CPU, la categoría más alta de los objetos seleccionados es decisiva y solo se agregarán a la
selección múltiple los dispositivos enteros.

Selección múltiple de CPU utilizando la tecla <Mayús>
En lugar de la selección múltiple con un marco de selección también es posible seleccionar
varios objetos con la tecla <Mayús>. Con este método se seleccionan dos objetos para que
todos los objetos que estén situados entre estos dos se incluyan en la selección múltiple.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

53

Configuración de dispositivos y redes
1.2 Configurar dispositivos
Para seleccionar varias CPU de la vista topológica con la tecla <Mayús>, proceda del siguiente
modo:
1. Seleccione la primera CPU de la selección múltiple deseada con el botón izquierdo del
ratón:

2. Seleccione la última CPU de la selección múltiple deseada con el botón izquierdo del ratón
al mismo tiempo que mantiene pulsada la tecla <Mayús>. Las dos CPU seleccionadas se
comportan como límites de un marco de selección, que se representa aquí con la línea
naranja:

3. Todas las CPU situadas entre la primera y la última CPU seleccionadas se incluirán en la
selección múltiple:

En el ejemplo anterior solo se seleccionan CPU. Si en su lugar se seleccionan dispositivos
enteros, los dispositivos situados entre el primer y el segundo dispositivo seleccionados se
incluirán en la selección múltiple. Si se seleccionan tanto un dispositivo entero como una CPU,
la categoría del último objeto seleccionado es la que decide la categoría de todos los objetos
seleccionados.

Selección múltiple de dispositivos con las teclas <Ctrl> y <Mayús>
Una selección múltiple también se puede realizar con las teclas <Mayús> y <Ctrl>. En este
caso se seleccionan varios objetos con el botón izquierdo del ratón y la tecla <Ctrl>. Si a
continuación se selecciona un objeto con el botón izquierdo del ratón y la tecla <Mayús>, se
incluirán en la selección múltiple todos los objetos situados entre el objeto seleccionado
anteriormente y el último seleccionado.

54

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos
Para seleccionar varios dispositivos de la vista de dispositivos con las teclas <Mayús> y <Ctrl>,
proceda del siguiente modo:
1. Seleccione varios dispositivos individuales con el botón izquierdo del ratón al mismo tiempo
que mantiene pulsada la tecla <Ctrl>.

2. Seleccione el último dispositivo de la selección múltiple deseada con el botón izquierdo del
ratón al mismo tiempo que mantiene pulsada la tecla <Mayús>. Los dispositivos
seleccionados se comportan como límites de un marco de selección, que se representa
aquí con la línea naranja:

3. Ahora, todos los dispositivos del marco de selección virtual y las subredes incluidas en el
marco de selección se agregan a la selección múltiple.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

55

Configuración de dispositivos y redes
1.2 Configurar dispositivos
Solo se seleccionan categorías iguales de objetos. En el ejemplo anterior, además de los
dispositivos seleccionados se incluyen también las subredes rodeadas por el marco de
selección virtual, porque forman parte de la misma categoría que los dispositivos. Las
subredes PN/IE_4 y PN/IE_5 no estaban dentro del marco de selección virtual, por lo que no
se han incluido en la selección múltiple.

1.2.10

Copiar un componente de hardware
Los componentes de hardware se copian en la vista de dispositivos o redes. Los componentes
de hardware copiados se guardan en el portapapeles y pueden copiarse en otro lugar desde
este último. Las estaciones copiadas se insertan como nuevas en la vista de redes, los
dispositivos y módulos copiados pueden insertarse en los racks existentes en la vista de redes
y dispositivos.

Reglas
● Se pueden copiar tanto objetos individuales como varios objetos al mismo tiempo.
● Es posible copiar módulos insertados del rack y del área de módulos no enchufados.
● Sólo es posible copiar dispositivos y módulos en slots válidos y libres observando las reglas
para slots.
● Los racks con una CPU insertada no pueden copiarse individualmente, sino sólo completos
junto con todos los componentes de hardware insertados.

Procedimiento
Para copiar un componente de hardware, proceda del siguiente modo:
1. Seleccione el componente de hardware que desea copiar.
– Vista de dispositivos: seleccione el módulo en un rack o en el área de módulos no
enchufados.
– Vista de redes o topológica: seleccione la estación o el componente de hardware
relevante para la vista de redes.
– Árbol del proyecto: seleccione la estación o el módulo.
2. Elija "Copiar" del menú contextual o pulse <Ctrl+C>.
Si el comando de menú "Copiar" está atenuado, significa que la selección contiene al
menos un componente que no se puede copiar.

56

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos
3. Seleccione el lugar en el que debe insertarse el contenido del portapapeles.
– En la vista de dispositivos, seleccione un slot libre del rack o el área de módulos no
enchufados.
– En la vista de redes o topológica, seleccione una estación para insertar dispositivos o
módulos.
4. Elija "Pegar" del menú contextual o pulse <Ctrl+V>.
– Si el objeto copiado se inserta con <Ctrl+V> sin selección en la vista de redes o
topológica, se insertará a la derecha del objeto original.
– Si el objeto copiado se inserta con el menú contextual sin selección en la vista de redes
o topológica, se colocará en el lugar donde está el puntero del ratón.
Si el comando de menú "Pegar" está atenuado, significa que el portapapeles está vacío o
que contiene al menos un componente que no se puede pegar en este lugar.
El objeto copiado se insertará en el lugar elegido.
Si se ha seleccionado una estación en la vista de redes o topológica para insertar un módulo,
dicho módulo se insertará en el primer slot válido y libre. Si no hay ninguno, el objeto se
insertará en el área de módulos no enchufados.
Nota
También es posible copiar un módulo de un dispositivo a otro:
Para ello, copie un módulo en el editor de hardware y redes, seleccione otro dispositivo en la
vista de redes o topológica o en la lista desplegable de la vista de dispositivos e inserte el
módulo.
En la vista de dispositivos, el objeto copiado puede insertarse directamente en un slot o en el
área de módulos no enchufados. Si el objeto copiado se agrega a un dispositivo o estación en
la vista de redes, se insertará en el primer slot libre.
Si no hay ningún slot disponible para el objeto, se insertará automáticamente en el área de
módulos no enchufados (Página 20).
Nota
También es posible copiar cualquier componente de hardware directamente con <Ctrl> y Drag
& Drop.

Consulte también
Comandos de teclado: editar objetos (Página 39)

1.2.11

Desplazar un componente de hardware
Los componentes de hardware se desplazan en la vista de dispositivos o redes.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

57

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Reglas
● Es posible desplazar dispositivos y módulos del rack y del área de módulos no enchufados
observando las reglas para slots.
● Los CPs no se pueden desplazar en la vista de redes. El CP se inserta en un slot libre y
válido del dispositivo de destino. Si no hay ningún slot libre, el CP que se va a insertar se
desplaza al área de módulos no enchufados.
● Las CPUs y los módulos de cabecera esclavos pueden desplazarse entre los dispositivos
de la vista de redes e incluso dentro del rack, según sea el tipo de CPU.
Nota
Los CPs desplazados se desconectan de su red, pero conservan los parámetros de red y la
dirección. Si el CP se conecta de nuevo a la red pero su dirección se ha utilizado en otro lugar,
es posible asignar una nueva dirección unívoca al CP desde un cuadro de diálogo.

Procedimiento
Para desplazar un componente de hardware, proceda del siguiente modo:
1. Seleccione el componente de hardware que desea desplazar.
– Vista de dispositivos: Seleccione el módulo en un rack o en el área de módulos no
enchufados.
– Vista de redes: seleccione el componente de hardware relevante para la vista de redes.
2. Elija "Cortar" del menú contextual o pulse <Ctrl+X>.
Si el comando de menú "Cortar" está atenuado, significa que la selección contiene al menos
un componente que no se puede cortar.
3. Seleccione el lugar al que debe desplazarse el objeto cortado.
– Vista de dispositivos: Seleccione un slot libre del rack o el área de módulos no
enchufados.
– Vista de redes: seleccione una estación para insertar dispositivos o módulos.
4. Elija "Pegar" del menú contextual o pulse <Ctrl+V>.
Si el comando de menú "Pegar" está atenuado, significa que el portapapeles está vacío o
que contiene al menos un componente que no se puede pegar en este lugar.
El componente de hardware seleccionado se desplazará a la ubicación de destino. Si el
componente de hardware desplazado es un objeto conectado en red, se desacoplará de la red.
Nota
También es posible desplazar cualquier componente de hardware directamente con Drag &
Drop.

Consulte también
Comandos de teclado: editar objetos (Página 39)

58

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

1.2.12

Sustituir un componente de hardware
Los componentes de hardware se pueden sustituir. Esto permite, por ejemplo,
reemplazar CPUs no especificadas (Página 43) por CPUs disponibles del catálogo de
hardware.

Reglas
Sólo está permitido sustituir componentes de hardware que soporten el cambio de módulo y
sean compatibles entre sí.

Procedimiento
Para sustituir módulos, proceda del siguiente modo:
1. Seleccione el módulo que desea sustituir.
2. Abra el menú contextual:
– Si la entrada "Sustituir dispositivo" está activada, se podrán sustituir los módulos.
– Si la entrada "Sustituir dispositivo" está desactivada, no se podrán sustituir los módulos.
3. Haga clic en la entrada "Sustituir dispositivo" del menú contextual. Se abre el cuadro de
diálogo "Sustituir dispositivo".
4. En "Dispositivo nuevo" de la estructura de árbol seleccione el módulo que reemplazará al
módulo actual.
5. Haga clic en "Aceptar".
6. Compile el hardware y software.
El módulo existente será reemplazado por el nuevo.
Otra posibilidad es arrastrar directamente un módulo desde el catálogo de hardware hasta el
módulo que debe sustituirse con la función Drag & Drop. Un símbolo en el puntero del ratón
indicará si es posible sustituir los dos módulos.

1.2.13

Cambiar el nombre de un componente de hardware
Los nombres de los componentes de hardware pueden editarse cómodamente en el área
gráfica de las tres vistas (vista de redes, vista de dispositivos y vista topológica), pero también
en las áreas de tabla correspondientes o en la ventana de inspección.

Reglas
Los nombres de los componentes de hardware pueden cambiarse de los siguientes modos:
● En la vista gráfica tras seleccionar el nombre visualizado.
● En la vista de tabla, en la fila de la tabla que contiene el nombre que debe modificarse.
● En la ventana de inspección, en "Propiedades > General" del componente de hardware
seleccionado.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

59

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Procedimiento
Para cambiar el nombre de un componente de hardware en el área gráfica de una vista,
proceda del siguiente modo:
Para la vista de dispositivos se aplica lo siguiente:
1. Active la visualización de los nombres de módulos mediante el botón correspondiente de la
barra de herramientas.
2. Seleccione el componente de hardware o su nombre.
3. Ahora dispone de dos opciones:
– Pulse <F2>.
– Haga clic en el nombre seleccionado anteriormente.
4. Edite el nombre.

Para la vista de redes y topológica se aplica lo siguiente:
1. Seleccione el componente de hardware o su nombre.
2. Ahora dispone de tres opciones:
– Pulse <F2>.
– Haga clic en el nombre seleccionado anteriormente.
– Elija el comando "Cambiar nombre" del menú contextual.

60

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos
Para editar nombres en el área de tabla seleccione en la tabla la celda que contiene el nombre
que quiere editar. Seguidamente, vuelva a hacer clic en el nombre para poder editarlo
directamente en la celda.
Para la edición de nombres en la ventana de inspección seleccione en el área gráfica el
componente de hardware cuyo nombre quiere editar. En la ventana de inspección se muestran
los parámetros relevantes. Ahora pueden editarse los nombres en "Propiedades > General".

Consulte también
Vista de redes (Página 11)
Vista de dispositivos (Página 14)
Vista topológica (Página 21)
Ventana de inspección (Página 24)

1.2.14

Borrar un componente de hardware
Los componentes de hardware se borran de diferentes maneras. Los componentes de
hardware borrados se eliminan del sistema y las direcciones ocupadas vuelven a estar
disponibles.

Reglas
● Es posible borrar CPUs o módulos del rack y del área de módulos no enchufados.
● Si se borra un rack en la vista de dispositivos, los componentes de hardware insertados se
desplazan al área de módulos no enchufados.

Procedimiento
Para borrar un componente de hardware, proceda del siguiente modo:
1. Seleccione el componente de hardware que desea borrar.
– Vista de redes: en la vista gráfica o en la vista general de redes seleccione dispositivos
o componentes de hardware relevantes para la red.
– Vista de dispositivos: en la vista gráfica o en la vista general de dispositivos seleccione
racks o módulos de los racks o del área de módulos no enchufados.
– Vista topológica: en la vista gráfica o en la vista topológica general de redes dispositivos
o componentes de hardware con interfaces Ethernet.
– Árbol del proyecto: seleccione los dispositivos o componentes de hardware individuales
de la estructura de árbol.
2. Elija "Borrar" del menú contextual o pulse <Supr>.
Si el comando de menú "Borrar" está atenuado, significa que la selección contiene al menos
un componente que no se puede borrar.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

61

Configuración de dispositivos y redes
1.2 Configurar dispositivos
Los componentes de hardware seleccionados se borran.
Nota
Al borrar componentes de hardware es posible que el proyecto presente incoherencias, p. ej.
violación de reglas para slots. Con la comprobación de coherencia se notificarán las
incoherencias. Elimínelas realizando las acciones pertinentes, p. ej. restableciendo la
observación de las reglas para slots.

Consulte también
Comandos de teclado: editar objetos (Página 39)

1.2.15

Cambiar o actualizar componentes de hardware

Explicación de términos
La versión de firmware de un componente de hardware se puede cambiar a una versión nueva
(si está disponible) o, en determinadas circunstancias, se pueden utilizar funciones nuevas del
componente de hardware con una actualización de la descripción del módulo.
A continuación se explican con detalle los términos "descripción del módulo" y "versión de
firmware".
● Descripción del módulo: es la versión del software de configuración de la que se deriva la
descripción técnica del módulo.
Ej.: V11.0.0.0
● Versión de firmware: es la versión del firmware del módulo parametrizado offline
Ej.: V2.0

Requisitos
● Ha creado una configuración de dispositivos.
● Posteriormente, ha instalado una actualización o un paquete opcional, por ejemplo. Debido
a dicha instalación se ha actualizado la descripción de un tipo de módulo como mínimo en
el catálogo de hardware, pero la nueva versión de la descripción es incompatible con la
anterior.
● Ha utilizado estos módulos en la configuración de dispositivos y desea aprovechar las
propiedades modificadas o agregadas.

62

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Procedimiento
Realice los pasos siguientes para cada uno de los tipos de módulo afectados.
1. Seleccione un módulo afectado en la vista de dispositivos.
2. Vaya a "Propiedades > General > Información de catálogo" en la ventana de inspección.
Haga clic en el botón "Actualizar descripción del módulo".
3. En la ventana que aparece, especifique si desea actualizar solo la descripción del módulo
seleccionado o la de todos los módulos de este tipo en el proyecto actual.

Resultado
En el proyecto actual se reemplazan los módulos seleccionados por los mismos módulos con
una descripción actualizada.

¿En qué casos no es necesario actualizar la descripción del módulo?
La actualización de la descripción del módulo es innecesaria en los casos siguientes:
● No se quieren aprovechar las propiedades modificadas o agregadas de los módulos.
● Se abre un proyecto existente con una versión del software de configuración más reciente
que la versión con la que se ha creado el proyecto, y el sistema lleva a cabo una conversión
automática del proyecto, p. ej., de TIA Portal V12 a V13. En este caso se adaptan
automáticamente todas las descripciones de módulo no actualizadas.

1.2.16

Editar las propiedades y los parámetros
Una vez insertados los componentes de hardware en el rack puede proceder a modificar sus
propiedades predeterminadas en la vista de redes, dispositivos o topología, p. ej. nombres,
parámetros o direcciones.

Requisitos
Se encuentra en la vista de redes, dispositivos o topología.
Nota
Las diferentes vistas permiten editar las propiedades y los parámetros relevantes tanto en la
vista gráfica como en la vista de tabla. Los parámetros que pueden editarse dependen de la
vista en la que se encuentre. Desde la vista gráfica de redes se accede a la estación y a los
componentes de hardware relevantes para la red. Desde el área de tabla de la vista de redes
se accede a los módulos y componentes de hardware que no aparecen en la vista gráfica. En
la vista topológica y en la vista de dispositivos se dispone también de acceso a otros
parámetros relacionados con la topología o los dispositivos.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

63

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Procedimiento
Para modificar las propiedades y los parámetros de los componentes de hardware en la vista
de dispositivos, proceda del siguiente modo:
1. En la representación gráfica, seleccione la CPU, el módulo, el rack o la interfaz que desee
editar.
2. Edite los ajustes del objeto seleccionado:
– En el área gráfica, por ejemplo, puede modificar los nombres de los objetos si está
activada la rotulación del módulo.
– En el área de tabla pueden modificarse las direcciones y los nombres, por ejemplo.
– En "Propiedades" de la ventana de inspección existen las posibilidades de ajuste más
variadas.
Tenga en cuenta que los módulos solo pueden parametrizarse por completo cuando están
asignados a una CPU. Por ello, los módulos de interfaz PROFIBUS o PROFINET deben
conectarse en red primero con la CPU o con un módulo de comunicación que esté insertado
centralmente, de modo que se forme un sistema maestro o un sistema IO. Solo entonces será
posible editar las direcciones de los componentes que estén insertados de forma
descentralizada, por ejemplo.

64

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Ejemplo de la modificación de ajustes








①
②
③
④

Selección de un módulo
Posibilidad de edición de direcciones en la vista general de dispositivos
Posibilidades de selección en la ventana de inspección
Posibilidad de edición de direcciones en la ventana de inspección

Consulte también
Ventana de inspección (Página 24)

1.2.17

Direcciones de entrada y salida en la vista de direcciones

Introducción
En la vista de direcciones pueden mostrarse, en forma de tabla, las direcciones de entrada y
salida actualmente utilizadas. La vista de direcciones se encuentra en "Propiedades" de la
CPU, dentro de la ventana de inspección.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

65

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Estructura de la vista de direcciones
Podrá ajustar qué objetos deberán mostrarse en la vista de direcciones a través de distintas
casillas opcionales:
● Entradas: Visualización de direcciones de entrada
● Salidas: Visualización de direcciones de salida
● Huecos en las direcciones: Visualización de áreas libres de dirección
● Slot: Visualización del número de slot
Normalmente, en la vista de direcciones se muestra la siguiente información:
Encabezado de la tabla

Significado

Tipo

Tipo de área de direcciones. Indica si el área de direcciones es de entrada
o salida.
● I = Dirección de entrada de módulo con espacio de direcciones de
periferia de entrada (con longitud > 0)
● I* = Dirección de entrada o de diagnóstico de módulos sin espacio de
direcciones de periferia de entrada (con longitud = 0). Estas direcciones
no permiten intercambiar datos (estados de señal o valores medidos)
en el programa de usuario. Se usan para notificar eventos de
diagnóstico del sistema operativo (p. ej. en la información de arranque
de los OB de error).
● Q = Dirección de salida

Dir. desde

Dirección inicial del área de direcciones. Muestra la primera dirección asig‐
nada de la entrada o salida.

Dir. hasta

Dirección final del área de direcciones. Muestra la última dirección asigna‐
da de la entrada o salida.

Tamaño

Longitud del área de direcciones asignada por el módulo para la entrada o
salida.
Ejemplos:
● Si la dirección inicial es 0 y la dirección final es 1, la longitud de la
dirección es de 2 bytes.
● Si la dirección inicial es 0 y la dirección final es 3, la longitud de la
dirección es de 4 bytes.
● Si la dirección inicial es 0.1 y la dirección final es 0.2, la longitud de la
dirección es de 2 bits.
● Si las direccones inicial y final son idénticas, se indican 0 bytes.

66

Módulo

Módulo cuya área de direcciones se utiliza.

Rack

Número del rack donde se encuentra enchufado el componente de hard‐
ware.

Slot

Número del slot donde se encuentra enchufado el componente de hard‐
ware en el rack.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos
Encabezado de la tabla

Significado

Nombre de dispositivo

Nombre y tipo del dispositivo en el que está enchufado el módulo.
Ejemplos:
● El módulo está enchufado en un PLC denominado "PLC_1" y del tipo
CPU 1516-3 PN/DP; se indicará "PLC_1 [CPU 1516-3]".
● El módulo está enchufado en un módulo de cabecera denominado "IO
Device_1" y del tipo IM 151-3 PN; se indicará "IO Device_1 [IM 151-3
PN]".

Número de dispositivo

Número de dispositivo PROFINET o dirección PROFIBUS si el módulo
está conectado a un PLC a través de PROFINET o PROFIBUS. Si el mó‐
dulo está enchufado directamente en un PLC se mostrará "-".
Ejemplos:
● El módulo está enchufado en un módulo de cabecera que está
conectado a un PLC a través de una interfaz PROFINET; se indicará el
número de dispositivo de la dirección Ethernet.
● El módulo está enchufado en un esclavo DP que está conectado a un
PLC a través de una interfaz PROFIBUS; se mostrará el parámetro de
la dirección PROFIBUS.

Sistema maestro/IO

Nombre del sistema maestro DP o del sistema IO que se utiliza para co‐
nectar el esclavo DP o el dispositivo IO al PLC. Entre corchetes se muestra
el número correspondiente del sistema maestro DP o del sistema IO. Si el
módulo está enchufado directamente en un PLC se mostrará "-".
Ejemplos:
● El módulo está enchufado en un dispositivo IO y conectado a un PLC a
través de un sistema PROFINET IO denominado "PROFINET IOSystem_1" con el número 100. Se muestra "PROFINET IO-System_1
[100]".
● El módulo está enchufado en un esclavo DP y conectado a un PLC a
través de un sistema maestro PROFIBUS DP denominado "DPMastersystem" con el número 1. Se muestra "DP-Mastersystem [1]".

OB

Bloque de organización asignado a la memoria imagen de proceso. El OB
de ciclo "Main" se refiere siempre a la actualización automática de la me‐
moria imagen de proceso.
Esta columna no está disponible en todas las CPU.

IPP

Memoria imagen parcial de proceso. Indica si la dirección se actualiza
automáticamente a través de la memoria imagen de proceso cíclica o si se
encuentra en una memoria imagen parcial de proceso, cuya actualización
debe lanzarse explícitamente.
Consulte más abajo la descripción "Memoria imagen parcial de proceso
IPP".

Memoria imagen parcial de proceso IPP
La columna de la tabla "IPP" muestra la asignación de la dirección a la memoria imagen de
proceso cíclica o a una memoria imagen parcial de proceso (IPP).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

67

Configuración de dispositivos y redes
1.2 Configurar dispositivos
En S7-300/400:
● "IP OB1": la dirección está asignada a la memoria imagen de proceso cíclica. El sistema
operativo actualiza automáticamente esta dirección en cada ciclo del programa.
● "IPP x": la dirección está asignada a la memoria imagen parcial de proceso x (p. ej. IPP 1,
no a la memoria imagen de proceso cíclica). El sistema operativo actualiza esta IPP cuando
ejecuta el OB asignado. Si la IPP no tiene asignado ningún OB, el sistema operativo no la
actualiza. El usuario dispone de la posibilidad de actualizar la IPP en el programa de
usuario con las instrucciones "UPDAT_PI" y "UPDAT_PO" (en S7-400 y algunas CPU
S7-300).
En S7-1200:
● "Actualización automática": la dirección está asignada a la memoria imagen de proceso
cíclica (IPP 0). El sistema operativo actualiza automáticamente esta dirección en cada ciclo
del programa.
● "Ninguna": la dirección no está asignada a ninguna memoria imagen parcial de proceso. En
el programa de usuario se accede directamente a esta dirección (acceso directo a periferia,
sin memoria imagen de proceso).
● "IPP x": el sistema operativo actualiza esta IPP cuando ejecuta el OB asignado. Si la IPP no
tiene asignado ningún OB, el sistema operativo no la actualiza. Existe la posibilidad de leer
entradas o escribir salidas en el programa de usuario por medio de accesos directos a
periferia. Las instrucciones "UPDAT_PI", "UPDAT_PO", "SYNC_PI" y "SYNC_PO" no
están soportadas en S7-1200.
● "IPP OB Servo": La memoria imagen parcial de proceso "IPP OB Servo" no está asignada
a ningún bloque de organización (ajuste fijo en el bloque de organización: "---(ninguna)").
El sistema operativo no actualiza esta IPP ni tampoco las direcciones que contiene: en el
programa de usuario se accede directamente a las direcciones (acceso directo a periferia).
En S7-1500:
● "Actualización automática": la dirección está asignada a la memoria imagen de proceso
cíclica (IPP 0). El sistema operativo actualiza automáticamente esta dirección en cada ciclo
del programa.
● "None": la dirección no está asignada a ninguna memoria imagen parcial de proceso. En el
programa de usuario se accede directamente a esta dirección (acceso directo a periferia,
sin memoria imagen de proceso).
● "IPP x" (IPP 1 a IPP 31): El sistema operativo actualiza la IPP x cuando ejecuta el OB
asignado. Si la IPP no tiene asignado ningún OB, el sistema operativo no actualiza la IPP
x. El usuario dispone de la posibilidad de actualizar la IPP x en el programa de usuario con
las instrucciones "UPDAT_PI" y "UPDAT_PO". Si la IPP x está asignada a un OB de alarma
de sincronismo (OB 61 a OB 64), el sistema operativo no la actualiza: el usuario dispone de
la posibilidad de actualizar la IPP x en el programa de usuario con las instrucciones
"SYNC_PI" y "SYNC_PO".
● "IPP OB Servo": la memoria imagen parcial de proceso "IPP OB Servo" está asignada de
forma fija al OB "MC-Servo". STEP 7 genera este OB automáticamente cuando se crea un
objeto tecnológico en la sección Motion Control. Al ejecutar el OB se actualiza la IPP OB
Servo de forma isócrona. Todos los accionamientos y encóders utilizados por Motion
Control están asignados a esta memoria imagen parcial de proceso.

68

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Consulte también
Definir las direcciones de entrada y salida (Página 1598)

1.2.18

Periferia descentralizada en el árbol del proyecto
Las unidades periféricas descentralizadas se muestran en carpetas propias dentro del árbol
del proyecto. En función de si un dispositivo se ha asignado a un sistema PROFINET IO, a un
sistema maestro DP o a ninguno, dicho dispositivo se mostrará como nodo o vínculo al
dispositivo en una de las carpetas que se describen a continuación.

Carpeta "Dispositivos no agrupados" en el proyecto
En la carpeta "Dispositivos no agrupados" se reúnen todos los periféricos descentralizados del
proyecto.
Los símbolos de las carpetas y los vínculos muestran el estado "asignado" por medio de
marcas cromáticas: Los dispositivos PROFINET IO están marcados en verde, los esclavos
PROFIBUS DP en magenta y el resto de periféricos descentralizados no están marcados de
ninguna forma especial.
Los símbolos de las carpetas y los vínculos muestran el estado "no asignado" por medio de un
interrogante.

Si se ha establecido una conexión con un dispositivo IO o un esclavo DP por medio de la
función "Establecer conexión online", la misma información de diagnóstico (p. ej. marca de
verificación verde) se muestra en el árbol del proyecto tanto para el vínculo de un dispositivo
como para el propio dispositivo. Para más información al respecto, consulte el capítulo "Vista
en modo online".
Existe la posibilidad de copiar o mover unidades periféricas descentralizadas de la carpeta
"Dispositivos no agrupados" a otro lugar del árbol del proyecto, pero no la propia carpeta. Los
destinos posibles son la carpeta del proyecto o una carpeta del dispositivo. Y a la inversa, es
posible volver a copiar o mover unidades periféricas descentralizadas a la carpeta
"Dispositivos no agrupados".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

69

Configuración de dispositivos y redes
1.2 Configurar dispositivos
Haciendo doble clic en el vínculo se accede a la vista de dispositivos, donde puede
configurarse la unidad periférica descentralizada.

Carpeta "Dispositivos no asignados" en el proyecto
Los dispositivos que no están asignados a ningún sistema de periferia descentralizada se
muestran como vínculo en la carpeta "Dispositivos no asignados".
Los símbolos de la carpeta y el vínculo del dispositivo correspondiente en el árbol del proyecto
presentan un interrogante que indica que no están asociados a ningún sistema de periferia
descentralizada. El vínculo está marcado con una pequeña flecha.

La visualización en forma de vínculo en el árbol del proyecto permite seleccionar
individualmente dispositivos IO o esclavos DP con el fin de elegir el destino del vínculo, por
ejemplo. También sigue siendo posible seleccionar grupos de dispositivos.
Haciendo doble clic en el vínculo se accede a la vista de dispositivos, donde puede
configurarse la unidad periférica descentralizada.

Carpeta "Periferia descentralizada" en un dispositivo
Si se asigna un dispositivo IO a un sistema PROFINET IO, se mostrará como vínculo en el
árbol del proyecto, debajo del nodo "Periferia descentralizada > Sistema PROFINET IO".
De modo similar, un esclavo DP asignado a un sistema maestro DP se mostrará como vínculo
debajo del nodo "Periferia descentralizada > Sistema maestro DP".
El vínculo remite al correspondiente dispositivo IO o esclavo DP en el árbol del proyecto.
Los símbolos del nodo y el vínculo del dispositivo correspondiente en el árbol del proyecto
indican si están asociados a PROFINET (verde) o a PROFIBUS (magenta). El vínculo está
marcado con una pequeña flecha.

70

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.2 Configurar dispositivos

Las pasarelas se muestran en forma de enlace debajo del maestro DP/nodo IO al que están
asignadas.
Haciendo doble clic en el vínculo se accede a la vista de dispositivos, donde puede
configurarse la unidad periférica descentralizada.

1.2.19

Comparar dispositivos

1.2.19.1

Principios básicos de la comparación de dispositivos

Funcionamiento
Existe la posibilidad de comparar los componentes de hardware de dos dispositivos con el fin
de determinar posibles diferencias. Para ello puede realizar una comparación offline/offline.
Los dispositivos que se compararán pueden proceder de un proyecto o de proyectos
diferentes.
Es posible comparar tanto periferia centralizada como descentralizada. Los dispositivos que
se compararán se pueden asignar automática o manualmente. La asignación automática de
periferia centralizada se realiza a partir del número de slot. En el caso de la periferia
descentralizada, la asignación automática puede realizarse conforme a los siguientes criterios:
● Asignación por dirección/ID de hardware: la asignación se realiza a través de las
direcciones o las ID de los dispositivos. Este criterio es adecuado para la comparación de
dispositivos que se encuentran dentro de un proyecto.
● Asignación por nombre: la asignación se basa en los nombres de los dispositivos. Este
criterio es adecuado para la comparación de dispositivos que se encuentran en proyectos
diferentes.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

71

Configuración de dispositivos y redes
1.2 Configurar dispositivos
El usuario puede decidir el tipo de asignación por sí mismo o dejar que lo haga el sistema. En
este último caso, el sistema elije la asignación en función del contexto.
Para comparar los módulos de la periferia descentralizada, inicie una comparación offline/
offline de las estaciones descentralizadas afectadas.

Consulte también
Realizar una comparación de dispositivos (Página 72)

1.2.19.2

Realizar una comparación de dispositivos

Procedimiento
Para realizar una comparación de dispositivos, proceda del siguiente modo:
1. Seleccione en el árbol del proyecto un dispositivo que permita una comparación offline/
offline.
2. Elija el comando "Comparar > offline/offline" del menú contextual.
Se abre el editor de comparación y el dispositivo seleccionado se muestra en el área
izquierda.
3. Abra la ficha "Hardware".
4. Arrastre otro dispositivo mediante Drag & Drop a la superficie de arrastre del área derecha.
Todos los objetos disponibles de los dispositivos seleccionados se muestran en función de
los ajustes realizados en la ficha "Hardware" del editor de comparación y se lleva a cabo
una comparación automática. Los símbolos del editor de comparación indican el estado de
los objetos comparados. En el área "Comparación de propiedades" encontrará un
resultado detallado de los submódulos.
5. Para modificar el criterio de asignación, haga clic en la barra de herramientas en la flecha
del botón "Mostrar criterios de asignación disponibles". Seleccione el criterio de asignación
que desea utilizar.
6. Si desea realizar una comparación manual, haga clic sobre el área de estado en el botón
para conmutar entre la comparación automática y manual. Seguidamente, seleccione los
objetos que desea comparar.
Se muestra la comparación de propiedades. Los símbolos indican el estado de los objetos.

Consulte también
Principios básicos de la comparación de dispositivos (Página 71)

72

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

1.3

Configurar redes

1.3.1

Conectar dispositivos en red

1.3.1.1

Comunicación y redes

Comunicación entre dispositivos
La base para cualquier tipo de comunicación es siempre una red previamente configurada.
Con la configuración de red se organiza la accesibilidad necesaria de los diferentes
dispositivos de red para la comunicación. Para el intercambio de mensajes en la red S7 deben
cumplirse los siguientes requisitos:
● Asignación de direcciones topológicas S7 unívocas a todos los dispositivos de la red
● Aseguramiento de la interconexión de los circuitos a través de secciones de cable físicas
● Comunicación de los dispositivos con propiedades de transferencia coherentes

Definición
A través de la red, los diferentes equipos y terminales (PC, PG, PLC, AS) se conectan entre sí
utilizando módulos de interfaz, cables físicos y el software adecuado. Los dispositivos
conectados en red pueden intercambiar datos entre sí. La conexión en red puede realizarse
con cable o mediante una red inalámbrica, p. ej. WLAN.
Desde el punto de vista de la red, las diferentes formas de cableado derivan en diferentes
subredes S7. Una subred S7 forma parte de toda la red S7. Los parámetros de los dispositivos
de una subred S7 (p. ej. con PROFIBUS) deben ser unitarios en cuanto al cableado físico. Una
subred S7 física abarca los componentes de bus y todos los dispositivos conectados. Las
subredes S7 que se encuentran en cableados físicos diferentes pueden acoplarse en la red S7
mediante pasarelas o routers.

Configuración de una red
Para configurar la red S7 son necesarios los siguientes pasos:
● Conectar dispositivos con una subred S7
● Definir las propiedades y los parámetros de cada subred S7
● Definir las propiedades de los dispositivos para cada módulo conectado en red (p. ej.
dirección topológica S7 unívoca)
● Cargar los datos de configuración en los dispositivos para proporcionar a las interfaces los
ajustes resultantes de la configuración de red S7
● Documentar la configuración de red S7
Para la Open User Communication, la creación y configuración de una subred S7 es soportada
por la parametrización de la conexión.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

73

Configuración de dispositivos y redes
1.3 Configurar redes

Relación entre la configuración de redes y el proyecto
Dentro de un proyecto, las subredes S7 se gestionan junto con sus propiedades. Las
propiedades resultan básicamente de los parámetros de red S7 ajustables y del número y las
propiedades de comunicación de los dispositivos conectados.
Los nodos que hay que conectar en red deben estar dentro del mismo proyecto.

Nombre e ID de la subred S7
Las subredes S7 se identifican unívocamente dentro del proyecto con un nombre y una ID de
subred S7. La ID de subred S7 está almacenada en todos los componentes con interfaces
conectables en red. De este modo, es posible asignar componentes a una subred S7 de forma
unívoca incluso después de cargarlos en un proyecto.
Las subredes S7 existen en dos posibles variantes:
● Cableado Ethernet físico ("línea verde")
● Interconexión PROFIBUS física ("línea violeta")

Posibilidades de la conexión en red
En el proyecto pueden crearse y conectarse en red dispositivos con componentes aptos para
la comunicación. Para conectar los dispositivos en red existen básicamente las posibilidades
siguientes:
● Conectar entre sí las interfaces de los componentes aptos para la comunicación. De este
modo se creará una subred S7 nueva adecuada al tipo de interfaz.
● Conectar la interfaz de los dispositivos aptos para la comunicación con una subred S7
nueva o ya existente.
● Crear una conexión de la Open User Communication. Al parametrizar la conexión de la
Open User Communication se creará automáticamente una subred S7 entre los
interlocutores.
● Configurar conexiones mediante la configuración gráfica de conexiones; las conexiones en
red que faltan se detectan y se crean de forma automática o con la ayuda de un cuadro de
diálogo.
Debido a las diferentes tareas de los dispositivos o a la extensión de la instalación es posible
que se requieran varias subredes S7. Dichas subredes S7 se gestionan en un proyecto.

1.3.1.2

Conectar dispositivos en red en la vista de redes

Opciones
La vista gráfica de redes ofrece una visión general de las subredes existentes en toda la
instalación del proyecto. El área de tabla de la vista general de redes sirve de ayuda.

74

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
En la configuración existen varias formas de conectar en red la interfaz de un componente apto
para la comunicación, según sea la situación de partida. A continuación se describen los
procedimientos:
● Crear una subred individual
● Crear varias subredes al mismo tiempo
● Conectar dos dispositivos de destino a través de una nueva subred
● Conectar los dispositivos a una subred existente
● Seleccionar una subred existente de la lista
● Conexión automática en red al configurar la conexión:
Consulte también: AUTOHOTSPOT
Las situaciones de partida pueden ser:
● Todavía no existe ninguna subred adecuada.
● La subred a la que debe conectarse el componente ya existe.

Procedimiento para crear una subred individual
Para crear una subred y conectarla a una interfaz, proceda del siguiente modo:
1. Seleccione la interfaz de una CPU/un CP.
2. Elija el comando "Crear subred" del menú contextual de la interfaz.
La interfaz seleccionada se conecta a una nueva subred. Las incoherencias que pudieran
originarse por el cambio de configuración se solucionan automáticamente o mediante
consulta. Si se producen problemas de coherencia se utiliza preferentemente la siguiente
dirección libre.
La figura siguiente muestra una interfaz con una línea de conexión que sale hacia una subred:

Procedimiento para crear varias subredes al mismo tiempo
Para crear varias subredes al mismo tiempo, proceda del siguiente modo:
1. Seleccione varias interfaces haciendo clic con el ratón y pulsando simultáneamente la tecla
<Ctrl>.
2. Elija el comando "Crear subred" del menú contextual de la interfaz.
Cada interfaz seleccionada se conectará a una nueva subred. Las incoherencias que pudieran
originarse por el cambio de configuración se solucionan automáticamente o mediante
consulta. Si se producen problemas de coherencia se utiliza preferentemente la siguiente
dirección libre.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

75

Configuración de dispositivos y redes
1.3 Configurar redes
La figura siguiente muestra varias subredes que se han creado mediante selección múltiple de
las interfaces:

Procedimiento para conectar dos dispositivos de destino a través de una nueva subred
Para conectar una interfaz a otro dispositivo a través de una subred que todavía no existe,
proceda del siguiente modo:
1. Coloque el cursor del ratón en la interfaz que debe conectarse de un componente apto para
comunicación.
2. Haga clic con el botón izquierdo del ratón y manténgalo pulsado.
3. Mueva el cursor del ratón.
Ahora, el cursor indica el modo "Conectar en red" con el símbolo correspondiente. Al mismo
tiempo, en el puntero del ratón aparece el símbolo de prohibición, que no desaparece hasta
que no se sitúa en una posición de destino válida.

4. En modo de conexión, arrastre el cursor del ratón hasta la interfaz del dispositivo de
destino. El botón izquierdo del ratón puede permanecer pulsado o soltarse.
5. Ahora, suelte el botón izquierdo del ratón o vuelva a hacer clic con el mismo.
Nota
Si antes quiere salir del modo de conexión, pulse <Esc>, haga clic con el botón derecho del
ratón o haga doble clic en el segundo plano de la vista de redes.
Se crea una subred. Ahora, las interfaces están conectadas a través de la nueva subred. Las
incoherencias que pudieran originarse por el cambio de configuración se solucionan
automáticamente o mediante consulta. Si se producen problemas de coherencia se utiliza
preferentemente la siguiente dirección libre.
La figura siguiente muestra dos dispositivos conectados en red:

76

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento para conectar los dispositivos a una subred existente
Para conectar una interfaz a una subred ya existente, proceda del siguiente modo:
1. Coloque el cursor del ratón en la interfaz que debe conectarse de un componente apto para
la comunicación o en la subred existente.
2. Haga clic con el botón izquierdo del ratón y manténgalo pulsado.
3. Mueva el cursor del ratón.
Ahora, el cursor indica el modo "Conectar en red" con el símbolo correspondiente. Al mismo
tiempo, el cursor del ratón muestra el símbolo de prohibición, que desaparece cuando se
pasa por encima de una posición de destino válida.
4. Arrastre el cursor del ratón hasta la subred existente o hasta la interfaz que debe
conectarse en red. El botón izquierdo del ratón puede permanecer pulsado o soltarse.

5. Suelte el botón izquierdo del ratón o haga nuevamente clic con el botón izquierdo del ratón.
Si antes desea salir del modo de conexión, pulse <Esc> o haga clic con el botón derecho
del ratón.
Resultado:
La interfaz y la subred seleccionada están conectadas. Las incoherencias que pudieran
originarse por el cambio de configuración se solucionan automáticamente o mediante
consulta. Si se producen problemas de coherencia se utiliza preferentemente la siguiente
dirección libre.

Procedimiento para seleccionar una subred existente de la lista
Para conectar una interfaz a una subred ya creada, proceda del siguiente modo:
1. Seleccione la interfaz de una CPU.
2. Elija el comando "Asignar a la subred nueva" del menú contextual de la interfaz.
Aparece una lista de selección con las subredes existentes.
3. Seleccione una subred de la lista.
La interfaz y la subred seleccionada están conectadas. Las incoherencias que pudieran
originarse por el cambio de configuración se solucionan automáticamente o mediante

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

77

Configuración de dispositivos y redes
1.3 Configurar redes
consulta. Si se producen problemas de coherencia se utiliza preferentemente la siguiente
dirección libre.

1.3.1.3

Área de tabla de la vista general de redes

Área de tabla de la vista de redes
El área de tabla de la vista de redes consta de varias tablas:
● Vista general de redes: la tabla de la vista general de redes complementa la vista gráfica de
redes con las funciones siguientes:
– Ofrece información detallada sobre la estructura y parametrización de los dispositivos.
– Desde la columna "Subred" se conectan componentes aptos para la comunicación con
subredes creadas.
● Conexiones: las conexiones de comunicación se muestran en esta tabla. Algunos aspectos
de las conexiones que se muestran aquí se pueden editar directamente en la tabla. Las
conexiones seleccionadas se muestran en la ventana de inspección, en la que se pueden
editar.
● Relaciones: aquí se muestran las conexiones lógicas de la relación cliente-servidor HMI.
● Comunicación E/S: en esta tabla se configura y muestra la comunicación de dispositivos
mediante PROFIBUS DP y PROFINET IO. En la tabla de comunicación E/S se muestran
solo las interfaces de un dispositivo que pueden utilizarse para una comunicación mediante
PROFIBUS DP o PROFIBUS IO.
● VPN: aquí se muestran propiedades de los grupos VPN y de sus módulos de seguridad
asignados.

Funciones básicas de las tablas
La vista general de redes soporta las siguientes funciones básicas para editar una tabla:
● Mostrar y ocultar las columnas de la tabla
Nota: no es posible ocultar las columnas relevantes para la configuración.
● Optimizar el ancho de las columnas
● Ordenar la tabla
● Explicar el significado de una columna, fila o campo mediante tooltips

1.3.1.4

Conectar dispositivos en red en la vista de dispositivos

Conexión en red en la vista de dispositivos
La vista de dispositivos permite comprobar detalladamente y ajustar todos los parámetros de
las interfaces y los componentes que corresponden a un dispositivo. Aquí también es posible
asignar las interfaces a las subredes creadas en el proyecto.

78

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Requisitos
● La subred a la que debe conectarse una interfaz ya está creada.
● Si la subred todavía no está creada, pase a la vista de redes y realice en ella la conexión
en red.

Procedimiento para conectar a una subred existente
Para conectar la interfaz a una subred ya creada, proceda del siguiente modo en la vista de
dispositivos:
1. Seleccione todo el componente apto para la comunicación o bien la interfaz que debe
conectarse en red.
En la ventana de inspección aparecerán las propiedades de la interfaz o el componente
seleccionado.
2. En la ventana de inspección, seleccione el grupo de parámetros correspondientes a la
interfaz seleccionada, p. ej. el grupo de parámetros "Direcciones Ethernet" en una interfaz
PROFINET.
3. Elija la subred que debe conectarse en la lista desplegable "Subred" de "Interfaz conectada
en red con".
La interfaz y la subred seleccionada están conectadas. Las incoherencias que pudieran
originarse por el cambio de configuración se solucionan automáticamente o mediante
consulta. Si se producen problemas de coherencia se utiliza preferentemente la siguiente
dirección libre.

Procedimiento para crear una subred nueva
Para crear una subred y conectarla a la interfaz, proceda del siguiente modo en la vista de
dispositivos:
1. Seleccione todo el componente apto para la comunicación o bien la interfaz que debe
conectarse en red.
En la ventana de inspección aparecerán las propiedades de la interfaz o el componente
seleccionado.
2. En la ventana de inspección, seleccione el grupo de parámetros correspondiente a la
interfaz seleccionada, p. ej. el grupo de parámetros "Direcciones Ethernet" en una interfaz
PROFINET.
3. Haga clic en el botón "Agregar nueva subred" en "Interfaz conectada en red con".
La interfaz se conectará a una subred nueva del tipo adecuado. Las incoherencias que
pudieran originarse por el cambio de configuración se solucionan automáticamente o
mediante consulta. Si se producen problemas de coherencia se utiliza preferentemente la
siguiente dirección libre.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

79

Configuración de dispositivos y redes
1.3 Configurar redes

1.3.1.5

Comprobar o modificar los parámetros de red o interfaz

Introducción
Para que los dispositivos conectados en red sean aptos para la comunicación, hay que
configurar los parámetros siguientes:
● Parámetros de red
Los parámetros de red identifican la red dentro de la configuración de la instalación, p. ej.
mediante un nombre.
● Parámetros de interfaz
Los parámetros de interfaz definen propiedades específicas de un componente apto para
la comunicación. El ajuste coherente con los parámetros de red para las direcciones y las
propiedades de transferencia se genera automáticamente.
Nota
Los parámetros de red e interfaz están configurados por defecto en la conexión en red de
modo que la comunicación es posible en muchos casos sin tener que modificar parámetros.
Las incoherencias que pudieran originarse por un cambio de configuración se solucionan
automáticamente o mediante consulta. Si se producen problemas de coherencia se utiliza
preferentemente la siguiente dirección libre.

Procedimiento para comprobar o modificar parámetros de red
Para comprobar o modificar parámetros de red, proceda del siguiente modo:
1. Vaya a la vista de redes.
2. Seleccione la subred en la vista de redes.
En la ventana de inspección se muestran los parámetros de red en la ficha "Propiedades".
3. Compruebe y, dado el caso, modifique los parámetros de red en el grupo correspondiente.

Procedimiento para comprobar o modificar parámetros de interfaz
Los parámetros de interfaz se comprueban y modifican en la vista de redes y en la de
dispositivos.
Para comprobar o modificar parámetros de interfaz, proceda del siguiente modo:
1. Vaya a la vista de redes o de dispositivos.
2. Seleccione la interfaz.
En la ventana de inspección se muestran los parámetros de interfaz en la ficha
"Propiedades".
3. Compruebe y, dado el caso, modifique los parámetros de interfaz en el grupo
correspondiente.

80

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento para comprobar o modificar direcciones de interfaz
Las direcciones MPI, PROFIBUS y Ethernet se editan directamente en la vista gráfica de redes.
Para editar direcciones MPI, PROFIBUS y Ethernet en la vista de redes, proceda del siguiente
modo:
1. Active en la vista de redes la visualización de las direcciones de interfaz.
2. Seleccione una dirección MPI, PROFIBUS o Ethernet que vaya a editarse.
3. Haga clic en el campo de dirección seleccionado o pulse [F2] para editar directamente la
dirección en la vista de redes.

1.3.1.6

Modificar conexiones en red

Introducción
Existe la posibilidad de eliminar la conexión de red de una interfaz o de asignarla a otra subred
del mismo tipo.

Repercusiones
Según el modelo hay que distinguir entre:
● Eliminar la conexión de red de una interfaz
Los parámetros configurados de la interfaz no se modificarán.
● Asignar la conexión de red a otra subred
Si las direcciones de la subred asignada no son unívocas, es decir, ya existen, se
convertirán automáticamente en unívocas.

Procedimiento para eliminar la conexión de red
Para eliminar la conexión de red de una interfaz, proceda del siguiente modo:
1. Seleccione la interfaz conectada en red.

2. Elija el comando "Deshacer la conexión con la subred" del menú contextual de la interfaz.
La conexión de red se borrará sin modificar las direcciones de la interfaz.
Las conexiones configuradas se conservan, aunque se marcan en rojo en la tabla de
conexiones porque falta la conexión en red. Las conexiones especificadas siguen estando
especificadas.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

81

Configuración de dispositivos y redes
1.3 Configurar redes

Consulte también
Conectar dispositivos en red en la vista de redes (Página 74)

1.3.1.7

Copiar, cortar o borrar subredes

Introducción
Es posible copiar subredes como objetos individuales, junto con dispositivos conectados en
red o junto con otras redes.
De este modo se crean sin mayor esfuerzo, p. ej., configuraciones complejas que deben
incluirse varias veces en el proyecto.

Repercusiones en la subred copiada
Las propiedades que deben ser asignadas de forma unívoca dentro del proyecto se reasignan
en correspondencia a los objetos copiados durante el proceso de copia.
Para las subredes esto significa lo siguiente: la ID y el nombre de la subred se reasignan a la
subred copiada.
Las propiedades configuradas se aplican a la subred copiada.

Procedimiento para copiar una subred
Para copiar una o varias redes, proceda del siguiente modo:
1. Seleccione una o varias subredes.
2. En el menú contextual, elija el comando "Copiar".
3. En el menú contextual, elija el comando "Pegar".
Las subredes copiadas aparecen en el área superior de la vista de redes como subredes
"huérfanas".

82

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento para copiar subredes con dispositivos conectados
Para copiar una o varias redes con dispositivos conectados, proceda del siguiente modo:
1. Seleccione una o varias subredes con los dispositivos conectados, p. ej. con la función de
lazo.
2. En el menú contextual, elija el comando "Copiar".
3. En el menú contextual, elija el comando "Pegar".
Se crean copias completas de las subredes y los dispositivos conectados.
Las conexiones configuradas se aplican y se conservan en los dispositivos copiados. Las
conexiones con dispositivos que no se han copiado se deshacen y quedan sin especificar.

1.3.1.8

Configuración de redes PROFINET/Industrial Ethernet

Información importante sobre la configuración de PROFINET/Industrial Ethernet
Reglas para la configuración de red
Las interfaces Ethernet de los dispositivos tienen una dirección IP predeterminada que puede
modificarse.

Dirección IP
Los parámetros IP son visibles si el módulo apto para la comunicación soporta el protocolo
TCP/IP. Esto suele suceder en todos los módulos Ethernet.
La dirección IP consiste en 4 números decimales comprendidos en un rango entre 0 y 255. Los
decimales están separados entre sí por un punto.
Ejemplo: 140.80.0.2
La dirección IP se compone de:
● dirección de la subred IP
● dirección del dispositivo (también se denomina host o nodo de red)

Máscara de subred
La máscara de subred separa las dos direcciones. Determina qué parte de la dirección IP
direcciona la red y qué parte direcciona el dispositivo.
Los bits activados de la máscara de subred determinan la parte de la dirección IP
correspondiente a la red.
Ejemplo:
Máscara de subred: 255.255.0.0 = 11111111.11111111.00000000.00000000
En el ejemplo superior de dirección IP, la máscara de subred tiene el significado siguiente:
Los 2 primeros bytes de la dirección IP determinan la subred, es decir, 140.80. Los 2 últimos
bytes direccionan el dispositivo, es decir, 0.2.
Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

83

Configuración de dispositivos y redes
1.3 Configurar redes
Por lo general rige lo siguiente:
● La dirección de la red resulta de la combinación lógica Y de la dirección IP y la máscara de
subred.
● La dirección del dispositivo resulta de la combinación lógica Y-NO de la dirección IP y la
máscara de subred.

Relación entre la dirección IP y la máscara de subred predeterminada
Existe un acuerdo respecto de la asignación entre áreas de direcciones IP y "máscaras de
subred predeterminadas". El primer decimal de la dirección IP (desde la izquierda) determina
la estructura de la máscara de subred predeterminada en cuanto al número de valores "1"
(binarios), del siguiente modo:
Dirección IP (dec.)

Dirección IP (bin.)

Clase de dirección

Máscara de subred pre‐
determinada

0 a 126

0xxxxxxx.xxxxxxxx....

A

255.0.0.0

de 128 a 191

10xxxxxx.xxxxxxxx...

B

255.255.0.0

de 192 a 223

110xxxxx.xxxxxxxx...

C

255.255.255.0

Nota
Rango de valores del primer decimal
En el primer decimal de la dirección IP también se acepta un valor entre 224 y 255 (clase de
dirección D, etc.). Sin embargo, no es recomendable porque no se verifica la dirección de estos
valores.

Enmascarar otras subredes
La máscara de subred permite seguir estructurando una subred asignada a las clases de
dirección A, B o C y crear subredes "privadas" poniendo a "1" otras posiciones de orden inferior
de la máscara de subred. Por cada bit puesto a "1" se duplica el número de redes "privadas"
y se divide en dos el número de dispositivos que contiene. Hacia fuera, la red sigue pareciendo
una red individual.
Ejemplo:
En una subred de la clase de dirección B (p. ej. dirección IP 129.80.xxx.xxx), la máscara de
subred predeterminada se modifica del siguiente modo:
Máscaras

Decimal

Binario

Máscara de subred predetermi‐
nada

255.255.0.0

11111111.11111111.00000000.
00000000

Máscara de subred

255.255.128.0

11111111.11111111.10000000.
00000000

Resultado:
Todos los dispositivos con direcciones comprendidas entre 129.80.001.xxx y 129.80.127.xxx
están en una subred IP y todos los dispositivos con direcciones comprendidas entre
129.80.128.xxx y 129.80.255.xxx están en otra subred IP.

84

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Transición de red (router)
Las transiciones de red (router) sirven para conectar las subredes IP. Si un datagrama IP debe
enviarse a otra red, primero hay que transmitirlo a un router. Para que esto sea posible, hay
que introducir la dirección del router en cada dispositivo de la subred IP.
La dirección IP de un dispositivo de la subred y la dirección IP de la transición de red (router)
solo pueden diferir en las cifras que son "0" en la máscara de subred.

Consulte también
Ajustes para la interconexión de dispositivos Ethernet (Página 85)
Interfaz virtual para aplicaciones basadas en IP (Página 96)
IP Forwarding (Página 88)

Ajustes para la interconexión de dispositivos Ethernet
A continuación se describe el comportamiento de STEP 7 en la interconexión de dispositivos
PROFINET y los efectos de la interconexión de puertos en la vista de redes.

Relación entre la interconexión de puertos y la vista de redes
Vista topológica
En la vista topológica se define la interconexión física de puertos Ethernet. En ella se determina
de manera concreta qué puerto Ethernet de un dispositivo debe conectarse a un determinado
puerto Ethernet de otro dispositivo mediante un cable Ethernet (topología teórica).
Ejemplo:
Se establece que el puerto 1 de la interfaz PROFINET de la CPU se conectará con el puerto
2 de la interfaz PROFINET del dispositivo A a través de un cable Ethernet. En los dispositivos
con varias interfaces PROFINET se define también la interfaz.
Ejemplo:
Se establece que el puerto 1 de la interfaz PROFINET X2 de la CPU se conectará con el puerto
2 de la interfaz PROFINET del dispositivo A a través de un cable Ethernet. La interconexión de
los puertos Ethernet puede realizarse en modo gráfico o de tabla.
Vista de redes
En la vista de redes se establece qué dispositivos se conectarán entre sí a través de una
subred Ethernet. No se determina a través de qué puertos Ethernet se interconectarán los
dispositivos (esto se lleva a cabo en la interconexión de puertos).
La interconexión de puertos tiene repercusiones sobre la vista de redes: Cuando se
interconectan puertos Ethernet de dispositivos en la vista topológica, STEP 7 une las
interfaces PROFINET interconectadas de los dispositivos en la vista de redes con una subred
Ethernet (línea verde). El recorrido de la línea verde no refleja el tendido efectivo de los cables.
El cableado concreto se define en la vista topológica.
Una subred Ethernet tiene un nombre y una ID de subred S7. Ambos valores pueden ajustarse
en las propiedades de la subred.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

85

Configuración de dispositivos y redes
1.3 Configurar redes

¿Con qué subred Ethernet se conectan los dispositivos interconectados?
STEP 7 distingue los siguientes casos:
● La subred Ethernet está especificada (subred predeterminada).
● La subred Ethernet no está especificada (sin subred predeterminada).

La subred Ethernet está especificada (subred predeterminada)
En las propiedades de una subred Ethernet está activada la opción "Conectar dispositivos no
interconectados en caso de interconexión de puertos con esta subred" (opción
predeterminada). Esta opción puede estar activada con una y solo una subred Ethernet. Active
esta opción si es necesario, con la subred Ethernet que se deba prolongar al interconectar
dispositivos no conectados en red. En lo sucesivo esta subred se denominará "subred
predeterminada".
Reacción de STEP 7:
Cuando en la vista topológica se interconectan los puertos de dos dispositivos no conectados
en red, STEP 7 conecta estos dispositivos a la subred predeterminada.
Ejemplo:
Paso 1: Crear una subred en la vista de redes en PLC_4, la opción "Conectar dispositivos no
intercaonectados en caso de interconexión de puertos con esta subred" está activada.

Paso 2: Interconectar PLC_1 con PLC_2 (vista topológica).

Resultado: Todos los PLC están conectados a la misma subred predeterminada (vista de
redes).

86

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

La subred Ethernet no está especificada (sin subred predeterminada).
Este caso se produce cuando se cumplen las siguientes condiciones:
● Se ha agregado una subred a una interfaz PROFINET (esta interfaz se denominará en lo
sucesivo "interfaz A").
● En las propiedades de esta subred está desactivada la opción "Conectar dispositivos no
interconectados en caso de interconexión de puertos con esta subred" (sin subred
predeterminada).
● Tampoco existe ninguna otra subred Ethernet en la que esta opción esté activada.
Reacción de STEP 7:
● La subred Ethernet de la interfaz A solo se prolonga si se interconecta un puerto de la
interfaz A con un puerto de otro dispositivo.
● Al interconectar puertos de otros dispositivos no conectados en red, STEP 7 crea otra
subred Ethernet.
Ejemplo:
Paso 1: Crear una subred en la vista de redes en PLC_4, la opción "Conectar dispositivos no
intercaonectados en caso de interconexión de puertos con esta subred" está desactivada.

Paso 2: Interconectar PLC_1 con PLC_2 (vista topológica).

Resultado: PLC_1 y PLC_2 están conectadas con una nueva subred (vista de redes).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

87

Configuración de dispositivos y redes
1.3 Configurar redes

Adaptación manual de las direcciones IP
Es posible que STEP 7 no adapte las direcciones IP de los dispositivos interconectados de
manera que pueda compilarse la conexión en red resultante, p. ej. en el caso de dispositivos
con varias interfaces PROFINET. En estos casos es necesario adaptar manualmente las
direcciones IP de los dispositivos.
Se aplican las reglas siguientes:
● Los dispositivos que deben comunicarse unos con otros sin router, no pueden pertenecer
a subredes IP diferentes.
● En los dispositivos con varias interfaces PROFINET, las interfaces deben encontrarse en
diferentes subredes IP.
Para cambiar la dirección IP de una interfaz PROFINET; ejecute los pasos siguientes:
1. Pase a la vista de redes (si no se encuentra ya en ella).
2. Haga clic con el botón izquierdo del ratón en el símbolo de la interfaz PROFINET que no
deba incorporarse a la subred IP.
3. En las propiedades de la interfaz PROFINET, modifique el componente de subred de la
dirección IP (en el apartado "Direcciones Ethernet").
Ejemplo: Cambio manual de la parte de subred IP en dispositivos con varias interfaces
PROFIENT en una subred
La dirección IP es: "192.168.0.1".
La máscara de subred es "255.255.255.0".
Los tres primeros números "192.168.0" constituyen el componente de subred IP de la dirección
IP "192.168.0.1".
Sustituya el componente de subred IP por "192.168.1", por ejemplo

Consulte también
Interconectar los puertos en la vista gráfica (Página 325)
Interconexión de los puertos en la vista de tabla (Página 327)
Información importante sobre la configuración de PROFINET/Industrial Ethernet (Página 83)
Interfaz virtual para aplicaciones basadas en IP (Página 96)
IP Forwarding (Página 88)

IP Forwarding
Reenvío de paquetes IP con IP Forwarding
IP Forwarding es una función de dispositivos para reenviar paquetes IP entre 2 subredes IP
conectadas.
La función IP Forwarding se activa y desactiva en STEP 7. Si IP Forwarding está activado, la
CPU S7-1500 reenvía los paquetes IP recibidos que no están direccionados a la CPU a
subredes IP conectadas localmente o a un router configurado.

88

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
La figura siguiente muestra cómo accede una programadora a datos de un dispositivo HMI. La
programadora y el dispositivo HMI están en diferentes subredes IP. Las subredes IP están
conectadas a las dos interfaces X1 y X2 de la CPU.
3*3&

6XEUHG,3$
;
&38FRQ,3
)RUZDUGLQJ
DFWLYDGR
;
3DTXHWHV,3

6XEUHG,3%

+0,

Figura 1-1

Acceso de una programadora a un HMI a través de IP Forwarding

Campos de aplicación
● Acceso sencillo del nivel de gestión al nivel de campo para la configuración y
parametrización de aparatos de campo, p. ej., mediante PDM o navegador web.
● Integración simplificada de dispositivos para accesos remotos, p. ej., para diagnósticos
durante el mantenimiento remoto o actualizaciones de firmware.

Requisitos para el uso de IP Forwarding
● CPU S7-1500 con versión de firmware V2.8 o superior
● Número de interfaces Ethernet:
– La CPU posee al menos 2 interfaces Ethernet.
– O bien la CPU posee una interfaz Ethernet y un CP 1543-1 con versión de firmware V2.2
o superior proporciona la otra interfaz Ethernet. En este caso, en la CPU debe estar
activada para el CP la función "Acceso a PLC mediante módulo de comunicación".
● IP Forwarding está activado.
● En cada dispositivo que interviene a lo largo de la ruta de ida y vuelta de los paquetes IP hay
parametrizadas pasarelas/rutas predeterminadas adecuadas.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

89

Configuración de dispositivos y redes
1.3 Configurar redes

Tabla de rutas IP
Si IP Forwarding está activado, la CPU reenvía los paquetes IP recibidos que no están
direccionados a ella. El modo en que la CPU reenvía los paquetes IP está establecido en la
tabla interna de rutas IP.
La CPU elabora automáticamente la tabla de rutas IP a partir de la siguiente información de la
configuración hardware cargada:
● configuración IP de las interfaces Ethernet
● router configurado

Ejemplo de una configuración con IP Forwarding
La figura siguiente muestra un ejemplo de configuración junto con los ajustes de dirección IP
y los ajustes de router necesarios.
● Un PC en la subred IP 192.168.4.0 se comunica con un dispositivo HMI en la subred IP
192.168.2.0.
● En la CPU, interfaz Ethernet X3, está configurada la dirección IP de un router ("pasarela
estándar"); en la figura de abajo se trata del dispositivo identificado con "Router IP".
En STEP 7, un router se configura en las propiedades de la interfaz en "Direcciones
Ethernet" > "Protocolo IP".
● Para el PC, el router IP, el dispositivo IO y el dispositivo HMI también están registradas las
direcciones IP de una pasarela estándar o las rutas correspondientes.

Figura 1-2

Configurar un router

Del ejemplo de configuración se deduce la siguiente tabla de rutas IP para la CPU:

90

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
3&

'LUHFFLµQ,3



5RXWHU



;

5RXWHU,3


;



;

&38FRQ,3
)RUZDUGLQJ
DFWLYDGR


;


;



;

3DTXHWHV,3


;





'LVSRVLWLYR,2

+0,

Figura 1-3

Ejemplo de configuración

Tabla 1-1

Tabla de rutas IP de la CPU

Destino de la red

Interfaz

Pasarela

0.0.0.0/0

10.10.0.10

10.10.0.1

192.168.1.0/24

192.168.1.1

-

192.168.2.0/24

192.168.2.1

-

10.10.0.0/24

10.10.0.10

-

Para que sea posible una comunicación IP entre la PG/el PC y el dispositivo HMI es necesario
crear, tanto en el PC como en el router IP, rutas IP adicionales a la subred IP del dispositivo
HMI. En el dispositivo HMI la dirección IP de la interfaz X1 de la CPU se configura como
pasarela estándar.
En un equipo Windows, p. ej., se crea una ruta IP adicional en el símbolo del sistema con el
comando "route add <subred IP de destino> mask <máscara de subred> <pasarela>". No
obstante, para ello se requieren determinados derechos de acceso. Para este ejemplo se
introduce lo siguiente en el símbolo del sistema:
● "route add 192.168.2.0 mask 255.255.255.0 192.168.4.20"

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

91

Configuración de dispositivos y redes
1.3 Configurar redes
En un router IP se crean rutas adicionales, p. ej., a través de una interfaz web. Para este
ejemplo se crea la siguiente ruta:
● Subred IP de destino: 192.168.2.0
● Máscara de subred: 255.255.255.0
● Pasarela: 10.10.0.10

Restricciones
Para una CPU S7-1500 no es posible configurar rutas IP adicionales además del router
("pasarela estándar"). El destino de la red es bien una subred IP conectada bien se alcanza
exactamente a través de un router configurable. Dado que la CPU S7-1500 no soporta rutas
IP adicionales, no es posible establecer cascadas de routers IP bidireccionales.
En la configuración siguiente es posible configurar en la CPU "Router 1" o "Router 2". Como
ejemplo se ha configurado "Router 1". En este caso no es posible configurar "Router 2". No es
posible una comunicación IP entre el PC y el dispositivo HMI, porque la ruta no puede
recorrerse en ambos sentidos.

92

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
3&

6XEUHG,3$

5RXWHU

6XEUHG,3%
&38FRQ,3
)RUZDUGLQJ
DFWLYDGR
;
6XEUHG,3&

5RXWHU

6XEUHG,3'

+0,

Figura 1-4

Cascada de routers IP no soportada

IP Forwarding a través de la interfaz de un CP
IP Forwarding también funciona a través de la interfaz de un CP. Para ello hay, en la CPU hay
que activar para ese CP la función "Acceso a PLC mediante módulo de comunicación".
En la Ayuda en pantalla de STEP 7 se describe cómo activar la función "Acceso a PLC
mediante módulo de comunicación".

Acceder a Linux de la CPU‑1518‑4 PN/DP MFP a través de las interfaces X1 o X2
Si se activa IP Forwarding para la CPU 1518‑4 PN/DP MFP, a través de las interfaces X1 y X2
no solo se podrá acceder a dispositivos en la subred IP de la interfaz X3, sino también a Linux.
Desde Linux de la CPU 1518‑4 PN/DP MFP se accede a todos los dispositivos que están en
las subredes IP de las interfaces X1, X2 y X3.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

93

Configuración de dispositivos y redes
1.3 Configurar redes
Condiciones marco:
● IP Forwarding está activado para la CPU 1518‑4 PN/DP MFP.
● La dirección IP de Linux y la dirección IP de la interfaz X3 están en la misma subred IP.
● En Linux están registradas las rutas a las subredes IP en X1 y X2.
Una ruta se registra en Linux con el siguiente comando: "Route add-net <Subred IP de
destino> mask <Máscara de subred> gw <Pasarela>
La figura siguiente muestra una configuración en la que un PC accede al Linux de la CPU
1518-4 PN/DP MFP a través de la interfaz X2.
'LUHFFLµQ,3
5XWD
3&
5RXWHDGGPDVN
3DTXHWHV,3
;


&3831'30)3
FRQ,3)RUZDUGLQJDFWLYDGR

/LQX[
 'HIDXOW
5RXWHDGGQHWPDVNJZ
;



;

;




Figura 1-5

Acceso a Linux a través de la interfaz X2

Considerar la seguridad de la red con IP Forwarding
Al activar IP Forwarding para una CPU se permite un acceso "desde fuera" a dispositivos que
en realidad solo son accesibles y pueden controlarse desde la CPU. Por ello, en general esos
dispositivos están desprotegidos frente a ataques.

94

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
La figura siguiente muestra cómo se protege el sistema de automatización contra un acceso
no autorizado.
● La CPU accede a través de las interfaces X1 y X2 a todos los dispositivos que están dentro
de las subredes IP B y C cercanas a la CPU, representadas en verde oscuro.
3&

3&

6XEUHG,3'

6XEUHG,3$

&3
6&$/$1&(6

&38FRQ,3
)RUZDUGLQJ
DFWLYDGR

:
; ;

6XEUHG,3&

6XEUHG,3%
3DTXHWHV,3
'LVSRVLWLYR,2

Figura 1-6

'LVSRVLWLYR,2

+0,

Seguridad de la red con IP Forwarding

● En la CPU hay configurado un router SCALANCE S. A través del router, la CPU accede a
los dispositivos de la subred IP A lejana, representada en verde claro.
● En la CPU está activada para el CP 1543 la función "Acceso a PLC mediante módulo de
comunicación". A través de la interfaz W1, la CPU accede a todos los dispositivos que están
dentro de la subred IP D.
Si en la CPU está activado IP Forwarding, un dispositivo de la subred IP A puede acceder a
cualquier dispositivo que esté dentro de las subredes IP B, C y D cercanas a la CPU.
Proteja el sistema de automatización y los dispositivos conectados contra accesos no
autorizados del exterior.
Utilice un cortafuegos para aislar las subredes IP cercanas a la CPU de las subredes IP
lejanas. Para ello puede utilizar, por ejemplo, el módulo de seguridad SCALANCE S con
cortafuegos integrado.
Encontrará la forma de proteger con un cortafuegos una célula de automatización mediante los
módulos de seguridad SCALANCE S602 V3 y SCALANCE S623 en este ejemplo de aplicación
(https://support.industry.siemens.com/cs/ww/es/view/22376747).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

95

Configuración de dispositivos y redes
1.3 Configurar redes

Activar/desactivar IP Forwarding
Para activar IP Forwarding, proceda del siguiente modo:
1. Seleccione la CPU en la vista de redes de STEP 7 (TIA Portal).
2. Navegue en la ventana de inspección por las propiedades de la CPU hasta "General" >
"Configuración avanzada" > "IP Forwarding".
3. En el área "Configuración IPv4 Forwarding" active la casilla de verificación "Activar IPv4
Forwarding para interfaces de este PLC".

Figura 1-7

Activar IP Forwarding

Resultado: IP Forwarding está activado para todas las interfaces de la CPU S7-1500.
IP Forwarding se desactiva desactivando la casilla de verificación "Activar IPv4 Forwarding
para interfaces de este PLC".

IP Forwarding en sistemas redundantes S7-1500R/H
Encontrará información sobre la configuración de IP Forwarding en un sistema S7-1500R/H en
el capítulo "Comunicación con el sistema redundante S7-1500R/H" del manual de funciones
de la comunicación.

Consulte también
Información importante sobre la configuración de PROFINET/Industrial Ethernet (Página 83)
Ajustes para la interconexión de dispositivos Ethernet (Página 85)
Resumen de las propiedades de la CPU (Página 1024)

Interfaz virtual para aplicaciones basadas en IP
A partir de la versión de firmware 2.8, la CPU S7-1500 ofrece la posibilidad de acceder a sus
aplicaciones basadas en IP, como OPC UA, no solo a través de la interfaz (PN) local, sino
también a través de las interfaces de los procesadores de comunicaciones en la misma
estación. Un interlocutor de la comunicación accede a estas aplicaciones basadas en IP a
través de una interfaz virtual que puede configurarse en TIA Portal a partir de la versión V16.
La interfaz virtual tiene la identificación W1 (conforme a IEC 81346-2).

Características de la interfaz virtual
La interfaz virtual no es una interfaz completamente diagnosticable con las propiedades
conocidas de las interfaces tradicionales. Como la conexión interna a través del bus de fondo
no constituye una subred S7 y no tiene puertos, la interfaz virtual no se muestra en las vistas
gráficas. Por esta razón no puede establecerse una conexión física a través de un cable de red.
La dirección IP de la interfaz virtual se muestra (p. ej. en TIA Portal, en el display de la CPU)
y puede configurarse.

96

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
A través de la interfaz virtual W1, por ejemplo, pueden utilizarse los siguientes servicios
basados en IP:
● OPC UA (cliente y servidor)
● conexiones OUC programadas
● comunicación S7 (acceso ES/HMI e instrucciones para la comunicación S7, como PUT o
GET)
La interfaz activada puede utilizarse en cuadros de diálogo en los que se configuran
conexiones basadas en IP.
&38

&3

23&8$

W1

3DUWQHU
X2

X3

X1

X1

,QGXVWULDO(WKHUQHW

6ZLWFK

Figura 1-8

Principio de la interfaz virtual

En comparación con las interfaces convencionales, la interfaz virtual tiene las siguientes
restricciones:
● A través de la interfaz virtual no es posible acceder al servidor web.
● La copia de seguridad online no es posible si se utiliza una programadora conectada a TIA
Portal.
● Si la CPU y el interlocutor de la comunicación están conectados entre sí a través de la
interfaz virtual, no pueden intercambiar datos mediante LLDP (Página 1052) (Link Layer
Discovery Protocol).
● El servicio de routing S7 no utiliza la interfaz virtual W1.

Requisitos
Para poder acceder a un servicio de CPU a través de la interfaz Ethernet de un CP deben
cumplirse los siguientes requisitos:
● CPU S7-1500 con firmware V2.8 o superior
● CP 1543-1 con firmware V2.2 o superior
Las CPU R/H no soportan esta función, puesto que no son compatibles con CP.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

97

Configuración de dispositivos y redes
1.3 Configurar redes

Configuración de la interfaz virtual W1
En las propiedades de una CPU S7-1500 con versión de firmware V2.8 o superior, mediante
"Configuración avanzada > Acceso a PLC mediante módulo de comunicación" es posible
asignar un módulo de comunicación enchufado a la interfaz virtual W1. Seguidamente, a
través del módulo se puede acceder a la CPU desde fuera. Si no hay ningún CP enchufado o
si los CP enchufados no soportan el acceso a la CPU, la selección está vacía.

Figura 1-9

Selección del CP en las propiedades de la CPU

Una vez seleccionado el CP se muestran los datos y parámetros de la interfaz virtual. Aquí
pueden editarse los ajustes para el protocolo IP y los parámetros PROFINET.
● La subred IP puede elegirse libremente, al igual que en el CP. La subred IP se introduce
mediante la máscara de subred y la dirección IP de la interfaz virtual.
● Al introducir la subred IP para la interfaz virtual, no se debe utilizar la misma subred IP que
para la interfaz local de la CPU.
● Para que desde la CPU se pueda acceder a los servicios basados en IP del CP, y viceversa,
la dirección IP de la interfaz virtual debe estar en la misma subred IP que la interfaz Ethernet
del CP.
Una vez introducida la dirección IP, esta se incluye en el cuadro de diálogo de propiedades del
servidor OPC UA, en la lista de direcciones de servidor. Con esta configuración la CPU dispone
de la nueva interfaz virtual W1, mediante la cual se puede acceder a los servicios de la CPU,
como el servidor OPC UA, a través de un módulo de comunicación. Las conexiones creadas
en correspondencia y la comunicación S7 (p. ej. HMI y BSEND, BRCV) pasan por esta interfaz.
El servidor OPC UA no permite seleccionar una interfaz concreta (selección a través de una
dirección IP), sino que deben seleccionarse todas o bien ninguna.
Nota
La dirección IP de la interfaz virtual no se muestra como W1 en el display del dispositivo debajo
de las interfaces locales que se muestran actualmente (Xn), sino debajo de "Direcciones" en
la sección "Ajustes". La interfaz virtual también es visible aunque no esté activada o aunque no
haya ningún CP enchufado. Si no hay disponible ninguna IP-Suite, la dirección IP y la máscara
de subred son 0.0.0.0.
Si se han cargado los parámetros de dirección IP configurados y cargados de la interfaz virtual
y a continuación se modifican los parámetros de dirección IP desde el display, mediante una
instrucción T_CONFIG u online, tras un rearranque completo de la CPU la configuración
cargada volverá a estar activa.

98

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Cambios de configuración en el CP
Un cambio del módulo de comunicación asignado puede influir en la configuración de la
interfaz virtual:
● En las propiedades de la CPU:
– Asignación de otro CP: se aplica la configuración para el nuevo CP.
– Eliminación del CP asignado: la interfaz virtual W1 se desactiva y se pierde la
configuración.
Al asignar posteriormente un CP es necesario realizar de nuevo la configuración.
● En el dispositivo:
– Desplazar el CP: Si el CP solo se ha desplazado a otro slot del dispositivo, la
configuración seguirá siendo válida.
– Eliminar el CP: Si se borra el CP o se desplaza a otro dispositivo, la configuración se
conserva. En la lista desplegable de la CPU, el CP se muestra como ausente y la
compilación de la configuración presenta un error. Para solucionarlo es posible
desmarcar el CP que falta o asignar otro CP.

Visualización en el diagnóstico y en las constantes de sistema
La interfaz virtual W1 se muestra en la vista de diagnóstico en "Online y diagnóstico". En las
propiedades de la CPU, el identificador de hardware de la interfaz virtual se muestra en las
constantes de sistema.

Ajustes en el módulo de comunicación
La configuración del firewall interno del CP no influye en la comunicación a través de la interfaz
virtual. Por consiguiente, las funciones de seguridad del módulo de comunicación no pueden
proteger el tráfico de datos a través de la interfaz virtual.
ATENCIÓN
Conexión con redes no seguras
Si se conecta el CP a una red no segura, es imprescindible poner un cortafuegos adicional
entre el CP y la red no segura. Para ello se puede utilizar, por ejemplo, el módulo de seguridad
SCALANCE S602 V3 y SCALANCE S623 con cortafuegos integrado.

Consulte también
Acceso a aplicaciones OPC UA (Página 1298)
Información importante sobre la configuración de PROFINET/Industrial Ethernet (Página 83)
Ajustes para la interconexión de dispositivos Ethernet (Página 85)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

99

Configuración de dispositivos y redes
1.3 Configurar redes

1.3.1.9

Configuración de red PROFIBUS

Direcciones PROFIBUS
Reglas de la configuración de red
Todos los nodos de una subred deben tener direcciones PROFIBUS distintas.
Los ajustes sólo deben cargarse a través de la red si todos los módulos de una subred poseen
direcciones distintas y su estructura real coincide con la configuración de red creada.
En la subred PROFIBUS pueden conectarse nodos que se comuniquen a través de
conexiones configuradas o formen parte de un sistema maestro PROFIBUS DP.
Los siguientes capítulos ofrecen más información sobre la configuración de un sistema
maestro DP.

Requisitos
La CPU 121xC es apta para PROFIBUS a partir de la versión de firmware 2.0.

Reglas para la asignación de direcciones PROFIBUS
● Las direcciones PROFIBUS deben asignarse en orden ascendente.
● La dirección PROFIBUS "0" debe reservarse para una programadora.
● Debe asignarse una dirección PROFIBUS unívoca en el rango de 0 a 126 para cada
dispositivo en la red PROFIBUS o para cada maestro DP y cada esclavo DP en la red
PROFIBUS.
● Existen módulos cuya dirección configurable más pequeña tiene que ser mayor que 1.
● Todas las direcciones PROFIBUS de una subred PROFIBUS deben ser distintas.
En los manuales de montaje de sistemas de automatización, p. ej. SIMATIC S7-1200, se
encuentran más reglas sobre la configuración de una red.
Nota
Dirección PROFIBUS "0"
La dirección PROFIBUS "0" debe reservarse para una programadora que se conectará a la red
PROFIBUS más adelante y por un tiempo limitado para fines de servicios.

Consulte también
Información importante sobre los parámetros de bus PROFIBUS (Página 101)

100

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Información importante sobre los parámetros de bus PROFIBUS
Parámetros sintonizados entre sí
La subred PROFIBUS sólo funciona a la perfección si los parámetros del perfil de bus están
sintonizados entre sí. Por esta razón, los valores predeterminados sólo deberían modificarse
si se está familiarizado con la parametrización del perfil de bus para PROFIBUS.
Nota
En función del perfil de bus, los parámetros podrán ajustarse o no. Si los parámetros de bus no
pueden ajustarse, aparecen atenuados. Siempre se visualizan los valores offline de los
parámetros del bus, incluso si están conectados online con el sistema de destino.
Los parámetros visualizados sirven para toda la subred PROFIBUS y se explican brevemente
a continuación.

Activar difusión cíclica de los parámetros de bus
Si, con la subred PROFIBUS desmarcada, está activada la casilla de verificación "Activar
difusión cíclica de los parámetros de bus" en el apartado "Parámetros del bus" de la ventana
de inspección, los módulos que soportan esta función enviarán cíclicamente los parámetros de
bus durante el funcionamiento. De esta forma, por ejemplo, la PG puede conectarse sin
problemas al PROFIBUS durante el funcionamiento.
Esta función debe desactivarse:
● En una subred PROFIBUS heterogénea (exactamente, en dispositivos de terceros
conectados cuyo protocolo utilice el DSAP 63 para Multicast)
● en caso de funcionamiento equidistante (minimizar el ciclo de bus)

Parámetros de bus para el perfil de bus de las subredes PROFIBUS
Parámetros del bus

¿Ajustables?

Valores límite

Tslot_Init

Sí

Max. Tsdr + 15 <= Tslot_init <= 16.383 t_bit

Max. Tsdr

Sí

35 + 2*Tset + Tqui <= Max. Tsdr <= 1.023 t_bit

Min. Tsdr

Sí

11 t_bit <= Min. Tsdr <= MIN(255 t_bit, ...
... Max. Tsdr - 1, 34 + 2*Tset + Tqui)

Tset

Sí

1 t_bit <= Tset <= 494 t_bit

Tqui

Sí

0 t_bit <= Tqui <= MIN(31 t_bit, Min. Tsdr - 1)

Factor GAP

Sí

1 <= Factor GAP <= 100

Retry Limit

Sí

1 <= Retry Limit <= 15

Tslot

No

---

Tid2

No

Tid2 = Max. Tsdr

Trdy

No

Trdy = Min. Tsdr

Tid1

No

Tid1 = 35 + 2*Tset + Tqui

Ttr

Sí

256 t_bit <= Ttr <= 16.777.960 t_bit

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

101

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetros del bus

¿Ajustables?

Valores límite

Ttr típico

No

Este tiempo sólo tiene carácter informativo y no se transmite a los nodos.

Supervisión de respuesta

10 ms <= Supervisión de respuesta (watchdog) <= 650 s

Si se desea crear un perfil de bus definido por el usuario, recomendamos realizar los siguientes
ajustes:
● Target-Rotation-Time mínimo (Ttr) = 5000 x HSA (dirección PROFIBUS más alta)
● Supervisión de respuesta mínima (Watchdog) = 6250 x HSA

Recalcular
Pulsando el botón "Recalcular" se recalculan los parámetros.

Consulte también
Direcciones PROFIBUS (Página 100)
Descripción de los parámetros de bus (Página 102)

Descripción de los parámetros de bus
Descripción detallada de los parámetros de bus PROFIBUS
Parámetros de bus

Significado

Tslot_Init

El tiempo de espera a recepción determina cuánto tiempo debe esperar como
máximo el emisor hasta recibir una respuesta del interlocutor direccionado. Si en
el grupo de parámetros "Configuración de línea" se configura la influencia de los
componentes de la línea sobre los tiempos de ejecución de telegramas, deberán
tenerse en cuenta también estas proporciones. La proporción se suma al
Tslot_Init predefinido y el total se utiliza como Tslot.

Max. Tsdr

El tiempo máximo de procesamiento de protocolo determina el tiempo máximo al
cabo del cual el nodo que responde debe haber respondido.

Min. Tsdr

El tiempo mínimo de procesamiento de protocolo determina el tiempo mínimo al
cabo del cual el nodo que responde puede responder.

Tset

El tiempo de activación es el tiempo que puede transcurrir entre la recepción de
un telegrama de datos y la reacción correspondiente en el nodo.

Tqui

El tiempo de desactivación del modulador es el tiempo que requiere un nodo
emisor después del fin del telegrama para conmutar de Enviar a Recibir.

Factor GAP

El factor de actualización GAP determina al cabo de cuántas rotaciones del token
puede incorporarse un nuevo nodo activo al anillo lógico.

Retry Limit

Con este parámetro se determina cuántos intentos (repeticiones del telegrama)
pueden realizarse como máximo para acceder a un nodo.

102

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetros de bus

Significado

Tslot

El tiempo de espera a recepción (slot time) determina cuánto tiempo debe espe‐
rar como máximo el emisor hasta recibir una respuesta del interlocutor direccio‐
nado.
Si en la ficha "Líneas" se configura la influencia de los componentes físicos del
bus sobre los tiempos de ejecución de telegramas, deberán tenerse en cuenta
también estas proporciones. La proporción se suma al Tslot_Init predefinido y el
total se utiliza como Tslot.

Tid2

El tiempo de reposo 2 determina al cabo de cuánto tiempo como mínimo un nodo
emisor puede enviar el siguiente telegrama tras el envío de un telegrama no
acusado.

Trdy

El tiempo de disponibilidad determina al cabo de cuánto tiempo como mínimo un
nodo emisor puede recibir un telegrama de respuesta.

Tid1

El tiempo de reposo 1 determina al cabo de cuánto tiempo como mínimo un nodo
emisor puede enviar el siguiente telegrama tras la recepción de una respuesta.

Ttr

El tiempo consignado de rotación del token es el tiempo máximo disponible para
una rotación del token. Durante ese tiempo, todos los nodos activos (maestros
DP, etc.) reciben una vez el testigo (token). La diferencia entre el tiempo consig‐
nado de rotación del token y el tiempo real de parada del token de un nodo
determina cuánto tiempo queda para que los otros nodos activos (PG, otros
maestros DP, etc.) puedan enviar telegramas.

Ttr típico

El tiempo de ciclo de datos típico es el tiempo de reacción medio del bus cuando
todos los esclavos configurados intercambian datos con el maestro DP. Ninguno
de los esclavos notifica un diagnóstico y no se produce ningún tráfico de telegra‐
mas adicional con PGs u otros nodos activos, etc. en el bus.

Supervisión de respuesta

El tiempo de supervisión de respuesta sólo se requiere para los sistemas de bus
PROFIBUS DP. Determina al cabo de cuánto tiempo como máximo el maestro
DP debe activar un esclavo DP con un nuevo telegrama de datos. Si esto no
ocurre, el esclavo DP presupone que el maestro DP ha fallado y resetea sus
salidas a un estado seguro.

Consulte también
Información importante sobre los parámetros de bus PROFIBUS (Página 101)

Perfiles de bus en PROFIBUS
Introducción
Según sean los tipos de dispositivos conectados y los protocolos utilizados en PROFIBUS, hay
disponibles diferentes perfiles. Los perfiles se distinguen por sus opciones de ajuste y por el
cálculo de los parámetros de bus. Seguidamente, se describen los perfiles.

Dispositivos con distintos perfiles en la misma subred PROFIBUS
La subred PROFIBUS sólo funciona a la perfección si los parámetros de bus de todos los
dispositivos tienen los mismos valores. Si, por ejemplo, en una subred se utilizan tanto
servicios DP como FMS, deben ajustarse siempre los juegos de parámetros de bus "más
lentos" para todos los dispositivos, es decir, también el perfil "Universal (DP/FMS)" para
dispositivos DP.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

103

Configuración de dispositivos y redes
1.3 Configurar redes

Perfiles y velocidades de transferencia
Perfiles

Velocidades de transferencia soportadas en Kbits/s

DP

9,6 19,2 45,45 93,75 187,5 500 1500 3000 6000 12000

Estándar

9,6 19,2 45,45 93,75 187,5 500 1500 3000 6000 12000

Universal (DP-FMS)

9,6 19,2 93,75 187,5 500 1500

Definido por el usuario

9,6 19,2 45,45 93,75 187,5 500 1500 3000 6000 12000

Significado de los perfiles
Perfil

Significado

DP

Seleccione el perfil de bus "DP" si en la subred PROFIBUS sólo hay conectados
dispositivos que cumplen con las exigencias de la norma EN 50170 Volumen
2/3, Parte 8-2 PROFIBUS. El ajuste de los parámetros de bus se ha optimizado
para estos dispositivos.
Entre ellos, se incluyen los dispositivos con interfaces maestro DP y esclavo DP
de SIMATIC S7, así como unidades periféricas descentralizadas de otros fa‐
bricantes.

Estándar

104

Con respecto al perfil "DP", el perfil "Estándar" ofrece además la posibilidad de
tener en cuenta para el cálculo de los parámetros de bus dispositivos de otro
proyecto o dispositivos no configurados aquí. Los parámetros de bus se calcu‐
larán entonces con un algoritmo sencillo y no optimizado.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Perfil

Significado

Universal (DP/FMS)

Seleccione el perfil de bus "Universal (DP/FMS)" si en la subred PROFIBUS
hay dispositivos individuales que utilizan el servicio PROFIBUS FMS.
Se trata, por ejemplo, de los siguientes dispositivos:
● CP 343-5 (SIMATIC S7)
● Dispositivos PROFIBUS FMS de otros fabricantes
Al igual que en el perfil "Estándar", en este caso también existe la posibilidad de
tener en cuenta dispositivos adicionales para el cálculo de los parámetros de
bus.

Definido por el usua‐
rio

La subred PROFIBUS sólo funciona a la perfección si los parámetros del perfil
de bus están sintonizados entre sí. Seleccione el perfil de bus "Definido por el
usuario" cuando, para el funcionamiento de un dispositivo PROFIBUS, ninguno
de los perfiles restantes "se ajuste" y deban adaptarse los parámetros de bus a
la estructura especial. Para más información, puede consultarse la documen‐
tación del dispositivo PROFIBUS.
Los valores predeterminados sólo deberían modificarse si se está familiarizado
con la parametrización del perfil de bus para PROFIBUS.
Con este perfil de bus tampoco pueden introducirse todas las combinaciones
teóricamente ajustables. La norma PROFIBUS define algunos valores límite de
parámetros en función de otros parámetros. Así, por ejemplo, no se permite que
un respondedor pueda responder (Min Tsdr) antes de que el iniciador pueda
recibir el telegrama (Trdy). Estos requisitos también se comprueban en el perfil
"Definido por el usuario".
Sugerencia: Los últimos parámetros de bus válidos en la subred PROFIBUS
siempre se ajustan automáticamente como definidos por el usuario. Si, por
ejemplo, el perfil de bus "DP" era válido para la subred, se ajustarán los pará‐
metros de bus para "DP" en el perfil de bus "Definido por el usuario". A partir de
este ajuste, pueden modificarse los parámetros.
El recálculo de los tiempos de vigilancia no se realiza automáticamente para no
poner en peligro la igualdad de los valores ajustados, p. ej. para la configuración
de otras herramientas de configuración, sin que el usuario lo sepa.
Los tiempos de vigilancia Ttr y la supervisión de respuesta pueden calcularse
con los parámetros ajustados por el usuario: Para ello, haga clic en el botón
"Recalcular".

Nota
En todos los perfiles PROFIBUS es posible tanto el funcionamiento monomaestro como el
funcionamiento multimaestro.

Información importante sobre la configuración de línea PROFIBUS
Configuración de línea y parámetros de bus
La información sobre la configuración de línea puede tenerse en cuenta para el cálculo de los
parámetros de bus. Para ello, hay que activar la casilla de verificación "Considerar
configuración de línea" en las propiedades de la subred PROFIBUS.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

105

Configuración de dispositivos y redes
1.3 Configurar redes
La información restante depende del tipo de línea utilizada. Pueden ajustarse las siguientes
opciones:
● Cable de cobre
● Cable de fibra óptica / anillo óptico

Configuración de línea PROFIBUS, anillo óptico
El cálculo depende de los tipos de OLM utilizados. La selección se efectúa activando la casilla
de verificación (pueden activarse varias casillas y como mínimo deberá seleccionarse un tipo
de OLM):
● OLM/P12
● OLM/G12
● OLM/G12-EEC
● OLM/G12-1300
Se realizan las siguientes adaptaciones de los parámetros de bus:
● Configuración de un nodo no existente
Nota
Las siguientes restricciones también rigen para los nodos pasivos (p. ej. esclavos DP) en
los anillos ópticos:
Pueden conectarse a la red PROFIBUS nodos con HSA-1 como máximo. En el caso de un
HSA de 126, las direcciones 126 y 125 no pueden utilizarse. Así, puede haber como
máximo 125 nodos en el bus (n.º 0 a 124).
En el caso de un HSA menor o igual a 125, no pueden utilizarse las direcciones HSA y
mayores. En cambio, la dirección HSA-1 puede utilizarse.
● Aumento del valor Retry a 3
● Ajuste del tiempo slot mínimo necesario para el funcionamiento del anillo
Nota
Para OLM/P12 se requieren valores de tiempo slot bajos; para OLM/G12 y OLM/G12-EEC,
valores medios, y para OLM/G12-1300, valores altos. De ahí resulta un alto rendimiento en
una extensión de red pequeña o un rendimiento de medio a bajo en una extensión de red
de media a grande.

106

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Carga de comunicación PROFIBUS
Carga de comunicación - considerar los nodos de red adicionales
Los parámetros de bus dependen del volumen de comunicación de los nodos de red activos.
En este caso, existen diferencias entre la comunicación cíclica (DP) y la comunicación acíclica
orientada a la conexión (comunicación S7, Send/Receive (FDL), FMS). A diferencia del DP, el
número y la magnitud de las peticiones de comunicación (carga de comunicación) dependen
del programa de usuario. Por este motivo, la carga de comunicación no siempre puede
determinarse automáticamente.
Para calcular los tiempos de bus, puede fijarse una configuración de red en el grupo de
parámetros "Dispositivos de red adicionales" que sea diferente de la configuración de red
configurada.

Considerar el perfil
La configuración de red puede determinarse para los perfiles "Estándar", "Universal (DP/
FMS)" y "Definido por el usuario". En el perfil "DP", los parámetros del grupo de parámetros
"Dispositivos de red adicionales" no pueden introducirse.

Cuantificación de la carga de comunicación
Para tener en cuenta la carga de comunicación, pueden realizarse los siguientes ajustes:
● información sobre el número de nodos de red no configurados;
● información sobre la carga de comunicación resultante de los programas de usuario para
comunicación FDL o S7. Para ello, pueden seleccionarse los siguientes niveles:
– Bajo
Típico para DP, no hay ninguna comunicación de datos mayor a excepción de DP.
– Medio
Típico para el modo mixto de DP y otros servicios de comunicación (p. ej. comunicación
S7), cuando DP tiene altas demandas de tiempo y en caso de volumen medio de
comunicación acíclica.
– Alto
Para el modo mixto de DP y otros servicios de comunicación (p. ej. comunicación S7),
cuando DP tiene bajas demandas de tiempo y en caso de volumen alto de comunicación
acíclica.

1.3.1.10

Configuración de red MPI

Asignación de direcciones MPI
En el caso de dispositivos con una interfaz MPI, todos los dispositivos de una subred deben
tener una dirección distinta.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

107

Configuración de dispositivos y redes
1.3 Configurar redes
Las CPU con dirección MPI se entregan con la dirección predeterminada MPI 2. Puesto que
esta dirección solo se puede utilizar una vez en la subred MPI, deberá modificarse la dirección
predeterminada en las demás CPU.
Para dispositivos con las referencias 6ES7 3xx-xxxxx-0AB0 vala lo siguiente:
Al planificar direcciones MPI para varias CPU, deberán preverse "huecos en las direcciones
MPI" para módulos FM y CP con direcciones MPI propias para que las direcciones no se
asignen por duplicado.
Los ajustes solo deben cargarse a través de la red cuando todos los módulos de una subred
posean direcciones distintas y su estructura real coincida con la configuración de red creada.

Reglas para la asignación de direcciones MPI
● Las direcciones MPI deben asignarse en orden ascendente.
● La dirección MPI 0 debe reservarse para una PG.
● En una subred MPI pueden interconectarse hasta 126 dispositivos (direccionables), y hasta
8 dispositivos con una velocidad de transferencia de 19,2 kbits/s.
● Todas las direcciones MPI de una subred MPI deben ser distintas.
En los manuales de montaje de sistemas de automatización se encuentran más reglas sobre
la configuración de una red.

1.3.2

Comunicación vía conexiones

1.3.2.1

Trabajar con conexiones

Utilizar Open User Communication
Principios básicos de la Open User Communication
Introducción
Open User Communication (OUC) es el nombre de un procedimiento de comunicación
controlado por programa para la comunicación a través de la interfaz PN/IE integrada de las
CPU S7-1200/1500 o S7-300/400. Para este procedimiento de comunicación se dispone de
diversos tipos de conexiones.
La Open User Communication destaca por una elevada flexibilidad en cuanto a las estructuras
de datos que deben transferirse, con lo que permite la comunicación abierta con cualquier
nodo de comunicación, siempre que este soporte los tipos de comunicación disponibles.
Puesto que la comunicación se controla exclusivamente por medio de las instrucciones del
programa de usuario, es posible establecer y deshacer conexiones en función de un evento.
Asimismo, las conexiones pueden modificarse desde el programa de usuario durante el
funcionamiento.

108

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Para las CPUs con una interfaz PN/IE integrada, están disponibles los tipos de conexión TCP,
UDP e ISO on TCP para la Open User Communication. Los interlocutores pueden ser dos
PLCs SIMATIC o bien un PLC SIMATIC y un dispositivo de terceros adecuado.

Instrucciones para la Open User Communication
Después de abrir el editor de programación, en la Task Card "Instrucciones > Comunicación
> Open user Communication" se dispone de distintas instrucciones para crear las conexiones,
dependiendo del tipo de CPU:
● Instrucciones compactas para enviar o recibir datos con las funciones integradas para
establecer o deshacer la conexión (solo S7-1200/1500):
– TSEND_C (establecer/deshacer conexión, enviar)
– TRCV_C (establecer/deshacer conexión, recibir)
● Instrucciones individuales para enviar y recibir datos o para establecer o deshacer las
conexiones:
– TCON (establecer conexión)
– TDISCON (deshacer conexión)
– TSEND (TCP o ISO on TCP: enviar)
– TRCV (TCP o ISO on TCP: recibir)
– TUSEND (UDP: enviar)
– TURCV (UDP: recibir)

Establecimiento de la conexión
En la Open User Communication deben existir instrucciones para establecer y deshacer la
conexión para ambos interlocutores. Un interlocutor envía los datos mediante TSEND,
TUSEND o TSEND_C, mientras que el otro los recibe mediante TRCV, TURCV o TRCV_C.
Uno de los interlocutores empieza a establecer la conexión en calidad de interlocutor activo. El
otro interlocutor reacciona y empieza a establecer su conexión en calidad de interlocutor
pasivo. Cuando ambos interlocutores han lanzado su establecimiento de conexión, se
establece por completo la conexión.

Parametrización de la conexión
El establecimiento de la conexión se parametriza a través de un DB de descripción de conexión
con la estructura TCON_Param, TCON_IP_v4 o TCON_IP_RFC, del modo siguiente:
● Crear manualmente, parametrizar y escribir directamente en la instrucción.
● Soportado por la parametrización de la conexión.
La parametrización de la conexión soporta el establecimiento de la conexión, por lo que es
recomendable utilizar este método antes que otros.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

109

Configuración de dispositivos y redes
1.3 Configurar redes
En la parametrización de la conexión se determina lo siguiente:
● Interlocutor
● Tipo de conexión
● ID de conexión
● DB de descripción de la conexión
● Detalles de la dirección en función del tipo de conexión seleccionado
Asimismo, se determina el interlocutor que activa el establecimiento de la conexión y el que
responde a la petición del interlocutor estableciendo una conexión pasiva.

Consulte también
Funcionamiento de los protocolos orientados a la conexión (Página 122)

Parametrización de la conexión
Resumen de la parametrización de la conexión
Introducción
La parametrización de la conexión se encuentra en la ventana de inspección del editor de
programación si se desea programar una Open User Communication con las instrucciones de
comunicación TSEND_C, TRCV_C o TCON.
La parametrización de la conexión soporta la funcionalidad flexible de la programación de la
comunicación: En un DB global generado automáticamente y derivado de la estructura del tipo
TCON_Param, TCON_IP_v4 o TCON_IP_RFC se guardan los parámetros introducidos en la
parametrización de la conexión. En este DB de descripción de la conexión se modifican los
parámetros de la misma.

110

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Estructura de la parametrización de la conexión
La parametrización de la conexión incluye los componentes siguientes:











①

Instrucción de comunicación para TCON, TSEND_C o TRCV_C

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

111

Configuración de dispositivos y redes
1.3 Configurar redes

②
③
④
⑤

Ficha "Configuración" en la ficha "Propiedades"
Navegación local de la ficha "Configuración"
Propiedades generales de los parámetros de conexión
Detalles de dirección de los parámetros de la conexión (con DBs de conexión seleccionados)

Ficha "Configuración"
Introduzca los parámetros de conexión deseados en la ficha "Configuración". Encontrará el
grupo "Parámetros de la conexión" en la navegación local de la ficha "Configuración". Dicho
grupo contiene la parametrización de la conexión. Aquí se introducen los parámetros de las
conexiones y los detalles de dirección con soporte del sistema. También se cablean los
parámetros de bloque CONNECT (TCON, TSEND_C, TRCV_C) o ID (TCON, TSEND, TRCV,
TUSEND, TURCV) de las instrucciones de comunicación seleccionadas.
Cuando ya están todos los parámetros, se activa una marca de verificación delante del grupo
"Parámetros de la conexión" de la navegación local.
Nota
La parametrización de la conexión no comprueba que las ID de conexión y los números de
puerto (TCP, UDP) o TSAP (ISO on TCP, ISO) sean unívocos. Por consiguiente, al configurar
la Open User Communication hay que procurar asignar parámetros unívocos dentro de un
dispositivo.

Consulte también
Parámetros de conexión conforme a TCON_Param (Página 124)
Parámetros de conexión conforme a TCON_IP_v4 (Página 127)
Parámetros de conexión conforme a TCON_IP_RFC (Página 134)

112

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Descripción de los parámetros de conexión
Resumen
La tabla siguiente muestra los parámetros de conexión generales:
Parámetro

Descripción

Punto final

Se muestra el nombre del punto final local y del punto final del interlocutor.
El punto final local es la CPU para la que se programa TCON, TSEND_C o TRCV_C. Por
tanto, el punto final local siempre se conoce.
El punto final del interlocutor se selecciona en una lista desplegable. Dicha lista muestra
todos los interlocutores disponibles, entre ellos también interlocutores sin especificar para
dispositivos cuyos datos son desconocidos dentro del proyecto.
En S7-1500 puede seleccionarse como punto final del interlocutor "Broadcast" (aviso a todos
los dispositivos de la subred). En CPs o CMs S7-1500 puede seleccionarse como punto final
del interlocutor "Multicast" (aviso a un grupo dentro de la subred). En este caso el tipo de
conexión cambia automáticamente a UDP.
Mientras no se haya seleccionado ningún interlocutor, todos los demás parámetros de la
máscara estarán desactivados salvo el parámetro "Datos de conexión".

Interfaz

Se muestra la interfaz del punto final local. Si hay disponibles varias interfaces, por ejemplo
también a través de CPs o de CMs, la interfaz puede seleccionarse a través de la lista
desplegable. La interfaz del interlocutor no se visualiza ni se selecciona hasta que se ha
seleccionado un punto final especificado del interlocutor.

Subred

Se muestra la subred del punto final local, si existe. La subred del interlocutor no se visualiza
hasta que se selecciona el punto final del interlocutor.
Si como mínimo uno de los dos interlocutores no está conectado a una subred, se conectarán
en red los dos interlocutores.
Solo es posible conectar interlocutores a subredes distintas a través de un routing IP. La
configuración del routing IP puede modificarse en las propiedades de las interfaces Ethernet
en cuestión.

Dirección

Se muestra la dirección IP o la dirección PROFIBUS del punto final local, en función de la
subred utilizada. La dirección correspondiente del interlocutor no se visualiza hasta que se
selecciona el punto final del interlocutor.
Si se ha seleccionado un interlocutor no especificado, el campo de entrada estará vacío y
resaltado en rojo. En este caso hay que indicar una dirección IP o PROFIBUS válida. El tipo
de dirección (IP o PROFIBUS) depende del tipo de subred configurada en el interlocutor local.
Broadcast (solo S7-1500): Si se ha configurado como punto final del interlocutor "Broadcast",
para el interlocutor se registra automáticamente una dirección IP no modificable con la di‐
rección de host 255. La parte de red es la del emisor. Ejemplo: Dirección IP local 192.168.0.1,
dirección IP del interlocutor 192.168.0.255.
Multicast (solo para CPs y CMs S7-1500): Si se ha configurado como punto final del interlo‐
cutor "Multicast", para el interlocutor se registra automáticamente la dirección IP modificable
224.0.1.0.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

113

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Descripción

Tipo de conexión

Elija el tipo de conexión que debe utilizarse en la lista desplegable "Tipo de conexión":
● TCP
● ISO-on-TCP
● UDP
En el S7-1500 se puede seleccionar también el tipo de conexión ISO en TSEND_C y TRCV_C
o TCON en el tipo de configuración de las conexiones configuradas.
Los tipos de conexión solo pueden emplearse con interlocutores que sean asimismo com‐
patibles con el protocolo correspondiente.

Tipo de configuración
(solo para S7-1500)

Para S7-1500 es posible ajustar en TSEND_C y TRCV_C dos tipos de configuración dife‐
rentes:
● Las conexiones programadas utilizan bloques de programa para describir la conexión.
● Las conexiones configuradas se guardan y se crean una vez cargada la configuración en
el dispositivo, en el tiempo de ejecución. A través de la conexión configurada se puede
seleccionar también el tipo de conexión ISO.
El tipo de configuración predeterminado depende del tipo de conexión seleccionado. Si son
posibles ambos tipos de configuración, está predeterminada la conexión programada.
Se debe configurar el mismo tipo de conexión en ambos interlocutores.

ID de conexión

Introduzca la ID de conexión en el campo de entrada. La ID de conexión se modifica en los
campos de entrada o bien se indica directamente en TCON.
Procure asignar una ID de conexión unívoca dentro del dispositivo.

Datos de conexión

En las listas desplegables se muestran los nombres de los DB de descripción de la conexión
estructurados según TCON_IP_v4, TCON_IP_RFC o TCON_Param.
Mediante la lista desplegable puede generarse un bloque de datos nuevo o seleccionarse
uno ya existente. Al mismo se le asignarán automáticamente los valores de la parametriza‐
ción de la conexión. El nombre del bloque de datos seleccionado se registra automática‐
mente en el parámetro de bloque CONNECT de las instrucciones seleccionadas TSEND_C,
TRCV_C o TCON.
Desde la lista desplegable también es posible referenciar otro bloque de datos válido. Si con
el parámetro de entrada CONNECT de las instrucciones avanzadas TSEND_C, TRCV_C o
TCON se hace referencia a un DB que no se corresponde con la estructura de un
TCON_IP_v4, TCON_IP_RFC o TCON_Param, la lista desplegable aparecerá vacía y resal‐
tada en rojo.

Nombre de conexión
(solo para S7-1500)

Si para S7-1500 está ajustado el tipo de configuración de las conexiones configuradas en
TSEND_C y TRCV_C, el parámetro "Datos de conexión" es reemplazado por el parámetro
"Nombre de conexión". En este caso, el nombre de la conexión configurada sirve de fecha de
la conexión.
Después de seleccionar un interlocutor, la lista desplegable permanece vacía. Mediante la
lista desplegable puede generarse una conexión nueva o seleccionarse una ya existente.
Dado el caso, se genera un bloque de datos y se le asignan automáticamente los valores de
la parametrización de la conexión. El nombre del bloque de datos se registra automática‐
mente en el parámetro de bloque CONNECT de la instrucción TSEND_C o TRCV_C.
Desde la lista desplegable también es posible referenciar una conexión existente.

Iniciativa local

114

Determine el interlocutor activo de la Open User Communication mediante el botón de opción
"Iniciativa local" (solo en TCP e ISO on TCP).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Descripción

Puerto

Componente de dirección para una conexión TCP o UDP. El valor predeterminado después
de crear una nueva conexión TCP es 2000.

(solo con TCP y UDP)

Los números de puerto pueden cambiarse
pero tienen que ser unívocos dentro del dispositivo.

TSAP
(solo con ISO on TCP)

Componente de dirección para una conexión ISO on TCP. El valor predeterminado después
de crear una conexión ISO on TCP nueva es E0.01.49.53.4F.6F.6E.54.43.50.2D.31
(S7-1200/1500) o E0.02.49.53.4F.6F.6E.54.43.50.2D.31 (S7-300/400).
La ID TSAP puede introducirse con extensión o como TSAP ASCII.
Los TSAPs tienen que ser unívocos dentro del dispositivo.

Nota
Conexión UDP para configuración "Broadcast" (S7-300/400/1200)
Los parámetros de la conexión UDP para la configuración "Broadcast" en el punto final del
interlocutor se guardan en un DB de descripción de la conexión TCON_IP_v4 : Respecto a la
comunicación UDP con TCON y TUSEND/TURCV , al TCON_IP_v4 no se le asigna ningún
parámetro de interlocutor (valor=0). Sin embargo, la dirección y el puerto interlocutor son
necesarios para el envío de los datos, y el usuario debe registrarlos en TADDR_Param . El
parámetro de bloque TUSEND-/TURCVhace referencia al TADDR_Param para la
comunicación UDP como ADDR . Los valores para ambos parámetros pueden obtenerse de
la parametrización de la conexión.
La configuración debe adaptarse también a los demás receptores de la comunicación UDP.
Para recibir telegramas Broadcast, en el lado del receptor debe configurarse el puerto
interlocutor. Para ello, en el bloque ADDRdebe rellenarse el parámetro RemotePort del
TADDR_Param .
Nota
Comunicación vía TSEND_C y TRCV_C (S7-1500)
Si se emplean TSEND_C y TRCV_C, cada comunicación requiere su propia pareja de bloques
TSEND_C y TRCV_C con una conexión configurada. Para la comunicación, la misma
conexión configurada no puede ser utilizada por varias parejas de bloques TSEND_C y
TRCV_C.
En los parámetros de conexión de la ventana de inspección pueden crearse, con los botones
correspondientes, conexiones adicionales para una instrucción TSEND_C o TRCV_C,
además de los datos de la conexión.
Las conexiones configuradas mediante TSEND_C y TRCV_C se muestran para el bloque
seleccionado TSEND_C o TRCV_C en la ventana de inspección, dentro de una tabla de
conexiones en "Propiedades > Configuración > Vista general de las conexiones configuradas".

Consulte también
Asignación de números de puerto (Página 140)
Estructura TSAP (Página 143)
Ejemplos de asignación TSAP (Página 146)
Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

115

Configuración de dispositivos y redes
1.3 Configurar redes
Capacidad de relectura de los parámetros para la descripción de la conexión (Página 142)
Crear y parametrizar conexiones (Página 117)
Parámetros de conexión conforme a TCON_Param (Página 124)
Parámetros de conexión conforme a TCON_IP_v4 (Página 127)
Parámetros de conexión conforme a TCON_IP_RFC (Página 134)

Iniciar la parametrización de la conexión
La parametrización de la conexión para la Open User Communication se activa en cuanto se
selecciona una instrucción de comunicación TCON, TSEND_C o TRCV_C en un bloque de
programa.

Requisitos
● El proyecto contiene una CPU S7 como mínimo.
● El editor de programación está abierto.
● Existe una red.

Procedimiento
Para insertar las instrucciones avanzadas para la Open User Communication, proceda del
siguiente modo:
1. Abra la Task Card, paleta y carpeta "Instrucciones > Comunicación > Open User
Communication".
2. Arrastre una de las instrucciones siguientes a una red con la función Drag & Drop:
– TSEND_C
– TRCV_C
– TCON
Se abre el cuadro de diálogo "Opciones de llamada".
3. Edite las propiedades del DB instancia en el cuadro de diálogo "Opciones de llamada".
Existen las posibilidades siguientes:
– Modificar el nombre predeterminado.
– Seleccionar el campo de opción "manual" para asignar un número propio.
– Para los bloques de función también puede utilizar el bloque de datos como
multiinstancia.
4. Haga clic en "Aceptar" para concluir la entrada.

Resultado
Para la instrucción insertada TSEND_C, TRCV_C o TCON se crea, para una instancia
individual, un DB de instancia correspondiente. En caso de una multiinstancia, se utiliza el DB
instancia del bloque de función.

116

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Si TSEND_C, TRCV_C o TCON está seleccionado, consulte la ficha "Configuración" en
"Propiedades" de la ventana de inspección. El grupo "Parámetros de la conexión" de la
navegación local contiene la parametrización de la conexión que debe realizarse ahora.

Consulte también
Crear y parametrizar conexiones (Página 117)

Crear y parametrizar conexiones
En la parametrización de la conexión de la Open User Communication se crean y parametrizan
conexiones del tipo TCP, UDP e ISO on TCP.

Requisitos
Existe una CPU con una instrucción de comunicación TCON, TSEND_C o TRCV_C.

Procedimiento
Para crear una conexión de la Open User Communication, proceda del siguiente modo:
1. Seleccione un bloque de la Open User Communication TCON, TSEND_C o TRCV_C en el
editor de programación.
2. En la ventana de inspección abra la ficha "Propiedades > Configuración".
3. Seleccione el grupo "Parámetros de la conexión". Mientras no se haya seleccionado ningún
interlocutor, solo estarán activas las listas desplegables para el punto final del interlocutor
y los datos de conexión locales. Todas las demás entradas posibles estarán desactivadas.
Se mostrarán los parámetros de conexión que ya se conocen:
– Nombre del punto final local
– Interfaz del punto final local
– Dirección IP (con subred Ethernet) o dirección PROFIBUS (con subred PROFIBUS) del
punto final local
4. Para utilizar un DB de descripción de conexión existente, proceda con el paso 6. Para
configurar la conexión con un interlocutor remoto nuevo, continúe aquí:
Seleccione un interlocutor en la lista desplegable del punto final del interlocutor. El
interlocutor puede ser un dispositivo sin especificar o una CPU del proyecto.
Seguidamente, se registrarán automáticamente algunos parámetros de la conexión como
valores predeterminados.
Se ajustan los parámetros siguientes:
– Nombre del punto final del interlocutor
– Interfaz del punto final del interlocutor
– Dirección IP (con subred Ethernet) o dirección PROFIBUS (con subred PROFIBUS) del
punto final del interlocutor
Si los interlocutores están conectados en red, se muestra el nombre de la subred.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

117

Configuración de dispositivos y redes
1.3 Configurar redes
5. Para S7-1500 elija entre utilizar bloques de programa o conexiones configuradas en la lista
desplegable "Tipo de configuración".

118

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
6. En la lista desplegable "Datos de conexión" seleccione un DB existente de descripción de
la conexión o, para conexiones configuradas, una conexión existente en "Nombre de
conexión". También es posible crear otro DB de descripción de la conexión u otra conexión
configurada. Si selecciona un DB de descripción de conexión, se aplican datos de
configuración disponibles y se introducen en la descripción de la conexión. Los datos de un
interlocutor remoto que se hayan introducido antes se sobrescriben. Posteriormente puede
seleccionar adicionalmente otras conexiones configuradas o bien modificar los nombres de
los DB de descripción de conexión para crear bloques de datos nuevos:
– El bloque de datos seleccionado también se ve en el cableado del parámetro de entrada
CONNECT de la instrucción seleccionada TCON, TSEND_C o TRCV_C.
– Si ya se ha indicado un DB de descripción de la conexión para el interlocutor mediante
el parámetro CONNECT de la instrucción TCON, TSEND_C o TRCV_C, podrá utilizarse
dicho DB o bien crearse uno nuevo.
– Si se edita el nombre del bloque de datos visualizado en la lista desplegable, se genera
automáticamente un bloque de datos nuevo con el nombre modificado pero con la
misma estructura y el mismo contenido y se utiliza para la conexión.
– Los nombres modificados de un bloque de datos tienen que ser unívocos en el contexto
del interlocutor.
– Dependiendo del tipo de CPU y de la conexión, un DB de descripción de la conexión
debe tener la estructura TCON_Param, TCON_IP_v4 o TCON_IP_RFC.
– No es posible seleccionar un bloque de datos para un interlocutor sin especificar.
Tras seleccionar o crear el DB de descripción de la conexión o la conexión configurada se
determinan y registran más valores.
Para interlocutores especificados rige lo siguiente:
– Tipo de conexión ISO on TCP
– ID de conexión con el valor predeterminado 1
– Iniciativa local del interlocutor local
– ID de TSAP
para S7-1200/1500: E0.01.49.53.4F.6F.6E.54.43.50.2D.31
para S7-300/400: E0.02.49.53.4F.6F.6E.54.43.50.2D.31
Para interlocutores sin especificar rige lo siguiente:
– Tipo de conexión TCP
– Puerto interlocutor 2000
Para una conexión configurada con interlocutor especificado rige lo siguiente:
– Tipo de conexión TCP
– ID de conexión con el valor predeterminado 257
– Iniciativa local del interlocutor local
– Puerto interlocutor 2000
Para una conexión configurada con interlocutor no especificado rige lo siguiente:
– Tipo de conexión TCP
– Puerto local 2000

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

119

Configuración de dispositivos y redes
1.3 Configurar redes
7. Indique una ID de conexión para el interlocutor si fuera necesario. Si hay un interlocutor sin
especificar, no es posible asignarle ninguna ID de conexión.
Nota
Para un interlocutor conocido debe introducir una ID de conexión unívoca. La univocidad de
la ID de conexión no es verificada por la parametrización de conexiones y al crear una
conexión no se registra ningún valor predeterminado para la ID de la conexión.
8. Seleccione el tipo de conexión deseado en la lista desplegable correspondiente. Los
detalles de la dirección se ajustan con valores estándar en función del tipo de conexión.
Puede elegir entre:
– TCP
– ISO-on-TCP
– UDP
Para conexiones configuradas en el S7-1500 también vale ISO.
9. Los campos de entrada se editan en los detalles de dirección. Según sea el protocolo
ajustado, se pueden editar los puertos (para TCP y UDP) o los TSAP (para ISO on TCP e
ISO).
10.Ajuste el comportamiento de establecimiento de la conexión con los botones de opción
"Iniciativa local" en TCP, ISO e ISO on TCP. Existe la posibilidad de elegir qué interlocutor
debe establecer la conexión activamente.
La parametrización de la conexión comprueba inmediatamente si los valores modificados
presentan errores de entrada y los registra en el bloque de datos para la descripción de la
conexión.
Nota
La Open User Communication entre dos interlocutores no estará lista hasta que se haya
cargado en el hardware también la parte del programa destinada al punto final del interlocutor.
Para que la comunicación funcione, asegúrese de no cargar en el dispositivo únicamente la
descripción de la conexión de la CPU local, sino también la de la CPU partner.

Consulte también
Descripción de los parámetros de conexión (Página 113)
Iniciar la parametrización de la conexión (Página 116)
Estructura TSAP (Página 143)
Asignación de números de puerto (Página 140)
Parámetros de conexión conforme a TCON_Param (Página 124)
Parámetros de conexión conforme a TCON_IP_v4 (Página 127)
Parámetros de conexión conforme a TCON_IP_RFC (Página 134)

120

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Borrar conexiones
Introducción
Los datos de una conexión creada para la Open User Communication se almacenan en un DB
de descripción de la conexión. La conexión se borra borrando el bloque de datos con la
descripción de la conexión incluida.

Requisitos
Se ha creado una conexión de la Open User Communication.

Procedimiento
Para borrar una conexión, proceda del siguiente modo:
1. Seleccione un interlocutor de la Open User Communication en el árbol del proyecto.
2. Abra la carpeta "Bloques de programa > Bloques de sistema > Recursos de programa"
situada debajo del interlocutor seleccionado.
3. Elija el comando "Borrar" del menú contextual del bloque de datos con la parametrización
de la conexión.
Nota
Si no sabe exactamente qué bloque hay que borrar, abra la instrucción avanzada TCON,
TSEND_C o TRCV_C. Encontrará el nombre del bloque de datos como parámetro de entrada
CONNECT o en la parametrización de la conexión como parámetro "Datos de conexión".
Si sólo se borra el DB instancia de las instrucciones avanzadas TCON, TSEND_C o TRCV_C,
no se borrarán las conexiones parametrizadas.
Nota
Si todavía hay bloques de las instrucciones avanzadas que están utilizando el DB de conexión,
habrá que borrar también de la carpeta de bloques las llamadas correspondientes, sus DBs de
instancia y, si existen, los bloques combinados TSEND_C y TRCV_C, siempre que no se
utilicen en otro lugar.
De este modo se impide que el programa sea incoherente.

Resultado
Se ha borrado la conexión.
Nota
Vuelva a insertar una instrucción avanzada TCON, TSEND_C o TRCV_C para hacer
referencia de nuevo mediante el parámetro "Datos de conexión" a una descripción de conexión
ya existente de estructura TCON_Param, TCON_IP_v4 o TCON_IP_RFC.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

121

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros de conexión
Funcionamiento de los protocolos orientados a la conexión
Introducción
Los protocolos orientados a la conexión establecen una conexión lógica con el interlocutor
antes de la transferencia de datos y la deshacen una vez concluida la transferencia, dado el
caso. Los protocolos orientados a la conexión se utilizan especialmente cuando lo importante
en la transferencia de datos es la fiabilidad. A través de una línea física es posible establecer
varias conexiones lógicas.
La Open User Communication soporta los tipos de conexión siguientes:
● TCP
● ISO-on-TCP
● ISO (solo S7-1500)
● UDP
Para una conexión, los dos interlocutores deben soportar el mismo tipo de conexión. Si, por
ejemplo, un interlocutor no soporta una conexión del tipo ISO on TCP, pruebe a utilizar el tipo
de conexión TCP, si es que se soporta.
Para interlocutores que no se puedan configurar en el TIA Portal, por ejemplo dispositivos de
terceros o PC, introduzca el punto final del interlocutor "sin especificar" en la parametrización
de la conexión. El tipo de conexión necesario para dispositivos no especificados debe
consultarse en la documentación correspondiente.

Nota
Conexiones con ISO
En las CPU S7-1500 es posible crear conexiones configuradas del tipo ISO mediante las
instrucciones TSEND_C y TRCV_C. Para más información sobre estos tipos de conexiones
consulte las descripciones generales de las conexiones.

Características de TCP
TCP es un protocolo de streaming en el que la longitud del flujo de datos se transmite al
receptor para que pueda recibir el flujo de datos en forma de segmentos TCP individuales. Por
tanto, en la transferencia de datos a través de una conexión TCP no se transmite información
sobre el principio y el final de un mensaje. El receptor no puede saber dónde termina un
mensaje en el flujo de datos y dónde empieza el siguiente a partir de los segmentos recibidos
en el flujo de datos. Por ello, es recomendable asignar al número de bytes que deben recibirse
(parámetro LEN, instrucción TRCV/TRCV_C) el mismo valor que al número de bytes que
deben enviarse (parámetro LEN, instrucción TSEND/TSEND_C).

122

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Si la longitud de los datos enviados no coincide con la de los datos esperados, se procede del
siguiente modo:
● Longitud de los datos que deben recibirse (parámetro LEN, instrucción TRCV/TRCV_C)
mayor que la longitud de los datos enviados (parámetro LEN, instrucción TSEND/
TSEND_C):
TRCV/TRCV_C no copia los datos recibidos en el área de recepción predefinida (parámetro
DATA) hasta que se ha alcanzado la longitud parametrizada. Cuando se alcanza la longitud
parametrizada, ya se reciben datos de una petición posterior. En este caso, en el área de
recepción habrá datos de dos peticiones de transmisión distintas. Si no se conoce la
longitud exacta del primer mensaje, no será posible reconocer el final del primero ni el
principio del segundo.
● Longitud de los datos que deben recibirse (parámetro LEN, instrucción TRCV/TRCV_C)
menor que la longitud de los datos enviados (parámetro LEN, instrucción TSEND/
TSEND_C):
TRCV/TRCV_C copia tantos bytes en el área de datos recibidos (parámetro DATA) como
los predefinidos en el parámetro LEN. Seguidamente, pone el parámetro de estado NDR a
TRUE (petición concluida correctamente) y asigna el valor de LEN a RCVD_LEN (número
de datos realmente recibidos). Con cada llamada posterior se obtendrá un bloque adicional
de los datos enviados.
A través de la variante de protocolo del modo Ad-hoc, en las instrucciones TRCV/TRCV_C se
puede determinar un área de recepción con una longitud de datos fija.

Características de ISO on TCP
ISO on TCP es un protocolo orientado a mensajes que detecta el fin del mensaje en el lado del
receptor e indica al usuario los datos pertenecientes al mensaje. Esto no depende de la
longitud de recepción especificada del mensaje. Por tanto, al transferir datos a través de una
conexión ISO on TCP, se suministra información relacionada con la longitud y el final de un
mensaje.
Si la longitud de los datos enviados no coincide con la de los datos esperados, se procede del
siguiente modo:
● Longitud de los datos que deben recibirse (parámetro LEN, instrucción TRCV/TRCV_C)
mayor que la longitud de los datos enviados (parámetro LEN, instrucción TSEND/
TSEND_C):
TRCV/TRCV_C copia todos los datos enviados en el área de datos recibidos (parámetro
DATA). Seguidamente, pone el parámetro de estado NDR a TRUE (petición concluida
correctamente) y asigna la longitud de los datos enviados a RCVD_LEN (número de datos
realmente recibidos).
● Longitud de los datos que deben recibirse (parámetro LEN, instrucción TRCV/TRCV_C)
menor que la longitud de los datos enviados (parámetro LEN, instrucción TSEND/
TSEND_C):
TRCV/TRCV_C no copia datos en el área de datos recibidos (parámetro DATA), sino que
proporciona la información de error siguiente: ERROR=1, STATUS=W#16#8088 (búfer de
destino demasiado pequeño).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

123

Configuración de dispositivos y redes
1.3 Configurar redes

Características de UDP
UDP es un protocolo orientado a mensajes que detecta el fin del mensaje en el lado del
receptor e indica al usuario los datos pertenecientes al mensaje. Esto no depende de la
longitud de recepción especificada del mensaje. Por tanto, al transferir datos a través de una
conexión UDP, se suministra información relacionada con la longitud y el final de un mensaje.
Si la longitud de los datos enviados no coincide con la de los datos esperados, se procede del
siguiente modo:
● Longitud de los datos que deben recibirse (parámetro LEN, instrucción TURCV/TRCV_C)
mayor que la longitud de los datos enviados (parámetro LEN, instrucción TUSEND/
TSEND_C):
TURCV/TRCV_C copia todos los datos enviados en el área de datos recibidos (parámetro
DATA). Seguidamente, pone el parámetro de estado NDR a TRUE (petición concluida
correctamente) y asigna la longitud de los datos enviados a RCVD_LEN (número de datos
realmente recibidos).
● Longitud de los datos que deben recibirse (parámetro LEN, instrucción TURCV/TRCV_C)
menor que la longitud de los datos enviados (parámetro LEN, instrucción TUSEND/
TSEND_C):
TURCV/TRCV_C copia tantos datos en el área de datos recibidos (parámetro DATA) como
los solicitados en el parámetro LEN. No se generan más mensajes de error. En este caso,
el usuario debe volver a llamar un T_URCV para recibir los bytes restantes.

Consulte también
Principios básicos de la Open User Communication (Página 108)

Parámetros de conexión conforme a TCON_Param
Bloque de datos para descripción de la conexión
Para parametrizar las conexiones en TCP, UDP e ISO on TCP, para algunas CPUs de la
S7-1200 se utiliza un DB de descripción de la conexión con una estructura conforme a
TCON_Param. La estructura de datos fija de TCON_Param contiene los parámetros
necesarios para establecer la conexión. El DB de descripción de la conexión lo crea
automáticamente la parametrización de la conexión de la Open User Communication cuando
se utilizan las instrucciones TSEND_C, TRCV_C o TCON para una conexión nueva.
El parámetro de conexión CONNECT de los DB de instancia para TSEND_C, TRCV_C o
TCON contiene una referencia al bloque de datos utilizado.

Estructura de la descripción de la conexión conforme a TCON_Param
Byte

Parámetro

Tipo de datos Valor de arran‐ Descripción
que

0 … 1 block_length

UINT

64

Longitud: 64 bytes (fija)

2 … 3 id

CONN_OUC

1

Referencia a esta conexión (rango de valores: de 1 a 4095).
El valor de este parámetro debe indicarse en ID para la ins‐
trucción TSEND_C, TRCV_C o TCON.

124

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Byte

Parámetro

Tipo de datos Valor de arran‐ Descripción
que

4

connection_type

USINT

17

Tipo de conexión:
● 17: TCP (17 dec = 0x11 hex)
● 18: ISO on TCP (18 dec = 0x12 hex)
● 19: UDP (19 dec = 0x13 hex)

5

active_est

BOOL

TRUE

Identificador del tipo de establecimiento de la conexión. En
UDP siempre rige FALSE, porque es posible enviar o recibir
datos mediante la ID local.
Para TCP e ISO on TCP rige lo siguiente:
● FALSE: establecimiento pasivo de la conexión
● TRUE: establecimiento activo de la conexión

6

local_device_id

USINT

1

Identificador de la interfaz local PN/IE.

7

local_tsap_id_len

USINT

0

Longitud utilizada del parámetro local_tsap_id en bytes; valo‐
res posibles:
● 0 o 2, si el tipo de conexión = 17 (TCP)
Para el lado activo solo se admite el valor 0.
● de 2 a 16, si el tipo de conexión = 18 (ISO on TCP)
● 2, si el tipo de conexión = 19 (UDP)

8

rem_subnet_id_len

USINT

0

Este parámetro no se utiliza.

9

rem_staddr_len

USINT

4

Longitud de la dirección del punto final del interlocutor en
bytes:
● 0: sin especificar, es decir, el parámetro rem_staddr es
irrelevante.
● 4: dirección IP válida en el parámetro rem_staddr
(solo TCP e ISO on TCP)

10

rem_tsap_id_len

USINT

2

Longitud utilizada del parámetro rem_tsap_id en bytes; valo‐
res posibles:
● 0 o 2, si el tipo de conexión = 17 (TCP)
Para el lado pasivo solo se admite el valor 0.
● de 2 a 16, si el tipo de conexión = 18 (ISO on TCP)
● 0, si el tipo de conexión = 19 (UDP)

11

next_staddr_len

USINT

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

0

Este parámetro no se utiliza.

125

Configuración de dispositivos y redes
1.3 Configurar redes
Byte

Parámetro

Tipo de datos Valor de arran‐ Descripción
que

12 …
27

local_tsap_id

ARRAY
[1..16] of
BYTE

-

Componente de dirección local de la conexión:
● TCP y UDP: n.º de puerto local (valores posibles:
1...49151; valores recomendados: 2000...5000);
local_tsap_id[1] = byte High del n.º de puerto en
representación hexadecimal;
local_tsap_id[2] = byte Low del n.º de puerto en
representación hexadecimal;
local_tsap_id[3-16] = irrelevante
● ISO on TCP: ID TSAP local:
local_tsap_id[1] = B#16#E0;
local_tsap_id[2] = rack y slot de los puntos finales locales
(bits de 0 a 4: número de slot, bits de 5 a 7: número de
rack);
local_tsap_id[3-16] = extensión TSAP, opcional
Nota: asegúrese de que todos los valores de local_tsap_id
sean unívocos dentro de la CPU.

28 …
33

rem_subnet_id

ARRAY [1..6]
of USINT

-

Este parámetro no se utiliza.

34 …
39

rem_staddr

ARRAY [1..6]
of USINT

-

Solo TCP e ISO on TCP: Dirección IP del punto final del in‐
terlocutor, p. ej. para 192.168.002.003:
● rem_staddr[1] = 192
● rem_staddr[2] = 168
● rem_staddr[3] = 002
● rem_staddr[4] = 003
● rem_staddr[5-6] = irrelevante

40 …
55

rem_tsap_id

ARRAY
[1..16] of
BYTE

-

Componente de dirección del interlocutor de la conexión
● TCP: n.º de puerto interlocutor (valores posibles:
1...49151; valores recomendados: 2000...5000);
rem_tsap_id[1] = byte alto del n.º de puerto en
representación hexadecimal;
rem_tsap_id[2] = byte bajo del n.º de puerto en
representación hexadecimal;
rem_tsap_id[3-16] = irrelevante
● ISO on TCP: ID TSAP del interlocutor:
rem_tsap_id[1] = B#16#E0;
rem_tsap_id[2] = rack y slot del punto final del interlocutor
(bits 0 a 4: número de slot, bits de 5 a 7: número de rack);
rem_tsap_id[3-16] = extensión TSAP, opcional
● UDP: Este parámetro no se utiliza.

56 …
61

next_staddr

ARRAY [1..6]
of BYTE

62 …
63

spare

WORD

126

W#16#0000

Este parámetro no se utiliza.
Reservado.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Nota
TCON_Param para la CPU S7-1500
El DB de descripción de la conexión con la estructura conforme a TCON_Param también es
soportado por CPU S7-1500 por motivos de migración. Sin embargo, se recomienda utilizar las
nuevas estructuras TCON_IP_v4 y TCON_IP_RFC.
Nota
TCON_Param para CPU S7-1500 R/H
El DB de descripción de la conexión con la estructura conforme a TCON_Param no está
soportado por las CPU S7-1500 R/H.

Consulte también
Funcionamiento de los protocolos orientados a la conexión (Página 122)
Descripción de los parámetros de conexión (Página 113)
Capacidad de relectura de los parámetros para la descripción de la conexión (Página 142)
Resumen de la parametrización de la conexión (Página 110)
Estructura TSAP (Página 143)
Asignación de números de puerto (Página 140)

Parámetros de conexión conforme a TCON_IP_v4
Bloque de datos para descripción de la conexión
Para parametrizar las conexiones en TCP y UDP, para las CPU S7-1200 a partir de V4.0 y
S7-1500 se utiliza un DB de descripción de la conexión con una estructura conforme a
TCON_IP_v4. La estructura de datos fija de TCON_IP_v4 contiene los parámetros necesarios
para establecer la conexión. El DB de descripción de la conexión lo crea automáticamente la
parametrización de la conexión de la Open User Communication cuando se utilizan las
instrucciones TSEND_C, TRCV_C o TCON para una conexión nueva.
El parámetro de conexión CONNECT de los DB de instancia para TSEND_C, TRCV_C o
TCON contiene una referencia al bloque de datos utilizado.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

127

Configuración de dispositivos y redes
1.3 Configurar redes

Estructura de la descripción de la conexión conforme a TCON_IP_v4
Byte

Parámetro

Tipo de datos Valor de arran‐ Descripción
que

0 … 1 InterfaceId

HW_ANY

64

Identificador de hardware de la interfaz local (rango de valo‐
res: de 0 a 65535).

2 … 3 ID

CONN_OUC

1

Referencia a esta conexión (rango de valores: de 1 a 4095).
El valor de este parámetro debe indicarse en ID para la ins‐
trucción TSEND_C, TRCV_C o TCON.

4

ConnectionType

BYTE

11

Tipo de conexión:
● 11: TCP (11 dec = 0x0B hex)
● 17 TCP (17 dec = 0x11 hex)
● 19: UDP (19 dec = 0x13 hex)

5

ActiveEstablished

BOOL

TRUE

Identificador del tipo de establecimiento de conexión:
● FALSE: establecimiento pasivo de la conexión
● TRUE: establecimiento activo de la conexión

6 … 9 RemoteAddress

ARRAY [1..4] of BYTE

● Dirección IP del punto final del interlocutor, p. ej. para
192.168.0.1:
–

addr[1] = 192

–

addr[2] = 168

–

addr[3] = 0

–

addr[4] = 1

● Dirección Multicast de un grupo Multicast IPv4 (para CPU
S7-1500 a partir de la versión de firmware V2.0 o V2.1
cuando se utiliza TSEND_C/TRCV_C)
10 ...
11

RemotePort

UINT

2000

Dirección de puerto del interlocutor remoto (rango de valores:
de 1 a 49151).

12 ...
13

LocalPort

UINT

2000

Dirección de puerto del interlocutor local (rango de valores: de
1 a 49151).

Consulte también
Funcionamiento de los protocolos orientados a la conexión (Página 122)
Descripción de los parámetros de conexión (Página 113)
Capacidad de relectura de los parámetros para la descripción de la conexión (Página 142)
Resumen de la parametrización de la conexión (Página 110)
Asignación de números de puerto (Página 140)

128

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros de conexión conforme a TCON_IP_V4_SEC
Bloque de datos de descripción de la conexión
Con el fin de parametrizar las conexiones de comunicación en TCP mediante IPv4 con Secure
Communication, utilice los módulos siguientes:
● CPU con DB de descripción de la conexión con la estructura del SDT TCON_IP_V4_SEC:
– S7-1200 con firmware V4.4 o superior
– S7-1500 con firmware V2.0 o superior
● También opcionalmente con los siguientes CP:
– CP 1243-1 con firmware V3.2 o superior
– CP 1243-8 IRC con firmware V3.2 o superior
– CP 1543-1 con firmware V2.0 o superior
– CP 1545-1
– CP 1543SP-1
Nota
Conexión TCP o UDP no segura a través de IPv4
También es posible utilizar el SDT TCON_IP_V4_SEC para una conexión TCP o UDP no
segura a través de IPv4.
El parámetro de conexión CONNECT de los DB de instancia para TCON contiene una
referencia al bloque de datos utilizado.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

129

Configuración de dispositivos y redes
1.3 Configurar redes

Estructura de la descripción de la conexión conforme a TCON_IP_V4_SEC
Byte

Parámetro

Tipo de datos Valor de arran‐ Descripción
que

0…
15

ConnPara

TCON_IP_v4

-

SDT para los parámetros de la conexión
Nota sobre interface_id:
● Si se deja interface_id en el valor predeterminado 0, el
sistema operativo de la CPU evalúa la dirección IP remota
y las rutas IP existentes localmente y a continuación
define una interfaz Industrial Ethernet de la CPU para
establecer la conexión OUC segura.
En este caso los datos de diagnóstico se asignan siempre
a la primera interfaz Industrial Ethernet de la CPU.
● Si como interface_id se indica la ID de hardware de una
interfaz Industrial Ethernet de la CPU o de un CP, la
conexión OUC segura se establecerá a través de la
correspondiente interfaz Industrial Ethernet.

16

ActivateSecure‐
Conn

BOOL

FALSE

Activación de Secure Communication para esta conexión

17

TLSServerReq‐
ClientCert

BOOL

FALSE

Solo para el lado del servidor: solicitud de un certificado X.509V3 del cliente TLS

18 ...
19

ExtTLSCapabilities

WORD

16#0

● Bit 0: Solo para el lado del cliente. Un bit activado significa
que el cliente valida el nombre alternativo del titular del
certificado (subjectAlternateName) en el certificado X.509V3 del servidor para comprobar la identidad del servidor.
Los certificados se comprueban al establecer la conexión.

Si este parámetro tiene el valor FALSE, los parámetros de
seguridad siguientes serán irrelevantes, es decir, la conexión
no será segura. En tal caso es posible crear una conexión
TCP o UDP no segura.

● Bits 1 a 15: reservados para futuras ampliaciones
20 ...
23

TLSServerCertRef

24 …
27

TLSClientCertRef

130

UDINT

0

● Lado del servidor: ID del certificado X.509-V3 propio
● Lado del cliente: ID del certificado X.509-V3
(habitualmente un certificado CA) que el cliente TLS utiliza
para validar la autenticación del servidor TLS. Si este
parámetro es 0, para validar la autenticación del servidor
el cliente TLS utiliza todos los certificados (CA) que hay
actualmente cargados en el almacén de certificados del
cliente.

UDINT

0

● Lado del cliente: ID del certificado X.509-V3 propio
● Lado del servidor: ID del certificado X.509-V3 (o de un
grupo de certificados X.509-V3) que el servidor TLS utiliza
para validar la autenticación del cliente TLS. Si este
parámetro es 0, para validar la autenticación del cliente el
servidor TLS utiliza todos los certificados (CA) que hay
actualmente cargados en el almacén de certificados del
servidor.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Consulte también
Parámetros de conexión conforme a TCON_IP_v4 (Página 127)
Secure OUC entre dos CPU S7-1500 (Página 773)

Parámetros de conexión conforme a TCON_QDN
Bloque de datos para describir la conexión
Con el fin de parametrizar las conexiones de comunicación en TCP y UDP mediante el nombre
del dominio plenamente cualificado, utilice las CPU siguientes con DB de descripción de la
conexión y una estructura conforme a TCON_QDN:
● CPU S7-1200 con firmware V4.4 o superior
● CPU S7-1500 con firmware V2.0 o superior
El parámetro de conexión CONNECT de los DB de instancia para TCON contiene una
referencia al bloque de datos utilizado.
Nota
Estructura TCON_DNS
TCON_QDN reemplaza a TCON_DNS Por este motivo solo deben emplearse DB de
descripción de conexión con una estructura conforme a TCON_QDN.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

131

Configuración de dispositivos y redes
1.3 Configurar redes

Estructura de la descripción de la conexión conforme a TCON_QDN
Byte

Parámetro

0 … 1 interface_id

Tipo de datos Valor de arran‐ Descripción
que
HW_ANY

0

CPU S7-1200 con firmware V4.4 o superior / CPU S7-1500
con firmware V2.8 o superior:
● InterfaceId de un CP insertado:
–

con CP de S7-1500 con firmware V2.2 o superior

–

con CP de S7-1200 con firmware V3.2 o superior

–

con CP de ET 200SP con firmware V2.1 o superior

● 0 (solo CPU S7-1500 con firmware V2.8 o superior):
Mientras se está estableciendo la conexión, está asignada
a la primera interfaz PROFINET. Nada más establecerse
con éxito la conexión, se asigna a la interfaz PROFINET
utilizada.
CPU S7-1200 con firmware inferior a V4.4 / CPU S7-1500 con
firmware inferior a V2.8:
● Parámetro irrelevante
● A partir de la versión de firmware 2.0 de las CPU S7-1500
se aplica: mientras se está estableciendo la conexión,
está asignada a la primera interfaz PROFINET. Nada más
establecerse correctamente la conexión, se asigna a la
interfaz PROFINET utilizada.
2 … 3 id

CONN_OUC

1

Referencia a esta conexión (rango de valores: de 1 a 4095).
El valor de este parámetro debe indicarse en ID para la ins‐
trucción TCON.

4

connection_type

BYTE

11

Tipo de conexión:
● 11: TCP (11 dec = 0x0B hex)
● 19: UDP (19 dec = 0x13 hex)
Por motivos de compatibilidad y de migración, la CPU
S7-1500 también permite los valores del DB de descripción de
la conexión con una estructura conforme a TCON_Param. Por
tanto, para el tipo de conexión TCP también está permitida la
entrada 17 (17 dec = 0x11 hex).

5

active_established

BOOL

TRUE

Identificador del tipo de establecimiento de conexión:
● FALSE: establecimiento pasivo de la conexión
● TRUE: establecimiento activo de la conexión

6 ...
261

remote_qdn

Array of
STRING
[1..254]

-

Fully qualified domain name del punto final del interlocutor,
que debe terminar con ".".
Tenga en cuenta que en un entorno SIMATIC el nombre, in‐
cluido el punto final, no puede tener más de 254 caracteres de
longitud.

262
…
263

remote_port

UINT

2000

Dirección de puerto del interlocutor remoto (rango de valores:
de 1 a 49151).

264
…
265

local_port

UINT

2000

Dirección de puerto del interlocutor local (rango de valores: de
1 a 49151).

132

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros de conexión conforme a TCON_QDN_SEC
Bloque de datos de descripción de la conexión
Con el fin de parametrizar las conexiones de comunicación en TCP mediante el nombre del
dominio plenamente cualificado utilizando Secure Communication, utilice las CPU siguientes
con DB de descripción de la conexión y una estructura del SDT TCON_QDN_SEC:
● CPU S7-1200 con firmware V4.4 o superior
● CPU S7-1500 con firmware V2.0 o superior
Nota
Conexión TCP o UDP no segura mediante el nombre del dominio plenamente cualificado
También es posible utilizar el SDT TCON_QDN_SEC para una conexión TCP o UDP no segura
a través del nombre del dominio plenamente cualificado.
El parámetro de conexión CONNECT de los DB de instancia para TCON contiene una
referencia al bloque de datos utilizado.

Estructura de la descripción de la conexión conforme a TCON_QDN_SEC
Byte

Parámetro

Tipo de datos Valor de arran‐ Descripción
que

0…
271

ConnPara

TCON_QDN

-

272

ActivateSecure‐
Conn

BOOL

FALSE

TLSServerReq‐
ClientCert

BOOL

FALSE

Solo para el lado del servidor: solicitud de un certificado X.509V3 del cliente TLS

WORD

16#0

● Bit 0: Solo para el lado del cliente. Un bit activado significa
que el cliente valida el subjectAlternateName en el
certificado X.509-V3 del servidor para comprobar la
identidad del servidor. Los certificados se comprueban al
establecer la conexión.

273

274 .. ExtTLSCapabilities
. 275

Parámetro de la conexión
Activación de secure communication para esta conexión
Si este parámetro tiene el valor FALSE, los parámetros de
seguridad siguientes son irrelevantes. En tal caso es posible
crear una conexión TCP o UDP no segura.

● Bits 1 a 15: reservados para futuras ampliaciones

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

133

Configuración de dispositivos y redes
1.3 Configurar redes
Byte

Parámetro

Tipo de datos Valor de arran‐ Descripción
que

276 .. TLSServerCertRef
. 279

UDINT

280
…
283

UDINT

TLSClientCertRef

0

● Lado del servidor: ID del certificado X.509-V3 propio
● Lado del cliente: ID del certificado X.509-V3
(habitualmente un certificado CA) que el cliente TLS utiliza
para validar la autenticación del servidor TLS. Si este
parámetro es 0, para validar la autenticación del servidor
el cliente TLS utiliza todos los certificados (CA) que hay
actualmente cargados en el Certificate Store del cliente.

0

● Lado del cliente: ID del certificado X.509-V3 propio
● Lado del servidor: ID del certificado X.509-V3 (o de un
grupo de certificados X.509-V3) que el servidor TLS utiliza
para validar la autenticación del cliente TLS. Si este
parámetro es 0, para validar la autenticación del cliente el
servidor TLS utiliza todos los certificados (CA) que hay
actualmente cargados en el Certificate Store del servidor.

Consulte también
Parámetros de conexión conforme a TCON_QDN (Página 131)
Secure OUC entre dos CPU S7-1500 (Página 773)
Secure OUC de una CPU S7-1500 como cliente TLS a un PLC de terceros (servidor TLS)
(Página 776)
Secure OUC de una CPU S7-1500 como servidor TLS a un PLC de terceros (cliente TLS)
(Página 779)
Secure OUC a través de correo electrónico (Página 785)

Parámetros de conexión conforme a TCON_IP_RFC
Bloque de datos para la descripción de la conexión
Para parametrizar las conexiones en ISO on TCP, paralas CPU S7-1200 a partir de V4.0 y
S7-1500 se utiliza un DB de descripción de la conexión con una estructura conforme a
TCON_IP_RFC. La estructura de datos fija de TCON_IP_RFC contiene los parámetros
necesarios para establecer la conexión. El DB de descripción de la conexión lo crea
automáticamente la parametrización de conexión de la Open User Communication cuando se
utilizan las instrucciones TSEND_C, TRCV_C o TCON para una conexión nueva.
El parámetro de conexión CONNECT de los DB de instancia para TSEND_C, TRCV_C o
TCON contiene una referencia al bloque de datos utilizado.

134

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Estructura de la descripción de la conexión conforme a TCON_IP_RFC
Byte

Parámetro

Tipo de datos Valor de arran‐ Descripción
que

0 … 1 Interface_id

HW_ANY

64

Identificador de hardware de la interfaz local (rango de valo‐
res: de 0 a 65535).

2 … 3 id

CONN_OUC

1

Referencia a esta conexión (rango de valores: de 1 a 4095).
El valor de este parámetro debe indicarse bajo ID para la
instrucción TSEND_C, TRCV_C o TCON.

4

connection_type

BYTE

12

Tipo de conexión 12: ISO on TCP (12 dec = 0x0C hex)
Por motivos de compatibilidad y de migración, la CPU
S7-1500 también permite los valores del DB para la descrip‐
ción de la conexión con una estructura después de TCON_Pa‐
ram. Por tanto, para el tipo de conexión ISO on TCP también
está permitida la entrada 18 (18 dec = 0x12 hex).

5

active_established

BOOL

TRUE

Identificador del tipo de establecimiento de conexión:
● FALSE: establecimiento de conexión pasivo
● TRUE: iniciativa local

8…
11

remote_address

ARRAY [1..4] of BYTE

Dirección IP del punto final del interlocutor, p. ej. para
192.168.0.1:
● addr[1] = 192
● addr[2] = 168
● addr[3] = 0
● addr[4] = 1

12 …
45

remote_tselector

TSelector

-

TSelector del interlocutor remoto:
● TSelLength = rango de valores de 0 a 32 como UINT
● TSel[1-32] = rango de valores de 0 a 255 en bytes

46 …
79

local_tselector

TSelector

-

TSelector del interlocutor local:
● TSelLength = rango de valores de 0 a 32 como UINT
● TSel[1-32] = rango de valores de 0 a 255 en bytes

Consulte también
Funcionamiento de los protocolos orientados a la conexión (Página 122)
Descripción de los parámetros de conexión (Página 113)
Capacidad de relectura de los parámetros para la descripción de la conexión (Página 142)
Resumen de la parametrización de la conexión (Página 110)
Estructura TSAP (Página 143)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

135

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros de conexión conforme a TCON_Phone
Tipos de datos de sistema TCON_... para conexiones de Telecontrol
TCON_PHONE se utiliza como descripción de la conexión para los siguientes tipos de
conexión:
● En CP de telefonía móvil de S7-1200 para conexiones de la Open User Communication con
el fin de transferir SMS a través de TCON / TDISCON / TSEND o TSEND_C
● En CP 1242-7 para conexiones de Telecontrol con clientes SMS a través de TC_CON
Para configurar el establecimiento de una conexión utilizando una de las instrucciones citadas
anteriormente se utiliza el parámetro CONNECT de la instrucción para la descripción de la
conexión.
La descripción de la conexión está especificada por la estructura del tipo de datos de sistema
(SDT) TCON_Phone. La estructura del SDT correspondiente contiene los parámetros
necesarios para establecer el enlace con un interlocutor remoto.

Creación de un DB del tipo TCON_Phone
El tipo de datos del DB debe introducirse con el teclado. No se muestra en la lista de selección.
No se distingue entre mayúsculas y minúsculas a la hora de introducir el tipo de datos.
Para crear el DB proceda del siguiente modo:
1. Cree un bloque de datos del tipo "DB Global" con acceso al bloque "estándar".
Para ello, desactive la propiedad "Acceso optimizado" en la ficha "Atributos" de las
propiedades del bloque (menú contextual).
2. Cree un SDT en la tabla de configuración de parámetros del DB.
3. Introduzca el siguiente nombre en la celda del tipo de datos de la tabla de declaración del
DB: TCON_Phone
Se crea el SDT con sus parámetros (ver abajo).
4. Configure los parámetros que se describen a continuación.
Los bits reservados no se muestran.

Tipo de datos de sistema TCON_Phone para conexiones SMS
Nota
Texto SMS
● Se accede a los textos SMS programados para SMS que deben ser enviados a través del
parámetro DATA de la instrucción TC_SEND.
● El texto de un SMS recibido se asigna al rango de direcciones de la CPU a través del
parámetro DATA de la instrucción TC_RECV.

136

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Tabla 1-2

Parámetros de TCON_Phone

Byte

Parámetro

Tipo de datos

0 ... 1

InterfaceId

HW_ANY

2 ... 3

ID

CONN_OUC

Valor inicial

Descripción
Referencia a la interfaz local (interfaz de Telecontrol o
interfaz Ethernet del CP > "Identificador HW")

1...07FFh

Referencia a la conexión local de telefonía móvil. La
ID se asigna y debe ser unívoca dentro de la CPU.
Nota sobre las conexiones de Telecontrol del CP
1242-7:
Aquí debe emplearse el mismo valor que el de la ID de
parámetro de la instrucción TC_CON.

4

ConnectionType

Byte

5

ActiveEstablished

Bool

W#16#0E

Variante de protocolo 14 (Eh): enlace SMS
Identificación del tipo de establecimiento del enlace
(no relevante para el CP 1242‑7):
● 0: establecimiento pasivo del enlace (irrelevante
en este caso)
● 1: establecimiento activo del enlace

6...7

-

-

8 ... 31 PhoneNumber

-

String[22]

- reserviert Número de abonado del interlocutor
Valores permitidos: signo más (+) y cifras
Tenga en cuenta los caracteres concretos del prefijo
de país de los números de llamada en cuestión asig‐
nado por el proveedor de red (signos "+" o ceros).
Nota sobre las conexiones de Telecontrol del CP
1242-7:
Si no se introduce el parámetro PhoneNumber no se
especifica ningún interlocutor de la conexión y los
SMS pueden ser recibidos por todos los interlocutores
autorizados.
Si no hay entrada, TC_RECV devuelve durante el
arranque el SMS recibido más antiguo.

Parámetros de conexión conforme a TCON_FDL
Bloque de datos de sistema (SDT) para la descripción de la conexión FDL
Para parametrizar una conexión FDL para el CM 1542‑5 se utiliza un DB de descripción de la
conexión con un SDT conforme a TCON_FDL. La estructura de datos fija del SDT contiene los
parámetros necesarios para establecer la conexión. El SDT de descripción de la conexión
debe crearse en un DB ya creado.
El parámetro de conexión CONNECT de los DB de instancia para TSEND_C o TRCV_C
contiene una referencia al bloque de datos utilizado.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

137

Configuración de dispositivos y redes
1.3 Configurar redes
Se pueden establecer los siguientes tipos de conexión FDL:
● Conexiones FDL configuradas
Estos tipos de conexión se configuran en el editor de programas de STEP 7, véase
AUTOHOTSPOT. Como bloques se utilizan TSEND_C y TRCV_C.
– Conexión especificada
Conexión totalmente configurada entre dos maestros
– Conexión no especificada
Conexión configurada a un interlocutor no especificado
● Conexiones FDL programadas
Estos tipos de conexión no son configurables en el editor de programas de STEP 7. Para
estos tipos de conexión, la llamada de la instrucción TCON debe realizarse en combinación
con TSEND/TRCV o TUSEND/TURCV.
– Conexión Layer 2 no especificada
Conexión FDL programada a un interlocutor no especificado con acceso libre a Layer 2
– Conexión Broadcast
Conexión con todos los interlocutores conectados
– Conexión Multicast
Conexión con varios interlocutores definidos
Si para los distintos tipos de conexión son necesarios ajustes específicos, se hace mención de
ello en los siguientes parámetros del SDT.

Estructura de la descripción de la conexión "TCON_FDL" para conexiones configuradas
La tabla que aparece a continuación describe los parámetros de conexión para las siguientes
conexiones FDL configuradas:
● Conexión especificada
● Conexión no especificada
Byte

Parámetro

Tipo de datos Rango de valo‐ Descripción
res / Valor de
arranque

0 … 1 InterfaceId

HW_ANY

0 .. 65535

Identificador de hardware de la interfaz local

2 … 3 ID

CONN_OUC

0 .. 4095

Referencia a esta conexión conforme a la configuración de la
conexión

4

ConnectionType

Byte

15

Tipo de conexión: 0x15 (21 dec) para FDL

5

ActiveEstablished

Bool

FALSE

Identificador del tipo de establecimiento de conexión
● FALSE: establecimiento pasivo de la conexión
● TRUE: establecimiento activo de la conexión
El valor del parámetro no se somete a ningún procesamiento
adicional.

138

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Byte

Parámetro

Tipo de datos Rango de valo‐ Descripción
res / Valor de
arranque

5

ServiceId

Byte

0 .. 2

Identificador del servicio de transferencia de datos
● 0: Ajuste predeterminado automático con selección del
servicio en función del receptor configurado en la
descripción de la conexión
Para conexiones configuradas, en este ajuste solo se
utiliza SDA.
● 1: Send Data Acknowledged (SDA) - para conexiones
activas entre dos maestros
Utilice este ajuste para conexiones no especificadas.
● 2: Send Data Non-Acknowledged (SDN) - para Multicast/
Broadcast

6 … 9 RemotePBAddress

Byte

0 .. 126

Dirección PROFIBUS del interlocutor
● Para conexiones especificadas, se asigna a través de la
configuración de la conexión.
● Debe indicarse explícitamente para conexiones no
especificadas.

6 … 9 LocalPBAddress

Byte

0 .. 126

Dirección PROFIBUS propia (local)
La asigna automáticamente la configuración de la interfaz.

10 …
11

RemoteLSAP

12 …
13

LocalLSAP

Byte

2 .. 32

LSAP (link layer service access point) del interlocutor
Debe indicarse explícitamente para conexiones configuradas.

Byte

2 .. 32

LSAP propio (local)
Debe indicarse explícitamente para conexiones configuradas.

Estructura de la descripción de la conexión "TCON_FDL" para conexiones programadas
La tabla que aparece a continuación describe los parámetros de conexión para las siguientes
conexiones FDL programadas:
● Conexión Layer 2 no especificada
● Conexión Broadcast
● Conexión Multicast
Byte

Parámetro

Tipo de datos Rango de valo‐ Descripción
res / Valor de
arranque

0 … 1 InterfaceId

HW_ANY

0 .. 65535

Identificador de hardware de la interfaz local

2 … 3 ID

CONN_OUC

0 .. 4095

Referencia a esta conexión
Cree una referencia al valor de la ID generada por TCON.
Especifique en el parámetro ID el valor para TSEND/TRCV o
TUSEND/TURCV.

4

ConnectionType

Byte

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

15

Tipo de conexión: 0x15 (21 dec) para FDL

139

Configuración de dispositivos y redes
1.3 Configurar redes
Byte

Parámetro

Tipo de datos Rango de valo‐ Descripción
res / Valor de
arranque

5

ActiveEstablished

Bool

FALSE

Identificador del tipo de establecimiento de conexión
● FALSE: establecimiento pasivo de la conexión
● TRUE: establecimiento activo de la conexión
El valor del parámetro no se somete a ningún procesamiento
adicional.

5

ServiceId

Byte

0 .. 2

Identificador del servicio de transferencia de datos
● 0: Selección automática del servicio. No debe utilizarse
para conexiones programadas.
● 1: Send Data Acknowledged (SDA) - para conexiones
activas entre dos maestros
● 2: Send Data Non-Acknowledged (SDN) - para Multicast/
Broadcast
Para conexiones programadas debe programarse "1" o "2".

6 … 9 RemotePBAddress

Byte

0 .. 127

Dirección PROFIBUS del interlocutor
Especifique la dirección en caso de utilizar TSEND o TU‐
SEND.
Para TRCV o TURCV, el programa de usuario ajusta el valor.
● Para Broadcast/Multicast: 127

6 … 9 LocalPBAddress

Byte

0 .. 126

Dirección PROFIBUS propia (local)
La asigna automáticamente la configuración de la interfaz.

10 …
11

RemoteLSAP

Byte

2 .. 32, 63

LSAP (link layer service access point) del interlocutor
Especifique la dirección en caso de utilizar TSEND o TU‐
SEND:
● Para conexiones Layer 2 no especificadas: 2 .. 32.
● Para Broadcast: 63
● Para Multicast: Utilice el mismo valor de "LocalLSAP".
Para TRCV o TURCV, el programa de usuario ajusta el valor.

12 …
13

LocalLSAP

Byte

2 .. 32

LSAP propio (local)
Debe asignarse desde el programa.

Asignación de números de puerto
Introducción
Al crear una Open User Communication se asigna automáticamente el valor 2000 como
número de puerto.

140

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Los números de puerto admiten valores de 1 a 49151. Dentro de este rango, se pueden asignar
libremente. Sin embargo, puesto que algunos puertos ya son utilizados por el sistema, es
recomendable utilizar números de puerto en un rango de 2000 a 5000.
Nota
Los números de puerto deben ser unívocos. Si se produjera doble asignación en los números
de puerto, la configuración de la conexión o una correspondiente llamada de bloque se
rechazarán con un error.

Sinopsis de los números de puerto
La tabla siguiente muestra resumidamente las reacciones del sistema a diferentes números de
puerto.
N.º de puerto

Descripción

Reacción del sistema

2000 … 5000

Rango recomendado

Ninguna advertencia, ningún mensaje
de error cuando se introduce
El número de puerto se admite y se apli‐
ca

1 … 1999, 5001 … 49151
0, 20, 21, 25, 80, 102, 135, 161, 443,
465, 989, 990, 8080, 34962 … 34964
53, 80, 102, 135, 161, 162, 443, 520,
9001, 34962 … 34964

Utilizable pero fuera del rango recomen‐ Advertencia en la entrada
dado
El número de puerto se admite y se apli‐
ca
Utilizable con limitaciones*
Utilizable con limitaciones**

* Puertos definidos para determinadas funciones: ("well-known Ports"):
0: ANY - el número de puerto es asignado automáticamente por la CPU S7-1500 como valor
(>49151)
20: Transferencia de datos vía FTP
21: Control FTP
25: SMTP (Simple Mail Transfer Protocol) / TMAIL_C
80: HTTP (Hypertext Transfer Protocol) / servidor web
102: ISO on TCP (RFC1006)
135: DCE Endpoint Mapper para PROFINET
161: SNMP (Simple Network Management Protocol)
443: HTTPS (Hypertext Transfer Protocol Secure)
465: SMTPS (Simple Mail Transfer Protocol Secure)
989: Transferencia de datos FTPS
990: Control FTPS

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

141

Configuración de dispositivos y redes
1.3 Configurar redes
8080: HTTP alternativo / web interna
34962 ... 34964: PROFINET
Nota
Para UDP/TCP, el usuario normalmente especifica en el punto final activo de la conexión el
valor 0 para el puerto local. En este caso, el sistema operativo de la CPU selecciona el
siguiente puerto libre por encima de 49151. Inversamente, en el punto final pasivo de la
conexión, el puerto del interlocutor suele recibir 0. En la parametrización de la conexión se
desactiva el correspondiente parámetro.
** Estos puertos están bloqueados según sea el volumen de funciones de la CPU utilizada. La
asigación de dichos puertos se desprende de la documentación de las CPU correspondientes.

Consulte también
Descripción de los parámetros de conexión (Página 113)
Crear y parametrizar conexiones (Página 117)

Capacidad de relectura de los parámetros para la descripción de la conexión
Modificar los valores de parámetros en la descripción de la conexión
La parametrización de la conexión registra la descripción de una sola conexión de la Open
User Communication en el DB de descripción de la conexión.
Existe la posibilidad de modificar los valores de los parámetros del DB de descripción de la
conexión en el programa de usuario, fuera de la parametrización de la conexión. La
parametrización de la conexión puede releer los DBs de descripción de la conexión que
contienen los valores modificados con posterioridad por el usuario. En "Propiedades >
Configuración > Parámetros de conexión" de la ventana de inspección se muestran solo los
parámetros de conexión guardados en el DB de descripción de la conexión.
Nota
Mientras se ejecuta el programa de usuario, solo está permitido modificar valores si no se
están procesando las instrucciones TCON, TSEND_C o TRCV_C, o si la conexión
referenciada no se ha establecido.
Las descripciones de la conexión registradas con anidamiento en tipos de DB que solo se
encuentran mediante referenciación de offset (p. ej. DB global) no son soportadas por la
parametrización de la conexión.
La estructura de la descripción de la conexión no puede modificarse.

Capacidad de relectura de los diferentes parámetros de conexión
En el parámetro "Dirección" del interlocutor en una conexión TCP o ISO on TCP se muestra su
dirección IP desde el parámetro "rem_staddr" de la descripción de la conexión.

142

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Asimismo, los valores siguientes pueden volver a cargarse desde la descripción de la
conexión:
● Tipo de conexión
● ID de conexión local
● Establecimiento de conexión activo/pasivo (no en UDP)
● TSAP local (solo con ISO on TCP)
● TSAP del interlocutor (solo con ISO on TCP)
● Puerto local (solo con TCP y UDP)
● Puerto interlocutor (solo con TCP)
Los valores de los parámetros de la ID de conexión del interlocutor, de los datos de conexión
así como del establecimiento de la conexión no forman parte de la descripción del DB de
descripción de la conexión local. Así pues, no es posible visualizar dichos parámetros cuando
se vuelve a abrir la parametrización de la conexión. Sin embargo, el establecimiento de
conexión del interlocutor resulta del establecimiento de conexión local, por lo que sí se
visualiza.
La lista desplegable "Interlocutor" permite seleccionar un interlocutor nuevo en cualquier
momento.
Si se selecciona una CPU detectada en el proyecto como interlocutor especificado, se
mostrarán nuevamente las posibilidades de entrada de la ID de conexión y los datos de la
misma.

Consulte también
Parámetros de conexión conforme a TCON_Param (Página 124)
Descripción de los parámetros de conexión (Página 113)

Estructura TSAP
Introducción
En una conexión del tipo ISO on TCP hay que asignar Transportation Service Access Points
(TSAPs) a ambos interlocutores. Las IDs TSAP se asignan automáticamente después de crear
una conexión ISO on TCP. Para garantizar la univocidad de las IDs TSAP dentro de un
dispositivo, es posible modificar los TSAPs asignados en la parametrización de la conexión.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

143

Configuración de dispositivos y redes
1.3 Configurar redes

Estructura de los TSAPs
Para asignar libremente TSAPs hay que observar ciertas reglas. Un TSAP debe incluir un
número determinado de bytes que se visualizan e introducen en la parametrización de la
conexión en forma de valores hexadecimales (ID TSAP) o de caracteres ASCII (TSAP ASCII):
76$3$6&,,
76$3 $6&,,

,62RQ7&3

&DUDFWHUHV$6&,,

,'76$3

))('

9DORUHVKH[DGHFLPDOHV

,'76$3

Las entradas o modificaciones de las ID TSAP o TSAP ASCII en los campos de entrada
correspondientes repercuten siempre en el otro formato de visualización respectivo.
Si un TSAP no contiene ningún carácter ASCII válido, solo se visualizará como ID TSAP, no
como TSAP ASCII. Esto sucede después de crear una conexión. Los dos primeros caracteres
hexadecimales como ID TSAP identifican el tipo de comunicación y el rack/slot. Puesto que
estos caracteres no son caracteres ASCII válidos para una CPU, en este caso no se mostrará
el TSAP ASCII:
76$3$6&,,QRH[LVWHQWH
OD,'76$3FRQWLHQHFDUDFWHUHV$6&,,QRY£OLGRV
&DUDFWHUHV$6&,,

76$3 $6&,,
,'76$3

())('
,'76$3

9DORUHVKH[DGHFLPDOHV

$PSOLDFLµQ76$3
,'76$3FRPSOHWD

Además de las reglas de longitud y estructura de los TSAPs hay que garantizar la univocidad
de las ID TSAP. Los TSAPs no son unívocos automáticamente.

Longitud y contenido de los TSAPs
Estructura de la ID TSAP con extensión TSAP:
● Válido para CPU S7-1200 FW V1
Longitud = de 2 a 16 bytes
x_tsap_id[0] = 0xE0 (Open User Communication)
x_tsap_id[1] (bits de 0 a 4) = número de slot de la CPU
x_tsap_id[1] (bits de 5 a 7) = número de rack de la CPU
x_tsap_id[2...15] = cualquier carácter (extensión TSAP, opcional)
(x = loc (local) o x = rem (interlocutor))
● Válido para CPU S7-1500 y S7-1200 FW V2 y superior
Longitud = de 2 a 16 bytes
x_tsap_id[0] = 0xE0 (Open User Communication)
x_tsap_id[1] = de 0x00 a 0xFF
x_tsap_id[2...15] = cualquier carácter (extensión TSAP, opcional)
(x = loc (local) o x = rem (interlocutor))

144

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Estructura de la ID TSAP como TSAP ASCII:
● Válido para CPU S7-1200 FW V1
Longitud = de 3 a 16 bytes
x_tsap_id[0...2] = 3 caracteres ASCII (de 0x20 a 0x7E)
x_tsap_id[3...15] = cualquier carácter (opcional)
(x = loc (local) o x = rem (interlocutor))
● Válido para CPU S7-1200 FW V2 y superior
Longitud = de 3 a 16 bytes
x_tsap_id[0...2] para conexión activa = 3 caracteres ASCII (de 0x00 a 0xFF) o cualquier
secuencia de bits*
x_tsap_id[0...2] para conexión pasiva = 3 caracteres ASCII (de 0x20 a 0x7E) o cualquier
secuencia de bits*
x_tsap_id[3...15] = cualquier carácter (opcional)
(x = loc (local) o x = rem (interlocutor))
● Válido para CPU S7-1500
Longitud = de 3 a 16 bytes
x_tsap_id[0...2] = 3 caracteres ASCII (de 0x00 a 0xFF) o cualquier secuencia de bits*
x_tsap_id[3...15] = cualquier carácter (opcional)
(x = loc (local) o x = rem (interlocutor))
* Las secuencias de caracteres ASCII no pueden empezar por "SIMATIC-"
La tabla siguiente muestra la estructura esquemática de diferentes ID TSAP:
ID TSAP

tsap_id_len

tsap_id[0]

tsap_id[1]

tsap_id[2]

tsap_id[3..15]

...con extensión

2...16 bytes

0xE0

0x01 o
0x02 o
0x00*

Extensión
(opcional)

Extensión
(opcional)

2...16 bytes

0xE0

0x00...0xFF

Extensión
(opcional)

Extensión
(opcional)

3...16 bytes

0x20...0x7E

0x20...0x7E

0x20...0x7

cualquiera
(opcional)

(CPU S7-1200 FW V1)
...con extensión
(CPU S7-1500, S7-1200
FW V2 y superior)
...como TSAP ASCII
(CPU S7-1200 FW V1)

* Una CPU S7-1200 suele estar enchufada en el rack 0 y el slot 1, y una CPU S7-300/400 en
el rack 0 y el slot 2. Por ello, la segunda cifra de la ID TSAP con extensión es el valor
hexadecimal 01 o 02. Si el interlocutor es una CPU sin especificar, p. ej. un dispositivo de
terceros, también se admite el valor hexadecimal 00 como dirección del slot.
Nota
Si los interlocutores están sin especificar, la ID TSAP local y del interlocutor admiten una
longitud de 0 a 16 bytes, permitiéndose todos los valores hexadecimales de 00 a FF.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

145

Configuración de dispositivos y redes
1.3 Configurar redes

Tabla de códigos ASCII para introducir TSAPs ASCII
Para introducir TSAP ASCII con los valores hexadecimales de 20 a 7E solo se admiten los
caracteres siguientes:
Códi‐
go

..0

2..

..1

..2

..3

..4

..5

..6

..7

..8

..9

..A

..B

..C

..D

..E

..F

!

"

#

$

%

&

’

(

)

*

+

,

-

.

/

1

2

3

4

5

6

7

8

9

:

;

<

=

>

?

3..

0

4..

@

A

B

C

D

E

F

G

H

I

J

K

L

M

N

O

5..

P

Q

R

S

T

U

V

W

X

Y

Z

[

\

]

^

_

6..

`

a

b

c

d

e

f

g

h

i

j

k

l

m

n

o

7..

p

q

r

s

t

u

v

w

x

y

z

{

|

}

~

Consulte también
Ejemplos de asignación TSAP (Página 146)
Descripción de los parámetros de conexión (Página 113)
Crear y parametrizar conexiones (Página 117)

Ejemplos de asignación TSAP
Los ejemplos siguientes muestran la ejecución de los TSAP para CPUs S7-1200/1500 (CPU
en el slot 1) desde criterios diferentes:
● Ejemplo 1: crear una conexión nueva para una comunicación PLC-PLC
● Ejemplo 2: entrada de un TSAP ASCII local
● Ejemplo 3: entrada de una extensión TSAP en la ID TSAP
● Ejemplo 4: edición errónea de la ID TSAP
● Ejemplo 5: entrada de un TSAP ASCII desde el campo de entrada "ID TSAP"

Ejemplo 1: crear una conexión nueva para una comunicación PLC-PLC
Después de haber creado una conexión nueva con dos PLCs para la Open User
Communication, se asigna automáticamente la extensión TSAP "ISOonTCP-1".
Dicha extensión resulta de la ID TSAP E0.01.49.53.4F.6F.6E.54.43.50.2D.31, que se registra
automáticamente en el DB de descripción de la conexión y en los campos de entrada del TSAP
local y del interlocutor. Los campos de entrada de los TSAPs ASCII quedan vacíos:
TSAP local

TSAP del interlocutor

E0.01.49.53.4F.6F.6E.54.43.50.2D.31

E0.01.49.53.4F.6F.6E.54.43.50.2D.31

TSAP (ASCII)
ID TSAP

Es posible cambiar en cualquier momento los valores de los campos de entrada de la ID TSAP
y del TSAP ASCII.

146

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
El campo de entrada de la ID TSAP muestra todo el TSAP guardado en el bloque de datos de
la descripción de la conexión. La ID TSAP con extensión TSAP, limitada a 16 caracteres, no
se muestra en el campo de entrada "TSAP (ASCII)" ya que el carácter E0 no representa ningún
carácter válido para el TSAP ASCII.
Si la ID TSAP visualizada es un TSAP ASCII válido, se mostrará en el campo de entrada "TSAP
(ASCII)".
Los cambios en los campos de entrada de ID TSAP y TSAP ASCII se influyen mutuamente.

Ejemplo 2: entrada de un TSAP ASCII local
Si se ha creado una conexión nueva y se asigna un valor ASCII al TSAP local en el campo de
entrada "TSAP (ASCII)", p. ej. "ISOonTCP-1", la ID TSAP resultante se generará
automáticamente.
Al salir del campo de entrada "TSAP (ASCII)" se comprobará automáticamente el
mantenimiento de la limitación de caracteres ASCII de 3 a 16 y se registrará la ID TSAP
resultante en el campo de entrada correspondiente:
TSAP local
TSAP (ASCII)

ISOonTCP-1

ID TSAP

49.53.4F.6F.6E.54.43.50.2D.31

TSAP del interlocutor
E0.01.49.53.4F.6F.6E.54.43.50.2D.31

Ejemplo 3: entrada de una extensión TSAP en la ID TSAP
Si después de crear una conexión e introducir un TSAP ASCII (véanse los ejemplos 1 y 2) en
el campo de entrada de la ID TSAP local se anteponen los caracteres "E0.01." al valor TSAP,
una vez se salga del campo de entrada ya no se visualizará ningún TSAP ASCII:
TSAP local

TSAP del interlocutor

E0.01.49.53.4F.6F.6E.54.43.50.2D.31

E0.01.49.53.4F.6F.6E.54.43.50.2D.31

TSAP (ASCII)
ID TSAP

Después de salir del campo de entrada de la ID TSAP se comprobará automáticamente si el
primer carácter de la ID TSAP es un carácter ASCII válido. Puesto que el carácter "E0" de la
ID TSAP no es válido para el TSAP ASCII, ya no se visualizará ningún TSAP ASCII en el
campo de entrada "TSAP (ASCII)".
Si se utilizan caracteres ASCII válidos, se comprueba que se mantenga una longitud entre 2
y 16 caracteres.

Ejemplo 4: edición errónea de la ID TSAP
Si se elimina el valor hexadecimal "E0" de una ID TSAP que empieza por "E0.01", la ID TSAP
empezará ahora por "01" y ya no será conforme a las reglas, por lo que no será válida:
TSAP local

TSAP del interlocutor

01.49.53.4F.6F.6E.54.43.50.2D.31

E0.01.49.53.4F.6F.6E.54.43.50.2D.31

TSAP (ASCII)
ID TSAP

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

147

Configuración de dispositivos y redes
1.3 Configurar redes
Después de salir del campo de entrada se emite un aviso, ya que la ID TSAP no es ni un TSAP
ASCII válido (para ello debería tener un primer valor hexadecimal en un rango de 20 a 7E) ni
una ID TSAP válida (para ello el primer valor debería tener la identificación "E0").

Ejemplo 5: entrada de un TSAP ASCII desde el campo de entrada "ID TSAP"
Si en la ID TSAP errónea del ejemplo 4 tras eliminar el valor "E0" se elimina también el valor
"01", la ID TSAP empezará por el valor hexadecimal 49. Dicho valor está dentro del rango
permitido para TSAPs ASCII:
TSAP local

TSAP del interlocutor

49.53.4F.6F.6E.54.43.50.2D.31

E0.01.49.53.4F.6F.6E.54.43.50.2D.31

TSAP (ASCII)
ID TSAP

Al salir del campo de entrada, la ID TSAP se detectará como TSAP ASCII válido y el TSAP
ASCII resultante "ISOonTCP-1" se escribirá en el campo de entrada "TSAP (ASCII)".

Consulte también
Estructura TSAP (Página 143)
Descripción de los parámetros de conexión (Página 113)

Configuración de conexiones HMI
Introducción a la configuración de conexiones
Definición
Una conexión define la asignación lógica de dos interlocutores con el fin de ejecutar servicios
de comunicación. Una conexión define lo siguiente:
● Interlocutores que intervienen
● Tipo de conexión (p. ej. conexión HMI)
● Propiedades especiales (p. ej. si una conexión permanece establecida o si se establece y
deshace dinámicamente en el programa de usuario y si deben enviarse avisos sobre el
estado operativo)
● Vía de conexión

Información importante para configurar conexiones
Al configurar conexiones se asigna un nombre de conexión local en una conexión HMI en
calidad de identificación local unívoca.
En la vista de redes, junto a la ficha "Vista general de redes" aparece la ficha "Conexiones".
Esta ficha incluye la tabla de conexiones. Una fila de dicha tabla representa una conexión
configurada, p. ej. entre un dispositivo HMI y un PLC, junto con sus propiedades.

148

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Información importante sobre el consumo de recursos de conexión
Introducción
Cada conexión requiere recursos de los dispositivos implicados tanto para el punto final como
para el punto de transición. El número de recursos de conexión es específico del dispositivo.
Si todos los recursos de conexión de un interlocutor están ocupados, no podrá establecerse
ninguna conexión nueva. Esto se reconoce por el hecho de que la nueva conexión se resaltará
en rojo en la tabla de conexiones. En este caso, la configuración es incoherente y no puede
compilarse.

Conexiones HMI
Cada conexión HMI establecida a través de la interfaz PN integrada ocupa un recurso de
conexión para el punto final en el dispositivo HMI.
El interlocutor (PLC) también requiere un recurso de conexión.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

149

Configuración de dispositivos y redes
1.3 Configurar redes

Vistas con información sobre las conexiones configuradas
Desde las vistas descritas a continuación se accede a toda la información y las funciones
relacionadas con la configuración y verificación de conexiones.
● Visualización de conexiones en la vista de redes
● Tabla de conexiones
● Ficha "Propiedades" de una conexión en la ventana de inspección

150

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Ventajas
La información representada en estas vistas siempre es actual en cuanto a las acciones de
usuario inmediatas. Esto significa que:
● La tabla de conexiones muestra todas las conexiones creadas.
● Si se ha seleccionado una conexión en la tabla de conexiones, rige lo siguiente:
– La vía de conexión se representa gráficamente en la vista de redes.
– La ficha "Propiedades" de la ventana de inspección muestra los parámetros de dicha
conexión.

La tabla de conexiones
La tabla de conexiones ofrece las funciones siguientes:
● Relación de todas las conexiones del proyecto
● Selección de una conexión y su visualización en la vista de redes
● Cambio de interlocutores
● Visualización de información de estado

Ficha "Propiedades" de una conexión en la ventana de inspección
El cuadro de diálogo de propiedades tiene el significado siguiente:
● Visualización de los parámetros de la conexión
● Visualización de la vía de conexión
● Especificación posterior de las conexiones por medio del botón "Buscar vía de conexión"

Crear una conexión nueva
Alternativas para crear una conexión
Existen las posibilidades siguientes para crear una conexión en la vista de redes:
● Configuración gráfica de la conexión
● Configuración de la conexión desde un cuadro de diálogo
Los diferentes pasos que deben seguirse se explican en los capítulos siguientes.

Requisitos y resultado
En la vista de redes se han creado los dispositivos con CPUs y los dispositivos HMI entre los
que deben configurarse conexiones.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

151

Configuración de dispositivos y redes
1.3 Configurar redes

Especificar una conexión
Si ambos interlocutores están conectados a la misma red para el tipo de conexión
seleccionado, cree una conexión completamente especificada entre ambos interlocutores
mediante la selección gráfica o desde un cuadro de diálogo.
Dicha conexión se registrará automáticamente en la tabla de conexiones del dispositivo HMI
y se le asignará un nombre de conexión local.
La representación siguiente muestra una conexión configurada en un dispositivo conectado en
red:

Crear una conexión nueva gráficamente
Configurar conexiones gráficamente
En la configuración gráfica de las conexiones, el sistema requiere en algunos casos que se
defina la vía de conexión. Seleccione los dispositivos que deben conectarse en la
configuración actual.

152

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Determinar automáticamente la vía de conexión
Para crear una conexión gráficamente, proceda del siguiente modo:
1. Haga clic en el botón "Conexiones".

De este modo se activa el modo de conexión para el tipo de conexión seleccionado.
Esto se reconoce por el comportamiento siguiente:
En la vista de redes están resaltados en color los dispositivos que pueden utilizarse en el
proyecto para el tipo de conexión seleccionado.
2. Arrastre el cursor del ratón, manteniendo pulsado el botón del ratón, desde el dispositivo del
que debe partir la conexión hasta el dispositivo en el que debe finalizar la conexión.

3. Suelte el botón del ratón en el dispositivo de destino para crear la conexión entre ambos.

Resultado
● Se ha creado una conexión especificada.
● La vía de conexión se representa resaltada.
● La conexión está registrada en la tabla de conexiones.

Crear una conexión nueva desde un cuadro de diálogo
Configurar conexiones desde un cuadro de diálogo
Determine el dispositivo local y su interlocutor.

Procedimiento
Para crear una conexión desde un cuadro de diálogo, proceda del siguiente modo:
1. En el menú contextual del interlocutor para el que debe crearse la conexión, elija el
comando "Crear conexión nueva".
Se abrirá el cuadro de diálogo "Crear conexión nueva".
2. Seleccione el punto final del interlocutor.
En el lado derecho del cuadro de diálogo aparecerá una posible vía de conexión apropiada
para el punto final seleccionado, si existiera. Las vías incompletas, como en el caso de una
CPU no especificada, se marcan con un signo de exclamación sobre fondo rojo.
3. Para salir del cuadro de diálogo pulse "Aceptar".
Para aplicar la conexión configurada y configurar otras conexiones referentes a otros
puntos finales, haga clic en "Aplicar".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

153

Configuración de dispositivos y redes
1.3 Configurar redes

Trabajar en la vista de redes
Resaltar la vía de conexión y el interlocutor en la vista de redes
Para mostrar los interlocutores de todos o algunos tipos de conexión en la vista de redes,
proceda del siguiente modo:
1. Haga clic en el botón "Conexiones".
2. En el menú contextual del dispositivo HMI cuyo interlocutor desea visualizar en la vista de
redes, elija el comando "Resaltar interlocutores".
3. En el menú que aparece a continuación, elija "Todos los interlocutores".
El dispositivo local y las CPUs de los dispositivos de destino están seleccionados. El
interlocutor local presenta una flecha hacia la derecha y los interlocutores remotos una
flecha hacia la izquierda.
4. Abra una lista con los datos de los dispositivos de destino seleccionando la flecha del
dispositivo local. Esta función complementaria es útil en las configuraciones de red
complejas en las que no se ven todos los dispositivos.

Nota
Es posible visualizar uno de los interlocutores que no se ve en el área de visualización actual
de la vista de redes. Haga clic en el interlocutor en la lista que aparece. Resultado: la
visualización se desplaza hasta que aparece el interlocutor.

Consulte también
Crear una conexión nueva gráficamente (Página 152)

Trabajar con la tabla de conexiones
Funciones básicas de las tablas
La tabla de conexiones soporta las siguientes funciones básicas para editar una tabla:
● Modificar el ancho de las columnas
● Explicar el significado de una columna, fila o campo mediante tooltips.

154

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Modificar el ancho de las columnas
Para adaptar el ancho de una columna al contenido de modo que se lean los textos de todas
las filas, proceda del siguiente modo:
1. Posicione el puntero del ratón en el encabezado de la tabla de conexiones, a la derecha de
la columna que debe optimizarse, hasta que el puntero adopte la forma de dos líneas
paralelas (como si quisiera modificar el ancho de la columna arrastrando el puntero del
ratón).
2. Haga doble clic en este punto.
o
1. Abra el menú contextual en el encabezado de la tabla.
2. Haga clic en
– "Optimizar ancho de columnas" o
– "Optimizar ancho de todas las columnas".
Si las columnas son demasiado estrechas, se puede ver todo el contenido de los diferentes
campos colocando el puntero del ratón brevemente sobre el campo en cuestión.

Mostrar/ocultar columnas
Mediante el menú contextual de los encabezados de la tabla de conexiones se controla la
visualización de las diferentes columnas. Con el comando "Mostrar/ocultar columnas" del
menú contextual aparece una vista general de las columnas disponibles. Con las casillas de
verificación se controla la visibilidad de las columnas.

Navegar por la tabla de conexiones con las teclas de cursor
Las teclas de cursor FLECHA ARRIBA y FLECHA ABAJO permiten seleccionar una conexión
en la tabla de conexiones; la conexión queda seleccionada y se resalta en la vista de redes.

Modificar las propiedades de la conexión
Algunos de los parámetros visualizados en la tabla de conexiones pueden editarse
directamente. Para modificar el nombre de una conexión no es necesario navegar hasta la
ventana de inspección.

Modificar el interlocutor
El interlocutor de una conexión se modifica del siguiente modo:
1. Seleccione la conexión.
2. Elija el nuevo interlocutor en la lista desplegable activada de la columna "Interlocutor".

Borrar conexiones
Las conexiones configuradas se borran en la vista de redes o en la tabla de conexiones.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

155

Configuración de dispositivos y redes
1.3 Configurar redes
En la vista de redes se puede borrar en cada caso una conexión resaltada. En la tabla de
conexiones se borran una o varias conexiones.

Procedimiento
Para borrar una conexión, proceda del siguiente modo:
1. Seleccione la conexión que desea borrar:
– En la vista de redes: seleccione la conexión que desea borrar.
– En la tabla de conexiones: seleccione las filas de las conexiones que deben borrarse
(posibilidad de selección múltiple).
2. Abra el menú contextual con el botón derecho del ratón.
3. Elija el comando "Borrar".

Resultado
La conexión seleccionada se borrará por completo.

Copiar conexiones
Introducción
Las conexiones no se copian individualmente, sino siempre en relación con el proyecto o
dispositivo.
Es posible copiar:
● Proyectos enteros
● Uno o varios dispositivos dentro de un proyecto o en varios proyectos

Copiar un proyecto
Al copiar un proyecto se copiarán también todas las conexiones configuradas. No es necesario
realizar ajustes en las conexiones copiadas porque siguen siendo coherentes.

Copiar dispositivos
Al copiar dispositivos para los que se han configurado conexiones (dispositivo HMI) también se
copiarán las conexiones. Para completar la vía de conexión todavía hay que arrastrar la
conexión en red.
Una CPU S7-1200 con un firmware V1.0 es simplemente un servidor de conexiones HMI y no
tiene ninguna configuración de conexiones propia. Por ello, al copiar una CPU S7-1200 con un
firmware V1.0 no se copiarán conexiones.

156

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Conexiones incoherentes - conexiones sin asignación
Cuando una conexión es incoherente, significa que la estructura de los datos de conexión está
destruida o bien la conexión no funciona en relación con el proyecto.
No es posible compilar ni cargar conexiones incoherentes, como tampoco lo es su operación.
En la tabla de conexiones, las conexiones incoherentes se reconocen por el color rojo.

Causas posibles de conexiones incoherentes
● Borrado o modificaciones de la configuración de hardware
● Falta de conexiones en red entre las interfaces del proyecto necesarias para una conexión.
● Rebase por exceso de los recursos de conexión
● Error al realizar una copia de seguridad de los datos por falta de memoria
● Conexiones con un interlocutor no especificado sin indicar la dirección del mismo.
Encontrará información detallada sobre la causa de la incoherencia en la ficha "Compilar"
después de la compilación (Edición > Compilar).

Soluciones
Si la conexión no se repara al abrir, modificar o deshacer las propiedades de la misma en la
configuración, posiblemente será necesario borrarla y volver a crearla.

Ajustes generales de la conexión HMI
Parámetros de conexión generales
En el grupo de parámetros "General" de las propiedades de la conexión se muestran los
parámetros generales que identifican el punto final local de la conexión.
Aquí también existe la posibilidad de asignar la vía de conexión y especificar por completo a
los interlocutores.

Propiedades de conexión especiales
Visualización de las propiedades de conexión (no modificable):
● Iniciativa local
El dispositivo HMI es el que establece siempre la conexión. Esta opción está seleccionada
por defecto si la dirección del interlocutor está especificada.
● Unilateral
Unilateral significa que el interlocutor es el servidor de dicha conexión y que no puede
enviar o recibir activamente.
● Enviar avisos de estado operativo
No relevante para dispositivos HMI.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

157

Configuración de dispositivos y redes
1.3 Configurar redes

Detalles de dirección
Visualización de los detalles de dirección de la conexión HMI. Si un interlocutor no está
especificado, pueden modificarse los valores de rack y slot. Todos los demás valores se
tomarán de la configuración actual y no podrán modificarse.

Misceláneo
Visualización de los puntos de acceso para la conexión online entre dispositivo HMI e
interlocutor.

Configuración de conexiones S7
Introducción a la configuración de conexiones
Definición
Una conexión define la asignación lógica de dos interlocutores con el fin de ejecutar servicios
de comunicación. Una conexión define lo siguiente:
● Interlocutores que intervienen
● Tipo de conexión (p. ej. conexión S7)
● Propiedades especiales (p. ej. si una conexión permanece establecida o si se establece y
deshace dinámicamente en el programa de usuario y si deben enviarse avisos sobre el
estado operativo)
● Vía de conexión

Información importante para configurar conexiones
Al configurar conexiones se asigna un nombre de conexión local en una conexión S7 en
calidad de identificación local unívoca.
En la vista de redes, junto a la ficha "Vista general de redes" aparece la ficha "Conexiones".
Esta ficha incluye la tabla de conexiones. Una fila de dicha tabla representa una conexión
configurada desde el punto de vista del interlocutor local con sus propiedades, p. ej. entre dos
CPUs S7-1200.

Información importante sobre el consumo de recursos de conexión
Introducción
Cada conexión requiere recursos de los dispositivos implicados tanto para el punto final como
para el punto de transición. El número de recursos de conexión es específico del dispositivo.
Si todos los recursos de conexión de un interlocutor están ocupados, no podrá establecerse
ninguna conexión nueva. Esto se reconoce por el hecho de que la nueva conexión se resaltará
en rojo en la tabla de conexiones. En este caso, la configuración es incoherente y no puede
compilarse.

158

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Conexiones S7
Cada conexión S7 establecida a través de la interfaz PN ocupa un recurso de conexión para
el punto final en la CPU S7-1200. El interlocutor también requiere un recurso de conexión.
En "Propiedades > Recursos de conexión" de la ventana de inspección encontrará un resumen
de los recursos de conexión disponibles y ocupados en la CPU S7-1200 seleccionada.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

159

Configuración de dispositivos y redes
1.3 Configurar redes

Vistas con información sobre las conexiones configuradas
Desde las vistas descritas a continuación se accede a toda la información y las funciones
relacionadas con la configuración y verificación de conexiones.
● Visualización de conexiones en la vista de redes
● Tabla de conexiones
● Ficha "Propiedades" de una conexión en la ventana de inspección

160

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Ventajas
La información representada en estas vistas siempre es actual en cuanto a las acciones de
usuario inmediatas. Esto significa que:
● La tabla de conexiones muestra todas las conexiones creadas.
● Si se ha seleccionado una conexión en la tabla de conexiones, rige lo siguiente:
– Si el modo de conexión es activo, la vía de conexión se resalta gráficamente en la vista
de redes.
– La ficha "Propiedades" de la ventana de inspección muestra los parámetros de dicha
conexión.

La tabla de conexiones
La tabla de conexiones ofrece las funciones siguientes:
● Relación de todas las conexiones del proyecto
● Selección de una conexión y su visualización en la vista de redes (en caso de modo de
conexión activo)
● Cambio de interlocutores
● Visualización de información de estado

Ficha "Propiedades" de una conexión en la ventana de inspección
El cuadro de diálogo de propiedades tiene el significado siguiente:
● Visualización de los parámetros de la conexión
● Visualización de la vía de conexión
● Especificación posterior de las conexiones por medio del botón "Buscar vía de conexión"

Crear una conexión nueva
Alternativas para crear una conexión
Existen las posibilidades siguientes para crear una conexión en la vista de redes:
● Configuración gráfica de la conexión
● Configuración de la conexión desde un cuadro de diálogo
Los diferentes pasos que deben seguirse se explican en los capítulos siguientes.

Requisitos y resultado
En la vista de redes se han insertado los dispositivos entre los que deben configurarse las
conexiones.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

161

Configuración de dispositivos y redes
1.3 Configurar redes

Especificar una conexión
Si ambos interlocutores están conectados a la misma red para el tipo de conexión
seleccionado, cree una conexión completamente especificada entre ambos interlocutores
mediante la selección gráfica o desde un cuadro de diálogo.
Dicha conexión se registrará automáticamente en la tabla de conexiones de la CPU S7-1200.
y se le asignará un nombre de conexión local.
La representación siguiente muestra una conexión configurada en un dispositivo conectado en
red:

Crear una conexión nueva gráficamente
Configurar conexiones gráficamente
En el caso de la configuración gráfica de conexiones, la vía de conexión se determina
automáticamente, siempre que haya interfaces y recursos. Seleccione los dispositivos que
deben conectarse en la configuración actual.

Determinar automáticamente la vía de conexión
Para crear una conexión gráficamente, proceda del siguiente modo:
1. Haga clic en el botón "Conexiones".

De esta forma se activa el modo de conexión. Ahora puede seleccionar el tipo de conexión
deseado. Esto se reconoce por el comportamiento siguiente:
En la vista de redes están resaltados en color los dispositivos que pueden utilizarse en el
proyecto para el tipo de conexión seleccionado.
2. Arrastre el cursor del ratón, manteniendo pulsado el botón del ratón, desde el dispositivo del
que debe partir la conexión hasta el dispositivo en el que debe finalizar la conexión.

3. Suelte el botón del ratón en el dispositivo de destino para crear la conexión entre ambos.

162

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Resultado
● Se ha creado una conexión especificada.
● La vía de conexión se representa resaltada.
● La conexión está registrada en la tabla de conexiones.

Configurar una conexión cuando falta la asignación de red o ésta no es unívoca
Las conexiones en red que faltan se establecen en la medida de lo posible de forma automática
al crear una conexión. En caso de no ser posible una asignación de red unívoca, se produce
una consulta al finalizar la configuración de la conexión. En este caso se ofrecen las subredes
existentes para su selección.
Ejemplo en la siguiente figura: al crear una conexión entre las estaciones PLC_1 y PLC_2 que
aún no han sido conectadas en red se produce una consulta.

Crear una conexión nueva desde un cuadro de diálogo
Configurar conexiones desde un cuadro de diálogo
Determine el dispositivo local y su interlocutor.

Procedimiento
Para crear una conexión desde un cuadro de diálogo, proceda del siguiente modo:
1. En el menú contextual de un interlocutor para el que debe crearse una conexión, elija el
comando "Crear conexión nueva".
Se abre el cuadro de diálogo "Crear conexión nueva".
2. Seleccione el punto final del interlocutor.
En el lado derecho del cuadro de diálogo aparecerá una posible vía de conexión apropiada
para el punto final seleccionado, si existiera. Las vías incompletas, como en el caso de una
CPU no especificada, se marcan con un signo de exclamación sobre fondo rojo.
3. Para aplicar la conexión configurada y configurar otras conexiones referentes a otros
puntos finales, haga clic en "Agregar".
Para salir del cuadro de diálogo pulse "Aceptar".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

163

Configuración de dispositivos y redes
1.3 Configurar redes

Trabajar en la vista de redes
Resaltar la vía de conexión y el interlocutor en la vista de redes
Para mostrar los interlocutores de todos o algunos tipos de conexión en la vista de redes,
proceda del siguiente modo:
1. Haga clic en el botón "Conexiones".
2. En el menú contextual de la CPU S7 cuyo interlocutor desea visualizar en la vista de redes,
elija el comando "Resaltar interlocutores".
3. En el menú que aparece a continuación, elija "Todos los interlocutores".
El dispositivo local y las CPUs de los dispositivos de destino están seleccionados. El
interlocutor local presenta una flecha hacia la derecha y los interlocutores remotos una
flecha hacia la izquierda.
4. Abra una lista con los datos de los dispositivos de destino seleccionando la flecha del
dispositivo local. Esta función complementaria es útil en las configuraciones de red
complejas en las que no se ven todos los dispositivos.

Nota
Es posible visualizar uno de los interlocutores que no se ve en el área de visualización actual
de la vista de redes. Haga clic en el interlocutor en la lista que aparece. Resultado: la
visualización se desplaza hasta que aparece el interlocutor.

Trabajar con la tabla de conexiones
Funciones básicas de las tablas
La tabla de conexiones soporta las siguientes funciones básicas para editar una tabla:
● Modificar el ancho de las columnas
● Mostrar el significado de una columna, fila o campo a través de tooltips.

164

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Modificar el ancho de las columnas
Para adaptar el ancho de una columna al contenido de modo que se lean los textos de todas
las filas, proceda del siguiente modo:
1. Posicione el puntero del ratón en el encabezado de la tabla de conexiones, a la derecha de
la columna que debe optimizarse, hasta que el puntero adopte la forma de dos líneas
paralelas (como si quisiera modificar el ancho de la columna arrastrando el puntero del
ratón).
2. Haga doble clic en este punto.
o
1. Abra el menú contextual en el encabezado de la tabla.
2. Haga clic en
– "Optimizar ancho de columnas" o
– "Optimizar ancho de todas las columnas".
Si las columnas son demasiado estrechas, se puede ver todo el contenido de los diferentes
campos colocando el puntero del ratón brevemente sobre el campo en cuestión.

Mostrar/ocultar columnas
Mediante el menú contextual de los encabezados de la tabla de conexiones se controla la
visualización de las diferentes columnas. Con el comando "Mostrar/ocultar columnas" del
menú contextual aparece una vista general de las columnas disponibles. Con las casillas de
verificación se controla la visibilidad de las columnas.
Si desea guardar la disposición, el ancho y la visibilidad de las columnas, haga clic en la
función "Anotar disposición" en la parte superior derecha de la vista de redes.
Símbolo

Significado
Anotar disposición
Guarda la representación actual de la tabla. La disposición, el ancho y la visibilidad de las
columnas se almacenan en la vista de tabla.

Navegar por la tabla de conexiones con las teclas de cursor
Las techas de cursor FLECHA ARRIBA y FLECHA ABAJO permiten seleccionar una conexión
en la tabla de conexiones; la conexión queda seleccionada y se resalta en la vista de redes.

Modificar las propiedades de la conexión
Algunos de los parámetros visualizados en la tabla de conexiones pueden editarse
directamente. Así, por ejemplo, el nombre de la conexión sólo puede modificarse en la tabla de
conexiones.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

165

Configuración de dispositivos y redes
1.3 Configurar redes

Modificar el interlocutor
El interlocutor de una conexión se modifica del siguiente modo:
1. Seleccione la conexión.
2. Elija el nuevo interlocutor en la lista desplegable activada de la columna "Interlocutor".

Borrar conexiones
Las conexiones configuradas se borran en la vista de redes o en la tabla de conexiones.
En la vista de redes se puede borrar en cada caso una conexión resaltada. En la tabla de
conexiones se borran una o varias conexiones.

Procedimiento
Para borrar una conexión, proceda del siguiente modo:
1. Seleccione la conexión que desea borrar:
– En la vista de redes: seleccione la conexión que desea borrar.
– En la tabla de conexiones: seleccione las filas de las conexiones que deben borrarse
(posibilidad de selección múltiple).
2. Abra el menú contextual con el botón derecho del ratón.
3. Elija el comando "Borrar".

Resultado
La conexión seleccionada se borrará por completo.

Copiar conexiones
Introducción
Las conexiones no se copian individualmente, sino siempre en relación con el proyecto o
dispositivo.
Es posible copiar:
● Proyectos enteros
● Uno o varios dispositivos dentro de un proyecto o en varios proyectos

Copiar un proyecto
Al copiar un proyecto se copiarán también todas las conexiones configuradas. No es necesario
realizar ajustes en las conexiones copiadas porque siguen siendo coherentes.

166

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Copiar dispositivos
Al copiar dispositivos para los que se han configurado conexiones también se copiarán las
conexiones. Para completar la vía de conexión todavía hay que arrastrar la conexión en red.
Una CPU S7-1200 con un firmware V1.0 es simplemente un servidor de conexiones y no tiene
ninguna configuración de conexiones propia. Por ello, al copiar una CPU S7-1200 con un
firmware V1.0 no se copiarán conexiones.

Conexiones incoherentes - conexiones sin asignación
Cuando una conexión es incoherente, significa que la estructura de los datos de conexión está
destruida o bien la conexión no funciona en relación con el proyecto.
No es posible compilar ni cargar conexiones incoherentes, como tampoco lo es su operación.
En la tabla de conexiones, las conexiones incoherentes se reconocen por el color rojo.

Causas posibles de conexiones incoherentes
● Borrado o modificaciones de la configuración de hardware
● Falta de conexiones en red entre las interfaces del proyecto necesarias para una conexión.
● Rebase por exceso de los recursos de conexión
● Conexiones con un interlocutor no especificado sin indicar la dirección del mismo.
Encontrará información detallada sobre la causa de la incoherencia en la ficha "Compilar"
después de la compilación (Edición > Compilar).

Soluciones
Para asignar una vía de conexión cerrada a una vía de conexión abierta existente, amplíe la
configuración del dispositivo de tal forma que las interfaces necesarias para el tipo de conexión
se encuentren disponibles para ambos interlocutores. Con el botón "Buscar vía de conexión"
de "Propiedades > General > Interfaz" de la ventana de inspección es posible establecer una
conexión con un interlocutor existente.

Ajustes generales de la conexión S7
Parámetros de conexión generales
En el grupo de parámetros "General" de las propiedades de la conexión se muestran los
parámetros generales que identifican el punto final local de la conexión.
Aquí existe la posibilidad de asignar la vía de conexión y especificar por completo a los
interlocutores.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

167

Configuración de dispositivos y redes
1.3 Configurar redes

ID local
Aquí se muestra la ID local del módulo desde el que se observa la conexión (interlocutor local).
La ID local se puede modificar. Esto es necesario cuando ya se han programado bloques de
función de comunicación y debe utilizarse la ID local indicada allí para la conexión.

Propiedades de conexión especiales
Visualización de las propiedades de conexión (modificable en función de los componentes
utilizables):
● Unilateral
Unilateral significa que el interlocutor es el servidor de dicha conexión y que no puede
enviar o recibir activamente.
● Iniciativa local
En una conexión unilateral, p. ej. con una CPU S7-1200 con versión de firmware V1.0, sólo
puede haber disponible un interlocutor para la iniciativa local. En una conexión bilateral
existe la posibilidad de especificar qué interlocutor debe tomar la iniciativa.
● Enviar avisos de estado operativo
Indica si el interlocutor local envía avisos de estado operativo al interlocutor.

Detalles de dirección
Visualización de los detalles de direcciones de la conexión S7. Si un interlocutor no está
especificado, pueden modificarse los valores de rack y slot. Todos los demás valores se
tomarán de la configuración actual y no podrán modificarse.

Detalles de direcciones de la conexión S7
Significado
En los detalles de dirección se muestran los puntos finales de la conexión, que pueden
localizarse indicando el rack y el slot.
Cuando se establece una conexión, se asignan de forma fija recursos específicos de un
módulo a dicha conexión. Para la asignación es imprescindible que el recurso de conexión
pueda direccionarse. El TSAP (Transport Service Access Point) es prácticamente la dirección
del recurso y se forma, entre otros, por medio del recurso de conexión o, en CPUs S7-1200 a
partir del firmware V2.0, con la SIMATIC-ACC (SIMATIC Application Controlled
Communication).

168

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Estructura del TSAP para S7-1200
● Para CPU S7-1200 con firmware V2.0 o superior:
"SIMATIC-ACC"<nnn><mm>
nnn = ID local
mm = valor libre
● Para CPU S7-1200 con firmware V1.0:
<xx>.<yz>
xx = número del recurso de conexión
y = número de rack
z = número de slot

Estructura TSAP en función del interlocutor
La estructura del TSAP en las CPUs S7-1200 depende del firmware correspondiente y del
interlocutor remoto. Si se conecta una CPU S7-1200 con una CPU S7-300/400, la primera
utiliza también la estructura TSAP incluyendo el recurso de conexión.
Consulte los ejemplos siguientes para TSAPs de distintas configuraciones de conexiones
● Conexión entre dos CPUs S7-1200 (ambas con firmware V2.0):
– CPU S7-1200 "A" con firmware V2.0 e ID local 100:
TSAP: SIMATIC-ACC10001
– CPU S7-1200 "B" con firmware V2.0 e ID local 5AE:
TSAP: SIMATIC-ACC5AE01
● Conexión entre dos CPUs S7-1200 (con firmware V2.0 y V1.0):
– CPU S7-1200 con firmware V2.0 e ID local 1FF:
TSAP: SIMATIC-ACC1FF01
– CPU S7-1200 con firmware V1.0 (rack 0, slot 1, recurso de conexión 03):
TSAP: 03.01
● Conexión entre una CPU S7-1200 (con firmware V2.0) y una CPU S7-300/400:
– CPU S7-1200 con firmware V2.0 (rack 0, slot 1, recurso de conexión 12):
TSAP: 12.01
– CPU S7-300/400 (rack 0, slot 2, recurso de conexión 11):
TSAP: 11.02

Conexiones S7 a través de CM/CP
Introducción
Las CPU S7-1200 con una versión de firmware V2.0 o superior soportan conexiones S7
unilaterales y bilaterales a través de interfaces CM/CP. De este modo aumenta la cantidad de
redes y puertos Ethernet disponibles para las conexiones S7. Aunque la conexión se realiza
entonces a través del CM/CP, la respectiva CPU S7-1200 es un punto final en la conexión. El
otro punto final puede ser cualquier otro dispositivo en el caso de las conexiones bilaterales.
Este otro dispositivo debe soportar también conexiones S7.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

169

Configuración de dispositivos y redes
1.3 Configurar redes

Volumen de datos y recursos disponibles
El número de conexiones soportadas por CM/CP se puede consultar en el manual de producto
adjunto con cada CM/CP. Añadiendo más CM/CP se puede aumentar el número de
conexiones por dispositivo.
Si un dispositivo incorpora varios CM/CP, al sobrepasar este límite se cambia
automáticamente al siguiente CP. En caso necesario, asigne selectivamente las conexiones a
través de la elección de vía.
Nota
Los CPs actuales soportan la transferencia de datos > 240 bytes.
Los CPs con una versión más antigua soportan la transferencia de datos con una longitud de
hasta 240 bytes.
Tenga en cuenta las indicaciones del manual de producto del CP Ethernet.

Tareas del CM/CP Ethernet en el modo online
El CM/CP Ethernet asume las siguientes tareas durante la transferencia de datos a través de
una conexión:
● Recibir
Recepción de datos de Ethernet y transmisión al área de datos de usuario de la CPU.
● Enviar
Aceptación de datos del área de datos de usuario de la CPU y transmisión de los datos a
través de Ethernet.
El establecimiento de la conexión se realiza automáticamente en cuanto se puede acceder al
interlocutor.

Conexiones S7 mediante instrucciones PUT y GET
Principios básicos de la comunicación mediante la instrucción PUT/GET
Principios básicos de las instrucciones PUT/GET
Para intercambiar datos entre dos CPUs a través de una conexión S7, utilice las instrucciones
PUT y GET.
La instrucción GET permite leer datos de una CPU interlocutora. Con la instrucción PUT se
puede controlar la escritura de variables en el interlocutor a través del programa de usuario.
Además de las instrucciones PUT y GET, no se ha previsto ninguna otra función de
comunicación para la lectura y escritura de variables.
Para facilitar la utilización de ambas instrucciones, defina todos los parámetros necesarios
para la conexión, así como todos los parámetros de bloque en la ventana de inspección del
editor de programación.

170

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Requisitos
Para poder utilizar las instrucciones PUT y GET, es necesario que se cumplan los siguientes
requisitos.
● Se debe haber incluido como mínimo una CPU S7-1200/1500 o S7-300/400 en el proyecto.
En una CPU S7-1200 debe estar instalado el firmware 2.0 o superior. Si aún no se ha
incluido una segunda CPU en el proyecto, se puede establecer primero la conexión con un
interlocutor no especificado.
● Debe existir una conexión S7 entre ambas CPUs. Si aún no ha creado ninguna conexión
entre dos CPUs, se establecerá automáticamente una conexión durante la configuración
de las instrucciones.
● Para ambas instrucciones se requiere un bloque de datos de instancia, en el que se
almacenan todos los datos utilizados por la instrucción. El bloque de datos de instancia se
crea automáticamente en el momento en el que la instrucción PUT o GET se arrastra a un
segmento en el editor de programación. Para la correcta ejecución del programa, los
bloques de datos de instancia no pueden modificarse, por lo que tienen protección de know
how. El usuario sólo tiene acceso de lectura a los bloques de datos de instancia.

Consulte también
Resumen de la parametrización de la conexión (Página 171)
Parametrizar el tipo de petición (Página 177)
PUT: Parametrizar área de escritura y transmisión (Página 177)
GET: Parametrizar un área de lectura y memoria (Página 178)

Parametrización de la conexión
Resumen de la parametrización de la conexión
Introducción
La parametrización de la conexión para las instrucciones PUT y GET se realiza en la ventana
de inspección del editor de programación. Todos los parámetros se almacenan en el bloque de
datos de instancia correspondiente.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

171

Configuración de dispositivos y redes
1.3 Configurar redes

Estructura de la parametrización de la conexión
La parametrización de la conexión incluye los componentes siguientes:








①
②
③
④
⑤



Instrucción de comunicación para PUT o GET
Llamada a funciones online y de diagnóstico
Ficha "Configuración" en la ficha "Propiedades"
Navegación local de la ficha "Configuración"
Propiedades generales de los parámetros de conexión

Visualización de funciones online y de diagnóstico
Haciendo clic en el icono de arranque de las funciones online y de diagnóstico, la CPU
correspondiente se conecta online automáticamente. En la vista de redes se abre la tabla de
conexiones. Además, en la ventana de inspección se muestran la ficha "Diagnóstico" y los
datos de la conexión.

172

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Introducción de los parámetros de conexión
Introduzca los parámetros de conexión deseados en la ficha "Configuración". Encontrará el
grupo "Parámetros de la conexión" en la navegación local de la ficha "Configuración". Dicho
grupo contiene la parametrización de la conexión. Aquí se pueden introducir los parámetros de
las conexiones con asistencia del sistema. Cuando todos los parámetros necesarios están
disponibles, se activa una marca de verificación después del grupo "Parámetros de la
conexión" en la navegación local.

Consulte también
Parametrizar el tipo de petición (Página 177)
PUT: Parametrizar área de escritura y transmisión (Página 177)
GET: Parametrizar un área de lectura y memoria (Página 178)

Descripción de los parámetros de conexión
Resumen
La tabla siguiente muestra los parámetros de conexión generales:
Parámetro

Descripción

Punto final

Se muestra el nombre del punto final local y del interlocutor.
● Punto final local
El punto final local es la CPU en la que se programa la instrucción PUT/GET.
● Punto final del interlocutor
El punto final del interlocutor se selecciona en una lista desplegable. Dicha lista muestra
todos los interlocutores disponibles, entre ellos también interlocutores sin especificar para
dispositivos cuyos datos son desconocidos dentro del proyecto.
Mientras no se haya ajustado ningún interlocutor, todos los demás parámetros de la
máscara permanecerán desactivados.

Interfaz

Se muestra la interfaz de la CPU interlocutora. La interfaz del interlocutor no se visualiza
hasta que se selecciona una CPU interlocutora especificada.

Tipo de interfaz

Se visualiza el tipo de interfaz a través del cual tendrá lugar la comunicación.

Nombre de la subred

Se muestra la subred del punto final local, si existe. La subred del interlocutor no se visualiza
hasta que se selecciona el punto final del interlocutor.
Si como mínimo uno de los dos interlocutores no está conectado a una subred, se conectarán
automáticamente en red los dos interlocutores. En este caso, el interlocutor que no está
conectado en red se conectará a la misma subred a través de la cual el otro interlocutor se
encuentra conectado a una red.
Solo es posible conectar interlocutores a subredes distintas a través de un routing IP o S7. La
configuración del routing IP puede modificarse en las propiedades de las interfaces Ethernet
en cuestión.

Dirección

Se muestra la dirección IP del punto final local. La dirección IP del interlocutor no se visualiza
hasta que se selecciona el punto final del interlocutor.
Si se ha seleccionado un interlocutor no especificado, el campo de entrada estará vacío y
resaltado en rojo. En este caso, hay que indicar una dirección IP válida para el interlocutor.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

173

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Descripción

ID de conexión

Se visualiza la ID de conexión actualmente ajustada. La ID de conexión se puede modificar
en la tabla de conexiones, dentro de la vista de redes. Además, durante la parametrización
de la conexión se puede acceder directamente a la tabla de conexiones. Para ello, haga clic
en el icono "Crear conexión".

Nombre de conexión

Se visualiza el nombre de la conexión creada automáticamente al introducir la instrucción
PUT/GET. El nombre de la conexión se puede modificar introduciendo otro nombre en el
campo. Además es posible crear una conexión o editar conexiones ya existentes haciendo
clic en el icono "Crear conexión".

Iniciativa local

Determine mediante el botón de opción "Establecimiento activo de la conexión" el interlocutor
que debe iniciar la comunicación. Al crear la conexión, primero se determina el interlocutor
local para el establecimiento de la conexión de forma automática. Si un dispositivo no soporta
el establecimiento activo de la conexión, será necesario activar el establecimiento activo de
la conexión en el otro interlocutor.

Unilateral

Si la casilla de verificación está activada, el interlocutor actúa como servidor para esta co‐
nexión. No puede enviar ni recibir de forma activa. Se corresponde con el comportamiento de
las instrucciones PUT/GET. En este caso, no son posibles otras instrucciones. Si la casilla de
verificación está desactivada, es también posible utilizar otras instrucciones para la comuni‐
cación.

Iniciar la parametrización de la conexión
La conexión para PUT y GET se puede parametrizar en la ventana de inspección en cuanto se
ha insertado una instrucción PUT/GET en un bloque de programa y se ha seleccionado.

Procedimiento
Para insertar instrucciones PUT/GET, proceda del siguiente modo:
1. Abra la Task Card "Instrucciones", carpeta "Comunicación > Comunicación S7".
2. Arrastre la instrucción PUT/GET a un segmento con la función Drag & Drop:
Se abre el cuadro de diálogo "Opciones de llamada".
3. Opcionalmente: Edite las propiedades del DB instancia en el cuadro de diálogo "Opciones
de llamada". Existen las posibilidades siguientes:
– Modificar el nombre predeterminado.
– Seleccionar el campo de opción "manual" para asignar un número propio.
4. Haga clic en "Aceptar".

Resultado
Para la instrucción insertada PUT o GET se crea un bloque de datos de instancia
correspondiente. En el caso de las CPUs S7-300, se crea además un bloque de función en los
recursos del programa.
Si hay una instrucción PUT/GET seleccionada, en la ventana de inspección se puede ver la
ficha "Configuración" en "Propiedades". El grupo "Parámetros de la conexión" de la
navegación local contiene la parametrización de la conexión que debe realizarse ahora.

174

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Consulte también
Crear y parametrizar conexiones (Página 175)
Borrar conexiones (Página 176)

Crear y parametrizar conexiones
En la parametrización de conexión de las instrucciones PUT y GET es posible crear y
parametrizar las conexiones S7. La parametrización de conexión comprueba inmediatamente
si los valores modificados presentan errores de entrada.

Requisitos
Existe una CPU con una instrucción de comunicación PUT o GET.

Procedimiento
Para configurar una conexión S7 mediante instrucciones PUT/GET, proceda del siguiente
modo:
1. En el editor de programación, seleccione la llamada de la instrucción PUT o GET.
2. En la ventana de inspección abra la ficha "Propiedades > Configuración".
3. Seleccione el grupo "Parámetros de la conexión". Mientras no se haya seleccionado ningún
interlocutor, sólo estará activa la lista desplegable vacía del punto final del interlocutor.
Todas las demás entradas posibles estarán desactivadas.
Se mostrarán los parámetros de conexión que ya se conocen:
– Nombre del punto final local
– Interfaz del punto final local
– Dirección IP del punto final local

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

175

Configuración de dispositivos y redes
1.3 Configurar redes
4. Seleccione un interlocutor en la lista desplegable del punto final del interlocutor. El
interlocutor puede ser un dispositivo sin especificar o una CPU del proyecto.
Los siguientes parámetros se introducen automáticamente en cuanto se selecciona el
interlocutor:
– Nombre del punto final del interlocutor
– Interfaz del punto final del interlocutor. Si se dispone de varias interfaces, se puede
cambiar de interfaz en caso necesario.
– Tipo de interfaz del punto final del interlocutor
– Nombre de la subred de ambos puntos finales
– Dirección IP del punto final del interlocutor
– Nombre de la conexión que se utiliza para la comunicación. Si no existe ninguna
conexión, se creará una de forma automática.
5. En caso necesario, cambie el nombre de conexión en el campo de entrada "Nombre de
conexión". Si desea crear una conexión o editar una conexión ya existente, haga clic en el
icono "Crear conexión".
Nota
Las instrucciones PUT y GET entre dos interlocutores no estarán listas hasta que se haya
cargado en el hardware tanto la configuración de hardware como la parte del programa
destinada al punto final del interlocutor. Para que la comunicación funcione, asegúrese de
no cargar en el dispositivo únicamente la descripción de la conexión de la CPU local, sino
también la de la CPU partner.

Borrar conexiones
Una conexión que se ha creado automáticamente al insertar una instrucción PUT/GET
aparece, como cualquier otra conexión, en la tabla de conexiones de la vista de redes. De ese
modo es posible borrarla en la tabla de conexiones.

Procedimiento
Para borrar una conexión, proceda del siguiente modo:
1. Abra la tabla de conexiones en la vista de redes.
2. En la tabla la conexiones, seleccione la conexión que desea borrar.
3. Haga clic en la conexión con el botón derecho del ratón y elija el comando "Borrar" en el
menú contextual.

Resultado
La conexión se ha borrado. La instrucción PUT/GET y los bloques de datos de instancia
correspondientes se conservan y, en caso necesario, deben borrarse manualmente.
Para continuar utilizando la instrucción PUT/GET hay que volver a configurar la conexión en la
ventana de inspección del editor de programación, ya que al borrar la conexión también se

176

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
borran todos los parámetros correspondientes. En ese caso, especifique un nuevo interlocutor
y una conexión adecuada.

Parametrización de bloques
Parametrizar el tipo de petición
Para iniciar una comunicación a través de la instrucción PUT/GET, hay que definir un evento
que active la instrucción. Este evento se denomina parámetro de control (REQ). La petición de
comunicación se activa con un flanco positivo en el parámetro de control REQ.
Recuerde que el parámetro de control REQ tiene asignado FALSE en la primera llamada.

Requisitos
● El editor de programación está abierto.
● Ya ha insertado una instrucción PUT/GET.
● Existe una conexión entre dos interlocutores.

Procedimiento
Para definir el parámetro de control REQ, proceda del siguiente modo:
1. Seleccione la instrucción PUT/GET en el editor de programación.
2. Abra la ficha "Configuración" en la ventana de inspección.
3. Seleccione la entrada "Parametrización de bloques" en la navegación local.
4. En el campo "REQ", seleccione una variable del tipo de datos "BOOL" para inicializar la
ejecución de la instrucción. También es posible interconectar una instrucción previa en el
editor de programación.

Consulte también
PUT: Parametrizar área de escritura y transmisión (Página 177)
GET: Parametrizar un área de lectura y memoria (Página 178)

PUT: Parametrizar área de escritura y transmisión
En la comunicación con la instrucción PUT hay que especificar en qué área de memoria de la
CPU interlocutora deben escribirse los datos. Además hay que especificar el área de memoria
de la CPU local de la cual deben leerse los datos.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

177

Configuración de dispositivos y redes
1.3 Configurar redes

Requisitos
● El editor de programación está abierto.
● Ya ha insertado una instrucción PUT.
● Existe una conexión entre dos interlocutores.

Procedimiento
Para definir el área de lectura y memoria de la instrucción, proceda del siguiente modo:
1. Seleccione la instrucción PUT en el editor de programación.
2. Abra la ficha "Configuración" en la ventana de inspección.
3. Seleccione la entrada "Parametrización de bloques" en la navegación local.
4. En el campo "Entradas/salidas > Área de escritura (ADDR_1) > Inicio" seleccione un
puntero con el tipo de datos "REMOTE" al área de la CPU interlocutora que debe escribirse.
Sólo se admite el direccionamiento absoluto.
Ejemplo: P#DB10.DBX5.0 byte 10
5. En el campo "Longitud", indique la longitud del área de escritura y seleccione el tipo de
datos del área de memoria en la lista desplegable.
6. En el campo "Entradas/salidas > Área de transmisión (SD_1) > Inicio", seleccione un
puntero al área de la CPU local que contiene los datos que deben enviarse.
7. Indique en el campo "Longitud" la longitud del área de memoria que debe leerse y
seleccione el tipo de datos en la lista desplegable.
Sólo se permiten los tipos de datos BOOL (en un campo de bits debe indicarse como
dirección "0" y como longitud un múltiplo entero de Byte), BYTE, CHAR, WORD, INT,
DWORD, DINT, REAL, COUNTER, TIMER.
Si el puntero VARIANT accede a un DB, éste siempre debe especificarse (p. ej.:
P#DB10.DBX5.0 Byte 10).

Consulte también
GET: Parametrizar un área de lectura y memoria (Página 178)

GET: Parametrizar un área de lectura y memoria
En la comunicación con la instrucción GET hay que especificar en qué área de memoria de la
CPU local deben escribirse los datos. Además hay que definir el área de lectura de la CPU
interlocutora de la cual deben leerse los datos.

Requisitos
● El editor de programación está abierto.
● Ya ha insertado una instrucción GET.
● Existe una conexión entre dos interlocutores.

178

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento
Para definir el área de lectura y memoria de la instrucción, proceda del siguiente modo:
1. Seleccione la instrucción GET en el editor de programación.
2. Abra la ficha "Configuración" de la ventana de inspección.
3. Seleccione la entrada "Parametrización de bloques" en la navegación local.
4. En el campo "Entradas/salidas > Área de lectura (ADDR_1) > Inicio" seleccione un puntero
con el tipo de datos "REMOTE" al área de la CPU interlocutora que debe leerse.
Sólo se admite el direccionamiento absoluto.
Ejemplo: P#DB10.DBX5.0 byte 10
5. En el campo "Longitud", indique la longitud del área de lectura y seleccione el tipo de datos
del área de memoria en la lista desplegable.
6. En el campo "Entradas/salidas > Área de memoria (RD_1) > Inicio", seleccione un puntero
al área de la CPU local en la que deben depositarse los datos leídos.
7. Indique en el campo "Longitud" la longitud del área de memoria y seleccione el tipo de datos
en la lista desplegable.
Sólo se permiten los tipos de datos BOOL (en un campo de bits debe indicarse como
dirección "0" y como longitud un múltiplo entero de Byte), BYTE, CHAR, WORD, INT,
DWORD, DINT, REAL, COUNTER, TIMER.

Consulte también
PUT: Parametrizar área de escritura y transmisión (Página 177)

Recursos de conexión
Recursos disponibles en la configuración de conexiones
Recursos de conexión
Algunos servicios de comunicación requieren conexiones. Durante el funcionamiento, las
conexiones de comunicación exigen recursos de memoria y programación de las CPUs, los
CPs y CMs que intervienen en la ruta de comunicación (p. ej. áreas de memoria del sistema
operativo de la CPU). Esto afecta, por ejemplo dentro de un controlador (PLC), a la CPU como
punto final de la conexión, así como a las ampliaciones con CPs como interfaces a las
subredes. En la mayoría de los casos, para cada conexión se ocupa un recurso por cada CPU/
CP/CM. En la comunicación HMI, por cada conexión HMI se necesitan hasta 3 recursos.

Recursos de conexión disponibles
La capacidad máxima dentro del sistema de automatización la determina siempre la CPU, bien
por el límite superior del sistema determinado por la CPU (S7-1200/1500), bien por la suma de
recursos útiles de la CPU y el CP (S7-300/400). En la mayoría de los casos los recursos de
conexión disponibles de una CPU, un CP o un CM se distribuyen automáticamente en las
interfaces en función de las necesidades concretas.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

179

Configuración de dispositivos y redes
1.3 Configurar redes
Cada CPU incluye en su configuración recursos de conexión reservados para comunicación
PG, HMI y de servidor web. Paralelamente existen recursos disponibles que pueden utilizarse
para cualquier comunicación HMI o S7 y para comunicación abierta (S7-1200/1500).
La configuración de los dispositivos permite determinar los recursos disponibles del modo
siguiente:
● Selección del tipo de dispositivo del punto final de la conexión (CPU)
● Número y tipo de módulos de comunicación adicionales (CP, CM)
En cada sistema de automatización se dispone de un número diferente de recursos de
conexión:
● S7-300: La CPU utilizada determina el número de recursos posibles para conexiones.
Mediante CP agregados puede aumentarse el número máximo de recursos para
conexiones.
● S7-400: La CPU utilizada determina el número de recursos posibles para conexiones S7.
Los recursos también pueden emplearse para otros tipos de conexiones; mediante los CP
agregados puede aumentarse el número máximo de recursos para otros tipos de
conexiones.
● S7-1200: La CPU utilizada determina el número de recursos posibles para conexiones S7.
Este límite superior no puede ampliarse agregando más CP o CM.
● S7-1500: La CPU empleada determina el límite superior de recursos de conexión válido
para todo el sistema de automatización. La propia CPU controla parte de estos recursos de
conexión; otros recursos se agregan vía CP y CM. Pero con independencia del número de
CP y CM agregados, no puede sobrepasarse el número total máximo de recursos de
conexión determinado por el tipo de CPU.

Asignación de recursos de conexión
Los recursos que realmente se requieren durante el funcionamiento dependen de qué
funciones de comunicación se estén utilizando en un determinado momento y de qué
conexiones estén establecidas en un determinado momento. Por eso, durante la configuración
sólo puede comprobarse si se cumplen determinadas capacidades y si hay recursos de
comunicación disponibles. La configuración de conexiones ofrece la máxima ayuda posible.

Factores que influyen en la capacidad funcional
Al configurar los dispositivos se determinan los recursos de comunicación:
● Número de recursos de conexión S7 disponibles en la CPU (S7-300/400)
● Número de recursos de conexión para S7 y comunicación abierta en la estación (S7-1500)
● Número de recursos de conexión específicos del protocolo en los CP o CM
● Número de CP o CM disponibles
● Creación automática de la conexión programada o configurada

180

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Comportamiento de la configuración de conexiones
La configuración de conexiones comprueba durante la entrada las siguientes circunstancias y
se comporta del siguiente modo:
● Al crear conexiones S7
¿Se ha asignado el número máximo de recursos de conexión S7 disponibles? En caso
afirmativo, a través de la interfaz seleccionada no puede configurarse ninguna conexión S7
adicional.
En S7-300 puede ampliarse la capacidad mediante otros CPs.
● Al crear cualquier tipo de conexión
¿Se ha asignado el número máximo de recursos de conexión específicos de protocolo en
la interfaz (CP)? En caso afirmativo, a través de la interfaz seleccionada no puede
configurarse ninguna conexión adicional del tipo seleccionado.
En S7-300/400 puede ampliarse la capacidad mediante otros CPs.
● Al crear cualquier tipo de conexión con OPC (estaciones PC)
En conexiones con OPC como punto final, generalmente se pueden configurar más
conexiones de las que el CP utilizado en la estación PC puede operar en un determinado
momento. Esto está relacionado con el hecho de que en las propiedades de conexión se
diferencia entre "mantener de forma permanente" y "establecer a petición".
El límite para CP Softnet IE es de 64 conexiones simultáneas y para CP Hardnet IE de 120
conexiones simultáneas.
Nota
Número de conexiones configuradas localmente mayor que el número de conexiones
posibles en tiempo de ejecución
El usuario puede configurar el número máximo posible de conexiones S7 y SEND/
RECEIVE vía OPC en tiempo de ejecución como "mantener de forma permanente" y no
configurar más conexiones como "establecer a petición". Como alternativa, el usuario
puede configurar menos conexiones S7 y SEND/RECEIVE vía OPC que el número máximo
posible en tiempo de ejecución como "Mantener la conexión de forma permanente" y
después configurar otras conexiones S7 y SEND/RECEIVE como "Establecer conexión
bajo demanda".
Si el usuario configura más de 64 conexiones S7 y SEND/RECEIVE, aparece una
advertencia al compilar la configuración. La advertencia aparece independientemente de si
las conexiones están configuradas como permanentes ("Mantener la conexión de forma
permanente") o temporales ("Establecer conexión bajo demanda"), pues incluso con 65
conexiones temporales teóricamente es posible que se rebase por exceso el número
máximo de conexiones simultáneas en tiempo de ejecución.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

181

Configuración de dispositivos y redes
1.3 Configurar redes
Si es necesario, al compilar la configuración de conexiones se emite una advertencia, o un
mensaje de error en caso de que no pueda asignarse la interfaz.
Nota
Recursos de conexión S7 agotados
Cuando el número máximo de recursos de conexión S7 está reservado, es posible que durante
el funcionamiento no quede disponible ningún recurso de conexión S7, que se requiere
adicionalmente para la transferencia de datos entre CPU y CP. En tal caso, se rechazan las
correspondientes peticiones de comunicación.
Por eso, debe asegurarse un número suficiente de recursos de conexión S7 no ocupados
dependiendo de las funciones de comunicación que se requieren en total.
El número de recursos de conexión S7 reservados para la CPU S7-300 o S7-1200/1500
seleccionada puede consultarse en "Recursos de conexión", dentro de la navegación local.
Para S7-300 se muestran solo los recursos de conexión de la CPU; para S7-1200/1500 se
muestran también los recursos de los CP y CM.

Recursos de conexión y tipo de comunicación
Cada conexión requiere recursos de los dispositivos implicados tanto para el punto final como
para el punto de transición (p. ej. CP, CM). El número de recursos de conexión disponibles es
específico de la CPU, el CP o el CM.
Si todos los recursos de conexión de un interlocutor están ocupados, no podrá establecerse
ninguna nueva conexión. A continuación se consideran todos los tipos de comunicación
individualmente. Sin embargo, si se consideran los recursos de conexión disponibles, es
posible cualquier combinación.

Conexiones S7 a través de interfaz integrada
Cada conexión S7 establecida a través de la interfaz MPI/PROFIBUS DP/PN integrada ocupa
un recurso de conexión para el punto final en la CPU. Esto se aplica a todas las CPU
S7-300/400/1200/1500.
&38




①
②

182

Recurso de conexión S7 ocupado en la CPU
Subred (p. ej. MPI, PROFIBUS DP o Industrial Ethernet o PROFINET)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
● CPU S7-300/400: Se ocupa un recurso de conexión S7 en la CPU.
● CPU S7-1200/1500: Se ocupa un recurso de conexión S7 en la CPU y, por tanto, también
otro en la estación.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

183

Configuración de dispositivos y redes
1.3 Configurar redes

Conexiones S7 a través de interfaz externa
En las conexiones S7 a través de una interfaz CP externa cabe distinguir los siguientes casos:
● CPU S7-300
– Conexión S7 unilateral: En la CPU (para el punto final) y en el CP (punto de transición)
se ocupa un recurso de conexión S7 por cada conexión S7.
&38

&3

&38



&3




①
②
③

Un recurso de conexión S7 en la CPU y uno en el CP del punto final local
Interlocutor
Subred, p. ej. Industrial Ethernet

– Conexión S7 bilateral: El el CP se ocupa un recurso S7 por cada conexión S7.
&38

&3

&38



&3




①
②
③

Un recurso de conexión S7 en el CP del punto final local
Interlocutor
Subred, p. ej. Industrial Ethernet

● CPU S7-400
En la CPU (para el punto final) y en el CP (punto de transición) se ocupa un recurso de
conexión S7 por cada conexión S7.

184

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
&38

&3

&38



&3




①
②
③

Un recurso de conexión S7 en la CPU y uno en el CP del punto final local
Interlocutor
Subred, p. ej. Industrial Ethernet

● CPU S7-1200/1500:
– Conexión S7 unilateral: Se ocupa un recurso de conexión S7 en la CPU por cada
conexión S7 y, por tanto, también otro recurso de conexión S7 en la estación.
&38

&3

&38



&3




①
②
③

Un recurso de conexión S7 en la CPU y uno en el CP del punto final local
Interlocutor
Subred, p. ej. Industrial Ethernet

– Conexión S7 bilateral: Se ocupa un recurso de conexión S7 en la CPU por cada
conexión S7 y, por tanto, también otro recurso de conexión S7 en la estación.
&38

&3

&38



&3




①
②
③

Un recurso de conexión S7 en el CP y, por tanto, otro en la estación
Interlocutor
Subred, p. ej. Industrial Ethernet

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

185

Configuración de dispositivos y redes
1.3 Configurar redes

Nota
En "Recursos de conexión" en la navegación local, para determinados tipos de CPU S7-300
puede consultarse el número de recursos de conexión S7 reservados para la CPU
seleccionada, y con S7-1200/1500 para la CPU seleccionada y los módulos de comunicación
conectados. Aquí se pueden reservar recursos de conexión S7 para la comunicación básica
S7 y OP/PG.

Comunicaciones para servicios de comunicación abiertos (interfaz SEND/RECEIVE)
La comunicación a través de la interfaz SEND/RECEIVE se realiza exclusivamente con CPs.
Para ello, en el CP se ocupa un recurso de conexión específico de protocolo para el punto final
por cada conexión (es decir, conexión FDL, ISO-Transport, ISO-on-TCP, UDP y TCP).
En la CPU no se necesitan recursos de conexión para la conexión.
&38

&3




①
②

1 Recurso de conexión ocupado en el CP
Subred, p. ej. Industrial Ethernet

Excepción: En la CPU S7-400, las conexiones con la propiedad "SPEED SEND/RECEIVE"
requieren un recurso de conexión S7 adicional para cada conexión "SPEED SEND/RECEIVE"
en la CPU.

Recursos de conexión y tipo de conexión
Activación de la conexión
A menudo existe la posibilidad de elegir entre una activación configurada o una programada.
La activación programada facilita la habilitación de recursos de conexión tras la transferencia
de datos. La activación configurada sirve de apoyo para administrar los recursos de conexión
en STEP 7.
Tabla 1-3

Activación del servicio de comunicación

Servicio de comunicación

186

Activación automá‐ Activación programa‐ Activación configu‐
tica
da
rada

Comunicación PG

X

-

-

Comunicación HMI

X

-

X

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Servicio de comunicación

Activación automá‐ Activación programa‐ Activación configu‐
tica
da
rada

Comunicación S7

-

X

X

Comunicación abierta vía TCP/IP

-

X

X

Comunicación abierta vía ISO on
TCP

-

X

X

Comunicación abierta vía UDP

-

X

X

Comunicación abierta vía ISO

-

X

X

Comunicación abierta vía correo
electrónico

-

X

-

Comunicación abierta vía FTP

-

X

-

Comunicación abierta vía FDL

-

X

X

Routing S7

-

-

X

Ocupación de los recursos de conexión en función del dispositivo de conexión.
Dependiendo de cómo se realice la conexión, la ocupación de los recursos se efectúa de
manera diferente:
● Activación configurada
En las conexiones configuradas, el recurso de conexión se ocupa en cuanto la
configuración hardware se carga en la CPU. Para servidores OPC los recursos se ocupan
conforme se van necesitando.
● Activación programada
Al llamar las instrucciones correspondientes para establecer la conexión (vía TSEND_C o
T_CON), se ocupa un recurso de conexión.
● Activación automática
En cuanto la PG o el dispositivo HMI se conecta físicamente y en línea con una CPU, se
ocupan los recursos de conexión.

Recursos de conexión con activación configurada
Active la conexión en la vista de redes del editor de hardware y de redes dentro del contexto
de una CPU.
Una vez transmitidos los datos no se deshace la conexión, es decir, los recursos de conexión
permanecen ocupados permanentemente. Para deshacer la conexión, borre su configuración
y cargue en la CPU la configuración modificada.
Las conexiones OPC se establecen y deshacen automáticamente en función de las
necesidades.
Si se han configurado conexiones, en el sistema de automatización de supervisa que se
respete el número máximo posible de recursos.

Recursos de conexión con activación programada
Active la conexión en el editor de programas en el contexto de una CPU parametrizando
instrucciones para comunicación, p. ej. TSEND_C.
Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

187

Configuración de dispositivos y redes
1.3 Configurar redes
Una vez establecida la conexión con las instrucciones TCON o TSEND_C, se deshace
parametrizando adecuadamente la instrucción TSEND_C o llamando la instrucción TDISCON
después de la transferencia de datos. Cuando se deshace la conexión, los recursos de
conexión vuelven a estar disponibles en la CPU, el CP o el CM. Si se mantiene la conexión, el
tiempo de procesamiento de las instrucciones en una nueva transferencia de datos es menor,
puesto que no es necesario volver a establecer la conexión.
Si las conexiones se establecen y deshacen de forma programada en el programa de usuario,
hay que vigilar que se respeten los límites del sistema de automatización. En caso necesario
recibirá un mensaje de error de comunicación en el parámetro de salida "STATUS" de la
instrucción TSEND_C o T_CON, y podrá obtener información más detallada en el diagnóstico
de la conexión.

Recursos de conexión con activación automática
La conexión se activa automáticamente (p. ej. conexión PG o HMI) en cuanto la interfaz PG-PG
se conecta físicamente con una interfaz de la CPU y en el diálogo "Establecer conexión online"
se ha realizado la asignación a la interfaz.
Para conexiones activadas automáticamente se vigila que en el sistema de automatización se
respeten los recursos de conexión reservados.

Recursos de conexión S7-1200
Indicación de los recursos de conexión
Recursos de conexión en la ventana de inspección
Encontrará un resumen de los recursos de conexión reservados y disponibles de un sistema
de automatización S7-1200 en las propiedades de la CPU, dentro de la ventana de inspección
del editor de hardware y de redes.

Resumen de los recursos de conexión
La CPU soporta como máximo el número siguiente de conexiones de comunicación
asíncronas simultáneas para PROFINET y PROFIBUS. El número máximo de recursos de
conexión asignados a cada categoría está definido. Los valores no se pueden modificar. Sin
embargo, las 6 conexiones de libre disponibilidad pueden utilizarse para incrementar el
número de conexiones en función de las necesidades de utilización en cada categoría.
Al visualizar los recursos de conexión se distingue si se trata de la vista offline o de la vista
online. La siguiente figura muestra la visualización offline de los recursos de conexión
reservados y disponibles de una CPU 1217C:

188

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes



①
②



Recursos de conexión específicos de la estación
Recursos de conexión específicos del módulo

Recursos de conexión específicos de la estación
Las columnas de los recursos de conexión específicos de la estación informan sobre los
recursos de conexión reservados y que puede utilizar dinámicamente la estación. En el
ejemplo, el sistema de automatización dispone como máximo de 68 recursos de conexión
específicos de la estación:
● 62 recursos de conexión están reservados para determinados tipos de conexión
● 6 recursos de conexión pueden utilizarse libremente para diversos tipos de conexión
El triángulo de advertencia en la columna de los recursos dinámicos de la estación aparece
porque la suma del número máximo de recursos de conexión disponibles de la CPU ha
alcanzado el límite de la estación de 68.
Nota
Rebase de los recursos de conexión disponibles
Cuando se alcanza el número de recursos de conexión específicos de una estación, STEP 7
lo notifica con una advertencia. Si se necesitan más recursos de conexión, debe utilizarse una
CPU con un un número mayor de recursos de conexión disponibles específicos de la estación,
o bien debe reducirse el número de conexiones de comunicación.
Recursos de conexión específicos del módulo
Las columnas de los recursos de conexión específicos del módulo informan sobre la
asignación de los recursos en las CPU, los CP y los CM de un sistema de automatización: La

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

189

Configuración de dispositivos y redes
1.3 Configurar redes
visualización es granular por módulos y no por interfaces. En el ejemplo, la CPU tiene
disponibles como máximo 68 recursos de conexión.
Nota
Si se agregan módulos CM/CP no aumenta el número total de recursos de comunicación
S7-1200.
Vista online
Si existe una conexión online con la CPU, en la ficha "Información de la conexión" del área
"Diagnóstico" de la ventana de inspección se ve también cuántos recursos se utilizan
actualmente en cada caso.
Además de los recursos de conexión reservados y dinámicos de las conexiones configuradas,
la vista online de la tabla "Recursos de conexión" contiene también columnas con los recursos
de las conexiones programadas y activadas automáticamente que están ocupados en la
estación. Por tanto, en la vista online se muestran todos los recursos ocupados del sistema de
automatización, con independencia de cómo se haya activado la conexión. En la línea "Otra
comunicación" se muestran los recursos ocupados para comunicación con dispositivos de
terceros y comunicación vía routing de juegos de datos.
La tabla se actualiza de forma automática. Si existen incoherencias entre la configuración
hardware y la existente online, se emite el correspondiente aviso.

Recursos necesarios de las conexiones
Las conexiones de comunicación de Open User Communication, conexión S7, HMI,
programadora y servidor web (HTTP) pueden utilizar varios recursos de conexión
dependiendo de las funciones utilizadas.
En función de los recursos de conexión asignados, para cada dispositivo se dispone del
siguiente número de conexiones:
Programadora (PG)
Número máxi‐
4
mo de recur‐ (está garantizado que
sos de cone‐ soporta una conexión
xión de una
PG)
CPU 1217C

Dispositivos HMI

Cliente/servidor
GET/PUT

Open User Com‐
munication

Navegador web

12

8

8

30

(está garantizado
que soporta cuatro
conexiones HMI)

(está garantizado
que soporta tres co‐
nexiones HTTP)

Comunicación PG
Por ejemplo, para una comunicación PG hay disponibles cuatro recursos de conexión. Según
las funciones PG que se utilicen actualmente, la PG ocupa para una conexión hasta tres
recursos de conexión. Con el S7-1200, actualmente está garantizada como mínimo una
conexión PG.
Comunicación HMI
Otro ejemplo es el número de dispositivos HMI, como se muestra en la figura siguiente. Para
dispositivos HMI hay disponibles 12 recursos de conexión. Según el tipo o el modelo del
dispositivo HMI y de las funciones HMI utilizadas, un dispositivo HMI puede necesitar hasta

190

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
tres recursos de conexión para una conexión HMI. Por ejemplo, un Basic Panel requiere hasta
dos recursos de conexión en la CPU para una conexión HMI, y un Comfort Panel hasta tres
recursos. Dependiendo del número de recursos de conexión necesarios puede haber
configuradas simultáneamente como mínimo cuatro conexiones HMI.
Un dispositivo HMI puede utilizar los recursos de conexión que tiene disponibles para las
funciones siguientes:
● lectura
● escritura
● alarmas y diagnósticos
Esto es solo un ejemplo. El número real de conexiones puede variar en función del tipo y la
versión del dispositivo HMI.
Ejemplo

HMI 1

HMI 2

HMI 3

HMI 4

HMI 5

Número to‐
tal de recur‐
sos de cone‐
xión disponi‐
bles

Recursos de
conexión uti‐
lizados

2

2

2

3

3

12

Puede consultarse información sobre la disponibilidad y ocupación de recursos para
conexiones HMI en la vista offline del dispositivo HMI (en "Propiedades > General > Recursos
de conexión" dentro de la ventana de inspección).

En el área Recursos de conexión se muestra lo siguiente:
● El número de conexiones disponibles en HMI que están reservadas para la comunicación
HMI y la comunicación HTTP
● El número de recursos de conexión utilizados offline en HMI para la comunicación HMI y la
comunicación HTTP
Si se rebasa el número máximo de recursos de conexión disponibles para un dispositivo
HMI, STEP 7 emite el aviso correspondiente.
● El número máximo de recursos PLC utilizados por cada conexión HMI. Este parámetro es
un factor que debe multiplicarse por el número de conexiones HMI utilizadas offline. El
producto da como resultado el número de recursos HMI ocupados por la CPU.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

191

Configuración de dispositivos y redes
1.3 Configurar redes
Si se rebasa el número máximo de recursos de conexión disponibles para un dispositivo HMI,
se emite el correspondiente aviso.
Comunicación web
La CPU ofrece conexiones de servidor web (HTTP) para varios navegadores web. El número
de navegadores que pueden soportar simultáneamente las CPU depende de cuántas
conexiones requiera o utilice un navegador web.

Recursos de conexión S7-1500
Recursos de conexión en el sistema de automatización
Introducción
Algunos servicios de comunicación requieren conexiones. Las conexiones ocupan recursos
en el sistema de automatización. Los recursos de conexión los proporcionan las CPU, los
procesadores de comunicaciones (CP) y los módulos de comunicación (CM).

Recursos de conexión de una estación
Los recursos de conexión disponibles dependen de las CPU, los CP o los CM utilizados y no
deben rebasar un número máximo por estación. La CPU determina el número máximo de
recursos de una estación.
Cada CPU incorpora recursos de conexión reservados para la comunicación PG, HMI y de
servidor web. De este modo se garantiza, p. ej., que una PG siempre pueda establecer al
menos una conexión online con la CPU, independientemente de cuántos otros servicios de
comunicación ocupen ya recursos de conexión. Además existen recursos dinámicos. La
diferencia entre el número máximo de recursos de conexión y el número de recursos de
conexión reservados es el número máximo de recursos de conexión dinámicos. Los servicios
de comunicación, como comunicación PG, HMI, S7, web, Open User Communication y
cualquier otra comunicación (p. ej. OPC UA), se sirven del grupo de recursos de conexión
dinámicos.
La figura siguiente muestra un ejemplo de cómo los diferentes componentes ponen a
disposición los recursos de conexión de una estación S7-1500.

192

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

%

$

&

'




①

②

Recursos de conexión disponibles de la estación, de los cuales
A

Recursos de conexión reservados de la estación

A+B

Recursos de conexión de la CPU 1518

C

Recursos de conexión del módulo de comunicación CM 1542-1

D

Recursos de conexión del procesador de comunicaciones CP 1543‑1 / CP 1545‑1

Recursos de conexión máximos de la estación tomando como ejemplo una configuración for‐
mada por CPU 1518, CM 1542-1 y CP 154x-1

Número de recursos de conexión de una estación
En la tabla siguiente encontrará el número máximo de recursos de conexión disponibles para
algunos tipos de CPU:
Recursos de conexión de
una estación
Recursos de conexión máxi‐
mos de la estación

1511
1511C

1512C

96

128

1515

1516

1517

1518

192

256

320

384

1513

de los cuales reservados

10

de los cuales dinámicos

86

118

182

246

310

374

Recursos de conexión de la
CPU

64

88

108

128

160

192

Número máx. de recursos de
conexión utilizables adicio‐
nalmente al insertar CM/CP

32

40

84

128

160

192

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

193

Configuración de dispositivos y redes
1.3 Configurar redes
Recursos de conexión de
una estación

1511
1511C

1512C

1515

1516

1517

1518

1513

Recursos de conexión adicio‐
nales CM 1542‑1

64

Recursos de conexión adicio‐
nales CP 154x‑1

118

Recursos de conexión adicio‐
nales CM 1542‑5

40

Recursos de conexión adicio‐
nales CP 1542‑5

16

Encontrará el número de recursos de conexión soportados por una CPU o un módulo de
comunicación en los datos técnicos de los respectivos manuales de producto.

Ejemplo
Se ha configurado una CPU 1518-4PN/DP con un módulo de comunicación CM 1542-1 y un
procesador de comunicaciones CP 1542-5.
● Recursos de conexión máximos de la estación: 384
● Recursos de conexión disponibles:
– CPU 1518-4 PN/DP: 192
– CM 1542-1: 64
– CP 1542-5: 16
– Total: 272
La instalación dispone de 272 recursos de conexión. Si se agregan otros módulos de
comunicación, la estación puede soportar como máximo otros 112 recursos de conexión.

Recursos de conexión reservados
Para estaciones con CPU S7‑1500, CPU ET 200SP y CPU ET 200pro basadas en S7-1500
hay reservados 10 recursos de conexión:
● 4 para la comunicación PG, que STEP 7 necesita, p. ej., para las funciones de test y
diagnóstico o para la carga en la CPU.
● 4 para la comunicación HMI, que son ocupados por las primeras conexiones HMI
configuradas en STEP 7.
● 2 para comunicación con el servidor web

194

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Asignación de recursos de conexión
Sinopsis - Asignación de recursos de conexión
La figura siguiente muestra la forma en que diferentes conexiones ocupan los recursos del
S7-1500:
6HUYLGRUZHE
+0,






6

6




&OLHQWH23&8$



3*3&

①
②

Comunicación HMI: véase más abajo

③

Comunicación S7: Las conexiones de la comunicación S7 ocupan un recurso de conexión en
cada punto final.

④
⑤
⑥/
⑦

Open User Communication: Las conexiones de la Open User Communication ocupan un re‐
curso de conexión en cada punto final.

Comunicación web: La conexión del servidor web ocupa como mínimo un recurso de conexión
en la estación. El número de conexiones ocupadas depende del navegador.
Comunicación PG: La conexión PG ocupa un recurso de conexión en la estación.
Comunicación cliente-servidor OPC UA: por lo general, cada sesión que el servidor OPC UA de
la CPU establece con un cliente OPC UA ocupa un recurso de conexión en la estación.
Información sobre los recursos de conexión del cliente OPC UA: véase más abajo
Recurso de conexión para la comunicación HMI
Recurso de conexión para la Open User Communication
Recurso de conexión para la comunicación S7
Recurso de conexión para la comunicación web
Recurso de conexión para la comunicación PG
Recurso de conexión para la comunicación cliente-servidor OPC UA, v. más adelante

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

195

Configuración de dispositivos y redes
1.3 Configurar redes

Recursos de conexión para la comunicación HMI
En la comunicación HMI, la asignación de recursos de conexión en la estación depende del
dispositivo HMI utilizado. En la tabla siguiente encontrará el número máximo de recursos de
conexión ocupados para una conexión HMI en función de los diferentes dispositivos HMI:
Dispositivo HMI

1

Número máximo de recursos de conexión de la
estación asignados por conexión HMI

Basic Panel

1

Comfort Panel

21

RT Advanced

21

RT Professional

3

Si no se utilizan el diagnóstico de sistema ni la configuración de avisos, la estación solo asigna un
recurso de conexión por conexión HMI.

Ejemplo: Para una CPU 1516‑3 PN/DP se han configurado las siguientes conexiones HMI:
● Dos conexiones HMI a un HMI TP700 Comfort (2 recursos de conexión cada una)
● Una conexión HMI a un HMI KTP1000 Basic (1 recurso de conexión)
En la CPU se asignan en total 5 recursos de conexión para comunicación HMI.

Recursos de conexión para el routing
Conexiones S7 fuera de la red (routing S7)
Para la transferencia de datos a través de varias subredes S7 ("routing S7"), se establece una
conexión S7 entre dos CPU. Las subredes S7 están conectadas entre sí mediante pasarelas
denominadas "routers S7". El router es el punto de paso de una conexión S7 y puede
establecer conexiones S7. En S7‑1500, las CPU, los CM y los CP actúan como router S7.
A la hora de establecer una conexión S7 enrutada, debe tenerse en cuenta lo siguiente:
● Una conexión enrutada ocupa un recurso de conexión en cada uno de los dos puntos
finales. STEP 7 muestra estos recursos de conexión en la tabla "Recursos de conexión".
● En el router S7 se ocupan dos recursos de conexión especiales para el routing S7. STEP
7 no visualiza los recursos de conexión especiales para el routing S7 en la tabla "Recursos
de conexión". El número de recursos para el routing S7 depende de la CPU. Encontrará los
recursos para el routing S7 en los datos técnicos de la CPU, en "Número de conexiones de
routing S7".
La figura siguiente muestra la ocupación de recursos de conexión en el routing S7:
3XQWRILQDO

5RXWHU6

3XQWRILQDO

Recurso de conexión para la comunicación S7
Recurso de conexión especial para el routing S7

196

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Routing de juegos de datos (registros)
El routing de juegos de datos también permite transferir datos a través de varias subredes S7
(desde una estación de ingeniería conectada a PROFINET hasta diversos aparatos de campo
vía PROFIBUS).
Igual que en el routing S7, en el routing de juegos de datos en las pasarelas también se ocupan
dos de los recursos de conexión especiales para routing S7 en cada router de juegos de datos.
En el punto final de la comunicación (CPU) los recursos para el routing de juegos de datos se
muestran en la vista online de la tabla "Recursos de conexión", en la línea "Otra comunicación".
Nota
Recursos de conexión para routing de juegos de datos
Para el routing de juegos de datos se ocupan dos recursos de conexión especiales para el
routing S7 en el router de juegos de datos. En la tabla de recursos de conexión no se muestran
ni la conexión de juegos de datos ni los recursos de conexión asignados. El propio usuario
debe prestar atención a que se respeten los límites en la configuración.

¿Cuándo se asignan recursos de conexión?
El momento de la asignación de recursos de conexión dependerá de cómo se cree la conexión.
● Creación programada de una conexión
En cuanto en el programa de usuario de la CPU se llama una instrucción para establecer
una conexión (TSEND_C/TRCV_C o TCON), se asigna un recurso de conexión. Después
de la transferencia de datos se puede deshacer la conexión y liberar el recurso
parametrizando adecuadamente el parámetro CONT de las instrucciones TSEND_C/
TRCV_C o la llamada de la instrucción TDISCON. Si se deshace la conexión, los recursos
de conexión de CPU/CP/CM vuelven a estar disponibles.
● Conexiones configuradas (p. ej. conexión HMI)
Si se ha configurado una conexión en STEP 7, el recurso de conexión queda ocupado en
cuanto se carga la configuración hardware en la CPU. Tras utilizar una conexión
configurada para transferir datos, la conexión no se deshace. El recurso de conexión queda
ocupado de forma permanente. Para volver a liberar el recurso de conexión, debe borrarse
la conexión configurada en STEP 7 y cargar la configuración modificada en la CPU.
● Conexión PG
Tan pronto como se conecta la programadora a una CPU en modo online en STEP 7,
quedan asignados recursos de conexión.
● Servidor web
Mientras el servidor web de la CPU permanece abierto en un navegador, se asignan
recursos de conexión en la CPU.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

197

Configuración de dispositivos y redes
1.3 Configurar redes
● Servidor OPC UA
Cada conexión con el servidor OPC UA de la CPU ocupa un recurso de conexión en la
estación. Este recurso de conexión se libera en cuanto se deshace la conexión.
● Cliente OPC UA
Cada conexión que el cliente OPC UA de la CPU ha establecido con un servidor OPC UA
ocupa un recurso de conexión en la estación. Al establecer una conexión OPC UA, el
cliente OPC UA ocupa temporalmente un recurso de conexión adicional. Al deshacer una
conexión OPC UA, el recurso de conexión se vuelve a liberar según RFC 793 tras un tiempo
de espera de aproximadamente 60 s (v. Detalles de las conexiones cliente-servidor OPC
UA (Página 198)).

Vigilancia del máximo número posible de recursos de conexión
Offline
Durante la configuración de conexiones, STEP 7 vigila la asignación de recursos de conexión.
STEP 7 notifica que se ha rebasado el número máximo de recursos de conexión con la
correspondiente advertencia.
Online
La CPU vigila el consumo de recursos de conexión del sistema de automatización. Si en el
programa de usuario se establecen más conexiones que recursos de conexión proporciona el
sistema de automatización, la CPU responde con un error a la instrucción de establecimiento
de conexión.

Detalles de las conexiones cliente-servidor OPC UA
En la comunicación cliente-servidor OPC UA puede producirse temporalmente una escasez
de recursos de conexión, pero solo si la CPU sufre una alta carga por peticiones de
comunicación.
Para comprender la escasez temporal de recursos de conexión deben tenerse en cuentas las
siguientes circunstancias:
● La desconexión para la comunicación basada en TCP, como es el caso de OPC UA, ocupa
recursos temporalmente, también tras deshacer la conexión (Disconnect).
● En OPC UA, el establecimiento de la conexión se desarrolla fundamentalmente en 2
etapas: primero el cliente establece una conexión para el proceso Discovery, y solo
entonces establece la conexión productiva.
● El número de conexiones OPC UA posibles está determinado por 2 límites. El
comportamiento en un establecimiento de conexión depende de qué límite se alcance
primero:
– el número máximo posible de conexiones de cliente-servidor OPC UA
– el número máximo posible de recursos del "grupo de conexiones", que permite un uso
variable de los recursos
Cómo se deshacen las conexiones basadas en TCP
La siguiente figura muestra cómo una conexión ya deshecha sigue ocupando recursos un
tiempo después.

198

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
6HUYHU

&OLHQW

1

GLVFRQQHFW
2

7,0(B:$,7

3

①
②

③

Disconnect: el cliente inicia una desconexión.
Apagado "ordenado" de la conexión conforme a RFC 793 (Transmission Control Protocol): el
recurso para el cliente (más concretamente: en el interlocutor que finaliza la conexión) perma‐
nece ocupado (aprox. 60 s), el recurso para el servidor (más concretamente: el interlocutor al
que se le notifica el final de la conexión) se libera al momento; la conexión se muestra como
"disconnected" (desconectada) en el cliente. Aunque la instrucción "OPC_UA_Disconnect" haya
terminado con "Done", el recurso permanece ocupado durante el tiempo de espera.

La conexión está deshecha y el tiempo de espera necesario para el acuse del interlocutor ha
transcurrido; el recurso se libera también en el cliente.
Figura 1-10
Principio: deshacer una conexión OPC UA

Cómo se establece una conexión de cliente-servidor OPC UA
Por las características del sistema, el establecimiento de una conexión OPC UA consta de 2
etapas: primero se establece una conexión para el proceso Discovery y, una vez recibida la
información solicitada, la conexión se deshace. Entonces es cuando se establece la conexión
productiva.
Junto con el proceso explicado anteriormente de la desconexión se produce una ocupación
temporal de 2 recursos en el cliente.
6HUYHU

&OLHQW
*HW(QGSRLQWV FRQQHFW

1

(QGSRLQW'HVFU
GLVFRQQHFW
&UHDWH6HVVLRQ FRQQHFW
7,0(B:$,7

①
②
③

2

3

Conexión para el proceso Discovery: ocupa un recurso en el cliente y en el servidor
Conexión productiva: ocupa un recurso en el cliente y en el servidor

Conexión paralela Discovery y productiva: se ocupan temporalmente dos recursos solo en el
cliente
Figura 1-11
Principio: establecer una conexión OPC UA

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

199

Configuración de dispositivos y redes
1.3 Configurar redes

Modelo flexible para la administración de recursos de conexión
Entre todos los tipos de conexión se reparten un grupo de recursos de conexión en la CPU.
Condiciones marco:
● Los recursos reservados para determinados tipos de conexión (PG y HMI) reducen el
número de recursos libres disponibles.
● Para las conexiones cliente-servidor OPC UA existe, de forma similar a otros tipos de
conexión, un límite superior "propio" para cada gama de CPU: ejemplo: máximo 64 para
servidores OPC UA y máximo 40 para el cliente OPC UA en la CPU 1518.
Existe la posibilidad de reducir el límite de conexiones posibles con el servidor con el
parámetro de CPU "Número máximo de sesiones OPC UA" en el área "OPC UA > Servidor
> Ajustes" . Con la CPU 1518, por ejemplo, el valor predeterminado es 20.
● Ejemplo de límites superiores propios para otros tipos de conexión concretos que impiden
el uso ilimitado del grupo de conexiones:
comunicación web con un máximo de 80 conexiones.
Podría haber otras limitaciones derivadas de la capacidad funcional de las diferentes
interfaces.
La siguiente figura muestra de forma simplificada cómo es posible, por ejemplo, una demanda
múltiple de conexiones de Open User Communication a costa de otras conexiones. En este
caso, la que "padece" las consecuencias es la comunicación cliente-servidor OPC UA. Del
mismo modo se muestra que en OPC UA el establecimiento de la conexión en dos etapas
provoca temporalmente una elevada necesidad de recursos.
28&

28&

23&8$

23&8$

5HVHUYHG

5HVHUYHG

Figura 1-12

Principio: Consumo temporal de recursos

Consejos y reglas para trabajar con conexiones OPC UA
Aquí encontrará de nuevo resumidos los consejos y las reglas de las explicaciones.
● Si está al límite en lo que se refiere al número de conexiones necesarias, conviene
establecer las conexiones cliente-servidor OPC UA una tras otra y "dilatadas" en el tiempo.
Si las conexiones de cliente-servidor OPC UA se establecen en intervalos reducidos, se
puede producir una escasez de recursos (véase la descripción anterior de TIME_WAIT).
● Dado que las conexiones de cliente-servidor OPC UA se establecen en 2 etapas y solo
utilizan una conexión adicional temporalmente, conviene establecer primero las
conexiones de cliente-servidor OPC UA y a continuación los otros tipos de conexión (HMI,
OUC, …). De ese modo, las conexiones de cliente-servidor OPC UA se pueden manejar
primero libremente desde el grupo de recursos para el establecimiento de la conexión.
● En la planificación de recursos para conexiones debe permanecer como mínimo un recurso
sin usar. Explicación: si todos los recursos de conexión están ocupados y se interrumpe
una conexión OPC UA, no podrá volver a establecerse. Motivo: temporalmente se
requieren 2 recursos de conexión para restablecer la conexión.

200

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Visualización de los recursos de conexión
Recursos de conexión en la ventana de inspección
Encontrará un resumen de los recursos de conexión reservados y disponibles del sistema de
automatización S7-1500 en las propiedades de la CPU, dentro de la ventana de inspección del
editor de hardware y de redes.

indicación de los recursos de conexión en STEP 7 (vista offline)
Al visualizar los recursos de conexión se distingue si se trata de la vista offline o de la vista
online. La figura siguiente muestra la visualización offline de los recursos de conexión
reservados y disponibles de una CPU S7-1500 con un CP y un CM:



①
②



Recursos de conexión específicos de la estación
Recursos de conexión específicos del módulo

Recursos de conexión específicos de la estación
Las columnas de los recursos de conexión específicos de la estación informan sobre los
recursos de conexión reservados y que puede utilizar dinámicamente la estación. En el
ejemplo, el sistema de automatización dispone como máximo de 256 recursos de conexión
específicos de la estación.
● 10 recursos de conexión reservados, 4 de los cuales ya se utilizan y 6 siguen disponibles.
Los 4 recursos asignados se utilizan para comunicación HMI:
● 246 recursos de conexión dinámicos, 26 de los cuales ya se utilizan y 220 siguen
disponibles.
Los recursos configurados se reparten del siguiente modo:
– 6 recursos para la comunicación HMI
– 7 recursos para la comunicación S7
– 13 recursos para Open User Communication

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

201

Configuración de dispositivos y redes
1.3 Configurar redes
El triángulo de advertencia de la columna de recursos dinámicos de la estación aparece
porque la suma del número máximo de recursos de conexión disponibles de CPU, CP y CM
(= 310 recursos de conexión) rebasa el límite de la estación de 256.
Nota
Rebase de los recursos de conexión disponibles
Si se sobrepasa el número de recursos de conexión específicos de una estación, STEP 7 lo
notifica con una advertencia. Si se agotan los recursos de conexión disponibles de la CPU, el
CP y el CM, debe utilizarse una CPU con un límite superior de recursos de conexión
disponibles específicos de la estación o bien debe reducirse el número de conexiones de
comunicación.
Recursos de conexión específicos del módulo
Las columnas de los recursos de conexión específicos del módulo informan sobre la
asignación de los recursos en las CPU, los CP y los CM de un sistema de automatización: La
visualización es granular por módulos y no por interfaces. En el ejemplo, la CPU pone a
disposición como máximo 128 recursos de conexión, 18 de los cuales ya se utilizan y 110
siguen disponibles:
Los recursos configurados se reparten del siguiente modo:
● 6 recursos para la comunicación HMI
● 4 recursos para la comunicación S7
● 8 recursos para Open User Communication
El CP pone a disposición 118 recursos, y el CM 64 recursos, de los cuales se utilizan 4 o 8.

202

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Visualización de los recursos de conexión en STEP 7 (vista online)
Si existe una conexión online con la CPU, en la ficha "Información de la conexión" del área
"Diagnóstico" de la ventana de inspección se ve también cuántos recursos se utilizan
actualmente en cada caso. La siguiente figura muestra la visualización online de los recursos
de conexión reservados, disponibles y utilizados de una CPU S7-1500:

Además de los recursos de conexión reservados y dinámicos de las conexiones configuradas,
la vista online de la tabla "Recursos de conexión" contiene también columnas con los recursos
de las conexiones programadas y activadas automáticamente que están ocupados en la
estación. Por tanto, en la vista online se muestran todos los recursos ocupados del sistema de
automatización, con independencia de cómo se haya activado la conexión. En la línea "Otra
comunicación" se muestran los recursos ocupados para comunicación con dispositivos de
terceros y comunicación vía routing de juegos de datos.
La tabla se actualiza de forma automática. Si existen incoherencias entre la configuración
hardware y la existente online, se emite el correspondiente aviso.
Nota
Si una conexión S7 enrutada pasa por una CPU, los recursos de conexión de la CPU
necesarios para ello no se muestran en la tabla de recursos de conexión.

Visualización de los recursos de conexión para HMI
En la comunicación HMI la ocupación de recursos de conexión en la CPU depende del
dispositivo HMI empleado y de las aplicaciones en las que se utilice dicho dispositivo HMI. Por
ejemplo, un Basic Panel requiere hasta dos recursos de conexión en la CPU para una conexión
HMI, y un Comfort Panel hasta tres recursos.
Puede consultarse información sobre la disponibilidad y ocupación de recursos para
conexiones HMI en la vista offline del dispositivo HMI (en "Propiedades > General > Recursos
de conexión" en la ventana de inspección).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

203

Configuración de dispositivos y redes
1.3 Configurar redes

En el área Recursos de conexión se muestra lo siguiente:
● Número de conexiones disponibles en HMI que están reservadas para la comunicación
HMI y la comunicación HTTP
● Número de recursos de conexión utilizados offline en HMI para la comunicación HMI y la
comunicación HTTP
Si se rebasa el número máximo de recursos de conexión disponibles para un dispositivo
HMI, STEP 7 emite el aviso correspondiente.
● "Número máximo de recursos PLC utilizados por conexión HMI": Este parámetro es un
factor que debe multiplicarse por el número de conexiones HMI utilizadas offline. El
producto da como resultado el número de recursos HMI ocupados por la CPU.
Si se rebasa el número máximo de recursos de conexión disponibles para un dispositivo HMI,
se emite el correspondiente aviso.

Visualización de los recursos de conexión en el servidor web
Los recursos de conexión no solo pueden visualizarse en STEP 7, sino también con un
navegador que muestre la página correspondiente del servidor web. Encontrará más
información acerca de la visualización de los recursos de conexión en el servidor web en el
manual de funciones del servidor web.

Ejemplo de cálculo de recursos de conexión
Introducción
Este ejemplo de la tabla que contiene la visualización de los recursos ilustra cómo se
componen las distintas entradas de la tabla.

204

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Requisitos
● 2 CPU 1516-3 PN/DP con un CP 1543-1 y un CM 1542-5 cada una, para ampliar la
capacidad funcional como interlocutor
● 1 sistema de PC WinCC RT Professional con CP 1616 onboard como interlocutor para
conexiones HMI
● Los dispositivos están conectados en red entre sí.

Creación de las conexiones
Después de crear y conectar en red los interlocutores (CPU, CP, CM, WinCC RT Professional)
en la vista de redes del editor de hardware y redes, proceda del siguiente modo:
1. En la vista de redes cambie al modo de conexión.
2. Cree las conexiones siguientes:
– Conexiones S7: 2 vía CPU, 21 vía CM
– Conexiones TCP: 2 vía CPU, 4 vía CM
– Conexión ISO: 6 vía CP
– ISO on TCP: 3 vía CPU, 4 vía CM
– Conexiones UDP: 4 vía CPU, 106 vía CP
– Conexiones HMI: 1 vía CPU, 2 vía CP

Resultado
En la visualización de los recursos de conexión se verán los recursos disponibles y los
recursos que son necesarios para las conexiones creadas.
En la figura siguiente se destacan los recursos disponibles para dispositivos y módulos:



①
②
③



Dependiendo de qué CPU se utilice, esta estación dispone de un máximo de 256 recursos. 10 recursos están
reservados para determinados tipos de conexión y 246 están disponibles dinámicamente.
La CPU proporciona 128 recursos de conexión, el CP y el CM 118 recursos adicionales cada uno.
Conjuntamente, la CPU, el CP y el CM proporcionan 128 + 118 + 118 = 364 recursos. Como a través de los
dispositivos y módulos se proporcionan más recursos de los que puede manejar como máximo la estación (256), se
muestra un símbolo de advertencia.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

205

Configuración de dispositivos y redes
1.3 Configurar redes
En la figura siguiente se destacan los recursos consumidos por las conexiones creadas:



①
②
③
④
⑤
⑥
⑦

206












Se trata de los recursos ocupados vía las conexiones HMI. En este ejemplo una conexión HMI ocupa 3 recursos.
Para toda la estación se necesitan 3 + 6 = 9 recursos de conexión para la comunicación HMI.
Hay 4 recursos reservados para la comunicación HMI.
Los 9 recursos necesarios para la comunicación HMI se distribuyen de la manera siguiente: Para los 4 primeros
recursos se emplean los que ya estaban reservados para la comunicación HMI. Los otros 5 recursos necesarios se
toman de los recursos dinámicos.
Se trata de los recursos ocupados vía las conexiones S7. Una conexión S7 consume 1 recurso de conexión. Para
toda la estación se necesitan 2 + 21 = 23 recursos de conexión.
No hay recursos reservados para la comunicación S7. Los 23 recursos necesarios proceden de los recursos dis‐
ponibles dinámicamente.
Se trata de los recursos de Open User Communication (para TCP, FDL, ISO, ISO on TCP y UDP). Para toda la
estación se necesitan 9 + 112 + 8 = 129 recursos de conexión.
No hay recursos reservados para la Open User Communication. Los 129 recursos necesarios proceden de los
recursos disponibles dinámicamente.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Cálculo de los recursos de conexión
A partir de los recursos disponibles y utilizados de cada dispositivo o módulo se calculan los
recursos que quedan libres y los utilizados en total:










①
②
③
④
⑤

Aquí se muestran todos los recursos necesarios para cada tipo de comunicación de la CPU. Se necesitan 3 recursos
para la comunicación HMI, 2 para la comunicación S7 y 9 para los tipos de conexión de Open User Communication.
Debajo de la lista de recursos necesarios para los distintos tipos de comunicación se encuentra el número total de
recursos necesarios. Para la CPU resultan 3 + 2 + 9 = 14 recursos necesarios.
El CP 1543-1 tiene 118 recursos de conexión disponibles. Si están ocupados, no pueden crearse otras conexiones
para el CP.
Para el CP 1543-1 se han ocupado 118 recursos vía las 2 conexiones HMI (3 recursos cada una = 6 recursos) y 112
vía las conexiones de comunicación abierta.
El CP 1543-1 no tiene recursos libres. No pueden crearse más conexiones para el CP 1543-1.

La ilustración también muestra los recursos libres y el total de recursos utilizados para el
conjunto de la estación:






①
②
③

Recursos empleados en toda la estación para cada tipo de comunicación, recursos reservados (configurados) y
recursos dinámicos. Los valores resultan de la suma de recursos utilizados en los dispositivos y módulos (CPU, CP,
CM).
Recursos empleados en toda la estación para todos los tipos de comunicación, recursos reservados (configurados)
y recursos dinámicos.
Número total de recursos reservados aún disponibles y de recursos dinámicos. Los valores se obtienen de restar al
número máximo de recursos configurables el número de recursos utilizados.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

207

Configuración de dispositivos y redes
1.3 Configurar redes

Coherencia de datos
Definición
Para la transferencia de datos es muy importante su coherencia, que debe tenerse en cuenta
a la hora de configurar una tarea de comunicación. Si esto no sucede pueden producirse fallos
de funcionamiento.
Un área de datos que no puede ser modificada por procesos concurrentes se denomina área
de datos coherente. Esto significa que un área de datos conexa cuyo volumen supere el
tamaño máximo del área de datos coherente puede estar compuesta en un momento dado en
parte por datos nuevos y en parte por datos antiguos.
Una incoherencia puede producirse cuando se interrumpe una instrucción de comunicación,
p. ej., por un OB de alarma de proceso de mayor prioridad. De este modo también se
interrumpe la transferencia del área de datos. Si el programa de usuario de este OB modifica
ahora los datos que todavía no ha procesado la instrucción de comunicación, los datos
transferidos proceden de diferentes instantes.
La figura siguiente muestra un área de datos más pequeña que el tamaño máximo del área de
datos coherente. En este caso, a la hora de transferir el área de datos se asegura que durante
el acceso a los datos no se producen interrupciones por parte del programa de usuario y, por
tanto, que los datos no se modifican.

5(&25'

UHDGHGDWRVGH
RULJHQ

UHDGHGDWRVGHGHVWLQR


①
②

El área de datos de origen es menor que el tamaño máximo del área de datos coherente (②).
La instrucción transfiere los datos de forma conexa al área de datos de destino.

Tamaño máximo del área de datos coherente
Figura 1-13
Transferencia coherente de datos

La figura siguiente muestra un área de datos más grande que el tamaño máximo del área de
datos coherente. En este caso existe la posibilidad de modificar los datos durante una
interrupción de la transferencia de datos. Se produce una interrupción, p. ej., cuando el área
de datos debe transferirse en varias partes. Si los datos se modifican durante la interrupción,
los datos transferidos provienen de instantes distintos.

208

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes


UHDGHGDWRVGHRULJHQHQ
HOLQVWDQWH7

UHDGHGDWRVGHGHVWLQR


UHDGHGDWRVGHRULJHQHQ
HOLQVWDQWH7

UHDGHGDWRVGHGHVWLQR



①
②

El área de datos de origen es mayor que el tamaño máximo del área de datos coherente (③). En el instante T1, la
instrucción transfiere del área de datos de origen al área de datos de destino únicamente el volumen de datos que
cabe en el área de datos coherente.
En el instante T2, la instrucción transfiere el resto del área de datos de origen al área de datos de destino. Después
de la transferencia, en el área de datos de destino hay datos de instantes distintos. Si los datos del área de datos de
origen han cambiado entretanto, es posible que se produzca una incoherencia.

③
Tamaño máximo del área de datos coherente
Figura 1-14
Transferencia de datos con mayor volumen que el área de coherencia máxima
Ejemplo de incoherencia

La figura siguiente muestra un ejemplo de la modificación de datos durante la transferencia. En
el área de datos de destino hay datos de instantes distintos.


(6$1$%

(6$1



(6%+$$

(6$1 $$


Figura 1-15

Ejemplo: modificación de datos durante la transferencia

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

209

Configuración de dispositivos y redes
1.3 Configurar redes

Coherencia de datos máxima del sistema para el S7‑1500:
No se producirá ninguna incoherencia si se respeta el tamaño máximo del sistema para los
datos coherentes. En el S7-1500 se copian los datos de comunicación de forma coherente en/
desde la memoria de usuario en bloques de como máximo 512 bytes durante el ciclo del
programa. Para las áreas de datos mayores no se garantiza la coherencia de datos. Si se
requiere una coherencia de datos definida, los datos de comunicación del programa de usuario
de la CPU no deben exceder los 512 bytes. A estas áreas de datos puede accederse de forma
coherente p. ej. desde un dispositivo HMI con lectura/escritura de variables.
Si debe transferirse de manera coherente un volumen de datos mayor que el tamaño máximo
específico del sistema, el propio usuario deberá velar por la coherencia de los datos en el
programa de usuario tomando las medidas adecuadas.

Asegurar la coherencia de datos
Uso de instrucciones para el acceso a datos comunes:
Si el programa de usuario contiene instrucciones de comunicación que acceden a datos
comunes, p. ej. TSEND/TRCV, el propio usuario puede coordinar el acceso a esa área de
datos, p. ej., con el parámetro "DONE". Por lo tanto, en el programa de usuario puede
garantizarse la coherencia de datos de las áreas de datos que se transfieren con una
instrucción de comunicación.
Nota
Medidas en el programa de usuario
Para conseguir que los datos sean coherentes existe la posibilidad de copiar los datos que
deben transferirse a un área de datos separada (p. ej. bloque de datos global). Mientras el
programa de usuario sigue trabajando con los datos originales, es posible transferir de forma
coherente los datos guardados en el área de datos separada utilizando la instrucción de
comunicación.
Para copiar utilice instrucciones que no puedan interrumpirse, como UMOVE_BLK o
UFILL_BLK. Dichas instrucciones garantizan la coherencia de datos hasta 16 KB.
Uso de instrucciones PUT/GET o Escribir/Leer vía comunicación HMI:
En la comunicación S7 con las instrucciones PUT/GET o Escribir/Leer vía comunicación HMI
debe tenerse en cuenta el tamaño de las áreas de datos coherentes ya durante la
programación o configuración. En el programa de usuario de un S7-1500 que actúa de servidor
no hay ninguna instrucción que pueda coordinar la transferencia de datos en el programa de
usuario. El S7-1500 actualiza los datos intercambiados mediante las instrucciones PUT/GET
en el tiempo de ejecución del programa de usuario. No hay ningún instante dentro del
procesamiento del programa de usuario cíclico en el que los datos se intercambien de forma
coherente. La longitud del área de datos que debe transmitirse debe tener menos de 512 bytes.

Información adicional
● También encontrará el número máximo de datos coherentes en los datos técnicos de los
manuales de producto de la CPU, del CM o del CP.
● Encontrará más información sobre la coherencia de datos en la descripción de las
instrucciones de la ayuda en pantalla de STEP 7.

210

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

1.3.2.2

Conexiones - significado y selección

Introducción a la configuración de conexiones
¿Para qué configurar conexiones?
Una conexión de comunicación o, simplemente, conexión define la asignación lógica de dos
interlocutores con el fin de ejecutar servicios de comunicación.
Las conexiones las puede configurar uno mismo o, si se cumplen ciertos requisitos, también
pueden configurarse por programa.
En este capítulo se explica cómo definir conexiones, qué particularidades hay que tener en
cuenta y qué instrucciones de comunicación se pueden utilizar en el programa de usuario.

Definición
Una conexión define lo siguiente:
● los interlocutores que intervienen
● el tipo de conexión (p. ej. conexión S7, ISO-on-TCP, ISO-Transport, FDL, UDP, de correo
electrónico o TCP)
● propiedades especiales como p. ej.
– el comportamiento de la instalación
Una conexión puede quedar establecida de forma permanente o puede establecerse y
deshacerse según sea necesario.
– la transmisión de avisos de estado operativo
● la vía de comunicación
– dentro de los dispositivos (CPU - CP)
– en la red (subredes / router)

Información importante para configurar conexiones
En la configuración de conexiones se asigna una identificación local unívoca por conexión, la
"ID local". En la parametrización de los bloques de comunicación sólo se necesita esta ID local.
La ID local está asignada unívocamente a las direcciones del interlocutor local y remoto.
Cuando un punto final de la conexión es una aplicación de una estación PC, se utiliza el
nombre de la conexión como "ID local" para la identificación de la conexión.
Después de abrir el proyecto se visualiza la tabla de conexiones de todo el proyecto. Si
desactiva la opción "Mostrar todas las conexiones" en el menú contextual de la tabla de
conexiones, a partir de entonces se mostrarán sólo las conexiones específicas de los objetos

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

211

Configuración de dispositivos y redes
1.3 Configurar redes
seleccionados. Las conexiones creadas para los objetos siguientes se pueden visualizar
aparte:
● Módulos programables que pueden ser punto final de una conexión
● Módulos de comunicación (CPs) que se utilizan en la vía de conexión
● Subredes
Las direcciones del interlocutor local y remoto están especificadas por la conexión de los
dispositivos en red y se asignan a las conexiones durante la configuración. Las siguientes
conexiones son excepciones:
● Conexión UDP libre
En la conexión UDP libre la dirección se indica en la interfaz de comunicación del programa
de usuario.
● Conexión programada
Nota
El término "conexión" también se utiliza en la comunicación SIMATIC con UDP. El motivo
es que, durante la configuración, los interlocutores se asignan entre sí de forma que se
"conectan" lógicamente. Realmente, con UDP no se establece ninguna conexión explícita
entre los interlocutores.

La conexión en red y la selección de la vía determinan el estado de configuración
Dependiendo de si los interlocutores existen y están conectados en el proyecto, los
parámetros de dirección de los puntos finales de la conexión pueden estar especificados por
completo o sólo parcialmente.
● Especificados por completo
– Las direcciones y parámetros de red del interlocutor local y remoto están definidos.
– La conexión está lista para funcionar tras cargar los parámetros de conexión en el
dispositivo.
● Sin especificar (parcialmente especificada)
Sólo está definido el interlocutor local. El interlocutor para el tipo de conexión seleccionado
no está conectado en red, o bien se encuentra fuera del proyecto, o bien no debe definirse
debido a un manejo especial.
Caso de aplicación:
– La configuración del hardware está incompleta, de forma que todavía no es posible
realizar la conexión en red completa de los dispositivos.
– Debe establecerse una disponibilidad de recepción para los interlocutores deseados (no
especificados).
La conexión está lista para funcionar de forma condicionada tras cargar los parámetros de
conexión en el dispositivo.

212

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Conexiones programadas
En determinados campos de aplicación es ventajoso no crear las conexiones de forma estática
a través de la configuración. Por eso, de forma alternativa existe la posibilidad de establecer
determinados tipos de conexión a través de una aplicación específica mediante un programa
y hacerlo así de forma dinámica si es necesario.

Características de la configuración de conexiones
La vista de redes es una plataforma clara para la configuración de conexiones entre
dispositivos configurados.

Funciones principales
● Configuración gráfica de conexiones en la vista de redes
Con unos pocos clics del ratón se establece una conexión gráficamente.
● Resaltar posibles interlocutores
Se selecciona el tipo de conexión y los posibles interlocutores se resaltan automáticamente.
● Búsqueda automática de vías de conexión
Se ordena la asignación automática de las mejores vías de conexión posibles o la selección
de vías de conexión alternativas.
● Aplicación automática de configuraciones
Si se configuran módulos posteriormente y se conectan en red, las conexiones ya
configuradas y soportadas por el módulo se asignan automáticamente.
● Selección cómoda de la visualización de conexiones
Si se selecciona un objeto en la vista de redes, p. ej. una subred o la interfaz de un módulo
apto para la comunicación, se muestra la correspondiente conexión configurada en una
tabla de conexiones.
● Consideración de los recursos disponibles
Mientras se necesiten recursos de conexión para un tipo de conexión, se tiene en cuenta
una determinada limitación al establecer conexiones. El número máximo de recursos de
conexión varía tanto con los tipos de dispositivo CPU como con los tipos de dispositivo CP.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

213

Configuración de dispositivos y redes
1.3 Configurar redes







①
②
③

Visualización de conexiones en la vista de redes
Tabla de conexiones
Ficha "Propiedades" de una conexión en la ventana de inspección

Consulte también
Vista general del diagnóstico de conexiones (Página 3660)

214

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Campos de aplicación de los tipos de conexión
Introducción
Los siguientes apartados ofrecen una breve panorámica de los tipos de conexión que se
pueden utilizar para la comunicación según el tipo de dispositivo y la finalidad de uso.

Información adicional
Para más información sobre las posibilidades de comunicación en SIMATIC y las finalidades
de uso de los tipos de conexión consulte el manual sobre las comunicaciones con SIMATIC.

Conexiones S7
Las conexiones S7 ofrecen, entre otras, las siguientes características:
● Tipo de conexión utilizable en todos los dispositivos S7;
● Utilizables en los siguientes tipos de subred: MPI, PROFIBUS, Industrial Ethernet;
● Si se utilizan los SFBs BSEND/BRCV: Transferencia segura de datos entre estaciones
SIMATIC S7-400/1500; p. ej. intercambio de contenidos de bloques de datos (hasta 64 KB);
● Con una CPU 317-2 PN/DP o con una CPU 31x y un CP también es posible la transferencia
segura de datos a S7-300, S7-400 y S7-1500 utilizando los FBs BSEND/BRCV;
● Si se utilizan los SFBs USEND/URCV: transmisión rápida y no segura de datos
independientemente de la ejecución temporal del interlocutor; p. ej. para avisos de
operación y de mantenimiento;
● Acuse de la transferencia de datos del interlocutor en el nivel 7 del modelo de referencia
ISO.

Conexión FDL
PROFIBUS FDL (Fieldbus Data Link) se identifica por las siguientes características:
● Transferencia de datos a un interlocutor (p. ej. SIMATIC S5 o PC) que soporte la
transmisión o recepción según la función SDA (Send Data with Acknowledge);
● La recepción de los datos se confirma con un acuse del servicio FDL del interlocutor;
● tipo de subred utilizable: PROFIBUS;
● Cumple la norma EN 50170 Vol.2 PROFIBUS;
● Puede asignarse al nivel 2 del modelo de referencia ISO;
● Interfaz en el programa de usuario S7: SEND/RECEIVE;
● Servicios FDL disponibles en el PC como funciones C.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

215

Configuración de dispositivos y redes
1.3 Configurar redes

Conexión de transporte ISO
La conexión de transporte ISO se identifica por las siguientes características:
● "Bloqueo de datos" apto para grandes cantidades de datos;
● Comunicación con un interlocutor (p. ej. SIMATIC S5 o PC) que soporte la transmisión o
recepción de datos según el transporte ISO.
● Tipo de subred utilizable: Industrial Ethernet;
● La recepción de los datos se confirma con un acuse del servicio de transporte ISO del
interlocutor;
● Interfaz en el programa de usuario S7: SEND/RECEIVE y FETCH/WRITE;
● El servicio de transporte ISO (ISO 8073 class 4) corresponde al nivel 4 del modelo de
referencia ISO;
● Servicios de transporte ISO disponibles en el PC como funciones C.

Conexión ISO-on-TCP
La conexión ISO-on-TCP se identifica por las siguientes características:
● Corresponde al estándar TCP/IP (Transmission Control Protocol/Internet Protocol) con la
ampliación RFC 1006 según el nivel 4 del modelo de referencia ISO. RFC 1006 describe
cómo se pueden reproducir en TCP los servicios del nivel 4 ISO;
● Comunicación con un interlocutor (p. ej. PC o sistema de terceros) que soporte la
transmisión o recepción de datos según ISO-on-TCP.
● Tipo de subred utilizable: Industrial Ethernet;
● La recepción de los datos se confirma con un acuse;
● Interfaz en el programa de usuario STEP 7: SEND/RECEIVE y FETCH/WRITE;
● Servicios ISO-on-TCP disponibles en el PC como funciones C.

Conexión TCP
La conexión TCP se identifica por las siguientes características:
● Corresponde al estándar TCP/IP (Transmission Control Protocol/Internet Protocol);
● Permite la comunicación con un interlocutor (p. ej., un PC o un sistema de terceros) que
soporte la transmisión o recepción de datos según TCP/IP;
● Tipo de subred utilizable: Industrial Ethernet;
● Interfaz en el programa de usuario STEP 7: SEND/RECEIVE y FETCH/WRITE;
● Normalmente es posible utilizar la implementación TCP/IP del sistema operativo del PC.

216

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Conexión UDP
La conexión UDP (User Datagramm Protocol) se identifica por las siguientes características:
● Tipo de subred utilizable: Industrial Ethernet (protocolo TCP/IP);
● Transferencia no segura de bloques de datos relacionados entre dos dispositivos;
● Interfaz en el programa de usuario S7: SEND/RECEIVE.

Conexión de correo electrónico
La conexión de correo electrónico se identifica por las siguientes características:
● Tipo de subred utilizable: Industrial Ethernet (protocolo TCP/IP);
● Permite p. ej. la transmisión de datos de proceso de bloques de datos por correo electrónico
a través de un CP con funcionalidad IT (IT-CP);
● Con la conexión de correo electrónico se establece el servidor de correo a través del cual
se entregan todos los correos electrónicos enviados por un IT-CP.

Conexión FTP (conexión TCP configurada de forma especial)
La conexión FTP se utiliza para la ejecución de secuencias de petición FTP.
Con las funciones de transferencia de archivos (FTP) los CPs con funcionalidad IT ofrecen la
posibilidad de transferir archivos desde o hacia dispositivos S7.

Conexión HMI
AUTOHOTSPOT

Selección de los tipos de conexión
Selección del tipo de conexión
El tipo de conexión que se selecciona depende, aparte de las propiedades de transferencia, de
la subred y del protocolo de transferencia a través del cual se establece la conexión. Además,
el tipo de dispositivo limita los tipos de conexión en los correspondientes puntos finales.
Las instrucciones o servicios que se utilizan en la interfaz (puntos finales de la conexión)
dependen del tipo de conexión y del tipo de dispositivo.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

217

Configuración de dispositivos y redes
1.3 Configurar redes
La siguiente tabla muestra estas dependencias:
Tipo de conexión

Tipo de subred / pro‐
tocolo

Tipo de dispositivo: conexión entre SIMA‐
TIC ...

Interfaz

Conexión S7

MPI,
PROFIBUS,
Industrial Ethernet

S7 - S7, S7 - PG/PC,
S7 - PG/PC con WinCC, PG/PC - PG/PC

Instrucciones para S7:
USEND, URCV,
BSEND, BRCV, GET,
PUT, START, STOP,
RESUME, STATUS,
USTATUS

Interlocutor S7 en otro proyecto (S7,
PG/PC con WinCC)

PG/PC: servicios OPC
o interfaces de progra‐
mación
Conexión FDL

PROFIBUS
(protocolo FDL)

S7 - S7, S7 - S5, S7 - PC/PG, S7 - dispo‐
sitivo de terceros, PG/PC - PG/PC
Interlocutor S7 en otro proyecto (S7, S5,
PG/PC, dispositivo de terceros)

Instrucciones para S7:
AG_SEND,
AG_RECV,
AG_LSEND,
AG_LRECV
PG/PC: servicios OPC

Conexión de transporte
ISO

Industrial Ethernet
(protocolo
de transporte ISO)

S7 - S7, S7 - S5, S7 - PC/PG, S7 - dispo‐
sitivo de terceros, PG/PC - PG/PC
S7 - sin especificar

Instrucciones para S7:
AG_SEND,
AG_RECV,

AG_LSEND,
Interlocutor S7 en otro proyecto (S7, S5,
PG/PC, dispositivo de terceros, sin especi‐ AG_LRECV
AG_LOCK
ficar)
AG_UNLOCK
PG/PC: servicios OPC
Conexión
ISO-on-TCP

Industrial Ethernet
(protocolo TCP/IP)

S7 - S7, S7 - S5,
S7 - PC/PG, S7 - dispositivo de terceros,
PG/PC - PG/PC,
S7 - sin especificar

Instrucciones para S7:
AG_SEND,
AG_RECV,

AG_LSEND,
AG_LRECV
Interlocutor S7 en otro proyecto (S7, S5,
PG/PC, dispositivo de terceros, sin especi‐ AG_LOCK
ficar)
AG_UNLOCK
PG/PC: servicios OPC
Conexión TCP

Industrial Ethernet
(protocolo TCP/IP)

Instrucciones para S7:
AG_SEND*,
AG_RECV*,

S7 - S7, S7 - S5,
S7 - PC/PG, PG/PC - PG/PC
S7 - dispositivo de terceros,
S7 - sin especificar

AG_LSEND**,
AG_LRECV**
Interlocutor S7 en otro proyecto (S7, S5,
PG/PC, dispositivo de terceros, sin especi‐ AG_LOCK
ficar)
AG_UNLOCK
PG/PC: servicios OPC
Conexión UDP

Industrial Ethernet
(protocolo TCP/IP)

S7 - S7, S7 - S5, S7 - PC/PG, S7 - dispo‐
sitivo de terceros, S7 - sin especificar

Instrucciones para S7:
AG_SEND,
AG_RECV,

Interlocutor S7 en otro proyecto (S7, S5,
PG/PC, dispositivo de terceros, sin especi‐ AG_LSEND,
ficar)
AG_LRECV

218

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Tipo de conexión

Tipo de subred / pro‐
tocolo

Tipo de dispositivo: conexión entre SIMA‐
TIC ...

Interfaz

Conexión de correo electró‐
nico

Industrial Ethernet
(protocolo TCP/IP)

S7 - sin especificar (S7 - servidor de correo
electrónico),

Instrucciones para S7:
AG_SEND,

S7 - PC/PG (S7 - servidor de correo elec‐
trónico)

AG_LSEND

S7 - sin especificar

Instrucciones para S7:
FTP_CONNECT,
FTP_STORE, FTP_RE‐
TRIEVE, FTP_DELE‐
TE, FTP_QUIT

Conexión FTP (conexión
TCP configurada de forma
especial)

Industrial Ethernet
(protocolo TCP/IP)

Conexión a dispositivos Broadcast y Multicast
Nota
Para tipos de conexión especiales existe la posibilidad de no sólo seleccionar un único
interlocutor, sino varios (dispositivos Broadcast y Multicast). Los interlocutores "Con todos los
dispositivos Broadcast" o "...Multicast" pueden seleccionarse en el cuadro de diálogo para la
introducción de una nueva conexión.
● Es posible establecer una conexión con "todos los dispositivos Broadcast" (transmisión
simultánea a todos los receptores Broadcast) para los tipos de conexión FDL y UDP.
● Es posible establecer una conexión con "todos los dispositivos Multicast" (transmisión
simultánea a varios dispositivos) para los tipos de conexión FDL y UDP.

Selección de los tipos de conexión
Selección del tipo de conexión
Según la tarea de automatización de que se trate, elija un servicio de comunicación u otro. La
selección del servicio de comunicación influye en lo siguiente:
● las funciones disponibles
● el momento de establecimiento de la conexión
● las actividades que han de ejecutarse (p. ej. configuración de conexiones, programación de
instrucciones)
La tabla siguiente ofrece un resumen de los servicios de comunicación disponibles.
Servicio de comunicación

funcionalidad

Vía interfaz:
PN

DP

serie

Comunicación PG

Para puesta en marcha, test, diagnóstico

X

X

-

Comunicación HMI

Para manejo y visualización

X

X

-

Comunicación E/S

Intercambio de datos, p. ej. entre:

X

X

-

● controladores IO y dispositivos IO
● maestro DP y esclavo DP

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

219

Configuración de dispositivos y redes
1.3 Configurar redes
Servicio de comunicación

funcionalidad

Vía interfaz:
PN

DP

serie

X

X

-

X

-

-

X

-

-

X

-

-

X

-

-

Comunicación abierta vía correo electró‐ Intercambio de datos vía correo electrónico
nico
Solo mediante programa de usuario: instrucción
TMAIL_C

X

-

-

Comunicación abierta vía FTP (solo CPs
con interfaz PN)

X

-

-

-

X

-

Comunicación S7

Intercambio de datos de cliente a servidor o de clien‐
te a cliente Requiere configuración de conexiones
Mediante instrucciones PUT/GET, BSEND/BRCV o
USEND/URCV

Comunicación abierta vía TCP/IP

Intercambio de datos vía PROFINET con protocolo
TCP/IP
Con configuración de conexiones: instrucciones
TSEND_C/TRCV_C o TSEND/TRCV
Solo mediante programa de usuario: instrucciones
TCON, TSEND, T_RCV, T_DISCON o TSEND_C y
TRCV_C

Comunicación abierta vía ISO on TCP

Intercambio de datos vía PROFINET con protocolo
ISO on TCP
Con configuración de conexiones: instrucciones
TSEND_C/TRCV_C o TSEND/TRCV
Solo mediante programa de usuario: instrucciones
TCON, TSEND, T_RCV, T_DISCON o TSEND_C y
TRCV_C

Comunicación abierta vía UDP

Intercambio de datos vía PROFINET con protocolo
UDP
Con configuración de conexiones: instrucciones
TSEND_C/TRCV_C o TSEND/TRCV
Solo mediante programa de usuario: instrucciones
TCON, TSEND, T_RCV, T_DISCON o TSEND_C y
TRCV_C

Comunicación abierta vía ISO (solo CPs
con interfaz PN)

Intercambio de datos vía PROFINET con protocolo
ISO
Con configuración de conexiones: instrucciones
TSEND_C/TRCV_C o TSEND/TRCV
Solo mediante programa de usuario: instrucciones
TCON, TSEND, T_RCV, T_DISCON o TSEND_C y
TRCV_C

Intercambio de datos vía FTP (File Transfer Protocol)
Solo mediante programa de usuario: instrucción
FTP_CMD

Comunicación abierta vía FDL (solo CMs Intercambio de datos vía PROFIBUS con protocolo
con interfaz DP)
FDL
Con configuración de conexiones: instrucciones
TSEND_C/TRCV_C o TSEND/TRCV
Solo mediante programa de usuario: instrucciones
TCON, TSEND, T_RCV, T_DISCON o TSEND_C y
TRCV_C

220

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Servicio de comunicación
Acoplamiento punto a punto

funcionalidad
Intercambio de datos punto a punto con protocolo
Freeport, 3964 (R), USS o Modbus

Vía interfaz:
PN

DP

serie

-

-

X

Mediante instrucciones SEND_P2P/RCV_P2P o
MB_COMM_LOAD, MB_MASTER , MB_SLAVE
Routing S7

Intercambio de datos fuera de los límites de red, p. ej.
para parametrización, test y diagnóstico

X

X

-

Routing de registros

Ampliación del routing S7, p. ej. para parametriza‐
ción y diagnóstico de dispositivos de campo en PRO‐
FIBUS vía un sistema de ingeniería en una interfaz
PROFINET

X

X

-

Servidor web

Intercambio de datos vía Internet, p. ej. para diag‐
nóstico

X

-

-

SNMP (Simple Network Management
Protocol)

Intercambio de datos vía protocolo estándar SNMP,
para diagnóstico y parametrización de redes

X

-

-

Sincronización horaria

Vía NTP (Network Time Protocol); la CPU es cliente

X

-

-

La CPU es maestro o esclavo horario

-

X

-

Conexión a dispositivos Broadcast y Multicast
Nota
Para tipos de conexión especiales existe la posibilidad de seleccionar, no un único interlocutor,
sino varios (dispositivos Broadcast y Multicast). Los interlocutores "Con todos los dispositivos
Broadcast" o "...Multicast" pueden seleccionarse en el cuadro de diálogo para la introducción
de una conexión nueva.
● Es posible establecer una conexión con "todos los dispositivos Broadcast" (transmisión
simultánea a todos los receptores Broadcast) para los tipos de conexión FDL y UDP.
● Es posible establecer una conexión con "todos los dispositivos Multicast" (transmisión
simultánea a varios dispositivos) para los tipos de conexión FDL y UDP.

Instrucciones para tareas de comunicación
Interfaz del programa de usuario
Para la interfaz de comunicación del programa de usuario de SIMATIC S7-300/400/1500
existen instrucciones especiales. Aquí se presenta un resumen de las instrucciones para cada
uno de los tipos de conexión.
Para S7-1500 se emplean las instrucciones PUT/GET. Para las instrucciones de S7-300/400,
véanse las tablas siguientes.

Instrucciones para conexiones S7
Los bloques de función de sistema asignados a las instrucciones están integrados en las CPUs
de S7-400.
Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

221

Configuración de dispositivos y redes
1.3 Configurar redes
En las CPUs y los CPs más recientes para S7-300, existe la posibilidad de operar activamente
(es decir, como cliente) la comunicación S7 a través de la interfaz del CP. Las instrucciones
tienen el mismo nombre que los SFBs de la S7-400, pero tienen que llamarse cíclicamente en
el programa de usuario de la CPU S7-300.
El CP tiene que soportar la función de cliente para comunicación S7.
Una CPU S7-300 con interfaz PROFINET integrada se puede configurar también como cliente
para la comunicación S7. Se utilizan los mismos bloques que el caso mencionado
anteriormente para S7-300 con CP. La funcionalidad de cliente sólo está disponible en la
interfaz PROFINET.
Nombre

Descripción breve

USEND

Intercambio de datos no coordinado a través de un SFB de transmisión y recepción.

URCV

Longitud máx. SFB 8/9: 440 bytes divididos en 4x100 bytes.
Longitud máx. FB 8/9: 160 bytes.

BSEND

Intercambio de bloques de datos de longitud variable entre un SFB de transmisión y un SFB de recepción.

BRCV

Longitud máx. SFB 12/13: 64 Kbytes
Longitud máx. FB 12/13: 32 Kbytes

GET

Leer datos de un dispositivo remoto
Longitud máx. SFB 14: 400 bytes divididos en 4x100 bytes
Longitud máx. FB 14: 160

PUT

Escribir datos en un dispositivo remoto
Longitud máx. SFB 15: 400 bytes divididos en 4x100 bytes
Longitud máx. FB 15: 160

START

Ejecutar un rearranque completo (en caliente) en un dispositivo remoto

STOP

Poner un dispositivo remoto en el estado "STOP"

RESUME

Ejecutar un rearranque en un dispositivo remoto

STATUS

Consulta selectiva del estado de un dispositivo remoto

USTATUS

Recepción de avisos de estado de dispositivos remotos

CONTROL

Consultar el estado de la conexión perteneciente a una instancia SFB

C_CNTRL

Consultar el estado de una conexión (para CPUs S7-300)

Instrucciones para la comunicación S7

Instrucciones para conexiones punto a punto
Para el tipo de conexión punto a punto se pueden utilizar los SFBs BSEND, BRCV, GET, PUT
y STATUS (véase tabla superior).
Además se puede utilizar el SFB PRINT:
Nombre

Descripción breve

PRINT

Enviar datos a una impresora

222

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Instrucciones para conexión FDL, ISO-on-TCP, UDP y TCP, así como para conexión de correo
electrónico
Nombre

Descripción breve

AG_SEND

Envía datos al interlocutor a través de una conexión configurada (en CPs más antiguos y en CPs para
S7-400 es aplicable la limitación siguiente para este FC: <= 240 bytes).

AG_RECV

Recibe datos del interlocutor a través de una conexión configurada (en CPs más antiguos y en CPs
para S7-400 es aplicable para este FC la limitación: <= 240 bytes y no correo electrónico).

AG_LSEND

Envía datos al interlocutor a través de una conexión configurada.

AG_LRECV

Recibe datos del interlocutor a través de una conexión configurada (no correo electrónico).

AG_LOCK

Bloqueo del acceso externo a los datos con FETCH/WRITE (no en UPD, correo electrónico).

AG_UNLOCK

Habilitación del acceso externo a los datos con FETCH/WRITE (no en UPD, correo electrónico).

AG_CNTRL

Diagnosticar conexiones con el programa de usuario.

AUTOHOTSPOT
AUTOHOTSPOT

Instrucciones para servicios FTP mediante conexiones TCP (conexión FTP)
Nombre

Descripción breve

FTP_CONNECT

Establecer conexión FTP

FTP_STORE

Transferir bloque de datos (File DB) del cliente FTP al servidor FTP.

FTP_RETRIEVE

Transferir archivo del servidor FTP al cliente FTP.

FTP_DELETE

Borrar archivo en el servidor FTP.

FTP_QUIT

Deshacer la conexión FTP designada mediante la ID.

AUTOHOTSPOT

Instrucciones para servicios de comunicación abiertos y programados con conexión ISO-on-TCP, UDP
y TCP, así como conexión de correo electrónico a través de CPs
Nombre

Descripción breve

IP_CONFIG

Configurar conexiones e IP del CP con control por programa.

AUTOHOTSPOT

Instrucciones para servicios de comunicación abiertos y programados (Open User Communication) con
conexión ISO-on-TCP, UDP y TCP a través de CPU o CP*)
*) Observación: La comunicación a través de CP con estas instrucciones sólo es posible
mediante ISO-on-TCP.
Nombre

Descripción breve

TCON

Establecimiento de la conexión

TDISCON

Desconexión

TSEND

Envío de datos

TRCV

Recibir datos

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

223

Configuración de dispositivos y redes
1.3 Configurar redes
Nombre

Descripción breve

TUSEND

Envío de datos; protocolo UDP orientado a la no-conexión según RFC 768

TURCV

Recepción de datos; protocolo UDP orientado a la no-conexión según RFC 768

AUTOHOTSPOT

Conexiones a través de CPs
Volumen de datos y recursos disponibles
El número de conexiones soportadas por el correspondiente CP se puede consultar en el
manual de producto adjunto con cada CP. Añadiendo más CPs se aumenta el número de
conexiones por dispositivo.
Si en un dispositivo hay montados varios CPs, al sobrepasar este límite se cambia
automáticamente al siguiente CP. En caso necesario, asigne selectivamente las conexiones a
través de la elección de vía.

CP Ethernet
El CP Ethernet puede transferir a través de una conexión las siguientes cantidades de datos
por petición:
ISO-Transport

ISO-on-TCP

TCP

UDP

Enviar

8192 bytes

8192 bytes

8192 bytes

2048 bytes

Recibir

8192 bytes

8192 bytes

8192 bytes

2048 bytes

Nota
Los CPs actuales soportan la transferencia de datos > 240 bytes.
Los CPs con una versión más antigua soportan la transferencia de datos con una longitud de
hasta 240 bytes.
Tenga en cuenta las indicaciones del manual de producto del CP Ethernet.

Tareas del CP Ethernet en el modo online
El CP Ethernet adopta las siguientes tareas durante la transferencia de datos a través de una
conexión:
● Recibir
Recepción de datos de Ethernet y transmisión al área de datos de usuario de la CPU.
● Enviar
Aceptación de datos del área de datos de usuario de la CPU y transmisión de los datos a
través de Ethernet.
El establecimiento de la conexión se realiza automáticamente en cuanto se puede acceder al
interlocutor.

224

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
En una conexión UDP/FDL libre se añade:
● Al recibir
Introducción del remitente que ha enviado el mensaje en la cabecera de la petición.
● Al enviar
Evaluación de la cabecera de la petición y direccionamiento del interlocutor.

CP PROFIBUS
El CP PROFIBUS puede transferir a través de una conexión las siguientes cantidades de datos
por petición:
Tipo de conexión
FDL

Especificada

Sin especificar acceso libre a ni‐
vel 2

Broadcast

Multicast

Enviar

240 bytes

236 bytes 1)

236 bytes 1)

236 bytes 1)

Recibir

240 bytes

236 bytes 1)

236 bytes 1)

236 bytes 1)

1) La cabecera de la petición ocupa 4 bytes adicionales además de los datos de usuario nombrados

Tareas del CP PROFIBUS en el modo online
El CP PROFIBUS adopta las siguientes tareas para ejecutar la transferencia de datos a través
de una conexión FDL:
● En conexiones especificadas
– Recibir
Recepción de datos de PROFIBUS y transmisión al área de datos de usuario de la CPU.
– Enviar
Aceptación de datos del área de datos de usuario de la CPU y transmisión de los datos
a través de PROFIBUS.
● En conexiones sin especificar adicionalmente
– Al recibir
Introducción del remitente y del servicio FDL en la cabecera de la petición.
– Al enviar
Evaluación de la cabecera de la petición y direccionamiento del interlocutor; ejecución
del servicio FDL seleccionado.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

225

Configuración de dispositivos y redes
1.3 Configurar redes

Conexiones con estaciones PC
Puntos finales de la conexión de una estación PC
En el caso de estaciones PC, configure las conexiones con uno de los siguientes componentes
como punto final:
● Servidor OPC como prestador de servicios de comunicación central
Según el CP disponible, pueden utilizarse los siguientes tipos de conexión:
– Conexión S7
– Conexión ISO
– Conexión ISO-on-TCP
– Conexión TCP
– Conexión FDL
● Aplicación estándar
Con el tipo de conexión S7 es posible realizar la comunicación a través de Ind. Ethernet o
PROFIBUS según el CP disponible.
Nota
CPU 1515SP PC como router para conexiones S7
Si se asigna la interfaz "PROFINET onboard [X2]" de la CPU 1515SP PC a la estación
SIMATIC PC, es posible utilizar la CPU 1515SP PC como router para conexiones S7. Con el
ajuste "Ninguna aplicación u otra aplicación Windows" en la interfaz CP "PROFINET onboard
[X2]" no es posible utilizar la CPU 1515SP PC como router para conexiones S7 enrutadas.
Una conexión S7 existente y enrutada por la CPU 1515SP PC queda invalidada cuando la
asignación de la interfaz de la CPU 1515SP PC cambia de "Estación PC SIMATIC" a "Ninguna
aplicación u otra aplicación Windows". Puesto que ahora el PLC ya no se encarga de enrutar
esta conexión, al compilar la CPU 1515SP PC no aparece ninguna indicación de que la
conexión no es válida. La conexión S7 enrutada e invalidada no se muestra hasta que se
compilan los puntos finales de la conexión.
Las interfaces necesarias para conexiones S7 enrutadas tienen que permanecer asignadas
explícitamente en la CPU 1515SP PC . La asignación de la interfaz de la CPU 1515SP PC se
edita en las propiedades, en "PROFINET onboard [X2] > Asignación de interfaz".

Particularidades de la configuración de conexiones con servidor OPC
En conexiones con OPC como punto final, generalmente se pueden configurar más
conexiones de las que el CP utilizado en la estación PC puede operar en un determinado
momento.
Esto está relacionado con el hecho de que en las propiedades de conexión se diferencia entre
"mantener de forma permanente" y "establecer a petición".
Por consiguiente, el número de conexiones con la propiedad "mantener de forma permanente"
no puede sobrepasar el número máximo de recursos de conexión del CP. Si fuese posible
establecer más conexiones a petición, deben mantenerse libres los correspondientes recursos
de conexión del CP. Por ello, con la propiedad "mantener de forma permanente" configure un

226

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
menor número de conexiones de las admitidas por el número máximo de recursos de conexión
del CP.
Si es necesario, aparece una advertencia al compilar la configuración de conexiones.

Información adicional
Comunicación industrial con la PG/el PC banda 1 en la ID del artículo: 42783968 (http://
support.automation.siemens.com/WW/view/es/42783968)
Comunicación industrial con la PG/el PC banda 2 en la ID del artículo: 42783660 (http://
support.automation.siemens.com/WW/view/es/42783660)
Puesta en marcha de estaciones PC, manual en la ID del artículo: 13542666 (http://
support.automation.siemens.com/WW/view/es/13542666)

Conexiones no especificadas
Conexiones no especificadas en Industrial Ethernet
Las conexiones con un dispositivo aún desconocido (p. ej., un dispositivo de diagnóstico) se
configuran como conexiones "sin especificar". Una conexión no especificada se puede utilizar
de diferentes maneras, como se explica a continuación con una conexión ISO-on-TCP a modo
de ejemplo; el procedimiento que se debe usar con las conexiones ISO-Transport y con las
conexiones TCP es equivalente.
● Declaración de disponibilidad para la comunicación: establecimiento de conexión pasivo
El establecimiento de la conexión debe ajustarse como "pasivo".
En tal caso, para la configuración de la dirección en una conexión ISO-on-TCP rige lo
siguiente:
la dirección IP remota y el TSAP remoto están vacíos, es decir, son irrelevantes para el CP.
Por lo tanto, al establecer la conexión se aceptan todos los interlocutores (interlocutor =
nombre de la conexión que direcciona el CP con dirección IP correcta y TSAP).
También existe la posibilidad de establecer una especificación parcial, es decir, se autoriza
la comunicación con un interlocutor cualquiera que coincida en el TSAP especificado.
● Conexión con una estación concreta de un proyecto cualquiera
En tal caso, para la configuración de la dirección en una conexión ISO-on-TCP rige lo
siguiente:
Es posible indicar la dirección IP remota y el puerto para una estación de destino
cualquiera. La estación de destino puede encontrarse dentro o fuera del proyecto STEP 7
actual.
Utilice esta variante si no ha creado la estación interlocutora en el proyecto actual.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

227

Configuración de dispositivos y redes
1.3 Configurar redes
● Conexión sin especificación del puerto
Las conexiones TCP no se especifican en los casos siguientes:
– El puerto local no se indica (establecimiento activo de la conexión).
– El puerto remoto no se indica (establecimiento no activo de la conexión).
● Direccionamiento IP a través de DHCP
Si selecciona la opción de direccionamiento IP a través de DHCP, primeramente no se
puede crear ninguna conexión completamente especificada en el proyecto, ya que se
desconoce la dirección IP local. Por consiguiente, se debe seleccionar el tipo de conexión
"sin especificar" sin establecimiento de conexión activo.
La tabla siguiente resume las distintas posibilidades de ajuste de los parámetros de dirección
"remotos":
Significado para el estableci‐
miento de la conexión

Dirección IP / dirección
MAC (remota)

TSAP / puerto (remoto)

Establecimiento activo de la conexión

desde un interlocutor cual‐
quiera

vacía

vacía

no

desde un interlocutor cual‐
quiera a través de un TSAP
determinado

vacía

especificado

no

hacia o desde un interlocutor
determinado

especificada

especificada

sí
El puerto local puede quedar sin es‐
pecificar (pero no necesariamente).

No especificada

no

La conexión UDP libre representa otra variante. En este tipo de conexión, la dirección del
interlocutor queda sin especificar durante la configuración. Los dispositivos interlocutores se
determinan mediante la indicación de direcciones en la petición de comunicación del programa
de usuario.

Conexiones no especificadas en PROFIBUS
Una conexión FDL no especificada con acceso libre Layer 2 permite el direccionamiento del
interlocutor controlado por el programa y la comunicación entre dos dispositivos de
PROFIBUS con las siguientes propiedades:
El dispositivo local ha sido fijado mediante configuración. El programa de usuario registra el
dispositivo remoto en el encabezado de la petición del búfer de peticiones al llamar la
instrucción AG_SEND. De esta forma es posible acceder a todos los dispositivos de
PROFIBUS (direcciones PROFIBUS de 0 a 126).

Información adicional
Seguidamente encontrará más información al respecto en los capítulos dedicados a las
conexiones.
Conexión UDP libre (Página 289)
Conexión FDL no especificada (acceso libre Layer 2) (Página 298)

228

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Conexiones programadas a través de CP
Campo de aplicación
En determinados campos de aplicación no conviene crear las conexiones ni la configuración
IP del CP con la configuración, sino con una aplicación específica controlada por programa.
Existe la posibilidad de configurar libremente las conexiones mediante un programa a través
de los CPs Industrial Ethernet. Deben tenerse en cuenta las características funcionales del tipo
de CP utilizado.
Un caso de aplicación típico es p. ej. el de los fabricantes de máquinas en serie. Para ofrecer
a sus clientes una interfaz de usuario lo más cómoda posible, estos fabricantes adaptan los
servicios de comunicación a las correspondientes peticiones de mando. El usuario final no
necesita conocimientos sobre la configuración de conexiones.
Para estas aplicaciones se dispone de la instrucción IP_CONFIG, que permite la transferencia
flexible de bloques de datos con datos de configuración a un CP Ethernet.

Interacción de programación y configuración
Las conexiones se configuran en general o a través del programa de usuario durante el tiempo
de ejecución del dispositivo S7. Dentro de un CP no es posible mezclar ambas variantes.

Principio
La instrucción IP_CONFIG del programa de usuario transfiere al CP los datos de configuración
para las conexiones.
El DB de configuración se puede cargar así en cualquier momento en el CP. Las conexiones
y datos de configuración previos (dirección IP, máscara de subred, router predeterminado,
servidor horario NTP y otros parámetros) se sobrescriben.
El CP Ethernet reconoce mediante los datos de configuración que las conexiones deben
establecerse a través del programa de usuario.

Recursos disponibles
La instrucción IP_CONFIG admite un máximo de 64 conexiones. Sin embargo, es decisivo el
número máximo de conexiones que soporta el tipo de CP utilizado.

Particularidades/restricciones
● Comprobación de coherencia sólo con una conexión configurada
La configuración de conexiones está enlazada con comprobaciones de coherencia que no
son posibles durante la configuración programada o lo son de forma limitada.
● Configuración de conexiones necesaria en el interlocutor
En la configuración de conexiones especificadas se crea implícitamente la conexión para
el interlocutor. Esto no es posible en el caso de una configuración programada. En este
caso, tienen que configurarse para los interlocutores las correspondientes conexiones
coherentes.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

229

Configuración de dispositivos y redes
1.3 Configurar redes
● Configuración de la protección de acceso IP
Mediante la protección de acceso IP existe la posibilidad de limitar la comunicación a través
del CP del dispositivo S7 local a interlocutores con direcciones IP muy concretas. Esta
parametrización también es válida para conexiones programadas.
● Se soporta DHCP/DNS
En la configuración programada, el direccionamiento IP también es posible a través de
DHCP/DNS.

Conexiones con Open User Communication vía CPU y CP
Open User Communication vía Industrial Ethernet: conexiones programadas
La Open User Communication ofrece servicios para Industrial Ethernet que se pueden utilizar
en el programa de usuario mediante la interfaz de instrucciones. Las conexiones se establecen
por medio de la interfaz de instrucciones en el programa de usuario; no es necesario configurar
las conexiones.

Servicios a través de la interfaz de la CPU
Con S7-1500, para el intercambio de datos a través de la interfaz Ethernet integrada de una
CPU se dispone de los servicios siguientes de Open User Communication:
● TCP según RFC 793
● ISO on TCP según RFC 1006
● UDP según RFC 768 (broadcast o singlecast; no se soporta multicast)

Servicios a través de la interfaz del CP
Con S7-300/400/1500, para el intercambio de datos a través de la interfaz Ethernet de un CP
se dispone de los servicios siguientes de Open User Communication:
● TCP según RFC 793
● ISO según RFC 905
● ISO on TCP según RFC 1006
● UDP según RFC 768 (broadcast o singlecast; no se soporta multicast)

230

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

1.3.2.3

Configuración de conexiones

Crear una conexión: sinopsis
Alternativas para crear una conexión
Existen las posibilidades siguientes para crear una conexión en la vista de redes:
● Configuración gráfica de las conexiones
Trace una línea de conexión con el interlocutor o asigne una conexión nueva al interlocutor
seleccionado previamente. Es una manera sencilla de crear conexiones individuales en la
vista de redes.
Las interconexiones que faltan se agregan automáticamente o a través de cuadros de
diálogo.
● Configuración de conexiones a través de cuadros de diálogo
Seleccionando el interlocutor en una lista. Si se desea configurar un número mayor de
conexiones, este procedimiento es más adecuado que el procedimiento gráfico.
Los diferentes pasos que deben seguirse se explican en los capítulos siguientes.

Asignar la vía de conexión
Según el caso de aplicación hay que distinguir entre los siguientes procedimientos:
● Selección del punto final de la conexión en los dispositivos fuente y de destino
El software determina automáticamente la vía de conexión adecuada para el dispositivo de
destino. Esta conexión se denomina entonces "vía de conexión estándar". Para el
enrutamiento, el software considera los recursos de conexión disponibles.
El punto final de la conexión puede ser una CPU o una aplicación para PC.
Observación: Esta variante sólo es posible para la configuración gráfica de la conexión.
● Selección de las vías de conexión en los dispositivos fuente y de destino
Siempre que se prevean varios componentes (CPs) y, en caso dado, también diferentes
subredes a fin de distribuir la carga, también es posible configurar la vía de una conexión
de forma específica. La vía de conexión se especifica a través del punto final de la conexión
y la selección de la interfaz con la subred.

Requisitos y resultado
En la vista de redes se han especificado los dispositivos con CPUs y aplicaciones para PC, así
como, dado el caso, los módulos con capacidad de comunicación (CP).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

231

Configuración de dispositivos y redes
1.3 Configurar redes
El resultado de la configuración depende en este caso de la configuración actual de los
dispositivos y de la interconexión en el proyecto. Por tanto, con los procedimientos descritos
en los siguientes capítulos se obtienen los siguientes resultados:
● Conexión especificada
Cuando ambos interlocutores seleccionados se encuentran interconectados en la misma
subred, se define una conexión totalmente especificada de forma gráfica o desde un cuadro
de diálogo.
Esta conexión totalmente especificada se registra automáticamente tanto en la tabla de
conexiones del dispositivo local como en la del interlocutor. Para esta conexión se otorgan
la ID local y la ID del interlocutor. Estas IDs son necesarias para programar las
instrucciones de comunicación (valor para el parámetro del bloque "ID") o de las
aplicaciones para el PC.
Excepciones:
– Conexiones S7 unilaterales
En una conexión S7 unilateral, el interlocutor tiene la función de servidor. Por esta razón,
para el interlocutor no se realiza ninguna entrada en la tabla de conexiones. Solo para
el interlocutor local se otorga una ID de conexión.
La siguiente representación muestra una conexión especificada:

● Conexión no especificada
En los siguientes casos se definen conexiones no especificadas de forma específica
seleccionando solo el interlocutor local de forma gráfica o desde un cuadro de diálogo:
– Si determinadas propiedades de conexión requieren una conexión no especificada.
Ejemplos: Conexión de correo electrónico, conexión FTP, conexión FDL con acceso
libre Layer 2.
– Cuando uno de ambos interlocutores (aún) no se encuentra disponible para el tipo de
conexión seleccionado pero se desea aun así reservar un recurso de conexión.

232

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Influencia de la interconexión: comportamiento cuando falta la conexión en red
La conexión de los interlocutores en red es un requisito para la univocidad y coherencia de los
parámetros de conexión asignados. Si uno o ambos interlocutores no están conectados a la
misma subred, es necesario distinguir entre los comportamientos siguientes al configurar la
conexión gráficamente:
Nota
Configuración de conexiones a través de cuadros de diálogo: interconexión no automática
En la configuración de conexiones a través de cuadros de diálogo no se efectúan
interconexiones automáticas.
● Las interfaces de los interlocutores que se deben conectar no están conectadas en red, o
al menos no están conectadas en red a través de la misma subred.
Aparece el cuadro de diálogo "Conectar con subred", que ofrece las opciones siguientes:
– Asignar subred existente
Seleccione una subred de la lista de subredes disponibles. La conexión se puede crear
de manera coherente y especificada.
– "Conectar con subred nueva"
Las interfaces de los interlocutores se conectan a través de una nueva subred. La
conexión se puede crear de manera coherente y especificada.
– "No conectar con subred"
La conexión se crea de manera especificada; la coherencia no está asegurada debido
a la falta de interconexión, por lo que la entrada aparece en color rojo en la tabla de
conexiones. Las conexiones se representan en la vista de redes en forma de línea
discontinua;
● Varias interfaces/CPs en el interlocutor: como mínimo una de las interfaces disponibles del
interlocutor no está conectada en red
Según como se cree la conexión en este caso, rige lo siguiente:
– Si la conexión se establece únicamente seleccionando la CPU o el servidor OPC como
punto final, la vía de conexión se establecerá independientemente de la interconexión.
Esto puede dar lugar al comportamiento descrito en el caso b, de manera que aparece
el diálogo de selección.
– Si como punto final se selecciona la interfaz del interlocutor que sigue libre y sin
conectar, se produce el comportamiento descrito en el caso a.
Las interfaces de los interlocutores se conectan a través de una nueva subred. La
conexión se puede crear de manera coherente y especificada.

Vistas con información sobre las conexiones configuradas
Desde las vistas descritas a continuación se accede a toda la información y las funciones
relacionadas con la configuración y verificación de conexiones.
Es posible acceder a la vista a través del árbol del proyecto en "Dispositivos y redes".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

233

Configuración de dispositivos y redes
1.3 Configurar redes







①
②
③

234

Visualización de conexiones en la vista de redes
Tabla de conexiones
Ficha "Propiedades" de una conexión en la ventana de inspección

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Ventajas
La información representada en estas vistas siempre es actual en cuanto a las acciones de
usuario inmediatas. Esto significa que:
● Si se ha seleccionado p. ej. una CPU en la vista de redes, la tabla de conexiones muestra
todas las conexiones creadas para esta CPU.
Observación: A través del menú contextual de la tabla de conexiones es posible escoger
entre la visualización de todas las conexiones del proyecto y la visualización de las
conexiones de un componente seleccionado.
● Si se ha seleccionado una conexión en la tabla de conexiones, rige lo siguiente:
– Si el modo de comunicación se encuentra conectado, la vía de conexión se representa
gráficamente en la vista de redes.
– La vista Propiedades de la ventana de inspección muestra los parámetros de dicha
conexión.

Visualización de conexiones en la vista de redes
La vista de redes muestra los dispositivos con sus componentes, así como las redes y las
conexiones.
En referencia a las conexiones, la vista de redes muestra:
● Entre qué dispositivos se han creado conexiones.
● Desde qué dispositivos parten conexiones no especificadas.
La vista de redes ofrece las funciones siguientes:
● Crear conexiones gráficamente;
● Seleccionar las vías de conexión al crearlas gráficamente.

La tabla de conexiones
La tabla de conexiones ofrece las funciones siguientes:
● Relación de las conexiones con un objeto seleccionado en la vista de redes (red, CPU, CP);
● Relación de todas las conexiones del proyecto;
● Selección de una conexión con la consiguiente visualización en la vista de redes, así como
visualización de las propiedades de una conexión seleccionada en la ventana de
inspección;
● Cambio de interlocutores;
● Posibilidad de entrada de parámetros centrales;
● Visualización de información de estado;
● Acceso a la creación de conexiones nuevas a través de cuadros de diálogo (tiene que estar
desactivada la opción "Mostrar todas las conexiones").

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

235

Configuración de dispositivos y redes
1.3 Configurar redes

Ficha "Propiedades" de una conexión en la ventana de inspección
El cuadro de diálogo de propiedades tiene el significado siguiente:
● Visualización y posibilidad de ajuste de todos los parámetros de conexión;
● Ajuste de la vía de conexión; de forma automática o seleccionable
● Especificación posterior de conexiones no especificadas.

Crear una conexión gráficamente
Configurar conexiones gráficamente
● En el caso más sencillo se seleccionan solo los dispositivos que se desea conectar. En la
configuración actual se selecciona una vía de conexión posible y se denomina "vía de
conexión estándar". La vía de conexión se selecciona entonces de tal forma que los
recursos disponibles sean utilizados de la mejor forma. La definición se basa en el siguiente
comportamiento:
– En la medida de lo posible, los componentes que no están interconectados se
interconectan automáticamente para poder crear conexiones totalmente especificadas
directamente.
– Los recursos de un componente se utilizan por completo antes de conmutar a otro
componente.
– Los tipos de red se ven sujetos a las siguientes reglas de preferencia para los tipos de
conexión independientes de la red (conexiones S7): Industrial Ethernet antes que
PROFIBUS.
● Como alternativa se determina específicamente de forma fija una vía de conexión sobre el
punto final de la conexión, así como la interfaz con la subred.
Nota
Crear conexiones S7 gráficamente en la CPU 1515SP PC
Si desea crear una conexión S7 en una CPU 1515SP PC , utilice la interfaz derecha de la CPU
1515SP PC "PROFINET onboard [X1]" al crear la conexión gráficamente. Esta interfaz está
conectada directamente a la CPU 150xS .
La interfaz izquierda de la CPU 1515SP PC "PROFINET onboard [X2]" está conectada a la
estación SIMATIC PC o a una aplicación de Windows y no puede utilizarse al crear una
conexión S7 gráficamente.

236

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Determinar automáticamente la vía de conexión
Para crear una conexión gráficamente sobre una vía de conexión por defecto, proceda del
siguiente modo:
1. Haga clic en el símbolo "Conexiones" de la barra de herramientas. De esta forma se activa
el modo de conexión.

2. Seleccione el tipo de conexión que necesite en la lista desplegable situada al lado.
A continuación es posible observar el siguiente comportamiento:
– En la vista de redes están resaltados en color los componentes que pueden utilizarse
como puntos finales de la conexión en el proyecto para el tipo de conexión seleccionado.
En el caso de los componentes puede tratarse de CPUs o aplicaciones para PC.

3. Seleccione el componente del que deba partir una conexión.
4. Para crear la conexión existen 2 posibilidades:
– Haga clic en el componente del que debe partir una conexión y arrastre el cursor del
ratón, en modo de conexión, hasta el componente de destino. Confirme el punto final de
la conexión mediante un nuevo clic.

– Mientras mantiene presionada la tecla <Mayús>, seleccione además el componente de
destino y elija con el botón derecho del ratón el comando "Agregar conexión".
Nota
Si antes quiere salir del modo de conexión, pulse <Esc>, haga clic con el botón derecho del
ratón o haga doble clic en el segundo plano de la vista de redes.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

237

Configuración de dispositivos y redes
1.3 Configurar redes

Resultado
● Se ha creado una conexión especificada.
● La vía de conexión aparece resaltada. La vía de conexión se ha ajustado automáticamente
conforme a los recursos de conexión e interfaces disponibles.
● La conexión ha sido registrada en las tablas de conexión de los componentes (CPU /
aplicación para PC).

238

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Seleccionar la vía de conexión de forma específica
Para crear una conexión con una vía de conexión seleccionada de forma explícita, proceda del
siguiente modo:
1. Haga clic en el símbolo "Conexiones" de la barra de herramientas. De esta forma se activa
el modo de conexión.

2. Seleccione el tipo de conexión necesario en la lista desplegable.
3. En la interfaz de subred, haga clic en el dispositivo del que deba partir una conexión.
4. En modo de conexión arrastre el cursor del ratón, manteniendo el botón del mismo pulsado,
hasta la interfaz deseada del dispositivo de destino y suelte el botón del ratón.

Nota
Si antes quiere salir del modo de conexión, pulse <Esc>, haga clic con el botón derecho del
ratón o haga doble clic en el segundo plano de la vista de redes.
Resultado:
– Se ha creado una conexión especificada.
– La conexión creada entre los puntos finales utiliza las interfaces seleccionadas para la
vía de conexión.
– La vía de conexión aparece resaltada.
– La conexión ha sido registrada en las tablas de conexión de los dispositivos (CPU /
aplicación para PC).

Configurar una conexión cuando falta la asignación de red o ésta no es unívoca
Las interconexiones que faltan se establecen en la medida de lo posible de forma automática
al crear una conexión. En caso de no ser posible una asignación de red unívoca, se produce
una consulta al finalizar la configuración de la conexión. En este caso se ofrecen las subredes
existentes para su selección.
Ejemplo en la siguiente figura: Al crear una conexión entre las estaciones PLC2 y PLC3 que
aún no han sido interconectadas se produce una consulta.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

239

Configuración de dispositivos y redes
1.3 Configurar redes

Crear una conexión nueva a través de cuadros de diálogo
Configurar conexiones en cuadros de diálogo
La configuración de la conexión en cuadros de diálogo es muy útil para crear varias conexiones
dentro de una estación en un solo paso de trabajo.
Por un lado se dispone del control completo sobre la selección de la vía de conexión, ya que
el sistema muestra todas las variantes de interfaces. Por otro lado, se tiene la posibilidad de
delegar en el sistema la consideración de los recursos disponibles del sistema y, con ello, la
selección de la vía de conexión.
Nota
Configuración de conexiones en cuadros de diálogo: interconexión no automática
En la configuración de conexiones en cuadros de diálogo no se efectúan interconexiones
automáticas.

240

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Cuadro de diálogo "Crear conexión"
A continuación se muestra la estructura del cuadro de diálogo "Crear conexión". Se representa
una interconexión entre varias estaciones. El modo de conexión está activado y se ha
seleccionado la estación situada arriba.















①

Lista desplegable para la selección del tipo de conexión.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

241

Configuración de dispositivos y redes
1.3 Configurar redes

②

Visualización de los interlocutores posibles para el tipo de conexión seleccionado.
Seleccione de entre las siguientes alternativas:
● Dependiendo del tipo de conexión, una configuración especial:

③

–

"No especificada"

–

"Broadcast"

–

"Multicast"

● El interlocutor
Área de contenido para selección de interfaces.
Se muestran las posibles combinaciones de interfaces correspondientes a la configuración. Solo se muestran las
interfaces posibles para el tipo de conexión seleccionado. La indicación del estado informa adicionalmente acerca de
si es posible establecer la conexión dependiendo de la interconexión y los recursos disponibles. Aunque falte una
interconexión de interfaces es posible establecer una conexión.
Consulte también AUTOHOTSPOT
Ejemplo mostrado:

④
⑤

⑥

⑦

Entre PLC1 y PLC4 se encuentran interconectados en cada caso los puertos Gbit por un lado y las interfaces
PROFINET por otro lado. Correspondientemente, solo se muestran estas dos combinaciones como completamente
asignables.
Lista desplegable para la selección o la entrada de la ID local.
Casilla de verificación para mostrar el establecimiento de conexión activo.
Al crear una conexión se activa siempre la casilla de verificación de iniciativa local en el lado local. No todos los
dispositivos tienen la capacidad de hacerse cargo del establecimiento de una conexión. En tal caso la ha de esta‐
blecer el interlocutor. La casilla de verificación muestra siempre la capacidad de la conexión seleccionada.
Casilla de verificación para mostrar una conexión unilateral.
En una conexión unilateral hay una relación cliente-servidor. Sólo el cliente conoce al servidor, mientras que el
servidor no dispone de información de ningún tipo acerca del cliente. En una conexión bilateral, ambos puntos finales
conocen la información sobre el interlocutor. La casilla de verificación muestra siempre la información sobre la
conexión seleccionada.
Indica la confirmación de que se ha creado una conexión nueva.
Se mencionan el tipo de conexión y ambos interlocutores. Los iconos amarillos indican que existe conexión pero que
no es coherente. En dicho caso, compruebe los parámetros de conexión.

Indicación del estado
Icono

Significado
Las interfaces están interconectadas y en los interlocutores seleccionados se dispone
de recursos de conexión.
Las interfaces no están interconectadas o no están conectadas a la misma subred.

242

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento
Para crear una conexión desde un cuadro de diálogo, proceda del siguiente modo:
1. Haga clic en el símbolo "Conexiones" de la barra de herramientas. De esta forma se activa
el modo de conexión.

2. En el menú contextual del componente que debe convertirse en el punto final de la conexión
(CPU o aplicación para PC), seleccione el comando "Agregar conexión".
o
Con la opción "Mostrar todas las conexiones" desactivada y con la CPU o aplicación
seleccionada, elija el comando "Agregar conexión" en el menú contextual de la tabla de
conexiones.
Se abre el cuadro de diálogo "Crear conexión".
3. Seleccione en la lista desplegable "Tipo" el tipo de conexión deseado, p. ej. "Conexión
FDL".
4. Compruebe en la línea inferior el ajuste previo de parámetros de conexión adicionales
mostrados y corríjalos conforme a sus requisitos.
Nota
También puede modificar dichos parámetros a posteriori en la tabla de conexiones o en las
propiedades de la conexión.
5. En el área izquierda del cuadro de diálogo, seleccione el interlocutor (dispositivo o CPU).
En el área de contenido se muestran las posibles combinaciones de interfaces
correspondientes a la configuración junto a la información de estado. Se encuentra
seleccionada la primera combinación de interfaces a la que es posible asignar una
conexión del tipo seleccionado.
Nota
Dependiendo del tipo de conexión seleccionado se ofrecen, además de los posibles
interlocutores, tipos de conexión especiales tales como "no especificada", "Broadcast" o
"Multicast".
6. Conserve la selección o seleccione la vía de conexión deseada.
7. Confirme la selección con el botón "Agregar".
Se crea una conexión, que se muestra en la tabla de conexiones.
8. Si no ha cerrado el cuadro de diálogo, continúe alternativamente del modo siguiente:
– Establezca otra conexión del mismo tipo con el mismo dispositivo de destino haciendo
clic de nuevo en el botón "Agregar".
– Repita el procedimiento indicado arriba con otro tipo de conexión de la lista desplegable
u otro interlocutor.

Configurar una conexión cuando falta la interconexión
Las interconexiones que faltan se establecen en la medida de lo posible de forma automática
al crear una conexión. En caso de ser posible una asignación de red unívoca, tras finalizar el
cuadro de diálogo se muestra la interfaz correspondiente interconectada en la vista de redes.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

243

Configuración de dispositivos y redes
1.3 Configurar redes
En caso de no ser posible una asignación de red unívoca, en la configuración de una conexión
a través de cuadros de diálogo no se introducirá ninguna interconexión. Por esta razón, las
conexiones creadas de esta forma aún no han sido completamente especificadas y se marcan
en color rojo en la tabla de conexiones.

Trabajar en la vista de redes
Significado de la vista de redes en el modo de conexión
La vista de redes muestra dispositivos con sus componentes e interfaces a las subredes. En
el modo de conexión, las vías de comunicación de las conexiones configuradas se pueden
hacer visibles.
En lo relativo a las conexiones se puede apreciar:
● Entre qué dispositivos se han creado conexiones
● Qué tipos de conexión se han creado partiendo de un dispositivo
● Desde qué dispositivos parten conexiones no especificadas
En el modo de conexión, la vista de redes ofrece las funciones siguientes:
● Crear conexiones gráficamente; consulte también Crear una conexión gráficamente
(Página 236)
● Resaltar las conexiones de una subred de forma selectiva;
● Resaltar interlocutores.

244

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Resaltar la vía de conexión y el interlocutor en la vista de redes
Para mostrar los interlocutores de todos o algunos tipos de conexión en la vista de redes,
proceda del siguiente modo:
1. En el menú contextual del punto final de la conexión (CPU o aplicación para PC) cuyos
interlocutores desea mostrar en la vista de redes, seleccione el comando de menú
"Resaltar interlocutores".
2. En el menú que aparece a continuación, elija "Todos los interlocutores" o "Seleccionar el
tipo de conexión..."
Se seleccionan el punto final local y los puntos finales de los dispositivos de destino
correspondientes a todos los tipos de conexión o al tipo de conexión correspondiente.
Además, los dispositivos muestran una flecha.
3. Abra una lista con los datos de los dispositivos de destino seleccionando con el botón
derecho del ratón la flecha situada en la línea inferior del dispositivo local. Esta función
complementaria es útil en las configuraciones de red complejas en las que no se ven todos
los dispositivos.

Nota
Es posible visualizar uno de los interlocutores que no se ve en el área de visualización actual
de la vista de redes. Haga clic en el interlocutor en la lista que aparece. Resultado: La vista se
desplaza de tal forma que se muestra el interlocutor.

Resaltar / seleccionar una conexión
Es posible seleccionar conexiones individuales para que queden resaltadas. Con ello se
consigue lo siguiente:
● La conexión está seleccionada en la tabla de conexiones; ello permite ajustar en ella
determinadas propiedades.
● La conexión se muestra en la ventana de inspección con todas las posibilidades de
parametrización.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

245

Configuración de dispositivos y redes
1.3 Configurar redes
Proceda del siguiente modo:
1. Sitúe el puntero del ratón sobre la subred.
2. Seleccione y marque la conexión deseada en el cuadro de diálogo que aparece "Resaltar
la conexión".
La vía de conexión se muestra en forma de línea discontinua azul clara.

3. Haga clic en la línea discontinua.
El color de la línea pasa a azul oscuro; la conexión se muestra tanto en la tabla de
conexiones como en la ventana de inspección.

246

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Trabajar con la tabla de conexiones
Funciones
Además de la posibilidad de crear conexiones a través de cuadros de diálogo, la tabla de
conexiones ofrece otras funciones:
● Relación de las conexiones con un objeto seleccionado en la vista de redes (red, CPU, CP)
● Relación de todas las conexiones del proyecto
● Selección de una conexión y su visualización en la vista de redes
● Cambio de interlocutores
● Posibilidad de entrada de parámetros centrales
● Visualización de información de estado

Crear conexiones a través de cuadros de diálogo
Crear una conexión nueva a través de cuadros de diálogo (Página 240)

Contenido de la tabla de conexiones
La tabla de conexiones permite visualizar en detalle todas las conexiones creadas en el
proyecto:
● Mostrar todas las conexiones (ajuste predeterminado, seleccionable en el menú contextual)
La tabla de conexiones muestra todas las conexiones creadas en el proyecto.
● Mostrar las conexiones relacionadas con la selección (ajuste recomendado para proyectos
complejos)
Desactive para ello la opción "Mostrar todas las conexiones" mediante el menú contextual.
La tabla de conexiones muestra las conexiones correspondientes a una subred o una CPU/
un CP seleccionado. Por tanto, se encuentra vacía cuando no se selecciona en la vista de
redes ninguno de los objetos mencionados.
También es posible seleccionar simultáneamente varios objetos del mismo tipo en cada
caso (varias subredes, varias CPUs/CPs o varias interfaces). La tabla de conexiones
muestra en este caso todas las conexiones correspondientes.

Funciones básicas de las tablas
La tabla de conexiones soporta las siguientes funciones básicas para editar una tabla:
● Mostrar y ocultar las columnas de la tabla de forma selectiva
Seleccione para ello el comando "Mostrar/ocultar columnas" en el menú contextual de la fila
superior de la tabla.
● Modificar manualmente el ancho de las columnas
Desplace para ello la línea de separación situada en el lado derecho de la columna, en la
fila superior.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

247

Configuración de dispositivos y redes
1.3 Configurar redes
● Optimizar automáticamente el ancho de las columnas
Seleccione para ello el comando "Optimizar ancho de columnas" en el menú contextual del
encabezado de la tabla.
● Mostrar el significado de una columna mediante tooltips.
Si desea guardar la disposición, el ancho y la visibilidad de las columnas, haga clic en la
función "Recordar disposición" en la parte superior derecha de la vista de redes.
Símbolo

Significado
Recordar disposición
Guarda la representación actual de la tabla. La disposición, el ancho y la visibilidad de las
columnas se almacenan en la vista de tabla.

Navegar por la tabla de conexiones con las teclas de cursor
Las teclas de cursor FLECHA ARRIBA y FLECHA ABAJO permiten seleccionar una conexión
en la tabla de conexiones; la conexión queda seleccionada y se resalta en la vista de redes
cuando el modo de conexión se encuentra activado.

Modificar las propiedades de la conexión
Algunos de los parámetros visualizados en la tabla de conexiones pueden editarse
directamente. Así, por ejemplo, el nombre de la conexión sólo puede modificarse en la tabla de
conexiones.

Modificar el interlocutor
El interlocutor de una conexión se modifica del siguiente modo:
1. Seleccione la conexión.
2. Elija el nuevo interlocutor en la lista desplegable activada de la columna "Interlocutor".

Consulte también
Vista general del diagnóstico de conexiones (Página 3660)
Ver el estado de conexión mediante iconos (Página 3661)
Diagnosticar conexiones detalladamente (Página 3662)

Modificar el interlocutor
Para una conexión ya configurada, modifique en caso necesario el interlocutor según la
siguiente descripción. Se mantienen la ID local y el tipo de conexión.
Solo son posibles las modificaciones de los puntos finales de la conexión en la tabla de
conexiones o en la ventana de inspección.

248

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Modificar conexiones a través de cuadros de diálogo
Para acceder a otro interlocutor en una vía de conexión predeterminada, proceda del siguiente
modo:
1. Marque en la vista de redes el punto final local para el que desea asignar un interlocutor
nuevo.
En la tabla de conexiones se visualizan las conexiones correspondientes.
2. Marque la conexión deseada en la tabla de conexiones.
3. Elija el nuevo dispositivo de destino para la conexión mediante la lista desplegable de la
columna de la tabla "Interlocutor".
Como alternativa, seleccione el nuevo dispositivo de destino en "Vía de conexión" de la
ventana de inspección.
Nota
Efecto en las propiedades ya configuradas
Tenga en cuenta que al modificar el interlocutor, las propiedades parametrizadas de la
conexión se reinician al ajuste predefinido.
Utilice las posibilidades de entrada en la tabla de conexiones o en la ventana de inspección
cuando desee modificar las "Propiedades" de la conexión.
Nota
Efecto en la interconexión
En el caso de los anteriores, para modificar el interlocutor no se crean subredes de forma
automática cuando falta la interconexión con el nuevo punto final de la conexión.

Ajustar o modificar la vía de conexión
Dependiendo de los componentes e interfaces disponibles dentro de un dispositivo, es posible
trazar conexiones a lo largo de diferentes vías dentro del dispositivo.
Dependiendo del estado de la configuración del dispositivo, en la configuración existen
conexiones con el siguiente estado de conexión, las cuales se representan de la forma
correspondiente:
● Vía de conexión cerrada
Se encuentran disponibles ambos puntos finales (CPU o aplicación para PC), así como las
interfaces necesarias para la comunicación (local en la CPU o CP adicional).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

249

Configuración de dispositivos y redes
1.3 Configurar redes
● Vía de conexión abierta
– La vía de conexión no es completamente asignable debido a las interfaces que faltan.
– La vía de conexión se ha definido únicamente en un punto final debido a una conexión
no especificada.

A continuación se describe el procedimiento para modificar o volver a asignar una vía de
conexión configurada en un dispositivo local o interlocutor.
La vía de conexión se ajusta o modifica en las siguientes vistas:
● Ventana de inspección en "Propiedades > General"

Modificar la vía de conexión en la ventana de inspección
Para asignar otra vía de conexión a una conexión existente, proceda del siguiente modo:
1. Seleccione en la vista de redes el punto final (CPU o aplicación para PC) para el que se
desea modificar una conexión.
2. Seleccione en la tabla de conexiones la conexión cuya vía de conexión desea modificar.
Sugerencia: En la vista de redes, la vía de conexión actual aparece resaltada si se ha
ajustado la vista "Resaltar conexión" de la forma correspondiente.
3. Seleccione la interfaz nueva en "Propiedades > General > Interfaz" de la ventana de
inspección. En el interlocutor se ofrecen las interfaces posibles en el contexto de la interfaz
local (observación: en principio, las conexiones S7 se pueden trazar a través de distintos
tipos de subred).
En la vista de redes se representa la nueva vía de conexión resaltada.

Asignar la vía de conexión
Para asignar una vía de conexión cerrada a una vía de conexión existente, proceda del
siguiente modo:
1. Amplíe la configuración del dispositivo de tal forma que las interfaces necesarias para el
tipo de conexión se encuentren disponibles para ambos interlocutores.
2. Marque en la tabla de conexiones la conexión cuya vía de conexión desea asignar.
Sugerencia: En la vista de redes se representa la vía de conexión actual resaltada si se ha
ajustado la vista "Resaltar conexión" de la forma correspondiente.
3. Haga clic en el botón "Buscar vía de conexión" en "Propiedades > General > Interfaz" de la
ventana de inspección.
En la vista de redes se representa la nueva vía de conexión resaltada.

250

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Crear una conexión no especificada
En los siguientes casos se definen conexiones no especificadas de forma específica
seleccionando solo el interlocutor local de forma gráfica o desde un cuadro de diálogo:
● Si determinadas propiedades de servicio o conexión requieren una conexión no
especificada (ejemplos: conexión de correo electrónico, conexión FTP, conexión FDL con
la propiedad "Acceso libre Layer 2").
● Cuando es necesario establecer una conexión que debe estar preparada para la
comunicación con cualquier interlocutor.
● Cuando uno de ambos interlocutores (aún) no se encuentra disponible para el tipo de
conexión seleccionado pero se desea aun así reservar un recurso de conexión.
● Cuando el interlocutor se encuentra fuera del proyecto (p. ej. estaciones ajenas).
● Conexión UDP con Broadcast/Multicast:
– véase UDP con Broadcast y Multicast (Página 286)
– véase Conexión UDP libre (Página 289)

Requisitos
Está abierta la vista de redes.

Configurar gráficamente una conexión no especificada
Para crear una conexión no especificada gráficamente, proceda del siguiente modo:
1. En el modo de conexión, seleccione el tipo de conexión necesario en la lista desplegable,
por ejemplo, "Conexión TCP".
Las CPUs posibles para el tipo de conexión seleccionado han sido seleccionadas y se
representan resaltadas.
2. Haga clic en la CPU de la que deba partir una conexión.
3. Desplace el puntero del ratón dentro de la CPU o sobre la interfaz del CP y confirme el punto
final de la conexión haciendo doble clic con el ratón.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

251

Configuración de dispositivos y redes
1.3 Configurar redes

Resultado
● Se ha creado una conexión no especificada. Dependiendo del punto final seleccionado
(CPU o CP) rige para la selección de la vía:
– Punto final CPU: Se selecciona la mejor vía de conexión posible de forma automática y
local. Consulte también Crear una conexión gráficamente (Página 236)
– Punto final interfaz CP: La vía de conexión se determina mediante la introducción de
datos.
● La conexión no especificada aparece resaltada mediante una línea corta discontinua.

● La conexión no especificada está registrada en la tabla de conexiones del dispositivo; en la
columna "Interlocutor" aparece la entrada "desconocido".

Configurar una conexión no especificada a través de cuadros de diálogo
Para crear una conexión no especificada desde un cuadro de diálogo, proceda del siguiente
modo:
1. En el menú contextual del dispositivo (CPU) para el que debe crearse una conexión, elija
el comando "Agregar conexión".
o
Con la opción "Mostrar todas las conexiones" desactivada, seleccione el comando
"Agregar conexión" en el menú contextual de la tabla de conexiones.
Resultado: Se abre el cuadro de diálogo "Crear conexión".
2. Seleccione en el cuadro de diálogo "Crear conexión" el tipo de conexión deseado, p. ej.
"Conexión FDL".
3. En la zona superior del cuadro de diálogo, seleccione la entrada "no especificada".
4. Si hay varias interfaces locales disponibles, la interfaz deseada se puede seleccionar de
una lista. En la primera línea de la lista aparece preseleccionada la interfaz identificada por
el sistema como la mejor posible.
5. Confirme la selección con el botón "Agregar".
Se crea una conexión no especificada, que se muestra en la tabla de conexiones.
6. Repita el proceso o salga del cuadro de diálogo mediante "Aceptar".

Resultado
● Se ha creado una o varias conexiones no especificadas.
● Las conexiones no especificadas están registradas en la tabla de conexiones.
Nota
Recuerde que además se pueden parametrizar propiedades especiales para cada
conexión.

252

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Crear conexiones UDP/FDL con Multicast/Broadcast
Significado
Multicast y Broadcast son opciones de conexión especiales que son soportadas y
configurables por CPs Industrial Ethernet en el caso de conexiones UDP y por PROFIBUS en
el caso de conexiones FDL.

Crear una conexión a través de cuadros de diálogo: procedimiento
Para crear una conexión Multicast/Broadcast a través de cuadros de diálogo, proceda del
siguiente modo:
1. En el menú contextual del componente que debe convertirse en el punto final de la
conexión, seleccione el comando "Agregar conexión".
o
Con la opción "Mostrar todas las conexiones" desactivada, seleccione el comando
"Agregar conexión" en el menú contextual de la tabla de conexiones.
Se abre el cuadro de diálogo "Crear conexión".
2. En la lista desplegable "Tipo", seleccione el tipo de conexión Conexión UDP/Conexión FDL.
3. En el área izquierda del cuadro de diálogo, seleccione el tipo de conexión Broadcast o
Multicast.
En el área de contenido aparecen las interfaces locales posibles conforme a la
configuración con su información de estado. Aparece preseleccionada la primera interfaz
a la que puede asignarse una conexión del tipo seleccionado.
4. Conserve la selección o seleccione la vía de conexión deseada.
5. Confirme la selección con el botón "Agregar".
Se crea una conexión, que se muestra en la tabla de conexiones.
6. Si no ha finalizado el cuadro de diálogo, continúe alternativamente del siguiente modo:
– Establezca otra conexión del mismo tipo con el mismo dispositivo de destino haciendo
clic de nuevo en el botón "Agregar".
– Repita el procedimiento indicado arriba con otro tipo de conexión de la lista desplegable
u otro interlocutor.

Crear la conexión gráficamente: procedimiento
1. En primer lugar, cree una conexión UDP/conexión FDL no especificada en la configuración
gráfica de conexiones; Crear una conexión gráficamente (Página 236)
2. A continuación, configure los ajustes de la dirección del interlocutor conforme a los
requisitos para Multicast o Broadcast. De manera alternativa, proceda del modo siguiente:
– Seleccione el tipo de conexión deseado en la lista desplegable de la columna
"Interlocutor" de la tabla de conexiones; los parámetros de dirección se asignan
automáticamente.
o
– Con UDP, introduzca la dirección IP o el puerto directamente en "General > Detalles de
direcciones". Con FDL, ajuste la dirección de dispositivo PROFIBUS 63.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

253

Configuración de dispositivos y redes
1.3 Configurar redes

Consulte también
UDP con Broadcast y Multicast (Página 286)
Conexión FDL con Broadcast (Página 299)
Conexión FDL con Multicast (Página 300)

Especificar una conexión no especificada
Características de la conexión no especificada
Para una conexión no especificada faltan, dependiendo del tipo de conexión, todos o parte de
los parámetros necesarios para el acceso local a la red y para el direccionamiento del
interlocutor.
Una conexión no especificada se representa como sigue:
● Vista de redes:
Tras la creación de una nueva conexión o cuando la conexión ha sido marcada en la tabla
de conexiones, la conexión no especificada aparece en la vista de redes como una línea
discontinua.
● Tabla de conexiones:
– Visualización en la columna "Interlocutor": "desconocido"
Una conexión no especificada se crea como sigue: Consulte también Crear una conexión no
especificada (Página 251)
Al especificar a posteriori la conexión debe distinguirse en principio:
● El interlocutor se encuentra en el mismo proyecto
La conexión se especifica mediante la selección a posteriori de los componentes
disponibles en el proyecto.
● El interlocutor se encuentra fuera del proyecto
La conexión se especifica introduciendo parámetros de dirección de los interlocutores
disponibles fuera del proyecto.

Complementación automática de los parámetros de conexión que faltan
Si se soluciona la falta de recursos mediante la introducción de componentes, se asignarán
conexiones en la medida de lo posible de forma automática, formando con ello una conexión
totalmente especificada en caso dado.

Requisitos
● Los componentes de ambos dispositivos cuentan con recursos libres para el tipo de
conexión.

254

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento en la tabla de conexiones
Para aportar a una conexión no especificada los parámetros de dirección de un dispositivo de
destino disponible en el proyecto, proceda del siguiente modo:
1. Seleccione la CPU cuya conexión desea especificar.
En la tabla de conexiones, todas las conexiones no especificadas configuradas para la CPU
se identifican con la observación "desconocido" en la columna "Interlocutor".
2. Seleccione el dispositivo de destino deseado en la columna "Interlocutor" de la tabla de
conexiones.

Resultado
● La conexión está especificada con los detalles de direcciones correspondientes para el
interlocutor.
● En la vista de redes se representa la nueva vía de conexión resaltada como una línea
discontinua.
La siguiente representación muestra una conexión especificada:

Borrar una conexión
Las conexiones configuradas se borran en la vista de redes o en la tabla de conexiones.
En la vista de redes se puede borrar en cada caso una conexión resaltada. En la tabla de
conexiones se borran una o varias conexiones.

Procedimiento en la vista de redes
En la vista de redes se pueden borrar conexiones individuales mediante el menú contextual.
Proceda del siguiente modo:
1. Conmute al modo de conexión.
2. Sitúe el puntero del ratón sobre la subred.
El cuadro de diálogo "Resaltar la conexión" muestra las conexiones configuradas
actualmente.
3. Seleccione la conexión que desea borrar.
4. Vuelva a situar el puntero del ratón sobre la subred.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

255

Configuración de dispositivos y redes
1.3 Configurar redes
5. Abra el menú contextual con el botón derecho del ratón.
6. Seleccione el comando "Borrar".
La conexión seleccionada se borra por completo. Si para una conexión especificada el
interlocutor se encuentra dentro del proyecto, la conexión se borra también de la tabla de
conexiones del interlocutor.
Nota
Cargar los datos de conexión en el módulo
Cargue la tabla de conexiones con la conexión borrada en los módulos programables
afectados por la operación de borrado.

Procedimiento en la tabla de conexiones / vista de redes
En la tabla de conexiones se pueden borrar una o más conexiones seleccionadas mediante el
menú contextual. Proceda del siguiente modo:
1. Seleccione en la tabla las conexiones que desea borrar.
2. Seleccione el menú contextual con el botón derecho del ratón.
3. Elija el comando "Borrar".
La conexión seleccionada en cada caso se borra por completo. Si para una conexión
especificada el interlocutor se encuentra dentro del proyecto, la conexión se borra también
de la tabla de conexiones del interlocutor.
4. Cargue la tabla de conexiones con las conexiones borradas en el módulo programable
correspondiente.
Nota
Cargar los datos de conexión en el módulo
Cargue la tabla de conexiones con la conexión borrada en los módulos afectados por la
operación de borrado.
Nota
Para borrar todas las conexiones del módulo se debe cargar una tabla de conexiones vacía.

Copiar una conexión
Introducción
Las conexiones no se copian individualmente, sino siempre en relación con el proyecto o
dispositivo.
Es posible copiar:
● Proyectos enteros
● Uno o varios dispositivos dentro de un proyecto o de varios proyectos

256

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Copiar un proyecto
Al copiar un proyecto se copian también todas las conexiones configuradas. No es necesario
realizar ajustes en las conexiones copiadas porque siguen siendo coherentes.

Copiar dispositivos
● Copiar el dispositivo dentro de un proyecto
Cuando se copian dispositivos individuales se crean conexiones no especificadas y es
necesario volver a asignar los interlocutores al dispositivo local.
Al copiar un grupo de dispositivos se copian también las conexiones dentro del grupo de
dispositivos. No obstante, debido al duplicado se crean en este caso duplicados de los
nombres de las conexiones. Modifique estos nombres de conexión tras el proceso de copia.
Los dispositivos copiados se deben conectar nuevamente en red.
● Copiar dispositivos en otro proyecto
Es posible copiar uno o varios dispositivos en otro proyecto. Con el fin de procesar en
paralelo el otro proyecto, reinicie el TIA Portal.
Las conexiones configuradas entre los dispositivos copiados permanecen sin cambios en
el proyecto de destino. En el proyecto de destino se vuelve a asignar únicamente la
interconexión.
Si copia los dispositivos en el proyecto de destino uno tras otro, se generan conexiones
temporales no especificadas. No obstante, al introducir otro dispositivo se vuelven a
asignar los interlocutores en tanto sea posible.

Información adicional
Consulte también Especificar una conexión no especificada (Página 254)

Conexiones incoherentes - Conexiones sin asignación
Cuando una conexión es incoherente, significa que los datos de conexión no son completos o
unívocos; la conexión no funciona en el contexto del proyecto.
Las conexiones incoherentes no pueden cargarse, como tampoco es posible el
funcionamiento con una conexión de este tipo.
En la tabla de conexiones, las conexiones incoherentes se reconocen por el color rojo.
Nota
Conexiones no especificadas
En general, las conexiones no especificadas no son incoherentes aunque se marquen en color
rojo en la tabla de conexiones.
Crear una conexión no especificada (Página 251)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

257

Configuración de dispositivos y redes
1.3 Configurar redes

Causas posibles de conexiones incoherentes
● La configuración hardware se ha borrado o modificado
● Falta de conexiones en red entre las interfaces del proyecto necesarias para una conexión.
● Rebase por exceso de los recursos de conexión
● Conexiones con un interlocutor no especificado sin indicar la dirección del mismo.
Puede consultar la información detallada acerca de la causa de la incoherencia en la ventana
de inspección de la página de propiedades de una conexión; en ella los parámetros
incoherentes se marcan en color rojo. Puede consultar la información adicional referente a
dichos parámetros situando el puntero del ratón sobre el parámetro.

Ejemplos y ayuda para incoherencias en acciones típicas dentro de la configuración
A continuación se aclaran las acciones que pueden llevar a la pérdida o eliminación de la
asignación de conexiones configuradas.
Nota
Tenga en cuenta que, al contrario que en las conexiones S7, se asigna una ID dependiente del
CP a las conexiones de la interfaz SEND/RECEIVE. Por tanto, para las acciones que se
describen a continuación pueden producirse adaptaciones de la ID, de tal forma que en el
programa de usuario sea necesario adaptar asimismo la interfaz.
Si se sustituye un CP por otro, éste debe ofrecer como mínimo los mismos servicios y debe ser
como mínimo de la misma versión. Solo de esta forma se garantiza que las conexiones
configuradas mediante el CP permanezcan coherentes y puedan ser utilizadas.

258

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Tabla 1-4

Acciones en una interfaz de CP que llevan a modificaciones en conexiones configuradas

Acción

Consecuencia para las conexiones

Qué es necesario hacer para volver a establecer
la conexión

Borrar el CP (módulo).

Las conexiones se conservan en la ta‐
bla de conexiones sin asignación a un
CP.

Después de colocar e interconectar un CP en la
configuración del hardware:

La asignación a la CPU/aplicación PC
se conserva.

2. Comprobar la dirección inicial de los
módulos LADDR y, en caso dado, adaptarla
en el programa de usuario.

1. Asignar el CP a la conexión;

3. Adaptar las IDs de la conexión en el
programa de usuario.
4. Cargar de nuevo la configuración de la
conexión en el CP.
Borrar un dispositivo.

Todas las conexiones a este dispositivo
se deshacen en el proyecto:

Volver a configurar el dispositivo y las conexio‐
nes.

● Las conexiones se conservan en el
interlocutor como conexiones no
especificadas.

Reasignar o eliminar las conexiones no especi‐
ficadas.

● Las conexiones sin interlocutor se
eliminan por completo.
Modificar la asignación de su‐
bred del CP.

1.3.2.4

Las conexiones asignadas a través del
CP se conservan, pero pueden resultar
incoherentes.

Reasignar conexiones en caso necesario.

Tipos de conexión

Conexión S7
Ajustes generales de la conexión S7
Parámetros de conexión generales
En el grupo de parámetros "General" de las propiedades de la conexión se muestran los
parámetros generales que identifican el punto final local de la conexión.
Aquí existe la posibilidad de asignar la vía de conexión y especificar por completo a los
interlocutores.

ID local
Aquí se muestra la ID local del módulo desde el que se observa la conexión (interlocutor local).
La ID local se puede modificar. Esto es necesario cuando ya se han programado bloques de
función de comunicación y debe utilizarse la ID local indicada allí para la conexión.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

259

Configuración de dispositivos y redes
1.3 Configurar redes

Propiedades de conexión especiales
Visualización de las propiedades de conexión (modificable en función de los componentes
utilizables):
● Unilateral
Unilateral significa que el interlocutor es el servidor de dicha conexión y que no puede
enviar o recibir activamente.
En las conexiones unilaterales no se pueden emplear instrucciones de conexión bilaterales
("parejas de módulos"), como USEND y URCV, BSEND y BRCV o USTATUS.
● Establecimiento activo de la conexión
Determine con esta opción si el establecimiento de la conexión debe realizarse desde este
dispositivo.
Si ha seleccionado como interlocutor "no especificado" al crear la conexión, la opción está
deseleccionada por defecto. Si se activa esta opción, es necesario especificar la dirección
del interlocutor en el registro "Direcciones".
● Enviar avisos de estado operativo
Indica si el interlocutor local envía avisos de estado operativo al interlocutor.

Detalles de direcciones
Visualización de los detalles de direcciones de la conexión S7. Si un interlocutor no está
especificado, pueden modificarse los valores de rack y slot. Todos los demás valores se
tomarán de la configuración actual y no podrán modificarse.

Detalles de direcciones de la conexión S7
Significado
Un recurso de conexión, tal y como se muestra en "Propiedades > Detalles de direcciones",
forma parte de TSAP (Transport Service Access Point) del módulo local o del interlocutor.
Cuando se establece una conexión, se asignan de forma fija recursos específicos de un
módulo a dicha conexión. Para la asignación es imprescindible que el recurso de conexión
pueda direccionarse. El TSAP (Transport Service Access Point) es prácticamente la dirección
del recurso y se forma, entre otros, por medio del recurso de conexión o, en las CPU S7-1500,
con la SIMATIC-ACC (SIMATIC Application Controlled Communication).
Existen limitaciones y reglas en referencia a la posibilidad de uso de los recursos de conexión.
No todos los recursos de conexión son p. ej. utilizables para cada tipo de conexión.

260

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Estructura del TSAP
● Para CPU S7-1500:
"SIMATIC-ACC"<nnn><mm>
nnn = ID local
mm = valor libre
● Para CPU S7-300/400:
<xx>.<yz>
xx = número del recurso de conexión
y = número de rack
z = número de slot

Estructura TSAP en función del interlocutor
La estructura del TSAP en las CPU S7-1500 depende del interlocutor remoto. Si se conecta
una CPU S7-1500 con una CPU S7-300/400, la primera utiliza también la estructura TSAP
incluyendo el recurso de conexión.
Consulte los ejemplos siguientes para TSAPs de distintas configuraciones de conexiones
● Conexión entre dos CPU S7-1500:
– CPU S7-1500 "A" con ID local 200:
TSAP: SIMATIC-ACC20001
– CPU S7-1500 "B" con ID local 3B2:
TSAP: SIMATIC-ACC3B201
● Conexión entre una CPU S7-1500 y una CPU S7-300/400:
– CPU S7-1500 (rack 0, slot 1, recurso de conexión 10):
TSAP: 10.01
– CPU S7-300/400 (rack 0, slot 2, recurso de conexión 11):
TSAP: 11.02

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

261

Configuración de dispositivos y redes
1.3 Configurar redes

Rangos de valores del recurso de conexión
La siguiente tabla informa acerca del significado de los valores y el tipo de conexión.
Dependiendo del interlocutor y el tipo de conexión, el rango de valores se limita
automáticamente a valores válidos, o el valor del recurso de conexión se asigna de forma fija.
Recurso de conexión

Significado

Tipo

Significado

0x01 ("PG")

Conexión PG

Conexión libre (no está confi‐ Se ha reservado como míni‐
gurada)
mo un recurso por CPU para
conexiones PG. En el caso
de determinadas CPUs
S7-300 es posible reservar
varios recursos en las propie‐
dades de la CPU.

0x02 ("OP")

Conexión OP

Conexión libre (no está confi‐ Se ha reservado como míni‐
gurada)
mo un recurso por CPU para
conexiones OP. En el caso
de determinadas CPUs
S7-300 es posible reservar
varios recursos en las propie‐
dades de la CPU.

0x03

otras

Conexión libre (conexión con‐ Este recurso de conexión
figurada no especificada)
puede dar servicio a varias
conexiones. Utilización: ¡Co‐
nexión unilateral para interlo‐
cutor no especificado! No es
necesario configurar el inter‐
locutor cuando se direcciona
el recurso de conexión 0x03.

0x10..0xDF

Conexiones con estableci‐
miento de conexión estático
o dinámico

Conexión configurada no es‐ Uno de estos recursos de co‐
pecificada
nexión puede dar servicio
exactamente a una conexión.
Utilización: ¡Conexión bilate‐
ral para interlocutor no espe‐
cificado!

(1er byte del TSAP)

Conexiones S7 libres
Las conexiones S7 libres se establecen de forma dinámica durante el tiempo de
funcionamiento; existen las siguientes conexiones libres:
● Conexiones PG (0x01)
Conexiones S7 establecidas normalmente por una programadora o un PC (con
funcionalidad ES). La estación/el módulo direccionado se configura, programa, comprueba
y pone en funcionamiento mediante una conexión de este tipo; por regla general, la
conexión vuelve a eliminarse a continuación. Mediante este recurso de conexión es posible
tanto la lectura como la escritura (p. ej. observar y cargar).
● Conexiones OP (0x02)
Conexiones S7 establecidas normalmente desde un OP o un PC (con funcionalidad OS).
Mediante una conexión de este tipo se observa la estación/el módulo en referencia al
proceso controlado.

262

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
● Otras (0x03)
La utilización no ha sido fijada. Durante la configuración de una conexión unilateral S7
desde un S7-400 hasta un S7-300 se utiliza p. ej. este recurso de forma automática.
● Comunicación básica S7 (0xFD)
Conexiones establecidas normalmente desde una CPU hasta otro módulo (CPU, FM, ...)
dentro de una subred. El establecimiento de conexión es iniciado por el programa de
aplicación y no existe ninguna configuración de conexión. Mediante una conexión de este
tipo es posible intercambiar datos de proceso entre los módulos. En el caso de
determinadas CPUs S7-300 es posible reservar recursos para la comunicación básica S7.

Recomendación para la selección del recurso de conexión
Para el interlocutor local, STEP 7 propone siempre un recurso de conexión libre.
Recomendamos utilizar el recurso propuesto.

Conexión de transporte ISO
Transporte ISO - Propiedades de conexión especiales
Referencia
En el grupo de parámetros "Propiedades > General > Propiedades especiales de la conexión"
se pueden definir propiedades adicionales del punto final local de la conexión.

Establecer conexión activa
Determine con esta opción si el establecimiento de la conexión debe realizarse desde este
dispositivo. Esta opción está seleccionada por defecto si la dirección del interlocutor está
especificada.
● ON: La conexión se establece activamente.
● OFF: El interlocutor establece la conexión.
Si ha seleccionado como interlocutor "no especificado" al crear la conexión, la opción está
deseleccionada por defecto. Si se activa esta opción, es necesario especificar la dirección del
interlocutor en el registro "Direcciones".
Nota
Efecto en el modo de operación
Tenga en cuenta el efecto en el modo de operación.
● S7-300 / S7-400
Si se debe utilizar el modo de operación FETCH o WRITE (véase el grupo de parámetros
"Opciones"), deberá desactivarse la opción "Establecimiento activo de la conexión".
● Servidor OPC
Si se debe utilizar el modo de operación FETCH o WRITE (véase el grupo de parámetros
"Opciones"), deberá activarse la opción "Establecimiento activo de la conexión".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

263

Configuración de dispositivos y redes
1.3 Configurar redes

Nombre
Al crear la conexión se visualiza el nombre propuesto para el punto final de la conexión, que
contiene un número de conexión como sufijo.
Utilice este campo para identificar el interlocutor en caso de conexiones no especificadas.

Detalles del establecimiento OPC ISO
Referencia
Configuración de conexiones en el caso de OPC en el grupo de parámetros "Propiedades >
General > Detalles de establecimiento"

Opciones del establecimiento de la conexión
En esta área sólo pueden realizarse entradas si en "Propiedades especiales de la conexión"
se ha seleccionado el establecimiento activo de la conexión.
Elija una de las dos alternativas siguientes:
● Mantener la conexión establecida permanentemente
La conexión se establece y se mantiene al arrancar la estación PC así como en caso de
interrumpirse la conexión.
● Establecer la conexión a petición (acceso a variable)
Aquí se indica adicionalmente durante cuánto tiempo debe mantenerse la conexión
después de un acceso.

Monitorización del establecimiento de la conexión
● Tiempo excedido: Tiempo de espera de errores durante el establecimiento de la conexión.
Si dentro del tiempo de espera no es posible establecer la conexión, ésta se inicializará y
la petición pendiente se acusará con error.
Rango de valores: 0 – 99999 ms
Valor predeterminado: 15000 ms
Nota
La monitorización del establecimiento de la conexión que se ajusta aquí está relacionada
del siguiente modo con la vigilancia de tiempo que puede ajustarse en la configuración de
módulos: el valor válido es el más pequeño.
En la configuración de módulos, la vigilancia de tiempo se configura en "Propiedades de
interfaz Ethernet".

264

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Transporte ISO, detalles de la dirección
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General > Detalles de
direcciones".

Parámetros de dirección
Una conexión de transporte ISO (ISO Transport) se especifica mediante los puntos finales
local y remoto de la conexión.
● Direcciones locales:
Dirección MAC local y TSAP (Transport Service Access Point) local
● Direcciones remotas:
Dirección MAC remota y TSAP remoto
'LVSRVLWLYR(WKHUQHW%

'LVSRVLWLYR(WKHUQHW$

76$3
UHPRWR
76$3
ORFDO
'LUHFFLµQ
0$&$

Figura 1-16

&RQH[LµQ
7UDQVSRUWH
,62

76$3
ORFDO
76$3
UHPRWR
'LUHFFLµQ
0$&%

Emisión y recepción a través de una conexión de transporte ISO en cada caso

Formato TSAP
Las conexiones de transporte ISO tienen una longitud de TSAP de entre 1 y 16 bytes. Al
realizar la entrada se muestra automáticamente la longitud actual (visualización: 16 caracteres
ASCII). Los TSAPs locales y remotos pueden introducirse como valor hexadecimal o como
string ASCII. En caso de una entrada ASCII, los caracteres introducidos también se visualizan
en formato hexadecimal. En caso de entrada hexadecimal, los caracteres imprimibles se
representan como valor ASCII (son visibles 8 caracteres hexadecimales). Si se introducen
caracteres no imprimibles, la visualización ASCII queda atenuada (no es posible la entrada
ASCII) y los caracteres no imprimibles se representan en forma de punto.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

265

Configuración de dispositivos y redes
1.3 Configurar redes

TSAPs locales y remotos
Los TSAPs locales y remotos pueden ser idénticos, ya que la conexión es unívoca debido a las
distintas direcciones MAC. Si hay que configurar más de una conexión entre dos estaciones,
habrá que diferenciar los TSAPs.
● Conexión especificada
Los TSAPs de una conexión de transporte ISO deben coincidir como se indica a
continuación:
– TSAP remoto (en el CP Ethernet) = TSAP local (en la estación de destino)
– TSAP local (en el CP Ethernet) = TSAP remoto (en la estación de destino)
● Conexión no especificada
Los parámetros de dirección quedan en parte sin especificar: Conexiones no especificadas
(Página 227)

TSAPs predeterminados
Para configurar los TSAPs locales y remotos se proponen valores estándar (puede cambiarse)
(p. ej. ISO-1 para la primera conexión entre dos interlocutores). Si se configuran nuevas
conexiones entre los mismos interlocutores, los valores estándar se incrementan
automáticamente (p. ej. ISO-2, etc.). Si se establece una nueva conexión con otro interlocutor
distinto, se inicia de nuevo ISO-1.

Transporte ISO, opciones
Referencia
Configuración de conexión en el grupo de parámetros "Propiedades > General > Opciones"

266

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Modos de operación
● SEND/RECV:
Es el modo estándar con las FCs AG_SEND/AG_LSEND y AG_RECV/AG_LRECV.
● FETCH/WRITE:
Si selecciona uno de los siguientes modos de operación para la conexión de transporte
ISO, el acceso a las áreas de memoria del sistema en la SIMATIC S7 es posible desde los
siguientes dispositivos:
– SIMATIC S5
– Estaciones SIMATIC PC
– Dispositivos de terceros
La conexión puede entonces utilizarse exclusivamente para este modo de operación. En
este caso no es posible enviar o recibir mediante las instrucciones AG_SEND/AG_LSEND
o AG_RECV/AG_LRECV.
– FETCH
Al seleccionar el modo de operación Fetch, se permite el acceso directo de lectura a los
rangos de datos en la SIMATIC S7. Dicho acceso puede tener lugar por ejemplo desde
una estación SIMATIC S5 o una estación de otro fabricante.
– WRITE
Al seleccionar el modo de operación Write, se permite el acceso directo de escritura a
los rangos de datos en la SIMATIC S7. Dicho acceso puede tener lugar por ejemplo
desde una estación SIMATIC S5 o una estación de otro fabricante.
● SPEED SEND/RECV:
Al seleccionar el modo de operación SPEED SEND/RECV se permite la utilización de las
instrucciones AG_SSEND y AG_SRECV.
AG_SSEND/AG_SRECV (SPEED SEND/RECEIVE) ofrecen una transmisión optimizada
(más rápida) dentro de una estación S7-400. En la documentación del dispositivo CP
utilizado, consulte si el CP utilizado soporta este modo de operación y en combinación con
la CPU seleccionada.

Requisitos para FETCH/WRITE: Tipo de establecimiento de la conexión
Seleccione la siguiente opción para el establecimiento de conexión en del tipo de estación en
el grupo de parámetros "Propiedades > General > Propiedades especiales de la conexión":
● Estación SIMATIC S7: Establecimiento de conexión PASIVO
● Estación PC: Establecimiento activo de la conexión

Opción "Modo de direccionamiento S7" (solo para FETCH/WRITE)
En la configuración para el modo de operación FETCH / WRITE es posible seleccionar aquí el
modo de direccionamiento.
● Modo de direccionamiento S7: Dirección de byte
● Modo de direccionamiento S5: Dirección de palabra

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

267

Configuración de dispositivos y redes
1.3 Configurar redes
Esto permite que las aplicaciones accedan a las estaciones S5 o S7 sin adaptar las
direcciones. Esto es interesante especialmente para aplicaciones S5 existentes que deben
utilizarse tal como están para acceder a estaciones S7.
El modo de direccionamiento para el acceso a SIMATIC S7 (opción seleccionada) está
seleccionado por defecto.

Consulte también
Configuración de conexión para FETCH/WRITE (Página 293)
Aplicación de FETCH/WRITE (Página 291)

Transporte ISO, dinámica
Referencia
Configuración de conexión en el grupo de parámetros "Propiedades > General > Dinámica"
Se visualizan los temporizadores y contadores relevantes de la conexión. Los valores
predeterminados pueden aplicarse.
En caso necesario (p. ej. en acoplamientos a sistemas ajenos) es posible ajustar
individualmente los temporizadores y contadores y, con ello, también el comportamiento
dinámico de la conexión.

Propiedades OPC ISO
Referencia
Configuración de conexiones en el caso de OPC en el grupo de parámetros "Propiedades >
General > OPC"
Ajuste aquí las propiedades específicas para una conexión de transporte ISO utilizada por el
servidor OPC.
Se pueden ajustar los parámetros siguientes:

Tiempo excedido para la petición
Si en el transcurso del tiempo de espera ajustado no es posible procesar una petición
pendiente, la conexión se inicializa y la petición se acusa con un error.
Rango de valores: 0 – 99999 ms
- Ajuste predeterminado: 15000 ms

Tamaño del búfer de transmisión
Tamaño predeterminado del búfer de transmisión predeterminado. Durante el tiempo de
ejecución es posible utilizar otros búferes de transmisión adicionales de una longitud
cualquiera (máx. 65535 bytes).

268

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Rango de valores:
- Ajuste predeterminado: 256 bytes
- Rango de valores: 65535 bytes como máximo

Opción "Optimización de acceso directo a servicios de variable"
Si se utiliza esta opción, el servidor OPC intenta agrupar los accesos directos a diferentes
variables de modo que las peticiones que hay que transferir sean las menos posibles.
Dicha opción está activada por defecto.

Opción "Notificación inmediata al detectar una interrupción de la conexión"
Al seleccionar esta opción se determina que, en caso de que la conexión no esté disponible,
la aplicación reciba inmediatamente una notificación acerca de una petición de comunicación
que no pueda ejecutarse (FETCH o WRITE). La notificación tiene lugar independientemente
de que funcione o no el intento actual de restablecer la conexión.
Si no se selecciona esta opción en caso de que la conexión no esté disponible, la aplicación
no recibirá notificación hasta que no haya transcurrido el timeout para la conexión.
La opción aquí descrita sólo es relevante y sólo está disponible si se utilizan los dos modos de
operación citados a continuación:
● La conexión está configurada como permanente.
Las conexiones se pueden configurar como configuraciones establecidas
permanentemente (en la sección "Detalles sobre el establecimiento de conexión"). De este
modo, las peticiones pueden transmitirse al interlocutor con un tiempo de reacción lo más
breve posible sin que sea necesario establecer primero una conexión.
Si la conexión falla, se intentará volver a establecerla. En este estado pueden producirse
retardos hasta que el aviso correspondiente se transmita a la aplicación.
● Se utilizan los tipos de petición FETCH o WRITE (posibilidad de selección en "Opciones").
Sólo con estos tipos de petición es necesaria una reacción inmediata en determinados casos
de aplicación si falla la conexión.

Conexión ISO on TCP
ISO on TCP: propiedades de conexión especiales
Referencia
En el grupo de parámetros "Propiedades > General > Propiedades especiales de la conexión"
se pueden definir propiedades adicionales del punto final local de la conexión.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

269

Configuración de dispositivos y redes
1.3 Configurar redes

Establecimiento activo de la conexión
Determine con esta opción si el establecimiento de la conexión debe realizarse desde este
dispositivo. Esta opción está seleccionada por defecto si la dirección del interlocutor está
especificada.
● ON: La conexión se establece activamente.
● OFF: El interlocutor establece la conexión.
Si ha seleccionado como interlocutor "no especificado" al crear la conexión, la opción está
deseleccionada por defecto. Si se activa esta opción, es necesario especificar la dirección del
interlocutor en el registro "Direcciones".
Nota
Efecto en el modo de operación
Tenga en cuenta el efecto en el modo de operación.
● S7-300 / S7-400
Si se debe utilizar el modo de operación FETCH o WRITE (véase el grupo de parámetros
"Opciones"), deberá desactivarse la opción "Establecimiento activo de la conexión".
● Servidor OPC
Si se debe utilizar el modo de operación FETCH o WRITE (véase el grupo de parámetros
"Opciones"), deberá activarse la opción "Establecimiento activo de la conexión".

Nombre
Al crear la conexión se visualiza el nombre propuesto para el punto final de la conexión, que
contiene un número de conexión como sufijo.
Utilice este campo para identificar el interlocutor en caso de conexiones no especificadas.

Detalles del establecimiento OPC ISO-on-TCP
Referencia
Configuración de conexiones en el caso de OPC en el grupo de parámetros "Propiedades >
General > Detalles del establecimiento"

Opciones del establecimiento de la conexión
En esta área sólo pueden realizarse entradas si en "Propiedades especiales de la conexión"
se ha seleccionado el establecimiento activo de la conexión.

270

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Elija una de las dos alternativas siguientes:
● La conexión se mantiene establecida permanentemente
La conexión se establece y se mantiene al arrancar la estación PC así como en caso de
interrumpirse la conexión.
● La conexión se establece en caso necesario (acceso a variable)
Aquí se indica adicionalmente durante cuánto tiempo debe mantenerse la conexión
después de un acceso.

Monitorización del establecimiento de conexión
Tiempo excedido: Tiempo de espera de errores durante el establecimiento de la conexión.
Si dentro del tiempo de espera no es posible establecer la conexión, ésta se inicializará y la
petición pendiente se acusará con error.
Rango de valores: 0 – 99999 ms
Valor predeterminado: 15000 ms
Nota
La monitorización del establecimiento de la conexión que se ajusta aquí está relacionada del
siguiente modo con la vigilancia de tiempo que puede ajustarse en la configuración de
módulos: el valor válido es el más pequeño.
En la configuración de módulos, la vigilancia de tiempo se configura en "Propiedades de
interfaz Ethernet".

ISO on TCP, detalles de la conexión
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General > Detalles de
direcciones".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

271

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros de dirección
Una conexión se especifica mediante los puntos finales local y remoto de la conexión.
● Direcciones locales:
Dirección IP local y TSAP (Transport Service Access Point) local
● Direcciones remotas:
Dirección IP remota y TSAP remoto
'LVSRVLWLYR(WKHUQHW%

'LVSRVLWLYR(WKHUQHW$

76$3
UHPRWR
76$3
ORFDO
'LUHFFLµQ
,3$

Figura 1-17

&RQH[LµQ
,62
RQ7&3

76$3
ORFDO
76$3
UHPRWR
'LUHFFLµQ
,3%

Emisión y recepción a través de una conexión ISO on TCP en cada caso

Registro Direcciones
En el registro Direcciones se muestra la información de direcciones locales y remotas
relevantes en forma de valores propuestos. Tiene la posibilidad de ajustar de forma individual
los TSAPs.

Formato TSAP
Las conexiones ISO on TCP tienen una longitud de TSAP de entre 1 y 16 bytes. Al realizar la
entrada se muestra automáticamente la longitud actual (visualización: 16 caracteres ASCII).
Los TSAPs locales y remotos pueden introducirse como valor hexadecimal o como string
ASCII. En caso de una entrada ASCII, los caracteres introducidos también se visualizan en
formato hexadecimal. En caso de entrada hexadecimal, los caracteres imprimibles se
representan como valor ASCII (son visibles 8 caracteres hexadecimales). Si se introducen
caracteres no imprimibles, la visualización ASCII queda atenuada (no es posible la entrada
ASCII) y los caracteres no imprimibles se representan en forma de punto.

272

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

TSAPs locales y remotos
Los TSAPs locales y remotos pueden ser idénticos, ya que la conexión es unívoca debido a las
distintas direcciones IP. Si hay que configurar más de una conexión entre dos estaciones,
habrá que diferenciar también los TSAPs.
● Conexión especificada
Para la configuración del CP Ethernet y en la estación de destino Ethernet, los TSAPs de
una conexión ISO-on-TCP deben coincidir de forma cruzada:
– TSAP remoto (en el CP Ethernet) = TSAP local (en la estación de destino)
– TSAP local (en el CP Ethernet) = TSAP remoto (en la estación de destino)
● Conexión no especificada
Los parámetros de dirección quedan en parte sin especificar: Conexiones no especificadas
(Página 227)

TSAPs predeterminados
Para configurar los TSAPs locales y remotos hay un valor estándar "TCP-1" para la primera
conexión entre ambos interlocutores (puede cambiarse). Si se establece una nueva conexión
entre los mismos interlocutores, se propone el valor estándar "TCP-2". Si se establece una
nueva conexión con otro interlocutor distinto, se utiliza de nuevo TCP-1.

ISO on TCP, opciones
Referencia
Configuración de conexión en el grupo de parámetros "Propiedades > General > Opciones"

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

273

Configuración de dispositivos y redes
1.3 Configurar redes

Modos de operación
● SEND/RECV:
Es el modo estándar con las FCs AG_SEND/AG_LSEND y AG_RECV/AG_LRECV.
● FETCH/WRITE:
Si selecciona uno de los siguientes modos de operación para la conexión de transporte
ISO, el acceso a las áreas de memoria del sistema en la SIMATIC S7 es posible desde los
siguientes dispositivos:
– SIMATIC S5
– Estaciones PC SIMATIC
– Dispositivos ajenos
La conexión puede entonces utilizarse exclusivamente para este modo de operación. En
este caso no es posible enviar o recibir mediante las instrucciones AG_SEND/AG_LSEND
o AG_RECV/AG_LRECV.
– FETCH
Al seleccionar el modo de operación Fetch, se permite el acceso directo de lectura a los
rangos de datos en la SIMATIC S7. Dicho acceso puede tener lugar por ejemplo desde
una estación SIMATIC S5 o una estación de otro fabricante.
– WRITE
Al seleccionar el modo de operación Write, se permite el acceso directo de escritura a
los rangos de datos en la SIMATIC S7. Dicho acceso puede tener lugar por ejemplo
desde una estación SIMATIC S5 o una estación de otro fabricante.
● SPEED SEND/RECV:
Al seleccionar el modo de operación SPEED SEND/RECV se permite la utilización de las
instrucciones AG_SSEND y AG_SRECV.
AG_SSEND/AG_SRECV (SPEED SEND/RECEIVE) ofrecen una transmisión optimizada
(más rápida) dentro de una estación S7-400. Infórmese en la documentación del dispositivo
del CP utilizado si se soporta este modo de operación.

Requisitos para FETCH/WRITE: Tipo de establecimiento de conexión
Seleccione la siguiente opción para el establecimiento de conexión en del tipo de estación en
el grupo de parámetros "Propiedades > General > Propiedades especiales de la conexión":
● Estación SIMATIC S7: Establecimiento de conexión PASIVO
● Estación PC: Establecimiento activo de la conexión

Opción "Modo de direccionamiento S7" (solo para FETCH/WRITE)
En la configuración para el modo de operación FETCH / WRITE es posible seleccionar aquí el
modo de direccionamiento.
● Modo de direccionamiento S7: Dirección de byte
● Modo de direccionamiento S5: Dirección de palabra
Esto permite que las aplicaciones accedan a las estaciones S5 o S7 sin adaptar las
direcciones. Esto es interesante especialmente para aplicaciones S5 existentes que deben
utilizarse tal como están para acceder a estaciones S7.

274

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
El modo de direccionamiento para el acceso a SIMATIC S7 (opción seleccionada) está
seleccionado por defecto.

Consulte también
Configuración de conexión para FETCH/WRITE (Página 293)
Aplicación de FETCH/WRITE (Página 291)

Propiedades OPC ISO-on-TCP
Referencia
Configuración de conexiones en el caso de OPC en el grupo de parámetros "Propiedades >
General > OPC"
Ajuste aquí las propiedades específicas para una conexión ISO-on-TCP utilizada por el
servidor OPC.
Se pueden ajustar los parámetros siguientes:

Tiempo excedido para la petición
Si en el transcurso del tiempo de espera ajustado no es posible procesar una petición
pendiente, la conexión se inicializa y la petición se acusa con un error.
Rango de valores: 0 – 99999 ms
- Ajuste predeterminado: 15000 ms

Tamaño del búfer de transmisión
Tamaño predeterminado del búfer de transmisión predeterminado. Durante el tiempo de
ejecución es posible utilizar otros búferes de transmisión adicionales de una longitud
cualquiera (máx. 65535 bytes).
Rango de valores:
- Ajuste predeterminado: 256 bytes
- Rango de valores: 65535 bytes como máximo

Opción "Optimización de acceso directo a servicios de variable"
Si se utiliza esta opción, el servidor OPC intenta agrupar los accesos directos a diferentes
variables de modo que las peticiones que hay que transferir sean las menos posibles.
Dicha opción está activada por defecto.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

275

Configuración de dispositivos y redes
1.3 Configurar redes

Opción "Notificación inmediata al detectar una interrupción de la conexión"
Al seleccionar esta opción se determina que, en caso de que la conexión no esté disponible,
la aplicación reciba inmediatamente una notificación acerca de una petición de comunicación
que no pueda ejecutarse (FETCH o WRITE). La notificación tiene lugar independientemente
de que funcione o no el intento actual de restablecer la conexión.
Si no se selecciona esta opción en caso de que la conexión no esté disponible, la aplicación
no recibirá notificación hasta que no haya transcurrido el timeout para la conexión.
La opción aquí descrita sólo es relevante y sólo está disponible si se utilizan los dos modos de
operación citados a continuación:
● La conexión está configurada como permanente.
Las conexiones se pueden configurar como configuraciones establecidas
permanentemente (en el apartado "Detalles sobre el establecimiento de la conexión"). De
este modo, las peticiones pueden transmitirse al interlocutor con un tiempo de reacción lo
más breve posible sin que sea necesario establecer primero una conexión.
Si la conexión falla, se intentará volver a establecerla. En este estado pueden producirse
retardos hasta que el aviso correspondiente se transmita a la aplicación.
● Se utilizan los tipos de petición FETCH o WRITE (posibilidad de selección en "Opciones").
Sólo con estos tipos de petición es necesaria una reacción inmediata en determinados
casos de aplicación si falla la conexión.

Conexión TCP
TCP: Propiedades especiales de la conexión
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General >
Propiedades especiales de la conexión"
Los parámetros de conexión definen propiedades adicionales del punto final local de la
conexión.

Establecer conexión activa
Determine con esta opción si el establecimiento de la conexión debe realizarse desde este
dispositivo. Esta opción está seleccionada por defecto si la dirección del interlocutor está
especificada.
● ON: La conexión se establece activamente.
● OFF: El interlocutor establece la conexión.

276

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Si ha seleccionado como interlocutor "no especificado" al crear la conexión, la opción está
deseleccionada por defecto. Si se activa esta opción, es necesario especificar la dirección del
interlocutor en el registro "Direcciones".
Nota
Efecto en el modo de operación
Tenga en cuenta el efecto en el modo de operación.
● S7-300 / S7-400
Si se debe utilizar el modo de operación FETCH o WRITE (véase el grupo de parámetros
"Opciones"), deberá desactivarse la opción "Establecimiento activo de la conexión".
● Servidor OPC
Si se debe utilizar el modo de operación FETCH o WRITE (véase el grupo de parámetros
"Opciones"), deberá activarse la opción "Establecimiento activo de la conexión".

Modo FTP (en el S7-300 / S7-400 - conexión no especificada)
Si se selecciona la opción, las repercusiones son las siguientes:
● La conexión TCP se utiliza ahora como conexión FTP.
● Grupo de parámetros "Detalles de direcciones": Las direcciones se especifican
automáticamente (puerto = 21; observación: este ajuste no resulta visible en "Detalles de
direcciones").
● Grupo de parámetros "Opciones": El modo de operación está ajustado a FTP de forma fija.
La opción "'Establecimiento activo de la conexión" es irrelevante aquí y no está operativa.
Requisitos: Esta opción sólo se puede seleccionar con una conexión TCP no especificada para
determinados CPs del S7-300 / S7-400.

Detalles del establecimiento OPC TCP
Referencia
Configuración de conexiones en el caso de OPC en el grupo de parámetros "Propiedades >
General > Detalles del establecimiento"

Opciones del establecimiento de la conexión
En esta área sólo pueden realizarse entradas si en "Propiedades especiales de la conexión"
se ha seleccionado el establecimiento activo de la conexión.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

277

Configuración de dispositivos y redes
1.3 Configurar redes
Elija una de las dos alternativas siguientes:
● La conexión se mantiene establecida permanentemente
La conexión se establece y se mantiene al arrancar la estación PC así como en caso de
interrumpirse la conexión.
● La conexión se establece en caso necesario (acceso a variable)
Aquí se indica adicionalmente durante cuánto tiempo debe mantenerse la conexión
después de un acceso.

Monitorización del establecimiento de conexión
● Timeout: Tiempo de espera de errores durante el establecimiento de la conexión.
Si dentro del tiempo de espera no es posible establecer la conexión, ésta se inicializará y
la petición pendiente se acusará con error.
Rango de valores: 0 – 99999 ms
Valor predeterminado: 15000 ms
Nota
La monitorización del establecimiento de la conexión que se ajusta aquí está relacionada
del siguiente modo con la vigilancia de tiempo que puede ajustarse en la configuración de
módulos: el valor válido es el más pequeño.
En la configuración de módulos, la vigilancia de tiempo se configura en "Propiedades de
interfaz Ethernet".

TCP, detalles de dirección
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General > Detalles de
direcciones".

278

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros de dirección y tipos de conexión
Para TCP los interlocutores se direccionan mediante el punto final local y remoto como se
indica a continuación.
● Direcciones locales: Dirección IP local y puerto local
● Direcciones remotas: Dirección IP remota y puerto remoto
'LVSRVLWLYR(WKHUQHW%

'LVSRVLWLYR(WKHUQHW$

3XHUWR
UHPRWR
3XHUWR
ORFDO

&RQH[LµQ
8'3

'LUHFFLµQ
,3$

3XHUWR
ORFDO
3XHUWR
UHPRWR
'LUHFFLµQ
,3%

Puertos
Los puertos o las direcciones de los puertos definen el punto de acceso al programa de usuario
dentro de la estación/CPU. ¡Estos deben ser unívocos dentro de la estación/CPU!
● Conexión especificada
Para la configuración del CP Ethernet y en la estación de destino Ethernet, los puertos de
una conexión TCP deben coincidir de forma cruzada:
– puerto remoto (en el CP Ethernet) = puerto local (en la estación de destino)
– puerto local (en el CP Ethernet) = puerto remoto (en la estación de destino)
● Conexión no especificada
Los parámetros de dirección quedan en parte sin especificar: Conexiones no especificadas
(Página 227)

Respecto al rango de valores del puerto, véase también
Configuración de puerto (Página 282)

TCP, opciones
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General > Opciones"

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

279

Configuración de dispositivos y redes
1.3 Configurar redes

Modo de operación
● SEND/RECV:
Es el modo estándar con las FCs AG_SEND/AG_LSEND y AG_RECV/AG_LRECV.
● FETCH/WRITE:
Si selecciona uno de los siguientes modos de operación para la conexión TCP, el acceso
a las áreas de memoria del sistema en la SIMATIC S7 es posible desde los siguientes
dispositivos:
– SIMATIC S5
– Estaciones SIMATIC PC
– Dispositivos de terceros
La conexión puede entonces utilizarse exclusivamente para este modo de operación. En
este caso no es posible enviar o recibir mediante las FCs AG_SEND/AG_LSEND o
AG_RECV/AG_LRECV.
– FETCH
Seleccionando este modo de operación, se permite el acceso directo en lectura a las
áreas de datos en la SIMATIC S7. Dicho acceso puede tener lugar por ejemplo desde
una estación SIMATIC S5 o una estación de otro fabricante.
– WRITE
Al seleccionar el modo de operación, se permite el acceso directo en escritura a las
áreas de datos en el SIMATIC S7. Dicho acceso puede tener lugar por ejemplo desde
una estación SIMATIC S5 o una estación de otro fabricante.
● FTP
Si en "Propiedades > General > Propiedades especiales de la conexión" se ha
seleccionado la opción "Utilizar para protocolo FTP", aquí se muestra "FTP"; en este caso,
la conexión TCP se utiliza como "conexión FTP" y no existe ninguna otra posibilidad de
selección.
Requisitos: Sólo es posible seleccionar la opción para una conexión TCP no especificada.
● SPEED SEND/RECV
Al seleccionar el modo de operación SPEED SEND/RECV se permite la utilización de las
instrucciones AG_SSEND y AG_SRECV.
Las instrucciones AG_SSEND/AG_SRECV (SPEED SEND/RECEIVE) ofrecen una
transmisión optimizada (más rápida) dentro de una estación S7-400. Infórmese en la
documentación del dispositivo CP utilizado si se soporta este modo de operación.

Requisitos para FETCH/WRITE: Tipo de establecimiento de la conexión
Dependiendo del tipo de estación, seleccione la siguiente opción para el establecimiento de la
conexión en el registro "General":
● Estación SIMATIC S7: Establecimiento PASIVO de la conexión
● Estación PC: Establecimiento activo de la conexión

280

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Opción "Modo de direccionamiento S7" (solo para FETCH/WRITE)
En la configuración para el modo de operación FETCH / WRITE es posible seleccionar aquí el
modo de direccionamiento:
● Modo de direccionamiento S7: Dirección de byte
● Modo de direccionamiento S5: Dirección de palabra
Esto permite que las aplicaciones accedan a las estaciones S5 o S7 sin adaptar las
direcciones. Esto es interesante especialmente para aplicaciones S5 existentes que deben
utilizarse tal como están para acceder a estaciones S7.
El modo de direccionamiento para el acceso a SIMATIC S7 (opción seleccionada) está
seleccionado por defecto.

Consulte también
Configuración de conexión para FETCH/WRITE (Página 293)
Aplicación de FETCH/WRITE (Página 291)

Propiedades OPC TCP
Referencia
Configuración de conexiones en el caso de OPC en el grupo de parámetros "Propiedades >
General > OPC"
Ajuste aquí las propiedades específicas para una conexión TCP utilizada por el servidor OPC.
Se pueden ajustar los parámetros siguientes:

Timeout de petición
Si en el transcurso del tiempo de espera aquí ajustado no es posible procesar una petición
pendiente, la conexión se inicializa y la petición se acusa con un error.
Rango de valores:
● Ajuste predeterminado: 15000 ms

Tamaño del búfer de transmisión
Tamaño predeterminado del búfer de transmisión predeterminado. Durante el tiempo de
ejecución es posible utilizar otros búferes de transmisión adicionales de una longitud
cualquiera (máx. 65535 bytes).
Rango de valores:
● Ajuste predeterminado: 256 bytes
● Rango de valores: 65535 bytes como máximo

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

281

Configuración de dispositivos y redes
1.3 Configurar redes

Optimización de acceso directo a servicios de variable
Si se utiliza esta opción, el servidor OPC intenta agrupar los accesos directos a diferentes
variables de modo que las peticiones que hay que transferir sean las menos posibles.
Dicha opción está activada por defecto.

Utilizar el miniprotocolo
Con esta opción se determina si los datos deben transferirse en TCP como bloques
individuales con una indicación cada uno acerca del tamaño del mismo (2 bytes en el búfer de
peticiones). En este caso, el receptor lee los datos de acuerdo con la indicación de longitud.
Esta propiedad debe configurarse de forma idéntica para ambos interlocutores.
Dicha opción está activada por defecto; el receptor lee los datos de acuerdo con el tamaño
ajustado para el búfer de recepción.
● Tamaño del búfer de recepción
Si no se utiliza ningún miniprotocolo, aquí es posible ajustar el tamaño del búfer de
recepción.
Rango de valores: 0 - 65535 bytes
– Ajuste predeterminado: 256 bytes

Configuración de puerto
Configuración de puerto
Los puertos o las direcciones de los puertos definen el punto de acceso al programa de usuario
dentro de la estación/CPU. ¡Estos deben ser unívocos dentro de la estación/CPU! Encontrará
las particularidades de las conexiones no específicas con interlocutores redundantes en el
apartado de más abajo.
La siguiente tabla aporta información sobre el rango de valores:
Direcciones de puerto

Aplicación/nota

0

Asignado de forma fija; ¡no puede utilizarse!

1..1023

Asignado de forma estándar; no se debería utilizar (well known ports)

1024..49151

Puertos para protocolos específicos de aplicación
a partir de
2000...5000

Rango en el que la herramienta de configuración busca o asigna una
dirección de puerto libre en cada caso.
Es posible ajustar la dirección de puerto en este rango de forma indi‐
vidual.

5001..49151

¡El sistema utiliza las direcciones de puerto a partir de 5000!
Observación:
Si desea utilizar estas direcciones de puerto, contacte en caso dado a
su administrador del sistema para que compruebe su disponibilidad.

49152..65535

Puertos asignados de forma dinámica
Se recomienda no utilizar estos puertos.

282

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Los siguientes números locales de puerto han sido reservados, no deben ser utilizados para
otra finalidad durante la configuración de la conexión.
Número de puerto

Protocolo

Servicio

20, 21

TCP

FTP

25

TCP

SMTP

80

TCP

HTTP

102

TCP

RFC1006

123

UDP (TCP)

NTP *

135

TCP

RPC-DCOM

161

UDP

SNMP_REQUEST

34964

UDP

PN IO

65532

UDP

NTP

65533

UDP

NTP

65534

UDP

NTP

65535

UDP

NTP

* En el CP 443‑1 y el CP 443‑1 Advanced a partir de la versión de firmware V3, el puerto 123 está reservado para NTP.

Números de puerto en conexiones no específicas con interlocutores redundantes
Si se crean conexiones no específicas con un interlocutor redundante, p. ej. desde una S7‑400
con CP a un maestro IEC redundante, en el CP 443‑1 (Advanced) se puede utilizar el mismo
número de puerto local para las dos conexiones TCP no específicas.

Conexión UDP
UDP, detalles de dirección
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General > Detalles de
direcciones".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

283

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros de dirección y tipos de conexión
Para UDP los interlocutores se direccionan mediante el punto final local y remoto como se
indica a continuación.
● Direcciones locales:
Dirección IP local y puerto local
● Direcciones remotas:
Dirección IP remota y puerto remoto
Nota
El término "Conexión" se utiliza aquí también para UDP, ya que para la configuración (así
como p. ej. también para TCP), los interlocutores son asignados entre sí y, por tanto,
quedan "conectados" de forma lógica. En realidad, en la operación de las estaciones no
tiene lugar ningún establecimiento de conexión explícito entre los interlocutores para UDP.
'LVSRVLWLYR(WKHUQHW%

'LVSRVLWLYR(WKHUQHW$

3XHUWR
UHPRWR
3XHUWR
ORFDO
'LUHFFLµQ
,3$

Figura 1-18

&RQH[LµQ
8'3

3XHUWR
ORFDO
3XHUWR
UHPRWR
'LUHFFLµQ
,3%

Emisión y recepción a través de una conexión UDP

Dependiendo del tipo de conexión deseado se especifican o se dejan abiertos los parámetros
de dirección remotos durante la configuración.
● Conexión UDP especificada
Se ha indicado una estación de destino al crear una nueva conexión.
● Conexión UDP especificada como Broadcast
Se ha indicado "Broadcast" como interlocutor al crear una nueva conexión (la conexión se
debe crear primeramente como conexión no especificada a través de cuadros de diálogo
o gráficamente ).
● Conexión UDP especificada como Multicast
Se ha indicado "Multicast" como interlocutor al crear una nueva conexión (la conexión se
debe crear primeramente como conexión no especificada a través de cuadros de diálogo
o gráficamente ).
● Conexión UDP no especificada
Al crear la conexión ha seleccionado el tipo de conexión "sin especificar".

284

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Conexión UDP no especificada
La conexión UDP no especificada puede utilizarse de dos formas:
● Conexión UDP libre
Para configurar una conexión UDP libre seleccione la opción "Asignación de dirección en
el bloque". Ya no es posible introducir los campos de entrada de la dirección IP remota y el
puerto remoto, puesto que ahora el programa de usuario determina las direcciones de
destino.
● Conexión con una "estación ajena" de otro proyecto
Es posible indicar la dirección IP remota y el puerto para una estación de destino
cualquiera. La estación de destino puede encontrarse dentro o fuera del proyecto actual.
Nota
Es preciso especificar las direcciones de interlocutor
Debido a que en UDP no tiene lugar ningún establecimiento de conexión (servicio de
datagramas), la comunicación a través de la conexión UDP configurada solo es posible si
también se han especificado las direcciones de interlocutor (dirección IP y puerto).

Consulte también
Conexiones no especificadas (Página 227)

Conexión con todos los dispositivos Broadcast
Al seleccionar como interlocutores "todos los dispositivos Broadcast" se determina que se
envíen telegramas UDP a todos los dispositivos Broadcast accesibles.
En el grupo de parámetros "Detalles de direcciones" se propone una dirección Broadcast
válida para la red en la dirección IP (IP) para el interlocutor.
En PUERTO se debe introducir una dirección de PUERTO adecuada para todos los
interlocutores a los que se desea acceder.

Configuración de puerto, véase también
Configuración de puerto (Página 290)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

285

Configuración de dispositivos y redes
1.3 Configurar redes

UDP con Broadcast y Multicast
Aplicación
Para la selección del interlocutor, en las conexiones UDP se dispone de dos opciones
adicionales:
● Conexión con todos los dispositivos Broadcast
Al seleccionar como interlocutores "Todos los dispositivos Broadcast" se determina que
serán enviados telegramas UDP a todos los dispositivos Broadcast accesibles.
Nota
En el caso de Broadcast, a través de los CPs S7 únicamente se puede enviar; un CP S7 no
permite recibir datos de usuario a través de las conexiones Broadcast (véase más abajo)
● Conexión con todos los dispositivos Multicast
Al seleccionar como interlocutores "Todos los dispositivos Multicast" se determina que
serán enviados telegramas UDP a todos los dispositivos de un grupo Multicast y que es
posible recibir telegramas Multicast.
Multicast y Broadcast son opciones de conexión especiales que son soportadas y
configurables por CPs Industrial Ethernet en conexiones UDP.
Los telegramas se envían sin acuse ya que el protocolo UDP no prevé confirmaciones. Esto ha
sido previsto así para evitar "desbordamientos de datos" debidos a acuses. Si, por ejemplo, se
envían telegramas a 100 interlocutores, se recibirán 100 acuses (1 por interlocutor)
simultáneamente. El módulo emisor no es capaz de procesar tales caudales de datos.

Consulte también
Crear conexiones UDP/FDL con Multicast/Broadcast (Página 253)

¿Cuándo es preferible usar Multicast en lugar de Broadcast?
La opción de conexión "Multicast" para conexiones UDP ha sido añadida para permitir la
transmisión simultánea de un telegrama a un gran número de interlocutores.
Al contrario que en la opción de conexión Broadcast, en este tipo de conexión también es
posible la recepción de telegramas enviados a varios dispositivos en el círculo Multicast.
Mediante la orientación a un grupo de destinatarios determinado (círculo Multicast) se puede
evitar la carga de los destinatarios no direccionados. Por esta razón, Multicast representa en
cualquier caso una solución mejor que Broadcast cuando se desea enviar telegramas a grupos
de estaciones interlocutoras.

¿Por qué un CP S7 no permite la recepción de datos de usuario en las conexiones Broadcast?
Los CPs S7 no reciben telegramas Broadcast de transferencia de datos de usuario. Solo los
telegramas utilizables, p. ej. solicitud ARP, serán transferidos más allá del controlador LAN y
evaluados. No obstante, con los CPs S7 se pueden enviar telegramas Broadcast a la red.
Motivo:

286

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
A menudo se desea enviar telegramas desde un dispositivo a múltiples dispositivos
interlocutores. En este caso es importante que los telegramas sean enviados simultáneamente
y que también lleguen a los dispositivos interlocutores de forma casi simultánea. Por esta
razón se requiere siempre un envío y recepción de telegramas Broadcast. En el caso de un
mensaje Broadcast, el telegrama es aceptado realmente por todos los dispositivos de la red.
Un caso de aplicación típico es la necesidad de telegramas Broadcast para la búsqueda de una
dirección MAC relacionada con una dirección IP (solicitud ARP).
Por esta razón, un módulo de comunicación debe aceptar en general telegramas Broadcast y
evaluarlos mediante software. En este caso, la gran desventaja consiste en que un número
excesivo de telegramas Broadcast en la red reducen drásticamente el rendimiento. Esto es
debido a que cada uno de los módulos debe procesar todos los telegramas Broadcast a fin de
determinar si son destinatarios de los mismos.
Para evitar estas desventajas, el comportamiento de los CPs S7 en referencia al Broadcast es
el siguiente:
● Tras la recepción, se filtran los telegramas Broadcast en todos los CPs Ethernet con la
máxima prioridad. Esto significa que todos los telegramas que no sean utilizables serán
directamente eliminados. Solo los telegramas utilizables, p. ej. solicitud ARP, serán
transferidos más allá del controlador LAN y evaluados. De esta forma se evita un posible
efecto negativo de los telegramas Broadcast sobre el resto de las conexiones.

Grupo de parámetros "Detalles de direcciones": conexión con todos los dispositivos Multicast
Al seleccionar como interlocutores "Todos los dispositivos Multicast" se determina lo siguiente:
● Los telegramas UDP enviados son entregados a todos los dispositivos Multicast accesibles
del grupo Multicast;
● El dispositivo local para telegramas Multicast está preparado para la recepción en el grupo
Multicast indicado.
El círculo Multicast se determina mediante la dirección IP y las direcciones de los puertos.
En la dirección IP (IP) para el interlocutor se propone una dirección IP válida en la red para
conjuntos Multicast. En cada caso, el interlocutor para Multicast es un grupo de destinatarios
(grupo Multicast).
Para todos los interlocutores a los que se desea llegar es necesario introducir en PUERTO una
dirección de PUERTO. Debe ser adecuada para todos los interlocutores.
En principio es posible dirigirse a varios conjuntos Multicast bajo una dirección IP. Para ello es
posible crear varias conexiones UDP con la misma dirección IP pero diferentes direcciones de
PUERTO.

Nota
Es preciso asignar direcciones de puerto idénticas para el puerto local y el puerto del
interlocutor dentro de un círculo Multicast. ¡Solo de esta manera es posible enviar y recibir
telegramas desde el CP dentro de un círculo Multicast!
Tenga en cuenta el siguiente ejemplo para tres dispositivos en el círculo Multicast:

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

287

Configuración de dispositivos y redes
1.3 Configurar redes
'LVSRVLWLYR(WKHUQHW$
&RQH[LµQ8'3

,3JUXSR0XOWLFDVW

38(572ORFDO

38(572JUXSR0XOWLFDVW
'LVSRVLWLYR(WKHUQHW%

&RQMXQWR0XOWLFDVWFRQ
GLUHFFLµQ,3
'LUHFFLµQGH38(572


&RQH[LµQ8'3

,3JUXSR0XOWLFDVW

38(572ORFDO

38(572JUXSR0XOWLFDVW
1RGR(WKHUQHW&
&RQH[LµQ8'3

,3JUXSR0XOWLFDVW

38(572ORFDO

38(572JUXSR0XOWLFDVW

Figura 1-19

Envío y recepción en un círculo Multicast a través de direcciones de puerto idénticas

Direcciones IP para Multicast IP
● Rango de valores
Para Multicast IP pueden utilizarse las direcciones IP desde 224.0.0.0 hasta
239.255.255.255.
Debido a que las direcciones IP hasta 224.0.0.255 han sido reservadas para fines
especiales, se recomienda utilizar para Multicast IP las direcciones IP a partir de 224.0.1.0
(ajuste por defecto).
● Identificación del círculo Multicast
La identificación de un círculo Multicast no se realiza mediante la dirección IP completa; en
realidad se ignoran el primer byte de dirección y el bit de mayor peso del segundo byte de
dirección. Esta es una particularidad importante ya que de esta forma es posible direccionar
direcciones IP aparentemente diferentes del mismo círculo Multicast.
Ejemplo:
Las siguientes direcciones IP direccionan en cada caso el mismo círculo Multicast.
'LUHFFLµQ0XOWLFDVWUHVXOWDQWH

'LUHFFLµQ,3













288

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Conexión UDP libre
Direccionamiento controlado por el programa
Una conexión UDP libre permite direccionar el interlocutor de forma controlada por el
programa. La comunicación entre dos dispositivos en Industrial Ethernet tiene las siguientes
propiedades:
● La transferencia de datos es bidireccional, es decir, en la conexión UDP es posible enviar
y recibir de forma simultánea.
● El dispositivo local ha sido fijado mediante configuración. El programa de usuario registra
el dispositivo remoto en el encabezado de la petición del búfer de peticiones en la llamada
de AG_SEND. De esta forma es posible acceder a cada dispositivo de Ethernet/LAN/WAN.
● En el encabezado de la petición de AG_RECV es posible leer la dirección IP y el puerto del
emisor.
(VWDFLµQ6,0$7,&6
FRQ&3(WKHUQHW

'LVSRVLWLYR
(WKHUQHW
QRHVSHFLILFDGR

UHDGHGDWRVGHXVXDULR
%¼IHUGHSHWLFLRQHV
(QFDEH]DGRGHOD
SHWLFLµQ

HQYLDU

'DWRVGHXVXDULR

5HFLELU

Figura 1-20

&RQH[LµQ8'3
QRHVSHFLILFDGD

5HFLELU
HQYLDU

Emisión y recepción a través de una conexión UDP no especificada: direccionamiento
por programa

Volumen de datos y equipamiento
Consulte cuántas conexiones UDP soporta cada CP Ethernet en el manual de producto que
acompaña al CP Ethernet. Mediante la aceptación de otros CPs es posible aumentar el
número de conexiones por estación.
Por cada búfer de peticiones es posible transmitir hasta 2042 bytes de datos de usuario. El
encabezado de la petición ocupa adicionalmente 6 bytes.

Opciones UDP
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General > Opciones"

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

289

Configuración de dispositivos y redes
1.3 Configurar redes

Modo de operación
● SEND/RECV:
Es el modo estándar con las FCs AG_SEND/AG_LSEND y AG_RECV/AG_LRECV.
● SPEED SEND/RECV
Al seleccionar el modo de operación SPEED SEND/RECV se permite la utilización de las
instrucciones AG_SSEND y AG_SRECV.
Las instrucciones AG_SSEND/AG_SRECV (SPEED SEND/RECEIVE) ofrecen una
transmisión optimizada (más rápida) dentro de una estación S7-400. Infórmese en la
documentación del dispositivo CP utilizado si se soporta este modo de operación.

Configuración de puerto
Configuración de puerto
Los puertos o las direcciones de los puertos definen el punto de acceso al programa de usuario
dentro de la estación/CPU. ¡Estos deben ser unívocos dentro de la estación/CPU! Encontrará
las particularidades de las conexiones no específicas con interlocutores redundantes en el
apartado de más abajo.
La siguiente tabla aporta información sobre el rango de valores:
Direcciones de puerto

Aplicación/nota

0

Asignado de forma fija; ¡no puede utilizarse!

1..1023

Asignado de forma estándar; no se debería utilizar (well known ports)

1024..49151

Puertos para protocolos específicos de aplicación
a partir de
2000...5000

Rango en el que la herramienta de configuración busca o asigna una
dirección de puerto libre en cada caso.
Es posible ajustar la dirección de puerto en este rango de forma indi‐
vidual.

5001..49151

¡El sistema utiliza las direcciones de puerto a partir de 5000!
Observación:
Si desea utilizar estas direcciones de puerto, contacte en caso dado a
su administrador del sistema para que compruebe su disponibilidad.

49152..65535

Puertos asignados de forma dinámica
Se recomienda no utilizar estos puertos.

Los siguientes números locales de puerto han sido reservados, no deben ser utilizados para
otra finalidad durante la configuración de la conexión.
Número de puerto

Protocolo

Servicio

20, 21

TCP

FTP

25

TCP

SMTP

80

TCP

HTTP

102

TCP

RFC1006

123

UDP (TCP)

NTP *

135

TCP

RPC-DCOM

161

UDP

SNMP_REQUEST

290

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Número de puerto

Protocolo

Servicio

34964

UDP

PN IO

65532

UDP

NTP

65533

UDP

NTP

65534

UDP

NTP

65535

UDP

NTP

* En el CP 443‑1 y el CP 443‑1 Advanced a partir de la versión de firmware V3, el puerto 123 está reservado para NTP.

Números de puerto en conexiones no específicas con interlocutores redundantes
Si se crean conexiones no específicas con un interlocutor redundante, p. ej. desde una S7‑400
con CP a un maestro IEC redundante, en el CP 443‑1 (Advanced) se puede utilizar el mismo
número de puerto local para las dos conexiones TCP no específicas.

Modo de operación FETCH/WRITE
Aplicación de FETCH/WRITE
FETCH/WRITE
Los servicios FETCH/WRITE permiten acceder a áreas de memoria del sistema de la CPU S7.
● FETCH: Leer datos directamente
● WRITE: Escribir datos directamente
El acceso es posible desde los siguientes dispositivos:
● SIMATIC S5
● Estaciones PC SIMATIC
● Dispositivos ajenos

Tipos de conexión
Los servicios FETCH/WRITE pueden configurarse y utilizarse con SIMATIC S7 en los
siguientes tipos de conexión:
● Conexiones de transporte ISO
● Conexiones ISO on TCP
● Conexiones TCP

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

291

Configuración de dispositivos y redes
1.3 Configurar redes

Memoria de sistema
Mediante FETCH o WRITE es posible acceder a las siguientes áreas de operandos en la
memoria de sistema de SIMATIC S7:
● Bloques de datos (DB)
(tenga en cuenta la siguiente limitación para el acceso a DB: el número máximo de DB es
255)
● Marcas (M)
● Memoria imagen de proceso de las entradas (PAE)
● Memoria imagen de proceso de las salidas (PAA)
● Área de periferia de las entradas (PEW, PED, PEB)
● Área de periferia de las salidas (PAW, PAD, PAB)
● Contadores (Z)
● Temporizadores (T)

Acoplamiento con sistemas ajenos
FETCH y WRITE pueden utilizarse en principio desde cualquier dispositivo ajeno para el
acceso a áreas de memoria del sistema S7.
Para que sea posible implementar este acceso también p. ej. para aplicaciones de PC, es
necesario conocer la estructura de PDU para las peticiones. Tenga en cuenta para ello la
documentación del dispositivo.

Mensajes en el búfer de diagnóstico
Debido a los accesos FETCH/WRITE pueden darse confirmaciones negativas por parte de la
CPU S7. Esto lleva a las correspondientes entradas orientadas a la conexión en el búfer de
diagnóstico.
Tabla 1-5

Codificación de mensajes en el búfer de diagnóstico en FETCH/WRITE

Codificación

Significado

01H

Error de hardware

03H

No se permite el acceso al objeto.

05H

Dirección no válida (ID de sintaxis, rango, tipo, número de bit)

06H

No se soporta el tipo de datos.

07H

El tipo de datos no es coherente.

0AH

El objeto no existe o se ha superado el final del área.

FFH

Error interno de protocolo

Información adicional
La estructura de PDU para el acceso desde sistemas ajenos se describe en la documentación
de dispositivos para CPs S7.

292

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Configuración de conexión para FETCH/WRITE
Configurar el modo de operación en función del tipo de dispositivo
Según el tipo de estación es posible configurar los siguientes modos de operación para el
punto final de la conexión:
● Estación SIMATIC S7: FETCH PASIVO / WRITE PASIVO
Seleccionando uno de los modos de operación FETCH PASIVO o WRITE PASIVO para la
conexión, es posible realizar accesos directos a las áreas de memoria del sistema en la
SIMATIC S7 desde una estación SIMATIC S5 o una estación ajena (conexión no
especificada).
La conexión puede entonces utilizarse exclusivamente para este modo de operación. En
este caso no es posible enviar o recibir mediante las FCs AG_SEND/AG_LSEND o
AG_RECV/AG_LRECV.
El establecimiento de conexión tiene lugar de forma pasiva, es decir, solo la estación
interlocutora (estación SIMATIC S5, estación PC o una estación ajena) puede establecer
la conexión. El ajuste correspondiente se realiza en "Propiedades > Opciones". Después
de seleccionar el modo de operación ya no es posible modificar el tipo de establecimiento
de conexión.
● Estación PC SIMATIC: FETCH ACTIVO / WRITE ACTIVO
Seleccionando uno de los modos de operación FETCH ACTIVO o WRITE ACTIVO se
pueden efectuar accesos directos a las áreas de memoria del sistema en la estación
SIMATIC S7 o SIMATIC S5 desde la estación PC.
El establecimiento de conexión tiene lugar de forma activa, es decir, la estación
interlocutora debe esperar al establecimiento de conexión (establecimiento de conexión
pasivo en el interlocutor). El ajuste correspondiente se realiza en "Propiedades >
Opciones". Después de seleccionar el modo de operación ya no es posible modificar el tipo
de establecimiento de conexión.

Opción "Modo de direccionamiento S7"
En la configuración para el modo de operación FETCH ACTIVO/WRITE ACTIVO es posible
seleccionar el modo de direccionamiento. De esta manera se determina la forma en la que
debe interpretarse la indicación de la dirección en la llamada FETCH/WRITE en la estación
SIMATIC S7 para el acceso a DBs:
● Modo de direccionamiento S7: Dirección de byte
● Modo de direccionamiento S5: Dirección de palabra
Esto permite que las aplicaciones accedan a las estaciones S5 o S7 sin adaptar las
direcciones. Esto es interesante especialmente para aplicaciones S5 existentes que deben
utilizarse tal como están para acceder a estaciones S7.
El modo de direccionamiento para el acceso a SIMATIC S7 (opción seleccionada) está
seleccionado por defecto.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

293

Configuración de dispositivos y redes
1.3 Configurar redes

Conexión FDL
Conexiones FDL: sinopsis
Aplicación
La transferencia de datos a través de una conexión FDL configurada es adecuada para la
transmisión de bloques de datos relacionados entre dos o más dispositivos PROFIBUS.
Debe distinguirse entre
● Conexión FDL especificada
Los dispositivos interlocutores se han definido de forma unívoca mediante la configuración
de la conexión.
El interlocutor puede encontrarse dentro o fuera del proyecto STEP7.
● Conexión FDL no especificada (acceso libre Layer 2)
La dirección del interlocutor permanece abierta durante la configuración. Los dispositivos
interlocutores se determinan mediante la indicación de direcciones en la petición de
comunicación del programa de usuario. De esta forma es posible acceder a hasta 126
dispositivos a través de una conexión FDL configurada no especificada, en tanto dichos
dispositivos soporten conexiones FDL.
El interlocutor puede encontrarse dentro o fuera del proyecto.
● Conexión FDL con Broadcast
Se accede a todos los dispositivos de PROFIBUS preparados para la recepción en
Broadcast.
● Conexión FDL con Multicast
Se accede a todos los dispositivos de PROFIBUS que pertenecen al conjunto Multicast.
Nota
Requisitos para la configuración
Si se utilizan conexiones FDL, no se permite ajustar el modo de operación CP del CP de
PROFIBUS como esclavo DP pasivo.
Nota
Prioridad de los telegramas
Tenga en cuenta que los CPs de PROFIBUS para SIMATIC S7 envían los telegramas con la
prioridad "LOW".
Las estaciones interlocutoras (SIMATIC S5, S7 o estaciones ajenas) deben utilizar asimismo
la prioridad "LOW", ya que de lo contrario no tiene lugar ningún establecimiento de conexión.

294

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

FDL, detalles de dirección
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General > Detalles de
direcciones".

Parámetros de dirección en conexiones FDL
Una conexión FDL se especifica mediante los puntos finales local y remoto de la conexión.
Esto incluye:
● Dirección PROFIBUS del dispositivo al que se desea acceder.
● LSAP (Link ServiceAccessPoint) local:
El LSAP local controla la disponibilidad para la recepción del CP PROFIBUS. Para el LSAP
se proporcionan en el CP de PROFIBUS los recursos de recepción para la recepción de
datos en la conexión FDL.
● LSAP (Link ServiceAccessPoint) remoto:
El LSAP remoto controla el servicio de envío en el CP PROFIBUS. El CP PROFIBUS envía
a través del LSAP al dispositivo a través de la conexión FDL. El dispositivo de destino debe
estar preparado para la recepción desde este SAP.

Conexión FDL especificada
En una conexión FDL especificada se muestra la información de direcciones locales y remotas
relevantes en forma de valores propuestos. En caso necesario, tiene la posibilidad de ajustar
de forma individual las direcciones LSAP.

Conexión FDL no especificada
La conexión FDL no especificada puede utilizarse de dos formas:
● Conexión con una "estación ajena" de otro proyecto
Es posible indicar la dirección PROFIBUS remota y el LSAP para una estación de destino
cualquiera. La estación de destino puede encontrarse dentro o fuera del proyecto STEP 7
actual.
En tanto no se haya especificado la dirección remota, no es posible la comunicación a
través de la conexión FDL.
● Acceso libre Layer -2
Para configurar un acceso libre Layer 2, seleccione la casilla de verificación
correspondiente. Ya no es posible introducir los campos de entrada de la dirección
PROFIBUS remota y el LSAP remoto, puesto que ahora el programa de usuario determina
las direcciones de destino.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

295

Configuración de dispositivos y redes
1.3 Configurar redes

Conexión FDL con Broadcast
En la conexión FDL con Broadcast, los parámetros de dirección remota están ajustados de
forma fija. Es posible acceder a todos los dispositivos Broadcast a través de la dirección
PROFIBUS 127. Todos los dispositivos Broadcast reciben los datos de recepción a través del
LSAP 63.
Durante el envío, los parámetros de dirección local se incluyen en el encabezado de la petición
del mensaje y se envían al destinatario. El programa de usuario del interlocutor remoto puede
determinar quién es el emisor del telegrama Broadcast mediante dichos parámetros.
Nota
El CP recibe solo en una conexión Broadcast
Si se utiliza una conexión FDL con Broadcast, no es posible utilizar ninguna otra conexión
Broadcast en el CP en cuestión.
PRECAUCIÓN
Función "Activar difusión cíclica de los parámetros de bus"
Si se ha activado esta opción para la subred en "General > Parámetros de bus", los
parámetros de bus se envían cíclicamente como telegramas Broadcast durante el
funcionamiento. A fin de evitar conflictos durante la manipulación de los telegramas en el
programa de usuario encargado de recibir telegramas Broadcast, proceda del siguiente
modo:
● Ignore todos los telegramas enviados con un LSAP >56;
o
● Desactive la opción mencionada en "General > Parámetros de bus".

Conexión FDL con Multicast
En la conexión FDL con Multicast, los parámetros de dirección remota están ajustados de
forma fija. Es posible acceder a todos los dispositivos Multicast a través de la dirección
PROFIBUS 127. Todos los dispositivos del círculo Multicast envían y reciben datos a través del
mismo LSAP (rango de 1 a 56). Por esta razón, el valor del LSAP solo se puede seleccionar
de forma local y se acepta de forma automática en el LSAP remoto.
Durante el envío, los parámetros de dirección local se incluyen en el encabezado de la petición
del mensaje y se envían al destinatario. El programa de usuario del interlocutor remoto puede
determinar quién es el emisor del telegrama Multicast mediante dichos parámetros.

Opciones FDL
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General > Opciones"

296

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Modo de operación
● SEND/RECV:
Es el modo estándar con las FCs AG_SEND/AG_LSEND y AG_RECV/AG_LRECV. En las
conexiones FDL, este modo de operación es el predeterminado y no se puede modificar.

Propiedades OPC FDL
Referencia
Configuración de conexiones en el caso de OPC en el grupo de parámetros "Propiedades >
General > OPC"
Ajuste aquí las propiedades específicas para una conexión FDL utilizada por el servidor OPC.
Se pueden ajustar los parámetros siguientes:

Tiempo de espera de errores
Si dentro del tiempo de espera no es posible procesar una petición pendiente, la conexión se
reseteará y la petición se acusará con error.

N.º máx. de repeticiones de transmisión
Indique aquí cuántas repeticiones de transmisión deben realizarse para una petición si el
interlocutor no está accesible debido a una falta temporal de recursos, por ejemplo.

Tamaño del búfer de transmisión
Aquí se predefine el tamaño del búfer de transmisión predeterminado.
El ajuste realizado sirve tanto para transmisiones acusadas como no acusadas.
Durante el tiempo de ejecución es posible utilizar búferes de transmisión adicionales de una
longitud cualquiera (máx. 244 ó 246 bytes).
Ajuste predeterminado:
244 bytes o 246 bytes (en SAPs predeterminados, cuando se ha ajustado el SAP
predeterminado 255 para el SAP local y remoto)

N.º máx. de peticiones de transmisión en paralelo
Número máximo de peticiones de transmisión paralelas en la conexión configurada aquí.

Número de recursos para las peticiones recibidas
Indique el número de peticiones de recepción que el servidor OPC de la conexión FDL aquí
configurada debe estar preparado para recibir simultáneamente.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

297

Configuración de dispositivos y redes
1.3 Configurar redes
Elija un valor equivalente al número de comunicaciones esperadas; es decir,
● En un número reducido de conexiones totales: elegir el valor más bien alto para asegurar
un tiempo de reacción rápido.
● En un número elevado de conexiones totales: elegir el valor más bien bajo para impedir
conflictos de recursos.
– Ajuste predeterminado: 3

Enviar con prioridad alta
Indique si los telegramas FDL deben enviarse preferentemente vía LAN en la conexión
configurada (opción activada).

Conexión FDL no especificada (acceso libre Layer 2)
Propiedades
Una conexión FDL no especificada con acceso libre Layer 2 permite el direccionamiento del
interlocutor controlado por el programa y la comunicación entre dos dispositivos de
PROFIBUS con las siguientes propiedades:
● La transferencia de datos es bidireccional, es decir, en la conexión FDL es posible enviar
y recibir de forma simultánea.
● El dispositivo local ha sido fijado mediante configuración. El programa de usuario registra
el dispositivo remoto en el encabezado de la petición del búfer de peticiones al llamar la
instrucción AG_SEND. De esta forma es posible acceder a todos los dispositivo de
PROFIBUS (direcciones PROFIBUS de 0 a 126).
● En el encabezado de la petición de AG_RECV es posible leer la dirección PB, el LSAP y el
servicio del emisor.
La siguiente representación ilustra el direccionamiento controlado por el programa en el búfer
de peticiones:
'LVSRVLWLYR6,0$7,&6
FRQ&3GH352),%86

'LVSRVLWLYR
352),%86
QRHVSHFLILFDGR

UHDGHGDWRVGHXVXDULR
%¼IHUGHSHWLFLRQHV
(QFDEH]DGRGHOD
SHWLFLµQ
(QFDEH]DGRGHOD
SHWLFLµQ
'DWRVGHXVXDULR

298

HQYLDU
5HFLELU

&RQH[LµQ)'/
QRHVSHFLILFDGD

5HFLELU
HQYLDU

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Volumen de datos y equipamiento
Por cada búfer de peticiones es posible transmitir hasta 236 bytes de datos de usuario. El
encabezado de la petición ocupa adicionalmente 4 bytes.

Conexión FDL con Broadcast
Propiedades
Una conexión Broadcast permite enviar un mensaje a varios destinatarios con una petición.
Del mismo modo, es posible recibir mensajes en la misma conexión Broadcast que serán
recibidos al mismo tiempo por otros dispositivos de PROFIBUS.
Es posible resumir las propiedades como sigue:
● La transferencia de datos es bidireccional, es decir, en la conexión Broadcast es posible
enviar y recibir de forma simultánea.
● El envío y la recepción se realizan mediante el servicio FDL SDN (Send Data with No
Acknowledge).
● La llamada de AG_SEND requiere un búfer de peticiones al enviar. Es necesario reservar
el encabezado de la petición de este búfer.
● En el encabezado de la petición de AG_RECV es posible leer la dirección PB, el LSAP y el
servicio del emisor Broadcast.
● Para el envío se utiliza el rango LSAP de 1 a 56. Para la recepción se reserva el LSAP 63
para todos los dispositivos Broadcast.
La siguiente representación ilustra la emisión y recepción a través de una conexión FDL con
direccionamiento Broadcast por programa:
'LVSRVLWLYR6,0$7,&6
&RQ&3GH352),%86
UHDGHGDWRVGHXVXDULR
%¼IHUGHSHWLFLRQHV

(QYLDU

(QFDEH]DGRGHOD
SHWLFLµQ

'DWRVGHXVXDULR

/6$3 
&RQH[LµQ)'/
FRQ%URDGFDVW

5HFLELU

/6$3 

Configuración de una conexión FDL con Broadcast
Al crear la conexión FDL, como interlocutor/estación "Todos los dispositivos Broadcast".

Consulte también
Crear conexiones UDP/FDL con Multicast/Broadcast (Página 253)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

299

Configuración de dispositivos y redes
1.3 Configurar redes

Volumen de datos y equipamiento
El CP de PROFIBUS soporta en cada caso una conexión Broadcast.
Por cada búfer de peticiones es posible transmitir hasta 236 bytes de datos de usuario. El
encabezado de la petición ocupa adicionalmente 4 bytes.
Nota
El CP recibe solo en una conexión Broadcast
Si se utiliza una conexión FDL con Broadcast, no es posible recibir mensajes en ninguna otra
conexión Broadcast del CP en cuestión y tampoco en ninguna conexión FMS con Broadcast.
Motivo:
El LSAP de recepción para Broadcast (63) está ocupado por una conexión Broadcast.

Conexión FDL con Multicast
Propiedades
Una conexión FDL con Multicast permite el envío de un mensaje a varios destinatarios de un
círculo Multicast mediante una petición.
Es posible resumir las propiedades como sigue:
● La transferencia de datos es bidireccional, es decir, en la conexión FDL con Multicast es
posible enviar y recibir de forma simultánea.
● El envío y la recepción se realizan mediante el servicio FDL SDN (Send Data with No
Acknowledge).
● El envío se realiza a través de un LSAP unívoco para el círculo Multicast (rango de 1 a 56).
● La llamada de AG_SEND requiere un búfer de peticiones al enviar. Es necesario reservar
el encabezado de la petición de este búfer.
● En el encabezado de la petición de AG_RECV es posible leer la dirección PB, el LSAP y el
servicio del emisor Multicast.
La siguiente representación ilustra la emisión y recepción a través de una conexión FDL con
direccionamiento Multicast por programa:

300

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

'LVSRVLWLYR6,0$7,&6
FRQ&3GH352),%86
UHDGHGDWRVGHXVXDULR
%¼IHUGHSHWLFLRQHV

HQYLDU

FRQH[LµQ)'/
FRQ0XOWLFDVW

(QFDEH]DGRGHOD
SHWLFLµQ
(QFDEH]DGRGHOD
SHWLFLµQ
'DWRVGHXVXDULR

5HFLELU

/6$3 ORFDO /6$3 UHPRWR 

'DWRVGHXVXDULR

Conjunto
Multicast

Configuración de conexión FDL con Multicast
Al crear la conexión FDL, seleccione como interlocutor/estación "Todos los dispositivos
Multicast".

Consulte también
Crear conexiones UDP/FDL con Multicast/Broadcast (Página 253)

Volumen de datos y equipamiento
Consulte el número de conexiones FDL soportadas por cada CP de PROFIBUS en la
documentación de dispositivo relativa al CP de PROFIBUS. Mediante la aceptación de otros
CPs es posible aumentar el número de conexiones por estación.
Por cada búfer de peticiones es posible transmitir hasta 236 bytes de datos de usuario. El
encabezado de la petición ocupa adicionalmente 4 bytes.

Configurar la comunicación vía FDL
Requisitos
● Software de configuración: STEP 7 Professional V14
● Punto final de la conexión: CPU S7-1500 a partir de la versión de firmware V2.0 con el
módulo de comunicación CM 1542‑5 con la versión de firmware V2.0

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

301

Configuración de dispositivos y redes
1.3 Configurar redes

Crear una conexión FDL configurada
Para crear en STEP 7 una conexión FDL configurada, proceda del siguiente modo:
1. Cree una instrucción TSEND_C en el editor de programas.
2. Seleccione la instrucción TSEND_C y navegue a "Propiedades" > "General" > "Parámetros
de conexión" en la ventana de inspección.
3. Seleccione el punto final del interlocutor en Punto final. Utilice uno de los dos puntos finales
del interlocutor siguientes:
– CPU S7‑1500 con CM 1542‑5
– No especificada
4. En tipo de configuración elija "Utilizar conexión configurada de".
5. En tipo de conexión, seleccione "FDL".
6. Seleccione las siguientes interfaces en Interfaz:
– Local: interfaz PROFIBUS del CM 1542‑5
– Interlocutor especificado: interfaz PROFIBUS del CM 1542‑5
7. En Datos de conexión seleccione el ajuste <nuevo>.
La figura siguiente muestra una conexión FDL completamente configurada en STEP 7.

Figura 1-21

302

Configurar una conexión FDL

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Configurar una conexión FDL en el programa de usuario
Para la comunicación vía FDL, el propio usuario debe crear el bloque de datos del tipo de datos
del sistema TCON_FDL, parametrizarlo y llamarlo directamente en la instrucción. Proceda del
siguiente modo:
1. Cree un bloque de datos global en el árbol del proyecto.
2. Defina en el bloque de datos global una variable del tipo de datos TCON_FDL.
El ejemplo siguiente muestra el bloque de datos global "FDL_connection" en el que está
definida la variable "FDL_connection" del tipo de datos TCON_FDL.

Figura 1-22

Programar una conexión FDL

3. Programe los parámetros de la conexión FDL (p. ej. las direcciones PROFIBUS) en la
variable del tipo de datos TCON_FDL.
4. Cree una instrucción TCON en el editor de programas.
5. Interconecte el parámetro CONNECT de la instrucción TCON con la variable del tipo de
datos TCON_FDL.
En el siguiente ejemplo el parámetro CONNECT de la instrucción TCON está
interconectado con la variable "FDL_Connection" (tipo de datos TCON_FDL).

Figura 1-23

Ejemplo: Instrucción TCON para conexión FDL

Conexión de correo electrónico
Establecer una conexión de correo electrónico
El sistema de automatización puede enviar correo electrónico pero no puede recibirlo.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

303

Configuración de dispositivos y redes
1.3 Configurar redes
Para el envío de correo electrónico en el programa de usuario de la CPU S7 se utiliza la
llamada de envío de la interfaz SEND/RECEIVE (FC AG_SEND / AG_LSEND).

Sinopsis para la configuración
Configure para el envío de correos electrónicos exactamente una conexión de correo
electrónico por CP. Mediante la conexión de correo electrónico se determina el servidor de
correo a través del cual se entrega todo el correo electrónico enviado por el CP.
Es posible establecer una conexión de correo electrónico como sigue:
● Configuración de conexión (aplicación estándar)
Este caso de aplicación se describe a continuación.
● Programa de usuario con FB CP_CONFIG y bloque de datos de configuración
Existen áreas de aplicación en las que es ventajoso establecer las conexiones no a través
de la interfaz de configuración, sino a través de aplicaciones específicas de forma
controlada por programa.

Procedimiento: ejemplo de configuración gráfica
A continuación se describe la configuración de una conexión de correo electrónico. En
principio, proceda como en el caso de una conexión no especificada: Crear una conexión no
especificada (Página 251).
Seleccione el tipo de conexión de correo electrónico en la lista desplegable.
De esta forma se activa el modo de conexión: Las CPUs posibles para el tipo de conexión
seleccionado han sido seleccionadas y se representan resaltadas.
1. Haga clic en la CPU de la que deba partir una conexión.
2. Desplace el puntero del ratón dentro de la CPU y confirme el punto final de la conexión
mediante un nuevo clic.
Se ha creado una conexión no especificada.
3. Introduzca los parámetros de dirección en "Propiedades > Detalles de direcciones" de la
ventana de inspección conforme a los datos de los detalles de direcciones:
Detalles de la dirección de correo electrónico (Página 305)
Tras la carga de los datos de configuración, el programa de usuario puede enviar correos
electrónicos a través de esta conexión.

304

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Uso del servidor OPC como servidor SMTP
En lugar de seleccionar una conexión no especificada, aquí puede seleccionar como
interlocutor un servidor OPC como servidor SMTP. Con ello, en los detalles de direcciones del
interlocutor se introduce automáticamente la dirección IP de la interfaz SMTP de la estación
PC.
Nota
La interfaz del PC debe ser compatible con el protocolo SMTP
La conexión de correo electrónico a través del servidor OPC sólo se crea de manera coherente
si en la estación PC está activada una interfaz compatible con el protocolo SMTP. Tenga en
cuenta la información recogida en la documentación del módulo utilizado.

Detalles de la dirección de correo electrónico
Referencia
Configuración de conexiones en el grupo de parámetros "Propiedades > General > Detalles de
direcciones".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

305

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros
Introduzca los parámetros necesarios para el envío del correo electrónico. Pueden introducirse
los parámetros siguientes:
Parámetros

Descripción

Servidor de correo
electrónico (SMTP)

Dirección del servidor de correo a través del que se envían los co‐ absoluto:140.80.0.4
rreos electrónicos.
simbólico:t-online.de
La dirección IP puede indicarse en formato absoluto o simbólico.

Ejemplo

Para la entrada simbólica rige lo siguiente:
Un nombre válido tiene entre 1 y 64 caracteres; de ellos, 1 carácter
como mínimo debe ser una letra.
Si en la entrada se utilizan uno o varios caracteres ".", rige además:
Un nombre válido tiene detrás del último "." entre 1 y 3 caracteres;
de ellos, 1 carácter como mínimo debe ser una letra.
Para el formato simbólico es imprescindible que el CP Internet co‐
nozca la dirección del Domain Name System (DNS). Se debe rea‐
lizar una entrada a este respecto en la configuración DNS al confi‐
gurar el CP para Internet.
Pueden introducirse 64 caracteres como máximo
Nombre predetermina‐
do del remitente

Indicación de una dirección que se insertará como dirección del
remitente en el correo electrónico siempre que la información del
remitente (parámetro FROM) esté vacía en el encabezado del co‐
rreo electrónico.

Sta‐
tion2.CPU412@xy.werk2.de

Este dato no suele ser relevante para el envío de mensajes. Sirve
de información para el destinatario del correo electrónico. Puesto
que algunos servidores de correo no transmiten peticiones si el
campo del remitente está vacío, es recomendable realizar una en‐
trada.
Pueden introducirse 126 caracteres como máximo.
Nota:
Tenga en cuenta que hay que indicar un nombre predeterminado de
remitente si debe lanzarse un mensaje de test desde el diagnóstico
especial.

Enviar un mensaje de correo electrónico
Procedimiento
Para enviar un mensaje de correo electrónico es necesario realizar los siguientes pasos:
1. Se preparan los datos de correo electrónico en un bloque de datos.
2. Se utiliza la instrucción AG_SEND o AG_LSEND en el programa de usuario.

Requisitos
Es posible enviar correo electrónico si se ha establecido la conexión de correo electrónico
mediante la configuración de conexión. Se utiliza la ID definida durante la configuración de
conexión al realizar la llamada a FC AG_SEND/AG_LSEND.

306

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Bloque de datos
Todo el mensaje de correo electrónico, es decir, los datos de dirección y el propio mensaje, se
generan en cualquier bloque de datos. A continuación se incluyen los datos correspondientes
para la estructura de DB necesaria a partir de un ejemplo en notación AWL.
Utilice el editor de programación para crear e introducir los datos de DB.
La siguiente tabla contiene información acerca de los bloques de datos de correo electrónico
en notación AWL.
Dirección

Nombre

0.0

Tipo

Valor inicial

Comentario

Entrada

'TO:name.name@t-online.de;'

Destinatario

Obligatorio

STRUCT

+0.0

TO1)

STRING[40]

+42.0

CC

STRING[40]

'CC:name.name@t-online.de;'

CC destinatario

Opcional

+84.0

FROM

STRING[40]

'FROM:anlage.werk2@xyz-onli‐
ne.de;'

Remitente

Opcional

+126.0

SUB

STRING[40]

'SUB:Status Station 7;'

Asunto

Opcional

+168.0

Texto

STRING[100]

'TXT:Fallo en la sección 2 de la ins‐ Texto del mensaje de
talación;'
correo

Obligatorio

+270.0

Anexo

STRING[4]

'BNY:'

Aquí comienza el ane‐
xo3)

Opcional

+276.0

Valor1

BYTE

B#16#272)

Anexo/valor binario3)

Opcional

+277.0

Valor2

BYTE

B#16#03

Anexo/valor binario

Opcional

=278.0

1)

2)

3)

END_STRUCT

1) Se pueden indicar varios destinatarios. Las indicaciones deben separarse mediante comas.
2) Los datos marcados en negrita se entregan al destinatario como anexo
3) También es posible aportar los datos de forma dinámica.

Indicaciones relativas a la tabla
● Estructura y sintaxis de los datos en el DB de correo electrónico
La estructura propuesta aquí con varios STRINGs es una de varias variantes. Son
decisivas las entradas de la columna "Valor inicial" con los identificadores contenidos en
ella (TO:, SUB:, CC:, FROM:, TXT:, BNY:), los cuales deben utilizarse exactamente con
esta notación en el DB para la identificación de los contenidos del mensaje de correo. Es
necesario cerrar aquí todas las entradas con un punto y coma; solo en la última entrada
puede prescindirse del punto y coma.
La longitud del string se indica en la tabla solo a modo de ejemplo; es posible adaptarla al
número real de caracteres (excepción: La longitud del string para la identificación del anexo
debe indicarse con [4]).
Otra variante sería, por ejemplo, utilizar solo un STRING en total y asignar al mismo el texto
completo con los identificadores.
● Si la introducción del carácter @ supone un problema, utilice la entrada ALT+64.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

307

Configuración de dispositivos y redes
1.3 Configurar redes
● Anexos
Los datos útiles introducidos en el DB del correo electrónico también pueden ser
entregados al destinatario en conjunto o parcialmente como anexo. Para ello, el remitente
debe añadir a los datos el identificador 'BNY:' .
Los datos introducidos a continuación de este identificador se entregan entonces al
destinatario como anexo.
En la tabla, el anexo tiene 2 bytes; ¡este es solo un ejemplo! Es posible introducir anexos
con una complejidad aleatoria.
● Longitud de datos
La longitud de datos indicada en AG_SEND/AG_LSEND debe cubrir como mínimo la
longitud de los datos en el DB; tenga en cuenta los datos de la columna Dirección del editor
de programación (nota: los datos se corresponden con el número de bytes).

Enviar un mensaje de correo electrónico con AG_SEND/AG_LSEND 1)
Para enviar un mensaje de correo electrónico utilice la instrucción AG_SEND o, para
longitudes de datos >240 bytes, AG_LSEND. Encontrará una descripción detallada relativa a
los parámetros de llamada en la ayuda en pantalla relativa a las instrucciones.
Consulte también AUTOHOTSPOT
Ejemplo:
AWL

Explicación

call fc 50

//Llamada del bloque AG_LSEND

ACT := M 10.0

//Bit para el lanzamiento de la petición

ID := MW 12

//ID de la conexión (configuración de conexión)

LADDR := W#16#0100

//Dirección 256 dec. en la configuración
hardware

SEND := P#db99.dbx10.0 byte 278,

//Dirección del bloque de datos; longitud de
DB

LEN := MW 14

//Longitud del área de datos que se desea enviar

DONE := M 10.6

//Dirección para parámetro de retorno DONE

ERROR := M 10.7

//Dirección para parámetro de retorno ERROR

STATUS := MW 16

//Dirección para parámetro de retorno STATUS

Conexión PtP
Comunicación PtP
Tipos de comunicación PtP
En la comunicación a través de una conexión PtP se distinguen dos tipos diferentes:
● Comunicación homogénea
● Comunicación no homogénea

308

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Gracias a la compatibilidad con la comunicación PtP se pueden direccionar dispositivos
externos, como impresoras.

Comunicación PtP homogénea
El CP PtP transmite los datos entre módulos compatibles con el protocolo S7. El usuario tiene
a su disposición el conjunto completo de funciones de comunicación compatibles con los
dispositivos finales interconectados entre sí a través del PtP (p. ej., CPU con CPU, o
programadora con CPU).
En esta conexión, los CPs PtP no son el punto final de la conexión, sino que asumen la función
de un router.
En el acoplamiento homogéneo se pueden usar todas las funciones de comunicación
definidas en S7 que sean compatibles con ambos interlocutores. Por ello, no resulta necesario
desarrollar un protocolo para llamadas específicas de instrucciones de comunicación en el CP.

Comunicación PtP no homogénea
El CP PtP funciona como gateway a través de otros protocolos, como RK512, 3964,
controlador abierto y protocolos especiales. Determinados bloques siven como interfaz de
usuario sincronizada con el programa de usuario. En la parte de recepción, el programa de
usuario también puede ser direccionado a través de funciones de comunicación sincronizadas
con el programa mediante el acoplamiento PtP no homogéneo.
En la comunicación no homogénea, y desde el punto de vista de la tecnología de
comunicación, el CP PtP es el punto final de la comunicación S7. La comunicación entre CPU
y CP se efectúa mediante elementos del protocolo S7. El CP se encarga de convertir estos
elementos de protocolo al protocolo PtP y viceversa.
Para la comunicación no homogénea se pueden usar en la CPU las instrucciones de
comunicación siguientes:
● BSEND
● BRCV
● PUT
● GET
En el CP PtP se deben implementar los elementos de protocolo S7 correspondientes a las
instrucciones BSEND, BRCV, PUT y GET como cliente (el CP está activo) y PUT y GET como
servidor (el CP está pasivo).
Instrucciones

Cliente

Servidor

BSEND

sí

no

BRCV

sí

no

PUT

sí

sí

GET

sí

sí

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

309

Configuración de dispositivos y redes
1.3 Configurar redes

Funciones de comunicación
En función de la aplicación, la comunicación no homogénea se puede efectuar en dos
calidades diferentes:
● Funciones de comunicación controladas:
Las funciones de comunicación controladas permiten llevar a cabo la transmisión de
manera controlada. Esto significa que la transmisión no sólo se puede iniciar desde la parte
activa, sino que también se habilita de manera controlada desde la parte pasiva y se
detecta el fin de la transmisión.
En las instrucciones de comunicación en S7, esta funcionalidad se lleva a cabo con los
parámetros "EN_R" (disponibilidad de recepción) y "NDR" (recepción de datos terminada).
● Funciones de comunicación no controladas:
En las funciones de comunicación no controladas, la transmisión es efectuada por el
interlocutor activo, sin que el interlocutor pasivo tenga posibilidad de intervenir.

Parametrizar conexión PtP
Configurar el hardware para PtP
Para establecer una conexión PtP se requiere un CP 441. Los módulos de comunicación del
tipo CP 441 disponen de ranuras para uno (CP 441-1) o dos (CP 441-2) módulos de interfaz
PtP.
Los módulos de interfaz PtP del tipo IF963 se encuentran en el catálogo de hardware del
SIMATIC S7-400, bajo los módulos de comunicación para PtP. Existen módulos IF963 para los
tipos de interfaz siguientes:
● RS232C
● TTY
● RS422/485
Según el tipo de interfaz, los módulos IF963 son compatibles como máximo con los protocolos
de comunicación siguientes:
● ASCII
● 3964(R)
● RK512
● Impresora
● Maestro Modbus
● Esclavo Modbus
Si se utiliza una interfaz PtP en un CP 441, automáticamente se muestra una subred PtP y se
inserta una conexión PtP no especificada.
Una vez seleccionado el CP 441 o tras seleccionar directamente la interfaz deseada, se puede
elegir el protocolo en la ventana de inspección y configurarlo.

310

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Conexión PtP con un dispositivo S7 como interlocutor
En la tabla de conexiones se pueden registrar 8 conexiones como máximo para el interlocutor
local. Para el interlocutor se debe registrar sólo una conexión en la tabla de conexiones. El
interlocutor puede recibir datos de las 8 conexiones a través de esta conexión.
Ejemplo: Definiciones para el interlocutor local:
● Protocolo 3964(R)
● Sentido de comunicación 1: Local --> interlocutor
● 8 conexiones máx., IDs locales: 1000; 1001, ..., 1007
Definiciones para el interlocutor:
● Protocolo 3964(R)
● Sentido de comunicación 2: Interlocutor --> local
● 1 conexión máx., ID local: 1000

Número de conexiones
El número máximo de conexiones configurables por dispositivo (CPU/FM) depende de los
recursos del módulo empleado.

Sentido de comunicación PtP
Sentido de comunicación
En las conexiones PtP se pueden definir distintos sentidos de comunicación. Active para ello
la casilla de verificación correspondiente:
● Local → interlocutor:
Conexiones a través de las cuales desea enviar telegramas (tramas).
● Interlocutor → local:
Conexiones a través de las cuales desea recibir telegramas.
● Local ↔ interlocutor:
Conexiones a través de las cuales desea enviar y recibir telegramas.
Nota
Encontrará información más detallada sobre cómo determinar el sentido de comunicación en
la documentación de su módulo.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

311

Configuración de dispositivos y redes
1.3 Configurar redes

Vía de conexión PtP
Ajustes de la vía de conexión
En los ajustes del sentido de comunicación en "General > Vía de conexión" se puede
configurar la vía que sigue la conexión que va del punto final local al interlocutor. Se puede
elegir la vía en función de los CPs PtP configurados. Ejemplo: El interlocutor local contiene dos
CPs PtP. En este caso se puede elegir a través de qué CP debe conducirse la conexión.
Particularidad: A diferencia de lo que ocurre en las conexiones S7, la configuración de
conexiones PtP con un interlocutor no especificado no requiere la interconexión del
interlocutor local. En este caso, los interlocutores se deben interconectar en la instalación real
antes de poner la conexión en funcionamiento.

Posibilidades de selección de los interlocutores
● Vía CP:
Para el interlocutor local se puede seleccionar el CP PtP a través del cual debe conducirse
la conexión (nombre del CP con indicación del rack y el slot).
● Interfaz:
Los CPs de SIMATIC S7 cuentan con más canales (interfaces) a través de los que se
pueden establecer las conexiones PtP. Se muestra el canal y el protocolo usado para el
canal (canal/protocolo). El protocolo se ha configurado con el software especial de
configuración para el CP.
● Tipo:
Aquí se visualiza el tipo de interfaz "PtP".

"Conexión seleccionada a través del n.º de CPU RK512:" (local)
Los sistemas de automatización con modo multiprocesador (como, p. ej., SIMATIC S7-400)
pueden contener varias CPUs. Por ello, se debe indicar un número de CPU, a través del cual
el interlocutor pueda direccionar la conexión.
Si se ha elegido como sentido de comunicación interlocutor -> local o bien local <-> interlocutor
y se desea recibir telegramas del interlocutor a través de un SFB, introduzca aquí el número
de la CPU (1 a 4) del interlocutor local.
El número de CPU aquí indicado debe coincidir con el número de CPU introducido en el
encabezado del telegrama de comando del CP (la estructura del telegrama de comando se
puede consultar en la documentación del CP empleado). Si coincide, el interlocutor direcciona
la conexión a través de este número de CPU.
Nota
Si desea enviar y recibir telegramas a través de SFBs debe rellenar ambos campos en "Local"
e "Interlocutor". El número máximo de conexiones a través de las que se pueden enviar/recibir
telegramas se puede consultar en la documentación del CP empleado.

312

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

"N.º de CPU RK512:" (interlocutor)
Los sistemas de automatización con modo multiprocesador (como, p. ej., SIMATIC S7-400)
pueden contener varias CPUs. Por ello, se debe indicar el número de la CPU a la que deba
conducirse la conexión.
Si se ha elegido como sentido de comunicación local -> interlocutor o bien local <-> interlocutor
y desea enviar telegramas al interlocutor a través de un SFB, introduzca aquí el número de la
CPU (1 a 4) del interlocutor.
El CP introduce el número de CPU aquí indicado en el encabezado del telegrama de comando
que se va a enviar. Por medio de este número de CPU se direcciona una de las 4 CPUs del
interlocutor.
En caso de transmisión hacia dispositivos de terceros también se puede indicar "0" como
número de CPU. Esto posibilita el acceso Broadcast en la estación interlocutora. Si el
interlocutor es el CP441, se direcciona siempre la CPU 1.
Nota
Si desea enviar y recibir telegramas a través de SFBs debe rellenar ambos campos en "Local"
e "Interlocutor". El número máximo de conexiones a través de las que se pueden enviar/recibir
telegramas se puede consultar en la documentación del CP empleado.

PtP: Propiedades especiales de la conexión
Referencia
En el grupo de parámetros "Propiedades > General > Propiedades especiales de la conexión"
se pueden definir propiedades adicionales del punto final local de la conexión.

Unilateral
Unilateral significa que el interlocutor es el servidor de dicha conexión y que no puede enviar
o recibir activamente.

Establecer conexión activa
Determine con esta opción si el establecimiento de la conexión debe realizarse desde este
dispositivo. Esta opción está seleccionada por defecto si la dirección del interlocutor está
especificada.
● ON: La conexión se establece activamente.
● OFF: El interlocutor establece la conexión.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

313

Configuración de dispositivos y redes
1.3 Configurar redes
Si ha seleccionado como interlocutor "no especificado" al crear la conexión, la opción está
deseleccionada por defecto. Si se activa esta opción, es necesario especificar la dirección del
interlocutor en el registro "Direcciones".
Nota
No todos los dispositivos tienen la capacidad de establecer una conexión. En este caso, el
interlocutor debe tomar la iniciativa; las casillas de verificación se muestran atenuadas y no es
posible modificarlas.

Enviar avisos de estado operativo
Los interlocutores también pueden intercambiar sus avisos de estado operativo a través de
una conexión existente.
Active la casilla de verificación cuando el dispositivo local deba enviar sus avisos de estado
operativo al interlocutor. Seguidamente, los avisos de estado se reciben en el interlocutor
mediante la instrucción USTATUS (SFB 23).

1.3.3

Mostrar y configurar topología

1.3.3.1

Sinopsis de la vista topológica

Funciones de la vista topológica
La vista topológica es una de las tres áreas de trabajo del editor de hardware y redes. Aquí se
realizan las tareas siguientes:
● Mostrar la topología de Ethernet
– Mostrar todos los dispositivos PROFINET y los componentes Ethernet pasivos del
proyecto con puertos
– Mostrar las interconexiones entre los puertos
– Mostrar las respectivas redes lógicas
– Mostrar la información de diagnóstico de todos los puertos
● Configurar la topología Ethernet
– Crear, modificar y borrar las interconexiones de los puertos
– Cambiar el nombre de estaciones, dispositivos, interfaces y puertos
– Agregar los dispositivos PROFINET y los componentes pasivos Ethernet del catálogo
de hardware al proyecto
● Determinar y minimizar diferencias entre la topología prevista y la topología real
– Comparación offline/online de los módulos, puertos e interconexiones de puertos
Ethernet
– Aplicar la información de topología disponible online al proyecto offline

314

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Nota
Dispositivos sin dirección IP válida
Sin una dirección IP válida no es posible obtener información de la topología (LLDP) de un
dispositivo.
Para evitar que haya dispositivos sin dirección IP válida, en los ajustes de la configuración
hardware del TIA Portal puede especificarse que se asigne una dirección IP temporal a los
dispositivos que carezcan de IP válida.
Nota
Pertenencia a la subred
Antes de determinar la topología hay que ajustar para la interfaz local de la PG/el PC la
dirección de red que tienen en la instalación real los componentes Ethernet que deben
determinarse. Si no se cumplen estos requisitos no será posible determinar información
topológica avanzada (datos sobre puertos y relaciones de vecindad).

Diferencias entre la vista de redes y la vista topológica
● La vista de redes muestra todas las subredes lógicas del proyecto.
La vista topológica muestra todos los componentes Ethernet del proyecto. Entre ellos, los
componentes pasivos como switches, convertidores de medio y líneas.
Nota
Además, se muestran estaciones con componentes no Ethernet si en la estación se
encuentra por lo menos un componente Ethernet.
● La posición de un dispositivo en la vista de redes y su posición en la vista topológica son en
principio independientes la una de la otra, es decir, normalmente se encuentra el mismo
dispositivo en las dos vistas en otro lugar.
Si desea alinear los dispositivos de la vista topológica igual que en la vista de redes, haga
clic en el símbolo siguiente de la barra de herramientas de la vista topológica:
Símbolo

Significado
Cambia la posición de los dispositivos en la vista topológica, de modo la nueva
posición se parece lo máximo posible a la posición en la vista de redes.

● Si abre el catálogo de hardware desde la vista topológica, aparecerán sólo dispositivos con
interfaz Ethernet.

Estructura de la vista topológica
La vista topológica (Página 21) se compone básicamente de un área gráfica (en lo sucesivo
denominada vista gráfica) y un área de tabla (en lo sucesivo denominada vista de tabla).

¿Qué funciones existen en la vista gráfica y en la vista de tabla?
● Mostrar la topología de Ethernet

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

315

Configuración de dispositivos y redes
1.3 Configurar redes

Función

Vista gráfica

Vista de tabla

Mostrar todos los dispositivos PROFINET y los componentes Et‐
hernet pasivos del proyecto con puertos

sí

sí

Mostrar interconexiones entre los puertos (incluido el tipo de medio) sí

sí

Mostrar las respectivas redes lógicas

no

sí

Mostrar las propiedades de las líneas entre los puertos

no

sí

Mostrar la información de diagnóstico de todos los puertos

sí

sí

Función

Vista gráfica

Vista de tabla

Crear, modificar y borrar las interconexiones de los puertos

● Crear: sí

● Crear: sí

● Cambiar: sí

● Cambiar: sí

● Borrar: sí

● Borrar: sí

● Configurar la topología Ethernet

Cambiar el nombre de estaciones, dispositivos, interfaces y puertos no

sí

Agregar los dispositivos PROFINET y los componentes pasivos
Ethernet del catálogo de hardware al proyecto

no

sí

● Determinar y minimizar diferencias entre la topología prevista y la topología real
Función

Vista gráfica

Vista de tabla

Comparación offline/online de los módulos, puertos e intercone‐
xiones de puertos Ethernet

no

sí

Aplicar la información de topología disponible online al proyecto
offline

no

sí

Estructura de la vista de tabla
La vista de tabla contiene las dos fichas siguientes:
● Ficha "Vista topológica general"
● Ficha "Comparación topológica"
La ficha "Vista topológica general" ofrece las funciones siguientes:
● Visualización de la topología configurada con estructuras jerárquicas (desde la estación
hasta el puerto)
● Configuración de la topología Ethernet
● Visualización del estado del diagnóstico de los componentes de hardware
La ficha "Comparación topológica" ofrece la función siguiente:
● Determinación y minimización de diferencias entre la topología prevista y la topología real

316

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

1.3.3.2

Iniciar la vista topológica

Requisitos
La vista de dispositivos o la vista de redes está abierta en el editor de hardware y redes.

Procedimiento
Para iniciar la vista topológica del proyecto, proceda del siguiente modo:
1. Haga clic en la ficha "Vista topológica".
O bien:
1. Abra la vista de redes del editor de hardware.
2. Seleccione un dispositivo PROFINET o un módulo PROFINET.
3. Selecciona el comando "Ir a la vista topológica" del menú contextual.

Resultado
Se inicia la vista topológica. Si ha llamado la vista topológica desde el menú contextual, el
componente seleccionado se mantiene seleccionado después de la conmutación.

1.3.3.3

Mostrar topología

Mostrar la vista gráfica de la topología configurada
¿Qué se muestra?
La vista gráfica de la topología configurada muestra lo siguiente:
● Los dispositivos PROFINET configurados y componentes Ethernet pasivos con puertos
● Estaciones configuradas con componentes no Ethernet si en la estación se encuentra
como mínimo un componente Ethernet
● Interconexiones configuradas entre los puertos

Modo de representación
La vista gráfica de la vista topológica y de la vista de redes son muy similares en lo que
respecta al modo de representación:
● Los componentes se muestran simplificados en comparación con la vista de dispositivos.
● Las interconexiones entre los puertos se muestran en forma de líneas horizontales y
verticales. Estas líneas son discontinuas si se trata de la interconexión entre el puerto de
cambiador de herramientas y sus posibles puertos interlocutores.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

317

Configuración de dispositivos y redes
1.3 Configurar redes

Mostrar la vista de tabla de la topología configurada
Requisitos
● La vista de tabla de la topología está abierta.
● Se encuentra en la ficha "Vista topológica general".

¿Qué se muestra?
La vista de tabla de la topología configurada muestra lo mismo que la vista gráfica, a excepción
de las subredes lógicas configuradas de PROFINET:
● Todos los dispositivos PROFINET configurados y componentes pasivos de Ethernet con
puertos
● Todas las estaciones configuradas con componentes no Ethernet si en la estación se
encuentra como mínimo un componente Ethernet
● Interconexiones configuradas entre los puertos
A un puerto con la propiedad "Puerto interlocutor cambiante" pertenecen tantas filas
rellenadas como el número de puertos interlocutores posibles más una fila en blanco.

Modo de representación
Como su nombre bien indica, la vista de tabla de la vista topológica consiste en una tabla, que
es la tabla de la vista topológica general. Muestra la topología configurada con sus estructuras
jerárquicas (desde la estación hasta el puerto). Está estructurada como la tabla de la vista de
redes general. La tabla contiene las columnas siguientes:
● Dispositivo/Puerto
Esta es la columna principal de la tabla. Las entradas de esta columna están estructuradas
de manera jerárquica y el último elemento de la jerarquía son los puertos PROFINET. Las
entradas jerárquicas se pueden expandir y contraer. Por ejemplo, en el caso de una CPU,
una entrada se compone de los siguientes elementos:
– Nombre de estación
– Nombre de dispositivo
– Nombre de la interfaz PROFINET
– Nombre de los puertos
Nota: El resto de las columnas contienen entradas únicamente en las filas con los nombres
de puertos.
● Slot
Indica el número del slot de un rack en el que está insertado el módulo correspondiente. En
el caso de interfaces se muestra además la designación de la interfaz.
● Índice (como ajuste predeterminado no se muestra esta columna)
Esta columna solo es relevante para estaciones PC. El índice es la dirección virtual del slot
del componente.

318

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
● Tipo de dispositivo (como ajuste predeterminado no se muestra esta columna)
Muestra a qué tipo de estación, dispositivo o interfaz se refiere la fila de la tabla o si
pertenece a un puerto.
● Referencia (como ajuste predeterminado no se muestra esta columna)
Referencia del dispositivo
● Subred (como ajuste predeterminado no se muestra esta columna)
Subred configurada a la que pertenece la interfaz
● Sistema maestro/IO (como ajuste predeterminado no se muestra esta columna)
Muestra si la interfaz pertenece a un sistema maestro PROFIBUS DP o a un sistema
PROFINET IO.
● Dirección IP (como ajuste predeterminado no se muestra esta columna)
Dirección configurada de la interfaz en la subred
● Estación del interlocutor
Nombre de la estación que contiene el puerto interlocutor
● Dispositivo del interlocutor
Nombre del dispositivo que contiene el puerto interlocutor
● Interfaz del interlocutor
Interfaz a la que pertenece el puerto interlocutor
● Puerto interlocutor
● Datos de la línea
Contiene la longitud de la línea y el tiempo de propagación de señal de la línea que conecta
los puertos

Funciones básicas de las tablas
La tabla de la vista topológica general soporta las siguientes funciones básicas para editar una
tabla:
● Mostrar y ocultar las columnas de la tabla
Nota: No es posible ocultar las columnas relevantes para la configuración.
● Optimizar el ancho de las columnas
● Guardar la representación actual
● Explicar el significado de una columna, fila o campo mediante tooltips

Mostrar el estado de diagnóstico de puertos en la vista gráfica
Requisitos
La vista gráfica de la vista topológica está abierta.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

319

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento
Para determinar el estado de diagnóstico de los puertos, proceda del siguiente modo:
1. Conéctese online con el componente o los componentes deseados.

Resultado
Aparecen los símbolos siguientes:
● Cada dispositivo muestra su respectivo símbolo de diagnóstico.
● Si hay como mínimo un error en un componente subordinado, se muestra también el
símbolo de diagnóstico "Error en componente subordinado" en la esquina inferior izquierda
del símbolo de diagnóstico.
● De cada puerto se muestra el respectivo símbolo de diagnóstico.
● Las líneas entre dos puertos que estén online reciben el color correspondiente a su estado
de diagnóstico.
Encontrará los posibles símbolos de diagnóstico de los puertos y el color de las líneas Ethernet
en la descripción del diagnóstico del hardware. Consulte: Mostrar el estado de diagnóstico y de
comparación mediante iconos (Página 3603)

Mostrar el estado de diagnóstico de los componentes hardware en la vista de tabla
Requisitos
● La vista de tabla de la vista topológica está abierta.
● Se encuentra en la ficha "Vista topológica general".

Procedimiento
Para determinar el estado de diagnóstico de los componentes hardware de la tabla de la vista
topológica general, proceda del siguiente modo:
1. Conéctese online con el componente deseado.

Resultado
Los siguientes símbolos aparecen en el margen izquierdo de la tabla de la vista topológicao
general, es decir en cada fila que pertenece al componente afectado:
● Se muestra el símbolo de diagnóstico que pertenece al componente hardware.
● En los componentes hardware con componentes subordinados se muestra además el
símbolo de "error en componente subordinado" en la esquina izquierda bajo el símbolo de
diagnóstico del componente hardware, si hay como mínimo un error en uno de los
componentes subordinados.

320

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Los posibles símbolos de diagnóstico de los componentes hardware se encuentran en la
descripción del diagnóstico de hardware. Véase: Mostrar el estado de diagnóstico y de
comparación mediante iconos (Página 3603)
Nota
La visualización del estado del diagnóstico de los componentes hardware en la tabla de la vista
topológica general y la de la tabla de la vista de redes general son idénticas.

Ejecutar una comparación offline/online y mostrar del resultado
Requisitos
● La vista de tabla de la vista topológica está abierta.
● Se encuentra en la ficha "Comparación topológica".
●

Una conexión online con uno o más dispositivos es posible pero no obligatoria.

Procedimiento
Para determinar las diferencias entre la topología configurada y la topología realmente
existente, proceda del siguiente modo:
1. Haga clic en el botón "Comparación offline/online" de la barra de herramientas.

Resultado
Se determina la topología que existe realmente y se compara con la topología configurada.
Los dispositivos determinados online se asignan automáticamente a los dispositivos
configurados, siempre que sea posible. Consulte Asignación automática de dispositivos
mediante comparación offline/online (Página 330)
Las columnas situadas en la parte derecha de la tabla se rellenan y/o actualizan:
● Columnas del resultado de la comparación offline/online: "Estado" y "Acción"
● Columnas de la topología determinada online
Nota
Cancelación de una comparación offline/online en curso
Si se hace clic en el botón "Comparación offline/online" mientras está en marcha una
determinación de topología, esta se cancela.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

321

Configuración de dispositivos y redes
1.3 Configurar redes
Se activan los siguientes botones en la barra de herramientas de la tabla:
Botón

Nombre

Significado

Actualizar

Se reinicia la determinación de la topología existente online.

Sincronizar

● Aplicar al proyecto las interconexiones de puertos
determinadas online (Página 331)
● Aplicar los dispositivos determinados online al proyecto
(Página 332)

Nota
Si no se ha configurado offline la programadora o el PC propios, como icono o símbolo de
diagnóstico se muestra el círculo gris.
También es posible configurar offline una segunda y una tercera programadora o un segundo
y un tercer PC.

Columnas del resultado de la comparación offline/online
Se muestran las siguientes columnas:
● "Estado"
Aquí se muestra el resultado de la comparación offline/online mediante iconos de
diagnóstico. Pueden encontrarse los siguientes iconos:
Icono de diagnóstico

Significado
Distinta información topológica en un componente subordinado, como míni‐
mo
Información topológica idéntica
La información topológica solo está disponible offline o el dispositivo está
desactivado
La información topológica solo está disponible online
Distinta información topológica
No se ha configurado ninguna interconexión de puertos, no se ha determi‐
nado online ninguna interconexión de puertos
Si un dispositivo no soporta ninguna función de topología, la columna "Esta‐
do" queda vacía.

● "Acción"
Aquí se muestran las acciones posibles. Son posibles las acciones siguientes:
– ninguna acción
– aplicar

322

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Nota
Columnas de separación
Para separar ópticamente las columnas offline y online de la tabla de comparación topológica,
hay una columna de separación a la izquierda de la columna "Estado" y a la derecha de la
columna "Acción". No es posible ocultar las columnas de separación ni tampoco cambiar su
anchura.

Columnas de la topología determinada online
Se muestran las siguientes columnas:
● "Nombre de dispositivo PROFINET"
● "Referencia" (como ajuste predeterminado no se muestra esta columna)
● "Familia de dispositivos" (como ajuste predeterminado no se muestra esta columna)
● "Dirección IP" (como ajuste predeterminado no se muestra esta columna)
● "Puerto"
● "Interconexión"
– Raya verde si el puerto está interconectado
– Raya gris si el puerto no está interconectado
● "Puerto del interlocutor"
● "Dirección IP del interlocutor"
● "Nombre de dispositivo PROFINET del interlocutor"
● "Referencia del interlocutor" (como ajuste predeterminado no se muestra esta columna)
● "Familia de dispositivos del interlocutor" (como ajuste predeterminado no se muestra esta
columna)

Funciones básicas de las tablas
La tabla de la comparación topológica soporta las siguientes funciones básicas para editar una
tabla:
● Mostrar y ocultar las columnas de la tabla
Nota: no es posible ocultar las columnas relevantes para la configuración.
● Optimizar el ancho de las columnas
● Guardar la representación actual
● Explicar el significado de una columna, fila o campo mediante tooltips

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

323

Configuración de dispositivos y redes
1.3 Configurar redes

Ejecutar una comparación offline/online avanzada y mostrar del resultado
Sinopsis
En la comparación offline/online estándar se utiliza un método de búsqueda que emplea el
protocolo DCP.
En la comparación offline/online avanzada se utiliza además ICMP para detectar también
dispositivos que no soportan DCP. Estos dispositivos incluyen, p. ej., estaciones PG/PC.

Requisitos
● La vista de tabla de la vista topológica está abierta.
● Se encuentra en la ficha "Comparación topológica".
● Los dispositivos que deben detectarse mediante ICMP están en la misma subred que la
tarjeta de red que utiliza actualmente su PG/PC.

Procedimiento
Proceda del siguiente modo:
1. En la barra de herramientas, haga clic en la flecha del botón "Comparación avanzada".
2. Utilizando los campos de entrada "Dirección inicial" y "Dirección final", elija un área de
direcciones IP en la que deban buscarse dispositivos Ethernet accesibles con ICMP.
Confírmela haciendo clic en el botón con la marca de verificación verde, por ejemplo.
3. Haga clic en el símbolo situado en la parte izquierda del botón "Comparación avanzada".

Resultado
Se determinan los dispositivos Ethernet que pueden detectarse mediante DCP e ICMP.
Las columnas situadas en la parte derecha de la tabla se rellenan y/o actualizan.

1.3.3.4

Configurar topología

Interconectar puertos
Sinopsis
Interconectar puertos en la vista topológica
En la vista topológica dispone de las siguientes posibilidades para interconectar los puertos:
● en la vista gráfica (Página 325)
● en la vista gráfica de un cambiador de herramientas (Página 327)
● en la vista de tabla (Página 327)

324

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
● en la vista de tabla de un cambiador de herramientas (Página 328)
● mediante la aplicación de las interconexiones de puertos determinadas online (Página 331)
Nota
Interconexión entre un puerto eléctrico y uno óptico
Si desea interconectar un puerto eléctrico con uno óptico debe distinguir entre comunicación
RT e IRT:
● En la comunicación RT no es necesario configurar un convertidor de medio.
● En la comunicación IRT es necesario realizar la interconexión utilizando un convertidor de
medio.

¿Qué efectos tiene la interconexión de puertos en la vista de redes?
Nota
En la vista de redes, en las propiedades de una subred se puede especificar que al crear una
interconexión de puertos entre dos dispositivos no interconectados se utilice esta subred.
Al crear una interconexión entre dos puertos son posibles los siguientes efectos en la vista de
redes:
● Si las interfaces correspondientes no están conectadas: Si ha especificado una subred, se
utilizará dicha subred. Si no, se creará una nueva subred para conectar las dos interfaces.
● Si sólo está conectada una de las dos interfaces correspondientes: La interfaz no
conectada se conectará con la misma subred que la interfaz ya conectada.
● En otros casos: Las interfaces correspondientes no se conectan con una subred lógica.

Consulte también
Interconectar puertos (Página 3146)
Ajustes para la interconexión de dispositivos Ethernet (Página 85)

Interconectar los puertos en la vista gráfica
Requisitos
Se encuentra en la vista gráfica de la vista topológica.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

325

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento: crear interconexiones entre dos puertos
Para interconectar un puerto de un dispositivo con un puerto de otro dispositivo, proceda del
siguiente modo:
1. Coloque el puntero del ratón en el puerto que desee interconectar.
2. Haga clic con el botón izquierdo del ratón y manténgalo pulsado.
3. Desplace el puntero del ratón.
El puntero del ratón indica con el símbolo de interconexión que se encuentra en modo de
interconexión. Al mismo tiempo, en el puntero del ratón aparece el símbolo de prohibición,
que no desaparece hasta que no se sitúa en una posición de destino válida.
4. Arrastre el puntero del ratón al puerto de destino. Puede mantener el botón izquierdo del
ratón pulsado o soltarlo.
5. Ahora, suelte el botón izquierdo del ratón o vuelva a hacer clic con el mismo.
Resultado: se crea una nueva interconexión de puertos.
Nota
Creación de un anillo en CPU S7-300, S7-400 y S7-1500
Cuando se crea un anillo en las CPU S7-300, S7-400 o S7-1500 mediante interconexiones de
puertos, se crea automáticamente un dominio MRP.

Procedimiento: modificar una interconexión de puertos existente sin borrarla previamente
Proceda del siguiente modo:
1. Coloque el cursor del ratón sobre el puerto de una interconexión existente que deba recibir
un puerto interlocutor nuevo.
2. Arrástrelo hasta el puerto interlocutor nuevo.
Resultado: la interconexión existente de puertos se borra. Se crea la nueva interconexión de
puertos.
Procedimiento alternativo:
1. Coloque el cursor del ratón en un puerto no interconectado hasta el momento, y que deba
conectarse con un puerto ya interconectado.
2. Arrástrelo hasta el puerto ya interconectado.
Resultado: la interconexión existente de puertos se borra. Se crea la nueva interconexión de
puertos.

Procedimiento: interconexión de dos puertos ya interconectados, sin tener que borrar previamente las
dos interconexiones existentes
Proceda del siguiente modo:
1. Coloque el cursor del ratón sobre un puerto ya interconectado que deba recibir un puerto
interlocutor nuevo.
2. Arrástrelo hasta el puerto interlocutor nuevo, que a su vez ya está interconectado.

326

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Resultado: las dos interconexiones existentes de puertos se borran. Se crea la nueva
interconexión de puertos.

Interconexión de los puertos en la vista de tabla
¿Qué acciones se pueden realizar con interconexiones de puertos en la vista de tabla?
En la vista de tabla se pueden realizar las siguientes acciones con interconexiones de puertos:
● Crear nueva interconexión de puertos
● Modificar interconexión de puertos existente
● Borrar interconexión de puertos existente

Requisitos
En la ficha "Vista topológica general" se ve la línea con el puerto cuya interconexión desea
crear, modificar o borrar.

Procedimiento
Para crear, modificar o borrar la interconexión de un puerto por primera vez, proceda del
siguiente modo:
1. Mueva el puntero del ratón a la línea del puerto de origen en la columna "Puerto
interlocutor".
2. Haga clic en la lista desplegable.
3. Seleccione el puerto interlocutor deseado (al crear o modificar una interconexión de
puertos) o la entrada "cualquier interlocutor" (al borrar una interconexión de puertos).

Resultado
Se realiza la acción deseada. En la columna "Puerto interlocutor" se muestra el nuevo puerto
interlocutor (después de crear o modificar una interconexión de puertos) o la indicación
"Seleccione puerto" (después de borrar una interconexión de puertos).

Interconexión de un puerto con varios puertos interlocutores en la vista gráfica
Requisitos
● Ha parametrizado un puerto de un dispositivo PROFINET con la propiedad "Interlocutores
alternativos" y ha indicado los puertos interlocutores posibles.
● La vista gráfica de la vista topológica está abierta.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

327

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento
1. Interconecte este puerto (en lo sucesivo denominado puerto de origen) con uno de los
puertos interlocutores indicados (en lo sucesivo denominados puertos de destino).
2. Interconecte el puerto de origen con otro puerto de destino.
Esto se puede realizar de diferentes maneras:
– Arrastre el puntero del ratón de un puerto interlocutor ya interconectado a un puerto de
destino.
– Arrastre el puntero del ratón de una interconexión ya establecida a un puerto de destino.
– Arrastre el puntero del ratón de un puerto de destino a un puerto interlocutor ya
interconectado.
– Arrastre el puntero del ratón de un puerto de destino a una interconexión ya establecida.
3. Repita el paso anterior una o varias veces, según sea necesario.

Resultado
Se establece una interconexión entre el puerto de origen y los puertos interlocutores
cambiantes. Esta interconexión se muestra mediante una línea discontinua.

Interconexión de un puerto con varios puertos interlocutores en la vista de tabla
¿Qué acciones se pueden realizar con interconexiones de puertos a varios puertos interlocutores en la
vista de tabla?
En un cambiador de herramientas, las acciones que se pueden realizar con interconexiones de
puertos a varios puertos interlocutores en la vista de tabla son:
● Crear nueva interconexión de puertos
● Modificar interconexión de puertos existente
● Borrar interconexión de puertos existente

Requisitos
● Ha parametrizado un puerto de un dispositivo PROFINET con la propiedad "Interlocutores
alternativos" y ha indicado los puertos interlocutores posibles.
● En la ficha "Vista topológica general" se ve la línea con el puerto cuya interconexión desea
crear, modificar o borrar.

328

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimiento
Para crear por primera vez, modificar o borrar la interconexión de un puerto con otro de varios
puertos interlocutores, proceda del siguiente modo:
1. Mueva el puntero del ratón a la línea del puerto de origen en la columna "Puerto
interlocutor".
2. Haga clic en la lista desplegable.
3. Seleccione el puerto interlocutor deseado (al crear o modificar una interconexión de
puertos) o la entrada "cualquier interlocutor" (al borrar una interconexión de puertos).

Resultado
Se realiza la acción deseada:
● En caso de crear un puerto se inserta una fila nueva en la tabla de la vista topológica
general. En la columna "Puerto interlocutor" se muestra el nuevo puerto interlocutor.
● Al realizar una modificación, en la columna "Puerto interlocutor" se muestra el nuevo puerto
interlocutor.
● En caso de borrar, se borra la fila con la interconexión de puertos existente hasta el
momento.
Nota
En un cambiador de herramientas, un puerto con interconexiones a varios puertos
interlocutores suele constar de varias filas. En este caso, la última fila siempre es una línea
en blanco. La primera fila se puede editar, el resto son de solo lectura.

Cambiar el nombre de estaciones, dispositivos, interfaces y puertos
Cambiar el nombre de una estación, dispositivo, interfaz o puerto
Requisitos
● La vista de tabla de la vista topológica está abierta.
● Se encuentra en la ficha "Vista topológica general".

Procedimiento
Para cambiar el nombre de una estación, dispositivo, interfaz o puerto, proceda del siguiente
modo:
1. Haga clic dos veces en el campo correspondiente de la tabla de la vista topológica general
(con el segundo clic se accede al modo de edición).
2. Introduzca el nombre nuevo y pulse la tecla INTRO (finaliza el modo de edición).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

329

Configuración de dispositivos y redes
1.3 Configurar redes

Resultado
Se cambia el nombre del objeto.

Comparar offline/online
Asignación automática de dispositivos mediante comparación offline/online
Resumen
Al comparar offline/online se compara la topología configurada con la topología realmente
existente. Aquí se asignan automáticamente los dispositivos determinados online a los
dispositivos configurados, siempre que sea posible.

Iniciar la determinación de disponibilidad
Se inicia la determinación de disponibilidad por primera vez mediante un clic en el botón
"Comparación offline/online" de la barra de herramientas de la ficha "Comparación topológica".
La determinación de disponibilidad se reinicia haciendo clic en el botón "Actualizar".
Nota
La determinación de la disponibilidad puede requerir varios segundos. Durante este tiempo no
se pueden realizar más entradas.

Asignación automática de un dispositivo PNIO
Un dispositivo PNIO determinado online se asigna automáticamente a un dispositivo
configurado si los dos dispositivos concuerdan en las siguientes propiedades:
● Referencia
● Tipo de dispositivo o familia de dispositivos
● Nombre de dispositivo PROFINET

330

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Asignación automática no posible
La asignación automática no es posible en los siguientes casos:
● No existe ningún dispositivo determinado online para el dispositivo configurado (por lo que
las columnas correspondientes en el área "Topología online" de la tabla de comparación
topológica están vacías).
En este caso, debe agregar el dispositivo configurado a la instalación o borrar el dispositivo
configurado de la configuración.
● No se puede asignar un dispositivo determinado online a ningún dispositivo configurado,
aunque hay diferencias en las interconexiones de puertos.
En este caso puede aplicar manualmente las interconexiones de puertos determinadas
online al proyecto (Página 331).
● No se puede asignar un dispositivo determinado online a ningún dispositivo configurado
(por lo que las columnas correspondientes en el área "Topología online" de la tabla de
comparación topológica están vacías).
En este caso puede aplicar manualmente el dispositivo determinado online al proyecto
(Página 332).

Aplicar manualmente al proyecto las interconexiones de puertos determinadas online
Requisitos
Ha realizado una comparación offline/online en la vista topológica. El resultado ha sido que
como mínimo un dispositivo determinado online se ha asignado automáticamente a un
dispositivo configurado pero hay diferencias en la interconexión.

Procedimiento
Para aplicar manualmente al proyecto una o varias interconexiones de puertos determinadas
online, proceda del siguiente modo:
1. Seleccione la fila correspondiente a la interconexión de puertos.
2. Seleccione otras filas utilizando la selección múltiple si fuera necesario.
3. En el menú contextual, elija "Aplicar" > "Aplicar los seleccionados".
Seguidamente, el contenido de los campos correspondientes de la tabla cambian a
"Aplicar" en la columna "Acción".
4. Si se ha equivocado y ha preparado demasiadas interconexiones de puertos para
incorporarlas al proyecto:
Utilizando la selección múltiple, seleccione las filas correspondientes a las interconexiones
de puertos que se han preparado erróneamente para incorporarlas al proyecto.
En el menú contextual, elija "Resetear" > "Restablecer los seleccionados".
Seguidamente, los campos correspondientes de la tabla cambian a "Ninguna acción" en la
columna "Acción".
5. Haga clic en el botón de comando "Sincronizar".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

331

Configuración de dispositivos y redes
1.3 Configurar redes

Resultado
Para los dispositivos correspondientes se aplican al proyecto las interconexiones de puertos
determinadas online. Si la aplicación se realiza correctamente, aparece el símbolo de
diagnóstico "Información de topología idéntica" en cada puerto.
Nota
Si para un dispositivo determinado online se detectan interconexiones de puertos diferentes de
las que existen en el proyecto, su aplicación al proyecto tendrá como resultado la sustitución
de las interconexiones existentes en el proyecto por las interconexiones detectadas online. Si
para un dispositivo determinado online no se detecta ninguna interconexión de puertos, la
aplicación al proyecto tendrá como consecuencia la eliminación de todas las interconexiones
de este dispositivo del proyecto.

Aplicar manualmente los dispositivos determinados online al proyecto
Requisitos
Ha realizado una comparación offline/online en la vista topológica. El resultado ha sido que
como mínimo un dispositivo determinado online no se ha podido asignar a ningún dispositivo
configurado.

Procedimiento
Para aplicar manualmente al proyecto uno o varios dispositivos determinados online, proceda
del siguiente modo:
1. Mueva el puntero del ratón en la columna "Dispositivo/Puerto" de la topología online de un
dispositivo configurado sin interlocutor online.
2. En la lista desplegable de este campo, seleccione el dispositivo que desea asignar al
dispositivo configurado.
3. Si es necesario, repita los pasos anteriores para otros dispositivos configurados sin
interlocutor online.

Resultado
Se desplaza el dispositivo determinado online seleccionado desde el final de la tabla hasta el
principio. Después, se encontrará en la fila del dispositivo configurado al que acaba de
asignarlo.

Asignación automática de dispositivos mediante comparación offline/online avanzada
Sinopsis
En la comparación offline/online avanzada se utiliza, además de DCP, ICMP para detectar
también dispositivos que no soportan DCP.

332

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Asignación automática de dispositivos determinados mediante ICMP
Los dispositivos determinados mediante ICMP no disponen de tipo.
Los dispositivos pasivos no disponen de referencia. Por este motivo, solo es posible asignar
automáticamente dispositivos pasivos si en los datos configurados no se han asignado
referencias y la dirección IP offline coincide con la online.
Para switches es posible una asignación automática cuando la referencia, la dirección IP y el
nombre de dispositivo PROFINET coinciden tanto offline como online.

1.3.4

Industrial Ethernet Security

1.3.4.1

Configuración de la seguridad

General
Dispositivos soportados
Dispositivos soportados
Las funciones de seguridad descritas en este apartado de ayuda son soportadas por los
siguientes productos:
● SCALANCE S-600 V3:
– S602 V2*/V3/V4
– S612 V2*/V3/V4
– S613 V2*
– S623 V3/V4
– S627-2M V4
● SOFTNET Security Client:
– SOFTNET Security Client V4
● S7-CPs / TIM: CP 343-1 GX31 Advanced, CP 443-1 GX30 Advanced, CP 443-1 OPC UA,
CP 1543-1, CP 1542SP-1 IRC, CP 1543SP-1, CP 1243-1 BX30, CP 1243-1 PCC, CP
1242-7 KX31, CP 1243-7 LTE, CP 1243-8 IRC, TIM 4R-IE, TIM 4R-IE DNP3, TIM 1531 IRC
● CP PC: CP 1628
● Router de telefonía móvil: SCALANCE M875
* Los dispositivos SCALANCE S V2 no pueden insertarse en un proyecto de STEP 7. Los
dispositivos SCALANCE V2 de proyectos de versiones anteriores de STEP 7 solo se muestran
con sus propiedades. Sin embargo, no es posible modificar las propiedades de estos
dispositivos. Tampoco son posibles la descarga, la compilación ni el diagnóstico de
dispositivos SCALANCE S V2. Todas las funciones descritas para dispositivos SCALANCE S
hacen referencia a las versiones de firmware V3 o superiores.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

333

Configuración de dispositivos y redes
1.3 Configurar redes
Cuando se abre un proyecto de STEP 7 con dispositivos SCALANCE S V2 ya presentes es
posible crear reglas de cortafuegos globales a partir de las reglas de cortafuegos locales
disponibles para el dispositivo.

Denominación genérica "módulo de seguridad"
En el presente apartado del sistema de información se utiliza la denominación "Módulo de
seguridad" en representación de los nombres de producto arriba citados. Encontrará las
diferencias entre las funciones en los distintos productos en el Siemens Industry Mall.

Uso de las denominaciones "interfaz" y "puerto"
En la presente documentación, los puertos de los módulos SCALANCE S se denominan de la
siguiente manera:
● "Interfaz externa": el puerto externo del SCALANCE S602 / S612 / S613 / S623 o bien un
puerto externo del SCALANCE S627-2M (marca roja)
● "Interfaz interna": el puerto interno del SCALANCE S602 / S612 / S613 / S623 o bien un
puerto interno del SCALANCE S627-2M (marca verde)
● "Interfaz DMZ": el puerto DMZ del SCALANCE S623 / S627-2M (marca amarilla)
La denominación "puerto" se utilizará cuando se quiera destacar un puerto en particular de una
interfaz.

Estructura del presente apartado de ayuda
En el capítulo "General" encontrará los temas relevantes para varios tipos de módulo. La
información que solo es relevante para un determinado tipo de módulo se encuentra en los
apartados correspondientes específicos de cada módulo.

Vista general - Prestaciones y funcionamiento
Denominación general "STEP 7"
La configuración de funciones de seguridad se soporta a partir de STEP 7 V12. Por este
motivo, en el presente apartado del sistema de información se utiliza la denominación "STEP
7" como término global para todas las versiones de STEP 7 a partir de V12.

Prestaciones
En STEP 7 pueden utilizarse las siguientes funciones de seguridad:
● Configuración de los módulos de seguridad
● Creación de datos de configuración VPN para SOFTNET Security Client V4
● Creación de datos de configuración VPN para SCALANCE M875
● Creación de archivos de configuración VPN para dispositivos VPN de otros fabricantes
● Funciones de test y diagnóstico, indicaciones de estado

334

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Vista de configuración offline y vista online/de diagnóstico
Las funciones de seguridad se configuran en dos vistas:
● Vista de configuración offline
En la vista de configuración offline se ajustan los datos de configuración. Antes de realizar
la carga no es necesario establecer para esto una conexión con los módulos de seguridad.
● Vista online/de diagnóstico
La vista online/de diagnóstico sirve para diagnosticar los módulos de seguridad y ofrece la
posibilidad de actualizar el firmware, entre otros.

Funcionamiento - Seguridad y coherencia
● Acceso solo para usuarios autorizados
Las funciones de seguridad de cada proyecto solo están disponibles con la protección de
proyecto activa. Eso permite proteger las funciones de seguridad de cambios involuntarios
o no autorizados.
● Datos de proyecto coherentes
Ya durante la entrada en los distintos cuadros de diálogo se realizan comprobaciones de la
coherencia. Adicionalmente se ejecutan pruebas de coherencia a nivel de proyecto en las
que se incluyen todos los cuadros de diálogo.
En los módulos de seguridad solo se pueden cargar datos de proyecto coherentes.
● Protección de datos de proyecto por encriptación
Los datos de configuración y del proyecto relevantes para la seguridad está protegidos por
encriptación. Según el módulo de seguridad, los datos se guardan en el proyecto y/o en el
C-PLUG.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

335

Configuración de dispositivos y redes
1.3 Configurar redes

Interfaz de usuario para funciones de seguridad







①

Funciones de seguridad

En el árbol del proyecto se encuentran las funciones de seguridad globales. Las funciones de seguridad globales
pueden configurarse en función del módulo y a continuación asignarse, en su caso, a módulos de seguridad indi‐
viduales. Los cambios en las funciones de seguridad globales deben cargarse en todos los módulos de seguridad
afectados. Lo mismo es válido para los ajustes de relaciones de redundancia.
Para visualizar todas las funciones de seguridad al completo en el árbol del proyecto es necesario que la protección
del proyecto esté activada y haya como mínimo un módulo de seguridad en el proyecto. Si el primer módulo de
seguridad disponible es un CP, es necesario activar además los ajustes de seguridad locales del CP.
En las funciones de seguridad globales están disponibles las siguientes carpetas principales y entradas:
● Administrador de certificados
En el administrador de certificados se obtiene una relación de todos los certificados utilizados en el proyecto. Así,
p. ej., es posible importar nuevos certificados así como exportar, renovar o sustituir certificados existentes.

336

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
● Cortafuegos
En la entrada "Cortafuegos" se definen conjuntos de reglas globales para el cortafuegos IP y MAC así como
conjuntos de reglas IP personalizados (solo para módulos SCALANCE S) y se asignan módulos de seguridad.
También es posible exportar de STEP 7 e importar en STEP 7 conjuntos de reglas globales para el cortafuegos.
Las definiciones de los servicios IP y MAC permiten especificar de forma compacta y clara las reglas de
cortafuegos IP y MAC.
● Grupos VPN
Esta carpeta contiene todos los grupos VPN generados. Aquí podrá crear nuevos grupos VPN y asignar módulos
de seguridad a dichos grupos VPN. Además, es posible adaptar las propiedades de grupos VPN ya creados.
● NTP
Aquí puede crear servidores NTP seguros y asignarlos a uno o varios módulos de seguridad. Así se consigue que
la sincronización horaria tenga lugar a través del servidor NTP asignado. Los servidores NTP no seguros pueden
configurarse en los ajustes de seguridad locales.
● RADIUS
Aquí pueden crearse servidores RADIUS y asignarse a uno o a varios módulos de seguridad. Así se consigue
que se reenvíen al servidor RADIUS asignado las consultas de autenticación de los usuarios que inician sesión
en el módulo de seguridad seleccionado para activar conjuntos de reglas IP personalizados.

②

● Archivos de registro (vista offline)
Apertura de eventos registrados de sistema, auditoría y filtrado de paquetes guardados como archivo en la vista
online.
Área de trabajo

Después de haber seleccionado un módulo de seguridad, un módulo SCALANCE M o un dispositivo de seguridad
en el área de trabajo, sus ajustes de seguridad locales pueden configurarse en "Propiedades" > "General". Si el
objeto seleccionado se encuentra en un grupo VPN, la información correspondiente se muestra en la ficha VPN.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

337

Configuración de dispositivos y redes
1.3 Configurar redes

③

④

Ficha VPN

En esta ficha se muestra información sobre todos los grupos VPN a los que pertenece el módulo de seguridad que
se ha seleccionado en el área de trabajo. La información de cada uno de los participantes de un grupo VPN se puede
mostrar u ocultar.
Ajustes de seguridad local

Los ajustes de seguridad local se configuran para un módulo de seguridad / módulo SCALANCE M / dispositivo de
seguridad determinado. Después de haber seleccionado uno de estos objetos en el área de trabajo, sus ajustes de
seguridad locales están disponibles en la ficha "Propiedades" > "General" de la ventana de inspección. Para visua‐
lizar los ajustes de seguridad locales es necesario que la protección del proyecto esté activada.
Para los CP es necesario activar la casilla de verificación "Activar funciones de seguridad" en la entrada "Seguridad"
de la ficha "Propiedades" > "General" de la ventana de inspección. Los ajustes de seguridad locales se visualizan
a continuación dentro de la entrada "Seguridad". Al activar la casilla de verificación, algunos ajustes de CP (siempre
que estén activados) se migran automáticamente a los ajustes de seguridad locales.
Además, en función del módulo de seguridad correspondiente están disponibles otras funciones de seguridad, como
NTP (secure), SNMPv3 y FTPS.
Adicionalmente se crean automáticamente para las conexiones configuradas reglas de cortafuegos que habilitan el
establecimiento de conexión. Para registrar paquetes bloqueados están disponibles los ajustes de registro corres‐
pondientes.

Áreas de configuración seguras y no seguras
La interfaz de usuario puede dividirse en áreas de configuración seguras y no seguras.
Se consideran seguras las áreas en las que no es posible realizar la configuración hasta que
se ha activado la protección del proyecto. Estas áreas son encriptadas, con lo que solo están
a disposición de a personas autorizadas dentro de la administración de usuarios, incluso si el
proyecto es accesible a un grupo de personas más amplio.

338

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
En cambio, las funciones de las áreas no seguras pueden configurarse sin necesidad de
activar la protección del proyecto. Antes de cargar el proyecto en los componentes de la
instalación debe comprobarse que los ajustes sean correctos, en caso de que un grupo amplio
de personas pueda realizar cambios en el proyecto.
La lista siguiente muestra qué áreas de configuración de la interfaz de usuario son seguras y
cuáles no. En parte, esto depende del módulo de seguridad para el que se realiza la
configuración.
● Todas las funciones de seguridad globales son seguras.
● Áreas de configuración seguras y no seguras para módulos SCALANCE S:
– Los ajustes que se encuentran en la entrada "General" de los ajustes de seguridad
locales son no seguros.
– Los ajustes de nivel superior (p. ej. ajustes de MRP como administrador MRP, etc.) que
no se configuran en el propio módulo de seguridad pero que pueden afectar al módulo
de seguridad, son no seguros. Esto no afecta a las funciones de seguridad globales.
– Los demás ajustes son seguros.
● Áreas de configuración seguras y no seguras para CP:
– Todos los ajustes que están fuera de la entrada "Seguridad" son no seguros.
– Los ajustes de nivel superior (p. ej. ajustes de MRP como administrador MRP, ajustes
de PROFINET, conexiones, etc.) que no se configuran en el propio módulo de seguridad
pero que pueden afectar al módulo de seguridad, son no seguros. Esto no afecta a las
funciones de seguridad globales.
– Todos los ajustes para interfaces y puertos, especialmente direcciones IP, son no
seguros.
– Los ajustes que se encuentran en la entrada "Seguridad" son seguros.

Restricciones en el uso de librerías
Cuando se crea una plantilla maestra en la librería global para un módulo de seguridad, se
pierde la configuración de dicho módulo de seguridad en la plantilla maestra. Para utilizar la
plantilla maestra es necesario volver a iniciar sesión.
Cuando se crea una plantilla maestra en la librería del proyecto para un módulo de seguridad,
se conserva la configuración de dicho módulo de seguridad, a excepción de la información
intermódulo para relaciones VPN y de redundancia.

Direcciones IP para servidores configurables
A la hora de configurar servidores no está permitido utilizar las direcciones IP (alias) del módulo
de seguridad. Cuando se indica la dirección IP se comprueba la coherencia de todos los
servidores configurables.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

339

Configuración de dispositivos y redes
1.3 Configurar redes

Realizar prueba de coherencia
Sinopsis
Existen las siguientes pruebas de coherencia:
● Pruebas de coherencia locales
● Pruebas de coherencia a nivel de proyecto
En las descripciones de los diferentes cuadros de diálogo de esta ayuda se listan bajo el
término "Verificación de consistencia" las reglas que deben tenerse en cuenta al realizar cada
entrada.

Pruebas de coherencia locales
Una prueba de coherencia se considera local si se puede realizar directamente dentro de un
cuadro de diálogo. Para las acciones siguientes se llevan a cabo verificaciones de coherencia
locales:
● al salir de un campo
● al salir de una fila de una tabla
● al confirmar un cuadro de diálogo con OK.

Pruebas de coherencia a nivel de proyecto
Las pruebas de coherencia a nivel de proyecto informan sobre la configuración correcta de los
datos de proyecto. Para las acciones siguientes se comprueba la coherencia en todo el
proyecto:
● al compilar una configuración
● al cargar una configuración
Nota
Solo se pueden cargar datos configurados en un módulo de seguridad si se ha aprobado la
comprobación de coherencia del módulo de seguridad en todo el proyecto.

Sustitución del módulo de seguridad
Función específica del módulo
Los módulos SCALANCE S con versión V3 o superior se pueden sustituir por módulos
SCALANCE S con versión V3 o superior, consulte el apartado:
Sustitución del módulo de seguridad (Página 477)
También pueden sustituirse CP 1543-1 y TIM 1531 IRC por módulos con versiones de
firmware superiores respectivamente. Para ello es necesario que estén activados los ajustes
de seguridad locales de los módulos.

340

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Requisitos
Para poder sustituir los módulos de seguridad, sus descripciones deben estar actualizadas.
Para actualizar la descripción de los módulos de seguridad, proceda del siguiente modo:
1. Seleccione el módulo de seguridad que desea editar.
2. En los ajustes de seguridad locales, haga clic en la entrada "General" > "Información de
catálogo".
3. Haga clic en el botón "Actualizar descripción del módulo".

Cómo se accede a esta función
1. Seleccione el módulo de seguridad que desea editar en la vista topológica o de redes.
2. Haga clic con el botón derecho del ratón en el módulo de seguridad y elija el comando
"Sustituir dispositivo..." del menú contextual.

Administrar certificados
Resumen de certificados
Administración de certificados
El administrador de certificados para las funciones de seguridad globales contiene una
sinopsis de todos certificados utilizados en el proyecto con la siguiente información:
● ID: cada certificado contenido en el administrador de certificados recibe una ID. El
administrador de certificados asigna la ID de certificado cuando se crea o importa un
certificado. En determinados casos, como, por ejemplo, en certificados de servidor OPC
UA, la ID se utiliza para identificar los certificados. La ID de certificado es unívoca dentro del
proyecto y no puede modificarse.
● Propietario del certificado: dispositivo para el cual es válido el certificado.
● Emisor: indica el nombre del emisor del certificado.
● Validez: indica cuándo caduca el certificado.
● Usado como: indica cómo se utiliza el certificado, es decir, p. ej. como certificado SSL o
como autoridad certificadora.
● Clave privada: indica si existe una clave privada.
● Procedimiento: indica el método de cifrado de la clave privada.
● Responsabilidad: aquí se selecciona cómo debe mantenerse actualizado el certificado.
Encontrará información más detallada en el capítulo Certificados de dispositivos
(Página 345).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

341

Configuración de dispositivos y redes
1.3 Configurar redes
Los datos se pueden modificar a través de la entrada "Renovar" del menú contextual.
Nota
Cargar la configuración
Tras sustituir o renovar certificados es necesario cargar la configuración en los módulos de
seguridad correspondientes.
Tras sustituir o renovar certificados CA es necesario cargar la configuración en todos los
módulos de seguridad.

Nota
Fecha y hora actuales en los módulos de seguridad
Cuando utilice comunicación segura (p. ej. HTTPS, VPN...), asegúrese de que los módulos de
seguridad afectados tienen la hora y fecha actuales. De lo contrario, los certificados utilizados
se considerarán no válidos y la comunicación segura no funcionará.

Administrador de certificados global
En el administrador de certificados, dentro de las funciones de seguridad globales están
disponibles las funciones siguientes:
● Importación de certificados y autoridades de certificación nuevos y de confianza, además
de cadenas de certificados, consulte el capítulo Importar certificados (Página 346).
● Exportar los certificados, las autoridades de certificación y las cadenas de certificados
utilizados en el proyecto, consulte el capítulo Exportar certificados (Página 347).
● Asignación de un certificado a uno o varios dispositivos; consulte el capítulo Asignar
certificados (Página 347).
● Respecto a la renovación de certificados, por ejemplo en caso de caducidad de la validez
o para actualizar el método de cifrado, consulte el capítulo Renovar certificados
(Página 348).
● Respecto a la sustitución de certificados, por ejemplo en caso de caducidad de la validez,
consulte el capítulo Reemplazar certificados (Página 349).
● Borrado de certificados importados manualmente.
Haga doble clic en la entrada "Administrador de certificados" de las funciones de seguridad
globales.

342

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
En las diferentes fichas se dispone de los comandos siguientes del menú contextual:
Comando

Significado

Importar

Importación de certificados y cadenas de certificados, con o sin cla‐
ve privada y cifrado. Seleccione uno de los siguientes formatos:
*.der: certificado codificado en DER
*.cer: certificado codificado en DER
*.crt: certificado codificado en PEM
*.pem: certificado codificado en PEM
Formatos *.p12:
● Fichero PKSC12: Certificado con la clave privada
correspondiente
● Fichero de cadena PKSC12: Certificado con la clave privada
correspondiente y todos los certificados de la ruta de certificación

Exportar

Exportación de certificados y cadenas de certificados, con o sin
clave privada y cifrado. Seleccione uno de los siguientes formatos:
*.der: certificado codificado en DER
*.cer: certificado codificado en DER
*.crt: certificado codificado en PEM
*.pem: certificado codificado en PEM
*.crl: lista de revocación de certificados, con codificación DER
Formatos *.p12:
● Fichero PKSC12: Certificado con la clave privada
correspondiente
● Fichero de cadena PKSC12: Certificado con la clave privada
correspondiente y todos los certificados de la ruta de certificación
En función de la selección, después de hacer clic en el botón "Guar‐
dar" aparece un cuadro de diálogo adicional, que permite realizar
más ajustes, consulte el capítulo Exportar certificados (Página 347).

Mostrar

Abre el cuadro de diálogo de certificados de Windows, en el que se
muestra una vista general de todos los datos de certificado.
Para que se muestre que el certificado es válido, instale el certifica‐
do con el botón "Instalar certificado..." de la ficha "General" en la
memoria de certificados de Windows. Para poder instalar el certifi‐
cado se requieren los correspondientes derechos de usuario de
Windows.

Renovar
(solo en las fichas "Autoridad de
certificación (CA)" y "Certifica‐
dos de dispositivos")

Abre el cuadro de diálogo "Renovar certificado", en el que si es
necesario, p. ej. en los certificados comprometidos, se puede crear
un certificado nuevo de STEP 7.

Reemplazar

Abre el cuadro de diálogo "Sustituir certificado", en el que puede
reemplazarse un certificado existente por otro certificado nuevo.

Asignar

Abre el cuadro de diálogo "Asignar certificado", en el que puede
asignarse un certificado existente a uno o varios dispositivos como
certificado del dispositivo o de confianza.

Borrar

Borra un certificado en la ficha "Autoridades de certificación raíz y
certificados acreditados".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

343

Configuración de dispositivos y redes
1.3 Configurar redes

Administrador de certificados local
Los certificados que han sido importados mediante el administrador de certificados en las
funciones de seguridad globales no se asignan automáticamente a los módulos
correspondientes. Los certificados importados deben transferirse manualmente mediante la
entrada "Administrador de certificados" de los ajustes de seguridad locales a la lista de los
certificados de interlocutor de confianza. Los certificados generados por STEP 7, como los
certificados SSL o los certificados de grupos VPN, se asignan automáticamente a los módulos
correspondientes y no deben asignarse a estos mediante los ajustes de seguridad locales.
Antes de poder referenciar certificados en bloques de programa para la "Secure
Communication" hay que asignarlos al módulo de seguridad como certificados de dispositivo
a través del administrador de certificados local. Una vez seleccionada una celda de la tabla, se
puede crear un certificado con el botón "Agregar" o utilizar un certificado del proyecto ya
existente colocando la marca de verificación. Para acceder a certificados del proyecto ya
existentes y para la firma de un certificado nuevo por parte de una autoridad certificadora es
necesario que esté activada la casilla de verificación "Utilizar ajustes globales de seguridad
para el administrador de certificados".

Entidades emisoras
Ficha "Autoridad de certificación (CA)"
Un certificado CA es un certificado emitido por una autoridad de certificación, llamada
"Certificate Authority", a partir del cual se generan y firman los certificados de dispositivo.
Las posibles entidades emisoras pueden ser:
● El proyecto STEP 7 en sí. Si "Propietario del certificado" y "Emisor" son iguales, se trata de
un certificado autofirmado, es decir, emitido por el proyecto STEP 7.
● Una entidad emisora superior. Los certificados externos al proyecto de otros emisores se
importan y se guardan en la memoria de certificados de STEP 7.
Los certificados creados por una de las dos autoridades de certificación siempre cuentan con
una clave privada, que permite crear y firmar los certificados de dispositivo.
Se generan automáticamente las siguientes entidades emisoras:
● Certificados CA de un proyecto: Al crear un proyecto nuevo se generan certificados CA
para el proyecto que usan diferentes algoritmos Hash para la firma del certificado. Los
certificados CA para proyectos siempre se cargan a los módulos de seguridad
correspondientes. A partir de los certificados CA se derivan los certificados SSL y los
certificados de cliente/servidor OPC UA para los diferentes módulos de seguridad.
● Certificados de grupo CA: Al crear un grupo VPN nuevo, se genera un certificado CA para
el grupo VPN. De este certificado se derivan los certificados de dispositivos VPN para
dispositivos de grupos VPN.

344

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Certificados de dispositivos
Ficha "Certificados de dispositivos"
Visualización de los certificados de dispositivos que emiten las respectivas entidades emisoras
para los módulos. Aquí se incluyen:
● Certificado SSL de un módulo: Para cada módulo creado se genera un certificado SSL
derivado del certificado CA del proyecto. Se recurre a los certificados SSL para autenticar
la comunicación segura entre PG o PC y el módulo así como para cargar la configuración.
● Certificado de cliente/servidor OPC UA del módulo: Según sea la función de cliente/
servidor OPC UA configurada para el CP 443-1 OPC UA, se genera un certificado de
cliente/servidor OPC UA que se utiliza para la autenticación en el correspondiente
interlocutor de la comunicación.
● Certificado de grupos VPN de un módulo: Además, se genera un certificado de dispositivo
VPN para cada módulo por cada grupo VPN en el que se encuentra.
Selección de la responsabilidad
El ajuste predeterminado para todos los certificados específicos del dispositivo es "Usuario" y
no puede modificarse. Solo para los certificados OPC-UA, el ajuste predeterminado es
"Sistema" y se puede elegir cómo mantenerlos actualizados:
● Sistema después de la compilación, todos los parámetros de certificado (salvo "Válido
desde" y "Válido hasta") adoptan de nuevo el ajuste predeterminado y son actualizados
automáticamente por el sistema. Los parámetros agregados adicionalmente por el usuario
(p. ej. para "Nombre alternativo del propietario del certificado (SAN)") se borran. Ese
comportamiento también es aplicable al cambio de "Usuario" a "Sistema".
● Usuario: tras la compilación, los parámetros de certificado (p. ej. para "Nombre alternativo
del propietario del certificado (SAN)") permanecen invariables o se mantienen como los ha
ajustado el usuario en el cuadro de diálogo "Renovar certificado". El sistema no actualiza
los parámetros automáticamente.

Certificados de confianza y entidades emisoras de certificados de origen
Ficha "Certificados de confianza y entidades emisoras de certificados de origen"
Visualización de los certificados externos importados a STEP 7. Se pueden importar p. ej.
certificados de servidores FTPS externos, certificados de otros proyectos de STEP 7 y
certificados que son necesarios para servicios externos como, p. ej. DNS din.
Tras la importación, los certificados deben asignarse a los módulos correspondientes
mediante los ajustes locales de seguridad o la función "Asignar" del administrador de
certificados. Encontrará más información al respecto en el capítulo Resumen de certificados
(Página 341).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

345

Configuración de dispositivos y redes
1.3 Configurar redes

Importar certificados
Importación de certificados
Al importar o renovar un archivo, el sistema detecta automáticamente qué certificados forman
parte del archivo.
Así, por ejemplo, puede ser una cadena de certificados con los contenidos siguientes:
● certificado de dispositivo A emitido por la autoridad de certificación 1, con clave privada
● certificado CA B de la autoridad de certificación 1, sin clave privada
● certificado CA C de la autoridad de certificación 2 que ha emitido el certificado B, sin clave
privada
Al importar el archivo se guardan los certificados siguientes:
● el certificado de dispositivo A en la ficha "Certificados de dispositivos"; clave privada: sí
● el certificado CA B de la autoridad de certificación en la ficha "Autoridad de certificación
(CA)", clave privada: no
● el certificado CA C de la autoridad de certificación 2 en la ficha "Autoridad de certificación
(CA)", clave privada: no
Para poder generar certificados de dispositivos nuevos como autoridad de certificación 1 al
renovar, proceda del siguiente modo:
● Importe un certificado de la autoridad de certificación 1 con clave privada.
Resultado:
– El certificado B de la autoridad de certificación en la ficha "Autoridad de certificación
(CA)" no se sobrescribe porque ya se ha importado.
– El estado de la clave privada cambia de "no" a "sí".
– Al renovar solo pueden firmarse certificados de dispositivos nuevos.
Este comportamiento también es aplicable al renovar certificados, consulte el capítulo
Renovar certificados (Página 348).

346

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Exportar certificados
Ajustes para la exportación
Según sea el formato, para la exportación pueden seleccionarse las opciones siguientes:
Seleccionable para la ex‐
portación:
Clave privada

Formato

Nota

*.cer

*.der

*.crt.

*.pem

*.crl

*.p12

x

x

x

x

-

x

Para *.cer y *.der: se exporta un archivo de cla‐
ves adicional para el certificado. El archivo de
claves exportado no puede volver a importarse.
Para *.crt y *.pem: se guarda en un archivo jun‐
to con el certificado.

Clave privada cifrada

-

-

x

x

-

-

Posibilidad de seleccionar el método de cifrado
e introducir una contraseña. Si no introduce nin‐
guna contraseña, se utiliza el nombre del pro‐
yecto como contraseña.

Cadena de certificados

-

-

x

x

-

-

Solo es posible si los certificados de la cadena
están guardados en el administrador de certifi‐
cados.

Solo contraseña

-

-

-

-

-

x

Si no introduce ninguna contraseña, se utiliza el
nombre del proyecto como contraseña.

x: el formato se soporta
-: el formato no se soporta

Asignar certificados
Significado
En el cuadro de diálogo "Asignar certificado al dispositivo" se asigna un certificado existente a
uno o varios dispositivos.

Cómo se accede a esta función
1. Haga clic con el botón derecho del ratón en una entrada de lista de un certificado.
2. Elija el comando "Asignar" del menú contextual.
3. Se abre el cuadro diálogo "Asignar certificado al dispositivo".
4. Active la casilla de verificación "Asignado" para los dispositivos a los que debe asignarse el
certificado.
Si la marca de verificación ya está puesta, significa que el certificado ya se ha asignado a
este dispositivo.
Selección adicional "Uso"
En la ficha "Certificados de dispositivos" puede utilizarse adicionalmente la selección "Uso"
para especificar si el certificado debe asignarse como certificado de dispositivo o como
certificado de confianza. Un certificado puede asignarse a unos dispositivos como certificado

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

347

Configuración de dispositivos y redes
1.3 Configurar redes
de dispositivo y a otros como certificado de confianza. Para cada dispositivo solo es posible
utilizar un certificado como certificado de dispositivo.

Renovar certificados
Significado
En este cuadro de diálogo se renuevan certificados CA y certificados de dispositivos. La
función no es válida para certificados importados.

Cómo se accede a esta función
1. Haga clic con la tecla derecha del ratón en una entrada de la lista en el administrador de
certificados.
2. Elija el comando "Renovar" del menú contextual.
3. Seleccione si el nuevo certificado debe ser autofirmado o bien firmado por una entidad
emisora.
4. Si el certificado debe ser firmado por una entidad emisora, seleccione la entidad emisora
que debe utilizarse con el botón "Seleccionar". Para tal fin solo están disponibles las
autoridades de certificación que están guardadas en la memoria de certificados del
proyecto actual y tienen una clave privada. Consulte el capítulo Resumen de certificados
(Página 341).
5. En función del certificado, introduzca los parámetros siguientes en los campos de entrada
previstos para tal fin:
Parámetro

Significado

Propietario del certifica‐
do

Propietario del certificado. El valor del propietario del certificado debe tener 64 caracteres como
máximo (con ID).

Método de cifrado

Elija el método de cifrado.
Observe el apartado "Cambiar el método de cifrado".

Algoritmo

Selección en función del método de cifrado
Longitud de clave fija en bits para RAS: 2048
Curva ECC para EC: secp256k1 o secp384r

Algoritmo Hash

Algoritmo utilizado para firmar el certificado.

Válido desde

Periodo de validez del certificado

Válido hasta
Uso previsto

Valor que se registra en las ampliaciones "KeyUsage" y "ExtendedKeyUsage" del estándar X.509
V3 para certificados digitales.

Nombre alternativo del
propietario del certifica‐
do (SAN)

Según sea el certificado que debe renovarse, el nombre alternativo del propietario del certificado
se muestra con un tipo de nombre (p. ej. dirección IP de las interfaces utilizadas) y un valor (p. ej.
URI del servidor OPC UA) adaptables.

348

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Cambiar el método de cifrado
Nota
Proceso de encriptado "EC" válido solo para TIM 1531 IRC a partir de la versión V3
El ajuste predeterminado para todos los dispositivos es el Método de cifrado "RSA".
Aunque se puede ajustar el proceso de encriptado "EC" para todos los dispositivos, el proceso
solo es válido para TIM 1531 IRC a partir de la versión V3. Para todos los dispositivos restantes
aparece un mensaje de error tras la compilación.
Para cambiar el Método de cifrado, proceda del siguiente modo:
1. Seleccione el certificado de dispositivo.
2. Seleccione el comando "Renovar" del menú contextual.
3. En el cuadro de diálogo "Renovar certificado" haga clic en la opción "Autofirma".
4. Como Método de cifrado elija la entrada "EC" y seleccione el Algoritmo y Algoritmo Hash.
Resultado:
● Al compilar se asigna al dispositivo el certificado con los ajustes realizados.
● En los parámetros de certificado del cuadro de diálogo "Renovar certificado" se muestra
ahora "EC" como método de cifrado.

Reemplazar certificados
Significado
En el cuadro de diálogo "Reemplazar certificado" se reemplaza un certificado existente por
otro certificado nuevo.
Tenga en cuenta que un certificado CA solo puede ser sustituido por otro certificado CA y un
certificado de dispositivo solo por otro certificado de dispositivo.
Cuando se sustituye un solo certificado no se actualiza la firma.

Cómo se accede a esta función
1. Haga clic con el botón derecho del ratón en una entrada de lista de un certificado.
2. Elija el comando "Reemplazar" del menú contextual.
3. Se abre el cuadro diálogo "Sustituir certificado".
Todos los certificados que aparecen en la tabla "Certificados afectados" se vuelven a derivar.
De este modo es posible reemplazar el certificado de grupo CA de un grupo VPN configurado
previamente dentro del proyecto por el certificado de grupo CA de otro proyecto. Es decir, los
certificados de dispositivo VPN de los miembros del grupo VPN se derivan en ambos proyectos
del mismo certificado de grupo CA.
Una vez realizados los cambios en el administrador de certificados, la configuración debe
cargarse en todos los módulos de seguridad afectados.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

349

Configuración de dispositivos y redes
1.3 Configurar redes

Particularidades de la administración de usuarios para funciones de seguridad
Acceso a funciones de seguridad
Solo se puede acceder a las funciones de seguridad después de activar la protección del
proyecto y después de haber iniciado sesión. El usuario que ha iniciado sesión debe poseer
además los derechos de ingeniería y de runtime necesarios.
Encontrará información fundamental sobre la administración de usuarios en STEP 7 en el
apartado "Utilizar la administración de usuarios" del sistema de información.

Derechos de ingeniería para módulos de seguridad
Estos derechos de ingeniería autorizan el diagnóstico y la configuración de módulos de
seguridad:
● Seguridad: Módulos de seguridad con derechos de lectura: Visualizar las funciones de
seguridad globales y los ajustes de seguridad locales de los módulos de seguridad.
● Seguridad: Módulos de seguridad con derechos de escritura: Configurar las funciones de
seguridad globales y los ajustes de seguridad locales de los módulos de seguridad y
realizar el diagnóstico de los módulos de seguridad.

Funciones con derechos de runtime para módulos de seguridad
Las funciones definidas por el sistema con el prefijo "NET" tienen asignados por defecto
derechos de runtime para módulos de seguridad. Los derechos de runtime proporcionan
derecho a realizar determinadas tareas en módulos de seguridad, como por ejemplo tareas de
diagnóstico o de actualización de firmware. Para poder ejecutar estas tareas es necesario
asignar al usuario una función adecuada definida por el sistema con el prefijo "NET" o asignar
una función definida por el usuario con los derechos de runtime correspondientes. Igual que
los derechos de ingeniería, los derechos de runtime no se pueden modificar para funciones
definidas por el sistema. Para las funciones definidas por el usuario, los derechos de runtime
se pueden modificar libremente. Los derechos de runtime de una función definida por el
usuario se definen para cada módulo de seguridad.
Debe existir como mínimo un usuario con una función asignada con plenos derechos de
runtime para un módulo de seguridad, p. ej. la función definida por el usuario "NET
Administrator".
Las funciones definidas por el sistema con el prefijo "NET" tienen asignados los siguientes
derechos de runtime:
Derecho

NET Admi‐
nistrator

NET
Stan‐
dard

Abrir el proyecto protegido contra escri‐
tura

x

x

x

Abrir el proyecto con derechos de escri‐
tura

x

x

Editar ajustes de seguridad: "Ajustes" y
"Usuarios y funciones"

x

-

350

NET
NET Remote
Diagnose
Access

NET Adminis‐
trator Radius

NET Radius

-

-

-

-

-

-

-

-

-

-

-

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Derecho

NET Admi‐
nistrator

NET
Stan‐
dard

NET
NET Remote
Diagnose
Access

Seguridad: Módulos de seguridad con
derechos de lectura

x

x

x

Seguridad: Módulos de seguridad con
derechos de escritura

x

x

-

NET Adminis‐
trator Radius

NET Radius

-

x

x

-

x

-

Derechos de runtime para módulos de seguridad
Dependiendo del módulo de seguridad están disponibles los siguientes derechos de runtime:
Tabla 1-6

Derechos de runtime en CP 343-1 Advanced / 443-1 Advanced

Derecho

NET Admi‐
nistrator

NET
Stan‐
dard

NET
NET Remote
Diagnose
Access

NET Adminis‐
trator Radius

NET Radius

FTP: Leer archivos del sistema de archi‐
vos del CP

x

x

x

-

x

-

FTP: Escribir archivos del sistema de ar‐
chivos del CP

x

x

-

-

x

-

Servidor web: Formatear el sistema de
archivos del CP *

x

-

-

-

x

-

Applets: Leer valores a través de varia‐
bles PLC *

x

x

x

-

x

-

Applets: Leer valores a través de direc‐
ciones *

x

x

x

-

x

-

Applets: Escribir valores a través de di‐
recciones *

x

x

-

-

x

-

FTP: Leer archivos (DB) de la CPU S7
**

x

x

x

-

x

-

FTP: Escribir archivos (DB) en la CPU
S7 ***

x

x

-

-

x

-

Applets: Leer estado de los módulos en
el bastidor *

x

x

x

-

x

-

Applets: Leer referencias de los módulos
en el bastidor *

x

x

x

-

x

-

Applets: Escribir valores a través de va‐
riables PLC *

x

x

-

-

x

-

SNMP: Leer MIB II

x

x

x

-

-

-

SNMP: Escribir MIB-II

x

x

-

-

-

-

SNMP: Leer Automation MIB

x

x

x

-

-

-

SNMP: Leer LLDP MIB

x

x

x

-

-

-

TIA Portal: Ejecutar el diagnóstico del
módulo de seguridad

x

x

x

-

x

x

Servidor web: Ampliar lista de protección
de acceso IP *

x

-

-

-

x

-

Servidor web: Acceder a diagnóstico
web y al sistema de archivos del CP

x

x

x

-

x

-

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

351

Configuración de dispositivos y redes
1.3 Configurar redes
Derecho

NET Admi‐
nistrator

NET
Stan‐
dard

NET
NET Remote
Diagnose
Access

Servidor web: Enviar un mensaje de co‐
rreo electrónico de prueba *

x

x

x

Servidor web: Actualizar el firmware *

x

x

-

NET Adminis‐
trator Radius

NET Radius

-

x

-

-

x

-

SNMP: Leer MRP MIB

x

x

x

-

-

-

SNMP: Escribir MRP MIB

x

x

-

-

-

-

SNMP: Leer SNMPv2 MIB

x

x

x

-

-

-

Servidor web: Cargar textos de diagnós‐
tico *

x

x

-

-

x

-

Tabla 1-7

Derechos de runtime en CP 443-1 OPC UA

Derecho

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

SNMP: Leer MIB II

x

x

x

-

-

-

SNMP: Escribir MIB-II

x

x

-

-

-

-

SNMP: Leer Automation MIB

x

x

x

-

-

-

SNMP: Leer LLDP MIB

x

x

x

-

-

-

TIA Portal: Ejecutar el diagnóstico del mó‐
dulo de seguridad

x

x

x

-

x

x

Servidor web: Actualizar el firmware

x

x

-

-

x

-

SNMP: Leer SNMPv2 MIB

x

x

x

-

-

-

Servidor web: Recargar textos de diagnosti‐
co

x

x

-

-

x

-

OPC UA: Leer variables

x

x

x

-

-

-

OPC UA: Escribir variables

x

x

-

-

-

-

Servidor web: Diagnóstico

x

x

x

-

-

-

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

SNMP: Leer MIB II

x

x

x

-

-

-

SNMP: Escribir MIB-II

x

x

-

-

-

-

SNMP: Leer Automation MIB

x

x

x

-

-

-

TIA Portal: Ejecutar el diagnóstico del mó‐
dulo de seguridad

x

x

x

-

x

x

SNMP: Leer SNMPv2 MIB

x

x

x

-

-

-

Tabla 1-8

Derechos de runtime en CP 1628

Derecho

352

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Tabla 1-9

Derechos de runtime SCALANCE S-600 V3

Derecho

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

SNMP: Leer MIB-II

x

x

x

-

-

-

SNMP: Escribir MIB-II

x

x

-

-

-

-

SNMP: Leer Automation MIB

x

x

x

-

-

-

SNMP: Leer LLDP MIB

x

x

x

-

-

-

Cargar los archivos de configuración

x

x

-

-

x

-

TIA Portal: Ejecutar el diagnóstico del mó‐
dulo de seguridad

x

x

x

-

x

x

Servidor web: Actualizar el firmware

x

x

-

-

x

-

SNMP: Leer MRP-MIB (solo para SCALAN‐
CE S627-2M)

x

x

x

-

-

-

SNMP: Escribir MRP-MIB (solo para SCA‐
LANCE S627-2M)

x

x

-

-

-

-

SNMP: Leer SNMPv2 MIB

x

x

x

-

-

-

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

FTP: Leer archivos del sistema de archivos
del CP

x

x

x

-

x

-

FTP: Escribir archivos del sistema de archi‐
vos del CP

x

x

-

-

x

-

FTP: Leer archivos (DB) de la CPU S7 **

x

x

x

-

x

-

Tabla 1-10

Derechos de runtime en CP 1543-1

Derecho

FTP: Escribir archivos (DB) en la CPU S7 ***

x

x

-

-

x

-

SNMP: Leer MIB II

x

x

x

-

-

-

SNMP: Escribir MIB-II

x

x

-

-

-

-

SNMP: Leer Automation MIB

x

x

x

-

-

-

SNMP: Leer LLDP MIB

x

x

x

-

-

-

TIA Portal: Ejecutar el diagnóstico del mó‐
dulo de seguridad

x

x

x

-

x

x

SNMP: Leer SNMPv2 MIB

x

x

x

-

-

-

SNMP: Leer IPv6 MIB

x

x

x

-

-

-

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

SNMP: Leer MIB II

x

x

x

-

-

-

SNMP: Escribir MIB-II

x

x

-

-

-

-

Tabla 1-11

Derechos de runtime del CP 1542SP‑1 IRC

Derecho

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

353

Configuración de dispositivos y redes
1.3 Configurar redes
Derecho

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

SNMP: Leer Automation MIB

x

x

x

-

-

-

TIA Portal: Ejecutar el diagnóstico del mó‐
dulo de seguridad

x

x

x

-

x

x

SNMP: Leer SNMPv2 MIB

x

x

x

-

-

-

SNMP: Leer IPv6 MIB

x

x

x

-

-

-

Utilizar TeleService

x

-

-

x

-

-

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

Tabla 1-12

Derechos de runtime en CP 1543SP-1

Derecho

NET Ad‐
ministra‐
tor

SNMP: Leer MIB II

x

x

x

-

-

-

SNMP: Escribir MIB-II

x

x

-

-

-

-

SNMP: Leer Automation MIB

x

x

x

-

-

-

SNMP: Leer LLDP MIB

x

x

x

-

-

-

TIA Portal: Ejecutar el diagnóstico del mó‐
dulo de seguridad

x

x

x

-

x

x

SNMP: Leer SNMPv2 MIB

x

x

x

-

-

-

SNMP: Leer IPv6 MIB

x

x

x

-

-

-

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

SNMP: Leer MIB II

x

x

x

-

-

-

SNMP: Escribir MIB-II

x

x

-

-

-

-

SNMP: Leer Automation MIB

x

x

x

-

-

-

TIA Portal: Ejecutar el diagnóstico del mó‐
dulo de seguridad

x

x

x

-

x

x

SNMP: Leer SNMPv2 MIB

x

x

x

-

-

-

SNMP: Leer IPv6 MIB

x

x

x

-

-

-

Utilizar TeleService

x

-

-

x

-

-

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

x

-

-

x

-

-

Tabla 1-13

Derechos de runtime en CP 1243-1

Derecho

Tabla 1-14

Derechos de runtime en CP 1242-7

Derecho

Utilizar TeleService

354

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Tabla 1-15

Derechos de runtime en CP 1243-7 LTE

Derecho

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

TIA Portal: Ejecutar el diagnóstico del mó‐
dulo de seguridad

x

x

x

-

x

x

Utilizar TeleService

x

-

-

x

-

-

NET Ad‐
ministra‐
tor

NET
Stan‐
dard

NET
Diagno‐
se

NET Remote
Access

NET Adminis‐
trator Radius

NET Radius

SNMP: Leer MIB II

x

x

x

-

-

-

SNMP: Escribir MIB-II

x

x

-

-

-

-

SNMP: Leer Automation MIB

x

x

x

-

-

-

TIA Portal: Ejecutar el diagnóstico del mó‐
dulo de seguridad

x

x

x

-

x

x

SNMP: Leer SNMPv2 MIB

x

x

x

-

-

-

SNMP: Leer IPv6 MIB

x

x

x

-

-

-

Tabla 1-16

Derechos de runtime en CP 1243-8 IRC

Derecho

*
**
***

Para utilizar la función, también debe estar activado el derecho de runtime "Servidor web:
Acceder al diagnóstico web y al sistema de archivos de CP".
Para utilizar la función, también debe estar activado el derecho de runtime "FTP: Leer
archivos del sistema de archivos del CP".
Para utilizar la función, también debe estar activado el derecho de runtime "FTP: Escribir
archivos del sistema de archivos del CP".

Capacidad para usuarios y funciones en módulos de seguridad
● Número máximo de usuarios en un módulo de seguridad:
El número máximo de usuarios que tienen asignada una función con derechos de runtime
para un módulo de seguridad es de 33 (32 + 1 administrador al crear el proyecto).
● Número máximo de funciones en un módulo de seguridad:
El número máximo de funciones que tienen asignados derechos de runtime para el módulo
de seguridad y que están asignadas a usuarios es de 37.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

355

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros para conjuntos de reglas IP específicos de usuario
Durante el uso de conjuntos de reglas IP específicos de usuario tenga en cuenta los siguientes
parámetros de la administración de usuarios:
● Método de autenticación "RADIUS" (solo para SCALANCE S a partir de V4):
la autenticación del usuario se realizará a través de un servidor RADIUS en caso de
activarse conjuntos de reglas IP específicos del usuario. En este método de autenticación,
la contraseña del usuario no se configura en STEP 7, sino que debe guardarse en el
servidor RADIUS. Utilice este método de autenticación exclusivamente para usuarios que
deban iniciar sesión únicamente en la página web de un módulo de seguridad. Un usuario
con el método de autenticación "RADIUS" no puede iniciar sesión en proyectos STEP 7.
● Duración máxima de la sesión (solo para SCALANCE S V3 o superior):
entrada de la duración tras la cual se cierra automáticamente la sesión de un usuario que
ha iniciado sesión en la página web para conjuntos de reglas IP específicos de usuario de
módulos SCALANCE S. La duración aquí indicada comienza tras el inicio de sesión y tras
renovarse esta en la página web del módulo de seguridad.
– Ajuste estándar: 30 minutos
– Valor mínimo: 5 minutos
– Valor máximo: 480 minutos

Autenticación mediante servidor RADIUS
Función específica del módulo
Esta función solo está disponible para SCALANCE S V4 o superior, consulte el apartado:
AUTOHOTSPOT.

Generar datos de configuración para módulos SCALANCE M
Significado
Se pueden generar informaciones de VPN para la parametrización de un SCALANCE M con
STEP 7. Para ello es necesario que el módulo esté como mínimo en un grupo VPN con un
módulo de seguridad o un SOFTNET Security Client. Con los archivos creados se puede
configurar el SCALANCE M utilizando el Web Based Management del dispositivo.

356

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Archivos generados
Se generan los siguientes tipos de archivos:
● Archivo de exportación con los datos de configuración
– Tipo de archivo: archivo *.txt en formato ASCII
– Contiene la información de configuración exportada para el SCALANCE M, incluida una
información sobre los certificados generados adicionalmente.
● Certificados de grupo VPN del módulo
– Tipo de archivo de la clave privada: archivo *.p12
– El archivo contiene el certificado de módulo y el material de clave.
– El acceso está protegido por contraseña.
● Certificados CA de grupos VPN
– Tipo de archivo: archivo *.cer

Figura 1-24

Archivo de configuración de SCALANCE M

Nota
No hay transferencia al módulo SCALANCE M
Los archivos de configuración no se transfieren al módulo SCALANCE M. Se genera un
archivo ASCII con el que se pueden configurar las propiedades relevantes para VPN del
SCALANCE M. Para ello, el SCALANCE M debe estar por lo menos en un grupo VPN con otro
módulo de seguridad o un SOFTNET Security Client.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

357

Configuración de dispositivos y redes
1.3 Configurar redes
Nota
Proteger archivos de configuración exportados de accesos no autorizados
Los archivos de configuración exportados de STEP 7 para SCALANCE M pueden contener
información relevante para la seguridad. Por este motivo hay que asegurarse de que dichos
archivos están protegidos de accesos no autorizados. Esto es especialmente importante
cuando se transfieren archivos.

Proceda del siguiente modo
1. Seleccione el módulo del tipo "SCALANCE M".
2. En los ajustes de seguridad locales elija la entrada "Configuración de SCALANCE M".
3. Active la casilla de verificación "Generar archivos de SCALANCE M" y elija una ubicación
para los archivos de configuración.
4. Establezca una contraseña para la encriptación de los certificados de grupo VPN utilizando
el nombre del proyecto como contraseña o asignando su propia contraseña.
5. Compile la configuración del módulo SCALANCE M.
Resultado: los archivos (archivo .txt y certificados) se guardan en el directorio que ha indicado.

Generar datos de configuración para dispositivos de seguridad
Significado
Un dispositivo de seguridad representa a un dispositivo de otro fabricante.
V1.0: el equipo solo se puede utilizar como dispositivo VPN.
V1.1 o superior: existe la posibilidad de elegir si el dispositivo debe utilizarse como dispositivo
VPN o como pasarela de Internet.

Dispositivo de seguridad como dispositivo VPN
Se pueden generar informaciones de VPN para la parametrización de un dispositivo VPN con
STEP 7. Para ello es necesario que el dispositivo VPN esté como mínimo en un grupo VPN con
un módulo de seguridad. Con los archivos creados es posible configurar a continuación el
dispositivo VPN.
Nota
Proteger archivos de configuración exportados de accesos no autorizados
Los archivos de configuración exportados de STEP 7 para dispositivos VPN pueden contener
información relevante para la seguridad. Por este motivo hay que asegurarse de que dichos
archivos están protegidos de accesos no autorizados. Esto es especialmente importante
cuando se transfieren archivos.

358

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Para utilizar el dispositivo de seguridad como dispositivo VPN, proceda del siguiente modo:
1. Seleccione el dispositivo de seguridad que desee editar.
2. En los ajustes de seguridad locales, elija la entrada "Configuración".
3. V1.1: seleccione el modo de operación "Dispositivo VPN" en la lista desplegable. Para V1.0
el ajuste predeterminado es "Dispositivo VPN".
4. Elija la entrada "Dispositivo VPN" en los ajustes de seguridad locales.
5. Active la casilla de verificación "Generar archivos del dispositivo VPN".
6. Seleccione el modo de operación del dispositivo VPN en la lista desplegable "Modo de
operación VPN". Esta selección solo es posible si el dispositivo VPN no está en un grupo
VPN.
– Cliente VPN: el dispositivo VPN puede aceptar la función siguiente:
Iniciador: el dispositivo VPN intenta establecer activamente una conexión VPN con un
interlocutor.
– Servidor VPN: el dispositivo VPN puede aceptar las funciones siguientes:
Iniciador/respondedor: el dispositivo VPN intenta establecer activamente una conexión
VPN con un interlocutor. También es posible aceptar peticiones para establecer una
conexión VPN. Esta función está seleccionada de forma estándar en las propiedades de
la conexión VPN.
Respondedor: es posible aceptar peticiones para establecer una conexión VPN.
– Cliente VPN NCP para Android (a partir de la versión 2.1): el dispositivo VPN con el
software NCP Secure VPN Client for Android intenta establecer activamente una
conexión VPN con un interlocutor.
– SOFNET Security Client V5: el dispositivo VPN con software SSC instalado intenta
establecer activamente una conexión VPN con un interlocutor.
– Cliente SINEMA RC: el dispositivo VPN con software de cliente SINEMA RC instalado
intenta establecer activamente una conexión VPN con un interlocutor.
7. Seleccione una ubicación para los archivos de configuración VPN.
8. Establezca una contraseña para la encriptación de los certificados de grupo VPN utilizando
el nombre del proyecto como contraseña o asignando su propia contraseña.
Si se ha configurado el dispositivo VPN como "cliente VPN":
1. Establezca en la entrada "Certificados y claves exportados" los tipos de archivo
correspondientes.
2. Introduzca en la entrada "Subredes accesibles por túnel" las subredes y/o direcciones IP
para las que debe habilitarse la comunicación tunelada.
Si se ha configurado el dispositivo VPN como "servidor VPN":
1. Introduzca en el campo "Dirección de servidor VPN (dirección WAN IP)" la dirección WAN
IP bajo la cual el iniciador de la conexión VPN puede acceder al servidor VPN.
2. Establezca en la entrada "Certificados y claves exportados" los tipos de archivo
correspondientes.
3. Introduzca en la entrada "Subredes accesibles por túnel" las subredes y/o direcciones IP
para las que debe habilitarse la comunicación tunelada.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

359

Configuración de dispositivos y redes
1.3 Configurar redes
Si se ha configurado el dispositivo VPN como "Cliente NCP VPN para Android (versión 2.1 o
superior)":
1. Indique en la entrada "Cliente NCP VPN para ajustes Android" la ruta de almacenamiento
en el cliente NCP VPN.
Nota
Habilitación de subredes y dispositivos en la conexión VPN entre el cliente VPN NCP
Secure y SCALANCE S.
La subred interna local de los módulos SCALANCE S está habilitada por defecto para la
comunicación tunelada. Por tanto, esta siempre se registra como primera subred habilitada
en el archivo generado para el cliente NCP VPN. Puesto que el cliente NCP VPN soporta
como máximo 5 entradas para subredes / dispositivos habilitados, se habilitan por defecto
la red interna local del módulo SCALANCE S y las 4 primeras entradas de la tabla de la
entrada "Nodo" en el cliente NCP VPN. Para habilitar otras subredes y dispositivos para la
comunicación tunelada, debe adaptarse el archivo generado desde STEP 7 en
correspondencia.
Si se ha configurado el dispositivo VPN como SOFTNET Security Client V5:
● No se requieren ajustes adicionales.
Si se ha configurado el dispositivo VPN como cliente SINEMA RC:
1. Con el botón "Buscar", seleccione el archivo para iniciar el cliente SINEMA RC.
2. Abra el cliente SINEMA RC con el botón "Iniciar cliente SINEMA RC".
Para el cliente SINEMA RC no se crea ningún archivo de configuración VPN.

Dispositivo de seguridad como pasarela de Internet
Para utilizar el dispositivo de seguridad como pasarela de Internet, proceda del siguiente modo:
1. Seleccione el dispositivo de seguridad que desee editar.
2. En los ajustes de seguridad locales, elija la entrada "Configuración".
3. Seleccione el modo de operación "Pasarela de Internet" en la lista desplegable.
4. Elija la entrada "Pasarela de Internet" en los ajustes de seguridad locales.
5. Introduzca la dirección IP WAN o el FQDN.
6. Bajo la entrada "Módulos asignados" existe la posibilidad de asignar a la pasarela de
Internet módulos que se encuentran en un grupo VPN.

360

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Configurar interfaces para módulos SCALANCE S
Sinopsis
Encontrará información sobre la configuración de las interfaces de módulos SCALANCE S en
el apartado AUTOHOTSPOT. La información incluida en dicho apartado explica las siguientes
posibilidades de configuración:
● Modo de operación (modo Bridge / modo Routing / modo Ghost (solo para SCALANCE
S602 V3.1 o superior)): Ajustar el modo de operación (Página 480)
● Parámetros de dirección IP: Configurar parámetros de dirección IP (Página 480)
● Ajustes de puertos (solo para SCALANCE S V3 o superior): Configurar el modo de puerto
(Página 482)
● Ajustes del Internet Service Provider (ISP) cuando una de las interfaces funciona vía
PPPoE (solo para SCALANCE S V3 o superior): Configurar una conexión a Internet
(Página 483)
● DNS (solo para SCALANCE S a partir de V3): Configuración de DNS (Página 484)
● DNS dinámico (solo para SCALANCE S a partir de V3): Configurar DNS dinámico
(Página 485)
● LLDP (solo para SCALANCE S V4 o superior en modo Routing): Configurar un LLDP
(Página 487)
● Redundancia de medios en topologías de anillo (p. ej. cliente MRP), solo para SCALANCE
S627-2M V4 o superior en modo Routing): AUTOHOTSPOT
Encontrará más información sobre las particularidades del modo Ghost en el capítulo
siguiente: Particularidades del modo Ghost (Página 490)
La configuración de las interfaces de los CPs se describe en los capítulos dedicados a los CPs.

Crear cortafuegos
Resumen del cortafuegos
Significado
La función de cortafuegos de los módulos de seguridad protege redes y estaciones de
influencias externas e interferencias. De ese modo, solo se permiten relaciones de
comunicación determinadas, definidas previamente. Los telegramas no autorizados son
rechazados por el cortafuegos sin enviar una respuesta.
Para filtrar el tráfico de datos pueden utilizarse, entre otros, direcciones IP, subredes IP,
servicios o direcciones MAC. Además se puede ajustar una limitación de la velocidad de
transmisión.
Las funciones de cortafuegos se pueden configurar para los siguientes niveles de protocolo:
● Cortafuegos IP con Stateful Packet Inspection (capa 3 y 4)
● Cortafuegos también para telegramas Ethernet "No IP" conforme a IEEE 802.3 (capa 2)

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

361

Configuración de dispositivos y redes
1.3 Configurar redes
En un módulo de seguridad apto para VPN, el cortafuegos también puede emplearse para el
tráfico de datos encriptado (túnel IPsec). En el módulo de seguridad SCALANCE S602 el
cortafuegos solo puede utilizarse para el tráfico de datos no encriptado.

Reglas de cortafuegos
Las reglas de cortafuegos describen qué paquetes se permiten o prohíben en qué dirección.
Las reglas IP afectan a todos los paquetes IP a partir del nivel 3. Las reglas MAC afectan solo
a frames inferiores al nivel 3.

Tipos de reglas de cortafuegos
● Conjuntos de reglas de cortafuegos globales: los conjuntos de reglas de cortafuegos
globales se pueden asignar a varios módulos de seguridad al mismo tiempo. Los conjuntos
de reglas de cortafuegos globales se configuran en las funciones de seguridad globales.
● Reglas de cortafuegos locales: Las reglas de cortafuegos locales se configuran en los
ajustes de seguridad locales de un módulo de seguridad.
● Conjuntos de reglas IP personalizados (solo para SCALANCE S V3 o superior): los
conjuntos de reglas IP personalizados se pueden asignar a uno o varios módulos de
seguridad al mismo tiempo. Los conjuntos de reglas IP personalizados se configuran en las
funciones de seguridad globales, donde se asignan a uno o varios usuarios.
SCALANCE S V4 o superior (RADIUS): además de uno o varios usuarios, a los conjuntos
de reglas IP personalizados es posible asignarles una o varias funciones.

Definiciones de servicios
Adicionalmente se tiene la posibilidad de definir reglas de cortafuegos de forma compacta y
clara con ayuda de definiciones de servicios. Las definiciones de servicios se configuran en las
funciones de seguridad globales y pueden utilizarse tanto en las reglas de cortafuegos
globales como en las locales y en las personalizadas.

Adaptar reglas estándar para servicios IP
Para módulos SCALANCE S V3 o superior existe la posibilidad de adaptar las reglas de
cortafuegos específicas del servicio que están ajustadas de forma estándar para las interfaces
de los módulos de seguridad. Encontrará información sobre la configuración de estas reglas
de cortafuegos en el apartado Adaptar reglas estándar para servicios IP (Página 508).

Reglas de cortafuegos generadas automáticamente para conexiones de CP
Para conexiones configuradas mediante CPs, STEP 7 crea automáticamente reglas de
cortafuegos que autorizan la comunicación con el interlocutor correspondiente del CP en el
sentido prescrito (CP activo/pasivo). Se tienen en cuenta los sentidos de establecimiento de
las conexiones. Para visualizar dichas reglas de cortafuegos debe pulsarse el botón
"Actualizar reglas de conexión" estando activado el modo de cortafuegos avanzado. Las
reglas de cortafuegos se mostrarán seguidamente en el modo de cortafuegos avanzado.

362

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
En los apartados siguientes se explica qué reglas de cortafuegos se generan
automáticamente.
● Para CPs S7-300/S7-400/PC: Reglas de cortafuegos automáticas referidas a conexiones
(Página 542) en el capítulo "Seguridad para CPs S7-300/S7-400/PC".
● Para CP S7-1200/S7-1500: Reglas de cortafuegos automáticas referidas a conexiones
(Página 555) en el capítulo "Seguridad para CP S7-1200/S7-1500".

Activar cortafuegos
En los ajustes de seguridad locales, las funciones de cortafuegos para un módulo de seguridad
determinado se controlan mediante la casilla de verificación "Activar cortafuegos". Si la casilla
de verificación está activada es posible configurar el cortafuegos, que será efectivo tras el
proceso de carga. Si el módulo de seguridad está en un grupo VPN, la casilla de verificación
"Activar cortafuegos" está activada de forma predeterminada y no puede desactivarse. Tras
cambiar al modo de cortafuegos avanzado no es posible regresar al modo normal. Encontrará
información más detallada sobre el modo normal y el modo de cortafuegos avanzado en el
capítulo:
Resumen de reglas de cortafuegos locales (Página 393).

Conjuntos de reglas de cortafuegos globales
Aplicación
Los conjuntos de reglas de cortafuegos globales se configuran en función del módulo en las
funciones de seguridad globales. Un conjunto de reglas de cortafuegos consta de una o varias
reglas de cortafuegos y se asigna a módulos de seguridad individuales.
Dentro de los conjuntos de reglas de cortafuegos globales, se distingue entre:
● conjuntos de reglas IP
● conjuntos de reglas MAC
La representación siguiente ilustra la relación entre los conjuntos de reglas de definición global
y los conjuntos de reglas utilizados a nivel local.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

363

Configuración de dispositivos y redes
1.3 Configurar redes

3UR\HFWR
MXHJRGHUHJODVJOREDOHVQ
MXHJRGHUHJODVJOREDOHV
MXHJRGHUHJODVJOREDOHV
5HJODJ

0µGXOR
MXHJRGHUHJODVORFDO
5HJODORFDOO
MXHJRGHUHJODVJOREDOHV

5HJODJ
5HJODJ

5HJODORFDOO
MXHJRGHUHJODVJOREDOHV

Configuración
Al configurar reglas de cortafuegos globales es posible realizar un ajuste detallado del
cortafuegos. Existe la posibilidad de activar servicios determinados para dispositivos
concretos o habilitar para el dispositivo todos los servicios para el acceso a la estación o a la
red.

¿Cuándo son convenientes las reglas de cortafuegos IP y MAC?
Las reglas de cortafuegos globales son convenientes cuando se desean definir criterios de
filtrado idénticos para la comunicación.
Nota
Asignación de conjuntos de reglas de cortafuegos con reglas de cortafuegos incompatibles
Para un módulo de seguridad solo se aplican correctamente las reglas de conjuntos de reglas
de cortafuegos que realmente son soportadas por el módulo de seguridad. Una regla incluida
en un conjunto de reglas de cortafuegos global con el sentido "De: Externa" o "A: Any" no se
asigna a un CP 1628, por ejemplo. Las demás reglas del conjunto de reglas de cortafuegos
global se aplican siempre que el CP 1628 las soporte.

364

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Conjuntos de reglas de cortafuegos globales - Convenios
Los conjuntos de reglas de cortafuegos globales se utilizan localmente
Para la creación de un conjunto de reglas de cortafuegos global y la asignación a un módulo
rigen los siguientes convenios:
● Vista de configuración
Los conjuntos de reglas de cortafuegos globales se configuran en las funciones de
seguridad globales.
● Prioridad
Por defecto, las reglas definidas localmente tienen mayor prioridad que los conjuntos de
reglas de cortafuegos IP y MAC globales. Por consiguiente, los conjuntos de reglas de
cortafuegos IP y MAC globales que se asignan de nuevo se insertan en un principio en
último lugar de la lista de reglas local.
La prioridad se puede modificar cambiando el emplazamiento en la lista de reglas.
● Introducir, modificar o borrar conjuntos de reglas
Los conjuntos de reglas de cortafuegos globales no se pueden editar en la lista de reglas
de cortafuegos locales de las propiedades del módulo. Allí solo se pueden ver y emplazar
según la prioridad deseada
Una regla individual no puede borrarse de un conjunto de reglas asignado en los ajustes de
seguridad locales. Solo es posible eliminar de la lista de reglas local todo el conjunto de
reglas. Los conjuntos de reglas de cortafuegos de las funciones de seguridad globales no
se ven afectados.

Crear conjuntos de reglas de cortafuegos globales
Cómo se accede a esta función
1. En las funciones globales de seguridad elija la entrada "Cortafuegos > Juegos de reglas
globales para el cortafuegos > Conjuntos de reglas IP o Conjuntos de reglas MAC".
Resultado: Debajo de la entrada seleccionada se muestran los conjuntos de reglas IP o
MAC creados anteriormente.
2. Haga doble clic en la entrada "Agregar nuevo juego de reglas IP" o "Agregar nuevo juego
de reglas MAC".
Resultado: El conjunto de reglas del cortafuegos se muestra con un número asignado de
forma automática por debajo de la entrada "Conjuntos de reglas IP" o "Conjuntos de reglas
MAC".
3. Haga doble clic en el conjunto de reglas del cortafuegos creado.
Resultado: En el área de trabajo se muestra el cuadro de diálogo de asignaciones para los
conjuntos de reglas del cortafuegos. En la lista desplegable "Juego de reglas" se ha
seleccionado el conjunto de reglas del cortafuegos elegido. Existe la posibilidad de
asignarle los módulos de seguridad deseados, véase el capítulo Asignar conjuntos de
reglas de cortafuegos globales (Página 373). En los ajustes de seguridad locales se
muestran las propiedades configurables del conjunto de reglas del cortafuegos.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

365

Configuración de dispositivos y redes
1.3 Configurar redes
4. Introduzca en la entrada "General" de los ajustes locales de seguridad los datos siguientes:
– Nombre: designación unívoca del conjunto de reglas para todo el proyecto. El nombre
aparece en la lista de reglas local del módulo de seguridad tras la asignación del
conjunto de reglas.
– Descripción (opcional): Introduzca la descripción del conjunto de reglas global.
5. Introduzca las reglas del cortafuegos en la lista de la entrada "Conjunto de reglas del
cortafuegos" en los ajustes locales de seguridad.
Tenga en cuenta la descripción de los parámetros en los capítulos siguientes:
Para conjuntos de reglas IP: Definir reglas de filtrado de paquetes IP (Página 395)
Para conjuntos de reglas MAC: Definir reglas para filtrado de paquetes MAC (Página 400)
Para cambiar a los ajustes locales de seguridad de otro conjunto de reglas del cortafuegos,
selecciónelo en la lista desplegable "Juego de reglas" del cuadro de diálogo de
asignaciones o haga doble clic en la entrada correspondiente en las funciones globales de
seguridad.

Resultado
Se ha creado el conjunto de reglas globales para el cortafuegos, que puede asignarse a los
módulos de seguridad que se desee.
Tenga en cuenta las descripciones del capítulo siguiente:
Asignar conjuntos de reglas de cortafuegos globales (Página 373)

366

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Crear un conjunto de reglas IP
Significado
Tabla 1-17

Conjunto de reglas del cortafuegos: Parámetros

Parámetro

Significado/comentario

Posibilidades de selección / Rangos de valores

Acción

Definición de la autoriza‐
ción (habilitación/bloqueo)

● Accept
Autorizar telegramas según definición.
● Drop
Bloquear telegramas según definición.
● Reject
Los telegramas son rechazados y el remitente recibe un aviso al respecto.
Para reglas de cortafuegos que se crearon automáticamente mediante una
configuración de conexión y después se adaptaron manualmente:
● Accept*
● Drop*
Si se modifican reglas de conexión creadas automáticamente, al
seleccionar la opción "*" no volverán a generarse ni sobrescribirse desde
STEP 7.

De / A

Selecciona los sentidos de
comunicación para los que
debe regir la regla.

Se describen en apartados separados.
● Para módulos SCALANCE S: Sentidos de filtrado de paquetes IP
SCALANCE S (Página 506)
● Para CP S7-300/S7-400/PC: Sentidos de filtrado de paquetes IP CPs
S7-300/S7-400/PC (Página 539)
● Para CP S7-1200/S7-1500: Sentidos de filtrado de paquetes IP para CP
S7-1200/S7-1500 (Página 554)
El sentido de comunicación "Estación" contiene el acceso al CP y el acceso
a la CPU a través del CP.
El sentido de comunicación "Any" incluye todos los sentidos de cortafuegos
soportados por el módulo de seguridad en el momento de la carga.
Los sentidos de comunicación "Estación", "Bus de fondo" (solo para CP
1543-1 a partir de V2.1 con la opción "Routing IP entre módulos de comuni‐
cación" activada) y "Túnel" están clasificados de forma estándar como fia‐
bles. Para la comunicación entre sentidos fiables no es necesario configurar
reglas de cortafuegos.

IPv6

Si activa esta casilla de ve‐
rificación podrá utilizar en
las regla de cortafuegos un
servicio ICMPv6 que se ha‐
ya definido anteriormente.
Para algunos CP de segu‐
ridad es posible introducir
adicionalmente direccio‐
nes IPv6 en los campos de
entrada "Dirección IP de
origen" y "Dirección IP de
destino" después de acti‐
var la casilla de verificación.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

La casilla de verificación solo puede activarse y desactivarse si no hay en‐
tradas en los campos "Dirección IP de origen" y "Dirección IP de destino".
Si se ha desactivado IPv6 en los ajustes locales de un CP apto para IPv6, no
es posible activar la casilla de verificación "IPv6" en los ajustes locales de
seguridad del CP y, por tanto, tampoco es posible utilizar los servicios
ICMPv6 o las direcciones IPv6 en las reglas del cortafuegos. Las reglas de
cortafuegos existentes que utilizan IPv6 se representan atenuadas cuando
IPv6 está desactivado.

367

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Significado/comentario

Posibilidades de selección / Rangos de valores

Dirección IP de
origen

La regla del cortafuegos se
aplica a los telegramas cu‐
yo remitente tiene la direc‐
ción IP indicada aquí. Si no
se indica ninguna dirección
IP, la regla del cortafuegos
es válida para todos los dis‐
positivos dentro del sentido
de comunicación seleccio‐
nado en la columna "De".

Encontrará más información sobre direcciones IP en el apartado Direcciones
IP en reglas de filtrado de paquetes IP (Página 403).

Dirección IP de
destino

Servicio

La regla del cortafuegos se
aplica a los telegramas cu‐
yo destinatario tiene la di‐
rección IP indicada aquí. Si
no se indica ninguna direc‐
ción IP, la regla del corta‐
fuegos es válida para todos
los dispositivos dentro del
sentido de comunicación
seleccionado en la colum‐
na "A".

Selección del servicio IP/
ICMP o del grupo de servi‐
cios que debe utilizarse.
Nota: antes de utilizar un
servicio predefinido, asegú‐
rese de que sus paráme‐
tros predefinidos cumplen
los requisitos necesarios.
Preste especial atención a
los puertos de origen y des‐
tino predefinidos.

Velocidad de
transmisión
(Mbits/s)

Si el modo Ghost está activado, la dirección IP del dispositivo interno se
determina dinámicamente en el tiempo de ejecución desde el módulo de
seguridad. Según sea el sentido seleccionado, no podrá seleccionar una de
las opciones siguientes en la columna "Dirección IP de origen" (con el sentido
"de interna a externa") o en la columna "Dirección IP de destino" (con el
sentido "de externa a interna"):
● Dirección IP del dispositivo interno: el SCALANCE S insertará la dirección
IP del dispositivo interno en la regla del cortafuegos.
● Limited broadcast: el SCALANCE S insertará la dirección IP Broadcast
255.255.255.255 en la regla del cortafuegos.
● Directed broadcast: el SCALANCE S insertará la dirección IP Broadcast
de la red SCALANCE S en la regla del cortafuegos. Un Directed broadcast
también se puede reenviar a la red de destino a través de router.
● Multicast: el SCALANCE S insertará la banda de direcciones Multicast
224.0.0.0 /24 en la regla del cortafuegos. Tras seleccionar esta opción,
alternativamente se puede indicar una determinada dirección IP Multicast
de la banda de direcciones Multicast.
Al realizar la selección se abre una ventana en la que se muestran todos los
servicios IP, servicios ICMP y grupos de servicios, tanto predefinidos como
configurados. Se administran en las funciones globales de seguridad, en
"Cortafuegos > Servicios > Definir servicios para reglas IP".

Limitación de la velocidad
de transmisión

CP 343-1 Adv. / CP 443-1 Adv., CP S7-1200/S7-1500, CP 1628: 0,001 ... 100
Mbits/s

Solo puede introducirse si
para la acción está selec‐
cionado "Accept".

SCALANCE S: 0,001 ... 1000 Mbits/s

Un paquete pasa el corta‐
fuegos si la regla Accept es
correcta y si no se ha so‐
brepasado aún la veloci‐
dad de transmisión permiti‐
da para esa regla.

368

Configuraciones posibles en modo Ghost (solo para SCALANCE S602 V3.1
o superior):

Para reglas globales y personalizadas: 0,001 ... 1000 Mbits/s
Para reglas IP con sentido "Bus de fondo": 0,001 ... 1 Mbit/s
Nota: si se configura el sentido "De túnel a estación" en una regla de corta‐
fuegos para CP S7-1200/S7-1500 no es posible indicar ninguna velocidad de
transmisión.
Para CP 1543-1 V2.1 solo puede indicarse una velocidad de transmisión si
para uno de los sentidos se ha configurado "Any". Esta norma no es aplicable
para la combinación de los sentidos "Any" y "Estación".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Significado/comentario

Registro

Activación o desactivación ● activado
del registro para esta regla. ● desactivado (predeterminado)
Si el registro está activado
rigen los ajustes para el re‐
gistro de filtros de paquetes
que se han configurado en
los ajustes locales de segu‐
ridad.

Posibilidades de selección / Rangos de valores

Número

Número de la regla asigna‐
do automáticamente. Los
números se calculan de
nuevo cuando se despla‐
zan reglas.

Con estado

Si esta casilla de verifica‐
ción está desactivada para
una regla IP con la acción
"Accept", no se generan es‐
tados de cortafuegos por
medio de paquetes que
cumplen la regla Accept.
Los estados de cortafue‐
gos hacen que las respues‐
tas a paquetes permitidos
se permitan automática‐
mente.

Para reglas Accept de SCALANCE S ≥ V3:
● activado (predeterminado)
● desactivado
Para reglas Accept de SCALANCE S < V3 y CP:
● activado (predeterminado)
Observación: la casilla de verificación no existe para CP, pero implícitamente
se utiliza siempre la opción activada para reglas Accept de CP.

Para reglas Drop:
Solo puede adaptarse si
● desactivado (predeterminado)
para la acción está selec‐
cionado "Accept". La confi‐
guración de reglas IP sin
estados de cortafuegos so‐
lo es posible para módulos
SCALANCE S con firmwa‐
re V3 o superior. Si también
deben permitirse respues‐
tas a paquetes que han pa‐
sado el cortafuegos de
acuerdo con este tipo de
reglas IP, deben configurar‐
se reglas IP adicionales pa‐
ra dichas respuestas.

Comentario

Tabla 1-18

Espacio para explicación
propia de la regla

Si un comentario está marcado con "AUTO", significa que ha sido creado para
una regla de conexión automática. Para reglas de creación propia, la entrada
de un comentario es opcional.

Significado de las entradas del menú contextual

Entrada del menú contextual

Significado

Insertar regla arriba

Inserta una regla sobre el conjunto de reglas seleccionado.

Insertar regla debajo

Inserta una regla debajo del conjunto de reglas seleccionado.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

369

Configuración de dispositivos y redes
1.3 Configurar redes
Entrada del menú contextual

Significado

Borrar

Borra el conjunto de reglas seleccionado.
Indicaciones sobre la eliminación de un conjunto de reglas definido como global y
asignado como local:
Al borrar el conjunto de reglas solo se anula la asignación al módulo de seguridad.

Subir

Mueve el conjunto de reglas seleccionado una posición hacia arriba en la lista.
También es posible mover o el conjunto de reglas seleccionado por Drag & Drop.
No es posible realizar una selección múltiple.
De esta forma el conjunto de reglas desplazado se trata con una prioridad mayor.

Bajar

Mueve el conjunto de reglas seleccionado una posición hacia abajo en la lista.
También es posible mover o el conjunto de reglas seleccionado por Drag & Drop.
No es posible realizar una selección múltiple.
De esta forma el conjunto de reglas desplazado se trata con una prioridad menor.

Definir servicio para reglas IP

370

Abre un cuadro de diálogo en el que se administran los servicios IP y los grupos
de servicios.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Crear un conjunto de reglas MAC
Significado
Tabla 1-19

Conjunto de reglas MAC: Parámetros

Parámetro

Significado/comentario

Posibilidades de selección / Rangos de valores

Acción

Definición de la autorización (habili‐
tación/bloqueo)

● Accept
Autorizar telegramas según definición.
● Drop
Bloquear telegramas según definición.
● Reject
Los telegramas son rechazados y el remitente recibe el aviso
correspondiente.
Para reglas de cortafuegos que se crearon automáticamente me‐
diante una configuración de conexión y después se adaptaron ma‐
nualmente:
● Accept*
● Drop*
Si se modifican reglas de conexión creadas automáticamente, al
seleccionar la opción "*" no volverán a generarse ni
sobrescribirse desde STEP 7.

De / A

Selecciona los sentidos de comuni‐ Se describen en apartados separados.
cación para los que debe regir la reg‐ ● Para módulos SCALANCE S: Sentidos de filtrado de paquetes
la.
MAC SCALANCE S (Página 507)
● Para CP S7-300/S7-400/PC: Sentidos de filtrado de paquetes
MAC CPs S7-300/S7-400/PC (Página 540)
● Para CP S7-1200/S7-1500: Sentidos de filtrado de paquetes
MAC para CP S7-1200/S7-1500 (Página 554)
El sentido de comunicación "Station" contiene el acceso al CP y el
acceso a la CPU a través del CP.
Los sentidos de comunicación "Station" y "Tunnel" están clasifica‐
dos de forma estándar como fiables. Para la comunicación entre
sentidos fiables no es necesario configurar reglas de cortafuegos.

Dirección MAC
de origen

La regla del cortafuegos se aplica a Dirección MAC en formato correcto
los telegramas cuyo remitente tiene
la dirección MAC indicada aquí. Si
no se indica ninguna dirección MAC,
la regla del cortafuegos es válida pa‐
ra todos los dispositivos dentro del
sentido de comunicación selecciona‐
do en la columna "De".

Dirección MAC
de destino

La regla del cortafuegos se aplica a
los telegramas cuyo destinatario tie‐
ne la dirección MAC indicada aquí.
Si no se indica ninguna dirección
MAC, la regla del cortafuegos es vá‐
lida para todos los dispositivos den‐
tro del sentido de comunicación se‐
leccionado en la columna "A".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

371

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Significado/comentario

Servicio

Selección del servicio MAC o del gru‐ La lista desplegable le ofrece los servicios y grupos de servicios
po de servicios que debe utilizarse. predefinidos y configurados, para su selección. Se muestran en las
funciones de seguridad globales, en "Cortafuegos > Servicios > De‐
Nota: Antes de utilizar un servicio
finir servicios para reglas MAC".
predefinido, asegúrese de que sus

Posibilidades de selección / Rangos de valores

parámetros predefinidos cumplen
los requisitos necesarios.
Velocidad de
transmisión
(Mbits/s)

Limitación de la velocidad de trans‐
misión

CP 343-1 Adv. / CP 443-1 Adv., S7-1200-/S7-1500-CPs:
0,001 ... 100 Mbits/s

Solo puede introducirse si para la ac‐ CP 1628 y SCALANCE S: 0,001 ... 1000 Mbits/s
ción está seleccionado "Accept".
Para reglas globales: 0,001 ... 1000 Mbits/s
Un paquete pasa el cortafuegos si la Nota: Si se configura el sentido "De túnel a estación" en una regla de
regla Accept es correcta y si no se ha cortafuegos para CP S7-1200/S7-1500 no es posible indicar ningu‐
sobrepasado aún la velocidad de
na limitación de la velocidad de transmisión.
transmisión permitida para esa regla.

Registro

Activación o desactivación del regis‐ ● activado
tro para esta regla. Si el inicio de se‐ ● desactivado (predeterminado)
sión está activado rigen los ajustes
para el registro de filtros de paquetes
que se han configurado en los ajus‐
tes de seguridad locales.

Número

Número de la regla asignado auto‐
máticamente. Los números se calcu‐
lan de nuevo cuando se desplazan
reglas.

Comentario

Espacio para explicación propia de
la regla

Tabla 1-20

Si un comentario está marcado con "AUTO", significa que ha sido
creado para una regla de conexión automática. Para reglas de crea‐
ción propia, la entrada de un comentario es opcional.

Significado de las entradas del menú contextual

Entrada del menú contextual

Significado

Insertar regla arriba

Inserta una regla sobre el conjunto de reglas seleccionado.

Insertar regla debajo

Inserta una regla debajo del conjunto de reglas seleccionado.

Borrar

Borra el conjunto de reglas seleccionado.
Indicaciones sobre la eliminación de un conjunto de reglas definido como global y
asignado como local:
Al eliminar el conjunto de reglas solo se anula la asignación al módulo de seguri‐
dad.

Subir

Mueve el conjunto de reglas seleccionado una posición hacia arriba en la lista.
También es posible mover o el conjunto de reglas seleccionado por Drag & Drop.
No es posible realizar una selección múltiple.
De esta forma el conjunto de reglas desplazado se trata con una prioridad mayor.

Bajar

Mueve el conjunto de reglas seleccionado una posición hacia abajo en la lista.
También es posible mover o el conjunto de reglas seleccionado por Drag & Drop.
No es posible realizar una selección múltiple.
De esta forma el conjunto de reglas desplazado se trata con una prioridad menor.

Definir servicio para reglas MAC

372

Abre un cuadro de diálogo en el que se administran los servicios IP y los grupos
de servicios.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Asignar conjuntos de reglas de cortafuegos globales
Requisitos
Se ha activado el módulo de cortafuegos avanzado para los módulos de seguridad que deben
asignarse a un conjunto de reglas de cortafuegos.

Procedimiento
1. En las funciones globales de seguridad elija la entrada "Cortafuegos > Juegos de reglas
globales para el cortafuegos > Asignar módulo a un conjunto de reglas del cortafuegos".
2. En la lista desplegable "Juego de reglas" seleccione el conjunto de reglas al que desee
asignar el módulo de seguridad.
En la tabla de la derecha se muestran los módulos de seguridad que pueden asignarse al
conjunto de reglas de cortafuegos seleccionado. En la tabla de la izquierda se muestran los
módulos de seguridad que ya están asignados al conjunto de reglas de cortafuegos
seleccionado.
3. En el área "Módulos disponibles" seleccione los módulos de seguridad que desee asignar
al conjunto de reglas seleccionado.
4. Haga clic en el botón "<<" para asignar los módulos seleccionados al conjunto de reglas
seleccionado.

Resultado
Los módulos de seguridad asignados utilizan el conjunto de reglas global como conjunto de
reglas local; el conjunto de reglas global aparece automáticamente al final de la lista de reglas
de cortafuegos de los ajustes de seguridad locales.

Exportar e importar conjuntos de reglas globales para el cortafuegos
Significado y función
Los conjuntos de reglas IP globales y los conjuntos de reglas MAC globales pueden exportarse
de STEP 7 en formato XLSX e importarse a STEP 7. Para cada conjunto de reglas de
cortafuegos se genera un archivo XLSX durante la exportación.
La exportación y la importación ofrecen la posibilidad de intercambiar conjuntos de reglas de
cortafuegos entre diferentes proyectos de STEP 7. Además, los conjuntos de reglas de
cortafuegos exportados pueden editarse en Microsoft Excel® y volver a importarse después a
STEP 7. Esto facilita la tarea de modificar datos de forma masiva.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

373

Configuración de dispositivos y redes
1.3 Configurar redes
Los conjuntos de reglas del cortafuegos exportados de STEP 7 son ampliamente compatibles
con la Security Configuration Tool (SCT). Los conjuntos de reglas del cortafuegos exportados
de la Security Configuration Tool son completamente compatibles con STEP 7.
Nota
Restricciones a la importación de conjuntos de reglas del cortafuegos de STEP 7 a la Security
Configuration Tool
En SCT no se soportan las reglas de cortafuegos IPv6 ni los servicios ICMPv6. Durante la
importación, tanto los servicios ICMPv6 como las reglas de cortafuegos marcadas como IPv6
se ignorarán.
La limitación de la velocidad de transmisión en SCT es de 100 Mbits/s como máximo. Durante
la importación, las reglas de cortafuegos de más de 100 Mbits/s se ignorarán.

Exportar conjuntos de reglas de cortafuegos de STEP 7
1. En las funciones de seguridad globales elija la entrada "Cortafuegos" > "Juegos de reglas
globales para el cortafuegos".
2. Haga doble clic en la entrada "Vista general".
Resultado: En el área de trabajo se muestran los conjuntos de reglas IP y MAC existentes
en STEP 7.
3. Si no desea exportar todos los conjuntos de reglas de cortafuegos, active las casillas de
verificación de los conjuntos que deben exportarse.
4. Haga clic en el botón
5. En el cuadro de diálogo "Exportar conjuntos de reglas del cortafuegos" elija si solo deben
exportarse los conjuntos de reglas de cortafuegos seleccionados o todos los soportados
por SCT. Con la tercera opción se excluyen de la exportación los conjuntos de reglas de
cortafuegos que contienen reglas con sentidos de comunicación no soportados por SCT.
6. Indique una ruta para guardar los conjuntos de reglas de cortafuegos y haga clic en el botón
"Exportar".
Resultado: Para cada conjunto de reglas de cortafuegos se ha generado un archivo XLSX.
Los archivos XLSX han recibido los nombres de los respectivos conjuntos de reglas de
cortafuegos y se han complementado con la fecha y la hora de la exportación.

Importar conjuntos de reglas de cortafuegos a STEP 7
Los conjuntos de reglas de cortafuegos exportados pueden editarse antes de importarse.
Tenga en cuenta las indicaciones al respecto en el capítulo "Requisitos para conjuntos de
reglas de cortafuegos que deben importarse".
Proceda del siguiente modo para importar a STEP 7 los conjuntos de reglas de cortafuegos:
1. En las funciones de seguridad globales elija la entrada "Cortafuegos" > "Juegos de reglas
globales para el cortafuegos".
2. Haga doble clic en la entrada "Vista general".
Resultado: En el área de trabajo se muestran los conjuntos de reglas IP y MAC existentes
en STEP 7.

374

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
3. Haga clic en el botón
4. Si durante la importación deben sobrescribirse los conjuntos de reglas de cortafuegos
homónimos, active la casilla de verificación "Sobrescribir los conjuntos de reglas del
cortafuegos existentes".
Observación: Para cotejar los conjuntos de reglas de cortafuegos existentes en STEP 7 con
los archivos XLSX se utilizan únicamente los nombres de los conjuntos de reglas de
cortafuegos. Las indicaciones de fecha y hora incluidas en los nombres de los archivos
XLSX se ignoran.
5. Seleccione los archivos XLSX que deben importarse. Es posible una selección múltiple.
6. Haga clic en el botón "Importar".
Resultado: Los conjuntos de reglas de cortafuegos de los archivos XLSX seleccionados se
han importado a STEP 7.

Estructura de los conjuntos de reglas IP exportados
Para cada conjunto de reglas IP exportado desde STEP 7 se genera un archivo XLSX con las
hojas de tabla siguientes:
● IP Ruleset: Contiene las reglas de filtrado de paquetes IP para el conjunto de reglas IP.
● IP Services: Contiene los servicios IP que se utilizan en las reglas de filtrado de paquetes
IP para el conjunto de reglas IP. Aquí también se muestran los servicios IP en los grupos
de servicios IP utilizados.
● ICMP Services: Contiene los servicios ICMP que se utilizan en las reglas de filtrado de
paquetes IP para el conjunto de reglas IP. Aquí también se muestran los servicios ICMP en
los grupos de servicios IP utilizados.
● IP Service Groups: Contiene los grupos de servicios IP que se utilizan en las reglas de
filtrado de paquetes IP para el conjunto de reglas IP. Para cada grupo de servicios IP se
muestran los servicios IP e ICMP correspondientes.

Estructura de los conjuntos de reglas MAC exportados
Para cada conjunto de reglas MAC exportado desde STEP 7 se genera un archivo XLSX con
las hojas de tabla siguientes:
● MAC Ruleset: Contiene las reglas de filtrado de paquetes MAC para el conjunto de reglas
MAC.
● MAC Services: Contiene los servicios MAC que se utilizan en las reglas de filtrado de
paquetes MAC para el conjunto de reglas MAC. Aquí también se muestran los servicios
MAC en los grupos de servicios MAC utilizados.
● MAC Service Groups: Contiene los grupos de servicios MAC que se utilizan en las reglas
de filtrado de paquetes MAC para el conjunto de reglas MAC. Para cada grupo de servicios
MAC se muestran los servicios MAC correspondientes.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

375

Configuración de dispositivos y redes
1.3 Configurar redes

Convenios para conjuntos de reglas que deben importarse
Los convenios siguientes son válidos para los conjuntos de reglas de cortafuegos que deben
importarse a STEP 7:
● Los archivos tienen la extensión *.XLSX y el formato Office Open XML correspondiente.
● Si el nombre del archivo XLSX tiene más de 128 caracteres, el conjunto de reglas se crea
en STEP 7 con un nombre estándar.
● Los nombres de las columnas dentro de las hojas de la tabla no deben modificarse, aunque
sí puede modificarse el orden de las columnas.
● Los nombres de las hojas de la tabla no deben modificarse, aunque sí puede modificarse
el orden de las hojas.

376

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Valores de parámetros permitidos para conjuntos de reglas IP que deben importarse
Los valores siguientes pueden introducirse en las columnas de tabla de archivos XLSX para
conjuntos de reglas IP. A la hora de comprobar que la grafía sea correcta no se tienen en
cuenta mayúsculas y minúsculas.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

377

Configuración de dispositivos y redes
1.3 Configurar redes
Tabla 1-21

Valores de parámetros permitidos para la hoja de tabla "IP Ruleset"

Action

From

● Acce
pt

External

To

IPv6*

● Drop

● Intern ● True
al
● False
● DMZ

● Rejec
t

● Tunn
el

Source
IP ad‐
dress

Destina‐
tion IP
Address

Service

Band‐
width

[Texto li‐
bre de
255 ca‐
racteres
máximo]

[Texto li‐
bre de
255 ca‐
racteres
máximo]

[Texto li‐
bre de
128 ca‐
racteres
máximo]

[Valores
posibles:
0.001…
1000]

Logging

● True
● False

Stateful

Com‐
ment

● True [Texto li‐
● Fals bre de
255 ca‐
e
racteres
máximo]

● Any
● Statio
n
● Back
plane
Internal

● Exter
nal
● Intern
al
● DMZ
● Tunn
el
● Any
● Statio
n

DMZ

● Exter
nal
● Intern
al
● Tunn
el
● Any

Tunnel

● Exter
nal
● Intern
al
● DMZ
● Tunn
el
● Any
● Statio
n
● Back
plane

Any

378

● Exter
nal

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Action

From

To

IPv6*

Source
IP ad‐
dress

Destina‐
tion IP
Address

Service

Band‐
width

Logging

Stateful

Com‐
ment

● Intern
al
● DMZ
● Back
plane
Station

● Exter
nal
● Intern
al
● Tunn
el
● Back
plane

Backpla‐
ne

● Any
● Exter
nal
● Statio
n
● Tunn
el

* Esta columna es opcional. Si la columna no existe cuando se realiza la importación a STEP 7 se utiliza en STEP 7 el valor
estándar "False".

Tabla 1-22

Valores de parámetros permitidos para la hoja de tabla "IP Services"
Name

[Texto libre de 128 caracte‐
res máximo]

Protocol
● UDP
● TCP

Source Port

Destination Port

[Texto libre de 32 caracteres
máximo]

[Texto libre de 32 caracteres
máximo]

● All

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

379

Configuración de dispositivos y redes
1.3 Configurar redes

380

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Tabla 1-23

Valores de parámetros permitidos para la hoja de tabla "ICMP Services"
Name

[Texto libre de 128 caracte‐
res máximo]

ICMPv6*
True

Type
● PacketToBig

Code
NoCode

● EchoRequest
● EchoReply
● MulticastListenerQuery
● MulticastListenerReport
● V2MulticastListenerRepo
rt
● MulticastListenerDone
● RouterSolicitation
● RouterAdvertisement
● NeighbourSolicitation
● NeighbourAdvertisement
● RedirectMessage
● InverseDiscoverySolicitati
on
● InverseDiscoveryAdvertis
ement
● HomeDiscoveryRequest
● HomeDiscoveryReply
● MobilePrefixSolicitation
● MobilePrefixAdvertiseme
nt
● CertificationPathSolicitati
on
● CertificatePathAdvertise
ment
● IcmpMessagesUtilizedBy
Seamoby
● MulticastRouterAdvertise
ment
● MulticastRouterSolicitatio
n
● MulticastRouterTerminati
on
● FmIpV6
● RplControl
RouterRenumbering

● RouterRenumberingCom
mand
● RouterRenumberingResu
lt
● SequenceNumberReset

IcmpNodeInformationQuery

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

● ContainsIpV6

381

Configuración de dispositivos y redes
1.3 Configurar redes
Name

ICMPv6*

Type

Code
● ContainsName
● ContainsIpV4

IcmpInformationResponse

● Successful
● RefuseToSupplyAnswer
● UnknownQtypeOfQuery

TimeExceeded

● HopLimitExceededInTran
sit
● FragmentReassemblyTi
meExceeded

ParameterProblem

● ErroneousHeaderFieldEn
countered
● UnrecognizedNextHeade
rTypeEncountered
● UnrecognizedIpV6Option
Encountered

False

NoCode

● EchoReply
● SourceQuench
● AlternateHostAddress
● EchoRequest
● RouterSolicitation
● TimestampReply
● TimestampRequest
● InformationRequest
● InformationReply
● AddressMaskReply
● AddressMaskRequest
● MobileHostRedirect
● IpV6WhereAreYou
● IpV6IAmHere
● MobileRegistrationReply
● MobileRegistrationReque
st
● Skip
● Star
DestinationUnreachable

● Star
● NetUnreachable
● HostUnreachable
● ProtocolUnreachable
● PortUnreachable
● FragmentationNeededAn
dDontFragmentWasSet
● SourceRouteFailed

382

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Name

ICMPv6*

Type

Code
● DestinationNetworkUnkn
own
● DestinationHostUnknown
● SourceHostIsolated
● CommunicationWithDesti
nationNetworkIsAdministr
ativelyProhibited
● CommunicationWithDesti
nationHostIsAdministrativ
elyProhibited
● DestinationNetworkUnre
achableForTypeOfServic
e
● DestinationHostUnreach
ableForTypeOfService
● CommunicationAdministr
ativelyProhibited
● HostPrecedenceViolation
● PrecedenceCutOffInEffec
t

Redirect

● Star
● DatagramForNetwork
● DatagramForTheHost
● DatagramForTheTypeOf
ServiceAndNetwork
● DatagramForTheTypeOf
ServiceandHost

RouterAdvertisement

● Star
● NormalRouterAdvertisem
ent
● DoesNotRouteCommonT
raffic

TimeExceeded

● Star
● TimeToLiveExceededInT
ransit
● FragmentReassemblyTi
meExceeded

ParameterProblem

● Star
● TheIpHeaderIsInvalid
● ArequiredOptionIsMissin
g

Traceroute

● Star
● OutboundPacketSuccess
fullyForwarded

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

383

Configuración de dispositivos y redes
1.3 Configurar redes
Name

ICMPv6*

Type

Code
● NoRouteForOutboundPa
cketThePacketWasDisca
rded

ConversionError

● Star
● UnknownOrUnspecifiedE
rror
● DontConvertOptionPrese
nt
● UnknownMandatoryOptio
nPresent
● KnownUnsupportedOptio
nPresent
● UnsupportedTransportPr
otocol
● OverallLengthExceeded
● IpHeaderLengthExceede
d
● TransportProtocolGreater
Then255
● PortConversionOutOfRa
nge
● TransportHeaderLengthE
xceeded
● BitRolloverMissingAndAc
kSet
● UnknownMandatoryTran
sportOptionPresent

Photuris

● Star
● BadSpi
● AuthenticationFailed
● DecompressionFailed
● DecryptionFailed
● NeedAuthentication
● NeedAuthorization

* Esta columna es opcional. Si la columna no existe cuando se realiza la importación a STEP 7 se utiliza en STEP 7 el valor
estándar "False".

Tabla 1-24

Valores de parámetros permitidos para la hoja de tabla "IP Service Groups"
Name

Description

IP Services

[Texto libre de 128 caracteres máximo]

[Texto libre de 255 caracteres máximo]

[Texto libre, los servicios se separan en‐
tre sí con comas]

384

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Valores de parámetros permitidos para conjuntos de reglas MAC que deben importarse
Los valores siguientes pueden introducirse en las columnas de tabla de archivos XLSX para
conjuntos de reglas MAC. A la hora de comprobar que la grafía sea correcta no se tienen en
cuenta mayúsculas y minúsculas.
Tabla 1-25

Valores de parámetros permitidos para la hoja de tabla "MAC Ruleset"

Action

● Accept

From

External

To

● Internal

● Drop

● Tunnel

● Reject

● Any
● Station
Internal

● External

Source
MAC Ad‐
dress

Destina‐
tion MAC
Address

Service

[Dirección
MAC en
formato
correcto:
xx-xx-xxxx-xx-xx]

[Dirección
MAC en
formato
correcto:
xx-xx-xxxx-xx-xx]

[Texto li‐
bre de
128 carac‐
teres má‐
ximo]

Bandwidth

[Valores
posibles:
0.001…
1000]

Logging

Comment

[Texto li‐
bre de
255 carac‐
teres má‐
ximo]

● True
● False

● Tunnel
● Any
Tunnel

● External
● Internal
● Station

Any

● External
● Internal

Station

● External
● Tunnel

Tabla 1-26

Valores de parámetros permitidos para la hoja de tabla "MAC Services"

Name

Protocol

[Texto libre de 128
caracteres máxi‐
mo]

● SNAP
● PROFINET IO
● ISO
● [Valores
hexadecimales
empezando
por 0x]

Tabla 1-27

DSAP

SSAP

[Valores hexadeci‐ [Valores he‐
males con 2 carac‐ xadecimales
teres máximo]
con 2 carac‐
teres máxi‐
mo]

CTRL

OUI

OUI Type

[Valores he‐
xadecimales
con 2 carac‐
teres máxi‐
mo]

[Valores he‐
xadecimales
con 6 carac‐
teres máxi‐
mo]

[Valores he‐
xadecimales
con 4 carac‐
teres máxi‐
mo]

Valores de parámetros permitidos para la hoja de tabla "MAC Service Groups"
Name

Description

MAC Services

[Texto libre de 128 caracteres máximo]

[Texto libre de 255 caracteres máximo]

[Texto libre, los servicios se separan en‐
tre sí con comas]

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

385

Configuración de dispositivos y redes
1.3 Configurar redes

Servicios IP
Definir servicios IP
Cómo se accede a esta función
En las funciones globales de seguridad, seleccione la entrada "Cortafuegos > Servicios >
Definir servicios para reglas IP".

Procedimiento
En esta página se definen los servicios IP. Con ayuda de las definiciones de servicios IP se
pueden definir reglas de cortafuegos, que se aplican a servicios determinados. Para esto se
adjudica un nombre, al que se asignan los parámetros de servicio. También existe la
posibilidad de seleccionar servicios IP predefinidos.
Para la configuración de las reglas IP se utiliza simplemente ese nombre.
Además, los servicios así definidos se pueden reunir a su vez en grupos, con un nombre de
grupo. También en este caso es posible seleccionar grupos predefinidos.

Parámetros para servicios IP
Los servicios IP se definen a través de los siguientes parámetros:
Tabla 1-28

Servicios IP: Parámetros

Parámetro

Significado/comentario

Posibilidades de selección /
Rangos de valores

Nombre

Nombre para el servicio; se utiliza para la identifica‐
ción en la definición de reglas o en el agrupamiento.
Los nombres de servicios predefinidos no pueden
modificarse.

● El nombre no puede estar
repetido.

Protocolo

Selecciona el tipo de protocolo

● TCP
● UDP
● TCP+UDP
● Todos

386

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Significado/comentario

Posibilidades de selección /
Rangos de valores

Puerto de ori‐
gen

Se filtra a partir del número de puerto aquí indicado;
este define el acceso al servicio para el remitente de
los telegramas.

Si se selecciona el protocolo
"TCP+UDP" no es posible indi‐
car el puerto.
Ejemplos:
*: Puerto no se comprueba
20 o 21: Servicio FTP

Puerto de des‐ Se filtra a partir del número de puerto aquí indicado;
tino
este define el acceso al servicio para el destinatario
de los telegramas.

Si se selecciona el protocolo
"TCP+UDP" no es posible indi‐
car el puerto.
Ejemplos:
*: Puerto no se comprueba
TCP 80: Web-HTTP-Service
TCP 102: protocolo S7

Servicios ICMP
Cómo se accede a esta función
1. En las funciones globales de seguridad, seleccione la entrada "Cortafuegos > Servicios >
Definir servicios para reglas IP".
2. Seleccione la ficha "ICMP".

Principio
Con ayuda de la definición de los servicios ICMP se pueden definir de forma compacta y clara
reglas de cortafuegos que se aplican a servicios determinados. Para esto se adjudica un
nombre, al que se asignan los parámetros de servicio. También existe la posibilidad de
seleccionar servicios ICMPv4 e ICMPv6 predefinidos.
Además, los servicios definidos de este modo se pueden reunir en grupos, con un nombre de
grupo. También en este caso es posible seleccionar grupos predefinidos.
Para la configuración de las reglas de filtrado de paquetes se utiliza entonces ese nombre.

Servicios ICMPv4 e ICMPv6 definidos por el sistema
Los servicios definidos por el sistema se muestran en la tabla. Los valores de los servicios
ICMP predefinidos no pueden modificarse.
Si ya se utilizan nombres de servicios ICMP definidos por el sistema en proyectos existentes,
estos no se mostrarán en la lista. Si desea utilizar todos los servicios ICMP definidos por el
sistema, deberá cambiar el nombre que ya se utiliza para el servicio en una versión anterior de
STEP 7.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

387

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros para servicios ICMP
Parámetro

Significado/comentario

Posibilidades de selección / Ran‐
gos de valores

Nombre

Nombre de libre definición para el servicio; se
utiliza para la identificación en la definición de
reglas o en el agrupamiento.

● Nombre de libre elección.

Los nombres de servicios ICMPv4 e ICMPv6
predefinidos no pueden modificarse.

● Para un servicio ICMPv4 y
un servicio ICMPv6 es
posible utilizar el mismo
nombre.
● Dentro de un servicio, el
nombre debe ser unívoco.

ICMPv6

Si se activa esta casilla de verificación, el ser‐ ● activado
vicio ICMP se declara como servicio ICMPv6 ● desactivado
y es posible seleccionar para el servicio un
tipo y un código específicos de ICMPv6. Un
servicio ICMPv6 solo puede utilizarse en la
regla de cortafuegos de un módulo de seguri‐
dad que soporte IPv6.
Si se desactiva esta casilla de verificación, el
servicio ICMP se declara como servicio
ICMPv4 y es posible seleccionar para el ser‐
vicio un tipo y un código específicos de
ICMPv4.

Tipo

Si la casilla de verificación
"ICMPv6" está desactivada pue‐
den seleccionarse tipos específi‐
Destination Unreachable: no es posible entre‐
cos de ICMPv4. Si la casilla de
gar el telegrama IP.
verificación está activada puede
Time Exeeded: se ha rebasado el límite de
seleccionarse tipos específicos
tiempo.
de ICMPv6.
Echo-Request: consulta de eco, más conoci‐
da como "ping".
Tipo del mensaje ICMPv4 o ICMPv6.
Algunos ejemplos son:

Código

Código del tipo ICMP.
El código describe con más precisión el tipo
de paquete ICMP. La indicación depende del
tipo seleccionado.

Los valores dependen del tipo
seleccionado.

"*" significa que se han seleccionado todos
los códigos.

Resultado
Encontrará una lista completa de los tipos de paquete ICMP y de los códigos en la página web
de IANA:
Enlace: (https://www.iana.org/assignments/icmp-parameters)

388

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Crear grupos de servicios
Cómo se accede a esta función
1. En las funciones globales de seguridad, seleccione la entrada "Cortafuegos > Servicios >
Definir servicios para reglas IP".
2. Seleccione la ficha "Grupos de servicios".

Formación de grupos de servicios
Puede agrupar varios servicios formando grupos de servicios. De este modo se crean servicios
más complejos que se pueden utilizar en las reglas de filtrado de paquetes seleccionando
simplemente un nombre. Es posible reunir en un grupo servicios IPv4 e IPv6.
Los grupos se crean en la ficha "Grupos de servicios" abierta. A continuación asigne los
servicios a un grupo en la ficha "Administración de grupos".
También es posible seleccionar grupos de servicios que ya están predefinidos para ICMPv4 o
ICMPv6, por ejemplo.

Proceda del siguiente modo
1. Primero cree en esta ficha grupos con un nombre adecuado a sus exigencias y un texto
descriptivo opcional.
2. Seleccione luego la ficha "Administración de grupos". Allí puede asignar a los grupos aquí
definidos los servicios IP establecidos con anterioridad.

Administrar grupos de servicios
Cómo se accede a esta función
1. En las funciones globales de seguridad, seleccione la entrada "Cortafuegos > Servicios >
Definir servicios para reglas IP".
2. Seleccione la ficha "Administración de grupos".

Formación de grupos de servicios
Puede agrupar varios servicios formando grupos de servicios. De este modo se crean servicios
más complejos que se pueden utilizar en las reglas de filtrado de paquetes seleccionando
simplemente un nombre. Es posible reunir en un grupo servicios IPv4 e IPv6.
En la ficha "Administración de grupos" se asignan servicios a un grupo de servicios
seleccionado. Puede ser un grupo creado previamente en la ficha "Grupos de servicios" o un
grupo predefinido.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

389

Configuración de dispositivos y redes
1.3 Configurar redes

Proceda del siguiente modo
1. En esta ficha seleccione primero un grupo por medio de la lista desplegable "Grupos de
servicios".
2. Luego asigne al grupo los servicios deseados del campo de selección de la derecha
"Servicios disponibles".

Servicios MAC
Definir servicios MAC
Cómo se accede a esta función
En las funciones globales de seguridad, seleccione la entrada "Cortafuegos > Servicios >
Definir servicios para las reglas MAC".

Significado
La definición de los servicios MAC permite definir de forma compacta y clara reglas de
cortafuegos que se aplican a servicios determinados. Se adjudica un nombre, al que se
asignan los parámetros de servicio.
Además, los servicios definidos de este modo se pueden reunir en grupos, con un nombre de
grupo.
Para la configuración de las reglas de filtrado de paquetes globales o locales se utilizan
entonces esos nombres.

390

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Parámetros para servicios MAC
Una definición de servicios MAC se forma mediante parámetros MAC específicos del
protocolo:
Tabla 1-29

Parámetros de servicios MAC

Parámetro

Significado/comentario

Posibilidades de selección / Rangos de va‐
lores

Nombre

Nombre de libre definición para el servicio; se utiliza para
la identificación en la definición de reglas o en el agrupa‐
miento.

● El nombre no puede estar repetido.

Nombre del tipo de protocolo:

● ISO

● ISO
ISO designa telegramas con las siguientes
propiedades:
Lengthfield <= 05DC (hex),
DSAP= userdefined
SSAP= userdefined
CTRL= userdefined

● SNAP

Protocolo

● PROFINET IO
● 0x (entrada del número de protocolo)

● SNAP
SNAP designa telegramas con las siguientes
propiedades:
Lengthfield <= 05DC (hex),
DSAP=AA (hex),
SSAP=AA (hex),
CTRL=03 (hex),
OUI=userdefined,
OUI-Type=userdefined
● PROFINET IO
● Como alternativa también es posible introducir un
número de protocolo.
Las entradas de protocolo 0800 (hex) y 0806 (hex) no se
aceptan, ya que estos valores se aplican a telegramas IP
y ARP, respectivamente.
DSAP

Destination Service Access Point: Dirección de destinata‐
rio LLC

SSAP

Source Service Access Point: Dirección de remitente LLC

CTRL

LLC Control Field

OUI

Organizationally Unique Identifier
(los tres primeros bytes de la dirección MAC = identifica‐
ción del fabricante)

Tipo OUI

Tipo/Identificación de protocolo

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

391

Configuración de dispositivos y redes
1.3 Configurar redes

Nota
Procesamiento para CPs S7
Solo se procesan ajustes para frames ISO con DSAP=SSAP=FE (hex). Cualquier otro tipo de
frame no es relevante para CPs S7, por lo que ya es rechazado por el cortafuegos antes del
procesamiento.

Ajustes especiales para servicios SIMATIC NET
Utilice para el filtrado de servicios especiales SIMATIC NET los siguientes ajustes de protocolo:
● DCP:
PROFINET IO
● SiClock :
OUI= 08 00 06 (hex), OUI-Type= 01 00 (hex)

Crear grupos de servicios
Cómo se accede a esta función
1. En las funciones globales de seguridad, seleccione la entrada "Cortafuegos > Servicios >
Definir servicios para las reglas MAC".
2. Seleccione la ficha "Grupos de servicios".

Formación de grupos de servicios
Puede agrupar varios servicios formando grupos de servicios. De este modo se crean servicios
más complejos que se pueden utilizar en las reglas de filtrado de paquetes seleccionando
simplemente un nombre.
Los grupos se crean en la ficha "Grupos de servicios" abierta. A continuación asigne los
servicios a un grupo en la ficha "Administración de grupos".
También es posible seleccionar grupos de servicios que ya están predefinidos para DCP, por
ejemplo.

Proceda del siguiente modo
1. Primero cree en esta ficha grupos con un nombre adecuado a sus exigencias y un texto
descriptivo opcional.
2. Seleccione luego la ficha "Administración de grupos". Allí puede asignar a los grupos aquí
definidos los servicios MAC establecidos con anterioridad.

392

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Administrar grupos de servicios
Cómo se accede a esta función
1. En las funciones globales de seguridad, seleccione la entrada "Cortafuegos > Servicios >
Definir servicios para las reglas MAC".
2. Seleccione la ficha "Administración de grupos".

Formación de grupos de servicios
Puede agrupar varios servicios formando grupos de servicios. De este modo se crean servicios
más complejos que se pueden utilizar en las reglas de filtrado de paquetes seleccionando
simplemente un nombre.
En la ficha "Administración de grupos" se asignan servicios a un grupo de servicios
seleccionado. Puede ser un grupo creado previamente en la ficha "Grupos de servicios" o un
grupo predefinido.

Proceda del siguiente modo
1. En esta ficha seleccione primero un grupo por medio de la lista desplegable "Grupos de
servicios".
2. Luego asigne al grupo los servicios deseados del campo de selección de la derecha
"Servicios disponibles".

Cortafuegos local
Resumen de reglas de cortafuegos locales
Significado
Las reglas de cortafuegos locales se configuran en los ajustes de seguridad locales de un
módulo de seguridad y solo son válidas para dicho módulo de seguridad. Después de activar
la funcionalidad de cortafuegos es posible utilizar reglas de cortafuegos predefinidas o bien
definir nuevas reglas de cortafuegos en el modo de cortafuegos avanzado.

Utilizar reglas de cortafuegos predefinidas
Aquí se recurre a reglas de cortafuegos sencillas y predefinidas. Solo pueden habilitarse reglas
específicas de servicio. Los servicios habilitados están permitidos para todos los dispositivos
en el sentido indicado. Encontrará información detallada sobre la definición de reglas de
cortafuegos de esta ventana de diálogo en los capítulos siguientes específicos del módulo:
● Para SCALANCE S: AUTOHOTSPOT
● Para CP S7-300/S7-400/PC: AUTOHOTSPOT
● Para CP S7-1200/S7-1500: AUTOHOTSPOT

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

393

Configuración de dispositivos y redes
1.3 Configurar redes
El sentido de comunicación configurable para CPs "Estación" contiene el acceso al CP y el
acceso a la CPU a través del CP.

Definir reglas de cortafuegos en modo de cortafuegos avanzado
En el modo de cortafuegos avanzado se pueden definir ajustes de cortafuegos detallados.
Existe la posibilidad de activar servicios determinados para dispositivos concretos o habilitar
para el dispositivo todos los servicios para el acceso a la estación o a la red. Active el modo de
cortafuegos avanzado mediante la casilla de verificación "Activar cortafuegos en modo
avanzado". Los editores para la configuración de reglas IP y MAC se abren en el modo de
cortafuegos avanzado a través de los botones correspondientes en "Cortafuegos > Reglas IP"
o bien "Cortafuegos > Reglas MAC". Consulte las posibilidades de configuración que existen
en los editores en los capítulos siguientes:
Para reglas de filtrado de paquetes IP: Definir reglas de filtrado de paquetes IP (Página 395)
Para reglas de filtrado de paquetes MAC: Definir reglas para filtrado de paquetes MAC
(Página 400)
Nota
No es posible desactivar el modo de cortafuegos avanzado
Una vez que se ha activado el modo de cortafuegos avanzado ya no se puede desactivar.

Aplicación de reglas de cortafuegos predefinidas en el modo de cortafuegos avanzado
Cuando se cambia al modo de cortafuegos avanzado se aplican tanto las reglas de
cortafuegos predefinidas activadas como los ajustes de registro. Si, por ejemplo, para un
módulo SCALANCE S está activada la casilla de verificación "Permitir protocolo S7" en el
sentido "De externa a interna", en el modo de cortafuegos avanzado se crea automáticamente
una regla Accept con este sentido de comunicación y el servicio "S7".
Si para CP S7-1200/S7-1500 existen ajustes de registro predefinidos, no se representarán
como reglas de cortafuegos en el modo de cortafuegos avanzado sino que se visualizarán bajo
la entrada "Cortafuegos > Ajustes de registro" con posibilidad de editarse.

Capacidad
Número de reglas de cortafuegos (modo de cortafuegos avanzado)
SCALANCE S V3 o superior

256 como máximo

CP S7-1200/S7-1500

256 como máximo

CP 343-1 Adv. / 443-1 Adv.

226 como máximo

CP 1628

226 como máximo

394

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Definir reglas de filtrado de paquetes IP
Significado
Utilizando reglas de filtrado de paquetes IP se puede filtrar por telegramas IP, p. ej. TCP, UDP
o ICMP.
Dentro de una regla de filtrado de paquetes se puede acceder a definiciones de los servicios
IP.
Las reglas de cortafuegos globales asignadas y las reglas de cortafuegos generadas
automáticamente para NAT/NAPT se representan como conjuntos de reglas.

Elementos de mando de la barra de menús
Los elementos de mando de la barra de menús tienen las siguientes funciones:
Elemento de mando

Función
Activar cortafuegos
Activa el editor para reglas IP. Con el editor activado pueden configurarse las
reglas correspondientes, que se transmiten al módulo al cargar.
Insertar regla arriba
Inserta una regla sobre la regla seleccionada o sobre el conjunto de reglas
seleccionado. Para insertar encima de un conjunto de reglas tiene que estar
seleccionada la primera línea de este.
Insertar regla abajo
Inserta una regla debajo de la regla seleccionada o del conjunto de reglas
seleccionado. Para insertar debajo de un conjunto de reglas tiene que estar
seleccionada la primera línea de este.
Mover hacia arriba
Mueve la regla seleccionada o el conjunto de reglas seleccionado una línea
hacia arriba. Para mover un conjunto de reglas tiene que estar seleccionada la
primera línea de este.
Mover hacia abajo
Mueve la regla seleccionada o el conjunto de reglas seleccionado una línea
hacia abajo. Para mover un conjunto de reglas tiene que estar seleccionada la
primera línea de este.
Desplegar juegos de reglas
Representa los conjuntos de reglas existentes desplegados.
Plegar juegos de reglas
Representa los conjuntos de reglas existentes plegados.
Separar
Convierte la línea seleccionada en una o varias reglas individuales. Si se se‐
lecciona la primera línea de un conjunto de reglas, todas las reglas del conjunto
de reglas se convertirán en reglas individuales. Si se selecciona una regla
contenida en el conjunto de reglas, esta se convierte en una regla individual.
Además, las siguientes reglas del conjunto de reglas se convierten en un con‐
junto de reglas individual.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

395

Configuración de dispositivos y redes
1.3 Configurar redes

Editor de reglas IP avanzado
Después de seleccionar una regla IP, en "General > Reglas IP" de la ventana de inspección
aparece un editor de reglas IP avanzado para la configuración simplificada de reglas IP. Los
cambios realizados en este editor se aplican a la regla IP seleccionada.

Definir reglas IP en el editor de reglas IP avanzado
Pueden configurarse los parámetros siguientes:
Tabla 1-30
Parámetro

Parámetros del editor de reglas IP
Significado/comentario

Posibilidades de selección / Rangos de valores

General
Número

Número de la regla asigna‐
do automáticamente. Los
números se calculan de
nuevo cuando se despla‐
zan reglas.

Comentario

Espacio para explicación
propia de la regla

Si un comentario está marcado con "AUTO", significa que ha sido creado para
una regla de conexión automática. Para reglas de creación propia, la entrada
de un comentario es opcional.

Definición de la autoriza‐
ción (habilitación/bloqueo)

● Accept
Autorizar telegramas según definición.

Reglas IP
Acción

● Drop
Bloquear telegramas según definición.
● Reject
Los telegramas son rechazados y el remitente recibe el aviso
correspondiente.
Para reglas de cortafuegos que se crearon automáticamente mediante una
configuración de conexión y después se adaptaron manualmente:
● Accept*
● Drop*
Si se modifican reglas de conexión creadas automáticamente, al
seleccionar la opción "*" no volverán a generarse ni sobrescribirse desde
STEP 7.

396

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Significado/comentario

Posibilidades de selección / Rangos de valores

De / A

Selecciona los sentidos de
comunicación para los que
debe regir la regla.

Se describen en apartados separados.
● Para módulos SCALANCE S: Sentidos de filtrado de paquetes IP
SCALANCE S (Página 506)
● Para CP S7-300/S7-400/PC: Sentidos de filtrado de paquetes IP CPs
S7-300/S7-400/PC (Página 539)
● Para CP S7-1200/S7-1500: Sentidos de filtrado de paquetes IP para CP
S7-1200/S7-1500 (Página 554)
El sentido de comunicación "Station" contiene el acceso al CP y el acceso a
la CPU a través del CP.
El sentido de comunicación "Any" incluye todos los sentidos de cortafuegos
soportados por el módulo de seguridad en el momento de la carga.
Los sentidos de comunicación "Station", "Bus de fondo" (solo para CP 1543-1
ab V2.1 con la opción "Routing IP entre módulos de comunicación") y "Tun‐
nel" están clasificados de forma estándar como fiables. Para la comunicación
entre sentidos fiables no es necesario configurar reglas de cortafuegos.

Dirección IP de
origen

Dirección IP de
destino

La regla del cortafuegos se
aplica a los telegramas cu‐
yo remitente tiene la direc‐
ción IP indicada aquí. Si no
se indica ninguna dirección
IP, la regla del cortafuegos
es válida para todos los dis‐
positivos dentro del sentido
de comunicación seleccio‐
nado en la columna "De".
La regla del cortafuegos se
aplica a los telegramas cu‐
yo destinatario tiene la di‐
rección IP indicada aquí. Si
no se indica ninguna direc‐
ción IP, la regla del corta‐
fuegos es válida para todos
los dispositivos dentro del
sentido de comunicación
seleccionado en la colum‐
na "A".

Las áreas de direcciones pueden configurarse en los campos de entrada de
las columnas "Desde" y "Hasta" del editor. Si se configuran varias áreas de
direcciones para una regla IP, tendrá que coincidir el número de direcciones
en cada caso. Tras la configuración de áreas de direcciones, a partir de la
regla IP de STEP 7 seleccionada se genera un conjunto de reglas IP, que
contiene una regla IP para cada una de las reglas.
Encontrará más información sobre direcciones IP en el apartado Direcciones
IP en reglas de filtrado de paquetes IP (Página 403).
Configuraciones posibles en modo Ghost (solo para SCALANCE S602 V3.1
o superior):
Si el modo Ghost está activado, la dirección IP del dispositivo interno se
determina dinámicamente en el tiempo de ejecución desde el módulo de
seguridad. Según sea el sentido seleccionado, no podrá seleccionar una de
las opciones siguientes en la columna "Dirección IP de origen" (con el sentido
"de interna a externa") o en la columna "Dirección IP de destino" (con el
sentido "de externa a interna"):
● Dirección IP del dispositivo interno: el SCALANCE S insertará la dirección
IP del dispositivo interno en la regla del cortafuegos.
● Limited broadcast: el SCALANCE S insertará la dirección IP Broadcast
255.255.255.255 en la regla del cortafuegos.
● Directed broadcast: el SCALANCE S insertará la dirección IP Broadcast
de la red SCALANCE S en la regla del cortafuegos. Un Directed broadcast
también se puede reenviar a la red de destino a través de router.
● Multicast: el SCALANCE S insertará el rango de direcciones Multicast
224.0.0.0 /24 en la regla del cortafuegos. Tras seleccionar esta opción,
alternativamente se puede indicar una determinada dirección IP Multicast
del rango de direcciones Multicast.

Ajustes adicionales

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

397

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Significado/comentario

Posibilidades de selección / Rangos de valores

Servicio

Selección del servicio IP/
ICMP o del grupo de servi‐
cios que debe utilizarse.

Al realizar la selección se abre una ventana en la que se muestran todos los
servicios IP, servicios ICMP y grupos de servicios, tanto predefinidos como
configurados. Se administran en las funciones globales de seguridad, en
"Cortafuegos > Servicios > Definir servicios para reglas IP".

Nota: Antes de utilizar un
servicio predefinido, asegú‐
rese de que sus paráme‐
tros predefinidos cumplen
los requisitos necesarios.
Preste especial atención a
los puertos de origen y des‐
tino predefinidos.
Velocidad de
transmisión
(Mbits/s)

Limitación de la velocidad
de transmisión

CP 343-1 Adv. / CP 443-1 Adv., CP S7-1200/S7-1500, CP 1628: 0,001 ... 100
Mbits/s

Solo puede introducirse si
para la acción está selec‐
cionado "Accept".

SCALANCE S: 0,001 ... 1000 Mbits/s

Un paquete pasa el corta‐
fuegos si la regla Accept es
correcta y si no se ha so‐
brepasado aún la veloci‐
dad de transmisión permiti‐
da para esa regla.

Para reglas globales y personalizadas: 0,001 ... 1000 Mbits/s
Para reglas IP con sentido "Bus de fondo": 0.001 ... 1 Mbits/s
Nota: Si se configura el sentido "De túnel a estación" en una regla de corta‐
fuegos para CP S7-1200/S7-1500 no es posible indicar ninguna limitación de
la velocidad de transmisión.
Para CP 1543-1 V2.1 solo puede indicarse una limitación de la velocidad de
transmisión si para uno de los sentidos se ha configurado "Any". Esta norma
no es aplicable para la combinación de los sentidos "Any" y "Station".

Registro

Activación o desactivación ● activado
del inicio de sesión para es‐ ● desactivado (predeterminado)
ta regla. Si el inicio de se‐
sión está activado rigen los
ajustes para el registro de
filtros de paquetes que se
han configurado en los
ajustes de seguridad loca‐
les.

Número

Número de la regla asigna‐
do automáticamente. Los
números se calculan de
nuevo cuando se despla‐
zan reglas.

398

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Significado/comentario

Posibilidades de selección / Rangos de valores

Con estado

Si esta casilla de verifica‐
ción está desactivada para
una regla IP con la acción
"Accept", no se generan
States de cortafuegos por
medio de paquetes que
cumplen la regla Accept.
Los States de cortafuegos
hacen que las respuestas a
paquetes permitidos se
permitan automáticamente.

Para reglas Accept de SCALANCE S ≥ V3:
● activado (predeterminado)
● desactivado
Para reglas Accept de SCALANCE S < V3 y CP:
● activado (predeterminado)
Observación: La casilla de verificación no existe para CP, pero implícitamente
se utiliza siempre la opción activada para reglas Accept de CP.

Solo puede adaptarse si
Para reglas Drop:
para la acción está selec‐
● desactivado (predeterminado)
cionado "Accept". La confi‐
guración de reglas IP sin
States de cortafuegos solo
es posible para módulos
SCALANCE S con firmwa‐
re V3 o superior. Si también
deben permitirse respues‐
tas a paquetes que han pa‐
sado el cortafuegos en ba‐
se a este tipo de reglas IP,
deben configurarse reglas
IP adicionales para dichas
respuestas.
Número de co‐
pias que deben
crearse

Tabla 1-31

La regla IP seleccionada se Seleccione con qué frecuencia debe copiarse la regla seleccionada y haga
copia
clic en el botón "Crear copias".

Significados de las entradas del menú contextual

Entrada del menú contextual

Significado

Insertar regla arriba

Inserta una regla sobre la regla seleccionada.

Insertar regla abajo

Inserta una regla por debajo de la regla seleccionada.

Borrar

Borra la regla seleccionada.

Guardar como juego de reglas global

Copia la o las reglas de cortafuegos seleccionadas y las inserta en las funciones
de seguridad globales como conjunto de reglas de cortafuegos global. Este pro‐
ceso no afecta a la configuración de cortafuegos actual definida para el módulo de
seguridad.

Subir

Mueve la regla seleccionada una posición hacia arriba en la lista. También es
posible mover la regla seleccionada por Drag & Drop. No es posible realizar una
selección múltiple.
De esta forma la regla desplazada se trata con una prioridad mayor.

Bajar

Mueve la regla seleccionada hacia abajo. También es posible mover la regla se‐
leccionada por Drag & Drop. No es posible realizar una selección múltiple.
De esta forma la regla desplazada se trata con una prioridad menor.

Definir servicio para reglas IP

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Sirve para abrir un cuadro de diálogo en el que se administran los servicios IP y los
grupos de servicios.

399

Configuración de dispositivos y redes
1.3 Configurar redes

Definir reglas para filtrado de paquetes MAC
Significado
Con reglas de filtrado de paquetes MAC se filtran telegramas MAC.
Dentro de una regla de filtrado de paquetes se puede acceder a definiciones de los servicios
MAC.
Las reglas de cortafuegos globales asignadas se representan como conjuntos de reglas.

Elementos de mando de la barra de menús
Los elementos de mando de la barra de menús tienen las siguientes funciones:
Elemento de mando

Función
Activar cortafuegos
Activa el editor para reglas MAC. Con el editor activado pueden configurarse
las reglas correspondientes, que se transmiten al módulo al cargar.
Insertar regla arriba
Inserta una regla sobre la regla seleccionada o sobre el conjunto de reglas
seleccionado. Para insertar encima de un conjunto de reglas tiene que estar
seleccionada la primera línea de este.
Insertar regla abajo
Inserta una regla debajo de la regla seleccionada o del conjunto de reglas
seleccionado. Para insertar debajo de un conjunto de reglas tiene que estar
seleccionada la primera línea de este.
Mover hacia arriba
Mueve la regla seleccionada o el conjunto de reglas seleccionado una línea
hacia arriba. Para mover un conjunto de reglas tiene que estar seleccionada la
primera línea de este.
Mover hacia abajo
Mueve la regla seleccionada o el conjunto de reglas seleccionado una línea
hacia abajo. Para mover un conjunto de reglas tiene que estar seleccionada la
primera línea de este.
Desplegar juegos de reglas
Representa los conjuntos de reglas existentes desplegados.
Plegar juegos de reglas
Representa los conjuntos de reglas existentes plegados.

Introducir reglas para el filtrado de paquetes MAC
Después de activar el editor, las reglas MAC pueden configurarse a través de los siguientes
parámetros:

400

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Tabla 1-32

Reglas MAC: Parámetros

Parámetro

Significado/comentario

Posibilidades de selección / Rangos de valores

Acción

Definición de la autorización (habili‐
tación/bloqueo)

● Accept
Autorizar telegramas según definición.
● Drop
Bloquear telegramas según definición.
● Reject
Los telegramas son rechazados y el remitente recibe el aviso
correspondiente.
Para reglas de cortafuegos que se crearon automáticamente me‐
diante una configuración de conexión y después se adaptaron ma‐
nualmente:
● Accept*
● Drop*
Si se modifican reglas de conexión creadas automáticamente, al
seleccionar la opción "*" no volverán a generarse ni
sobrescribirse desde STEP 7.

De/A

Selecciona los sentidos de comuni‐ Se describen en apartados separados.
cación para los que debe regir la reg‐ ● Para módulos SCALANCE S: Sentidos de filtrado de paquetes
la.
MAC SCALANCE S (Página 507)
● Para CP S7-300/S7-400/PC: Sentidos de filtrado de paquetes
MAC CPs S7-300/S7-400/PC (Página 540)
● Para CP S7-1200/S7-1500: Sentidos de filtrado de paquetes
MAC para CP S7-1200/S7-1500 (Página 554)
El sentido de comunicación "Station" contiene el acceso al CP y el
acceso a la CPU a través del CP.
Los sentidos de comunicación "Station" y "Tunnel" están clasifica‐
dos de forma estándar como fiables. Para la comunicación entre
sentidos fiables no es necesario configurar reglas de cortafuegos.

Dirección MAC
de origen

La regla del cortafuegos se aplica a Dirección MAC en formato correcto
los telegramas cuyo remitente tiene
la dirección MAC indicada aquí. Si
no se indica ninguna dirección MAC,
la regla del cortafuegos es válida pa‐
ra todos los dispositivos dentro del
sentido de comunicación selecciona‐
do en la columna "De".

Dirección MAC
de destino

La regla del cortafuegos se aplica a
los telegramas cuyo destinatario tie‐
ne la dirección MAC indicada aquí.
Si no se indica ninguna dirección
MAC, la regla del cortafuegos es vá‐
lida para todos los dispositivos den‐
tro del sentido de comunicación se‐
leccionado en la columna "A".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

401

Configuración de dispositivos y redes
1.3 Configurar redes
Parámetro

Significado/comentario

Servicio

Selección del servicio MAC o del gru‐ La lista desplegable le ofrece los servicios y grupos de servicios
po de servicios que debe utilizarse. predefinidos y configurados, para su selección. Se muestran en las
funciones de seguridad globales, en "Cortafuegos > Servicios > De‐
Nota: Antes de utilizar un servicio
finir servicios para reglas MAC".
predefinido, asegúrese de que sus

Posibilidades de selección / Rangos de valores

parámetros predefinidos cumplen
los requisitos necesarios.
Velocidad de
transmisión
(Mbits/s)

Limitación de la velocidad de trans‐
misión

CP 343-1 Adv. / CP 443-1 Adv., S7-1200-/S7-1500-CPs:
0,001 ... 100 Mbits/s

Solo puede introducirse si para la ac‐ CP 1628 y SCALANCE S: 0,001 ... 1000 Mbits/s
ción está seleccionado "Accept".
Para reglas globales: 0,001 ... 1000 Mbits/s
Un paquete pasa el cortafuegos si la Nota: Si se configura el sentido "De túnel a estación" en una regla de
regla Accept es correcta y si no se ha cortafuegos para CP S7-1200/S7-1500 no es posible indicar ningu‐
sobrepasado aún la velocidad de
na limitación de la velocidad de transmisión.
transmisión permitida para esa regla.

Registro

Activación o desactivación del regis‐ ● activado
tro para esta regla. Si el inicio de se‐ ● desactivado (predeterminado)
sión está activado rigen los ajustes
para el registro de filtros de paquetes
que se han configurado en los ajus‐
tes de seguridad locales.

Número

Número de la regla asignado auto‐
máticamente. Los números se calcu‐
lan de nuevo cuando se desplazan
reglas.

Comentario

Espacio para explicación propia de
la regla

Tabla 1-33

Si un comentario está marcado con "AUTO", significa que ha sido
creado para una regla de conexión automática. Para reglas de crea‐
ción propia, la entrada de un comentario es opcional.

Significado de los comandos de menú

Botón

Significado

Borrar

Sirve para eliminar la regla seleccionada o el conjunto de reglas global seleccio‐
nado.
Indicaciones sobre la eliminación de un conjunto de reglas definido como global y
asignado como local:
Al eliminar el conjunto de reglas solo se anula la asignación al módulo de seguri‐
dad.

Guardar como conjunto de reglas global Copia la o las reglas de cortafuegos seleccionadas y las inserta en las funciones
(solo para reglas de cortafuegos locales) de seguridad globales como conjunto de reglas de cortafuegos global. Este pro‐
ceso no afecta a la configuración de cortafuegos actual definida para el módulo de
seguridad.
Mover hacia arriba

Sirve para mover la regla seleccionada o el conjunto de reglas global seleccionado
una posición hacia arriba en la lista. También es posible mover por Drag & Drop la
regla o el conjunto de reglas seleccionado. No es posible realizar una selección
múltiple.
De esta forma la regla o el conjunto de reglas desplazado se trata con una priori‐
dad mayor.

402

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Botón

Significado

Mover hacia abajo

Sirve para mover la regla seleccionada o el conjunto de reglas global seleccionado
una posición hacia abajo en la lista. También es posible mover por Drag & Drop la
regla o el conjunto de reglas seleccionado. No es posible realizar una selección
múltiple.
De esta forma la regla o el conjunto de reglas desplazado se trata con una priori‐
dad menor.

Definir servicio para reglas MAC

Sirve para abrir un cuadro de diálogo en el que se administran los servicios MAC
y los grupos de servicios.

Direcciones IP en reglas de filtrado de paquetes IP
Entrada de direcciones IP en reglas de filtrado de paquetes IP
En las reglas de filtrado de paquetes IP existen las siguientes posibilidades de introducir
direcciones IP:
● ninguna indicación
La regla es válida para todas las direcciones IP.
● una dirección IP
La regla es válida exactamente para la dirección indicada.
● Rango de direcciones
La regla es válida para todas las direcciones IP incluidas en el rango de direcciones.
Una banda de direcciones se define indicando la cantidad de posiciones de bits válidas en
la dirección IP, a saber en la siguiente forma:[Dirección IP]/[Número de bits que considerar]
– [Dirección IP]/24 significa por consiguiente que solo los 24 bits de mayor valor de la
dirección IP se tienen en cuenta en la regla de filtrado. Se trata de las tres primeras
posiciones de la dirección IP.
– [Dirección IP]/25 significa que solo se tienen en cuenta en la regla de filtrado las tres
primeras posiciones y el bit de valor más alto de la cuarta posición de la dirección IP.
● Área de direcciones
Para la dirección IP de origen puede introducirse un área de direcciones con el formato
siguiente:
[Dirección IP inicial]-[dirección IP final]

Direcciones IPv4
Una dirección IPv4 consta de 4 números decimales comprendidos en el rango de 0 a 255 y
separados entre ellos por un punto.
Tabla 1-34

Ejemplos de rangos de direcciones IPv4

Dirección IP de origen o
dirección IP de destino

Rango de direcciones
de

Número de
direcciones *)
a

192.168.0.0/16

192.168.0.0

192.168.255.255

65.536

192.168.10.0/24

192.168.10.0

192.168.10.255

256

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

403

Configuración de dispositivos y redes
1.3 Configurar redes
Dirección IP de origen o
dirección IP de destino

Rango de direcciones
de

Número de
direcciones *)
a

192.168.10.0/25

192.168.10.0

192.168.10.127

128

192.168.10.0/26

192.168.10.0

192.168.10.63

64

192.168.10.0/27

192.168.10.0

192.168.10.31

32

192.168.10.0/28

192.168.10.0

192.168.10.15

16

192.168.10.0/29

192.168.10.0

192.168.10.7

8

192.168.10.0/30

192.168.10.0

192.168.10.3

4

*) Nota: Tenga en cuenta que la dirección de red y la dirección Broadcast de un rango de direcciones
no están disponibles como direcciones IP de dispositivos de red.

Direcciones IPv6
Las direcciones IPv6 constan de 8 bloques de cuatro cifras hexadecimales cada uno (128 bits
en total). Los bloques están separados por dos puntos.
Ejemplo: fd00:ffff:ffff:ffff:ffff:ffff:2f33:8f21
Reglas / simplificaciones:
● Está permitido omitir los ceros a la izquierda dentro de un bloque.
Ejemplo: en lugar de 2001:0db8:2426:08d3:1457:8a2e:0070:7344 también es posible la
notación 2001:db8:2426:8d3:1457:8a2e:70:7344.
● Si uno o varios bloques tienen el valor 0 (o 0000) se admite una notación abreviada.
Ejemplo: en lugar de 2001:0db8:0:0:0:0:1428:57ab también es posible la notación
2001:db8::1428:57ab.
Con el fin de conservar la univocidad, dicha abreviación solo puede aplicarse una vez
dentro de toda la dirección.
● Notación decimal con puntos
Para los 2 últimos bloques o 4 bytes es posible utilizar la notación decimal tradicional con
puntos.
Ejemplo: la dirección IPv6 fd00::ffff.125.1.0.1 es equivalente a fd00::ffff:7d01:1.
● Notación de rango de direcciones en reglas de filtrado de paquetes IP: de forma análoga a
las direcciones IPv4, también es posible la notación de direcciones IPv6 en forma de rangos
de direcciones.
Ejemplo: la entrada "2001:0db8:85a3:08d3:1319:8a2e:0:0 /96" incluye todas las
direcciones IPv6 de 2001:0db8:85a3:08d3:1319:8a2e:0:0 a
2001:0db8:85a3:08d3:1319:8a2e:ffff:ffff.

Realizar ajustes de registro específicos del módulo
Resumen de ajustes de registro
Función específica del módulo
Algunas funciones de registro solo están disponibles para determinados módulos de
seguridad.

404

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Ajustes de registro en la configuración
Los ajustes de registro aquí adoptados se cargan en el módulo con la configuración y se
activan al arrancar el módulo de seguridad.
Los ajustes configurados para el registro de filtros de paquetes se pueden restringir, en caso
necesario, en las funciones online. Por ejemplo, si se ha configurado un registro IP y MAC, en
las funciones online puede ajustarse que únicamente se muestre el registro IP.

Métodos de registro y clases de eventos
Aquí puede definir qué datos deben ser registrados. De este modo activa ya el registro al
cargar la configuración en el módulo de seguridad.
Además elige en la configuración uno de los métodos de registro o ambos:
● registro local
● red Syslog
El módulo de seguridad reconoce para cada uno de los dos métodos de registro los tres tipos
de eventos siguientes:
● Eventos de filtrado de paquetes
● eventos de auditoría
● eventos de sistema

Configurar registro local
Cómo se accede a esta función
1. Seleccione el módulo que desea editar.
2. En los ajustes de seguridad locales elija la entrada "Configuración del registro" > "Local log
store".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

405

Configuración de dispositivos y redes
1.3 Configurar redes

Configurar registro local
Tabla 1-35

Registro local - Ajustes para eventos de registro

Evento de registro

Significado

Registro de filtros de paquetes (cor‐ El registro de filtros de paquetes re‐
tafuegos)
gistra determinados paquetes del trá‐
fico de datos. Solamente se registran
los paquetes de datos afectados por
una regla de filtrado de paquetes con‐
figurada (cortafuegos), o para los que
reacciona la protección básica (pa‐
quetes corruptos o no válidos). Con‐
dición para ello es que esté activado
el registro para la regla de filtrado de
paquetes.

Observaciones
Los datos del registro de filtros de paquetes
no son remanentes
Los datos se guardan en una memoria volátil
del módulo de seguridad, por lo que dejan de
estar disponibles tras una desconexión de la
alimentación eléctrica. Para el guardado re‐
manente es posible guardar también en un
archivo los datos de registro visualizados en
el cuadro de diálogo "Online y diagnóstico".

Puede definir la cantidad de paquetes
de datos registrados en la lista des‐
plegable "Paquetes para registrar":
● "Todos los paquetes": se registran
los paquetes de datos para los
que es válida una regla de
cortafuegos configurada. Además
se registran los paquetes de
respuesta a los paquetes que han
pasado el cortafuegos conforme a
una regla Accept configurada.
● "Paquetes generadores de
estado" (solo para SCALANCE S
V3 o superior): se registran
únicamente los paquetes de datos
a los que afecta una regla de
cortafuegos configurada y que
inicialmente generan un estado
en el cortafuegos. Los paquetes
de datos que han pasado el
cortafuegos utilizando este
estado de cortafuegos, no se
registran.
Registro de auditoría

El registro de eventos de auditoría es‐ Los datos de registro de auditoría son rema‐
nentes
tá siempre activado.
Se guardan en una memoria remanente del
módulo de seguridad, por lo que están dispo‐
El registro de auditoría registra de ma‐ nibles tras una desconexión de la alimenta‐
ción eléctrica.
nera automática y continua eventos
relevantes para la seguridad, por
Nota para CPs:
ejemplo acciones del usuario como
Con CPs, los datos de registro de auditoría no
activación o desactivación del regis‐ son remanentes. Por ello, para guardar los
tro de paquetes o carga de configura‐ datos es necesario utilizar un servidor Syslog.
ciones en el módulo de seguridad.
Se almacena siempre en la memoria
cíclica.

406

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Evento de registro

Significado

Observaciones

Registro del sistema

El registro del sistema registra de for‐
ma automática y continua eventos de
sistema como p. ej. el inicio de un pro‐
ceso o el intento fallido de un usuario
para iniciar sesión.

Los datos de registro de sistema no son re‐
manentes

Los datos se guardan en una memoria volátil
del módulo de seguridad, por lo que dejan de
estar disponibles tras una desconexión de la
Para configurar el filtro de eventos y el alimentación eléctrica. Para el guardado re‐
diagnóstico de líneas, elija la entrada manente es posible guardar también en un
"Ajustes del registro" > "Eventos del archivo los datos de registro visualizados en
sistema".
el cuadro de diálogo "Online y diagnóstico".

Tabla 1-36

Registro local - método de almacenamiento para el registro de los datos

Método de almacenamiento

Significado

Memoria circulante

Cuando se alcanza el final del búfer el registro continúa al principio del
búfer sobrescribiendo las entradas más antiguas.

Memoria lineal

El registro se detiene cuando el búfer está lleno.

Configurar eventos de sistema
Cómo se accede a esta función
1. Seleccione el módulo que desea editar.
2. En los ajustes de seguridad locales elija la entrada "Ajustes del registro" > "Eventos del
sistema".

Filtrado de los eventos de sistema
Ajuste en este cuadro de diálogo un nivel de filtrado para los eventos del sistema. Los valores
predeterminados son los siguientes:
● SCALANCE S: nivel 3 (error)
● CP: nivel 3 (error)
Se registran aquellos eventos del sistema que tienen la misma prioridad que los niveles de
filtrado seleccionados y que disponen de una prioridad más elevada que los niveles de filtrado
seleccionados. Cuanto menor sea el valor del nivel de filtrado, mayor será su prioridad y menos
eventos se registrarán.
El nivel de filtrado seleccionado debe tener una prioridad igual o menor que la severidad
ajustada para el diagnóstico de la línea (véase la tabla "Parametrización del diagnóstico de
líneas"; no para CP).
Recomendación: Seleccione el nivel de filtrado "Error" o un nivel de filtrado con una prioridad
superior para impedir el registro de eventos generales, no críticos.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

407

Configuración de dispositivos y redes
1.3 Configurar redes

Nota para CP
Seleccione para CPs únicamente los niveles 3 o 6, pues para los CPs solo se generan eventos
de estos niveles.
● Si selecciona el nivel 3, se muestran los mensajes de error de los niveles 0 a 3.
● Si selecciona el nivel 6, se muestran los mensajes de error de los niveles 0 a 6.

Propiedades de los eventos de sistema – Diagnóstico de líneas (solo para SCALANCE S)
El diagnóstico de líneas genera un evento especial del sistema. Se genera un evento de
sistema al alcanzarse el porcentaje de telegramas erróneos que se haya establecido. A este
evento de sistema se le asignarán la severidad y facilidad ajustadas en este cuadro de diálogo.
Tabla 1-37

Parametrización del diagnóstico de líneas

Función / opción / parámetro Significado
Activar

Activación y desactivación del registro.

Limit

Porcentaje ajustable de telegramas erróneos que, al alcanzarse, pro‐
voca un evento de sistema.

Facilidad

Seleccione en la lista desplegable una facilidad con la que identificar el
evento de sistema captado para su registro.

Severidad

A través de la severidad se ponderan los eventos de sistema del diag‐
nóstico de líneas respecto a la severidad de los eventos de sistema
restantes.

Nota
Severidad de los eventos de sistema del diagnóstico de líneas
No debe asignarse a los eventos de sistema del diagnóstico de líneas una severidad menor
que la que haya ajustado para el filtrado. En caso de una severidad menor, esos eventos no
pueden pasar el filtrado y no serán registrados.

Configurar el registro del sistema en red
Cómo se accede a esta función
1. Seleccione el módulo que desea editar.
2. Seleccione en los ajustes de seguridad locales la entrada "Configuración del registro" >
"Red Syslog".

408

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Configurar el registro del sistema en red
Tabla 1-38

Registro del sistema en red - Ajustes básicos

Opción/parámetros
Activar registro del sistema en red

Activar y desactivar la transferencia de eventos de registro al servidor
Syslog.

Servidor Syslog

Introduzca aquí la dirección IP del servidor Syslog. Para módulos SCA‐
LANCE S versión V4 o superior también existe la posibilidad alternativa de
introducir un FQDN.
El servidor Syslog debe ser accesible desde el módulo de seguridad a
través de la dirección indicada, y si fuese necesario, a través de la confi‐
guración del router en la entrada "Enrutamiento" de los ajustes de seguri‐
dad locales. Si el servidor Syslog no está accesible, no se enviarán men‐
sajes de registro del sistema. Este estado operativo puede reconocerse por
medio de los correspondientes avisos del sistema. Para activar de nuevo el
envío de información Syslog, deberá actualizar en caso necesario la infor‐
mación de routing y efectuar un reinicio del módulo de seguridad.

Activar clases de eventos

Active las clases de eventos que deben transferirse al servidor Syslog. Los
eventos de filtrado de paquetes y de auditoría pueden clasificarse por gra‐
vedad mediante Severity y por procedencia mediante Facility.

Nombre del módulo

Aquí se muestra el nombre del módulo, que no puede modificarse.

Nota
Transferencia no segura de eventos de registro
Los eventos de registro se transfieren al servidor Syslog en texto claro. Esto debe tenerse en
cuenta cuando se utilizan servidores Syslog.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

409

Configuración de dispositivos y redes
1.3 Configurar redes
Tabla 1-39

Registro del sistema en red - Ajustes para eventos de registro

Evento de registro

Configuración

Observaciones

Eventos de filtrado de paquetes
(cortafuegos)

El registro de filtros de paquetes regis‐
tra determinados paquetes del tráfico
de datos. Solamente se registran los
paquetes de datos afectados por una
regla de filtrado de paquetes configu‐
rada (cortafuegos), o para los que
reacciona la protección básica (paque‐
tes corruptos o no válidos). Para ello
es imprescindible que esté activado el
registro para la regla de filtrado de pa‐
quetes.

El valor que se seleccione aquí depende de la
evaluación en el servidor Syslog.
Si deja configurado el valor estándar "default",
se determina mediante el módulo de seguri‐
dad con qué combinación de Facility y Seve‐
rity se visualizará el evento.

Mediante el ajuste de Facility y Seve‐
rity se pueden clasificar los avisos de
Syslog en función de su procedencia y
de su gravedad. La asignación se rea‐
liza mediante listas desplegables. A
cada evento se asignan la Severity y
Facility que se configuren aquí.
Eventos de auditoría

El registro de auditoría registra de ma‐
nera automática y continua eventos
relevantes para la seguridad, por ejem‐
plo acciones del usuario como activa‐
ción o desactivación del registro de
paquetes o carga de configuraciones
en el módulo de seguridad.
La asignación de Severity y Facility se
realiza mediante listas desplegables.
A cada evento se asignan la Severity y
Facility que se configuren aquí.

Eventos de sistema

El registro del sistema registra de for‐
ma automática y continua eventos de
sistema como p. ej. el inicio de un pro‐
ceso o el intento fallido de un usuario
para iniciar sesión.

El valor que se seleccione aquí para Security
y Facility depende de la evaluación en el ser‐
vidor Syslog.
Si deja configurado el valor estándar "default",
se determina mediante el módulo de seguri‐
dad con qué combinación de Facility y Seve‐
rity se visualizará el evento.

Para configurar el filtro de eventos y el diag‐
nóstico de líneas, en los ajustes de seguridad
locales elija la entrada "Ajustes del registro" >
"Eventos del sistema".

Módulo de seguridad como router
Sinopsis de los ajustes de enrutamiento
Significado
Utilizando el módulo de seguridad en modo de enrutamiento, las redes se convierten en
subredes separadas en las interfaces interna y externa. La interfaz DMZ (solo SCALANCE
S623/S627-2M) se conecta en el modo de enrutamiento independientemente del modo de
operación. En el modo de enrutamiento se reenvían los telegramas dirigidos a una dirección
IP existente en la respectiva subred. Por lo demás son válidas las reglas de cortafuegos
adoptadas para el respectivo sentido de transmisión.

410

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Además, existen las siguientes posibilidades:
● Ajustar rutas específicas - configurable en "Enrutamiento" de los ajustes de seguridad
locales (solo para SCALANCE S), véase Definir rutas (Página 509).
● Utilizar router estándar - configurable en "Interfaz externa [P1] roja", "Interfaz interna [P2]
verde" o "Interfaz DMZ [P3] amarilla" (solo SCALANCE S623/S627-2M) de los ajustes de
seguridad locales, véase Configurar parámetros de dirección IP (Página 480).
Solo es posible utilizar un router estándar como máximo por módulo de seguridad.
● Enrutamiento NAT/NAPT - ajustable en los ajustes de seguridad locales en "NAT / NAPT"
(solo para SCALANCE S y CP 343-1 Adv. / CP 443-1 Adv.).

Activar el modo de enrutamiento (solo es necesario para módulos SCALANCE S)
Para este modo de operación es necesario configurar en los ajustes de seguridad locales una
dirección IP interna y una máscara de subred interna para el direccionamiento del router en la
subred interna. Todas las solicitudes de red que no pertenecen a una subred se transfieren a
otra subred a través del módulo de seguridad.
Nota: A diferencia del modo Bridge del módulo de seguridad, en el modo de enrutamiento se
pierden los identificadores VLAN.
1. En los ajustes de seguridad locales elija la opción "Modo de enrutamiento" en "Modo de
operación".
2. En "Interfaz interna [P2] verde" > "Direcciones Ethernet" de los ajustes de seguridad
locales, introduzca en los campos de entrada una dirección IP interna y una máscara de
subred interna para el direccionamiento del router en la subred interna.

Sinopsis de NAT/NAPT
Requisitos
● El módulo de seguridad se encuentra en el modo de enrutamiento o la interfaz DMZ (solo
SCALANCE S623 / S627-2M) está activada.
● Puesto que para reglas NAT/NAPT se generan automáticamente reglas de cortafuegos
que habilitan la comunicación en el sentido de conversión de direcciones configurado, para
el módulo de seguridad deben estar activados en el editor el modo de cortafuegos
avanzado y el cortafuegos. Encontrará más información en el capítulo Relación entre router
NAT/NAPT y cortafuegos (Página 425)

Cómo se accede a esta función
1. Seleccione el módulo que desea editar.
2. En los ajustes de seguridad locales elija la entrada "NAT/NAPT".
3. Abra el editor correspondiente con el botón "Abrir editor".
4. Según se requiera, configure una conversión de direcciones según NAT (Network Address
Translation) o NAPT (Network Address Port Translation).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

411

Configuración de dispositivos y redes
1.3 Configurar redes

Conversión de direcciones con NAT (Network Address Translation)
NAT es un método para la conversión de direcciones entre dos áreas de direcciones.
La principal tarea es la conversión de direcciones IP privadas en públicas, es decir, en
direcciones IP utilizadas y enrutadas en Internet. De ese modo se consigue que las direcciones
IP de la red interna no se conozcan en la red externa. Los dispositivos internos solo se pueden
ver en la red externa a través de las direcciones IP externas definidas en la lista de conversión
de direcciones (tabla NAT). El hecho de que la dirección IP externa no sea la dirección del
módulo de seguridad y que la dirección IP interna sea unívoca se denomina 1:1 NAT. Con 1:1
NAT la dirección interna se convierte a esta dirección externa sin conversión de puerto. En
cualquier otro caso será n:1 NAT.

Conversión de direcciones con NAPT (Network Address Port Translation)
La conversión de direcciones en NAPT modifica la dirección de destino y el puerto de destino
en una relación de comunicación (reenvío de puerto).
Se convierten telegramas procedentes de la red externa o la red DMZ y destinados a la
dirección IP del módulo de seguridad. Si el puerto de destino del telegrama es idéntico a uno
de los valores de la columna "Puerto de origen", el módulo de seguridad sustituye la dirección
IP de destino y el puerto de destino de la forma indicada en la fila correspondiente de la tabla
NAPT. En la respuesta, el módulo de seguridad aplica como dirección IP de origen y puerto de
origen los valores que figuran como dirección IP de destino o puerto de destino en el telegrama
inicial.
La diferencia respecto a NAT consiste en que en este protocolo también se pueden convertir
puertos. Ya no hay una conversión 1:1 de la dirección IP. Solo existe una dirección IP pública,
que se convierte agregando números de puerto a una serie de direcciones IP privadas.

Conversión de direcciones en los túneles VPN
La conversión de direcciones con NAT/NAPT también se puede realizar para relaciones de
comunicación establecidas a través de túneles VPN. Esto se soporta para interlocutores de la
conexión del tipo SCALANCE S612 / S623 / S627-2M de la versión V4 o superior.
Encontrará más información sobre las conversiones de direcciones en túneles VPN en los
siguientes capítulos:
● Enrutamiento NAT/NAPT (Página 413)
● Conversión de direcciones con NAT/NAPT en túneles VPN (Página 425)

Prueba de coherencia - reglas a considerar
Observe entre otras las reglas siguientes con el fin de obtener entradas coherentes:
● La dirección IP de la interfaz interna no debe utilizarse en la tabla NAT/NAPT.
● Una dirección IP utilizada en la lista de conversión de direcciones NAT/NAPT no debe ser
dirección Multicast ni dirección Broadcast.

412

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
● Los puertos externos asignados a la conversión NAPT han de estar en el rango > 0 y
≤ 65535.
Quedan excluidos el puerto 123 (NTP), el puerto 443 (HTTPS), el puerto 514 (Syslog), el
puerto 161 (SNMP), los puertos 67+68 (DHCP) y los puertos 500+4500 (IPsec) siempre
que estén activados los servicios correspondientes en el módulo de seguridad.
● La dirección IP externa del módulo de seguridad o la dirección IP de la interfaz DMZ solo
se deben utilizar en la tabla NAT para la acción "Source-NAT".
● Control de duplicidad en la tabla NAT
Una dirección IP externa o una dirección IP de la red DMZ utilizada en sentido "DestinationNAT", "Source-NAT + Destination-NAT" o "Double-NAT" solo puede utilizarse una vez en
cada sentido indicado.
● Control de duplicidad en la tabla NAPT: cada número de puerto de origen solo puede
introducirse una vez en cada interfaz.
● Los puertos NAPT internos pueden estar en el rango > 0 y ≤ 65535.

Consulte también
Sinopsis de los ajustes de enrutamiento (Página 410)

Enrutamiento NAT/NAPT
Conversión de direcciones con NAT
Los siguientes elementos de mando están disponibles en la barra de menús:
Elemento de mando

Función
Activar NAT
Activa el editor para reglas NAT. Con el editor activado pueden configurarse las
reglas correspondientes, que se transmiten al módulo al cargar.
Dado que para las reglas NAT se generan automáticamente reglas IP, que
habilitan la comunicación en la conversión de direcciones configurada, el editor
para reglas NAT solo puede activarse con el modo cortafuegos y el cortafuegos
IP activos.
Insertar regla arriba
Inserta una regla sobre la regla seleccionada o sobre el conjunto de reglas
seleccionado. Para insertar encima de un conjunto de reglas tiene que estar
seleccionada la primera línea de este.
Insertar regla abajo
Inserta una regla debajo de la regla seleccionada o del conjunto de reglas
seleccionado. Para insertar debajo de un conjunto de reglas tiene que estar
seleccionada la primera línea de este.
Mover hacia arriba
Mueve la regla seleccionada o el conjunto de reglas seleccionado una línea
hacia arriba. Para mover un conjunto de reglas tiene que estar seleccionada la
primera línea de este.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

413

Configuración de dispositivos y redes
1.3 Configurar redes
Elemento de mando

Función
Mover hacia abajo
Mueve la regla seleccionada o el conjunto de reglas seleccionado una línea
hacia abajo. Para mover un conjunto de reglas tiene que estar seleccionada la
primera línea de este.
Desplegar juegos de reglas
Representa los conjuntos de reglas existentes desplegados.
Plegar juegos de reglas
Representa los conjuntos de reglas existentes plegados.
Separar
Convierte la línea seleccionada en una o varias reglas individuales. Si se se‐
lecciona la primera línea de un conjunto de reglas, todas las reglas del conjunto
de reglas se convertirán en reglas individuales. Si se selecciona una regla
contenida en el conjunto de reglas, esta se convierte en una regla individual.
Además, las siguientes reglas del conjunto de reglas se convierten en un con‐
junto de reglas individual.

Tras crear las reglas NAT, se generan las reglas de cortafuegos correspondientes y se
muestran en el modo de cortafuegos avanzado; véase el capítulo:
Relación entre router NAT/NAPT y cortafuegos (Página 425)
Si para la interfaz externa o la interfaz DMZ está activado PPPoE, en la acción "DestinationNAT" no podrá seleccionarse la interfaz externa o la interfaz DMZ como "sentido hacia". Al
configurar la acción "Source-NAT", la dirección IP no puede introducirse en el campo de
entrada "Conversión de origen" porque se determina de forma dinámica en el tiempo de
ejecución.

Acciones de conversión de direcciones posibles para NAT
La siguiente tabla recoge las posibilidades de entrada para la conversión de direcciones con
NAT.

Acción "Destination-NAT" - "Redirect"
La acción "Destination-NAT" puede ejecutarse en el siguiente sentido:
● De externa a interna
Si la interfaz DMZ del módulo de seguridad (solo SCALANCE S623/S627-2M) está activada,
la acción "Destination-NAT" también puede ejecutarse en los siguientes sentidos:
● De externa a DMZ
● De DMZ a interna
● De DMZ a externa

414

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Si el módulo SCALANCE S (solo SCALANCE S612/S623/S627-2M versión V4 o superior) está
dentro de un grupo VPN y la interfaz de túnel está activada, la acción "Destination-NAT"
también puede ejecutarse en los siguientes sentidos:
● De túnel a interna
● De túnel a externa
● De túnel a DMZ (solo con la interfaz DMZ activada)
Para el sentido "De externa a interna" se aplica, por ejemplo, lo siguiente: se comprueba si la
dirección IP de destino de un telegrama procedente de la red externa coincide con la dirección
IP indicada en el campo de entrada "Dirección IP de destino". Si coincide, el telegrama se
transfiere a la red interna sustituyendo la dirección IP de destino del telegrama por la dirección
IP indicada en el campo de entrada "Conversión de destino". El acceso de externa a interna a
través de la dirección IP externa es posible.
La siguiente tabla muestra el esquema de entrada para la acción "Destination-NAT".
Campo

Entradas posibles

Significado

Dirección IP de origen

No relevante para esta acción.

-

Conversión de origen

No relevante para esta acción.

-

Dirección IP de destino

Dirección IP en la red de origen

Dirección IP de destino en la red de origen a través de
la cual se debe acceder a una dirección IP de la red de
destino. La dirección IP de destino no debe ser la mis‐
ma que la dirección IP del módulo de seguridad en la
red de origen.
Si en un telegrama la dirección IP de destino concuer‐
da con la dirección introducida, la dirección se cambia
por la dirección IP correspondiente en la red de desti‐
no.
La dirección IP de destino indicada se convierte en
dirección alias. Eso significa que la dirección IP indi‐
cada se registra además como dirección IP en la in‐
terfaz seleccionada. Asegúrese de que no existe nin‐
gún conflicto de dirección IP en la red con esta direc‐
ción alias. Las direcciones IP alias de un módulo de
seguridad se muestran en la entrada "Direcciones IP
alias" de la interfaz correspondiente.

Conversión de destino

Dirección IP en la red de destino

N.º

-

La dirección IP de destino se sustituye por la dirección
IP indicada aquí.
Número consecutivo adjudicado por STEP 7 que se
utiliza para la referencia a la regla de cortafuegos que
STEP 7 genera para la regla NAT.

Acción "Source-NAT" - "Masquerading"
La acción "Source-NAT" puede ejecutarse en el siguiente sentido:
● De interna a externa

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

415

Configuración de dispositivos y redes
1.3 Configurar redes
Si la interfaz DMZ del módulo de seguridad (solo SCALANCE S623/S627-2M) está activada,
la acción "Source-NAT" también puede ejecutarse en los siguientes sentidos:
● De interna a DMZ
● De externa a DMZ
● De DMZ a externa
Si el módulo SCALANCE S (solo SCALANCE S612/S623/S627-2M versión V4 o superior) está
dentro de un grupo VPN y la interfaz de túnel está activada, la acción "Source-NAT" también
puede ejecutarse en los siguientes sentidos:
● De interna a túnel
● De externa a túnel
● De DMZ a túnel (solo con la interfaz DMZ activada)
Para el sentido "De interna a externa" se aplica, por ejemplo, lo siguiente: se comprueba si la
dirección IP de origen de un telegrama procedente de la red interna coincide con la dirección
IP indicada en el campo de entrada "Dirección IP de origen". Si coincide, el telegrama se
transfiere a la red externa con la dirección IP externa indicada en el campo de entrada
"Conversión de origen" como nueva dirección IP de origen. En la red externa rige la dirección
IP externa.
La siguiente tabla muestra el esquema de entrada para la acción "Source-NAT".
Campo

Entradas posibles

Significado

Dirección IP de origen

Dirección IP en la red de origen

La dirección IP de origen del dispositivo indicado se sus‐
tituye por la dirección IP indicada en el campo de entrada
"Conversión de origen".

Área de direcciones IP / banda de di‐
recciones IP en la red de origen

Las direcciones IP del área de direcciones / banda de
direcciones IP se sustituyen por la dirección IP indicada
en el campo de entrada "Conversión de origen".

*

Conversión de origen

Dirección IP en la red de destino

Las direcciones IP de todos los dispositivos de la red de
origen se sustituyen por la dirección IP indicada en el
campo de entrada "Conversión de origen".
Entrada de la dirección IP que debe utilizarse como nue‐
va dirección IP de origen.
Si la dirección IP introducida aquí no es la dirección IP del
módulo de seguridad, se convierte en dirección alias.
Eso significa que la dirección indicada se registra ade‐
más como dirección IP en la interfaz seleccionada. Ase‐
gúrese de que no existe ningún conflicto de dirección IP
en la red con esta dirección alias. Las direcciones IP alias
de un módulo de seguridad se muestran en la entrada
"Direcciones IP alias" de la interfaz correspondiente.

Dirección IP de destino

No relevante para esta acción.

Conversión de destino

No relevante para esta acción.

N.º

416

-

Número consecutivo adjudicado por STEP 7 que se uti‐
liza para la referencia a la regla de cortafuegos que
STEP 7 genera para la regla NAT.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Nota
Puede configurar que las direcciones de todos los telegramas que van de una red de origen a
una red de destino se conviertan a la dirección IP de los módulos de la red de destino. Además,
el módulo de seguridad asigna un número de puerto a cada telegrama. En este caso, se trata
de una conversión de direcciones n:1 NAT en la que varias direcciones IP de la red de origen
se convierten a una dirección IP de la red de destino.
Introduzca, por ejemplo, los siguientes parámetros para el sentido "De interna a externa":
● Acción: "Source-NAT"
● De: "Interna"
● A "Externa"
● Dirección IP de origen: "*"
● Conversión de origen: dirección IP externa del módulo de seguridad

Acción "Source-NAT + Destination-NAT" - "1:1-NAT"
La acción "Source-NAT + Destination-NAT" puede ejecutarse en el siguiente sentido:
● De interna a externa
Si la interfaz DMZ del módulo de seguridad (solo SCALANCE S623/S627-2M) está activada,
la acción "Source-NAT + Destination-NAT" también puede ejecutarse en los siguientes
sentidos:
● De interna a DMZ
● De externa a DMZ
● De DMZ a externa
Si el módulo SCALANCE S (solo SCALANCE S612/S623/S627-2M versión V4 o superior) está
dentro de un grupo VPN y la interfaz de túnel está activada, la acción "Source-NAT +
Destination-NAT" también puede ejecutarse en los siguientes sentidos:
● De externa a túnel
● De interna a túnel
● De DMZ a túnel (solo con la interfaz DMZ activada)
Para el sentido "De interna a externa" se aplica, por ejemplo, lo siguiente: en el acceso de
interna a externa, se ejecuta la acción "Source-NAT". En el acceso de externa a interna, se
ejecuta la acción "Destination-NAT".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

417

Configuración de dispositivos y redes
1.3 Configurar redes
La siguiente tabla muestra el esquema de entrada para la acción "Source-NAT+ DestinationNAT":
Campo

Entradas posibles

Significado

Dirección IP de origen

Dirección IP en la red de origen

La configuración siempre se indica en sentido SourceNAT. Por ello, las direcciones IP del sentido Destina‐
tion-NAT siempre son insertadas automáticamente
por STEP 7.

Conversión de origen

Dirección IP en la red de destino

Dirección IP de destino

No relevante para esta acción.

Conversión de destino

No relevante para esta acción.

N.º

-

Número consecutivo adjudicado por STEP 7 que se
utiliza para la referencia a las reglas de cortafuegos
que STEP 7 genera para la regla NAT.

Acción "Double-NAT"
La acción "Double-NAT" puede ejecutarse para los módulos SCALANCE S en los siguientes
sentidos:
● De interna a externa
● De externa a interna
Si la interfaz DMZ del módulo de seguridad (solo SCALANCE S623/S627-2M) está activada,
la acción "Double-NAT" también puede ejecutarse en los siguientes sentidos:
● De interna a DMZ
● De externa a DMZ
● De DMZ a interna
● De DMZ a externa
Source-NAT y Destination-NAT se producen siempre en cada sentido.
Para el sentido "De externa a interna" se aplica, por ejemplo, lo siguiente: en el acceso de
externa a interna, se sustituye la dirección IP de origen del dispositivo externo (Source-NAT).
Además, el acceso a la red interna se realiza a través de la dirección IP externa (DestinationNAT) indicada en el campo de entrada "Dirección IP de destino".
Puede utilizar esta acción, por ejemplo, si se ha introducido un router estándar distinto al
módulo de seguridad para un dispositivo al que se accede con ayuda de Destination-NAT. Los
telegramas de respuesta de este dispositivo no se enviarán al router estándar introducido, sino
a la interfaz correspondiente del módulo de seguridad.
La siguiente tabla muestra el esquema de entrada para la acción "Double-NAT":
Campo

Entradas posibles

Significado

Dirección IP de origen

Dirección IP en la red de origen

Dirección IP del dispositivo en la red de
origen

Conversión de origen

418

-

La conversión de direcciones SourceNAT se realiza siempre a la dirección IP
del módulo de seguridad en la red de
destino. Por este motivo, el campo de
entrada "Conversión de origen" no pue‐
de configurarse.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Campo

Entradas posibles

Significado

Dirección IP de destino

Dirección IP en la red de origen

Dirección IP de destino en la red de ori‐
gen a través de la cual se debe acceder
a una dirección IP de la red de destino.
Si en un telegrama la dirección IP de
destino concuerda con la dirección IP
introducida, la dirección IP se sustituye
por la dirección IP introducida en el cam‐
po de entrada "Conversión de destino".
Si la dirección IP introducida aquí no es
la dirección IP del módulo de seguridad,
se convierte en dirección alias. Eso sig‐
nifica que la dirección indicada se regis‐
tra además como dirección IP en la in‐
terfaz seleccionada. Asegúrese de que
no existe ningún conflicto de dirección
IP en la red con esta dirección alias. Las
direcciones IP alias de un módulo de
seguridad se muestran en la entrada
"Direcciones IP alias" de la interfaz co‐
rrespondiente.

Conversión de destino
N.º

Dirección IP en la red de destino
-

La dirección IP de destino se sustituye
por la dirección IP indicada aquí.
Número consecutivo adjudicado por
STEP 7 que se utiliza para la referencia
a la regla de cortafuegos que STEP 7
genera para la regla NAT.

Editor NAT avanzado
Después de seleccionar una regla NAT, en "Propiedades > General" de la ventana de
inspección aparece un editor NAT avanzado para la configuración simplificada de áreas de
direcciones para puertos y direcciones IP. Los cambios realizados en este editor se aplican a
la regla NAT seleccionada. Además las reglas y conjuntos de reglas NAT seleccionados se
pueden copiar en el editor NAT avanzado. Para copiar un conjunto de reglas NAT tiene que
estar seleccionada la primera línea de este. Adaptando las reglas IP generadas para las reglas
NAT se puede determinar cuál de las reglas NAT copiadas se aplica en cada caso. El siguiente
apartado muestra la configuración de áreas de direcciones en el editor NAT avanzado a partir
de ejemplos.

Configuración de áreas de direcciones en el editor NAT avanzado
Las áreas de direcciones pueden configurarse en los campos de entrada de las columnas "De"
y "Hasta". Si se configuran varias áreas de direcciones para una regla NAT, tendrá que
coincidir el número de direcciones en cada caso. Tras la configuración de áreas de
direcciones, a partir de la regla NAT de STEP 7 seleccionada se genera un conjunto de reglas
NAT, que contiene una regla NAT para cada una de las reglas.
En los campos de entrada para puertos de la columna "Hasta" se puede utilizar como
alternativa el comodín "*". En ese caso las áreas de puertos y las reglas NAT afectadas se
formarán conforme a los parámetros NAT restantes.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

419

Configuración de dispositivos y redes
1.3 Configurar redes

Conversión de direcciones con NAPT
Los siguientes elementos de mando están disponibles en la barra de menús:
Elemento de mando Función
Activar NAPT
Activa el editor para reglas NAPT. Con el editor activado pueden configurarse las reglas correspon‐
dientes, que se transmiten al módulo al cargar. Después de seleccionar una regla NAPT, estará dis‐
ponible el editor para ajustes NAPT avanzados en la ficha "Propiedades > General" de la ventana de
inspección.
Insertar regla arriba
Inserta una regla sobre la regla seleccionada o sobre el conjunto de reglas seleccionado. Para insertar
encima de un conjunto de reglas tiene que estar seleccionada la primera línea de este.
Insertar regla abajo
Inserta una regla debajo de la regla seleccionada o del conjunto de reglas seleccionado. Para insertar
debajo de un conjunto de reglas tiene que estar seleccionada la primera línea de este.
Mover hacia arriba
Mueve la regla seleccionada o el conjunto de reglas seleccionado una línea hacia arriba. Para mover
un conjunto de reglas tiene que estar seleccionada la primera línea de este.
Mover hacia abajo
Mueve la regla seleccionada o el conjunto de reglas seleccionado una línea hacia abajo. Para mover
un conjunto de reglas tiene que estar seleccionada la primera línea de este.
Desplegar juegos de reglas
Representa los conjuntos de reglas existentes desplegados.
Plegar juegos de reglas
Representa los conjuntos de reglas existentes plegados.
Separar
Convierte la línea seleccionada en una o varias reglas individuales. Si se selecciona la primera línea
de un conjunto de reglas, todas las reglas del conjunto de reglas se convertirán en reglas individuales.
Si se selecciona una regla contenida en el conjunto de reglas, esta se convierte en una regla individual.
Además, las siguientes reglas del conjunto de reglas se convierten en un conjunto de reglas individual.

Tras crear las reglas NAPT, se generan las reglas de cortafuegos correspondientes y se
muestran en el modo de cortafuegos avanzado; véase el capítulo:
Relación entre router NAT/NAPT y cortafuegos (Página 425)
La conversión de direcciones IP con NAPT puede ejecutarse en el siguiente sentido:
● De externa a interna
Si la interfaz DMZ del módulo de seguridad (solo SCALANCE S623/S627-2M) está activada,
la conversión de direcciones IP con NAPT también puede ejecutarse en los siguientes
sentidos:
● De externa a DMZ
● De DMZ a interna
● De DMZ a externa

420

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Si el módulo SCALANCE S (solo SCALANCE S612/S623/S627-2M versión V4 o superior) está
dentro de un grupo VPN y la interfaz de túnel está activada, la conversión de direcciones IP con
NAPT también puede ejecutarse en los siguientes sentidos:
● De túnel a interna
● De túnel a externa
● De túnel a DMZ (solo con la interfaz DMZ activada)
Para el sentido "De externa a interna" se aplica, por ejemplo, lo siguiente: Los telegramas
destinados a la dirección IP externa del módulo de seguridad y al puerto introducido en la
columna "Puerto virtual" se reenvían a la dirección IP de destino de la red interna y al puerto
de destino indicados.
La dirección IP desde la que se reenvían telegramas a la red de destino se muestra en la
columna "Dirección IP virtual". En un sentido "de externa" es la dirección IP externa del módulo
de seguridad y en un sentido "de DMZ" es la la dirección IP de la interfaz DMZ del módulo de
seguridad.
La siguiente tabla muestra el esquema de entrada para la conversión de direcciones con NAPT
en la ficha "NAPT":
Campo

Entradas posibles

Significado

Puerto virtual

Puerto o rango de puertos TCP/UDP

Un dispositivo de la red de origen puede enviar un telegrama a
Ejemplo de entrada de un rango de puer‐ un interlocutor de la red de destino utilizando este número de
puerto.
tos: 78:99

Dirección IP
de destino

Dirección IP en la red de destino

Los telegramas destinados a la dirección IP del módulo de se‐
guridad de la red de origen, así como al puerto TCP/UDP indi‐
cado en el campo "Puerto virtual", se reenvían a la dirección IP
aquí indicada.

Puerto de des‐ Puerto TCP/UDP
tino

Número de puerto al que se transfieren los telegramas proce‐
dentes de la red de origen.

Protocolo

Selección de la familia de protocolos para los números de puer‐
to indicados

● TCP+UDP
● TCP
● UDP

N.º

-

Número consecutivo adjudicado por STEP 7 que se utiliza para
la referencia a la regla de cortafuegos que STEP 7 genera para
la regla NAPT.

Editor NAPT avanzado
Después de seleccionar una regla NAPT, en "Propiedades > General" de la ventana de
inspección aparece un editor NAPT avanzado para la configuración simplificada de áreas de
direcciones para puertos y direcciones IP. Los cambios realizados en este editor se aplican en
las reglas NAPT seleccionadas. Además las reglas y conjuntos de reglas NAPT seleccionados
se pueden copiar en el editor NAPT avanzado. Para copiar un conjunto de reglas NAPT tiene
que estar seleccionada la primera línea de este. Adaptando las reglas IP generadas para las
reglas NAPT se puede determinar cuál de las reglas NAPT copiadas se aplica en cada caso.
El siguiente apartado muestra la configuración de áreas de direcciones en el editor NAPT
avanzado a partir de ejemplos.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

421

Configuración de dispositivos y redes
1.3 Configurar redes

Configuración de áreas de direcciones en el editor NAPT avanzado
Las áreas de direcciones pueden configurarse en los campos de entrada de las columnas "De"
y "Hasta". Si se configuran varias áreas de direcciones para una regla NAPT, tendrá que
coincidir el número de direcciones en cada caso. Tras la configuración de áreas de
direcciones, a partir de la regla NAPT de STEP 7 seleccionada se genera un conjunto de reglas
NAPT, que contiene una regla NAPT para cada una de las reglas.
El ejemplo siguiente muestra la configuración de áreas de direcciones para el puerto virtual, así
como para la dirección IP y el puerto de destino:

Figura 1-25

Editor NAPT avanzado: Ejemplo 1

En los campos de entrada para puertos de la columna "Hasta" se puede utilizar como
alternativa el comodín "*". En ese caso las áreas de puertos y las reglas NAPT afectadas se
formarán conforme a los parámetros.
En el siguiente ejemplo se determinan las áreas de puertos para el puerto virtual y para el
puerto de destino mediante STEP 7:

422

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Figura 1-26

Editor NAPT avanzado: Ejemplo 2

Para configurar la misma área de puertos para cada regla NAPT de un conjunto de datos
NAPT, en la columna "De" se pueden indicar por separado el puerto de inicio y el puerto final
para el puerto virtual mediante el carácter de dos puntos. Para el puerto de destino no se puede
indicar un área de puertos de este tipo. Un carácter comodín "*" después de los dos puntos se
interpreta como el valor máximo 65535.
En el ejemplo siguiente se utiliza un área de puertos con la notación anterior para cada regla
NAPT del conjunto de reglas NAPT:

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

423

Configuración de dispositivos y redes
1.3 Configurar redes

Figura 1-27

Editor NAPT avanzado: Ejemplo 3 (reglas NAPT)

En el ejemplo 3, la dirección IP y el puerto virtual son idénticos para cada regla NAPT. En este
caso, la prioridad de las reglas de cortafuegos generadas por STEP 7 para las reglas NAPT
determina qué regla NAPT se aplica. La máxima prioridad le corresponde a la regla de
cortafuegos generada para la regla NAPT con el número NAPT_1.1.

Figura 1-28

Editor NAPT avanzado: Ejemplo 3 (reglas de cortafuegos)

Por eso todos los telegramas destinados a la dirección IP 192.168.0.1 y a un puerto del área
85...90 se reenvían a la dirección IP de destino 192.168.1.5 y al puerto de destino 95.
Para definir unívocamente reglas NAPT con la misma dirección IP virtual y el mismo puerto
virtual / misma área de puertos, se pueden configurar direcciones IP de origen en las reglas IP
correspondientes. Las direcciones IP de origen deciden entonces qué regla NAPT se aplica:

424

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Figura 1-29

Editor NAPT avanzado: Ampliación del ejemplo 3

Conversión de direcciones con NAT/NAPT en túneles VPN
Función específica del módulo
La conversión de direcciones con NAT/NAPT en túneles VPN solo está disponible para
módulos SCALANCE S612/S623/S627-2M versión V4 o superior, consulte el apartado:
Conversión de direcciones con NAT/NAPT en túneles VPN (Página 510)

Relación entre router NAT/NAPT y cortafuegos
Significado
Tras crear reglas NAT/NAPT, STEP 7 genera automáticamente reglas de cortafuegos que
habilitan la comunicación en el sentido de conversión de direcciones configurado. En el modo
de cortafuegos avanzado las reglas de cortafuegos generadas son visibles como conjuntos de
datos de cortafuegos y pueden ampliarse si es necesario (dirección IP adicional / área de
direcciones IP / banda de direcciones IP, servicios, velocidad de transmisión). Asimismo,
debería comprobarse automáticamente la prioridad de las reglas de cortafuegos generadas
respecto de su posición. Si en la lista de reglas hay también reglas de cortafuegos que se han
configurado manualmente y tienen mayor prioridad que las reglas generadas
automáticamente, en determinadas circunstancias no se ejecutará NAT/NAPT.
Si hay varias parejas de reglas de cortafuegos/NAT idénticas, la prioridad de la lista de reglas
de cortafuegos decide la regla que se aplicará.
Los parámetros de cortafuegos generados por STEP 7 no pueden adaptarse. Después de
desactivar NAT/NAPT se desactivan las reglas de cortafuegos generadas por STEP 7.
Para simplificar la referencia entre las reglas NAT/NAPT y las correspondientes reglas de
cortafuegos, estas están marcadas con los correspondientes números consecutivos.
En las reglas de cortafuegos que se han generado automáticamente para reglas NAT/NAPT
no es posible desactivar la casilla de verificación "Stateful".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

425

Configuración de dispositivos y redes
1.3 Configurar redes
La siguiente tabla muestra los esquemas de las reglas de cortafuegos generadas para los
módulos SCALANCE S para las reglas NAT.
Tabla 1-40

Conversión de direcciones NAT y reglas de cortafuegos correspondientes para módulos SCALANCE S

Acción NAT

Regla de cortafuegos creada
Dirección IP de ori‐
gen

Dirección IP de des‐
tino

Red de destino

-

Dirección IP, indica‐
da en el campo de
entrada "Dirección
IP de destino".

Red de origen

Red de destino

Dirección IP del dis‐
positivo indicado
en el campo de en‐
trada "Dirección IP
de origen".

-

Accept

Red de origen

Red de destino

Dirección IP del dis‐
positivo indicado
en el campo de en‐
trada "Dirección IP
de origen".

-

Accept

Red de destino

Red de origen

-

Dirección IP, inser‐
tada por STEP 7 en
el campo de entra‐
da "Dirección IP de
destino".

Accept

Red de origen

Red de destino

Dirección IP del dis‐
positivo indicado
en el campo de en‐
trada "Dirección IP
de origen".

Dirección IP, indica‐
da en el campo de
entrada "Dirección
IP de destino".

Accept

Red de origen

Red de destino

Dirección IP del dis‐
positivo indicado
en el campo de en‐
trada "Dirección IP
de origen".

Dirección IP del dis‐
positivo indicado
en el campo de en‐
trada "Conversión
de destino".

Acción

De

A

DestinationNAT

Accept

Red de origen

Source-NAT

Accept

Source-NAT +
DestinationNAT

Double-NAT

426

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
La siguiente tabla muestra los esquemas de las reglas de cortafuegos generadas para el CP
343-1 Adv. / CP 443-1 Adv. para reglas NAT.
Tabla 1-41

Conversión de direcciones NAT y reglas de cortafuegos correspondientes para CP 343-1 Adv. / CP 443-1 Adv.

Acción NAT

Regla de cortafuegos creada
Acción

De

A

Drop

Externa

Accept

Source-NAT

Source-NAT +
DestinationNAT

DestinationNAT

Dirección IP de ori‐
gen

Dirección IP de des‐
tino

Estación

-

Dirección IP del mó‐
dulo de seguridad
en la red externa

Externa

Any

-

Dirección IP del dis‐
positivo indicado
en el campo de en‐
trada "Conversión
de destino".

Accept

Any

Externa

Dirección IP, indica‐
da en el campo de
entrada "Conver‐
sión de origen".

-

Accept

Any

Externa

Dirección IP, indica‐
da en el campo de
entrada "Conver‐
sión de origen".

-

Drop

Externa

Estación

-

Dirección IP del mó‐
dulo de seguridad
en la red externa

Accept

Externa

Any

-

Dirección IP del dis‐
positivo insertado
por STEP 7 en el
campo de entrada
"Conversión de
destino".

La siguiente tabla muestra el esquema de las reglas de cortafuegos generadas para los
módulos SCALANCE S para las reglas NAPT.
Tabla 1-42

Conversión de direcciones NAPT y reglas de cortafuegos creadas para módulos SCALANCE S
Regla de cortafuegos creada

Acción

De

A

Accept

Red de origen

Red de destino

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Dirección IP de ori‐ Dirección IP de
gen
destino
-

Dirección IP del
módulo de se‐
guridad en la
red de origen

Servicio
[Regla Servi‐
cio_NAPT]

427

Configuración de dispositivos y redes
1.3 Configurar redes
La siguiente tabla muestra los esquemas de las reglas de cortafuegos generadas para el CP
343-1 Adv. / CP 443-1 Adv. para reglas NAPT.
Tabla 1-43

Conversión de NAPT y reglas de cortafuegos creadas para CP 343-1 Adv. / CP 443-1 Adv.
Reglas de cortafuegos creada

Acción

De

A

Dirección IP de ori‐ Dirección IP de
gen
destino

Servicio

Drop

Externa

Estación

-

Dirección IP del
módulo de se‐
guridad en la
red externa

[Regla Servi‐
cio_NAPT]

Accept

Externa

Any

-

Dirección IP del
módulo de se‐
guridad en la
red externa

[Regla Servi‐
cio_NAPT]

Stateful Packet Inspection
El cortafuegos y el router NAT/NAPT contribuyen a la "Stateful Packet Inspection". Por esta
razón, los telegramas de respuesta pueden pasar el router NAT/NAPT y el cortafuegos sin que
sus direcciones se tengan que adoptar adicionalmente en las reglas de cortafuegos ni en la
conversión de direcciones de NAT/NAPT.

Relación entre router NAT/NAPT y cortafuegos personalizado
Función específica del módulo
La configuración de reglas NAT/NAPT en el cortafuegos personalizado solo está disponible
para módulos SCALANCE S versión V3 o superior, consulte el apartado:
Relación entre router NAT/NAPT y cortafuegos personalizado (Página 512)

428

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Configurar la sincronización horaria
Procedimientos de la sincronización horaria
Significado
Para la sincronización temporal de la transferencia de los datos productivos, para comprobar
la validez horaria de un certificado y para los sellos de tiempo de entradas de registro se
indican la fecha y la hora en el módulo de seguridad. Para las funciones de Security debe
sincronizarse la hora del módulo de seguridad de un proyecto.
Nota
Configurar el cortafuegos para la comunicación con el servidor NTP
Si no es posible acceder al servidor NTP desde el módulo de seguridad, los telegramas del
servidor NTP se tienen que permitir explícitamente en el cortafuegos (UDP, puerto 123).
Nota
La sincronización horaria se refiere únicamente al módulo de seguridad y no puede utilizarse
para la sincronización de dispositivos de la red interna de dicho módulo.
Algunos CP pueden reenviar la hora a otros módulos de la estación.
En el procedimiento SIMATIC, el CP 443‑1 OPC UA solo puede recibir la hora de la estación
pero no reenviarla.
Nota
Antes de que se apliquen las funciones de seguridad de un CP (reloj esclavo), el CP debe
recibir un telegrama horario válido del reloj maestro.

Configurar la sincronización horaria para un módulo de seguridad
Cómo se accede a esta función
1. Seleccione el módulo que desea editar.
2. Elija la entrada "Sincronización horaria" en los ajustes de seguridad locales.
3. Active la casilla de verificación "Activar sincronización horaria".

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

429

Configuración de dispositivos y redes
1.3 Configurar redes

Procedimientos de la sincronización horaria
Dependiendo del módulo de seguridad empleado es posible configurar los procedimientos
siguientes:
Procedimiento

Significado

Ajustar la hora al cargar

La hora del módulo se ajusta automáticamente a la hora
del PC al cargar una configuración.

SIMATIC

Sincronización horaria mediante mensajes horarios
MMS recibidos (MMS = Manufacturing Message Speci‐
fication)
Elija para el CP si solo debe recibir la hora o también
reenviarla. En el CP 1628 la hora siempre se reenvía. El
CP 443‑1 OPC UA usa el procedimiento SIMATIC si no
se ha configurado una sincronización horaria mediante
NTP. Solo puede recibir la hora de la estación pero no
reenviarla.
Sentidos disponibles:
● Automático
el CP recibe la hora de la estación o LAN y la
transfiere a la estación o LAN, respectivamente. Si se
utilizan varios CP en la estación, este preajuste
puede causar colisiones. Para impedirlas, debería
definir el sentido del reenvío selectivamente.
● De estación
el CP reenvía la hora de la estación a la LAN.
● De LAN
El CP reenvía la hora de la LAN a la estación.
Si el reenvío de la hora está activado, la casilla de veri‐
ficación "Utilizar hora corregida" permite especificar si
debe utilizarse un factor de corrección que pueda estar
incluido en el telegrama horario. Para el CP 1628 esta
opción está preajustada y no puede desactivarse.

430

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Procedimiento

Significado

Hora del interlocutor

La hora se obtiene del interlocutor correspondiente.
Ciclo de sincronización: define el ciclo de la sincroniza‐
ción horaria. Para el ciclo de sincronización del CP es
posible definir una base individual de horas o minutos.

NTP / NTP (secure)

Sincronización horaria mediante un servidor NTP / ser‐
vidor NTP del tipo "NTP (secure)".
● Zona horaria: en el procedimiento NTP se transfiere
generalmente la hora UTC (Universal Time
Coordinated), que equivale a la hora GMT
(Greenwich Mean Time). Mediante la configuración
de la zona horaria local se puede ajustar la diferencia
de tiempo respecto de la hora UTC.
● Intervalo de actualización en segundos: Define el
espacio de tiempo entre las consultas de hora en
segundos. Para SCALANCE S versión V3 o superior,
el intervalo de tiempo para la consulta del servidor
NTP se define automáticamente.
Si se activa la casilla de verificación "Activar
funciones de seguridad" en los ajustes de seguridad
locales de CPs, el ajuste del intervalo de
actualización se toma de los ajustes locales del CP y
se aplica a los ajustes de seguridad locales del CP.
● Sincronización horaria al minuto completo: Con esta
opción se determina que la hora se debe reenviar al
bus K exactamente al cumplirse el minuto. Esta
opción se requiere solo para algunas aplicaciones
especiales.
● Aceptar tiempo de servidores NTP no sincronizados:
aquí se ajusta si el módulo de seguridad también
debe aceptar la hora de servidores NTP no
sincronizados.
● Transferir hora a la estación: desactive esta opción si
la CPU pregunta la hora independientemente a un
servidor NTP. De este modo se evita que la hora
consultada directamente en el servidor NTP por la
CPU se sobrescriba con la hora del CP. La
transferencia a través del CP podría provocar una
precisión menor.
● Servidor NTP: La creación de servidores NTP en los
ajustes de seguridad locales se describe en el
capítulo Configurar servidores NTP (Página 432).

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

431

Configuración de dispositivos y redes
1.3 Configurar redes

Configurar servidores NTP
Crear un servidor NTP del tipo "NTP (secure)" en las funciones de seguridad globales
En las funciones globales de seguridad existe la posibilidad de crear únicamente servidores
NTP del tipo "NTP (secure)" y asignarlos a dispositivos.
1. En las funciones de seguridad globales elija la entrada "NTP".
Resultado: Debajo de la entrada seleccionada se muestran los servidores NTP (secure)
creados hasta ahora.
2. Haga doble clic en la entrada "Agregar servidor NTP nuevo".
Resultado: El servidor NTP (secure) creado se muestra con un número asignado de forma
automática por debajo de la entrada "NTP".
3. Haga doble clic en el servidor NTP (secure) creado.
Resultado: En el área de trabajo se muestra el cuadro de diálogo de asignación para el
servidor NTP (secure). En la lista desplegable "Servidores NTP" se ha marcado el servidor
NTP (secure) seleccionado. Existe la posibilidad de asignarle los módulos de seguridad
deseados, véase el capítulo Asignar módulo de seguridad a un servidor NTP (secure)
(Página 434). En los ajustes de seguridad locales se muestran las propiedades
configurables del servidor NTP (secure).

432

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
4. Introduzca en la entrada "General" de los ajustes de seguridad locales los datos siguientes:
– Nombre: para el nombre del servidor NTP (secure) pueden utilizarse como máximo 25
caracteres.
– Dirección IP/FQDN: Dirección del servidor NTP (secure).
– Puerto: puerto del servidor NTP. Son posibles los siguientes puertos: 123 (puerto
predeterminado), 1025 a 36564.
– Ciclo de sincronización: intervalo de tiempo en segundos entre dos solicitudes de hora.
Los posibles valores se sitúan entre 16 y 16284 segundos.
5. Introduzca los parámetros de cifrado siguientes en la entrada "Clave NTP" de los ajustes de
seguridad locales:
Propiedad

Significado

ID de código

Valor numérico entre 1 ... 65534.

Algoritmo Hash

Seleccione el algoritmo Hash. Según sea la se‐
lección, tenga en cuenta la longitud para la clave
NTP.

Hex/ASCII

Seleccione el formato del código NTP.

Código

Introduzca la clave NTP.
SCALANCE S-600 V3 / CP S7
Selección MD5 o SHA-1:
● Hex: 10 ... 40 caracteres
● ASCII: 5 ... 20 caracteres
TIM, CP 1628
Selección MD5 o SHA-1:
● Hex: 22 ... 40 caracteres
● ASCII: 11 ... 20 caracteres
SCALANCE SC-600
Selección MD5:
● ASCII: 16 ... 128 caracteres
Selección SHA1:
● ASCII: 20 ... 128 caracteres
Selección DES:
● ASCII: 8 caracteres
Los números de caracteres indicaos cubren to‐
das las longitudes de clave soportadas por los
módulos de seguridad.

Para cambiar a los ajustes de seguridad locales de otro servidor NTP (secure), selecciónelo
en la lista desplegable "Servidores NTP" del diálogo de asignación o haga doble clic en la
entrada correspondiente en las funciones de seguridad globales.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

433

Configuración de dispositivos y redes
1.3 Configurar redes

Resultado
Se ha creado el servidor NTP (secure), que puede asignarse a los módulos de seguridad que
se desee.
Tenga en cuenta las descripciones del capítulo siguiente:
Asignar módulo de seguridad a un servidor NTP (secure) (Página 434)

Crear servidores NTP no seguros en los ajustes de seguridad locales
Los servidores NTP no seguros para módulos SCALANCE S inferiores a V4 y CP deben
crearse en los ajustes de seguridad locales.
1. Seleccione el módulo que desea editar.
2. Elija la entrada "Sincronización horaria" en los ajustes de seguridad locales.
3. Seleccione el método de sincronización.
4. Introduzca un nombre y la dirección IP del servidor NTP. Para el nombre pueden utilizarse
como máximo 25 caracteres. Si se ha seleccionado el modo de sincronización "NTP
(secure)", puede elegir en la columna "Nombre" un servidor NTP (secure) que haya creado
en las funciones de seguridad globales.

Convenciones para nombres de servidores NTP
Los caracteres 0-9, a-z, A-Z, -._ pueden utilizarse para los nombres de servidores NTP. Un
nombre debe empezar con una letra y terminar con una letra o un número. Antes del carácter
'.' solo se permiten letras y números, y después del carácter '.' solo letras. Antes y después del
carácter '_' o '-' solo se permiten letras y números.

Importar y exportar la lista de claves de servidores NTP (secure)
Los comandos "Importar" y "Exportar" del menú contextual permiten exportar la lista de
códigos del servidor NTP (secure) seleccionado en ese momento en las funciones de
seguridad globales e importar el archivo a un servidor NTP (secure), o viceversa.

Asignar módulo de seguridad a un servidor NTP (secure)
Requisitos
● Se ha definido un servidor NTP (secure) en las funciones de seguridad globales.
● En los ajustes de seguridad locales del módulo de seguridad que quiera asignar a un
servidor NTP (secure) se ha seleccionado como modo de sincronización "NTP" o "NTP
(secure)".

Procedimiento
1. Haga doble clic en la entrada "NTP" de las funciones de seguridad globales.
2. Haga doble clic sobre la entrada "Asignar módulo a un servidor NTP".

434

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
3. Seleccione de la lista desplegable "Servidor NTP" el servidor NTP (secure) al que quiera
asignar un módulo de seguridad.
4. Seleccione en el área "Módulos disponibles" el módulo de seguridad que quiera asignar al
servidor NTP (secure) seleccionado.
5. Haga clic sobre el botón "<<" para asignar el módulo de seguridad seleccionado al servidor
NTP (secure) seleccionado.

Resultado
Ha asignado el módulo de seguridad al servidor NTP (secure). El servidor NTP (secure)
aparece en los ajustes de seguridad locales automáticamente en la lista de los servidores NTP.

Módulo de seguridad como servidor DHCP
Función específica del módulo
Solo es posible utilizar el módulo de seguridad como servidor DHCP con módulos SCALANCE
S; consulte el apartado:
AUTOHOTSPOT

Configurar SNMP
Resumen SNMP
¿Qué es SNMP?
El módulo de seguridad soporta la transmisión de información de administración a través del
Simple Network Management Protocol (SNMP). Para ello se ha instalado en el módulo de
seguridad un agente SNMP, que recibe y responde las solicitudes SNMP. La información
sobre las propiedades de dispositivos compatibles con SNMP está almacenada en los
denominados archivos MIB (MIB = Management Information Base), para los que el usuario
debe tener los derechos correspondientes.
En SNMPv1 también se envía el "community string". El community string es como una
contraseña que se envía junto con la solicitud SNMP. Si el community string es correcto, el
módulo de seguridad responde con la información solicitada. Si el community string es
incorrecto, el módulo de seguridad rechaza la solicitud y no contesta. En SNMPv1 el
community string se transfiere sin cifrar.
En SNMPv3 los datos pueden enviarse cifrados.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

435

Configuración de dispositivos y redes
1.3 Configurar redes

Configurar SNMP - Entrada "SNMP"
Cómo se accede a esta función
1. Seleccione el módulo que desea editar.
2. En los ajustes de seguridad locales elija la entrada "SNMP".
3. Active la casilla de verificación "Activar SNMP".
4. Elija una de las siguientes versiones de protocolo SNMP:
Nota
Transferencia de datos encriptada en SNMPv3
Para aumentar la seguridad, utilice SNMPv3, puesto que los datos se transfieren
encriptados.
– SNMPv1
Para controlar los derechos de acceso en el agente SNMP el módulo de seguridad
utiliza los siguientes valores estándar para los community strings. Estos valores
estándar deberían adaptarse para aumentar la seguridad.
Para acceso de lectura: public
Para acceso de lectura y escritura: private
Para activar el acceso de escritura a través de SNMP, elija la opción "Permitir acceso de
escritura".
– SNMPv3
Seleccione solo un algoritmo de autenticación o bien un algoritmo de autenticación y
uno de encriptación.
Algoritmo de autenticación: Ninguno, MD5, SHA-1
Algoritmo de cifrado: Ninguno, AES-128, DES
Nota
Evitar la utilización de DES
DES es un algoritmo de encriptación no seguro. Solo ha de utilizarse por motivos de
compatibilidad con versiones anteriores.
Nota
Si se utiliza SNMPv3 no es posible la autenticación RADIUS.

436

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
5. Si va a utilizarse SNMPv3, asigne a un usuario una función en la que estén activados los
correspondientes derechos SNMP para que pueda acceder al módulo vía SNMP.
Encontrará una vista general de los derechos SNMP en el capítulo:
Particularidades de la administración de usuarios para funciones de seguridad
(Página 350)
6. En el área "Configuración avanzada" de los módulos SCALANCE S, configure datos
específicos del módulo relacionados con el autor, la ubicación y la dirección de correo
electrónico, que sobrescriban los datos de las propiedades del proyecto.
Para valores escritos por una herramienta SNMP en el módulo de seguridad por medio de
un comando SNMP-SET rige lo siguiente:
si se activa la casilla de verificación "Conservar los valores escritos por SNMP-SET", los
valores no se sobrescribirán al volver a cargar una configuración de STEP 7 en el módulo
de seguridad.

Configurar Proxy ARP
Función específica del módulo
Esta función solo está disponible para SCALANCE S V3 o superior, consulte el apartado:
Configurar Proxy ARP (Página 517)

Activar el servidor web en módulo de seguridad
Función específica del módulo
Esta función solo está disponible para el CP 343-1 / CP 443-1 Advanced y el CP 443-1 OPC
UA; consulte el apartado:
Activar el servidor web en un módulo de seguridad (Página 544) en el capítulo "Seguridad para
CP S7-300/S7-400/PC".

Túnel IPsec-VPN: Crear y asignar grupos VPN
Cómo crear túneles IPsec mediante grupos VPN
Requisitos
Nota
Fecha y hora actuales en los módulos de seguridad
Cuando utilice comunicación segura (p. ej. HTTPS, VPN...), asegúrese de que los módulos de
seguridad afectados tienen la hora y fecha actuales. De lo contrario, los certificados utilizados
se considerarán no válidos y la comunicación segura no funcionará.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

437

Configuración de dispositivos y redes
1.3 Configurar redes

Crear un grupo VPN
1. En las funciones de seguridad globales elija la entrada "Grupos VPN".
Resultado: Debajo de la entrada seleccionada se muestran los grupos VPN creados hasta
ahora.
2. Haga doble clic en la entrada "Agregar grupo VPN nuevo".
Resultado: El grupo VPN creado se muestra con un número asignado de forma automática
por debajo de la entrada "Grupos VPN".
Otra posibilidad consiste en hacer clic con el botón derecho del ratón en una interfaz de un
módulo apta para VPN en la vista redes y crear un grupo VPN con el comando "Agregar
nuevo grupo VPN" del menú contextual (no es posible para SOFTNET Security Client). Al
grupo VPN creado se le asigna automáticamente el módulo de seguridad seleccionado.
3. Haga doble clic en el grupo VPN creado.
Resultado: En el área de trabajo se muestra el cuadro de diálogo de asignación para los
grupos VPN. En la lista desplegable "VPN" se ha marcado el grupo VPN seleccionado.
Existe la posibilidad de asignarle los módulos de seguridad mediante el cuadro de diálogo
de asignación correspondiente, véase el capítulo Asignar el módulo de seguridad a un
grupo VPN (Página 441). En los ajustes de seguridad locales es posible adaptar las
propiedades del grupo VPN seleccionado, véase el capítulo Configuración de propiedades
de grupo VPN (Página 443).

Convenciones para nombres de grupos NTP
Los caracteres 0-9, a-z, A-Z, -._ pueden utilizarse para los nombres de grupos NTP. Un nombre
debe empezar con una letra y terminar con una letra o un número. Antes del carácter '.' solo se
permiten letras y números, y después del carácter '.' solo letras. Antes y después del carácter
'_' o '-' solo se permiten letras y números.

438

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Visualización de los grupos VPN con sus propiedades
Si se selecciona un módulo de seguridad que está en uno o varios grupos VPN, en el área
"Datos de red" se muestran las propiedades del o los grupos VPN en los que se encuentra el
módulo de seguridad.

Las siguientes propiedades de los grupos VPN se visualizan por columnas en la ficha "VPN"
del área "Datos de red":
Propiedad/columna

Significado

VPN

Nombres de los grupos VPN en los que se en‐
cuentra el módulo de seguridad seleccionado

Módulo de seguridad

Nombres de los módulos de seguridad asignados

Autenticación

Tipo de autenticación: Preshared Key o certificado

Miembro del grupo hasta

Fecha y hora hasta las que es válido el certificado
de grupo VPN del módulo de seguridad

Tipo

Números de modelos de los módulos de seguri‐
dad asignados

Comentario

Comentario

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

439

Configuración de dispositivos y redes
1.3 Configurar redes

Ajustar la duración de certificados
Abra de la forma siguiente el cuadro de diálogo en el que puede introducir la fecha de
caducidad del certificado:
1. En la ficha "VPN", seleccione el grupo VPN que desea editar.
2. En la ficha "Propiedades" > "General" de la ventana de inspección seleccione la entrada
"Autenticación".
Nota
Caducidad de un certificado
La comunicación a través del túnel VPN continúa una vez caducado el certificado hasta que
el túnel se deshaga o finalice la vida útil SA. Encontrará más información sobre certificados
en el capítulo:
AUTOHOTSPOT.

Capacidades
Número de túneles VPN
SCALANCE S612 V3/V4

128 como máximo

SCALANCE S623 V3/V4

128 como máximo

SCALANCE S627-2M V4

128 como máximo

CP 343-1 Advanced / CP 443-1 Advanced

32 como máximo

CP 1628

64 como máximo

S7-1200-CPs/ET 200SP-CPs

8 como máximo

CPs S7-1500

16 como máximo

Para el número de relaciones de comunicación entre subredes del módulo de seguridad y
subredes de otros módulos de seguridad accesibles a través de túnel VPN están disponibles
las siguientes capacidades:
Número de relaciones de subred
SCALANCE S612 V3/V4

128 como máximo

SCALANCE S623 V3/V4

128 como máximo

SCALANCE S627-2M V4

128 como máximo

CP 343-1 Advanced / CP 443-1 Advanced

32 como máximo

CP 1628

64 como máximo

CPs S7-1200-/S7-1500

8 como máximo

440

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Asignar el módulo de seguridad a un grupo VPN
Requisitos
● Se ha definido un grupo VPN en las funciones de seguridad globales. Antes de asignar
módulos de seguridad a grupos VPN tenga en cuenta las reglas correspondientes en el
capítulo Modos de operación de grupos VPN (Página 454).
● Antes de la asignación a grupos VPN primero hay que activar VPN para los siguientes
módulos y seleccionar el tipo de conexión VPN "Internet Key Exchange (IKE)":
– CP 1243-1 a partir de V3.1
– CP 1243-8 IRC a partir de V3.1
– CP 1243-7 LTE a partir de V3.1
– CP 1543SP-1 a partir de V2

Procedimiento
1. Haga doble clic en la entrada "Grupos VPN" de las funciones de seguridad globales.
2. Haga doble clic en la entrada "Asignar módulo a un grupo VPN".
3. Seleccione en la lista desplegable "VPN" el grupo VPN al que quiera asignar un módulo de
seguridad.
4. Seleccione en el área "Módulos disponibles" el módulo de seguridad que quiera asignar al
grupo VPN seleccionado.
5. Haga clic en el botón "<<" para asignar el módulo de seguridad seleccionado al grupo VPN
seleccionado.
Si el módulo de seguridad no soporta una o más propiedades del grupo VPN, el símbolo del
módulo se representará con un símbolo de error
en el área de los módulos asignados.
Alternativamente al procedimiento descrito arriba es posible asignar un módulo de
seguridad a un grupo VPN existente haciendo clic con el botón derecho del ratón en una
interfaz de un módulo apta para VPN en la vista redes y asignarla a un grupo VPN con el
comando "Asignar módulo a un grupo VPN" del menú contextual (no es posible para
SOFTNET Security Client).

Resultado
Se ha asignado el módulo de seguridad al grupo VPN.

Métodos de autenticación
Métodos disponibles
El método de autenticación se fija por grupo VPN y determina la forma de autenticación
utilizada.

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

441

Configuración de dispositivos y redes
1.3 Configurar redes
Son posibles métodos de autenticación basados en clave o en certificado:
● Preshared Key
La autenticación se produce a través de una secuencia de caracteres establecida de
antemano, que se distribuye a todos los módulos del grupo.
Para ello, introduzca una Preshared Key en el campo "Clave" en "Autenticación" >
"General" de las propiedades del grupo VPN. Al hacer clic en el botón "Renovar Preshared
Key" STEP 7 renueva la Preshared Key que se utilizará.
● Certificado
El ajuste estándar es el método de autenticación basado en certificado "Certificado". El
comportamiento es el siguiente:
– Al crear un grupo se genera automáticamente un certificado CA como certificado de
origen.
– Cada módulo de seguridad que forma parte del grupo recibe adicionalmente un
certificado de grupo firmado con la clave del certificado CA.
Al hacer clic en el botón "Renovar certificado" STEP 7 renueva el certificado CA del grupo
VPN.
Todos los certificados se basan en el estándar ITU X.509v3 (ITU, International
Telecommunications Union).
Los certificados son generados por una entidad certificadora contenida en STEP 7.
Nota
Restricción para el modo VLAN
En la transmisión de telegramas IP a través del túnel VPN del módulo de seguridad no se
transmiten identificadores de VLAN. Los identificadores de VLAN contenidos en los
telegramas IP se pierden al pasar los módulos de seguridad, ya que para la transmisión de
los telegramas IP se utiliza IPSec.
Con el ajuste predeterminado no es posible transmitir telegramas IP Broadcast o Mulitcast
con IPsec a través de un túnel VPN de capa 3. A través de un túnel VPN de capa 2 del
módulo de seguridad, los telegramas IP Broadcast o Multicast se "empaquetan" en UDP y
se transmiten exactamente como paquetes MAC, incluido el encabezado Ethernet. Por
ello, en esos paquetes también se conservan los identificadores de VLAN.

442

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes

Propiedades de grupos VPN
Establecimiento de conexión VPN mediante Known Peers y Unknown Peers
Las propiedades de un grupo VPN se componen del método de autenticación seleccionado y
de los parámetros configurados para las fases IKE 1 y 2, y se transfieren a todas las estaciones
del grupo VPN durante la carga. En el respondedor se depositan además las direcciones IP de
los módulos de seguridad, que podrían iniciar el establecimiento de la conexión VPN con las
propiedades configuradas del grupo VPN. Cuando el módulo de seguridad trata de establecer
una conexión VPN con el respondedor, éste comprueba primero si conoce la dirección IP del
iniciador. En caso afirmativo, el iniciador es un Known Peer. Si las propiedades del grupo VPN
propuestas por este Known Peer coinciden con las que hay depositadas en el respondedor
para el Known Peer, el respondedor permite establecer la conexión VPN. Además de las
propiedades de un grupo VPN, a un grupo VPN se le pueden asignar perfiles VPN fallback. Los
perfiles VPN incluyen propiedades predefinidas para el método de autenticación, fases IKE 1
y 2. Los perfiles VPN fallback pueden utilizarse para SCALANCE S-600 V3, CP 343-1 Adv. /
CP 443-1 Adv. y CP 1628 como configuraciones alternativas para el establecimiento de
conexiones VPN. Estos actúan cuando las propiedades VPN del iniciador no concuerdan con
las propiedades VPN del respondedor. En tales casos los perfiles VPN fallback garantizan el
establecimiento de la conexión VPN. Al igual que las propiedades del grupo VPN, los perfiles
VPN fallback configurados se transfieren a todas las estaciones del grupo VPN. La prioridad
para el uso de los perfiles VPN fallback se determina a través de su orden en la configuración.
Los perfiles VPN fallback y las propiedades del grupo VPN no pueden diferenciarse en el
método de autenticación.
Si el respondedor no conoce la dirección IP del iniciador, por ejemplo porque en modo
productivo el iniciador se ha conectado mediante una conversión NAT, el iniciador es un
Unknown Peer (Road Warrior). Está predeterminado que el respondedor permita establecer la
conexión mediante Unknown Peers. En las propiedades VPN del respondedor específicas del
módulo se define si el respondedor permite el establecimiento de la conexión mediante
Unknown Peers, y en su caso con qué propiedades del grupo VPN, siempre que se trate de un
módulo del tipo SCALANCE S-600 V3, CP 343-1 Adv. / CP 443-1 Adv. o CP 1628, consulte el
capítulo Configurar ajustes VPN específicos del módulo y la conexión (Página 458).

Configuración de propiedades de grupo VPN
Propiedades del grupo VPN
Nota
Se requieren conocimientos sobre IPsec
Para poder ajustar estos parámetros necesita tener conocimientos en materia de IPsec. Si no
efectúa ni modifica ningún ajuste, rigen los ajustes predeterminados.
En las propiedades de un grupo VPN pueden configurarse los ajustes siguientes:
● Ajustar automáticamente una configuración VPN compatible (entrada: "Configuración")
● Método de autenticación (entrada: "General")
● Ajustes IKE (entrada: "Configuración avanzada fase 1")

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

443

Configuración de dispositivos y redes
1.3 Configurar redes
● Ajustes IPsec (entrada: "Configuración avanzada fase 2")
● Perfiles VPN fallback
Si las propiedades del grupo VPN que se han configurado son menos seguras que las
propiedades recomendadas, STEP 7 lo indica con el correspondiente texto de aviso.

Cómo se accede a esta función
1. En la entrada "Grupos VPN" de las funciones de seguridad globales seleccione el grupo
VPN cuyas propiedades desee configurar.
2. Elija el comando "Abrir" del menú contextual de esta entrada.
Resultado: Las propiedades del grupo VPN aparecen bajo "Autenticación", en el área de los
ajustes de seguridad locales.
3. En la entrada "Configuración", elija si debe ajustarse automáticamente la configuración
VPN compatible. Si la función está activada, los ajustes de los diferentes miembros del
grupo cambiarán automáticamente de acuerdo con las funciones de dispositivo
soportadas, de modo que se corresponderán con las exigencias de seguridad óptimas.
4. En la entrada "General" elija si para la autenticación debe utilizarse una Preshared Key o
un certificado. Encontrará más información al respecto en el capítulo:
Métodos de autenticación (Página 441).
5. Seleccione la versión IKE. Según sea la selección, en los "Ajustes avanzados" estarán
disponibles diferentes opciones.

Fase 1 de la configuración avanzada
Fase 1: negociación IKE de Security Association (SA) para fase 2:
Aquí se ajustan los parámetros para negociar los parámetros de seguridad que se utilizarán en
la fase 2:

444

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Las siguientes propiedades de grupo VPN son soportadas por los diferentes módulos:
Módulo

CP 1543-1 (V2.1
y superior)

Ver‐
sión
IKE

Fase 1
Modo
IKE

Grupo
DH

IKEv1

Main

Grupo 1 Time: 1440 ...
AES-256, 192, 128*: Advan‐
Grupo 2 2500000 minutos ced Encryption Standard (Mo‐
do CBC)
Grupo 5
3DES-168**: DES triple***
Grupo
DES
14

CP 1543SP-1
(V2.0)
CP 1243-1 BX30
(V3.0 y superior)

Duración SA

Encriptado

Grupo
15

CP 1243-7 LTE
BX30 (V3.0 y su‐
perior)

Autenticación
SHA-256: Secure Hash
Algorithm 256
SHA-1***: Secure Hash
Algorithm 1
MD5***: Message Di‐
gest Algorithm 5

CP 1243-8 IRC
BX30 (V3.0 y su‐
perior)
CP 1543-1 (has‐
ta 2.0)

IKEv1

Main

CP 1543SP-1
(V1.0)
CP 1243-1 BX30
(hasta V2.1)

Grupo 1 Time: 1440 ...
AES-256, 192, 128*: Advan‐
2500000
minutos
ced Encryption Standard (Mo‐
Grupo 2
do CBC)
Grupo 5
3DES-168**: DES triple***
Grupo
DES
14

SHA-1***: Secure Hash
Algorithm 1

Grupo 1 Time: 1440 ...
AES-256, 192, 128*: Advan‐
Grupo 2 2500000 minutos ced Encryption Standard (Mo‐
do CBC)
Grupo 5
3DES-168**: DES triple***
Grupo
DES
14

SHA-1***: Secure Hash
Algorithm 1

Grupo 2 Time: 1440 ...
2879 minutos
Grupo

3DES-168**: DES triple***

SHA-1***: Secure Hash
Algorithm 1

Grupo 2 Time: 1440 ...
2879 minutos
Grupo

AES-256, 192, 128*: Advan‐ SHA-1***: Secure Hash
ced Encryption Standard (Mo‐ Algorithm 1
do CBC)
MD5***: Message Di‐
3DES-168**: DES triple***
gest Algorithm 5

MD5***: Message Di‐
gest Algorithm 5

CP 1243-7 LTE
BX30 (V2.1)
CP 1243-8 IRC
BX30 (V2.1)
CP 343-1 GX31
Advanced

IKEv1

Main

CP 443-1 GX30
Advanced
CP 443-1 OPC
UA

MD5***: Message Di‐
gest Algorithm 5

CP 1628
SCALAN‐
CE S-600 V3 y
superior
SOFTNET Secu‐ IKEv1
rity Client V4, V5
(WinXP)

Main

Dispositivo de se‐ IKEv1
guridad configu‐
rado como
SOFTNET Secu‐
rity Client V5
(Win7)

Main

MD741-1 V1.1,
M875 V2.0

Main

IKEv1

14

14

DES

MD5***: Message Di‐
gest Algorithm 5

DES
Grupo 2 Time: 1440 ...
3DES-168**: DES triple***
2500000 minutos

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

SHA-1***: Secure Hash
Algorithm 1

445

Configuración de dispositivos y redes
1.3 Configurar redes
Módulo

Ver‐
sión
IKE

Dispositivo de se‐ IKEv1
guridad configu‐
rado como
cliente VPN
Servidor VPN

Fase 1
Modo
IKE

Grupo
DH

Duración SA

Grupo 1 Time: 10 ...
Ag‐
Grupo 2 1666666 minutos
gressi‐ Grupo 5
ve
Grupo
14 grupo
18

Main

Encriptado

Autenticación

AES-256, 192, 128: Advan‐
SHA-512: Secure Hash
ced Encryption Standard (Mo‐ Algorithm 512
do CBC)
SHA-384: Secure Hash
3DES-168**: DES triple***
Algorithm 384
DES

SHA-256: Secure Hash
Algorithm 256
SHA-1***: Secure Hash
Algorithm 1
MD5***: Message Di‐
gest Algorithm 5

IKEv2

Main

Grupo 1 Time: 10 ...
AES-256, 192, 128*: Advan‐
1666666
minutos
ced Encryption Standard (mo‐
Grupo 2
do CBC, CTR, CCM 16 o
Grupo 5
GCM 16)
Grupo
3DES-168**: DES triple***
14 DES
grupo
18

SHA-512: Secure Hash
Algorithm 512
SHA-384: Secure Hash
Algorithm 384
SHA-256: Secure Hash
Algorithm 256
SHA-1***: Secure Hash
Algorithm 1
MD5***: Message Di‐
gest Algorithm 5

Dispositivo de se‐ IKEv1
guridad configu‐
rado como
cliente NCP VPN

Main

Grupo 1 Time: 10 ...
AES-256, 192, 128*: Advan‐
2500000
minutos
ced Encryption Standard (Mo‐
Ag‐
Grupo 2
do CBC)
gressi‐ Grupo 5
3DES-168**: DES triple***
ve
Grupo
DES
14
Grupo
15

SHA-512: Secure Hash
Algorithm 512
SHA-384: Secure Hash
Algorithm 384
SHA-256: Secure Hash
Algorithm 256
SHA-1***: Secure Hash
Algorithm 1
MD5***: Message Di‐
gest Algorithm 5

446

Edición de dispositivos y redes
Manual de programación y manejo, 11/2019

Configuración de dispositivos y redes
1.3 Configurar redes
Módulo

SCALANCE
SC-600

Ver‐
sión
IKE

Fase 1

IKEv1

Main

SCALANCE
S615

Modo
IKE

Grupo
DH

Duración SA

Grupo 1 Time: 10 ...
Ag‐
Grupo 2 2500000 minutos
gressi‐ Grupo 5
ve
Grupo
14 grupo
18

Encriptado

Autenticación

AES-256, 192, 128*: Advan‐ SHA-512: Secure Hash
ced Encryption Standard (Mo‐ Algorithm 512
do CBC)
SHA-384: Secure Hash
3DES-168**: DES triple***
Algorithm 384
SHA-256: Secure Hash
Algorithm 256
SHA-1***: Secure Hash
Algorithm 1
MD5***: Message Di‐
gest Algorithm 5

IKEv2

Main

Grupo 1 Time: 10 ...
AES-256, 192, 128*: Advan‐
2500000
minutos
ced Encryption Standard (mo‐
Grupo 2
do CBC, CTR, CCM 16 o
Grupo 5
GCM 16)
Grupo
3DES-168**: DES triple***
14 DES
grupo
18

SHA-512: Secure Hash
Algorithm 512
SHA-384: Secure Hash
Algorithm 384
SHA-256: Secure Hash
Algorithm 256
SHA-1***: Secure Hash
Algorithm 1
MD5***: Message Di‐
gest Algorithm 5

* Longitud de código 256 bits, 192 bits o 128 bits
** Longitud de código 168 bits
*** El ajuste está clasificado como menos seguro. Se recomienda utilizar un ajuste más seguro dentro de las posibilidades.

Propiedades de