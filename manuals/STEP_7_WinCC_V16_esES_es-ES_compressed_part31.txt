en la entrada I1, tiene que ser mayor
que 2 ms.

Alarmas de proceso
El inicio y el fin de una medici√≥n pueden notificarse con alarmas de proceso en el FM 452.

Medici√≥n con errores
En caso de una medici√≥n de longitud/captura de bordes con errores, el FM 452 devuelve el
valor -1 para la longitud.
Una "Medici√≥n de longitud" o "Captura de bordes" deber√≠a ejecutar un m√°ximo de 126 cambios
a cero en un sentido. Un cambio a cero es el cambio del eje rotativo del valor final del eje
rotativo a 0 y a la inversa. En cuanto el FM 452 detecta m√°s de 126 pasos por cero en un
sentido, notifica una "Medici√≥n de longitud" o una "Captura de bordes" err√≥nea, aunque luego
haya detectado nuevamente pasos por cero en el otro sentido.
Una medici√≥n tambi√©n es err√≥nea si
‚óè en un eje rotativo la longitud medida es superior a 231 ,
‚óè el FM 452 simult√°neamente el flanco de activaci√≥n y el de desactivaci√≥n (p. ej. por rebotes
del conector).
Este evento se puede comunicar como alarma de proceso.

Desplazamiento del sistema de coordenadas durante una medici√≥n de longitud
Los desplazamientos de coordenadas afectan a la longitud medida bajo las condiciones
siguientes:
‚óè Se utiliza un enc√≥der incremental o un detector de proximidad, o bien el FM 452 en el modo
de simulaci√≥n.
‚óè Se ejecuta "Definir punto de referencia" o "Redisparar punto de referencia" durante una
medici√≥n de longitud.

Ejemplo
Es posible emplear la influencia arriba indicada de la longitud medida del modo que sigue:
Se dispone de un sistema en el que durante una medici√≥n de longitud siempre se produce un
deslizamiento.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

577

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
Con el "Redisparo del punto de referencia" es posible corregir este deslizamiento de forma que
se emitan los valores medidos de longitud correctos.

Redisparar punto de referencia
Definici√≥n
Con la funci√≥n "Redisparar punto de referencia" es posible sincronizar el eje en funci√≥n de un
evento externo repetitivo.
La funci√≥n se mantiene activa hasta que se desactiva de nuevo.

Requisitos
‚óè Se emplea un enc√≥der incremental o un detector de proximidad.
‚óè El evento externo puede ser una se√±al de paso por cero de un enc√≥der incremental o un
sensor del punto de referencia en la entrada I2.

Desarrollo de la funci√≥n
1. Introduzca el valor de la coordenada del punto de referencia en el DB de par√°metros.
2. Introduzca el tipo de "Redisparar el punto de referencia" en el DB de par√°metros.
Para ello, existen las posibilidades siguientes:
‚Äì S√≥lo se eval√∫a la se√±al de paso por cero del enc√≥der (RETR_TYPE = 7).
‚Äì S√≥lo se eval√∫a el sensor del punto de referencia (RETR_TYPE = 6).
‚Äì Se eval√∫a la se√±al de paso por cero
en sentido positivo: Se eval√∫a el primer flanco ascendente de la se√±al de paso por cero
tras abandonar el sensor del punto de referencia en sentido positivo (RETR_TYPE = 0).
en sentido negativo: Se eval√∫a el primer flanco descendente de la se√±al de paso por
cero tras abandonar el sensor del punto de referencia en sentido negativo (RETR_TYPE
= 1).
3. Escriba y active los datos m√°quina.
4. Active el selector de funci√≥n del DB de canal.

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

34.3

REFTR_ON

25.0

SYNC

578

Tipo

valor inicial

Comentarios

BOOL

FALSE

1 = Redisparar el punto de referencia

BOOL

FALSE

1 = Eje sincronizado

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

44.0

REFPT

DINT

L#0

Coordenada del punto de referencia

52.0

RETR_TYPE

DINT

L#0

Forma de "Redisparar el punto de referencia"

Efectos de la funci√≥n
‚óè El FM x52 eval√∫a la se√±al de paso por cero y el sensor del punto de referencia en funci√≥n
del sentido del movimiento del eje.
‚Äì En caso de un sentido positivo se eval√∫an los flancos ascendentes.
‚Äì En caso de un sentido de movimiento negativo se eval√∫an los flancos descendentes.
‚óè La posici√≥n real se fija en el valor de la coordenada del punto de referencia.
‚óè La zona de trabajo se desplaza f√≠sicamente en el eje.
‚óè Cada uno de los puntos conserva su valor original, pero se encuentran en posiciones f√≠sicas
nuevas.
‚óè Los cambios de estado de la leva que normalmente disparar√≠an una alarma, se pueden
perder.
‚óè El bit SYNC de las se√±ales de realimentaci√≥n se activa.
Nota
Tenga en cuenta el comportamiento de conmutaci√≥n con las levas de tiempo (P√°gina 563).

Ejemplo
Para este ejemplo rige:
‚óè Del sensor del punto de referencia y la se√±al de paso por cero se eval√∫an los flancos
ascendentes (sentido positivo del eje).
‚óè La coordenada del punto de referencia tiene el valor 300 mm.
‚óè En el instante de la ejecuci√≥n no hay activo ning√∫n decalaje de se√±al cero.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

579

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra el desplazamiento de la zona de trabajo en el eje a trav√©s de la
funci√≥n "Redisparar punto de referencia".
Redisparar punto de referencia
)&6,

5($/
 

DGH
WUDE
=RQ
 )&6,



REF

REAL

FCSF

[mm]

[mm]

[mm]

[mm]

-400

300

100

400

-400

300

300

400

)&6) 6LVWHPDGHFRRUGHQDGDVDQWHULRU

5()



>PP@

'HFDODMH
GHOD]RQDGH
WUDEDMRSRU
UHGLVSDUDUSWR
GHUHIHUHQFLDD
PP

DMR

(MH



FCSI

>PP@


)&6)
5($/ 5()

1XHYRVLVWHPDGHFRRUGHQDGDV

Consideraci√≥n de un decalaje de se√±al cero
Cuando hay un decalaje de se√±al cero activo, se tiene en cuenta en la funci√≥n "Redisparar
punto de referencia". Esto significa que la coordenada del punto de referencia que se activar√°,
se calcular√° conforme a la f√≥rmula siguiente:
Ref = RefDM - Decalaje de se√±al cero
RefDM es el valor depositado en los datos m√°quina a modo de coordenada del punto de
referencia.

580

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra el desplazamiento de la zona de trabajo en el eje a trav√©s de la
funci√≥n "Redisparar punto de referencia" con decalaje de se√±al cero.
Redisparar punto de referencia

FCSI

REF

REAL

FCSF

[mm]

[mm]

[mm]

[mm]

-500

300

0

300

-400

400

100

400

-400

400

400

400

6LVWHPDGHFRRUGHQDGDVDQWHULRU
)&6,

)&6)

5($/



5()



>PP@

(MH



'6& 

DMR



=R

QD
G

HW

UDE

'HFDODMH
GHOD]RQDGH
WUDEDMRSRU
UHGLVSDUDUSWR
GHUHIHUHQFLD



 )&6,

>PP@



)&6) 5() 5()'6&
'0
1XHYRVLVWHPDGHFRRUGHQDGDV

Desconectar el final de carrera por software
Definici√≥n
La funci√≥n "Desconectar final de carrera por software" desactiva la vigilancia del final de
carrera por software de un eje lineal.
La funci√≥n se mantiene activa hasta que se desactiva de nuevo. Entonces se vuelven a activar
los finales de carrera parametrizados originalmente.

Desarrollo de la funci√≥n
Active el selector de funci√≥n en el DB de canal.

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

Valor inicial

Comentarios

34.4

SSW_OFF

BOOL

FALSE

1 = Final de carrera por software desconectado

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

581

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

Valor inicial

Comentarios

64.0

SSW_STRT

DINT

L# -1000000000

Final de carrera por software Inicio

68.0

SSW_END

DINT

L#1000000000

Final de carrera por software Fin

Efectos de la funci√≥n
‚óè Simulaci√≥n
‚Äì Si en el modo de simulaci√≥n se rebasa un final de carrera por software se detiene el
modo de simulaci√≥n.
‚Äì Si desactiva entonces la vigilancia del final de carrera por software, el modo de
simulaci√≥n prosigue. El eje se desplaza en la direcci√≥n indicada.
‚óè Decalaje de se√±al cero con vigilancia desactivada
Si se define un decalaje de se√±al cero en el que los finales de carrera por software se
encuentran todav√≠a dentro de los l√≠mites de la zona de desplazamiento, el valor real puede
encontrarse fuera del rango de contaje admisible.
‚óè Las levas que se encuentran fuera del final de carrera por software parametrizado, se
pueden activar.
PRECAUCI√ìN
Se pueden producir da√±os materiales.
Si limita la zona de desplazamiento con finales de carrera por software y protege con ello
su instalaci√≥n, al desconectar los finales de carrera por software se pueden producir da√±os
materiales.
Por ello, al planificar la instalaci√≥n cuide que el accionamiento pueda desplazarse por toda
la zona de desplazamiento f√≠sica.

Ejecutar la "Simulaci√≥n"
Definici√≥n
La funci√≥n "Simulaci√≥n" brinda la posibilidad de activar la leva electr√≥nica sin un enc√≥der
conectado.

Desarrollo de la funci√≥n
1. Introduzca la velocidad de simulaci√≥n en el DB de par√°metros.
2. Escriba y active los datos m√°quina.
3. En el DB de canal seleccione como sentido de la simulaci√≥n el sentido positivo o negativo.
4. Active el selector de funci√≥n del DB de canal.

582

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

15.2

DIR_M

BOOL

FALSE

1 = Simulaci√≥n en el sentido negativo

15.3

DIR_P

BOOL

FALSE

1 = Simulaci√≥n en el sentido positivo

34.1

SIM_ON

BOOL

FALSE

1 = Simulaci√≥n activa

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

84.0

SIM_SPD

DINT

L#0

Velocidad de simulaci√≥n

Efectos al activar la simulaci√≥n
‚óè Las se√±ales de enc√≥der dejan de evaluarse.
‚óè Todas las supervisiones referidas a la entrada del enc√≥der se desconectan.
‚óè Los errores que se hayan notificado con respecto al enc√≥der, se desactivan.
‚óè El FM x52 simula el movimiento de un eje a una velocidad de simulaci√≥n constante.
‚óè El procesamiento de levas se desactiva con la activaci√≥n de la simulaci√≥n. Sin embargo, es
posible activarlo de nuevo. La sincronizaci√≥n se mantiene.
‚óè El valor real de la posici√≥n cambia a partir del valor real actual, dependiendo de la velocidad
y del sentido de la simulaci√≥n.

Efectos al desactivar la simulaci√≥n
‚óè El procesamiento de levas se desactiva.
‚óè En caso de un enc√≥der incremental o un detector de proximidad, la sincronizaci√≥n se borra.
Entonces como valor real se define el valor de la coordenada del punto de referencia.
‚óè En el caso de un enc√≥der absoluto se notifica el valor real de la posici√≥n, que se
corresponde con la posici√≥n actual del enc√≥der. Las se√±ales del enc√≥der se eval√∫an de
nuevo tal como se han parametrizado en los datos m√°quina.

Valores l√≠mite
Los l√≠mites m√°ximo y m√≠nimo de la velocidad de simulaci√≥n dependen de la resoluci√≥n
(P√°gina 599).

Velocidad
Entre la velocidad definida y la velocidad real (P√°gina 599) a la que funciona el m√≥dulo, puede
haber diferencias.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

583

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Leer "Valores de contaje de las pistas de leva de contaje"
Definici√≥n
La funci√≥n "Valores de contaje de las pistas de leva de contaje" permite leer los valores de
contaje actuales.

Desarrollo de la funci√≥n
1. Defina las pistas de la leva de contaje y los valores de contaje superiores en los datos
m√°quina.
2. Escriba y active los datos m√°quina.
3. Habilite la funci√≥n de contaje.
4. El valor de contaje se fijar√° en el valor de contaje superior.
5. Con cada flanco ascendente del resultado de la pista el valor de contaje se reducir√° en 1.
6. Active el bit de inicio en el DB de canal para la lectura de los valores de contaje.
7. Los valores de contaje de las dos pistas se escriben en el DB de canal. Para una pista no
parametrizada como pista de leva de contaje se emite 0.
8. Si el valor de contaje alcanza el valor 0, el bit identificador de la pista de leva de contaje se
pone a 1.
9. Con el siguiente flanco descendente del resultado de pista, el bit identificador vuelve a 0 y
el contador se pone al valor de contaje superior.

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

15.5

CNTC0_EN

BOOL

FALSE

1 = Habilitar la funci√≥n de contaje de la pista de leva de
contaje 0

15.6

CNTC1_EN

BOOL

FALSE

1 = Habilitar la funci√≥n de contaje de la pista de leva de
contaje 1

38.3

CNTTRC_EN

BOOL

FALSE

1 = Leer valores de contaje de la pista de leva de contaje

124.0

CNT_TRC0

INT

0

Valor de contaje actual para la pista de leva de contaje 0

126.0

CNT_TRC1

INT

0

Valor de contaje actual para la pista de leva de contaje 1

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

99.0

SPEC_TRC0

BOOL

FALSE

1 = Pista 0 es pista de leva de contaje

99.1

SPEC_TRC1

BOOL

FALSE

1 = Pista 1 es pista de leva de contaje

100.0

CNT_LIM0

DINT

L#2

Valor de contaje superior para la pista de leva de contaje
0

104.0

CNT_LIM1

DINT

L#2

Valor de contaje superior para la pista de leva de contaje
1

584

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Leer "Datos de posici√≥n y pista"
Definici√≥n
Con la funci√≥n "Datos de posici√≥n y pista" se lee la posici√≥n, la velocidad y el bit identificador
de pista en ese instante. Los bits identificadores de pista se capturan antes de combinarlos con
los datos m√°quina y de canal.
El algoritmo de c√°lculo implantado en el FM x52 calcula cambios de velocidad mayores que 1
impulso por 4 ms. La velocidad que se muestra, por lo tanto, incluye imprecisi√≥n y no es
conveniente para fines de c√°lculo. La velocidad interna que se emplea para dinamizar las levas
es m√°s precisa.

Desarrollo de la funci√≥n
1. Active el bit de inicio en el DB de canal.
2. Los datos se depositan en el DB de canal.

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

38.4

ACTPOS_EN

BOOL

FALSE

1 = Leer Datos de posici√≥n y pista

128.0

ACTPOS

DINT

L#0

Posici√≥n actual

132.0

ACTSPD

DINT

L#0

Velocidad actual

136.0

TRACK_ID

DWORD

DW#16#0

Bits identificadores de pista de las pistas 0 a 31

Leer "Datos de enc√≥der"
Definici√≥n
Con la funci√≥n "Datos de enc√≥der" se leen los datos actuales del enc√≥der as√≠ como el valor del
reajuste del enc√≥der absoluto.

Requisitos
Es posible leer el valor para el reajuste del enc√≥der absoluto (P√°gina 594) despu√©s de
ejecutar la funci√≥n "Definir punto de referencia (P√°gina 569)".

Desarrollo de la funci√≥n
1. Active el bit de inicio en el DB de canal.
2. Los datos se depositan en el DB de canal.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

585

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

38.5

ENCVAL_EN

BOOL

FALSE

1 = Leer valores del enc√≥der

140.0

ENCVAL

DINT

L#0

Valor de enc√≥der / Lectura del contador (representaci√≥n
interna)

144.0

ZEROVAL

DINT

L#0

Lectura del contador en la √∫ltima se√±al de paso por cero
(representaci√≥n interna)

148.0

ENC_ADJ

DINT

L#0

Reajuste del enc√≥der absoluto

Leer los "Datos de leva y pista"
Definici√≥n
Con la funci√≥n "Datos de leva y pista" se leen los bits identificadores de leva y de pista actuales
as√≠ como la posici√≥n en ese instante. Los bits identificadores de pista se capturan antes de
combinarlos con los datos m√°quina y de canal.

Desarrollo de la funci√≥n
1. Introduzca como identificador de tipo un 1 en el par√°metro FM_TYPE del DB de canal. Con
ello es posible leer los datos de leva y de pista de 24 bytes.
Si introduce 0 como identificador de tipo s√≥lo se leer√°n los bits identificadores de la leva (16
byte).
2. Los datos se depositan en el DB de canal.

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

12.0

FM_TYPE

BOOL

FALSE

0 = FM 352 a V4.0

38.6

CAMOUT_EN

BOOL

FALSE

1 = Leer datos de leva y pista

152.0

CAM_00_31

DWORD

DW#16#0

Bits identificadores de la leva para las levas de 0 a 31

156.0

CAM_32_63

DWORD

DW#16#0

Bits identificadores de leva para las levas de 32 a 63

160.0

CAM_64_95

DWORD

DW#16#0

Bits identificadores de la leva para las levas de 64 a 95

164.0

CAM_96_127

DWORD

DW#16#0

Bits identificadores de la leva para las levas de 96 a 127

168.0

TRACK_ID1

DWORD

DW#16#0

Bits identificadores de pista de las pistas 0 a 31

172.0

ACTPOS1

DINT

L#0

Posici√≥n actual

1 = FM 352 a partir de V5.0 y FM 452

Activar "Se√±ales de control de la leva electr√≥nica"
Definici√≥n
Con la funci√≥n "Se√±ales de control de la leva electr√≥nica" se habilita el procesamiento de levas
as√≠ como las pistas.

586

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Proceso de la funci√≥n
1. Active los bits que desee en el DB de canal.
2. Con cada llamada de la instrucci√≥n CAM_CTRL o CAM_CTRL_452 los datos se transfieren
al m√≥dulo.

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

15.4

CAM_EN

BOOL

FALSE

1 = Habilitar el procesamiento de levas

16.0

TRACK_EN

WORD

W#16#0

Habilitar pistas de leva de 0 a 12
Bit 0 = Pista 0

Efectos
El procesamiento de levas se inicia o se detiene seg√∫n la habilitaci√≥n.
Los bits identificadores de pista de las pistas habilitadas se transfieren a las se√±ales de pista
y a las salidas digitales.

Consultar "Se√±ales de realimentaci√≥n de la leva electr√≥nica"
Definici√≥n
Con la funci√≥n "Se√±ales de respuesta de la leva electr√≥nica" se informa del estado actual de
la leva y de las se√±ales de pista. La coherencia entre la posici√≥n indicada y las se√±ales de pista
no est√° asegurada.

Proceso de la funci√≥n
Con cada llamada de la instrucci√≥n CAM_CTRL o CAM_CTRL_452 los datos se depositan en
el DB de canal.

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

23.4

CAM_ACT

BOOL

FALSE

1 = Procesamiento de levas activo

26.0

ACT_POS

DINT

L#0

Posici√≥n actual del eje

30.0

TRACK_OUT

DWORD

DW#16#0

Se√±ales de pista actuales de las pistas 0 a 31
Bit 0 = Pista 0

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

587

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Consultar "Se√±ales de realimentaci√≥n del diagn√≥stico"
Definici√≥n
Con el ajuste "Se√±ales de realimentaci√≥n del diagn√≥stico" se recibe informaci√≥n sobre los
eventos de diagn√≥stico que se han producido.

Proceso de ajuste
1. Cuando el m√≥dulo realiza una nueva entrada en el b√∫fer de diagn√≥stico, activa el bit DIAG
en la interfaz de realimentaci√≥n. Cada aparici√≥n de un error (P√°gina 632) provoca una
entrada en el b√∫fer de diagn√≥stico.
2. Cuando el m√≥dulo detecta una petici√≥n de escritura con datos err√≥neos, activa el bit
DATA_ERR en la interfaz de realimentaci√≥n. La causa del error se registra en el b√∫fer de
diagn√≥stico.
3. La instrucci√≥n CAM_CTRL o CAM_CTRL_452 coloca la interfaz de realimentaci√≥n en el DB
de canal.
4. Una vez que la instrucci√≥n CAM_DIAG o CAM_DIAG_452 haya le√≠do el b√∫fer de
diagn√≥stico, el m√≥dulo restablece el bit DIAG a 0.

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

22.2

DIAG

BOOL

FALSE

1 = B√∫fer de diagn√≥stico modificado

22.4

DATA_ERR

BOOL

FALSE

1 = Error de datos

2.1.4.3

Configurar FM 452

2.1.4.4

Parametrizar el FM 452

Sistema de medici√≥n
Seleccionar sistema de medidas
Seleccionar sistema de medidas
Para la entrada y salida de datos es posible elegir entre los siguientes sistemas de medida:
‚óè Mil√≠metros (ajuste predeterminado)
‚óè Inch
‚óè Grados
‚óè Impulsos

588

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Nota
Si se modifica el sistema de medida en el cuadro de di√°logo "Sistema de medida", los valores
se convierten al nuevo sistema. Aqu√≠ se pueden producir errores de redondeo.
Si se modifica el sistema de medida mediante el dato m√°quina, los valores no se convierten
autom√°ticamente.
Si el sistema de medida cambia de o a "impulsos", el procesamiento de levas se desactivar√°
y el eje dejar√° de estar sincronizado.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentario

8.0

UNITS

DINT

L#1

Sistema de medida
Valores permitidos:
‚óè 1 = 10-3 mm
‚óè 2 = 10-4 pulgadas
‚óè 3 = 10-4 grados
‚óè 4 = 10-2 grados
‚óè 5 = Impulsos
‚óè 6 = 10-3 grados

Sistema de medida est√°ndar en la ayuda en pantalla
Para la indicaci√≥n de valores l√≠mite se utiliza el sistema de medida mm. Por ello, para
determinar los valores l√≠mite en los otros sistemas de medida, realice la conversi√≥n siguiente:
Para convertir de

calcule

mm ‚Üí pulgadas
mm ‚Üí grados

Valor l√≠mite (inch) = valor l√≠mite (mm) √ó 0,1 1)

10 (4 decimales)

Valor l√≠mite (grados) = valor l√≠mite (mm) √ó 0,1

10-3 (3 decimales)

Valor l√≠mite (grados) = valor l√≠mite (mm) √ó 1

10 (2 decimales)

Valor l√≠mite (grados) = valor l√≠mite (mm) √ó 10

-4

-2

mm ‚Üí impulsos
1)

Valor l√≠mite (impulsos) = valor l√≠mite (mm) x 1000

En el valor m√°ximo el n√∫mero de decimales repercute en el n√∫mero de d√≠gitos que preceden a la
coma. En el sistema de medida Inch se utilizan 4 decimales, por lo tanto se pueden introducir como
m√°ximo 100 000,0000 inch. El sistema de medida Mil√≠metros utiliza 3 decimales y por lo tanto se
pueden introducir como m√°ximo 1 000 000,000 mm.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

589

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Eje
Definir tipo de eje
Seleccionar tipo de eje
Tipos de eje
La leva electr√≥nica soporta los siguientes tipos de ejes:
‚óè Eje lineal
El eje lineal es un eje con una zona de desplazamiento f√≠sica limitada.

,QLFLRI¬ØVLFR

)LQDOI¬ØVLFR

‚óè Eje rotativo
El eje rotativo es un eje cuya zona de desplazamiento no est√° limitada por topes mec√°nicos.
,QLFLRGHOHMHURWDWLYR 
)LQDOGHOHMHURWDWLYR

(OYDORUPD\RULQGLFDGR

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

12.0

AXIS_TYPE

DINT

L#0

Tipo de eje
Valores permitidos:
‚óè 0 = Eje lineal
‚óè 1 = Eje rotativo

Definir final de carrera por software
Final de carrera por software
Los finales de carrera por software existen s√≥lo para el eje lineal.
El √°rea limitada por el final de carrera por software es la zona de trabajo. Los l√≠mites de la zona
de trabajo pueden ser vigilados por el FM x52.
El inicio del final de carrera por software (FCSI) debe ser siempre menor que el fin del final de
carrera por software (FCSF).

590

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
Los finales de carrera por software est√°n activos cuando el FM x52 est√° sincronizado.
‚óè Si se utiliza un enc√≥der incremental o un detector de proximidad:
Despu√©s de cada arranque del FM x52 el eje no est√° sincronizado. S√≥lo tras una
sincronizaci√≥n se vigilan los finales de carrera por software parametrizados.
‚óè Si se utiliza un enc√≥der absoluto (SSI):
El FM x52 est√° sincronizado despu√©s de haber recibido un telegrama completo y sin
errores. A partir de este instante los finales de carrera por software son vigilados. El
enc√≥der absoluto utilizado tiene que abarcar por lo menos la zona de trabajo, incluido el
final de carrera por software.

Relaci√≥n entre la zona de trabajo, del enc√≥der y la zona de desplazamiento
‚óè La zona de trabajo es el √°rea que el usuario define para sus tareas mediante los finales de
carrera por software.
‚óè El zona del enc√≥der es el √°rea que el enc√≥der cubre claramente. En el caso de un eje lineal
del m√≥dulo, el √°rea del enc√≥der se define de forma sim√©trica por encima de la zona de
trabajo. Es decir, el m√≥dulo desplaza la zona del enc√≥der de tal modo que las distancias
entre los finales de carrera por software y los finales de la zona del enc√≥der son iguales en
cada caso (v√©ase la figura en la parte de abajo).
‚óè La zona de desplazamiento es el rango de valores que puede procesar el FM x52. La zona
de desplazamiento depende de la resoluci√≥n.
Se debe considerar: Zona de desplazamiento ‚â• Rango del enc√≥der ‚â• Zona de trabajo
La figura siguiente muestra la relaci√≥n entre los finales de carrera por software, la zona de
trabajo, el rango del enc√≥der y la zona de desplazamiento.
=RQDGHWUDEDMR

(MH

)&6,



=RQDGHDOFDQFHGHOHQF¬µGHU
0DUJHQGHGHVSOD]DPLHQWR

)&6)





Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

64.0

SSW_STRT

DINT

L# -100.000.000

Final de carrera por software Inicio

68.0

SSW_END

DINT

L# 100.000.000

Final de carrera por software Fin
Rango de valores admisible:
‚óè -1 000 000 000 ¬µm a 1 000 000 000 ¬µm

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

591

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Definir final del eje rotativo
Final del eje rotativo
El valor "Final del eje rotativo" es el valor m√°ximo te√≥rico que el valor real puede alcanzar. Sin
embargo, el m√°ximo valor te√≥rico nunca se indica porque f√≠sicamente identifica la misma
posici√≥n que el inicio del eje rotativo (0).
El valor m√°s grande que se muestra en el caso de un eje rotativo es:
Final del eje rotativo [¬µm] - Resoluci√≥n [¬µm/impulso] √ó 1 [impulso]
Ejemplo: Final del eje rotativo 1000 mm
La visualizaci√≥n pasa:
‚óè Con un sentido de giro positivo, de 999 mm a 0 mm.
‚óè con un sentido de giro negativo, de 0 mm a 999 mm.

Eje rotativo con enc√≥ders absolutos
En el caso de un eje rotativo con un enc√≥der absoluto, el √°rea del eje rotativo (0 hasta el final
del eje rotativo) tiene que coincidir exactamente con el total de pasos del enc√≥der absoluto.
wP
3DVRV HQFRGHU >SXO@
)LQGHHMHURWDWLYR>wP@ Q¬ºPHURGHYXHOWDV HQFRGHU   5(6>@
9XHOWD
3XOVR

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

16.0

ENDROTAX

DINT

L#100000

Final del eje rotativo
Rango de valores admisible:
‚óè 1 ¬µm a +1 000 000 000 ¬µm

Definir sincronizaci√≥n
Seleccionar la "Forma de redisparar el punto de referencia"
Redisparar el punto de referencia
Con la forma de "Redisparar el punto de referencia (P√°gina 578)" se definen las condiciones
de sincronizaci√≥n del eje para el funcionamiento con un enc√≥der incremental o un detector de
proximidad.

592

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

52.0

RETR_TYPE

DINT

L#0

Forma de "Redisparar el punto de referencia"
Valores permitidos:
‚óè 0 = sensor del punto de referencia y se√±al de paso por
cero en sentido +
‚óè 1 = sensor del punto de referencia y se√±al de paso por
cero en sentido ‚óè 6 = s√≥lo sensor del punto de referencia
‚óè 7 = s√≥lo se√±al de paso por cero

Definir la coordenada del punto de referencia
Coordenada del punto de referencia
‚óè Enc√≥der incremental y detector de proximidad:
Con el selector de funci√≥n "Redisparar punto de referencia" y un evento de sincronizaci√≥n,
definido por la forma de "Redisparar el punto de referencia" (P√°gina 592), se asigna a este
evento la coordenada del punto de referencia.
‚óè Enc√≥der absoluto (SSI)
Un eje parametrizado con un enc√≥der absoluto siempre est√° sincronizado despu√©s de la
transmisi√≥n del primer telegrama SSI sin errores.
Consulte al respecto tambi√©n la descripci√≥n del reajuste del enc√≥der absoluto
(P√°gina 594), en la que se explica la interacci√≥n de dicho ajuste con el resto de datos.
El valor de la coordenada del punto de referencia se encuentra dentro de la zona de trabajo:
‚óè Eje lineal
Incluido el final de carrera por software.
‚óè Eje rotativo
Mayor o igual que 0 y menor que el valor "Final del eje rotativo" (0 ‚â§ coordenada del punto
de referencia < final del eje rotativo).

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

44.0

REFPT

DINT

L#0

Coordenada del punto de referencia
Rango de valores admisible:
‚óè -1.000.000.000 ¬µm a +1.000.000.000 ¬µm

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

593

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Definir reajuste del enc√≥der absoluto
Calcular reajuste del enc√≥der absoluto
Definici√≥n
El reajuste del enc√≥der absoluto s√≥lo es necesario para un enc√≥der absoluto (SSI).
Con el reajuste del enc√≥der absoluto y las coordenadas del punto de referencia el rango de
valores del sensor se reproduce claramente en el sistema de coordenadas del eje. Se calcula
el valor del enc√≥der que equivale a la coordenada del punto de referencia en el eje. El valor
tiene que ser menor que el total de pasos del enc√≥der absoluto.
Encontrar√° m√°s informaci√≥n al respecto en "Procedimiento de reajuste del enc√≥der absoluto
(P√°gina 594)", as√≠ como en un ejemplo (P√°gina 595).

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

48.0

ENC_ADJ

DINT

L#0

Reajuste del enc√≥der absoluto
Rango de valores admisible:
‚óè 0 a (225 - 1)

Datos utilizados en el DB de canal
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

98.0

REFPT

DINT

L#0

Coordenada del punto de referencia
Rango de valores admisible:
‚óè -1.000.000.000 ¬µm a +1.000.000.000 ¬µm

Procedimiento para un reajuste del enc√≥der absoluto
Determinar el reajuste correcto del enc√≥der absoluto
Tras la primera parametrizaci√≥n hay que llevar a cabo otros pasos para que se establezca una
relaci√≥n correcta entre el enc√≥der y el sistema de coordenadas. El proceso se representa
utilizando el cuadro de di√°logo de parametrizaci√≥n.
1. Desplace el eje a un punto definido y reproducible que f√≠sicamente sea √∫nico.
Puede ser, por ejemplo, el "Fin del final de carrera por software".
2. Llame el ajuste "Definir punto de referencia (P√°gina 569)" con la coordenada del punto
definido en 1.
El FM x52 determina entonces un valor de enc√≥der para la coordenada del punto de
referencia registrada en el eje en el DB de canal (REFPT): el reajuste del enc√≥der absoluto.
Este valor se puede leer con el ajuste "Datos de enc√≥der (P√°gina 585)".
3. Registre el valor le√≠do en el campo "Reajuste del enc√≥der absoluto".

594

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
4. Guarde la parametrizaci√≥n en el DB de par√°metros correspondiente con la funci√≥n de
exportaci√≥n.
5. Cargue los datos de HWCN en la CPU.
6. Para activar los datos, rearranque la CPU.
Nota
Esta sincronizaci√≥n se realiza una vez en la puesta en marcha. Tras una parametrizaci√≥n, el
FM x52 queda sincronizado durante el arranque en cuanto se recibe un telegrama sin errores
del enc√≥der.

Alternativa: Reajuste mec√°nico de un enc√≥der
Tambi√©n se puede obtener una relaci√≥n correcta entre el sistema de coordenadas y el enc√≥der
del modo siguiente:
1. Desplace el eje a un punto definido y reproducible que f√≠sicamente sea √∫nico.
Puede ser, por ejemplo, el "Inicio del final de carrera por software".
2. Introduzca este valor de coordenadas en los datos m√°quina a modo de "coordenada del
punto de referencia".
3. Lea el valor de enc√≥der que se muestra en esta posici√≥n con el ajuste "Datos de enc√≥der
(P√°gina 585)".
4. Introduzca este valor como reajuste del enc√≥der absoluto en los datos m√°quina.
Tras la parametrizaci√≥n se mostrar√° siempre un valor real correcto.
En lugar del paso 3 y 4 tambi√©n es posible resetear a cero el codificador a trav√©s de la opci√≥n
"Reset", si est√° disponible. A continuaci√≥n, introduzca el valor "0" como reajuste del enc√≥der
absoluto en los datos m√°quina.

Ejemplo para un reajuste del enc√≥der absoluto
Ejemplo para un reajuste del enc√≥der absoluto
Para este ejemplo se parte de las premisas siguientes:
‚óè Coordenada del punto de referencia = -125 mm
‚óè √Årea de trabajo de SSW_STRT = -1.000 mm a SSW_END = 1.000 mm
‚óè Reajuste del enc√≥der absoluto = 0
‚óè √Årea del enc√≥der = 2.048 incrementos con una resoluci√≥n de 1 mm/impulso
‚óè El enc√≥der absoluto utilizado no permite un ajuste mec√°nico exacto y tampoco ofrece la
posibilidad de definir el valor del enc√≥der.
La figura siguiente muestra un ejemplo de reajuste del enc√≥der absoluto.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

595

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

GHVHDGR

(MH
9DORUGHOHQF¬µGHUDEVROXWR

(QF¬µGHU

9DORUUHDO  






9DORUGHOHQF¬µGHU



(MH

DFWXDOPHQWH




 



1)

Asignaci√≥n del sistema de coordenadas a los valores del sensor con el reajuste de enc√≥der
absoluto definido. El valor del enc√≥der 0 equivale al valor real -125.

2)

Asignaci√≥n deseada del sistema de coordenadas con respecto al enc√≥der. En esta posici√≥n, la
coordenada tiene que ser -125.

Resultado tras "Definir el punto de referencia"
Tras "Definir el punto de referencia", la relaci√≥n es la siguiente:
La coordenada del punto de referencia en el eje (-125) se asigna al valor del enc√≥der calculado
(1798) a partir del reajuste del enc√≥der absoluto. La figura siguiente muestra esta asignaci√≥n.
$OFDQFHTXHSXHGHFXEULUVHFODUDPHQWHFRQHVWHHQF¬µGHU

(MH



 






)&6)

9DORUGHOHQF¬µGHUDEVROXWR

)&6,







9DORUFDOFXODGRGHO
UHDMXVWHGHOHQF¬µGHU
DEVROXWR




El enc√≥der devuelve 2.048 valores un√≠vocos. La zona de trabajo est√° definida por el final de
carrera por software. Sin embargo, debido a la resoluci√≥n seleccionada de 1 mm por impulso,
el enc√≥der puede abarcar una zona de trabajo mayor que la prevista por el final de carrera por
software.
Con la resoluci√≥n definida, la zona de trabajo est√° ya cubierta con 2.001 valores. Por ello en
el ejemplo quedan 47 impulsos "sobrantes" dispuestos sim√©tricamente alrededor de la zona de
trabajo.

596

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Definir hist√©resis
Hist√©resis
El rango de valores de la hist√©resis (P√°gina 470) depende de la resoluci√≥n (P√°gina 603).
El valor m√°ximo de entrada es como sigue:
‚óè En el caso de ejes lineales: Valor de entrada m√°ximo < ¬º de la zona de trabajo
‚óè En el caso de los ejes rotativos: Valor de entrada m√°ximo < ¬º del √°rea del eje rotativo

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

80.0

HYS

DINT

L#0

Hist√©resis
Rango de valores admisible:
‚óè 0 ‚Ä¶ 65.535 [Imp] √ó resoluci√≥n [¬µm/Imp]

Leva de recorrido con hist√©resis
Una leva de recorrido se acciona cuando se cumplen las siguientes condiciones:
‚óè el valor real detectado se encuentra dentro de la leva de recorrido
‚óè la hist√©resis no est√° activada.
Seg√∫n la posici√≥n en la que tiene lugar el cambio de sentido, puede variar la posici√≥n de un
punto de cambio.
La siguiente figura muestra el comportamiento de conmutaci√≥n de una leva de recorrido en el
caso de una hist√©resis.



6HQWLGRGHDFWXDFL¬µQ
,/
)/
      






&DPELRGHVHQWLGR


&DPELRGHVHQWLGR





Leva
Hist√©resis
1)

La leva se activa porque el principio de leva se rebasa en sentido de actuaci√≥n positivo.

2)

A pesar del cambio de sentido, la leva permanece activada debido a la hist√©resis.

3)

La leva se desactiva al final de la hist√©resis.

4)

La leva permanece desactivada tras el cambio de sentido.

5)

Tras el final de la hist√©resis la leva se activa nuevamente.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

597

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Nota
Las levas de recorrido que son m√°s cortas que la hist√©resis no pueden ser acortadas por la
hist√©resis en caso de un cambio de sentido.

Levas de tiempo con hist√©resis
La leva de tiempo se acciona cuando se cumplen las siguientes condiciones:
‚óè El principio de leva se rebasa en el sentido de actuaci√≥n.
‚óè la hist√©resis no est√° activada.
Nota
Si el √°rea comprendida entre el punto de inversi√≥n y el principio de leva de tiempo es menor
que la hist√©resis la leva de tiempo quedar√° oculta por la hist√©resis.
La siguiente figura muestra el comportamiento de conmutaci√≥n de una leva de tiepo en el caso
de una hist√©resis. Se representa una leva de tiempo que no se activa de nuevo.

 

6HQWLGRGHDFWXDFL¬µQ
,/
      




&DPELRGHVHQWLGR

&DPELRGHVHQWLGR


Leva
Hist√©resis

598

1)

La leva se activa porque el principio de leva se rebasa en sentido de actuaci√≥n positivo.

2)

Tras el cambio de sentido y hasta que ha transcurrido el tiempo de conexi√≥n la leva se
mantiene activada, independientemente de la hist√©resis.

3)

El principio de leva queda oculto por la hist√©resis, la leva no se activa.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Definir velocidad de simulaci√≥n
Velocidad de simulaci√≥n
Este dato m√°quina define la velocidad de la "simulaci√≥n". Tenga en cuenta a este respecto la
informaci√≥n incluida en "Influencia de los ajustes en el comportamiento de conmutaci√≥n de las
levas de tiempo (P√°gina 563)".
La velocidad de simulaci√≥n real Vsim puede diferir de la velocidad de simulaci√≥n introducida Vsim,
V y se calcula conforme a la f√≥rmula siguiente:
9
6LP 

 H[S 5(6
(QWHUR

 H[S 5(6


9
6LP9

En esta f√≥rmula:
‚óè Vsim: es la velocidad de simulaci√≥n definida por el FM 352. Unidad: ¬µm/min
‚óè Vsim, V: es la velocidad de simulaci√≥n que el usuario define en los datos m√°quina.
Unidad: ¬µm/min
‚óè RES: Resoluci√≥n calculada a partir de los datos del enc√≥der. Unidad: ¬µm/Impulso
‚óè Entero ( ): a partir de esta expresi√≥n, s√≥lo se tiene en cuenta el valor previo al decimal para
otros c√°lculos. Esta expresi√≥n tiene que encontrarse dentro del rango de 2 ... 65.536 en
todos los c√°lculos.
Las diferentes relaciones (v√©ase la f√≥rmula anterior) provocan cambios inesperados en la
velocidad de simulaci√≥n real.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

84.0

SIM_SPD

DINT

L#0

Velocidad de simulaci√≥n
Rango de valores admisible:
‚óè 0 = Parada
‚óè 5 √ó 108 = Ajuste m√°ximo del m√≥dulo
Dentro de este rango la velocidad de simulaci√≥n depende
de la resoluci√≥n (P√°gina 603):
1000 √ó resoluci√≥n ‚â§ velocidad de simulaci√≥n
‚â§ 3 √ó 107 √ó resoluci√≥n

Definir distancia m√≠nima entre bordes
Distancia m√≠nima entre bordes
En una captura de bordes, con este dato m√°quina se define un √°rea tras detectar el inicio de
la medici√≥n. Si el final del proceso de medici√≥n se encuentra dentro de este rango, la medici√≥n
se desestima.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

599

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
El inicio de la medici√≥n se notifica en cuanto se ha recorrido la distancia m√≠nima entre bordes.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

4.0

EDGEDIST

DINT

L#0

Distancia m√≠nima entre bordes
Rango de valores admisible:
‚óè 0 ... 1.000.000.000 ¬µm

Enc√≥der
Seleccionar tipo de se√±al
Tipo de se√±al
El enc√≥der da informaci√≥n de recorrido al m√≥dulo, el cual la eval√∫a y la convierte en un valor
real con la resoluci√≥n.
Es posible seleccionar un tipo de se√±al de uno de los enc√≥ders (P√°gina 474) siguientes:
‚óè Se√±al diferencial de 5 V (P√°gina 475)
Seleccione el tipo de se√±al "5 V Se√±al diferencial" si utiliza un enc√≥der incremental de 5 V
con se√±ales diferenciales A, /A, B, /B y N, /N.
‚óè 24 V Pista A+B desfasado (P√°gina 475)
Seleccione el tipo de se√±al "24 V Pista A+B desfasado" si desea utilizar un enc√≥der
incremental de 24 V con las se√±ales A*, B* y N*.
‚óè SSI absoluto (P√°gina 477)
Seleccione el tipo de se√±al "SSI absoluto" si desea utilizar un enc√≥der absoluto con una
interfaz en serie.
‚óè 24 V Detector de proximidad (P√°gina 477)
Seleccione el tipo de se√±al "Detector de proximidad de 24 V" si desea utilizar un detector de
24V con la se√±al A*.

600

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

20.0

ENC_TYPE

DINT

L#1

Tipo de se√±al
Valores permitidos:
‚óè 1 = 5 V incremental
‚óè 2 = 24 V incremental
‚óè 3 = SSI longitud del telegrama 13 bits
‚óè 4 = SSI longitud del telegrama 25 bits
‚óè 5 = Escuchar
‚óè 6 = 24 V Detector de proximidad ascendente (positivo)
‚óè 7 = 24 V Detector de proximidad descendente (negativo)
‚óè 8 = SSI longitud del telegrama 13 bits (alineaci√≥n
derecha)
‚óè 9 = SSI longitud del telegrama 25 bits (alineaci√≥n
derecha)
‚óè 10 = Escuchar (alineaci√≥n derecha)

Definir resoluci√≥n
Definir el recorrido por vuelta del enc√≥der
recorrido por vuelta del enc√≥der
Con el dato m√°quina "Recorrido por vuelta del enc√≥der" se indica al FM x52 qu√© recorrido
realiza el sistema de accionamiento en cada vuelta.
El valor "Recorrido por vuelta del enc√≥der" depende de la estructura del eje y del modo en que
est√° colocado el enc√≥der. Debe tener en cuenta todos los elementos de transmisi√≥n, como
acoplamientos o engranajes. La figura siguiente muestra dos disposiciones de enc√≥der
distintas a modo de ejemplo.

0RWRU

(QF¬µGHU

0RWRU

5HGXFWRUHV

5HGXFWRUHV

(QF¬µGHU

La relaci√≥n entre los datos m√°quina "Recorrido por vuelta del enc√≥der" e "Incrementos por
vuelta del enc√≥der" se describe en el apartado Resoluci√≥n (P√°gina 603).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

601

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

24.0

DISP_REV

DINT

L#80000

Recorrido por vuelta del enc√≥der
Rango de valores admisible:
‚óè 1 ¬µm a 1.000.000.000 ¬µm

Definir los incrementos por vuelta del enc√≥der
Incrementos por vuelta del enc√≥der
El dato m√°quina "Incrementos por vuelta del enc√≥der" indica la cantidad de incrementos que
proporciona un enc√≥der en cada vuelta. A partir de este valor y del dato m√°quina "Recorrido
por vuelta del enc√≥der", el FM x52 calcula la resoluci√≥n.
Enc√≥der incremental
Como entrada (P√°gina 475) es posible indicar cualquier valor dentro del rango de valores. El
m√≥dulo eval√∫a los incrementos en m√∫ltiplos de 4.
Detector de proximidad
Es posible indicar cualquier valor dentro del rango de valores.
Enc√≥der absoluto
Los l√≠mites var√≠an seg√∫n el tipo de enc√≥der:
Tipo de enc√≥der

Longitud/tipo de telegrama

Valores posibles

utilizable como
eje lineal

Enc√≥der monovuel‚Äê
ta

13 bits medio abeto

64 ... 8192 en potencias de 2

Enc√≥der monovuel‚Äê
ta

13 bits alineaci√≥n derecha

64 ... 8192 todos los valores

X

Enc√≥der monovuel‚Äê
ta

25 bits alineaci√≥n derecha

64 ... 225 todos los valores

X

Enc√≥der multivuelta

25 bits abeto

64 ... 8192 en potencias de 2

Enc√≥der multivuelta

25 bits alineaci√≥n derecha

64 ... 224 todos los valores

Escuchar

Abeto

64 ... 8192 en potencias de 2

Escuchar

alineaci√≥n derecha

64 ... 225 todos los valores

25 bits medio abeto

64 ... 8192 en potencias de 2

X

Ajuste especial:
Enc√≥der multivuelta
como enc√≥der mo‚Äê
novuelta

Nota
La cantidad de impulsos de un enc√≥der se calcula a partir de los dos datos "Incrementos por
vuelta del enc√≥der" multiplicado por "N√∫mero de vueltas" (v√©ase el apartado "Resoluci√≥n
(P√°gina 603)").

602

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

32.0

INC_REV

DINT

L#500

Incrementos por vuelta del enc√≥der
Rango de valores admisible:
‚óè 1 a 225
Atenci√≥n:
En el sistema de medida "Impulsos" esta entrada carece de
importancia.

Resoluci√≥n
Resoluci√≥n
La resoluci√≥n es una medida para la precisi√≥n del procesamiento de levas. Determina tambi√©n
la zona de desplazamiento m√°xima posible.
Para calcular la resoluci√≥n (RES) se procede tal como se indica en la tabla siguiente:

Valores de entra‚Äê
da

Enc√≥der incremental

Enc√≥der absoluto/detector de proximi‚Äê
dad

‚óè Recorrido por vuelta

‚óè Recorrido por vuelta del enc√≥der

‚óè Incrementos por vuelta del enc√≥der: ‚óè Incrementos por vuelta del enc√≥der.
‚Äì

Evaluaci√≥n de impulsos:
Cu√°druple

‚Äì

1 Incremento = 4 Impulsos

C√°lculo

‚Äì

1 Incremento = 1 Impulso

7UD\HFWR
5(6

9XHOWDGHOHQF¬µGHU
,PSXOVRV
9XHOWDGHOHQF¬µGHU

Nota
En el sistema de medida "Impulsos" la resoluci√≥n siempre tiene el valor 1.
Todos los datos de posici√≥n se redondean al m√∫ltiplo entero de la resoluci√≥n. De este modo es
posible diferenciar entre los valores introducidos y los utilizados.

Rango de valores de la resoluci√≥n
Es preciso convertir el rango de valores admitidos de la resoluci√≥n al sistema de medida
subyacente. Con la elecci√≥n de los dos valores "Recorrido por vuelta" e "Incrementos por
vuelta" la resoluci√≥n se define dentro de este rango de valores.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

603

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
El sistema de medida seleccionado determina el margen de valores de la resoluci√≥n:
Sistema de
medici√≥n

Datos en ...

Rango de valores de la resoluci√≥n

mm

10-3 mm

0,1 √ó 10-3 mm .... 1000 √ó 10-3 mm/impulso

pulgadas

10-4 pulgadas

0,1 √ó 10-4 pulgadas .... 1000 √ó 10-4 pulgadas/impulso

grados

10 grados

0,1 √ó 10-4 grados .... 1000 √ó 10-4 grados/impulso

10-3 grados

0,1 √ó 10-3 grados .... 1000 √ó 10-3 grados/impulso

10 grados

0,1 √ó 10-2 grados .... 1000 √ó 10-2 grados/impulso

1 impulso

1

-4

-2

Impulsos

Ejemplo
‚óè Un enc√≥der incremental tiene los datos siguientes:
‚Äì Incrementos por vuelta: 5000
‚Äì Recorrido por vuelta del enc√≥der: 1000 mm
‚Äì 1 incremento = 4 impulsos
De ello resulta la resoluci√≥n (evaluaci√≥n cu√°druple):
5HVROXFL¬µQ

PP
LQFUHPHQWRV




PP
,QFUHPHQWR



PP
LPSXOVRV

PP
,QFUHPHQWR



PP
,PSXOVR

PP
,PSXOVR

‚óè Un enc√≥der SSI tiene los datos siguientes:
‚Äì Incrementos por vuelta: 4096
‚Äì Recorrido por vuelta del enc√≥der: 1000 mm
‚Äì 1 incremento = 1 impulso
De ello resulta la resoluci√≥n:
5HVROXFL¬µQ

PP
LQFUHPHQWRV



Dependencia entre la zona de desplazamiento y la resoluci√≥n
La zona de desplazamiento est√° limitada por la representaci√≥n num√©rica en el FM x52. Esta
representaci√≥n num√©rica var√≠a en funci√≥n de la resoluci√≥n. Por ello, al definir valores hay que
procurar mantenerse siempre dentro de los l√≠mites admitidos.
La siguiente tabla muestra la zona de desplazamiento m√°xima:

604

Resoluci√≥n (RES) dentro de la zona

Zona de desplazamiento m√°xima

0,1 ¬µm/impulso ‚â¶ RES < 1 ¬µm/impulso

-108 ¬µm a 108 ¬µm (-100 m a +100 m)

1 ¬µm/impulso ‚â¶RES ‚â¶ 1000 ¬µm/impulso

-109 ¬µm a 109 ¬µm (-1000 m a +1000 m)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Dependencia de la velocidad de la resoluci√≥n
La velocidad que se muestra puede oscilar dentro de los m√°rgenes que se indican seg√∫n sea
la resoluci√≥n (los datos se expresan en el sistema de medida mm):
‚óè de 1 ¬µm/min a 90 m/min a una resoluci√≥n < 1 ¬µm/impulso
‚óè de 1 ¬µm/min a 900 m/min a una resoluci√≥n ‚â• 1 ¬µm/impulso
La velocidad es calculada y suavizada por el m√≥dulo cada 4 ms.
Tiene por lo menos una imprecisi√≥n de un impulso/4 ms y no resulta adecuada para fines de
regulaci√≥n.

Seleccionar sentido de contaje
Direcci√≥n de contaje
Con el dato m√°quina "Direcci√≥n de contaje" se adapta la direcci√≥n de la captura del recorrido
al sentido del movimiento del eje. Para ello, tenga en cuenta todos los sentidos de giro de los
elementos de transmisi√≥n (como p. ej., acoplamientos y engranajes).
‚óè normal = los impulsos de contaje adelantes (enc√≥der incremental) o valores del sensor
(enc√≥der absoluto) equivalen a los valores de posici√≥n real ascendentes
‚óè invertida = los impulsos de contaje adelantes (enc√≥der incremental) o valores del sensor
(enc√≥der absoluto) equivalen a los valores de posici√≥n real descendentes
Nota:
No se permite un tiempo de anticipaci√≥n en combinaci√≥n con un enc√≥der absoluto (SSI) y con
sentido de contaje invertido.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

Valor inicial

Comentario

59.0

CNT_DIR

BOOL

FALSE

Sentido de contaje
Valores permitidos:
‚óè 0 = normal
‚óè 1 = invertida

Seleccionar vigilancia
Vigilancia
Rotura de hilo

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

605

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
Con la activaci√≥n de la vigilancia, el FM x52 vigila, en el caso de un enc√≥der incremental, las
se√±ales A, /A, B, /B, N y /N. La vigilancia detecta:
‚óè Rotura de hilo
‚óè Cortocircuito de los distintos cables
En los enc√≥ders incrementales sin marcas cero, como alternativa tiene que
‚Äì desconectar la vigilancia de rotura de hilo
‚Äì interconectar externamente las se√±ales N y /N (P√°gina 474)
‚óè Distancia de flancos de los impulsos de contaje
‚óè Corte de la alimentaci√≥n del enc√≥der
Error del telegrama
La monitorizaci√≥n de errores de telegrama en los enc√≥ders absolutos (SSI) no puede
desactivarse. Supervisa:
‚óè el telegrama para ver si hay errores del bit de inicio y del bit de parada
‚óè el tiempo monoestable del enc√≥der conectado
Impulsos err√≥neos (enc√≥der incremental)
Entre dos marcas cero consecutivas, un enc√≥der incremental siempre tiene que proporcionar
el mismo n√∫mero de incrementos.
El FM x52 comprueba si la marca cero de un enc√≥der incremental aparece en el estado
adecuado del enc√≥der.
En el caso de enc√≥ders sin marca cero es preciso desactivar la vigilancia de los impulsos de
error.
Igualmente es preciso desactivar la vigilancia de rotura de hilo o bien interconectar las
entradas de marca cero N y /N de forma externa.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

Valor inicial

Comentarios

63.0

MON_WIRE

BOOL

TRUE

1 = Rotura de hilo

63.1

MON_FRAME

BOOL

TRUE

1 = Error de telegrama (tiene que ser siempre 1)

63.2

MON_PULSE

BOOL

TRUE

1 = Impulsos de error

Vigilancias

606

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Seleccionar datos para el enc√≥der absoluto (SSI)
N√∫mero de vueltas
N√∫mero de vueltas del enc√≥der
El dato m√°quina "N√∫mero de vueltas del enc√≥der" s√≥lo existe en enc√≥ders absolutos. Con √©l
se indica el n√∫mero de vueltas posibles con este enc√≥der. Encontrar√° m√°s informaci√≥n en el
apartado "Enc√≥der absoluto (SSI) (P√°gina 477)".
‚óè Enc√≥der monovuelta
S√≥lo es posible el valor 1.
‚óè Enc√≥der multivuelta
‚Äì Enc√≥der Multivuelta / Escuchar (abeto): 2 ... 4096 en potencias de 2
‚Äì Enc√≥der multivuelta / Escuchar (alineaci√≥n derecha): 1 ... 4096 todos los valores
‚óè Escala lineal
Tambi√©n es posible conectar una escala lineal. Introduzca para ello el valor 1.
El total de pasos del enc√≥der no es un dato m√°quina. Se calcula del modo siguiente:
Total de pasos = Incremento por vuelta x N√∫mero de vueltas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentario

36.0

NO_REV

DINT

L#1024

N√∫mero de vueltas del enc√≥der
Rango de valores admisible:
‚óè 1 (enc√≥der monovuelta)
‚óè 1 a 4096 (enc√≥der multivuelta)

Velocidad de transferencia
Velocidad de transferencia
Con el dato m√°quina "Velocidad de transferencia" se define la velocidad de la transferencia de
datos del enc√≥der SSI al FM x52.
La velocidad de transferencia m√°xima depende de la velocidad de transferencia:
‚óè 320 m ‚Üí 125 kHz
‚óè 160 m ‚Üí 250 kHz
‚óè 63 m ‚Üí 500 kHz
‚óè 20 m ‚Üí 1000 kHz

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

607

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

40.0

BAUDRATE

DINT

L#0

Velocidad de transferencia
Valores permitidos:
‚óè 0 = 125 kHz
‚óè 1 = 250 kHz
‚óè 2 = 500 kHz
‚óè 3 = 1000 kHz

Longitud de telegrama
Longitud de telegrama
Con la "longitud de telegrama" se define el marco de impulsos que emite el FM x52.
Seleccionando "Escuchar", se desactiva el reloj del FM x52. Entonces el FM x52 puede
escuchar tambi√©n otros telegramas SSI con un marco de telegramas de 13 √≥ 25 bits. La
velocidad de la transferencia se basa en la velocidad de reloj del m√≥dulo maestro.

Datos utilizados en el DB de par√°metros
La longitud de telegrama seleccionada aqu√≠ se dispone en el DB de par√°metro con el
dato ENC_TYPE (P√°gina 600).

Sentido del detector de proximidad
Sentido del detector de proximidad
Con el sentido del detector es posible determinar el sentido de un detector de proximidad
conectado:
‚óè Positivo: corresponde al sentido de avance (impulsos de contaje ascendentes)
‚óè Negativo: corresponde al sentido de retroceso (impulsos de contaje descendentes)

608

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Pistas
Seleccionar el modo de control de las salidas de pista
Control de las salidas de pista
Con el dato m√°quina "Control de las salidas de pista" se define el modo de control de las
salidas de pista de las pistas 0 a 15. El control es posible mediante:
‚óè Leva electr√≥nica: Las se√±ales de pista son activadas y desactivadas por el procesamiento
de levas del FM 452.
‚óè CPU: Las se√±ales de pista reproducen directamente los valores correspondientes de las
habilitaciones de pistas en el DB de canal.
De este modo las salidas de pista se pueden controlar directamente desde su programa.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

90.0

TRACK_OUT

WORD

W#16#0

Control de las salidas de pista
Valores permitidos:
‚óè 0 = Leva electr√≥nica
‚óè 1 = CPU
N√∫mero de bit = N√∫mero de pista

Seleccionar pistas especiales
Pistas especiales
Es posible parametrizar las pistas 0, 1 y 2 como pistas especiales.
‚óè Pista 0 y pista 1 como pista de leva de contaje (P√°gina 469)
‚óè Pista 2 como pista de leva de freno (P√°gina 469)

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios
Pistas especiales

99.0

SPEC_TRC0

BOOL

FALSE

1 = Pista 0 es pista de leva de contaje

99.1

SPEC_TRC1

BOOL

FALSE

1 = Pista 1 es pista de leva de contaje

99.2

SPEC_TRC2

BOOL

FALSE

1 = Pista 2 es pista de leva de freno

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

609

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Definir valor de contaje superior para la pista de leva de contaje
Valor de contaje superior pista de leva de contaje
Con este dato m√°quina se define el valor de contaje superior para la pista de leva de contaje
parametrizada.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

100.0

CNT_LIM0

DINT

L#2

104.0

CNT_LIM1

DINT

L#2

Valor de contaje superior para pista de leva de conta‚Äê
je(Pista 0)
Valor de contaje superior para pista de leva de conta‚Äê
je(Pista 1)
Rango de valores admisible:
‚óè 2 ‚Ä¶ 65535

Seleccionar entrada de habilitaci√≥n
Entrada de habilitaci√≥n
La se√±al de pista Q3 a Q10 se activa cuando se cumplen todas las condiciones siguientes:
‚óè La pista est√° habilitada.
‚óè La entrada de habilitaci√≥n externa correspondiente I3 a I10 est√° activada.
‚óè El resultado de pista es = 1.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios
Entrada de habilitaci√≥n

95.0

EN_IN_I3

BOOL

FALSE

‚Ä¶

‚Ä¶

‚Ä¶

‚Ä¶

95.7

EN_IN_I10

BOOL

FALSE

610

1 = La se√±al de pista Pista 3 est√° combinada con la en‚Äê
trada de habilitaci√≥n I3 con la operaci√≥n l√≥gica AND
‚Ä¶
1 = La se√±al de pista Pista 10 est√° combinada con la
entrada de habilitaci√≥n I10 con la operaci√≥n l√≥gica AND

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Leva
Alcance
Alcance
El alcance determina el n√∫mero m√°ximo de levas parametrizables y, con ello, el tiempo de ciclo
de la leva.
Alcance

Tiempo de ciclo de la leva

16 levas

20,48 ¬µs

32 levas

40,96 ¬µs

64 levas

81,92 ¬µs

128 levas

163,84 ¬µs

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

76.0

C_QTY

DINT

UDT3: L#0

0 = m√°x. 16 levas

UDT4: L#1

1 = m√°x. 32 levas

UDT5: L#2

2 = m√°x. 64 levas

UDT6: L#3

3 = m√°x. 128 levas

Alcance

Datos de leva
Datos de leva
Datos de leva
Los datos de leva describen las propiedades de una leva, la asignaci√≥n de cada una de ellas
a una pista y el comportamiento de conmutaci√≥n de la leva.
Los datos de leva que se listan a continuaci√≥n se ajustan por separado para cada leva.
‚óè Validez (P√°gina 612)
‚óè N√∫mero de pista (P√°gina 612)
‚óè Tipo de leva (P√°gina 613)
‚óè Principio y final de la leva para levas de recorrido (P√°gina 613)
‚óè Inicio de leva y tiempo de conexi√≥n para levas de tiempo (P√°gina 614)
‚óè Tiempo de anticipaci√≥n (P√°gina 615)
‚óè Sentido de actuaci√≥n (P√°gina 617)
‚óè Alarma de proceso (P√°gina 619)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

611

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
Por lo general, para el procesamiento de levas se aplica lo siguiente:
‚óè S√≥lo las levas ajustadas como "v√°lidas" son interpretadas y procesadas por el m√≥dulo.
‚óè Las levas 0 ... 7 soportan alarmas de proceso
‚óè La cantidad de levas parametrizables depende del alcance.

Validez de una leva
Leva "v√°lida"
Es preciso activar como v√°lidas todas las levas que deben ser procesadas por la leva
electr√≥nica.
Nota
Configure siempre las levas no utilizadas como "no v√°lidas" (CAMVALID = FALSE).

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

CAMVALID

BOOL

FALSE

1 = Leva "v√°lida"

relativa
+0.0

Definir n√∫mero de pista para una leva
N√∫mero de pista
Al escoger el n√∫mero de pista se define para cada leva la pista en la que dicha leva tiene que
tener efecto.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

TRACK_NO

BYTE

B#16#0

N√∫mero de pista

relativo
+1.0

Rango de valores admisible:
‚óè 0 a 31

612

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Seleccionar tipo de leva
Tipo de leva
Seleccione el tipo de leva deseado.
‚óè Leva de recorrido
‚óè Leva de tiempo

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

CAM_TYPE

BOOL

FALSE

Tipo de leva

relativo
+0.3

Valores permitidos:
‚óè 0 = Leva de recorrido
‚óè 1 = Leva de recorrido

Definir inicio y final de la leva para levas de recorrido
Inicio de leva (IL) / Fin de leva (FL) en levas de recorrido
El inicio y el final de leva definen la longitud de leva en una leva de recorrido.
Longitud m√≠nima de una leva de recorrido
La siguiente figura muestra la leva m√°s corta con sentido de movimiento positivo del eje.
3XOVRVGHWHUPLQDGRVDSDUWLUGH
ODVVH¬≥DOHVGHOHQFRGHU

     
,/ )/

)/

V

,/

V

/HYDP¬£VFRUWD,/ \
)/ 
/HYDP¬£VFRUWDQRDFWLYDVL
,/HVPD\RUTXH)/,/ \
)/ 

Por regla general, rige lo siguiente:
‚óè La parte no activa de una leva siempre tiene que mantener una distancia m√≠nima de 4
impulsos entre el fin de leva (FL) y el inicio de leva (IL).
‚óè En el caso de FL = IL la leva se activa por un impulso.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

613

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

relativo

para levas de recorrido

+2.0

CBEGIN

DINT

L#-100000000

Inicio de leva (IL)

+6.0

CEND

DINT

L#100000000

Fin de leva (FL)
Rango de valores admisible:
‚óè -1.000.000.000 ¬µm a 1 000 000
000 ¬µm

Definir principio de leva y tiempo de conexi√≥n para levas de tiempo
Inicio de leva (IL) / Final de leva (FL) ‚âô Tiempo de conexi√≥n en levas de tiempo
En el caso de una leva de tiempo es preciso definir un inicio de leva y, en lugar del fin de leva,
un tiempo de conexi√≥n. El tiempo de conexi√≥n se define en pasos de 100 ¬µs. El tiempo empieza
a transcurrir a partir de la conexi√≥n de la leva.
Para la definici√≥n de estos tiempos rigen las condiciones siguientes:
‚óè 0 ¬µs: Una leva con el tiempo de conexi√≥n 0 ¬µs no se activa nunca
‚óè 0 ¬µs < t ‚â§ 400 ¬µs: El FM x52 ajusta un tiempo de leva m√≠nimo de unos 330 ¬µs.
‚óè t > 400 ¬µs: El FM x52 calcula el tiempo de conexi√≥n real treal a partir del tiempo de conexi√≥n
especificado tdef seg√∫n la f√≥rmula siguiente:
W
UHDO Q¬ºPHURHQWHUR

W GHI
7LHPSRGHFLFORGH
ODOHYD



7LHPSRGHFLFORGHODOHYD

El error m√°ximo siempre es menor que el tiempo de ciclo de la leva.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

relativo

Comentarios
para levas de tiempo

+2.0

CBEGIN

DINT

L#-100000000

Inicio de leva (IL)

+6.0

CEND

DINT

L#100000000

Final de leva (FL) ‚âô Tiempo de conexi√≥n
Rango admisible de valores para inicio de leva:
‚óè -1.000.000.000 ¬µm a 1 000 000 000 ¬µm
Rango admisible de valores para tiempo de conexi√≥n:
‚óè (0 a 13421) √ó 100 ¬µs con un m√°ximo de 16 levas
‚óè (0 a 26843) √ó 100 ¬µs con un m√°ximo de 32 levas
‚óè (0 a 53686) √ó 100 ¬µs con un m√°ximo de 64 levas
‚óè (0 a 65535) √ó 100 ¬µs con un m√°ximo de 128 levas

614

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Definir tiempo de anticipaci√≥n
Tiempo de anticipaci√≥n
Los retardos de los elementos de maniobra conectados se pueden compensar definiendo un
tiempo de anticipaci√≥n. El tiempo de anticipaci√≥n se define en pasos de 100 ¬µs. Es posible
conceder un tiempo de anticipaci√≥n por leva. El tiempo de anticipaci√≥n es v√°lido para el inicio
y el final de la leva.
Recorrido de anticipaci√≥n
El recorrido de anticipaci√≥n de una leva se calcula continuamente en funci√≥n de la velocidad
actual y del tiempo de anticipaci√≥n. Toda la leva se desplaza ese recorrido en la direcci√≥n del
valor real. El √°rea parametrizada se denomina "√°rea est√°tica" y el √°rea calculada atendiendo
al tiempo de anticipaci√≥n se denomina "√°rea din√°mica".
Recorrido de anticipaci√≥n = tiempo de anticipaci√≥n √ó velocidad actual
El c√°lculo de los recorridos de anticipaci√≥n de todas las levas se realiza dentro de ¬º del tiempo
de anticipaci√≥n m√°s largo parametrizado en el FM x52. Si parametriza un tiempo de
anticipaci√≥n muy prolongado para una leva, el ajuste din√°mico se calcula con menos
frecuencia.
Tiempo de anticipaci√≥n real
El tiempo de anticipaci√≥n real se calcula del modo siguiente:
1. Calcule el tiempo de ciclo de la leva: Es el tiempo en el que el FM x52 ha procesado por
completo todas las levas. Depende del alcance parametrizado.
2. Calcule el tiempo de anticipaci√≥n real con la f√≥rmula siguiente:
7LHPSRGHGLVSRQLELOLGDGUHDO Q¬ºPHURHQWHUR

7LHPSRGHGLVSRQLELOLGDG

7LHPSRGHFLFORGHOD
'

7LHPSRGHFLFORGHODOHYD 

OHYD 

Significados:
‚Äì Tiempo de anticipaci√≥nreales el tiempo de anticipaci√≥n ajustado por el FM x52.
‚Äì Tiempo de anticipaci√≥n D es el tiempo de anticipaci√≥n preseleccionado.
‚Äì N√∫mero entero ( ) significa que para el c√°lculo de lo comprendido entre par√©ntesis s√≥lo
se tiene en cuenta el valor anterior al decimal.
El error m√°ximo del tiempo de anticipaci√≥nreal siempre es menor que el tiempo de ciclo de la leva
√ó 4.
Ejemplo:
Se especifican los valores siguientes:
‚óè Alcance: m√°ximo 32 levas
‚óè Tiempo de ciclo de la leva: 40,96 ¬µs
‚óè Tiempo de anticipaci√≥nD = 1000 ¬µs
Resultado: Se obtiene un tiempo de anticipaci√≥n real de 983 ¬µs.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

615

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Nota
El tiempo de anticipaci√≥n real siempre es menor que el tiempo de anticipaci√≥n parametrizado.
Puede ser 0 aunque el tiempo de anticipaci√≥n parametrizado sea ‚â•100 ¬µs.
El recorrido de anticipaci√≥n en un eje rotativo tiene que ser menor que el √°rea del eje rotativo
y la parte no activa de la leva. Esto tiene que estar garantizado para todas las velocidades.
Nota
No se soporta un tiempo de anticipaci√≥n en relaci√≥n con un enc√≥der absoluto (SSI) ni con una
direcci√≥n de contaje parametrizada como invertida.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

LTIME

INT

0

Tiempo de anticipaci√≥n

relativo
+ 10.0

Rango de valores admisible:
‚óè (0 a 53686) √ó 100 ¬µs con un m√°x. de 16 levas
‚óè (0 a 65535) √ó 100 ¬µs con un m√°x. 32, 64 o 128 levas

Ajuste din√°mico de una leva
Para el rango de la leva se distinguen dos casos:
1. El rango est√°tico y el rango din√°mico de la leva est√°n superpuestos.
2. El rango est√°tico y el rango din√°mico de la leva no est√°n superpuestos.

616

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra para ambos casos el c√°lculo del ajuste din√°mico.
Ajuste din√°mico

Descripci√≥n
,/

6HQWLGRGHOPRYLPLHQWR

)/

9DORUUHDO
/HYDQ

5HFRUULGRGHGLVSRQLELOLGDG
$MXVWHGLQ¬£PLFR

Cuando el rango din√°mico se superpone al rango est√°tico de
la leva, rige lo siguiente:
‚óè Cuando se alcanza el √°rea din√°mica de la leva, √©sta se
activa. Simult√°neamente se bloquea el c√°lculo de un
nuevo ajuste din√°mico.
‚óè Si el valor real alcanza el √°rea est√°tica de la leva, se
vuelve a habilitar el c√°lculo de un ajuste din√°mico nuevo
y un cambio de velocidad act√∫a al final de la leva.
‚óè Si la leva se desactiva al final del √°rea din√°mica, el ajuste
din√°mico vuelve a estar bloqueado hasta el final del √°rea
est√°tica de la leva.

,/

6HQWLGRGHOPRYLPLHQWR
9DORUUHDO
/HYDQ

5HFRUULGRGHGLVSRQLELOLGDG

)/

Cuando el √°rea din√°mica no se superpone al √°rea est√°tica de
la leva, rige lo siguiente:
‚óè Cuando se alcanza el rango din√°mico de la leva, √©sta se
activa. Simult√°neamente se bloquea el c√°lculo de un
nuevo ajuste din√°mico.
‚óè Al final del √°rea est√°tica de la leva se vuelve a habilitar el
ajuste din√°mico.

$MXVWH
GLQ¬£PLFR

√Årea din√°mica
√Årea est√°tica
Es posible un nuevo ajuste din√°mico

Nota
Modificando la direcci√≥n de giro se vuelve a habilitar la determinaci√≥n del ajuste din√°mico.

Selecci√≥n sentido de actuaci√≥n
Sentido de actuaci√≥n
Existen dos sentidos de actuaci√≥n posibles:
‚óè Positivo: la leva se activa al inicio, cuando el eje se desplaza en sentido ascendente
respecto al valor real.
‚óè Negativo: la leva se activa al final, cuando el eje se desplaza en sentido descendente
respecto al valor real.
Es posible tambi√©n ajustar simult√°neamente ambos sentidos de actuaci√≥n.
Si se selecciona "Ninguno" la leva queda sin efecto.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

617

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Comportamiento de conmutaci√≥n de la leva dependiendo del sentido de actuaci√≥n
La siguiente tabla muestra el comportamiento de actuaci√≥n de las levas de recorrido y de
tiempo dependiendo del sentido de actuaci√≥n. Excepto en el ejemplo 5 se parte siempre de un
sentido de actuaci√≥n positivo.
N¬∫
1

2

3

Descripci√≥n

Leva de recorrido

Leva de tiempo

,/

,/

Una leva se rebasa en el sentido de actuaci√≥n

Una leva se rebasa en el sentido contrario al de
actuaci√≥n

Una leva se desplaza en el sentido de actuaci√≥n;
mientras est√° activada, cambia el
sentido del movimiento del eje

)/

,/

)/

,/

)/

,/

7LHPSRGHDFWLYDFL¬µQ

7LHPSRGHDFWLYDFL¬µQ

7LHPSRGHDFWLYDFL¬µQ

,/

[
W
W
7LHPSRGHDFWLYDFL¬µQ[ WW

4

5

Una leva se desplaza en sentido opuesto al de ac‚Äê
tuaci√≥n; en la leva el sentido de movimiento del eje
cambia al sentido de actuaci√≥n

Una leva se desplaza y se abandona en un sentido
cualquiera; el sentido de actuaci√≥n est√° ajustado
para ambas direcciones

La leva no se activa
,/

)/

,/

)/

,/

7LHPSRGHDFWLYDFL¬µQ
[
W
W
W

7LHPSRGHDFWLYDFL¬µQ[ WWW

Leva parametrizada
Leva activada

618

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

+0.1

EFFDIR_P

BOOL

TRUE

1 = Sentido de actuaci√≥n positivo (+)

+0.2

EFFDIR_M

BOOL

TRUE

1 = Sentido de actuaci√≥n negativo (-)

relativo

Seleccionar alarma de proceso para levas
Alarma de proceso al activar/desactivar levas
Para las levas 0 a 7 se puede definir si, al conectar, desconectar o al conectar y desconectar
la leva, debe generarse una alarma de proceso.

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

+0.4

PI_SW_ON

BOOL

FALSE

1 = Alarma de proceso al activar

+0.5

PI_SW_OFF

BOOL

FALSE

1 = Alarma de proceso al desactivar

relativo

Habilitar alarma de proceso
Habilitar las alarmas de proceso
Habilitar las alarmas de proceso
Los datos m√°quina permiten habilitar alarmas de proceso.
Es posible ajustar cu√°ndo deben generarse las alarmas de proceso:
‚óè Comienzo de la medici√≥n
En el ajuste "Captura de bordes (P√°gina 575)", un flanco ascendente de la entrada digital
I1 puede iniciar una alarma de proceso.
‚óè Fin de la medici√≥n
Tanto en el ajuste "Captura de bordes (P√°gina 575)" como en el ajuste "Medici√≥n de
longitud (P√°gina 575)", un flanco ascendente de la entrada digital I1 puede iniciar una
alarma de proceso.
‚óè Leva activa / inactiva
En los datos de leva (P√°gina 619) es posible establecer si se tienen que generar alarmas
de proceso al activar y/o desactivar las levas 0 a 7.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

619

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de par√°metros
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

3.1

PI_MEND

BOOL

FALSE

1 = Habilitar la alarma de proceso: Fin de la medici√≥n

3.2

PI_CAM

BOOL

FALSE

1 = Habilitar la alarma de proceso: Leva activa / inactiva

3.5

PI_MSTRT

BOOL

FALSE

1 = Habilitar la alarma de proceso: Comienzo de la medici√≥n

Evaluaci√≥n de una alarma de proceso
Cuando el FM 452 dispara una alarma de proceso, en las variables OB4x_POINT_ADDR del
OB de alarma de procesos se encuentra disponible la informaci√≥n sobre alarmas.
La tabla siguiente muestra el formato del tipo de datos OB4x_POINT_ADDR:
Byte

Bit 7

Bit 6

Bit 5

Bit 4

Bit 3

Bit 2

Bit 1

Bit 0

0

0

0

0

0

0

0

0

0

1

0

0

Comien‚Äê
zo de la
medici√≥n

0

0

Leva

Fin de la
medici√≥n

0

2

Leva 7
activa

Leva 7
inactiva

Leva 6
activa

Leva 6
inactiva

Leva 5
activa

Leva 5
inactiva

Leva 4
activa

Leva 4
inactiva

3

Leva 3
activa

Leva 3
inactiva

Leva 2
activa

Leva 2
inactiva

Leva 1
activa

Leva 1
inactiva

Leva 0
activa

Leva 0
inactiva

La causa de la alarma se puede consultar en el byte 1.
‚óè Leva:
Eval√∫e los bytes 2 y 3 seg√∫n la tabla.
‚óè Comienzo / Final de la medici√≥n:
Con la instrucci√≥n CAM_MSRM_452 es posible leer los valores de medici√≥n actuales del
m√≥dulo.

Alarmas de proceso perdidas
Si una alarma de proceso todav√≠a no se ha terminado de procesar en el OB de alarma de
proceso, el m√≥dulo memoriza todos los eventos siguientes de alarma de proceso. Si vuelve a
aparecer un evento antes de que la alarma de proceso se haya podido disparar, el m√≥dulo
disparar√° la alarma de diagn√≥stico "Alarma de proceso perdida".

Interfaz de control y realimentaci√≥n del FM 452
Aplicaci√≥n
En aplicaciones especiales o en el nivel de las alarmas es preciso un acceso especialmente
r√°pido a las se√±ales de respuesta y de control. Estos datos se alcanzan directamente por
medio de las √°reas de entrada y salida del m√≥dulo.

620

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
Para coordinar el arranque cada vez que arranca el m√≥dulo (p. ej. tras insertar el m√≥dulo o
despu√©s de una transici√≥n STOP-RUN de la CPU), la instrucci√≥n CAM_CTRL debe llamarse
hasta que se muestre el final del arranque a trav√©s de RETVAL = 0.
Nota
Para acceder directamente a los datos del FM 452 s√≥lo se deben emplear los datos no internos
aqu√≠ descritos del modo indicado. De lo contrario, el acceso de su programa de usuario al
m√≥dulo puede sufrir anomal√≠as.

Leer se√±ales de respuesta mediante acceso directo
Las direcciones de byte se indican de forma relativa con respecto a la direcci√≥n de salida del
m√≥dulo. Los nombres de los par√°metros corresponden a los nombres del DB de canal.
En AWL se accede a los datos con los comandos PEB (leer 1 byte) y PED (leer 4 bytes).
Direcci√≥n

N√∫mero de bit
7

6

5

4

3

2

1

0

Byte 0

PARA

interno

interno

DATA_ERR

interno

DIAG

interno

interno

Byte 1

0

0

0

CAM_ACT

0

0

0

0

GO_M

MSR_DONE

SYNC

Byte 2
Byte 3

interno
0

0

FVAL_DONE

HYS

GO_P

Byte 4

ACT_POS

Byte 5
Byte 6
Byte 7
Byte 8

TRACK_OUT

Byte 9
Byte 10
Byte 11

Escribir las se√±ales de control mediante acceso directo
Las direcciones de byte se indican de forma relativa respecto a la direcci√≥n de entrada del
m√≥dulo. Los nombres de los par√°metros corresponden a los nombres del DB de canal.
En AWL se accede a los datos con los comandos PAB (escribir 1 byte) y PAW (escribir 2 bytes).
Direcci√≥n

N√∫mero de bit
7

6

5

Byte 0
Byte 1

4

3

2

1

0

DIR_P

DIR_M

0

0

interno
0

Byte 2

CNTC1_EN

CNTC0_EN

CAM_EN
TRACK_EN

Byte 3

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

621

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Ejemplo: Valor real de posici√≥n ACT_POS
La direcci√≥n inicial del m√≥dulo es 512.
AWL
L PED 516

//Leer el valor real de posici√≥n (ACT_POS) con acceso directo:
//Direcci√≥n inicial del m√≥dulo + 4

V√≠as de transferencia de par√°metros
Se entiende por par√°metros los datos m√°quina y los datos de leva que siguen a continuaci√≥n.
La figura siguiente muestra las v√≠as de transferencia de par√°metros al FM 452.

622

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

3*3&
RIIOLQH

&DUJDU
,QWHUID]GH
SURJUDPDFL¬µQ

)0

&38
RQOLQH



E
'%



D

'%

D


&DUJDUHQOD3*

E






3URJUDPD
GHXVXDULR




&$0B&75/

+:&RQILJ

3DU¬£PHWURV
'DWRV
P¬£TXLQD
\GHOHYD




'DWRVGH
VLVWHPD
6'%

D
&DUJDU

'DWRVGH
VLVWHPD
6'%



1

Guardar los par√°metros en la interfaz de parametrizaci√≥n.

2

Guardar, compilar y cargar la configuraci√≥n de hardware en la CPU.

3

La CPU escribe los par√°metros en el m√≥dulo en parametrizaciones de sistema.

4

Cargar los par√°metros del m√≥dulo en la programadora con el comando "Cargar sistema de
destino en PG".

5

Cargar los par√°metros en el m√≥dulo desde la interfaz de parametrizaci√≥n con el comando "Car‚Äê
gar sistema de destino".

6

Escribir los par√°metros en el m√≥dulo con tareas del programa de usuario.

7

Leer los par√°metros desde el m√≥dulo con tareas del programa de usuario.

8

Almacenar par√°metros del programa de usuario en el DB Online.

9

Leer par√°metros del DB Online en el programa de usuario.

10

Exportar par√°metros desde la interfaz de parametrizaci√≥n hasta el DB (DB Offline o DB Online);
posteriormente, tambi√©n debe cargarse un DB Offline en la CPU.

11

Importar par√°metros de un DB Online o DB Offline a la interfaz de parametrizaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

623

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Casos de aplicaci√≥n de la transferencia de par√°metros
Caso de aplicaci√≥n

Pasos

Los par√°metros se editan con la interfaz de parametrizaci√≥n. A con‚Äê Ejecute los pasos 1, 2 y 3.
tinuaci√≥n, el m√≥dulo se tiene que parametrizar autom√°ticamente en
el arranque.
Los par√°metros se modifican durante la puesta en servicio en el mo‚Äê Ejecute los pasos 4 y 5
do Test en la interfaz de parametrizaci√≥n.
Los par√°metros modificados durante la puesta en servicio se tienen
que cargar autom√°ticamente durante el arranque.

Ejecute los pasos 1, 2 y 3.

Los par√°metros se crean con la interfaz de parametrizaci√≥n. En el
arranque, el m√≥dulo s√≥lo se debe parametrizar con el programa de
usuario mediante bloques de datos.

Ejecute los pasos 10 y 6.

Para crear c√≥modamente datos de reserva para recetas.

Ejecute el paso 10.

Los par√°metros se crean con la interfaz de parametrizaci√≥n. √âstos
tienen que estar a disposici√≥n del programa de usuario para modifi‚Äê
caciones provisionales.

Ejecute los pasos 1, 2 y 3 para
la parametrizaci√≥n autom√°tica.
Ejecute los pasos 10 y 7 para el
acceso por medio del programa
de usuario.

Los par√°metros existentes se modifican (exclusivamente) con el pro‚Äê Ejecute los pasos 7, 9, 8 y 6.
grama de usuario.
Para ver los datos modificados por el programa de usuario con la
interfaz de parametrizaci√≥n.

Ejecute el paso 11.

Los par√°metros modificados por el programa de usuario se tienen
que cargar autom√°ticamente tambi√©n en el arranque.

Ejecute los pasos 6, 11, 1, 2 y 3.

2.1.4.5

Puesta en servicio del FM 452

2.1.4.6

Uso del FM 452 desde el programa de usuario

Inclusi√≥n del FM 452 en un programa de usuario
Para integrar el FM 452 en un programa de usuario pueden utilizarse instrucciones que le
facilitar√°n en lo posible el manejo de las funciones deseadas:
Las instrucciones CAM_INIT y CAM_CTRL o CAM_CTRL_452 se activan en el programa de
usuario de la CPU. √âstas realizan la comunicaci√≥n entre la CPU y el FM 452.
Si integra la instrucci√≥n CAM_CTRL en el proyecto, el DB de canal se crear√° autom√°ticamente
como DB de instancia en la instrucci√≥n CAM_CTRL.
Si integra la instrucci√≥n CAM_CTRL_452 en el proyecto, entonces deber√° insertar en su
programa como DB de canal un bloque de datos del tipo CAM_CHANTYPE mediante "Bloques
de programa > Agregar bloque".
Todos los datos de par√°metros pertenecientes a un canal del m√≥dulo (datos m√°quina, datos
leva) se encuentran en el DB de par√°metros del m√≥dulo. Inserte un bloque de datos del tipo

624

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
CAM_PxxxTYPE en el proyecto mediante "Bloques de programa > Agregar bloque".
Dependiendo del alcance se requieren los siguientes tipos de DB:
‚óè Hasta 16 levas: CAM_P016TYPE
‚óè Hasta 32 levas: CAM_P032TYPE
‚óè Hasta 64 levas: CAM_P064TYPE
‚óè Hasta 128 levas: CAM_P128TYPE
La instrucci√≥n CAM_MSRM_452 se utiliza para la evaluaci√≥n inmediata de los datos de
medici√≥n de la medici√≥n de longitud o de la captura de bordes de un FM 452 en el OB de la
alarma de proceso.
Adem√°s, para el FM 452 se puede utilizar tambi√©n la instrucci√≥n CAM_DIAG o
CAM_DIAG_452, que permite transferir informaciones de diagn√≥stico al DB de diagn√≥stico.
Si integra la instrucci√≥n CAM_DIAG en el proyecto, el DB de diagn√≥stico se crear√°
autom√°ticamente como DB de instancia en la instrucci√≥n CAM_DIAG.
Si integra la instrucci√≥n CAM_DIAG_452 en el proyecto, entonces deber√° insertar en el
programa como DB de diagn√≥stico un bloque de datos del tipo CAM_DIAGTYPE mediante
"Bloques de programa > Agregar bloque".

Puesta en servicio del m√≥dulo
Incluso sin programa de usuario es posible realizar un primer test del m√≥dulo con el cuadro de
di√°logo "Puesta en servicio". Tenga en cuenta particularmente la advertencia siguiente.
ADVERTENCIA
Se pueden producir da√±os personales y materiales.
Para evitar da√±os personales y materiales observe los puntos siguientes:
‚óè Instale un interruptor de PARADA DE EMERGENCIA en las inmediaciones del equipo.
S√≥lo as√≠ puede garantizarse que en caso de un fallo del software o del equipo sea posible
desconectar la instalaci√≥n de modo seguro.
‚óè Instale finales de carrera por hardware que act√∫en directamente en las etapas de potencia
de todos los accionamientos.
‚óè Aseg√∫rese de que ninguna persona tenga acceso al √°rea de la instalaci√≥n donde hay
piezas en movimiento.
‚óè Si controla y vigila paralelamente el FM 452 desde el programa y desde el cuadro de
di√°logo "Puesta en servicio" pueden producirse conflictos cuyos efectos no est√°n
definidos. Por lo tanto, conmute siempre la CPU al estado STOP cuando trabaje con el
cuadro de di√°logo "Puesta en servicio" o bien desactive el programa.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

625

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

2.1.4.7

FM 452: Diagn√≥stico online

Informaci√≥n actual sobre el m√≥dulo
Diagn√≥stico est√°ndar
Indicaci√≥n de errores mediante los diodos de error del FM 452
¬øD√≥nde se indica el error?
Los diodos rojos de error del m√≥dulo indican diferentes estados de error. Los LED se
encienden tambi√©n en caso de errores que aparecen brevemente, por lo menos, durante 3 s.
En la figura siguiente se muestra la posici√≥n de los diodos de error en el FM 452.
,17)
(;7)

626

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

¬øQu√© errores se indican?
La tabla siguiente contiene los tipos de error que se indican mediante los diodos de error.
LED

Significado

Explicaci√≥n

INTF

Error de grupo pa‚Äê Este diodo indica los siguientes estados de error del FM 452:
ra errores internos ‚óè Alarma de proceso perdida
‚óè Vigilancia de tiempo transcurrida
‚óè FM 452 no configurado
‚óè FM 452 parametrizado con errores
Para eliminar el error, ver Clases de error (P√°gina 632).

EXTF

Error de grupo pa‚Äê Este LED indica los siguientes estados de error:
ra errores externos ‚óè Falta tensi√≥n auxiliar externa de 24 V
‚óè Falta conector frontal
‚óè Rotura de hilo enc√≥der
‚óè Fallo operativo
‚óè Error de telegrama enc√≥der absoluto
‚óè Error en se√±al enc√≥der incremental o falta marca cero

INTF + EXTF

M√≥dulo defectuo‚Äê
so

Todas las salidas se desconectan. El m√≥dulo debe ser sustituido.

Diagn√≥stico espec√≠fico de canal
Disparo de alarmas de diagn√≥stico
Procesamiento de las alarmas
El FM 452 puede disparar alarmas de proceso y de diagn√≥stico. Estas alarmas se procesan en
un OB de alarma. Cuando se dispara una alarma sin que se encuentre cargado el OB
correspondiente, la CPU pasa a STOP.
Para habilitar las alarmas de diagn√≥stico se procede del modo siguiente:
1. Seleccione el m√≥dulo en HWCN
2. Habilite la alarma de diagn√≥stico en Edici√≥n > Propiedades del objeto > Par√°metros
b√°sicos.
3. Guardar y compilar la configuraci√≥n.
4. Cargue la configuraci√≥n en la CPU

Visi√≥n de conjunto de las alarmas de diagn√≥stico
Los eventos y errores siguientes disparan una alarma de diagn√≥stico:
‚óè Fallo operativo
‚óè Datos m√°quina err√≥neos

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

627

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
‚óè Datos de levas err√≥neos
‚óè Error de diagn√≥stico
Estos errores se describen con detalle en el apartado "Clases de error (P√°gina 632)".

Reacci√≥n del m√≥dulo en caso de error con alarma de diagn√≥stico
‚óè El procesamiento de levas se desactiva.
‚óè Con las alarmas de diagn√≥stico siguientes se borra la sincronizaci√≥n:
‚Äì Falta conector frontal, falta tensi√≥n auxiliar externa
‚Äì se ha detectado un error de se√±al cero, error de l√≠nea (se√±ales de enc√≥der de 5 V)
‚Äì se ha rebasado la zona de desplazamiento (se notifica con un error de operador)
‚Äì Ajustar valor real no se puede ejecutar (se notifica con un error de operador)
‚óè Las se√±ales de control dejan de procesarse excepto en un caso.
Excepci√≥n:
En caso de desbordamiento del final de carrera por software todav√≠a es posible un cambio
de sentido en el modo de simulaci√≥n.
‚óè Los selectores de funci√≥n y las tareas se contin√∫an procesando.

El m√≥dulo detecta un fallo ("entrante")
Una alarma de diagn√≥stica es "entrante" cuando por lo menos hay un error en cola de espera.
Si no se han solventado todos los fallos los dem√°s que queden en cola de espera, se
notificar√°n de nuevo como "entrantes".
Secuencia:
1. El FM 452 detecta uno o varios fallos y dispara una alarma de diagn√≥stico. El LED de error
se enciende. El error se registra en el b√∫fer de diagn√≥stico.
2. El sistema operativo de la CPU solicita el OB de alarma de diagn√≥stico, por ejemplo, OB 82.
3. Es posible evaluar la informaci√≥n de inicio del OB 82.
4. Con el par√°metro OB82_MOD_ADDR se lee qu√© m√≥dulo ha disparado la alarma.
5. Encontrar√° m√°s informaci√≥n si llama la instrucci√≥n CAM_DIAG o CAM_DIAG_452.

El m√≥dulo detecta el paso al estado libre de fallos ("saliente")
Una alarma s√≥lo es "saliente" cuando se ha eliminado el √∫ltimo error del m√≥dulo.
Secuencia:
1. El FM 452 detecta que todos los fallos han sido eliminados y dispara una alarma de
diagn√≥stico. El LED de error est√° apagado. El b√∫fer de diagn√≥stico no se modifica.
2. El sistema operativo de la CPU solicita el OB de alarma de diagn√≥stico, por ejemplo, OB 82.
3. Con el par√°metro OB82_MOD_ADDR se lee qu√© m√≥dulo ha disparado la alarma.
4. Eval√∫e el bit OB82_MDL_DEFECT.
Si este bit es "0", no hay errores en el m√≥dulo. Su evaluaci√≥n puede finalizar aqu√≠.

628

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Alarmas de diagn√≥stico seg√∫n el estado de la CPU
‚óè En estado STOP de la CPU las alarmas de diagn√≥stico est√°n bloqueadas por el FM 452.
‚óè Si con la CPU en estado STOP no se eliminan todos los fallos pendientes, el FM 452 vuelve
a notificar como "entrantes" los errores todav√≠a no eliminados tras la transici√≥n al estado
RUN.
‚óè Si se eliminan todos los errores pendientes con la CPU en estado STOP, el estado libre de
errores del FM 452no se notificar√° con una alarma de diagn√≥stico tras la transici√≥n al
estado RUN.

Evaluaci√≥n de errores en el programa de usuario
Reacci√≥n de errores en el programa de usuario
En el programa de usuario es posible reaccionar de forma precisa a los errores que aparecen.
Para ello se dispone de los siguientes recursos:
‚óè Los valores de retorno RET_VAL de las instrucciones integradas como indicador de grupo
de los errores que han aparecido durante el transcurso de las instrucciones.
‚óè Los bits de error _ERR de las peticiones como indicador de grupo de errores que se han
producido durante la ejecuci√≥n de una petici√≥n.
‚óè El bit de error DATA_ERR como indicador de grupo de un error que el FM 452 ha detectado
durante una petici√≥n de escritura.
‚óè La identificaci√≥n de errores en JOB_ERR de la causa de error en la comunicaci√≥n entre la
instrucci√≥n y el FM 452.
‚óè La instrucci√≥n CAM_DIAG o CAM_DIAG_452 para leer el b√∫fer de diagn√≥stico del FM 452.
Aqu√≠ es posible averiguar las causas de error de las peticiones y los eventos as√≠ncronos
(fallos operativos y errores de diagn√≥stico).
‚óè Alarma de diagn√≥stico para una respuesta r√°pida a eventos.

B√∫fer de diagn√≥stico del m√≥dulo
Eventos de diagn√≥stico
El b√∫fer de diagn√≥stico del m√≥dulo contiene como m√°ximo 4 eventos de diagn√≥stico y est√°
organizado como b√∫fer anular.
Un evento de diagn√≥stico se escribe en el b√∫fer cuando se detecta un aviso (de error) entrante.
Esto puede ser un aviso, un error is√≥crono (error de datos) o incluso un error as√≠ncrono (error
de servicio y error de diagn√≥stico). De una causa de un error pueden surgir tambi√©n varias
entradas como errores consiguientes. Los avisos salientes no generan entradas en el b√∫fer de
diagn√≥stico.
Para cada evento de diagn√≥stico se indican:
‚óè Estado (siempre entrante)
‚óè Error interno

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

629

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
‚óè Error externo
‚óè Clase de error
‚óè N√∫mero de error
‚óè N√∫mero de canal
‚óè N√∫mero de levas (si hay errores de datos de levas)
Cuando se escribe un evento de diagn√≥stico en el b√∫fer de diagn√≥stico, la se√±al de
realimentaci√≥n DIAG = 1 se activa.
El b√∫fer de diagn√≥stico puede transferirse como un todo con la instrucci√≥n CAM_DIAG o
CAM_DIAG_452 a un bloque de datos (DB de diagn√≥stico) o a trav√©s de un cuadro de di√°logo
de evaluaci√≥n de errores del software de configuraci√≥n. Si se lee el b√∫fer de diagn√≥stico, el
m√≥dulo activa la se√±al de realimentaci√≥n DIAG = 0.
Nota
Si el b√∫fer de diagn√≥stico se lee al mismo tiempo con la instrucci√≥n CAM_DIAG o
CAM_DIAG_452 y el cuadro de di√°logo de evaluaci√≥n de errores, puede ocurrir que uno de los
eventos de diagn√≥stico que se ha producido no sea detectado por el programa.

Datos y estructura del DB de diagn√≥stico
Datos y estructura del DB de diagn√≥stico
Nota
Los datos que no se indican en esta tabla no deben ser modificados.

La tabla siguiente muestra la estructura del DB de diagn√≥stico.
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

0.0

MOD_ADDR
(registrar)

INT

0

Direcci√≥n del m√≥dulo

256.0

JOB_ERR

INT

0

Error de comunicaci√≥n

258.0

JOBBUSY

BOOL

FALSE

1 = Petici√≥n activa

258.1

DIAGRD_EN

BOOL

FALSE

1 = Leer el b√∫fer de diagn√≥stico necesaria‚Äê
mente

260.0

DIAG_CNT

INT

0

N√∫mero de entradas v√°lidas de la lista

262.0

DIAG[1]

STRUCT

Entrada m√°s reciente de datos de diagn√≥s‚Äê
tico

272.0

DIAG[2]

STRUCT

Segunda entrada de datos de diagn√≥stico

282.0

DIAG[3]

STRUCT

Tercera entrada de datos de diagn√≥stico

292.0

DIAG[4]

STRUCT

√öltima entrada de datos de diagn√≥stico

630

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra la estructura de una entrada de diagn√≥stico DIAG[n].
Direcci√≥n

Nombre

Tipo

valor inicial

Comentarios

+0.0

STATE

BOOL

FALSE

0 = Evento saliente
1 = Evento entrante

+0.1

INTF

BOOL

FALSE

1 = Error interno

+0.2

EXTF

BOOL

FALSE

1 = Error externo

+2.0

FCL

INT

0

Clase de error
1: Fallo operativo
4: Fallo de datos
5: Fallo de datos m√°quina
7: Fallo de datos de leva
15: Avisos
128: Error de diagn√≥stico

+4.0

FNO

INT

0

N√∫mero de error 0 a 255

+6.0

CH_NO

INT

0

N√∫mero de canal (siempre 1)

+8.0

CAMNO

INT

0

N√∫mero de leva de 0 a 127 con clase de error = error de datos de
leva

Lista de los avisos JOB_ERR
Avisos JOB_ERR
JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

80A0

32928

-32608

Acuse negativo al leer el m√≥dulo. M√≥dulo extra√≠do durante la lectura o m√≥‚Äê
dulo defectuoso.

80A1

32929

-32607

Acuse negativo al escribir en el m√≥dulo. M√≥dulo extra√≠do durante la escritura
o m√≥dulo defectuoso.

80A2 1)

32930

-32606

Error de protocolo en la capa 2 (transferencia de datos dentro de PROFI‚Äê
NET / PROFIBUS DP interrumpida, p. ej. por rotura de hilo, ausencia de
conector de cierre, error de parametrizaci√≥n, etc.)

80A3 1)

32931

-32605

Error de protocolo en User-Interface/User (transferencia de datos dentro de
PROFINET / PROFIBUS DP interrumpida, p. ej. por rotura de hilo, ausencia
de conector de cierre, error de parametrizaci√≥n, etc.)

80A4 1)

32932

-32604

Anomal√≠a en la comunicaci√≥n del bus K

80B1

32945

-32591

Indicaci√≥n de longitud err√≥nea. Par√°metro FM_TYPE del DB de canal para el
m√≥dulo utilizado no activado correctamente.

80B2

32946

-32590

El slot configurado no est√° ocupado.

32947

-32589

El tipo de m√≥dulo real no es igual al tipo de m√≥dulo te√≥rico.

80B3
1)

32960

-32576

El m√≥dulo a√∫n no tiene preparados los datos que hay que leer.

80C1 1)

80C0

32961

-32575

Los datos de una tarea de escritura semejante todav√≠a no se han procesado
en el m√≥dulo.

80C2 1)

32962

-32574

El m√≥dulo procesa de instante el n√∫mero m√°ximo posible de peticiones.

80C3

1)

32963

-32573

Los recursos necesarios (memoria, etc.) est√°n ocupados de instante.

80C4

1)

32964

-32572

Error de comunicaci√≥n

80C5 1)

32965

-32571

La periferia descentralizada no est√° disponible.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

631

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

80C6 1)

32966

-32570

Cancelaci√≥n de las clases de prioridad (rearranque normal o en segundo
plano)

8522

34082

-31454

DB del canal o DB de par√°metros demasiado corto. No se pueden leer los
datos del DB. (Petici√≥n de escritura)

8532

34098

-31438

El n√∫mero de DB del DB de par√°metros es demasiado grande. (Petici√≥n de
escritura)

853A

34106

-31430

DB de par√°metros no presente. (Petici√≥n de escritura)

8544

34116

-31420

Error en el en√©simo (n > 1) acceso de lectura a un DB tras un error. (Petici√≥n
de escritura)

8723

34595

-30941

DB del canal o DB de par√°metros demasiado corto. No se pueden escribir los
datos en el DB. (Petici√≥n de lectura)

8730

34608

-30928

DB de par√°metros protegido contra escritura en la CPU No se pueden es‚Äê
cribir los datos en el DB (petici√≥n de lectura)

8732

34610

-30926

El n√∫mero de DB del DB de par√°metros es demasiado grande. (Petici√≥n de
lectura)

873A

34618

-30918

DB de par√°metros no presente. (Petici√≥n de lectura)

8745

34629

-30907

Error en el en√©simo (n > 1) acceso de escritura a un DB tras un error. (Peti‚Äê
ci√≥n de lectura)

1)

Los errores 80A2 a 80A4 as√≠ como 80Cx son temporales, es decir, se pueden eliminar tras un tiempo de espera sin la
intervenci√≥n del usuario. Los avisos con la estructura 7xxx indican situaciones temporales de la comunicaci√≥n.

Clases de error
Fallo operativo
Clase de error 1: Fallo operativo
Los fallos operativos se detectan de forma as√≠ncrona respecto a un control.
La tabla siguiente muestra los fallos operativos posibles y sus causas.
N¬∫

Significado

1

Rebase del inicio del final de carrera por software

S√≠

2

Rebase del fin del final de carrera por software

S√≠

3

Rebase del inicio de la zona de desplazamiento

S√≠

4

Rebase del fin de la zona de desplazamiento

S√≠

Ajustar valor real al vuelo no ejecutable

S√≠

13

Causa

Alarma de diag‚Äê
n√≥stico

Los finales de carrera por software, tras ajustar valor real al vuelo, se en‚Äê
cuentran fuera de la zona de desplazamiento
(-100 m...+100 m o -1.000 m...+1.000 m).
El decalaje resultante de Ajustar valor real / Ajustar valor real al vuelo es
mayor que ¬±100 m o ¬±1.000 m.

Efecto

632

Eje no sincronizado.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas

Error de datos
Clase de error 4: Error de datos
Los errores de datos se detectan de forma s√≠ncrona respecto a un control/mando.
La tabla siguiente muestra los errores de datos posibles y sus causas.
N¬∫

Significado

10

Decalaje de se√±al cero err√≥neo
Causa

Alarma de diag‚Äê
n√≥stico
No

El decalaje de se√±al cero es mayor que ¬± 100 m o ¬± 1.000 m.
Los finales de carrera por software, tras ajustar el decalaje de se√±al cero, se
encuentran fuera de la zona de desplazamiento
(-100 m...+100 m o -1.000 m...+1.000 m).
Eje rotativo: El valor del decalaje de se√±al cero es mayor que el final del eje
rotativo.

11

Indicaci√≥n del valor real err√≥nea
Causa

no

Eje lineal: La coordenada se encuentra fuera del final de carrera por soft‚Äê
ware actual (que puede estar desplazado).
Eje rotativo: La coordenada es < 0 o mayor que el final del eje rotativo.

12

Punto de referencia err√≥neo
Causa

no

Eje lineal: La coordenada se encuentra fuera del final de carrera por soft‚Äê
ware actual (que puede estar desplazado).
Eje rotativo: La coordenada es < 0 o mayor que el final del eje rotativo.

20

Activar datos m√°quina no admisible
Causa

21

27

En el m√≥dulo no hay datos m√°quina nuevos (sin errores)

Ajustar valor real al vuelo no admisible
Causa

no

Se ha intentado ejecutar "Ajustar valor real al vuelo" teniendo "Redisparar
punto de referencia" activado.

Ajuste codificado en bits no permitido
Causa

no

no

Los bits no utilizados y no descritos aqu√≠ son distintos a 0.
Se ha intentado seleccionar simult√°neamente" Medici√≥n de longitud" y
"Captura de bordes".

28

Redisparar el punto de referencia no admisible
Causa

no

Se ha intentado ejecutar "Redisparar el punto de referencia" estando "Ajus‚Äê
tar valor real al vuelo" pendiente.
Se ha intentado ejecutar "Redisparar el punto de referenciao" con un enc√≥‚Äê
der SSI.

29

Comando codificado en bits no permitido
Causa

no

Los bits no utilizados y no descritos aqu√≠ son distintos a 0.

30

Tiempo de anticipaci√≥n err√≥neo

no

31

N√∫mero de leva err√≥neo

no

Causa

La leva no es v√°lida.
El n√∫mero de leva no se encuentra en el rango 0..127.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

633

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
N¬∫

Significado

32

Inicio de leva err√≥neo
Causa

Alarma de diag‚Äê
n√≥stico
no

El inicio de leva se encuentra fuera de la zona de desplazamiento
(-100 m...+100 m √≥ -1000 m...+1000 m).
Eje rotativo: El principio de leva es < 0 o mayor que el final del eje rotativo.

33

Fin de leva err√≥neo / Tiempo de activaci√≥n err√≥neo
Causa

no

El fin de leva se encuentra fuera de la zona de desplazamiento
(-100 m...+100 m √≥ -1000 m...+1000 m).
Eje rotativo: El final de leva es < 0 o mayor que el final del eje rotativo.
La leva no est√° activada por lo menos en la duraci√≥n de un impulso.
En una leva invertida no hay una distancia m√≠nima de 4 impulsos entre inicio
de leva y fin de leva.

34

No es posible cancelar la activaci√≥n del valor real
Causa

35

no

Con un enc√≥der SSI y un eje l√≠neal, tras la ejecuci√≥n del ajuste el valor real
de posici√≥n se encontrar√≠a fuera de la zona de trabajo.

Indicaci√≥n del valor real err√≥nea al Ajustar valor real / Ajustar valor real al vuelo
Causa

no

La indicaci√≥n del valor real se encuentra fuera del margen num√©rico admi‚Äê
sible de ¬± 100 m √≥ ¬± 1.000 m.
Tras la ejecuci√≥n del ajuste, los finales de carrera por software se encon‚Äê
trar√≠an fuera de la zona de desplazamiento
(-100 m...+1000 m √≥ -1.000 m...+1.000 m).
El decalaje resultante de Ajustar valor real / Ajustar valor al vuelo ser√≠a
mayor que ¬±100 m √≥ ¬±1.000 m.

107

Eje no parametrizado
Causa

no

En el eje no hay ning√∫n dato m√°quina disponible.
En el eje no hay ning√∫n dato m√°quina activado.

108

Eje no sincronizado
Causa

no

Uno de los ajustes "Ajustar valor real" o "Ajustar valor real al vuelo" se ha
activado a pesar de que el eje no est√° sincronizado.

109

Procesamiento de levas en curso.

no

110

N√∫mero err√≥neo de levas a modificar

no

Error de datos m√°quina
Clase de error 5: Error de datos m√°quina
La alarma de diagn√≥stico s√≥lo se disparar√° con un m√≥dulo de datos del sistema (SDB) con
errores.
La tabla siguiente muestra errores de datos m√°quina posibles y sus causas.
N¬∫

Significado

Alarma de
diagn√≥stico

5

Error en el ajuste de la alarma de proceso

S√≠

Causa

634

Ha intentado seleccionar una alarma de proceso que el m√≥dulo no soporta.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
N¬∫

Significado

6

Distancia m√≠nima entre bordes err√≥nea
Causa

8

S√≠

El valor del final del eje rotativo se encuentra fuera del rango admitido de 1 a
109 ¬µm o respectivamente de 1 a 108 ¬µm (seg√∫n sea la resoluci√≥n).
S√≠

El valor del tipo de enc√≥der se encuentra fuera del rango admisible de 1 a 10

Recorrido err√≥neo por vuelta
Causa

S√≠

Como tipo de eje no ha indicado ni 0 ni 1.

Tipo de enc√≥der err√≥neo
Causa

11

Ha indicado como distancia m√≠nima entre bordes un valor < 0 √≥ > 10 ¬µm.

Final err√≥neo del eje rotativo
Causa

10

S√≠
9

Tipo de eje err√≥neo
Causa

9

Alarma de
diagn√≥stico

S√≠

El valor del recorrido/vuelta se encuentra fuera del margen admisible de 1 a
109 ¬µm (independientemente de la resoluci√≥n).

13

N√∫mero err√≥neo de incrementos/vuelta del enc√≥der(v√©ase el apartado "Incrementos por vuelta
del enc√≥der (P√°gina 602)")

S√≠

14

N√∫mero err√≥neo de vueltas (v√©ase el apartado ""N√∫mero de vueltas de enc√≥der (P√°gina 607)")

S√≠

15

Velocidad de transferencia err√≥nea

S√≠

Causa
16

Para la velocidad de transferencia ha indicado un valor fuera del rango admi‚Äê
sible de 0 a 3.

Coordinada del punto de referencia err√≥nea
Causa

S√≠

La coordenada se encuentra fuera del margen de -100 m a +100 m o, res‚Äê
pectivamente, de -1000 m a +1000 m, seg√∫n la resoluci√≥n.
Eje lineal: La coordenada se encuentra fuera de la zona de trabajo.
Eje rotativo: La coordenada es < 0 o mayor que el final del eje rotativo.

17

Reajuste err√≥neo del enc√≥der absoluto
Causa

18

21

S√≠

Ha puesto en "FALSE" la vigilancia de errores de telegrama en el DB de pa‚Äê
r√°metros.

Inicio err√≥neo del final de carrera por software
Causa

S√≠

Ha indicado un valor fuera de los valores admisibles 0 y 1.

Supervisi√≥n de hardware no posible
Causa

S√≠

Ha indicado un valor fuera de los valores admisibles 0, 1, 6 y 7.

Ajuste err√≥neo del sentido
Causa

20

Enc√≥der SSI de recorrido: El valor del reajuste del enc√≥der absoluto no se
encuentra dentro del rango del enc√≥der
(Incrementos por vuelta √ó Cantidad de vueltas - 1).

Forma err√≥nea para redisparar el punto de referencia
Causa

19

S√≠

S√≠

Eje lineal: El inicio del final de carrera por software se encuentra fuera de la
zona de desplazamiento (-100 m...+100 m √≥
-1000 m...+1000 m, dependiendo de la resoluci√≥n).
Eje lineal: El inicio del final de carrera por software (dado el caso, incluido un
decalaje de se√±al cero presente) es menor que -100 m √≥ -1000 m (seg√∫n la
resoluci√≥n).

22

Fin err√≥neo del final de carrera por software

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

S√≠

635

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
N¬∫

Significado
Causa

Alarma de
diagn√≥stico
Eje lineal: El fin del final de carrera por software se encuentra fuera de la zona
de desplazamiento (-100 m...+100 m √≥
-1000 m...+1000 m, dependiendo de la resoluci√≥n) o es menor que el inicio del
final de carrera por software.
El fin del final de carrera por software (dado el caso, incluido un decalaje de
se√±al cero presente) es mayor que +100 m √≥ +1000 m (seg√∫n la resoluci√≥n).

144

Alcance err√≥neo
Causa

145

S√≠
Para el alcance ha indicado un valor distinto de 0 a 3.

Hist√©resis err√≥nea
Causa

S√≠
La hist√©resis se encuentra fuera del rango 0..65535 √ó resoluci√≥n.
El decalaje de se√±al cero es mayor que ¬º √ó zona de trabajo o ¬º √ó √°rea de eje
rotativo.

146

Velocidad de simulaci√≥n err√≥nea
Causa

S√≠

La velocidad de simulaci√≥n se encuentra fuera del rango 1000 √ó RES hasta 3
√ó 107 √ó RES o es mayor que 5 √ó 108 ¬µm/min.
La velocidad de simulaci√≥n no puede ajustarse internamente.

147

Pista err√≥nea
Causa

148

Se ha seleccionado el control de una pista fuera de 0..15 (bit 0..15).

Selecci√≥n err√≥nea de entradas de habilitaci√≥n
Causa

149

S√≠

Ha querido habilitar una pista fuera de 3..10 (bit 0..7) mediante una se√±al
externa.

Selecci√≥n err√≥nea de una pista especial
Causa

S√≠

Ha querido definir una pista fuera de 0, 1 y 2 (bit 0, 1 y 2) a modo de pista
especial

150

Valor de contaje superior err√≥neo pista 0

151

Valor de contaje superior err√≥neo pista 1

Causa

S√≠

Ha indicado un valor de contaje < 2 √≥ > 65535 como valor de contaje superior.

Causa
200

S√≠

S√≠

Ha indicado un valor de contaje < 2 √≥ > 65535 como valor de contaje superior.

Resoluci√≥n err√≥nea
Causa

S√≠

Ha indicado una resoluci√≥n < 0,1 ¬µm/impulso √≥ >1000 ¬µm/impulso.
Ha indicado un recorrido/vuelta y una cantidad de impulsos/vuelta que dan
una resoluci√≥n < 0,1 √≥ > 1000.

201

El enc√≥der de recorrido no se adapta a la zona de trabajo / √°rea del eje rotativo
Causa

S√≠

Enc√≥der SSI de recorrido y eje rotativo: El enc√≥der de recorrido no cubre
exactamente el √°rea del eje rotativo.
Eje lineal: El enc√≥der de recorrido no cubre ni siquiera la zona de trabajo
(finales de carrera por software incluidos).

Error de datos de leva
Clase de error 7: Error de datos de leva
La alarma de diagn√≥stico s√≥lo se disparar√° con un bloque de datos del sistema (SDB) con
errores.

636

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra los errores de datos de leva posibles y sus causas.
N¬∫

Significado

1

Alarma de proceso no admisible
Causa

2

Alarma de diag‚Äê
n√≥stico
Ha querido indicar una alarma de proceso con una leva con un n√∫mero > 7.

N√∫mero de pista err√≥neo
Causa

3

S√≠
S√≠

El n√∫mero de pista se encuentra fuera del margen 0 a 31.

Inicio de leva err√≥neo
Causa

S√≠

El inicio de leva se encuentra fuera de la zona de desplazamiento
(-100 m...+100 m √≥ -1000 m...+1000 m).
Eje rotativo: El principio de leva es < 0 o mayor que el final del eje rotativo.

4

Final de leva err√≥neo
Causa

S√≠

El fin de leva se encuentra fuera de la zona de desplazamiento
(-100 m...+100 m √≥ -1000 m...+1000 m).
La leva no tiene una longitud de por lo menos 1 impulso.
Eje rotativo: El final de leva es < 0 o mayor que el final del eje rotativo.
En una leva invertida no hay una distancia m√≠nima de 4 impulsos entre inicio
de leva y fin de leva.

5

Tiempo de activaci√≥n err√≥neo

6

Tiempo de anticipaci√≥n err√≥neo1)

Demasiados juegos de levas
Causa

51

Eje en funcionamiento

S√≠

Ha querido indicar juegos de levas con la leva electr√≥nica activada.

Eje no parametrizado
Causa

1)

S√≠

Ha querido indicar m√°s juegos de levas de los posibles con este alcance.

Causa
52

S√≠

El tiempo de anticipaci√≥n es < 0 ¬µs. El valor m√°ximo (P√°gina 615) depende
del alcance.

Causa
50

S√≠

El tiempo de conexi√≥n es < 0¬µs. El valor m√°ximo (P√°gina 614) depende del
alcance.

Causa

S√≠

Ha querido indicar datos de levas a pesar de que todav√≠a no hay datos m√°‚Äê
quina activos.

El mensaje de error tambi√©n puede aparecer si ha parametrizado el sentido de contaje "invertido" en combinaci√≥n con un
enc√≥der absoluto (SSI).

Avisos
Clase de error 15: Avisos
La tabla siguiente muestra los avisos posibles y sus causas.
N¬∫

Significado

1

Inicio de parametrizaci√≥n
Causa

Alarma de diag‚Äê
n√≥stico
no

El m√≥dulo ha detectado una parametrizaci√≥n mediante un bloque de datos
del sistema.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

637

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
N¬∫

Significado

2

Final de la parametrizaci√≥n
Causa

Alarma de diag‚Äê
n√≥stico
no

El m√≥dulo ha procesado sin problemas la parametrizaci√≥n mediante un blo‚Äê
que de datos del sistema.

Error de diagn√≥stico
Clase de error 128: Error de diagn√≥stico
La tabla siguiente muestra los errores de datos posibles y sus causas, as√≠ como los efectos y
las soluciones posibles.
N¬∫

Significado

Alarma de diag‚Äê
n√≥stico

4

Falta tensi√≥n auxiliar externa

S√≠

Causa

La tensi√≥n auxiliar externa de 24 V no se ha conectado o ha ca√≠do, falta el
conector frontal

Efecto

Consulte "Activaci√≥n de alarmas de diagn√≥stico (P√°gina 627)":
‚óè El procesamiento de levas se desactivar√°
‚óè Desconexi√≥n de las salidas de pista:
‚óè Borrado de la sincronizaci√≥n, con enc√≥ders incrementales
‚óè El FM 452 no est√° parametrizado (se√±al de realimentaci√≥n PARA = 0).

Soluci√≥n
5

Comprobar que la conexi√≥n de 24 V sea correcta (si la conexi√≥n de 24 V es
correcta, el m√≥dulo est√° averiado).

Falta conector frontal
Causa

El conector frontal no est√° insertado

Efecto

‚óè Falta tensi√≥n auxiliar externa de 24 V

S√≠

‚óè El m√≥dulo no est√° listo para funcionar
Soluci√≥n
51

Enchufar el conector frontal

Vigilancia de tiempo transcurrida
Causa

‚óè Interferencias fuertes en el FM 452

Efecto

‚óè El m√≥dulo se resetea

S√≠

‚óè Error en el FM 452
‚óè Siempre que tras el reseteado del m√≥dulo no se detecte ning√∫n defecto en
el m√≥dulo, este vuelve a estar listo para funcionar.
‚óè El m√≥dulo notifica el transcurso de la vigilancia del tiempo (watchdog) con
"entrante" y "saliente"
Soluci√≥n

‚óè Eliminaci√≥n de interferencias
‚óè Consulte al departamento comercial correspondiente cuando las
circunstancias exactas que han dado lugar al error son de mayor entidad.
‚óè Cambio del FM 452

638

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
N¬∫

Significado

Alarma de diag‚Äê
n√≥stico

52

Ca√≠da de la alimentaci√≥n interna del m√≥dulo
Causa

Error en el FM 452

Efecto

‚óè El m√≥dulo se resetea

S√≠

‚óè Siempre que tras el reseteado del m√≥dulo no se detecte ning√∫n defecto en
el m√≥dulo, este vuelve a estar listo para funcionar.
Soluci√≥n
70

Cambio del FM 452

Alarma de proceso perdida
Causa

El FM 452 ha detectado un evento de alarma de proceso, que no puede ser
notificado porque el mismo evento todav√≠a no ha sido procesado por el pro‚Äê
grama de usuario o la CPU.

Efecto

‚óè El procesamiento de levas se desactivar√°

S√≠

‚óè Desconexi√≥n de las salidas de pista:
‚óè Borrado de la sincronizaci√≥n, con enc√≥ders incrementales
Soluci√≥n

‚óè Incorporar el OB 40 en el programa de usuario
‚óè Comprobar la conexi√≥n de bus del m√≥dulo
‚óè Desactivar la alarma de proceso
‚óè Adapte el hardware y software a las necesidades de su proceso (p. ej.
CPU m√°s r√°pida, optimizar el programa de usuario)

144

Rotura de hilo Enc√≥der
Causa

S√≠

‚óè El cable del enc√≥der no est√° enchufado o est√° cortado
‚óè Enc√≥der sin se√±ales de cuadratura
‚óè Asignaci√≥n de pines err√≥nea
‚óè Longitud de cable excesiva
‚óè Cortocircuito de las se√±ales del enc√≥der

Efecto

‚óè El procesamiento de levas se desactivar√°
‚óè Desconexi√≥n de las salidas de pista:
‚óè Borrado de la sincronizaci√≥n, con enc√≥ders incrementales

Soluci√≥n

‚óè Comprobar el cable del enc√≥der
‚óè Guardar los datos t√©cnicos del enc√≥der
‚óè La vigilancia puede desactivarse de forma provisional con el cuadro de
di√°logo de parametrizaci√≥n bajo la responsabilidad del operador.
‚óè Guardar las especificaciones t√©cnicas del m√≥dulo

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

639

Leva electr√≥nica (S7-300, S7-400)
2.1 Control por levas
N¬∫

Significado

145

Error de telegrama Enc√≥der absoluto
Causa

Alarma de diag‚Äê
n√≥stico
S√≠

El tr√°fico de telegramas entre el FM 452 y el enc√≥der absoluto (SSI) tiene
errores o est√° interrumpido:
‚óè El cable del enc√≥der no est√° enchufado o est√° cortado
‚óè Tipo de enc√≥der err√≥neo
‚óè Enc√≥der mal configurado (enc√≥ders programables)
‚óè Longitud de telegrama mal indicada
‚óè El enc√≥der proporciona valores err√≥neos (enc√≥der defectuoso)
‚óè Interferencia en el cable del sistema de medici√≥n
‚óè Velocidad de transferencia escogida demasiado alta

Efecto

‚óè El procesamiento de levas se desactivar√°
‚óè Desconexi√≥n de las salidas de pista:
‚óè el √∫ltimo valor real correcto se mantiene sin cambios hasta el final de la
siguiente transferencia SSI correcta

Soluci√≥n

‚óè Comprobar el cable del enc√≥der
‚óè Comprobar el enc√≥der
‚óè Comprobar el tr√°fico de telegramas entre el enc√≥der y el FM 452

146

Impulsos err√≥neos (enc√≥der incremental)
Causa

S√≠

‚óè Vigilancia del enc√≥der ha detectado impulsos err√≥neos
‚óè La cantidad de incrementos por vuelta est√° mal introducida
‚óè Enc√≥der defectuoso: no proporciona la cantidad de impulsos indicada
‚óè Marca cero err√≥nea o no presente
‚óè Interferencias en el cable del enc√≥der

Efecto

‚óè El procesamiento de levas se desactivar√°
‚óè Desconexi√≥n de las salidas de pista:
‚óè Borrado de la sincronizaci√≥n

Soluci√≥n

‚óè Indicar correctamente el n√∫mero de incrementos/vuelta.
‚óè Comprobar el enc√≥der y su cable
‚óè Cumplir las normas de apantallamiento y de conexi√≥n a tierra
‚óè La vigilancia puede desactivarse de forma provisional con el cuadro de
di√°logo de parametrizaci√≥n bajo la responsabilidad del operador.

640

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

3

Regulaci√≥n PID
3.1

Principios b√°sicos de la regulaci√≥n

3.1.1

Lazo de regulaci√≥n y elementos finales de control

Lazo de regulaci√≥n
Un ejemplo sencillo de un lazo de regulaci√≥n es la regulaci√≥n de la temperatura ambiente
mediante una calefacci√≥n. La temperatura ambiente se mide con un sensor y se transmite a un
regulador. Este compara la temperatura ambiente actual con una consigna y calcula un valor
de salida (variable manipulada) para controlar la calefacci√≥n.
&RQVLJQD
9DORUUHDO

5HJXODGRU

9DULDEOH
PDQLSXODGD

$FWXDGRU

6HQVRU

&DOHIDFFL¬µQ

7HPSHUDWXUD

Un regulador PID ajustado correctamente alcanza la consigna lo m√°s r√°pido posible y luego la
mantiene constante. Tras un cambio del valor de salida el valor real suele cambiar de forma
retardada. Este comportamiento debe compensarse con el regulador.

Elementos finales de control
El elemento final de control es un componente del lazo de regulaci√≥n y se ve influenciado por
el regulador. De esta manera se modifica un flujo m√°sico o energ√©tico.
La tabla siguiente muestra los campos de aplicaci√≥n de los elementos finales de control
Aplicaci√≥n para

Elemento final de control

Flujo m√°sico de l√≠quidos y gases

V√°lvula, compuerta, corredera

Flujo m√°sico s√≥lido p. j. carga a granel

V√°lvula de descarga, cinta transportadora, canal vibra‚Äê
torio

Flujo el√©ctrico

Conmutador, contactor, rel√©, tiristor
Resistor variable, transformador de regulaci√≥n, transis‚Äê
tor

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

641

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n
Los elementos finales de control se diferencian del modo siguiente:
‚óè Elementos finales de control proporcionales con se√±al de posicionamiento constante
Los √°ngulos de apertura, √°ngulos de rotaci√≥n o posiciones se adoptan proporcionalmente
al valor de salida. Dentro del rango de ajuste el valor de salida incide en el proceso de
manera an√°loga.
A los elementos finales de control de este grupo pertenecen los accionamientos
neum√°ticos cargados por resorte, as√≠ como los accionamientos motorizados con
realimentaci√≥n de posici√≥n en los que se conforma un lazo de regulaci√≥n de
posicionamiento.
El valor de salida es generado por un regulador continuo, p. ej. PID_Compact.
‚óè Elementos finales de control proporcionales mediante se√±al con modulaci√≥n de ancho de
impulsos
En estos elementos finales de control (actuadores) se emite un impulso con una frecuencia
equivalente al tiempo de muestreo y cuya longitud es proporcional al valor de salida. El
elemento final de control, p. ej. una resistencia calefactora o un grupo frigor√≠fico, se conecta
de forma sincronizada con el ciclo por un tiempo variable en funci√≥n del valor de salida.
La se√±al de posicionamiento puede adoptar unipolarmente los estados "Conectado" o
"Desconectado" o bien representar bipolarmente los valores "Abierto/Cerrado", "Adelante/
Atr√°s", "Acelerar/Decelerar" etc.
El valor de salida es generado por un regulador de dos puntos, p. ej. PID_Compact con
modulaci√≥n de ancho de impulsos.
‚óè Elementos finales de control de acci√≥n integral con se√±al de salida de tres puntos
Frecuentemente los elementos finales de control se accionan con motores cuya duraci√≥n
de conexi√≥n es proporcional al trayecto de ajuste del √≥rgano de regulaci√≥n. A este grupo
pertenecen p. ej. v√°lvulas, compuertas y correderas. A pesar de que su dise√±o var√≠a
considerablemente, estos elementos finales de control se asemejan en cuanto a que tienen
el efecto de una acci√≥n I en la entrada del sistema regulado.
El valor de salida es generado por un regulador paso a paso, p. ej. PID_3Step.

3.1.2

Sistemas regulados
Las propiedades de un sistema regulado est√°n definidas por aspectos tecnol√≥gicos y
mec√°nicos que dejan un margen de influencia muy reducido. Para que la regulaci√≥n arroje
buenos resultados es imprescindible elegir un tipo de regulador apropiado, que pueda ser
adaptado √≥ptimamente a la rapidez de respuesta del sistema regulado. Por lo tanto, es
esencial conocer a fondo los datos caracter√≠sticos y el tipo del sistema regulado para poder
configurar la acci√≥n P, I y D del regulador.

Tipos de sistema regulado
Los sistemas regulados se clasifican en funci√≥n de su rapidez de respuesta a cambios bruscos
del valor de salida.

642

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n
Se distinguen los siguientes sistemas regulados:
‚óè Sistemas regulados con compensaci√≥n
‚Äì Sistemas regulados tipo P
‚Äì Sistemas regulados tipo PT1
‚Äì Sistemas regulados tipo PT2
‚óè Sistemas regulados sin compensaci√≥n
‚óè Sistemas regulados con y sin tiempo muerto

Sistemas regulados con compensaci√≥n
Sistemas regulados tipo P
En los sistemas proporcionales el valor real sigue al valor de salida casi instant√°neamente. La
relaci√≥n entre el valor real y el valor de salida se expresa mediante la ganancia proporcional
Gain del sistema regulado.
Ejemplos:
‚óè V√°lvula deslizante en un sistema de tuber√≠as
‚óè Divisor de tensi√≥n
‚óè Reducci√≥n en sistemas hidr√°ulicos
Sistemas regulados tipo PT1
En un sistema regulado tipo PT1 el valor real var√≠a en un principio de manera proporcional al
cambio del valor de salida. A medida que transcurre el tiempo, el valor real cambia m√°s
lentamente (con retardo) hasta alcanzar un valor final.
Ejemplos:
‚óè Sistemas de amortiguaci√≥n por resorte
‚óè Carga de componentes RC
‚óè Dep√≥sito de agua calentado con vapor.
Frecuentemente rigen las mismas constantes de tiempo para procesos de calefacci√≥n y
refrigeraci√≥n o curvas de carga y descarga. Si las constantes de tiempo son divergentes, la
regulaci√≥n se torna mucho m√°s complicada.
Sistemas regulados tipo PT2
En un sistema regulado tipo PT2 el valor real en un principio no cambia ante un escal√≥n del
valor de salida, pero luego aumenta en rampa de subida hasta finalmente aproximarse a la
consigna con una rampa de bajada. El sistema regulado presenta un comportamiento de
transferencia proporcional con retardo de 2¬∫ grado.
Ejemplos:
‚óè Regulaci√≥n de presi√≥n
‚óè Regulaci√≥n de caudal
‚óè Regulaci√≥n de temperatura

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

643

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

Sistemas regulados sin compensaci√≥n
Los sistemas regulados sin compensaci√≥n presentan un comportamiento integral. El valor real
persigue un valor infinitamente grande.
Ejemplo:
‚óè Entrada de un l√≠quido determinado a un dep√≥sito

Sistemas regulados con tiempo muerto
Un tiempo muerto es siempre el tiempo de ejecuci√≥n o de transporte hasta que un cambio en
la entrada del sistema pueda ser medido en la salida del mismo.
En los sistemas regulados con tiempo muerto el valor real var√≠a con retardo en funci√≥n del
tiempo muerto.
Ejemplo:
Cinta transportadora

644

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

3.1.3

Valores caracter√≠sticos del sistema regulado

Determinar el comportamiento de tiempo a partir de la respuesta indicial
La respuesta temporal del sistema regulado se puede determinar a partir de la evoluci√≥n
temporal del valor real x tras un cambio brusco del valor de salida y. En la mayor√≠a de los casos
se trata de sistemas regulados con compensaci√≥n.
\



W

[
7J
;PD[

‡∑ô[

‡∑ôW

7X

W

El comportamiento de tiempo se puede definir aproximadamente con las magnitudes tiempo
de retardo Tu, tiempo de compensaci√≥n Tg y valor m√°ximo Xmax. Las magnitudes se determinan
posicionando tangentes en el valor m√°ximo y en el punto de inflexi√≥n de la respuesta indicial.
En muchos casos no es posible aceptar la respuesta transitoria hasta el valor m√°ximo debido
a que el valor real no puede rebasar ciertos valores. Luego se utiliza la velocidad de aumento
vmax para identificar el sistema regulado (vmax = Œîx/Œît).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

645

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n
La regulabilidad del sistema regulado se puede estimar a partir de la relaci√≥n Tu/Tg o bien Tu √ó
vmax/Xmax Rige lo siguiente:
Tipo de sistema

Tu / Tg

Regulabilidad del sistema regulado

I

< 0,1

Altamente regulable

II

0,1 hasta 0,3

Todav√≠a regulable

III

> 0,3

Dif√≠cil de regular

Incidencia del tiempo muerto en la regulabilidad del sistema regulado
Un sistema regulado con tiempo muerto y compensaci√≥n presenta la respuesta siguiente ante
un escal√≥n del valor de salida
\

W
[

7J

W
7X

7W
7D

Tt

Tiempo muerto

Tu

Tiempo de retardo

Tg

Tiempo de compensaci√≥n

y

Valor de salida

x

Valor real

La regulabilidad de un sistema regulado con tiempo muerto est√° determinada por la relaci√≥n
existente entre Tt y Tg. El valor de Tt debe ser peque√±o en relaci√≥n a Tg. Rige:
Tt/Tg ‚â§ 1

Velocidad de reacci√≥n de sistemas regulados
Los sistemas regulados se pueden catalogar en funci√≥n de los valores siguientes:
Tu < 0,5 min, Tg < 5 min = sistema regulado r√°pido

646

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n
Tu > 0,5 min, Tg > 5 min = sistema regulado lento

Valores caracter√≠sticos de algunos sistemas regulados
Magnitud f√≠si‚Äê
ca
Temperatura

Sistema regulado

Tiempo de retardo Tu

Tiempo de com‚Äê
pensaci√≥n Tg

Velocidad de au‚Äê
mento vmax

Horno peque√±o calentado el√©ctricamente

0,5 hasta 1 min

5 hasta 15 min

hasta 60 K/min

Horno de recocer grande calentado el√©ctri‚Äê
camente

1 hasta 5 min

10 hasta 20 min

hasta 20 K/min

Horno de recocer grande calentado por gas

0,2 hasta 5 min

3 hasta 60 min

1 hasta 30 K/min

1 hasta 7 min

40 hasta 60 min

0,1 hasta 0,5 ¬∞C/s

Autoclave (2,5 m3)

0,5 hasta 0,7 min

10 hasta 20 min

ninguna indica‚Äê
ci√≥n

Autoclave de alta presi√≥n

12 hasta 15 min

200 hasta 300 min

ninguna indica‚Äê
ci√≥n

Columna de destilaci√≥n fraccionada

Recalentador de vapor
M√°quinas de moldeo por inyecci√≥n
Extrusora
M√°quinas de envasado y embalaje
Calefacci√≥n de locales
Caudal
Presi√≥n

Tuber√≠a con gas

30 s hasta 2,5 min

1 hasta 4 min

2 ¬∞C/s

0,5 hasta 3 min

3 hasta 30 min

5 hasta 20 K/min

1 hasta 6 min

5 hasta 60 min

0,5 hasta 4 min

3 hasta 40 min

2 hasta 35 K/min

1 hasta 5 min

10 hasta 60 min

1 ¬∞C/min
no aplicable

0 hasta 5 s

0,2 hasta 10 s

Tuber√≠a con l√≠quido

Sin

Sin

Tuber√≠a de gas

Sin

0,1 s

no aplicable

Caldera de tambor calentada con gas o
fuel oil

Sin

150 s

no aplicable

2 hasta 5 min

no aplicable

Caldera de tambor con molinos batidores

1 hasta 2 min

Nivel del de‚Äê
p√≥sito (nivel)

Caldera de tambor

Velocidad

Accionamiento el√©ctrico peque√±o

Sin

0,2 hasta 10 s

no aplicable

Accionamiento el√©ctrico grande

Sin

5 hasta 40 s

no aplicable

Turbina de gas

Sin

ninguna indicaci√≥n

50 rpm

Generadores peque√±os

Sin

1 hasta 5 s

no aplicable

Generadores grandes

Sin

5 hasta 10 s

no aplicable

Tensi√≥n el√©c‚Äê
trica

3.1.4

0,6 hasta 1 min

ninguna indicaci√≥n 0,1 hasta 0,3 cm/s

Regulador de impulsos

Regulador de dos puntos sin realimentaci√≥n
Los reguladores de dos puntos tienen como funci√≥n de conmutaci√≥n el estado "ON" y "OFF".
Esto corresponde al 100 % o bien al 0 % de la potencia. Este comportamiento origina una
oscilaci√≥n continua del valor real x en torno a la consigna w.
La amplitud y la duraci√≥n de periodo de la oscilaci√≥n aumentan con la relaci√≥n existente entre
el tiempo de retardo Tu y el tiempo de compensaci√≥n Tg presente en el sistema regulado. Estos

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

647

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n
reguladores se utilizan principalmente en regulaciones de temperatura simples (p. ej. hornos
el√©ctricos de calefacci√≥n directa) o como se√±alizadores de l√≠mite.
El gr√°fico siguiente muestra la curva caracter√≠stica de un regulador de dos puntos
\



<K


Z

‚ë†
‚ë°

OFF

Yh

Rango

w

Consigna

[

ON

El gr√°fico siguiente muestra la funci√≥n de regulaci√≥n de un regulador de dos puntos

648

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

[

7J





Z
;
6G

7X

W

\




W

‚ë†
‚ë°

Respuesta transitoria con regulador de dos puntos

Tu

Tiempo de retardo

Tg

Tiempo de compensaci√≥n

XSd

Ganancia diferencial

Respuesta transitoria sin regulador

Regulador de dos puntos con realimentaci√≥n
El comportamiento de los reguladores de dos puntos en sistemas regulados que presentan
grandes tiempos de retardo (p. ej. hornos en los que la capacidad √∫til est√° separada de la
calefacci√≥n) se puede mejorar con realimentaciones electr√≥nicas.
Con la realimentaci√≥n se eleva la frecuencia de conmutaci√≥n del regulador, con lo que se
reduce la amplitud del valor real. Adem√°s, se pueden mejorar considerablemente los
resultados de la regulaci√≥n en el funcionamiento din√°mico. El l√≠mite de la frecuencia de
conmutaci√≥n est√° definido por la etapa de salida. La frecuencia de conmutaci√≥n de elementos
finales de control mec√°nicos como rel√©s y contactores no debe ser mayor de 1 a 5
conmutaciones por minuto. Para las salidas de corriente y tensi√≥n binarias con tiristores o
triacs postconectados se pueden elegir altas frecuencias de conmutaci√≥n ubicadas muy por
encima de la frecuencia de corte del sistema regulado.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

649

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n
Dado que los impulsos de conmutaci√≥n en la salida del sistema regulado ya no se pueden
determinar, se obtienen resultados comparables a los de los reguladores continuos.
El valor de salida se genera por modulaci√≥n del ancho de impulsos del valor de salida de un
regulador continuo.
Los reguladores de dos puntos con realimentaci√≥n se utilizan para regular la temperatura en
hornos, m√°quinas para procesar pl√°stico, textiles, papel, goma y alimentos, as√≠ como en
enfriadores y calefactores.

Regulador de tres puntos
Los reguladores de tres puntos se utilizan en calefacci√≥n/refrigeraci√≥n. Estos reguladores
tienen dos puntos de conmutaci√≥n como salida. Los resultados de la regulaci√≥n se optimizan
con estructuras de realimentaci√≥n electr√≥nicas. Los campos de aplicaci√≥n de estos
reguladores son las c√°maras t√©rmicas, frigor√≠ficas y climatizadas, as√≠ como el
precalentamiento de herramientas de m√°quinas transformadoras de pl√°stico.
El gr√°fico siguiente muestra la curva caracter√≠stica de un regulador de tres puntos
\
\

\

\

\
[

Z
[ 6K

y

Valor de salida, p. ej.
y11 = 100 % calefacci√≥n
y12 = 0 % calefacci√≥n
y21 = 0 % refrigeraci√≥n
y22 = 100 % refrigeraci√≥n

650

x

Unidad f√≠sica del valor real, p. ej. la temperatura en ¬∞C

w

Consigna

xSh

Distancia entre los puntos de conmutaci√≥n 1 y 2

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

3.1.5

Respuesta de regulaci√≥n y a perturbaciones

Respuesta de regulaci√≥n
El valor real debe seguir un cambio de la consigna lo m√°s r√°pido posible. La respuesta de
regulaci√≥n mejora cuanto m√°s corto sea el tiempo necesario para alcanzar la nueva consigna
y menor la fluctuaci√≥n del valor real.
[

Z

W

x

Valor real

w

Consigna

Respuesta a perturbaciones
La consigna se ve afectada por magnitudes perturbadoras. El regulador debe eliminar lo m√°s
r√°pido posible el error de regulaci√≥n resultante. La respuesta a perturbaciones mejora cuanto
m√°s corto sea el tiempo necesario para alcanzar la nueva consigna consigna y menor la
fluctuaci√≥n del valor real.
[



Z

W

x

Valor real

w

Consigna

‚ë†

Incidencia de una magnitud perturbadora

Una magnitud perturbadora se compensa con reguladores con acci√≥n I. La calidad de la
regulaci√≥n no se reduce por una magnitud perturbadora que incida constantemente, ya que el

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

651

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n
error de regulaci√≥n es relativamente constante. Una magnitud perturbadora din√°mica afecta
en mayor medida a la calidad de la regulaci√≥n porque el error de regulaci√≥n fluct√∫a. S√≥lo a
trav√©s de la acci√≥n I, que se forma lentamente, se vuelve a reducir el error de regulaci√≥n.
Una magnitud perturbadora medible puede entrar en el lazo de regulaci√≥n. Esto puede
acelerar considerablemente la reacci√≥n del regulador.

3.1.6

Respuesta de regulaci√≥n con diferentes estructuras de realimentaci√≥n

Comportamientos de regulador
Cuanto mayor sea la precisi√≥n de adaptaci√≥n del regulador al comportamiento de tiempo del
sistema regulado, mayor ser√° la precisi√≥n de ajuste de la consigna, de modo que la respuesta
a magnitudes perturbadores ser√° √≥ptima.
La inclusi√≥n en la realimentaci√≥n puede tener un comportamiento proporcional (P),
proporcional diferencial (PD), proporcional integral (PI) o proporcional integral diferencial (PID).
Si se le aplica una funci√≥n de escal√≥n al error de regulaci√≥n, se generar√°n distintas respuestas
indiciales en funci√≥n del regulador.

652

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

Respuesta indicial de un regulador P


[

W


\

W
\






‚ë†
‚ë°
‚ë¢

W

Error de regulaci√≥n
Valor de salida de un regulador continuo
Valor de salida de un regulador de impulsos

F√≥rmula para reguladores P
El valor de salida y el error de regulaci√≥n son directamente proporcionales, es decir:
Valor de salida = ganancia proporcional √ó error de regulaci√≥n
y = GAIN √ó x

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

653

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

Respuesta indicial de un regulador PD


[

W
\


70B/$*

W
\





W

‚ë†
‚ë°
‚ë¢

Valor de salida de un regulador continuo

TM_LAG

Retardo de la acci√≥n D

Error de regulaci√≥n
Valor de salida de un regulador de impulsos

F√≥rmula para reguladores PD
Para la respuesta indicial del regulador PD en el dominio temporal rige lo siguiente:
W
7'
\ *$,1y;:y 
70B/$*

70B/$*
yH

t = duraci√≥n desde el escal√≥n del error de regulaci√≥n
La acci√≥n D genera un valor de salida en funci√≥n de la velocidad con la que cambia el valor real.
Una acci√≥n D pura no es apta para la regulaci√≥n, pues s√≥lo un cambio del valor real puede

654

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n
generar un cambio del valor de salida. Si el valor real permanece constante, el valor de salida
tampoco cambia.
La acci√≥n D, en combinaci√≥n con una acci√≥n P, mejora la respuesta a perturbaciones. Las
perturbaciones no se eliminan por completo. El comportamiento beneficioso es el bueno y
din√°mico. Durante el desplazamiento y al cambiar la consigna se alcanza una transici√≥n bien
amortiguada y exenta de vibraciones.
Un regulador con acci√≥n D no es apropiado si el sistema regulado tiene magnitudes de
medici√≥n pulsantes, p. ej. en la regulaci√≥n de presi√≥n o de caudal.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

655

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

Respuesta indicial de un regulador PI
[


W
\



W
\





W

‚ë†
‚ë°
‚ë¢

Error de regulaci√≥n
Valor de salida de un regulador continuo
Valor de salida de un regulador de impulsos

Una acci√≥n I en el regulador totaliza el error de regulaci√≥n en el tiempo. De este modo el
regulador sigue reajust√°ndose hasta eliminar el error de regulaci√≥n. En un regulador P puro se
presenta un error de regulaci√≥n permanente. √âste se puede eliminar con una acci√≥n I en el
regulador.
Dependiendo de los requisitos que deba cumplir la respuesta de regulaci√≥n, en la pr√°ctica
resulta id√≥nea una combinaci√≥n de las acciones P, I y D. El comportamiento de tiempo de las
distintas acciones se puede describir con los siguientes par√°metros del regulador: ganancia
proporcional GAIN, tiempo de acci√≥n integral TI (acci√≥n I) y tiempo de anticipaci√≥n TD (acci√≥n
D).

656

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n
F√≥rmula para reguladores PI
Para la respuesta indicial del regulador PI en el dominio temporal rige lo siguiente:
\ *$,1y;:y 


7,yW

t = duraci√≥n desde el escal√≥n del error de regulaci√≥n

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

657

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

Respuesta indicial de un regulador PID
[


W

\

70B/$*

W

7,

\



W

‚ë†
‚ë°
‚ë¢

Valor de salida de un regulador continuo

TM_LAG

Retardo de la acci√≥n D

Ti

Tiempo de integraci√≥n

Error de regulaci√≥n
Valor de salida de un regulador de impulsos

F√≥rmula para reguladores PID
Para la respuesta indicial del regulador PID en el dominio temporal rige lo siguiente:

658

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

\ *$,1y;:y




7,yW

7'

 70B/$* yH

W
70B/$*

t = duraci√≥n desde el escal√≥n del error de regulaci√≥n

Comportamiento de un sistema regulado con distintas estructuras de regulaci√≥n
La mayor√≠a de regulaciones que se aplican en la t√©cnica de procesos se puede controlar con
un regulador con comportamiento PI. En sistemas regulados lentos con grandes tiempos de
retardo, p. ej. regulaci√≥n de temperatura, el resultado de la regulaci√≥n se puede mejorar con
un regulador con comportamiento PID.
[






Z




W

‚ë†
‚ë°
‚ë¢

Regulador PID

w

Consigna

x

Valor real

Sin regulador
Regulador PD

Los reguladores con comportamiento PI y PID ofrecen la ventaja de que tras la fase de
estabilizaci√≥n el valor real no muestra ninguna desviaci√≥n frente a la consigna. Durante el
desplazamiento el valor real oscila sobre la consigna.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

659

Regulaci√≥n PID
3.1 Principios b√°sicos de la regulaci√≥n

3.1.7

Elecci√≥n de la estructura del regulador con un sistema regulado definido

Selecci√≥n de las estructuras de regulador apropiadas
Un resultado de regulaci√≥n √≥ptimo s√≥lo se puede alcanzar si se elige una estructura de
regulador que sea af√≠n al sistema regulado, y que se pueda adaptar al mismo dentro de
determinados l√≠mites.
La tabla siguiente ofrece una vista general de las estructuras de regulador adecuadas en
funci√≥n del sistema regulado.
Sistema regulado

Estructura de regulador
P

PD

PI

PID

S√≥lo con tiempo muerto No apta

No apta

Apta

No apta

PT1 con tiempo muerto No apta

No apta

Muy apta

Muy apta

PT2 con tiempo muerto No apta

Apta con limitacio‚Äê
nes

Muy apta

Muy apta

Alto grado

No apta

No apta

Apta con limitacio‚Äê
nes

Muy apta

Sin compensaci√≥n

Muy apta

Muy apta

Muy apta

Muy apta

La tabla siguiente ofrece una vista general de las estructuras de regulador adecuadas en
funci√≥n de la magnitud f√≠sica.
Magnitud f√≠sica

Estructura de regulador
P

PD

Error de regulaci√≥n permanente

660

PI

PID

Error de regulaci√≥n no permanente

Temperatura

Para exigencias
reducidas y siste‚Äê
mas P con Tu/Tg <
0,1

Muy apta

Estructuras de regulador id√≥neas para
exigencias elevadas (con excepci√≥n de
reguladores especiales adaptados)

Presi√≥n

Apta, si el tiempo
de retardo no es
significativo

No apta

Estructuras de regulador id√≥neas para
exigencias elevadas (con excepci√≥n de
reguladores especiales adaptados)

Caudal

No apta, porque el No apta
rango GAIN reque‚Äê
rido suele ser de‚Äê
masiado grande

V√°lido, pero el re‚Äê Casi no es necesa‚Äê
gulador I solo sue‚Äê ria
le ser mejor

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

3.1.8

Ajuste de los par√°metros PID

F√≥rmula emp√≠rica para ajustar los par√°metros
Estructura de regulador
P
PI

Ajuste
GAIN ‚âà vmax √ó Tu [ ¬∞C ]
GAIN ‚âà 1,2 √ó vmax √ó Tu [ ¬∞C ]
TI ‚âà 4 √ó Tu [ min ]

PD

GAIN ‚âà 0,83 √ó vmax √ó Tu [ ¬∞C ]
TD ‚âà 0,25 √ó vmax √ó Tu [ min ]
TM_LAG ‚âà 0,5 √ó TD[ min ]

PID

GAIN ‚âà 0,83 √ó vmax √ó Tu [ ¬∞C ]
TI ‚âà 2 √ó Tu [ min ]
TD ‚âà 0,4 √ó Tu [ min ]
TM_LAG ‚âà 0,5 √ó TD[ min ]

PD/PID

GAIN ‚âà 0,4 √ó vmax √ó Tu [ ¬∞C ]
TI ‚âà 2 √ó Tu [ min ]
TD ‚âà 0,4 √ó Tu [ min ]
TM_LAG ‚âà 0,5 √ó TD[ min ]

En vez de vmax = ‚àÜx / ‚àÜt se puede utilizar Xmax / Tg.
En los reguladores con estructura PID el ajuste del tiempo de acci√≥n integral est√° acoplado por
lo general al ajuste del tiempo de anticipaci√≥n.
La relaci√≥n TI / TD es de 4 a 5 y por lo tanto √≥ptima para la mayor√≠a de sistemas regulados.
La inobservancia del tiempo de anticipaci√≥n TD no es grave en los reguladores PD.
En los reguladores PI o PID ocurren oscilaciones en la regulaci√≥n si el tiempo de acci√≥n integral
TI se ha ajustado por debajo de la mitad del nivel requerido.
Un tiempo de acci√≥n integral demasiado grande retarda la eliminaci√≥n de perturbaciones. No
se puede pretender que los lazos de regulaci√≥n trabajen √≥ptimamente despu√©s de haber
ajustado por primera vez los par√°metros. La experiencia ha demostrado que es necesario
efectuar un reajuste de par√°metros si se trata de un sistema "dif√≠cil de regular" con Tu / Tg > 0,3.

3.2

Configuraci√≥n de un regulador por software

3.2.1

Vista general de los reguladores de software
Para la configuraci√≥n de un regulador por software, se requiere una instrucci√≥n con el
algoritmo de regulaci√≥n y un objeto tecnol√≥gico. El objeto tecnol√≥gico para un regulador de
software equivale al DB de instancia de la instrucci√≥n. En el objeto tecnol√≥gico, se guarda la
configuraci√≥n del regulador. A diferencia de los DB de instancia de otras instrucciones, los
objetos tecnol√≥gicos no se guardan junto a los recursos del programa, sino en CPU > Objetos
tecnol√≥gicos.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

661

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Objetos tecnol√≥gicos e instrucciones
CPU

Librer√≠a

Instrucci√≥n

Objeto tecnol√≥gi‚Äê
co

Descripci√≥n

S7-1200

Compact PID

PID_Compact
V1.x

PID_Compact
V1.x

Regulador PID universal con optimizaci√≥n in‚Äê
tegrada

S7-1200

PID_3Step V1.x

PID_3Step V1.x

Regulador PID para v√°lvulas con optimiza‚Äê
ci√≥n integrada

S7-1500
S7-1200 V4.x

PID_Compact
V2.x

PID_Compact
V2.x

Regulador PID universal con optimizaci√≥n in‚Äê
tegrada

S7-1500

PID_3Step V2.x

PID_3Step V2.x

Regulador PID para v√°lvulas con optimiza‚Äê
ci√≥n integrada

PID_Temp V1.x

PID_Temp V1.x

Regulador de temperatura PID universal con
optimizaci√≥n integrada

CONT_C

CONT_C

Regulador continuo

S7-1500/300/4
00

CONT_S

CONT_S

Regulador paso a paso para elementos fina‚Äê
les de control de acci√≥n integrativa

S7-1500/300/4
00

PULSEGEN

-

Generador de impulsos para elementos fina‚Äê
les de control de acci√≥n proporcional

S7-1500/300/4
00

TCONT_CP

TCONT_CP

Regulador de temperatura continuo con ge‚Äê
nerador de impulsos

S7-1500/300/4
00

TCONT_S

TCONT_S

Regulador de temperatura para accionado‚Äê
res integrables

TUN_EC

TUN_EC

Optimizaci√≥n de un regulador continuo

TUN_ES

TUN_ES

Optimizaci√≥n de un regulador paso a paso

PID_CP

Regulador continuo con generador de impul‚Äê
so

PID_ES

Regulador paso a paso para elementos fina‚Äê
les de control de acci√≥n integrativa

-

Distribuir llamadas del regulador

S7-1200 V4.x
S7-1500 ‚â• V1.7
S7-1200 ‚â• V4.1
S7-1500/300/4
00

S7-300/400
S7-300/400
S7-300/400
S7-300/400
S7-300/400

662

Funciones b√°sicas
de PID

PID Self Tuner

Standard PID Con‚Äê PID_CP
trol (paquete op‚Äê
cional PID Profes‚Äê PID_ES
sional)
LP_SCHED

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
CPU

Librer√≠a

Instrucci√≥n

Objeto tecnol√≥gi‚Äê
co

Descripci√≥n

S7-300/400

Modular PID Con‚Äê
trol (paquete op‚Äê
cional PID Profes‚Äê
sional)

A_DEAD_B

-

Filtrar se√±ales perturbadoras del error de re‚Äê
gulaci√≥n

CRP_IN

-

Escalar se√±al de entrada anal√≥gica

CRP_OUT

-

Escalar se√±al de salida anal√≥gica

S7-300/400

DEAD_T

-

Emitir se√±al de entrada retardada

S7-300/400

DEADBAND

-

Inhibir peque√±as oscilaciones del valor real

S7-300/400

DIF

-

Diferenciar se√±al de entrada en el tiempo

S7-300/400

ERR_MON

S7-300/400

INTEG

S7-300/400
S7-300/400

S7-300/400
S7-300/400

Vigilar error de regulaci√≥n
-

Integrar se√±al de entrada en el tiempo

LAG1ST

-

Elemento de retardo de primer orden

LAG2ND

-

Elemento de retardo de segundo orden

S7-300/400

LIMALARM

-

Notificar valores l√≠mite

S7-300/400

LIMITER

-

Limitar la variable manipulada

S7-300/400

LMNGEN_C

-

Determinar variable manipulada para regula‚Äê
dor continuo

S7-300/400

LMNGEN_S

-

Determinar variable manipulada para regula‚Äê
dor paso a paso

S7-300/400

NONLIN

-

Linealizar se√±al del enc√≥der

S7-300/400

NORM

-

Normalizar el valor real f√≠sicamente

S7-300/400

OVERRIDE

-

Aplicar variables manipuladas de 2 regulado‚Äê
res PID en 1 actuador

S7-300/400

PARA_CTL

-

Conmutar juegos de par√°metros

S7-300/400

PID

-

Algoritmo PID

S7-300/400

PUSLEGEN_M

-

Generar impulsos para actuadores de acci√≥n
proporcional

S7-300/400

RMP_SOAK

-

Especificar consignas seg√∫n perfil

S7-300/400

ROC_LIM

-

Limitar la velocidad de cambio

S7-300/400

SCALE_M

-

Escalar valor real

S7-300/400

SP_GEN

-

Especificar consigna manualmente

S7-300/400

SPLT_RAN

-

Dividir rangos de variable manipulada

S7-300/400

SWITCH

-

Aplicar valores anal√≥gicos

S7-300/400

LP_SCHED_M

-

Distribuir llamadas del regulador

3.2.2

Pasos para la configuraci√≥n de un regulador por software
Todos los reguladores de software se proyectan seg√∫n el mismo esquema:
Paso

Descripci√≥n

1

Agregar objeto tecnol√≥gico (P√°gina 664)

2

Configurar objeto tecnol√≥gico (P√°gina 665)

3

Llamar la instrucci√≥n en el programa de usuario (P√°gina 666)

4

Cargar objeto tecnol√≥gico en el dispositivo (P√°gina 667)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

663

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

3.2.3

Paso

Descripci√≥n

5

Poner en marcha el regulador de software (P√°gina 668)

6

Guardar los par√°metros PID optimizados en el proyecto (P√°gina 669)

7

Comparar valores (P√°gina 670)

8

Mostrar instancias de un objeto tecnol√≥gico (P√°gina 691)

Agregar objetos tecnol√≥gicos

Agregar objeto tecnol√≥gico en el √°rbol del proyecto
Al agregar un objeto tecnol√≥gico, se genera un DB de instancia de la instrucci√≥n para este
objeto tecnol√≥gico. En √©l se guarda la configuraci√≥n del objeto tecnol√≥gico.

Requisitos
Hay un proyecto creado con una CPU.

Procedimiento
Para agregar un objeto tecnol√≥gico, proceda del siguiente modo:
1. Abra la carpeta de la CPU en el √°rbol del proyecto.
2. Abra la carpeta "Objetos tecnol√≥gicos".
3. Haga doble clic en "Agregar objeto".
Se abre el cuadro de di√°logo "Agregar objeto".
4. Haga clic en el bot√≥n "Regulador PID".
Se muestran todos los reguladores PID disponibles para esta CPU.
5. Seleccione la instrucci√≥n para el objeto tecnol√≥gico, p. ej., PID_Compact.
6. En el campo de entrada "Nombre", introduzca un nombre personalizado para el objeto
tecnol√≥gico.
7. Seleccione la opci√≥n "manual" si desea modificar el n√∫mero de bloque de datos propuesto
para el DB de instancia.
8. Haga clic en "M√°s informaci√≥n" para guardar informaci√≥n propia sobre el objeto tecnol√≥gico.
9. Confirme con "OK".

664

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Resultado
El nuevo objeto tecnol√≥gico se genera y se guarda en la capeta "Objetos tecnol√≥gicos" del
√°rbol del proyecto. El objeto tecnol√≥gico se utiliza, cuando la instrucci√≥n para este objeto
tecnol√≥gico se llama en un OB de alarma c√≠clica.
Nota
Existe la posibilidad de activar la casilla de verificaci√≥n "Agregar nuevo y abrir" situada en la
parte inferior del di√°logo. De ese modo, la configuraci√≥n del objeto tecnol√≥gico se abrir√° una
vez agregado.

3.2.4

Configurar objetos tecnol√≥gicos
Puede configurar las propiedades de un objeto tecnol√≥gico en una CPU S7-1200 de dos
maneras.
‚óè En la ventana de inspecci√≥n del editor de programaci√≥n
‚óè En el editor de configuraci√≥n
Puede configurar las caracter√≠sticas de un objeto tecnol√≥gico en una CPU S7-300/400 s√≥lo en
el editor de configuraci√≥n.

Ventana de inspecci√≥n del editor de programaci√≥n
En la ventana de inspecci√≥n del editor de programaci√≥n, s√≥lo es posible configurar los
par√°metros que son necesarios para el funcionamiento.
Tambi√©n en el modo en l√≠nea, se muestran los valores fuera de l√≠nea de los par√°metros. Los
valores en l√≠nea se pueden modificar s√≥lo en la ventana de puesta en servicio.
Para abrir la ventana de inspecci√≥n del objeto tecnol√≥gico, proceda del siguiente modo:
1. Abra la carpeta "Bloques de programa" en el √°rbol del proyecto.
2. Haga doble clic en el bloque (OB de alarma c√≠clica) en el que llama la instrucci√≥n del
regulador de software.
El bloque se abre en el √°rea de trabajo.
3. Haga clic en la instrucci√≥n del regulador de software.
4. En la ventana de inspecci√≥n, seleccione una tras otra las fichas "Propiedades" y
"Configuraci√≥n".

Ventana de configuraci√≥n
Para cada objeto tecnol√≥gico, hay una ventana de configuraci√≥n espec√≠fica, en la que se
configuran todas las caracter√≠sticas.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

665

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
Para abrir la ventana de configuraci√≥n de un objeto tecnol√≥gico, proceda del siguiente modo:
1. Abra la carpeta "Objetos tecnol√≥gicos" en el √°rbol del proyecto.
2. Abra el objeto tecnol√≥gico en el √°rbol del proyecto.
3. Haga doble clic en el objeto "Configuraci√≥n".

S√≠mbolos
Los s√≠mbolos que aparecen en la navegaci√≥n local de la configuraci√≥n y de la ventana de
inspecci√≥n muestran m√°s detalles sobre la integridad de la configuraci√≥n:
La configuraci√≥n contiene valores predeterminados y est√° completa.
La configuraci√≥n s√≥lo contiene valores predeterminados. Con ellos es posible utilizar el objeto
tecnol√≥gico sin m√°s modificaciones.
La configuraci√≥n contiene valores definidos por el usuario o adaptados autom√°ticamente y est√°
completa
Todos los campos de entrada de la configuraci√≥n contienen valores v√°lidos y se ha modificado
como m√≠nimo un valor predeterminado.
La configuraci√≥n es incompleta o err√≥nea
Como m√≠nimo un campo de entrada o una lista desplegable est√° vac√≠o o contiene un valor no v√°lido.
El campo o la lista desplegable en cuesti√≥n se marca en rojo. Al hacer clic, el roll out con el aviso
de error indica la causa del error.

La caracter√≠sticas de un objeto tecnol√≥gico se describen con detalle en el cap√≠tulo para el
objeto tecnol√≥gico.

3.2.5

Llamar la instrucci√≥n en el programa de usuario
La instrucci√≥n del regulador de software se debe llamar en el OB de alarma c√≠clica. El tiempo
de muestreo del regulador de software se determina a partir del intervalo transcurrido entre las
llamadas en el OB de alarma c√≠clica.

Requisitos
El OB de alarma c√≠clica est√° creado y el tiempo de ciclo del OB de alarma c√≠clica est√°
configurado correctamente.

Procedimiento
Para llamar la instrucci√≥n en el programa de usuario, proceda del siguiente modo:
1. Abra la carpeta de la CPU en el √°rbol del proyecto.
2. Abra la carpeta "√Årbol del proyecto".
3. Haga doble clic en el OB de alarma c√≠clica.
El bloque se abre en el √°rea de trabajo.
4. Abra, en la ventana "Instrucciones", el grupo "Tecnolog√≠a" y la carpeta "PID Control".
La carpeta contiene todas las instrucciones para los reguladores del software que se
pueden configurar en la CPU.

666

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
5. Seleccione una instrucci√≥n y arr√°strela al OB de alarma c√≠clica correspondiente mediante
Drag & Drop.
Se abre el cuadro de di√°logo "Opciones de llamada".
6. En la lista "Nombre" seleccione un objeto tecnol√≥gico o introduzca el nombre del nuevo
objeto tecnol√≥gico.

Resultado
Si el objeto tecnol√≥gico no existe todav√≠a, √©ste se agrega. La instrucci√≥n se agrega en el OB
de alarma c√≠clica. El objeto tecnol√≥gico est√° asignado a esta llamada de la instrucci√≥n.

3.2.6

Cargar objetos tecnol√≥gicos en el dispositivo
Para poder utilizar una configuraci√≥n nueva o modificada en el modo online es necesario
cargarla en la CPU. Al cargar datos remanentes, hay que tener en cuenta las siguientes
particularidades:
‚óè Software (solo modificaciones)
‚Äì S7-1200, S7-1500:
Los datos remanentes se conservan.
‚Äì S7-300/400:
Los datos remanentes se actualizan de inmediato. La CPU no pasa a Stop.
‚óè

Cargar e inicializar programa PLC en el dispositivo
‚Äì S7-1200, S7-1500:
Los datos remanentes se actualizan con la siguiente transici√≥n de Stop a RUN. El
programa PLC solo puede cargarse completo.
‚Äì S7-300/400:
Los datos remanentes se actualizan con la siguiente transici√≥n de Stop a RUN.

Cargar datos remanentes en una CPU S7-1200 o S7-1500
Nota
La carga e inicializaci√≥n del programa PLC con la instalaci√≥n en marcha puede causar
importantes da√±os materiales y personales en caso de fallos de funcionamiento o errores de
programa.
Aseg√∫rese de que no puedan darse situaciones de peligro antes de cargar e inicializar el
programa PLC.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

667

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
Para cargar datos remanentes, proceda del siguiente modo:
1. Seleccione la entrada de la CPU en el √°rbol del proyecto.
2. Seleccione el comando "Cargar e inicializar programa PLC en el dispositivo" en el men√∫
"Online".
‚Äì Si hasta ahora no se ha establecido ninguna conexi√≥n online, se abre el cuadro de
di√°logo "Carga avanzada". Ajuste en este caso todos los par√°metros necesarios para la
conexi√≥n y haga clic en "Cargar".
‚Äì Una vez definida la conexi√≥n online, los datos de proyecto se compilan si es necesario
y se abre el cuadro de di√°logo "Cargar vista preliminar". En este cuadro de di√°logo se
muestran avisos y se indican acciones necesarias para la carga.
3. Compruebe los avisos.
Cuando la carga pueda efectuarse, el bot√≥n "Cargar" se activa.
4. Haga clic en "Cargar".
El programa PLC completo se carga y se abre el cuadro de di√°logo "Cargar resultados".
Este cuadro de di√°logo muestra el estado y las acciones tras el proceso de carga.
5. Si los m√≥dulos deben volver a arrancarse directamente tras la carga, active la casilla de
verificaci√≥n "Arrancar todos".
6. Cierre el cuadro de di√°logo "Cargar resultados" con "Finalizar".

Resultado
El programa PLC completo se carga en el dispositivo. Se borran los bloques que solo existen
online en el dispositivo. Cargando todos los bloques implicados y borrando los bloques no
necesarios en el dispositivo, se evitan incoherencias entre los bloques en el programa de
usuario.
Los avisos de la ventana de inspecci√≥n (en "Informaci√≥n > General") indican si el proceso de
carga ha finalizado correctamente.

3.2.7

Poner en marcha el regulador de software

Procedimiento
Para abrir la zona de trabajo "Puesta en servicio" de un objeto tecnol√≥gico, proceda del
siguiente modo:
1. Abra la carpeta "Objetos tecnol√≥gicos" en el √°rbol del proyecto.
2. Abra el objeto tecnol√≥gico en el √°rbol del proyecto.
3. Haga doble clic en el objeto "Puesta en servicio".
Las funciones para la puesta en servicio son espec√≠ficas para cada regulador y se describen
all√≠.

668

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

3.2.8

Guardar los par√°metros PID optimizados en el proyecto
El regulador de software se optimiza en la CPU. De este modo, los valores ya no coinciden con
su proyecto en el DB de instancia en la CPU.
Para actualizar los par√°metros PID en el proyecto con los par√°metros PID optimizados en la
CPU, proceda del siguiente modo:

Requisitos
‚óè Hay establecida una conexi√≥n online con la CPU y esta se encuentra en el estado operativo
"RUN".
‚óè Las funciones de la ventana de puesta en servicio se han habilitado con el bot√≥n "Iniciar".

Procedimiento
1. Abra la carpeta de la CPU en el √°rbol del proyecto.
2. Abra la carpeta "Objetos tecnol√≥gicos".
3. Abra un objeto tecnol√≥gico.
4. Haga doble clic en "Puesta en servicio".
5. Haga clic en el s√≠mbolo

"Cargar par√°metros PID".

6. Guarde el proyecto.

Resultado
Los par√°metros PID efectivos en ese momento se guardan en los datos del proyecto. Al cargar
nuevamente los datos de proyecto en la CPU, se utilizan los par√°metros optimizados.

3.2.9

Comparar valores

3.2.9.1

Visualizaci√≥n de comparaci√≥n y condiciones
La funci√≥n "Comparar valores" ofrece las siguientes opciones:
‚óè Comparaci√≥n de los valores de arranque configurados del proyecto con los valores de
arranque de la CPU y los valores actuales
‚óè Procesamiento directo de los valores actuales y de los valores de arranque del proyecto
‚óè Detecci√≥n y visualizaci√≥n inmediatas de errores de introducci√≥n con ayuda para su
correcci√≥n
‚óè Copia de seguridad de los valores actuales en el proyecto
‚óè Transferencia de los valores de arranque del proyecto a la CPU como valores actuales

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

669

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

S√≠mbolos y elementos de control
Est√°n disponibles los siguientes s√≠mbolos y elementos de control:
S√≠mbolo

Funci√≥n
El valor de arranque en la CPU es igual al valor de arranque configurado en el proyecto
El valor de arranque en la CPU es diferente al valor de arranque configurado en el
proyecto
No se puede realizar la comparaci√≥n entre valor de arranque en la CPU y valor de arran‚Äê
que configurado en el proyecto
Por lo menos uno de los dos valores de comparaci√≥n es incorrecto desde el punto de
vista tecnol√≥gico o sint√°ctico.
Los valores actuales se transmiten al proyecto offline
Los valores de arranque actualizados en el proyecto se transfieren a la CPU (inicializar
valores de ajuste)
Se abre el cuadro de di√°logo "Comparar valores"

Condiciones
La funci√≥n "Comparar valores" est√° disponible de forma ilimitada para S7-1200 y S7-1500.
Para S7-300 y S7-400 rige la siguiente limitaci√≥n:
En el modo de observaci√≥n una S7-300/S7-400 no puede transferir los valores de arranque a
la CPU. Estos valores no pueden mostrarse online con "Comparar valores".
Los valores actuales del objeto tecnol√≥gico se muestran y se pueden modificar directamente.

3.2.9.2

Comparar valores
A continuaci√≥n se muestra el procedimiento con el ejemplo de los "par√°metros PID".

Requisitos
‚óè Est√° configurado un proyecto con un regulador de software.
‚óè El proyecto est√° cargado en la CPU.
‚óè En el navegador de proyecto est√° abierto el di√°logo de configuraci√≥n.

Procedimiento
1. Abra el regulador de software deseado en el √°rbol del proyecto.
2. Haga doble clic en el objeto "Configuraci√≥n".
3. Navegue al cuadro de di√°logo "Par√°metros PID" en la ventana de configuraci√≥n.
4. Haga clic en el s√≠mbolo
para activar el modo de observaci√≥n.
Se muestran los s√≠mbolos y elementos de control (P√°gina 669) de la funci√≥n "Comparar
valores" detr√°s de los par√°metros.

670

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
5. Haga clic en el campo de entrada del par√°metro deseado y modifique manualmente los
valores de par√°metro mediante entrada directa.
‚Äì Si el fondo del campo de entrada es gris, los valores solo son legibles, no modificables.
‚Äì Para modificar los valores en el cuadro de di√°logo "Par√°metros PID", active primero la
entrada manual haciendo clic en la casilla de verificaci√≥n "Activar entrada manual".
6. Haga clic en el s√≠mbolo
para abrir el cuadro de di√°logo de los valores de arranque.
Este cuadro de di√°logo muestra dos valores del par√°metro:
‚Äì Valor de arranque en la CPU: En la parte superior se muestra el valor de arranque en la
CPU.
‚Äì Valor de arranque en el proyecto: En la parte inferior se muestra el valor de arranque
configurado en el proyecto.
7. Introduzca el valor deseado en el campo de entrada para el proyecto.

Detecci√≥n
Se detecta la entrada de valores incorrectos. En ese caso, se ofrece ayuda para la correcci√≥n.
Si introduce un valor sint√°cticamente err√≥neo, debajo del par√°metro se abre una ventana
desplegable con el correspondiente aviso de error. No se aplica el valor medido incorrecto.
Si introduce un valor tecnol√≥gicamente incorrecto, se abre un cuadro de di√°logo en el que se
notifica el error y se muestra informaci√≥n para la correcci√≥n:
‚óè Haciendo clic en "No" puede adoptar la correcci√≥n y corregir su entrada.
‚óè Haciendo clic en "OK" se aplica el valor incorrecto.
ATENCI√ìN
Mal funcionamiento del regulador
Los valores tecnol√≥gicamente incorrectos pueden producir un mal funcionamiento del
regulador.

Copia de seguridad de los valores actuales
Haciendo clic en el s√≠mbolo
se transfieren los valores actuales del regulador a los valores
de arranque de su proyecto configurado.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

671

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Transferir valores de proyecto a la CPU
Haciendo clic en el s√≠mbolo

se transfieren los valores configurados de su proyecto a la CPU.

PRECAUCI√ìN
Evitar da√±os personales y materiales
La carga e inicializaci√≥n del programa de usuario en la instalaci√≥n en marcha puede causar
importantes da√±os materiales y personales en caso de fallos de funcionamiento o errores de
programa.
Aseg√∫rese de que no puedan darse situaciones de peligro antes de cargar e inicializar el
programa de usuario.

3.2.10

Vista de par√°metros

3.2.10.1

Introducci√≥n a la vista de par√°metros
La vista de par√°metros le ofrece una visi√≥n de conjunto de todos los par√°metros relevantes de
un objeto tecnol√≥gico. Proporciona una vista general de los ajustes de los par√°metros, de
manera que usted puede modificarlos c√≥modamente en el modo offline y online.

‚ë†
‚ë°
‚ë¢
‚ë£

672

Ficha "Vista de par√°metros"
Barra de herramientas (P√°gina 674)
Navegaci√≥n (P√°gina 675)
Tabla de par√°metros (P√°gina 675)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Funcionalidad
Para analizar los par√°metros de los objetos tecnol√≥gicos, y para poderlos observar y forzar de
manera selectiva, hay disponibles las siguientes funciones.
Funciones de indicaci√≥n:
‚óè Indicaci√≥n de los valores de par√°metros en modo offline y online
‚óè Indicaci√≥n de la informaci√≥n de estado de los par√°metros
‚óè Indicaci√≥n de desviaciones de los valores y posibilidad de corregirlas directamente
‚óè Indicaci√≥n de errores de configuraci√≥n
‚óè Indicaci√≥n de variaciones de valores como consecuencia de dependencias de par√°metros
‚óè Indicaci√≥n de todos los valores almacenados de un par√°metro: valor de arranque en la
CPU, valor de arranque en el proyecto, valor de observaci√≥n
‚óè Indicaci√≥n de la comparaci√≥n de par√°metros de los valores almacenados de un par√°metro
Funciones de manejo:
‚óè Navegaci√≥n, para cambiar r√°pidamente entre los par√°metros y las estructuras de
par√°metros.
‚óè Filtro de texto, para encontrar m√°s r√°pidamente determinados par√°metros.
‚óè Funci√≥n de ordenaci√≥n, para adaptar el orden de par√°metros y grupos de par√°metros en
funci√≥n de las necesidades.
‚óè Funci√≥n de almacenamiento, para guardar ajustes estructurales de la vista de par√°metros.
‚óè Observar y forzar online valores de par√°metro.
‚óè Cambiar el formato de visualizaci√≥n del valor.
‚óè Guardar instant√°nea de valores de par√°metros de la CPU para reproducir situaciones
transitorias y reaccionar a ellas.
‚óè Aplicar instant√°nea de valores de par√°metros como valores de arranque.
‚óè Cargar en la CPU valores de arranque modificados.
‚óè Funciones de comparaci√≥n, para comparar entre s√≠ valores de par√°metros.

Validez
La vista de par√°metros aqu√≠ descrita est√° disponible para los siguientes objetos tecnol√≥gicos:
‚óè PID_Compact
‚óè PID_3Step
‚óè PID_Temp
‚óè CONT_C (solo S7-1500)
‚óè CONT_S (solo S7-1500)
‚óè TCONT_CP (solo S7-1500)
‚óè TCONT_S (solo S7-1500)
‚óè TO_Axis_PTO (S7-1200 Motion Control)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

673

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
‚óè TO_Positioning_Axis (S7-1200 Motion Control)
‚óè TO_CommandTable_PTO (S7-1200 Motion Control)
‚óè TO_CommandTable (S7-1200 Motion Control)

3.2.10.2

Estructura de la vista de par√°metros

Barra de herramientas
En la barra de herramientas de la vista de par√°metros pueden seleccionarse las siguientes
funciones:
S√≠mbolo

Funci√≥n

Explicaci√≥n

Observar todos

Inicia la observaci√≥n de los par√°metros visibles en la vista de par√°‚Äê
metros activa (modo online).

Crear instant√°nea de los Aplica los valores de observaci√≥n actuales a la columna "Instant√°nea"
valores de observaci√≥n y actualiza los valores de arranque en el proyecto.
y aplicar valores de ajus‚Äê Solo en modo online con PID_Compact, PID_3Step y PID_Temp.
te de esa instant√°nea co‚Äê
mo valores de arranque
Inicializar valores de
ajuste

Transfiere a la CPU los valores de arranque actualizados en el pro‚Äê
yecto.
Solo en modo online con PID_Compact, PID_3Step y PID_Temp.

Crear instant√°nea de los
valores de observaci√≥n

Aplica los valores de observaci√≥n actuales a la columna "Instant√°nea".
Solo en modo online.

Forzar una vez e inme‚Äê Este comando se ejecuta una sola vez y lo antes posible, sin referen‚Äê
diatamente todos los pa‚Äê cia a un punto determinado del programa de usuario.
r√°metros seleccionados Solo en modo online.
Seleccionar la estructu‚Äê
ra de navegaci√≥n

Cambia entre la navegaci√≥n orientada a funciones y la navegaci√≥n
orientada a datos.

Filtro de texto...

Tras introducir una cadena de caracteres: indicaci√≥n de todos los pa‚Äê
r√°metros que contienen la cadena de caracteres introducida en una de
las columnas visibles actualmente.

Seleccionar valores de
comparaci√≥n

Selecci√≥n de los valores de par√°metros que deben compararse entre
s√≠ en modo online (valor de arranque en el proyecto, valor de arranque
en la CPU, instant√°nea)
Solo en modo online.

Memorizar disposici√≥n

674

Guarda los ajustes de visualizaci√≥n de la vista de par√°metros realiza‚Äê
dos (p. ej., estructura de navegaci√≥n seleccionada, columnas activa‚Äê
das de la tabla, etc.).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Navegaci√≥n
Dentro de la ficha "Vista de par√°metros" pueden seleccionarse como alternativa las siguientes
estructuras de navegaci√≥n:
Navegaci√≥n

Explicaci√≥n

Navegaci√≥n orien‚Äê
tada a funciones

En la navegaci√≥n orientada a funciones, la estructura de los par√°‚Äê
metros se basa en la estructura de los cuadros de di√°logo de con‚Äê
figuraci√≥n (ficha "Vista de funciones"), puesta en marcha y diag‚Äê
n√≥stico.
El √∫ltimo grupo "Otros par√°metros" contiene los restantes par√°me‚Äê
tros del objeto tecnol√≥gico.
En la navegaci√≥n orientada a datos, la estructura de los par√°metros
se basa en la estructura del DB de instancia/DB tecnol√≥gico.

Navegaci√≥n orien‚Äê
tada a datos

El √∫ltimo grupo "Otros par√°metros" contiene los par√°metros que no
est√°n incluidos en el DB de instancia/DB tecnol√≥gico.

Con la lista desplegable "Seleccionar la estructura de navegaci√≥n" puede cambiar la estructura
de navegaci√≥n.

Tabla de par√°metros
La tabla siguiente muestra el significado de las distintas columnas de la tabla de par√°metros.
Las columnas pueden mostrarse u ocultarse seg√∫n convenga.
‚óè Columna "Offline" = X: la columna es visible en modo offline.
‚óè Columna "Online" = X: la columna es visible en modo online (conexi√≥n online con la CPU).
Columna

Explicaci√≥n

Offline

Online

Nombre en la vista
de funciones

Nombre del par√°metro en la vista de funciones.

X

X

Nombre completo en Ruta completa del par√°metro en el DB de instancia/DB tecnol√≥gico.
DB
Este campo de visualizaci√≥n est√° vac√≠o en el caso de par√°metros que no est√°n
incluidos en el DB de instancia/DB tecnol√≥gico.

X

X

Nombre en DB

X

X

Este campo de visualizaci√≥n est√° vac√≠o en el caso de par√°metros que no se
configuran por medio del objeto tecnol√≥gico.

Nombre del par√°metro en el DB de instancia/DB tecnol√≥gico.
Si el par√°metro es parte de una estructura o UDT, se a√±ade el prefijo ". ./".
Este campo de visualizaci√≥n est√° vac√≠o en el caso de par√°metros que no est√°n
incluidos en el DB de instancia/DB tecnol√≥gico.

Estado de la configu‚Äê Indicaci√≥n de la integridad de la configuraci√≥n mediante s√≠mbolos de estado
raci√≥n
ver Estado de la configuraci√≥n (offline) (P√°gina 683)
Resultado de la com‚Äê Resultado de la funci√≥n "Comparar valores".
paraci√≥n
Esta columna aparece si existe una conexi√≥n online y el bot√≥n
todos" est√° seleccionado.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

X
X

"Observar

675

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
Columna

Offline

Online

Valor de arranque en Valor de arranque configurado en el proyecto.
el proyecto
Indicaci√≥n de errores en caso de valores mal introducidos desde el punto de
vista sint√°ctico o tecnol√≥gico.

X

X

Valor predetermina‚Äê
do

X

X

X

X

Instant√°nea

Explicaci√≥n

Valor predeterminado del par√°metro.
Este campo de visualizaci√≥n est√° vac√≠o en el caso de par√°metros que no est√°n
incluidos en el DB de instancia/DB tecnol√≥gico.
Instant√°nea de los valores actuales en la CPU (valores de observaci√≥n).
Indicaci√≥n de errores en caso de valores incorrectos desde el punto de vista
tecnol√≥gico.

Valor de arranque en Valor de arranque en la CPU.
la CPU
Esta columna aparece si existe una conexi√≥n online y el bot√≥n
todos" est√° seleccionado.

X
"Observar

Indicaci√≥n de errores en caso de valores incorrectos desde el punto de vista
tecnol√≥gico.
X

Valor de observaci√≥n Valor actual en la CPU.
Esta columna aparece si existe una conexi√≥n online y el bot√≥n
todos" est√° seleccionado.

"Observar

Indicaci√≥n de errores en caso de valores incorrectos desde el punto de vista
tecnol√≥gico.
Valor de forzado

Valor con que debe modificarse el valor de observaci√≥n.

X

Esta columna aparece si existe una conexi√≥n online y el bot√≥n
todos" est√° seleccionado.

"Observar

Indicaci√≥n de errores en caso de valores mal introducidos desde el punto de
vista sint√°ctico o tecnol√≥gico.
Selecci√≥n del valor
de forzado

Selecci√≥n de los valores de forzado que deben transferirse por medio del bot√≥n
"Forzar una vez e inmediatamente todos los par√°metros seleccionados".

X

Esta columna aparece junto con la columna "Valor de forzado".
X

X

X

X

Valor de ajuste

Identifica el par√°metro como valor de ajuste. Estos par√°metros pueden iniciali‚Äê X
zarse online.

X

Tipo de datos

Tipo de datos del par√°metro.

X

X

X

X

Accesible desde HMI Indica si HMI puede acceder a este par√°metro durante el tiempo de ejecuci√≥n. X

X

Valor m√≠nimo

Valor tecnol√≥gico m√°s bajo del par√°metro.
Si el valor m√≠nimo depende de otros par√°metros, entonces viene determinado:
‚óè Offline: por los valores de arranque en el proyecto.
‚óè Online: por los valores de observaci√≥n.

Valor m√°ximo

Valor tecnol√≥gico m√°s alto del par√°metro.
Si el valor m√°ximo depende de otros par√°metros, entonces viene determinado:
‚óè Offline: por los valores de arranque en el proyecto.
‚óè Online: por los valores de observaci√≥n.

Este campo de visualizaci√≥n est√° vac√≠o en el caso de par√°metros que no est√°n
incluidos en el DB de instancia/DB tecnol√≥gico.
Remanencia

Identifica el valor como remanente.
Los valores de los par√°metros remanentes se conservan incluso despu√©s de
desconectar la tensi√≥n de alimentaci√≥n.

Visible en HMI

Indica si el par√°metro es visible por defecto en la lista de selecci√≥n de HMI.

X

X

Comentario

Descripci√≥n abreviada del par√°metro.

X

X

676

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Consulte tambi√©n
Comparar valores (P√°gina 669)

3.2.10.3

Abrir la vista de par√°metros

Requisitos
El objeto tecnol√≥gico se ha agregado al √°rbol de proyectos, lo que significa que se ha generado
el correspondiente DB de instancia/DB tecnol√≥gico de la instrucci√≥n.

Procedimiento
1. Abra la carpeta "Objetos tecnol√≥gicos" en el √°rbol del proyecto.
2. Abra el objeto tecnol√≥gico en el √°rbol del proyecto.
3. Haga doble clic en el objeto "Configuraci√≥n".
4. Seleccione en la esquina superior derecha la ficha "Vista de par√°metros".

Resultado
Se abre la vista de par√°metros. En la tabla de par√°metros cada par√°metro mostrado viene est√°
representado por una fila de la tabla.
Las propiedades visualizables de los par√°metros (columnas de la tabla) dependen de si la vista
de par√°metros est√° en modo offline u online.
Adem√°s, es posible mostrar y ocultar las distintas columnas de la tabla de manera selectiva.

Consulte tambi√©n
Ajuste predeterminado de la vista de par√°metros (P√°gina 677)

3.2.10.4

Ajuste predeterminado de la vista de par√°metros

Ajustes predeterminados
Para trabajar de forma efectiva con la vista de par√°metros, puede adaptar la representaci√≥n de
los par√°metros y guardar los ajustes realizados.
Pueden efectuarse y guardarse los siguientes ajustes:
‚óè Mostrar y ocultar columnas
‚óè Modificar el ancho de las columnas
‚óè Modificar el orden de las columnas
‚óè Cambiar la navegaci√≥n

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

677

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
‚óè Seleccionar un grupo de par√°metros en la navegaci√≥n
‚óè Seleccionar valores de comparaci√≥n

Mostrar y ocultar columnas
Para mostrar y ocultar columnas en la tabla de par√°metros, proceda del siguiente modo:
1. Sit√∫e el puntero del rat√≥n en el encabezado de la tabla de par√°metros.
2. En el men√∫ contextual, seleccione el comando "Mostrar/ocultar".
Se muestra la selecci√≥n de las columnas disponibles.
3. Para mostrar una columna, active la casilla de verificaci√≥n de la columna.
4. Para ocultar una columna, desactive la casilla de verificaci√≥n de la columna.
o bien
1. Sit√∫e el puntero del rat√≥n en el encabezado de la tabla de par√°metros.
2. En el men√∫ contextual, seleccione el comando "Mostrar todas las columnas" si desea
mostrar todas las columnas del modo offline u online.
Algunas columnas solo pueden mostrarse en modo online: ver Tabla de par√°metros
(P√°gina 675).

Modificar el ancho de las columnas
Para adaptar el ancho de una columna al contenido de manera que pueda leerse todo el texto
de las filas, proceda del siguiente modo:
1. Sit√∫e el puntero del rat√≥n en el encabezado de la tabla de par√°metros, a la derecha junto
a la columna que se desea optimizar, hasta que el puntero del rat√≥n adopte la forma de una
cruz.
2. Haga doble clic en este punto.
o bien
1. Abra el men√∫ contextual del encabezado de la tabla de par√°metros.
2. Haga clic en
‚Äì "Optimizar ancho de columna" o
‚Äì "Optimizar ancho de todas las columnas".
Situando brevemente el puntero del rat√≥n sobre el campo en cuesti√≥n, aparece el contenido
completo de los distintos campos en las columnas de ancho insuficiente.

Modificar el orden de las columnas
Las columnas de la tabla de par√°metros pueden situarse donde se desee.
Para modificar el orden de las columnas, proceda del siguiente modo:
1. Haga clic sobre el encabezado de la columna, arr√°strelo y su√©ltelo en el lugar deseado.
Cuando suelte el bot√≥n del rat√≥n, la columna se anclar√° en la nueva posici√≥n.

678

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Cambiar la navegaci√≥n
Para cambiar la estructura de visualizaci√≥n de los par√°metros, proceda del siguiente modo:
1. Seleccione la navegaci√≥n que desee en la lista desplegable "Seleccionar la estructura de
navegaci√≥n":
‚Äì Navegaci√≥n orientada a datos
‚Äì Navegaci√≥n orientada a funciones
Ver tambi√©n Navegaci√≥n (P√°gina 675).

Seleccionar un grupo de par√°metros en la navegaci√≥n
Dentro de la navegaci√≥n elegida puede optar entre la visualizaci√≥n "Todos los par√°metros" o
la visualizaci√≥n de un grupo de par√°metros subordinado deseado.
1. Haga clic sobre el grupo de par√°metros deseado en la navegaci√≥n.
En la tabla de par√°metros se muestran solo los par√°metros del grupo de par√°metros.

Seleccionar valores de comparaci√≥n (online)
Para ajustar los valores de comparaci√≥n para la funci√≥n "Comparar valores", proceda del
siguiente modo:
1. Seleccione en la lista desplegable "Seleccionar valores de comparaci√≥n" los valores de
comparaci√≥n que desee:
‚Äì Valor de arranque en el proyecto / valor de arranque en la CPU
‚Äì Valor de arranque en el proyecto / instant√°nea
‚Äì Valor de arranque en la CPU / instant√°nea
Por defecto est√° ajustada la opci√≥n "Valor de arranque en el proyecto / Valor de arranque en
la CPU".

Guardar el ajuste predeterminado de la vista de par√°metros
Para guardar las modificaciones anteriores de la vista de par√°metros, proceda del siguiente
modo:
1. Adapte la vista de par√°metros en funci√≥n de sus necesidades.
2. Haga clic en el bot√≥n
vista de par√°metros.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

"Memorizar disposici√≥n" situado en la parte superior derecha de la

679

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

3.2.10.5

Trabajar con la vista de par√°metros

Sinopsis
La siguiente tabla ofrece una vista general de las funciones de la vista de par√°metros que se
describen a continuaci√≥n en los modos online y offline.
‚óè Columna "Offline" = X: esta funci√≥n est√° disponible en modo offline.
‚óè Columna "Online" = X: esta funci√≥n est√° disponible en modo online.
Funci√≥n/acci√≥n

Offline

Online

Filtrar la tabla de par√°metros (P√°gina 680)

X

X

Ordenar la tabla de par√°metros (P√°gina 681)

X

X

Aplicar datos de par√°metros en otros editores (P√°gina 681)

X

X

Mostrar errores (P√°gina 682)

X

X

Editar valores de arranque en el proyecto (P√°gina 682)

X

X

Estado de la configuraci√≥n (offline) (P√°gina 683)

X

Observar online los valores en la vista de par√°metros (P√°gina 684)

X

Crear instant√°nea de los valores de observaci√≥n (P√°gina 686)

X

Forzar valores (P√°gina 687)

X

Comparar valores (P√°gina 688)

X

Aplicar valores como valores de arranque desde el programa online (P√°gi‚Äê
na 689)

X

Inicializar los valores de ajuste en el programa online (P√°gina 690)

X

Filtrar la tabla de par√°metros
Los par√°metros de la tabla de par√°metros pueden filtrarse de las siguientes maneras:
‚óè Con el filtro de texto
‚óè Con los subgrupos de la navegaci√≥n
Los dos m√©todos de filtrado pueden utilizarse simult√°neamente.

Con el filtro de texto
Puede filtrarse por los textos que son visibles en la tabla de par√°metros. Esto significa que solo
se puede filtrar por los textos de las l√≠neas de par√°metros y columnas mostradas.
1. Introduzca en el campo de entrada "Filtro de texto..." la cadena de caracteres por la que
desee filtrar.
La tabla de par√°metros solo muestra aquellos par√°metros que contienen la cadena de
caracteres.
El filtro de texto se restablece:
‚óè Seleccionando otro grupo de par√°metros en la navegaci√≥n.
‚óè Cambiando entre la navegaci√≥n orientada a datos y a funciones.

680

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Con los subgrupos de la navegaci√≥n
1. Haga clic sobre el grupo de par√°metros deseado en la navegaci√≥n, p. ej., "Static".
En la tabla de par√°metros se muestran solo los par√°metros "Static". En algunos grupos de
la navegaci√≥n puede seleccionar otros subgrupos.
2. Haga clic sobre "Todos los par√°metros" en la navegaci√≥n si desea volver a mostrar todos
los par√°metros.

Ordenar la tabla de par√°metros
Los valores de los par√°metros est√°n dispuestos por filas. La tabla de par√°metros puede
ordenarse seg√∫n cualquiera de las columnas mostradas.
‚óè En las columnas con valores num√©ricos se ordena seg√∫n la altura del valor num√©rico.
‚óè En las columnas con texto se ordena alfab√©ticamente.

Ordenar por columnas
1. Sit√∫e el puntero del rat√≥n en el encabezado de la columna deseada.
El fondo de esta celda se marca en azul.
2. Haga clic sobre el encabezado de la columna.

Resultado
Toda la tabla de par√°metros se ordena seg√∫n la columna marcada. En el encabezado de la
columna aparece un tri√°ngulo con la punta hacia arriba.
Haciendo clic de nuevo sobre el encabezado de la columna, el orden cambia de la siguiente
manera:
‚óè S√≠mbolo "‚ñ≤": la tabla de par√°metros se ordena de manera ascendente.
‚óè S√≠mbolo "‚ñº": la tabla de par√°metros se ordena de manera descendente.
‚óè Ning√∫n s√≠mbolo: se anula la ordenaci√≥n. La tabla de par√°metros adopta la vista
predeterminada.
En la ordenaci√≥n se ignora el prefijo "../" de la columna "Nombre en DB".

Aplicar datos de par√°metros en otros editores
Una vez seleccionada toda una fila de par√°metros de la tabla de par√°metros, con
‚óè arrastrar y soltar
‚óè <Ctrl+C>/<Ctrl+V>
‚óè copiar/pegar por medio del men√∫ contextual
pueden aplicarse par√°metros en los siguientes editores del TIA Portal:
‚óè en el editor de programas;
‚óè en la tabla de observaci√≥n;
‚óè en la tabla de se√±ales para Trace.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

681

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
El par√°metro se a√±ade con el nombre completo: ver indicaci√≥n en la columna "Nombre
completo en DB".

Mostrar errores
Se√±alizaci√≥n de errores
Los errores de parametrizaci√≥n que conllevan errores de compilaci√≥n (p. ej., rebase de l√≠mite),
se indican en la vista de par√°metros.
Cada vez que se introduce un valor en la vista de par√°metros, se comprueba y muestra de
inmediato la correcci√≥n tecnol√≥gica y sint√°ctica.
Los valores err√≥neos se indican con:
‚óè Un s√≠mbolo de error rojo en las columnas "Estado de la configuraci√≥n" (modo offline) o
"Resultado de la comparaci√≥n" (modo online, en funci√≥n del tipo de comparaci√≥n elegido)
y/o
‚óè El campo de la tabla con el fondo rojo
Al hacer clic sobre el campo err√≥neo, se muestra el mensaje de error desplegable que
indica el rango de valores admisible o la sintaxis requerida (formato)

Errores de compilaci√≥n
Desde el mensaje de error del compilador puede abrirse directamente la vista de par√°metros
(navegaci√≥n orientada a funciones) con el par√°metro causante del error para aquellos
par√°metros que no se muestren en el cuadro de di√°logo de configuraci√≥n.

Editar valores de arranque en el proyecto
Con la vista de par√°metros pueden editarse los valores de arranque en el proyecto en los
modos offline y online:
‚óè Los valores se modifican en la columna "Valor de arranque en el proyecto" de la tabla de
par√°metros.
‚óè En la columna "Estado de la configuraci√≥n" de la tabla de par√°metros se muestra el
progreso de la configuraci√≥n mediante los s√≠mbolos de estado conocidos del cuadro de
di√°logo de configuraci√≥n del objeto tecnol√≥gico.

Condiciones
‚óè Si hay otros par√°metros que dependen del par√°metro cuyo valor de arranque se ha
modificado, el valor de arranque del par√°metro dependiente se adapta igualmente.
‚óè Si un par√°metro de un objeto tecnol√≥gico no es editable, tampoco lo es en la vista de
par√°metros. La posibilidad de edici√≥n de un par√°metro puede depender tambi√©n de los
valores de otros par√°metros.

682

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Definir nuevos valores de arranque
Para especificar valores de arranque para par√°metros en la vista de par√°metros, proceda del
siguiente modo:
1. Abra la vista de par√°metros del objeto tecnol√≥gico.
2. Introduzca en la columna "Valor de arranque en el proyecto" los valores de arranque
deseados. El valor debe ser conforme al tipo de datos del par√°metro y no debe rebasar el
rango de valores del par√°metro.
En las columnas "Valor m√°ximo" y "Valor m√≠nimo" se muestran los valores l√≠mite del rango
de valores.
En la columna "Estado de la configuraci√≥n" se muestra el "progreso" de la configuraci√≥n
mediante s√≠mbolos de colores.
Ver tambi√©n Estado de la configuraci√≥n (offline) (P√°gina 683)
Una vez adaptados los valores de arranque y cargado el objeto tecnol√≥gico en la CPU, los
par√°metros adoptan durante el arranque el valor definido, siempre y cuando estos par√°metros
est√©n declarados como remanentes (columna "Remanencia").

Se√±alizaci√≥n de errores
Cuando se introduce un valor de arranque, se comprueba y muestra de inmediato la correcci√≥n
tecnol√≥gica y sint√°ctica:
Los valores de arranque err√≥neos se indican con
‚óè Un s√≠mbolo de error rojo en las columnas "Estado de la configuraci√≥n" (modo offline) o
"Resultado de la comparaci√≥n" (modo online, en funci√≥n del tipo de comparaci√≥n elegido)
y/o
‚óè Un fondo rojo en el campo "Valor de arranque en el proyecto"
Al hacer clic sobre el campo err√≥neo, se muestra el mensaje de error desplegable que
indica el rango de valores admisible o la sintaxis requerida (formato)

Corregir valores de arranque err√≥neos
1. Corrija los valores de arranque err√≥neos con ayuda de la informaci√≥n del mensaje de error
desplegable.
El s√≠mbolo de error rojo, el fondo rojo del campo y el mensaje de error desplegable dejar√°n
de mostrarse.
El proyecto solo puede compilarse correctamente con valores de arranque correctos.

Estado de la configuraci√≥n (offline)
El estado de la configuraci√≥n se indica mediante s√≠mbolos:
‚óè En la columna "Estado de la configuraci√≥n" en la tabla de par√°metros
‚óè En la estructura de navegaci√≥n de la navegaci√≥n orientada a funciones o la navegaci√≥n
orientada a datos

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

683

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

S√≠mbolo en la columna "Estado de la configuraci√≥n"
S√≠mbolo

Significado
El valor de arranque del par√°metro coincide con el valor predeterminado y es v√°lido. El
usuario todav√≠a no ha definido ning√∫n valor de arranque.
El valor de arranque del par√°metro contiene un valor definido por el usuario o adaptado
autom√°ticamente. El valor de arranque difiere del valor predeterminado. El valor de
arranque no contiene errores y es v√°lido.
El valor de arranque del par√°metro no es v√°lido (error sint√°ctico o tecnol√≥gico).
El campo de entrada tiene fondo rojo. Al hacer clic, el roll out con el aviso de error indica
la causa del error.
Solo con S7-1200 Motion Control:
El valor de arranque del par√°metro es v√°lido, pero contiene advertencias.
El campo de entrada tiene fondo amarillo.
El par√°metro no es relevante en la configuraci√≥n actual.

S√≠mbolo en la navegaci√≥n
Los s√≠mbolos en la navegaci√≥n muestran el "progreso" de la configuraci√≥n de la misma manera
que en el cuadro de di√°logo de configuraci√≥n del objeto tecnol√≥gico.

Consulte tambi√©n
Configurar objetos tecnol√≥gicos (P√°gina 665)

Observar online los valores en la vista de par√°metros
Es posible observar directamente en la vista de par√°metros los valores que los par√°metros del
objeto tecnol√≥gico van adoptando actualmente en la CPU (valores de observaci√≥n).

Requisitos
‚óè Existe una conexi√≥n online.
‚óè El objeto tecnol√≥gico est√° cargado en la CPU.
‚óè La ejecuci√≥n del programa est√° activa (CPU en "RUN").
‚óè La vista de par√°metros del objeto tecnol√≥gico est√° abierta.

684

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Procedimiento
1. Inicie la observaci√≥n haciendo clic en el s√≠mbolo
.
En cuanto la vista de par√°metros est√© online, se mostrar√°n tambi√©n las siguientes
columnas:
‚Äì Resultado de la comparaci√≥n
‚Äì Valor de arranque en la CPU
‚Äì Valor de observaci√≥n
‚Äì Valor de forzado
‚Äì Selecci√≥n del valor de forzado
La columna "Valor de observaci√≥n" muestra los valores actuales de los par√°metros en la
CPU.
Significado de las dem√°s columnas: ver Tabla de par√°metros (P√°gina 675)
2. La observaci√≥n se finaliza haciendo clic de nuevo en el s√≠mbolo

.

Indicaci√≥n
Todas las columnas disponibles √∫nicamente online tienen fondo naranja:
‚óè Los valores de las celdas naranja claro
‚óè Los valores de las celdas con fondo naranja oscuro

se pueden modificar.
no admiten modificaciones.

Cambio del formato de visualizaci√≥n del valor
El formato de visualizaci√≥n del valor puede seleccionarse en el men√∫ contextual de una fila en
la vista de par√°metros del objeto tecnol√≥gico.
El formato de visualizaci√≥n de los siguientes valores puede cambiarse tanto en modo online
como offline:
‚óè Valor de arranque en el proyecto
‚óè Valor de arranque en la CPU
‚óè Valor m√°ximo
‚óè Valor m√≠nimo
‚óè Instant√°nea
‚óè Valor de observaci√≥n
‚óè Valor predeterminado
‚óè Valor de forzado
El formato de visualizaci√≥n configurado se aplica a todos los valores de la fila.
Pueden modificarse los siguientes formatos de visualizaci√≥n del valor:
‚óè Predeterminado
‚óè Hex
‚óè Octal

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

685

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
‚óè Bin
‚óè Dec (+/-)
‚óè DEC
Solo pueden elegirse los formatos de visualizaci√≥n soportados dependiendo del par√°metro
seleccionado en la vista de par√°metros.

Requisitos
‚óè La vista de par√°metros del objeto tecnol√≥gico est√° abierta.

Procedimiento
Para cambiar el formato de visualizaci√≥n del valor, haga lo siguiente:
1. Seleccione una o varias filas en las que desee cambiar el formato de visualizaci√≥n.
2. Seleccione el comando "Formato visualizaci√≥n" en el men√∫ contextual.
3. Seleccione el formato de visualizaci√≥n deseado.
Nota
Para modificar el formato de visualizaci√≥n de un tipo de datos determinado en varias filas,
ordene la vista de par√°metros por este tipo de datos. A continuaci√≥n, seleccione la primera y
la √∫ltima fila con este tipo de datos manteniendo pulsada la tecla <May√∫s> y modifique el
formato de visualizaci√≥n de las filas seleccionadas.

Crear instant√°nea de los valores de observaci√≥n
Es posible guardar los valores actuales del objeto tecnol√≥gico en la CPU (valores de
observaci√≥n) y mostrarlos en la vista de par√°metros.

Requisitos
‚óè Existe una conexi√≥n online.
‚óè El objeto tecnol√≥gico est√° cargado en la CPU.
‚óè La ejecuci√≥n del programa est√° activa (CPU en "RUN").
‚óè La vista de par√°metros del objeto tecnol√≥gico est√° abierta.
‚óè El bot√≥n "Observar todos"

est√° activado.

Procedimiento
Para mostrar los valores actuales de los par√°metros, proceda del siguiente modo:
1. Haga clic en la vista de par√°metros sobre el s√≠mbolo
de observaci√≥n".

686

"Crear instant√°nea de los valores

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Resultado
Los valores de observaci√≥n actuales se aplican una vez en la columna "Instant√°nea" de la tabla
de par√°metros.
Los valores "congelados" as√≠ pueden analizarse mientras que los valores de observaci√≥n de
la columna "Valores de observaci√≥n" se siguen actualizando.

Forzar valores
Con la vista de par√°metros puede forzar los valores del objeto tecnol√≥gico en la CPU.
Puede asignar valores al par√°metro (valor de forzado) una sola vez y forzarlos de inmediato.
Al ejecutar esta funci√≥n la orden de forzado se lleva a cabo lo antes posible, sin referencia a
un punto determinado del programa de usuario.

PELIGRO
Peligro en el forzado:
Una modificaci√≥n de los valores de los par√°metros con la instalaci√≥n en marcha puede causar
importantes da√±os materiales y personales en caso de fallos de funcionamiento o errores de
programa.
Aseg√∫rese de que no puedan darse situaciones de peligro antes de ejecutar la funci√≥n
"Forzar".

Requisitos
‚óè Existe una conexi√≥n online.
‚óè El objeto tecnol√≥gico est√° cargado en la CPU.
‚óè La ejecuci√≥n del programa est√° activa (CPU en "RUN").
‚óè La vista de par√°metros del objeto tecnol√≥gico est√° abierta.
‚óè El bot√≥n "Observar todos"

est√° activado.

‚óè El par√°metro puede forzarse (el campo correspondiente en la columna "Valor de forzado"
tiene fondo naranja claro).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

687

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Procedimiento
Para forzar par√°metros inmediatamente, proceda del siguiente modo:
1. Introduzca los valores de forzado deseados en la columna "Valores de forzado" de la tabla
de par√°metros.
2. Compruebe si se ha activado la casilla de verificaci√≥n para el forzado en la columna
"Selecci√≥n del valor de forzado".
Los valores de forzado y las casillas de verificaci√≥n correspondientes de los par√°metros
dependientes se adaptan tambi√©n autom√°ticamente.
3. Haga clic en el s√≠mbolo
seleccionados".

"Forzar una vez e inmediatamente todos los par√°metros

Los par√°metros seleccionados se fuerzan una vez e inmediatamente con los valores
especificados y pueden observarse en la columna "Valores de observaci√≥n". Las casillas de
verificaci√≥n para el forzado en la columna "Selecci√≥n del valor de forzado" se desactivan
autom√°ticamente una vez ejecutada la orden de forzado.

Se√±alizaci√≥n de errores
Cuando se introduce un valor de forzado, se comprueba y muestra de inmediato la correcci√≥n
tecnol√≥gica y sint√°ctica:
Los valores de forzado err√≥neos se indican con
‚óè Un fondo rojo en el campo "Valor de forzado"
y
‚óè Al hacer clic sobre el campo err√≥neo, se muestra el mensaje de error desplegable que
indica el rango de valores admisible o la sintaxis requerida (formato)

Valores de forzado err√≥neos
‚óè Los valores de forzado err√≥neos desde el punto de vista tecnol√≥gico pueden transferirse.
‚óè Los valores de forzado err√≥neos desde el punto de vista sint√°ctico no pueden transferirse.

Comparar valores
Las funciones de comparaci√≥n permiten comparar los siguientes valores almacenados de un
par√°metro:
‚óè Valor de arranque en el proyecto
‚óè Valor de arranque en la CPU
‚óè Instant√°nea

Requisitos
‚óè Existe una conexi√≥n online.
‚óè El objeto tecnol√≥gico est√° cargado en la CPU.
‚óè La ejecuci√≥n del programa est√° activa (CPU en "RUN").

688

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
‚óè La vista de par√°metros del objeto tecnol√≥gico est√° abierta.
‚óè El bot√≥n "Observar todos"

est√° activado.

Procedimiento
Para comparar los valores de arranque de los diversos sistemas de destino, proceda del
siguiente modo:
1. Haga clic en el s√≠mbolo
"Seleccionar valores de comparaci√≥n".
Se abre una lista de selecci√≥n con las opciones de comparaci√≥n:
‚Äì Valor de arranque en el proyecto - valor de arranque en la CPU (ajuste predeterminado)
‚Äì Valor de arranque en el proyecto - instant√°nea
‚Äì Valor de arranque en la CPU - instant√°nea
2. Elija la opci√≥n de comparaci√≥n que desee.
La opci√≥n de comparaci√≥n seleccionada se ejecuta de la siguiente manera:
‚Äì En las celdas del encabezado de las dos columnas seleccionadas para la comparaci√≥n
aparece un s√≠mbolo con una balanza.
‚Äì En la columna "Resultado de la comparaci√≥n" se muestra mediante s√≠mbolos el
resultado de la comparaci√≥n de las columnas seleccionadas.

S√≠mbolo en la columna "Resultado de la comparaci√≥n"
S√≠mbolo

Significado
Los valores de comparaci√≥n son iguales y no contienen errores.
Los valores de comparaci√≥n son distintos y no contienen errores.
Por lo menos uno de los dos valores de comparaci√≥n es incorrecto desde el punto de
vista tecnol√≥gico o sint√°ctico.
No se ha podido llevar a cabo la comparaci√≥n. Por lo menos uno de los dos valores de
comparaci√≥n no est√° disponible (p. ej., instant√°nea).
No tiene sentido comparar el valor, ya que no es relevante en una de las configuraciones.

S√≠mbolo en la navegaci√≥n
Los s√≠mbolos se muestran de la misma manera en la navegaci√≥n cuando el resultado de la
comparaci√≥n se cumple como m√≠nimo para uno de los par√°metros de debajo de la estructura
de navegaci√≥n mostrada.

Aplicar valores como valores de arranque desde el programa online
Para aplicar al proyecto en un paso valores optimizados de la CPU como valores de arranque,
genere una instant√°nea de los valores de observaci√≥n. A continuaci√≥n, los valores de la
instant√°nea marcados como "Valor de ajuste" se aplicar√°n como valores de arranque en el
proyecto.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

689

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software

Requisitos
‚óè El objeto tecnol√≥gico es de tipo "PID_Compact" o "PID_3Step".
‚óè Existe una conexi√≥n online.
‚óè El objeto tecnol√≥gico est√° cargado en la CPU.
‚óè La ejecuci√≥n del programa est√° activa (CPU en "RUN").
‚óè La vista de par√°metros del objeto tecnol√≥gico est√° abierta.
‚óè El bot√≥n "Observar todos"

est√° activado.

Procedimiento
Para aplicar valores optimizados de la CPU, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo
"Crear instant√°nea de los valores de observaci√≥n y aplicar
valores de ajuste de esa instant√°nea como valores de arranque".

Resultado
Los valores de observaci√≥n actuales se aplican a la columna "Instant√°nea" y sus valores de
ajuste se copian como valores de arranque nuevos en la columna "Valor de arranque en el
proyecto".

Nota
Aplicar valores de par√°metros individuales
Tambi√©n es posible aplicar los valores de determinados par√°metros que no est√©n marcados
como valor de ajuste de la columna "Instant√°nea" a la columna "Valores de arranque en el
proyecto". Para ello copie los valores con ayuda de los comandos "Copiar"¬∑y "Pegar" del men√∫
contextual y p√©guelos en la columna "Valor de arranque en el proyecto".

Inicializar los valores de ajuste en el programa online
Todos los par√°metros marcados en la vista de par√°metros como "Valor de ajuste" se pueden
inicializar en la CPU con nuevos valores en un solo paso. Para ello se deben cargar los valores
de arranque del proyecto en la CPU. La CPU se mantiene en el estado operativo "RUN".

690

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.2 Configuraci√≥n de un regulador por software
Para evitar una p√©rdida de datos en la CPU al arrancar en fr√≠o o al reiniciar (arranque en
caliente), es necesario cargar tambi√©n el objeto tecnol√≥gico en la CPU.
PELIGRO
Peligro al modificar valores de par√°metros
Una modificaci√≥n de los valores de los par√°metros con la instalaci√≥n en marcha puede causar
importantes da√±os materiales y personales en caso de fallos de funcionamiento o errores de
programa.
Aseg√∫rese de que no puedan darse situaciones de peligro antes de reinicializar los valores de
ajuste.

Requisitos
‚óè El objeto tecnol√≥gico es de tipo "PID_Compact" o "PID_3Step".
‚óè Existe una conexi√≥n online.
‚óè El objeto tecnol√≥gico est√° cargado en la CPU.
‚óè La ejecuci√≥n del programa est√° activa (CPU en "RUN").
‚óè La vista de par√°metros del objeto tecnol√≥gico est√° abierta.
‚óè El bot√≥n "Observar todos"

est√° activado.

‚óè Los par√°metros marcados como "Valor de ajuste" disponen de un "Valor de arranque en el
proyecto" sin errores tecnol√≥gicos o sint√°cticos.

Procedimiento
Para inicializar todos los valores de ajuste, proceda del siguiente modo:
1. Introduzca los valores deseados en la columna "Valor de arranque en el proyecto".
Compruebe que los valores de arranque no contengan errores tecnol√≥gicos o sint√°cticos.
2. Haga clic en el s√≠mbolo

"Inicializar valores de ajuste".

Resultado
Los valores de ajuste de la CPU se inicializan con los valores de arranque del proyecto.

3.2.11

Mostrar el DB de instancia de un objeto tecnol√≥gico
Para cada objeto tecnol√≥gico, se crea un DB de instancia, en el que est√°n guardados los
par√°metros y las variables est√°ticas.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

691

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Procedimiento
Para mostrar el DB de instancia de un objeto tecnol√≥gico, proceda del siguiente modo:
1. Abra la carpeta de la CPU en el √°rbol del proyecto.
2. Abra la carpeta "Objetos tecnol√≥gicos".
3. Marque un objeto tecnol√≥gico.
4. Seleccione la orden "Abrir en el editor DP" en el men√∫ contextual.

3.3

Regulaci√≥n PID (S7-1200, S7-1500)

3.3.1

Utilizar PID_Compact

3.3.1.1

Objeto tecnol√≥gico PID_Compact
El objeto tecnol√≥gico PID_Compact ofrece un regulador PID continuo con optimizaci√≥n
integrada. Asimismo, tambi√©n es posible configurar un regulador de impulsos. Es posible elegir
entre el modo manual y el autom√°tico.
PID-Compact registra de forma continua el valor real medido dentro de un lazo de regulaci√≥n
y lo compara con la consigna deseada. A partir del error de regulaci√≥n resultante, la instrucci√≥n
PID_Compact calcula un valor de salida, con el que el valor real se iguala con la consigna con
la m√°xima rapidez y estabilidad. En los reguladores PID, el valor de salida se compone de tres
acciones:
‚óè Acci√≥n P
La acci√≥n P del valor de salida aumenta proporcionalmente al error de regulaci√≥n.
‚óè Acci√≥n I
La acci√≥n I del valor de salida aumenta hasta que se compensa el error de regulaci√≥n.
‚óè Acci√≥n D
La acci√≥n D aumenta con una velocidad de variaci√≥n creciente del error de regulaci√≥n. El
valor real se iguala lo m√°s r√°pidamente posible con la consigna. Si la velocidad de variaci√≥n
del error de regulaci√≥n vuelve a reducirse, tambi√©n lo hace la acci√≥n D.
La instrucci√≥n PID_Compact calcula los par√°metros P, I y D para su sistema regulado de forma
aut√≥noma durante la optimizaci√≥n inicial. Los par√°metros pueden optimizarse a√∫n m√°s a
trav√©s de una optimizaci√≥n fina. No es necesario determinar los par√°metros manualmente.

Informaci√≥n adicional
‚óè Vista general de los reguladores de software (P√°gina 661)
‚óè Agregar objetos tecnol√≥gicos (P√°gina 664)
‚óè Configurar objetos tecnol√≥gicos (P√°gina 665)
‚óè Configurar PID_Compact V2 (P√°gina 693)
‚óè Configurar PID_Compact V1 (P√°gina 714)

692

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Preguntas frecuentes (FAQ)
Para m√°s informaci√≥n al respecto, consulte la siguiente pregunta frecuente (FAQ) en el
Siemens Industry Online Support:
‚óè ID de art√≠culo 79047707 (https://support.industry.siemens.com/cs/ww/en/view/79047707)

3.3.1.2

PID_Compact V2

Configurar PID_Compact V2
Ajustes b√°sicos V2
Introducci√≥n V2
Configure las propiedades siguientes del objeto tecnol√≥gico PID_Compact en el √°rea de
ajustes b√°sicos de la ventana de inspecci√≥n o de configuraci√≥n.
‚óè Magnitud f√≠sica
‚óè Sentido de regulaci√≥n
‚óè Comportamiento en arranque despu√©s de un reset
‚óè Consigna (s√≥lo en la ventana de inspecci√≥n)
‚óè Valor real (s√≥lo en la ventana de inspecci√≥n)
‚óè Valor de salida (s√≥lo en la ventana de inspecci√≥n)

Consigna, valor real y valor de salida
La consigna, el valor real y el valor de salida s√≥lo pueden configurarse en la ventana de
inspecci√≥n del editor de programaci√≥n. Para cada salida digital elija la fuente:
‚óè DB de instancia
Se utiliza el valor que se encuentra almacenado en el DB de instancia.
El valor debe actualizarse en el DB de instancia del programa de usuario.
En la instrucci√≥n no puede haber ning√∫n valor.
Modificaci√≥n posible desde HMI.
‚óè Instrucci√≥n
Se utiliza el valor que se conecta con la instrucci√≥n.
Cada vez que se llama la instrucci√≥n, el valor se escribe en el DB de instancia.
No se puede modificar desde HMI.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

693

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Tipo de regulaci√≥n V2
Magnitud f√≠sica
En el grupo "Tipo de regulaci√≥n", seleccione la magnitud f√≠sica y la unidad para la consigna, el
valor real y la magnitud perturbadora. La consigna, el valor real y la magnitud perturbadora se
mostrar√°n en dicha unidad.

Sentido de regulaci√≥n
Por lo general, un aumento del valor de salida debe lograr un aumento del valor real. En este
caso, se habla de un sentido de regulaci√≥n normal.
PID_Compact no funciona con ganancia proporcional negativa. Para reducir el valor real con
un valor de salida m√°s elevado, active la casilla de verificaci√≥n "Inversi√≥n sentido de
regulaci√≥n".
Ejemplos
‚óè Al abrir una v√°lvula de escape se reduce el nivel de llenado de un recipiente.
‚óè Si se aumenta la potencia de refrigeraci√≥n, disminuye la temperatura.

Comportamiento en arranque
1. Para cambiar inmediatamente al modo de operaci√≥n "Inactivo" tras el rearranque de la
CPU, desactive la casilla de verificaci√≥n "Activar Mode tras rearrancar la CPU".
Para cambiar inmediatamente, tras el rearranque de la CPU, al modo de operaci√≥n
almacenado en Mode, active la casilla de verificaci√≥n "Activar Mode tras rearrancar la
CPU".
2. En la lista desplegable "Poner Mode a", seleccione el modo de operaci√≥n que debe
activarse tras una carga completa en el dispositivo.
Tras una carga completa en el dispositivo, PID_Compact arranca en el modo de operaci√≥n
seleccionado. Con cada rearranque, PID_Compact arranca en el √∫ltimo modo de operaci√≥n
almacenado en Mode.
Ejemplo
Se ha activado la casilla de verificaci√≥n "Activar Mode tras rearrancar la CPU" y se ha
seleccionado la entrada "Optimizaci√≥n inicial" en la lista "Poner Mode a". Tras una carga
completa en el dispositivo, PID_Compact arranca en el modo de operaci√≥n "Optimizaci√≥n
inicial". Si la optimizaci√≥n inicial a√∫n est√° activa y se rearranca la CPU, PID_Compact arranca
de nuevo en el modo de operaci√≥n "Optimizaci√≥n inicial". Si la optimizaci√≥n inicial ha finalizado
correctamente, el modo autom√°tico a√∫n est√° activo y se rearranca la CPU, PID_Compact
arranca en "Modo autom√°tico".

694

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Consigna V2
Procedimiento
Para especificar una consigna fija, proceda del siguiente modo:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 ¬∞C.
3. En caso necesario, elimine una entrada de la instrucci√≥n.
Para especificar una consigna variable, proceda del siguiente modo:
1. Seleccione "Instrucci√≥n".
2. Indique el nombre de la variable REAL en la que est√° almacenada la consigna.
Es posible asignar varios valores controlados por programa a la variable REAL para, por
ejemplo, modificar la consigna de tiempo de forma controlada.

Valor real V2
Si utiliza directamente el valor de la entrada anal√≥gica, PID_Compact escala el valor de la
entrada anal√≥gica al tama√±o f√≠sico.
Si se desea acondicionar el valor de la entrada anal√≥gica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada anal√≥gica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada anal√≥gica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucci√≥n" como fuente.
3. Introduzca la direcci√≥n de la entrada anal√≥gica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucci√≥n" como fuente.
3. Indique el nombre de la variable en la que est√° almacenado el valor real acondicionado.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

695

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Valor de salida V2
PID_Compact ofrece tres valores de salida. El valor de salida que se utilice depender√° del
actuador.
‚óè Output_PER
El actuador se activa a trav√©s de una salida anal√≥gica y se controla con una se√±al continua,
como puede ser 0 a 10 V, 4 a 20 mA.
‚óè Output
El valor de salida debe acondicionarse mediante el programa de usuario, por ejemplo,
porque el actuador muestra un comportamiento no lineal.
‚óè Output_PWM
El actuador se controla a trav√©s de una salida digital. Una modulaci√≥n de ancho de impulsos
permite formar tiempos de conexi√≥n y desconexi√≥n variables.

Procedimiento
Para utilizar el valor de salida anal√≥gico, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output_PER" (anal√≥gica).
2. Seleccione "Instrucci√≥n".
3. Introduzca la direcci√≥n de la salida anal√≥gica.
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "Output", seleccione la entrada "Output".
2. Seleccione "DB de instancia".
El valor de salida calculado se guarda en DB de instancia.
3. Para acondicionar el valor de salida utilice el par√°metro de salida Output.
4. Transfiera el valor de salida acondicionado hasta el actuador a trav√©s de una salida digital
o anal√≥gica de la CPU.
Para utilizar el valor de salida digital, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output_PWM".
2. Seleccione "Instrucci√≥n".
3. Introduzca la direcci√≥n de la salida digital.

Ajustes de valor real V2
Escalar valor real V2
Si en los ajustes b√°sicos ha configurado el uso de Input_PER, deber√° convertir el valor de la
entrada anal√≥gica a la magnitud f√≠sica del valor real. En el cuadro de visualizaci√≥n Input_PER
se muestra la configuraci√≥n actual.
Si el valor real es directamente proporcional al valor de la entrada anal√≥gica, Input_PER se
escalar√° a partir de un par de valores inferior y superior.

696

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Procedimiento
Para escalar el valor real, haga lo siguiente:
1. En los campos de entrada "Valor real inferior escalado" y "abajo", introduzca el par de
valores inferior.
2. En los campos de entrada "Valor real superior escalado" y "arriba", introduzca el par de
valores superior.
La configuraci√≥n hardware contiene pares de valores predeterminados. Para utilizar los pares
de valores contenidos en la configuraci√≥n hardware, haga lo siguiente:
1. Seleccione en el editor de programaci√≥n la instrucci√≥n PID_Compact.
2. En los ajustes b√°sicos, interconecte Input_PER con una entrada anal√≥gica.
3. En los ajustes del valor real, haga clic en el bot√≥n "Ajuste autom√°tico".
Los valores existentes se sobrescribir√°n con los valores de la configuraci√≥n hardware.

L√≠mites de valor real V2
Como valores l√≠mite para el sistema regulado defina los l√≠mites superior e inferior absolutos del
valor real de modo que sean razonables. Tan pronto como dichos valores se rebasen por
exceso o defecto, se producir√° un error (ErrorBits = 0001h). La optimizaci√≥n se cancela cuando
se rebasan los valores reales. Configure en los ajustes de los valores de salida c√≥mo debe
reaccionar PID_Compact en caso de error en el modo autom√°tico.

Ajustes avanzados V2
Vigilancia de valor real V2
Configure un l√≠mite de advertencia inferior y uno superior para el valor real en la ventana de
configuraci√≥n "Monitorizaci√≥n del valor real". Si durante el funcionamiento se rebasa uno de los
l√≠mites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucci√≥n
"PID_Compact".
‚óè En el par√°metro de salida "InputWarning_H", si se ha rebasado por exceso el l√≠mite superior
de advertencia
‚óè En el par√°metro de salida "InputWarning_L", si se ha rebasado por defecto el l√≠mite inferior
de advertencia
Los l√≠mites de advertencia deben encontrarse dentro de los l√≠mites superior e inferior del valor
real.
Si no introduce ning√∫n valor, se utilizan los l√≠mites superior e inferior del valor real.

Ejemplo
L√≠mite superior del valor real = 98 ¬∞C; l√≠mite superior de advertencia = 90 ¬∞C
L√≠mite inferior de advertencia = 10 ‚ÑÉ; l√≠mite inferior del valor real = 0 ‚ÑÉ

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

697

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
PID_Compact se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

ErrorBits

Modo de opera‚Äê
ci√≥n

> 98 ¬∞C

TRUE

FALSE

0001h

Inactivo o
valor de salida sus‚Äê
titutivo con monito‚Äê
rizaci√≥n de errores

‚â§ 98 ¬∞C y > 90 ¬∞C

TRUE

FALSE

0000h

Modo autom√°tico

‚â§ 90 ¬∞C y ‚â• 10 ¬∞C

FALSE

FALSE

0000h

Modo autom√°tico

< 10¬∞C y ‚â• 0 ¬∞C

FALSE

TRUE

0000h

Modo autom√°tico

< 0 ¬∞C

FALSE

TRUE

0001h

Inactivo o
valor de salida sus‚Äê
titutivo con monito‚Äê
rizaci√≥n de errores

Configure en los ajustes de los valores de salida c√≥mo debe reaccionar PID_Compact si se
rebasa el l√≠mite superior o inferior del valor real.

Limitaciones de PWM V2
Una modulaci√≥n de ancho de impulsos transforma el valor del par√°metro de salida Output en
un tren de impulsos que se emite por el par√°metro de salida Output_PWM.
Output se calcula en el tiempo de muestreo Algoritmo PID. El tiempo de muestreo se utiliza
como duraci√≥n del per√≠odo de la modulaci√≥n por ancho de impulso.
El tiempo de muestreo Algoritmo PID se determina durante la optimizaci√≥n inicial o la
optimizaci√≥n fina. Al ajustar los par√°metros PID manualmente, debe configurarse tambi√©n ah√≠
el tiempo de muestreo Algoritmo PID.
Output_PWM se emite en el tiempo de muestreo PID_Compact. El tiempo de muestreo
PID_Compact equivale al tiempo de ciclo del OB invocante.
La duraci√≥n del impulso es proporcional al valor de Output y es siempre un m√∫ltiplo entero del
tiempo de muestreo PID_Compact.

698

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
2XWSXW





W PV

2XWSXWB3:0
758(
)$/6(

W PV





‚ë†
‚ë°
‚ë¢
‚ë£



Tiempo de muestreo PID_Compact
Tiempo de muestreo Algoritmo PID
Duraci√≥n del impulso
Duraci√≥n de la pausa

"Tiempo conexi√≥n m√≠n." y "Tiempo de desconex. m√≠n." se redondean a un m√∫ltiplo entero del
tiempo de muestreo PID_Compact.
Un impulso o una pausa nunca son m√°s cortas que los tiempos de conexi√≥n o desconexi√≥n
m√≠nimos. Las imprecisiones que se producen se suman y se compensan en el siguiente ciclo.
Ejemplo
Tiempo de muestreo PID_Compact (equivale al tiempo de ciclo del OB que efect√∫a la llamada)
= 100 ms
Tiempo de muestreo Algoritmo PID (equivale a la duraci√≥n del periodo)= 1000 ms
Tiempo conexi√≥n m√≠n. = 200 ms
Output es constante del 15%. El m√≠nimo impulso que PID_Compact puede emitir es del 20 %
En el primer ciclo no se emite ning√∫n impulso. En el segundo ciclo, el impulso no emitido del
primer ciclo se agrega al impulso del segundo ciclo.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

699

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
2XWSXW





2XWSXWB3:0

W PV

758(
)$/6(

W PV





‚ë†
‚ë°
‚ë§

Tiempo de muestreo PID_Compact
Tiempo de muestreo Algoritmo PID
Tiempo conexi√≥n m√≠n.

Para reducir la frecuencia de conmutaci√≥n y proteger el actuador, prolongue los tiempos de
conexi√≥n y desconexi√≥n m√≠nimos.
Si se utiliza "Output" o "Output_PER", los tiempos m√≠nimos de conexi√≥n y desconexi√≥n deben
configurarse con el valor 0.0.
Nota
Los tiempos m√≠nimos de conexi√≥n y desconexi√≥n act√∫an solo en el par√°metro de salida
Output_PWM y no se utilizan para posibles generadores de impulsos integrados en la CPU.

Valor de salida V2
L√≠mites del valor de salida
Configure en tantos por ciento los l√≠mites absolutos del valor de salida en la ventana de
configuraci√≥n "L√≠mites del valor de salida". Los l√≠mites del valor de salida absolutos no se
rebasan ni por exceso ni por defecto ni en el modo manual ni en el autom√°tico. Si en el modo
manual se especifica un valor de salida fuera de los l√≠mites, el valor efectivo se limitar√° en la
CPU a los l√≠mites configurados.
Los l√≠mites del valor de salida deben ser compatibles con el sentido de regulaci√≥n.

700

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Los valores v√°lidos para los l√≠mites del valor de salida dependen del Output utilizado.
Output

de -100.0 a 100.0%

Output_PER

de -100.0 a 100.0%

Output_PWM

de -0.0 a 100.0%

Comportamiento en caso de error
ATENCI√ìN
Su instalaci√≥n puede sufrir da√±os.
Si en caso de fallo se emite "Valor actual para la duraci√≥n del error" o "Valor de salida
sustitutivo mientras dure el error", PID_Compact se mantiene en modo autom√°tico. De este
modo, los l√≠mites del valor real pueden rebasarse y su instalaci√≥n puede sufrir da√±os.
Configure un comportamiento en caso de error para su sistema regulado que proteja su
instalaci√≥n de da√±os.
PID_Compact est√° preajustado de manera que, en caso de error, la regulaci√≥n permanece
activa en la mayor√≠a de los casos. Si en el modo de regulaci√≥n se producen errores con
frecuencia, este ajuste empeorar√° el comportamiento de regulaci√≥n. Compruebe en tal caso el
par√°metro Errorbits y elimine la causa de error.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

701

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
En caso de error, PID_Compact emite un valor de salida configurable:
‚óè Cero (inactivo)
PID_Compact emite 0.0 como valor de salida para todos los errores y conmuta al modo de
operaci√≥n "Inactivo". El regulador no se reactiva hasta que no se detecta un flanco
descendente en Reset o un flanco ascendente en ModeActivate.
‚óè Valor actual mientras dure el error
Si se producen los siguientes errores en el modo autom√°tico, PID_Compact regresa a dicho
modo en cuanto los errores en cuesti√≥n dejan de existir.
Si se producen uno o varios de los errores siguientes, PID_Compact permanece en
modo autom√°tico:
‚Äì 0001h: El par√°metro "Input" se encuentra fuera de los l√≠mites del valor real.
‚Äì 0800h: Error en tiempo de muestreo
‚Äì 40000h: Valor no v√°lido en el par√°metro Disturbance.
Si en el modo autom√°tico se producen uno o varios de los errores siguientes, PID_Compact
pasa al modo "Valor de salida sustitutivo con monitorizaci√≥n de errores" y emite el √∫ltimo
valor de salida v√°lido:
‚Äì 0002h: Valor no v√°lido en el par√°metro Input_PER.
‚Äì 0200h: Valor no v√°lido en el par√°metro Input.
‚Äì 0400h: Error al calcular el valor de salida.
‚Äì 1000h: Valor no v√°lido en el par√°metro Setpoint.
Si se produce un error en modo manual, PID_Compact sigue utilizando como valor de
salida el valor manual. Si el valor manual no es v√°lido, se utiliza el valor de salida sustitutivo.
Si el valor manual y el valor de salida sustitutivo no son v√°lidos, se utiliza el l√≠mite inferior del
valor de salida.
Si durante una optimizaci√≥n inicial u optimizaci√≥n fina aparece el siguiente error,
PID_Compact se mantiene en el modo de operaci√≥n activo:
‚Äì 0020h: La optimizaci√≥n inicial no est√° permitida durante la optimizaci√≥n fina.
Con todos los dem√°s errores, PID_Compact interrumpe la optimizaci√≥n y cambia al modo
desde el que se inici√≥ la optimizaci√≥n.
En cuanto no aparezcan errores, PID_Compact pasa de nuevo al modo autom√°tico.
‚óè Valor de salida sustitutivo mientras dure el error
PID_Compact emite el valor de salida sustitutivo.
Si se produce el siguiente error, PID_Compact se mantiene en el modo "Valor de salida
sustitutivo con monitorizaci√≥n de errores" y emite el l√≠mite inferior del valor de salida:
‚Äì 20000h: Valor no v√°lido en la variable SubstituteOutput.
Con el resto de los errores, PID_Compact se comporta del modo descrito en "Valor actual
mientras dure el error".

702

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Par√°metros PID V2
En la ventana de configuraci√≥n "Par√°metros PID" se visualizan los par√°metros PID. Durante la
optimizaci√≥n los par√°metros PID se adaptan al sistema regulado. No es necesario introducir
los par√°metros PID de forma manual.
Nota
Los par√°metros PID efectivos actualmente est√°n en la estructura sRet con PID_Compact V1
y en la estructura Retain.CtrlParams con PID_Compact V2.
Para prevenir un comportamiento err√≥neo del regulador PID, los par√°metros PID efectivos
actualmente solo deben modificarse online en el modo de operaci√≥n "Inactivo".
Si desea modificar online los par√°metros PID en los modos de operaci√≥n "Autom√°tico" o
"Manual", debe hacerlo del siguiente modo:
‚óè PID_Compact V1: Modifique los par√°metros PID en la estructura sBackUp y aplique los
cambios poniendo sPid_Cmpt.b_LoadBackUp = TRUE en la estructura sRet.
‚óè PID_Compact V2: Modifique los par√°metros PID en la estructura CtrlParamsBackUp y
aplique los cambios poniendo LoadBackUp = TRUE en la estructura Retain.CtrlParams.
Los cambios online en los par√°metros PID realizados en el modo de operaci√≥n "Autom√°tico"
pueden provocar saltos en el valor de salida.
El algoritmo PID funciona de acuerdo con la siguiente f√≥rmula:

1

y = Kp

[ (b ¬∑ w - x) + T ¬∑ s

(w - x) +

I

y

Valor de salida del algoritmo PID

Kp

Ganancia proporcional

s

Operador laplaciano

b

Ponderaci√≥n de la acci√≥n P

w

Consigna

x

Valor real

TI

Tiempo de integraci√≥n

TD ¬∑ s
a ¬∑ TD ¬∑ s + 1

(c ¬∑ w - x)

]

a

Coeficiente para el retardo de la acci√≥n derivada (retardo de la acci√≥n derivada T1 = a √óTD)

TD

Tiempo derivativo

c

Ponderaci√≥n de la acci√≥n D

El gr√°fico siguiente muestra c√≥mo entran los par√°metros en el algoritmo PID.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

703

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
6HWSRLQW Z

E



$QWL:LQGXS
/,0,7

.3

,

\


F

6FDOHG,QSXW [



'7

Todos los par√°metros PID son remanentes. Si introduce manualmente los par√°metros PID,
debe cargar PID_Compact por completo.
Cargar objetos tecnol√≥gicos en el dispositivo (P√°gina 667)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_Compact no funciona con una
ganancia proporcional negativa. El sentido de regulaci√≥n se invierte en Ajustes b√°sicos > Tipo
de regulaci√≥n.

Tiempo de integraci√≥n
El tiempo de integraci√≥n determina el comportamiento temporal de la acci√≥n I. La desconexi√≥n
de la acci√≥n I se realiza con el tiempo de integraci√≥n = 0,0. Si el tiempo de integraci√≥n se
modifica online en el modo de operaci√≥n "Autom√°tico" de un valor cualquiera a 0.0, la acci√≥n
I actual se borra y se produce un salto del valor de salida.

Tiempo derivativo
El tiempo de la acci√≥n derivada determina el comportamiento temporal de la acci√≥n D. La
desconexi√≥n de la acci√≥n D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acci√≥n derivada
El efecto de la acci√≥n D se retrasa mediante el coeficiente de retardo de la acci√≥n derivada.

704

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Retardo de la acci√≥n derivada = Tiempo derivativo x coeficiente de retardo de la acci√≥n
derivada
‚óè 0.0: la acci√≥n D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
‚óè 0.5: Este valor se ha acreditado en la pr√°ctica para sistemas regulados con una constante
de tiempo dominante.
‚óè > 1.0: Cuanto mayor sea el coeficiente, m√°s se retrasar√° el efecto de la acci√≥n D.

Ponderaci√≥n de la acci√≥n P
En el caso de que se produzcan cambios en la consigna, es posible atenuar la acci√≥n P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n P es totalmente efectiva cuando se cambia la consigna
‚óè 0.0: La acci√≥n P no act√∫a al cambiar la consigna
Si se produce una modificaci√≥n del valor real, la acci√≥n P es totalmente efectiva.

Ponderaci√≥n de la acci√≥n D
En el caso de que se produzcan cambios en la consigna, es posible atenuar la acci√≥n D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n D es totalmente efectiva cuando se cambia la consigna.
‚óè 0.0: La acci√≥n D no act√∫a al cambiar la consigna
Si se produce una modificaci√≥n del valor real, la acci√≥n D es totalmente efectiva.

Tiempo de muestreo Algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo del algoritmo
PID es el tiempo entre dos c√°lculos del valor de salida. Este se determina durante la
optimizaci√≥n y se redondea a un m√∫ltiplo del tiempo de ciclo. Todas las dem√°s funciones de
PID_Compact se ejecutan con cada llamada.
Si se utiliza Output_PWM, el tiempo de muestreo del algoritmo PID se utiliza como duraci√≥n del
periodo de la modulaci√≥n por ancho de impulsos. La precisi√≥n de la se√±al de salida est√°
determinada por la relaci√≥n entre el tiempo de muestreo del algoritmo PID y el tiempo de ciclo
del OB. Por eso se recomienda que el tiempo de ciclo sea como m√°ximo una d√©cima parte del
tiempo de muestreo del algoritmo PID.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

705

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Regla para la optimizaci√≥n
En la lista desplegable "Estructura del regulador" seleccione si van a calcular los par√°metros
PI o PID.
‚óè PID
Se calcula durante la optimizaci√≥n inicial y la optimizaci√≥n fina del par√°metro PID.
‚óè PI
Se calcula durante la optimizaci√≥n inicial y la optimizaci√≥n fina del par√°metro PI.
‚óè Definido por el usuario
Si se han ajustado diferentes estructuras del regulador para la optimizaci√≥n inicial y la
optimizaci√≥n fina en un programa de usuario, en la lista desplegable aparece "Definido por
el usuario".

Consulte tambi√©n
Elecci√≥n de la estructura del regulador con un sistema regulado definido (P√°gina 660)

Poner en servicio PID_Compact V2
Optimizaci√≥n inicial V2
La optimizaci√≥n inicial determina el comportamiento del proceso a un escal√≥n del valor de
salida y busca el punto de inflexi√≥n. Los par√°metros PID √≥ptimos se calculan a partir de la
pendiente m√°xima y el tiempo muerto del sistema regulado. Para obtener los mejores
par√°metros PID, debe efectuarse una optimizaci√≥n inicial y una optimizaci√≥n fina.
Cuanto m√°s estable es el valor real, con mayor facilidad y precisi√≥n se pueden calcular los
par√°metros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea
considerablemente mayor que el ruido. Esto tiene m√°s probabilidades de suceder en los
modos "Inactivo" o "Manual". Es preciso realizar una copia de seguridad de los par√°metros PID
antes de volver a calcularlos.

Requisitos
‚óè La instrucci√≥n "PID_Compact" se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè Reset = FALSE
‚óè PID_Compact se encuentra en el modo de operaci√≥n "Modo manual", "Inactivo" o "Modo
autom√°tico".
‚óè La consigna y el real se encuentran dentro de los l√≠mites configurados (v√©ase la
configuraci√≥n "Monitorizaci√≥n del valor real").
‚óè La diferencia entre la consigna y el valor real es mayor del 30% de la diferencia entre el
l√≠mite superior e inferior del valor real.
‚óè La diferencia entre la consigna y el valor real es superior al 50% de la consigna.

706

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimizaci√≥n inicial, proceda del siguiente modo:
1. Haga doble clic en la navegaci√≥n del proyecto en la entrada "PID_Compact" > Puesta en
servicio".
2. En la lista desplegable "Modo de optimizaci√≥n" seleccione la entrada "Optimizaci√≥n inicial".
3. Haga clic en el s√≠mbolo "Start".
‚Äì Se establece una conexi√≥n online.
‚Äì Se inicia el registro de los valores.
‚Äì Se inicia la optimizaci√≥n inicial.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Haga clic en el s√≠mbolo "Stop" cuando la barra de progreso haya alcanzado el 100% y
se deba presuponer un bloqueo de la optimizaci√≥n. Compruebe la configuraci√≥n del
objeto tecnol√≥gico y, si procede, vuelva a iniciar la optimizaci√≥n.

Resultado
Si la optimizaci√≥n inicial ha finalizado sin ning√∫n mensaje de error, significa que los par√°metros
PID se han optimizado. PID_Compact cambia al modo autom√°tico y utiliza los par√°metros
optimizados. Los par√°metros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es posible realizar la optimizaci√≥n inicial, PID_Compact se comporta del modo
configurado en Comportamiento en caso de error.

Optimizaci√≥n fina V2
La optimizaci√≥n fina genera una oscilaci√≥n constante y limitada del valor real. Los par√°metros
PID se optimizan para el punto de operaci√≥n a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular todos los par√°metros PID. Los par√°metros PID existentes
despu√©s de la optimizaci√≥n fina muestran en su mayor√≠a un comportamiento de gu√≠a y ante
fallos mucho mejor que los par√°metros PID de la optimizaci√≥n inicial. Para obtener los mejores
par√°metros PID, debe efectuarse una optimizaci√≥n inicial y una optimizaci√≥n fina.
PID_Compact intenta generar autom√°ticamente una oscilaci√≥n que es mayor que el ruido del
valor real. La estabilidad del valor real ejerce tan solo una m√≠nima influencia sobre la
optimizaci√≥n fina. Es preciso realizar una copia de seguridad de los par√°metros PID antes de
volver a calcularlos.

Requisitos
‚óè La instrucci√≥n "PID_Compact" se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè Reset = FALSE

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

707

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
‚óè La consigna y el valor real se encuentran dentro de los l√≠mites configurados.
‚óè El lazo de regulaci√≥n es estacionario en el punto de operaci√≥n. El punto de operaci√≥n se ha
alcanzado cuando el valor real coincide con la consigna.
‚óè No se esperan perturbaciones.
‚óè PID_Compact se encuentra en el modo de operaci√≥n inactivo, autom√°tico o manual.

El proceso depende de la situaci√≥n de inicio
La optimizaci√≥n fina puede iniciarse desde los modos de operaci√≥n "Inactivo", "Autom√°tico" o
"Manual". Al inicio, la optimizaci√≥n fina se desarrolla del modo siguiente:
‚óè Modo autom√°tico
Si desea mejorar los par√°metros PID existentes mediante optimizaci√≥n, inicie la
optimizaci√≥n fina desde el modo autom√°tico.
PID_Compact regula con los par√°metros PID existentes hasta que el lazo de regulaci√≥n es
estacionario y se cumplen las condiciones para la optimizaci√≥n fina. S√≥lo entonces
comienza la optimizaci√≥n fina.
‚óè Inactivo o manual
Si se cumplen las condiciones para optimizaci√≥n inicial, √©sta se inicia. Con los par√°metros
PID calculados, la regulaci√≥n se realiza hasta que el lazo de regulaci√≥n es estacionario y se
han cumplido las condiciones para una optimizaci√≥n fina. S√≥lo entonces comienza la
optimizaci√≥n fina. Si no es posible realizar la optimizaci√≥n inicial, PID_Compact se
comporta del modo configurado en Comportamiento en caso de error.
Si el valor real para una optimizaci√≥n inicial se encuentra ya muy cerca de la consigna, se
intenta alcanzar la consigna con el valor de salida m√°ximo o m√≠nimo, lo que puede
ocasionar una sobreoscilaci√≥n muy alta.

Procedimiento
Para poder realizar una optimizaci√≥n fina, proceda del siguiente modo:
1. En la lista desplegable "Modo de optimizaci√≥n" seleccione la entrada "Optimizaci√≥n fina".
2. Haga clic en el s√≠mbolo "Start".
‚Äì Se establece una conexi√≥n online.
‚Äì Se inicia el registro de los valores.
‚Äì Se inicia el proceso de optimizaci√≥n fina.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de optimizaci√≥n" haga clic en el s√≠mbolo "Stop" cuando la barra de
progreso haya alcanzado el 100% y se deba presuponer un bloqueo de la optimizaci√≥n.
Compruebe la configuraci√≥n del objeto tecnol√≥gico y, si procede, vuelva a iniciar la
optimizaci√≥n.

708

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Resultado
Si durante la optimizaci√≥n fina no se producen errores, significa que los par√°metros PID se han
optimizado. PID_Compact cambia al modo autom√°tico y utiliza los par√°metros optimizados.
Los par√°metros PID optimizados se conservan al desconectar (Power OFF) y al rearrancar por
completo la CPU.
Si se han producido errores durante la "optimizaci√≥n fina", PID_Compact se comporta del
modo configurado en Comportamiento en caso de error.

Modo de operaci√≥n "Modo manual" V2
A continuaci√≥n se describe c√≥mo utilizar el modo de operaci√≥n "Modo manual" en la ventana
de puesta en servicio del objeto tecnol√≥gico "PID_Compact". El modo manual es posible
aunque haya un error pendiente.

Requisitos
‚óè La instrucci√≥n "PID_Compact" se llama en un OB de alarma c√≠clica.
‚óè Hay establecida una conexi√≥n online con la CPU y √©sta se encuentra en el estado operativo
"RUN".

Procedimiento
Utilice "Modo manual" en la ventana de puesta en servicio si desea probar el sistema regulado
especificando un valor manual. Para especificar un valor manual, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo "Start".
2. Active la casilla de verificaci√≥n "Modo manual" en el √°rea "Estado online del regulador".
PID_Compact funciona en modo manual. El √∫ltimo valor de salida actual permanece activo.
3. Introduzca el valor manual en la unidad % en el campo "Output".
4. Haga clic en el s√≠mbolo

.

Resultado
El valor manual se escribe en la CPU y es efectivo de forma inmediata.
Desactive la casilla de verificaci√≥n "Modo manual" si desea que el regulador PID vuelva a
especificar el valor de salida. El cambio al modo autom√°tico se efect√∫a sin discontinuidad.

Regulaci√≥n de transici√≥n con PID_Compact V2
Regulaci√≥n de transici√≥n
En caso de regulaci√≥n de transici√≥n, dos o m√°s reguladores comparten un actuador com√∫n. En
cada instante, solo un regulador tiene acceso al actuador y act√∫a sobre el proceso.
Una l√≥gica decide qu√© regulador obtiene acceso al actuador. A menudo, esta decisi√≥n se toma
en funci√≥n de una comparaci√≥n de los valores de salida de todos los reguladores, p. ej., el

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

709

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
regulador con el mayor valor de salida obtiene acceso al actuador en caso de selecci√≥n del
m√°ximo.
La selecci√≥n en funci√≥n del valor de salida hace necesario que todos los reguladores funcionen
en el modo autom√°tico. Los reguladores que no tengan efecto sobre el actuador se corrigen.
Esto es necesario para evitar los efectos de Windup y sus repercusiones negativas sobre el
comportamiento de regulaci√≥n y la conmutaci√≥n entre los reguladores.
A partir de la versi√≥n 2.3, PID_Compact soporta regulaciones de transici√≥n, pues el regulador
ofrece un procedimiento simplificado para corregir el regulador no activo:
‚óè Mediante las variables OverwriteInitialOutputValue y PIDCtrl.PIDInit es posible preasignar
la acci√≥n I del regulador en el modo autom√°tico como si el algoritmo PID hubiera calculado
Output = OverwriteInititalOutputValue para el valor de salida en el √∫ltimo ciclo.
‚óè Para ello, OverwriteInitialOutputValue se interconecta con el valor de salida del regulador
que tenga acceso en este momento al actuador.
‚óè Ajustando el bit PIDCtrl.PIDInit se lanza la preasignaci√≥n de la acci√≥n I, as√≠ como el reinicio
del ciclo del regulador y el per√≠odo de PWM.
‚óè El subsiguiente c√°lculo del valor de salida en el ciclo actual se realiza bas√°ndose en la
acci√≥n I preasignada (e igualada para todos los reguladores), as√≠ como en la acci√≥n P e I
del actual error de regulaci√≥n.
‚óè La acci√≥n D no est√° activa durante la llamada con PIDCtrl.PIDInit = TRUE y, por tanto, no
contribuye al valor de salida.
Este procedimiento garantiza que el c√°lculo del valor de salida actual y, con ello, la decisi√≥n
sobre qu√© regulador tiene acceso al actuador solo tengan lugar considerando el estado actual
del proceso y los par√°metros PI. As√≠ se evitan los efectos de Windup en los reguladores no
activos y, con ello, las decisiones err√≥neas de la l√≥gica de conmutaci√≥n.

Requisitos
‚óè PIDCtrl.PIDInit solo es efectivo si la acci√≥n I est√° activada (variable Retain.CtrlParams.Ti >
0.0).
‚óè Debe asignar PIDCtrl.PIDInit y OverwriteInitialOutputValue usted mismo en su programa
de usuario (ver ejemplo m√°s abajo). PID_Compact no realiza ning√∫n cambio autom√°tico en
estas variables.
‚óè PIDCtrl.PIDInit solo es efectivo si PID_Compact se encuentra en el modo autom√°tico
(par√°metro State = 3).
‚óè Si es posible, seleccione el tiempo de muestreo del algoritmo PID (variable
Retain.CtrlParams.Cycle) de forma que sea id√©ntico para todos los reguladores y llame
todos los reguladores en el mismo OB de alarma c√≠clica. De esta forma se asegurar√° de que
la conmutaci√≥n no suceda dentro de un ciclo de regulador o de un per√≠odo de PWM.

710

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Nota
Adaptaci√≥n continua de los l√≠mites de los valores de salida
En lugar de la correcci√≥n activa de reguladores sin acceso al actuador aqu√≠ descrita, en otros
sistemas de regulador se realiza alternativamente una adaptaci√≥n continua de los l√≠mites de
los valores de salida.
Esto no es posible con PID_Compact, pues no se soporta el cambio de los l√≠mites de los
valores de salida en el modo autom√°tico.

Ejemplo: regulaci√≥n de un gasoducto
PID_Compact se utiliza para regular un gasoducto
El objetivo principal es regular el caudal Input1. Para ello se utiliza el regulador
PID_Compact_1. Adem√°s, con el regulador de limitaci√≥n PID_Compact_2 debe mantenerse la
presi√≥n Input2 (medida en el sentido de flujo antes de la v√°lvula) por debajo de un l√≠mite
superior.
El caudal y la presi√≥n se modifican a trav√©s de una √∫nica electrov√°lvula. El valor de salida del
regulador se corresponde con la apertura de la v√°lvula: si aumenta el valor de salida, la v√°lvula
se abre. Con ello aumenta el caudal (sentido normal de regulaci√≥n) mientras cae la presi√≥n
(sentido inverso de regulaci√≥n).

Input1

PID_Compact_1

>
Input2

PID_Compact_2

La v√°lvula se acciona mediante el valor de salida de PID_Compact en el formato de periferia
(par√°metro Output_PER), escribiendo la variable de programa ActuatorInput.
La preasignaci√≥n de la consigna para el caudal se realiza en el par√°metro
PID_Compact_1.Setpoint.
El l√≠mite superior de presi√≥n se preasigna como consigna en el par√°metro
PID_Compact_2.Setpoint.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

711

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Input1

PID_Compact_1
Input

Output_PER

Setpoint

Output

1

ActuatorInput

0

PIDCtrl.PIDInit
OverwriteInitial
OutputValue

>

PID_Compact_2
Input

Output_PER

Setpoint

Output

1

0

PIDCtrl.PIDInit
OverwriteInitial
OutputValue

Input2

Ambos reguladores disponen √∫nicamente de una v√°lvula como actuador com√∫n. La l√≥gica que
decide qu√© regulador obtiene acceso al actuador se implementa aqu√≠ a trav√©s de una selecci√≥n
de m√°ximo del valor de salida (en formato Real, par√°metro Output). Puesto que el valor de
salida corresponde a la apertura de la v√°lvula, el regulador obtiene el control que requiere la
mayor apertura de la v√°lvula.
Nota
Activaci√≥n de la inversi√≥n del sentido de regulaci√≥n
Puesto que para el regulador de presi√≥n PID_Compact_2 debe alcanzarse una reducci√≥n del
valor real (presi√≥n) al aumentar el valor de salida (apertura de la v√°lvula), debe activarse la
inversi√≥n del sentido de regulaci√≥n: PID_Compact_2.Config.InvertControl = TRUE.
En el funcionamiento normal de la instalaci√≥n, el valor real del caudal corresponde a la
consigna. El regulador de caudal PID_Compact_1 se ha estabilizado en un valor de salida
estacionario PID_Compact_1.Output. En el modo normal, el valor real de la presi√≥n est√°
claramente por debajo del l√≠mite superior que se ha preasignado como consigna para
PID_Compact_2. Por tanto, el regulador de presi√≥n debe seguir cerrando la v√°lvula para
aumentar la presi√≥n, es decir, calcular√° un valor de salida PID_Compact_2.Output que ser√°
inferior al del regulador de caudal PID_Compact_1.Output. Por tanto, la selecci√≥n m√°xima de
la l√≥gica de conmutaci√≥n sigue permitiendo al regulador de caudal PID_Compact_1 el acceso
al actuador. Adem√°s, mediante las asignaciones PID_Compact_2.OverwriteInitialOutputValue
= PID_Compact_1.Output y PID_Compact_2.PIDCtrl.PIDInit = TRUE se garantiza que se
corregir√° PID_Compact_2.
Si ahora la presi√≥n se acerca al l√≠mite superior o lo rebasa, por ejemplo, debido a una aver√≠a,
el regulador de presi√≥n PID_Compact_2 calcular√° un valor de salida mayor para seguir
abriendo la v√°lvula y as√≠ reducir la presi√≥n. Si PID_Compact_2.Output es mayor que
PID_Compact_1.Output, el regulador de presi√≥n PID_Compact_2 obtiene acceso al actuador
a trav√©s de la selecci√≥n de valor m√°ximo y lo abre. Mediante las asignaciones
PID_Compact_1.OverwriteInitialOutputValue = PID_Compact_2.Output y
PID_Compact_1.PIDCtrl.PIDInit = TRUE se garantiza que se corregir√° PID_Compact_1.

712

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
La presi√≥n se reduce mientras el caudal aumenta y deja de poder mantenerse en la consigna.
Si la aver√≠a deja de producirse, la presi√≥n seguir√° cayendo, y la apertura de la v√°lvula se
reducir√° mediante el regulador de presi√≥n. Si el regulador de caudal calcula una apertura
mayor como valor de salida, la instalaci√≥n regresa al modo normal, de forma que el regulador
de caudal PID_Compact_1 vuelve a obtener acceso al actuador.
Este ejemplo se puede implementar con el siguiente c√≥digo de programa SCL:
"PID_Compact_1"(Input := "Input1");
"PID_Compact_2"(Input := "Input2");
IF "PID_Compact_1".Output >= "PID_Compact_2".Output THEN
"ActuatorInput" := "PID_Compact_1".Output_PER;
"PID_Compact_1".PIDCtrl.PIDInit := FALSE;
"PID_Compact_2".PIDCtrl.PIDInit := TRUE;
"PID_Compact_2".OverwriteInitialOutputValue :=
"PID_Compact_1".Output;
ELSE
"ActuatorInput" := "PID_Compact_2".Output_PER;
"PID_Compact_1".PIDCtrl.PIDInit := TRUE;
"PID_Compact_2".PIDCtrl.PIDInit := FALSE;
"PID_Compact_1".OverwriteInitialOutputValue :=
"PID_Compact_2".Output;
END_IF;

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

713

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Simulaci√≥n de PID_Compact V2 con PLCSIM
Nota
Simulaci√≥n con PLCSIM
La simulaci√≥n de PID_Compact V2.x con PLCSIM para CPU S7-1200 no se soporta.
PID_Compact V2.x solo puede simularse con PLCSIM para CPU S7-1500.
En la simulaci√≥n con PLCSIM, el comportamiento temporal del PLC simulado no es id√©ntico al
de un PLC "aut√©ntico". El verdadero ciclo de un OB de alarma c√≠clica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "aut√©ntico".
En la configuraci√≥n est√°ndar, PID_Compact determina autom√°ticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_Compact con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
Esto provoca la cancelaci√≥n de las optimizaciones en curso.
La reacci√≥n en el modo autom√°tico depende del valor de la variable ActivateRecoverMode.
Para evitarlo, debe configurarse PID_Compact en la simulaci√≥n con PLCSIM del modo
siguiente:
‚óè CycleTime.EnEstimation = FALSE
‚óè CycleTime.EnMonitoring = FALSE
‚óè CycleTime.Value: Asigne a estas variables el ciclo del OB de alarma c√≠clica que se debe
llamar en la unidad segundos.

3.3.1.3

PID_Compact V1

Configurar PID_Compact V1
Ajustes b√°sicos V1
Introducci√≥n V1
Configure las propiedades siguientes del objeto tecnol√≥gico PID_Compact en el √°rea de
ajustes b√°sicos de la ventana de inspecci√≥n o de configuraci√≥n.
‚óè Magnitud f√≠sica
‚óè Sentido de regulaci√≥n
‚óè Comportamiento en arranque despu√©s de un reset
‚óè Consigna (s√≥lo en la ventana de inspecci√≥n)
‚óè Valor real (s√≥lo en la ventana de inspecci√≥n)
‚óè Valor de salida (s√≥lo en la ventana de inspecci√≥n)

714

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Consigna, valor real y valor de salida
La consigna, el valor real y el valor de salida s√≥lo pueden configurarse en la ventana de
inspecci√≥n del editor de programaci√≥n. Para cada salida digital elija la fuente:
‚óè DB de instancia
Se utiliza el valor que se encuentra almacenado en el DB de instancia.
El valor debe actualizarse en el DB de instancia del programa de usuario.
En la instrucci√≥n no puede haber ning√∫n valor.
Modificaci√≥n posible desde HMI.
‚óè Instrucci√≥n
Se utiliza el valor que se conecta con la instrucci√≥n.
Cada vez que se llama la instrucci√≥n, el valor se escribe en el DB de instancia.
No se puede modificar desde HMI.

Tipo de regulaci√≥n V1
Magnitud f√≠sica
En el grupo "Tipo de regulaci√≥n" seleccione la magnitud f√≠sica y la unidad de la consigna y el
valor real. La consigna y el valor real se muestran en esta unidad.

Sentido de regulaci√≥n
Por lo general, un aumento del valor de salida debe lograr un aumento del valor real. En este
caso, se habla de un sentido de regulaci√≥n normal.
PID_Compact no funciona con ganancia proporcional negativa. Para reducir el valor real con
un valor de salida m√°s elevado, active la casilla de verificaci√≥n "Inversi√≥n sentido de
regulaci√≥n".
Ejemplos
‚óè Al abrir una v√°lvula de escape se reduce el nivel de un recipiente.
‚óè Si se aumenta la potencia de refrigeraci√≥n, disminuye la temperatura.

Comportamiento en arranque tras un reset
Para cambiar inmediatamente al √∫ltimo modo de operaci√≥n activo tras el rearranque de la
CPU, active la casilla de verificaci√≥n "Activar √∫ltimo modo de operaci√≥n despu√©s del
rearranque de la CPU".
Si la casilla de verificaci√≥n est√° desactivada, PID_Compact se queda en el modo de operaci√≥n
"Inactivo".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

715

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Consigna V1
Procedimiento
Para especificar una consigna fija, proceda del siguiente modo:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 ¬∞C.
3. En caso necesario, elimine una entrada de la instrucci√≥n.
Para especificar una consigna variable, proceda del siguiente modo:
1. Seleccione "Instrucci√≥n".
2. Indique el nombre de la variable REAL en la que est√° almacenada la consigna.
Es posible asignar varios valores controlados por programa a la variable REAL para, por
ejemplo, modificar la consigna de tiempo de forma controlada.

Valor real V1
Si utiliza directamente el valor de la entrada anal√≥gica, PID_Compact escala el valor de la
entrada anal√≥gica al tama√±o f√≠sico.
Si se desea acondicionar el valor de la entrada anal√≥gica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada anal√≥gica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada anal√≥gica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucci√≥n" como fuente.
3. Introduzca la direcci√≥n de la entrada anal√≥gica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucci√≥n" como fuente.
3. Indique el nombre de la variable en la que est√° almacenado el valor real acondicionado.

716

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Valor de salida V1
PID_Compact ofrece tres valores de salida. El valor de salida que se utilice depender√° del
actuador.
‚óè Output_PER
El actuador se activa a trav√©s de una salida anal√≥gica y se controla con una se√±al continua,
como puede ser 0 a 10 V, 4 a 20 mA.
‚óè Output
El valor de salida debe acondicionarse mediante el programa de usuario, por ejemplo,
porque el actuador muestra un comportamiento no lineal.
‚óè Output_PWM
El actuador se controla a trav√©s de una salida digital. Una modulaci√≥n de ancho de impulsos
permite formar tiempos de conexi√≥n y desconexi√≥n variables.

Procedimiento
Para utilizar el valor de salida anal√≥gico, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output_PER" (anal√≥gica).
2. Seleccione "Instrucci√≥n".
3. Introduzca la direcci√≥n de la salida anal√≥gica.
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "Output", seleccione la entrada "Output".
2. Seleccione "DB de instancia".
El valor de salida calculado se guarda en DB de instancia.
3. Para acondicionar el valor de salida utilice el par√°metro de salida Output.
4. Transfiera el valor de salida acondicionado hasta el actuador a trav√©s de una salida digital
o anal√≥gica de la CPU.
Para utilizar el valor de salida digital, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output_PWM".
2. Seleccione "Instrucci√≥n".
3. Introduzca la direcci√≥n de la salida digital.

Ajuste de valor real V1
Configure la normalizaci√≥n del valor real en la ventana de configuraci√≥n "Ajustes del valor real"
y fije los l√≠mites absolutos del valor real.

Escalar valor real
Si en los ajustes b√°sicos se ha elegido el uso de Input_PER, el valor de la entrada anal√≥gica
debe convertirse en el tama√±o f√≠sico del valor real. En el cuadro de visualizaci√≥n Input_PER se
muestra la configuraci√≥n actual.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

717

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Si el valor real es directamente proporcional al valor de la entrada anal√≥gica, Input_PER se
escala a partir de una pareja de valores inferiores y superiores.
1. En los campos de entrada "Valor real inferior escalado" y "Abajo" introduzca la pareja de
valores inferiores.
2. En los campos de entrada "Valor real inferior escalado" y "Abajo" introduzca la pareja de
valores inferiores.
La configuraci√≥n de hardware incluye una configuraci√≥n predeterminada para los pares de
valores. Para utilizar los pares de valores a partir de la configuraci√≥n de hardware, proceda del
siguiente modo:
1. Seleccione la instrucci√≥n PID_Compact en el editor de programaci√≥n.
2. En los ajustes b√°sicos, interconecte Input_PER con una entrada anal√≥gica.
3. En la configuraci√≥n del valor real, haga clic en el bot√≥n "Ajuste autom√°tico".
Los valores existentes se sobrescriben con los valores de la configuraci√≥n de hardware.

Monitorizar el valor real
Defina los l√≠mites absolutos superior e inferior del valor real. En cuanto dichos valores se
rebasen por exceso o por defecto durante el funcionamiento, la regulaci√≥n se desconectar√° y
el valor de salida se ajustar√° al 0%. Como l√≠mites, se deben introducir valores razonables para
el sistema regulado. Durante la optimizaci√≥n es importante disponer de valores l√≠mite
razonables para obtener los par√°metros PID √≥ptimos.
La preasignaci√≥n del "L√≠mite superior del valor real" es 120%. En la entrada de periferia, el
valor real puede encontrarse como m√°ximo un 18% por encima del rango normalizado
(margen de saturaci√≥n). No se comunica ning√∫n error m√°s debido al rebasamiento por exceso
del "L√≠mite superior del valor real". √önicamente se detectan la rotura de hilo y el cortocircuito
y PID_Compact pasa al modo de operaci√≥n "Inactivo".
ADVERTENCIA
Si ajusta valores muy altos (z. B. -3,4*1038...+3,4*1038) como l√≠mites del valor real, se
desactiva la monitorizaci√≥n del valor real. Esto puede dar lugar a da√±os en la instalaci√≥n.

Consulte tambi√©n
Vigilancia de valor real V1 (P√°gina 719)
Limitaciones de PWM V1 (P√°gina 719)
L√≠mites del valor de salida V1 (P√°gina 721)
Par√°metros PID V1 (P√°gina 722)

718

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Ajustes avanzados V1
Vigilancia de valor real V1
Configure un l√≠mite de advertencia inferior y uno superior para el valor real en la ventana de
configuraci√≥n "Monitorizaci√≥n del valor real". Si durante el funcionamiento se rebasa uno de los
l√≠mites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucci√≥n
"PID_Compact".
‚óè En el par√°metro de salida "InputWarning_H", si se ha rebasado por exceso el l√≠mite superior
de advertencia
‚óè En el par√°metro de salida "InputWarning_L", si se ha rebasado por defecto el l√≠mite inferior
de advertencia
Los l√≠mites de advertencia deben encontrarse dentro de los l√≠mites superior e inferior del valor
real.
Si no introduce ning√∫n valor, se utilizan los l√≠mites superior e inferior del valor real.

Ejemplo
L√≠mite superior del valor real = 98 ¬∞C; l√≠mite superior de advertencia = 90 ¬∞C
L√≠mite inferior de advertencia = 10 ‚ÑÉ; l√≠mite inferior del valor real = 0 ‚ÑÉ
PID_Compact se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

Modo de operaci√≥n

> 98 ¬∞C

TRUE

FALSE

Inactivo

‚â§ 98 ¬∞C y > 90 ¬∞C

TRUE

FALSE

Modo autom√°tico

‚â§ 90 ¬∞C y ‚â• 10 ¬∞C

FALSE

FALSE

Modo autom√°tico

< 10¬∞C y ‚â• 0 ¬∞C

FALSE

TRUE

Modo autom√°tico

< 0 ¬∞C

FALSE

TRUE

Inactivo

Consulte tambi√©n
Ajuste de valor real V1 (P√°gina 717)
Limitaciones de PWM V1 (P√°gina 719)
L√≠mites del valor de salida V1 (P√°gina 721)
Par√°metros PID V1 (P√°gina 722)

Limitaciones de PWM V1
Una modulaci√≥n de ancho de impulsos transforma el valor del par√°metro de salida Output en
un tren de impulsos que se emite por el par√°metro de salida Output_PWM.
Output se calcula en el tiempo de muestreo Algoritmo PID. El tiempo de muestreo se utiliza
como duraci√≥n del per√≠odo de la modulaci√≥n por ancho de impulso.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

719

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
El tiempo de muestreo Algoritmo PID se determina durante la optimizaci√≥n inicial o la
optimizaci√≥n fina. Al ajustar los par√°metros PID manualmente, debe configurarse tambi√©n ah√≠
el tiempo de muestreo Algoritmo PID.
Output_PWM se emite en el tiempo de muestreo PID_Compact. El tiempo de muestreo
PID_Compact equivale al tiempo de ciclo del OB invocante.
La duraci√≥n del impulso es proporcional al valor de Output y es siempre un m√∫ltiplo entero del
tiempo de muestreo PID_Compact.
2XWSXW





W PV

2XWSXWB3:0
758(
)$/6(

W PV





‚ë†
‚ë°
‚ë¢
‚ë£



Tiempo de muestreo PID_Compact
Tiempo de muestreo Algoritmo PID
Duraci√≥n del impulso
Duraci√≥n de la pausa

"Tiempo conexi√≥n m√≠n." y "Tiempo de desconex. m√≠n." se redondean a un m√∫ltiplo entero del
tiempo de muestreo PID_Compact.
Un impulso o una pausa nunca son m√°s cortas que los tiempos de conexi√≥n o desconexi√≥n
m√≠nimos. Las imprecisiones que se producen se suman y se compensan en el siguiente ciclo.
Ejemplo
Tiempo de muestreo PID_Compact (equivale al tiempo de ciclo del OB que efect√∫a la llamada)
= 100 ms
Tiempo de muestreo Algoritmo PID (equivale a la duraci√≥n del periodo)= 1000 ms
Tiempo conexi√≥n m√≠n. = 200 ms
Output es constante del 15%. El m√≠nimo impulso que PID_Compact puede emitir es del 20 %
En el primer ciclo no se emite ning√∫n impulso. En el segundo ciclo, el impulso no emitido del
primer ciclo se agrega al impulso del segundo ciclo.

720

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
2XWSXW





2XWSXWB3:0

W PV

758(
)$/6(

W PV





‚ë†
‚ë°
‚ë§

Tiempo de muestreo PID_Compact
Tiempo de muestreo Algoritmo PID
Tiempo conexi√≥n m√≠n.

Para reducir la frecuencia de conmutaci√≥n y proteger el actuador, prolongue los tiempos de
conexi√≥n y desconexi√≥n m√≠nimos.
Si se utiliza "Output" o "Output_PER", los tiempos m√≠nimos de conexi√≥n y desconexi√≥n deben
configurarse con el valor 0.0.
Nota
Los tiempos m√≠nimos de conexi√≥n y desconexi√≥n act√∫an solo en el par√°metro de salida
Output_PWM y no se utilizan para posibles generadores de impulsos integrados en la CPU.

Consulte tambi√©n
Ajuste de valor real V1 (P√°gina 717)
Vigilancia de valor real V1 (P√°gina 719)
L√≠mites del valor de salida V1 (P√°gina 721)
Par√°metros PID V1 (P√°gina 722)

L√≠mites del valor de salida V1
Configure en tantos por ciento los l√≠mites absolutos del valor de salida en la ventana de
configuraci√≥n "L√≠mites del valor de salida". Los l√≠mites absolutos del valor de salida no se
rebasan ni por exceso ni por defecto ni en el modo manual ni en el autom√°tico. Si en el modo
manual se especifica un valor de salida fuera de los l√≠mites, el valor efectivo se limitar√° en la
CPU a los l√≠mites configurados.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

721

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Los valores v√°lidos para los l√≠mites del valor de salida dependen del Output utilizado.
Output

-100,0 a 100,0

Output_PER

-100,0 a 100,0

Output_PWM

0,0 a 100,0

En caso de error, PID_Compact ajusta el valor de salida a 0.0. As√≠ pues, 0.0 debe encontrarse
siempre dentro de los l√≠mites del valor de salida. Para obtener un l√≠mite inferior del valor de
salida mayor que 0.0, en el programa de usuario debe sumarse un offset a Output y
Output_PER.

Consulte tambi√©n
Ajuste de valor real V1 (P√°gina 717)
Vigilancia de valor real V1 (P√°gina 719)
Limitaciones de PWM V1 (P√°gina 719)
Par√°metros PID V1 (P√°gina 722)

Par√°metros PID V1
En la ventana de configuraci√≥n "Par√°metros PID" se visualizan los par√°metros PID. Durante la
optimizaci√≥n los par√°metros PID se adaptan al sistema regulado. No es necesario introducir
los par√°metros PID de forma manual.
Nota
Los par√°metros PID efectivos actualmente est√°n en la estructura sRet con PID_Compact V1
y en la estructura Retain.CtrlParams con PID_Compact V2.
Para prevenir un comportamiento err√≥neo del regulador PID, los par√°metros PID efectivos
actualmente solo deben modificarse online en el modo de operaci√≥n "Inactivo".
Si desea modificar online los par√°metros PID en los modos de operaci√≥n "Autom√°tico" o
"Manual", debe hacerlo del siguiente modo:
‚óè PID_Compact V1: Modifique los par√°metros PID en la estructura sBackUp y aplique los
cambios poniendo sPid_Cmpt.b_LoadBackUp = TRUE en la estructura sRet.
‚óè PID_Compact V2: Modifique los par√°metros PID en la estructura CtrlParamsBackUp y
aplique los cambios poniendo LoadBackUp = TRUE en la estructura Retain.CtrlParams.
Los cambios online en los par√°metros PID realizados en el modo de operaci√≥n "Autom√°tico"
pueden provocar saltos en el valor de salida.
El algoritmo PID funciona de acuerdo con la siguiente f√≥rmula:

722

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
1

y = Kp

[ (b ¬∑ w - x) + T ¬∑ s

(w - x) +

I

TD ¬∑ s
a ¬∑ TD ¬∑ s + 1

(c ¬∑ w - x)

]

y

Valor de salida del algoritmo PID

Kp

Ganancia proporcional

s

Operador laplaciano

b

Ponderaci√≥n de la acci√≥n P

w

Consigna

x

Valor real

TI

Tiempo de integraci√≥n

a

Coeficiente para el retardo de la acci√≥n derivada (retardo de la acci√≥n derivada T1 = a √óTD)

TD

Tiempo derivativo

c

Ponderaci√≥n de la acci√≥n D

El gr√°fico siguiente muestra c√≥mo entran los par√°metros en el algoritmo PID.
6HWSRLQW Z

E



$QWL:LQGXS
/,0,7

,

.3

\


F

6FDOHG,QSXW [



'7

Todos los par√°metros PID son remanentes. Si introduce manualmente los par√°metros PID,
debe cargar PID_Compact por completo.
Cargar objetos tecnol√≥gicos en el dispositivo (P√°gina 667)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_Compact no funciona con una
ganancia proporcional negativa. El sentido de regulaci√≥n se invierte en Ajustes b√°sicos > Tipo
de regulaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

723

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Tiempo de integraci√≥n
El tiempo de integraci√≥n determina el comportamiento temporal de la acci√≥n I. La desconexi√≥n
de la acci√≥n I se realiza con el tiempo de integraci√≥n = 0,0. Si el tiempo de integraci√≥n se
modifica online en el modo de operaci√≥n "Autom√°tico" de un valor cualquiera a 0.0, la acci√≥n
I actual se borra y se produce un salto del valor de salida.

Tiempo derivativo
El tiempo de la acci√≥n derivada determina el comportamiento temporal de la acci√≥n D. La
desconexi√≥n de la acci√≥n D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acci√≥n derivada
El efecto de la acci√≥n D se retrasa mediante el coeficiente de retardo de la acci√≥n derivada.
Retardo de la acci√≥n derivada = Tiempo derivativo x coeficiente de retardo de la acci√≥n
derivada
‚óè 0.0: la acci√≥n D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
‚óè 0.5: Este valor se ha acreditado en la pr√°ctica para sistemas regulados con una constante
de tiempo dominante.
‚óè > 1.0: Cuanto mayor sea el coeficiente, m√°s se retrasar√° el efecto de la acci√≥n D.

Ponderaci√≥n de la acci√≥n P
En el caso de que se produzcan cambios en la consigna, es posible atenuar la acci√≥n P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n P es totalmente efectiva cuando se cambia la consigna
‚óè 0.0: La acci√≥n P no act√∫a al cambiar la consigna
Si se produce una modificaci√≥n del valor real, la acci√≥n P es totalmente efectiva.

Ponderaci√≥n de la acci√≥n D
En el caso de que se produzcan cambios en la consigna, es posible atenuar la acci√≥n D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n D es totalmente efectiva cuando se cambia la consigna.
‚óè 0.0: La acci√≥n D no act√∫a al cambiar la consigna
Si se produce una modificaci√≥n del valor real, la acci√≥n D es totalmente efectiva.

724

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Tiempo de muestreo Algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo del algoritmo
PID es el tiempo entre dos c√°lculos del valor de salida. Este se determina durante la
optimizaci√≥n y se redondea a un m√∫ltiplo del tiempo de ciclo. Todas las dem√°s funciones de
PID_Compact se ejecutan con cada llamada.
Si se utiliza Output_PWM, el tiempo de muestreo del algoritmo PID se utiliza como duraci√≥n del
periodo de la modulaci√≥n por ancho de impulsos. La precisi√≥n de la se√±al de salida est√°
determinada por la relaci√≥n entre el tiempo de muestreo del algoritmo PID y el tiempo de ciclo
del OB. Por eso se recomienda que el tiempo de ciclo sea como m√°ximo una d√©cima parte del
tiempo de muestreo del algoritmo PID.

Regla para la optimizaci√≥n
En la lista desplegable "Estructura del regulador" seleccione si van a calcular los par√°metros
PI o PID.
‚óè PID
Se calcula durante la optimizaci√≥n inicial y la optimizaci√≥n fina del par√°metro PID.
‚óè PI
Se calcula durante la optimizaci√≥n inicial y la optimizaci√≥n fina del par√°metro PI.
‚óè Definido por el usuario
Si se han ajustado diferentes estructuras del regulador para la optimizaci√≥n inicial y la
optimizaci√≥n fina en un programa de usuario, en la lista desplegable aparece "Definido por
el usuario".

Consulte tambi√©n
Elecci√≥n de la estructura del regulador con un sistema regulado definido (P√°gina 660)

Poner en servicio PID_Compact V1
Puesta en servicio V1
La ventana de puesta en servicio ayuda durante la puesta en servicio del regulador PID. En el
visor de curvas se puede observar los valores de la consigna, valor real y valor de salida a lo
largo del eje de tiempo. En la ventana de puesta en servicio se soportan las siguientes
funciones:
‚óè Optimizaci√≥n inicial del regulador
‚óè Optimizaci√≥n fina del regulador
Utilice la optimizaci√≥n fina si desea realizar un ajuste de precisi√≥n del par√°metro PID.
‚óè Observaci√≥n de la regulaci√≥n en curso en la ventana de curvas
‚óè Probar el sistema regulado especificando un valor de salida manual
Para todas las funciones es preciso realizar una conexi√≥n online a la CPU.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

725

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Principios b√°sicos del manejo
‚óè Seleccione el tiempo de actualizaci√≥n que desee en la lista desplegable "Tiempo de
actualizaci√≥n".
Todos los valores de la ventana de puesta en servicio se actualizan en el tiempo de
actualizaci√≥n seleccionado.
‚óè Haga clic en el bot√≥n "Inicio" en el grupo Medici√≥n si desea utilizar las funciones de puesta
en servicio.
Se inicia el registro de los valores. En el visor de curvas se registran los valores actuales de
consigna, valor real y valor de salida. Se habilita el manejo de la ventana de puesta en
servicio.
‚óè Haga clic en el bot√≥n "Parar" si desea finalizar las funciones de puesta en servicio.
Los valores mostrados en el visor de curvas pueden continuar analiz√°ndose.
Al cerrar la ventana de puesta en servicio finaliza el registro en el visor de curvas y los valores
registrados se borran.

Consulte tambi√©n
Optimizaci√≥n inicial V1 (P√°gina 726)
Optimizaci√≥n fina V1 (P√°gina 727)
Modo de operaci√≥n "Modo manual" V1 (P√°gina 729)

Optimizaci√≥n inicial V1
La optimizaci√≥n inicial determina el comportamiento del proceso a un escal√≥n del valor de
salida y busca el punto de inflexi√≥n. A partir de la inclinaci√≥n m√°xima y del tiempo muerto del
sistema regulado se calculan los par√°metros PID √≥ptimos.
Cuanto m√°s estable es el valor real, con mayor facilidad y precisi√≥n se pueden calcular los
par√°metros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea
considerablemente mayor que el ruido. Es preciso realizar una copia de seguridad de los
par√°metros PID antes de volver a calcularlos.

Requisitos
‚óè La instrucci√≥n "PID_Compact" se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè PID_Compact se encuentra en el modo de operaci√≥n "Inactivo" o "Manual".
‚óè La consigna no puede modificarse durante la optimizaci√≥n. De lo contrario se desactiva
PID_Compact.
‚óè La consigna y el real se encuentran dentro de los l√≠mites configurados (v√©ase la
configuraci√≥n "Monitorizaci√≥n del valor real").
‚óè La diferencia entre la consigna y el valor real es mayor del 30% de la diferencia entre el
l√≠mite superior e inferior del valor real.
‚óè La diferencia entre la consigna y el valor real es superior al 50% de la consigna.

726

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimizaci√≥n inicial, proceda del siguiente modo:
1. Haga doble clic en la navegaci√≥n del proyecto en la entrada "PID_Compact" > Puesta en
servicio".
2. En la lista desplegable "Modo de optimizaci√≥n" seleccione la entrada "Optimizaci√≥n inicial".
3. Haga clic en el s√≠mbolo "Start".
‚Äì Se establece una conexi√≥n online.
‚Äì Se inicia el registro de los valores.
‚Äì Se inicia la optimizaci√≥n inicial.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Haga clic en el s√≠mbolo "Stop" cuando la barra de progreso haya alcanzado el 100% y
se deba presuponer un bloqueo de la optimizaci√≥n. Compruebe la configuraci√≥n del
objeto tecnol√≥gico y, si procede, vuelva a iniciar la optimizaci√≥n.

Resultado
Si la optimizaci√≥n inicial ha finalizado sin ning√∫n mensaje de error, significa que los par√°metros
PID se han optimizado. PID_Compact cambia al modo autom√°tico y utiliza los par√°metros
optimizados. Los par√°metros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es preciso realizar la optimizaci√≥n inicial, PID_Compact cambia al modo de operaci√≥n
"Inactivo".

Consulte tambi√©n
Puesta en servicio V1 (P√°gina 725)
Optimizaci√≥n fina V1 (P√°gina 727)
Modo de operaci√≥n "Modo manual" V1 (P√°gina 729)

Optimizaci√≥n fina V1
La optimizaci√≥n fina genera una oscilaci√≥n constante y limitada del valor real. Los par√°metros
PID se optimizan para el punto de operaci√≥n a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular todos los par√°metros PID. Los par√°metros PID existentes
despu√©s de la optimizaci√≥n fina muestran en su mayor√≠a un comportamiento de gu√≠a y ante
fallos mucho mejor que los par√°metros PID de la optimizaci√≥n inicial.
PID_Compact intenta generar autom√°ticamente una oscilaci√≥n que es mayor que el ruido del
valor real. La estabilidad del valor real ejerce tan s√≥lo una m√≠nima influencia sobre la
optimizaci√≥n fina. Es preciso realizar una copia de seguridad de los par√°metros PID antes de
volver a calcularlos.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

727

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Requisitos
‚óè La instrucci√≥n "PID_Compact" se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè La consigna y el real se encuentran dentro de los l√≠mites configurados (v√©ase la
configuraci√≥n "Monitorizaci√≥n del valor real").
‚óè El lazo de regulaci√≥n es estacionario en el punto de operaci√≥n. El punto de operaci√≥n se ha
alcanzado cuando el valor real coincide con la consigna.
‚óè No se esperan perturbaciones.
‚óè La consigna no puede modificarse durante la optimizaci√≥n.
‚óè PID_Compact se encuentra en el modo de operaci√≥n inactivo, autom√°tico o manual.

El proceso depende de la situaci√≥n de inicio
La optimizaci√≥n fina puede iniciarse desde los modos de operaci√≥n "Inactivo", "Autom√°tico" o
"Manual". La optimizaci√≥n fina se realiza en el momento del inicio tal como se indica a
continuaci√≥n:
‚óè Modo autom√°tico
Si desea mejorar los par√°metros PID existentes mediante optimizaci√≥n, inicie la
optimizaci√≥n fina a partir del modo autom√°tico.
PID_Comact regula con los par√°metros PID existentes hasta que el lazo de regulaci√≥n es
estacionario y se han cumplido las condiciones para una optimizaci√≥n fina. S√≥lo entonces
comienza la optimizaci√≥n fina.
‚óè Inactivo o manual
Si se cumplen las condiciones para optimizaci√≥n inicial, √©sta se inicia. Con los par√°metros
PID calculados la regulaci√≥n se realiza hasta que el lazo de regulaci√≥n es estacionario y se
han cumplido las condiciones para una optimizaci√≥n fina. S√≥lo entonces comienza la
optimizaci√≥n fina. Si no es posible realizar la optimizaci√≥n inicial, PID_Compact cambia al
modo de operaci√≥n "Inactivo".
Si el valor real para una optimizaci√≥n inicial se encuentra ya muy cerca de la consigna, se
intenta alcanzar la consigna con el valor de salida m√°ximo o m√≠nimo. lo que puede
ocasionar una sobreoscilaci√≥n muy alta.

728

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimizaci√≥n fina, proceda del siguiente modo:
1. En la lista desplegable "Modo de optimizaci√≥n" seleccione la entrada "Optimizaci√≥n fina".
2. Haga clic en el s√≠mbolo "Start".
‚Äì Se establece una conexi√≥n online.
‚Äì Se inicia el registro de los valores.
‚Äì Se inicia el proceso de optimizaci√≥n fina.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de optimizaci√≥n" haga clic en el s√≠mbolo "Stop" cuando la barra de
progreso haya alcanzado el 100% y se deba presuponer un bloqueo de la optimizaci√≥n.
Compruebe la configuraci√≥n del objeto tecnol√≥gico y, si procede, vuelva a iniciar la
optimizaci√≥n.

Resultado
Si la optimizaci√≥n fina se ha completado sin ning√∫n aviso de error, significa que los par√°metros
PID se han optimizado. PID_Compact cambia al modo autom√°tico y utiliza los par√°metros
optimizados. Los par√°metros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si se produjeran errores durante la optimizaci√≥n fina, PID_Compact cambia al modo de
operaci√≥n "Inactivo".

Consulte tambi√©n
Puesta en servicio V1 (P√°gina 725)
Optimizaci√≥n inicial V1 (P√°gina 726)
Modo de operaci√≥n "Modo manual" V1 (P√°gina 729)

Modo de operaci√≥n "Modo manual" V1
A continuaci√≥n se describe c√≥mo utilizar el modo de operaci√≥n "Modo manual" en la ventana
de puesta en servicio del objeto tecnol√≥gico "PID Compact".

Requisitos
‚óè La instrucci√≥n "PID_Compact" se llama en un OB de alarma c√≠clica.
‚óè Hay establecida una conexi√≥n online con la CPU y √©sta se encuentra en el estado operativo
"RUN".
‚óè Las funciones de la ventana de puesta en marcha se han habilitado con el bot√≥n "Medici√≥n
on".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

729

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Procedimiento
Utilice "Modo manual" en la ventana de puesta en servicio si desea probar el sistema regulado
especificando un valor manual. Para especificar un valor manual, proceda del siguiente modo:
1. Active la casilla de verificaci√≥n "Modo manual" en el √°rea "Estado online del regulador".
PID_Compact funciona en modo manual. El √∫ltimo valor de salida actual permanece activo.
2. Introduzca el valor manual en la unidad % en el campo "Output".
3. Haga clic en el bot√≥n

.

Resultado
El valor manual se escribe en la CPU y es efectivo de forma inmediata.
Nota
PID_Compact sigue monitorizando el valor real. Cuando se exceden los l√≠mites del valor real,
se desactiva PID_Compact.
Desactive la casilla de verificaci√≥n "Modo manual" si desea que el regulador PID vuelva a
especificar el valor de salida. El cambio al modo autom√°tico se efect√∫a sin discontinuidad.

Consulte tambi√©n
Puesta en servicio V1 (P√°gina 725)
Optimizaci√≥n inicial V1 (P√°gina 726)
Optimizaci√≥n fina V1 (P√°gina 727)

730

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Simulaci√≥n de PID_Compact V1 con PLCSIM
Nota
Simulaci√≥n con PLCSIM
En la simulaci√≥n con PLCSIM, el comportamiento temporal del PLC simulado no es id√©ntico al
de un PLC "aut√©ntico". El verdadero ciclo de un OB de alarma c√≠clica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "aut√©ntico".
En la configuraci√≥n est√°ndar, PID_Compact determina autom√°ticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_Compact con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
PID_Compact cambia en este caso al modo de operaci√≥n Inactivo (State = 0).
Para evitarlo, debe configurarse PID_Compact en la simulaci√≥n con PLCSIM del modo
siguiente:
‚óè sb_EnCyclEstimation = FALSE
‚óè sb_EnCyclMonitoring = FALSE
‚óè sPid_Calc.r_Cycle: Asigne a estas variables el ciclo del OB de alarma c√≠clica que se debe
llamar en la unidad segundos.

3.3.2

Utilizar PID_3Step

3.3.2.1

Objeto tecnol√≥gico PID_3Step
El objeto tecnol√≥gico PID_3Step proporciona un regulador PID con optimizaci√≥n para v√°lvulas
o actuadores con comportamiento integrador.
Es posible configurar los siguientes reguladores:
‚óè Regulador paso a paso de tres puntos con realimentaci√≥n de posici√≥n
‚óè Regulador paso a paso de tres puntos sin realimentaci√≥n de posici√≥n
‚óè Regulador de v√°lvula con valor de salida anal√≥gico
PID_3Step registra de forma continua el valor real medido dentro de un lazo de regulaci√≥n y lo
compara con la consigna. A partir del error de regulaci√≥n resultante, PID_3Step calcula un
valor de salida, con el que el valor real se iguala con la consigna con la m√°xima rapidez y
estabilidad. En los reguladores PID, el valor de salida se compone de tres acciones:
‚óè Acci√≥n P
La acci√≥n P del valor de salida aumenta proporcionalmente al error de regulaci√≥n.
‚óè Acci√≥n I
La acci√≥n I del valor de salida aumenta hasta que se compensa el error de regulaci√≥n.
‚óè Acci√≥n D
La acci√≥n D aumenta con una velocidad de variaci√≥n creciente del error de regulaci√≥n. El
valor real se igual lo m√°s r√°pidamente posible con la consigna. Si la velocidad de variaci√≥n
del error de regulaci√≥n vuelve a reducirse, tambi√©n lo hace la acci√≥n D.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

731

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
La instrucci√≥n PID_3Step calcula los par√°metros P, I y D para su sistema regulado de forma
aut√≥noma durante la optimizaci√≥n inicial. Los par√°metros pueden optimizarse a√∫n m√°s a
trav√©s de una optimizaci√≥n fina. No es necesario determinar los par√°metros manualmente.

Informaci√≥n adicional
‚óè Vista general de los reguladores de software (P√°gina 661)
‚óè Agregar objetos tecnol√≥gicos (P√°gina 664)
‚óè Configurar objetos tecnol√≥gicos (P√°gina 665)
‚óè Configuraci√≥n de PID_3Step V2 (P√°gina 732)
‚óè Configuraci√≥n de PID_3Step V1 (P√°gina 751)

Principio
Para m√°s informaci√≥n al respecto, consulte la siguiente pregunta frecuente (FAQ) en el
Siemens Industry Online Support:
‚óè ID de art√≠culo 68011827 (https://support.industry.siemens.com/cs/ww/en/view/68011827)

3.3.2.2

PID_3Step V2

Configuraci√≥n de PID_3Step V2
Ajustes b√°sicos V2
Introducci√≥n V2
Configure las propiedades siguientes del objeto tecnol√≥gico PID_3Step en el √°rea de ajustes
b√°sicos de la ventana de inspecci√≥n o de configuraci√≥n.
‚óè Magnitud f√≠sica
‚óè Sentido de regulaci√≥n
‚óè Comportamiento en arranque tras un reset
‚óè Consigna (s√≥lo en la ventana de inspecci√≥n)
‚óè Valor real (s√≥lo en la ventana de inspecci√≥n)
‚óè Valor de salida (s√≥lo en la ventana de inspecci√≥n)
‚óè Realimentaci√≥n de posici√≥n (s√≥lo en la ventana de inspecci√≥n)

732

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Consigna, valor real, valor de salida y realimentaci√≥n de posici√≥n
La consigna, el valor real, el valor de salida y la realimentaci√≥n de posici√≥n s√≥lo pueden
configurarse en la ventana de inspecci√≥n del editor de programaci√≥n. Para cada valor elija el
origen:
‚óè DB de instancia
Se utiliza el valor que se encuentra almacenado en el DB de instancia.
El valor debe actualizarse en el DB de instancia del programa de usuario.
En la instrucci√≥n no puede haber ning√∫n valor.
Modificaci√≥n posible desde HMI.
‚óè Instrucci√≥n
Se utiliza el valor que se interconecta a la instrucci√≥n.
Cada vez que se llama la instrucci√≥n, el valor se escribe en el DB de instancia.
No se puede modificar desde HMI.

Tipo de regulaci√≥n V2
Magnitud f√≠sica
En el grupo "Tipo de regulaci√≥n", seleccione la magnitud f√≠sica y la unidad para la consigna, el
valor real y la magnitud perturbadora. La consigna, el valor real y la magnitud perturbadora se
mostrar√°n en dicha unidad.

Sentido de regulaci√≥n
Por lo general, un aumento del valor de salida debe lograr un aumento del valor real. En este
caso, se habla de un sentido de regulaci√≥n normal.
PID_3Step no funciona con ganancia proporcional negativa. Para reducir el valor real con un
valor de salida m√°s elevado, active la casilla de verificaci√≥n "Inversi√≥n sentido de regulaci√≥n".
Ejemplos
‚óè Al abrir una v√°lvula de escape se reduce el nivel de llenado de un recipiente.
‚óè Si se aumenta la potencia de refrigeraci√≥n, disminuye la temperatura.

Comportamiento en arranque
1. Para cambiar inmediatamente al modo de operaci√≥n "Inactivo" tras el rearranque de la
CPU, desactive la casilla de verificaci√≥n "Activar Mode tras rearrancar la CPU".
Para cambiar inmediatamente, tras el rearranque de la CPU, al modo de operaci√≥n
almacenado en Mode, active la casilla de verificaci√≥n "Activar Mode tras rearrancar la
CPU".
2. En la lista desplegable "Poner Mode a", seleccione el modo de operaci√≥n que debe
activarse tras una carga completa en el dispositivo.
Tras una carga completa en el dispositivo, PID_3Step arranca en el modo de operaci√≥n
seleccionado. Con cada rearranque, PID_3Step arranca en el √∫ltimo modo de operaci√≥n
almacenado en Mode.
Ejemplo

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

733

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Se ha activado la casilla de verificaci√≥n "Activar Mode tras rearrancar la CPU" y se ha
seleccionado la entrada "Optimizaci√≥n inicial" en la lista "Poner Mode a". Tras una carga
completa en el dispositivo, PID_3Step arranca en el modo de operaci√≥n "Optimizaci√≥n inicial".
Si la optimizaci√≥n inicial a√∫n est√° activa y se rearranca la CPU, PID_3Step arranca de nuevo
en el modo de operaci√≥n "Optimizaci√≥n inicial". Si la optimizaci√≥n inicial ha finalizado
correctamente, el modo autom√°tico a√∫n est√° activo y se rearranca la CPU, PID_3Step arranca
en "Modo autom√°tico".

Consigna V2
Procedimiento
Para especificar una consigna fija, proceda del siguiente modo:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 ¬∞C.
3. En caso necesario, elimine una entrada de la instrucci√≥n.
Para especificar una consigna variable, proceda del siguiente modo:
1. Seleccione "Instrucci√≥n".
2. Indique el nombre de la variable REAL en la que est√° almacenada la consigna.
Es posible asignar varios valores de forma controlada por programa a la variable REAL
para, por ejemplo, modificar la consigna de tiempo de forma controlada.

Valor real V2
Si utiliza directamente el valor de la entrada anal√≥gica, PID_3Step escala el valor de la entrada
anal√≥gica al tama√±o f√≠sico.
Si desea acondicionar primero el valor de la entrada anal√≥gica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada anal√≥gica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada anal√≥gica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucci√≥n" como fuente.
3. Introduzca la direcci√≥n de la entrada anal√≥gica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucci√≥n" como fuente.
3. Indique el nombre de la variable en la que est√° almacenado el valor real acondicionado.

734

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Realimentaci√≥n de posici√≥n V2
La configuraci√≥n de la realimentaci√≥n de posici√≥n depende del elemento final de control
utilizado.
‚óè Actuador sin realimentaci√≥n de posici√≥n
‚óè Elemento final de control con se√±ales de tope digitales
‚óè Actuador con realimentaci√≥n de posici√≥n anal√≥gica
‚óè Actuador con realimentaci√≥n de posici√≥n anal√≥gico y se√±ales de tope

Elemento final de control sin realimentaci√≥n de posici√≥n
Para configurar PID_3Step para un elemento final de control sin realimentaci√≥n de posici√≥n,
proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "No Feedback".

Elemento final de control con se√±ales de tope digitales
Para configurar PID_3Step para un elemento final de control con se√±ales de tope, proceda del
siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "No Feedback".
2. Active la casilla de verificaci√≥n "Se√±al tope del actuador".
3. Seleccione "Instrucci√≥n" como fuente para Actuator_H y Actuator_L.
4. Introduzca las direcciones de las entradas digitales para Actuator_H y Actuator_L.

Elemento final de control con realimentaci√≥n de posici√≥n anal√≥gica
Para configurar PID_3Step para un elemento final de control con realimentaci√≥n de posici√≥n
anal√≥gica, proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "Feedback" o "Feedback_PER".
‚Äì En Feedback_PER utilice el valor de la entrada anal√≥gica. El escalado de
Feedback_PER se configura en la configuraci√≥n del elemento final de control.
‚Äì En Feedback procese el valor de la entrada anal√≥gica a trav√©s de su programa de
usuario.
2. Seleccione "Instrucci√≥n" como fuente.
3. Introduzca la direcci√≥n de la entrada anal√≥gica o la variable de su programa de usuario.

Elemento final de control con realimentaci√≥n de posici√≥n anal√≥gica y se√±ales de tope
Para configurar PID_3Step para un elemento final de control con realimentaci√≥n de posici√≥n
anal√≥gica y se√±ales de tope, proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "Feedback" o "Feedback_PER".
2. Seleccione "Instrucci√≥n" como fuente.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

735

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
3. Introduzca la direcci√≥n de la entrada anal√≥gica o la variable de su programa de usuario.
4. Active la casilla de verificaci√≥n "Se√±al tope del actuador".
5. Seleccione "Instrucci√≥n" como fuente para Actuator_H y Actuator_L.
6. Introduzca las direcciones de las entradas digitales para Actuator_H y Actuator_L.

Valor de salida V2
PID_3Step ofrece un valor de salida anal√≥gico (Output_PER) y valores de salida digitales
(Output_UP, Output_DN). El valor de salida que se utilice depender√° del actuador.
‚óè Output_PER
El actuador dispone de un tiempo de posicionamiento del motor relevante, se activa a
trav√©s de una salida anal√≥gica y se controla con una se√±al continua, como puede ser 0 a
10 V, 4 a 20 mA. El valor de Output_PER se corresponde con la posici√≥n de destino de la
v√°lvula, p. ej., Output_PER = 13824, cuando la v√°lvula debe abrirse hasta un 50 %.
PID_3Step tiene en cuenta, p. ej., para la optimizaci√≥n autom√°tica y el comportamiento AntiWindup, que el valor de salida anal√≥gico act√∫a en el proceso con un retardo debido al
tiempo de posicionamiento del motor. Si en su proceso no act√∫a ning√∫n tiempo de
posicionamiento del motor relevante (p. ej., con electrov√°lvulas), de forma que el valor de
salida act√∫a directamente y en toda su magnitud sobre el proceso, utilice PID_Compact en
su lugar.
‚óè Output_UP, Output_DN
El actuador dispone de un tiempo de posicionamiento del motor relevante y se controla
mediante dos salidas digitales.
Output_UP desplaza la v√°lvula hacia el estado abierto.
Output_DN desplaza la v√°lvula hacia el estado cerrado.
El tiempo de posicionamiento del motor se tiene en cuenta tanto en el c√°lculo del valor de
salida anal√≥gico como en el c√°lculo de los valores de salida digitales. Es necesario para el
correcto funcionamiento, sobre todo, durante la optimizaci√≥n autom√°tica y el comportamiento
Anti-Windup. Por tanto, configure el tiempo de posicionamiento del motor en "Ajustes del
actuador" con el valor que requiere el motor para desplazar el actuador del estado cerrado al
estado abierto.

Procedimiento
Para utilizar el valor de salida anal√≥gico, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada Output (anal√≥gica).
2. Seleccione "Instrucci√≥n".
3. Introduzca la direcci√≥n de la salida anal√≥gica.
Para utilizar el valor de salida digital, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output (digital)".
2. Seleccione "Instrucci√≥n" para Output_UP y Output_DN.
3. Introduzca las direcciones de las salidas digitales.

736

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "Output" seleccione la entrada adecuada al actuador.
2. Seleccione "Instrucci√≥n".
3. Indique el nombre de la variable que utilizar√° para acondicionar el valor de salida.
4. Transfiera el valor de salida acondicionado hasta el actuador a trav√©s de una salida
anal√≥gica o digital de la CPU.

Ajustes de valor real V2
Escalar valor real V2
Si en los ajustes b√°sicos ha configurado el uso de Input_PER, deber√° convertir el valor de la
entrada anal√≥gica a la magnitud f√≠sica del valor real. En el cuadro de visualizaci√≥n Input_PER
se muestra la configuraci√≥n actual.
Si el valor real es directamente proporcional al valor de la entrada anal√≥gica, Input_PER se
escalar√° a partir de un par de valores inferior y superior.

Procedimiento
Para escalar el valor real, haga lo siguiente:
1. En los campos de entrada "Valor real inferior escalado" y "abajo", introduzca el par de
valores inferior.
2. En los campos de entrada "Valor real superior escalado" y "arriba", introduzca el par de
valores superior.
La configuraci√≥n hardware contiene pares de valores predeterminados. Para utilizar los pares
de valores contenidos en la configuraci√≥n hardware, haga lo siguiente:
1. Marque la instrucci√≥n PID_3Step en el editor de programaci√≥n.
2. En los ajustes b√°sicos, interconecte Input_PER con una entrada anal√≥gica.
3. En los ajustes del valor real, haga clic en el bot√≥n "Ajuste autom√°tico".
Los valores existentes se sobrescribir√°n con los valores de la configuraci√≥n hardware.

L√≠mites de valor real V2
Como valores l√≠mite para el sistema regulado defina los l√≠mites superior e inferior absolutos del
valor real de modo que sean razonables. Tan pronto como dichos valores se rebasen por
exceso o defecto, se producir√° un error (ErrorBits = 0001h). La optimizaci√≥n se cancela cuando
se rebasan los valores reales. Defina en los ajustes del actuador c√≥mo debe reaccionar
PID_3Step en caso de error en el modo autom√°tico.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

737

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Ajustes de actuador V2
Actuador V2
Tiempos espec√≠ficos del actuador
Para proteger el elemento final de control frente a da√±os, ajuste el tiempo de posicionamiento
del motor y los tiempos m√≠nimos de conexi√≥n y desconexi√≥n. Los datos figuran en la hoja de
datos del elemento final de control.
El tiempo de posicionamiento del motor es el tiempo en segundos que requiere el motor para
desplazar el elemento final de control del estado cerrado al estado abierto. El tiempo de
posicionamiento del motor puede calcularse durante la puesta en marcha.
El tiempo de posicionamiento del motor se tiene en cuenta tanto en el c√°lculo del valor de
salida anal√≥gico como en el c√°lculo de los valores de salida digitales. Es necesario para el
correcto funcionamiento, sobre todo, durante la optimizaci√≥n autom√°tica y el comportamiento
Anti-Windup.
Si en su proceso no act√∫a ning√∫n tiempo de posicionamiento del motor relevante (p. ej., con
electrov√°lvulas), de forma que el valor de salida act√∫a directamente y en toda su magnitud
sobre el proceso, utilice PID_Compact en su lugar.
El tiempo de posicionamiento del motor es remanente. Si modifica manualmente el tiempo de
posicionamiento del motor, debe cargar PID_3Step por completo.
Cargar objetos tecnol√≥gicos en el dispositivo (P√°gina 667)
Si se utiliza Output_UP y Output_DN, debe reducirse la frecuencia de conmutaci√≥n con los
tiempos m√≠nimos de conexi√≥n y desconexi√≥n.
En el modo autom√°tico se acumulan los tiempos calculados de conexi√≥n y desconexi√≥n y estos
no surten efecto hasta que la suma sea igual o superior al tiempo m√≠nimo de conexi√≥n o
desconexi√≥n.
En el modo manual, Manual_UP = TRUE o Manual_DN = TRUE permiten controlar el elemento
final de control al menos en el tiempo m√≠nimo de conexi√≥n o desconexi√≥n.
Si en los ajustes b√°sicos ha elegido el valor anal√≥gico de salida Output_PER, el tiempo de
conexi√≥n m√≠nimo y el tiempo de desconexi√≥n m√≠nimo no se eval√∫an ni se pueden modificar.

738

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Comportamiento en caso de error
PID_3Step est√° preajustado de manera que, en caso de error, la regulaci√≥n permanece activa
en la mayor√≠a de los casos. Si en el modo de regulaci√≥n se producen errores con frecuencia,
este ajuste empeorar√° el comportamiento de regulaci√≥n. Compruebe en tal caso el par√°metro
Errorbits y elimine la causa de error.
ATENCI√ìN
Su instalaci√≥n puede sufrir da√±os.
Si en caso de error se emite "Valor actual para la duraci√≥n del error" o "Valor de salida
sustitutivo mientras dure el error", PID_3Step se mantiene en modo autom√°tico tambi√©n
cuando se rebasan los l√≠mites del valor real. De este modo, su instalaci√≥n puede sufrir da√±os.
Configure un comportamiento en caso de error para su sistema regulado que proteja su
instalaci√≥n de da√±os.
En caso de error, PID_3Step emite un valor de salida configurable:
‚óè Valor actual
PID_3Step est√° desconectado y ya no modifica la posici√≥n del elemento final de control.
‚óè Valor actual para la duraci√≥n del error
Las funciones de regulaci√≥n de PID_3Step est√°n desactivadas y ya no se modifica la
posici√≥n del elemento final de control.
Si se producen los siguientes errores en el modo autom√°tico, PID_3Step regresa a dicho
modo en cuanto los errores en cuesti√≥n dejan de existir.
‚Äì 0002h: Valor no v√°lido en el par√°metro Input_PER.
‚Äì 0200h: Valor no v√°lido en el par√°metro Input.
‚Äì 0400h: Error al calcular el valor de salida.
‚Äì 1000h: Valor no v√°lido en el par√°metro Setpoint.
‚Äì 2000h: Valor no v√°lido en el par√°metro Feedback_PER.
‚Äì 4000h: Valor no v√°lido en el par√°metro Feedback.
‚Äì 8000h: Error en la realimentaci√≥n digital de posici√≥n.
‚Äì 20000h: Valor no v√°lido en la variable SavePosition.
Si se producen uno o varios de los errores siguientes, PID_3Step permanece en
modo autom√°tico:
‚Äì 0001h: El par√°metro Input se encuentra fuera de los l√≠mites del valor real.
‚Äì 0800h: Error en tiempo de muestreo
‚Äì 40000h: Valor no v√°lido en el par√°metro Disturbance.
Si aparece un error en el modo manual, PID_3Step permanece en dicho modo.
Si durante la optimizaci√≥n o la medici√≥n del tiempo de posicionamiento se produce un error,
PID_3Step cambia al modo de operaci√≥n en que se hab√≠a comenzado la optimizaci√≥n o la
medici√≥n del tiempo de posicionamiento. La optimizaci√≥n no se cancela con los siguientes
errores √∫nicamente:
‚Äì 0020h: La optimizaci√≥n inicial no est√° permitida durante la optimizaci√≥n fina.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

739

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
‚óè Valor de salida sustitutivo
PID_3Step desplaza el elemento final de control (actuador) al valor de salida sustitutivo y
se desconecta.
‚óè Valor de salida sustitutivo mientras dure el error
PID_3Step desplaza el elemento final de control (actuador) al valor de salida sustitutivo.
Una vez alcanzado el valor de salida sustitutivo, PID_3Step se comporta como se describe
en "Valor actual mientras dure el error".
El valor de salida sustitutivo se introduce en "%".
En los actuadores sin realimentaci√≥n de posici√≥n anal√≥gica, solo es posible aproximar de
forma exacta los valores de salida sustitutivos 0% y 100%. Un valor de salida sustitutivo
diferente del 0% o del 100% se aproxima a trav√©s de una realimentaci√≥n de posici√≥n simulada
internamente. Sin embargo, con este procedimiento el valor de salida sustitutivo no podr√°
aproximarse nunca de forma exacta.
En los actuadores con realimentaci√≥n de posici√≥n anal√≥gica, es posible aproximar de forma
exacta todos los valores de salida sustitutivos.

Escalar realimentaci√≥n de posici√≥n V2
Escalar realimentaci√≥n de posici√≥n
Si con el ajuste b√°sico se ha elegido el uso de Feedback_PER, el valor de la entrada anal√≥gica
debe convertirse en %. En el cuadro de visualizaci√≥n "Feedback" se muestra el ajuste actual.
Feedback_PER se escala a partir de una pareja de valores inferiores y superiores.
1. En los campos de entrada "Tope inferior" y "Abajo" introduzca la pareja de valores
inferiores.
2. En los campos de entrada "Tope superior" y "Arriba" introduzca la pareja de valores
superiores.
El valor de "Tope inferior" debe ser inferior al de "Tope superior"; por su parte, "Abajo" debe ser
inferior a "Arriba".
Los valores v√°lidos para el "tope superior" y el "tope inferior" dependen de:
‚óè Sin Feedback, Feedback, Feedback_PER
‚óè Output (anal√≥gico), Output (digital)

740

Output

Feedback

Tope inferior

Tope superior

Output (digital)

Sin Feedback

No ajustable (0.0 %)

No ajustable (100.0 %)

Output (digital)

Feedback

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (digital)

Feedback_PER

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (anal√≥gico)

Sin Feedback

No ajustable (0.0 %)

No ajustable (100.0 %)

Output (anal√≥gico)

Feedback

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (anal√≥gico)

Feedback_PER

-100.0 % o 0.0 %

0.0 % o +100.0 %

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

L√≠mites del valor de salida V2
Limitar el valor de salida
Los l√≠mites del valor de salida pueden rebasarse por exceso o por defecto durante la medici√≥n
del tiempo de posicionamiento y en el modo = 10. En los dem√°s modos de operaci√≥n, el valor
de salida se limita a estos valores.
Introduzca en los campos de entrada "L√≠m. sup. v. de salida" y "L√≠m. inf. v. de salida" los l√≠mites
absolutos del valor de salida. Los l√≠mites del valor de salida deben encontrarse dentro del
"Tope inferior" o el "Tope superior".
Si no existe ning√∫n Feedback y est√° ajustado Output (digital), no se puede limitar el valor de
salida. Output_UP y Output_DN se restablecen entonces si se cumple Actuator_H = TRUE o
Actuator_L = TRUE. Si tampoco existen se√±ales de tope, Output_UP y Output_DN se
restablecen despu√©s de un tiempo de desplazamiento del 150% del tiempo de
posicionamiento del motor.
El valor predeterminado 150% puede modificarse mediante la variable
Config.VirtualActuatorLimit. A partir de PID_3Step versi√≥n 2.3 puede desactivarse la vigilancia
y limitaci√≥n del tiempo de desplazamiento con Config.VirtualActuatorLimit = 0.0.

Ajustes avanzados V2
Vigilancia valor real V2
Configure un l√≠mite de advertencia inferior y uno superior para el valor real en la ventana de
configuraci√≥n "Monitorizaci√≥n del valor real". Si durante el funcionamiento se rebasa uno de los
l√≠mites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucci√≥n
"PID_3Step".
‚óè En el par√°metro de salida "InputWarning_H", si se ha rebasado por exceso el l√≠mite superior
de advertencia.
‚óè En el par√°metro de salida "InputWarning_L", si se ha rebasado por defecto el l√≠mite inferior
de advertencia.
Los l√≠mites de advertencia deben encontrarse dentro de los l√≠mites superior e inferior del valor
real.
Si no introduce ning√∫n valor, se utilizan los l√≠mites superior e inferior del valor real.

Ejemplo
L√≠mite superior del valor real = 98 ¬∞C; l√≠mite superior de advertencia = 90 ¬∞C
L√≠mite inferior de advertencia = 10 ‚ÑÉ; l√≠mite inferior del valor real = 0 ‚ÑÉ

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

741

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
PID_3Step se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

ErrorBits

Modo de opera‚Äê
ci√≥n

> 98 ¬∞C

TRUE

FALSE

0001h

Seg√∫n configura‚Äê
ci√≥n

‚â§ 98 ¬∞C y > 90 ¬∞C

TRUE

FALSE

0000h

Modo autom√°tico

‚â§ 90 ¬∞C y ‚â• 10 ¬∞C

FALSE

FALSE

0000h

Modo autom√°tico

< 10¬∞C y ‚â• 0 ¬∞C

FALSE

TRUE

0000h

Modo autom√°tico

< 0 ¬∞C

FALSE

TRUE

0001h

Seg√∫n configura‚Äê
ci√≥n

Configure en los ajustes del actuador c√≥mo debe reaccionar PID_3Step si se rebasa el l√≠mite
superior o inferior del valor real.

Par√°metros PID V2
En la ventana de configuraci√≥n "Par√°metros PID" se visualizan los par√°metros PID. Durante la
optimizaci√≥n los par√°metros PID se adaptan al sistema regulado. No es necesario introducir
los par√°metros PID de forma manual.
Nota
Los par√°metros PID efectivos actualmente est√°n en la estructura Retain.CtrlParams.
Para prevenir un comportamiento err√≥neo del regulador PID, los par√°metros PID efectivos
actualmente solo deben modificarse online en el modo de operaci√≥n "Inactivo".
Si desea modificar online los par√°metros PID en los modos de operaci√≥n "Autom√°tico" o
"Manual", modifique los par√°metros PID en la estructura CtrlParamsBackUp y aplique los
cambios en la estructura Retain.CtrlParams, del siguiente modo:
‚óè PID_3Step V1: Aplique los cambios poniendo Config.LoadBackUp = TRUE
‚óè PID_3Step V2: Aplique los cambios poniendo LoadBackUp = TRUE
Los cambios online en los par√°metros PID realizados en el modo de operaci√≥n "Autom√°tico"
pueden provocar saltos en el valor de salida.
El algoritmo PID funciona de acuerdo con la siguiente f√≥rmula:

742

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
1

[

Œî y = K p ¬∑ s ¬∑ (b ¬∑ w - x) +

TI ¬∑ s

(w - x) +

TD ¬∑ s
a ¬∑ TD ¬∑ s + 1

(c ¬∑ w - x)

]

Œîy

Valor de salida del algoritmo PID

Kp

Ganancia proporcional

s

Operador laplaciano

b

Ponderaci√≥n de la acci√≥n P

w

Consigna

x

Valor real

TI

Tiempo de integraci√≥n

a

Coeficiente para el retardo de la acci√≥n derivada (retardo de la acci√≥n derivada T1 = a √ó TD)

TD

Tiempo derivativo

c

Ponderaci√≥n de la acci√≥n D

El gr√°fico siguiente muestra c√≥mo entran los par√°metros en el algoritmo PID.
E

6HWSRLQW Z



'7

F

'

.

3

ÀÇ\



'HDGB%





7L

,

6FDOHG,QSXW [
)DF7W

$QWL:LQGXS

Todos los par√°metros PID son remanentes. Si introduce manualmente los par√°metros PID,
debe cargar PID_3Step por completo.
Cargar objetos tecnol√≥gicos en el dispositivo (P√°gina 667)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_3Step no funciona con una
ganancia proporcional negativa. El sentido de regulaci√≥n se invierte en Ajustes b√°sicos > Tipo
de regulaci√≥n.

Tiempo de integraci√≥n
El tiempo de integraci√≥n determina el comportamiento temporal de la acci√≥n I. La desconexi√≥n
de la acci√≥n I se realiza con el tiempo de integraci√≥n = 0,0. Si el tiempo de integraci√≥n se
modifica online en el modo de operaci√≥n "Autom√°tico" de un valor cualquiera a 0.0, la acci√≥n
I actual se borra y se produce un salto del valor de salida.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

743

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Tiempo derivativo
El tiempo de la acci√≥n derivada determina el comportamiento temporal de la acci√≥n D. La
desconexi√≥n de la acci√≥n D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acci√≥n derivada
El efecto de la acci√≥n D se retrasa mediante el coeficiente de retardo de la acci√≥n derivada.
Retardo de la acci√≥n derivada = Tiempo derivativo x coeficiente de retardo de la acci√≥n
derivada
‚óè 0.0: la acci√≥n D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
‚óè 0.5: Este valor se ha acreditado en la pr√°ctica para sistemas regulados con una constante
de tiempo dominante.
‚óè > 1.0: Cuanto mayor sea el coeficiente, m√°s se retrasar√° el efecto de la acci√≥n D.

Ponderaci√≥n de la acci√≥n P
En el caso de que se modifique la consigna, es posible atenuar la acci√≥n P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n P es totalmente efectiva al cambiar la consigna
‚óè 0.0: La acci√≥n P no es efectiva al cambiar la consigna
Si se produce una modificaci√≥n del valor real, la acci√≥n P es totalmente efectiva.

Ponderaci√≥n de la acci√≥n D
En el caso de que se modifique la consigna, es posible atenuar la acci√≥n D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n D es totalmente efectiva cuando se cambia la consigna.
‚óè 0.0: la acci√≥n D no es efectiva cuando cambia la consigna.
Si se produce una modificaci√≥n del valor real, la acci√≥n D es totalmente efectiva.

Tiempo de muestreo algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo del algoritmo
PID es el tiempo entre dos c√°lculos del valor de salida. Este se determina durante la
optimizaci√≥n y se redondea a un m√∫ltiplo del tiempo de muestreo PID_3Step. Todas las dem√°s
funciones de PID_3Step se ejecutan con cada llamada.

Ancho de zona muerta
La zona muerta suprime los niveles del ruido en el estado estabilizado del regulador. El ancho
de zona muerta indica el tama√±o de la zona muerta. Con un ancho de zona muerta de 0.0, la
zona muerta se encuentra desactivada.

744

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Si para la ponderaci√≥n de la acci√≥n P o de la acci√≥n D se han configurado valores diferentes
de 1.0, los cambios de la consigna tambi√©n tendr√°n efecto sobre el valor de salida en la zona
muerta.
Los cambios del valor real comprendidos dentro de la zona muerta no tienen efecto sobre el
valor de salida, independientemente de la ponderaci√≥n.

Consulte tambi√©n
Elecci√≥n de la estructura del regulador con un sistema regulado definido (P√°gina 660)

Puesta en servicio de PID_3Step V2
Optimizaci√≥n inicial V2
La optimizaci√≥n inicial determina el comportamiento del proceso a un impulso del valor de
salida y busca el punto de inflexi√≥n. A partir de la inclinaci√≥n m√°xima y del tiempo muerto del
sistema regulado se calculan los par√°metros PID √≥ptimos. Para obtener los mejores
par√°metros PID, debe efectuarse una optimizaci√≥n inicial y una optimizaci√≥n fina.
Cuanto m√°s estable es el valor real, con mayor facilidad y precisi√≥n se pueden calcular los
par√°metros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea
considerablemente mayor que el ruido. Esto tiene m√°s probabilidades de suceder en los
modos "Inactivo" o "Manual". Es preciso realizar una copia de seguridad de los par√°metros PID
antes de volver a calcularlos.
La consigna se congela durante la optimizaci√≥n inicial.

Requisitos
‚óè La instrucci√≥n "PID_3Step" se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè Reset = FALSE
‚óè El tiempo de posicionamiento del motor est√° configurado o medido.
‚óè PID_3Step se encuentra en el modo de operaci√≥n "Inactivo", "Modo manual" o "Modo
autom√°tico".
‚óè La consigna y el valor real se encuentran dentro de los l√≠mites configurados (v√©ase la
configuraci√≥n "Configuraci√≥n del valor real").

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

745

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimizaci√≥n inicial, proceda del siguiente modo:
1. Haga doble clic en la navegaci√≥n del proyecto en la entrada "PID_3Step > Puesta en
servicio".
2. En la lista desplegable "Modo de optimizaci√≥n" del √°rea de trabajo "Optimizaci√≥n"
seleccione la entrada "Optimizaci√≥n inicial".
3. Haga clic en el s√≠mbolo "Start".
‚Äì Se establece una conexi√≥n online.
‚Äì Se inicia el registro de los valores.
‚Äì Se inicia la optimizaci√≥n inicial.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Haga clic en el s√≠mbolo "Stop" cuando la barra de progreso haya alcanzado el 100% y
se deba presuponer un bloqueo de la optimizaci√≥n. Compruebe la configuraci√≥n del
objeto tecnol√≥gico y, si procede, vuelva a iniciar la optimizaci√≥n.

Resultado
Si la optimizaci√≥n inicial ha finalizado sin ning√∫n mensaje de error, significa que los par√°metros
PID se han optimizado. PID_3Step cambia al modo autom√°tico y utiliza los par√°metros
optimizados. Los par√°metros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es posible realizar la optimizaci√≥n inicial, PID_3Step se comporta del modo configurado
en Comportamiento en caso de error.

Optimizaci√≥n fina V2
La optimizaci√≥n fina genera una oscilaci√≥n constante y limitada del valor real. Los par√°metros
PID se optimizan para el punto de operaci√≥n a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular todos los par√°metros PID. Los par√°metros PID existentes
despu√©s de la optimizaci√≥n fina muestran en su mayor√≠a un comportamiento de gu√≠a y ante
fallos mucho mejor que los par√°metros PID de la optimizaci√≥n inicial. Para obtener los mejores
par√°metros PID, debe efectuarse una optimizaci√≥n inicial y una optimizaci√≥n fina.
PID_3Step intenta generar autom√°ticamente una oscilaci√≥n que es mayor que el ruido del
valor real. La estabilidad del valor real ejerce tan s√≥lo una m√≠nima influencia sobre la
optimizaci√≥n fina. Es preciso realizar una copia de seguridad de los par√°metros PID antes de
volver a calcularlos.
La consigna se congela durante la optimizaci√≥n fina.

746

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Requisitos
‚óè La instrucci√≥n "PID_3Step" se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè Reset = FALSE
‚óè El tiempo de posicionamiento del motor est√° configurado o medido.
‚óè La consigna y el valor real se encuentran dentro de los l√≠mites configurados (v√©ase la
configuraci√≥n "Configuraci√≥n del valor real").
‚óè El lazo de regulaci√≥n es estacionario en el punto de operaci√≥n. El punto de operaci√≥n se ha
alcanzado cuando el valor real coincide con la consigna.
‚óè No se esperan perturbaciones.
‚óè PID_3Step se encuentra en el modo de operaci√≥n inactivo, autom√°tico o manual.

El proceso depende de la situaci√≥n de inicio
La optimizaci√≥n fina se desarrolla del modo siguiente en el momento del inicio:
‚óè Modo autom√°tico
Si desea mejorar los par√°metros PID existentes mediante optimizaci√≥n, inicie la
optimizaci√≥n fina desde el modo autom√°tico.
PID_3Step regula con los par√°metros PID existentes hasta que el lazo de regulaci√≥n es
estacionario y se han cumplido las condiciones para una optimizaci√≥n fina. S√≥lo entonces
comienza la optimizaci√≥n fina.
‚óè Inactivo o manual
Se realiza primero una optimizaci√≥n inicial. Con los par√°metros PID calculados, la
regulaci√≥n se realiza hasta que el lazo de regulaci√≥n es estacionario y se han cumplido las
condiciones para una optimizaci√≥n fina. S√≥lo entonces comienza la optimizaci√≥n fina.

Procedimiento
Para poder realizar una optimizaci√≥n fina, proceda del siguiente modo:
1. En la lista desplegable "Modo de optimizaci√≥n" seleccione la entrada "Optimizaci√≥n fina".
2. Haga clic en el s√≠mbolo "Start".
‚Äì Se establece una conexi√≥n online.
‚Äì Se inicia el registro de los valores.
‚Äì Se inicia el proceso de optimizaci√≥n fina.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los errores
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de optimizaci√≥n" haga clic en el s√≠mbolo "Stop" cuando la barra de
progreso haya alcanzado el 100% y se deba presuponer un bloqueo de la optimizaci√≥n.
Compruebe la configuraci√≥n del objeto tecnol√≥gico y, si procede, vuelva a iniciar la
optimizaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

747

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Resultado
Si durante la optimizaci√≥n fina no se producen errores, significa que los par√°metros PID se han
optimizado. PID_3Step cambia al modo autom√°tico y utiliza los par√°metros optimizados. Los
par√°metros PID optimizados se conservan al desconectar (Power OFF) y al rearrancar por
completo la CPU.
Si se han producido errores durante la optimizaci√≥n fina, PID_3Step se comporta del modo
configurado en Comportamiento en caso de error.

Realizar la puesta en servicio con par√°metros PID manuales V2
Requisitos
‚óè La instrucci√≥n "PID_3Step" se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè Reset = FALSE
‚óè El tiempo de posicionamiento del motor est√° configurado o medido.
‚óè PID_3Step se encuentra en el modo de operaci√≥n "Inactivo".
‚óè La consigna y el valor real se encuentran dentro de los l√≠mites configurados (v√©ase la
configuraci√≥n "Configuraci√≥n del valor real").

Procedimiento
Para poner en marcha PID_3Step con par√°metros PID manuales, proceda del siguiente modo:
1. Haga doble clic en la navegaci√≥n del proyecto en la entrada "PID_3Step" > Configuraci√≥n".
2. En la ventana de configuraci√≥n haga clic en "Ajustes avanzados > Par√°metros PID".
3. Active la casilla de verificaci√≥n "Activar entrada manual".
4. Introduzca los par√°metros PID.
5. Haga doble clic en la navegaci√≥n del proyecto en la entrada "PID_3Step > Puesta en
servicio".
6. Establezca una conexi√≥n online con la CPU.
7. Cargue los par√°metros PID en la CPU.
8. Haga clic en el s√≠mbolo "Start PID_3Step".

Resultado
PID_3Step cambia al modo autom√°tico y realiza la regulaci√≥n con los par√°metros PID actuales.

Consulte tambi√©n
Par√°metros PID V2 (P√°gina 742)

748

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Medir el tiempo de posicionamiento del motor V2
Introducci√≥n
PID_3Step necesita un tiempo de posicionamiento del motor lo m√°s preciso posible para
alcanzar un buen resultado de regulaci√≥n. Los datos de la documentaci√≥n del elemento final
de control son valores medios para este tipo de elemento final de control. El valor puede variar
para el elemento final de control que se use en cada momento.
Si utiliza actuadores con realimentaci√≥n de posici√≥n o con se√±ales de tope, es posible medir
el tiempo de posicionamiento del motor durante la puesta en servicio. Los l√≠mites del valor de
salida no se tienen en cuenta durante la medici√≥n del tiempo de posicionamiento del motor. El
actuador puede desplazarse hasta el tope superior o inferior.
Si no se dispone de una realimentaci√≥n de posici√≥n ni de se√±ales de tope, no es posible medir
el tiempo de posicionamiento del motor.

Actuadores con realimentaci√≥n de posici√≥n anal√≥gica
Para medir el tiempo de posicionamiento del motor con realimentaci√≥n de posici√≥n, proceda
del siguiente modo:
Requisitos
‚óè En la configuraci√≥n b√°sica se ha seleccionado Feedback o Feedback_PER y la se√±al se
interconecta.
‚óè Se ha establecido una conexi√≥n online con la CPU.
1. Active la casilla de verificaci√≥n "Utilizar realimentaci√≥n de posici√≥n".
2. En el campo de entrada "Posici√≥n de destino" indique hacia d√≥nde desea mover el
elemento final de control.
La realimentaci√≥n de posici√≥n actual (posici√≥n de inicio) se muestra. La diferencia entre
"Posici√≥n de destino" y "Realimentaci√≥n de posici√≥n" debe ser al menos el 50% del rango
admisible para el valor de salida.
3. Haga clic en el s√≠mbolo "Start".

Resultado
El elemento final de control se desplaza hasta la posici√≥n de destino desde la posici√≥n de
inicio. La medici√≥n del tiempo se inicia de inmediato y finaliza en cuanto el elemento final de
control ha alcanzado la posici√≥n de destino. El tiempo de posicionamiento del motor se calcula
seg√∫n la f√≥rmula:
Tiempo de posicionamiento del motor = (L√≠mite superior del valor de salida - L√≠mite inferior del
valor de salida) x Tiempo de medici√≥n /VALOR ABSOLUTO(Posici√≥n de destino - Posici√≥n de
inicio).
Se muestran el progreso y el estado de la medici√≥n del tiempo de posicionamiento. El tiempo
de posicionamiento medido se almacena en el bloque de datos de instancia de la CPU y se
muestra en el campo "Tiempo de actuaci√≥n medido" Si ha finalizado la medici√≥n del tiempo de
posicionamiento y ActivateRecoverMode = TRUE, PID_3Step pasa al modo desde el que se

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

749

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
inici√≥ la medici√≥n. Si ha finalizado la medici√≥n del tiempo de posicionamiento y
ActivateRecoverMode = FALSE, PID_3Step pasa al modo de operaci√≥n "Inactivo".
Nota
Para adoptar el tiempo de posicionamiento del motor medido en el proyecto, haga clic en el
icono
"Cargar tiempo pos. medido".

Actuadores con se√±ales de tope
Para medir el tiempo de posicionamiento de los actuadores con se√±ales de tope, proceda del
siguiente modo:
Requisitos
‚óè En la configuraci√≥n b√°sica la casilla de verificaci√≥n "Se√±ales de tope" est√° activada y los
actuadores H y L est√°n interconectados.
‚óè Se ha establecido una conexi√≥n online con la CPU.
Para medir el tiempo de posicionamiento del motor con se√±ales de tope, proceda del siguiente
modo:
1. Active la casilla de verificaci√≥n "Utilizar se√±ales de tope del actuador".
2. Seleccione el sentido en el que desee mover el elemento final de control.
‚Äì Abrir - Cerrar - Abrir
El elemento final de control se mueve primero hasta el tope superior, despu√©s, hasta el
tope inferior y, de nuevo, hasta el tope superior.
‚Äì Cerrar - Abrir - Cerrar
El elemento final de control se mueve primero hasta el tope inferior, despu√©s, hasta el
tope superior y, de nuevo, hasta el tope inferior.
3. Haga clic en el s√≠mbolo "Start".

Resultado
El elemento final de control se mueve en el sentido seleccionado. La medici√≥n del tiempo se
inicia cuando el elemento final de control ha alcanzado el primer tope y finaliza cuando el
elemento final de control alcanza este tope por segunda vez. El tiempo medido dividido entre
dos da lugar al tiempo de posicionamiento del motor.
Se muestran el progreso y el estado de la medici√≥n del tiempo de posicionamiento. El tiempo
de posicionamiento medido se almacena en el bloque de datos de instancia de la CPU y se
muestra en el campo "Tiempo de actuaci√≥n medido" Si ha finalizado la medici√≥n del tiempo de
posicionamiento y ActivateRecoverMode = TRUE, PID_3Step pasa al modo desde el que se
inici√≥ la medici√≥n. Si ha finalizado la medici√≥n del tiempo de posicionamiento y
ActivateRecoverMode = FALSE, PID_3Step pasa al modo de operaci√≥n "Inactivo".

Cancelar medici√≥n del tiempo de posicionamiento
Una vez cancelada la medici√≥n del tiempo de posicionamiento con el bot√≥n Stop, PID_3Step
cambia al modo de operaci√≥n "Inactivo".

750

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Simulaci√≥n de PID_3Step V2 con PLCSIM
Nota
Simulaci√≥n con PLCSIM
La simulaci√≥n de PID_3Step V2.x con PLCSIM para CPU S7-1200 no se soporta.
PID_3Step V2.x solo puede simularse con PLCSIM para CPU S7-1500.
En la simulaci√≥n con PLCSIM, el comportamiento temporal del PLC simulado no es id√©ntico al
de un PLC "aut√©ntico". El verdadero ciclo de un OB de alarma c√≠clica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "aut√©ntico".
En la configuraci√≥n est√°ndar, PID_3Step determina autom√°ticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_3Step con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
Esto provoca la cancelaci√≥n de las optimizaciones en curso.
La reacci√≥n en el modo autom√°tico depende del valor de la variable ActivateRecoverMode.
Para evitarlo, debe configurarse PID_3Step en la simulaci√≥n con PLCSIM del modo siguiente:
‚óè CycleTime.EnEstimation = FALSE
‚óè CycleTime.EnMonitoring = FALSE
‚óè CycleTime.Value: Asigne a estas variables el ciclo del OB de alarma c√≠clica que se debe
llamar en la unidad segundos.

3.3.2.3

PID_3Step V1

Configuraci√≥n de PID_3Step V1
Ajustes b√°sicos V1
Introducci√≥n V1
Configure las propiedades siguientes del objeto tecnol√≥gico PID_3Step en el √°rea de ajustes
b√°sicos de la ventana de inspecci√≥n o de configuraci√≥n.
‚óè Magnitud f√≠sica
‚óè Sentido de regulaci√≥n
‚óè Comportamiento en arranque tras un reset
‚óè Consigna (s√≥lo en la ventana de inspecci√≥n)
‚óè Valor real (s√≥lo en la ventana de inspecci√≥n)
‚óè Valor de salida (s√≥lo en la ventana de inspecci√≥n)
‚óè Realimentaci√≥n de posici√≥n (s√≥lo en la ventana de inspecci√≥n)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

751

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Consigna, valor real, valor de salida y realimentaci√≥n de posici√≥n
La consigna, el valor real, el valor de salida y la realimentaci√≥n de posici√≥n s√≥lo pueden
configurarse en la ventana de inspecci√≥n del editor de programaci√≥n. Para cada valor elija el
origen:
‚óè DB de instancia
Se utiliza el valor que se encuentra almacenado en el DB de instancia.
El valor debe actualizarse en el DB de instancia del programa de usuario.
En la instrucci√≥n no puede haber ning√∫n valor.
Modificaci√≥n posible desde HMI.
‚óè Instrucci√≥n
Se utiliza el valor que se interconecta a la instrucci√≥n.
Cada vez que se llama la instrucci√≥n, el valor se escribe en el DB de instancia.
No se puede modificar desde HMI.

Tipo de regulaci√≥n V1
Magnitud f√≠sica
En el grupo "Tipo de regulaci√≥n" seleccione la magnitud f√≠sica y la unidad de la consigna y el
valor real. La consigna y el valor real se muestran en esta unidad.

Sentido de regulaci√≥n
Por lo general, un aumento del valor de salida debe lograr un aumento del valor real. En este
caso, se habla de un sentido de regulaci√≥n normal.
PID_3Step no funciona con ganancia proporcional negativa. Para reducir el valor real con un
valor de salida m√°s elevado, active la casilla de verificaci√≥n "Inversi√≥n sentido de regulaci√≥n".
Ejemplos
‚óè Al abrir una v√°lvula de escape se reduce el nivel de llenado de un recipiente.
‚óè Si se aumenta la potencia de refrigeraci√≥n, disminuye la temperatura.

Comportamiento en arranque tras un reset
Para cambiar inmediatamente al √∫ltimo modo de operaci√≥n activo tras un rearranque completo
de la CPU, active la casilla de verificaci√≥n "Activar √∫ltimo modo de operaci√≥n despu√©s del
rearranque de la CPU".
Si la casilla de verificaci√≥n est√° desactivada, PID_3Step se queda en el modo de operaci√≥n
"Inactivo".

752

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Consigna V1
Procedimiento
Para especificar una consigna fija, proceda del siguiente modo:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 ¬∞C.
3. En caso necesario, elimine una entrada de la instrucci√≥n.
Para especificar una consigna variable, proceda del siguiente modo:
1. Seleccione "Instrucci√≥n".
2. Indique el nombre de la variable REAL en la que est√° almacenada la consigna.
Es posible asignar varios valores de forma controlada por programa a la variable REAL
para, por ejemplo, modificar la consigna de tiempo de forma controlada.

Valor real V1
Si utiliza directamente el valor de la entrada anal√≥gica, PID_3Step escala el valor de la entrada
anal√≥gica al tama√±o f√≠sico.
Si desea acondicionar primero el valor de la entrada anal√≥gica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada anal√≥gica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada anal√≥gica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucci√≥n" como fuente.
3. Introduzca la direcci√≥n de la entrada anal√≥gica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucci√≥n" como fuente.
3. Indique el nombre de la variable en la que est√° almacenado el valor real acondicionado.

Realimentaci√≥n de posici√≥n V1
La configuraci√≥n de la realimentaci√≥n de posici√≥n depende del elemento final de control
utilizado.
‚óè Actuador sin realimentaci√≥n de posici√≥n
‚óè Elemento final de control con se√±ales de tope digitales

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

753

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
‚óè Actuador con realimentaci√≥n de posici√≥n anal√≥gica
‚óè Actuador con realimentaci√≥n de posici√≥n anal√≥gico y se√±ales de tope

Elemento final de control sin realimentaci√≥n de posici√≥n
Para configurar PID_3Step para un elemento final de control sin realimentaci√≥n de posici√≥n,
proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "No Feedback".

Elemento final de control con se√±ales de tope digitales
Para configurar PID_3Step para un elemento final de control con se√±ales de tope, proceda del
siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "No Feedback".
2. Active la casilla de verificaci√≥n "Se√±al tope del actuador".
3. Seleccione "Instrucci√≥n" como fuente para Actuator_H y Actuator_L.
4. Introduzca las direcciones de las entradas digitales para Actuator_H y Actuator_L.

Elemento final de control con realimentaci√≥n de posici√≥n anal√≥gica
Para configurar PID_3Step para un elemento final de control con realimentaci√≥n de posici√≥n
anal√≥gica, proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "Feedback" o "Feedback_PER".
‚Äì En Feedback_PER utilice el valor de la entrada anal√≥gica. El escalado de
Feedback_PER se configura en la configuraci√≥n del elemento final de control.
‚Äì En Feedback procese el valor de la entrada anal√≥gica a trav√©s de su programa de
usuario.
2. Seleccione "Instrucci√≥n" como fuente.
3. Introduzca la direcci√≥n de la entrada anal√≥gica o la variable de su programa de usuario.

Elemento final de control con realimentaci√≥n de posici√≥n anal√≥gica y se√±ales de tope
Para configurar PID_3Step para un elemento final de control con realimentaci√≥n de posici√≥n
anal√≥gica y se√±ales de tope, proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "Feedback" o "Feedback_PER".
2. Seleccione "Instrucci√≥n" como fuente.
3. Introduzca la direcci√≥n de la entrada anal√≥gica o la variable de su programa de usuario.
4. Active la casilla de verificaci√≥n "Se√±al tope del actuador".
5. Seleccione "Instrucci√≥n" como fuente para Actuator_H y Actuator_L.
6. Introduzca las direcciones de las entradas digitales para Actuator_H y Actuator_L.

754

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Valor de salida V1
PID_3Step ofrece un valor de salida anal√≥gico (Output_PER) y valores de salida digitales
(Output_UP, Output_DN). El valor de salida que se utilice depender√° del actuador.
‚óè Output_PER
El actuador dispone de un tiempo de posicionamiento del motor relevante, se activa a
trav√©s de una salida anal√≥gica y se controla con una se√±al continua, como puede ser 0 a
10 V, 4 a 20 mA. El valor de Output_PER se corresponde con la posici√≥n de destino de la
v√°lvula, p. ej., Output_PER = 13824, cuando la v√°lvula debe abrirse hasta un 50 %.
PID_3Step tiene en cuenta, p. ej., para la optimizaci√≥n autom√°tica y el comportamiento AntiWindup, que el valor de salida anal√≥gico act√∫a en el proceso con un retardo debido al
tiempo de posicionamiento del motor. Si en su proceso no act√∫a ning√∫n tiempo de
posicionamiento del motor relevante (p. ej., con electrov√°lvulas), de forma que el valor de
salida act√∫a directamente y en toda su magnitud sobre el proceso, utilice PID_Compact en
su lugar.
‚óè Output_UP, Output_DN
El actuador dispone de un tiempo de posicionamiento del motor relevante y se controla
mediante dos salidas digitales.
Output_UP desplaza la v√°lvula hacia el estado abierto.
Output_DN desplaza la v√°lvula hacia el estado cerrado.
El tiempo de posicionamiento del motor se tiene en cuenta tanto en el c√°lculo del valor de
salida anal√≥gico como en el c√°lculo de los valores de salida digitales. Es necesario para el
correcto funcionamiento, sobre todo, durante la optimizaci√≥n autom√°tica y el comportamiento
Anti-Windup. Por tanto, configure el tiempo de posicionamiento del motor en "Ajustes del
actuador" con el valor que requiere el motor para desplazar el actuador del estado cerrado al
estado abierto.

Procedimiento
Para utilizar el valor de salida anal√≥gico, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada Output (anal√≥gica).
2. Seleccione "Instrucci√≥n".
3. Introduzca la direcci√≥n de la salida anal√≥gica.
Para utilizar el valor de salida digital, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output (digital)".
2. Seleccione "Instrucci√≥n" para Output_UP y Output_DN.
3. Introduzca las direcciones de las salidas digitales.
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "Output" seleccione la entrada adecuada al actuador.
2. Seleccione "Instrucci√≥n".
3. Indique el nombre de la variable que utilizar√° para acondicionar el valor de salida.
4. Transfiera el valor de salida acondicionado hasta el actuador a trav√©s de una salida
anal√≥gica o digital de la CPU.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

755

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Ajuste de valor real V1
Configure la normalizaci√≥n del valor real en la ventana de configuraci√≥n "Ajustes del valor real"
y fije los l√≠mites absolutos del valor real.

Escalar valor real
Si en los ajustes b√°sicos se ha elegido el uso de Input_PER, el valor de la entrada anal√≥gica
debe convertirse en el tama√±o f√≠sico del valor real. En el cuadro de visualizaci√≥n Input_PER se
muestra la configuraci√≥n actual.
Si el valor real es directamente proporcional al valor de la entrada anal√≥gica, Input_PER se
escala a partir de una pareja de valores inferiores y superiores.
1. En los campos de entrada "Valor real inferior escalado" y "Abajo" introduzca la pareja de
valores inferior.
2. En los campos de entrada "Valor real superior escalado" y "arriba", introduzca el par de
valores superior.
La configuraci√≥n hardware incluye una configuraci√≥n predeterminada de las parejas de
valores. Para utilizar los pares de valores a partir de la configuraci√≥n hardware, proceda del
siguiente modo:
1. Marque la instrucci√≥n PID_3Step en el editor de programaci√≥n.
2. En los ajustes b√°sicos, interconecte Input_PER con una entrada anal√≥gica.
3. En los ajustes del valor real, haga clic en el bot√≥n "Ajuste autom√°tico".
Los valores existentes se sobrescriben con los valores de la configuraci√≥n hardware.

Monitorizar el valor real
Defina los l√≠mites absolutos superior e inferior del valor real. Como l√≠mites, se deben introducir
valores razonables para el sistema regulado. Durante la optimizaci√≥n es importante disponer
de valores l√≠mite razonables para obtener los par√°metros PID √≥ptimos. La preasignaci√≥n del
"L√≠mite superior del valor real" es 120%. En la entrada de periferia, el valor real puede
encontrarse como m√°ximo un 18% por encima del rango normalizado (margen de saturaci√≥n).
No se comunica ning√∫n error m√°s con este ajuste debido al rebase por exceso del "L√≠mite
superior del valor real". √önicamente se detectan la rotura de hilo y el cortocircuito y PID_3Step
se comporta seg√∫n la reacci√≥n configurada en caso de error.
ATENCI√ìN
Su instalaci√≥n puede sufrir da√±os.
Si ajusta valores muy altos (z. B. -3,4*1038...+3,4*1038) como l√≠mites del valor real, se
desactiva la monitorizaci√≥n del valor real. Esto puede dar lugar a da√±os en la instalaci√≥n.
Configure l√≠mites del valor real razonables para su sistema regulado.

756

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Ajuste de actuador V1
Tiempos espec√≠ficos del actuador
Para proteger el elemento final de control frente a da√±os, ajuste el tiempo de posicionamiento
del motor y los tiempos m√≠nimos de conexi√≥n y desconexi√≥n. Los datos figuran en la hoja de
datos del elemento final de control.
El tiempo de posicionamiento del motor es el tiempo en segundos que requiere el motor para
desplazar el elemento final de control del estado cerrado al estado abierto. El actuador se
mueve en un sentido a como m√°ximo el 110 % del tiempo de posicionamiento del motor. El
tiempo de posicionamiento del motor puede medirse durante la puesta en servicio.
El tiempo de posicionamiento del motor se tiene en cuenta tanto en el c√°lculo del valor de
salida anal√≥gico como en el c√°lculo de los valores de salida digitales. Es necesario para el
correcto funcionamiento, sobre todo, durante la optimizaci√≥n autom√°tica y el comportamiento
Anti-Windup.
Si en su proceso no act√∫a ning√∫n tiempo de posicionamiento del motor relevante (p. ej., con
electrov√°lvulas), de forma que el valor de salida act√∫a directamente y en toda su magnitud
sobre el proceso, utilice PID_Compact en su lugar.
Si se utiliza Output_UP y Output_DN, debe reducirse la frecuencia de conmutaci√≥n con los
tiempos m√≠nimos de conexi√≥n y desconexi√≥n.
En el modo autom√°tico se acumulan los tiempos calculados de conexi√≥n y desconexi√≥n y estos
no surten efecto hasta que la suma sea igual o superior al tiempo m√≠nimo de conexi√≥n o
desconexi√≥n.
En el modo manual, un flanco ascendente en Manual_UP o Manual_DN permite controlar el
elemento final de control al menos en el tiempo m√≠nimo de conexi√≥n o desconexi√≥n.
Si en los ajustes b√°sicos ha elegido el valor anal√≥gico de salida Output_PER, el tiempo de
conexi√≥n m√≠nimo y el tiempo de desconexi√≥n m√≠nimo no se eval√∫an ni se pueden modificar.

Comportamiento en caso de error
PID_3Step est√° preajustado de manera que, en caso de error, la regulaci√≥n permanece activa
en la mayor√≠a de los casos. Si en el modo de regulaci√≥n se producen errores con frecuencia,
este ajuste empeorar√° el comportamiento de regulaci√≥n. Compruebe en tal caso el par√°metro
Errorbits y elimine la causa de error.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

757

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
En caso de error, PID_3Step emite un valor de salida configurable:
‚óè Valor actual
PID_3Step est√° desconectado y ya no modifica la posici√≥n del elemento final de control.
‚óè Valor actual para la duraci√≥n del error
Las funciones de regulaci√≥n de PID_3Step est√°n desactivadas y ya no se modifica la
posici√≥n del elemento final de control.
Si se producen los siguientes errores en el modo autom√°tico, PID_3Step regresa a dicho
modo en cuanto los errores en cuesti√≥n dejan de existir.
‚Äì 0002h: Valor no v√°lido en el par√°metro Input_PER.
‚Äì 0200h: Valor no v√°lido en el par√°metro Input.
‚Äì 0800h: Error en tiempo de muestreo
‚Äì 1000h: Valor no v√°lido en el par√°metro Setpoint.
‚Äì 2000h: Valor no v√°lido en el par√°metro Feedback_PER.
‚Äì 4000h: Valor no v√°lido en el par√°metro Feedback.
‚Äì 8000h: Error en la realimentaci√≥n digital de posici√≥n.
Si aparece alguno de los errores siguientes en el modo manual, PID_3Step permanece en
dicho modo.
Si se produce un error durante la optimizaci√≥n o durante la medici√≥n del tiempo de
posicionamiento, PID_3Step se desconecta.
‚óè Valor de salida sustitutivo
PID_3Step desplaza el elemento final de control (actuador) al valor de salida sustitutivo y
se desconecta.
‚óè Valor de salida sustitutivo mientras dure el error
PID_3Step desplaza el elemento final de control (actuador) al valor de salida sustitutivo.
Una vez alcanzado el valor de salida sustitutivo, PID_3Step se comporta como se describe
en "Valor actual mientras dure el error".
El valor de salida sustitutivo se introduce en "%".
En los actuadores sin realimentaci√≥n de posici√≥n anal√≥gica, solo es posible aproximar de
forma exacta los valores de salida sustitutivos 0% y 100%. Para poder alcanzar el tope superior
e inferior, el elemento final de control se desplaza en un sentido con un 110% del tiempo de
posicionamiento del motor. Las se√±ales de tope tienen prioridad. Un valor de salida sustitutivo
diferente del 0% o del 100% se aproxima a trav√©s de una realimentaci√≥n de posici√≥n simulada
internamente. Sin embargo, con este procedimiento el valor de salida sustitutivo no podr√°
aproximarse nunca de forma exacta.
En los actuadores con realimentaci√≥n de posici√≥n anal√≥gica, es posible aproximar de forma
exacta todos los valores de salida sustitutivos.

Escalar realimentaci√≥n de posici√≥n
Si con el ajuste b√°sico se ha elegido el uso de Feedback_PER, el valor de la entrada anal√≥gica
debe convertirse en %. En el cuadro de visualizaci√≥n "Feedback" se muestra el ajuste actual.

758

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Feedback_PER se escala a partir de una pareja de valores inferiores y superiores.
1. En los campos de entrada "Tope inferior" y "Abajo" introduzca la pareja de valores
inferiores.
2. En los campos de entrada "Tope superior" y "Arriba" introduzca la pareja de valores
superiores.
El valor de "Tope inferior" debe ser inferior al de "Tope superior"; por su parte, "Abajo" debe ser
inferior a "Arriba".
Los valores v√°lidos para el "Tope superior" y el "Tope inferior" dependen de:
‚óè Sin Feedback, Feedback, Feedback_PER
‚óè Output (anal√≥gico), Output (digital)
Output

Feedback

Tope inferior

Tope superior

Output (digital)

Sin Feedback

No ajustable (0.0 %)

No ajustable (100.0 %)

Output (digital)

Feedback

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (digital)

Feedback_PER

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (anal√≥gico)

Sin Feedback

No ajustable (0.0 %)

No ajustable (100.0 %)

Output (anal√≥gico)

Feedback

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (anal√≥gico)

Feedback_PER

-100.0 % o 0.0 %

0.0 % o +100.0 %

Limitar el valor de salida
Los l√≠mites del valor de salida solo pueden rebasarse por exceso o por defecto durante la
medici√≥n del tiempo de posicionamiento. En los dem√°s modos de operaci√≥n, el valor de salida
se limita a estos valores.
Introduzca en los campos de entrada "L√≠m. sup. v. de salida" y "L√≠m. inf. v. de salida" los l√≠mites
absolutos del valor de salida. Los l√≠mites del valor de salida deben encontrarse dentro del
"Tope inferior" o el "Tope superior".
Si no hay ning√∫n Feedback y se ha ajustado Output (digital), el valor de salida no se puede
limitar. Las salidas digitales deben desactivarse en Actuator_H = TRUE o Actuator_L = TRUE
o despu√©s de un tiempo de desplazamiento del 110% del tiempo de posicionamiento del motor.

Ajustes avanzados V1
Vigilancia valor real V1
Configure un l√≠mite de advertencia inferior y uno superior para el valor real en la ventana de
configuraci√≥n "Monitorizaci√≥n del valor real". Si durante el funcionamiento se rebasa uno de los
l√≠mites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucci√≥n
"PID_3Step".
‚óè En el par√°metro de salida "InputWarning_H", si se ha rebasado por exceso el l√≠mite superior
de advertencia.
‚óè En el par√°metro de salida "InputWarning_L", si se ha rebasado por defecto el l√≠mite inferior
de advertencia.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

759

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Los l√≠mites de advertencia deben encontrarse dentro de los l√≠mites superior e inferior del valor
real.
Si no introduce ning√∫n valor, se utilizan los l√≠mites superior e inferior del valor real.

Ejemplo
L√≠mite superior del valor real = 98 ¬∞C; l√≠mite superior de advertencia = 90 ¬∞C
L√≠mite inferior de advertencia = 10 ‚ÑÉ; l√≠mite inferior del valor real = 0 ‚ÑÉ
PID_3Step se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

Modo de operaci√≥n

> 98 ¬∞C

TRUE

FALSE

Inactivo

‚â§ 98 ¬∞C y > 90 ¬∞C

TRUE

FALSE

Modo autom√°tico

‚â§ 90 ¬∞C y ‚â• 10 ¬∞C

FALSE

FALSE

Modo autom√°tico

< 10¬∞C y ‚â• 0 ¬∞C

FALSE

TRUE

Modo autom√°tico

< 0 ¬∞C

FALSE

TRUE

Inactivo

Par√°metros PID V1
En la ventana de configuraci√≥n "Par√°metros PID" se visualizan los par√°metros PID. Durante la
optimizaci√≥n los par√°metros PID se adaptan al sistema regulado. No es necesario introducir
los par√°metros PID de forma manual.
Nota
Los par√°metros PID efectivos actualmente est√°n en la estructura Retain.CtrlParams.
Para prevenir un comportamiento err√≥neo del regulador PID, los par√°metros PID efectivos
actualmente solo deben modificarse online en el modo de operaci√≥n "Inactivo".
Si desea modificar online los par√°metros PID en los modos de operaci√≥n "Autom√°tico" o
"Manual", modifique los par√°metros PID en la estructura CtrlParamsBackUp y aplique los
cambios en la estructura Retain.CtrlParams, del siguiente modo:
‚óè PID_3Step V1: Aplique los cambios poniendo Config.LoadBackUp = TRUE
‚óè PID_3Step V2: Aplique los cambios poniendo LoadBackUp = TRUE
Los cambios online en los par√°metros PID realizados en el modo de operaci√≥n "Autom√°tico"
pueden provocar saltos en el valor de salida.
El algoritmo PID funciona de acuerdo con la siguiente f√≥rmula:

760

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
1

[

Œî y = K p ¬∑ s ¬∑ (b ¬∑ w - x) +

TI ¬∑ s

(w - x) +

TD ¬∑ s
a ¬∑ TD ¬∑ s + 1

(c ¬∑ w - x)

]

Œîy

Valor de salida del algoritmo PID

Kp

Ganancia proporcional

s

Operador laplaciano

b

Ponderaci√≥n de la acci√≥n P

w

Consigna

x

Valor real

TI

Tiempo de integraci√≥n

a

Coeficiente para el retardo de la acci√≥n derivada (retardo de la acci√≥n derivada T1 = a √ó TD)

TD

Tiempo derivativo

c

Ponderaci√≥n de la acci√≥n D

El gr√°fico siguiente muestra c√≥mo entran los par√°metros en el algoritmo PID.
E

6HWSRLQW Z



'7

F

'

.

3

ÀÇ\



'HDGB%





7L

,

6FDOHG,QSXW [
)DF7W

$QWL:LQGXS

Todos los par√°metros PID son remanentes. Si introduce manualmente los par√°metros PID,
debe cargar PID_3Step por completo.
Cargar objetos tecnol√≥gicos en el dispositivo (P√°gina 667)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_3Step no funciona con una
ganancia proporcional negativa. El sentido de regulaci√≥n se invierte en Ajustes b√°sicos > Tipo
de regulaci√≥n.

Tiempo de integraci√≥n
El tiempo de integraci√≥n determina el comportamiento temporal de la acci√≥n I. La desconexi√≥n
de la acci√≥n I se realiza con el tiempo de integraci√≥n = 0,0. Si el tiempo de integraci√≥n se
modifica online en el modo de operaci√≥n "Autom√°tico" de un valor cualquiera a 0.0, la acci√≥n
I actual se borra y se produce un salto del valor de salida.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

761

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Tiempo derivativo
El tiempo de la acci√≥n derivada determina el comportamiento temporal de la acci√≥n D. La
desconexi√≥n de la acci√≥n D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acci√≥n derivada
El efecto de la acci√≥n D se retrasa mediante el coeficiente de retardo de la acci√≥n derivada.
Retardo de la acci√≥n derivada = Tiempo derivativo x coeficiente de retardo de la acci√≥n
derivada
‚óè 0.0: la acci√≥n D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
‚óè 0.5: Este valor se ha acreditado en la pr√°ctica para sistemas regulados con una constante
de tiempo dominante.
‚óè > 1.0: Cuanto mayor sea el coeficiente, m√°s se retrasar√° el efecto de la acci√≥n D.

Ponderaci√≥n de la acci√≥n P
En el caso de que se modifique la consigna, es posible atenuar la acci√≥n P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n P es totalmente efectiva al cambiar la consigna
‚óè 0.0: La acci√≥n P no es efectiva al cambiar la consigna
Si se produce una modificaci√≥n del valor real, la acci√≥n P es totalmente efectiva.

Ponderaci√≥n de la acci√≥n D
En el caso de que se modifique la consigna, es posible atenuar la acci√≥n D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n D es totalmente efectiva cuando se cambia la consigna.
‚óè 0.0: la acci√≥n D no es efectiva cuando cambia la consigna.
Si se produce una modificaci√≥n del valor real, la acci√≥n D es totalmente efectiva.

Tiempo de muestreo algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo del algoritmo
PID es el tiempo entre dos c√°lculos del valor de salida. Este se determina durante la
optimizaci√≥n y se redondea a un m√∫ltiplo del tiempo de muestreo PID_3Step. Todas las dem√°s
funciones de PID_3Step se ejecutan con cada llamada.

Ancho de zona muerta
La zona muerta suprime los niveles del ruido en el estado estabilizado del regulador. El ancho
de zona muerta indica el tama√±o de la zona muerta. Con un ancho de zona muerta de 0.0, la
zona muerta se encuentra desactivada.

762

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Si para la ponderaci√≥n de la acci√≥n P o de la acci√≥n D se han configurado valores diferentes
de 1.0, los cambios de la consigna tambi√©n tendr√°n efecto sobre el valor de salida en la zona
muerta.
Los cambios del valor real comprendidos dentro de la zona muerta no tienen efecto sobre el
valor de salida, independientemente de la ponderaci√≥n.

Consulte tambi√©n
Elecci√≥n de la estructura del regulador con un sistema regulado definido (P√°gina 660)

Puesta en servicio de PID_3Step V1
Puesta en servicio V1
En la zona de trabajo "Optimizaci√≥n" es posible observar la consigna, el valor real y el valor de
salida en funci√≥n del tiempo. En el registrador de curvas se soportan las siguientes funciones
de puesta en servicio:
‚óè Optimizaci√≥n inicial del regulador
‚óè Optimizaci√≥n fina del regulador
‚óè Observaci√≥n de la regulaci√≥n en curso en la ventana de curvas
Para todas las funciones es preciso realizar una conexi√≥n online a la CPU.

Principios b√°sicos del manejo
‚óè Seleccione el tiempo de actualizaci√≥n que desee en la lista desplegable "Tiempo de
actualizaci√≥n".
Todos los valores del √°rea de trabajo de optimizaci√≥n se actualizan en el tiempo de
actualizaci√≥n seleccionado.
‚óè Haga clic en el bot√≥n "Inicio" en el grupo Medici√≥n si desea utilizar las funciones de puesta
en servicio.
Se inicia el registro de los valores. En el visor de curvas se registran los valores actuales de
consigna, valor real y valor de salida. Se habilita el manejo de la ventana de puesta en
servicio.
‚óè Haga clic en el bot√≥n "Parar" si desea finalizar las funciones de puesta en servicio.
Los valores mostrados en el visor de curvas pueden continuar analiz√°ndose.
‚óè Al cerrar la ventana de puesta en servicio finaliza el registro en el visor de curvas y los
valores registrados se borran.

Optimizaci√≥n inicial V1
La optimizaci√≥n inicial determina el comportamiento del proceso a un impulso del valor de
salida y busca el punto de inflexi√≥n. A partir de la inclinaci√≥n m√°xima y del tiempo muerto del
sistema regulado se calculan los par√°metros PID √≥ptimos.
Cuanto m√°s estable es el valor real, con mayor facilidad y precisi√≥n se pueden calcular los
par√°metros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

763

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
considerablemente mayor que el ruido. Es preciso realizar una copia de seguridad de los
par√°metros PID antes de volver a calcularlos.
La consigna se congela durante la optimizaci√≥n inicial.

Requisitos
‚óè La instrucci√≥n "PID_3Step" se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè PID_3Step se encuentra en el modo de operaci√≥n "Inactivo" o "Manual".
‚óè La consigna y el valor real se encuentran dentro de los l√≠mites configurados (v√©ase la
configuraci√≥n "Configuraci√≥n del valor real").

Procedimiento
Para poder realizar una optimizaci√≥n inicial, proceda del siguiente modo:
1. Haga doble clic en la navegaci√≥n del proyecto en la entrada "PID_3Step > Puesta en
servicio".
2. En la lista desplegable "Modo de optimizaci√≥n" del √°rea de trabajo "Optimizaci√≥n"
seleccione la entrada "Optimizaci√≥n inicial".
3. Haga clic en el s√≠mbolo "Start".
‚Äì Se establece una conexi√≥n online.
‚Äì Se inicia el registro de los valores.
‚Äì Se inicia la optimizaci√≥n inicial.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Haga clic en el s√≠mbolo "Stop" cuando la barra de progreso haya alcanzado el 100% y
se deba presuponer un bloqueo de la optimizaci√≥n. Compruebe la configuraci√≥n del
objeto tecnol√≥gico y, si procede, vuelva a iniciar la optimizaci√≥n.

Resultado
Si la optimizaci√≥n inicial ha finalizado sin ning√∫n mensaje de error, significa que los par√°metros
PID se han optimizado. PID_3Step cambia al modo autom√°tico y utiliza los par√°metros
optimizados. Los par√°metros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es posible realizar la optimizaci√≥n inicial, PID_3Step cambia al modo de operaci√≥n
"Inactivo".

764

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Optimizaci√≥n fina V1
La optimizaci√≥n fina genera una oscilaci√≥n constante y limitada del valor real. Los par√°metros
PID se optimizan para el punto de operaci√≥n a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular todos los par√°metros PID. Los par√°metros PID existentes
despu√©s de la optimizaci√≥n fina muestran en su mayor√≠a un comportamiento de gu√≠a y ante
fallos mucho mejor que los par√°metros PID de la optimizaci√≥n inicial.
PID_3Step intenta generar autom√°ticamente una oscilaci√≥n que es mayor que el ruido del
valor real. La estabilidad del valor real ejerce tan s√≥lo una m√≠nima influencia sobre la
optimizaci√≥n fina. Es preciso realizar una copia de seguridad de los par√°metros PID antes de
volver a calcularlos.
La consigna se congela durante la optimizaci√≥n fina.

Requisitos
‚óè La instrucci√≥n PID_3Step se llama en un OB se alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè El tiempo de posicionamiento del motor est√° configurado o medido.
‚óè La consigna y el valor real se encuentran dentro de los l√≠mites configurados (v√©ase la
configuraci√≥n "Configuraci√≥n del valor real").
‚óè El lazo de regulaci√≥n es estacionario en el punto de operaci√≥n. El punto de operaci√≥n se ha
alcanzado cuando el valor real coincide con la consigna.
‚óè No se esperan perturbaciones.
‚óè PID_3Step se encuentra en el modo de operaci√≥n inactivo, autom√°tico o manual.

El proceso depende de la situaci√≥n de inicio
La optimizaci√≥n fina se desarrolla del modo siguiente en el momento del inicio:
‚óè Modo autom√°tico
Si desea mejorar los par√°metros PID existentes mediatne optimizaci√≥n, inicie la
optimizaci√≥n fina desde el modo autom√°tico.
PID_3Step regula con los par√°metros PID existentes hasta que el lazo de regulaci√≥n es
estacionario y se han cumplido las condiciones para una optimizaci√≥n fina. S√≥lo entonces
comienza la optimizaci√≥n fina.
‚óè Inactivo o manual
Se realiza primero una optimizaci√≥n inicial. Con los par√°metros PID calculados, la
regulaci√≥n se realiza hasta que el lazo de regulaci√≥n es estacionario y se han cumplido las
condiciones para una optimizaci√≥n fina. S√≥lo entonces comienza la optimizaci√≥n fina.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

765

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimizaci√≥n fina, proceda del siguiente modo:
1. En la lista desplegable "Modo de optimizaci√≥n" seleccione la entrada "Optimizaci√≥n fina".
2. Haga clic en el s√≠mbolo "Start".
‚Äì Se establece una conexi√≥n online.
‚Äì Se inicia el registro de los valores.
‚Äì Se inicia el proceso de optimizaci√≥n fina.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los errores
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de optimizaci√≥n" haga clic en el s√≠mbolo "Stop" cuando la barra de
progreso haya alcanzado el 100% y se deba presuponer un bloqueo de la optimizaci√≥n.
Compruebe la configuraci√≥n del objeto tecnol√≥gico y, si procede, vuelva a iniciar la
optimizaci√≥n.

Resultado
Si la optimizaci√≥n fina ha finalizado sin ning√∫n mensaje de error, significa que los par√°metros
PID se han optimizado. PID_3Step cambia al modo autom√°tico y utiliza los par√°metros
optimizados. Los par√°metros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si se produjeran errores durante la optimizaci√≥n fina, PID_3Step cambia al modo de operaci√≥n
"Inactivo".

Realizar la puesta en servicio con par√°metros PID manuales V1
Procedimiento
Para poner en marcha PID_3Step con par√°metros PID manuales, proceda del siguiente modo:
1. Haga doble clic en la navegaci√≥n del proyecto en la entrada "PID_3Step" > Configuraci√≥n".
2. En la ventana de configuraci√≥n haga clic en "Ajustes avanzados > Par√°metros PID".
3. Active la casilla de verificaci√≥n "Activar entrada manual".
4. Introduzca los par√°metros PID.
5. Haga doble clic en la navegaci√≥n del proyecto en la entrada "PID_3Step" > Puesta en
servicio".
6. Establezca una conexi√≥n online con la CPU.
7. Cargue los par√°metros PID en la CPU.
8. Haga clic en el s√≠mbolo "Activar regulador".

766

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Resultado
PID_3Step cambia al modo autom√°tico y realiza la regulaci√≥n con los par√°metros PID actuales.

Medir el tiempo de posicionamiento del motor V1
Introducci√≥n
PID_3Step necesita un tiempo de posicionamiento del motor lo m√°s preciso posible para
alcanzar un buen resultado de regulaci√≥n. Los datos de la documentaci√≥n del elemento final
de control son valores medios para este tipo de elemento final de control. El valor puede variar
para el elemento final de control que se use en cada momento.
Si utiliza actuadores con realimentaci√≥n de posici√≥n o con se√±ales de tope, es posible medir
el tiempo de posicionamiento del motor durante la puesta en servicio. Los l√≠mites del valor de
salida no se tienen en cuenta durante la medici√≥n del tiempo de posicionamiento del motor. El
actuador puede desplazarse hasta el tope superior o inferior.
Si no se dispone de una realimentaci√≥n de posici√≥n ni de se√±ales de tope, no es posible medir
el tiempo de posicionamiento del motor.

Actuadores con realimentaci√≥n de posici√≥n anal√≥gica
Para medir el tiempo de posicionamiento del motor con realimentaci√≥n de posici√≥n, proceda
del siguiente modo:
Requisitos
‚óè En la configuraci√≥n b√°sica se ha seleccionado Feedback o Feedback_PER y la se√±al se
interconecta.
‚óè Se ha establecido una conexi√≥n online con la CPU.
1. Active la casilla de verificaci√≥n "Utilizar realimentaci√≥n de posici√≥n".
2. En el campo de entrada "Posici√≥n de destino" indique hacia d√≥nde desea mover el
elemento final de control.
La realimentaci√≥n de posici√≥n actual (posici√≥n de inicio) se muestra. La diferencia entre
"Posici√≥n de destino" y "Realimentaci√≥n de posici√≥n" debe ser al menos el 50% del rango
admisible para el valor de salida.
3. Haga clic en el bot√≥n

"Iniciar medici√≥n tiempo de posicionamiento".

Resultado
El elemento final de control se desplaza hasta la posici√≥n de destino desde la posici√≥n de
inicio. La medici√≥n del tiempo se inicia de inmediato y finaliza en cuanto el elemento final de
control ha alcanzado la posici√≥n de destino. El tiempo de posicionamiento del motor se calcula
seg√∫n la f√≥rmula:
Tiempo de posicionamiento del motor = (L√≠mite superior del valor de salida - L√≠mite inferior del
valor de salida) x Tiempo de medici√≥n /VALOR ABSOLUTO(Posici√≥n de destino - Posici√≥n de
inicio).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

767

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Se muestran el progreso y el estado de la medici√≥n del tiempo de posicionamiento. El tiempo
de posicionamiento medido se almacena en el bloque de datos de instancia de la CPU y se
muestra en el campo "Tiempo de actuaci√≥n medido" Una vez finalizada la medici√≥n del tiempo
de posicionamiento, PID_3Step cambia al modo de operaci√≥n "Inactivo".
Nota
Para adoptar el tiempo de posicionamiento del motor medido en el proyecto, haga clic en el
icono
"Cargar tiempo pos. medido".

Actuadores con se√±ales de tope
Para medir el tiempo de posicionamiento de los actuadores con se√±ales de tope, proceda del
siguiente modo:
Requisitos
‚óè En la configuraci√≥n b√°sica la casilla de verificaci√≥n "Se√±ales de tope" est√° activada y los
actuadores H y L est√°n interconectados.
‚óè Se ha establecido una conexi√≥n online con la CPU.
Para medir el tiempo de posicionamiento del motor con se√±ales de tope, proceda del siguiente
modo:
1. Active la casilla de verificaci√≥n "Utilizar se√±ales de tope del actuador".
2. Seleccione el sentido en el que desee mover el elemento final de control.
‚Äì Abrir - Cerrar - Abrir
El elemento final de control se mueve primero hasta el tope superior, despu√©s, hasta el
tope inferior y, de nuevo, hasta el tope superior.
‚Äì Cerrar - Abrir - Cerrar
El elemento final de control se mueve primero hasta el tope inferior, despu√©s, hasta el
tope superior y, de nuevo, hasta el tope inferior.
3. Haga clic en el bot√≥n

"Iniciar medici√≥n tiempo de posicionamiento".

Resultado
El elemento final de control se mueve en el sentido seleccionado. La medici√≥n del tiempo se
inicia cuando el elemento final de control ha alcanzado el primer tope y finaliza cuando el
elemento final de control alcanza este tope por segunda vez. El tiempo medido dividido entre
dos da lugar al tiempo de posicionamiento del motor.
Se muestran el progreso y el estado de la medici√≥n del tiempo de posicionamiento. El tiempo
de posicionamiento medido se almacena en el bloque de datos de instancia de la CPU y se
muestra en el campo "Tiempo de actuaci√≥n medido" Una vez finalizada la medici√≥n del tiempo
de posicionamiento, PID_3Step cambia al modo de operaci√≥n "Inactivo".

768

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Cancelar medici√≥n del tiempo de posicionamiento
Una vez finalizada la medici√≥n del tiempo de posicionamiento, PID_3Step cambia de
inmediato al modo de operaci√≥n "Inactivo". El elemento final de control deja de moverse. Es
posible volver a activar PID-3Step en el registrador de curvas.

Simulaci√≥n de PID_3Step V1 con PLCSIM
Nota
Simulaci√≥n con PLCSIM
En la simulaci√≥n con PLCSIM, el comportamiento temporal del PLC simulado no es id√©ntico al
de un PLC "aut√©ntico". El verdadero ciclo de un OB de alarma c√≠clica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "aut√©ntico".
En la configuraci√≥n est√°ndar, PID_3Step determina autom√°ticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_3Step con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
Esto provoca la cancelaci√≥n de las optimizaciones en curso.
La reacci√≥n en el modo autom√°tico depende del valor de la variable ActivateRecoverMode.
Para evitarlo, debe configurarse PID_3Step en la simulaci√≥n con PLCSIM del modo siguiente:
‚óè CycleTime.EnEstimation = FALSE
‚óè CycleTime.EnMonitoring = FALSE
‚óè CycleTime.Value: Asigne a estas variables el ciclo del OB de alarma c√≠clica que se debe
llamar en la unidad segundos.

3.3.3

Utilizar PID_Temp

3.3.3.1

Objeto tecnol√≥gico PID_Temp
El objeto tecnol√≥gico PID_Temp ofrece un regulador PID continuo con optimizaci√≥n integrada.
PID_Temp est√° dise√±ado especialmente para regular la temperatura y es apto para
aplicaciones de calefacci√≥n o calefacci√≥n/refrigeraci√≥n. Para ello se dispone de dos salidas,
una para calefacci√≥n y otra para refrigeraci√≥n. Adem√°s, PID_Temp tambi√©n se puede utilizar
para otras tareas de regulaci√≥n. PID_Temp puede conectarse en cascada y emplearse en
modo manual o en modo autom√°tico.
PID_Temp captura de forma continua el valor real medido dentro de un lazo de regulaci√≥n y lo
compara con la consigna ajustada. A partir de los errores de regulaci√≥n que se producen, la
instrucci√≥n PID_Temp calcula el valor de salida para la calefacci√≥n o la refrigeraci√≥n, a trav√©s

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

769

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
del cual el valor real se iguala a la consigna. En el regulador PID, los valores de salida se
componen de tres acciones:
‚óè Acci√≥n P
La acci√≥n P del valor de salida aumenta proporcionalmente al error de regulaci√≥n.
‚óè Acci√≥n I
La acci√≥n I del valor de salida aumenta hasta que se compensa el error de regulaci√≥n.
‚óè Acci√≥n D
La acci√≥n D aumenta con una velocidad de variaci√≥n creciente del error de regulaci√≥n. El
valor real se iguala lo m√°s r√°pidamente posible con la consigna. Si la velocidad de variaci√≥n
del error de regulaci√≥n vuelve a reducirse, tambi√©n lo hace la acci√≥n D.
La instrucci√≥n PID_Temp calcula los par√°metros P, I y D para el sistema regulado de forma
aut√≥noma durante la "optimizaci√≥n inicial". Los par√°metros pueden optimizarse a√∫n m√°s a
trav√©s de una "optimizaci√≥n fina". No es necesario determinar los par√°metros manualmente.
Para aplicaciones de calefacci√≥n/refrigeraci√≥n puede utilizarse un factor de enfriamiento fijo o
bien dos juegos de par√°metros PID.

Informaci√≥n adicional
‚óè Vista general de los reguladores de software (P√°gina 661)
‚óè Agregar objetos tecnol√≥gicos (P√°gina 664)
‚óè Configurar objetos tecnol√≥gicos (P√°gina 665)
‚óè Configurar PID_Temp (P√°gina 770)

3.3.3.2

Configurar PID_Temp

Ajustes b√°sicos
Introducci√≥n
Configure las propiedades siguientes del objeto tecnol√≥gico PID_Temp en el √°rea de ajustes
b√°sicos de la ventana de inspecci√≥n o de configuraci√≥n.
‚óè Magnitud f√≠sica
‚óè Comportamiento en arranque tras un reset
‚óè Origen e introducci√≥n de la consigna (solo en la ventana de inspecci√≥n)
‚óè Selecci√≥n del valor real
‚óè Origen e introducci√≥n del valor real (solo en la ventana de inspecci√≥n)
‚óè Selecci√≥n del valor de salida para calefacci√≥n
‚óè Origen e introducci√≥n del valor de salida para calefacci√≥n (solo en la ventana de inspecci√≥n)
‚óè Activaci√≥n y selecci√≥n del valor de salida para refrigeraci√≥n
‚óè Origen e introducci√≥n del valor de salida para refrigeraci√≥n (solo en la ventana de
inspecci√≥n)

770

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
‚óè Activar PID_Temp como maestro o esclavo de una cascada
‚óè N√∫mero de esclavos
‚óè Selecci√≥n del maestro (solo en la ventana de inspecci√≥n)

Consigna, valor real, valor de salida para calefacci√≥n y valor de salida para refrigeraci√≥n
Para la consigna, el valor real, el valor de salida para calefacci√≥n y el valor de salida para
refrigeraci√≥n, en la ventana de inspecci√≥n del editor de programaci√≥n puede seleccionar el
origen e introducir valores o variables.
Para cada valor elija el origen:
‚óè DB de instancia:
Se utiliza el valor que se encuentra almacenado en el DB de instancia. El valor debe
actualizarse en el DB de instancia del programa de usuario. En la instrucci√≥n no puede
haber ning√∫n valor. Modificaci√≥n posible desde HMI.
‚óè Instrucci√≥n:
Se utiliza el valor que se interconecta a la instrucci√≥n. Cada vez que se llama la instrucci√≥n,
el valor se escribe en el DB de instancia. No se puede modificar desde HMI.

Tipo de regulaci√≥n
Magnitud f√≠sica
En el grupo "Tipo de regulaci√≥n", seleccione la magnitud f√≠sica y la unidad de la consigna y del
valor real. La consigna y el valor real se mostrar√°n en esta unidad.

Comportamiento en arranque
1. Para cambiar inmediatamente al modo de operaci√≥n "Inactivo" tras el rearranque de la
CPU, desactive la casilla de verificaci√≥n "Activar Mode tras rearrancar la CPU".
Para cambiar inmediatamente, tras el rearranque de la CPU, al modo de operaci√≥n
almacenado en Mode, active la casilla de verificaci√≥n "Activar Mode tras rearrancar la
CPU".
2. En la lista desplegable "Poner Mode a", seleccione el modo de operaci√≥n que debe
activarse tras una carga completa en el dispositivo.
Tras una operaci√≥n de "Cargar en dispositivo" completa, PID_Temp arranca en el modo de
operaci√≥n seleccionado. Con cada rearranque, PID_Temp arranca en el √∫ltimo modo de
operaci√≥n almacenado en Mode.
Al seleccionar la optimizaci√≥n inicial o la optimizaci√≥n fina, es preciso adem√°s setear o
resetear las variables Heat.EnableTuning y Cool.EnableTuning para elegir entre
optimizaci√≥n para calefacci√≥n y optimizaci√≥n para refrigeraci√≥n.
Ejemplo:
Se ha activado la casilla de verificaci√≥n "Activar Mode tras rearrancar la CPU" y en la lista
"Poner Mode a" se ha seleccionado la entrada "Optimizaci√≥n inicial". Tras una operaci√≥n de
"Cargar en dispositivo" completa, PID_Temp arranca en el modo de operaci√≥n "Optimizaci√≥n
inicial". Si la optimizaci√≥n inicial a√∫n est√° activa y se rearranca la CPU, PID_Temp arranca de
nuevo en el modo de operaci√≥n "Optimizaci√≥n inicial" (calefacci√≥n/refrigeraci√≥n dependiendo

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

771

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
de las variables Heat.EnableTuning y Cool.EnableCooling). Si la optimizaci√≥n inicial ha
finalizado correctamente, el modo autom√°tico a√∫n est√° activo y se rearranca la CPU,
PID_Temp arranca en "Modo autom√°tico".

Consigna
Procedimiento
Para especificar una consigna fija, proceda de la siguiente manera:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 ¬∞C.
3. En caso necesario, elimine una entrada de la instrucci√≥n.
Para especificar una consigna variable, proceda de la siguiente manera:
1. Seleccione "Instrucci√≥n".
2. Indique el nombre de la variable REAL en la que est√° almacenada la consigna.
Es posible asignar varios valores de forma controlada por programa a la variable REAL
para, por ejemplo, modificar la consigna de forma controlada por tiempo.

Valor real
Si utiliza directamente el valor de la entrada anal√≥gica, PID_Temp escala el valor de la entrada
anal√≥gica a la magnitud f√≠sica.
Si desea acondicionar primero el valor de la entrada anal√≥gica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada anal√≥gica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada anal√≥gica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucci√≥n" como fuente.
3. Introduzca la direcci√≥n de la entrada anal√≥gica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucci√≥n" como fuente.
3. Indique el nombre de la variable en la que est√° almacenado el valor real acondicionado.

772

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Valor de salida para calefacci√≥n y refrigeraci√≥n
La instrucci√≥n PID_Temp ofrece un regulador PID con optimizaci√≥n integrada para procesos
de temperatura. PID_Temp es apta para aplicaciones de calefacci√≥n o de calefacci√≥n/
refrigeraci√≥n.
PID_Temp ofrece los siguientes valores de salida. El valor de salida que se utilice depender√°
del actuador.
‚óè OutputHeat
Valor de salida para calefacci√≥n (formato de coma flotante): El valor de salida para
calefacci√≥n debe acondicionarse mediante el programa de usuario, por ejemplo, porque el
actuador presenta un comportamiento no lineal.
‚óè OutputHeat_PER
Valor de salida anal√≥gico para calefacci√≥n: El actuador para calefacci√≥n se activa a trav√©s
de una salida anal√≥gica y se controla con una se√±al continua, como puede ser 0 a 10 V, 4
a 20 mA.
‚óè OutputHeat_PWM
Valor de salida modulado por ancho de impulso para calefacci√≥n: El actuador para
calefacci√≥n se controla a trav√©s de una salida digital. Una modulaci√≥n de ancho de
impulsos permite formar tiempos de conexi√≥n y desconexi√≥n variables.
‚óè OutputCool
Valor de salida para refrigeraci√≥n (formato de coma flotante): El valor de salida para
refrigeraci√≥n debe acondicionarse mediante el programa de usuario, por ejemplo, porque
el actuador muestra un comportamiento no lineal.
‚óè OutputCool_PER
Valor de salida anal√≥gico para refrigeraci√≥n: El actuador para refrigeraci√≥n se activa a
trav√©s de una salida anal√≥gica y se controla con una se√±al continua, como puede ser 0 a
10 V, 4 a 20 mA.
‚óè OutputCool_PWM
Valor de salida modulado por ancho de impulso para refrigeraci√≥n: El actuador para
refrigeraci√≥n se controla a trav√©s de una salida digital. Una modulaci√≥n de ancho de
impulsos permite formar tiempos de conexi√≥n y desconexi√≥n variables.
La salida de refrigeraci√≥n solo est√° disponible si se ha activado a trav√©s de la casilla de
verificaci√≥n "Activar refrigeraci√≥n".
‚óè Si la casilla de verificaci√≥n est√° desactivada, el valor de salida del algoritmo PID
(PidOutputSum) se escala y se emite en las salidas para calefacci√≥n.
‚óè Si la casilla de verificaci√≥n est√° activada, los valores de salida positivos del algoritmo PID
(PidOutputSum) se escalan y se emiten en las salidas para calefacci√≥n. Los valores de
salida negativos del algoritmo PID se escalan y se emiten en las salidas para refrigeraci√≥n.
En los ajustes de salida se puede elegir entre dos m√©todos de c√°lculo del valor de salida.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

773

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Nota
Tenga en cuenta lo siguiente:
‚óè Las salidas OutputHeat_PWM, OutputHeat_PER, OutputCool_PWM, OutputCool_PER
√∫nicamente se calculan si se seleccionan en la lista desplegable.
‚óè La salida OutputHeat siempre se calcula.
‚óè La salida OutputCool se calcula si la casilla de verificaci√≥n para la refrigeraci√≥n est√°
activada.
‚óè La casilla de verificaci√≥n "Activar refrigeraci√≥n" √∫nicamente est√° disponible si el regulador
no est√° configurado como maestro en una cascada.

Procedimiento
Para utilizar el valor de salida anal√≥gico, proceda del siguiente modo:
1. En la lista desplegable "OutputHeat" o "OutputCool", seleccione la entrada
"OutputHeat_PER" o "OutputCool_PER".
2. Seleccione "Instrucci√≥n".
3. Introduzca la direcci√≥n de la salida anal√≥gica.
Para utilizar el valor de salida modulado por ancho de impulso, proceda de la siguiente manera:
1. En la lista desplegable "OutputHeat" o "OutputCool", seleccione la entrada
"OutputHeat_PWM" o "OutputCool_PWM".
2. Seleccione "Instrucci√≥n".
3. Introduzca la direcci√≥n de la salida digital.
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "OutputHeat" o "OutpuCool", seleccione la entrada "OutputHeat" o
"OutputCool".
2. Seleccione "Instrucci√≥n".
3. Indique el nombre de la variable que utilizar√° para acondicionar el valor de salida.
4. Transfiera el valor de salida acondicionado hasta el actuador a trav√©s de una salida
anal√≥gica o digital de la CPU.

Cascada
Si una instancia PID_Temp recibe su consigna de un regulador maestro superior y transmite
su propio valor de salida a un regulador esclavo inferior, esa instancia PID_Temp es regulador
maestro y regulador esclavo al mismo tiempo. Para esa instancia PID_Temp deben realizarse
entonces las dos configuraciones descritas a continuaci√≥n. Esto es lo que ocurre, por ejemplo,
con la instancia PID_Temp central de una regulaci√≥n en cascada con tres magnitudes
concatenadas y tres instancias PID_Temp.

774

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Configurar un regulador como maestro en una cascada
La salida de un regulador maestro es la consigna de un regulador esclavo.
Para utilizar PID_Temp como maestro en una cascada, debe desactivarse la refrigeraci√≥n en
los ajustes b√°sicos. Para configurar esa instancia PID_Temp como regulador maestro en una
cascada, active la casilla de verificaci√≥n "El regulador es maestro". La selecci√≥n del valor de
salida para calefacci√≥n se ajusta autom√°ticamente a OutputHeat.
OutputHeat_PWM y OutputHeat_PER no pueden utilizarse para un maestro en una cascada.
A continuaci√≥n, indique el n√∫mero de reguladores esclavos directamente subordinados y que
reciben su consigna de ese regulador maestro.
Si al asignar el par√°metro OutputHeat del maestro al par√°metro Setpoint del esclavo no se
utiliza una funci√≥n de escalado propia, puede que sea necesario adaptar los l√≠mites y la escala
del valor de salida del maestro al rango de consignas/valores reales del esclavo. Esto puede
realizarse en los ajustes de salida del maestro, en el √°rea "OutputHeat / OutputCool".

Configurar un regulador como esclavo en una cascada
Un regulador esclavo recibe su consigna (par√°metro Setpoint) de la salida de su regulador
maestro (par√°metro OutputHeat).
Para configurar esa instancia PID_Temp como regulador esclavo en una cascada, active la
casilla de verificaci√≥n "El regulador es esclavo" en los ajustes b√°sicos.
A continuaci√≥n, en la ventana de inspecci√≥n del editor de programaci√≥n, seleccione la
instancia PID_Temp que habr√° de utilizarse como regulador maestro para ese regulador
esclavo. Al realizar esta selecci√≥n, los par√°metros Master y Setpoint del regulador esclavo se
interconectan con el regulador maestro elegido (las interconexiones anteriores de estos
par√°metros se sobrescriben). Esta interconexi√≥n permite el intercambio de informaci√≥n y la
especificaci√≥n de consigna entre maestro y esclavo. Si es necesario, la interconexi√≥n del
par√°metro Setpoint del regulador esclavo puede modificarse posteriormente, p. ej., para a√±adir
un filtro adicional. La interconexi√≥n del par√°metro Maestro no puede modificarse
posteriormente.
En el regulador maestro seleccionado, la casilla de verificaci√≥n "El regulador es maestro" debe
estar activada, y el n√∫mero de esclavos debe estar correctamente configurado. El regulador
maestro debe llamarse antes que el regulador esclavo en el mismo OB de alarma c√≠clica.

Informaci√≥n adicional
Para m√°s informaci√≥n sobre creaci√≥n de programas, configuraci√≥n y puesta en marcha en
relaci√≥n con el uso de PID_Temp en regulaciones en cascada, ver Regulaci√≥n en cascada con
PID_Temp (P√°gina 803).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

775

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Ajustes del valor real
L√≠mites del valor real
Como valores l√≠mite para el sistema regulado, defina los l√≠mites superior e inferior absolutos del
valor real de modo que sean razonables. Tan pronto como dichos valores se rebasen por
exceso o defecto, se producir√° un error (ErrorBits = 0001h). La optimizaci√≥n se cancela cuando
se rebasan los l√≠mites del valor real. La manera como debe reaccionar PID_Temp en caso de
fallo en el modo autom√°tico se define en los ajustes de salida.

Escalar valor real
Si en los ajustes b√°sicos ha configurado el uso de Input_PER, deber√° convertir el valor de la
entrada anal√≥gica a la magnitud f√≠sica del valor real. En el cuadro de visualizaci√≥n Input_PER
se muestra la configuraci√≥n actual.
Si el valor real es directamente proporcional al valor de la entrada anal√≥gica, Input_PER se
escalar√° a partir de un par de valores inferior y superior.

Procedimiento
Para escalar el valor real, haga lo siguiente:
1. En los campos de entrada "Valor real inferior escalado" y "abajo", introduzca el par de
valores inferior.
2. En los campos de entrada "Valor real superior escalado" y "arriba", introduzca el par de
valores superior.
La configuraci√≥n hardware contiene pares de valores predeterminados. Para utilizar los pares
de valores contenidos en la configuraci√≥n hardware, haga lo siguiente:
1. Marque la instrucci√≥n PID_Temp en el editor de programaci√≥n.
2. En los ajustes b√°sicos, interconecte Input_PER con una entrada anal√≥gica.
3. En los ajustes del valor real, haga clic en el bot√≥n "Ajuste autom√°tico".
Los valores existentes se sobrescribir√°n con los valores de la configuraci√≥n hardware.

776

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Ajustes de salida
Ajustes b√°sicos salida
M√©todo para calefacci√≥n y refrigeraci√≥n
Si la refrigeraci√≥n est√° activada en los ajustes b√°sicos, para el c√°lculo del valor de salida PID
hay dos m√©todos disponibles:
‚óè Conmutaci√≥n de par√°metros PID (Config.AdvancedCooling = TRUE):
El c√°lculo del valor de salida para la refrigeraci√≥n se lleva a cabo mediante un juego de
par√°metros PID propio. El algoritmo PID, a partir del valor de salida calculado y el error de
regulaci√≥n, decide si los par√°metros PID se utilizar√°n para calefacci√≥n o para refrigeraci√≥n.
Este m√©todo es adecuado si el actuador de calefacci√≥n y el actuador de refrigeraci√≥n
presentan un comportamiento temporal diferente y ganancias diferentes.
La optimizaci√≥n inicial y la optimizaci√≥n fina para refrigeraci√≥n √∫nicamente est√°n
disponibles si se elige este m√©todo.
‚óè Factor de enfriamiento (Config.AdvancedCooling = FALSE):
El valor de salida para la refrigeraci√≥n se calcula con los par√°metros PID para calefacci√≥n
teniendo en cuenta el factor de enfriamiento configurable Config.CoolFactor. Este m√©todo
es adecuado si el actuador de calefacci√≥n y el actuador de refrigeraci√≥n presentan un
comportamiento temporal similar pero ganancias diferentes. Si se elige este m√©todo, la
optimizaci√≥n inicial y la optimizaci√≥n fina para refrigeraci√≥n, as√≠ como el juego de
par√°metros PID para refrigeraci√≥n, no est√°n disponibles. Tan solo pueden realizarse
optimizaciones para calefacci√≥n.

Factor de enfriamiento
Si como m√©todo para calefacci√≥n/refrigeraci√≥n se ha elegido el factor de enfriamiento, este se
tiene en cuenta como factor a la hora de calcular el valor de salida para refrigeraci√≥n. De esta
forma es posible tener en cuenta ganancias diferentes del actuador de calefacci√≥n y el
actuador de refrigeraci√≥n.
El factor de enfriamiento no se ajusta autom√°ticamente ni se adapta durante la optimizaci√≥n.
Debe configurar el factor de enfriamiento correctamente de forma manual con la relaci√≥n
"ganancia actuador de calefacci√≥n / ganancia actuador de refrigeraci√≥n".
Ejemplo: un factor de enfriamiento = 2.0 significa que la ganancia del actuador de calefacci√≥n
es el doble que la ganancia del actuador de refrigeraci√≥n.
El factor de enfriamiento √∫nicamente act√∫a y puede modificarse si como m√©todo para
calefacci√≥n / refrigeraci√≥n se ha elegido "Factor de enfriamiento".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

777

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Comportamiento en caso de error
ATENCI√ìN
Su instalaci√≥n puede sufrir da√±os.
Si en caso de fallo se emite "Valor actual mientras dure el error" o "Valor de salida sustitutivo
mientras dure el error", PID_Temp se mantiene en modo autom√°tico o en modo manual. De
este modo, los l√≠mites del valor real pueden rebasarse y su instalaci√≥n puede sufrir da√±os.
Configure un comportamiento en caso de fallo para su sistema regulado que proteja la
instalaci√≥n de da√±os.
PID_Temp est√° preajustado de manera que, en caso de fallo, la regulaci√≥n permanece activa
en la mayor√≠a de los casos.
Si en el modo de regulaci√≥n se producen errores con frecuencia, este ajuste empeorar√° el
comportamiento de regulaci√≥n. Compruebe en tal caso el par√°metro ErrorBits y elimine la
causa de error.

778

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
En caso de fallo, PID_Temp emite un valor de salida configurable:
‚óè Cero (inactivo)
Cuando se produce cualquier error, PID_Temp cambia al modo de operaci√≥n "Inactivo" y
emite lo siguiente:
‚Äì 0.0 como valor de salida PID (PidOutputSum)
‚Äì 0.0 como valor de salida para calefacci√≥n (OutputHeat) y valor de salida para
refrigeraci√≥n (OutputCool)
‚Äì 0 como valor de salida anal√≥gico para calefacci√≥n (OutputHeat_PER) y valor de salida
anal√≥gico para refrigeraci√≥n (OutputCool_PER)
‚Äì FALSE como valor de salida modulado por ancho de impulso para calefacci√≥n
(OutputHeat_PWM) y valor de salida modulado por ancho de impulso para refrigeraci√≥n
(OutputCool_PWM)
Esto es independiente de los l√≠mites y la escala del valor de salida que se hayan
configurado. El regulador no se reactiva hasta que no se detecta un flanco descendente en
Reset o un flanco ascendente en ModeActivate.
‚óè Valor actual mientras dure el error
La reacci√≥n a fallo depende del error ocurrido y del modo de operaci√≥n.
Si en el modo autom√°tico se producen uno o varios de los errores siguientes, PID_Temp
permanece en modo autom√°tico:
‚Äì 0000001h: El par√°metro Input se encuentra fuera de los l√≠mites del valor real.
‚Äì 0000800h: Error en tiempo de muestreo
‚Äì 0040000h: Valor no v√°lido en el par√°metro Disturbance.
‚Äì 8000000h: Error durante el c√°lculo de los par√°metros PID.
Si en el modo autom√°tico se producen uno o varios de los errores siguientes, PID_Temp
pasa al modo "Valor de salida sustitutivo con monitorizaci√≥n de errores" y emite el √∫ltimo
valor de salida PID v√°lido (PidOutputSum):
‚Äì 0000002h: Valor no v√°lido en el par√°metro Input_PER.
‚Äì 0000200h: Valor no v√°lido en el par√°metro Input.
‚Äì 0000400h: Error al calcular el valor de salida.
‚Äì 0001000h: Valor no v√°lido en el par√°metro Setpoint o SubstituteSetpoint.
Los valores resultantes del valor de salida PID en las salidas para calefacci√≥n y
refrigeraci√≥n se obtienen del escalado de salida configurado.
En cuanto los errores dejan de estar activos, PID_Temp pasa de nuevo al modo autom√°tico.
Si se produce un error en el modo manual, PID_Temp permanece en el modo manual y
contin√∫a utilizando el valor manual como valor de salida PID.
Si el valor manual no es v√°lido, se utiliza el valor de salida sustitutivo configurado.
Si el valor manual y el valor de salida sustitutivo no son v√°lidos, se utiliza el l√≠mite inferior del
valor de salida PID para calefacci√≥n (Config.Output.Heat.PidLowerLimit).
Si durante una optimizaci√≥n inicial u optimizaci√≥n fina aparece el siguiente error, PID_Temp
se mantiene en el modo de operaci√≥n activo:
‚Äì 0000020h: La optimizaci√≥n inicial no est√° permitida durante la optimizaci√≥n fina.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

779

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Con todos los dem√°s errores, PID_Temp interrumpe la optimizaci√≥n y cambia al modo
desde el que se inici√≥ la optimizaci√≥n.
‚óè Valor de salida sustitutivo mientras dure el error
PID_Temp se comporta del modo descrito en "Valor actual mientras dure el error", pero en
el modo de operaci√≥n "Valor de salida sustitutivo con monitorizaci√≥n de errores" emite el
valor de salida sustitutivo configurado (SubstituteOutput) como valor de salida PID
(PidOutputSum).
Los valores resultantes del valor de salida PID en las salidas para calefacci√≥n y
refrigeraci√≥n se obtienen del escalado de salida configurado.
Para reguladores con salida de refrigeraci√≥n activada (Config.ActivateCooling = TRUE),
‚Äì introduzca un valor de salida sustitutivo positivo para emitir el valor en las salidas para
calefacci√≥n.
‚Äì introduzca un valor de salida sustitutivo negativo para emitir el valor en las salidas para
refrigeraci√≥n.
Si se produce el siguiente error, PID_Temp se mantiene en el modo "Valor de salida
sustitutivo con monitorizaci√≥n de errores" y emite el l√≠mite inferior del valor de salida PID
para calefacci√≥n (Config.Output.Heat.PidLowerLimit):
‚Äì 0020000h: Valor no v√°lido en la variable SubstituteOutput.

L√≠mites y escalado del valor de salida
El valor de salida PID (PidOutputSum) se calcula autom√°ticamente con el algoritmo PID en
funci√≥n del modo de operaci√≥n o bien est√° predeterminado por el valor manual (ManualValue)
o por el valor de salida sustitutivo configurado (SubstituteOutput).
El valor de salida PID se limita dependiendo de la configuraci√≥n:
‚óè Si la refrigeraci√≥n est√° desactivada en los ajustes b√°sicos (Config.ActivateCooling =
FALSE), el valor se limita al l√≠mite superior del valor de salida PID (calefacci√≥n)
(Config.Output.Heat.PidUpperLimit) y al l√≠mite inferior del valor de salida PID (calefacci√≥n)
(Config.Output.Heat.PidLowerLimit).
Ambos valores l√≠mite pueden configurarse en el apartado "OutputHeat / OutputCool" en el
eje horizontal de la caracter√≠stica de escala. En los apartados "OutputHeat_PWM /
OutputCool_PWM" y "OutputHeat_PER / OutputCool_PER" se muestran dichos valores
l√≠mite, pero no es posible modificarlos.
‚óè Si la refrigeraci√≥n est√° activada en los ajustes b√°sicos (Config.ActivateCooling = TRUE), el
valor se limita al l√≠mite superior del valor de salida PID (Config.Output.Heat.PidUpperLimit)
y al l√≠mite inferior del valor de salida PID (refrigeraci√≥n) (Config.Output.Cool.PidLowerLimit).
Ambos valores l√≠mite pueden configurarse en el apartado "OutputHeat / OutputCool" en el
eje horizontal de la caracter√≠stica de escala. En los apartados "OutputHeat_PWM /
OutputCool_PWM" y "OutputHeat_PER / OutputCool_PER" se muestran dichos valores
l√≠mite, pero no es posible modificarlos.
El l√≠mite inferior del valor de salida PID (calefacci√≥n) (Config.Output.Heat.PidLowerLimit) y
el l√≠mite superior del valor de salida PID (refrigeraci√≥n) (Config.Output.Cool.PidUpperLimit)
no pueden modificarse y deben estar configurados con el valor 0.0.

780

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
El valor de salida PID se escala y se emite en las salidas para calefacci√≥n y refrigeraci√≥n. El
escalado puede especificarse por separado para cada salida y se define mediante 2 pares de
valores en cada caso: un valor l√≠mite del valor de salida PID y un valor de escalado.
Salida

Par de valores

Par√°metro

OutputHeat

Par de valores
1

L√≠mite superior del valor de salida PID (calefacci√≥n)
Config.Output.Heat.PidUpperLimit,
Valor de salida superior escalado (calefacci√≥n) Config.Out‚Äê
put.Heat.UpperScaling

Par de valores
2

L√≠mite inferior del valor de salida PID (calefacci√≥n)
Config.Output.Heat.PidLowerLimit,
Valor de salida inferior escalado (calefacci√≥n) Config.Out‚Äê
put.Heat.LowerScaling

OutputHeat_PWM

Par de valores
1

L√≠mite superior del valor de salida PID (calefacci√≥n)
Config.Output.Heat.PidUpperLimit,
Valor de salida PWM superior escalado (calefacci√≥n)
Config.Output.Heat.PwmUpperScaling

Par de valores
2

L√≠mite inferior del valor de salida PID (calefacci√≥n)
Config.Output.Heat.PidLowerLimit,
Valor de salida PWM inferior escalado (calefacci√≥n)
Config.Output.Heat.PwmLowerScaling

OutputHeat_PER

Par de valores
1

L√≠mite superior del valor de salida PID (calefacci√≥n)
Config.Output.Heat.PidUpperLimit,
Valor de salida anal√≥gico superior escalado (calefacci√≥n)
Config.Output.Heat.PerUpperScaling

Par de valores
2

L√≠mite inferior del valor de salida PID (calefacci√≥n)
Config.Output.Heat.PidLowerLimit,
Valor de salida anal√≥gico inferior escalado (calefacci√≥n)
Config.Output.Heat.PerLowerScaling

OutputCool

Par de valores
1

L√≠mite inferior del valor de salida PID (refrigeraci√≥n)
Config.Output.Cool.PidLowerLimit,
Valor de salida superior escalado (refrigeraci√≥n)
Config.Output.Cool.UpperScaling

Par de valores
2

L√≠mite superior del valor de salida PID (refrigeraci√≥n)
Config.Output.Cool.PidUpperLimit,
Valor de salida inferior escalado (refrigeraci√≥n)
Config.Output.Cool.LowerScaling

OutputCool_PWM

Par de valores
1

L√≠mite inferior del valor de salida PID (refrigeraci√≥n)
Config.Output.Cool.PidLowerLimit,
Valor de salida PWM superior escalado (refrigeraci√≥n)
Config.Output.Cool.PwmUpperScaling

Par de valores
2

L√≠mite superior del valor de salida PID (refrigeraci√≥n)
Config.Output.Cool.PidUpperLimit,
Valor de salida PWM inferior escalado (refrigeraci√≥n)
Config.Output.Cool.PwmLowerScaling

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

781

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Salida

Par de valores

Par√°metro

OutputCool_PER

Par de valores
1

L√≠mite inferior del valor de salida PID (refrigeraci√≥n)
Config.Output.Cool.PidLowerLimit,
Valor de salida anal√≥gico superior escalado (refrigeraci√≥n)
Config.Output.Cool.PerUpperScaling

Par de valores
2

L√≠mite superior del valor de salida PID (refrigeraci√≥n)
Config.Output.Cool.PidUpperLimit,
Valor de salida anal√≥gico inferior escalado (refrigeraci√≥n)
Config.Output.Cool.PerLowerScaling

El l√≠mite inferior del valor de salida PID (calefacci√≥n) (Config.Output.Heat.PidLowerLimit) debe tener el
valor 0.0 si la refrigeraci√≥n est√° activada (Config.ActivateCooling = TRUE).
El l√≠mite superior del valor de salida PID (refrigeraci√≥n) (Config.Output.Cool.PidUpperLimit) debe tener
siempre el valor 0.0.

Ejemplo:
Escalado de salida si se utiliza la salida OutputHeat (refrigeraci√≥n desactivada; el l√≠mite inferior
del valor de salida PID (calefacci√≥n) (Config.Output.Heat.PidLowerLimit) puede ser distinto de
0.0):
2XWSXW+HDW
&RQILJ2XWSXW+HDW
8SSHU6FDOLQJ
&RQILJ2XWSXW+HDW
/RZHU6FDOLQJ

&RQILJ2XWSXW+HDW
3LG/RZHU/LPLW

3LG2XWSXW6XP
&RQILJ2XWSXW+HDW
3LG8SSHU/LPLW

Ejemplo:
Escalado de salida si se utiliza la salida OutputHeat_PWM y OutputCool_PER (refrigeraci√≥n
activada; el l√≠mite inferior del valor de salida PID (calefacci√≥n)
(Config.Output.Heat.PidLowerLimit) debe ser 0.0):
OutputCool_PER OutputHeat_PWM
Config.Output.Cool.
PerUpperScaling

Config.Output.Heat.
PwmUpperScaling
Config.Output.Heat.
PwmLowerScaling

Config.Output.Cool.
PerLowerScaling

PidOutputSum

Config.Output.Heat.
Config.Output.Cool.
Config.Output.Heat.
PidLowerLimit
PidLowerLimit
PidUpperLimit
=Config.Output.Cool.
PidUpperLimit=0.0

Con la excepci√≥n del modo de operaci√≥n "Inactivo", el valor en una salida est√° siempre
comprendido entre su valor de salida superior escalado y el valor de salida inferior escalado;

782

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
p. ej., para OutputHeat est√° siempre entre el valor de salida superior escalado (calefacci√≥n)
(Config.Output.Heat.UpperScaling) y el valor de salida inferior escalado (calefacci√≥n)
(Config.Output.Heat.LowerScaling).
Por lo tanto, si se quiere limitar el valor en la salida correspondiente, tambi√©n deben limitarse
estos valores de escalado.
Los valores de escalado de una salida pueden configurarse en el eje vertical de la
caracter√≠stica de escala. Cada salida dispone de dos valores de escalado propios. Para
OutputHeat_PWM, OutputCool_PWM, OutputHeat_PER y OutputCool_PER, dichos valores
√∫nicamente pueden modificarse si la salida correspondiente est√° seleccionada en los ajustes
b√°sicos. Para todas las salidas para refrigeraci√≥n es necesario, adem√°s, que la refrigeraci√≥n
est√© activada en los ajustes b√°sicos.
El visor de curvas que hay en el cuadro de di√°logo de puesta en marcha tan solo registra los
valores de OutputHeat y OutputCool, con independencia de la salida seleccionada en los
ajustes b√°sicos. Por lo tanto, los valores de escalado para OutputHeat o OutputCool tambi√©n
deben adaptarse si se est√° utilizando OutputHeat_PWM o OutputHeat_PER, o bien
OutputCool_PWM o OutputCool_PER, y se quiere emplear el visor de curvas del cuadro de
di√°logo de puesta en marcha.

Ajustes avanzados
Monitorizaci√≥n de valor real
Configure un l√≠mite de advertencia inferior y uno superior para el valor real en la ventana de
configuraci√≥n "Monitorizaci√≥n del valor real". Si durante el funcionamiento se rebasa uno de los
l√≠mites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucci√≥n
PID_Temp:
‚óè En el par√°metro de salida "InputWarning_H", si se ha rebasado por exceso el l√≠mite superior
de advertencia
‚óè En el par√°metro de salida "InputWarning_L", si se ha rebasado por defecto el l√≠mite inferior
de advertencia
Los l√≠mites de advertencia deben encontrarse dentro de los l√≠mites superior e inferior del valor
real.
Si no introduce ning√∫n valor, se utilizan los l√≠mites superior e inferior del valor real.

Ejemplo
L√≠mite superior del valor real = 98 ¬∞C; l√≠mite superior de advertencia = 90 ¬∞C
L√≠mite inferior de advertencia = 10 ¬∞C; l√≠mite inferior del valor real = 0 ¬∞C
PID_Temp se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

ErrorBits

> 98 ¬∞C

TRUE

FALSE

0001h

‚â§ 98 ¬∞C y > 90 ¬∞C

TRUE

FALSE

0000h

‚â§ 90 ¬∞C y ‚â• 10 ¬∞C

FALSE

FALSE

0000h

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

783

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Valor real

InputWarning_H

InputWarning_L

ErrorBits

< 10 ¬∞C y ‚â• 0 ¬∞C

FALSE

TRUE

0000h

< 0 ¬∞C

FALSE

TRUE

0001h

La manera en que debe reaccionar PID_Temp si se rebasan el l√≠mite superior o inferior del
valor real se configura en los ajustes de salida.

Limitaciones PWM
El valor de salida PID PidOutputSum se escala y, mediante una modulaci√≥n de ancho de
impulsos, se transforma en una secuencia de impulsos que se emite en el par√°metro de salida
OutputHeat_PWM o OutputCool_PWM.
El "Tiempo muestreo algoritmo PID" es el tiempo que transcurre entre dos c√°lculos del valor de
salida PID. El tiempo de muestreo se utiliza como duraci√≥n de per√≠odo de la modulaci√≥n por
ancho de impulso.
Durante la calefacci√≥n, el valor de salida PID se calcula siempre en el "Tiempo muestreo
algoritmo PID para calefacci√≥n".
El c√°lculo del valor de salida PID durante la refrigeraci√≥n depende del tipo de refrigeraci√≥n
seleccionado en "Ajustes b√°sicos Salida":
‚óè Si se utiliza el factor de enfriamiento, se aplica el "Tiempo muestreo algoritmo PID para
calefacci√≥n".
‚óè Si se utiliza la conmutaci√≥n de par√°metros PID, se aplica el "Tiempo muestreo algoritmo
PID para refrigeraci√≥n".
El tiempo de muestreo del algoritmo PID para calefacci√≥n o refrigeraci√≥n se determina durante
la optimizaci√≥n inicial o la optimizaci√≥n fina. Si los par√°metros PID se ajustan manualmente,
debe configurarse tambi√©n ah√≠ el tiempo de muestreo del algoritmo PID para calefacci√≥n o
refrigeraci√≥n.
OutputHeat_PWM y OutputCool_PWM se emiten en el tiempo de muestreo PID_Temp. El
tiempo de muestreo PID_Temp equivale al tiempo de ciclo del OB que efect√∫a la llamada.
La duraci√≥n del impulso es proporcional al valor de salida PID y es siempre un m√∫ltiplo entero
del tiempo de muestreo PID_Temp.
Ejemplo de OutputHeat_PWM

784

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
3LG2XWSXW6XP





W PV

2XWSXW+HDWB3:0
758(
)$/6(

W PV





‚ë†
‚ë°
‚ë¢
‚ë£



Tiempo de muestreo PID_Temp
Tiempo de muestreo del algoritmo PID para calefacci√≥n
Duraci√≥n del impulso
Duraci√≥n de la pausa

"Tiempo conexi√≥n m√≠n." y "Tiempo desconex. m√≠n." pueden utilizarse por separado para
calefacci√≥n y refrigeraci√≥n, redondeados a un m√∫ltiplo entero del tiempo de muestreo
PID_Temp.
Un impulso o una pausa nunca son m√°s cortas que los tiempos de conexi√≥n o desconexi√≥n
m√≠nimos. Las imprecisiones que se producen se suman y se compensan en el siguiente ciclo.
Ejemplo de OutputHeat_PWM
Tiempo de muestreo PID_Temp (equivale al tiempo de ciclo del OB que efect√∫a la llamada) =
100 ms
Tiempo de muestreo Algoritmo PID (equivale a la duraci√≥n del periodo) = 1000 ms
Tiempo conexi√≥n m√≠n. = 200 ms
El valor de salida PID PidOutputSum es del 15% en todo momento. El impulso m√≠nimo que
PID_Temp puede emitir es del 20% En el primer ciclo no se emite ning√∫n impulso. En el
segundo ciclo, el impulso no emitido del primer ciclo se agrega al impulso del segundo ciclo.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

785

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
3LG2XWSXW6XP





2XWSXW+HDWB3:0

W PV

758(
)$/6(

W PV





‚ë†
‚ë°
‚ë§

Tiempo de muestreo PID_Temp
Tiempo de muestreo del algoritmo PID para calefacci√≥n
Tiempo conexi√≥n m√≠n.

Para reducir la frecuencia de conmutaci√≥n y proteger el actuador, prolongue los tiempos de
conexi√≥n y desconexi√≥n m√≠nimos.
Si en los ajustes b√°sicos se ha seleccionado como salida OutputHeat o OutputCool, o bien
OutputHeat_PER o OutputCool_PER, el tiempo de conexi√≥n m√≠nimo y el tiempo de
desconexi√≥n m√≠nimo no se eval√∫an y no pueden modificarse.
Si en caso de utilizar OutputHeat_PWM o OutputCool_PWM el "Tiempo de muestreo Algoritmo
PID" (Retain.CtrlParams.Heat.Cycle o Retain.CtrlParams.Cool.Cycle) y, con ello, la duraci√≥n
del periodo de la modulaci√≥n de ancho de impulsos es muy larga, puede especificarse una
duraci√≥n del per√≠odo m√°s corta en los par√°metros Config.Output.Heat.PwmPeriode o
Config.Output.Cool.PwmPeriode (v. tambi√©n Variable PwmPeriode) para as√≠ mejorar el filtrado
del valor real.
Nota
Los tiempos m√≠nimos de conexi√≥n y desconexi√≥n act√∫an solo en los par√°metros de salida
OutputHeat_PWM o OutputCool_PWM y no se utilizan para posibles generadores de impulsos
integrados en la CPU.

Par√°metros PID
En la ventana de configuraci√≥n "Par√°metros PID" se visualizan los par√°metros PID.
Si en los ajustes b√°sicos est√° activada la refrigeraci√≥n y en los ajustes de salida se ha
seleccionado la conmutaci√≥n de par√°metros PID como m√©todo para calefacci√≥n/refrigeraci√≥n,
est√°n disponibles dos juegos de par√°metros: uno para calefacci√≥n y otro para refrigeraci√≥n.

786

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
En tal caso, el algoritmo PID, a partir del valor de salida calculado y el error de regulaci√≥n,
decide si los par√°metros PID se utilizar√°n para calefacci√≥n o para refrigeraci√≥n.
Si la refrigeraci√≥n est√° desactivada o se ha seleccionado el factor de enfriamiento como
m√©todo para calefacci√≥n/refrigeraci√≥n, siempre se utiliza el juego de par√°metros para
calefacci√≥n.
Durante la optimizaci√≥n, los par√°metros PID se adaptan al sistema regulado, con excepci√≥n
del ancho de zona muerta, que debe configurarse manualmente.
Nota
Los par√°metros PID efectivos actualmente est√°n en la estructura Retain.CtrlParams.
Para prevenir un comportamiento err√≥neo del regulador PID, los par√°metros PID efectivos
actualmente solo deben modificarse online en el modo de operaci√≥n "Inactivo".
Si desea modificar online los par√°metros PID en los modos de operaci√≥n "Autom√°tico" o
"Manual", modifique los par√°metros PID en la estructura CtrlParamsBackUp y aplique los
cambios poniendo LoadBackUp = TRUE en la estructura Retain.CtrlParams.
Los cambios online en los par√°metros PID realizados en el modo de operaci√≥n "Autom√°tico"
pueden provocar saltos en el valor de salida.
PID_Temp es un regulador PIDT1 con Anti-Windup y ponderaci√≥n de las acciones P y D.
El algoritmo PID funciona de acuerdo con la siguiente f√≥rmula (zona de regulaci√≥n y zona
muerta desactivadas):

1

y = Kp

[ (b ¬∑ w - x) + T ¬∑ s

(w - x) +

I

TD ¬∑ s
a ¬∑ TD ¬∑ s + 1

(c ¬∑ w - x)

]

S√≠mbolo

Descripci√≥n

Par√°metro correspondiente de la instrucci√≥n
PID_Temp

y

Valor de salida del algoritmo PID

-

Kp

Ganancia proporcional

Retain.CtrlParams.Heat.Gain
Retain.CtrlParams.Cool.Gain
CoolFactor

s

Operador laplaciano

-

b

Ponderaci√≥n de la acci√≥n P

Retain.CtrlParams.Heat.PWeighting

w

Consigna

CurrentSetpoint

x

Valor real

ScaledInput

TI

Tiempo de integraci√≥n

Retain.CtrlParams.Heat.Ti

Retain.CtrlParams.Cool.PWeighting

Retain.CtrlParams.Cool.Ti
TD

Tiempo derivativo

Retain.CtrlParams.Heat.Td
Retain.CtrlParams.Cool.Td

a
c

Coeficiente para el retardo de acci√≥n derivativa

Retain.CtrlParams.Heat.TdFiltRatio

(retardo de la acci√≥n derivada T1 = a x TD)

Retain.CtrlParams.Cool.TdFiltRatio

Ponderaci√≥n de la acci√≥n D

Retain.CtrlParams.Heat.DWeighting
Retain.CtrlParams.Cool.DWeighting

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

787

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
S√≠mbolo

Descripci√≥n

Par√°metro correspondiente de la instrucci√≥n
PID_Temp

DeadZone

Ancho de zona muerta

Retain.CtrlParams.Heat.DeadZone

ControlZone

Ancho de zona de regulaci√≥n

Retain.CtrlParams.Cool.DeadZone
Retain.CtrlParams.Heat.ControlZone
Retain.CtrlParams.Cool.ControlZone

El gr√°fico siguiente muestra c√≥mo entran los par√°metros en el algoritmo PID.
E

&XUUHQW6HWSRLQW Z

&RQILJ2XWSXW+HDW
3LG8SSHU/LPLW


F

'7

.S

\




&RQILJ2XWSXW+HDW
3LG/RZHU/LPLW
&RQILJ2XWSXW&RRO
3LG/RZHU/LPLW

'HDG=RQH







$QWL:LQGXS

6FDOHG,QSXW [

/LPLW

,

&RQWURO=RQH




Todos los par√°metros PID son remanentes. Si introduce manualmente los par√°metros PID,
debe cargar PID_Temp por completo (Cargar objetos tecnol√≥gicos en el dispositivo
(P√°gina 667)).

788

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Diagrama de bloques PID_Temp
El siguiente diagrama de bloques muestra c√≥mo est√° integrado el algoritmo PID en PID_Temp.
InputPEROn

Scale

PV_ALRM

InputWarning_H

Input_PER
1

InputWarning_L

0

Input

z -1

sgn

CtrlParams
Heat.Gain
Heat Ti ‚Ä¶
Cool.Gain
Cool.Ti ...
SubstituteSetpointOn
Setpoint
SubstituteSetpoint

0

ScaledInput
Limit
CurrentSetpoint

PIDT1
Anti Windup

1

Disturbance

State
Limit

=3

PidOutputSum

ManualValue
=4

Scale
OutputHeat

PidOutput
OffsetHeat

Scale

Config.Output.Heat.Select

PWM

PIDSelfTune.TIR.
OutputOffsetHeat
Split

=1
FALSE
‚â†1

OutputHeat_PWM

Scale

Limit

=2
0

OutputHeat_PER

‚â†2

Limit

Split

Config.ActivateCooling

Scale

OutputCool

-1

1
0.0
0

PIDSelfTune.TIR.
OutputOffsetCool

Scale

Config.Output.Cool.Select

PWM
1

PidOutput
OffsetCool

FALSE
0

=1
FALSE
‚â†1

OutputCool_PWM

Scale
1
0
0

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

=2
0

OutputCool_PER

‚â†2

789

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_Temp no funciona con una
ganancia proporcional negativa y tan solo soporta el sentido de regulaci√≥n normal, es decir, al
aumentar el valor de salida PID (PidOutputSum) debe aumentar el valor real.

Tiempo de integraci√≥n
El tiempo de integraci√≥n determina el comportamiento temporal de la acci√≥n I. La desconexi√≥n
de la acci√≥n I se realiza con el tiempo de integraci√≥n = 0,0. Si el tiempo de integraci√≥n se
modifica online en el modo de operaci√≥n "Autom√°tico" de un valor cualquiera a 0.0, la acci√≥n
I actual se borra y se produce un salto del valor de salida.

Tiempo derivativo
El tiempo de la acci√≥n derivada determina el comportamiento temporal de la acci√≥n D. La
desconexi√≥n de la acci√≥n D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acci√≥n derivada
El efecto de la acci√≥n D se retrasa mediante el coeficiente de retardo de la acci√≥n derivada.
Retardo de la acci√≥n derivada = Tiempo derivativo x coeficiente de retardo de la acci√≥n
derivada
‚óè 0.0: la acci√≥n D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
‚óè 0.5: Este valor se ha acreditado en la pr√°ctica para sistemas regulados con una constante
de tiempo dominante.
‚óè > 1.0: Cuanto mayor sea el coeficiente, m√°s se retrasar√° el efecto de la acci√≥n D.

Ponderaci√≥n de la acci√≥n P
En el caso de que se modifique la consigna, es posible atenuar la acci√≥n P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n P es totalmente efectiva al cambiar la consigna
‚óè 0.0: La acci√≥n P no es efectiva al cambiar la consigna
Si se produce una modificaci√≥n del valor real, la acci√≥n P es totalmente efectiva.

Ponderaci√≥n de la acci√≥n D
En el caso de que se modifique la consigna, es posible atenuar la acci√≥n D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
‚óè 1.0: La acci√≥n D es totalmente efectiva cuando se cambia la consigna.
‚óè 0.0: la acci√≥n D no es efectiva cuando cambia la consigna.
Si se produce una modificaci√≥n del valor real, la acci√≥n D es totalmente efectiva.

790

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Tiempo de muestreo algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo "Algoritmo
PID" es el tiempo que transcurre entre dos c√°lculos del valor de salida PID. Este se determina
durante la optimizaci√≥n y se redondea a un m√∫ltiplo del tiempo de muestreo PID_Temp (tiempo
de ciclo del OB de alarma c√≠clica). Todas las dem√°s funciones de PID_Temp se ejecutan con
cada llamada.
Si se utiliza OutputHeat_PWM o OutputCool_PWM, el tiempo de muestreo del algoritmo PID
se utiliza como duraci√≥n de per√≠odo de la modulaci√≥n de ancho de impulsos. La precisi√≥n de
la se√±al de salida se determina mediante la relaci√≥n entre el tiempo de muestreo del algoritmo
PID y el tiempo de ciclo del OB. El tiempo de ciclo debe ser como m√°ximo una d√©cima parte
del tiempo de muestreo del algoritmo PID.
El tiempo de muestreo del algoritmo PID que se utilice como duraci√≥n de per√≠odo de la
modulaci√≥n por ancho de impulso con OutputCool_PWM depende del m√©todo seleccionado
en los "Ajustes b√°sicos Salida" para calefacci√≥n/refrigeraci√≥n:
‚óè Si se utiliza el factor de enfriamiento, con OutputCool_PWM tambi√©n se aplica el "Tiempo
de muestreo del algoritmo PID para calefacci√≥n".
‚óè Si se utiliza la conmutaci√≥n de par√°metros PID, el "Tiempo de muestreo del algoritmo PID
para refrigeraci√≥n" se aplica como duraci√≥n de per√≠odo para OutputCool_PWM.
En caso de utilizarse OutputHeat_PWM o OutputCool_PWM, si el tiempo de muestreo del
algoritmo PID y, por tanto, la duraci√≥n de per√≠odo de la modulaci√≥n de ancho de impulsos es
muy larga, en los par√°metros Config.Output.Heat.PwmPeriode o
Config.Output.Cool.PwmPeriode se puede especificar una duraci√≥n de per√≠odo m√°s corta con
el fin de reducir las fluctuaciones del valor real.

Ancho de zona muerta
Si el valor real est√° perturbado, la componente de ruido tambi√©n se ver√° reflejada en el valor
de salida. Si la ganancia del regulador es elevada y la acci√≥n D est√° activada, el valor de salida
puede variar en gran medida. Si el valor real se encuentra dentro de la zona muerta en torno
a la consigna, el error de regulaci√≥n se suprime para que el algoritmo PID no reaccione y las
fluctuaciones innecesarias del valor de salida se reduzcan.
El ancho de zona muerta para la calefacci√≥n o la refrigeraci√≥n no se ajusta autom√°ticamente
durante la optimizaci√≥n. El ancho de zona muerta correcto debe configurarse de forma manual.
La desconexi√≥n de la zona muerta tiene lugar con un ancho de zona muerta = 0.0.
Si la zona muerta est√° conectada, es posible ajustar un error de regulaci√≥n (desviaci√≥n entre
consigna y valor real) permanente. Esto puede tener un efecto negativo al realizar una
optimizaci√≥n fina.
Si en los ajustes b√°sicos est√° activada la refrigeraci√≥n y en los ajustes de salida se ha
seleccionado la conmutaci√≥n de par√°metros PID como m√©todo para calefacci√≥n/refrigeraci√≥n,
la zona muerta se encuentra entre "consigna - ancho de zona muerta (calefacci√≥n)" y
"consigna + ancho de zona muerta (refrigeraci√≥n)".
Si en los ajustes b√°sicos est√° desactivada la refrigeraci√≥n o bien se utiliza el factor de
enfriamiento, la zona muerta se encuentra justo entre "consigna - ancho de zona muerta
(calefacci√≥n)" y "consigna + ancho de zona muerta (calefacci√≥n)".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

791

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Si para la ponderaci√≥n de la acci√≥n P o de la acci√≥n D se han configurado valores diferentes
de 1.0, los cambios de la consigna tambi√©n tendr√°n efecto sobre el valor de salida en la zona
muerta.
Los cambios del valor real comprendidos dentro de la zona muerta no tienen efecto sobre el
valor de salida, independientemente de la ponderaci√≥n.

5HWDLQ&WUO3DUDPV
+HDW'HDG=RQH

5HWDLQ&WUO3DUDPV
&RRO'HDG=RQH

5HWDLQ&WUO3DUDPV
+HDW'HDG=RQH

Zona muerta con factor de enfriamiento o refrigeraci√≥n desactivados (izquierda) o con
refrigeraci√≥n activada y conmutaci√≥n de par√°metros PID (derecha). El eje x / horizontal
muestra el error de regulaci√≥n = consigna - valor real. El eje y / vertical muestra la se√±al de
salida de la zona muerta que se transmite al algoritmo PID.

Ancho de zona de regulaci√≥n
Si el valor real se sale de la zona de regulaci√≥n que hay en torno a la consigna, se emite el valor
de salida m√≠nimo o m√°ximo. De este modo el valor real alcanza m√°s r√°pido la consigna.
Si el valor real est√° dentro de la zona de regulaci√≥n que hay en torno a la consigna, se calcula
el valor de salida del algoritmo PID.
El ancho de la zona de regulaci√≥n para calefacci√≥n o refrigeraci√≥n √∫nicamente se ajusta
autom√°ticamente durante la optimizaci√≥n inicial si como estructura de regulador para
calefacci√≥n o refrigeraci√≥n se ha seleccionado "PID (temperatura)".
La desconexi√≥n de la zona de regulaci√≥n tiene lugar con un ancho de zona de regulaci√≥n =
3.402822e+38.
Si en los ajustes b√°sicos est√° desactivada la refrigeraci√≥n o bien se utiliza el factor de
enfriamiento, la zona de regulaci√≥n se encuentra justo entre "consigna - ancho de zona de
regulaci√≥n (calefacci√≥n)" y "consigna + ancho de zona de regulaci√≥n (calefacci√≥n)".
Si en los ajustes b√°sicos est√° activada la refrigeraci√≥n y en los ajustes de salida se ha
seleccionado la conmutaci√≥n de par√°metros PID como m√©todo para calefacci√≥n/refrigeraci√≥n,
la zona de regulaci√≥n se encuentra entre "consigna - ancho de zona de regulaci√≥n
(calefacci√≥n)" y "consigna + ancho de zona de regulaci√≥n (refrigeraci√≥n)".

792

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
,QSXW
3LG2XWSXW6XP 
&RQILJ2XWSXW+HDW3LG/RZHU/LPLW
3LG2XWSXW6XP 
&RQILJ2XWSXW&RRO3LG/RZHU/LPLW

6HWSRLQW
5HWDLQ&WUO3DUDPV
+HDW&RQWURO=RQH
6HWSRLQW

3LG2XWSXW6XP 
&RQILJ2XWSXW+HDW3LG8SSHU/LPLW

6HWSRLQW
5HWDLQ&WUO3DUDPV
+HDW&RQWURO=RQH

W

Zona de regulaci√≥n con factor de enfriamiento o refrigeraci√≥n desactivados.
,QSXW
3LG2XWSXW6XP 
&RQILJ2XWSXW&RRO3LG/RZHU/LPLW

6HWSRLQW
5HWDLQ&WUO3DUDPV
&RRO&RQWURO=RQH
6HWSRLQW

3LG2XWSXW6XP 
&RQILJ2XWSXW+HDW3LG8SSHU/LPLW

6HWSRLQW
5HWDLQ&WUO3DUDPV
+HDW&RQWURO=RQH
W

Zona de regulaci√≥n con refrigeraci√≥n activada y conmutaci√≥n de par√°metros PID.

Regla para la optimizaci√≥n
En la lista desplegable "Estructura del regulador" seleccione si se van a calcular los
par√°metros PI o PID. Las reglas de optimizaci√≥n para calefacci√≥n y optimizaci√≥n para
refrigeraci√≥n pueden especificarse por separado.
‚óè PID (temperatura)
Se calcula durante la optimizaci√≥n inicial y la optimizaci√≥n fina del par√°metro PID.
La optimizaci√≥n inicial est√° dise√±ada para procesos de temperatura y provoca un
comportamiento de regulaci√≥n m√°s lento y m√°s bien asint√≥tico, con menos
sobreoscilaciones que con la opci√≥n "PID". La optimizaci√≥n fina es id√©ntica que con la
opci√≥n "PID".
El ancho de la zona de regulaci√≥n se determina autom√°ticamente durante la optimizaci√≥n
inicial √∫nicamente si se selecciona esta opci√≥n.
‚óè PID
Se calcula durante la optimizaci√≥n inicial y la optimizaci√≥n fina del par√°metro PID.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

793

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
‚óè PI
Se calcula durante la optimizaci√≥n inicial y la optimizaci√≥n fina del par√°metro PI.
‚óè Definido por el usuario
Si se han ajustado diferentes estructuras del regulador para la optimizaci√≥n inicial y la
optimizaci√≥n fina mediante un programa de usuario o la vista de par√°metros, en la lista
desplegable aparece "Definido por el usuario".

3.3.3.3

Puesta en servicio de PID_Temp

Puesta en servicio
La ventana de puesta en servicio ayuda durante la puesta en servicio del regulador PID. En el
visor de curvas se pueden observar la consigna, el valor real y los valores de salida para
calefacci√≥n y refrigeraci√≥n a lo largo del eje de tiempo. En la ventana de puesta en servicio se
soportan las siguientes funciones:
‚óè Optimizaci√≥n inicial del regulador
‚óè Optimizaci√≥n fina del regulador
Utilice la optimizaci√≥n fina si desea realizar un ajuste de precisi√≥n del par√°metro PID.
‚óè Observaci√≥n de la regulaci√≥n en curso en la ventana de curvas
‚óè Prueba del sistema regulado especificando un valor de salida PID manual y una consigna
sustitutiva
‚óè Almacenamiento de los valores actuales de los par√°metros PID en el proyecto offline
Para todas las funciones es preciso realizar una conexi√≥n online a la CPU.
Mediante los botones "Observar todos"
o "Inicio" del visor de curvas se establece la
conexi√≥n online con la CPU, si no estaba ya establecida, y se habilita el manejo de la ventana
de puesta en servicio.

Manejo del visor de curvas
‚óè Seleccione el tiempo de muestreo que desee en la lista desplegable "Tiempo de muestreo".
Todos los valores del visor de curvas se actualizan en el tiempo de muestreo seleccionado.
‚óè Haga clic en el s√≠mbolo "Iniciar" del grupo Medici√≥n si desea utilizar el visor de curvas.
Se inicia el registro de los valores. En el visor de curvas se registran los valores actuales de
consigna, valor real y valores de salida para calefacci√≥n y refrigeraci√≥n.
‚óè Haga clic en el s√≠mbolo "Parar" si desea finalizar el visor de curvas.
Los valores mostrados en el visor de curvas pueden continuar analiz√°ndose.
Al cerrar la ventana de puesta en servicio finaliza el registro en el visor de curvas y los valores
registrados se borran.

794

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Optimizaci√≥n inicial
La optimizaci√≥n inicial determina el comportamiento del proceso a un escal√≥n del valor de
salida y busca el punto de inflexi√≥n. A partir de la inclinaci√≥n m√°xima y del tiempo muerto del
sistema regulado se calculan los par√°metros PID √≥ptimos. Para obtener los mejores
par√°metros PID, debe efectuarse una optimizaci√≥n inicial y una optimizaci√≥n fina.
Cuanto m√°s estable es el valor real, con mayor facilidad y precisi√≥n se pueden calcular los
par√°metros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea
considerablemente mayor que el ruido. Esto tiene m√°s probabilidades de suceder en los
modos "Inactivo" o "Manual". Es preciso realizar una copia de seguridad de los par√°metros PID
antes de volver a calcularlos.
PID_Temp ofrece varios tipos de optimizaci√≥n inicial en funci√≥n de la configuraci√≥n:
‚óè Optimizaci√≥n inicial calefacci√≥n
Se emite un salto en el valor de salida de calefacci√≥n, se calculan los par√°metros PID para
calefacci√≥n y a continuaci√≥n se ajusta la consigna en el modo autom√°tico.
‚óè Optimizaci√≥n inicial de la calefacci√≥n y la refrigeraci√≥n
Se emite un salto en el valor de salida para calefacci√≥n.
En cuanto el valor real se encuentra cerca de la consigna, se emite un salto en el valor de
salida para refrigeraci√≥n.
Se calculan los par√°metros PID para calefacci√≥n (estructura Retain.CtrlParams.Heat) y
refrigeraci√≥n (estructura Retain.CtrlParams.Cool) y a continuaci√≥n se ajusta la consigna en
modo autom√°tico.
‚óè Optimizaci√≥n inicial para refrigeraci√≥n
Se emite un salto en el valor de salida para refrigeraci√≥n.
Se calculan los par√°metros PID para refrigeraci√≥n y a continuaci√≥n se ajusta la consigna en
modo autom√°tico.
Si quiere optimizar los par√°metros PID para calefacci√≥n y refrigeraci√≥n, realizando una
"Optimizaci√≥n inicial calefacci√≥n" y seguidamente una "Optimizaci√≥n inicial refrigeraci√≥n" se
consigue un comportamiento de regulaci√≥n mejor que realizando una "Optimizaci√≥n inicial
calefacci√≥n y refrigeraci√≥n". Sin embargo, realizar la optimizaci√≥n inicial en dos pasos requiere
m√°s tiempo.

Requisitos generales
‚óè La instrucci√≥n PID_Temp se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè Reset = FALSE
‚óè PID_Temp se encuentra en el modo de operaci√≥n "Inactivo", "Modo manual" o "Modo
autom√°tico".
‚óè La consigna y el valor real se encuentran dentro de los l√≠mites configurados (ver la
configuraci√≥n Monitorizaci√≥n de valor real (P√°gina 783)).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

795

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Requisitos para la optimizaci√≥n inicial de la calefacci√≥n
‚óè La diferencia entre la consigna y el valor real es mayor del 30% de la diferencia entre el
l√≠mite superior e inferior del valor real.
‚óè La diferencia entre la consigna y el valor real es superior al 50% de la consigna.
‚óè La consigna es mayor que el valor real.

Requisitos para la optimizaci√≥n inicial de la calefacci√≥n y la refrigeraci√≥n
‚óè La salida de refrigeraci√≥n est√° activada en los "Ajustes b√°sicos" (Config.ActivateCooling =
TRUE).
‚óè La conmutaci√≥n de par√°metros PID est√° activada en los "Ajustes b√°sicos Valor de salida"
(Config.AdvancedCooling = TRUE).
‚óè La diferencia entre la consigna y el valor real es mayor del 30% de la diferencia entre el
l√≠mite superior e inferior del valor real.
‚óè La diferencia entre la consigna y el valor real es superior al 50% de la consigna.
‚óè La consigna es mayor que el valor real.

Requisitos para la optimizaci√≥n inicial para refrigeraci√≥n
‚óè La salida de refrigeraci√≥n est√° activada en los "Ajustes b√°sicos" (Config.ActivateCooling =
TRUE).
‚óè La conmutaci√≥n de par√°metros PID est√° activada en los "Ajustes b√°sicos Valor de salida"
(Config.AdvancedCooling = TRUE).
‚óè Se ha realizado correctamente una "Optimizaci√≥n inicial calefacci√≥n" o una "Optimizaci√≥n
inicial calefacci√≥n y refrigeraci√≥n" (PIDSelfTune.SUT.ProcParHeatOk = TRUE). Debe
utilizarse la misma consigna para todas las optimizaciones.
‚óè La diferencia entre la consigna y el valor real es inferior al 5% de la diferencia entre el l√≠mite
superior e inferior del valor real.

Procedimiento
Para poder realizar una optimizaci√≥n inicial, proceda del siguiente modo:
1. En el √°rbol del proyecto, haga clic en la entrada "PID_Temp > Puesta en servicio".
2. Active el bot√≥n "Observar todos"
Se establece una conexi√≥n online.

796

o inicie el visor de curvas.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
3. Seleccione la opci√≥n de optimizaci√≥n inicial que desee en la lista desplegable "Modo de
ajuste".
4. Haga clic en el s√≠mbolo "Start".
‚Äì Se inicia la optimizaci√≥n inicial.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los errores
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Si la barra de progreso (variable "Progress") lleva mucho tiempo sin avanzar y se debe
presuponer un bloqueo de la optimizaci√≥n, haga clic en el s√≠mbolo "Stop". Compruebe
la configuraci√≥n del objeto tecnol√≥gico y, si procede, vuelva a iniciar la optimizaci√≥n.

Resultado
Si la optimizaci√≥n inicial ha finalizado sin ning√∫n mensaje de error, significa que los par√°metros
PID se han optimizado. PID_Temp cambia al modo autom√°tico y utiliza los par√°metros
optimizados. Los par√°metros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es posible realizar una optimizaci√≥n inicial, PID_Temp se comporta del modo configurado
en Comportamiento en caso de error.

Optimizaci√≥n fina
La optimizaci√≥n fina genera una oscilaci√≥n constante y limitada del valor real. Los par√°metros
PID se optimizan para el punto de operaci√≥n a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular los par√°metros PID. Los par√°metros PID existentes
despu√©s de la optimizaci√≥n fina muestran en su mayor√≠a un comportamiento de gu√≠a y ante
fallos mucho mejor que los par√°metros PID de la optimizaci√≥n inicial. Para obtener los mejores
par√°metros PID, debe efectuarse una optimizaci√≥n inicial y una optimizaci√≥n fina.
PID_Temp intenta generar autom√°ticamente una oscilaci√≥n que es mayor que el ruido del valor
real. La estabilidad del valor real ejerce tan solo una m√≠nima influencia sobre la optimizaci√≥n
fina. Es preciso realizar una copia de seguridad de los par√°metros PID antes de volver a
calcularlos.
PID_Temp ofrece distintos tipos de optimizaci√≥n fina en funci√≥n de la configuraci√≥n:
‚óè Optimizaci√≥n fina para calefacci√≥n:
Mediante cambios peri√≥dicos en el valor de salida para calefacci√≥n, PID_Temp genera una
oscilaci√≥n del valor real y calcula los par√°metros PID para calefacci√≥n.
‚óè Optimizaci√≥n fina para refrigeraci√≥n:
Mediante cambios peri√≥dicos en el valor de salida para refrigeraci√≥n, PID_Temp genera
una oscilaci√≥n del valor real y calcula los par√°metros PID para refrigeraci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

797

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Offset temporal de la optimizaci√≥n para el regulador de calefacci√≥n y refrigeraci√≥n
Si se utiliza PID_Temp como regulador de calefacci√≥n y refrigeraci√≥n (Config.ActivateCooling
= TRUE), el valor de salida PID (PidOutputSum) en la consigna debe cumplir la siguiente
condici√≥n para que se genere una oscilaci√≥n del valor real y la optimizaci√≥n fina pueda llevarse
a cabo correctamente:
‚óè Valor de salida PID positivo para la optimizaci√≥n fina para calefacci√≥n
‚óè Valor de salida PID negativo para la optimizaci√≥n fina para refrigeraci√≥n
Si esta condici√≥n no se cumple, es posible especificar un offset temporal para la optimizaci√≥n
fina (este offset se emite en la salida opuesta).
‚óè Offset para la salida de refrigeraci√≥n (PIDSelfTune.TIR.OutputOffsetCool) en caso de
optimizaci√≥n fina para calefacci√≥n.
Antes de iniciar la optimizaci√≥n debe especificarse un valor de offset de optimizaci√≥n para
refrigeraci√≥n negativo que sea menor que el valor de salida PID (PidOutputSum) de la
consigna en estado estacionario.
‚óè Offset para la salida de calefacci√≥n (PIDSelfTune.TIR.OutputOffsetHeat) en caso de
optimizaci√≥n fina para refrigeraci√≥n.
Antes de iniciar la optimizaci√≥n debe especificarse un valor de offset de optimizaci√≥n para
calefacci√≥n positivo que sea mayor que el valor de salida PID (PidOutputSum) de la
consigna en estado estacionario.
Entonces, el algoritmo PID compensa el offset especificado de manera que el valor real se
mantenga en la consigna. A trav√©s de la magnitud del offset, el valor de salida PID se puede
adaptar para que cumpla la condici√≥n antes mencionada.
Para evitar sobreoscilaciones mayores del valor real al especificar el offset, esta tambi√©n
puede incrementarse en varios pasos.
Si PID_Temp sale del modo Optimizaci√≥n fina, se restablece el offset de optimizaci√≥n.

Ejemplo: especificaci√≥n de un offset para Optimizaci√≥n fina refrigeraci√≥n
‚óè Sin offset
‚Äì Consigna (Setpoint) = valor real (ScaledInput) = 80 ¬∞C
‚Äì Valor de salida PID (PidOutputSum) = 30.0
‚Äì Valor de salida para calefacci√≥n (OutputHeat) = 30.0
‚Äì Valor de salida para refrigeraci√≥n (OutputCool) = 0.0
La salida de refrigeraci√≥n por si sola no permite generar una oscilaci√≥n del valor real en
torno a la consigna. En ese caso fallar√≠a la optimizaci√≥n fina.
‚óè Con offset para la salida de calefacci√≥n (PIDSelfTune.TIR.OutputOffsetHeat) = 80.0
‚Äì Consigna (Setpoint) = valor real (ScaledInput) = 80 ¬∞C
‚Äì Valor de salida PID (PidOutputSum) = -50.0
‚Äì Valor de salida para calefacci√≥n (OutputHeat) = 80.0
‚Äì Valor de salida para refrigeraci√≥n (OutputCool) = -50.0
Especificando un offset para la salida de calefacci√≥n, la salida de refrigeraci√≥n puede
generar una oscilaci√≥n del valor real en torno a la consigna. De este modo la
optimizaci√≥n fina puede llevarse a cabo correctamente.

798

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Requisitos generales
‚óè La instrucci√≥n PID_Temp se llama en un OB de alarma c√≠clica.
‚óè ManualEnable = FALSE
‚óè Reset = FALSE
‚óè La consigna y el valor real se encuentran dentro de los l√≠mites configurados (v√©ase la
configuraci√≥n "Configuraci√≥n del valor real").
‚óè El lazo de regulaci√≥n es estacionario en el punto de operaci√≥n. El punto de operaci√≥n se ha
alcanzado cuando el valor real coincide con la consigna.
Si la zona muerta est√° conectada, es posible ajustar un error de regulaci√≥n (desviaci√≥n
entre consigna y valor real) permanente. Esto puede tener un efecto negativo al realizar la
optimizaci√≥n fina.
‚óè No se esperan perturbaciones.
‚óè PID_Temp se encuentra en el modo de operaci√≥n inactivo, autom√°tico o manual.

Requisitos para Optimizaci√≥n fina calefacci√≥n
‚óè Heat.EnableTuning = TRUE
‚óè Cool.EnableTuning = FALSE
‚óè Si PID_Temp est√° configurado como regulador de calefacci√≥n y refrigeraci√≥n
(Config.ActivateCooling = TRUE), la salida de calefacci√≥n debe estar activa en el punto de
operaci√≥n donde vaya a realizarse la optimizaci√≥n.
PidOutputSum > 0.0 (ver Offset de optimizaci√≥n)

Requisitos para Optimizaci√≥n fina refrigeraci√≥n
‚óè Heat.EnableTuning = FALSE
‚óè Cool.EnableTuning = TRUE
‚óè La salida de refrigeraci√≥n est√° activada (Config.ActivateCooling = TRUE).
‚óè La conmutaci√≥n de par√°metros PID est√° activada (Config.AdvancedCooling = TRUE).
‚óè La salida de refrigeraci√≥n debe estar activa en el punto de operaci√≥n donde vaya a
realizarse la optimizaci√≥n.
PidOutputSum < 0.0 (ver Offset de optimizaci√≥n)

El proceso depende de la situaci√≥n de inicio
La optimizaci√≥n fina puede iniciarse desde los modos de operaci√≥n "Inactivo", "Autom√°tico" o
"Manual".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

799

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
La optimizaci√≥n fina se desarrolla del modo siguiente en el momento del inicio:
‚óè Modo autom√°tico con PIDSelfTune.TIR.RunIn = FALSE (ajuste predeterminado)
Si desea mejorar los par√°metros PID existentes mediante optimizaci√≥n, inicie la
optimizaci√≥n fina desde el modo autom√°tico.
PID_Temp regula con los par√°metros PID existentes hasta que el lazo de regulaci√≥n es
estacionario y se cumplen las condiciones para la optimizaci√≥n fina. Solo entonces
comienza la optimizaci√≥n fina.
‚óè Modo inactivo, modo manual o modo autom√°tico con PIDSelfTune.TIR.RunIn = TRUE
Se intenta alcanzar la consigna con el valor de salida m√≠nimo o m√°ximo (regulaci√≥n de dos
puntos):
‚Äì con el valor de salida m√≠nimo o m√°ximo para calefacci√≥n en caso de optimizaci√≥n fina
para calefacci√≥n.
‚Äì con el valor de salida m√≠nimo o m√°ximo para refrigeraci√≥n en caso de optimizaci√≥n fina
para refrigeraci√≥n.
Esto puede ocasionar una sobreoscilaci√≥n muy alta. La optimizaci√≥n fina comienza cuando
se alcanza la consigna.
Si no es posible alcanzar la consigna, PID_Temp no cancela autom√°ticamente la
optimizaci√≥n.

Procedimiento
Para poder realizar una optimizaci√≥n fina, proceda del siguiente modo:
1. En el √°rbol del proyecto, haga doble clic en la entrada "PID_Temp > Puesta en servicio".
2. Active el bot√≥n "Observar todos"
Se establece una conexi√≥n online.

o inicie el visor de curvas.

3. Seleccione la opci√≥n de optimizaci√≥n fina que desee en la lista desplegable "Modo de
ajuste".

800

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
4. Si es necesario (ver Offset de optimizaci√≥n), especifique un offset de optimizaci√≥n y espere
a que se alcance de nuevo el estado estacionario.
5. Haga clic en el s√≠mbolo "Start".
‚Äì Se inicia el proceso de optimizaci√≥n fina.
‚Äì En el campo "Estado" se muestran los pasos actuales y, de haberlos, los errores
ocurridos.
La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de ajuste", haga clic en el s√≠mbolo "Stop" si la barra de progreso (variable
"Progress") lleva mucho tiempo sin avanzar y se debe presuponer un bloqueo de la
optimizaci√≥n. Compruebe la configuraci√≥n del objeto tecnol√≥gico y, si procede, vuelva a
iniciar la optimizaci√≥n.
En particular en las fases siguientes, la optimizaci√≥n no se cancela de forma autom√°tica si
no es posible alcanzar la consigna.
‚óè "Intentar alcanzar la consigna para la calefacci√≥n con regulaci√≥n de dos puntos."
‚óè "Intentar alcanzar la consigna para la refrigeraci√≥n con regulaci√≥n de dos puntos."

Resultado
Si durante la optimizaci√≥n fina no se produjeron errores, significa que los par√°metros PID se
optimizaron. PID_Temp pasa al modo autom√°tico y utiliza los par√°metros optimizados. Los
par√°metros PID optimizados se conservan al desconectar (Power OFF) y al rearrancar por
completo la CPU.
Si se han producido errores durante la optimizaci√≥n fina, PID_Temp se comporta del modo
configurado en Comportamiento en caso de error.

Modo de operaci√≥n "Modo manual"
A continuaci√≥n se describe c√≥mo utilizar el modo de operaci√≥n "Modo manual" en la ventana
de puesta en servicio del objeto tecnol√≥gico "PID_Temp".
El modo manual es posible aunque haya un error pendiente.

Requisitos
‚óè La instrucci√≥n "PID_Temp" se llama en un OB de alarma c√≠clica.
‚óè Se ha establecido una conexi√≥n online con la CPU.
‚óè La CPU se encuentra en el estado operativo "RUN".

Procedimiento
Si quiere probar el sistema regulado especificando un valor manual, utilice el "Modo manual"
en la ventana de puesta en servicio.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

801

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Para especificar un valor manual, proceda del siguiente modo:
1. En el √°rbol del proyecto, haga doble clic en la entrada "PID_Temp > Puesta en servicio".
2. Active el bot√≥n "Observar todos"
Se establece una conexi√≥n online.

o inicie el visor de curvas.

3. Active la casilla de verificaci√≥n "Modo manual" en el √°rea "Estado online del regulador".
PID_Temp opera en modo manual. El √∫ltimo valor de salida actual permanece activo.
4. Introduzca el valor manual en la unidad % en el campo editable.
Si est√° activada la refrigeraci√≥n en los ajustes b√°sicos, introduzca el valor manual de la
siguiente manera:
‚Äì Para emitir el valor en las salidas para calefacci√≥n, introduzca un valor manual positivo.
‚Äì Para emitir el valor en las salidas para refrigeraci√≥n, introduzca un valor manual
negativo.
5. Haga clic en el s√≠mbolo

.

Resultado
El valor manual se escribe en la CPU y es efectivo de forma inmediata.
Desactive la casilla de verificaci√≥n "Modo manual" si desea que el regulador PID vuelva a
especificar el valor de salida.
El cambio al modo autom√°tico se efect√∫a sin discontinuidad.

Consigna sustitutiva
A continuaci√≥n se describe c√≥mo utilizar la consigna sustitutiva en la ventana de puesta en
servicio del objeto tecnol√≥gico "PID_Temp".

Requisitos
‚óè La instrucci√≥n "PID_Temp" se llama en un OB de alarma c√≠clica.
‚óè Se ha establecido una conexi√≥n online con la CPU.
‚óè La CPU se encuentra en el estado operativo "RUN".

Procedimiento
Si temporalmente quiere utilizar como consigna un valor distinto al del par√°metro "Setpoint"
(p. ej., para optimizar un esclavo en una cascada), utilice la consigna sustitutiva en la ventana
de puesta en servicio.
Para especificar una consigna sustitutiva, proceda del siguiente modo:
1. En el √°rbol del proyecto, haga doble clic en la entrada "PID_Temp > Puesta en servicio".
2. Active el bot√≥n "Observar todos"
Se establece una conexi√≥n online.

802

o inicie el visor de curvas.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
3. Active la casilla de verificaci√≥n "Subst.Setpoint" en el √°rea "Estado online del regulador".
La consigna sustitutiva (variable SubstituteSetpoint) se inicializa con la √∫ltima consigna
actual y se utiliza ahora.
4. Introduzca la consigna sustitutiva en el campo editable.
5. Haga clic en el s√≠mbolo

.

Resultado
La consigna sustitutiva se escribe en la CPU y es efectiva de forma inmediata.
Desactive la casilla de verificaci√≥n "Subst.Setpoint" cuando de nuevo quiera utilizar como
consigna el valor del par√°metro "Setpoint".
El cambio no tiene lugar sin discontinuidad.

Puesta en servicio en cascada
Para m√°s informaci√≥n sobre la puesta en servicio en cascada con PID_Temp, ver Puesta en
servicio (P√°gina 808).

3.3.3.4

Regulaci√≥n en cascada con PID_Temp

Introducci√≥n
Para la regulaci√≥n en cascada se imbrican varios lazos de regulaci√≥n entre s√≠. Las consignas
(Setpoint) de los esclavos son los valores de salida (OutputHeat) de los respectivos maestros
superiores.
La condici√≥n para establecer una conexi√≥n en cascada es que el sistema regulado pueda
dividirse en sistemas parciales, cada uno de ellos con una magnitud propia.
La especificaci√≥n de consigna para la variable regulada se lleva a cabo en el maestro m√°s
exterior.
El valor de salida del esclavo m√°s interior se aplica en el actuador y act√∫a sobre el sistema
regulado.
El uso de una regulaci√≥n en cascada ofrece las siguientes ventajas principales en
comparaci√≥n con un lazo de regulaci√≥n simple:
‚óè Al haber m√°s lazos de regulaci√≥n subordinados, los errores que ocurren se corrigen m√°s
r√°pido. Su influencia en la variable regulada disminuye considerablemente. Esto mejora el
comportamiento ante fallos.
‚óè Los lazos de regulaci√≥n subordinados tienen un efecto linealizante. Esto reduce las
consecuencias negativas de tales faltas de linealidad sobre la variable regulada.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

803

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
PID_Temp ofrece las siguientes funciones especialmente para uso en regulaciones en
cascada:
‚óè especificaci√≥n de una consigna sustitutiva;
‚óè intercambio de informaci√≥n de estado entre maestro y esclavo (p. ej., modo de operaci√≥n
actual);
‚óè varios modos Anti-Wind-Up (reacci√≥n del maestro a la limitaci√≥n de sus esclavos).

Ejemplo
El siguiente diagrama de bloques muestra una regulaci√≥n en cascada con PID_Temp tomando
como ejemplo el proceso simplificado de un fundidor de chocolate:
7HPS&KRFRODWH
7HPS:DWHU

3,'B7HPSB

3,'B7HPSB

,QSXW

2XWSXW+HDW

,QSXW

2XWSXW+HDW

6HWSRLQW

2XWSXW&RRO

6HWSRLQW

2XWSXW&RRO

3,'B7HPSB
6ODYH

0DVWHU
6ODYH

&KRFRODWH
:DWHU

0DVWHU
6ODYH

,V0DVWHU
758(
,V6ODYH
)$/6(
&RXQW6ODYHV


,V0DVWHU
,V6ODYH
&RXQW6ODYHV

)$/6(
758(


El maestro PID_Temp_1 compara el valor real de la temperatura del chocolate
(TempChocolate) con la consigna especificada por el usuario con el par√°metro Setpoint. El
valor de salida OutputHeat es la consigna del esclavo PID_Temp_2.
PID_Temp_2 intenta que el valor real de la temperatura del ba√±o Mar√≠a (TempWater) llegue
hasta esa consigna. El valor de salida de PID_Temp_2 se aplica directamente sobre el
actuador del sistema regulado (calefacci√≥n del ba√±o Mar√≠a) y de este modo influye en la
temperatura del agua. A su vez, la temperatura del agua influye en la temperatura del
chocolate.

Preguntas frecuentes (FAQ)
Para m√°s informaci√≥n al respecto, consulte la siguiente pregunta frecuente (FAQ) en el
Siemens Industry Online Support:
‚óè ID de art√≠culo 103526819 (https://support.industry.siemens.com/cs/ww/en/view/
103526819)

804

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Consulte tambi√©n
Creaci√≥n del programa (P√°gina 805)

Creaci√≥n del programa
A la hora de crear el programa deben tenerse en cuenta los siguientes puntos:
‚óè N√∫mero de instancias de PID_Temp
Deben llamarse tantas instancias PID_Temp diferentes en un OB de alarma c√≠clica como
magnitudes concatenadas haya en el proceso.
En el ejemplo hay dos magnitudes concatenadas: TempChocolate y TempWater. Por lo
tanto, se necesitan dos instancias PID_Temp.
‚óè Orden de llamada
El maestro debe llamarse antes que sus esclavos en el mismo OB de alarma c√≠clica.
Primero se llama al maestro m√°s exterior, en el que se especifica la consigna de usuario.
A continuaci√≥n se llama al esclavo cuya consigna procede de ese maestro m√°s exterior, y
as√≠ sucesivamente.
El esclavo m√°s interior, cuyo valor de salida se aplica al actuador del proceso, es el √∫ltimo
en ser llamado.
En el ejemplo se llama a PID_Temp_1 antes que a PID_Temp_2.
‚óè Interconexi√≥n de las magnitudes
El maestro m√°s exterior se interconecta con la magnitud m√°s exterior, que debe regularse
hasta coincidir con la consigna de usuario.
El esclavo m√°s interior se interconecta con la magnitud m√°s interior, que recibe la influencia
directa del actuador.
La interconexi√≥n de las magnitudes con PID_Temp se lleva a cabo con los par√°metros Input
o Input_PER.
En el ejemplo, la magnitud exterior TempChocolate se interconecta con PID_Temp_1, y la
magnitud interior TempWater se interconecta con PID_Temp_2.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

805

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
‚óè Interconexi√≥n del valor de salida del maestro con la consigna del esclavo
El valor de salida (OutputHeat) de un maestro debe asignarse a la consigna (Setpoint) de
su esclavo.
Esta interconexi√≥n puede realizarse manualmente en el editor de programaci√≥n o bien
automatizarse en la ventana de inspecci√≥n del esclavo, seleccionando al maestro en los
ajustes b√°sicos.
Si es necesario, pueden a√±adirse funciones de filtro o escalado propias, p. ej., para adaptar
el rango de valores de salida del maestro al rango de consignas/valores reales del esclavo.
En el ejemplo, OutputHeat de PID_Temp_1 se asigna a Setpoint de PID_Temp_2.
‚óè Interconexi√≥n de la interfaz para el intercambio de informaci√≥n entre maestro y esclavo
El par√°metro "Slave" de un maestro debe asignarse al par√°metro "Master" de todos los
esclavos directamente subordinados (que reciben su consigna de ese maestro). Para
poder interconectar un maestro con varios esclavos y visualizar la interconexi√≥n en la
ventana de inspecci√≥n del esclavo en los ajustes b√°sicos, debe realizarse la asignaci√≥n a
trav√©s de la interfaz del esclavo.
Esta interconexi√≥n puede realizarse manualmente en el editor de programaci√≥n o bien
automatizarse en la ventana de inspecci√≥n del esclavo, seleccionando al maestro en los
ajustes b√°sicos.
La funcionalidad Anti-Wind-Up y la evaluaci√≥n de los modos de operaci√≥n de esclavo en el
maestro solo pueden funcionar correctamente si se ha realizado esa interconexi√≥n.
En el ejemplo, el par√°metro "Slave" de PID_Temp_1 se asigna al par√°metro "Master" de
PID_Temp_2.
C√≥digo de programa del ejemplo en lenguaje SCL (sin asignaci√≥n del valor de salida del
esclavo al actuador):
"PID_Temp_1"(Input:="TempChocolate");
"PID_Temp_2"(Input:="TempWater", Master := "PID_Temp_1".Slave,
Setpoint := "PID_Temp_1".OutputHeat);

Configuraci√≥n
La configuraci√≥n puede realizarse a trav√©s del programa de usuario, el editor de configuraci√≥n
o la ventana de inspecci√≥n de la llamada a PID_Temp.
A la hora de utilizar PID_Temp en una regulaci√≥n en cascada, debe tenerse en cuenta la
correcta configuraci√≥n de los ajustes mencionados a continuaci√≥n.
Si una instancia PID_Temp recibe su consigna de un maestro superior y transmite su valor de
salida a un esclavo inferior, esa instancia PID_Temp es maestro y esclavo al mismo tiempo.
Para esa instancia PID_Temp deben realizarse las dos configuraciones descritas a
continuaci√≥n. Esto es lo que ocurre, por ejemplo, con la instancia PID_Temp central de una
regulaci√≥n en cascada con tres magnitudes concatenadas y tres instancias PID_Temp.

806

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Configuraci√≥n de un maestro
Ajuste en el editor de configuraci√≥n o la
ventana de inspecci√≥n

Par√°metro del DB

Explicaci√≥n

Ajustes b√°sicos ‚Üí Cascada:

Config.Cascade.IsMaster =
TRUE

Activa ese regulador como maestro en una cas‚Äê
cada.

Config.Cascade.CountSlaves

N√∫mero de esclavos

N√∫mero de esclavos directamente subordina‚Äê
dos que reciben sus consignas de ese maestro.

Ajustes b√°sicos ‚Üí Par√°metros de entra‚Äê Config.Output.Heat.Select = 0
da/salida:

El maestro utiliza exclusivamente el par√°metro
de salida OutputHeat.

Selecci√≥n del valor de salida (calefac‚Äê
ci√≥n) = OutputHeat

OutputHeat_PWM y OutputHeat_PER est√°n de‚Äê
sactivados.

Ajustes b√°sicos ‚Üí Par√°metros de entra‚Äê Config.ActivateCooling = FAL‚Äê
SE
da/salida:

En un maestro, la refrigeraci√≥n debe estar de‚Äê
sactivada.

Activar la casilla de verificaci√≥n "El re‚Äê
gulador es maestro"
Ajustes b√°sicos ‚Üí Cascada:

Desactivar la casilla de verificaci√≥n "Ac‚Äê
tivar refrigeraci√≥n"
Ajustes de la salida ‚Üí L√≠mites y escala
del valor de salida ‚Üí OutputHeat / Out‚Äê
putCool:
L√≠mite inferior del valor de salida PID
(calefacci√≥n),
L√≠mite superior del valor de salida PID
(calefacci√≥n),
Valor de salida inferior escalado (cale‚Äê
facci√≥n),
Valor de salida superior escalado (cale‚Äê
facci√≥n)
Esta variable no est√° disponible en la
ventana de inspecci√≥n ni en la vista de
funciones del editor de configuraci√≥n.
Puede modificarse a trav√©s de la vista
de par√°metros del editor de configura‚Äê
ci√≥n.

Config.Output.Heat.PidLower‚Äê
Limit,
Config.Output.Heat.PidUpper‚Äê
Limit,
Config.Output.Heat.LowerSca‚Äê
ling,

Si al asignar OutputHeat del maestro a Setpoint
del esclavo no se utiliza una funci√≥n de escalado
propia, puede que sea necesario adaptar los l√≠‚Äê
mites y la escala del valor de salida del maestro
al rango de consignas/valores reales del escla‚Äê
vo.

Config.Output.Heat.UpperSca‚Äê
ling

Config.Cascade.AntiWindUp‚Äê
Mode

El modo Anti-Wind-Up determina c√≥mo se trata
la acci√≥n I de ese maestro si los esclavos direc‚Äê
tamente subordinados alcanzan sus l√≠mites de
valor de salida.
Posibilidades:
‚óè AntiWindUpMode = 0:
La funcionalidad AntiWindUp est√°
desactivada. El maestro no reacciona
cuando sus esclavos est√°n en el l√≠mite.
‚óè AntiWindUpMode = 1 (ajuste
predeterminado):
La acci√≥n I del maestro se reduce en la
proporci√≥n "esclavos en el l√≠mite / n√∫mero de
esclavos". De este modo se reducen las
repercusiones de la limitaci√≥n en el
comportamiento de regulaci√≥n.
‚óè AntiWindUpMode = 2:
La acci√≥n I del maestro se detiene en cuanto
un esclavo est√° en la limitaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

807

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)

Configuraci√≥n de un esclavo
Ajuste en el editor de configuraci√≥n o la
ventana de inspecci√≥n

Par√°metro del DB

Explicaci√≥n

Ajustes b√°sicos ‚Üí Cascada:

Config.Cascade.IsSlave =
TRUE

Activa ese regulador como esclavo en una cas‚Äê
cada.

Activar la casilla de verificaci√≥n "El re‚Äê
gulador es esclavo"

Puesta en servicio
Despu√©s de compilar y cargar el programa, puede iniciarse la puesta en marcha de la
regulaci√≥n en cascada.
Comience la puesta en marcha (ejecuci√≥n de una optimizaci√≥n o cambio al modo autom√°tico
con par√°metros PID existentes) con el esclavo m√°s interior y contin√∫e hacia fuera hasta llegar
al maestro m√°s exterior.
En el ejemplo anterior, la puesta en servicio comienza con PID_Temp_2 y prosigue con
PID_Temp_1.

Optimizaci√≥n del esclavo
La optimizaci√≥n de PID_Temp requiere una consigna constante. Por lo tanto, para optimizar un
esclavo hay que activar su consigna sustitutiva (variables SubstituteSetpoint y
SubstituteSetpointOn) o poner el maestro correspondiente en modo manual con el valor
manual correspondiente. De esta forma se garantiza que la consigna del esclavo permanezca
constante durante la optimizaci√≥n.

Optimizaci√≥n del maestro
Para que un maestro pueda influir en el proceso o realizar una optimizaci√≥n, todos los esclavos
posteriores deben estar en modo autom√°tico y haber desactivado la consigna sustitutiva. A
trav√©s de la interfaz para intercambio de informaci√≥n entre maestro y esclavo (par√°metros
Master y Slave), un maestro eval√∫a estas condiciones y muestra el estado actual en las
variables AllSlaveAutomaticState y NoSlaveSubstituteSetpoint. En el editor de puesta en
marcha se emiten los avisos de estado correspondientes.
Aviso de estado en el editor de puesta
en servicio del maestro

Par√°metro de DB del maestro

Uno o varios esclavos no est√°n en modo AllSlaveAutomaticState = FAL‚Äê
autom√°tico.
SE,
NoSlaveSubstituteSetpoint =
TRUE
Uno o varios esclavos han activado la
consigna sustitutiva.

AllSlaveAutomaticState =
TRUE,
NoSlaveSubstituteSetpoint =
FALSE

Uno o varios esclavos no est√°n en modo AllSlaveAutomaticState = FAL‚Äê
autom√°tico y han activado la consigna SE,
sustitutiva.
NoSlaveSubstituteSetpoint =
FALSE

808

Soluci√≥n
Realice primero la puesta en servicio de todos
los esclavos posteriores.
Antes de realizar una optimizaci√≥n o de activar
el modo manual o autom√°tico del maestro, ase‚Äê
g√∫rese de que se cumplen las condiciones si‚Äê
guientes:
‚óè Todos los esclavos siguientes est√°n en
modo autom√°tico (State = 3).
‚óè Todos los esclavos posteriores tienen la
consigna sustitutiva desactivada
(SubstituteSetpointOn = FALSE).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Si se inicia una optimizaci√≥n inicial o una optimizaci√≥n fina para un maestro, PID_Temp
cancela la optimizaci√≥n y muestra un error con ErrorBits = DW#16#0200000 en los casos
siguientes:
‚óè Uno o varios esclavos no est√°n en modo autom√°tico (AllSlaveAutomaticState = FALSE).
‚óè Uno o varios esclavos han activado la consigna sustitutiva (NoSlaveSubstituteSetpoint =
FALSE).
El siguiente cambio de modo de operaci√≥n depende de ActivateRecoverMode.

Consigna sustitutiva
Para la especificaci√≥n de una consigna, PID_Temp ofrece, adem√°s del par√°metro Setpoint,
una consigna sustitutiva en la variable SubstituteSetpoint. Esta puede activarse con
SubstituteSetpointOn = TRUE o marcando la casilla de verificaci√≥n correspondiente en el
editor de puesta en servicio.
Con la consigna sustitutiva se puede especificar la consigna directamente en el esclavo de
forma temporal, p. ej., para la puesta en servicio u optimizaci√≥n.
Para ello, en el programa no debe modificarse la interconexi√≥n del valor de salida del maestro
con la consigna del esclavo (interconexi√≥n necesaria para el funcionamiento normal de la
regulaci√≥n en cascada).
Para que un maestro pueda influir en el proceso o realizar una optimizaci√≥n, todos los esclavos
posteriores deben haber desactivado la consigna sustitutiva.
La consigna actualmente activa, utilizada por el algoritmo PID para el c√°lculo, puede verse en
la variable CurrentSetpoint.

Modos de operaci√≥n y reacci√≥n a fallo
El maestro o esclavo de una instancia PID_Temp no cambian el modo de operaci√≥n de dicha
instancia PID_Temp.
Si se produce un error en uno de sus esclavos, el maestro permanece en su modo de
operaci√≥n actual.
Si se produce un error en su maestro, el esclavo permanece en su modo de operaci√≥n actual.
Sin embargo, el funcionamiento posterior del esclavo depende del error y de la reacci√≥n a fallo

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

809

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
configurada en el maestro, ya que el valor de salida del maestro se utiliza como consigna del
esclavo:
‚óè Si en el maestro est√° configurado ActivateRecoverMode = TRUE y el error no impide el
c√°lculo de OutputHeat, el error no afecta al esclavo.
‚óè Si en el maestro est√° configurado ActivateRecoverMode = TRUE y el error impide el c√°lculo
de OutputHeat, el maestro, en funci√≥n de SetSubstituteOutput, emite el √∫ltimo valor de
salida v√°lido o el valor de salida sustitutivo configurado SubstituteOutput. Este valor es
utilizado por el esclavo como consigna.
PID_Temp est√° preajustado de manera que en este caso se emite el valor de salida
sustitutivo 0.0 (ActivateRecoverMode = TRUE, SetSubstituteOutput = TRUE,
SubstituteOutput = 0.0). Configure para su aplicaci√≥n un valor de salida sustitutivo
adecuado o bien active el uso del √∫ltimo valor de salida PID v√°lido (SetSubstituteOutput =
FALSE).
‚óè Si en el maestro est√° configurado ActivateRecoverMode = FALSE, en caso de fallo el
maestro cambia al modo de operaci√≥n "Inactivo" y emite OutputHeat = 0.0. El esclavo utiliza
0.0 como consigna.
La reacci√≥n a fallo puede consultarse en los ajustes de salida, en el editor de configuraci√≥n.

3.3.3.5

Regulaci√≥n multizona con PID_Temp

Introducci√≥n
La regulaci√≥n multizona consiste en que varias sub√°reas de una instalaci√≥n, llamadas zonas,
se regulan simult√°neamente a temperaturas diferentes. La caracter√≠stica de la regulaci√≥n
multizona es la influencia mutua de las zonas de temperatura mediante acoplamiento t√©rmico,
es decir, el valor real de una zona puede influir en el valor real de otra zona debido al
acoplamiento t√©rmico. El efecto de esta influencia depende del dise√±o de la instalaci√≥n y de los
puntos de operaci√≥n seleccionados en las zonas.
Ejemplo: una extrusora de las que se utilizan para la transformaci√≥n de pl√°sticos, entre otras
cosas.
Para que la transformaci√≥n se lleve a cabo de manera √≥ptima, la mezcla que pasa por la
extrusora debe regularse a temperaturas diferentes. As√≠, por ejemplo, en la zona de llenado de
la extrusora pueden necesitarse temperaturas diferentes que en la tobera de salida. Las
distintas zonas de temperatura influyen unas en otras debido al acoplamiento t√©rmico.
Si se utiliza PID_Temp en regulaciones multizona, cada zona de temperatura es regulada por
una instancia PID_Temp propia.
Debe tener en cuenta las indicaciones siguientes cuando utilice PID_Temp en una regulaci√≥n
multizona.

Optimizaci√≥n inicial separada para calefacci√≥n y refrigeraci√≥n
La primera puesta en servicio de una instalaci√≥n generalmente comienza con una optimizaci√≥n
inicial, para realizar un primer ajuste de los par√°metros PID y para regular el punto de
operaci√≥n. La optimizaci√≥n inicial para regulaciones multizona suele realizarse
simult√°neamente para todas las zonas.

810

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Para reguladores con refrigeraci√≥n activada y conmutaci√≥n de par√°metros PID como m√©todo
para calefacci√≥n/refrigeraci√≥n (Config.ActivateCooling = TRUE, Config.AdvancedCooling =
TRUE), PID_Temp ofrece la posibilidad de realizar la optimizaci√≥n inicial para calefacci√≥n y
refrigeraci√≥n en un solo paso (Mode = 1, Heat.EnableTuning = TRUE, Cool.EnableTuning =
TRUE).
No obstante, se recomienda no utilizar esta optimizaci√≥n en caso de optimizaci√≥n inicial
simult√°nea de varias instancias PID_Temp en una regulaci√≥n multizona. En lugar de ello,
realice la optimizaci√≥n inicial para calefacci√≥n (Mode = 1, Heat.EnableTuning = TRUE,
Cool.EnableTuning = FALSE) y la optimizaci√≥n inicial para refrigeraci√≥n (Mode = 1,
Heat.EnableTuning = FALSE, Cool.EnableTuning = TRUE) por separado.
La optimizaci√≥n inicial para refrigeraci√≥n no debe iniciarse hasta que todas las zonas hayan
concluido la optimizaci√≥n inicial para calefacci√≥n y hayan alcanzado su punto de operaci√≥n.
De esta manera, se reducen las influencias mutuas debidas a acoplamientos t√©rmicos entre
las zonas durante la optimizaci√≥n.

Adaptaci√≥n del tiempo de retardo
Si se utiliza PID_Temp en una regulaci√≥n multizona con fuertes acoplamientos t√©rmicos entre
las zonas, hay que cerciorarse de que la adaptaci√≥n del tiempo de retardo para la optimizaci√≥n
inicial est√© desactivada con PIDSelfTune.SUT.AdaptDelayTime = 0. De lo contrario, la
determinaci√≥n del tiempo de retardo puede verse falseada si durante la adaptaci√≥n del tiempo
de retardo (la calefacci√≥n est√° desactivada en esa fase) se impide la refrigeraci√≥n de esa zona
debido a la entrada de calor procedente de otras zonas.

Desconexi√≥n temporal de la refrigeraci√≥n
Para reguladores con refrigeraci√≥n activada (Config.ActivateCooling = TRUE), PID_Temp
ofrece la posibilidad de desactivar temporalmente la refrigeraci√≥n en modo autom√°tico
ajustando DisableCooling = TRUE.
De esta manera durante la puesta en servicio puede impedirse que ese regulador enfr√≠e en
modo autom√°tico mientras los reguladores de otras zonas todav√≠a no han concluido la
optimizaci√≥n de la calefacci√≥n. Si eso ocurriera, la optimizaci√≥n podr√≠a verse afectada
negativamente debido al acoplamiento t√©rmico entre las zonas.

Procedimiento
Para la puesta en servicio de regulaciones multizona con acoplamientos t√©rmicos relevantes,
puede proceder del siguiente modo:
1. Para todos los reguladores con refrigeraci√≥n activada, ajuste DisableCooling = TRUE.
2. Para todos los reguladores, ajuste PIDSelfTune.SUT.AdaptDelayTime = 0.
3. Especifique las consignas que desee (par√°metro Setpoint) e inicie simult√°neamente para
todos los reguladores la optimizaci√≥n inicial para calefacci√≥n (Mode = 1,
Heat.EnableTuning = TRUE, Cool.EnableTuning = FALSE).
4. Espere a que todos los reguladores hayan concluido la optimizaci√≥n inicial de la calefacci√≥n.
5. Para todos los reguladores con refrigeraci√≥n activada, ajuste DisableCooling = FALSE.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

811

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
6. Espere a que los valores reales de todas las zonas se hayan estabilizado y est√©n pr√≥ximos
a las consignas correspondientes.
Si en una zona no es posible alcanzar la consigna de manera permanente, significa que el
actuador de calefacci√≥n o refrigeraci√≥n est√° infradimensionado.
7. Para todos los reguladores con refrigeraci√≥n activada, inicie la optimizaci√≥n inicial de la
refrigeraci√≥n (Mode = 1, Heat.EnableTuning = FALSE, Cool.EnableTuning = TRUE).
Nota
Rebase de los l√≠mites del valor real
Si la refrigeraci√≥n en modo autom√°tico se desactiva con DisableCooling = TRUE, puede ocurrir
que el valor real rebase la consigna y los l√≠mites de valor real mientras DisableCooling = TRUE.
Observe los valores reales y est√© preparado para intervenir si utiliza DisableCooling.
Nota
Regulaciones multizona
En las regulaciones multizona, los acoplamientos t√©rmicos entre las zonas pueden causar
fuertes sobreoscilaciones, rebasamientos permanentes o transitorios de valores l√≠mite, y
errores de regulaci√≥n permanentes o transitorios durante la puesta en servicio y durante el
funcionamiento. Observe los valores reales y est√© preparado para intervenir. Dependiendo de
la instalaci√≥n, puede que sea necesario actuar de manera diferente al procedimiento descrito.

Sincronizaci√≥n de varias optimizaciones finas
Si la optimizaci√≥n fina se inicia desde el modo autom√°tico con PIDSelfTune.TIR.RunIn =
FALSE, PID_Temp intenta alcanzar la consigna con regulaci√≥n PID y con los par√°metros PID
actuales. La optimizaci√≥n propiamente dicha no comienza hasta que se alcanza la consigna.
El tiempo necesario para alcanzar la consigna puede diferir en las diferentes zonas de una
regulaci√≥n multizona.
Si se quiere realizar la optimizaci√≥n fina para varias zonas a la vez, PID_Temp ofrece la
posibilidad de sincronizarlas retrasando el resto de los pasos de optimizaci√≥n hasta que se
alcance la consigna.

Procedimiento
De esta manera puede asegurarse de que todos los reguladores hayan alcanzado su consigna
cuando comiencen los pasos de optimizaci√≥n propiamente dichos. As√≠ se reducen las
influencias mutuas debidas a acoplamientos t√©rmicos entre las zonas durante la optimizaci√≥n.
Con los reguladores para cuyas zonas quiera realizar la optimizaci√≥n fina de manera
simult√°nea, proceda del siguiente modo:
1. Ajuste PIDSelfTune.TIR.WaitForControlIn = TRUE para todos los reguladores.
Esos reguladores deben estar en modo autom√°tico con PIDSelfTune.TIR.RunIn = FALSE.
2. Especifique las consignas que desee (par√°metro Setpoint) e inicie la optimizaci√≥n fina para
todos los reguladores.

812

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
3. Espere hasta que en todos los reguladores est√© ajustado PIDSelfTune.TIR.ControlInReady
= TRUE.
4. Ajuste PIDSelfTune.TIR.FinishControlIn = TRUE Para todos los reguladores.
Todos los reguladores inician la optimizaci√≥n en s√≠ simult√°neamente.

3.3.3.6

Regulaci√≥n de transici√≥n con PID_Temp

Regulaci√≥n de transici√≥n
En caso de regulaci√≥n de transici√≥n, dos o m√°s reguladores comparten un actuador com√∫n. En
cada instante, solo un regulador tiene acceso al actuador y act√∫a sobre el proceso.
Una l√≥gica decide qu√© regulador obtiene acceso al actuador. A menudo, esta decisi√≥n se toma
en funci√≥n de una comparaci√≥n de los valores de salida de todos los reguladores, p. ej., el
regulador con el mayor valor de salida obtiene acceso al actuador en caso de selecci√≥n del
m√°ximo.
La selecci√≥n en funci√≥n del valor de salida hace necesario que todos los reguladores funcionen
en el modo autom√°tico. Los reguladores que no tengan efecto sobre el actuador se corrigen.
Esto es necesario para evitar los efectos de Windup y sus repercusiones negativas sobre el
comportamiento de regulaci√≥n y la conmutaci√≥n entre los reguladores.
A partir de la versi√≥n 1.1, PID_Temp soporta regulaciones de transici√≥n, pues el regulador
ofrece un procedimiento simplificado para corregir el regulador no activo: mediante las
variables OverwriteInitialOutputValue y PIDCtrl.PIDInit es posible preasignar la acci√≥n I del
regulador en el modo autom√°tico como si el algoritmo PID hubiera calculado PidOutputSum =
OverwriteInitialOutputValue para el valor de salida PID en el √∫ltimo ciclo. Para ello,
OverwriteInititalOutputValue se interconecta con el valor de salida PID del regulador que tenga
acceso en este momento al actuador. Ajustando el bit PIDCtrl.PIDInit se lanza la preasignaci√≥n
de la acci√≥n I, as√≠ como el reinicio del ciclo del regulador y el per√≠odo de PWM. El subsiguiente
c√°lculo del valor de salida PID en el ciclo actual se realiza bas√°ndose en la acci√≥n I
preasignada (e igualada para todos los reguladores), as√≠ como en la acci√≥n P e I del actual
error de regulaci√≥n. La acci√≥n D no est√° activa durante la llamada con PIDCtrl.PIDInit = TRUE
y, por tanto, no contribuye al valor de salida.
Este procedimiento garantiza que el c√°lculo del valor de salida PID actual y, con ello, la
decisi√≥n sobre qu√© regulador tiene acceso al actuador solo tengan lugar considerando el
estado actual del proceso y los par√°metros PI. As√≠ se evitan los efectos de Windup en los
reguladores no activos y, con ello, las decisiones err√≥neas de la l√≥gica de conmutaci√≥n.

Requisitos
‚óè PIDCtrl.PIDInit solo es efectivo si la acci√≥n I est√° activada (variables
Retain.CtrlParams.Heat.Ti y Retain.CtrlParams.Cool.Ti > 0.0).
‚óè Debe asignar PIDCtrl.PIDInit y OverwriteInitialOutputValue usted mismo en su programa
de usuario (ver ejemplo m√°s abajo). PID_Temp no realiza ning√∫n cambio autom√°tico en
estas variables.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

813

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
‚óè PIDCtrl.PIDInit solo es efectivo si PID_Temp se encuentra en el modo autom√°tico
(par√°metro State = 3).
‚óè Si es posible, seleccione el tiempo de muestreo del algoritmo PID (variables
Retain.CtrlParams.Heat.Cycle y Retain.CtrlParams.Cool.Cycle) de forma que sea id√©ntico
para todos los reguladores y llame todos los reguladores en el mismo OB de alarma c√≠clica.
De esta forma se asegurar√° de que la conmutaci√≥n no suceda dentro de un ciclo de
regulador o de un per√≠odo de PWM.
Nota
Adaptaci√≥n continua de los l√≠mites de los valores de salida
En lugar de la correcci√≥n activa de reguladores sin acceso al actuador aqu√≠ descrita, en otros
sistemas de regulador se realiza alternativamente una adaptaci√≥n continua de los l√≠mites de
los valores de salida.
Esto no es posible con PID_Temp, pues no se soporta el cambio de los l√≠mites de los valores
de salida en el modo autom√°tico.

Ejemplo: regulaci√≥n de una gran caldera
PID_Temp se utiliza para la regulaci√≥n de una gran caldera
El objetivo principal es regular la temperatura Input1. Para ello se utiliza el regulador
PID_Temp_1. Adem√°s, con el regulador de limitaci√≥n PID_Temp_2 debe mantenerse la
temperatura Input2 en un punto de medici√≥n adicional por debajo de un l√≠mite superior.
Las dos temperaturas se modifican a trav√©s de una √∫nica calefacci√≥n. El valor de salida del
regulador se corresponde con la potencia de calefacci√≥n.

Input1

PID_Temp_1

<
Input2

PID_Temp_2

La calefacci√≥n se acciona mediante el valor de salida modulado por ancho de impulso de
PID_Temp (par√°metro OutputHeat_PWM), escribiendo la variable de programa ActuatorInput.

814

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
La preasignaci√≥n de la consigna para la temperatura Input1 se realiza en el par√°metro
PID_Temp_1.Setpoint. El l√≠mite superior de temperatura para el punto de medici√≥n adicional
se preasigna como consigna en el par√°metro PID_Temp_2.Setpoint.
Input1

PID_Temp_1
Input

OutputHeat_PWM

Setpoint

PidOutputSum

1

ActuatorInput

0

PIDCtrl.PIDInit
OverwriteInitial
OutputValue

<

PID_Temp_2
Input

OutputHeat_PWM

Setpoint

PidOutputSum

1

0

PIDCtrl.PIDInit
OverwriteInitial
OutputValue

Input2

Ambos reguladores disponen √∫nicamente de una calefacci√≥n como actuador com√∫n. La l√≥gica
que decide qu√© regulador obtiene acceso al actuador se implementa aqu√≠ a trav√©s de una
selecci√≥n de m√≠nimo del valor de salida PID (en formato Real, par√°metro PidOutputSum).
Puesto que el valor de salida PID corresponde a la potencia de calefacci√≥n, el regulador
obtiene el control que requiere la menor potencia de calefacci√≥n.
En el funcionamiento normal de la instalaci√≥n, el valor real de la magnitud regulada principal
corresponde a la consigna. El regulador principal PID_Temp_1 se ha estabilizado en un valor
de salida PID estacionario PID_Temp_1.PidOutputSum. En el modo normal, el valor real del
regulador de limitaci√≥n Input2 est√° claramente por debajo del l√≠mite superior que se ha
preasignado como consigna para f√ºr PID_Temp_2. Por tanto, el regulador de limitaci√≥n debe
seguir aumentando la potencia de calefacci√≥n para aumentar su valor real, es decir, calcular√°
un valor de salida PID PID_Temp_2.PidOutputSum que ser√° superior al del regulador principal
PID_Temp_1.PidOutputSum. Por tanto, la selecci√≥n m√≠nima de la l√≥gica de conmutaci√≥n sigue
permitiendo al regulador principal PID_Temp_1 el acceso al actuador. Adem√°s, mediante las
asignaciones PID_Temp_2.OverwriteInitialOutputValue = PID_Temp_1.PidOutputSum y
PID_Temp_2.PIDCtrl.PIDInit = TRUE se garantiza que se corregir√° PID_Temp_2.
Si ahora Input2 se acerca al l√≠mite superior o lo rebasa, por ejemplo, debido a una aver√≠a, el
regulador de limitaci√≥n PID_Temp_2 calcular√° un valor de salida PID menor para seguir
moderando la potencia de calefacci√≥n y as√≠ reducir Input2. Si PID_Temp_2.PidOutputSum es
menor que PID_Temp_1.PidOutputSum, el regulador de limitaci√≥n PID_Temp_2 obtiene
acceso al actuador a trav√©s de la selecci√≥n de valor m√≠nimo y reduce la potencia de
calefacci√≥n. Mediante las asignaciones PID_Temp_1.OverwriteInitialOutputValue =
PID_Temp_2.PidOutputSum y PID_Temp_1.PIDCtrl.PIDInit = TRUE se garantiza que se
corregir√° PID_Temp_1.
La temperatura en el punto de medici√≥n adicional Input2 se reduce. La temperatura de la
magnitud regulada principal Input1 cae tambi√©n y ya no puede mantenerse en la consigna.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

815

Regulaci√≥n PID
3.3 Regulaci√≥n PID (S7-1200, S7-1500)
Si la aver√≠a deja de producirse, Input2 seguir√° cayendo, y la potencia de calefacci√≥n del
regulador de limitaci√≥n volver√° a aumentar. En cuanto el regulador principal calcula una
potencia de calefacci√≥n menor como valor de salida, la instalaci√≥n regresa al modo normal, de
forma que el regulador principal PID_Temp_1 vuelve a obtener acceso al actuador. Este
ejemplo se puede implementar con el siguiente c√≥digo de programa SCL:
"PID_Temp_1"(Input := "Input1");
"PID_Temp_2"(Input := "Input2");
IF "PID_Temp_1".PidOutputSum <= "PID_Temp_2".PidOutputSum THEN
"ActuatorInput" := "PID_Temp_1".OutputHeat_PWM;
"PID_Temp_1".PIDCtrl.PIDInit := FALSE;
"PID_Temp_2".PIDCtrl.PIDInit := TRUE;
"PID_Temp_2".OverwriteInitialOutputValue := "PID_Temp_1".PidOutputSum;
ELSE
"ActuatorInput" := "PID_Temp_2".OutputHeat_PWM;
"PID_Temp_1".PIDCtrl.PIDInit := TRUE;
"PID_Temp_2".PIDCtrl.PIDInit := FALSE;
"PID_Temp_1".OverwriteInitialOutputValue := "PID_Temp_2".PidOutputSum;
END_IF;

3.3.3.7

Simulaci√≥n de PID_Temp con PLCSIM
Nota
Simulaci√≥n con PLCSIM
La simulaci√≥n de PID_Temp con PLCSIM para CPU S7-1200 no se soporta.
PID_Temp solo puede simularse con PLCSIM para CPU S7-1500.
En la simulaci√≥n con PLCSIM, el comportamiento temporal del PLC simulado no es id√©ntico al
de un PLC "aut√©ntico". El verdadero ciclo de un OB de alarma c√≠clica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "aut√©ntico".
En la configuraci√≥n est√°ndar, PID_Temp determina autom√°ticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_Temp con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
Esto provoca la cancelaci√≥n de las optimizaciones en curso.
La reacci√≥n en el modo autom√°tico depende del valor de la variable ActivateRecoverMode.
Para evitarlo, debe configurarse PID_Temp en la simulaci√≥n con PLCSIM del modo siguiente:
‚óè CycleTime.EnEstimation = FALSE
‚óè CycleTime.EnMonitoring = FALSE
‚óè CycleTime.Value: Asigne a estas variables el ciclo del OB de alarma c√≠clica que se debe
llamar en la unidad segundos.

816

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

3.4

Regulaci√≥n PID (S7-300, S7-400, S7-1500)

3.4.1

Utilizar funciones b√°sicas PID

3.4.1.1

CONT_C

Objeto tecnol√≥gico CONT_C
El objeto tecnol√≥gico CONT_C proporciona un regulador PID continuo para los modos
autom√°tico y manual. Equivale al bloque de datos de instancia de la instrucci√≥n CONT_C. La
instrucci√≥n PULSEGEN permite configurar un regulador de impulsos.
Los componentes proporcional, integrativo (INT) y diferencial (DIF) est√°n conectados en
paralelo y se pueden conectar o desconectar de forma independiente. Con ello se pueden
parametrizar los reguladores P, PI, PD y PID.
S7-1500
Todos los par√°metros y variables del objeto tecnol√≥gico son remanentes y, al efectuarse la
carga en el dispositivo, solo pueden modificarse si se carga CONT_C por completo.

Consulte tambi√©n
Vista general de los reguladores de software (P√°gina 661)
Agregar objetos tecnol√≥gicos (P√°gina 664)
Configurar objetos tecnol√≥gicos (P√°gina 665)
Cargar objetos tecnol√≥gicos en el dispositivo (P√°gina 667)

Configurar el error de regulaci√≥n CONT_C
Utilizar el valor real de periferia
Para utilizar el valor real en el formato de periferia en el par√°metro de entrada PV_PER,
proceda del siguiente modo:
1. Active la casilla de verificaci√≥n "Activar periferia".
2. Si existe el valor real como magnitud f√≠sica, introduzca el factor y el offset para la
normalizaci√≥n en porcentajes.
De este modo, el valor real se calcula seg√∫n la siguiente f√≥rmula:
PV = PV_PER √ó PV_FAC + PV_OFF

Utilizar el valor real interno
Para utilizar el valor real en el formato de coma flotante en el par√°metro de entrada PV_IN,
proceda del siguiente modo:
1. Desactive la casilla de verificaci√≥n "Activar periferia".
Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

817

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Error de regulaci√≥n
Ajuste un ancho de zona muerta seg√∫n los siguientes requisitos:
‚óè La se√±al del valor real tiene ruido.
‚óè La ganancia del regulador es alta.
‚óè La acci√≥n D est√° activada.
El nivel de ruido del valor real provoca, en este caso, fuertes variaciones de la variable
manipulada. La zona muerta suprime el nivel de ruido, cuando el estado del regulador es
estacionario. El ancho de zona muerta indica el tama√±o de la zona muerta. Con un ancho de
zona muerta de 0.0, la zona muerta se encuentra desactivada.

Configurar el algoritmo de regulaci√≥n CONT_C
General
Para averiguar qu√© acciones del algoritmo de regulaci√≥n est√°n activadas, proceda del
siguiente modo:
1. Seleccione una entrada de la lista "Estructura de regulador".
S√≥lo puede introducir los par√°metros necesarios para la estructura de regulaci√≥n
seleccionada.

Acci√≥n P
1. Si la estructura de regulador contiene una acci√≥n P, introduzca la "Ganancia proporcional".

Acci√≥n I
1. Si la estructura de regulador contiene una acci√≥n I, introduzca la "Tiempo de integraci√≥n".
2. Para asignar un valor de inicializaci√≥n a la acci√≥n I, active el bot√≥n de opci√≥n "Inicializar
acci√≥n I" e introduzca el valor de inicializaci√≥n.
3. Para ajustar la acci√≥n I permanentemente a este valor de inicializaci√≥n, active el bot√≥n de
opci√≥n "Detener acci√≥n I".

Acci√≥n D
1. Si la estructura del regulador contiene una acci√≥n D, introduzca el tiempo derivativo, la
ponderaci√≥n de la acci√≥n D y el tiempo de retardo.

818

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Configurar la variable manipulada CONT_C
General
Puede instroducir CONT_C en el modo manual o en el modo autom√°tico.
1. Para fijar una variable manipulado manual, active el bot√≥n de opci√≥n "Activar modo
manual".
Puede especificar una variable manipulado manual en el par√°metro de entrada MAN.

L√≠mites de la variable manipulada
La variable manipulada se limita hacia arriba o hacia abajo, para que s√≥lo pueda aceptar
valores v√°lidos. No puede desconectar la limitaci√≥n. Si se sobrepasan los l√≠mites, esto se
muestra mediante los par√°metros de salida QLMN_HLM y QLMN_LLM.
1. Introduzca un valor para el l√≠mite superior y el l√≠mite inferior de la variable manipulada.
Si la variable manipulada es una magnitud f√≠sica, las unidades para el l√≠mite superior y el
l√≠mite inferior de la variable manipulada deben coincidir.

Normalizaci√≥n
La variable manipulada se puede normalizar para la salida como valor en coma flotante y valor
de periferia mediante un factor y un offset, seg√∫n la siguiente f√≥rmula.
Variable manipulada normalizada = variable manipulada √ó factor + offset
Est√°n preseleccionados un factor de 1.0 y un offset de 0.0.
1. Introduzca un valor para factor y offset.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

819

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Programar regulador de impulsos
Con el regulador continuo CONT_C y el formador de impulsos PULSEGEN, es posible realizar
un regulador de valor fijo con salida de conmutaci√≥n para actuadores proporcionales. La figura
siguiente muestra el proceso de se√±ales del lazo de regulaci√≥n.
&217B&

38/6(*(1
/01

,19

4326B3
41(*B3

39B3(5

5HFRUULGRFRQVDOLGD
GHFRQPXWDFL¬µQ

El regulador continuo CONT_C forma la variable manipulada LMN que el formador de impulsos
PULSEGEN convierte en se√±ales de pausa de impulso QPOS_P o QNEG_P.

Poner en marcha CONT_C
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.

Procedimiento
Para determinar manualmente los par√°metros PID √≥ptimos, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. Introduzca par√°metros PID nuevos en los campos "P", "I", "D" y "Tiempo de retardo".
3. Haga clic en el grupo "Optimizaci√≥n" en el s√≠mbolo

"Enviar par√°metros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna" .
5. Introduzca otra consigna y haga clic en el grupo "Valores actuales", en el s√≠mbolo

.

6. En caso necesario, desactive la casilla de verificaci√≥n "Modo manual".
El regulador trabaja con los nuevos par√°metros PID y regula seg√∫n la nueva consigna.

820

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)
7. Compruebe la calidad de los par√°metros PID mediante los recorridos de la curva.
8. Repita los pasos del 2 hasta el 6, hasta que est√© satisfecho/a con el resultado de la
regulaci√≥n.

3.4.1.2

CONT_S

Objeto tecnol√≥gico CONT_S
El objeto tecnol√≥gico CONT_S pone a disposici√≥n un regulador paso a paso para elementos
finales de control con comportamiento integral y sirve para regular los procesos t√©cnicos de
temperatura con se√±ales binarias de salida de variable manipulada. El objeto tecnol√≥gico
corresponde al bloque de datos de instancia de la instrucci√≥n CONT_S. El modo de trabajo se
basa en el algoritmo de regulaci√≥n PI del regulador de muestreo. El regulador paso a paso
opera sin realimentaci√≥n de posici√≥n. Es posible elegir entre el modo manual y el autom√°tico.
S7-1500
Todos los par√°metros y variables del objeto tecnol√≥gico son remanentes y, al efectuarse la
carga en el dispositivo, solo pueden modificarse si se carga CONT_S por completo.

Consulte tambi√©n
Vista general de los reguladores de software (P√°gina 661)
Agregar objetos tecnol√≥gicos (P√°gina 664)
Configurar objetos tecnol√≥gicos (P√°gina 665)
Cargar objetos tecnol√≥gicos en el dispositivo (P√°gina 667)

Configurar el error de regulaci√≥n CONT_S
Utilizar el valor real de periferia
Para utilizar el valor real en el formato de periferia en el par√°metro de entrada PV_PER,
proceda del siguiente modo:
1. Active la casilla de verificaci√≥n "Activar periferia".
2. Si existe el valor real como magnitud f√≠sica, introduzca el factor y el offset para la
normalizaci√≥n en porcentajes.
De este modo, el valor real se calcula seg√∫n la siguiente f√≥rmula:
PV = PV_PER √ó PV_FAC + PV_OFF

Utilizar el valor real interno
Para utilizar el valor real en el formato de coma flotante en el par√°metro de entrada PV_IN,
proceda del siguiente modo:
1. Desactive la casilla de verificaci√≥n "Activar periferia".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

821

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Error de regulaci√≥n
Ajuste un ancho de zona muerta seg√∫n los siguientes requisitos:
‚óè La se√±al del valor real tiene ruido.
‚óè La ganancia del regulador es alta.
‚óè La acci√≥n D est√° activada.
La componente de ruido del valor real provoca, en este caso, fuertes variaciones de la variable
manipulada. La zona muerta suprime la componente de ruido cuando el estado del regulador
es estacionario. El ancho de zona muerta indica el tama√±o de la zona muerta. Con un ancho
de zona muerta de 0.0, la zona muerta se encuentra desactivada.

Configurar el algoritmo de regulaci√≥n CONT_S
Algoritmo PI
1. Introduzca la "Ganancia roporcional" para la acci√≥n P.
2. Introduzca el tiempo de integraci√≥n para la rapidez de respuesta de la acci√≥n I.
Con un tiempo de integraci√≥n de 0.0, la acci√≥n I se encuentra desactivada.

Configurar la variable manipulada CONT_S
General
Puede introducir CONT_S en el modo manual o en el modo autom√°tico.
1. Para fijar una variable manipulado manual, active el bot√≥n de opci√≥n "Activar modo
manual".
Especifique una variable manipulada manual en los par√°metros de entrada LMNUP y
LMNDN.

Generador de impulsos
1. Introduzca la duraci√≥n m√≠nima de impulso y la duraci√≥n m√≠nima de pausa.
Los valores deben ser mayores o iguales al tiempo de ciclo en el par√°metro de entrada
CYCLE. De esta manera, se reduce la frecuencia de maniobra.
2. Introduzca el tiempo de posicionamiento del motor.
El valor debe ser mayor o igual al tiempo de ciclo en el par√°metro de entrada CYCLE.

Poner en marcha CONT_S
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.

822

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Procedimiento
Para determinar manualmente los par√°metros PID √≥ptimos, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. Introduzca una nueva ganancia proporcional y un nuevo tiempo de integraci√≥n en los
campos "P" e "I".
3. Haga clic en el grupo "Optimizaci√≥n" en el s√≠mbolo

"Enviar par√°metros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna" .
5. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
s√≠mbolo .
6. En caso necesario, desactive la casilla de verificaci√≥n "Modo manual".
El regulador trabaja con los nuevos par√°metros y regula seg√∫n la nueva consigna.
7. Compruebe la calidad de los par√°metros PID mediante los recorridos de la curva.
8. Repita los pasos del 2 hasta el 6, hasta que est√© satisfecho/a con el resultado de la
regulaci√≥n.

3.4.1.3

TCONT_CP

Objeto tecnol√≥gico TCONT_CP
El objeto tecnol√≥gico TCONT_CP proporciona un regulador de temperatura continuo con
generador de impulsos. Equivale al bloque de datos instancia de la instrucci√≥n TCONT_CP. El
modo de trabajo se basa en el algoritmo de regulaci√≥n PID del regulador de muestreo. Es
posible elegir entre el modo manual y el autom√°tico.
La instrucci√≥n TCONT_CP calcula los par√°metros P, I y D para el sistema regulado de forma
aut√≥noma durante la "optimizaci√≥n inicial". Los par√°metros pueden optimizarse a√∫n m√°s a
trav√©s de una "optimizaci√≥n fina". Los par√°metros PID tambi√©n pueden determinarse
manualmente.
S7-1500
Todos los par√°metros y variables del objeto tecnol√≥gico son remanentes y, al efectuarse la
carga en el dispositivo, solo pueden modificarse si se carga TCONT_CP por completo.

Consulte tambi√©n
Vista general de los reguladores de software (P√°gina 661)
Agregar objetos tecnol√≥gicos (P√°gina 664)
Configurar objetos tecnol√≥gicos (P√°gina 665)
Cargar objetos tecnol√≥gicos en el dispositivo (P√°gina 667)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

823

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Configurar TCONT_CP
Error de regulaci√≥n
Utilizar el valor real de periferia
Para utilizar el par√°metro de entrada PV_PER, proceda del siguiente modo:
1. Seleccione la entrada "Periferia" en la lista "Origen".
2. Seleccione el "Tipo de sensor ".
Seg√∫n el tipo de sensor, el valor real se normaliza seg√∫n diferentes f√≥rmulas.
‚Äì Termopares
est√°ndar; PT100/NI100
PV = 0.1 √ó PV_PER √ó PV_FAC + PV_OFFS
‚Äì Climatiz.;
PT100/NI100
PV = 0.01 √ó PV_PER √ó PV_FAC + PV_OFFS
‚Äì Intensidad/tensi√≥n
PV = 100/27648 √ó PV_PER √ó PV_FAC + PV_OFFS
3. Introduzca factor y offset para la normalizaci√≥n del valor real de periferia.

Utilizar el valor real interno
Para utilizar el par√°metro de entrada PV_IN, proceda del siguiente modo:
1. Seleccione la entrada "Interno" en la lista "Origen".

Error de regulaci√≥n
Ajuste un ancho de zona muerta seg√∫n los siguientes requisitos:
‚óè La se√±al del valor real tiene ruido.
‚óè La ganancia del regulador es alta.
‚óè La acci√≥n D est√° activada.
La componente de ruido del valor real provoca, en este caso, fuertes variaciones de la variable
manipulada. La zona muerta suprime la componente de ruido cuando el estado del regulador
es estacionario. El ancho de zona muerta indica el tama√±o de la zona muerta. Con un ancho
de zona muerta de 0.0, la zona muerta se encuentra desactivada.

824

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Algoritmo de regulaci√≥n
General
1. Introduzca el "Tiempo de muestreo del algoritmo PID".
El tiempo de muestreo del regulador no deber√≠a exceder un 10 % del tiempo de integraci√≥n
del regulador (TI) calculado.
2. Si la estructura de regulador contiene una acci√≥n P, introduzca la "Ganancia proporcional".
Una ganancia proporcional negativa invierte el sentido de regulaci√≥n.

Acci√≥n P
En caso de modificaciones de la consigna, la acci√≥n P puede provocar sobreoscilaciones.
Mediante la ponderaci√≥n de la acci√≥n P se puede elegir con qu√© intensidad debe actuar la
acci√≥n P al cambiar la consigna. La atenuaci√≥n de la acci√≥n P se logra mediante una
compensaci√≥n en la acci√≥n I.
1. Para atenuar la acci√≥n P en caso de modificaciones de la consigna, introduzca la
"Ponderaci√≥n de la acci√≥n P".
‚Äì 1.0: Acci√≥n P completamente efectiva en caso de modificaci√≥n de la consigna
‚Äì 0.0: Acci√≥n P inefectiva en caso de modificaci√≥n de la consigna

Acci√≥n I
En caso de limitaci√≥n de la variable manipulada, la acci√≥n I se detiene. En caso de un error de
regulaci√≥n, que mueve la acci√≥n I en direcci√≥n al √°rea manipulada interna, la acci√≥n I vuelve
a activarse.
1. Si la estructura de regulador contiene una acci√≥n I, introduzca el "Tiempo de integraci√≥n".
Con un tiempo de integraci√≥n de 0.0, la acci√≥n I se encuentra desactivada.
2. Para asignar un valor de inicializaci√≥n a la acci√≥n I, active el bot√≥n de opci√≥n "Inicializar
acci√≥n I" e introduzca el "Valor de inicializaci√≥n".
En caso de reinicio o COM_RST = TRUE, la acci√≥n I se pone en este valor.

Acci√≥n D
1. Si la estructura del regulador contiene una acci√≥n D, introduzca el tiempo derivativo (TD) y
el coeficiente DT1 (D_F).
Si est√° conectada la acci√≥n D, deber√° cumplirse la siguiente ecuaci√≥n:
TD = 0.5 √ó CYCLE√ó D_F.
De ah√≠ se calcula el tiempo de retardo seg√∫n la f√≥rmula:
Tiempo de retardo = TD/D_F

Parametrizar el regulador PD con el punto de operaci√≥n
1. Introduzca el tiempo de integraci√≥n 0.0.
2. Active el bot√≥n de opci√≥n "Inicializar acci√≥n I".
3. Introduzca el punto de operaci√≥n como valor de inicializaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

825

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Parametrizar el regulador P con el punto de operaci√≥n
1. Parametrice un regulador PD con el punto de operaci√≥n.
2. Introduzca el tiempo derivativo 0.0.
La acci√≥n D se desactiva.

Zona de regulaci√≥n
La zona de regulaci√≥n limita el rango del error de regulaci√≥n. Si el error de regulaci√≥n se
encuentra fuera de este rango, se utilizan los l√≠mites de la variable manipulada.
Al entrar en la zona de regulaci√≥n, la acci√≥n D conectada provoca una reducci√≥n muy r√°pida
de la magnitud manipulada. Por lo tanto, la zona de regulaci√≥n s√≥lo es √∫til, cuando la acci√≥n D
est√° conectada. Sin zona de regulaci√≥n, principalmente s√≥lo la acci√≥n P que va disminuyendo
reducir√≠a la magnitud manipulada. La zona de regulaci√≥n provoca un r√©gimen transitorio r√°pido
sin sobreoscilaciones ni posteriores infraoscilaciones, en caso de que la magnitud manipulada
m√≠nima o m√°xima emitida est√© a mucha distancia de la magnitud manipulada necesaria para
el nuevo punto de operaci√≥n.
1. Active el bot√≥n de opci√≥n "Activar" en el grupo "Zona de regulaci√≥n".
2. Introduzca en el campo de entrada "Ancho" un valor que el valor real pueda desviarse de
la consigna por encima o por debajo.

Variable manipulada del regulador continuo
L√≠mites de la variable manipulada
La variable manipulada se limita hacia arriba o hacia abajo, para que s√≥lo pueda aceptar
valores v√°lidos. No puede desconectar la limitaci√≥n. Si se sobrepasan los l√≠mites, esto se
muestra mediante los par√°metros de salida QLMN_HLM y QLMN_LLM.
1. Introduzca un valor para el l√≠mite superior y el l√≠mite inferior de la variable manipulada.

Normalizaci√≥n
La variable manipulada se puede normalizar para la salida como valor de punto flotante y valor
de periferia mediante un factor y un offset, seg√∫n la siguiente f√≥rmula.
Variable manipulada normalizada = variable manipulada √ó factor + offset
Hay preasignado un factor de 1.0 y un offset de 0.0.
1. Introduzca un valor para factor y offset.

Generador de impulsos
Para un regulador continuo, el generador de impulsos debe estar desconectado.
1. Desactive el bot√≥n de opci√≥n "Activar" en el grupo "Generador de impulsos".

826

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Variable manipulada del regulador de impulsos
Generador de impulsos
La variable manipulada an√°logo (LmnN) se puede emitir con modulaci√≥n de ancho de impulsos
en el par√°metro de salida QPULSE como un intervalor de impulsos.
Para utilizar el generador de impulsos, proceda del siguiente modo:
1. Active el bot√≥n de opci√≥n "Activar" en el grupo "Generador de impulsos".
2. Introduzca el "Tiempo de muestreo del generador de impulsos", la "Duraci√≥n m√≠nima de
impulso/de pausa" y la "Duraci√≥n del per√≠odo".
Los siguientes gr√°ficos aclaran la relaci√≥n entre el "Tiempo de muestreo del generador de
impulsos" (CYCLE_P), la "Duraci√≥n m√≠nima de impulso/de pausa" (P_B_TM) y la "Duraci√≥n del
per√≠odo" (PER_TM):
/PQ1








W


438/6(




W
&<&/(B3
3(5B70

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

827

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)



3B%B70
3(5B70

3B%B70
3(5B70

3(5B70

Tiempo de muestreo del generador de impulsos
El tiempo de muestreo del generador de impulsos debe coincidir con el per√≠odo del OB de
alarma c√≠clica invocante. La duraci√≥n del impulso generado es simpre un m√∫ltiplo entero de
este valor. Para una resoluci√≥n exacta y adecuada de la variable manipulada, deber√≠a darse
la siguiente relaci√≥n:
CYCLE_P ‚â§ PER_TM/50

Duraci√≥n m√≠nima de impulso/de pausa
Mediante la duraci√≥n m√≠nima de impulso/de pausa se evitan los tiempos de conexi√≥n o
desconexi√≥n cortos en el elemento final de control. Un impulso menor que P_B_TM se suprime.
Se recomienda los valores P_B_TM ‚â§ 0.1 √ó PER_TM.

Duraci√≥n del per√≠odo
La duraci√≥n del per√≠odo no deber√≠a exceder un 20 % del tiempo de integraci√≥n del regulador
(TI) calculado:
PER_TM ‚â§ TI/5

Ejemplo de los efectos de los par√°metros CYCLE_P, CYCLE y PER_TM:
Duraci√≥n del per√≠odo PER_TM = 10 s
Tiempo de muestreo del algoritmo PID CYCLE = 1 s
Tiempo de muestreo del generador de impulsos CYCLE_P = 100 ms.

828

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)
Cada segundo se calcula una nueva variable manipulada, cada 100 ms se produce la
comparaci√≥n de la variable manipulada con la longitud de impulso o de pausa emitida hasta
entonces.
‚óè Si se emite un impulso, existen 2 posibilidades:
‚Äì La variable manipulada calculada es mayor que la longitud de impulso/PER_TM
existente hasta entonces. En tal caso, el impulso se prolonga.
‚Äì La variable manipulada calculada es menor o igual que la longitud de impulso/PER_TM
existente hasta entonces. En tal caso, no se emiten m√°s se√±ales de impulso.
‚óè Si no se emite ning√∫n impulso, tambi√©n caben 2 posibilidades:
‚Äì El valor (100 % - variable manipulada calculada) es mayor que la longitud de pausa/
PER_TM existente hasta entonces. En tal caso, la pausa se prolonga.
‚Äì El valor (100 % - variable manipulada calculada) es menor o igual que la longitud de
pausa/ PER_TM existente hasta entonces. En tal caso se emite una se√±al de impulso.

Poner en marcha TCONT_CP
Optimizaci√≥n de TCONT_CP
Posibilidades de utilizaci√≥n
La optimizaci√≥n del regulador puede utilizarse exclusivamente en los procesos de refrigeraci√≥n
o en los procesos de calefacci√≥n del tipo de sistema I. Pero tambi√©n para los sistemas de orden
superior del tipo II o III, puede utilizar el bloque.
Los par√°metros PI/PID se calculan y ajustan autom√°ticamente. El dise√±o de regulador se ha
concebido con un comportamiento √≥ptimo frente a perturbaciones. Los par√°metros "de efecto
brusco" resultantes conducir√≠an a sobreoscilaciones de entre el 10 % y el 40 % de la amplitud
del escal√≥n, en caso de escalones de consigna.

Fases de la optimizaci√≥n del regulador
Durante la optimizaci√≥n del regulador se ejecutan fases individuales, que se indican en el
par√°metro PHASE .

PHASE = 0
No se produce ninguna optimizaci√≥n. TCONT_CP funciona en modo autom√°tico o manual.
Mientras PHASE = 0, el sistema regulado debe cumplir con los requisitos para una
optimizaci√≥n.
Al final de la optimizaci√≥n, TCONT_CP vuelve a cambiar en PHASE = 0.

PHASE = 1
TCONT_CP se encuentra en disposici√≥n de optimizaci√≥n. PHASE = 1 s√≥lo puede iniciarse, si
se cumplen las condiciones para una optimizaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

829

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)
Mientras PHASE = 1 se calculan los siguientes valores:
‚óè Ruido del valor real NOISE_PV
‚óè Subida inicial PVDT0
‚óè Valor medio de la variable manipulada
‚óè Tiempo de muestreo algoritmo PID CYCLE
‚óè Tiempo de muestreo del generador de impulsos CYCLE_P

PHASE = 2
En la fase 2 se busca el punto de inversi√≥n del valor real con una variable manipulada
constante. El procedimiento impide que el punto de inversi√≥n se detecte demasiado pronto
debido al ruido de PV:
En el regulador de impulsos se toma el promedio de PV mediante N ciclos de impulsos y,
seguidamente, se pone a disposici√≥n de la parte del regulador. En la parte del regulador se
realiza otra promediaci√≥n: al principio, dicha promediaci√≥n est√° inactiva, es decir, s√≥lo se toma
el promedio de 1 ciclo cada vez. En cuanto el ruido excede una medida determinada, se
duplica el n√∫mero de ciclos.
Se determinan el per√≠odo y la amplitud del ruido. La b√∫squeda del punto de inversi√≥n no se
cancela y se sale de la fase 2 hasta que el gradiente es siempre menor que el ascenso m√°ximo
durante el per√≠odo estimado. Sin embargo, TU y T_P_INF se calculan en el punto de inversi√≥n
real.
De todas formas, la optimizaci√≥n no finaliza hasta que se cumplen las dos condiciones
siguientes:
1. El valor real est√° m√°s alejado del punto de inversi√≥n que 2*NOISE_PV.
2. El valor real ha excedido el punto de inversi√≥n en un 20 %.
Nota
En caso de excitaci√≥n mediante escal√≥n de consigna, la optimizaci√≥n finaliza a muy tardar
cuando el valor real ha pasado el 75 % del escal√≥n de consigna (SP_INT-PV0) (v√©ase
abajo).

PHASE = 3, 4, 5
Las fases 3, 4 y 5 duran cada una 1 ciclo.
En la fase 3, se guardan los par√°metros PI/PID v√°lidos antes de la optimizaci√≥n y se calculan
los par√°metros del proceso.
En la fase 4, se calculan los nuevos par√°metros PI/PID.
En la fase 5, se calcula la nueva variable manipulada y se fija seg√∫n el sistema regulado.

830

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

PHASE = 7
El tipo de sistema se comprueba en la fase 7, ya que TCONT_CP siempre cambia al modo
autom√°tico tras la optmizaci√≥n. El modo autom√°tico se inicia con LMN = LMN0 +
0.75*TUN_DLMN como variable manipulada. La comprobaci√≥n del tipo de sistema tiene
lugar en modo autom√°tico con los par√°metros del regulador que se acaban de calcular y
finaliza, a lo sumo, 0,35*TA (tiempo de compensaci√≥n) tras el punto de inversi√≥n. Si el orden
de proceso se diferencia considerablemente del valor estimado, vuelven a calcularse los
par√°metros del regulador y aumenta en 1 el STATUS_D, de lo contrario, los par√°metros del
regulador se mantienen sin cambios.
La operaci√≥n de optimizaci√≥n est√° terminada y TCONT_CP vuelve a encontrarse en PHASE
= 0. El par√°metro STATUS_H indica si la optimizaci√≥n ha finalizado correctamente.

Cancelaci√≥n anticipada de la optimizaci√≥n
En las fases 1, 2 √≥ 3 se puede cancelar la optimizaci√≥n sin que se calculen par√°metros nuevos,
restableciendo TUN_ON = FALSE. El regulador se inicia en modo autom√°tico con LMN
= LMN0 + TUN_DLMN. Si el regulador se encontraba en modo manual antes de la
optimizaci√≥n, se emitir√° la variable manipulada manual antigua.
Si en la fase 4, 5 √≥ 7 se interrumpe la optimizaci√≥n por medio de TUN_ON = FALSE, se
conservan los par√°metros del regulador ya calculados.

Condiciones para una optimizaci√≥n
R√©gimen transitorio
El proceso debe presentar un r√©gimen transitorio estable, con retardo y asint√≥tico.
Despu√©s de un escal√≥n de la magnitud manipulada, el valor real debe pasar a un estado
estacionario. Con ello se excluyen procesos que presentan un comportamiento oscilante
incluso sin regulaci√≥n, as√≠ como sistemas regulados sin compensaci√≥n (integrador en el
proceso regulado).

ADVERTENCIA
Pueden producirse da√±os materiales considerables, lesiones f√≠sicas graves o incluso la
muerte.
Durante una optimizaci√≥n, el par√°metro MAN_ON no tiene efecto alguno. Por lo tanto, la
variable manipulada o el valor real pueden tomar valores no deseados, o tambi√©n extremos.
La variable manipulada se especifica mediante optimizaci√≥n. Para interrumpir la
optimizaci√≥n, primero hay ajustar TUN_ON = FALSE. De este modo, MAN_ON vuelve a tener
efecto.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

831

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Consolidaci√≥n de un estado inicial cuasi-estacionario (fase 0)
Si la magnitud regulada presentara oscilaciones de baja frecuencia, por ejemplo, debido a
unos par√°metros del regulador incorrectos, habr√° que controlar el regulador manualmente
antes de iniciar la optimizaci√≥n y esperar a que desaparezcan dichas oscilaciones. Como
alternativa, tambi√©n se puede conmutar a un regulador PI de efecto "suave" (ganancia del lazo
peque√±a, tiempo de integraci√≥n largo).
Ahora deber√° esperar hasta que se alcance el estado estacionario, es decir, hasta que el valor
real y la variable manipulada sean estacionarios. Tambi√©n est√° permitido un r√©gimen
transitorio asint√≥tico o un desplazamiento lento del valor real (estado cuasi-estacionario,
consulte la figura siguiente). La magnitud manipulada debe ser constante u oscilar alrededor
de un valor medio constante.
Nota
Evite modificar la magnitud manipulada justo antes del inicio de la optimizaci√≥n. La magnitud
manipulada tambi√©n se puede modificar de manera involuntaria mediante el establecimiento
de las condiciones de ensayo (p. ej., cerrar una puerta abierta). Si este fuera el caso, deber√°
esperar como m√≠nimo a que el valor real experimente de nuevo un r√©gimen transitorio de forma
asint√≥tica a un estado estacionario No obstante, conseguir√° mejores par√°metros de
regulaci√≥n, si espera hasta que el proceso de r√©gimen transitorio haya finalizado
completamente.

En la siguiente figura, se muestra el r√©gimen transitorio al estado estacionario:

832

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

39

9DORUUHDO

(VWDGRQRHVWDFLRQDULR
QRSHUPLWLGR

3+$6( 

3+$6( 

(VWDGRFXDVLHVWDFLRQDULR
D¬ºQSHUPLWLGR

(VPHMRUXQHVWDGR
HVWDFLRQDULRHVWDELOL]DGR

39

W

/01

9DORUPDQLSXODGR
,PSXOVRGHOYDORUPDQLSXODGR
/01

W

Linealidad y zona de trabajo
El proceso debe presentar un comportamiento lineal en la zona de trabajo. Un comportamiento
no lineal se produce, p. ej., con un cambio de un estado de agregaci√≥n. La optimizaci√≥n debe
tener lugar en una parte lineal de la zona de trabajo.
Esto significa que, tanto para la optimizaci√≥n como para el modo de regulaci√≥n normal, los
efectos no lineales dentro de dicha zona de trabajo deben ser despreciablemente peque√±os.
Sin embargo, es posible optimizar de nuevo el proceso cambiando el punto de operaci√≥n si la
optimizaci√≥n vuelve a ejecutarse en un entorno reducido del nuevo punto de operaci√≥n y si
durante la optimizaci√≥n no se pasa por la no linealidad.
Si se conocen determinadas no linealidades est√°ticas (p. ej. caracter√≠sticas de v√°lvulas), es
aconsejable compensarlas previamente con una l√≠nea poligonal para linealizar el
comportamiento del proceso.

Perturbaciones en procesos de temperatura
Las perturbaciones, como la transferencia de calor a zonas colindantes, no deben influir
excesivamente en el proceso global de temperatura. As√≠, p. ej., al optimizar las zonas de una
extrusionadora, todas las zonas deben calentarse simult√°neamente.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

833

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Posibilidades de la optimizaci√≥n
Existen las siguientes posibilidades de optimizaci√≥n:
‚óè Optimizaci√≥n inicial
‚óè Optimizaci√≥n fina
‚óè Optimizaci√≥n fina manual en modo de regulaci√≥n

Optimizaci√≥n inicial
Durante esta optimizaci√≥n, el punto de operaci√≥n del estado fr√≠o se pone en marcha a trav√©s
de un escal√≥n de consigna.
Con TUN_ON = TRUE, cree la disposici√≥n de optimizaci√≥n. El regulador cambia de PHASE = 0
a PHASE = 1.
3+$6( 

3+$6( 

3+$6(


3+$6( 

3+$6( 

63

r&
/01

(VWDGRGH
SURFHVR
HQFDOLHQWH
SXQWRGH
WUDEDMR

39
781B'/01
3XQWRGH
LQYHUVL¬µQ

/01

(VWDGRGH
SURFHVRHQ
IU¬ØR
W
781B21
W

La variable manipulada de la optimizaci√≥n (LMN0 + TUN_DLMN) se aplica mediante
modificaci√≥n de la consigna (transici√≥n fase 1 -> 2). La consigna no es efectiva hasta que se
alcanza el punto de inversi√≥n (s√≥lo entonces se conmutar√° al modo Autom√°tico).
El delta de la excitaci√≥n manipulada (TUN_DLMN) se define de acuerdo con la modificaci√≥n
admisible del valor real bajo responsabilidad propia. El signo de TUN_DLMN debe estar en
concordancia con la modificaci√≥n prevista del valor real (observar el sentido de regulaci√≥n).
El escal√≥n de consigna y TUN_DLMN deben estar coordinados. Un TUN_DLMN demasiado
grande conlleva el peligro de que el punto de inversi√≥n no est√© dentro del 75 % del escal√≥n de
consigna.
Sin embargo, TUN_DLMN debe ser lo suficientemente grande como para que el valor real
alcance como m√≠nimo el 22 % del escal√≥n de consigna. En caso contrario, el procedimiento
permanece en modo Optimizaci√≥n (fase 2).

834

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)
Soluci√≥n: reduzca la consigna durante la b√∫squeda del punto de inversi√≥n.
Nota
En procesos con un fuerte retardo, es aconsejable definir para la optimizaci√≥n una consigna de
destino un poco m√°s baja que el punto de operaci√≥n deseado y observar con detenimiento los
bits de estado y el PV (peligro de sobreoscilaciones).
Optimizaci√≥n √∫nicamente en el rango lineal:
Determinados sistemas regulados (p. ej. calderas de fusi√≥n de zinc o magnesio) pasan por un
rango no lineal poco antes del punto de operaci√≥n (modificaci√≥n del estado de agregaci√≥n).
Si se selecciona con habilidad el escal√≥n de consigna es posible limitar la optimizaci√≥n al rango
lineal. Si el valor real ha pasado el 75 % del escal√≥n de consigna (SP_INT-PV0) se finaliza la
optimizaci√≥n.
Paralelamente, TUN_DLMN deber√≠a reducirse hasta que el punto de inversi√≥n se encuentre
con seguridad antes de alcanzar el 75 % del escal√≥n de consigna.

Optimizaci√≥n fina
Durante esta optimizaci√≥n, el proceso se excita, en caso de una consigna constante, mediante
un salto de la variable manipulada.
r&
/01

3+$6( 

3+$6( 

3+$6(


3+$6( 

3+$6( 

39
9DORUUHDOGHOSXQWRGHWUDEDMR

3XQWRGH
LQYHUVL¬µQ
63

781B'/01

/01

VHGHVDFWLYD
DXWRP¬£WLFDPHQWH

781B21

9DORUPDQLSXODGRGHOSXQWRGHWUDEDMR

W

W
781B67
W

La variable manipulada de la optimizaci√≥n (LMN0 + TUN_DLMN) se aplica mediante activaci√≥n
del bit de inicio TUN_ST (transici√≥n fase 1 -> 2). Si se modifica la consigna, la nueva consigna
no es efectiva hasta que no se alcanza el punto de inversi√≥n (s√≥lo entonces se conmuta al
modo Autom√°tico).
Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

835

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)
El delta de la excitaci√≥n manipulada (TUN_DLMN) se define de acuerdo con la modificaci√≥n
admisible del valor real bajo responsabilidad propia. El signo de TUN_DLMN debe estar en
concordancia con la modificaci√≥n prevista del valor real (observar el sentido de regulaci√≥n).
ATENCI√ìN
Si la excitaci√≥n se realiza mediante TUN_ST no se produce ninguna desconexi√≥n de
seguridad al 75 %. La optimizaci√≥n finaliza cuando se alcanza el punto de inversi√≥n. Sin
embargo, en procesos con ruidos es posible que se sobrepase claramente el punto de
inversi√≥n.

Optimizaci√≥n fina manual en modo de regulaci√≥n
Para conseguir un comportamiento de consigna sin sobreoscilaciones, pueden tomarse las
medidas siguientes:
‚óè Adaptar la zona de regulaci√≥n
‚óè Optimizar el comportamiento de referencia
‚óè Amortiguar los par√°metros de regulaci√≥n
‚óè Modificar los par√°metros de regulaci√≥n

Resultado de la optimizaci√≥n
La cifra de la izquierda de STATUS_H muestra el estado de optimizaci√≥n
STATUS_H

Resultado

0

Se han encontrado par√°metros del regulador predeterminados, ninguno o nin‚Äê
guno nuevo.

10000

Se han encontrado par√°metros del regulador adecuados

2xxxx

Se han encontrado par√°metros del regulador superiores a los valores estimados;
compruebe el comportamiento de regulaci√≥n, lea el aviso de diagn√≥stico STA‚Äê
TUS_H y repita la optimizaci√≥n del regulador.

3xxxx

Se han producido errores de operador; lea el aviso de diagn√≥stico STATUS_H y
repita la optimizaci√≥n del regulador.

En la fase 1 ya se verificaron los tiempos de muestreo CYCLE y CYCLE_P.
Los siguientes par√°metros de regulaci√≥n se actualizan en TCONT_CP:
‚óè P (ganancia proporcional GAIN)
‚óè I (tiempo de integraci√≥n TI)
‚óè D (tiempo de acci√≥n derivativa TD)
‚óè Ponderaci√≥n de la acci√≥n P PFAC_SP
‚óè Coeficiente DT1 (D_F)
‚óè Zona de regulaci√≥n on/off CONZ_ON
‚óè Ancho de la zona de regulaci√≥n CON_ZONE

836

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)
La zona de regulaci√≥n s√≥lo se activa si el tipo de sistema es adecuado (I y II) y si el regulador
PID est√° activado (CONZ_ON = TRUE).
En funci√≥n de PID_ON se regula con el regulador PI o PID. Los par√°metros antiguos del
regulador se guardan y pueden volver a activarse mediante UNDO_PAR. Adem√°s, se guarda
un juego de par√°metros PI y PID en las estructuras PI_CON y PID_CON. Mediante LOAD_PID
y la activaci√≥n correspondiente de PID_ON, tambi√©n es posible cambiar m√°s adelante entre los
par√°metros optimizados PI o PID.

Optimizaci√≥n paralela de canales del regulador
Zonas colindantes (fuerte acoplamiento t√©rmico)
Si hay dos o m√°s reguladores que regulan la temperatura, p. ej. en una placa (es decir, dos
calefacciones y dos valores reales medidos con un fuerte acoplamiento t√©rmico), proceda del
siguiente modo:
1. Combine l√≥gicamente con la operaci√≥n O las dos salidas QTUN_RUN.
2. Interconecte cada una de las dos entradas TUN_KEEP con una de las salidas del elemento
O.
3. Inicie los dos reguladores predefiniendo simult√°neamente un escal√≥n de consigna o
activando simult√°neamente TUN_ST.
La figura siguiente representa la optimizaci√≥n paralela de canales del regulador:

7&217B&3'%B7&217B&3
781B.((3
4781B581

7&217B&3'%B7&217B&3
781B.((3

‡∏∏

4781B581

Ventaja:
Ambos reguladores emiten LMN0 + TUN_DLMN hasta que los dos han salido de la fase 2. De
este modo se impide que el regulador que finaliza primero la optimizaci√≥n falsifique el resultado
de optimizaci√≥n del otro regulador al modificar su magnitud manipulada.
ATENCI√ìN
Cuando se alcanza el 75 % del escal√≥n de consigna se sale de la fase 2, con lo que se
desactiva la salida QTUN_RUN. Sin embargo, el modo Autom√°tico no empezar√° hasta que
TUN_KEEP sea 0.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

837

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Zonas colindantes (acoplamiento t√©rmico d√©bil)
Por norma general, deber√≠a optimizarse del mismo modo que se regula posteriormente. Si en
modo productivo las zonas se desplazan conjuntamente en paralelo, de modo que las
diferencias de temperatura entre las distintas zonas se mantienen iguales, durante la
optimizaci√≥n deber√≠a aumentarse el nivel de temperatura de las zonas colindantes en
correspondencia.
Las diferencias de temperatura al principio del ensayo no son relevantes, porque se
compensan mediante una calefacci√≥n inicial adecuada (‚Üí subida inicial = 0).

S√≠ntomas de error y soluciones posibles
Interceptar errores de operador
Error de operador

STAUTS y medida

Comentario

Activaci√≥n simult√°nea de
TUN_ON y escal√≥n de consigna
o TUN_ST

Transici√≥n a la fase 1 pero
sin inicio de optimizaci√≥n.

La modificaci√≥n de la consigna se
anula. De este modo se impide que
el regulador se regule a la nueva
consigna y abandone innecesaria‚Äê
mente el punto de operaci√≥n esta‚Äê
cionario.

‚óè SP_INT = SPantiguo o
‚óè TUN_ST = FALSE

TUN_DLMN < 5 % efectivo (fin de STATUS_H = 30002
la fase 1)
‚óè Transici√≥n a la fase 0
‚óè TUN_ON = FALSE
‚óè SP = SPantiguo

Cancelaci√≥n de la optimizaci√≥n.
La modificaci√≥n de la consigna se
anula. De este modo se impide que
el regulador se regule a la nueva
consigna y abandone innecesaria‚Äê
mente el punto de operaci√≥n esta‚Äê
cionario.

Punto de inversi√≥n no alcanzado (s√≥lo en caso de excitaci√≥n mediante escal√≥n de consigna)
La optimizaci√≥n finaliza como muy tarde cuando el valor real ha pasado el 75 % del escal√≥n de
consigna (SP_INT-PV0). Esto se notifica mediante "Punto de inversi√≥n no alcanzado" en
STATUS_H (2xx2x).
Siempre rige la consigna que est√° ajustada en cada momento. As√≠ pues, si se reduce la
consigna, es posible que la optimizaci√≥n finalice anticipadamente.
En casos de procesos de temperatura t√≠picos, suele bastar con cancelar la optimizaci√≥n al 75
% del escal√≥n de consigna para impedir sobreoscilaciones. Sin embargo, hay que tomar
precauciones, especialmente en procesos con un retardo considerable(TU/TA > 0.1, tipo III).
Si la excitaci√≥n manipulada es demasiado fuerte en comparaci√≥n con el escal√≥n de consigna,
el valor real tendr√° muchas sobreoscilaciones (hasta el factor 3).
Si, en procesos de orden superior, el punto de inversi√≥n sigue muy alejado una vez alcanzado
el 75 % del escal√≥n de consigna, hay una sobreoscilaci√≥n clara. Adem√°s, los par√°metros del
regulados son demasiado rigurosos. En este caso, aten√∫e los par√°metros del regulador o
repita el ensayo.
La figura siguiente representa la sobreoscilaci√≥n del valor real en caso de excitaci√≥n
demasiado fuerte (tipo de sistema III):

838

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)
3+$6( 

3+$6( 

3+$6( 

r&
/01

3+$6( 

3+$6( 

/01
/01781B'/01
781B'/01

39TXHUHVXOWDU¬ØDVL
HO/01QRKD
FDPELDGR

3XQWRGHLQYHUVL¬µQ
39

(VWDGRGHSURFHVR
HQFDOLHQWH SXQWRGH
WUDEDMR

63
63

(VWDGRGH
SURFHVRHQIU¬ØR

W
781B21
W

En procesos de temperatura t√≠picos, una cancelaci√≥n justo ante de alcanzar el punto de
inversi√≥n no es cr√≠tica respecto de los par√°metros del regulador.
Si repite el ensayo, reduzca TUN_DLMN o aumente el escal√≥n de consigna.
Principio: la variable manipulada de optimizaci√≥n debe concordar con el escal√≥n de consigna.

Error de estimaci√≥n con tiempo de retardo u orden
El tiempo de retardo (STATUS_H = 2x1xx o 2x3xx) o el orden (STATUS_H = 21xxx o 22xxx)
no ha podido registrarse correctamente. Se sigue trabajando con un valor estimado que puede
provocar par√°metros no √≥ptimos del regulador.
Repita la optimizaci√≥n y aseg√∫rese de que no se produzcan perturbaciones en el valor real.
Nota
El caso especial de un proceso PT1 puro tambi√©n se se√±ala con STATUS_H = 2x1xx (TU <=
3*CYCLE). En este caso no es necesario repetir el ensayo. Aten√∫e los par√°metros del
regulador si la regulaci√≥n oscila.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

839

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Calidad de las se√±ales medidas (ruido medido, perturbaciones de baja frecuencia)
El resultado de la optimizaci√≥n puede verse entorpecido por ruidos medidos o perturbaciones
de baja frecuencia. En tal caso, considere lo siguiente:
‚óè En caso de ruidos medidos, seleccione una frecuencia de muestreo m√°s bien alta que baja.
Dentro de un per√≠odo de ruido, el valor real debe muestrearse como m√≠nimo dos veces. En
el modo Impulso sirve de ayuda la filtraci√≥n integrada del valor medio. De todas formas,
requiere que el valor PV se transfiera a la instrucci√≥n en el ciclo de impulso r√°pido. La
medida de ruido no deber√≠a exceder un 5 % del cambio de se√±al √∫til.
‚óè Las perturbaciones de alta frecuencia ya no pueden eliminarse por filtraci√≥n mediante
TCONT_CP. Dichas perturbaciones ya deber√≠an haberse filtrado en el sensor de medici√≥n
para impedir el efecto aliasing.
La figura siguiente representa el efecto aliasing con un tiempo de muestreo demasiado
grande:
;

W

‚óè En caso de perturbaciones de baja frecuencia es relativamente f√°cil garantizar una tasa de
muestreo lo suficientemente elevada. Por otro lado, el TCONT_CP debe generar una se√±al
medida homog√©nea a causa de un intervalo elevado de la filtraci√≥n de valores medios. Una
filtraci√≥n de valores medios debe abarcar como m√≠nimo dos per√≠odos de ruido. De esta
forma, dentro del bloque se generan r√°pidamente tiempos de muestreo m√°s grandes, de
modo que se merma la precisi√≥n de la optimizaci√≥n. Una precisi√≥n suficiente se garantiza
con un m√≠nimo de 40 per√≠odos de ruido hasta el punto de inversi√≥n.
Medidas posibles al repetir el ensayo:
aumentar TUN_DLMN.

840

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Sobreoscilaci√≥n
En las situaciones siguientes pueden producirse sobreoscilaciones:
Situaci√≥n

Causa

Fin de la optimi‚Äê ‚óè Excitaci√≥n mediante un cambio
zaci√≥n
demasiado brusco de la variable
manipulada en comparaci√≥n con el
escal√≥n de consigna (v√©ase arriba).
‚óè Regulador PI activado mediante
PID_ON = FALSE.
Optimizaci√≥n
en fase 7

Soluci√≥n
‚óè Aumentar el escal√≥n de consigna o
reducir el escal√≥n de la variable
manipulada
‚óè Si el proceso admite un regulador
PID, inicie la optimizaci√≥n con
PID_ON = TRUE.

Primero se han determinado par√°metros m√°s suaves para el regulador (tipo de sis‚Äê
tema III) que pueden provocar sobreosci‚Äê
laciones en la fase 7.

Modo de regula‚Äê Regulador PI y con PFAC_SP = 1.0 para el Si el proceso admite un regulador PID,
ci√≥n
tipo de sistema I.
inicie la optimizaci√≥n con PID_ON =
TRUE.

Realizar una optimizaci√≥n inicial
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.

Procedimiento
Para determinar los par√°metros PID √≥ptimos en la primera puesta en servicio, proceda del
siguiente modo:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimizaci√≥n inicial".
TCONT_CP est√° preparado para la optimizaci√≥n.
3. En el campo "Escal√≥n de la variable manipulada" indique el valor en el que debe
aumentarse la variable manipulada.
4. En el campo "Consigna", indique una consigna. El escal√≥n de la variable manipulada se
hace efectivo s√≥lo con una nueva consigna.
"Iniciar optimizaci√≥n".
5. Haga clic en el s√≠mbolo
Se inicia la optimizaci√≥n inicial. Se muestra el estado de la optimizaci√≥n.

Realizar optimizaci√≥n fina
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

841

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Procedimiento
Para determinar los par√°metros PID √≥ptimos en el punto de operaci√≥n, proceda del siguiente
modo:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimizaci√≥n fina".
TCONT_CP est√° disponible para la optimizaci√≥n.
3. En el campo "Escal√≥n de la variable manipulada" indique el valor en el que debe
aumentarse la variable manipulada.
4. Haga clic en el s√≠mbolo
"Iniciar optimizaci√≥n".
Se inicia la optimizaci√≥n fina. Se muestra el estado de la optimizaci√≥n.

Cancelaci√≥n de la optimizaci√≥n inicial o fina
Para cerrar una optimizaci√≥n inicial o fina, haga clic en el s√≠mbolo

"Detener optimizaci√≥n".

Si los par√°metros PID no se han calculado y almacenado todav√≠a, TCONT_CP se inicia en el
modo autom√°tico con LMN = LMN0 + TUN_DLMN. Si el regulador se encontraba en modo
manual antes de la optimizaci√≥n, se emitir√° la variable manipulada manual antigua.
Si los par√°metros PID calculados ya est√°n almacenados, TCONT_CP se inicia en el modo
autom√°tico y funciona entonces con los par√°metros PID calculados hasta la fecha.

Optimizaci√≥n fina manual en modo de regulaci√≥n
Para conseguir un comportamiento de consigna sin sobreoscilaciones pueden tomarse las
medidas siguientes:

Adaptar la zona de regulaci√≥n
En la optimizaci√≥n se determina una zona de regulaci√≥n CON_ZONE del TCONT_CP y se
activa con un tipo de sistema adecuado (I y II) y un regulador PID (CONZ_ON = TRUE). En el
modo de regulaci√≥n es posible modificar la zona de regulaci√≥n o desactivarla completamente
(con CONZ_ON = FALSE).
Nota
Si se activa la zona de regulaci√≥n en procesos de orden superior (tipo III), no suele suponer
ninguna ventaja, porque en este caso la zona de regulaci√≥n es mayor que el rango de
regulaci√≥n asequible con el 100 % de la magnitud manipulada. Tampoco es ventajoso activar
la zona de regulaci√≥n para regulador PI.
Antes de activar a mano la zona de regulaci√≥n, aseg√∫rese de no ajustar un ancho de zona de
regulaci√≥n demasiado peque√±o. Si el ancho de la zona de regulaci√≥n ajustado fuera
insuficiente, se producir√°n oscilaciones en las curvas de la magnitud manipulada y del valor
real.

842

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Atenuar continuamente la respuesta de regulaci√≥n con PFAC_SP
La respuesta de regulaci√≥n se aten√∫a con el par√°metro PFAC_SP. Dicho par√°metro determina
qu√© proporci√≥n de la acci√≥n P ser√° efectiva en casos de escalones de consigna.
PFAC_SP se predetermina a 0.8 mediante la optimizaci√≥n, independientemente del tipo de
sistema; seguidamente puede modificarse el valor. Para limitar las sobreoscilaciones a un 2 %
aproximadamente en caso de escalones de consigna (si los dem√°s par√°metros del regulador
son correctos), son suficientes los valores siguientes para PFAC_SP:
Tipo de sistema I

Tipo de sistema II

Tipo de sistema III

Proceso de temperatura t√≠‚Äê
pico

Rango de transici√≥n

Proceso de temperatura de orden supe‚Äê
rior

PI

0.8

0.82

0.8

PID

0.6

0.75

0.96

Ajuste el factor predeterminado (0.8), especialmente en los casos siguientes:
‚óè Tipo de sistema I con PID (0.8 -> 0.6): los escalones de consigna dentro de la zona de
regulaci√≥n provocan todav√≠a un 18 % de sobreoscilaciones con PFAC_SP = 0.8.
‚óè Tipo de sistema III con PID (0.8 -> 0.96): los escalones de consigna con PFAC_SP = 0.8 se
amortiguan demasiado. Se regala un tiempo de ajuste claro.

Amortiguar los par√°metros de regulaci√≥n
Si en el lazo de regulaci√≥n cerrado se producen oscilaciones o si hay sobreoscilaciones
despu√©s de escalones de consigna, es posible girar hacia atr√°s la ganancia del regulador
GAIN (p. ej. al 80 % del valor original) y aumentar el tiempo de acci√≥n integral TI (p. ej. al 150
% del valor original). Si la magnitud manipulada anal√≥gica del regulador continuo se convierte
en se√±ales manipuladas binarias con un generador de impulsos, es posible que aparezcan
peque√±as oscilaciones continuas debido a los efectos de cuantificaci√≥n. Dichas oscilaciones
se eliminan aumentando la zona muerta del regulador DEADB_W.

Modificar los par√°metros de regulaci√≥n
Para modificar los par√°metros del regulador, proceda del siguiente modo:
1. Guarde los par√°metros actuales con SAVE_PAR.
2. Modifique los par√°metros.
3. Pruebe el comportamiento de regulaci√≥n.
Si los par√°metros nuevos fueran peores que los antiguos, vuelva a ajustar los par√°metros
antiguos con UNDO_PAR.

Realizar una optimizaci√≥n fina manual
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

843

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Procedimiento
Para determinar manualmente los par√°metros PID √≥ptimos, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Manual".
3. Introduzca los nuevos par√°metros PID.
4. Haga clic en el grupo "Optimizaci√≥n" en el s√≠mbolo

"Enviar par√°metros a la CPU".

5. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna" .
6. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
s√≠mbolo .
7. En caso necesario, desactive la casilla de verificaci√≥n "Modo manual".
El regulador trabaja con los nuevos par√°metros PID y regula seg√∫n la nueva consigna.
8. Compruebe la calidad de los par√°metros PID mediante los recorridos de la curva.
9. Repita los pasos del 3 hasta el 8, hasta que est√© satisfecho/a con el resultado de la
regulaci√≥n.

3.4.1.4

TCONT_S

Objeto tecnol√≥gico TCONT_S
El objeto tecnol√≥gico TCONT_S pone a disposici√≥n un regulador paso a paso para elementos
finales de control con comportamiento integrador y sirve para regular los procesos t√©cnicos de
temperatura con se√±ales binarias de salida de variable manipulada. El objeto tecnol√≥gico
corresponde al bloque de datos de instancia de la instrucci√≥n TCONT_S. El modo de trabajo
se basa en el algoritmo de regulaci√≥n PI del regulador de muestreo. El regulador paso a paso
opera sin realimentaci√≥n de posici√≥n. Es posible elegir entre el modo manual y el autom√°tico.
S7-1500
Todos los par√°metros y variables del objeto tecnol√≥gico son remanentes y, al efectuarse la
carga en el dispositivo, solo pueden modificarse si se carga TCONT_S por completo.

Consulte tambi√©n
Vista general de los reguladores de software (P√°gina 661)
Agregar objetos tecnol√≥gicos (P√°gina 664)
Configurar objetos tecnol√≥gicos (P√°gina 665)
Cargar objetos tecnol√≥gicos en el dispositivo (P√°gina 667)

844

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Configurar el error de regulaci√≥n de TCONT_S
Utilizar el valor real de periferia
Para utilizar el par√°metro de entrada PV_PER, proceda del siguiente modo:
1. Seleccione la entrada "Periferia" en la lista "Origen".
2. Seleccione el "Tipo de sensor".
Seg√∫n el tipo de sensor, el valor real se normaliza seg√∫n diferentes f√≥rmulas.
‚Äì Termopares
est√°ndar; PT100/NI100
PV = 0.1 √ó PV_PER √ó PV_FAC + PV_OFFS
‚Äì Climatiz.;
PT100/NI100
PV = 0.01 √ó PV_PER √ó PV_FAC + PV_OFFS
‚Äì Intensidad/tensi√≥n
PV = 100/27648 √ó PV_PER √ó PV_FAC + PV_OFFS
3. Introduzca factor y offset para la normalizaci√≥n del valor real de periferia.

Utilizar el valor real interno
Para utilizar el par√°metro de entrada PV_IN, proceda del siguiente modo:
1. Seleccione la entrada "Interno" en la lista "Origen".

Error de regulaci√≥n
Ajuste un ancho de zona muerta seg√∫n los siguientes requisitos:
‚óè La se√±al del valor real tiene ruido.
‚óè La ganancia del regulador es alta.
‚óè La acci√≥n D est√° activada.
La componente de ruido del valor real provoca, en este caso, fuertes variaciones de la variable
manipulada. La zona muerta suprime la componente de ruido cuando el estado del regulador
es estacionario. El ancho de zona muerta indica el tama√±o de la zona muerta. Con un ancho
de zona muerta de 0.0, la zona muerta se encuentra desactivada.

Configurar el algoritmo de regulaci√≥n TCONT_S
General
1. Introduzca el "Tiempo de muestreo del algoritmo PID".
El tiempo de muestreo del regulador no deber√≠a exceder un 10 % del tiempo de integraci√≥n
del regulador (TI) calculado.
2. Si la estructura de regulador contiene una acci√≥n P, introduzca la "Ganancia proporcional".
Una ganancia proporcional negativa invierte el sentido de regulaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

845

Regulaci√≥n PID
3.4 Regulaci√≥n PID (S7-300, S7-400, S7-1500)

Acci√≥n P
En caso de modificaciones de la consigna, la acci√≥n P puede provocar sobreoscilaciones.
Mediante la ponderaci√≥n de la acci√≥n P se puede elegir con qu√© intensidad debe actuar la
acci√≥n P al cambiar la consigna. La atenuaci√≥n de la acci√≥n P se logra mediante una
compensaci√≥n en la acci√≥n I.
1. Para atenuar la acci√≥n P en caso de modificaciones de la consigna, introduzca la
"Ponderaci√≥n de la acci√≥n P".
‚Äì 1.0: Acci√≥n P completamente efectiva en caso de modificaci√≥n de la consigna
‚Äì 0.0: Acci√≥n P inefectiva en caso de modificaci√≥n de la consigna

Acci√≥n I
1. Si la estructura de regulador contiene una acci√≥n I, introduzca el "Tiempo de integraci√≥n".
Con un tiempo de integraci√≥n de 0.0, la acci√≥n I se encuentra desactivada.

Configurar la variable manipulada TCONT_S
Generador de impulsos
1. Introduzca la duraci√≥n m√≠nima de impulso y la duraci√≥n m√≠nima de pausa.
Los valores deben ser mayores o iguales al tiempo de ciclo en el par√°metro de entrada
CYCLE. De esta manera, se reduce la frecuencia de maniobra.
2. Introduzca el tiempo de posicionamiento del motor.
El valor debe ser mayor o igual al tiempo de ciclo en el par√°metro de entrada CYCLE.

Poner en marcha TCONT_S
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.

Procedimiento
Para determinar manualmente los par√°metros PID √≥ptimos, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. Introduzca los par√°metros PID nuevos en los campos "P", "I", "D" y ponderaci√≥n de la
acci√≥n P.
3. Haga clic en el grupo "Optimizaci√≥n" en el s√≠mbolo

"Enviar par√°metros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna" .
5. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
s√≠mbolo .

846

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
6. En caso necesario, desactive la casilla de verificaci√≥n "Modo manual".
El regulador trabaja con los nuevos par√°metros y regula seg√∫n la nueva consigna.
7. Compruebe la calidad de los par√°metros PID mediante los recorridos de la curva.
8. Repita los pasos del 2 hasta el 6, hasta que est√© satisfecho/a con el resultado de la
regulaci√≥n.

3.5

Regulaci√≥n PID (S7-300, S7-400)

3.5.1

Utilizar control PID est√°ndar

3.5.1.1

Utilizar PID_CP

Objeto tecnol√≥gico PID_CP
El objeto tecnol√≥gico PID_CP ofrece un regulador PID continuo para los modos autom√°tico y
manual. Equivale al bloque de datos de instancia de la instrucci√≥n PID_CP. Es posible
configurar los siguientes reguladores:
‚óè Regulaci√≥n de valor fijo con regulador P, PI, PD y PID continuo
‚óè Regulaci√≥n de valor fijo con control anticipativo
‚óè Regulaci√≥n en cascada
‚óè Regulaci√≥n de relaci√≥n de dos lazos
‚óè Regulaci√≥n de mezcla
Se configuran las funciones siguientes del objeto tecnol√≥gico PID_CP:
‚óè Normalizaci√≥n de la se√±al de valor real
‚óè Supresi√≥n de oscilaciones de alta frecuencia en la rama del valor real mediante filtrado
(retardando) la se√±al del valor real.
‚óè Linealizaci√≥n de funciones cuadr√°ticas del valor real (regulaci√≥n de caudal con sensores de
presi√≥n diferencial)
‚óè Llamada de "funciones propias" en la rama del valor real
‚óè Vigilancia de rebase por exceso de los l√≠mites de alarma y advertencia del valor real
‚óè Vigilancia de la velocidad de cambio del valor real
‚óè Modificaci√≥n de la consigna por generador ramp soak
‚óè Normalizaci√≥n de una se√±al de consigna externa en las regulaciones de relaci√≥n
‚óè Llamada de "funciones propias" en la rama de la consigna
‚óè Limitaci√≥n de la velocidad de cambio de la consigna
‚óè Limitaci√≥n de los valores absolutos de la consigna

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

847

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
‚óè Filtrado de la se√±al de error de regulaci√≥n por una zona muerta
‚óè Vigilancia de rebase por exceso de los l√≠mites de alarma y advertencia del error de
regulaci√≥n
‚óè Acciones P, I y D activables individualmente
‚óè Efecto P y D opcional en la rama de realimentaci√≥n del regulador.
‚óè Control anticipativo
‚óè Control de la variable manipulada en modo manual desde una programadora o un
dispositivo HMI
‚óè Llamada de "funciones propias" en la rama de la variable manipulada
‚óè Limitaci√≥n de la velocidad de cambio de la variable manipulada
‚óè Limitaci√≥n de los valores absolutos de la variable manipulada
‚óè Normalizaci√≥n de la variable manipulada
‚óè Modulaci√≥n de ancho de impulsos para reguladores de impulsos

C√°lculo de error de regulaci√≥n
Valor real
Normalizaci√≥n (PV_NORM)
Mediante la casilla de verificaci√≥n "Activar periferia" se especifica la magnitud de entrada
anal√≥gica que se normaliza a la unidad f√≠sica del valor real.
‚óè Activada: la magnitud de entrada es el valor real de periferia (PV_PER)
‚óè Desactivada: la magnitud de entrada es el valor real interno (PV_IN)
Para definir la recta de normalizaci√≥n de forma un√≠voca, defina los cuatro par√°metros
siguientes:
‚óè entrada arriba (NM_PIHR)
‚óè entrada abajo (NM_PILR)
‚óè salida arriba (NM_PVHR)
‚óè salida abajo (NM_PVLR)
Los par√°metros se prestablecen seg√∫n el tipo de sensor.
El valor real se calcula con la f√≥rmula siguiente a partir del respectivo valor de entrada PV_PER
o PV_IN:
MP4 = (PV_PER - NM_PILR) √ó (NM_PVHR - NM_PVLR) / (NM_PIHR - NM_PILR) + NM_PVLR
O bien:
MP4 = (PV_IN - NM_PILR) √ó (NM_PVHR - NM_PVLR) / (NM_PIHR - NM_PILR) + NM_PVLR

848

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
03
10B39+5

10B39/5

10B3,/5

39B3(5
39B,1

10B3,+5

El valor real se emite en la variable est√°tica MP4.
No se limitan valores ni se comprueban par√°metros. Si se introduce el mismo valor para la
entrada arriba y la entrada abajo, seg√∫n las f√≥rmulas anteriores se puede producir una divisi√≥n
por cero. Esto no se considera en la instrucci√≥n.

Funciones de filtro
Filtrar magnitud regulada (LAG1ST)
Para filtrar se√±ales de proceso con oscilaciones r√°pidas superpuestas (Noise) se utiliza un
elemento de retardo de primer orden en la rama del valor real. Esta funci√≥n aten√∫a en mayor
o menor grado la magnitud regulada anal√≥gica en funci√≥n de la constante de tiempo ajustada
(PV_TMLAG). De ese modo se suprimen de forma efectiva las se√±ales perturbadoras. Sin
embargo, con esta medida tambi√©n se aumenta en general la constante de tiempo de todo el
lazo de regulaci√≥n, de modo que la regulaci√≥n es m√°s lenta.
El efecto atenuador se consigue con un algoritmo de retardo de 1er orden.
La respuesta al escal√≥n en el rango de tiempo es:
outv(t) = MP4(0) (1 - e -t/PV_TMLAG)
RXWY

03 
RXWY W

W
39B70/$*

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

 39B70/$*

849

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

MP4(0)

la altura del escal√≥n del valor real en la entrada

outv(t)

la magnitud de salida

PV_TMLAG

la constante de tiempo de retardo

t

Tiempo

Filtrado del valor real
Si el filtrado del valor real (LAG1STON = FALSE) no est√° activado, la entrada de periferia
(PV_PER) o la entrada interna (PV_IN) se aplican sin retardo en la rama del valor real.

Tiempo de retardo
El par√°metro de entrada PV_TMLAG determina el tiempo de retardo para el valor real. Todo el
rango de valores es admisible.
Si PV_TMLAG ‚â§ 0.5 * CYCLE ya no act√∫a ning√∫n retardo.
Se requiere un tiempo de muestreo (CYCLE) de menos de una quinta parte del tiempo de
retardo para obtener un comportamiento de retardo aproximadamente equivalente al
comportamiento anal√≥gico.

Calcular ra√≠z cuadrada (SQRT)
La funci√≥n "C√°lculo de la ra√≠z cuadrada" (SQRT) permite linealizar la magnitud regulada. Si el
valor real proporcionado por un enc√≥der est√° presente como magnitud f√≠sica en relaci√≥n
cuadr√°tica con la magnitud de proceso medida, el desarrollo de la magnitud regulada debe
linealizarse antes de su procesamiento en el regulador.
La se√±al de medici√≥n siempre debe linealizarse extrayendo la ra√≠z cuadrada si se realizan
mediciones de caudal con diafragmas o tubos de Venturi, etc. La presi√≥n diferencial medida
(presi√≥n efectiva) es as√≠ proporcional al cuadrado del caudal.
A trav√©s de la se√±al de entrada SQRT_ON = TRUE se activa la funci√≥n de ra√≠z cuadrada en la
rama de valor real. El algoritmo de la funci√≥n de ra√≠z cuadrada es el siguiente:
outv = SQRT (MP5) √ó (SQRT_HR ‚Äì SQRT_LR) / 10.0 + SQRT_LR
outv es el valor de salida normalizado de la funci√≥n de ra√≠z cuadrada (caudal f√≠sico).
Esta f√≥rmula presupone que el valor de entrada de la ra√≠z est√° normalizado a un rango
num√©rico entre 0 y 100. En la normalizaci√≥n del valor real deben parametrizarse el "Rango de
medida superior" y el "Rango de medida inferior" a 100.0 y 0.0, respectivamente. La ra√≠z de
este valor da como resultado un rango de medida entre 0 y 10. Este rango se normaliza
mediante el l√≠mite superior (SQRT_HR) y el l√≠mite inferior del rango de medida f√≠sico
(SQRT_LR).

850

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
RXWY

6457B+5

6457B/5
03




Ejemplo de normalizaci√≥n
El valor de entrada PV_IN del regulador es la presi√≥n diferencial en mbar:
Principio del rango de medida
NM_PILR

Fin del rango de medida
NM_PIHR

Ejemplo de valores de PV_IN

20,0 mbar

200,0 mbar

150,0 mbar

Con la funci√≥n de normalizaci√≥n PV_NORM se calcula la presi√≥n diferencial normalizada,
seleccionando NM_PVHR = 100.0 y NM_PVLR = 0.0:
MP4

=
=
=

(PV_IN - NM_PILR) * (NM_PVHR - NM_PVLR) /
(NM_PIHR - NM_PILR) + NM_PVLR
(PV_IN - 20.0 mbar) * (100.0 - 0.0) /
(200.0 mbar - 20.0 mbar) + 0.0
(PV_IN - 20.0 mbar) * 100 / 180.0 mbar

Valor inicial de MP4

Valor final de MP4

Ejemplo de valores de MP4

0.0

100.0

72.222

En este ejemplo no se utiliza ning√∫n filtrado y, por lo tanto, rige lo siguiente: MP5 = MP4.
Para la ra√≠z de la presi√≥n diferencial normalizada MP5 resulta:
Valor inicial tras la ra√≠z

Valor final tras la ra√≠z

Ejemplo de valores de
SQRT(MP5)

0.0

10.0

8.498

Para el valor de salida normalizado outv de la funci√≥n de ra√≠z (caudal f√≠sico) sigue con
SQRT_HR = 20000.0 m3/h und SQRT_LR = 0.0 m3/h:
outv

=
=
=

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

SQRT(MP5) * (SQRT_HR - SQRT_LR) / 10.0 + SQRT_LR
SQRT(MP5) * (20000.0 m3/h - 0.0 m3/h) / 10.0 + 0.0 m3/h
2000.0 m3/h * SQRT(MP5)

851

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Principio del rango de medida
outv

Fin del rango de medida outv

Ejemplo de valores de outv

0,0 m3/h

20000,0 m3/h

16996,732 m3/h

Llamada de FC en la rama de valor real (PVFC)
La inserci√≥n de una funci√≥n espec√≠fica de usuario en la rama de valor real permite someter la
magnitud regulada a un tratamiento de se√±al antes de su procesamiento en el regulador (p. ej.
un retardo de se√±al o linealizaci√≥n).

Llamar una funci√≥n
Para insertar una funci√≥n espec√≠fica de usuario en la rama del valor real, active "Activar
llamada de FC" (PVFC_ON). En el campo de entrada "N√∫mero de FC" (PVFC_NBR) se indica
el n√∫mero de la funci√≥n utilizada. El regulador ejecuta una llamada de la funci√≥n. En ella no se
suministran valores a los par√°metros de entrada y salida de la funci√≥n de usuario. La
transferencia de datos debe programarla el usuario en su funci√≥n.
El valor de salida de la funci√≥n puede observarse en la variable est√°tica MP6.
Nota
No se comprueba si una funci√≥n est√° disponible. Si la funci√≥n no est√° disponible, la CPU pasa
a STOP con un error interno de sistema.

Alarma
Vigilar los l√≠mites del valor real (PV_ALARM)
Si se rebasan por exceso o defecto determinados valores de las magnitudes del proceso
(como velocidad, presi√≥n, nivel de llenado, temperatura, etc.), en las regulaciones pueden
producirse estados no permitidos de proceso o instalaci√≥n. En estos casos se aplica la
vigilancia de los l√≠mites del valor real (PV_ALARM) para controlar si el valor real rebasa el
rango de servicio admisible por exceso o por defecto. Los rebases de l√≠mite se registran y
notifican a fin de activar una respuesta adecuada.
Nota
La vigilancia de los l√≠mites del valor real no puede desactivarse. El rebase por exceso de los
l√≠mites configurados se notifica siempre.
La vigilancia de los l√≠mites del valor real (PV_ALARM) vigila la magnitud regulada PV(t) en
funci√≥n de cuatro l√≠mites predefinibles en dos zonas de tolerancia. Cuando los l√≠mites se
alcanzan o rebasan, la funci√≥n notifica "Advertencia" en el primer l√≠mite y "Alarma" en el
segundo.

852

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Valores l√≠mite
Los valores num√©ricos de los l√≠mites se ajustan en los par√°metros de entrada para
"Advertencia" y "Alarma". Si el valor real (PV) rebasa estos l√≠mites por exceso o defecto, se
activan los bits de aviso de salida correspondientes para la alarma superior (QPVH_ALM), la
advertencia superior (QPVH_WRN), la advertencia inferior (QPVL_WRN) y la alarma inferior
(QPVL_ALM).
Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
QPVH_ALM

QPVH_WRN

QPVL_WRN

QPVL_ALM

si:

y:

TRUE

TRUE

FALSE

FALSE

PV ‚Üó

PV ‚â• PVH_ALM

PV ‚Üò

PV ‚â• PVH_ALM - PV_HYS

PV ‚Üó

PV ‚â• PVH_WRN

PV ‚Üò

PV ‚â• PVH_WRN - PV_HYS

PV ‚Üò

PV ‚â§ PVL_WRN

PV ‚Üó

PV ‚â§ PVL_WRN + PV_HYS

PV ‚Üò

PV ‚â§ PVL_ALM

PV ‚Üó

PV ‚â§ PVL_ALM + PV_HYS

FALSE

TRUE

FALSE

FALSE

FALSE

FALSE

FALSE
TRUE

FALSE
FALSE

TRUE

TRUE

Para que el bloque funcione de manera eficiente debe aplicarse lo siguiente:
alarma superior < advertencia superior < advertencia inferior < alarma inferior
39 W

39

39B+<6

39+B$/0
39+B:51




39/B:51
39/B$/0
W

439+B$/0
439+B:51
439/B:51
439/B$/0

‚ë†
‚ë°

1. banda de tolerancia
2. banda de tolerancia

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

853

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Hist√©resis
Para impedir que los bits de aviso "centelleen" con cambios muy peque√±os de la magnitud de
entrada o con errores de redondeo, se ajusta una hist√©resis (diferencia de desactivaci√≥n)
PV_HYS. La magnitud regulada debe superar la hist√©resis antes de que los bits de aviso se
desactiven.

Vigilar la velocidad de cambio del valor real (ROCALARM)
Si el cambio de la magnitud de proceso (p. ej. velocidad, presi√≥n, nivel de llenado, temperatura,
etc.) es demasiado elevada, en las regulaciones pueden producirse estados no permitidos de
proceso o instalaci√≥n. En estos casos se aplica la vigilancia de la velocidad de cambio del valor
real (ROCALARM) para controlar si el valor real rebasa por exceso o por defecto una velocidad
de cambio admisible. Los rebases de l√≠mite se registran y notifican a fin de activar una
respuesta adecuada.
Nota
La vigilancia de la velocidad de cambio del valor real (ROCALARM) no puede desactivarse. El
rebase por exceso de los l√≠mites configurados se notifica siempre.
La funci√≥n ROCALARM vigila la magnitud regulada PV(t) respecto a l√≠mites admisibles de
velocidad de cambio, los cuales pueden ajustarse de forma diferente seg√∫n el signo
correspondiente.
Los valores num√©ricos de las pendientes l√≠mite se ajustan en los par√°metros de entrada
"Rampa de subida m√°xima" y "Rampa de bajada m√°xima" en el rango positivo y negativo de
la magnitud regulada. Las pendientes se refieren a la subida o bajada en porcentaje por
segundo. Si la velocidad de cambio de la magnitud regulada supera estos l√≠mites, se activan
los bits de aviso de salida correspondientes QPVURLMP ... QPVDRLMN.
39

39 W
3985/0B3
39'5/0B3
39'5/0B1
3985/0B1

W

3985/0B1

43985/0B3
439'5/0B3
439'5/0B1
43985/0B1

854

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
La identificaci√≥n de los par√°metros de las rampas se realiza seg√∫n el siguiente esquema:
Par√°metro

Cambio de PV

Rampa de subida m√°xima en el
rango positivo (PVURLM_P)

PV > 0 y |PV| ascendente

Rampa de bajada m√°xima en el
rango positivo (PVDRLM_P)

PV > 0 y |PV| descendente

Rampa de subida m√°xima en el
rango negativo (PVURLM_N)

PV < 0 y |PV| ascendente

Rampa de bajada m√°xima en el
rango negativo (PVDRLM_N)

PV < 0 y |PV| descendente

Consigna
Definir la consigna
Seleccione un origen para la consigna. Las posibilidades son las siguientes:
‚óè Consigna interna
El par√°metro de entrada SP_INT se utiliza como consigna
‚óè Generador de consigna
El par√°metro de entrada SP_INT se utiliza como consigna y puede aumentarse o
disminuirse mediante las variables est√°ticas SPUP y SPDN.
‚óè Generador ramp soak
El par√°metro de entrada SP_INT se utiliza como consigna y puede modificarse siguiendo
un perfil predefinido.
‚óè Consigna externa
En los reguladores de mezcla, relaci√≥n y cascada se utiliza el par√°metro de entrada
SP_EXT como consigna. La consigna externa puede normalizarse.
En el par√°metro de salida SP se muestra la consigna efectiva.

Generador de consigna (SP_GEN)
La consigna interna SP_INT se aumenta o disminuye progresivamente utilizando los
interruptores SPUP y SPDN. El valor modificado puede observarse en MP1. Se tienen en
cuenta los l√≠mites configurados de la consigna.

Repercusi√≥n de los interruptores SPUP y SPDN
Para poder realizar un cambio graduado finamente, el regulador debe tener un tiempo de
muestreo de 100 ms como m√°ximo.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

855

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
La velocidad de cambio de la magnitud de salida depende de la duraci√≥n de pulsaci√≥n de los
interruptores SPUP y SPDN as√≠ como de los l√≠mites ajustados de acuerdo con la relaci√≥n
siguiente:
‚óè durante los primeros 3 segundos despu√©s de activar SPUP o SPDN rige:
doutv/dt = (SP_HLM - SP_LLM) / 100 s
‚óè a continuaci√≥n
doutv/dt = (SP_HLM - SP_LLM) / 10 s
RXWY
63B+/0

V
W
V

V

63B//0

6383

63'1

W
V
W

Con un tiempo de muestreo de 100 ms y un rango de consigna de -100,0 a 100,0, la consigna
cambia en 0,2 por ciclo en los tres primeros segundos, por ejemplo. Si SPUP permanece en
TRUE durante m√°s de 3 segundos, la velocidad de cambio aumenta a diez veces el valor, en
este caso a 2 por ciclo.

Arranque y funcionamiento del generador de consigna
‚óè Durante el rearranque la salida outv se pone a 0.0.
‚óè Al activar el generador de consigna (SPGEN_ON = TRUE), en la salida outv se muestra
primero el valor de se√±al SPFC_IN. Por este motivo, la conmutaci√≥n al generador de
consigna desde otro modo de operaci√≥n se produce siempre suavemente. Mientras los
interruptores SPUP y SPDN (teclas arriba y abajo) no se activan, SPFC_IN permanece en
la salida.

856

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Par√°metros de la funci√≥n SP_GEN
El par√°metro de salida outv es un par√°metro impl√≠cito. Este puede observarse en la
herramienta de configuraci√≥n mediante el punto de medici√≥n MP1.
Par√°metro

Significado

Rango admisible

SPFC_IN

Consigna de la entrada de FC

Rango t√©cnico

SP_INT

Consigna interna

Rango t√©cnico

63B*(1

63*(1B21 %22/

)$/6(

6383

%22/

)$/6(

63'1

%22/

)$/6(

63B+/0

5($/



63B//0

5($/




63)&B,1

5($/



RXWY




63B,17

Figura 3-1

5($/

03

5($/





Esquema funcional y par√°metros del generador de consigna

Generador ramp soak (RMP_SOAK)
Si la consigna SP_INT debe cambiar por s√≠ misma en funci√≥n del tiempo, p. ej. en la regulaci√≥n
de procesos conforme a un programa de temperatura controlado por tiempo, es posible
hacerlo configurando un perfil y activando el generador ramp soak. El cambio de la consigna
se calcula a partir de segmentos con un m√°ximo de 256 nodos.
Nota
La funci√≥n del bloque no comprueba si existe un DB global con el n√∫mero "DB_NBR" ni
tampoco si el par√°metro "N√∫mero de nodos" NBR_PTS coincide con la longitud del DB. Si la
parametrizaci√≥n es incorrecta, la CPU cambia al estado STOP con un error de sistema interno.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

857

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Funcionamiento del generador ramp soak
El generador ramp soak proporciona una funci√≥n de la magnitud de salida outv que se ejecuta
de acuerdo con una programaci√≥n determinada. El desarrollo del perfil se define con una serie
de nodos en un bloque de datos global DB_RMPSK con los valores de tiempo PI[i].TMV y los
correspondientes valores de salida PI[i].OUTV.
‚óè PID-CP
AUTOHOTSPOT no est√° incluido en la librer√≠a. Debe crear usted mismo este bloque de
datos global.
‚óè PID-ES
AUTOHOTSPOT no est√° incluido en la librer√≠a. Debe crear usted mismo este bloque de
datos global.
La figura siguiente muestra un perfil con 6 nodos.
RXWY
3,>@2879
3,>@2879




RXWY W

3,>@2879
3,>@2879








3,>@709

W
3,>@709

3,>@2879 
3,>@2879
3,>@709

3,>@709
3,>@709

3,>@709

3,>@709

PV

Para el √∫ltimo nodo n, el valor de tiempo PI[n].TMV = 0 ms. El tiempo de procesamiento de un
perfil se calcula partiendo del valor inicial y descendiendo hasta cero.
PI[i].TMV indica los intervalos entre nodo y nodo. Entre los nodos se interpola de acuerdo con
la funci√≥n siguiente:
RXWY W  3,>Q@2879

56B70
3,>Q@709

3,>Q@28793,>Q@2879 

0 ‚â§ n ‚â§ (NBR_PTS - 1)
1RGR

3,>@2879
3,>@709

RXWY

1RGR

3XQWRLQLFLDO

3,>@2879
3,>@709

3,>@2879
3,>@709

3,>@709

3,>@709

3,>@709
W

858

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Nota
Nota
Al interpolar la curva de evoluci√≥n entre los nodos, es posible que el valor de salida se
mantenga temporalmente fijo si resulta que el tiempo de muestreo CYCLE es muy peque√±o
con respecto al tiempo entre los nodos PI[n].TMV. El generador ramp soak no puede linealizar
curvas planas debido a la precisi√≥n de c√°lculo de la CPU. Si la curva es demasiado plana, el
valor de salida permanece por un tiempo en el nodo correspondiente y, pasado cierto tiempo,
se integra en el pr√≥ximo nodo con la pendiente m√≠nima.
Soluci√≥n: reduzca el tiempo entre los nodos insertando m√°s nodos. De este modo, la curva
emitida se acercar√° a la curva plana deseada en forma de trapecio.

Activar el generador ramp soak
Con el cambio RMPSK_ON de FALSE a TRUE se activa el generador ramp soak. Una vez
alcanzado al √∫ltimo nodo se termina el perfil. Cuando el operador reinicia la funci√≥n, es
necesario poner primero RMPSK_ON a 'FALSE' y a continuaci√≥n a 'TRUE'.
En el rearranque, la salida outv se pone a 0.0 y se determina el tiempo total o el tiempo residual
total. En la transici√≥n al modo normal, la curva de evoluci√≥n se procesa inmediatamente desde
el punto inicial de acuerdo con el modo de operaci√≥n ajustado. Si no se desea que esto suceda,
el par√°metro RMPSK_ON debe ponerse a FALSE en el OB de rearranque.

Funciones del generador ramp soak
La instrucci√≥n dispone de las funciones siguientes:
‚óè Activar generador ramp soak para ejecuci√≥n √∫nica
‚óè Preasignar salida con valor fijo
‚óè Activar repetici√≥n c√≠clica
‚óè Detener generador ramp soak
‚óè Continuar generador ramp soak
‚óè Actualizar tiempo total de procesamiento y tiempo residual total
Para ajustar el modo de operaci√≥n deseado se aplica la valencia de las entradas de control
especificada en la siguiente tabla:
Modo de operaci√≥n

RMPSK_
ON

DFOUT_ RMP_
ON
HOLD

CONT_
ON

CYC_
ON

TUPDT_
ON

Se√±al de salida OUTV

Activar generador ramp
soak

TRUE

FALSE

**)

FALSE

**)

OUTV(t)

Especificar salida

TRUE

FALSE

El valor final se mantiene
tras el final de procesamien‚Äê
to.

Activar repetici√≥n c√≠clica TRUE

TRUE

**)

**)

**)

**)

DF_OUTV

FALSE

FALSE

**)

TRUE

**)

OUTV(t)
Tras final: arranque auto‚Äê
m√°tico

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

859

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Modo de operaci√≥n

RMPSK_
ON

DFOUT_ RMP_
ON
HOLD

CONT_
ON

CYC_
ON

TUPDT_
ON

Se√±al de salida OUTV

Detener generador
ramp soak

TRUE

FALSE

TRUE

FALSE

**)

**)

se mantiene el valor actual
de OUTV(t) *)

Continuar generador
ramp soak

TRUE

FALSE

TRUE

TRUE

**)

**)

OUTV (antiguo) *)

Actualizar el tiempo to‚Äê
tal y el tiempo residual
total

**)

FALSE
**)

Se sigue con los nuevos va‚Äê
lores predeterminados.

**)

**)

**)

FALSE

No influye en OUTV

TRUE

No influye en OUTV

*) Hasta el pr√≥ximo nodo la curva no tiene la forma parametrizada por el usuario.
**) El modo de operaci√≥n ajustado en cada caso se ejecuta independientemente de la valencia de las se√±ales de control en
los campos marcados con **)

Especificar la salida del generador ramp soak
Si se activa esta funci√≥n (DFRMP_ON = TRUE), el valor de salida del generador ramp soak se
pone al valor de se√±al SP_INT o al valor de salida SP_GEN.
Nota
La asignaci√≥n previa con la consigna interna solo tiene efecto si el generador ramp soak est√°
activado (RMPSK_ON = TRUE).
Tras la conmutaci√≥n DFRMP_ON = FALSE, outv se lleva linealmente de la consigna ajustada
(p. ej. SP_INT) al valor de salida del n√∫mero de nodo actual PI[NBR_ATMS].OUTV.
El procesamiento interno de tiempo tambi√©n contin√∫a con una consigna fija aplicada
directamente (RMPSK_ON = TRUE y DFRMP_ON = TRUE).
Al iniciar la curva RMPSK_ON = TRUE se emite la consigna fija SP_INT hasta que
DFRMP_ON cambia de TRUE a FALSE despu√©s del tiempo T*.
5036.B21
')503B21

RXWY

63B,17


&XUYDFRQILJXUDGD
FXUYDDFWXDO



RXWY W









3,>@709
7

3,>@709

3,>@709 3,>@709
3,>@709

3,>@709

W

3,>@709 PV

45B6B$&7

860

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
En este momento ha transcurrido el tiempo PI[0].TMV y parte del tiempo PI[1].TMV. OUTV se
lleva de SP_INT a PI[2].OUTV, es decir, a la consigna del nodo 2.
La curva configurada se emite solo a partir del nodo 2. La coincidencia entre la curva
configurada y la actual se indica con QR_S_ACT = TRUE. Con un flanco ascendente en
DFOUT_ON durante el procesamiento de la curva, el valor de la salida OUTV salta sin retardo
a DF_OUTV.

Activar repetici√≥n c√≠clica
Cuando el modo de operaci√≥n 'Repetici√≥n c√≠clica' (CYC_ON = TRUE) est√° activado, el
generador ramp soak vuelve autom√°ticamente al punto inicial tras emitir el √∫ltimo valor de nodo
y se ejecuta de nuevo.
Entre el √∫ltimo nodo y el punto inicial no se interpola. Para una transici√≥n sin discontinuidad se
debe aplicar lo siguiente: PI[NBR_PTS].OUTV = PI[0].OUTV.

Detener generador ramp soak
Con RMP_HOLD = TRUE se congela el valor de la magnitud de salida (incluido el
procesamiento de tiempo). Cuando RMP_HOLD = FALSE se desactiva, PI[x].TMV contin√∫a en
el punto de interrupci√≥n.
503B+2/'
')503B21
7
RXWY

63B,17




&XUYDFRQILJXUDGD
FXUYDDFWXDO
YDORUHVDFWXDOHV

 RXWY W








7



3,>@709
3,>@709 3,>@709
3,>@709 3,>@709
3,>@709
3,>@709
7LHPSRFRQILJXUDGR
3,>@7097
3,>@709
7LHPSRDFWXDO

W

45B6B$&7

El tiempo de procesamiento de la curva se prolonga por el tiempo T*. La curva presenta el
desarrollo configurado desde el nodo hasta el flanco ascendente en RMP_HOLD y desde el
nodo 5* hasta el nodo 6*, es decir, la se√±al de salida QR_S_ACT tiene el valor TRUE.
Si el interruptor CONT_ON est√° activado, el generador ramp soak detenido contin√∫a en el
punto predeterminado TM_CONT con el procesamiento de la curva de desplazamiento.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

861

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Continuar generador ramp soak
Con CONT_ON se contin√∫a una curva detenida en un punto definido. Si el generador ramp
soak no est√° detenido, CONT_ON no tiene efecto.
Si la entrada de control para continuar CONT_ON = TRUE est√° activada, el generador ramp
soak detenido contin√∫a en el nodo TM_SNBR. TM_CONT determina el tiempo residual que
requiere el generador hasta que se alcanza el nodo TM_SNBR.
La figura siguiente muestra la influencia de RMP_HOLD y CONT_ON con la configuraci√≥n
siguiente:
Continuar en el nodo 5 (TM_SNBR = 5) y continuar en T* s: TM_CONT = T*
1LQJXQDUHDFFL¬µQ

&217B21
503B+2/'

RXWY


7

&XUYDFRQILJXUDGD
FXUYDDFWXDOYDORUHV
DFWXDOHV



RXWY W





3,>@709 3,>@709
7LHPSRFRQILJXUDGR


3,>@709
3,>@709

7

3,>@709
3,>@709




3,>@709


W
3,>@709

7LHPSRDFWXDO
45B6B$&7

Los nodos 3 y 4 se suprimen para este ciclo de procesamiento del generador ramp soak.
Despu√©s del cambio de se√±al RMP_HOLD de TRUE a FALSE, el desarrollo configurado de la
curva solo se vuelve a alcanzar a partir del nodo 5.
La salida QR_S_ACT solo se activa cuando el generador ramp soak procesa la curva de
evoluci√≥n parametrizada por el usuario.

Actualizar el tiempo total y el tiempo residual total
En cada ciclo se actualizan el n√∫mero actual del nodo NBR_ATMS, el tiempo residual actual
hasta alcanzar el nodo RS_TM, el tiempo total T_TM y el tiempo residual total hasta alcanzar
el final de la curva RT_TM.
En caso de modificaciones online de PI[n].TMV, cambian el tiempo total y el tiempo residual
total de la curva. Ya que el c√°lculo de T_TM y RT_TM prolonga considerablemente el tiempo
de procesamiento del bloque de funci√≥n en muchos nodos, este solo se realiza despu√©s del
rearranque o si TUPDT_ON = TRUE. Los intervalos PI[0 ... NBR_PTS].TMV entre los
diferentes nodos se suman y se muestran en la salida del tiempo total T_TM y del tiempo
residual total RT_TM.

862

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Tenga en cuenta que el c√°lculo de los tiempos totales requiere mucho tiempo de ejecuci√≥n de
la CPU.

Procedimiento
Para configurar el generador ramp soak, proceda del siguiente modo:
1. En la lista "Origen de la consigna" seleccione la entrada "Generador ramp soak".
2. Cree un AUTOHOTSPOT (PID-CP) o un AUTOHOTSPOT (PID-ES).
3. Defina los par√°metros necesarios para el perfil.
4. Introduzca el n√∫mero del bloque de datos DB_RMPSK en el campo de entrada "N√∫mero de
DB".
5. Active o desactive las dem√°s funciones del generador ramp soak.
6. Si ha activado la funci√≥n "Continuar generador ramp soak", introduzca el nodo y el tiempo
en que deba continuar el generador.

Normalizaci√≥n
Normalizaci√≥n de una consigna externa
Si la consigna externa no est√° presente en la unidad f√≠sica del valor real (p. ej. en % en una
cascada de regulador), es necesario normalizar ese valor y su rango de ajuste a la unidad f√≠sica
del valor real. Para ello se utiliza la funci√≥n "Normalizaci√≥n en la rama de consigna".
La funci√≥n SP_NORM normaliza una magnitud de entrada anal√≥gica. La consigna externa
anal√≥gica se convierte a la magnitud de salida outv con la recta de normalizaci√≥n. El valor de
salida OUTV est√° accesible en la herramienta de configuraci√≥n a trav√©s del punto de medici√≥n
MP2.
El valor de salida de la funci√≥n es efectivo cuando la entrada de control es SPEXT_ON = TRUE.
Para definir la recta de normalizaci√≥n de forma un√≠voca, defina los cuatro par√°metros
siguientes:
‚óè Entrada arriba: SP_EXT: NM_SPEHR
‚óè Entrada abajo: SP_EXT: NM_SPELR

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

863

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
‚óè Salida arriba: NM_PVHR (este valor se introduce en la funci√≥n de normalizaci√≥n del valor
real.)
‚óè Salida abajo: NM_PVLR (este valor se introduce en la funci√≥n de normalizaci√≥n del valor
real.)
RXWY

10B39+5

10B39/5
63B(;7
10B63(/5

10B63(+5

El valor de salida outv se calcula con la f√≥rmula siguiente a partir del correspondiente valor de
entrada SP_EXT:
outv = (SP_EXT ‚Äì NM_SPELR) x (NM_PVHR ‚Äì NM_PVLR) / (NM_SPEHR ‚Äì NM_SPELR) +
NM_PVLR
Para el caso especial de una funci√≥n de ra√≠z aplicada en la rama de valor real rigen como l√≠mite
superior e inferior del valor de salida outv los valores de normalizaci√≥n de la funci√≥n de ra√≠z
(SQRT_HR y SQRT_LR).
En ese caso, el valor de salida outv de la funci√≥n de normalizaci√≥n se calcula con la f√≥rmula
siguiente a partir del correspondiente valor de entrada SP_EXT:
outv = (SP_EXT ‚Äì NM_SPELR) x (SQRT_HR ‚Äì SQRT_LR) / (NM_SPEHR ‚Äì NM_SPELR) +
SQRT_LR
Dentro de la funci√≥n no se limitan los valores ni se comprueban los par√°metros. Si introduce
el mismo valor para NM_SPEHR y NM_SPELR, seg√∫n las f√≥rmulas anteriores se puede
producir una divisi√≥n entre cero. Esto no se considera en la instrucci√≥n.

Factor de mezcla/relaci√≥n
En una regulaci√≥n de relaci√≥n, las consignas de los lazos de regulaci√≥n se adaptan unas a
otras de forma que la relaci√≥n ajustada se corresponde con la relaci√≥n efectiva de los valores
reales.
En una regulaci√≥n de mezcla se ajusta la proporci√≥n deseada de cada uno de los
componentes. La suma de los factores de mezcla FAC debe dar 1.

864

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para configurar la normalizaci√≥n, proceda del siguiente modo:
1. Introduzca los valores de la normalizaci√≥n en los campos de entrada "Entrada arriba" y
"Entrada abajo".
2. Introduzca un factor de mezcla/relaci√≥n (FAC).

L√≠mites
Llamada de FC en la rama de consigna
La inserci√≥n de una funci√≥n espec√≠fica de usuario en la rama de consigna permite someter una
referencia predeterminada de forma externa a un procesamiento de se√±al (p. ej. un retardo de
se√±al o linealizaci√≥n) antes de aplicarla en el regulador.
Si se activa la llamada de FC en la rama de consigna, se llama una funci√≥n espec√≠fica de
usuario. El regulador ejecuta una llamada de la FC. En ella no se suministran valores a los
par√°metros de entrada y salida de la funci√≥n de usuario ya existentes. Por ello, la transmisi√≥n
de datos debe programarse manualmente con S7-AWL en la FC de usuario. La consigna
acondicionada se observa en MP3.
En ese caso, el valor de SPFC_ON determina si en el canal de la consigna se inserta en este
punto una funci√≥n programada libremente en forma de FC est√°ndar (p. ej. una curva
caracter√≠stica) o si la consigna contin√∫a proces√°ndose sin ninguna influencia de ese tipo.
Nota
La instrucci√≥n no comprueba si hay una funci√≥n. Si la funci√≥n no est√° disponible, la CPU pasa
a STOP con un error interno de sistema.

Procedimiento
Para llamar una funci√≥n en la rama de la consigna, proceda del siguiente modo:
1. Active la casilla de verificaci√≥n "Activar llamada de FC".
2. En el campo de entrada "FC", indique el n√∫mero de la funci√≥n que se va a llamar.

Limitaci√≥n de la velocidad de cambio de la consigna
Las funciones de rampa en la rama de la consigna se utilizan en aquellos casos en que el
proceso no soporta cambios bruscos de la se√±al manipulada, ya que un cambio abrupto de la
consigna generalmente provoca tambi√©n un escal√≥n en la variable manipulada del regulador.
Estos cambios abruptos de la variable manipulada deben evitarse p. ej. en aquellos casos en
que entre el motor regulado y la carga que debe accionarse hay interpuesto un engranaje, y
una elevaci√≥n muy r√°pida del n√∫mero de revoluciones del motor derivar√≠a en una sobrecarga
del engranaje.
La funci√≥n SP_ROC limita la velocidad de cambio de las consignas procesadas en el
regulador, ya sea por separado para la rampa de subida y bajada, como por separado para los
rangos positivo y negativo de la referencia.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

865

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
En las cuatro entradas SPURLM_P, SPDRLM_P, SPURLM_N y SPDRLM_N se introducen las
limitaciones correspondiente para los aumentos de la funci√≥n de rampa en los rangos positivo
y negativo de la referencia. Las rampas de subida se refieren a la subida o bajada por segundo.
Los cambios de consigna m√°s r√°pidos se retardan a estas velocidades l√≠mite.
Si p. ej. SPURLM_P se parametriza a 10.0 [rango de valores tec./s], en cada ciclo de muestreo
se suman los siguientes valores al "valor antiguo" de outv mientras inv sea > outv:
Tiempo de muestreo

1s

outvantiguo + 10

100 ms

outvantiguo + 1

10 ms

outvantiguo + 0.1

La siguiente figura muestra el funcionamiento del procesamiento de la se√±al a partir de un
ejemplo. Las funciones de escal√≥n en la entrada inv(t) se traducen en funciones de rampa en
la salida outv(t).
LQY
RXWY

LQY W

RXWY W
63'5/0B3

6385/0B3


6385/0B3
6385/0B1

W
63'5/0B1

Figura 3-2

Limitaci√≥n de la velocidad de cambio de la referencia SP(t)

No se notifica el alcance de los l√≠mites de la pendiente.

Procedimiento
Para limitar la velocidad de cambio, proceda del siguiente modo:
1. Active la casilla de verificaci√≥n "Limitar la velocidad de cambio".
2. Defina los siguientes valores tanto para el rango positivo como para el negativo:
‚Äì Rampa de subida de consigna
‚Äì Rampa de bajada de consigna

Limitaci√≥n del valor absoluto de la referencia
El rango de ajuste de la referencia determina el rango dentro del cual puede oscilar la
referencia, es decir, el margen en el que se mueve el proceso dentro de los valores de estado
admisibles.
Por ello, para evitar estados de proceso cr√≠ticos o no permitidos, Standard PID Control limita
el rango de ajuste de la referencia en la rama de consigna por arriba y por abajo (SP_LIMIT).
La funci√≥n SP_LIMIT limita la consigna SP al valor inferior y superior predeterminable SP_LLM
y SP_HLM mientras la magnitud de entrada INV est√© fuera de dichas limitaciones. Dado que

866

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
la funci√≥n no puede desactivarse, en la configuraci√≥n siempre hay que tener en cuenta la
indicaci√≥n de los l√≠mites inferior y superior.
Los valores num√©ricos de los l√≠mites se ajustan en los par√°metros de entrada para la limitaci√≥n
inferior y superior. Si la magnitud de entrada inv(t) rebasa los l√≠mites, se emiten las
indicaciones correspondientes a trav√©s de las salidas de aviso.
LQY
63

LQY W

63B+/0

)UDQMDGHWROHUDQFLD

W


63 W
63B//0

463B+/0
463B//0

Figura 3-3

Limitaci√≥n de valor absoluto de la referencia SP(t)

Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
SP =PVH_ALM

QSP_HLM

QSP_LLM

si:

SP_HLM

TRUE

FALSE

inv ‚â• SP_HLM

SP_LLM

FALSE

TRUE

inv ‚â§ SP_LLM

inv

FALSE

FALSE

SP_HLM < inv < SP_LLM

Procedimiento
Para limitar el valor absoluto de la referencia, proceda del siguiente modo:
1. En el campo de entrada "L√≠mite superior", indique el l√≠mite superior absoluto de la consigna
(SP_HLM).
2. En el campo de entrada "L√≠mite inferior", indique el l√≠mite inferior absoluto de la consigna
(SP_LLM).

Error de regulaci√≥n
Zona muerta

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

867

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
En caso de superposici√≥n de la magnitud regulada o la referencia con una se√±al perturbadora
de mayor frecuencia, en un regulador con ajuste √≥ptimo el ruido tambi√©n es efectivo en la
salida del regulador. En una amplificaci√≥n elevada del regulador y con derivaci√≥n activada, por
ejemplo, esto puede provocar importantes oscilaciones en la magnitud manipulada. Debido al
aumento de la frecuencia de conmutaci√≥n (regulador paso a paso), eso deriva en un desgaste
elevado del actuador.
En estado forzado del regulador, la funci√≥n reduce el ruido en la se√±al del error de regulaci√≥n,
disminuyendo as√≠ la oscilaci√≥n no deseada de la salida de regulador.
La zona muerta puede desactivarse.

Filtrado de se√±al por funci√≥n de zona muerta
La funci√≥n DEADBAND suprime peque√±as oscilaciones de la magnitud de entrada dentro de
un rango parametrizable alrededor de un punto cero definido. Fuera de esta franja de
oscilaciones, el error de regulaci√≥n ER aumenta o cae proporcionalmente a la magnitud de
entrada. El ancho de la zona no efectiva (zona muerta) puede definirse con el par√°metro
DEADB_W. El ancho de zona muerta solo debe tener valores positivos.
Si la magnitud de entrada se encuentra dentro de la zona muerta, se deposita el valor 0 (error
de regulaci√≥n = 0) en la salida. Solo una vez que la magnitud de entrada abandona este rango
de insensibilidad, la salida aumenta o cae la parte correspondiente a los mismos valores de la
magnitud de entrada inv. El resultado es una falsificaci√≥n de la se√±al transmitida, tambi√©n fuera
de la zona muerta. Sin embargo, esto se tolera para evitar escalones en los l√≠mites de la zona
muerta (v√©ase la siguiente figura). La falsificaci√≥n corresponde al valor DEADB_W, por lo que
es f√°cilmente controlable.
La funci√≥n DEADBAND trabaja seg√∫n las siguientes funciones:
(ER) = inv + DEADB_W para inv < - DEADB_W
(ER) = 0 para -DEADB_W ‚â§ inv ‚â§ + DEADB_W
(ER) = inv - DEADB_W para inv > + DEADB_W
(5

LQY

'($'%B:

Las repercusiones del filtrado de se√±ales se observan en el par√°metro de salida ER.

868

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Alarma
Las desviaciones excesivas de la magnitud regulada respecto a la consigna ajustada pueden
provocar estados de proceso no deseados. En estos casos se utiliza la funci√≥n ER_ALARM
para vigilar que el error de regulaci√≥n no rebase el rango de servicio permitido por exceso ni
por defecto. ER_ALARM registra y notifica los rebases de l√≠mite ocurridos, para permitir una
respuesta adecuada.
Nota
La vigilancia de los l√≠mites del error de regulaci√≥n no puede desactivarse. El rebase por exceso
de los l√≠mites configurados se notifica siempre.
La funci√≥n ER_ALARM vigila el valor del error de regulaci√≥n ER(t) en funci√≥n de cuatro l√≠mites
predefinibles en dos zonas de tolerancia. Cuando los l√≠mites se alcanzan o rebasan, la funci√≥n
notifica primero "Advertencia" y a continuaci√≥n "Alarma" en el segundo l√≠mite.

Valores l√≠mite
Los valores num√©ricos de los l√≠mites se ajustan en los par√°metros de entrada para
"Advertencia" y "Alarma". Si el error de regulaci√≥n (ER) rebasa estos l√≠mites por exceso o
defecto, se activan los bits de aviso de salida correspondientes QERN_ALM ... QERP_ALM.
Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
QERP_ALM

QERP_WRN

QERN_WRN

QERN_ALM

si:

y:

TRUE

TRUE

FALSE

FALSE

ER ‚Üó

ER ‚â• ERP_ALM

ER ‚Üò

ER ‚â• ERP_ALM - ER_HYS

FALSE

TRUE

FALSE

FALSE

ER ‚Üó

ER ‚â• ERP_WRN

ER ‚Üò

ER ‚â• ERP_WRN - ER_HYS

FALSE

FALSE

TRUE

FALSE

ER ‚Üò

ER ‚â§ ERP_WRN

ER ‚Üó

ER ‚â§ ERP_WRN + ER_HYS

FALSE

FALSE

TRUE

TRUE

ER ‚Üò

ER ‚â§ ERP_ALM

ER ‚Üó

ER ‚â§ ERP_ALM + ER_HYS

Para que el bloque funcione de manera eficiente debe aplicarse lo siguiente:
alarma superior < advertencia superior < advertencia inferior < alarma inferior

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

869

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
(5

(5 W

(5B+<6

(53B$/0

l]RQDGHWROHUDQFLD

(53B:51

l]RQDGHWROHUDQFLD

W

(51B:51
(51B$/0

4(53B$/0
4(53B:51
4(51B:51
4(51B$/0

Hist√©resis
Para evitar que los bits de aviso "centelleen" con cambios muy peque√±os de la magnitud de
entrada o con errores de redondeo, se ajusta una hist√©resis (diferencia de desactivaci√≥n)
ER_HYS. El error de regulaci√≥n debe superar esta hist√©resis antes de que los bits de aviso se
desactiven.

Regulador
Algoritmo de regulaci√≥n
En el ciclo del tiempo de muestreo configurado se calcula la magnitud manipulada del
regulador continuo a partir del error de regulaci√≥n en el algoritmo de posici√≥n PID. El regulador
tiene una estructura puramente paralela. Las acciones proporcional, integral o diferencial se
pueden desconectar individualmente.
',69B6(/
',69

*$,1
(5

3

,

'

870

3B6(/

,B6(/

3,'B2879

'B6(/

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Control anticipativo
A la se√±al de salida del regulador PID_OUTV se le puede aplicar adicionalmente una magnitud
perturbadora DISV. La activaci√≥n o desactivaci√≥n se realiza en la ventana PID de la
herramienta de configuraci√≥n a trav√©s del conmutador de estructura DISV_SEL o mediante
"Magnitud perturbadora ON".

Acci√≥n P y D en la rama de realimentaci√≥n
En la estructura paralela, cada acci√≥n del algoritmo regulador recibe el error de regulaci√≥n
como se√±al de entrada. La magnitud manipulada es modificada directamente por la acci√≥n P
y la acci√≥n D con escalones de la consigna. Sin embargo, otra estructura del regulador en la
que la formaci√≥n de la acci√≥n P y la acci√≥n D se traslada a la realimentaci√≥n, garantiza una
evoluci√≥n suave de la magnitud manipulada en caso de variaciones del escal√≥n de la
referencia. En esta estructura la acci√≥n I procesa el error de regulaci√≥n como se√±al de entrada,
en la acci√≥n P y en la acci√≥n D solo se conecta la magnitud de regulaci√≥n negativa (factor = -1).
*$,1
(5

,

3

3,'B2879


39

'

Normalizaci√≥n de las magnitudes de entrada ER y PV
Las magnitudes de entrada ER y PV del regulador PID se normalizan antes del procesamiento
del regulador en el rango de 0 a 100, conforme a las f√≥rmulas siguientes:
‚óè con funci√≥n de ra√≠z desactivada (SQRT_ON = FALSE):
‚Äì ERnormalizado = ER * 100.0 / (NM_PVHR ‚Äì NM_PVLR)
‚Äì PVnormalizado = (PV - NM_PVLR) * 100.0 / (NM_PVHR ‚Äì NM_PVLR)
‚óè con funci√≥n de ra√≠z activada (SQRT_ON = TRUE):
‚Äì ERnormalizado = ER * 100.0 / (SQRT_HR ‚Äì SQRT_LR)
‚Äì PVnormalizado = (PV - SQRT_LR) * 100.0 / (SQRT_HR ‚Äì SQRT_LR)
La normalizaci√≥n se lleva a cabo para que la ganancia proporcional GAIN del regulador PID
pueda introducirse sin dimensiones. De este modo, si cambia el l√≠mite superior e inferior del
rango de medida f√≠sico (p. ej. de bar a mbar), no es necesario cambiar el factor de ganancia.
Las magnitudes de entrada normalizadas ERnormalizado y PVnormalizado no pueden observarse.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

871

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Consulte tambi√©n
Estructuras de regulador (P√°gina 872)
Acci√≥n P (P√°gina 875)
Acci√≥n D (P√°gina 878)
Acci√≥n I (P√°gina 876)

Estructuras de regulador
Uso y parametrizaci√≥n del regulador PID
La mayor parte de los procesos regulados que se dan en la industria del procesamiento y los
procesos puede regularse con la funci√≥n de regulador PI/PID de Standard PID Control. Solo en
casos especiales se requieren m√©todos y medidas adicionales para dominar la regulaci√≥n en
cuesti√≥n.
No obstante, un gran problema pr√°ctico suele ser la parametrizaci√≥n del regulador PI/PID, es
decir, encontrar los valores de ajuste "correctos" para los par√°metros del regulador. La calidad
de esta parametrizaci√≥n es determinante para la efectividad de la regulaci√≥n PID, y requiere
una gran experiencia pr√°ctica, conocimientos especializados o bien mucho tiempo.

Regulaci√≥n P
En el regulador P est√°n desconectadas las acciones I y D. (I_SEL y D_SEL = FALSE). Eso
significa que con un error de regulaci√≥n ER = 0, la se√±al de salida tambi√©n es OUTV = 0. Para
ajustar un punto de trabajo ‚â† 0, es decir, un valor num√©rico para la se√±al de salida con un error
de regulaci√≥n cero, hay que activar la rama I (v√©ase la figura siguiente).
En la acci√≥n I se puede predeterminar un punto de trabajo ‚â† 0 para el regulador P ajustando
el valor de inicializaci√≥n I_ITLVAL en correspondencia. Para ello hay que activar los
conmutadores 'I_ITL_ON' y 'I_SEL' = TRUE.
3B6(/

3
*$,1
(5

,B,7/B21
 ,B6(/

,

3,'B2879


,B,7/9$/

La respuesta indicial del regulador P en el rango de tiempo es:
PID_OUTV (t) = I_ITLVAL + GAIN * ER normalizado (t)
(5 QRUPDOL]DGR

3,'B287 W

3,'B2879

(5QRUPDOL]DGR W
W

872

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

PID_OUTV(t)

es la magnitud manipulada en modo autom√°tico del regulador

I_ITLVAL

es el punto de trabajo del regulador P

GAIN

es la ganancia de regulador

ER normalizado (t)

es el error de regulaci√≥n normalizado

Regulaci√≥n PI
En el regulador PI est√° desconectada la acci√≥n D. (D_SEL = FALSE). Un regulador PI modifica
la magnitud de salida PID_OUTV con la acci√≥n I hasta que el error de regulaci√≥n es ER = 0. Sin
embargo, esto solo es aplicable cuando la magnitud de salida no rebasa los l√≠mites del rango
manipulado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR    W
7,

(5 QRUPDOL]DGR
3,'B2879 W

3,'B2879
*$,1 (5 QRUPDOL]DGR


*$,1 (5 QRUPDOL]DGR W

*$,1 (5 QRUPDOL]DGR


(5QRUPDOL]DGR W
7,

PID_OUTV(t)

es la magnitud manipulada en modo autom√°tico del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escal√≥n del error de regulaci√≥n normalizado

TI

Constante de tiempo de integraci√≥n

Regulaci√≥n PD
En el regulador PD est√° desconectada la acci√≥n I (I‚ÄìSEL = FALSE). Eso significa que con un
error de regulaci√≥n ER = 0, la se√±al de salida tambi√©n es OUTV = 0. Para ajustar un punto de
trabajo ‚â† 0, es decir, un valor num√©rico para la se√±al de salida con un error de regulaci√≥n cero,
hay que activar la rama I (v√©ase tambi√©n el diagrama de bloques de la regulaci√≥n P).
En la acci√≥n I se puede predeterminar un punto de trabajo ‚â† 0 para el regulador PD ajustando
el valor de inicializaci√≥n I_ITLVAL en correspondencia. Para ello hay que activar los
conmutadores 'I_ITL_ON' e 'I_SEL' TRUE .
El regulador PD reproduce la magnitud de entrada ER(t) proporcionalmente sobre la se√±al de
salida y a√±ade la acci√≥n D creada por la derivaci√≥n de ER(t), que se calcula con el doble de
precisi√≥n seg√∫n la regla del trapecio (aproximaci√≥n de Pad√©). El comportamiento de tiempo se
determina mediante la constante derivativa (tiempo de derivaci√≥n) TD.
Para el filtrado de se√±ales y la supresi√≥n de se√±ales perturbadoras se ha integrado un retardo
de 1er orden (tiempo ajustable: TM_LAG) en el algoritmo para formar la acci√≥n D.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

873

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Generalmente es suficiente un valor reducido para TM_LAG para conseguir el resultado
deseado. Si se parametriza TM_LAG ‚â§ CYCLE/2 el retardo est√° desactivado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR 



7'
70B/$*

W
H 70B/$*

(5 QRUPDOL]DGR

3,'B2879

*$,1

7'
(5
70B/$*  QRUPDOL]DGR

3,'B2879 W

(5QRUPDOL]DGR W

*$,1 (5 QRUPDOL]DGR

70B/$*

PID_OUTV(t)

es la magnitud manipulada en modo autom√°tico del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escal√≥n del error de regulaci√≥n normalizado

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

Regulaci√≥n PID
En el regulador PID est√°n activadas las acciones P, I y D (P‚ÄìSEL = TRUE, I‚ÄìSEL = TRUE,
D_SEL = TRUE). Un regulador PID modifica la magnitud de salida PID_OUTV mediante la
acci√≥n I hasta que el error de regulaci√≥n es ER = 0. Sin embargo, esto solo es aplicable cuando
la magnitud de salida no rebasa los l√≠mites del rango manipulado. Si se rebasan los l√≠mites de
la variable manipulada, la acci√≥n I mantiene el valor alcanzado en el l√≠mite en (Anti-ResetWindup).
El regulador PID reproduce la magnitud de entrada normalizada ERnormalizado(t)
proporcionalmente sobre la se√±al de salida y a√±ade las acciones creadas por la derivaci√≥n e
integraci√≥n de ERnormalizado(t), que se calculan con el doble de precisi√≥n seg√∫n la regla de
trapecio (aproximaci√≥n Pad√©). La respuesta de tiempo se determina por el tiempo de
derivaci√≥n (tiempo de acci√≥n derivativa) TD y el tiempo de integraci√≥n (tiempo de acci√≥n
integral) TI.
Para el filtrado y la supresi√≥n de se√±ales perturbadoras se ha integrado un retardo de 1er orden
(constante de tiempo ajustable: TM_LAG) en el algoritmo para formar la acci√≥n D.
Generalmente es suficiente un valor reducido para TM_LAG para conseguir el resultado
deseado. Si se parametriza TM_LAG ‚â§ CYCLE/2 el retardo est√° desactivado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR 

874



 W
7'
7,
70B/$*

W
H 70B/$*

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
(5 QRUPDOL]DGR
3,'B2879

*$,1

3,'B2879 W

7'

(5 QRUPDOL]DGR
70B/$* 

3,B287 W
*$,1 (5 QRUPDOL]DGR 
*$,1 (5 QRUPDOL]DGR


*$,1 (5 QRUPDOL]DGR
W
W

70B/$*
7,

PID_OUTV(t)

es la magnitud manipulada en modo autom√°tico del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escal√≥n del error de regulaci√≥n normalizado

TI

Constante de tiempo de integraci√≥n

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

Nota
Si TD cambia, conviene adaptar TM_LAG de la forma correspondiente.
Recomendaci√≥n: 5 ‚â§ (TM / TM_LAG) ‚â§ 10

Consulte tambi√©n
Algoritmo de regulaci√≥n (P√°gina 870)
Acci√≥n P (P√°gina 875)
Acci√≥n D (P√°gina 878)
Acci√≥n I (P√°gina 876)

Acci√≥n P
Ganancia proporcional
El signo de la ganancia proporcional determina el sentido de acci√≥n del regulador continuo.
‚óè Ganancia proporcional positiva
error de regulaci√≥n ascendente ‚Üí variable manipulada ascendente
‚óè Ganancia proporcional negativa
error de regulaci√≥n ascendente ‚Üí variable manipulada descendente

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

875

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Aplicar la acci√≥n P en rama de realimentaci√≥n
Si la acci√≥n P est√° aplicada en la rama de realimentaci√≥n, solo el valor real tendr√° efecto sobre
la acci√≥n P. Por ello, la magnitud manipulada ‚Äì igual que en el caso de escal√≥n de la consigna
‚Äì en un cambio de autom√°tico a manual no realiza ning√∫n escal√≥n por la acci√≥n P: la
conmutaci√≥n es suave.

Consulte tambi√©n
Algoritmo de regulaci√≥n (P√°gina 870)

Acci√≥n I
Funci√≥n de la acci√≥n I
La acci√≥n I hace que, reajustando el punto de operaci√≥n, el error de regulaci√≥n pueda
convertirse en 0 para cualquier valor de la magnitud manipulada.
La acci√≥n I genera una se√±al de salida cuya velocidad de cambio es proporcional al cambio del
valor absoluto de la magnitud de entrada. La respuesta temporal viene determinada por el
tiempo integrativo TI.
La respuesta a un escal√≥n de entrada inv0 es:
2879 W 


7,

»â

LQY W GW

LQY
/01B,

/01B, W

/01B, W    LQY W
7,
LQY W

LQY

W
7,

LMN_I(t)

la magnitud de salida de la acci√≥n I

inv0

la altura del escal√≥n en la entrada de la acci√≥n I

TI

Tiempo integrativo

La acci√≥n I se observa en la variable est√°tica LMN_I.
En estado desactivado (I_SEL = FALSE) la acci√≥n I, es decir, la memoria interna y la variable
est√°tica LMN_I, se pone a cero.
La salida y la memoria de la acci√≥n I est√°n limitados por los l√≠mites absolutos de la variable
manipulada LMN_HLM y LMN_LLM (Anti Reset Wind‚Äìup).
En caso de influir en la se√±al manipulada en modo manual, es decir, cuando MAN_ON,
LMNOP_ON o CAS_ON = TRUE, el valor de la memoria interna de la acci√≥n I se corrige seg√∫n
el valor LMNFC_IN - LMN_P - DISV.

876

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3B6(/

3

*$,1
(5

,17B+326,17B+1(*
,B6(/

,

/0123
0$1
/0123B21
0$1B21






/01

,B,7/B21

,B,7/9$/




/01)&B,1/01B3',69

Conmutaci√≥n suave de manual a autom√°tico
En el modo manual, las acciones I y D del regulador se corrigen de tal forma que el regulador
comienza la conmutaci√≥n al modo autom√°tico con una magnitud manipulada adecuada.
‚óè Conmutaci√≥n suave activada (SMOO_CHG = TRUE)
La acci√≥n I se activa en modo manual de modo que la magnitud manipulada permanece
invariable en principio durante la conmutaci√≥n de manual a autom√°tico.
La acci√≥n D se pone a cero en modo manual. La conmutaci√≥n a autom√°tico se lleva a cabo
sin escal√≥n de la magnitud manipulada.
Si hay un error de regulaci√≥n, este se regula lentamente.
‚óè Conmutaci√≥n suave desactivada (SMOO_CHG = FALSE)
Durante la conmutaci√≥n de manual a autom√°tico y partiendo de la posici√≥n actual, la
magnitud manipulada realiza un escal√≥n cuya altura queda determinada por la acci√≥n P. La
altura del escal√≥n de la acci√≥n P equivale al cambio de la magnitud manipulada cuando hay
un escal√≥n de consiga del valor real actual a la consigna actual.
En modo manual, la acci√≥n D se pone a un valor que equivale al error de regulaci√≥n
existente. La conmutaci√≥n a autom√°tico se realiza con escal√≥n de magnitud manipulada; el
error de regulaci√≥n se regula m√°s r√°pido.
Sin embargo, si la acci√≥n P est√° aplicada en la rama de realimentaci√≥n, solo el valor real
tendr√° efecto sobre la acci√≥n P. Por ello, en una conmutaci√≥n de manual a autom√°tico, la
magnitud manipulada no realiza ning√∫n escal√≥n por la acci√≥n P; la conmutaci√≥n es suave.
Lo mismo es v√°lido para la acci√≥n D siempre que esta
se haya aplicado en la rama de realimentaci√≥n (DFDB_SEL = TRUE).
El error de regulaci√≥n existente se regula m√°s r√°pido. Esto debe ser as√≠, por ejemplo, en
sistemas de regulaci√≥n de temperatura.

Rangos admisibles para el tiempo integrativo TI y CYCLE
Debido a la precisi√≥n limitada de los n√∫meros REAL calculados en la CPU, es posible que se
produzca el efecto siguiente durante la integraci√≥n: si se ha elegido un tiempo de muestreo
CYCLE de la regulaci√≥n demasiado peque√±o en comparaci√≥n con el tiempo integrativo TI y si
el valor de entrada inv de la acci√≥n I es peque√±o en comparaci√≥n con su valor de salida OUTV,
la acci√≥n I no se activa y permanece en su valor de salida moment√°neo.
Este efecto puede evitarse si se considera la siguiente regla de dimensionado en la
configuraci√≥n:
CYCLE > 10‚Äì4 √ó TI

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

877

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
De este modo, la acci√≥n I reacciona incluso a cambios de los valores de entrada situados en
el rango de una millon√©sima parte por mil de la magnitud de salida actual:
inv > 10 ‚Äì10 √ó OUTV
Para que el comportamiento de transferencia del algoritmo del integrador equivalga al
comportamiento anal√≥gico, el tiempo de muestreo deber√≠a ser menor que el 20 % del tiempo
integrativo ajustado o bien TI deber√≠a tener como m√≠nimo cinco veces el valor del tiempo de
muestreo seleccionado:
CYCLE < 0,2 √ó TI
El algoritmo admite para el tiempo de muestreo valores hasta CYCLE ‚â§ 0,5 * TI.

Inicializar la acci√≥n I
Cuando se activa la inicializaci√≥n de la acci√≥n I, el valor de inicializaci√≥n se aplica a la variable
est√°tica LMN_I en caso de rearranque de la CPU o si COM_RST = TRUE. Al cambiar al modo
normal reseteando la inicializaci√≥n, la acci√≥n I comienza la integraci√≥n de su magnitud de
entrada a partir del valor de inicializaci√≥n.

Detener la acci√≥n I
Mediante las variables est√°ticas INT_HPOS y INT_HNEG es posible bloquear la acci√≥n I en
sentido positivo y negativo, respectivamente. Esto puede ser √∫til en cascadas. Si, p. ej., la
magnitud manipulada del regulador secundario se aproxima al l√≠mite superior, existe la
posibilidad de impedir que siga aumentando la magnitud manipulada del regulador piloto
mediante su acci√≥n I. Este comportamiento se programa con las instrucciones siguientes, p.
ej., en AWL:
A
"regulador secundario".QLMN_HLM
=
"regulador piloto".INT_HPOS
A
"regulador secundario".QLMN_ LLM
=
"regulador piloto".INT_HNEG

Consulte tambi√©n
Algoritmo de regulaci√≥n (P√°gina 870)
Estructuras de regulador (P√°gina 872)

Acci√≥n D
Funci√≥n de la acci√≥n D
La acci√≥n D genera una se√±al de salida cuya magnitud cambia proporcionalmente a la
velocidad de cambio de la magnitud de entrada. La respuesta temporal se determina mediante
el tiempo derivativo TD y el tiempo de retardo TM_LAG.
La respuesta a un escal√≥n de entrada inv0 es:

878

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
/01B'

/01B' W  

W
7'
LQY H 70B/$*
70B/$*

7' LQY

70B/$*
LQY
W
70B/$*

LMN_D(t)

la magnitud de salida de la acci√≥n D

inv0

la altura del escal√≥n en la entrada de la acci√≥n D

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

La acci√≥n D se observa en la variable est√°tica LMN_D.
En estado desactivado (D_SEL = FALSE) la acci√≥n D, es decir, la memoria interna y la variable
est√°tica LMN_D, se pone a cero.

Aplicar la acci√≥n D en la rama de realimentaci√≥n
Si la acci√≥n D est√° aplicada en la rama de realimentaci√≥n, solo el valor real tendr√° efecto sobre
la acci√≥n D. Por ello, en una conmutaci√≥n de manual a autom√°tico, la magnitud manipulada ‚Äì
igual que en el caso de un escal√≥n de la consigna ‚Äì no realiza ning√∫n escal√≥n por la acci√≥n D;
la conmutaci√≥n es suave.

Valores admisibles para el tiempo derivativo y el tiempo de retardo
Para que la acci√≥n D pueda calcularse correctamente, deben observarse las condiciones
siguientes para el tiempo derivativo y el tiempo de retardo:
‚óè TD ‚â• CYCLE y
‚óè TM_LAG ‚â• 0,5 √ó CYCLE
Si TD < CYCLE, la acci√≥n D trabaja como si TD tuviera el valor CYCLE.
Si TM_LAG < 0,5 √ó CYCLE, la acci√≥n D trabaja sin retardo. Un escal√≥n de entrada se multiplica
por el factor TD/CYCLE y este valor se devuelve en la salida como "impulso de aguja". Esto
significa que en el pr√≥ximo ciclo de procesamiento, LMN_D se pondr√° de nuevo a cero.

Coeficiente DT1
El coeficiente DT1 se calcula del modo siguiente:
Coeficiente DT1 = TD/TM_LAG

Tiempo de retardo
Para el filtrado de se√±ales y la supresi√≥n de se√±ales perturbadoras se ha integrado un retardo
de 1er orden (constante de tiempo ajustable: TM_LAG) en el algoritmo para formar la acci√≥n
D.
Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

879

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
La mayor√≠a de las veces es suficiente con un valor peque√±o como tiempo de retardo para
alcanzar el resultado deseado. Si se parametriza un tiempo de retardo inferior a la mitad del
tiempo de muestreo del regulador, el retardo est√° desactivado.

Procedimiento
Para configurar la acci√≥n D, proceda del siguiente modo:
1. Para aplicar la acci√≥n D en la rama de realimentaci√≥n, active la casilla de verificaci√≥n
correspondiente.
2. Introduzca el tiempo derivativo en segundos.
3. Introduzca el tiempo de retardo en segundos.

Consulte tambi√©n
Algoritmo de regulaci√≥n (P√°gina 870)

Variable manipulada
Modo manual
Adem√°s del modo de operaci√≥n "Autom√°tico" con la salida del algoritmo PID (PID_OUTV)
aplicada directamente en la salida, existen dos modos de operaci√≥n en los que es posible influir
manualmente en la se√±al manipulada: "Modo manual sin manejo del interruptor" y "Modo
manual mediante interruptor de m√°s/menos" (MAN_GEN).
A trav√©s del par√°metro MAN se puede aplicar una influencia externa sobre la magnitud
manipulada, o puede venir dada por el programa de usuario. El valor de entrada MAN se limita
a los l√≠mites de magnitud manipulada LMN_HLM (superior) y LMN_LLM (inferior).
La estructura de la generaci√≥n y aplicaci√≥n del valor manual puede verse en la figura siguiente.
Al activar MAN_GEN desde otro modo de operaci√≥n, se aplica la variable manipulada
actualmente efectiva en la salida de MAN_GEN. As√≠, la conmutaci√≥n al generador del valor
manual siempre es suave.
/01/,0,7
0$1
0$1*1B21
/01)&B,1

0$1B*(1

03



03

0$1B21



03
/01

3,'B2879

880

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Activar el modo autom√°tico
Si se ha desactivado el modo manual (MAN_ON = FALSE)), la variable manipulada del
algoritmo PID se aplica directamente a la salida. En el modo manual (MAN_ON = TRUE), la
acci√≥n I del regulador se controla de tal forma que el regulador comienza la conmutaci√≥n al
modo autom√°tico con una magnitud manipulada adecuada. La salida del algoritmo PID se
encuentra en el punto de medici√≥n MP7.
En el modo autom√°tico, el valor manual MAN sigue a la magnitud manipulada (menos la acci√≥n
D). Por ello, en la conmutaci√≥n al modo manual la magnitud manipulada permanece en el
√∫ltimo valor calculado. Puede modificarse mediante intervenci√≥n manual.
1. Desactive la casilla de verificaci√≥n "Activar modo manual".

Activar el modo manual con valor manual
En este modo de operaci√≥n (MANGN_ON = FALSE y MAN_ON = TRUE) se introduce la
variable manipulada manual como valor absoluto en la entrada MAN. La variable manipulada
manual se indica en el punto de medici√≥n MP8.
1. Active la casilla de verificaci√≥n "Activar modo manual".
2. Seleccione la opci√≥n "Valor manual".

Activar el generador de valor manual
El valor manual MAN se aumenta o reduce progresivamente utilizando los interruptores
MANUP y MANDN. El valor modificado puede observarse en MP8. Se tienen en cuenta los
l√≠mites configurados de la variable manipulada.
1. Active la casilla de verificaci√≥n "Activar modo manual".
2. Seleccione la opci√≥n "Generador del valor manual".

Repercusi√≥n de los interruptores MANUP y MANDN
Para poder realizar un cambio graduado finamente, el regulador debe tener un tiempo de
muestreo de 100 ms como m√°ximo.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

881

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
La velocidad de cambio de la variable manipulada depende de la duraci√≥n de pulsaci√≥n de los
interruptores MANUP y MANDN as√≠ como de los l√≠mites ajustados de acuerdo con la relaci√≥n
siguiente:
‚óè durante los primeros 3 segundos despu√©s de activar MANUP o MANDN rige:
doutv/dt = (LMN_HLM - LMN_LLM) / 100 s
‚óè a continuaci√≥n
doutv/dt = (LMN_HLM - LMN_LLM) / 10 s
RXWY
/01B+/0

V
W
V

V

/01B//0

0$183
W
0$1'1

V
W

Con un tiempo de muestreo de 100 ms y un rango de la variable manipulada de -100,0 a 100,0,
la variable manipulada cambia en 0,2 por ciclo en los tres primeros segundos, por ejemplo. Si
MANUP se mantiene en TRUE durante m√°s de 3 segundos, la velocidad de cambio aumenta
a diez veces el valor, en este caso a 2 por ciclo.
El generador del valor manual se activa suavemente.

Modos de operaci√≥n
La tabla siguiente muestra los modos de operaci√≥n posibles del regulador continuo con los
valores necesarios de los interruptores.

882

Modo de operaci√≥n

MAN_ON

MANGN_ON

Modo autom√°tico

FALSE

no aplicable

Modo manual con valor manual

TRUE

FALSE

Modo manual con generador del
valor manual

TRUE

TRUE

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

L√≠mites
Llamar una funci√≥n
Insertando una funci√≥n espec√≠fica de usuario en la rama de la magnitud manipulada se puede
someter la magnitud manipulada PID_OUTV generada en el regulador a un procesamiento de
se√±al (p. ej. un retardo) antes de la aplicaci√≥n en la salida del regulador.
El regulador ejecuta una llamada de la funci√≥n. En ella no se suministran valores a los
par√°metros de entrada y salida de la funci√≥n de usuario. La transferencia de datos debe
programarla el usuario en su funci√≥n.
Nota
No se comprueba si hay una funci√≥n disponible. Si la funci√≥n no est√° disponible, la CPU pasa
a STOP con un error interno de sistema.
1. Active la casilla de verificaci√≥n "Activar llamada de FC".
2. Introduzca el n√∫mero de la funci√≥n en el campo de entrada "FC".

Limitar la velocidad de cambio
Las funciones de rampa en la rama de la magnitud manipulada se utilizan cuando el proceso
no soporta cambios de la se√±al de entrada del proceso en forma de esal√≥n. Los cambios
abruptos de la variable manipulada deben evitarse p. ej. en aquellos casos en que entre el
motor regulado y la carga que debe accionarse hay interpuesto un engranaje, y un aumento
muy r√°pido del n√∫mero de revoluciones del motor derivar√≠a en una sobrecarga del engranaje.
La velocidad de cambio de las variables manipuladas en la salida del regulador se limita por
separado para la rampa de subida y bajada de la magnitud manipulada. Para todo el rango de
valores es posible parametrizar dos rampas con valores ascendentes o descendentes
partiendo desde el punto cero. La funci√≥n est√° activada si LMNRC_ON = TRUE.
En las dos variables est√°ticas LMN_URLM y LMN_DRLM se introducen las limitaciones
correspondientes para las pendientes de la funci√≥n de rampa en los rangos positivo y negativo
de la magnitud manipulada. Las pendientes se refieren a la subida o bajada en porcentajes por
segundo. Los cambios m√°s r√°pidos de la variable manipulada se retardan a estas velocidades
l√≠mite.
Si p. ej. 'LMN_URLM' se parametriza a 10,0 [%], en cada ciclo de muestreo se suman los
siguientes valores al "valor antiguo" de outv mientras |inv| sea > |outv|:
Tiempo 1 s
‚Üí outvantiguo + 10 %
de mues‚Äê
treo
100 ms ‚Üí outvantiguo + 1 %
10 ms ‚Üí outvantiguo + 0,1 %
La figura siguiente muestra el funcionamiento del procesamiento de las se√±ales. Las funciones
de escal√≥n en la entrada inv (t) se traducen en funciones de rampa en la salida outv (t).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

883

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
LQY
RXWY

LQY W

RXWY W
/01B'5/0 LQV

/01B85/0

/01B85/0

/01B85/0



W
/01B'5/0

No se notifica el alcance de los l√≠mites de la pendiente.
La identificaci√≥n de los par√°metros de las rampas se realiza seg√∫n el siguiente esquema:
Par√°metro

Rampa

LMN_URLM

|outv| ascendente

LMN_DRLM

|outv| descendente

1. Active la casilla de verificaci√≥n "Limitar la velocidad de cambio".
2. Introduzca la rampa de subida m√°xima de la variable manipulada en el campo de entrada
"Rampa de subida m√°xima".
Los cambios m√°s r√°pidos de la variable manipulada se retardan a ese valor.
3. Introduzca la rampa de bajada m√°xima de la variable manipulada en el campo de entrada
"Rampa de bajada m√°xima".
Los cambios m√°s r√°pidos de la variable manipulada se retardan a ese valor.

Limitar el valor absoluto de la magnitud manipulada
El rango de trabajo, es decir, el rango dentro del cual puede moverse el actuador sin
abandonar las variables manipuladas admisibles, est√° determinado por el rango de ajuste de
la variable manipulada. Dado que, dependiendo del tipo de actuador, los l√≠mites de las
variables manipuladas permitidas no suelen cubrirse con el l√≠mite 0 % o 100 % del rango de
ajuste, es posible configurar el l√≠mite superior e inferior de la variable manipulada.
Para evitar estados no permitidos en el proceso en cuesti√≥n, en la rama de la variable
manipulada de la regulaci√≥n se limita el rango de ajuste de la magnitud manipulada por arriba
y abajo.
La magnitud manipulada LMN(t) se limita a los l√≠mites superior (LMN_HLM) e inferior
(LMN_LLM) predefinibles. Sin embargo, la magnitud de entrada inv debe estar fuera de estos
l√≠mites. Dado que la funci√≥n no puede desactivarse, en la configuraci√≥n siempre hay que tener
en cuenta la indicaci√≥n de los l√≠mites inferior y superior.
Si la magnitud de entrada inv(t) rebasa los l√≠mites, se emiten las indicaciones correspondientes
a trav√©s de las salidas de aviso.

884

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
LQY W

LQY
03
/01B+/0

W


03 W
/01B//0

4/01B+/0
4/01B//0

Arranque y funcionamiento
‚óè En caso de rearranque, todas las salidas de aviso se ponen a cero.
‚óè La limitaci√≥n trabaja seg√∫n las siguientes relaciones:
LMN =

QLMN_HLM

QLMN_LLM

si:

LMN_HLM

TRUE

FALSE

inv ‚â• LMN_HLM

LMN_LLM

FALSE

TRUE

inv ‚â§ LMN_LLM

inv

FALSE

FALSE

LMN_HLM < inv < LMN_LLM

En la salida, es decir, en el par√°metro LMN o en el punto de medici√≥n MP10, se muestra la
variable manipulada efectiva de la regulaci√≥n.

Procedimiento
Para limitar el valor absoluto de la magnitud manipulada, proceda del siguiente modo:
1. Introduzca el valor m√°s alto permitido en el campo de entrada "L√≠mite superior".
2. Introduzca el valor m√°s bajo permitido en el campo de entrada "L√≠mite inferior".

Normalizaci√≥n
Si a la entrada del proceso regulado se requiere una magnitud f√≠sica como magnitud
manipulada, los valores en coma flotante deben desnormalizarse entre 0 y 100 % al rango
f√≠sico (p. ej. 150 a 3000 rpm) de la magnitud manipulada.
Para definir la recta de normalizaci√≥n de forma un√≠voca deben definirse dos par√°metros:
‚óè el factor para la pendiente (LMN_FAC)
‚óè el offset de la recta de normalizaci√≥n en el punto cero (LMN_OFF)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

885

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Valores porcentuales internos (en formato REAL) ‚áí valores f√≠sicos externos
/01

/01B)$&
/01B2))
03

,19

El valor de normalizaci√≥n se calcula con la funci√≥n siguiente a partir del correspondiente valor
de entrada MP10:
LMN = MP10 * LMN_FAC + LMN_OFF
Ejemplo
/01
USP

USP




/01)$&

 USP
 



03

USP


/012)) USP

Dentro de la funci√≥n no se limitan valores ni se comprueban par√°metros.

Realizar una normalizaci√≥n
1. En el campo de entrada "Factor", introduzca la pendiente de la recta de normalizaci√≥n.
2. En el campo de entrada "Offset", introduzca el offset de la recta de normalizaci√≥n hacia el
punto cero.

886

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Generador de impulsos
Aplicaci√≥n
El generador de impulsos transforma la magnitud de entrada "Variable manipulada del
regulador PID en el punto de medici√≥n MP10" mediante modulaci√≥n de ancho de impulsos en
un tren de impulsos con duraci√≥n de per√≠odo constante. La duraci√≥n de un impulso por per√≠odo
es proporcional a la magnitud de entrada.
03









4326B3

W




W

&<&/(B3
3(5B70

Una magnitud de entrada del 30% y 10 llamadas del generador de impulsos por duraci√≥n de
per√≠odo significan, por tanto:
‚óè "uno" en la salida QPOS para las tres primeras llamadas (30% de 10 llamadas),
‚óè "cero" en la salida QPOS para otras siete llamadas (70% de 10 llamadas).

Modos de operaci√≥n del regulador con salida de impulsos
Dependiendo de la parametrizaci√≥n del generador de impulsos es posible configurar
reguladores PID con comportamiento de tres puntos o con salida de dos puntos bipolar o
unipolar. La siguiente tabla muestra el ajuste de las combinaciones de interruptores para los
posibles modos de operaci√≥n.
Modo de operaci√≥n

Interruptor
MAN_ON

STEP3_ON

ST2BI_ON

Regulaci√≥n de tres puntos

FALSE

TRUE

cualquiera

Regulaci√≥n de dos puntos con rango de
ajuste

FALSE

FALSE

TRUE

FALSE

FALSE

FALSE

TRUE

cualquiera

cualquiera

bipolar (de ‚Äì100 % a 100 %)
Regulaci√≥n de dos puntos con rango de
ajuste
unipolar (de 0 % a 100 %)
Modo manual

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

887

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulaci√≥n de tres puntos
En el modo de operaci√≥n "Regulaci√≥n de tres puntos" se pueden generar tres estados de la
se√±al manipulada, por ejemplo, seg√∫n actuador y proceso: m√°s ‚Äì apagado ‚Äì menos, adelante
‚Äì parado ‚Äì atr√°s, calentar ‚Äì apagado ‚Äì enfriar, etc. Seg√∫n los requisitos del proceso que se
desea regular se asignan los valores de estado de las se√±ales de salida binarias QPOS_P y
QNEG_P a los respectivos estados operativos del actuador. La tabla muestra dos ejemplos.
calentar

apagado

enfriar

adelante

parado

atr√°s

QPOS_P

TRUE

FALSE

FALSE

QNEG_P

FALSE

FALSE

TRUE

El dimensionado de la duraci√≥n m√≠nima de impulso o pausa P_B_TM_P puede evitar tiempos
de conexi√≥n o desconexi√≥n muy cortos que merman la vida √∫til de los elementos de
conmutaci√≥n y los dispositivos de control. Para ello se sobrepone un valor de reacci√≥n para la
salida de impulsos a la caracter√≠stica de salida proporcional mediante la que se calcula la
duraci√≥n de impulso.
Nota
Se suprimen valores absolutos peque√±os de la magnitud de entrada "Variable manipulada del
regulador PID en el punto de medici√≥n MP10" que podr√≠an generar una duraci√≥n de impulso
menor que P_B_TM_P. Para los valores de entrada grandes, que generar√≠an una duraci√≥n de
impulso mayor que PER_TM_P ‚Äì P_B_TM_P, se ajusta la duraci√≥n de impulso a 100% o ‚Äì
100%.
Se recomiendan valores de ajuste P_B_TM_P ‚â§ 0,1 * PER_TM_P.


7LHPSRGHFRQH[L¬µQP¬ØQ
3B%B70B3

7LHPSRGHGHVFRQH[L¬µQP¬ØQ
3B%B70B3
3(5B70B3

3(5B70B3

3(5B70B3

La duraci√≥n de los impulsos positivos o negativos se calcula multiplicando la magnitud de
entrada "Variable manipulada del regulador PID en el punto de medici√≥n MP10" (en %) por el
per√≠odo:
'XUDFL¬µQGHLPSXOVR

03


3(5B70B3>V@

Debido a la supresi√≥n de la duraci√≥n m√≠nima de impulso o pausa, se forman puntos de inflexi√≥n
en el √°rea inicial y final de la caracter√≠stica de conversi√≥n.
Lo dicho anteriormente tambi√©n es v√°lido para P_B_TM_N y PER_TM_N.

888

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
'XUDFL¬µQGHLPSXOVRSRVLWLYR

6LHPSUHFRQHFWDGR

3(5B70B3
3(5B70B33B%B70B3



3B%B70B3

6LHPSUHGHVFR
QHFWDGR
3B%B70B1

03


3(5B70B13B%B70B1
3(5B70B1
'XUDFL¬µQGHLPSXOVRQHJDWLYR

Regulaci√≥n de tres puntos asim√©trica
A trav√©s del factor de relaci√≥n RATIOFAC puede modificarse la relaci√≥n entre la duraci√≥n de
impulsos positivos y negativos. En un proceso t√©rmico, ello permite tener en cuenta p. ej.
constantes temporales de proceso distintas para calentar y para enfriar.
Si se desea acortar la duraci√≥n de impulso en la salida de impulso negativo con respecto al
impulso positivo y si el valor absoluto "Variable manipulada del regulador PID en el punto de
medici√≥n MP10" es id√©ntico, se debe introducir un factor de relaci√≥n menor que 1:
,PSXOVRSRV!LPSXOVRQHJ5$7,2)$&
'XUDFL¬µQGHLPSXOVR
QHJDWLYR

03


3(5B70B1

'XUDFL¬µQGHLPSXOVR
SRVLWLYR

03


3(5B70B1

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

5$7,2)$&

889

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
'XUDFL¬µQGHLPSXOVR
SRVLWLYR
3(5B70B3
3(5B70B33B%B70B3





3B%B70B3

03
3B%B70B1



3(5B70B13B%B70B1
3(5B70B1
'XUDFL¬µQGHLPSXOVR
QHJDWLYR

Figura 3-4

Caracter√≠stica asim√©trica del regulador de tres puntos (factor de relaci√≥n = 0,5)

Si, por el contrario, se desea acortar la duraci√≥n de impulso en la salida de impulso positivo con
respecto al impulso negativo y si el valor absoluto |MP10| es id√©ntico, se debe introducir un
factor de relaci√≥n mayor que 1:
,PSXOVRSRVLPSXOVRQHJ5$7,2)$&!
'XUDFL¬µQGHLPSXOVR
QHJDWLYR

03


'XUDFL¬µQGHLPSXOVR
SRVLWLYR

03 3(5B70B3
 5$7,2)$&

3(5B70B1

En lo que respecta al c√°lculo, esto significa que con RATIOFAC < 1 el valor de reacci√≥n para
impulsos negativos se debe multiplicar por el factor de relaci√≥n y que con RATIOFAC > 1 el
valor de reacci√≥n para impulsos positivos se debe dividir por el factor de relaci√≥n.
Nota
En la regulaci√≥n de tres puntos asim√©trica RATIOFAC ‚â† 1, los l√≠mites de la variable manipulada
deben ajustarse de acuerdo con las f√≥rmulas siguientes:
RATIOFAC < 1:
LMN_HLM = 100
LMN_LLM = ‚Äì100 * (1 / RATIOFAC)
RATIOFAC > 1:
LMN_HLM = 100 * RATIOFAC
LMN_LLM = ‚Äì100

890

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Ejemplos:
RATIOFAC
LMN_HLM
LMN_LLM

=
=
=

1
100
‚Äì100

RATIOFAC
LMN_HLM
LMN_LLM

=
=
=

0.5
100
‚Äì200

RATIOFAC
LMN_HLM
LMN_LLM

=
=
=

2.0
200
‚Äì100

Regulaci√≥n de dos puntos
En la regulaci√≥n de dos puntos solo se conecta la salida de impulsos positiva QPOS_P al
actuador de conexi√≥n/desconexi√≥n en cuesti√≥n. Dependiendo del rango de ajuste utilizado,
MP10 = -100,0% a +100,0% o MP10 = 0,0% a 100,0%, el regulador de dos puntos tiene un
rango de ajuste bipolar o unipolar.
En el modo de operaci√≥n unipolar, MP10 solo debe adoptar valores entre 0,0% y 100,0%.
'XUDFL¬µQGHLPSXOVRSRVLWLYR
3(5B70B3
3(5B70B33B%B70B3

3B%B70B3




03

En el modo de operaci√≥n bipolar, MP10 solo debe adoptar valores entre -100,0% y -100,0%.
'XUDFL¬µQGHLPSXOVRSRVLWLYR

6LHPSUHFRQHFWDGR

3(5B70B3
3(5B70B33B%B70B3

6LHPSUHGHVFR
QHFWDGR
3B%B70B3




03


En QNEG_P est√° disponible la se√±al de salida negada para el caso en que la interconexi√≥n del
regulador de dos puntos en el lazo de regulaci√≥n exige una se√±al binaria invertida l√≥gicamente
para los impulsos de la se√±al manipulada.
ON

OFF

QPOS_P

TRUE

FALSE

QNEG_P

FALSE

TRUE

Tiempo de muestreo del regulador CYCLE y ancho de impulso CYCLE_P
Si ha activado la etapa de formaci√≥n de impulsos (PULSE_ON = TRUE), ser√° necesario
especificar el ciclo del OB de alarma c√≠clica invocante en la entrada CYCLE_P. La duraci√≥n del
impulso generado siempre asciende a un m√∫ltiplo entero de este valor.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

891

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
En la entrada CYCLE se especifica el tiempo de muestreo para las dem√°s funciones de
regulaci√≥n del PID_CP. PID_CP determina la reducci√≥n del ciclo y procesa las funciones de
regulaci√≥n con el tiempo de muestreo CYCLE.
CYCLE debe ser un m√∫ltiplo entero de CYCLE_P. Si no se cumple esta condici√≥n, PID_CP
redondea el tiempo de muestreo para las funciones de regulaci√≥n a un m√∫ltiplo entero de
CYCLE_P. Las funciones dependientes del tiempo (p. ej. filtrado, integraci√≥n, diferenciaci√≥n)
no trabajan con toda la correcci√≥n en este caso.
CYCLE puede ser menor que la duraci√≥n de per√≠odo PER_TM_P o PER_TM_N. Esto es
aconsejable si, por un lado, se desea una duraci√≥n de per√≠odo lo m√°s grande posible para
proteger los actuadores y, por otro lado, el tiempo de muestreo debe ser peque√±o porque el
sistema regulado es r√°pido.
Un valor adecuado para el tiempo de muestreo CYCLE es, al igual que en el regulador continuo
sin etapa de formaci√≥n de impulsos, que CYCLE no debe ser menor que aprox. el 10% de las
constantes de tiempo dominantes en el sistema regulado.
Ejemplo de los efectos de los par√°metros CYCLE_P, CYCLE y PER_TM_P o PER_TM_N:
‚óè PER_TM_P = 10 s, CYCLE = 1 s, CYCLE_P = 100 ms.
Cada segundo se calcula una nueva variable manipulada, cada 100 ms se produce la
comparaci√≥n de la variable manipulada con la longitud de impulso o pausa emitida hasta
entonces.
Cuando se emite un impulso y la variable manipulada calculada es mayor que la longitud de
impulso actual / PER_TM_P, se prolonga el impulso. En caso contrario, no se emiten m√°s
se√±ales de impulso. Si no se emite ning√∫n impulso y (100% - variable manipulada calculada)
es mayor que la longitud de pausa actual / PER_TM_P, se prolonga la pausa. En caso contrario
se emite una se√±al de impulso.
Debido a un procedimiento especial de formaci√≥n de impulsos, un aumento o una reducci√≥n de
la magnitud manipulada durante el per√≠odo provoca una prolongaci√≥n o reducci√≥n del impulso
emitido, respectivamente. Si, en este caso (CYCLE < PER_TM_P), la duraci√≥n de per√≠odo se
ha parametrizado tan grande que provocar√≠a una oscilaci√≥n del valor real, la duraci√≥n de
per√≠odo efectiva de PID_CP se reduce autom√°ticamente a un valor adecuado.

Precisi√≥n de la formaci√≥n de impulsos
La duraci√≥n de per√≠odo PER_TM no es id√©ntica al ciclo de procesamiento del generador de
impulsos. Una duraci√≥n de per√≠odo se compone de varios ciclos de procesamiento del
generador de impulsos. El n√∫mero de llamadas del generador de impulsos por duraci√≥n de
per√≠odo es una medida para la precisi√≥n del ancho de impulso.
Cuanto menor sea el tiempo de muestreo CYCLE_P en comparaci√≥n con la duraci√≥n de
per√≠odo PER_TM_P (o PER_TM_N), m√°s exacta ser√° la modulaci√≥n de ancho de impulsos.
Para una regulaci√≥n con una precisi√≥n suficiente debe cumplirse la condici√≥n siguiente:
&<&/(B3‡∏∑

892

3(5B70


Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Realizaci√≥n de tiempos de muestreo muy cortos
En un sistema regulado r√°pido son necesarios tiempos de muestreo muy cortos (p. ej. 10 ms).
A causa del tiempo de ejecuci√≥n del programa, en este caso no es aconsejable procesar los
elementos de la regulaci√≥n en el mismo OB de alarma c√≠clica que el c√°lculo de la salida de
impulsos. Es mejor trasladar el procesamiento de las funciones de regulaci√≥n al OB 1 o a un
OB de alarma c√≠clica m√°s lento. El procesamiento de la funci√≥n de regulaci√≥n en el OB 1 solo
tiene sentido si el tiempo de ciclo del OB 1 es claramente inferior al tiempo de muestreo CYCLE
del regulador.
Mediante el par√°metro SELECT se especifica la parte del programa que debe procesarse. La
siguiente tabla ofrece una visi√≥n de conjunto de la parametrizaci√≥n del par√°metro de entrada
SELECT:
SELECT

Funcionalidad utilizada en el bloque

M√©todo subyacente

0

Elemento de regulaci√≥n y salida de impulsos

Elemento de regulaci√≥n y salida de
impulsos en el mismo bloque

1

Llamada en el OB 1 (elemento de regulaci√≥n)

2

Llamada en el OB de alarma c√≠clica
(salida de impulsos)

Elemento de regulaci√≥n en el OB 1,
salida de impulsos en el OB de alar‚Äê
ma c√≠clica r√°pido

3

Llamada en el OB de alarma c√≠clica lento (elemen‚Äê Elemento de regulaci√≥n en el OB de
to de regulaci√≥n)
alarma c√≠clica lento, salida de impul‚Äê
Llamada en el OB de alarma c√≠clica r√°pido (salida sos en el OB de alarma c√≠clica r√°pido

2

de impulsos)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

893

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
A continuaci√≥n se explican con detalle los m√©todos citados en la tabla superior para conseguir
anchos de impulso muy cortos.
‚óè Funci√≥n de regulaci√≥n en el OB 1, salida de impulsos en el OB de alarma c√≠clica
Cuando se llama con SELECT = 2 se calcula la salida de impulsos y se comprueba si el
tiempo de muestreo parametrizado en CYCLE ha transcurrido desde el √∫ltimo
procesamiento del elemento de regulaci√≥n. Si dicho tiempo de muestreo ha transcurrido,
PID_CP escribe la variable QC_ACT en el DB de instancia con el valor TRUE.
Cuando se llama con SELECT = 1 se eval√∫a la variable QC_ACT en el DB de instancia: Si
QC_ACT tiene el valor FALSE, el bloque finaliza inmediatamente; as√≠ pues, ha necesitado
un tiempo de ejecuci√≥n muy corto. Si QC_ACT tiene el valor TRUE, el elemento de
regulaci√≥n se ejecuta una vez y, seguidamente, QC_ACT vuelve a ponerse a cero.
Este procedimiento hace que el tiempo de muestreo para la funci√≥n de regulaci√≥n no pueda
respetarse con exactitud. Oscila alrededor del tiempo de ejecuci√≥n del OB 1 (incluidas
todas las interrupciones). Por consiguiente, este procedimiento solo es adecuado si el
tiempo de ejecuci√≥n del OB 1 es peque√±o en comparaci√≥n con el tiempo de muestreo
CYCLE.
‚óè Funci√≥n de regulaci√≥n en el OB de alarma c√≠clica lento, salida de impulsos en el OB de
alarma c√≠clica r√°pido
Si se llama con SELECT = 2 se calcula siempre la salida de impulsos.
Si se llama con SELECT = 3 se calcula siempre el elemento de regulaci√≥n.
Nota
Para no tener que programar dos veces la llamada de la instrucci√≥n PID_CP con los
muchos operandos formales que contiene, es recomendable programarla una sola vez en
una FC que tambi√©n tenga como par√°metro de entrada un par√°metro SELECT. Este
par√°metro de entrada se interconecta con PID_CP.SELECT. En tal caso, en el OB 1 o en
el OB de alarma c√≠clica solo debe llamarse dicha FC.
Este procedimiento facilita los cambios y ahorra memoria de programa.

Puesta en servicio de PID_CP
Realizar una optimizaci√≥n manual
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.
‚óè MAN_ON = FALSE

Procedimiento
Para determinar manualmente los par√°metros PID √≥ptimos, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo
"Medici√≥n activada".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se establece. Los valores actuales de
consigna, valor real y variable manipulada se graban.
2. Introduzca par√°metros PID nuevos en los campos "P", "I", "D" y "Tiempo de retardo".

894

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Haga clic en el grupo "Optimizaci√≥n" en el s√≠mbolo

"Enviar par√°metros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna" .
5. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
s√≠mbolo .
Si la velocidad de cambio de la consigna est√° limitada, se conmuta suavemente a la nueva
consigna.
6. En caso necesario, desactive la casilla de verificaci√≥n "Modo manual".
El regulador trabaja con los nuevos par√°metros PID y regula seg√∫n la nueva consigna.
7. Compruebe la calidad de los par√°metros PID bas√°ndose en la evoluci√≥n de las curvas.
8. Repita los pasos del 3 hasta el 8, hasta que est√© satisfecho con el resultado de la regulaci√≥n.

Puesta en servicio con el PID Self Tuner
La instrucci√≥n PID_CP se pone en servicio con el PID Self-Tuner y se determinan los
par√°metros PID √≥ptimos.

Procedimiento
Para poner en servicio un regulador continuo, proceda del siguiente modo:
1. Llame la instrucci√≥n PID_CP en un OB de alarma c√≠clica e interconecte los par√°metros de
entrada y salida.
2. Llame la instrucci√≥n TUN_EC en el mismo OB de alarma c√≠clica.
3. Interconecte la instrucci√≥n TUN_EC con PID_CP del siguiente modo:
‚Äì TUN_EC.PV con PID_CP.PV
‚Äì TUN_EC.LMN con PID_CP.LMN
‚Äì TUN_EC.SP_OUT con PID_CP.SP_IN o PID_CP.SP_EXT
‚Äì TUN_EC.GAIN con PID_CP.GAIN
‚Äì TUN_EC.TI con PID_CP.TI
‚Äì TUN_EC.TD con PID_CP.TD
‚Äì TUN_EC.TM_LAG con PID_CP.TM_LAG
‚Äì Si se utiliza un regulador de tres puntos, TUN_EC.RATIOFAC con PID_CP.RATIOFAC
‚Äì TUN_EC.QMAN_ON con PID_CP.MAN_ON
4. Haga clic en el s√≠mbolo
en la instrucci√≥n TUN_EC.
Se abre el editor de puesta en servicio para TUN_EC. El funcionamiento del editor de
puesta en servicio se describe en el PID Self-Tuner.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

895

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3.5.1.2

Utilizar PID_ES

Objeto tecnol√≥gico PID_ES
El objeto tecnol√≥gico PID_ES proporciona un regulador paso a paso para los modos
autom√°tico y manual. Equivale al bloque de datos de instancia de la instrucci√≥n PID_ES. Es
posible configurar los siguientes reguladores:
‚óè Regulaci√≥n de valor fijo con regulador P, PI, PD y PID paso a paso
‚óè Regulador paso a paso con y sin realimentaci√≥n de posici√≥n
‚óè Regulaci√≥n de valor fijo con control anticipativo
‚óè Regulaci√≥n en cascada con regulador paso a paso en el lazo subsiguiente
‚óè Regulaci√≥n de relaci√≥n de dos lazos
‚óè Regulaci√≥n de mezcla
Se configuran las funciones siguientes del objeto tecnol√≥gico PID_ES:
‚óè Normalizaci√≥n de la se√±al de valor real
‚óè Supresi√≥n de oscilaciones de alta frecuencia en la rama del valor real mediante filtrado
(retardando) de la se√±al del valor real.
‚óè Linealizaci√≥n de funciones cuadr√°ticas del valor real (regulaci√≥n de caudal con sensores de
presi√≥n diferencial)
‚óè Llamada de "funciones propias" en la rama del valor real
‚óè Vigilancia de rebase por exceso de los l√≠mites de alarma y advertencia del valor real
‚óè Vigilancia de la velocidad de cambio del valor real
‚óè Modificaci√≥n de la consigna por el generador ramp soak
‚óè Normalizaci√≥n de una se√±al de consigna externa en las regulaciones de relaci√≥n
‚óè Llamada de "funciones propias" en la rama de la consigna
‚óè Limitaci√≥n de la velocidad de cambio de la consigna
‚óè Limitaci√≥n de los valores absolutos de la consigna
‚óè Filtrado de la se√±al de error de regulaci√≥n por una zona muerta
‚óè Vigilancia de rebase por exceso de los l√≠mites de alarma y advertencia del error de
regulaci√≥n
‚óè Acciones P, I y D activables individualmente
‚óè Efecto P y D opcional en la rama de realimentaci√≥n del regulador.
‚óè Control anticipativo
‚óè Aplicaci√≥n de la realimentaci√≥n de posici√≥n
‚óè Control de la variable manipulada en modo manual desde una programadora o un
dispositivo HMI
‚óè Limitaci√≥n de los valores absolutos de la variable manipulada
‚óè Consideraci√≥n de tiempos espec√≠ficos de los actuadores al generar los impulsos

896

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

C√°lculo de error de regulaci√≥n
Valor real
Normalizaci√≥n (PV_NORM)
Mediante la casilla de verificaci√≥n "Activar periferia" se especifica la magnitud de entrada
anal√≥gica que se normaliza a la unidad f√≠sica del valor real.
‚óè Activada: la magnitud de entrada es el valor real de periferia (PV_PER)
‚óè Desactivada: la magnitud de entrada es el valor real interno (PV_IN)
Para definir la recta de normalizaci√≥n de forma un√≠voca, defina los cuatro par√°metros
siguientes:
‚óè entrada arriba (NM_PIHR)
‚óè entrada abajo (NM_PILR)
‚óè salida arriba (NM_PVHR)
‚óè salida abajo (NM_PVLR)
Los par√°metros se prestablecen seg√∫n el tipo de sensor.
El valor real se calcula con la f√≥rmula siguiente a partir del respectivo valor de entrada PV_PER
o PV_IN:
MP4 = (PV_PER - NM_PILR) √ó (NM_PVHR - NM_PVLR) / (NM_PIHR - NM_PILR) + NM_PVLR
O bien:
MP4 = (PV_IN - NM_PILR) √ó (NM_PVHR - NM_PVLR) / (NM_PIHR - NM_PILR) + NM_PVLR
03
10B39+5

10B39/5

10B3,/5

10B3,+5

39B3(5
39B,1

El valor real se emite en la variable est√°tica MP4.
No se limitan valores ni se comprueban par√°metros. Si se introduce el mismo valor para la
entrada arriba y la entrada abajo, seg√∫n las f√≥rmulas anteriores se puede producir una divisi√≥n
por cero. Esto no se considera en la instrucci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

897

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Funciones de filtro
Filtrar magnitud regulada (LAG1ST)
Para filtrar se√±ales de proceso con oscilaciones r√°pidas superpuestas (Noise) se utiliza un
elemento de retardo de primer orden en la rama del valor real. Esta funci√≥n aten√∫a en mayor
o menor grado la magnitud regulada anal√≥gica en funci√≥n de la constante de tiempo ajustada
(PV_TMLAG). De ese modo se suprimen de forma efectiva las se√±ales perturbadoras. Sin
embargo, con esta medida tambi√©n se aumenta en general la constante de tiempo de todo el
lazo de regulaci√≥n, de modo que la regulaci√≥n es m√°s lenta.
El efecto atenuador se consigue con un algoritmo de retardo de 1er orden.
La respuesta al escal√≥n en el rango de tiempo es:
outv(t) = MP4(0) (1 - e -t/PV_TMLAG)
RXWY

03 
RXWY W

W
39B70/$*

 39B70/$*

MP4(0)

la altura del escal√≥n del valor real en la entrada

outv(t)

la magnitud de salida

PV_TMLAG

la constante de tiempo de retardo

t

Tiempo

Filtrado del valor real
Si el filtrado del valor real (LAG1STON = FALSE) no est√° activado, la entrada de periferia
(PV_PER) o la entrada interna (PV_IN) se aplican sin retardo en la rama del valor real.

Tiempo de retardo
El par√°metro de entrada PV_TMLAG determina el tiempo de retardo para el valor real. Todo el
rango de valores es admisible.
Si PV_TMLAG ‚â§ 0.5 * CYCLE ya no act√∫a ning√∫n retardo.
Se requiere un tiempo de muestreo (CYCLE) de menos de una quinta parte del tiempo de
retardo para obtener un comportamiento de retardo aproximadamente equivalente al
comportamiento anal√≥gico.

898

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Calcular ra√≠z cuadrada (SQRT)
La funci√≥n "C√°lculo de la ra√≠z cuadrada" (SQRT) permite linealizar la magnitud regulada. Si el
valor real proporcionado por un enc√≥der est√° presente como magnitud f√≠sica en relaci√≥n
cuadr√°tica con la magnitud de proceso medida, el desarrollo de la magnitud regulada debe
linealizarse antes de su procesamiento en el regulador.
La se√±al de medici√≥n siempre debe linealizarse extrayendo la ra√≠z cuadrada si se realizan
mediciones de caudal con diafragmas o tubos de Venturi, etc. La presi√≥n diferencial medida
(presi√≥n efectiva) es as√≠ proporcional al cuadrado del caudal.
A trav√©s de la se√±al de entrada SQRT_ON = TRUE se activa la funci√≥n de ra√≠z cuadrada en la
rama de valor real. El algoritmo de la funci√≥n de ra√≠z cuadrada es el siguiente:
outv = SQRT (MP5) √ó (SQRT_HR ‚Äì SQRT_LR) / 10.0 + SQRT_LR
outv es el valor de salida normalizado de la funci√≥n de ra√≠z cuadrada (caudal f√≠sico).
Esta f√≥rmula presupone que el valor de entrada de la ra√≠z est√° normalizado a un rango
num√©rico entre 0 y 100. En la normalizaci√≥n del valor real deben parametrizarse el "Rango de
medida superior" y el "Rango de medida inferior" a 100.0 y 0.0, respectivamente. La ra√≠z de
este valor da como resultado un rango de medida entre 0 y 10. Este rango se normaliza
mediante el l√≠mite superior (SQRT_HR) y el l√≠mite inferior del rango de medida f√≠sico
(SQRT_LR).
RXWY

6457B+5

6457B/5
03




Ejemplo de normalizaci√≥n
El valor de entrada PV_IN del regulador es la presi√≥n diferencial en mbar:
Principio del rango de medida
NM_PILR

Fin del rango de medida
NM_PIHR

Ejemplo de valores de PV_IN

20,0 mbar

200,0 mbar

150,0 mbar

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

899

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Con la funci√≥n de normalizaci√≥n PV_NORM se calcula la presi√≥n diferencial normalizada,
seleccionando NM_PVHR = 100.0 y NM_PVLR = 0.0:
MP4

=
=
=

(PV_IN - NM_PILR) * (NM_PVHR - NM_PVLR) /
(NM_PIHR - NM_PILR) + NM_PVLR
(PV_IN - 20.0 mbar) * (100.0 - 0.0) /
(200.0 mbar - 20.0 mbar) + 0.0
(PV_IN - 20.0 mbar) * 100 / 180.0 mbar

Valor inicial de MP4

Valor final de MP4

Ejemplo de valores de MP4

0.0

100.0

72.222

En este ejemplo no se utiliza ning√∫n filtrado y, por lo tanto, rige lo siguiente: MP5 = MP4.
Para la ra√≠z de la presi√≥n diferencial normalizada MP5 resulta:
Valor inicial tras la ra√≠z

Valor final tras la ra√≠z

Ejemplo de valores de
SQRT(MP5)

0.0

10.0

8.498

Para el valor de salida normalizado outv de la funci√≥n de ra√≠z (caudal f√≠sico) sigue con
SQRT_HR = 20000.0 m3/h und SQRT_LR = 0.0 m3/h:
outv

=
=
=

SQRT(MP5) * (SQRT_HR - SQRT_LR) / 10.0 + SQRT_LR
SQRT(MP5) * (20000.0 m3/h - 0.0 m3/h) / 10.0 + 0.0 m3/h
2000.0 m3/h * SQRT(MP5)

Principio del rango de medida
outv

Fin del rango de medida outv

Ejemplo de valores de outv

0,0 m3/h

20000,0 m3/h

16996,732 m3/h

Llamada de FC en la rama de valor real (PVFC)
La inserci√≥n de una funci√≥n espec√≠fica de usuario en la rama de valor real permite someter la
magnitud regulada a un tratamiento de se√±al antes de su procesamiento en el regulador (p. ej.
un retardo de se√±al o linealizaci√≥n).

Llamar una funci√≥n
Para insertar una funci√≥n espec√≠fica de usuario en la rama del valor real, active "Activar
llamada de FC" (PVFC_ON). En el campo de entrada "N√∫mero de FC" (PVFC_NBR) se indica
el n√∫mero de la funci√≥n utilizada. El regulador ejecuta una llamada de la funci√≥n. En ella no se
suministran valores a los par√°metros de entrada y salida de la funci√≥n de usuario. La
transferencia de datos debe programarla el usuario en su funci√≥n.

900

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
El valor de salida de la funci√≥n puede observarse en la variable est√°tica MP6.
Nota
No se comprueba si una funci√≥n est√° disponible. Si la funci√≥n no est√° disponible, la CPU pasa
a STOP con un error interno de sistema.

Alarma
Vigilar los l√≠mites del valor real (PV_ALARM)
Si se rebasan por exceso o defecto determinados valores de las magnitudes del proceso
(como velocidad, presi√≥n, nivel de llenado, temperatura, etc.), en las regulaciones pueden
producirse estados no permitidos de proceso o instalaci√≥n. En estos casos se aplica la
vigilancia de los l√≠mites del valor real (PV_ALARM) para controlar si el valor real rebasa el
rango de servicio admisible por exceso o por defecto. Los rebases de l√≠mite se registran y
notifican a fin de activar una respuesta adecuada.
Nota
La vigilancia de los l√≠mites del valor real no puede desactivarse. El rebase por exceso de los
l√≠mites configurados se notifica siempre.
La vigilancia de los l√≠mites del valor real (PV_ALARM) vigila la magnitud regulada PV(t) en
funci√≥n de cuatro l√≠mites predefinibles en dos zonas de tolerancia. Cuando los l√≠mites se
alcanzan o rebasan, la funci√≥n notifica "Advertencia" en el primer l√≠mite y "Alarma" en el
segundo.

Valores l√≠mite
Los valores num√©ricos de los l√≠mites se ajustan en los par√°metros de entrada para
"Advertencia" y "Alarma". Si el valor real (PV) rebasa estos l√≠mites por exceso o defecto, se
activan los bits de aviso de salida correspondientes para la alarma superior (QPVH_ALM), la
advertencia superior (QPVH_WRN), la advertencia inferior (QPVL_WRN) y la alarma inferior
(QPVL_ALM).
Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
QPVH_ALM

QPVH_WRN

QPVL_WRN

QPVL_ALM

si:

y:

TRUE

TRUE

FALSE

FALSE

PV ‚Üó

PV ‚â• PVH_ALM

PV ‚Üò

PV ‚â• PVH_ALM - PV_HYS

PV ‚Üó

PV ‚â• PVH_WRN

PV ‚Üò

PV ‚â• PVH_WRN - PV_HYS

FALSE

TRUE

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

FALSE

FALSE

901

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
QPVH_ALM

QPVH_WRN

QPVL_WRN

QPVL_ALM

si:

y:

FALSE

FALSE

TRUE

FALSE

PV ‚Üò

PV ‚â§ PVL_WRN

PV ‚Üó

PV ‚â§ PVL_WRN + PV_HYS

PV ‚Üò

PV ‚â§ PVL_ALM

PV ‚Üó

PV ‚â§ PVL_ALM + PV_HYS

FALSE

FALSE

TRUE

TRUE

Para que el bloque funcione de manera eficiente debe aplicarse lo siguiente:
alarma superior < advertencia superior < advertencia inferior < alarma inferior
39

39 W

39B+<6

39+B$/0
39+B:51




39/B:51
39/B$/0
W

439+B$/0
439+B:51
439/B:51
439/B$/0

‚ë†
‚ë°

1. banda de tolerancia
2. banda de tolerancia

Hist√©resis
Para impedir que los bits de aviso "centelleen" con cambios muy peque√±os de la magnitud de
entrada o con errores de redondeo, se ajusta una hist√©resis (diferencia de desactivaci√≥n)
PV_HYS. La magnitud regulada debe superar la hist√©resis antes de que los bits de aviso se
desactiven.

902

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Vigilar la velocidad de cambio del valor real (ROCALARM)
Si el cambio de la magnitud de proceso (p. ej. velocidad, presi√≥n, nivel de llenado, temperatura,
etc.) es demasiado elevada, en las regulaciones pueden producirse estados no permitidos de
proceso o instalaci√≥n. En estos casos se aplica la vigilancia de la velocidad de cambio del valor
real (ROCALARM) para controlar si el valor real rebasa por exceso o por defecto una velocidad
de cambio admisible. Los rebases de l√≠mite se registran y notifican a fin de activar una
respuesta adecuada.
Nota
La vigilancia de la velocidad de cambio del valor real (ROCALARM) no puede desactivarse. El
rebase por exceso de los l√≠mites configurados se notifica siempre.
La funci√≥n ROCALARM vigila la magnitud regulada PV(t) respecto a l√≠mites admisibles de
velocidad de cambio, los cuales pueden ajustarse de forma diferente seg√∫n el signo
correspondiente.
Los valores num√©ricos de las pendientes l√≠mite se ajustan en los par√°metros de entrada
"Rampa de subida m√°xima" y "Rampa de bajada m√°xima" en el rango positivo y negativo de
la magnitud regulada. Las pendientes se refieren a la subida o bajada en porcentaje por
segundo. Si la velocidad de cambio de la magnitud regulada supera estos l√≠mites, se activan
los bits de aviso de salida correspondientes QPVURLMP ... QPVDRLMN.
39

39 W
3985/0B3
39'5/0B3
39'5/0B1
3985/0B1

W

3985/0B1

43985/0B3
439'5/0B3
439'5/0B1
43985/0B1

La identificaci√≥n de los par√°metros de las rampas se realiza seg√∫n el siguiente esquema:
Par√°metro

Cambio de PV

Rampa de subida m√°xima en el
rango positivo (PVURLM_P)

PV > 0 y |PV| ascendente

Rampa de bajada m√°xima en el
rango positivo (PVDRLM_P)

PV > 0 y |PV| descendente

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

903

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Par√°metro

Cambio de PV

Rampa de subida m√°xima en el
rango negativo (PVURLM_N)

PV < 0 y |PV| ascendente

Rampa de bajada m√°xima en el
rango negativo (PVDRLM_N)

PV < 0 y |PV| descendente

Consigna
Definir la consigna
Seleccione un origen para la consigna. Las posibilidades son las siguientes:
‚óè Consigna interna
El par√°metro de entrada SP_INT se utiliza como consigna
‚óè Generador de consigna
El par√°metro de entrada SP_INT se utiliza como consigna y puede aumentarse o
disminuirse mediante las variables est√°ticas SPUP y SPDN.
‚óè Generador ramp soak
El par√°metro de entrada SP_INT se utiliza como consigna y puede modificarse siguiendo
un perfil predefinido.
‚óè Consigna externa
En los reguladores de mezcla, relaci√≥n y cascada se utiliza el par√°metro de entrada
SP_EXT como consigna. La consigna externa puede normalizarse.
En el par√°metro de salida SP se muestra la consigna efectiva.

Consulte tambi√©n
Generador ramp soak (RMP_SOAK) (P√°gina 906)

Generador de consigna (SP_GEN)
La consigna interna SP_INT se aumenta o disminuye progresivamente utilizando los
interruptores SPUP y SPDN. El valor modificado puede observarse en MP1. Se tienen en
cuenta los l√≠mites configurados de la consigna.

Repercusi√≥n de los interruptores SPUP y SPDN
Para poder realizar un cambio graduado finamente, el regulador debe tener un tiempo de
muestreo de 100 ms como m√°ximo.

904

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
La velocidad de cambio de la magnitud de salida depende de la duraci√≥n de pulsaci√≥n de los
interruptores SPUP y SPDN as√≠ como de los l√≠mites ajustados de acuerdo con la relaci√≥n
siguiente:
‚óè durante los primeros 3 segundos despu√©s de activar SPUP o SPDN rige:
doutv/dt = (SP_HLM - SP_LLM) / 100 s
‚óè a continuaci√≥n
doutv/dt = (SP_HLM - SP_LLM) / 10 s
RXWY
63B+/0

V
W
V

V

63B//0

6383

63'1

W
V
W

Con un tiempo de muestreo de 100 ms y un rango de consigna de -100,0 a 100,0, la consigna
cambia en 0,2 por ciclo en los tres primeros segundos, por ejemplo. Si SPUP permanece en
TRUE durante m√°s de 3 segundos, la velocidad de cambio aumenta a diez veces el valor, en
este caso a 2 por ciclo.

Arranque y funcionamiento del generador de consigna
‚óè Durante el rearranque la salida outv se pone a 0.0.
‚óè Al activar el generador de consigna (SPGEN_ON = TRUE), en la salida outv se muestra
primero el valor de se√±al SPFC_IN. Por este motivo, la conmutaci√≥n al generador de
consigna desde otro modo de operaci√≥n se produce siempre suavemente. Mientras los
interruptores SPUP y SPDN (teclas arriba y abajo) no se activan, SPFC_IN permanece en
la salida.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

905

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Par√°metros de la funci√≥n SP_GEN
El par√°metro de salida outv es un par√°metro impl√≠cito. Este puede observarse en la
herramienta de configuraci√≥n mediante el punto de medici√≥n MP1.
Par√°metro

Significado

Rango admisible

SPFC_IN

Consigna de la entrada de FC

Rango t√©cnico

SP_INT

Consigna interna

Rango t√©cnico

63B*(1

63*(1B21 %22/

)$/6(

6383

%22/

)$/6(

63'1

%22/

)$/6(

63B+/0

5($/



63B//0

5($/




63)&B,1

5($/



RXWY




63B,17

Figura 3-5

5($/

03

5($/





Esquema funcional y par√°metros del generador de consigna

Generador ramp soak (RMP_SOAK)
Si la consigna SP_INT debe cambiar por s√≠ misma en funci√≥n del tiempo, p. ej. en la regulaci√≥n
de procesos conforme a un programa de temperatura controlado por tiempo, es posible
hacerlo configurando un perfil y activando el generador ramp soak. El cambio de la consigna
se calcula a partir de segmentos con un m√°ximo de 256 nodos.
Nota
La funci√≥n del bloque no comprueba si existe un DB global con el n√∫mero "DB_NBR" ni
tampoco si el par√°metro "N√∫mero de nodos" NBR_PTS coincide con la longitud del DB. Si la
parametrizaci√≥n es incorrecta, la CPU cambia al estado STOP con un error de sistema interno.

906

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Funcionamiento del generador ramp soak
El generador ramp soak proporciona una funci√≥n de la magnitud de salida outv que se ejecuta
de acuerdo con una programaci√≥n determinada. El desarrollo del perfil se define con una serie
de nodos en un bloque de datos global DB_RMPSK con los valores de tiempo PI[i].TMV y los
correspondientes valores de salida PI[i].OUTV.
‚óè PID-CP
AUTOHOTSPOT no est√° incluido en la librer√≠a. Debe crear usted mismo este bloque de
datos global.
‚óè PID-ES
AUTOHOTSPOT no est√° incluido en la librer√≠a. Debe crear usted mismo este bloque de
datos global.
La figura siguiente muestra un perfil con 6 nodos.
RXWY
3,>@2879
3,>@2879




RXWY W

3,>@2879
3,>@2879








3,>@709

W
3,>@709

3,>@2879 
3,>@2879
3,>@709

3,>@709
3,>@709

3,>@709

3,>@709

PV

Para el √∫ltimo nodo n, el valor de tiempo PI[n].TMV = 0 ms. El tiempo de procesamiento de un
perfil se calcula partiendo del valor inicial y descendiendo hasta cero.
PI[i].TMV indica los intervalos entre nodo y nodo. Entre los nodos se interpola de acuerdo con
la funci√≥n siguiente:
RXWY W  3,>Q@2879

56B70
3,>Q@709

3,>Q@28793,>Q@2879 

0 ‚â§ n ‚â§ (NBR_PTS - 1)
1RGR

3,>@2879
3,>@709

RXWY

1RGR

3XQWRLQLFLDO

3,>@2879
3,>@709

3,>@2879
3,>@709

3,>@709

3,>@709

3,>@709
W

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

907

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Nota
Nota
Al interpolar la curva de evoluci√≥n entre los nodos, es posible que el valor de salida se
mantenga temporalmente fijo si resulta que el tiempo de muestreo CYCLE es muy peque√±o
con respecto al tiempo entre los nodos PI[n].TMV. El generador ramp soak no puede linealizar
curvas planas debido a la precisi√≥n de c√°lculo de la CPU. Si la curva es demasiado plana, el
valor de salida permanece por un tiempo en el nodo correspondiente y, pasado cierto tiempo,
se integra en el pr√≥ximo nodo con la pendiente m√≠nima.
Soluci√≥n: reduzca el tiempo entre los nodos insertando m√°s nodos. De este modo, la curva
emitida se acercar√° a la curva plana deseada en forma de trapecio.

Activar el generador ramp soak
Con el cambio RMPSK_ON de FALSE a TRUE se activa el generador ramp soak. Una vez
alcanzado al √∫ltimo nodo se termina el perfil. Cuando el operador reinicia la funci√≥n, es
necesario poner primero RMPSK_ON a 'FALSE' y a continuaci√≥n a 'TRUE'.
En el rearranque, la salida outv se pone a 0.0 y se determina el tiempo total o el tiempo residual
total. En la transici√≥n al modo normal, la curva de evoluci√≥n se procesa inmediatamente desde
el punto inicial de acuerdo con el modo de operaci√≥n ajustado. Si no se desea que esto suceda,
el par√°metro RMPSK_ON debe ponerse a FALSE en el OB de rearranque.

Funciones del generador ramp soak
La instrucci√≥n dispone de las funciones siguientes:
‚óè Activar generador ramp soak para ejecuci√≥n √∫nica
‚óè Preasignar salida con valor fijo
‚óè Activar repetici√≥n c√≠clica
‚óè Detener generador ramp soak
‚óè Continuar generador ramp soak
‚óè Actualizar tiempo total de procesamiento y tiempo residual total
Para ajustar el modo de operaci√≥n deseado se aplica la valencia de las entradas de control
especificada en la siguiente tabla:
Modo de operaci√≥n

RMPSK_
ON

DFOUT_ RMP_
ON
HOLD

CONT_
ON

CYC_
ON

TUPDT_
ON

Se√±al de salida OUTV

Activar generador ramp
soak

TRUE

FALSE

**)

FALSE

**)

OUTV(t)

Especificar salida

TRUE

FALSE

El valor final se mantiene
tras el final de procesamien‚Äê
to.

Activar repetici√≥n c√≠clica TRUE

TRUE

**)

**)

**)

**)

DF_OUTV

FALSE

FALSE

**)

TRUE

**)

OUTV(t)
Tras final: arranque auto‚Äê
m√°tico

908

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Modo de operaci√≥n

RMPSK_
ON

DFOUT_ RMP_
ON
HOLD

CONT_
ON

CYC_
ON

TUPDT_
ON

Se√±al de salida OUTV

Detener generador
ramp soak

TRUE

FALSE

TRUE

FALSE

**)

**)

se mantiene el valor actual
de OUTV(t) *)

Continuar generador
ramp soak

TRUE

FALSE

TRUE

TRUE

**)

**)

OUTV (antiguo) *)

Actualizar el tiempo to‚Äê
tal y el tiempo residual
total

**)

FALSE
**)

Se sigue con los nuevos va‚Äê
lores predeterminados.

**)

**)

**)

FALSE

No influye en OUTV

TRUE

No influye en OUTV

*) Hasta el pr√≥ximo nodo la curva no tiene la forma parametrizada por el usuario.
**) El modo de operaci√≥n ajustado en cada caso se ejecuta independientemente de la valencia de las se√±ales de control en
los campos marcados con **)

Especificar la salida del generador ramp soak
Si se activa esta funci√≥n (DFRMP_ON = TRUE), el valor de salida del generador ramp soak se
pone al valor de se√±al SP_INT o al valor de salida SP_GEN.
Nota
La asignaci√≥n previa con la consigna interna solo tiene efecto si el generador ramp soak est√°
activado (RMPSK_ON = TRUE).
Tras la conmutaci√≥n DFRMP_ON = FALSE, outv se lleva linealmente de la consigna ajustada
(p. ej. SP_INT) al valor de salida del n√∫mero de nodo actual PI[NBR_ATMS].OUTV.
El procesamiento interno de tiempo tambi√©n contin√∫a con una consigna fija aplicada
directamente (RMPSK_ON = TRUE y DFRMP_ON = TRUE).
Al iniciar la curva RMPSK_ON = TRUE se emite la consigna fija SP_INT hasta que
DFRMP_ON cambia de TRUE a FALSE despu√©s del tiempo T*.
5036.B21
')503B21

RXWY

63B,17


&XUYDFRQILJXUDGD
FXUYDDFWXDO



RXWY W









3,>@709
7

3,>@709

3,>@709 3,>@709
3,>@709

3,>@709

W

3,>@709 PV

45B6B$&7

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

909

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
En este momento ha transcurrido el tiempo PI[0].TMV y parte del tiempo PI[1].TMV. OUTV se
lleva de SP_INT a PI[2].OUTV, es decir, a la consigna del nodo 2.
La curva configurada se emite solo a partir del nodo 2. La coincidencia entre la curva
configurada y la actual se indica con QR_S_ACT = TRUE. Con un flanco ascendente en
DFOUT_ON durante el procesamiento de la curva, el valor de la salida OUTV salta sin retardo
a DF_OUTV.

Activar repetici√≥n c√≠clica
Cuando el modo de operaci√≥n 'Repetici√≥n c√≠clica' (CYC_ON = TRUE) est√° activado, el
generador ramp soak vuelve autom√°ticamente al punto inicial tras emitir el √∫ltimo valor de nodo
y se ejecuta de nuevo.
Entre el √∫ltimo nodo y el punto inicial no se interpola. Para una transici√≥n sin discontinuidad se
debe aplicar lo siguiente: PI[NBR_PTS].OUTV = PI[0].OUTV.

Detener generador ramp soak
Con RMP_HOLD = TRUE se congela el valor de la magnitud de salida (incluido el
procesamiento de tiempo). Cuando RMP_HOLD = FALSE se desactiva, PI[x].TMV contin√∫a en
el punto de interrupci√≥n.
503B+2/'
')503B21
7
RXWY

63B,17




&XUYDFRQILJXUDGD
FXUYDDFWXDO
YDORUHVDFWXDOHV

 RXWY W








7



3,>@709
3,>@709 3,>@709
3,>@709 3,>@709
3,>@709
3,>@709
7LHPSRFRQILJXUDGR
3,>@7097
3,>@709
7LHPSRDFWXDO

W

45B6B$&7

El tiempo de procesamiento de la curva se prolonga por el tiempo T*. La curva presenta el
desarrollo configurado desde el nodo hasta el flanco ascendente en RMP_HOLD y desde el
nodo 5* hasta el nodo 6*, es decir, la se√±al de salida QR_S_ACT tiene el valor TRUE.
Si el interruptor CONT_ON est√° activado, el generador ramp soak detenido contin√∫a en el
punto predeterminado TM_CONT con el procesamiento de la curva de desplazamiento.

910

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Continuar generador ramp soak
Con CONT_ON se contin√∫a una curva detenida en un punto definido. Si el generador ramp
soak no est√° detenido, CONT_ON no tiene efecto.
Si la entrada de control para continuar CONT_ON = TRUE est√° activada, el generador ramp
soak detenido contin√∫a en el nodo TM_SNBR. TM_CONT determina el tiempo residual que
requiere el generador hasta que se alcanza el nodo TM_SNBR.
La figura siguiente muestra la influencia de RMP_HOLD y CONT_ON con la configuraci√≥n
siguiente:
Continuar en el nodo 5 (TM_SNBR = 5) y continuar en T* s: TM_CONT = T*
1LQJXQDUHDFFL¬µQ

&217B21
503B+2/'

RXWY


7

&XUYDFRQILJXUDGD
FXUYDDFWXDOYDORUHV
DFWXDOHV



RXWY W





3,>@709 3,>@709
7LHPSRFRQILJXUDGR


3,>@709
3,>@709

7

3,>@709
3,>@709




3,>@709


W
3,>@709

7LHPSRDFWXDO
45B6B$&7

Los nodos 3 y 4 se suprimen para este ciclo de procesamiento del generador ramp soak.
Despu√©s del cambio de se√±al RMP_HOLD de TRUE a FALSE, el desarrollo configurado de la
curva solo se vuelve a alcanzar a partir del nodo 5.
La salida QR_S_ACT solo se activa cuando el generador ramp soak procesa la curva de
evoluci√≥n parametrizada por el usuario.

Actualizar el tiempo total y el tiempo residual total
En cada ciclo se actualizan el n√∫mero actual del nodo NBR_ATMS, el tiempo residual actual
hasta alcanzar el nodo RS_TM, el tiempo total T_TM y el tiempo residual total hasta alcanzar
el final de la curva RT_TM.
En caso de modificaciones online de PI[n].TMV, cambian el tiempo total y el tiempo residual
total de la curva. Ya que el c√°lculo de T_TM y RT_TM prolonga considerablemente el tiempo
de procesamiento del bloque de funci√≥n en muchos nodos, este solo se realiza despu√©s del
rearranque o si TUPDT_ON = TRUE. Los intervalos PI[0 ... NBR_PTS].TMV entre los
diferentes nodos se suman y se muestran en la salida del tiempo total T_TM y del tiempo
residual total RT_TM.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

911

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Tenga en cuenta que el c√°lculo de los tiempos totales requiere mucho tiempo de ejecuci√≥n de
la CPU.

Procedimiento
Para configurar el generador ramp soak, proceda del siguiente modo:
1. En la lista "Origen de la consigna" seleccione la entrada "Generador ramp soak".
2. Cree un AUTOHOTSPOT (PID-CP) o un AUTOHOTSPOT (PID-ES).
3. Defina los par√°metros necesarios para el perfil.
4. Introduzca el n√∫mero del bloque de datos DB_RMPSK en el campo de entrada "N√∫mero de
DB".
5. Active o desactive las dem√°s funciones del generador ramp soak.
6. Si ha activado la funci√≥n "Continuar generador ramp soak", introduzca el nodo y el tiempo
en que deba continuar el generador.

Normalizaci√≥n
Normalizaci√≥n de una consigna externa
Si la consigna externa no est√° presente en la unidad f√≠sica del valor real (p. ej. en % en una
cascada de regulador), es necesario normalizar ese valor y su rango de ajuste a la unidad f√≠sica
del valor real. Para ello se utiliza la funci√≥n "Normalizaci√≥n en la rama de consigna".
La funci√≥n SP_NORM normaliza una magnitud de entrada anal√≥gica. La consigna externa
anal√≥gica se convierte a la magnitud de salida outv con la recta de normalizaci√≥n. El valor de
salida OUTV est√° accesible en la herramienta de configuraci√≥n a trav√©s del punto de medici√≥n
MP2.
El valor de salida de la funci√≥n es efectivo cuando la entrada de control es SPEXT_ON = TRUE.
Para definir la recta de normalizaci√≥n de forma un√≠voca, defina los cuatro par√°metros
siguientes:
‚óè Entrada arriba: SP_EXT: NM_SPEHR
‚óè Entrada abajo: SP_EXT: NM_SPELR

912

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
‚óè Salida arriba: NM_PVHR (este valor se introduce en la funci√≥n de normalizaci√≥n del valor
real.)
‚óè Salida abajo: NM_PVLR (este valor se introduce en la funci√≥n de normalizaci√≥n del valor
real.)
RXWY

10B39+5

10B39/5
63B(;7
10B63(/5

10B63(+5

El valor de salida outv se calcula con la f√≥rmula siguiente a partir del correspondiente valor de
entrada SP_EXT:
outv = (SP_EXT ‚Äì NM_SPELR) x (NM_PVHR ‚Äì NM_PVLR) / (NM_SPEHR ‚Äì NM_SPELR) +
NM_PVLR
Para el caso especial de una funci√≥n de ra√≠z aplicada en la rama de valor real rigen como l√≠mite
superior e inferior del valor de salida outv los valores de normalizaci√≥n de la funci√≥n de ra√≠z
(SQRT_HR y SQRT_LR).
En ese caso, el valor de salida outv de la funci√≥n de normalizaci√≥n se calcula con la f√≥rmula
siguiente a partir del correspondiente valor de entrada SP_EXT:
outv = (SP_EXT ‚Äì NM_SPELR) x (SQRT_HR ‚Äì SQRT_LR) / (NM_SPEHR ‚Äì NM_SPELR) +
SQRT_LR
Dentro de la funci√≥n no se limitan los valores ni se comprueban los par√°metros. Si introduce
el mismo valor para NM_SPEHR y NM_SPELR, seg√∫n las f√≥rmulas anteriores se puede
producir una divisi√≥n entre cero. Esto no se considera en la instrucci√≥n.

Factor de mezcla/relaci√≥n
En una regulaci√≥n de relaci√≥n, las consignas de los lazos de regulaci√≥n se adaptan unas a
otras de forma que la relaci√≥n ajustada se corresponde con la relaci√≥n efectiva de los valores
reales.
En una regulaci√≥n de mezcla se ajusta la proporci√≥n deseada de cada uno de los
componentes. La suma de los factores de mezcla FAC debe dar 1.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

913

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para configurar la normalizaci√≥n, proceda del siguiente modo:
1. Introduzca los valores de la normalizaci√≥n en los campos de entrada "Entrada arriba" y
"Entrada abajo".
2. Introduzca un factor de mezcla/relaci√≥n (FAC).

L√≠mites
Llamada de FC en la rama de consigna
La inserci√≥n de una funci√≥n espec√≠fica de usuario en la rama de consigna permite someter una
referencia predeterminada de forma externa a un procesamiento de se√±al (p. ej. un retardo de
se√±al o linealizaci√≥n) antes de aplicarla en el regulador.
Si se activa la llamada de FC en la rama de consigna, se llama una funci√≥n espec√≠fica de
usuario. El regulador ejecuta una llamada de la FC. En ella no se suministran valores a los
par√°metros de entrada y salida de la funci√≥n de usuario ya existentes. Por ello, la transmisi√≥n
de datos debe programarse manualmente con S7-AWL en la FC de usuario. La consigna
acondicionada se observa en MP3.
En ese caso, el valor de SPFC_ON determina si en el canal de la consigna se inserta en este
punto una funci√≥n programada libremente en forma de FC est√°ndar (p. ej. una curva
caracter√≠stica) o si la consigna contin√∫a proces√°ndose sin ninguna influencia de ese tipo.
Nota
La instrucci√≥n no comprueba si hay una funci√≥n. Si la funci√≥n no est√° disponible, la CPU pasa
a STOP con un error interno de sistema.

Procedimiento
Para llamar una funci√≥n en la rama de la consigna, proceda del siguiente modo:
1. Active la casilla de verificaci√≥n "Activar llamada de FC".
2. En el campo de entrada "FC", indique el n√∫mero de la funci√≥n que se va a llamar.

Limitaci√≥n de la velocidad de cambio de la consigna
Las funciones de rampa en la rama de la consigna se utilizan en aquellos casos en que el
proceso no soporta cambios bruscos de la se√±al manipulada, ya que un cambio abrupto de la
consigna generalmente provoca tambi√©n un escal√≥n en la variable manipulada del regulador.
Estos cambios abruptos de la variable manipulada deben evitarse p. ej. en aquellos casos en
que entre el motor regulado y la carga que debe accionarse hay interpuesto un engranaje, y
una elevaci√≥n muy r√°pida del n√∫mero de revoluciones del motor derivar√≠a en una sobrecarga
del engranaje.
La funci√≥n SP_ROC limita la velocidad de cambio de las consignas procesadas en el
regulador, ya sea por separado para la rampa de subida y bajada, como por separado para los
rangos positivo y negativo de la referencia.

914

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
En las cuatro entradas SPURLM_P, SPDRLM_P, SPURLM_N y SPDRLM_N se introducen las
limitaciones correspondiente para los aumentos de la funci√≥n de rampa en los rangos positivo
y negativo de la referencia. Las rampas de subida se refieren a la subida o bajada por segundo.
Los cambios de consigna m√°s r√°pidos se retardan a estas velocidades l√≠mite.
Si p. ej. SPURLM_P se parametriza a 10.0 [rango de valores tec./s], en cada ciclo de muestreo
se suman los siguientes valores al "valor antiguo" de outv mientras inv sea > outv:
Tiempo de muestreo

1s

outvantiguo + 10

100 ms

outvantiguo + 1

10 ms

outvantiguo + 0.1

La siguiente figura muestra el funcionamiento del procesamiento de la se√±al a partir de un
ejemplo. Las funciones de escal√≥n en la entrada inv(t) se traducen en funciones de rampa en
la salida outv(t).
LQY
RXWY

LQY W

RXWY W
63'5/0B3

6385/0B3


6385/0B3
6385/0B1

W
63'5/0B1

Figura 3-6

Limitaci√≥n de la velocidad de cambio de la referencia SP(t)

No se notifica el alcance de los l√≠mites de la pendiente.

Procedimiento
Para limitar la velocidad de cambio, proceda del siguiente modo:
1. Active la casilla de verificaci√≥n "Limitar la velocidad de cambio".
2. Defina los siguientes valores tanto para el rango positivo como para el negativo:
‚Äì Rampa de subida de consigna
‚Äì Rampa de bajada de consigna

Limitaci√≥n del valor absoluto de la referencia
El rango de ajuste de la referencia determina el rango dentro del cual puede oscilar la
referencia, es decir, el margen en el que se mueve el proceso dentro de los valores de estado
admisibles.
Por ello, para evitar estados de proceso cr√≠ticos o no permitidos, Standard PID Control limita
el rango de ajuste de la referencia en la rama de consigna por arriba y por abajo (SP_LIMIT).
La funci√≥n SP_LIMIT limita la consigna SP al valor inferior y superior predeterminable SP_LLM
y SP_HLM mientras la magnitud de entrada INV est√© fuera de dichas limitaciones. Dado que

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

915

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
la funci√≥n no puede desactivarse, en la configuraci√≥n siempre hay que tener en cuenta la
indicaci√≥n de los l√≠mites inferior y superior.
Los valores num√©ricos de los l√≠mites se ajustan en los par√°metros de entrada para la limitaci√≥n
inferior y superior. Si la magnitud de entrada inv(t) rebasa los l√≠mites, se emiten las
indicaciones correspondientes a trav√©s de las salidas de aviso.
LQY
63

LQY W

63B+/0

)UDQMDGHWROHUDQFLD

W


63 W
63B//0

463B+/0
463B//0

Figura 3-7

Limitaci√≥n de valor absoluto de la referencia SP(t)

Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
SP =PVH_ALM

QSP_HLM

QSP_LLM

si:

SP_HLM

TRUE

FALSE

inv ‚â• SP_HLM

SP_LLM

FALSE

TRUE

inv ‚â§ SP_LLM

inv

FALSE

FALSE

SP_HLM < inv < SP_LLM

Procedimiento
Para limitar el valor absoluto de la referencia, proceda del siguiente modo:
1. En el campo de entrada "L√≠mite superior", indique el l√≠mite superior absoluto de la consigna
(SP_HLM).
2. En el campo de entrada "L√≠mite inferior", indique el l√≠mite inferior absoluto de la consigna
(SP_LLM).

Error de regulaci√≥n
Zona muerta

916

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
En caso de superposici√≥n de la magnitud regulada o la referencia con una se√±al perturbadora
de mayor frecuencia, en un regulador con ajuste √≥ptimo el ruido tambi√©n es efectivo en la
salida del regulador. En una amplificaci√≥n elevada del regulador y con derivaci√≥n activada, por
ejemplo, esto puede provocar importantes oscilaciones en la magnitud manipulada. Debido al
aumento de la frecuencia de conmutaci√≥n (regulador paso a paso), eso deriva en un desgaste
elevado del actuador.
En estado forzado del regulador, la funci√≥n reduce el ruido en la se√±al del error de regulaci√≥n,
disminuyendo as√≠ la oscilaci√≥n no deseada de la salida de regulador.
La zona muerta puede desactivarse.

Filtrado de se√±al por funci√≥n de zona muerta
La funci√≥n DEADBAND suprime peque√±as oscilaciones de la magnitud de entrada dentro de
un rango parametrizable alrededor de un punto cero definido. Fuera de esta franja de
oscilaciones, el error de regulaci√≥n ER aumenta o cae proporcionalmente a la magnitud de
entrada. El ancho de la zona no efectiva (zona muerta) puede definirse con el par√°metro
DEADB_W. El ancho de zona muerta solo debe tener valores positivos.
Si la magnitud de entrada se encuentra dentro de la zona muerta, se deposita el valor 0 (error
de regulaci√≥n = 0) en la salida. Solo una vez que la magnitud de entrada abandona este rango
de insensibilidad, la salida aumenta o cae la parte correspondiente a los mismos valores de la
magnitud de entrada inv. El resultado es una falsificaci√≥n de la se√±al transmitida, tambi√©n fuera
de la zona muerta. Sin embargo, esto se tolera para evitar escalones en los l√≠mites de la zona
muerta (v√©ase la siguiente figura). La falsificaci√≥n corresponde al valor DEADB_W, por lo que
es f√°cilmente controlable.
La funci√≥n DEADBAND trabaja seg√∫n las siguientes funciones:
(ER) = inv + DEADB_W para inv < - DEADB_W
(ER) = 0 para -DEADB_W ‚â§ inv ‚â§ + DEADB_W
(ER) = inv - DEADB_W para inv > + DEADB_W
(5

LQY

'($'%B:

Las repercusiones del filtrado de se√±ales se observan en el par√°metro de salida ER.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

917

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Alarma
Las desviaciones excesivas de la magnitud regulada respecto a la consigna ajustada pueden
provocar estados de proceso no deseados. En estos casos se utiliza la funci√≥n ER_ALARM
para vigilar que el error de regulaci√≥n no rebase el rango de servicio permitido por exceso ni
por defecto. ER_ALARM registra y notifica los rebases de l√≠mite ocurridos, para permitir una
respuesta adecuada.
Nota
La vigilancia de los l√≠mites del error de regulaci√≥n no puede desactivarse. El rebase por exceso
de los l√≠mites configurados se notifica siempre.
La funci√≥n ER_ALARM vigila el valor del error de regulaci√≥n ER(t) en funci√≥n de cuatro l√≠mites
predefinibles en dos zonas de tolerancia. Cuando los l√≠mites se alcanzan o rebasan, la funci√≥n
notifica primero "Advertencia" y a continuaci√≥n "Alarma" en el segundo l√≠mite.

Valores l√≠mite
Los valores num√©ricos de los l√≠mites se ajustan en los par√°metros de entrada para
"Advertencia" y "Alarma". Si el error de regulaci√≥n (ER) rebasa estos l√≠mites por exceso o
defecto, se activan los bits de aviso de salida correspondientes QERN_ALM ... QERP_ALM.
Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
QERP_ALM

QERP_WRN

QERN_WRN

QERN_ALM

si:

y:

TRUE

TRUE

FALSE

FALSE

ER ‚Üó

ER ‚â• ERP_ALM

ER ‚Üò

ER ‚â• ERP_ALM - ER_HYS

FALSE

TRUE

FALSE

FALSE

ER ‚Üó

ER ‚â• ERP_WRN

ER ‚Üò

ER ‚â• ERP_WRN - ER_HYS

FALSE

FALSE

TRUE

FALSE

ER ‚Üò

ER ‚â§ ERP_WRN

ER ‚Üó

ER ‚â§ ERP_WRN + ER_HYS

FALSE

FALSE

TRUE

TRUE

ER ‚Üò

ER ‚â§ ERP_ALM

ER ‚Üó

ER ‚â§ ERP_ALM + ER_HYS

Para que el bloque funcione de manera eficiente debe aplicarse lo siguiente:
alarma superior < advertencia superior < advertencia inferior < alarma inferior

918

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
(5

(5 W

(5B+<6

(53B$/0

l]RQDGHWROHUDQFLD

(53B:51

l]RQDGHWROHUDQFLD

W

(51B:51
(51B$/0

4(53B$/0
4(53B:51
4(51B:51
4(51B$/0

Hist√©resis
Para evitar que los bits de aviso "centelleen" con cambios muy peque√±os de la magnitud de
entrada o con errores de redondeo, se ajusta una hist√©resis (diferencia de desactivaci√≥n)
ER_HYS. El error de regulaci√≥n debe superar esta hist√©resis antes de que los bits de aviso se
desactiven.

Regulador
Algoritmo de regulaci√≥n
En el ciclo del tiempo de muestreo configurado se calcula la magnitud manipulada del
regulador continuo a partir del error de regulaci√≥n en el algoritmo de posici√≥n PID. El regulador
tiene una estructura puramente paralela. Las acciones proporcional, integral o diferencial se
pueden desconectar individualmente.
',69B6(/
',69

*$,1
(5

3

,

'

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

3B6(/

,B6(/

3,'B2879

'B6(/

919

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Control anticipativo
A la se√±al de salida del regulador PID_OUTV se le puede aplicar adicionalmente una magnitud
perturbadora DISV. La activaci√≥n o desactivaci√≥n se realiza en la ventana PID de la
herramienta de configuraci√≥n a trav√©s del conmutador de estructura DISV_SEL o mediante
"Magnitud perturbadora ON".

Acci√≥n P y D en la rama de realimentaci√≥n
En la estructura paralela, cada acci√≥n del algoritmo regulador recibe el error de regulaci√≥n
como se√±al de entrada. La magnitud manipulada es modificada directamente por la acci√≥n P
y la acci√≥n D con escalones de la consigna. Sin embargo, otra estructura del regulador en la
que la formaci√≥n de la acci√≥n P y la acci√≥n D se traslada a la realimentaci√≥n, garantiza una
evoluci√≥n suave de la magnitud manipulada en caso de variaciones del escal√≥n de la
referencia. En esta estructura la acci√≥n I procesa el error de regulaci√≥n como se√±al de entrada,
en la acci√≥n P y en la acci√≥n D solo se conecta la magnitud de regulaci√≥n negativa (factor = -1).
*$,1
(5

,

3,'B2879

3

39

'

Normalizaci√≥n de las magnitudes de entrada ER y PV
Las magnitudes de entrada ER y PV del regulador PID se normalizan antes del procesamiento
del regulador en el rango de 0 a 100, conforme a las f√≥rmulas siguientes:
‚óè con funci√≥n de ra√≠z desactivada (SQRT_ON = FALSE):
‚Äì ERnormalizado = ER * 100.0 / (NM_PVHR ‚Äì NM_PVLR)
‚Äì PVnormalizado = (PV - NM_PVLR) * 100.0 / (NM_PVHR ‚Äì NM_PVLR)
‚óè con funci√≥n de ra√≠z activada (SQRT_ON = TRUE):
‚Äì ERnormalizado = ER * 100.0 / (SQRT_HR ‚Äì SQRT_LR)
‚Äì PVnormalizado = (PV - SQRT_LR) * 100.0 / (SQRT_HR ‚Äì SQRT_LR)
La normalizaci√≥n se lleva a cabo para que la ganancia proporcional GAIN del regulador PID
pueda introducirse sin dimensiones. De este modo, si cambia el l√≠mite superior e inferior del
rango de medida f√≠sico (p. ej. de bar a mbar), no es necesario cambiar el factor de ganancia.
Las magnitudes de entrada normalizadas ERnormalizado y PVnormalizado no pueden observarse.

920

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Consulte tambi√©n
Estructuras de regulador (P√°gina 921)
Acci√≥n P (P√°gina 924)
Acci√≥n D (P√°gina 928)
Acci√≥n I (P√°gina 925)

Estructuras de regulador
Uso y parametrizaci√≥n del regulador PID
La mayor parte de los procesos regulados que se dan en la industria del procesamiento y los
procesos puede regularse con la funci√≥n de regulador PI/PID de Standard PID Control. Solo en
casos especiales se requieren m√©todos y medidas adicionales para dominar la regulaci√≥n en
cuesti√≥n.
No obstante, un gran problema pr√°ctico suele ser la parametrizaci√≥n del regulador PI/PID, es
decir, encontrar los valores de ajuste "correctos" para los par√°metros del regulador. La calidad
de esta parametrizaci√≥n es determinante para la efectividad de la regulaci√≥n PID, y requiere
una gran experiencia pr√°ctica, conocimientos especializados o bien mucho tiempo.

Regulaci√≥n P
En el regulador P est√°n desconectadas las acciones I y D. (I_SEL y D_SEL = FALSE). Eso
significa que con un error de regulaci√≥n ER = 0, la se√±al de salida tambi√©n es OUTV = 0. Para
ajustar un punto de trabajo ‚â† 0, es decir, un valor num√©rico para la se√±al de salida con un error
de regulaci√≥n cero, hay que activar la rama I (v√©ase la figura siguiente).
En la acci√≥n I se puede predeterminar un punto de trabajo ‚â† 0 para el regulador P ajustando
el valor de inicializaci√≥n I_ITLVAL en correspondencia. Para ello hay que activar los
conmutadores 'I_ITL_ON' y 'I_SEL' = TRUE.
3B6(/

3
*$,1
(5

,B,7/B21
 ,B6(/

,

3,'B2879


,B,7/9$/

La respuesta indicial del regulador P en el rango de tiempo es:
PID_OUTV (t) = I_ITLVAL + GAIN * ER normalizado (t)
(5 QRUPDOL]DGR

3,'B287 W

3,'B2879

(5QRUPDOL]DGR W
W

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

921

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

PID_OUTV(t)

es la magnitud manipulada en modo autom√°tico del regulador

I_ITLVAL

es el punto de trabajo del regulador P

GAIN

es la ganancia de regulador

ER normalizado (t)

es el error de regulaci√≥n normalizado

Regulaci√≥n PI
En el regulador PI est√° desconectada la acci√≥n D. (D_SEL = FALSE). Un regulador PI modifica
la magnitud de salida PID_OUTV con la acci√≥n I hasta que el error de regulaci√≥n es ER = 0. Sin
embargo, esto solo es aplicable cuando la magnitud de salida no rebasa los l√≠mites del rango
manipulado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR    W
7,

(5 QRUPDOL]DGR
3,'B2879 W

3,'B2879
*$,1 (5 QRUPDOL]DGR


*$,1 (5 QRUPDOL]DGR W

*$,1 (5 QRUPDOL]DGR


(5QRUPDOL]DGR W
7,

PID_OUTV(t)

es la magnitud manipulada en modo autom√°tico del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escal√≥n del error de regulaci√≥n normalizado

TI

Constante de tiempo de integraci√≥n

Regulaci√≥n PD
En el regulador PD est√° desconectada la acci√≥n I (I‚ÄìSEL = FALSE). Eso significa que con un
error de regulaci√≥n ER = 0, la se√±al de salida tambi√©n es OUTV = 0. Para ajustar un punto de
trabajo ‚â† 0, es decir, un valor num√©rico para la se√±al de salida con un error de regulaci√≥n cero,
hay que activar la rama I (v√©ase tambi√©n el diagrama de bloques de la regulaci√≥n P).
En la acci√≥n I se puede predeterminar un punto de trabajo ‚â† 0 para el regulador PD ajustando
el valor de inicializaci√≥n I_ITLVAL en correspondencia. Para ello hay que activar los
conmutadores 'I_ITL_ON' e 'I_SEL' TRUE .
El regulador PD reproduce la magnitud de entrada ER(t) proporcionalmente sobre la se√±al de
salida y a√±ade la acci√≥n D creada por la derivaci√≥n de ER(t), que se calcula con el doble de
precisi√≥n seg√∫n la regla del trapecio (aproximaci√≥n de Pad√©). El comportamiento de tiempo se
determina mediante la constante derivativa (tiempo de derivaci√≥n) TD.
Para el filtrado de se√±ales y la supresi√≥n de se√±ales perturbadoras se ha integrado un retardo
de 1er orden (tiempo ajustable: TM_LAG) en el algoritmo para formar la acci√≥n D.

922

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Generalmente es suficiente un valor reducido para TM_LAG para conseguir el resultado
deseado. Si se parametriza TM_LAG ‚â§ CYCLE/2 el retardo est√° desactivado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR 



7'
70B/$*

W
H 70B/$*

(5 QRUPDOL]DGR

3,'B2879

*$,1

7'
(5
70B/$*  QRUPDOL]DGR

3,'B2879 W

(5QRUPDOL]DGR W

*$,1 (5 QRUPDOL]DGR

70B/$*

PID_OUTV(t)

es la magnitud manipulada en modo autom√°tico del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escal√≥n del error de regulaci√≥n normalizado

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

Regulaci√≥n PID
En el regulador PID est√°n activadas las acciones P, I y D (P‚ÄìSEL = TRUE, I‚ÄìSEL = TRUE,
D_SEL = TRUE). Un regulador PID modifica la magnitud de salida PID_OUTV mediante la
acci√≥n I hasta que el error de regulaci√≥n es ER = 0. Sin embargo, esto solo es aplicable cuando
la magnitud de salida no rebasa los l√≠mites del rango manipulado. Si se rebasan los l√≠mites de
la variable manipulada, la acci√≥n I mantiene el valor alcanzado en el l√≠mite en (Anti-ResetWindup).
El regulador PID reproduce la magnitud de entrada normalizada ERnormalizado(t)
proporcionalmente sobre la se√±al de salida y a√±ade las acciones creadas por la derivaci√≥n e
integraci√≥n de ERnormalizado(t), que se calculan con el doble de precisi√≥n seg√∫n la regla de
trapecio (aproximaci√≥n Pad√©). La respuesta de tiempo se determina por el tiempo de
derivaci√≥n (tiempo de acci√≥n derivativa) TD y el tiempo de integraci√≥n (tiempo de acci√≥n
integral) TI.
Para el filtrado y la supresi√≥n de se√±ales perturbadoras se ha integrado un retardo de 1er orden
(constante de tiempo ajustable: TM_LAG) en el algoritmo para formar la acci√≥n D.
Generalmente es suficiente un valor reducido para TM_LAG para conseguir el resultado
deseado. Si se parametriza TM_LAG ‚â§ CYCLE/2 el retardo est√° desactivado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR 

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019



 W
7'
7,
70B/$*

W
H 70B/$*

923

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
(5 QRUPDOL]DGR
3,'B2879

*$,1

3,'B2879 W

7'

(5 QRUPDOL]DGR
70B/$* 

3,B287 W
*$,1 (5 QRUPDOL]DGR 
*$,1 (5 QRUPDOL]DGR


*$,1 (5 QRUPDOL]DGR
W
W

70B/$*
7,

PID_OUTV(t)

es la magnitud manipulada en modo autom√°tico del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escal√≥n del error de regulaci√≥n normalizado

TI

Constante de tiempo de integraci√≥n

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

Nota
Si TD cambia, conviene adaptar TM_LAG de la forma correspondiente.
Recomendaci√≥n: 5 ‚â§ (TM / TM_LAG) ‚â§ 10

Consulte tambi√©n
Algoritmo de regulaci√≥n (P√°gina 919)
Acci√≥n P (P√°gina 924)
Acci√≥n D (P√°gina 928)

Acci√≥n P
Ganancia proporcional
El signo de la ganancia proporcional determina el sentido de acci√≥n del regulador continuo.
‚óè Ganancia proporcional positiva
error de regulaci√≥n ascendente ‚Üí variable manipulada ascendente
‚óè Ganancia proporcional negativa
error de regulaci√≥n ascendente ‚Üí variable manipulada descendente

924

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Aplicar la acci√≥n P en rama de realimentaci√≥n
Si la acci√≥n P est√° aplicada en la rama de realimentaci√≥n, solo el valor real tendr√° efecto sobre
la acci√≥n P. Por ello, la magnitud manipulada ‚Äì igual que en el caso de escal√≥n de la consigna
‚Äì en un cambio de autom√°tico a manual no realiza ning√∫n escal√≥n por la acci√≥n P: la
conmutaci√≥n es suave.

Consulte tambi√©n
Algoritmo de regulaci√≥n (P√°gina 919)

Acci√≥n I
Funci√≥n de la acci√≥n I
La acci√≥n I hace que, reajustando el punto de operaci√≥n, el error de regulaci√≥n pueda
convertirse en 0 para cualquier valor de la magnitud manipulada.
La acci√≥n I genera una se√±al de salida cuya velocidad de cambio es proporcional al cambio del
valor absoluto de la magnitud de entrada. La respuesta temporal viene determinada por el
tiempo integrativo TI.
La funci√≥n de transferencia en el rango de tiempo es:
2879 W 


7,

»â

LQY W GW

LQY
/01B,

/01B, W

/01B, W    LQY W
7,
LQY W

LQY

W
7,

LMN_I(t)

la magnitud de salida de la acci√≥n I

inv0

la altura del escal√≥n en la entrada de la acci√≥n I

TI

Tiempo integrativo

La acci√≥n I se observa en la variable est√°tica LMN_I.
Par√°metro

Significado

Rango admisible

TI

Tiempo integrativo

‚â• 5 * CYCLE

I_ITLVAL

Valor de inicializaci√≥n para la acci√≥n
I

-100,0 a +100,0 [%]

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

925

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

,17
,B6(/

%22/

)$/6(

,B,7/B21

%22/

)$/6(

,17B+326

%22/

)$/6(

,17B+1(*

%22/

)$/6(




/01B,



LQY

5($/



7,

7,0(

7V



,B,7/9$/

5($/





5($/



*) Ajuste predeterminado al crear el objeto tecnol√≥gico
En estado desactivado (I_SEL = FALSE) la acci√≥n I, es decir, la memoria interna y la variable
est√°tica LMN_I, se pone a cero.
La salida y la memoria de la acci√≥n I est√°n limitados por los l√≠mites absolutos de la variable
manipulada LMN_HLM y LMN_LLM (Anti Reset Wind‚Äìup).
En caso de influir en la se√±al manipulada en modo manual, es decir, cuando MAN_ON,
LMNOP_ON o CAS_ON = TRUE, el valor de la memoria interna de la acci√≥n I se corrige seg√∫n
el valor LMN.
3B6(/

3

*$,1
(5

/0123
0$1
/0123B21
0$1B21

,17B+326,17B+1(*
,B6(/

,







/01

,B,7/B21

,B,7/9$/




/01

Conmutaci√≥n de modo manual a autom√°tico
La acci√≥n I se ajusta en modo manual de modo que durante la conmutaci√≥n de manual a
autom√°tico y partiendo de la posici√≥n actual, la magnitud manipulada realiza un escal√≥n cuya
altura queda determinada por la acci√≥n P. La altura del escal√≥n de la acci√≥n P equivale al
cambio de la magnitud manipulada cuando hay un escal√≥n de consiga del valor real actual a
la consigna actual.
Sin embargo, si la acci√≥n P est√° aplicada en la rama de realimentaci√≥n, solo el valor real tendr√°
efecto en la acci√≥n P. Por ello, en una conmutaci√≥n de manual a autom√°tico, la magnitud
manipulada no realiza ning√∫n escal√≥n por la acci√≥n P; la conmutaci√≥n es suave.

926

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Rangos admisibles para el tiempo integrativo TI y CYCLE
Debido a la precisi√≥n limitada de los n√∫meros REAL calculados en la CPU, es posible que se
produzca el efecto siguiente durante la integraci√≥n: si se ha elegido un tiempo de muestreo
CYCLE de la regulaci√≥n demasiado peque√±o en comparaci√≥n con el tiempo integrativo TI y si
el valor de entrada inv de la acci√≥n I es peque√±o en comparaci√≥n con su valor de salida OUTV,
la acci√≥n I no se activa y permanece en su valor de salida moment√°neo.
Este efecto puede evitarse si se considera la siguiente regla de dimensionado en la
configuraci√≥n:
CYCLE > 10‚Äì4 √ó TI
De este modo, la acci√≥n I reacciona incluso a cambios de los valores de entrada situados en
el rango de una millon√©sima parte por mil de la magnitud de salida actual:
inv > 10 ‚Äì10 √ó OUTV
Para que el comportamiento de transferencia del algoritmo del integrador equivalga al
comportamiento anal√≥gico, el tiempo de muestreo deber√≠a ser menor que el 20 % del tiempo
integrativo ajustado o bien TI deber√≠a tener como m√≠nimo cinco veces el valor del tiempo de
muestreo seleccionado:
CYCLE < 0,2 √ó TI
El algoritmo admite para el tiempo de muestreo valores hasta CYCLE ‚â§ 0,5 * TI.

Inicializar la acci√≥n I
Cuando se activa la inicializaci√≥n de la acci√≥n I, el valor de inicializaci√≥n se aplica a la variable
est√°tica LMN_I en caso de rearranque de la CPU o si COM_RST = TRUE. Al cambiar al modo
normal reseteando la inicializaci√≥n, la acci√≥n I comienza la integraci√≥n de su magnitud de
entrada a partir del valor de inicializaci√≥n.

Detener la acci√≥n I
Mediante las variables est√°ticas INT_HPOS y INT_HNEG es posible bloquear la acci√≥n I en
sentido positivo y negativo, respectivamente. Esto puede ser √∫til en cascadas. Si, p. ej., la
magnitud manipulada del regulador secundario se aproxima al l√≠mite superior, existe la
posibilidad de impedir que siga aumentando la magnitud manipulada del regulador piloto
mediante su acci√≥n I. Este comportamiento se programa con las instrucciones siguientes, p.
ej., en AWL:
A
"regulador secundario".QLMN_HLM
=
"regulador piloto".INT_HPOS
A
"regulador secundario".QLMN_ LLM
=
"regulador piloto".INT_HNEG

Consulte tambi√©n
Algoritmo de regulaci√≥n (P√°gina 919)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

927

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Acci√≥n D
Funci√≥n de la acci√≥n D
La acci√≥n D genera una se√±al de salida cuya magnitud cambia proporcionalmente a la
velocidad de cambio de la magnitud de entrada. La respuesta temporal se determina mediante
el tiempo derivativo TD y el tiempo de retardo TM_LAG.
La respuesta a un escal√≥n de entrada inv0 es:
/01B'

/01B' W  

W
7'
LQY H 70B/$*
70B/$*

7' LQY

70B/$*
LQY
W
70B/$*

LMN_D(t)

la magnitud de salida de la acci√≥n D

inv0

la altura del escal√≥n en la entrada de la acci√≥n D

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

La acci√≥n D se observa en la variable est√°tica LMN_D.
En estado desactivado (D_SEL = FALSE) la acci√≥n D, es decir, la memoria interna y la variable
est√°tica LMN_D, se pone a cero.

Aplicar la acci√≥n D en la rama de realimentaci√≥n
Si la acci√≥n D est√° aplicada en la rama de realimentaci√≥n, solo el valor real tendr√° efecto sobre
la acci√≥n D. Por ello, en una conmutaci√≥n de manual a autom√°tico, la magnitud manipulada ‚Äì
igual que en el caso de un escal√≥n de la consigna ‚Äì no realiza ning√∫n escal√≥n por la acci√≥n D;
la conmutaci√≥n es suave.

Valores admisibles para el tiempo derivativo y el tiempo de retardo
Para que la acci√≥n D pueda calcularse correctamente, deben observarse las condiciones
siguientes para el tiempo derivativo y el tiempo de retardo:
‚óè TD ‚â• CYCLE y
‚óè TM_LAG ‚â• 0,5 √ó CYCLE
Si TD < CYCLE, la acci√≥n D trabaja como si TD tuviera el valor CYCLE.
Si TM_LAG < 0,5 √ó CYCLE, la acci√≥n D trabaja sin retardo. Un escal√≥n de entrada se multiplica
por el factor TD/CYCLE y este valor se devuelve en la salida como "impulso de aguja". Esto
significa que en el pr√≥ximo ciclo de procesamiento, LMN_D se pondr√° de nuevo a cero.

928

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Coeficiente DT1
El coeficiente DT1 se calcula del modo siguiente:
Coeficiente DT1 = TD/TM_LAG

Tiempo de retardo
Para el filtrado de se√±ales y la supresi√≥n de se√±ales perturbadoras se ha integrado un retardo
de 1er orden (constante de tiempo ajustable: TM_LAG) en el algoritmo para formar la acci√≥n
D.
La mayor√≠a de las veces es suficiente con un valor peque√±o como tiempo de retardo para
alcanzar el resultado deseado. Si se parametriza un tiempo de retardo inferior a la mitad del
tiempo de muestreo del regulador, el retardo est√° desactivado.

Procedimiento
Para configurar la acci√≥n D, proceda del siguiente modo:
1. Para aplicar la acci√≥n D en la rama de realimentaci√≥n, active la casilla de verificaci√≥n
correspondiente.
2. Introduzca el tiempo derivativo en segundos.
3. Introduzca el tiempo de retardo en segundos.

Consulte tambi√©n
Algoritmo de regulaci√≥n (P√°gina 919)

Variable manipulada
Regulador paso a paso con realimentaci√≥n de posici√≥n
Esquema funcional del regulador paso a paso con realimentaci√≥n de posici√≥n en el lazo de regulaci√≥n
El funcionamiento del regulador paso a paso con realimentaci√≥n de posici√≥n se basa en el
algoritmo de regulaci√≥n PID y se completa con los elementos funcionales que generan las
se√±ales de salida binarias a partir de la se√±al manipulada anal√≥gica del regulador.
El elemento de tres puntos transforma las diferencias entre la magnitud manipulada y la
realimentaci√≥n de posici√≥n en impulsos positivos o negativos de la se√±al de salida (seg√∫n sea
el signo), que se dan en un accionamiento de v√°lvula motriz, por ejemplo. En la pr√°ctica, se
trata de una regulaci√≥n en cascada con un lazo de regulaci√≥n de posici√≥n subordinado.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

929

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
$OJRULWPR3,'
(5 QRUPDOL]DGR

&RQVLJQD

/01

HOHPHQWRGHWUHV
Y¬£OYXODGH
SXQWRV
FRQWURO
4/0183

SURFHVR

4/01'1

9DORUUHDO
5HDOLPHQWDFL¬µQGHSRVLFL¬µQ/015B,1R03

Seleccionar la realimentaci√≥n de posici√≥n
Para aplicar la realimentaci√≥n de posici√≥n en el comparador en la rama de la variable
manipulada del regulador paso a paso hay disponibles diferentes entradas con el
correspondiente procesamiento de se√±al, en funci√≥n del formato del valor que debe
procesarse. Con LMNR_PER se pueden aplicar se√±ales en el formato de la periferia SIMATIC
y con LMNR_IN se√±ales en formato de coma flotante.
En el punto de medici√≥n MP10 se deposita el valor interno correspondiente en el rango
porcentual.
03

/0151250

/015B&53

/015B3(5



/0153B21



/015B,1

Si la realimentaci√≥n de posici√≥n es suministrada por un m√≥dulo de entradas anal√≥gicas, el
valor num√©rico existente en LMNR_PER de la realimentaci√≥n de posici√≥n debe convertirse a
un valor en coma flotante normalizado a porcentajes.
No se comprueba si se produce un desbordamiento positivo o negativo, si se alcanza el rango
de tolerancia por encima o debajo ni si hay rotura de hilo.
La tabla siguiente ofrece una visi√≥n de conjunto de los rangos y valores num√©ricos antes y
despu√©s del procesamiento.

930

Valor de periferia LMNR_PER

Valor de salida en %

32767

118,515

27648

100,000

1

0,003617

0

0,000

-1

- 0,003617

- 27648

- 100,000

- 32768

- 118,519

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Nota
La realimentaci√≥n de posici√≥n no debe activarse ni desactivarse en modo online. Esto significa
que LMNR_ON no debe modificarse online.
Para activar la realimentaci√≥n de posici√≥n, proceda del siguiente modo:
1. Active la casilla de verificaci√≥n "Activar" en el √°rea "Seleccionar realimentaci√≥n de posici√≥n".
2. Elija la opci√≥n "Realimentaci√≥n de posici√≥n en periferia" para aplicar se√±ales en el formato
de periferia SIMATIC.
Elija la opci√≥n "Realimentaci√≥n de posici√≥n" para aplicar se√±ales en el formato de coma
flotante.

Normalizar la realimentaci√≥n de posici√≥n
Si la realimentaci√≥n de posici√≥n est√° disponible en forma de magnitud f√≠sica (p. ej. de 240 a 800
mm o en un √°ngulo de 0¬∞ a 60¬∞), la realimentaci√≥n de posici√≥n en formato de coma flotante (%)
debe normalizarse a la magnitud f√≠sica en el valor interno en coma flotante necesario para el
procesamiento posterior.
Para definir la recta de normalizaci√≥n de forma un√≠voca deben definirse los par√°metros
siguientes:
‚óè el factor (para la pendiente): LMNR_FAC
‚óè el offset de la recta de normalizaci√≥n en el punto cero: LMNR_OFF
03

/015B)$&
/015B2))
LQY

La realimentaci√≥n de posici√≥n normalizada se calcula de acuerdo con la f√≥rmula siguiente de
inv (LMNR_PER) y se emite en MP10:
MP10 = inv * LMNR_FAC + LMNR_OFF
La normalizaci√≥n se hace efectiva cuando la realimentaci√≥n de posici√≥n en periferia est√°
activada (LMNRP_ON = TRUE). Dentro de la funci√≥n no se limitan los valores. No tiene lugar
una comprobaci√≥n de los par√°metros.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

931

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para normalizar la se√±al de la realimentaci√≥n de posici√≥n, proceda del siguiente modo:
1. En el campo de entrada "Factor", introduzca la pendiente de la recta de normalizaci√≥n.
2. En el campo de entrada "Offset", introduzca el offset de la recta de normalizaci√≥n hacia el
punto cero.

Regulador paso a paso sin realimentaci√≥n de posici√≥n
Estructura y funci√≥n del regulador paso a paso
El regulador paso a paso sin realimentaci√≥n de posici√≥n se compone de dos elementos: el
elemento de regulador PD que trabaja con se√±ales continuas y un segundo elemento en el que
se generan las se√±ales manipuladas binarias a partir de la diferencia entre la acci√≥n PD y la
realimentaci√≥n.
La acci√≥n I del regulador paso a paso sin realimentaci√≥n de posici√≥n se calcula en la
realimentaci√≥n. La se√±al de realimentaci√≥n comparada con la salida del regulador PD se forma
integrando los dos elementos siguientes de la se√±al:
‚óè Componente de se√±al para la realimentaci√≥n de posici√≥n simulada
¬± 100/MTR_TM
‚óè Componente de se√±al para la acci√≥n I
ERnormalizado*GAIN/TI
As√≠ pues, la se√±al de realimentaci√≥n es la diferencia entre la realimentaci√≥n de posici√≥n
simulada y la acci√≥n I.
El elemento de tres puntos transforma las diferencias entre la magnitud manipulada y la se√±al
de realimentaci√≥n en impulsos positivos o negativos de la se√±al de salida (seg√∫n sea el signo),
que se dan en un accionamiento de v√°lvula motriz, por ejemplo.
En estado estabilizado, la salida de la acci√≥n I y la acci√≥n PD se convierten en cero. Puesto que
la entrada del elemento de tres puntos tambi√©n se convierte en cero, las se√±ales manipuladas
binarias QLMNUP y QLMNDN permanecen en FALSE.
Dado que la integraci√≥n se realiza en la realimentaci√≥n, la acci√≥n I no se incluye en el c√°lculo
del algoritmo PID. Sin embargo, la acci√≥n I del algoritmo PID puede ajustarse a un valor fijo con
I_ITL_ON y I_ITLVAL.
En un regulador paso a paso sin realimentaci√≥n de posici√≥n no se soporta la congelaci√≥n de
la acci√≥n I con INT_HPOS y INT_HNEG.
Aqu√≠, el modo manual a trav√©s del par√°metro MAN se suprime debido a la falta de informaci√≥n
sobre la posici√≥n del actuador.

932

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
4/0183
4/01'1



(5 QRUPDOL]DGR

/016B2125/0162321




075B70



,B6(/$1'127,B,7/B21








4/0183254/01'1





*$,1
7,

La activaci√≥n de las se√±ales de tope del actuador (LMNR_HS/LMNR_LS) provoca el bloqueo
de la variable manipulada LMNUP o LMNDN.
Si el actuador no suministra se√±ales de tope, hay que activar los par√°metros de entrada
LMNR_HS y LMNR_LS = FALSE.
Nota
Si no hay se√±ales de tope, el regulador no puede detectar si se ha alcanzado un tope
mec√°nico. Existe la posibilidad de que el regulador emita se√±ales para abrir la v√°lvula, por
ejemplo, aunque ya se encuentre en el tope superior.

Modo manual
Debido a la falta de informaci√≥n sobre la posici√≥n del actuador, en el regulador paso a paso sin
realimentaci√≥n de posici√≥n se suprime el modo manual a trav√©s del par√°metro MAN o el
generador de la variable manipulada manual MAN_GEN. Solo es posible el modo manual
mediante conmutaci√≥n directa de las se√±ales manipuladas (LMNS_ON = TRUE).

Simulaci√≥n de la realimentaci√≥n de posici√≥n
Si no se dispone de una realimentaci√≥n de posici√≥n como magnitud mensurable, tambi√©n
puede simularse (LMNRS_ON = TRUE).
La simulaci√≥n de la realimentaci√≥n de posici√≥n se realiza mediante un integrador usando el
tiempo de posicionamiento del motor MTR_TM como constante de tiempo integrativo. En el
estado LMNRS_ON = FALSE se emite el valor inicial del par√°metro LMNRSVAL en la salida
del integrador LMNR_ SIM. Despu√©s de conmutar a LMNRS_ON = TRUE, la simulaci√≥n
arranca con este valor inicial.
Si LMNR_HS = TRUE, la integraci√≥n se detiene hacia arriba, si LMNR_LS = TRUE, se detiene
hacia abajo. No se sincroniza la realimentaci√≥n de posici√≥n simulada en las posiciones finales.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

933

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
4/0183
38/6(287

4/01'1


/015B+6
/015B/6 6LPXODFL¬µQGHODUHDOLPHQWDFL
¬µQGHSRVLFL¬µQ





,17
/015B6,0

,17
/0156B21
/01569$/
075B70

Nota
La realimentaci√≥n de posici√≥n solamente se simula. No tiene que coincidir con la posici√≥n real
del actuador. Si existe una realimentaci√≥n de posici√≥n real, se deber√≠a usar sin falta.

Modo manual
Modo manual
La estructura de la generaci√≥n y aplicaci√≥n del valor manual puede verse en la figura siguiente.
0$1*1B21
/01/,0,7

/016B21

0$1

/0183

0$1B21

/01'1

03
/01/,0,7

0$1B*(1

7+5((B67

38/6(287

/01

4/0183
4/01'1

03
3,'B2879
UHJXODGRU

03
/0183B23
/01'1B23
/0162321
/015B,1R03

934

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
En el regulador paso a paso existen tres modos de operaci√≥n en los que es posible influir
manualmente en la variable manipulada:
‚óè Valor manual a trav√©s del par√°metro de entrada MAN
A trav√©s del par√°metro MAN (-100,0 % a 100,0 %) se puede aplicar una influencia externa
de la magnitud manipulada como valor absoluto, o puede predeterminarse desde el
programa de usuario.
Solo es posible si la realimentaci√≥n de posici√≥n est√° activada.
‚óè Modo manual mediante interruptor de m√°s/menos del generador del valor manual
(MANUP, MANDN),
Si se activa MAN_GEN desde otro modo de operaci√≥n, se aplica la variable manipulada
MP9. As√≠, la conmutaci√≥n al generador del valor manual siempre es suave. La variable
manipulada manual puede aumentarse o reducirse dentro de los l√≠mites LMN_HLM y
LMN_LLM.
Solo es posible si la realimentaci√≥n de posici√≥n est√° activada.
‚óè Modo manual por aplicaci√≥n directa de las se√±ales manipuladas
El modo manual por aplicaci√≥n directa de las se√±ales manipuladas LMNUP y LMNDN
siempre tiene preferencia.
Cuando se retrocede LMNS_ON = FALSE se aplica "con suavidad" un modo de operaci√≥n
cualquiera activado.

Modo autom√°tico
Si se ha desactivado el modo manual (MAN_ON = FALSE), la variable manipulada del
algoritmo PID se aplica al elemento de tres puntos. La conmutaci√≥n de modo manual a
autom√°tico provoca un escal√≥n de la variable manipulada LMN. No obstante, esto no tiene
ning√∫n efecto negativo, ya que el proceso se acciona en forma de rampa a trav√©s del actuador
de acci√≥n integrativa. La salida del algoritmo PID se encuentra en el punto de medici√≥n MP7.

Correcci√≥n del valor manual en el modo autom√°tico
Si la realimentaci√≥n de posici√≥n en periferia est√° activada (LMNRP_ON = TRUE), el par√°metro
de entrada MAN se corrige seg√∫n la posici√≥n del actuador (MP10).
Si la realimentaci√≥n de posici√≥n est√° activada (LMNRP_ON = FALSE), el par√°metro de entrada
MAN se corrige seg√∫n la posici√≥n del actuador (LMNR_IN).
Al conmutar al modo manual, la magnitud manipulada permanece en el valor correspondiente
a la posici√≥n del actuador. A continuaci√≥n puede modificarse mediante intervenci√≥n manual.

Activar el modo manual con valor manual
En este modo de operaci√≥n (MANGN_ON = FALSE y MAN_ON = TRUE) se introduce la
variable manipulada manual como valor absoluto en la entrada MAN. La variable manipulada
manual se indica en el punto de medici√≥n MP8.
1. Active la casilla de verificaci√≥n "Activar modo manual".
2. Seleccione la opci√≥n "Valor manual".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

935

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Activar el generador de valor manual
El valor manual MAN se aumenta o reduce progresivamente utilizando los interruptores
MANUP y MANDN. El valor modificado puede observarse en MP8. Se tienen en cuenta los
l√≠mites configurados de la variable manipulada.
1. Active la casilla de verificaci√≥n "Activar modo manual".
2. Seleccione la opci√≥n "Generador del valor manual".

Repercusi√≥n de los interruptores MANUP y MANDN
Para poder realizar un cambio graduado finamente, el regulador debe tener un tiempo de
muestreo de 100 ms como m√°ximo.
La velocidad de cambio de la variable manipulada depende de la duraci√≥n de pulsaci√≥n de los
interruptores MANUP y MANDN as√≠ como de los l√≠mites ajustados de acuerdo con la relaci√≥n
siguiente:
‚óè durante los primeros 3 segundos despu√©s de activar MANUP o MANDN rige:
doutv/dt = (LMN_HLM - LMN_LLM) / 100 s
‚óè a continuaci√≥n
doutv/dt = (LMN_HLM - LMN_LLM) / 10 s
RXWY
/01B+/0

V
W
V

V

/01B//0

0$183
W
0$1'1

V
W

Con un tiempo de muestreo de 100 ms y un rango de la variable manipulada de -100,0 a 100,0,
la variable manipulada cambia en 0,2 por ciclo en los tres primeros segundos, por ejemplo. Si
MANUP se mantiene en TRUE durante m√°s de 3 segundos, la velocidad de cambio aumenta
a diez veces el valor, en este caso a 2 por ciclo.
El generador del valor manual se activa suavemente.

936

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Activaci√≥n de los modos de operaci√≥n
La tabla siguiente muestra los modos de operaci√≥n posibles del regulador paso a paso con los
valores necesarios para los interruptores que determinan la estructura.
Tabla 3-1

Modos de operaci√≥n del regulador paso a paso
MAN_ON

MNGN_ON

LMNS_ON

Modo autom√°tico

FALSE

cualquiera

FALSE

Modo manual sin control por interruptor

TRUE

FALSE

FALSE

Modo manual mediante generador de valor ma‚Äê TRUE
nual

TRUE

FALSE

Modo manual mediante se√±ales manipuladas

cualquiera

TRUE

cualquiera

L√≠mites
En el regulador paso a paso con realimentaci√≥n de posici√≥n es posible limitar la variable
manipulada.

Limitar el valor absoluto de la magnitud manipulada
El rango de trabajo, es decir, el rango dentro del cual puede moverse el actuador sin
abandonar las variables manipuladas admisibles, est√° determinado por el rango de ajuste de
la variable manipulada. Dado que, dependiendo del tipo de actuador, los l√≠mites de las
variables manipuladas permitidas no suelen cubrirse con el l√≠mite 0 % o 100 % del rango de
ajuste, es posible configurar el l√≠mite superior e inferior de la variable manipulada.
Para evitar estados no permitidos en el proceso en cuesti√≥n, en la rama de la variable
manipulada de la regulaci√≥n se limita el rango de ajuste de la magnitud manipulada por arriba
y abajo.
La funci√≥n LMNLIMIT limita la magnitud manipulada LMN(t) a los valores inferior y superior
LMN_HLM y LMN_LLM. Estos valores pueden predeterminarse. Sin embargo, la magnitud de
entrada inv debe estar fuera de estos l√≠mites. Dado que la funci√≥n no puede desactivarse, en
la configuraci√≥n siempre hay que tener en cuenta la indicaci√≥n del l√≠mite inferior y superior.
Los valores num√©ricos de los l√≠mites (en porcentaje) se ajustan en los par√°metros de entrada
para la limitaci√≥n inferior y superior. Si la magnitud de entrada inv(t) rebasa los l√≠mites, se
muestran las indicaciones correspondientes a trav√©s de las salidas de aviso.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

937

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
LQY
/01

LQY W

/01B+/0

)UDQMDGH
WROHUDQFLD



W
/01 W

/01B//0

4/01B+/0
4/01B//0

Arranque y funcionamiento
‚óè En caso de rearranque, todas las salidas de aviso se ponen a cero.
‚óè La limitaci√≥n trabaja seg√∫n las siguientes relaciones:
LMN =

QLMN_HLM

QLMN_LLM

si:

LMN_HLM

TRUE

FALSE

inv ‚â• LMN_HLM

LMN_LLM

FALSE

TRUE

inv ‚â§ LMN_LLM

inv

FALSE

FALSE

LMN_HLM < inv < LMN_LLM

En la salida, es decir, en el par√°metro LMN o en el punto de medici√≥n MP10, se muestra la
variable manipulada efectiva de la regulaci√≥n.

Procedimiento
Para limitar el valor absoluto de la magnitud manipulada, proceda del siguiente modo:
1. Introduzca el valor m√°s alto permitido en el campo de entrada "L√≠mite superior".
2. Introduzca el valor m√°s bajo permitido en el campo de entrada "L√≠mite inferior".

Generador de impulsos
El generador de impulsos se encarga de que se mantenga el tiempo de conexi√≥n y
desconexi√≥n m√≠nimo con el fin de proteger los actuadores. La activaci√≥n de las se√±ales de tope
del actuador (LMNR_HS/LMNR_LS) provoca el bloqueo de la variable manipulada LMNUP o
LMNDN. Esto sirve tanto para el modo autom√°tico como manual.

938

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Si est√°n activados ambos interuptores de se√±al para el control de se√±al de la variable
manipulada (LMNUP = LMNDN = TRUE o LMNUP_OP = LMNDN_OP = TRUE), las salidas
QLMNUP y QLMNDN siempre son FALSE.
El cambio directo de "Se√±al de variable manipulada Abrir" (QLMNUP = TRUE, QLMNDN =
FALSE) a "Se√±al de variable manipulada Cerrar" (QLMNUP = FALSE, QLMNDN = TRUE) no
es posible. El generador de impulsos inserta un ciclo con QLMNUP = QLMNDN = FALSE.

Se√±al de entrada INV en el regulador paso a paso con realimentaci√≥n de posici√≥n
La diferencia entre la variable manipulada LMN y la realimentaci√≥n de posici√≥n LMNR se aplica
en el elemento de tres puntos con hist√©resis THREE_ST.
/015B+6
/015B/6

/016B21
/0183
/01'1
/01

7+5((B67
DGDSWLY

$1'

38/6(287

$1'

$1'

4/0183

$1'

4/01'1

/0183B23
/01'1B23
/0162321
/015B,1R03

Se√±al de entrada INV en el regulador paso a paso sin realimentaci√≥n de posici√≥n
La diferencia entre la acci√≥n PD del regulador y la magnitud de realimentaci√≥n (MP11) se
aplica al elemento de tres puntos con hist√©resis THREE_ST.

03

7+5((B67

3,'B2879

4/0183
4/01'1

38/6(287




25
03

/016B2125/0162321








075B70

,17



(5QRUPDOL]DGR *$,1
7,

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019



939

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Influencia del tiempo de posicionamiento del motor en el elemento de tres puntos
El elemento de tres puntos genera dos se√±ales binarias que son TRUE o FALSE seg√∫n sean
la magnitud y el signo del valor diferencial en la entrada.
El elemento de tres puntos THREE_ST reacciona a la se√±al de entrada INV de acuerdo con las
relaciones siguientes y adopta en cada caso una de las tres combinaciones posibles de sus
se√±ales de salida UP/DOWN:
UP

DOWN

Combinaci√≥n de entrada

TRUE

FALSE

|INV| ‚â• ThrOn o INV > ThrOff y UPantiguo = TRUE

FALSE

TRUE

|INV| ‚â§ -ThrOn o INV < -ThrOff y DOWNantiguo = TRUE

FALSE

FALSE

|INV| ‚â§ ThrOff

ThrOn = umbral de conexi√≥n, ThrOff = umbral de desconexi√≥n

83

03

83


'2:1

03
7KU2II

'2:1

7KU2Q

El umbral de desconexi√≥n ThrOff debe ser mayor que el cambio de la realimentaci√≥n de
posici√≥n o que el cambio de posici√≥n tras la duraci√≥n de un impulso. Este valor depende del
tiempo de posicionamiento del motor MTR_TM y se calcula del siguiente modo:
7KU2II 


&<&/(
075B70

MTR_TM debe ser un m√∫ltiplo entero de CYCLE.
Nota
Un tiempo de posicionamiento del motor demasiado elevado (10% por encima del tiempo de
posicionamiento real) provoca una conexi√≥n y desconexi√≥n continuas de las se√±ales de
variable manipulada QLMNUP y QLMNDN.

Adaptaci√≥n del umbral de conexi√≥n ThrOn
Con el fin de reducir la frecuencia de conmutaci√≥n al regular errores de regulaci√≥n mayores, el
umbral de conexi√≥n ThrOn se adapta autom√°ticamente durante el funcionamiento, mientras
que ThrOff permanece constante. ThrOn est√° limitado a:
0LQ7KU2Q 


0$; 38/6(B70&<&/(
075B70

0D[7KU2Q 

La adaptaci√≥n del umbral de conexi√≥n est√° desactivada en reguladores P, D o PD puros. En
este caso es:

940

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
ThrOn = Min ThrOn

Tiempo de conexi√≥n y desconexi√≥n m√≠nimo
El generador de impulsos procura que se mantenga el tiempo de conexi√≥n y desconexi√≥n
m√≠nimo al conectar y desconectar los impulsos de salida, respectivamente.
Por este motivo, para proteger el actuador es posible parametrizar un tiempo de conexi√≥n
m√≠nimo PULSE_TM y un tiempo de desconexi√≥n m√≠nimo BREAK_TM. La duraci√≥n de los
impulsos de salida QLMNUP y QLMNDN es siempre mayor que el tiempo de conexi√≥n m√≠nimo
y la pausa entre dos impulsos es siempre mayor que el tiempo de desconexi√≥n m√≠nimo. La
figura siguiente muestra el funcionamiento siguiendo el ejemplo de la se√±al UP.
83LQ

W
83RXW

38/6(B70


W
%5($.B70

Procedimiento
Para configurar el generador de impulsos, proceda del siguiente modo:
1. Introduzca el tiempo de posicionamiento del motor en el campo de entrada "Tiempo pos.
motor".
2. Introduzca un "Tiempo m√≠n. conexi√≥n".
3. Introduzca un "Tiempo m√≠n. desconexi√≥n".

Puesta en servicio de PID_ES
Realizar una optimizaci√≥n manual
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.
‚óè MAN_ON = FALSE

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

941

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para determinar manualmente los par√°metros PID √≥ptimos, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo
"Medici√≥n activada".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se establece. Los valores actuales de
consigna, valor real y variable manipulada se graban.
2. Introduzca par√°metros PID nuevos en los campos "P", "I", "D" y "Tiempo de retardo".
3. Haga clic en el grupo "Optimizaci√≥n" en el s√≠mbolo

"Enviar par√°metros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna" .
5. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
s√≠mbolo .
Si la velocidad de cambio de la consigna est√° limitada, se conmuta suavemente a la nueva
consigna.
6. En caso necesario, desactive la casilla de verificaci√≥n "Modo manual".
El regulador trabaja con los nuevos par√°metros PID y regula seg√∫n la nueva consigna.
7. Compruebe la calidad de los par√°metros PID bas√°ndose en la evoluci√≥n de las curvas.
8. Repita los pasos del 3 hasta el 8, hasta que est√© satisfecho con el resultado de la regulaci√≥n.

Puesta en servicio con el PID Self Tuner
La instrucci√≥n PID_ES se pone en servicio con el PID Self-Tuner y se determinan los
par√°metros PID √≥ptimos.

Procedimiento
Para poner en servicio un regulador paso a paso, proceda del siguiente modo:
1. Llame la instrucci√≥n PID_ES en un OB de alarma c√≠clica e interconecte los par√°metros de
entrada y salida.
2. Llame la instrucci√≥n TUN_ES en el mismo OB de alarma c√≠clica.

942

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Interconecte la instrucci√≥n TUN_ES con PID_ES del siguiente modo:
‚Äì TUN_ES.PV con PID_ES.PV
‚Äì Si se utiliza una realimentaci√≥n de posici√≥n, TUN_ES.LMNR con PID_ES.LMNR_IN
‚Äì TUN_ES.C_LMNUP y TUN_ES.C_LMNDN con PID_ES.QLMN_UP y PID_ES.QLMNDN
‚Äì TUN_ES.LMNR_HS con PID_ES.LMNR_HS
‚Äì TUN_ES.LMNR_ON con PID_ES.LMNR_ON
‚Äì TUN_ES.LMNS_ON con PID_ES.LMNS_ON
‚Äì TUN_ES.SP_OUT con PID_ES.SP_IN o PID_ES.SP_EXT
‚Äì TUN_ES.GAIN con PID_ES.GAIN
‚Äì TUN_ES.TI con PID_ES.TI
‚Äì TUN_ES.TD con PID_ES.TD
‚Äì TUN_ES.TM_LAG con PID_ES.TM_LAG
‚Äì TUN_ES.MTR_TM con PID_ES.MTR_TM
‚Äì Si se utiliza una zona muerta, TUN_ES.DEADB_W con PID_ES.DEADB_W
‚Äì TUN_ES.QLMNUP y TUN_ES.QLMNDN con PID_ES.LMNUP y PID_ES.LMNDN
4. Haga clic en el s√≠mbolo
en la instrucci√≥n TUN_ES.
Se abre el editor de puesta en servicio para TUN_ES. El funcionamiento del editor de
puesta en servicio se describe en el PID Self-Tuner.

3.5.2

Utilizar Modular PID Control

3.5.2.1

Volumen de funciones del Modular PID Control
En muchas tareas de regulaci√≥n no solo es importante el cl√°sico regulador PID como elemento
que influye en el proceso, sino que tambi√©n se ponen elevadas exigencias al procesamiento
de las se√±ales.
Modular PID Control contiene instrucciones con funciones para acondicionar el valor real y la
consigna, as√≠ como para calcular y retocar la variable manipulada.
Son posibles los reguladores siguientes:
‚óè Reguladores continuos
‚óè Reguladores paso a paso para actuadores de acci√≥n integrativa
‚óè Reguladores de impulsos
Interconectando las diferentes instrucciones se consiguen reguladores para diferentes
aplicaciones:
‚óè Regulador de valor fijo
‚óè Regulador en cascada
‚óè Regulador de relaci√≥n

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

943

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
‚óè Regulador de mezcla
‚óè Regulador de rango partido
‚óè Regulador de correcci√≥n
‚óè Regulador con procesamiento de magnitudes perturbadoras
‚óè Regulador multivariable
Se pueden regular tanto sistemas regulados lentos (temperatura, nivel, etc.) como sistemas
regulados muy r√°pidos (caudal, presi√≥n, etc.).
La instrucci√≥n LP_SCHED_M permite llamar muchos lazos de regulaci√≥n de forma
equidistante pero con diferentes tiempos de muestreo. El tiempo de muestreo del lazo de
regulaci√≥n var√≠a seg√∫n sea la inercia del correspondiente sistema regulado.
De este modo se garantiza una carga homog√©nea de la CPU.
Para poner en servicio y optimizar los par√°metros PID se utiliza el PID Self-Tuner.

3.5.2.2

Pasos b√°sicos para crear un FB de regulaci√≥n

Procedimiento b√°sico para programar un regulador
Un regulador se programa, p. ej., con AWL como bloque de funci√≥n (FB de regulaci√≥n). El FB
de regulaci√≥n debe tener como m√≠nimo los par√°metros siguientes:
‚óè Par√°metro de entrada COM_RST
‚óè Par√°metro de entrada CYCLE
‚óè Par√°metro de entrada para consigna
‚óè Par√°metro de entrada para valor real
‚óè Par√°metro de salida para la variable manipulada
‚óè Par√°metro de entrada/salida para la variable manipulada manual (regulador continuo)
Adicionalmente, es posible crear los par√°metros siguientes seg√∫n sean los requisitos de
regulaci√≥n:
‚óè Par√°metro de entrada para realimentaci√≥n de posici√≥n (regulador paso a paso)
‚óè Par√°metro de entrada para una magnitud perturbadora
‚óè Par√°metro de salida para el valor real acondicionado
‚óè Par√°metro de salida para la consigna acondicionada
‚óè Par√°metro de salida para el rebase por exceso de l√≠mites
El detalle con el que se configuren las entradas y salidas depender√° de las particularidades
espec√≠ficas, por ejemplo, si el valor real tiene formato de periferia o en coma flotante, qu√©
realimentaci√≥n de posici√≥n hay, etc.
En el FB de regulaci√≥n se llaman las instrucciones de Modular PID Control y se interconectan
los par√°metros de entrada y salida. El FB de regulaci√≥n creado se llama, p. ej. en el OB 100 o
en un OB de alarma c√≠clica.

944

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Para programar un regulador con Modular PID Control deben seguirse los pasos siguientes:
Paso

Descripci√≥n

1.¬∫

Acondicionar consigna (P√°gina 945)

2.¬∫

Acondicionamiento del valor real (P√°gina 947)

3.¬∫

Determinar y acondicionar el error de regulaci√≥n (P√°gina 948)

4.¬∫

Control anticipativo (P√°gina 951) (opcional)

5.

Calcular variable manipulada
‚óè Crear un regulador continuo (P√°gina 952)
‚óè Crear un regulador de impulsos (P√°gina 954)
‚óè Crear un regulador paso a paso (P√°gina 957)

6.

Acondicionamiento de la realimentaci√≥n de posici√≥n (P√°gina 958)

Consulte tambi√©n
Acondicionar consigna (P√°gina 945)
Acondicionamiento del valor real (P√°gina 947)
Determinar y acondicionar el error de regulaci√≥n (P√°gina 948)
Control anticipativo (P√°gina 951)
Crear un regulador continuo (P√°gina 952)
Crear un regulador de impulsos (P√°gina 954)
Crear un regulador paso a paso (P√°gina 957)
Acondicionamiento de la realimentaci√≥n de posici√≥n (P√°gina 958)

3.5.2.3

Programar el FB de regulaci√≥n

Acondicionar consigna
Instrucciones para acondicionar la consigna
Se pueden utilizar las siguientes instrucciones.
‚óè SP_GEN: especificar consigna manualmente
‚óè ROC_LIM: limitar velocidad de cambio
‚óè LAG1ST: filtrar consigna
‚óè NONLIN: linealizar consigna
‚óè LIMITER: limitar consigna
‚óè RMP_SOAK: especificar consigna seg√∫n programaci√≥n
‚óè SCALE_M: escalar consigna
‚óè NORM: normalizar consigna

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

945

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Ejemplo de acondicionamiento de la consigna
Una consigna especificada debe poder aumentarse o reducirse manualmente. Para evitar
cambios de la consigna en forma de escal√≥n, se limita la velocidad de cambio.
Para acondicionar la consigna tal como se describe en el ejemplo, proceda del siguiente modo:
1. Declare en el FB de regulaci√≥n, en este caso PIDCTR, un par√°metro de entrada SP_IN del
tipo de datos "Real".
2. Interconecte SP_IN con una variable que contenga la consigna deseada.
3. En el FB de regulaci√≥n llame la instrucci√≥n SP_GEN como multiinstancia e interconecte
SP_IN con SP_GEN.DF_OUTV.
4. Parametrice el l√≠mite superior e inferior de la consigna en la estructura SP_GEN_Instance
de la multiinstancia.
5. En el FB de regulaci√≥n llame la instrucci√≥n ROC_LIM como multiinstancia e interconecte
SP_GEN.OUTV con ROC_LIM.INV mediante una variable temporal.
6. Parametrice las velocidades de cambio m√°ximas en la estructura ROC_LIM_Instance de la
multiinstancia.
7. Para calcular el error de regulaci√≥n, reste el valor real acondicionado de ROC_LIM.OUTV
o interconecte ROC_LIM.OUTV con ERR_MON.SP.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n PIDCTR.
3,'&75
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



'($'%$1'



,19

&<&/(
,19

2879

2879



2879



3,'
&20B567
&<&/(
(5
/01*B3,'

&53B,1



52&B/,0
&20B567

/01*(1B&
&20B567
&<&/(

3,'B/01*

/,0$/$50

3,'B/01*



/01

/01

/01*B3,'



&20B567
39B3(5

946

,19B3(5

2879

,19

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Consulte tambi√©n
Acondicionamiento del valor real (P√°gina 947)

Acondicionamiento del valor real
Instrucciones para el acondicionamiento del valor real
Se pueden utilizar las siguientes instrucciones.
‚óè CRP_IN: escalar valor de periferia
‚óè LAG1ST: filtrar valor real
‚óè LIMITER: limitar valor real
‚óè LIMALARM: vigilar valor real
‚óè NONLIN: linealizar valor real
‚óè SCALE_M: escalar valor real
‚óè NORM: normalizar valor real

Ejemplo de acondicionamiento del valor real
El valor real tiene formato de periferia y debe vigilarse el mantenimiento de los l√≠mites de valor
real.
Para acondicionar el valor real tal como se describe en el ejemplo, proceda del siguiente modo:
1. Declare en el FB de regulaci√≥n, en este caso PIDCTR, un par√°metro de entrada PV_PER
del tipo de datos "Word".
2. Interconecte PV_PER con la entrada de periferia en la que se mide el valor real.
3. En el FB de regulaci√≥n llame la instrucci√≥n CRP_IN como multiinstancia, p. ej. con el
nombre CRP_IN_Instance_PV.
4. Interconecte PV_PER con CRP_IN.INV_PER.
5. Parametrice el factor y offset para el escalado en la estructura CRP_IN_Instance_PV de la
multiinstancia.
6. En el FB de regulaci√≥n llame la instrucci√≥n LIMALARM como multiinstancia e interconecte
CRP_IN.OUTV con LIMALARM.INV mediante una variable temporal.
7. Parametrice los l√≠mites del valor real en la estructura LIMALARM_Instance de la
multiinstancia.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n PIDCTR.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

947

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3,'&75
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



,19



&<&/(
,19

2879



'($'%$1'

2879

2879



3,'
&20B567
&<&/(
(5

/01*(1B&
&20B567
&<&/(

/01*B3,'

&53B,1



52&B/,0
&20B567

3,'B/01*



3,'B/01*

/,0$/$50



/01

/01

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Consulte tambi√©n
Acondicionar consigna (P√°gina 945)
Determinar y acondicionar el error de regulaci√≥n (P√°gina 948)

Determinar y acondicionar el error de regulaci√≥n
Determinar y limitar el error de regulaci√≥n
El error de regulaci√≥n se determina de dos formas: programando la resta del valor real de la
consigna o utilizando la instrucci√≥n ERR_MON. En la instrucci√≥n ERR_MON ya se incluye una
vigilancia del error de regulaci√≥n.

Instrucciones para el acondicionamiento del error de regulaci√≥n
Se pueden utilizar las siguientes instrucciones.
‚óè A_DEAD_B: conducir el error de regulaci√≥n por la zona muerta adaptativa
‚óè DEADBAND: conducir el error de regulaci√≥n por la zona muerta

948

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Ejemplo de la resta
El error de regulaci√≥n se calcula restando y se conduce por una zona muerta.
Para determinar el error de regulaci√≥n tal como se describe en el ejemplo, proceda del
siguiente modo:
1. Llame la instrucci√≥n DEADBAND como multiinstancia e interconecte DEADBAND.INV con
la diferencia entre consigna y valor real, p. ej. ROC_LIM.OUTV - CRP_IN.OUTV.
2. Parametrice el ancho de la zona muerta y un offset de la zona muerta en la estructura
DEADBAND_Instance de la multiinstancia.
Un DEADBAND.OUTV mostrar√° el error de regulaci√≥n acondicionado.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n PIDCTR.
3,'&75
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



'($'%$1'



,19

&<&/(
,19

2879

2879



2879



3,'
&20B567
&<&/(
(5
/01*B3,'

&53B,1



52&B/,0
&20B567

/01*(1B&
&20B567
&<&/(

3,'B/01*

/,0$/$50

3,'B/01*



/01

/01

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Ejemplo del uso de ERR_MON
El error de regulaci√≥n se determina y vigila con la instrucci√≥n ERR_MON.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

949

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Para determinar el error de regulaci√≥n tal como se describe en el ejemplo, proceda del
siguiente modo:
1. Llame la instrucci√≥n ERR_MON como multiinstancia.
2. Utilizando variables temporales, interconecte la consigna acondicionada con
ERR_MON.SP, p. ej. ROC_LIM.OUTV, y el valor real acondicionado con ERR_MON.PV, p.
ej. CRP_IN.OUTV.
En ERR_MON.ER se indica el error de regulaci√≥n.
3. Parametrice la vigilancia del error de regulaci√≥n en la estructura ERR_MON_Instance de la
multiinstancia.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n PIDCTR_ER.
3,'&75B(5
&20B567
&<&/(
63B,1



63B*(1
&20B567
&<&/(
')B2879



(55B021
63
39

&53B,1

&<&/(
,19

2879

(5



52&B/,0
&20B567
2879



3,'
&20B567
&<&/(
(5
/01*B3,'



/01*(1B&
&20B567
&<&/(

3,'B/01*

/,0$/$50

3,'B/01*



/01

/01

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Consulte tambi√©n
Acondicionamiento del valor real (P√°gina 947)
Control anticipativo (P√°gina 951)

950

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Control anticipativo
Instrucciones para el acondicionamiento de la magnitud perturbadora
Se pueden utilizar las siguientes instrucciones.
‚óè CRP_IN: Escalar valor de periferia
‚óè DIF: Reaccionar a cambios r√°pidos
‚óè LAG1ST: Filtrar perturbaciones
‚óè NON_LIN: Linealizar magnitud perturbadora
‚óè SCALE_M: Escalar magnitud perturbadora
‚óè NORM: Normalizar magnitud perturbadora

Ejemplo de acondicionamiento de la magnitud perturbadora
La magnitud perturbadora tiene formato de periferia, la se√±al debe filtrarse y linealizarse por
medio de una curva caracter√≠stica.
Para acondicionar la magnitud perturbadora tal como se describe en el ejemplo, proceda del
siguiente modo:
1. Declare en el FB de regulaci√≥n un par√°metro de entrada DISV_PER del tipo de datos
"Word".
2. Interconecte DISV_PER con la entrada de periferia en la que se mide la magnitud
perturbadora.
3. En el FB de regulaci√≥n llame la instrucci√≥n CRP_IN como multiinstancia, p. ej. con el
nombre CRP_IN_Instance_DISV.
4. Interconecte DISV_PER con CRP_IN.INV_PER.
5. Parametrice el factor y offset de la escala en la estructura CRP_IN_Instance_DISV de la
multiinstancia.
6. En el FB de regulaci√≥n llame la instrucci√≥n LAG1ST como multiinstancia e interconecte
CRP_IN.OUTV con LAG1ST.INV mediante una variable temporal.
7. Parametrice el tiempo de retardo en la estructura LAG1ST_Instance de la multiinstancia.
8. En el FB de regulaci√≥n llame la instrucci√≥n NONLIN como multiinstancia e interconecte
LAG1ST.OUTV con NONLIN.INV mediante una variable temporal.
9. Cree un AUTOHOTSPOT en el que se guardar√°n los nodos de la curva caracter√≠stica.
10.Parametrice el n√∫mero del bloque de datos global con la curva caracter√≠stica en la
estructura NONLIN_Instance de la multiinstancia.
11.En NONLIN.OUTV se indica la magnitud perturbadora acondicionada.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n CTR_C_FF.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

951

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

&75B&B))
&20B567
&<&/(



63B*(1
&20B567
&<&/(
2879

')B2879

63B,1



&53B,1
,19B3(5

3,'B/01*

3,'B/01*



2879

&53B,1
,19B3(5



/01

',69
/01*B3,'

',69B3(5

/01*(1B&
&20B567
&<&/(

(5



39B3(5

2879

,19



3,'
&20B567
&<&/(



52&B/,0
&20B567
&<&/(



2879

&53B287 

,19

2879

/01B3(5

/01*B3,'



/,0$/$50
&20B567
,19

/$*67

,19



2879



121/,1

,19

2879

Consulte tambi√©n
Determinar y acondicionar el error de regulaci√≥n (P√°gina 948)
Crear un regulador continuo (P√°gina 952)
Crear un regulador de impulsos (P√°gina 954)
Crear un regulador paso a paso (P√°gina 957)

Crear un regulador continuo
Para un regulador continuo con variable manipulada anal√≥gica se necesitan las instrucciones
PID, LMNGEN_C y CRP_OUT.

952

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para programar un regulador continuo con variable manipulada anal√≥gica, proceda del
siguiente modo:
1. Declare en el FB de regulaci√≥n un par√°metro de entrada/salida MAN del tipo de datos
"Real".
MAN se necesita para poner en servicio el regulador con el PID Self-Tuner.
2. En el FB de regulaci√≥n llame las instrucciones PID, LMNGEN_C y CRP_OUT como
multiinstancia.
3. Declare en el FB de regulaci√≥n un par√°metro de entrada/salida MAN del tipo de datos
"Real" e interconecte MAN con LMNGEN_C.MAN.
4. En el DB de regulaci√≥n, parametrice el comportamiento del algoritmo regulador en la
estructura PID_Instance, p. ej. si se utilizar√° la acci√≥n D.
5. En la estructura LMNGEN_C_Instance de la multiinstancia parametrice p. ej. los l√≠mites de
la variable manipulada y de la velocidad de cambio de la variable manipulada.
6. En la estructura CRP_OUT_Instance de la multiinstancia parametrice el factor y el offset
para la conversi√≥n del valor en coma flotante al formato de periferia.
7. Utilizando una variable temporal, interconecte PID.ER con el error de regulaci√≥n, p. ej.
ROC_LIM.OUTV - CRP_IN.OUTV o ERR_MON.ER.
8. En caso de control anticipativo, interconecte PID.DISV con la se√±al acondicionada de la
magnitud perturbadora, p. ej. NONLIN.OUTV, utilizando una variable temporal.
9. Utilizando la instrucci√≥n BLKMOV, interconecte el par√°metro de salida PID.PID_LMNG con
el par√°metro de entrada LMNGEN_C.PID_LMNG y el par√°metro de salida
LMNGEN_C.LMNG_PID con el par√°metro de entrada PID.LMNG_PID.
10.Interconecte LMNGEN_C.LMN con CRP_OUT.INV utilizando una variable temporal.
11.Declare en el FB de regulaci√≥n un par√°metro de salida LMN_PER del tipo de datos "Word"
e interconecte CRP_OUT.OUTV con LMN_PER.
12.Interconecte LMN_PER con la salida anal√≥gica de la CPU que controla el actuador.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n CTR_C_FF .

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

953

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

&75B&B))
&20B567
&<&/(



63B*(1
&20B567
&<&/(
2879

')B2879

63B,1





&53B,1
,19B3(5

3,'B/01*

3,'B/01*



2879

&53B,1
,19B3(5



/01

',69
/01*B3,'

',69B3(5

/01*(1B&
&20B567
&<&/(

(5



39B3(5

2879

,19

3,'
&20B567
&<&/(



52&B/,0
&20B567
&<&/(



2879

&53B287 

,19

2879

/01B3(5

/01*B3,'



/,0$/$50
&20B567
,19

/$*67

,19

2879





121/,1

,19

2879

Consulte tambi√©n
Control anticipativo (P√°gina 951)

Crear un regulador de impulsos
Para un regulador de impulsos, genere una variable manipulada continua en formato de coma
flotante con las instrucciones PID y LMNGEN_C. A partir de esta variable manipulada
continua, genere un tren de impulsos con la instrucci√≥n PULSEGEN_M mediante la
modulaci√≥n de ancho de impulsos.

Generar una variable manipulada continua en formato de coma flotante
1. Declare en el FB de regulaci√≥n, en este caso PIDCTR, un par√°metro de salida LMN del tipo
de datos "Real".
2. En el FB de regulaci√≥n llame las instrucciones PID y LMNGEN_C y como multiinstancia.

954

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Interconecte y parametrice PID y LMNGEN_C tal como se describe en el regulador
continuo.
4. Interconecte LMNGEN_C.LMN con el par√°metro de salida LMN del FB de regulaci√≥n.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n PIDCTR.
3,'&75
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



'($'%$1'



&<&/(
,19

2879

,19

2879



2879



3,'
&20B567
&<&/(
(5
/01*B3,'

&53B,1



52&B/,0
&20B567

/01*(1B&
&20B567
&<&/(

3,'B/01*

3,'B/01*

/,0$/$50



/01

/01

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Generar un tren de impulsos
Para generar un tren de impulsos a partir de una variable manipulada continua, proceda del
siguiente modo:
1. Cree una funci√≥n, p. ej. FC50, con los par√°metros de entrada COM_RST y CYCLE.
2. Cree un AUTOHOTSPOT en el que se parametrizar√°n los tiempos de ciclo para la llamada
del FB de regulaci√≥n y del generador de impulsos PULSEGEN_M.
La relaci√≥n entre el tiempo de ciclo para la llamada del FB de regulaci√≥n y PULSEGEN_M
deber√≠a ser ‚â• 20.
3. Llame la instrucci√≥n LP_SCHED_M en la funci√≥n.
4. Interconecte LP_SCHED_M.DB_NBR con el bloque de datos global DB_LOOP.
5. Llame el FB de regulaci√≥n, p. ej., PIDCTR, si DB_LOOP.LOOP_DAT[1].ENABLE = TRUE.
6. Interconecte DB_LOOP.LOOP_DAT[1].COM_RST y DB_LOOP.LOOP_DAT[1].CYCLE
con los par√°metros de entrada COM_RST y CYCLE del FB de regulaci√≥n.
7. Defina DB_LOOP.LOOP_DAT[1].ENABLE = FALSE.
Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

955

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
8. Llame la instrucci√≥n PULSEGEN_M si DB_LOOP.LOOP_DAT[2].ENABLE = TRUE.
9. Interconecte DB_LOOP.LOOP_DAT[2].COM_RST y DB_LOOP.LOOP_DAT[2].CYCLE
con PULSEGEN_M.COM_RST y PULSEGEN_M.CYCLE.
10.Interconecte PULSEGEN_M.INV con el par√°metro de salida LMN del FB de regulaci√≥n.
11.Interconecte PULSEGEN_M.PER_TM con el par√°metro de entrada CYCLE del FB de
regulaci√≥n.
12.Defina DB_LOOP.LOOP_DAT[2].ENABLE = FALSE.
13.Interconecte PULSEGEN_M.QPOS_P y, dado el caso, PULSEGEN_M.QNEG_P con las
salidas digitales de la CPU que controlan el actuador.
14.Llame la funci√≥n en el OB 100 y en el OB de alarma c√≠clica.
2%
2% PV

2%758(
2%)$/6(
7PV

)&
&20B567
&<&/(

)&
/3B6&+('B0
&20B567
&<&/(

&20B567
70B%$6(
'%B/223'%

'%B1%5

'%B/223
*/3B1%5
$/3B1%5
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(



PV
)$/6(
)$/6(
)$/6(
)$/6(
)$/6(
PV
PV
)$/6(
)$/6(
)$/6(
)$/6(
)$/6(
PV

3,'&75
&20B567
&<&/(

/01

38/6(*(1
&20B567
&<&/(

4326B3

3(5B70

41(*B3

,19

956

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Consulte tambi√©n
Control anticipativo (P√°gina 951)

Crear un regulador paso a paso
Para un regulador paso a paso se necesitan las instrucciones PID y LMNGEN_S.

Procedimiento
Para programar un regulador paso a paso, proceda del siguiente modo:
1. En el FB de regulaci√≥n llame las instrucciones PID y LMNGEN_S y como multiinstancia.
2. Parametrice el comportamiento del algoritmo regulador en la estructura PID_Instance de
la multiinstancia, p. ej. si se utilizar√° la acci√≥n D.
3. En la estructura LMNGEN_S_Instance de la multiinstancia, parametrice p. ej. que no deben
utilizarse realimentaciones de posici√≥n, LMNR_ON = FALSE.
4. Utilizando una variable temporal, interconecte PID.ER con el error de regulaci√≥n, p. ej.
DEADBAND.OUTV o ERR_MON.ER.
5. En caso de control anticipativo, interconecte PID.DISV con la se√±al acondicionada de la
magnitud perturbadora, p. ej. CRP_IN.OUTV, utilizando una variable temporal.
6. Utilizando la instrucci√≥n BLKMOV, interconecte el par√°metro de salida PID.PID_LMNG con
el par√°metro de entrada LMNGEN_S.PID_LMNG y el par√°metro de salida
LMNGEN_S.LMNG_PID con el par√°metro de entrada PID.LMNG_PID.
7. Declare en el FB de regulaci√≥n los par√°metros de salida QLMNUP y QLMNDN del tipo de
datos "Bool".
8. Interconecte LNMGEN_S.QLMNUP y LMNGEN_S. QLMNDN con estos par√°metros de
salida.
9. Interconecte los par√°metros de salida del FB de regulaci√≥n con las salidas digitales de la
CPU que controlan el actuador.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n PIDCTR_S.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

957

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3,'&75B6
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



,19



&20B567
&<&/(
,19

2879



'($'%$1'

2879



2879



3,'
&20B567
&<&/(
(5
/01*B3,'

&53B,1



52&B/,0

3,'B/01*

/,0$/$50

/01*(1B6
&20B567
&<&/(

3,'B/01*



4/0183
4/01'1

4/0183
4/01'1

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Consulte tambi√©n
Control anticipativo (P√°gina 951)
Acondicionamiento de la realimentaci√≥n de posici√≥n (P√°gina 958)

Acondicionamiento de la realimentaci√≥n de posici√≥n
La configuraci√≥n de la realimentaci√≥n de posici√≥n depende del actuador utilizado.
‚óè Actuador con realimentaci√≥n de posici√≥n anal√≥gica
‚óè Actuador con se√±ales de tope digitales

Requisitos
Debe haberse programado un regulador paso a paso.

Crear un regulador paso a paso con realimentaci√≥n de posici√≥n anal√≥gica
Para acondicionar la realimentaci√≥n de posici√≥n anal√≥gica se recomiendan las instrucciones
siguientes.
‚óè CRP_IN: escalar valor de periferia
‚óè NONLIN: linealizar realimentaci√≥n de posici√≥n

958

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
‚óè SCALE_M: escalar realimentaci√≥n de posici√≥n
‚óè NORM: normalizar realimentaci√≥n de posici√≥n
Ejemplo de una realimentaci√≥n de posici√≥n anal√≥gica
Un actuador proporciona una realimentaci√≥n de posici√≥n en formato de periferia que debe
tenerse en cuenta al calcular la variable manipulada.
1. Declare en el FB de regulaci√≥n un par√°metro de entrada LMNR_PER del tipo de datos
"Word".
2. Interconecte LMNR_PER con la entrada de periferia.
3. En el FB de regulaci√≥n llame la instrucci√≥n CRP_IN como multiinstancia, p. ej. con el
nombre CRP_IN_Instance_LMNR.
4. Interconecte LMNR_PER con CRP_IN.INV_PER.
5. Parametrice el factor y offset de la escala en la estructura CRP_IN_Instance_LMNR de la
multiinstancia.
6. Interconecte CRP_IN.OUTV con LMNGEN_S.LMNR_IN utilizando una variable temporal.
7. En la estructura LMNGEN_S_Instance de la multiinstancia active la realimentaci√≥n de
posici√≥n con LMNR_ON = TRUE.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n PIDCTR_SAF.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

959

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3,'&75B6$)
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1




,19

&20B567
&<&/(
,19

2879



'($'%$1'

2879



3,'
&20B567
&<&/(
(5

2879

/01*B3,'



&53B,1



52&B/,0

3,'B/01*

/,0$/$50

/01*(1B6
&20B567
&<&/(

/015B,1
3,'B/01*



4/0183
4/01'1

4/0183
4/01'1

/01*B3,'



&20B567
39B3(5

,19B3(5

&53B,1

/015B3(5

,19

2879

,19B3(5



2879

Crear un regulador paso a paso con realimentaci√≥n de posici√≥n digital
1. Declare en el FB de regulaci√≥n los par√°metros de entrada LMNR_HS y LMNR_LS del tipo
de datos "Bool".
2. Interconecte los par√°metros de entrada LMNR_HS y LMNR_LS con
LMNGEN_S.LMNR_HS y LMNGEN_S.LMNR_LS.
3. En la estructura LMNGEN_S_Instance active la realimentaci√≥n de posici√≥n con
LMNR_ON = TRUE.
La figura siguiente muestra c√≥mo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulaci√≥n PIDCTR_SDF.

960

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3,'&75B6')
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



52&B/,0
&20B567
&<&/(
,19

2879

2879

/015B+6
/015B/6


'($'%$1'


,19



3,'
&20B567
&<&/(
(5

2879

/01*B3,'

&53B,1





/01*(1B6
&20B567
&<&/(
/015B+6
/015B/6

3,'B/01*

/,0$/$50

3,'B/01*



4/0183
4/01'1

4/0183
4/01'1

/01*B3,'



&20B567
39B3(5

,19

2879

,19B3(5

Consulte tambi√©n
Crear un regulador paso a paso (P√°gina 957)

3.5.2.4

Estructuras de regulador complejas

Regulador de relaci√≥n monobucle
La figura siguiente muestra un lazo de regulaci√≥n t√≠pico para un regulador de relaci√≥n
monobucle.
63



5HJXODGRU

/01

6LVWHPD
UHJXODGR

39

39
39

La relaci√≥n entre dos valores reales se regula en una consigna ajustada con un algoritmo PID.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

961

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para crear un regulador de relaci√≥n monobucle, proceda del siguiente modo:
1. En el FB de regulaci√≥n programe el acondicionamiento de los valores reales tal como se
representa abajo.
2. Para evitar una divisi√≥n entre cero, hay que limitar el rango de valores del valor real
PV_PER2 a valores > 0 con la instrucci√≥n LIMITER.
La figura siguiente muestra un FB de regulaci√≥n, en este caso RATIOCTR, para un regulador
de relaci√≥n monobucle con variable manipulada continua.
5$7,2&75
&20B567
&<&/(
63B5$7,2

(55B021
63

(5

39

,19B3(5

39B3(5

962

,19B3(5



2879

3,'B/01*

3,'B/01*

,19

/,0,7(5
,19



/01*(1B&
&20B567
&<&/(
/01

/01*B3,'

&53B287



2879

&53B,1



(5
/01*B3,'

&53B,1
39B3(5

3,'
&20B567
&<&/(





2879B3(5

/01B3(5



2879

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulador de relaci√≥n multibucle
La figura siguiente muestra un lazo de regulaci√≥n t√≠pico para un regulador de relaci√≥n
multibucle.
63

/01

5HJXODGRUSLORWR



(VFDOD

5$7,2B)$&

(VFDOD
5$7,2B)$&
(VFDOD

5$7,2B)$&



5HJXODGRU
VHFXQGDULR



5HJXODGRU
VHFXQGDULR



5HJXODGRU
VHFXQGDULR

/01

/01

/01

6LVWHPD
UHJXODGR

6LVWHPD
UHJXODGR

39

39

39
6LVWHPD
UHJXODGR
39
6LVWHPD
UHJXODGR

Programar un lazo de regulaci√≥n
Para programar este ejemplo con Modular PID Control, proceda del siguiente modo:
1. Programe un FB de regulaci√≥n para el regulador piloto, p. ej. PIDCTR_PV.
2. Programe uno o varios FB de regulaci√≥n para los reguladores secundarios, p. ej.
RB_CTR_S.
3. Programe una funci√≥n con la que se llamen e interconecten los cuatro reguladores.

Programar el regulador piloto
Para programar el regulador piloto, proceda del siguiente modo:
1. Programe el regulador piloto de acuerdo con sus necesidades, tal como se describe en el
cap√≠tulo Programar el FB de regulaci√≥n (P√°gina 945).
2. Declare en el FB de regulaci√≥n, en este caso PIDCTR_PV, un par√°metro de salida PV del
tipo de datos "Real" en el que se muestre el valor real acondicionado del regulador piloto.
La figura siguiente muestra la interconexi√≥n para el regulador piloto siguiendo el ejemplo del
FB de regulaci√≥n PIDCTR_PV.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

963

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3,'&75B39
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



'($'%$1'



,19

&<&/(
,19

2879

2879



52&B/,0
&20B567
2879



3,'
&20B567
&<&/(
(5
/01*B3,'

/01*(1B&
&20B567
&<&/(

3,'B/01*

3,'B/01*



/01

/01

/01*B3,'
39

&53B,1



/,0$/$50



&20B567
39B3(5

,19B3(5

2879

,19

Programar los reguladores secundarios
Para programar los reguladores secundarios, proceda del siguiente modo:
1. Programe los reguladores secundarios de acuerdo con sus necesidades, tal como se
describe en el cap√≠tulo Programar el FB de regulaci√≥n (P√°gina 945).
2. Declare en el FB de regulaci√≥n, en este caso RB_CTR_S, un par√°metro de entrada
RATIO_FAC del tipo de datos "Int". Con este valor se multiplica la consigna acondicionada,
p. ej. SCALE.OUTV, del regulador secundario.
La figura siguiente muestra la interconexi√≥n para el regulador secundario siguiendo el ejemplo
del FB de regulaci√≥n RB_CTR_S.

964

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

5%B&75B6
&20B567



6&$/(

&<&/(
63B,1

,19

2879

5$7,2B)$&

/015B+6
/015B/6
'($'%$1' 



,19

2879

/01*B3,'

&53B,1
39B3(5

,19B3(5

/015B3(5

,19B3(5



2879

&53B,1



3,'
&20B567
&<&/(
(5

3,'B/01*

/,0$/$50
&20B567


/01*(1B6
&20B567
&<&/(
4/0183
/015B+6 4/01'1
/015B/6
/015B,1
3,'B/01* /01*B3,'

4/0183
4/01'1



,19



2879

Llamar e interconectar reguladores
Para llamar e interconectar los reguladores piloto y secundarios, proceda del siguiente modo:
1. Cree una funci√≥n, p. ej. FC50, con los par√°metros de entrada COM_RST y CYCLE.
2. Llame la instrucci√≥n LP_SCHED_M en la funci√≥n.
3. Cree un AUTOHOTSPOT en el que se parametrizar√°n el n√∫mero de reguladores y los
tiempos de ciclo para la llamada del regulador piloto y de los reguladores secundarios.
Los tiempos de ciclo de los reguladores secundarios deben ser iguales o inferiores al
tiempo de ciclo del regulador piloto.
4. Llame el FB de regulaci√≥n para el regulador piloto, en este caso PIDCTR_PV, si
DB_LOOP.LOOP_DAT[1].ENABLE = TRUE.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

965

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
5. Interconecte DB_LOOP.LOOP_DAT[1].COM_RST y DB_LOOP.LOOP_DAT[1].CYCLE
con los par√°metros de entrada COM_RST y CYCLE del regulador piloto.
6. Defina DB_LOOP.LOOP_DAT[1].ENABLE = FALSE.
7. Llame el FB de regulaci√≥n para el primer regulador secundario, en este caso RB_CTR_S,
si DB_LOOP.LOOP_DAT[2].ENABLE = TRUE.
8. Interconecte DB_LOOP.LOOP_DAT[2].COM_RST y DB_LOOP.LOOP_DAT[2].CYCLE
con COM_RST y CYCLE del regulador secundario.
9. Interconecte el par√°metro de salida PV del regulador piloto con el par√°metro de entrada
SP_IN del regulador secundario.
10.Defina DB_LOOP.LOOP_DAT[2].ENABLE = FALSE.
11.Repita los cuatro √∫ltimos pasos para los dos reguladores secundarios restantes.
Incremente el contador de la matriz para cada regulador.
12.Interconecte las variables manipuladas con las salidas de la CPU.
13.Llame la funci√≥n en el OB 100 y en el OB de alarma c√≠clica.
La figura siguiente muestra las llamadas y la interconexi√≥n de los reguladores siguiendo el
ejemplo de la funci√≥n FC50.

966

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
2%
2% PV
2%758(
2%)$/6(
7PV

)&
&20B567
&<&/(

)&
/3B6&+('B0
&20B567
&<&/(

3,'&75B39
3,'&75B39B'%
&20B567
&<&/(

&20B567
&<&/(
'%B/223
'%

'%B1%5

'%B/223'%
*/3B1%5
$/3B1%5
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

39



PV
)$/6(
)$/6(
)$/6(
)$/6(

PV
PV
)$/6(
)$/6(
)$/6(
)$/6(

PV
PV
)$/6(
)$/6(
)$/6(
)$/6(

PV
PV
)$/6(
)$/6(
)$/6(
)$/6(

PV

5%B&75B6
5%B&75B6B'%
&20B567
&<&/(
63B,1

5%B&75B6
5%B&75B6B'%
&20B567
&<&/(
63B,1

5%B&75B6
5%B&75B6B'%
&20B567
&<&/(
63B,1

967

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulador en cascada
La figura siguiente muestra un lazo de regulaci√≥n t√≠pico de un regulador en cascada.
',69

63



5HJXODGRU
SLORWR

/01


5HJXODGRU
VHFXQGDULR

/01

6LVWHPD
UHJXODGR

39

6LVWHPD
UHJXODGR

39

Programar un lazo de regulaci√≥n
Para programar este ejemplo con Modular PID Control, proceda del siguiente modo:
1. Programe un FB de regulaci√≥n para el regulador piloto, p. ej. PIDCTR.
2. Programe un FB de regulaci√≥n para el regulador secundario, p. ej. PIDCTR_SAF.
3. Programe una funci√≥n con la que se llamen e interconecten los dos reguladores.
4. Llame la instrucci√≥n LP_SCHED_M en la funci√≥n.
5. Cree un AUTOHOTSPOT en el que se parametrizar√°n el n√∫mero de reguladores y los
tiempos de ciclo para la llamada del regulador piloto y de los reguladores secundarios.
El tiempo de ciclo del regulador secundario debe ser igual o inferior al tiempo de ciclo del
regulador piloto.
6. Llame el FB de regulaci√≥n para el regulador piloto si DB_LOOP.LOOP_DAT[1].ENABLE =
TRUE.
7. Interconecte DB_LOOP.LOOP_DAT[1].COM_RST y DB_LOOP.LOOP_DAT[1].CYCLE
con los par√°metros de entrada COM_RST y CYCLE del regulador piloto.
8. Defina DB_LOOP.LOOP_DAT[1].ENABLE = FALSE.
9. Llame el FB de regulaci√≥n para el regulador secundario si
DB_LOOP.LOOP_DAT[2].ENABLE = TRUE.
10.Interconecte DB_LOOP.LOOP_DAT[2].COM_RST y DB_LOOP.LOOP_DAT[2].CYCLE
con COM_RST y CYCLE del regulador secundario.
11.Interconecte el par√°metro de salida LMN del regulador piloto con el par√°metro de entrada
SP_IN del regulador secundario.
12.Defina DB_LOOP.LOOP_DAT[2].ENABLE = FALSE.
13.Interconecte la variable manipulada del regulador secundario con la salida anal√≥gica de la
CPU que controla el actuador.
14.Llame la funci√≥n en el OB 100 y en el OB de alarma c√≠clica.
La figura siguiente muestra las llamadas y la interconexi√≥n de los reguladores siguiendo el
ejemplo de la funci√≥n FC50.

968

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
2%
2% PV
2%758(
2%)$/6(
7PV

)&
&20B567
&<&/(

)&
/3B6&+('B0
&20B567
&<&/(

&20B567
&<&/(
'%B/223
'%

'%B1%5

'%B/223'%
*/3B1%5
$/3B1%5
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019



PV
)$/6(
)$/6(
)$/6(
)$/6(

PV
PV
)$/6(
)$/6(
)$/6(
)$/6(

PV

3,'&75
3,'&75B'%
&20B567
&<&/(
/01

3,'&75B6$)
3,'&75B6$)B'%
&20B567
&<&/(
63B,1

/01B3(5

969

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulador multivariable
La figura siguiente muestra un lazo de regulaci√≥n t√≠pico para un regulador multivariable. Dos
reguladores PID con salida continua se aplican al sistema regulado.
',69
63

63



5HJXODGRU3,'



5HJXODGRU3,'

/01

/01

39
6LVWHPD
UHJXODGR

39

Programar un lazo de regulaci√≥n
Para programar este ejemplo con Modular PID Control, proceda del siguiente modo:
1. Declare en el FB de regulaci√≥n, en este caso MUL_CTR, los par√°metros de entrada
siguientes:
‚Äì COM_RST del tipo de datos "Bool"
‚Äì CYCLE del tipo de datos "Time"
‚Äì SP_IN1 y SP_IN2del tipo de datos "Real"
‚Äì PV_PER1 y PV_PER2 del tipo de datos "Word"
2. Declare en el FB de regulaci√≥n los par√°metros de salida LMN_PER1 y LMN_PER2 del tipo
de datos "Word".
3. Programe para ambos reguladores PID el acondicionamiento de la consigna y el valor real
as√≠ como el c√°lculo de la magnitud manipulada.
4. Para calcular el error de regulaci√≥n del primer regulador PID, reste el valor real
acondicionado PV_PER1 del producto de la consigna SP_IN1 y la variable manipulada del
segundo regulador PID.
5. Para calcular el error de regulaci√≥n del segundo regulador PID, reste el valor real
acondicionado PV_PER2 del producto de la consigna SP_IN2 y la variable manipulada del
primer regulador PID.
6. Interconecte las variables manipuladas LMN_PER1 y LMN_PER2 con dos salidas
anal√≥gicas que controlen los actuadores.
7. Llame el FB de regulaci√≥n en el OB 100 y en el OB de alarma c√≠clica.
La figura siguiente muestra la llamada siguiendo el ejemplo del FB de regulaci√≥n MUL_CTR.

970

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
2%
2% PV

2%758(
2%)$/6(
7PV

08/B&75
08/B&75B'%
&20B567
&<&/(

La figura siguiente muestra la interconexi√≥n de los reguladores siguiendo el ejemplo del FB de
regulaci√≥n MUL_CTR.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

971

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
08/B&75
&20B567
&<&/(


63B*(1
&20B567
&<&/(
')B2879
2879

63B,1

'($'%$1'



,19




52&B/,0
&20B567
&<&/(
,19
2879



3,'
&20B567
&<&/(
(5

2879



39B3(5

,19B3(5

/,0$/$50
&20B567

'($'%$1'



,19



972

,19B3(5

2879B3(5

/01B3(5

3,'B/01* /01*B3,'



/01*(1B&
&20B567
&<&/(




2879

/,0$/$50
&20B567



/01

/01*B3,' 3,'B/01*

39B3(5

,19




52&B/,0
&20B567
&<&/(
,19
2879

3,'
&20B567
&<&/(
(5

2879

&53B,1

&53B287

,19

2879


63B*(1
&20B567
&<&/(
')B2879
2879

63B,1



/01

/01*B3,' 3,'B/01*

&53B,1

/01*(1B&
&20B567
&<&/(

&53B287
,19



2879B3(5

/01B3(5

3,'B/01* /01*B3,'



,19

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3.5.2.5

Poner en servicio el FB de regulaci√≥n

Poner en servicio el regulador continuo
El FB de regulaci√≥n se pone en servicio con el PID Self-Tuner y se determinan los par√°metros
PID √≥ptimos.

Procedimiento
Para poner en marcha un regulador continuo o un regulador de impulsos, proceda del siguiente
modo:
1. Llame el FB de regulaci√≥n en un OB de alarma c√≠clica e interconecte los par√°metros de
entrada y salida.
2. Llame la instrucci√≥n TUN_EC en el mismo OB de alarma c√≠clica.
3. Interconecte la instrucci√≥n TUN_EC con el FB de regulaci√≥n del siguiente modo:
‚Äì TUN_EC.PV con el valor real acondicionado, p. ej. la variable est√°tica
CRP_IN_Instance_PV.OUTV o el par√°metro de salida PV
‚Äì TUN_EC.LMN con la variable manipulada en formato Real, p. ej. la variable est√°tica
LMNGEN_C_Instance.LMN
‚Äì TUN_EC.MAN con el par√°metro de entrada/salida para el valor manual, p. ej. MAN.
‚Äì TUN_EC.SP_OUT con el par√°metro de entrada para la consigna, p. ej. SP_IN
‚Äì TUN_EC.GAIN con la ganancia proporcional, p. ej. PID_Instance.GAIN
‚Äì TUN_EC.TI con el tiempo integrativo, p. ej. PID_Instance.TI
‚Äì TUN_EC.TD con el tiempo derivativo, p. ej. PID_Instance.TD
‚Äì TUN_EC.TM_LAG con el tiempo de retardo, p. ej. PID_Instance.TM_LAG
4. Haga clic en el s√≠mbolo
en la instrucci√≥n TUN_EC.
Se abre el editor de puesta en servicio para TUN_EC. El funcionamiento del editor de
puesta en servicio se describe en el PID Self-Tuner.

Poner en servicio el regulador paso a paso
El FB de regulaci√≥n se pone en servicio con el PID Self-Tuner y se determinan los par√°metros
PID √≥ptimos.

Procedimiento
Para poner en servicio un regulador paso a paso, proceda del siguiente modo:
1. Llame el FB de regulaci√≥n en un OB de alarma c√≠clica e interconecte los par√°metros de
entrada y salida.
2. Llame la instrucci√≥n TUN_ES en el mismo OB de alarma c√≠clica.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

973

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Interconecte la instrucci√≥n TUN_ES con el FB de regulaci√≥n del siguiente modo:
‚Äì TUN_ES.PV con el valor real acondicionado, p. ej. la variable est√°tica CRP_IN_Instance
_PV.OUTV o el par√°metro de salida PV
‚Äì TUN_ES.LMNR_IN con la realimentaci√≥n de posici√≥n acondicionada, p. ej.
LMNGEN_S_instance.LMNR_IN
‚Äì TUN_ES.C_LMNUP y TUN_ES.C_LMNDN con las se√±ales de la variable manipulada,
p. ej. los par√°metros de salida QLMN_UP y QLMNDN
‚Äì TUN_ES.LMNR_HS con la se√±al del tope superior, p. ej.
LMNGEN_S_Instance.LMNR_HS
‚Äì TUN_ES.LMNR_ON con el conmutador de la realimentaci√≥n de posici√≥n, p. ej.
LMNGEN_S_Instance.LMNR_ON
‚Äì TUN_ES.SP_OUT con el par√°metro de entrada para la consigna, p. ej. SP_IN
‚Äì TUN_ES.GAIN con la ganancia proporcional, p. ej. PID_Instance.GAIN
‚Äì TUN_ES.TI con el tiempo integrativo, p. ej. PID_Instance.TI
‚Äì TUN_ES.TD con el tiempo derivativo, p. ej. PID_Instance.TD
‚Äì TUN_ES.TM_LAG con el tiempo de retardo, p. ej. PID_Instance.TM_LAG
‚Äì TUN_ES.MTR_TM con el tiempo de posicionamiento del motor, p. ej.
LMNGEN_S_Instance.MTR_TM
‚Äì Si se utiliza una zona muerta, TUN_ES.DEADB_W con el ancho de la zona muerta, p.
ej. DEADBAND_Instance.OUTV
‚Äì TUN_ES.QLMNUP y TUN_ES.QLMNDN con las se√±ales de la variable manipulada
LMNGEN_S_Instance.LMNUP y LMNGEN_S_Instance.LMNDN
4. Haga clic en el s√≠mbolo
en la instrucci√≥n TUN_ES.
Se abre el editor de puesta en servicio para TUN_ES. El funcionamiento del editor de
puesta en servicio se describe en el PID Self-Tuner.

3.5.3

Utilizar PID Self Tuner

3.5.3.1

Optimizar el regulador continuo y el regulador de impulsos

Interconectar TUN_EC con el regulador
La instrucci√≥n TUN_EC permite crear un regulador continuo o un regulador de impulsos.
Seg√∫n el regulador, TUN_EC se activa con una de las siguientes instrucciones:

974

Regulador

Instrucci√≥n

Reguladores de impulsos FM 355 C, FM 355 S

PID_FM

Reguladores de impulsos FM 455 C, FM 455 S

PID_FM

Funciones b√°sicas PID

CONT_C Con o sin PULSEGEN

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Regulador

Instrucci√≥n

Standard PID Control (paquete opcional PID Pro‚Äê
fessional)

PID_CP

Modular PID Control (paquete opcional PID Pro‚Äê
fessional)

PID
LMNGEN_C

Interconecte los par√°metros de entrada y salida de la instrucci√≥n TUN_EC con la instrucci√≥n
del regulador como se describe a continuaci√≥n.
TUN_EC

PID_FM

CONT_C

PID_CP

PV

PV

PV

PV

LMN

LMN

LMN

LMN

NORM_FAC

--

--

(NM_PVHR-NM_PVLR)*0.01

WRITE_DIS

Operaci√≥n l√≥gica O con
LOAD_OP y LOAD_PAR

--

--

MAN_OUT

LMN_RE

MAN

MAN

SP_OUT

SP_RE

SP_INT

SP_INT

GAIN

GAIN

GAIN

GAIN

TI

TI

TI

TI

TD

TD

TD

TD

TM_LAG

TM_LAG

TM_LAG

TM_LAG

RATIOFAC

--

--

RATIOFAC

PHASE

--

--

PHASE

QMAN_ON

LMN_REON

MAN_ON

MAN_ON

QI_SEL

--

I_SEL

I_SEL

QD_SEL

--

D_SEL

D_SEL

QWRITE

LOAD_PAR y

--

--

LOAD_OP

Posibilidades de optimizaci√≥n
Optimizaci√≥n inicial
La optimizaci√≥n de los par√°metros PID se realiza durante el calentamiento. Para ello se lleva
a cabo una identificaci√≥n del proceso seguida de un dise√±o del regulador.
La optimizaci√≥n puede solicitarse con ADAPT1ST.
Si se ajusta ADAPT1ST = TRUE, se ajustar√° ADAPT_ON = TRUE y la optimizaci√≥n inicial se
llevar√° a cabo obligatoriamente. En la optimizaci√≥n inicial, el escal√≥n de la variable manipulada
se indica en el par√°metro LHLM_TUN.
El par√°metro ADAPT1ST solo es necesario si, debido a errores graves durante la adaptaci√≥n,
se han obtenido par√°metros de proceso tan absurdos que el escal√≥n de la variable manipulada
calculado autom√°ticamente no sirve para una nueva adaptaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

975

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Con ADAPT1ST = TRUE se ejecuta la rutina de inicializaci√≥n de la instrucci√≥n TUN_EC. Se
llevan a cabo los siguientes ajustes predeterminados:
‚óè Se conmuta al regulador PI. Para ello se transfieren al regulador los par√°metros de
PI_CON. Si los par√°metros PI_CON.GAIN y PI_CON.TI tienen ambos el valor 0.0, se les
asignar√°n los valores predeterminados PI_CON.GAIN = 1.5 y PI_CON.TI = 3600.0 s.
‚óè PROCESS.GAIN = 999.0
‚óè RATIOFAC = 1.0
‚óè STATUS_H = 0; STATUS_D = 0; STATUS_C = 0
Nota
A menos que desee hacerlo expresamente, en caso de rearranque completo (en caliente)
de la CPU no llame TUN_EC como es habitual con otras instrucciones, pues de lo contrario
se perder√°n todos los par√°metros de proceso.
La optimizaci√≥n se inicia con ADAPT1ST = TRUE, seguido de un escal√≥n de la variable
manipulada ‚â• MIN_STEP en sentido positivo.
El escal√≥n de la variable manipulada en la optimizaci√≥n inicial suele saltar desde la consigna
del proceso en fr√≠o (temperatura ambiente) hasta la proximidad del punto de operaci√≥n.
Tambi√©n puede usarse como estado inicial cualquier otra consigna, a condici√≥n de que el
proceso se encuentre en un estado estacionario. Durante la optimizaci√≥n no pueden
especificarse m√°s escalones de la variable manipulada.
Evoluci√≥n de curva en la optimizaci√≥n inicial
r&

3+$6( 
3+$6( 
67$786B+  67$786B+ 
67$786B'  67$786B' 

/+/0B781HQ
3ULPHUDMXVWH
DXWRP¬£WLFR
YDORU
DMXVWDGRHQ
2SWLPL]DFL¬µQILQD
HVWDGRHVWDFLRQDULR
HQHOSULPHUDMXVWH
HOHVWDGRGHO
SURFHVRHVSRUOR
JHQHUDOIU¬ØR
7HPSHUDWXUD
DPELHQWH

3+$6( 
67$786B+ 
67$786B' 

3+$6( 
67$786B+ 
67$786B' 

63

&DOLHQWH
(VWDGRGHOSURFHVR
3XQWRGHRSHUDFL¬µQ

39
3XQWRGH
LQYHUVL¬µQ

/01

W
$'$37B21
W

976

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Optimizaci√≥n fina
La optimizaci√≥n fina solo puede realizarse despu√©s de una optimizaci√≥n inicial concluida
correctamente. Con ADAPT_ON = TRUE, TUN_EC decide si se llevar√° a cabo una
optimizaci√≥n inicial o una optimizaci√≥n fina. Si ya se dispone de informaci√≥n acerca del
proceso, TUN_EC calcula autom√°ticamente un escal√≥n de la variable manipulada y lleva a
cabo una optimizaci√≥n fina. Si no existe informaci√≥n acerca del proceso, se realiza una
optimizaci√≥n inicial.

Iniciar optimizaci√≥n
La optimizaci√≥n puede iniciarse tanto desde el modo autom√°tico como desde el modo manual.
‚óè Iniciar la optimizaci√≥n desde el modo autom√°tico
En el modo autom√°tico, active ADAPT_ON o ajuste ADAPT1ST = TRUE y especifique un
salto de consigna ‚â• MIN_STEP.
‚óè Iniciar la optimizaci√≥n desde el modo manual
En modo manual, active ADAPT_ON o ajuste ADAPT1ST = TRUE y especifique un escal√≥n
de consigna ‚â• MIN_STEP. Cuando, a continuaci√≥n, se resetee MAN_ON = FALSE , el
escal√≥n de consigna se har√° efectivo y la optimizaci√≥n se iniciar√°.

Optimizaci√≥n de refrigeraci√≥n
La optimizaci√≥n de refrigeraci√≥n solo es posible si la optimizaci√≥n inicial ha concluido
correctamente. Se inicia en la PHASE 4. Al ajustar COOLID_ON = TRUE, el regulador pasa a
modo manual y se emite LLLM_TUN: MAN_OUT = LLLM_TUN. TUN_EC pasa a PHASE = 3,
y se vuelve a desactivar inmediatamente COOLID_ON. Tan pronto como se encuentra un
punto de inflexi√≥n en la curva del valor real, TUN_EC vuelve al modo de regulaci√≥n (PHASE =
4). TUN_EC calcula un factor de relaci√≥n RATIOFAC, cuyo valor se transmite al generador de
impulsos del regulador.
Evoluci√≥n de curva en la optimizaci√≥n de refrigeraci√≥n

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

977

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

r&
3+$6( 
67$786B&


3+$6( 
67$786B&


HVWDFLRQDULR
(VWDGR

3+$6( 
67$786B& 

63
39
3XQWRGHLQYHUVL¬µQ
/01

(VWDGRGHOSURFHVR
IU¬ØR

W

///0B781


&22/,'B21
W

Nota
‚óè El bit de inicio COOLID_ON puede activarse al mismo tiempo con ADAPT1ST o
ADAPT_ON, as√≠ como durante una optimizaci√≥n de los par√°metros del regulador. De este
modo, una vez finalizada la optimizaci√≥n de los par√°metros del regulador para el
calentamiento, se inicia de inmediato la optimizaci√≥n de refrigeraci√≥n.
‚óè En una instalaci√≥n con varias zonas de temperatura acopladas t√©rmicamente (p. ej.
m√°quinas de transformaci√≥n de pl√°sticos), la optimizaci√≥n de refrigeraci√≥n no debe
iniciarse hasta que todas (!) las zonas no hayan finalizado la optimizaci√≥n inicial, ya que de
lo contrario se falsear√≠an los resultados de la optimizaci√≥n inicial.

Cancelar optimizaci√≥n
Para interrumpir la optimizaci√≥n antes del escal√≥n de consigna, es necesario ajustar
ADAPT_ON = FALSE . Para interrumpir la optimizaci√≥n despu√©s del salto de consigna
(PHASE 2 o 3) o interrumpir la optimizaci√≥n de refrigeraci√≥n, debe pasarse a modo manual
(MAN_ON = TRUE).
Al ajustar ADAPT_ON, ADAPT1ST o COOLID_ON durante una optimizaci√≥n en curso (PHASE
2 o 3) la optimizaci√≥n no se interrumpe, sino que se lleva a cabo hasta el final. Dado que no se
desactivan ADAPT_ON, ADAPT1ST ni COOLID_ON, en cuanto se cumplen las condiciones
de inicio se inicia una nueva optimizaci√≥n.

Fases de la optimizaci√≥n
La optimizaci√≥n del regulador se lleva a cabo en varias fases, que se indican en el par√°metro
PHASE .

978

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

PHASE = 0
Al crear un DB de instancia para TUN_EC, el par√°metro PHASE tiene preasignado el valor cero
y MAN_ON el valor TRUE. Por eso, despu√©s del primer ciclo se cambia al modo manual
(PHASE = 7). Desde el modo manual se puede iniciar directamente la optimizaci√≥n inicial
(ADAPT_ON = TRUE) o cambiar al modo autom√°tico. En el primer cambio al modo autom√°tico
MAN_ON = FALSE, se adoptan los par√°metros de PI_CON. Los valores predeterminados para
GAIN y TI son: GAIN = 1.5, TI = 1h.

PHASE = 2
En cuanto se especifica un escal√≥n de consigna ‚â• MIN_STEP en sentido positivo hacia el
punto de operaci√≥n del estado caliente del proceso, en la optimizaci√≥n inicial se preasigna a
MAN_OUT el valor LHLM_TUN, y en la optimizaci√≥n fina se preasigna a MAN_OUT un valor
calculado por TUN_EC. Adem√°s se activa QMAN_ON = TRUE. Ambos valores se transmiten
al regulador PID. El regulador PID se controla entonces en modo manual. MIN_STEP deber√≠a
ser superior al 10 % del rango de trabajo de consigna y real.

PHASE = 3
Si se detecta el punto de inversi√≥n de la respuesta al salto (STATUS_H = 2) o si el valor real
ha alcanzado el 70 % de la intensidad del salto de la consigna (STATUS_H = 3), se dise√±a un
regulador PI de ajuste cuidado. La ganancia del regulador GAIN se limita al rango entre 0.2 y
20.0. El regulador funciona a partir de ese momento como regulador PI e intenta regular el
proceso a un estado estacionario. TUN_EC guarda los nuevos par√°metros de regulador PI en
GAIN, TI y PI_CON. Los valores anteriores del regulador PI se guardan en PI_CON_OLD. Si
el tiempo necesario para alcanzar el estado estacionario es muy prolongado (respuesta
transitoria muy lenta en lazos de regulaci√≥n de temperatura), ya puede iniciarse el dise√±o del
regulador con los datos actuales al aproximarse al estado estacionario activando STEADY =
TRUE. El dise√±o del regulador tambi√©n se puede iniciar de nuevo con los datos actuales en un
momento posterior, en PHASE = 3 o PHASE = 4, mediante la activaci√≥n de STEADY = TRUE.
Con frecuencia, as√≠ se mejora un poco m√°s el dise√±o del regulador.
En la optimizaci√≥n inicial, los rebases transitorios o la imposibilidad de encontrar el punto de
inflexi√≥n pueden deberse a que se ha seleccionado una altura demasiado grande del escal√≥n
de la variable manipulada LHLM_TUN, y no deben atribuirse necesariamente a un mal ajuste
del regulador. En la siguiente optimizaci√≥n inicial, asigne a LHLM_TUN un valor aprox. un 20%
menor.
Si TUN_EC ha detectado el estado estacionario o ha transcurrido desde el escal√≥n de la
variable manipulada el tiempo 30 √ó TI (TI: tiempo de integraci√≥n del regulador PI ajustado en
PHASE = 3), se realiza un dise√±o mejorado del regulador, y se cambia a PHASE = 4. TUN_ES
guarda los nuevos par√°metros de regulador PI/PID en GAIN, TI, TD y PI_CON o PID_CON. Los
valores anteriores del regulador PID se guardan en PID_CON_OLD. A ser posible se dise√±an
un regulador PID y un regulador PI. Para PID_ON = TRUE, se activa el regulador PID, o en su
caso el regulador PI. GAIN se limita de manera que la ganancia del lazo abierto (producto de
GAIN por la ganancia del proceso) sea inferior a 80.0.

PHASE = 4
En esta fase el regulador regula con sus par√°metros optimizados. Desde este estado se puede
iniciar una optimizaci√≥n de refrigeraci√≥n, una optimizaci√≥n fina o una optimizaci√≥n inicial.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

979

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Es posible alternar en cualquier momento sin discontinuidad entre el regulador PI y el
regulador PID.

Realizar una optimizaci√≥n inicial
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.
‚óè TUN_EC est√° interconectado con un regulador continuo o un regulador de impulsos.
‚óè MAN_ON = FALSE
‚óè El regulador est√° en modo autom√°tico.
‚óè El proceso est√° en estado estacionario.

Procedimiento
Para determinar los par√°metros PID √≥ptimos en la primera puesta en servicio, haga lo
siguiente:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimizaci√≥n inicial".
TUN_EC est√° disponible para la optimizaci√≥n.
3. Seleccione una estructura del regulador.
4. Introduzca en el campo "Variable manipulada" una variable manipulada, que se utilizar√°
hasta que se pase a la PHASE = 3.
5. En el campo "Consigna", indique una consigna. El escal√≥n de consigna debe ser ‚â•
MIN_STEP. La variable manipulada no ser√° efectiva hasta que no exista una nueva
consigna.
6. Haga clic en el s√≠mbolo
"Iniciar optimizaci√≥n".
La consigna y la variable manipulada se transferir√°n al regulador. Se iniciar√° la optimizaci√≥n
inicial. Se mostrar√° el estado de la optimizaci√≥n.

Realizar optimizaci√≥n fina
Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.
‚óè TUN_EC est√° interconectado con un regulador continuo o un regulador de impulsos.
‚óè MAN_ON = FALSE
‚óè El regulador est√° en modo autom√°tico.
‚óè El proceso est√° en estado estacionario.

980

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para determinar los par√°metros PID √≥ptimos en el punto de operaci√≥n, haga lo siguiente:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimizaci√≥n fina".
TUN_EC est√° disponible para la optimizaci√≥n.
3. Seleccione una estructura del regulador.
4. En el campo "Consigna", indique una consigna. El escal√≥n de consigna debe ser ‚â•
MIN_STEP.
5. Haga clic en el s√≠mbolo
"Iniciar optimizaci√≥n".
Se enviar√° la nueva consigna al regulador. TUN-EC calcular√° un escal√≥n de la variable
manipulada. Se iniciar√° la optimizaci√≥n fina. Se mostrar√° el estado de la optimizaci√≥n.

Efectuar una optimizaci√≥n de la refrigeraci√≥n
Durante la optimizaci√≥n de refrigeraci√≥n se calcula el factor de relaci√≥n para reguladores con
dos actuadores de acci√≥n contrapuesta (p. ej. calentar/enfriar).

Requisitos
‚óè La optimizaci√≥n inicial se ha llevado a cabo correctamente.
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.
‚óè TUN_EC est√° interconectado con un regulador continuo o un regulador de impulsos.
‚óè MAN_ON = FALSE
‚óè El regulador est√° en modo autom√°tico.
‚óè El proceso est√° en estado estacionario.

Procedimiento
Para obtener el factor de relaci√≥n, haga lo siguiente:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimizaci√≥n de la refrigeraci√≥n".
TUN_EC est√° disponible para la optimizaci√≥n.
3. Seleccione una estructura del regulador.
4. En el campo "Variable manipulada", introduzca una variable manipulada, que se utilizar√°
hasta que se encuentre el punto de inflexi√≥n.
5. Haga clic en el s√≠mbolo
"Iniciar optimizaci√≥n".
Se inicia la optimizaci√≥n de refrigeraci√≥n. Se mostrar√° el estado de la optimizaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

981

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Realizar una optimizaci√≥n manual
Si, despu√©s de una optimizaci√≥n inicial, se producen oscilaciones en el lazo de regulaci√≥n
cerrado, o existen rebases transitorios despu√©s de escalones de consigna, pueden
modificarse manualmente los par√°metros PID. P. ej., puede restablecer la ganancia del
regulador GAIN al 80% del valor inicial, o aumentar el tiempo de integraci√≥n TI hasta el 150%
del valor ajustado inicialmente. Si se usa un regulador de impulsos, pueden producirse
peque√±as oscilaciones permanentes que se eliminan aumentando la zona muerta DEADB_W.

Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.

Procedimiento
Para determinar manualmente los par√°metros PID √≥ptimos, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo", seleccione la entrada "Manual".
3. Seleccione una estructura del regulador.
4. Introduzca par√°metros PID nuevos en los campos "P", "I" y "D".
5. En el grupo "Optimizaci√≥n", haga clic en el s√≠mbolo

"Enviar par√°metros al regulador".

6. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna".
7. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
s√≠mbolo .
8. En caso necesario, desactive la casilla de verificaci√≥n "Modo manual".
El regulador trabajar√° con los nuevos par√°metros PID y regular√° de acuerdo con la nueva
consigna.
9. Compruebe la calidad de los par√°metros PID mediante los recorridos de la curva.
10.Repita los pasos del 3 al 9 hasta obtener una regulaci√≥n satisfactoria.

3.5.3.2

Optimizar el regulador paso a paso

Interconectar TUN_ES con el regulador
La instrucci√≥n TUN_ES permite optimizar un regulador paso a paso. Seg√∫n el regulador,
TUN_ES se activa con una de las siguientes instrucciones:
Regulador

Instrucci√≥n

Regulador paso a paso FM 355 S

PID_FM

Regulador paso a paso FM 455 S

PID_FM

Funciones b√°sicas PID

CONT_S
TCONT_S

982

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Regulador

Instrucci√≥n

Standard PID Control (paquete opcional)

PID_ES

Modular PID Control (paquete opcional)

PID
LMNGEN_S

Interconecte los par√°metros de entrada y salida de la instrucci√≥n TUN_ES con la instrucci√≥n
del regulador del modo que se describe a continuaci√≥n.
TUN_ES

PID_FM

CONT_S

TCONT_S

PID_ES

PV

PV

PV

PV

PV

LMNR

LMN_A

--

--

LMNR_IN

NORM_FAC

--

--

--

(NM_PVHRNM_PVLR)*0.01

C_LMNUP

QLMNUP

QLMNUP

QLMNUP

QLMNUP

C_LMNDN

QLMNDN

QLMNDN

QLMNDN

QLMNDN

LMNR_HS

QLMNR_HS

LMNR_HS

LMNR_HS

LMNR_HS

LMNR_ON

QLMNR_ON

--

--

LMNR_ON

WRITE_DIS

Operaci√≥n l√≥gica O
con LOAD_OP y
LOAD_PAR

--

--

--

MAN_OUT

LMN_RE

--

--

MAN

SP_OUT

SP_RE

SP_INT

SP_INT

SP_INT o
SP_EXT

GAIN

GAIN

GAIN

GAIN

GAIN

TI

TI

TI

TI

TI

TD

TD

--

--

TD

TM_LAG

TM_LAG

--

--

TM_LAG

MTR_TM

MTR_TM

MTR_TM

MTR_TM

MTR_TM

DEADB_W

DEADB_W

DEADB_W

DEADB_W

DEADB_W

PHASE

--

--

--

PHASE

QMAN_ON

LMN_REON

--

--

MAN_ON

QLMNS_ON

LMNSOPON

LMNS_ON

LMNS_ON

LMNS_ON

QLMNUP

LMNUP_OP

LMNUP

LMNUP

LMNUP

QLMNDN

LMNDN_OP

LMNDN

LMNDN

LMNDN

QI_SEL

--

--

--

I_SEL

QD_SEL

--

--

--

D_SEL

QWRITE

LOAD_PAR y

--

--

--

LOAD_OP

Posibilidades de la optimizaci√≥n
Optimizaci√≥n inicial
La optimizaci√≥n de los par√°metros PID se realiza durante el calentamiento. Para ello se lleva
a cabo una identificaci√≥n del proceso seguida de un dise√±o del regulador.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

983

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
La optimizaci√≥n inicial puede solicitarse con ADAPT1ST.
Si se ajusta ADAPT1ST = TRUE, entonces ADAPT_ON = TRUE y se cierra la v√°lvula (PHASE
= 1).
Con ADAPT1ST = TRUE se ejecuta la rutina de inicializaci√≥n de la instrucci√≥n TUN_ES. Se
llevan a cabo los siguientes ajustes predeterminados:
‚óè Se conmuta al regulador PI. Para ello se transfieren al regulador los par√°metros de
PI_CON. Si los par√°metros PI_CON.GAIN y PI_CON.TI tienen ambos el valor 0.0, se les
asignar√°n los valores predeterminados PI_CON.GAIN = 1.5 y PI_CON.TI = 3600.0 s.
‚óè PROCESS.GAIN = 999.0
‚óè STATUS_H = 0; STATUS_D = 0
Nota
A menos que desee hacerlo expresamente, en caso de rearranque completo (en caliente)
de la CPU no llame TUN_ES como es habitual con otras instrucciones, pues de lo contrario
se perder√°n todos los par√°metros de proceso.
Despu√©s de un escal√≥n de consigna ‚â• MIN_STEP se mide el tiempo de posicionamiento del
motor y a continuaci√≥n se lleva a cabo una optimizaci√≥n inicial. En la optimizaci√≥n inicial,
TUN_ES utiliza para la excitaci√≥n del proceso el par√°metro LHLM_TUN, que determina el
escal√≥n de la variable manipulada. En los reguladores paso a paso con realimentaci√≥n de
posici√≥n, se avanza directamente hasta el valor LHLM_TUN. En los reguladores paso a paso
sin realimentaci√≥n de posici√≥n, la servov√°lvula se abre por completo y se vuelve a cerrar de
nuevo hasta que transcurre la proporci√≥n especificada (100 - LHLM_TUN) del tiempo de
posicionamiento del motor.
Optimizaci√≥n inicial con medici√≥n del tiempo de posicionamiento del motor para reguladores
paso a paso sin realimentaci√≥n de posici√≥n

984

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
r&

3+$6( 
67$786B+ 
67$786B' 

3+$6( 
67$786B+ 
67$786B' 

/+/0B781HQ
3ULPHUDMXVWH
DXWRP¬£WLFR
YDORU
DMXVWDGRHQ
2SWLPL]DFL¬µQILQD

3+$6( 
67$786B+ 
67$786B' 

63

39
3XQWRGH
LQYHUVL¬µQ

HVWDGRHVWDFLRQDULR
HQHOSULPHUDMXVWH
HOHVWDGRGHO
SURFHVRHVSRUOR
JHQHUDOIU¬ØR
7HPSHUDWXUD
DPELHQWH

3+$6( 
67$786B+ 
67$786B' 

&DOLHQWH
(VWDGRGHO
SURFHVR
3XQWRGH
RSHUDFL¬µQ

/01

W
075B70

$'$37B21
W

Optimizaci√≥n fina
La optimizaci√≥n solo se puede iniciar con ADAPT_ON en los reguladores paso a paso con
realimentaci√≥n de posici√≥n. A partir de los valores de proceso anteriores, TUN_ES decide si se
realizar√° una optimizaci√≥n inicial sin medici√≥n del tiempo de posicionamiento del motor o una
optimizaci√≥n fina. Con ADAPT_ON = TRUE seguido de un escal√≥n de consigna ‚â• MIN_STEP
en sentido positivo, se inicia la optimizaci√≥n. En ese momento, TUN_ES pasa inmediatamente
a la PHASE = 2 y realiza un escal√≥n de consigna a LHLM_TUN en el caso de la optimizaci√≥n
inicial, o a una variable manipulada calculada autom√°ticamente, en el caso de la optimizaci√≥n
fina.
El escal√≥n de la variable manipulada en la optimizaci√≥n inicial suele saltar desde la consigna
del proceso en fr√≠o (temperatura ambiente) hasta la proximidad del punto de operaci√≥n.
Tambi√©n puede usarse como estado inicial cualquier otra consigna, a condici√≥n de que se trate
de un estado estacionario. Durante la optimizaci√≥n no pueden especificarse m√°s escalones de
la variable manipulada.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

985

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Iniciar optimizaci√≥n
La optimizaci√≥n puede iniciarse tanto desde el modo autom√°tico como desde el modo manual.
‚óè Iniciar la optimizaci√≥n desde el modo autom√°tico
En el modo autom√°tico, active ADAPT_ON o ajuste ADAPT1ST = TRUE y especifique un
salto de consigna ‚â• MIN_STEP.
‚óè Iniciar la optimizaci√≥n desde el modo manual
En modo manual, active ADAPT_ON o ajuste ADAPT1ST = TRUE y especifique un escal√≥n
de consigna ‚â• MIN_STEP. Cuando, a continuaci√≥n, se resetee MAN_ON = FALSE , el
escal√≥n de consigna se har√° efectivo y la optimizaci√≥n se iniciar√°.

Cancelar optimizaci√≥n
Para interrumpir la optimizaci√≥n antes del escal√≥n de consigna, es necesario ajustar
ADAPT_ON = FALSE . Para interrumpir la optimizaci√≥n despu√©s del escal√≥n de consigna
(PHASE 2 o 3) o interrumpir la optimizaci√≥n de refrigeraci√≥n, debe pasarse a modo manual
(MAN_ON = TRUE = LMNS_ON = TRUE).
Al ajustar ADAPT_ON o ADAPT1ST durante una optimizaci√≥n (PHASE 2 o 3) la optimizaci√≥n
no se interrumpe, sino que se lleva a cabo hasta el final. Dado que no se desactivan
ADAPT_ON ni ADAPT1ST, en cuanto se cumplen las condiciones de inicio se inicia una nueva
optimizaci√≥n.

Fases de la optimizaci√≥n
La optimizaci√≥n del regulador se lleva a cabo en varias fases, que se indican en el par√°metro
PHASE .

PHASE = 0
Al crear un DB de instancia para TUN_ES, el par√°metro PHASE tiene preasignado el valor cero
y LMNS_ON el valor TRUE. Por eso, despu√©s del primer ciclo se cambia al modo manual
(PHASE = 7). Desde el modo manual se puede iniciar directamente la optimizaci√≥n inicial
(ADAPT_ON = TRUE) o cambiar al modo autom√°tico. En el primer cambio al modo autom√°tico
MAN_ON = FALSE, se adoptan los par√°metros de PI_CON. Los valores predeterminados para
GAIN y TI son: GAIN = 1.5, TI = 1h.

PHASE = 1
Una vez que la optimizaci√≥n ha comenzado con ADAPT1ST = TRUE, TUN_ES cierra la
servov√°lvula (variable manipulada = 0 o LMNS_ON = LMNDN = TRUE) y espera hasta un
escal√≥n positivo de la consigna ‚â• MIN_STEP.

PHASE = 2
En el momento en que se especifica un escal√≥n de consigna ‚â• MIN_STEP en sentido positivo
hacia el punto de operaci√≥n del estado caliente del proceso, en la optimizaci√≥n inicial se asigna
a MAN_OUT el valor LHLM_TUN, y en la optimizaci√≥n fina se asigna a MAN_OUT un valor
calculado por TUN_ES. MIN_STEP debe ser mayor que el 10% del rango de trabajo entre
consigna y valor real.

986

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
En la regulaci√≥n paso a paso con realimentaci√≥n de posici√≥n (LMNR_ON=TRUE), se asigna
a QMAN_ON el valor TRUE. El regulador regula la v√°lvula al valor de MAN_OUT y TUN_ES
calcula el tiempo de posicionamiento del motor MTR_TM.
En la regulaci√≥n paso a paso sin realimentaci√≥n de posici√≥n, QLMNS_ON y QLMNUP se
ajustan a TRUE y la v√°lvula se mueve hasta el tope superior. Al alcanzar el tope superior
(LMNR_HS =TRUE), TUN_ES calcula el tiempo de posicionamiento del motor y lo transmite al
regulador. A continuaci√≥n la v√°lvula se cierra hasta el valor de MAN_OUT (QLMNDN = TRUE).

PHASE = 3
Si se detecta el punto de inversi√≥n de la respuesta al salto (STATUS_H = 2) o si el valor real
ha alcanzado el 70 % de la intensidad del salto de la consigna (STATUS_H = 3), se dise√±a un
regulador PI de ajuste cuidado. La ganancia del regulador GAIN se limita al rango entre 0.2 y
20.0. El regulador funciona a partir de ese momento como regulador PI e intenta regular el
proceso a un estado estacionario. TUN_ES guarda los nuevos par√°metros de regulador PI en
GAIN, TI y PI_CON. Los valores anteriores del regulador PI se guardan en PI_CON_OLD. Si
el tiempo necesario para alcanzar el estado estacionario es muy prolongado (respuesta
transitoria muy lenta en lazos de regulaci√≥n de temperatura), ya puede iniciarse el dise√±o del
regulador con los datos actuales al aproximarse al estado estacionario activando STEADY =
TRUE. El dise√±o del regulador tambi√©n se puede iniciar de nuevo con los datos actuales en un
momento posterior, en PHASE = 3 o PHASE = 4, mediante la activaci√≥n de STEADY = TRUE.
Con frecuencia, as√≠ se mejora un poco m√°s el dise√±o del regulador.
En la optimizaci√≥n inicial, los rebases transitorios o la imposibilidad de encontrar el punto de
inflexi√≥n pueden deberse a que se ha seleccionado una altura demasiado grande del escal√≥n
de la variable manipulada LHLM_TUN, y no deben atribuirse necesariamente a un mal ajuste
del regulador. En la siguiente optimizaci√≥n inicial, asigne a LHLM_TUN un valor aprox. un 20%
menor.
Si TUN_ES ha detectado el estado estacionario o ha transcurrido desde el escal√≥n de la
variable manipulada el tiempo 30 √ó TI (TI: tiempo de integraci√≥n del regulador PI ajustado en
PHASE = 3), se realiza un dise√±o mejorado del regulador, y se cambia a PHASE = 4. TUN_ES
guarda los nuevos par√°metros de regulador PI/PID en GAIN, TI, TD y PI_CON o PID_CON. Los
valores anteriores del regulador PID se guardan en PID_CON_OLD. A ser posible se dise√±an
un regulador PID y un regulador PI. Si PID_ON = TRUE, se activa el regulador PID, de lo
contrario el regulador PI. En procesos complejos, TUN_ES dise√±a siempre un regulador PI
independientemente de PID_ON. GAINse limita de tal manera que la ganancia del lazo abierto
(producto de GAIN por la ganancia del proceso) sea inferior a 40.0.

PHASE = 4
En esta fase el regulador regula con sus par√°metros optimizados. Desde este estado se puede
iniciar una optimizaci√≥n fina o una optimizaci√≥n inicial.
Es posible alternar en cualquier momento sin discontinuidad entre el regulador PI y el
regulador PID.

Realizar una optimizaci√≥n inicial
La optimizaci√≥n inicial de los par√°metros del regulador se realiza durante el calentamiento.
Para ello se lleva a cabo una identificaci√≥n del proceso seguida de un dise√±o del regulador.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

987

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.
‚óè TUN_ES est√° interconectado con un regulador paso a paso.
‚óè MAN_ON = FALSE
‚óè El regulador est√° en modo autom√°tico.
‚óè El proceso est√° en estado estacionario.

Procedimiento
Para determinar los par√°metros PID √≥ptimos en la primera puesta en servicio, haga lo
siguiente:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimizaci√≥n inicial".
TUN_ES est√° disponible para la optimizaci√≥n.
3. Seleccione una estructura del regulador.
4. Introduzca en el campo "Variable manipulada" una variable manipulada, que se utilizar√°
hasta que se pase a la PHASE = 3.
5. Introduzca una nueva consigna. El escal√≥n de consigna debe ser ‚â• MIN_STEP.
6. Haga clic en el s√≠mbolo "Iniciar optimizaci√≥n".
Se iniciar√° la optimizaci√≥n inicial. Se mostrar√° el estado de la optimizaci√≥n.

Realizar optimizaci√≥n fina
En los reguladores paso a paso con realimentaci√≥n de posici√≥n puede iniciarse una
optimizaci√≥n fina. Si cambia el punto de operaci√≥n o el comportamiento del proceso, el
regulador puede reoptimizarse online durante un salto positivo de la consigna.

Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.
‚óè TUN_ES est√° interconectado con un regulador paso a paso.
‚óè MAN_ON = FALSE
‚óè LMNR_ON = TRUE en la instrucci√≥n TUN_ES y en el regulador.
‚óè El regulador est√° en modo autom√°tico.
‚óè El proceso est√° en estado estacionario.

988

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para determinar los par√°metros PID √≥ptimos en la primera puesta en servicio, haga lo
siguiente:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimizaci√≥n fina".
TUN_ES est√° disponible para la optimizaci√≥n.
3. Seleccione una estructura del regulador.
4. Introduzca una nueva consigna. El escal√≥n de consigna debe ser ‚â• MIN_STEP.
5. Haga clic en el s√≠mbolo "Iniciar optimizaci√≥n".
Se iniciar√° la optimizaci√≥n fina. TUN_ES determinar√° la variable manipulada. Se mostrar√°
el estado de la optimizaci√≥n.

Realizar una optimizaci√≥n manual
Si, despu√©s de una optimizaci√≥n inicial, se producen oscilaciones en el lazo de regulaci√≥n
cerrado, o existen rebases transitorios despu√©s de escalones de consigna, pueden
modificarse manualmente los par√°metros PID. P. ej., puede restablecer la ganancia del
regulador GAIN al 80% del valor inicial, o aumentar el tiempo de integraci√≥n TI hasta el 150%
del valor ajustado inicialmente.

Requisitos
‚óè La instrucci√≥n y el objeto tecnol√≥gico est√°n cargados en la CPU.
‚óè TUN_ES est√° interconectado con un regulador paso a paso.
‚óè MAN_ON = FALSE
‚óè El regulador est√° en modo autom√°tico.
‚óè El proceso est√° en estado estacionario.

Procedimiento
Para determinar manualmente los par√°metros PID √≥ptimos, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo", seleccione la entrada "Manual".
3. Seleccione una estructura del regulador.
4. Introduzca par√°metros PID nuevos en los campos "P", "I" y "D".
5. En el grupo "Optimizaci√≥n", haga clic en el s√≠mbolo "Enviar par√°metros al regulador".
6. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

989

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
7. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
s√≠mbolo .
8. En caso necesario, desactive la casilla de verificaci√≥n "Modo manual".
El regulador trabajar√° con los nuevos par√°metros PID y regular√° de acuerdo con la nueva
consigna.
9. Compruebe la calidad de los par√°metros PID mediante los recorridos de la curva.
10.Repita los pasos del 3 al 9 hasta obtener una regulaci√≥n satisfactoria.

3.5.4

Fundamentos de los m√≥dulos de regulaci√≥n

3.5.4.1

Entradas

Introducci√≥n
En las entradas anal√≥gicas se pueden conectar diferentes tipos de sensores. Las se√±ales de
entrada de los sensores se procesan a continuaci√≥n seg√∫n las necesidades.
Las entradas digitales permiten poner el m√≥dulo en diferentes modos de operaci√≥n.
Los reguladores K y S tienen la misma estructura en cuanto a entradas anal√≥gicas y digitales.

N√∫mero de entradas

990

Entrada

FM 355

FM 355-2

FM 455

Entradas anal√≥gicas con acondiciona‚Äê
miento de los valores anal√≥gicos

4

4

16

Entrada de uni√≥n fr√≠a para la compensa‚Äê
ci√≥n de termopares

1

1

1

Entradas digitales

8

8

16

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Entradas anal√≥gicas
Bloques de funci√≥n de una entrada anal√≥gica
La figura siguiente muestra el esquema para el acondicionamiento de los valores anal√≥gicos:
7LSRGHVHQVRU
$

'
)LOWUR

5D¬Ø]
FXDGUDGD

3ROLO¬ØQHD

9DORU
1RUPDOL]DU DQDO¬µJLFR
SUHSDUDGR

(QWUDGDGH
UHIHUHQFLD
3DUDPHWUL]DGR

Adaptaci√≥n a sensores
Las entradas anal√≥gicas se pueden adaptar a diferentes sensores mediante su
parametrizaci√≥n. Son posibles los siguientes ajustes:
‚óè La entrada anal√≥gica no se procesa (p. ej. entrada no utilizada)
Con este ajuste, todos los par√°metros PID se ajustan a cero, el canal de regulaci√≥n no se
procesa y no se calcula ninguna variable manipulada.
‚óè Sensor de intensidad 0 a 20 mA
‚óè Sensor de intensidad 4 a 20 mA
‚óè Sensor de tensi√≥n 0 a 10 V
‚óè Pt 100, ‚Äì200 ... 850 ¬∞C
‚óè Pt 100, ‚Äì200 ... 556 ¬∞C (resoluci√≥n doble)
‚óè Pt 100, ‚Äì200 ... 130 ¬∞C (resoluci√≥n cu√°druple)
‚óè Termopares tipo B, J, K, R y S (entrada anal√≥gica ajustada a ¬±80 mV)
‚óè Termopar libre (entrada anal√≥gica ajustada a ¬±80 mV)
Las entradas anal√≥gicas se parametrizan en la pantalla "Entrada anal√≥gica".

Cambio Celsius/Fahrenheit
Las temperaturas se pueden medir tanto en ¬∞C como en ¬∞F.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

991

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Adaptaci√≥n a la frecuencia de red
Para suprimir interferencias durante la medici√≥n de se√±ales anal√≥gicas se puede ajustar el
procesamiento de la se√±al de entrada a la frecuencia de red. Son posibles los siguientes
ajustes:
‚óè Funcionamiento a 50 Hz
‚óè Funcionamiento a 60 Hz

Uni√≥n fr√≠a
Si se ha ajustado un termopar como sensor en una entrada anal√≥gica, se puede conectar en
la entrada de uni√≥n fr√≠a del m√≥dulo un Pt 100 para compensar la temperatura de referencia en
termopares. De forma alternativa, se puede parametrizar una temperatura de uni√≥n fr√≠o fija.
En el FM 355 se puede parametrizar opcionalmente una compensaci√≥n interna para los
termopares J, K y E. Un sensor de temperatura interno mide la temperatura de la uni√≥n fr√≠a
directamente en el m√≥dulo.
Si se utiliza la entrada de uni√≥n fr√≠a, el tiempo de muestreo de cada regulador se prolonga en
el tiempo de conversi√≥n de la entrada de uni√≥n fr√≠a.

Acondicionamiento de valores anal√≥gicos
El acondicionamiento de los valores anal√≥gicos ofrece diferentes posibilidades
parametrizables para acondicionar las se√±ales de entrada. La siguiente tabla ofrece una visi√≥n
de conjunto de estos par√°metros y los valores ajustables.
Par√°metro
Resoluci√≥n

Valores ajustables
‚óè 12 bits

Observaciones
Tiempo de conversi√≥n 20 ms (50 Hz)
Tiempo de conversi√≥n 162/3 ms (60 Hz)

Filtro

‚óè 14 bits

Tiempo de conversi√≥n 100 ms

‚óè On/Off

Filtro de 1er orden cuya respuesta tem‚Äê
poral est√° determinada por la constante
de tiempo

‚óè Constante de tiempo en s
Ra√≠z cuadrada

‚óè On/Off

Para linealizar se√±ales de enc√≥der en las
que el valor real existe como magnitud
f√≠sica en relaci√≥n cuadr√°tica con la mag‚Äê
nitud medida del proceso

Polil√≠nea

‚óè On/Off

Para linealizar curvas caracter√≠sticas de
enc√≥der

‚óè 13 puntos de apoyo seleccionables
en

Normalizaci√≥n

‚Äì

mA con entrada de intensidad

‚Äì

mV con entrada de tensi√≥n

‚óè Valor superior
‚óè Valor inferior

992

Para la conversi√≥n de la se√±al de entrada
en otra unidad f√≠sica mediante interpola‚Äê
ci√≥n lineal entre el valor inicial (abajo) y el
valor final (arriba)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Nota
Normalizaci√≥n/polil√≠nea: La conversi√≥n de la unidad mA o mV en una unidad f√≠sica se realiza
mediante polil√≠nea o (si esta no est√° activada) mediante normalizaci√≥n. La polil√≠nea se utiliza
para linealizar un termopar libre o para cualquier linealizaci√≥n.

Copiar par√°metros
Los FMs ofrecen en la entrada anal√≥gica la posibilidad de transferir par√°metros de una entrada
a otra o varias entradas. Todos los par√°metros ajustados del canal de salida se transfieren a
los canales de destino.

Entradas digitales
Modos de operaci√≥n
Las entradas digitales sirven para cambiar los modos de operaci√≥n de canales de regulaci√≥n
individuales.
El sentido de acci√≥n de las entradas digitales es parametrizable. Para cada entrada digital
individual son posibles los siguientes ajustes:
‚óè High activo
‚óè Low activo o abierto
Se pueden seleccionar los siguientes modos de operaci√≥n:
‚óè Conmutaci√≥n a la variable manipulada especificada con el FB PID_FM
‚óè Cambio a modo de seguimiento (variable manipulada especificada mediante una entrada
anal√≥gica)
‚óè Conmutaci√≥n a variable manipulada de seguridad
Con el regulador paso a paso se pueden definir adem√°s las siguientes se√±ales a trav√©s de
entradas digitales:
‚óè Respuesta: Actuador en tope superior
‚óè Respuesta: Actuador en tope inferior

Optimizaci√≥n paralela
La funci√≥n "Optimizaci√≥n paralela" s√≥lo est√° disponible para el FM 355-2.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

993

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Zonas vecinas (fuete acoplamiento t√©rmico)
Si dos o m√°s reguladores de un m√≥dulo regulan la temperatura p. ej. de una placa (p. ej. dos
calefacciones y dos valores reales medidos con fuerte acoplamiento de calor), existe la
posibilidad de realizar una optimizaci√≥n paralela para estos reguladores. Proceda del siguiente
modo:
1. Defina los canales conexos en la zona A o la zona B.
2. Inicie la optimizaci√≥n en uno de los canales. La optimizaci√≥n de los canales conexos se
inicia entonces autom√°ticamente.
Nota
Sin embargo, en caso de excitaci√≥n por escal√≥n de consigna el usuario debe garantizar la
activaci√≥n simult√°nea de los escalones de consigna. Con el asistente, los par√°metros
PID_ON y TUN_DLMN/TUN_CLMN s√≥lo se pueden especificar para un canal. Los
par√°metros para el resto de canales tienen que predefinirse con los correspondientes DBs
de instancia del FB FMT_PID antes de iniciar la optimizaci√≥n.

Cancelaci√≥n de la optimizaci√≥n
Si aparece un error en uno de los canales (fase 0 o final de la fase 1), se cancela la optimizaci√≥n
de todos los canales.
El usuario puede restablecer la optimizaci√≥n poniendo TUN_ON=FALSE en alguno de los
canales implicados.
Si un canal pasa al modo de seguridad, tambi√©n se desactiva la optimizaci√≥n de los canales
implicados.
En el asistente s√≥lo se muestra la informaci√≥n de estado del canal seleccionado. Encontrar√°
las causas de error de los canales restantes en los correspondientes DBs de instancia.

Ventaja
Los reguladores implicados emiten su correspondiente magnitud manipulada de optimizaci√≥n
hasta que todos los reguladores hayan abandonado la fase 2. De esta forma se evita que el
regulador que primero finalice la optimizaci√≥n falsifique el resultado de optimizaci√≥n del resto
de reguladores al modificar su magnitud manipulada.
ATENCI√ìN
El hecho de alcanzar el 75% del escal√≥n de consigna en uno de los canales implicados no
finaliza la optimizaci√≥n (peligro de sobreoscilaci√≥n). El modo autom√°tico se inicia cuando
todos los reguladores implicados han finalizado su optimizaci√≥n.

994

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Zonas vecinas (d√©bil acoplamiento t√©rmico)
En general se aplica la norma de que habr√≠a que optimizar tal y como se vaya a regular
despu√©s. Si en el modo de producci√≥n las zonas se recorren juntas en paralelo, de forma que
las diferencias de temperatura entre las zonas se mantienen iguales, durante la optimizaci√≥n
tambi√©n deber√≠a aumentarse correspondientemente el nivel de temperatura de las zonas
vecinas.
Las diferencias de temperatura al inicio del intento no son relevantes ya que se compensan con
una calefacci√≥n inicial correspondiente (rampa inicial = 0).

3.5.4.2

Error de regulaci√≥n

Copiar canales
En un regulador los FMs ofrecen la posibilidad de transferir un canal de regulaci√≥n a uno o
varios canales. Todos los ajustes del canal de salida se transfieren a los canales de destino.

Tipos de reguladores
En todos los m√≥dulos de regulaci√≥n el error de regulaci√≥n tiene la misma estructura.
1. La se√±al del valor real se acondiciona para obtener el valor real efectivo.
2. La se√±al de la consigna se acondiciona para obtener la consigna efectiva.
3. La consigna efectiva se resta del valor real efectivo.
4. El error de regulaci√≥n restante se agrega al algoritmo de regulaci√≥n.
Para la consigna y el valor real se pueden seleccionar los or√≠genes de regulaci√≥n, para utilizar
entonces el m√≥dulo de regulaci√≥n como:
‚óè Regulador de valor fijo y en cascada
‚óè Regulador de tres componentes
‚óè Regulador de relaci√≥n y de mezcla

Regulador de valor fijo y en cascada
En el regulador de seguimiento de una regulaci√≥n en cascada se selecciona como consigna la
variable manipulada de un regulador piloto.

Regulador de tres componentes
El regulador de tres componentes dispone de tres entradas para el valor real. Los valores
reales A, B y C se suman y dan como resultado el flujo total PV en una regulaci√≥n de mezcla.
‚óè Regulador de mezcla
Un regulador de mezcla siempre es un regulador de seguimiento. El correspondiente
regulador piloto es un regulador de tres componentes.
La magnitud manipulada del regulador piloto se conecta a trav√©s de la entrada Valor real D.
El factor de mezcla se define a trav√©s de la entrada de consigna del regulador.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

995

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulador de relaci√≥n
Un regulador de relaci√≥n siempre es un regulador de seguimiento. El correspondiente
regulador piloto es un regulador de consigna fija.
Como valor real D se selecciona el valor real del regulador piloto. El factor de proporci√≥n se
define a trav√©s de la entrada de consigna. Si se ha seleccionado una salida de regulador como
factor de relaci√≥n, la consigna se convierte (normaliza) al rango de valores "barrera inferior ...
barrera superior" con ayuda de la barrera inferior y superior de "0... 100%".

Regulador de mezcla
Un regulador de mezcla siempre es un regulador de seguimiento. El correspondiente
regulador piloto es un regulador de tres componentes.
Como valor real D se selecciona la magnitud manipulada del regulador piloto. El factor de
mezcla se define a trav√©s de la entrada de consigna del regulador.
La magnitud manipulada del regulador del flujo total se indica en el rango de valores 0% a
100%. El regulador de seguimiento convierte esta magnitud del valor real D al rango de valores
del valor real A. El rango de valores del valor real A son los valores de normalizaci√≥n "arriba"
y "abajo" de la entrada anal√≥gica seleccionada.
Si la magnitud manipulada de un regulador de seguimiento llega al l√≠mite o si el aumento de la
consigna de un regulador de seguimiento est√° limitado por la funci√≥n rampa de la rama de
consigna, la acci√≥n I del regulador piloto se bloquea en funci√≥n del sentido (Anti-ResetWindup) hasta que se haya solucionado la causa de la limitaci√≥n en el regulador de
seguimiento.

Selecci√≥n de se√±al para consigna, valor real, entrada D y magnitud perturbadora
Selecci√≥n de se√±al
Para la consigna, valor real, valor de la entrada D (entrada de acci√≥n D) y magnitud
perturbadora de cada canal de regulaci√≥n se puede seleccionar entre diferentes or√≠genes de
regulaci√≥n. La siguiente tabla muestra una visi√≥n de conjunto sobre las posibilidades de
selecci√≥n de se√±al.
Tabla 3-2

Selecci√≥n de se√±al para consigna, valor real, entrada D y magnitud perturbadora

Valores afectados
Consigna

Origen de se√±al seleccionable
‚óè Un valor predefinido por el programa de usuario a trav√©s del bloque de
funci√≥n
‚óè El valor anal√≥gico acondicionado de una entrada anal√≥gica
‚óè La variable manipulada (LMN, LMN_A o LMN_B) de otro canal de
regulaci√≥n (en conexi√≥n en cascada de reguladores)

Valores reales A, B y C

‚óè Cero
‚óè El valor anal√≥gico acondicionado de una entrada anal√≥gica
(los valores reales B y C se pueden valorar adicionalmente por factores)

996

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Valores afectados
Valor real D

Origen de se√±al seleccionable
‚óè Cero
‚óè El valor anal√≥gico acondicionado de una entrada anal√≥gica
‚óè Variable manipulada de otro canal de regulaci√≥n

Valor para la entrada D
(s√≥lo relevante en regu‚Äê
ladores PD o PID)

‚óè El error de regulaci√≥n tras la zona muerta del propio canal de regulaci√≥n

Magnitud perturbadora

‚óè Cero

‚óè El valor anal√≥gico acondicionado de una entrada anal√≥gica
‚óè El valor real efectivo negado del propio canal de regulaci√≥n
‚óè El valor anal√≥gico acondicionado de una entrada anal√≥gica

Acondicionamiento de la consigna
El acondicionamiento de la consigna para obtener una consigna efectiva se puede variar con
las siguientes funciones:

Origen de la consigna
La consigna puede venir dada por:
‚óè Una instrucci√≥n
‚óè Una entrada anal√≥gica
‚óè Una variable manipulada acondicionada de otro canal de regulaci√≥n del m√≥dulo
Este origen de la consigna se selecciona en un regulador de mezcla o regulador de
seguimiento en una regulaci√≥n en cascada.
‚óè Una variable manipulada A acondicionada de otro canal de regulaci√≥n del m√≥dulo (s√≥lo FM
355-2)
‚óè Una variable manipulada B acondicionada de otro canal de regulaci√≥n del m√≥dulo (s√≥lo FM
355-2)

Consigna de seguridad
En caso de fallo de la CPU, el m√≥dulo puede regular en una consigna de seguridad.
Para ello debe introducirse una consigna de seguridad y ajustarse como reacci√≥n en caso de
parada de la CPU "Consigna = Consigna de seguridad".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

997

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Respuesta a fallo de la CPU
En caso de fallo o parada de la CPU el m√≥dulo de regulaci√≥n puede regular en las consignas
siguientes:
‚óè Consigna = √∫ltima consigna v√°lida
Si como selecci√≥n de consigna se ha ajustado "por instrucci√≥n", la consigna permanece
constante en el √∫ltimo valor indicado tras el fallo de la CPU.
Si la consigna viene determinada por la variable manipulada de un regulador del FM o por
una entrada anal√≥gica, se modifica en funci√≥n del valor seleccionado.
‚óè Consigna = consigna de seguridad
Si se ha indicado una consigna de seguridad, el m√≥dulo regula a esta consigna.

Respuesta a arranque del m√≥dulo (s√≥lo FM 355 y FM 455)
El m√≥dulo de regulaci√≥n puede regular tambi√©n a las siguientes consignas en caso de
arranque del m√≥dulo:
‚óè Consigna = √∫ltima consigna v√°lida
‚óè Consigna = consigna de seguridad

Rampa
Seleccionando un tiempo de arranque del valor inicial f√≠sico al valor final se puede limitar la
velocidad de modificaci√≥n de la consigna.

L√≠mites de la consigna
Si la consigna viene dada por el bloque de funci√≥n o es un valor anal√≥gico acondicionado de
una entrada anal√≥gica, se limita a un l√≠mite inferior y superior especificables.
Si en el regulador de relaci√≥n se ha seleccionado como consigna la variable manipulada
acondicionada de otro canal de regulaci√≥n, este valor act√∫a como factor para la multiplicaci√≥n
del valor real D. La consigna aplicada a la entrada en % se normaliza en este caso con los
l√≠mites inferior y superior.
Si en el regulador de valor fijo o en cascada se utiliza como consigna la variable manipulada
de otro canal de regulaci√≥n, la consigna se normaliza a un valor f√≠sico con las constantes de
normalizaci√≥n del canal de valor real seleccionado.

Multiplicar
Con el tipo de regulador de relaci√≥n, el valor real A se utiliza como magnitud de regulaci√≥n y
el valor real D, como magnitud de relaci√≥n. La entrada de consigna sirve como factor de
relaci√≥n. Multiplic√°ndolo por el valor real D y sumando un offset ajustable, se obtiene una
consigna efectiva. Si el valor real D se desconecta, entonces s√≥lo se suma el offset a la
consigna.

998

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Acondicionamiento del valor real
El acondicionamiento del valor real para obtener el valor real efectivo depende de la estructura
del regulador.

Valor real efectivo con regulador de valor fijo o en cascada
El valor real efectivo es igual que el valor real A. El origen del valor real A puede ser una entrada
anal√≥gica. Los valores reales B, C y D no se tienen en cuenta.

Valor real efectivo en regulador de tres componentes
El valor real efectivo se calcula sumando los valores reales A, B y C, as√≠ como un offset
ajustable. Los valores reales B y C se pueden valorar adicionalmente por factores. El valor real
D no se tiene en cuenta.

Valor real efectivo en un regulador de relaci√≥n
Para un regulador de relaci√≥n seleccione los siguientes valores reales
‚óè Valor real A: La se√±al acondicionada de una entrada anal√≥gica.
‚óè Valor real D: El valor real del regulador piloto.
El factor de proporci√≥n se predetermina como consigna.
Si se ha seleccionado una salida de regulador como factor de proporci√≥n FAC, con ayuda de
la barrera inferior y superior de "0... 100%" la consigna se convierte (normaliza) al rango de
valores "barrera inferior ... barrera superior".

Valor real efectivo en reguladores de mezcla
Para un regulador de mezcla seleccione los siguientes valores reales
‚óè Valores reales A, B y C: Se√±ales acondicionadas de las respectivas entradas anal√≥gicas.
‚óè Valor real D: El valor real del regulador piloto.
Los factores de proporci√≥n de cada uno de los sistemas regulados se definen como consigna.
La magnitud manipulada LMN del regulador del flujo total se indica en el rango de valores "0 ...
100%". El regulador de seguimiento convierte (normaliza) esta magnitud de la entrada Valor
real D al rango de valores "barrera inferior ... barrera superior" del valor real A.
La magnitud manipulada del regulador piloto se aplica a trav√©s de la entrada "valor real D" del
regulador de seguimiento. El factor de proporci√≥n FAC se define a trav√©s de la entrada de
consigna del regulador.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

999

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Alarma
Vigilancia de l√≠mites
En el m√≥dulo de regulaci√≥n se lleva a cabo una vigilancia de l√≠mites. Esta permite vigilar
‚óè el error de regulaci√≥n
‚óè o el valor real efectivo
dentro de un l√≠mite de advertencia superior e inferior y un l√≠mite de alarma superior e inferior.
Adem√°s, se puede ajustar una hist√©resis para estos l√≠mites.
La figura siguiente muestra la hist√©resis del l√≠mite de advertencia y de alarma:

/¬ØPLWHLQIHULRUGH
DGYHUWHQFLDRDODUPD

3.5.4.3

$ODUPDHQWUDQWH
$ODUPDVDOLHQWH
+LVW¬´UHVLV

/¬ØPLWHVXSHULRUGH
DGYHUWHQFLDRDODUPD

Algoritmo de regulaci√≥n

Algoritmo de regulaci√≥n FM 355-2
Componentes del algoritmo de regulaci√≥n
El regulador continuo (FM 355-2 C) y el regulador de impulsos (FM 355-2 S) tienen la misma
estructura de algoritmo de regulaci√≥n. En el regulador paso a paso (FM 355-2 S) no se pueden
seleccionar los botones Enfriar ni Zona de regulaci√≥n.
La figura siguiente muestra el diagrama de bloques del algoritmo de regulaci√≥n para
reguladores continuos y reguladores de impulsos:

1000

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
9DORUPDQLSXODGRHIHFWLYR

3,'
(UURUGHUHJXODFL¬µQ
=RQDPXHUWD

(QIULDU

=RQDGHUHJXODFL¬µQ

(QWUDGD'

3HUWXUEDFL¬µQ

Algoritmo de regulaci√≥n: PID en estructura paralela
En el ciclo del tiempo de muestreo configurado se calcula la magnitud manipulada del
regulador a partir del error de regulaci√≥n del algoritmo de posici√≥n PID. El regulador tiene una
estructura puramente paralela. La acci√≥n proporcional, integral o diferencial se puede
desconectar individualmente. En el caso de la acci√≥n integral y diferencial esto se realiza
poniendo a cero los correspondientes par√°metros TI o TD.
La figura siguiente muestra el algoritmo de regulaci√≥n del FM 355-2 (estructura en paralelo):
&HUR
3HUWXUEDFL¬µQ
63
*$,1
(5

3

',69
3B6(/

3)$&B63

;

,



/01

7,
'
7'

Algoritmo de regulaci√≥n FM 355 y FM 455
Componentes del algoritmo de regulaci√≥n
En el algoritmo de regulaci√≥n se pueden seleccionar los siguientes modos de operaci√≥n:
‚óè Regulador de temperatura (regulador fuzzy con autoajuste)
‚óè Regulador PID
El regulador K y el regulador S tienen la misma estructura del algoritmo de regulaci√≥n (v√©ase
la figura que sigue a continuaci√≥n). La figura siguiente muestra el diagrama de bloques del
algoritmo de regulaci√≥n:

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1001

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

&RQVLJQDHIHFWLYD
9DORUUHDOHIHFWLYR

5HJXODGRUGH
WHPSHUDWXUD

9DORUPDQLSXODGR
HIHFWLYR

3,'
(UURUGHUHJXODFL¬µQ
=RQDPXHUWD
(QWUDGD'

6HJXLPLHQWRGHYDORUPDQLSXODGR

0DJQLWXGSHUWXUEDGRUD

Algoritmo de regulaci√≥n y estructura del regulador
En el ciclo del tiempo de muestreo configurado se calcula la magnitud manipulada del
regulador continuo a partir del error de regulaci√≥n del algoritmo de posici√≥n PID. El regulador
tiene una estructura puramente paralela (v√©ase figura inferior). La acci√≥n proporcional, integral
o diferencial se puede desconectar individualmente. En el caso de las acciones integral y
diferencial, esto se realiza poniendo a cero los correspondientes par√°metros TI o TD.
La figura siguiente muestra el algoritmo de regulaci√≥n del FM 355 (estructura en paralelo):
',69

*$,1
(5

;

3

',69B6(/

3B6(/

,

'



/01
FRPELQDFL¬µQOLQHDO

Seleccionar el modo de operaci√≥n
Selecci√≥n del modo de operaci√≥n
Si como tipo de regulador se ha seleccionado la entrada "regulador PID", se puede elegir entre
los diferentes modos de operaci√≥n:
‚óè P, para materializar un regulador P
‚óè PI, para materializar un regulador PI
‚óè PD, para materializar un regulador PD
‚óè PID, para materializar un regulador PID

1002

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
‚óè I, para materializar un regulador I
‚óè ID, para materializar un regulador ID
‚óè D, para materializar un regulador D

Conmutaci√≥n suave de manual a autom√°tico
Si ha seleccionado la conmutaci√≥n suave de manual a autom√°tico (no con reguladores paso
a paso), el integrador en modo manual se va corrigiendo de tal forma que la magnitud
manipulada no da ning√∫n salto por la acci√≥n P y D en la conmutaci√≥n de manual a autom√°tico.
Cualquier error de regulaci√≥n se corrige siempre lentamente con la acci√≥n I. Si no se ha
seleccionado la conmutaci√≥n suave de manual a autom√°tico, en la conmutaci√≥n de manual a
autom√°tico la magnitud manipulada da un salto partiendo del valor manual actual, y el salto se
corresponde con el error de regulaci√≥n actual. Cualquier error de regulaci√≥n se corrige
r√°pidamente.
Nota
En el caso del regulador paso a paso, la conmutaci√≥n al modo autom√°tico siempre se efect√∫a
de forma brusca. El error de regulaci√≥n existente produce a trav√©s de GAIN un cambio de la
magnitud manipulada interna en forma de escal√≥n. Como la acci√≥n del elemento final de
control es integral se obtiene tan solo un control del proceso en forma de rampa.

Control anticipativo
A la se√±al de salida del regulador se le puede aplicar adicionalmente una magnitud
perturbadora DISV. La activaci√≥n o desactivaci√≥n se realiza en la ventana "Error de
regulaci√≥n" de la herramienta de configuraci√≥n a trav√©s del interruptor "Selecci√≥n de se√±al
magnitud manipulada regulador".

Zona muerta
Finalidad de la zona muerta
Existe una zona muerta antepuesta al regulador PID. Con el regulador estabilizado, la zona
muerta suprime el nivel de ruido en la se√±al del error de regulaci√≥n que puede producirse por
superposici√≥n de la magnitud de regulaci√≥n o consigna con una se√±al interferente de alta
frecuencia. De esta forma se evita la oscilaci√≥n no deseada de la salida del regulador.

Ancho de la zona muerta
El ancho de la zona muerta es ajustable. Si el error de regulaci√≥n se encuentra dentro del
ancho de zona muerta ajustado, se emite el valor 0 (error de regulaci√≥n = 0) en la salida de la
zona muerta. S√≥lo cuando la magnitud de entrada abandona el rango de sensibilidad, la salida
cambia con los mismos valores que la magnitud de entrada.
De esto resulta una falsificaci√≥n de la se√±al transmitida incluso fuera de la zona muerta. Sin
embargo, esto se tolera para evitar escalones en los l√≠mites de la zona muerta. La falsificaci√≥n
se corresponde con el valor del ancho de la zona muerta y es, por ello, f√°cil de controlar.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1003

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
(UURUGHUHJXODFL¬µQ
HQODVDOLGDGHOD
]RQDPXHUWD

(UURUGHUHJXODFL¬µQ
HQODHQWUDGDGHOD
]RQDPXHUWD
(5

$QFKRGH]RQDPXHUWD

Figura 3-8

1004

Zona muerta

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulaci√≥n P
Regulador P
La figura siguiente muestra la respuesta indicial de un regulador P:
39
)XQFL¬µQGHVDOWRHQOD
HQWUDGDGHOUHJXODGRU

0DJQLWXGGHHQWUDGD

W

/01
5HVSXHVWDLQGLFLDOGHO
UHJXODGRUFRQWLQXR

0DJQLWXGGHVDOLGD

W

/01




5HVSXHVWDLQGLFLDOGHO
UHJXODGRUGHLPSXOVRV

0DJQLWXGGHVDOLGD

W

F√≥rmula para reguladores P
Las magnitudes de salida y de entrada son directamente proporcionales, es decir:
Modificaci√≥n de la magnitud de salida = ganancia proporcional x modificaci√≥n de la magnitud
de entrada
LMN = GAIN x ER

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1005

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulaci√≥n P
En el regulador P est√°n desconectadas las acciones I y D. Esto quiere decir que en caso de
error de regulaci√≥n ER = 0, la magnitud manipulada tambi√©n es = 0. Si se desea ajustar un
punto de operaci√≥n ‚â†0, es decir, un valor num√©rico para la magnitud manipulada en caso de
error de regulaci√≥n 0, esto se puede realizar a trav√©s del punto de operaci√≥n:
‚óè Punto de operaci√≥n autom√°tico: El regulador pone el punto de operaci√≥n a la magnitud
manipulada (manual) actual autom√°ticamente durante la conmutaci√≥n de manual a
autom√°tico.
‚óè Punto de operaci√≥n no autom√°tico: Se puede parametrizar el punto de operaci√≥n.
‚óè Ejemplo: Punto de operaci√≥n AP = 5% da una magnitud manipulada del 5% en caso de
error de regulaci√≥n ER = 0.
La figura siguiente muestra un regulador P con ajuste del punto de operaci√≥n a trav√©s del
componente I:
3B6(/

3
*$,1
(5

;

,

$XWRP¬£WLFR
1RDXWRP¬£WLFR



/01

3XQWRGHRSHUDFL¬µQ

La figura siguiente muestra la respuesta indicial del regulador P:
(5
0DJQLWXG
PDQLSXODGD

0DJQLWXGPDQLSXODGD
W

(5 W 
W

1006

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulaci√≥n PI
Regulador PI
La figura siguiente muestra la respuesta indicial de un regulador PI:
(5

)XQFL¬µQGHVDOWRHQOD
HQWUDGDGHOUHJXODGRU

0DJQLWXGGHHQWUDGD

W

/01

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUFRQWLQXR

0DJQLWXGGHVDOLGD

W

/01


5HVSXHVWDLQGLFLDOGHO
UHJXODGRUGHLPSXOVRV


0DJQLWXGGHVDOLGD

W

Los reguladores I tienen como magnitud de salida la integral de la magnitud de entrada, es
decir, el regulador suma la diferencia de la consigna en el tiempo. Esto quiere decir que el
regulador va corrigiendo hasta que se elimine la diferencia con la consigna. En la pr√°ctica,
seg√∫n las exigencias en cuanto a la respuesta del regulador, lo ideal es una combinaci√≥n de
los diferentes temporizadores. La respuesta de tiempo de cada uno de los componentes se
Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1007

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
puede describir con los par√°metros de regulaci√≥n de ganancia proporcional GAIN, tiempo de
acci√≥n integral TI (acci√≥n I) y tiempo de la acci√≥n derivada TD (acci√≥n D).

F√≥rmula para reguladores PI
Para la respuesta indicial del regulador PI en el rango temporal rige lo siguiente:

t = tiempo desde el escal√≥n de la magnitud de entrada

Regulaci√≥n PI
En el regulador PI est√° desconectada la acci√≥n D (TD=0.0). Un regulador PI modifica la
magnitud de salida con la acci√≥n I hasta que el error de regulaci√≥n sea ER = 0. Sin embargo,
esto s√≥lo es aplicable cuando la magnitud de salida no rebasa los l√≠mites de la zona regulada.
Si se rebasan los l√≠mites de la variable manipulada, la acci√≥n I mantiene el valor alcanzado en
el l√≠mite en (Anti-Reset-Windup).
(5
0DJQLWXG
PDQLSXODGD

0DJQLWXG W
PDQLSXODGD

*$,1 (5 
*$,1 (5 W 
(5 W 

*$,1 (5 

W
7,

1008

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulaci√≥n PD
Regulador PD
La figura siguiente muestra la respuesta indicial de un regulador PD:
(5
)XQFL¬µQGHVDOWRHQOD
HQWUDGDGHOUHJXODGRU

/01

0DJQLWXGGH
HQWUDGD

70B/$*

0DJQLWXGGHVDOLGD

W

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUFRQWLQXR

W

/01

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUGHLPSXOVRV



0DJQLWXGGHVDOLGD

W

Los reguladores D no son adecuados para la regulaci√≥n si funcionan solos, ya que dejan de dar
√≥rdenes para el elemento final de control cuando la magnitud de entrada regresa a un valor
est√°tico.
En combinaci√≥n con reguladores P, la acci√≥n D se utiliza para generar un impulso de control
adecuado seg√∫n la velocidad de modificaci√≥n de la magnitud de regulaci√≥n. Si en el sistema
regulado act√∫a una perturbaci√≥n z, el regulador PD cambia a otro error de regulaci√≥n debido
al cambio del grado de regulaci√≥n. Las perturbaciones no se eliminan por completo. El
comportamiento beneficioso es el bueno y din√°mico. Durante la aproximaci√≥n y la modificaci√≥n
de las consignas se alcanza una transici√≥n bien amortiguada y sin vibraciones. Sin embargo,

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1009

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
un regulador con acci√≥n D no es apropiado si el sistema regulado tiene magnitudes de
medici√≥n pulsantes, p. ej. en la regulaci√≥n de presi√≥n o de caudal.

F√≥rmula para reguladores PD
Para la respuesta indicial del regulador PD en el dominio temporal rige lo siguiente:

/01

*$,1¬ô(5 ¬ô



7'
70B/$*

¬ô H

‡≤¶W
70B/$*

t = tiempo desde el escal√≥n de la magnitud de entrada

Regulaci√≥n PD
En el regulador PD est√° desconectada la acci√≥n I (TI=0.0). Esto quiere decir que en caso de
error de regulaci√≥n ER = 0, la se√±al de salida tambi√©n es = 0. Si se desea ajustar un punto de
operaci√≥n ‚â†0, es decir, un valor num√©rico para la magnitud manipulada en caso de error de
regulaci√≥n 0, esto se puede realizar a trav√©s del punto de operaci√≥n:
‚óè Punto de operaci√≥n autom√°tico: El regulador pone el punto de operaci√≥n a la magnitud
manipulada (manual) actual autom√°ticamente durante la conmutaci√≥n de manual a
autom√°tico.
‚óè Punto de operaci√≥n no autom√°tico: Se puede parametrizar el punto de operaci√≥n.
El regulador PD reproduce la magnitud de entrada ER(t) proporcionalmente sobre la se√±al de
salida y a√±ade la acci√≥n D creada por la diferenciaci√≥n de ER(t), que se calcula con el doble
de precisi√≥n seg√∫n la regla del trapecio (aproximaci√≥n de Pad√©). La respuesta de tiempo
(fuerza de la acci√≥n D o superficie de regulaci√≥n) se determina por el tiempo de la acci√≥n
derivada TD (tiempo de acci√≥n derivada).
Para el filtrado de la se√±al y la supresi√≥n de se√±ales perturbadoras, la acci√≥n D se realiza
mediante un retardo de primer orden (constante de tiempo ajustable: TM_LAG). La mayor√≠a de
las veces es suficiente con un valor peque√±o para TM_LAG, para alcanzar el resultado
deseado.
Cuanto mayor seleccione el factor derivativo D_F,
‚óè menor ser√° la constante de tiempo efectiva TD/D_F del retardo y
‚óè mayor ser√° la variable manipulada m√°xima al inicio y
‚óè mejor la respuesta del regulador y
‚óè mayor tambi√©n la sensibilidad a ruidos.
D_F se limita al rango de valores entre 5,0 y 10,0.

1010

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
(5
0DJQLWXG
PDQLSXODGD

*$,1 

0DJQLWXG W 
PDQLSXODGD

7'
(5
70B/$*

(5 W 

*$,1 (5 
70B/$*

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

W

1011

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulaci√≥n PID
Regulador PID
La figura siguiente muestra la respuesta indicial de un regulador PID:
(5

)XQFL¬µQGHVDOWRHQOD
HQWUDGDGHOUHJXODGRU

W

0DJQLWXGGHHQWUDGD

/01

70B/$*

0DJQLWXGGHVDOLGD

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUFRQWLQXR

W

7Q
/01

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUGHLPSXOVRV

0DJQLWXGGHVDOLGD

W

La mayor√≠a de regulaciones que se aplican en la t√©cnica de procesos se puede controlar con
un regulador con comportamiento PI. En sistemas regulados lentos con grandes tiempos de

1012

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
retardo, p. ej. regulaciones de temperatura, el resultado de la regulaci√≥n se puede mejorar con
un regulador con comportamiento PID.
La figura siguiente muestra la respuesta indicial con distintos comportamientos del regulador:
39


5HVSXHVWDWUDQVLWRULD
VLQUHJXODGRU

3,'

63

3'


W

Los reguladores con comportamiento PI y PID tienen la ventaja de que tras la fase de
estabilizaci√≥n la magnitud de regulaci√≥n no presenta ninguna diferencia respecto a la
consigna. La magnitud regulada oscila sobre la consigna durante la aproximaci√≥n.

F√≥rmula para reguladores PID
Para la respuesta indicial del regulador PI en el dominio temporal rige lo siguiente:

/01

*$,1¬ô(5 ¬ô



W
7,



7'
70B/$*

¬ô H

‡≤¶W
70B/$*

t = tiempo desde el escal√≥n de la magnitud de entrada

Regulaci√≥n PID
En el regulador PID est√°n conectadas la acci√≥n P, I y D. Un regulador PID modifica la magnitud
de salida con la acci√≥n I hasta que el error de regulaci√≥n sea ER = 0. Sin embargo, esto s√≥lo
es aplicable cuando la magnitud de salida no rebasa los l√≠mites de la zona regulada. Si se
rebasan los l√≠mites de la variable manipulada, la acci√≥n I mantiene el valor alcanzado en el
l√≠mite en (Anti-Reset-Windup).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1013

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
El regulador PID reproduce la magnitud de entrada ER(t) proporcionalmente sobre la se√±al de
salida y a√±ade los componentes creados por la diferenciaci√≥n e integraci√≥n de ER(t). La
respuesta de tiempo se determina por el tiempo de la acci√≥n derivada TD (tiempo de la acci√≥n
derivada) y el tiempo de integraci√≥n TI (tiempo de acci√≥n integral).
Para el filtrado de la se√±al y la supresi√≥n de se√±ales interferentes, la acci√≥n D se realiza a
trav√©s de un retardo de primer orden.
Cuanto mayor seleccione el factor derivativo D_F,
‚óè menor ser√° la constante de tiempo efectiva TD/D_F del retardo y
‚óè mayor ser√° la variable manipulada m√°xima al inicio y
‚óè mejor la respuesta del regulador y
‚óè mayor tambi√©n la sensibilidad a ruidos.
D_F se limita al rango de valores entre 5,0 y 10,0.
(5
0DJQLWXGPDQLSXODGD

*$,1

0DJQLWXGPDQLSXODGD
W

7'
(5 
70B/$*

*$,1 (5 
*$,1 (5 
70B/$*
7,

*$,1 (5 W
W

3,BRXW W

Regulaci√≥n I
Regulador I
Para realizar una regulaci√≥n I se puede desconectar la acci√≥n P. Esto tambi√©n es posible con
el par√°metro P_SEL del m√≥dulo de funci√≥n PID_FM.

1014

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Acci√≥n P
Atenuaci√≥n de la acci√≥n P en caso de modificaciones de la consigna
Para evitar sobreoscilaciones del valor real o desviaciones importantes de la variable
manipulada, la acci√≥n P se puede atenuar con el par√°metro Factor proporcional en caso de
modificaciones de la consigna (PFAC_SP). Con PFAC_SP se puede seleccionar de forma
continua entre 0.0 y 1.0 c√≥mo debe actuar la acci√≥n P en caso de modificaciones de la
consigna:
‚óè PFAC_SP=1.0: La acci√≥n P es totalmente efectiva cuando se cambia la consigna
‚óè PFAC_SP=0,0: La acci√≥n P no es efectiva cuando se cambia la consigna.
En el FM355-2 existen dos posibilidades de limitar la velocidad de una modificaci√≥n de la
consigna:
‚óè Activar rampa (> 0,0 s)
‚óè Factor de modificaci√≥n de la consigna < 1,0
Utilice s√≥lo una de las dos limitaciones. Si se activan simult√°neamente ambas limitaciones, en
caso de un escal√≥n de la consigna aparece una modificaci√≥n de la variable manipulada inversa
a la modificaci√≥n de la consigna (respuesta indicial).

Particularidades en el regulador paso a paso
Un valor de PFAC_SP < 1,0 puede reducir las sobreoscilaciones si el tiempo de
posicionamiento del motor MTR_TM es corto frente al tiempo de estabilizaci√≥n TA y la relaci√≥n
TU/TA es <0,2. Si MTR_TM alcanza el 20% de TA, ya s√≥lo se podr√° alcanzar una ligera mejora.

Inversi√≥n del efecto del regulador
La inversi√≥n, es decir, el cambio del regulador de la asignaci√≥n
‚óè error de regulaci√≥n ascendente = magnitud manipulada ascendente
a
‚óè error de regulaci√≥n ascendente = magnitud manipulada descendente
se consigue ajustando una ganancia proporcional negativa (GAIN). El signo de este valor de
par√°metro determina el sentido de acci√≥n del regulador.

Acci√≥n D
Acci√≥n D en la rama de realimentaci√≥n
Para evitar desviaciones en forma de impulso en la acci√≥n D de la magnitud manipulada en
caso de modificaciones de la consigna, se puede colocar la acci√≥n D en la rama de
realimentaci√≥n.
En esta estructura s√≥lo se conecta a la acci√≥n D la magnitud de regulaci√≥n negativa (factor =
-1). En la acci√≥n D, la conmutaci√≥n a la realimentaci√≥n se lleva a cabo en la ventana "Error de

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1015

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
regulaci√≥n" con el interruptor "Entrada D regulador" seleccionando como se√±al de entrada el
valor real efectivo negado.
Nota
Si se coloca la acci√≥n D en realimentaci√≥n, tambi√©n debe reducirse PFAC_SP, de lo contrario,
aumenta la sobreoscilaci√≥n del valor real.

La figura siguiente muestra el algoritmo de regulaci√≥n con acci√≥n D en la rama de
realimentaci√≥n:
*$,1
(5

;

‡≤•
39

;

;

3
,



/01

'

Acci√≥n P/D
Acci√≥n P/D en la rama de realimentaci√≥n
En la estructura paralela, cada acci√≥n del algoritmo de regulaci√≥n recibe el error de regulaci√≥n
como se√±al de entrada. En esta estructura los escalones de consigna act√∫an directamente en
el regulador. La magnitud manipulada se modifica inmediatamente a trav√©s de la acci√≥n P y D
por escalones de la consigna.
Sin embargo, otra estructura del regulador en la que la formaci√≥n de la acci√≥n P y D se traslada
a la realimentaci√≥n, garantiza un transcurso suave de la magnitud manipulada en caso de
variaciones del escal√≥n de la consigna (v√©ase la siguiente figura).
En esta estructura la acci√≥n I procesa el error de regulaci√≥n como se√±al de entrada, en la
acci√≥n P y D s√≥lo se conecta la magnitud de regulaci√≥n negativa (factor = -1). En la acci√≥n D,
la conmutaci√≥n a la realimentaci√≥n se lleva a cabo en la ventana "Error de regulaci√≥n" con el
interruptor "Entrada D regulador" seleccionando como se√±al de entrada el valor real efectivo
negado.
La figura siguiente muestra el algoritmo de regulaci√≥n con acci√≥n D en la rama de
realimentaci√≥n:
*$,1
(5

;


39

;

,
3



/01

;
'

1016

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

M√≥dulo de regulaci√≥n de temperatura por l√≥gica difusa
Regulador de temperatura
El regulador de temperatura es un regulador fuzzy con autoajuste que, tras identificar el
sistema regulado, trabaja con par√°metros de regulaci√≥n determinados por √©l mismo.
En los reguladores de temperatura son posibles los siguientes ajustes:
‚óè Regulador de enfriamiento
‚óè Regulador de calefacci√≥n
‚óè Agresividad
Con el par√°metro Agresividad se puede modificar la velocidad del comportamiento
transitorio.
Valores posibles para la agresividad

3.5.4.4

-1 ‚â§ agresividad < 0

Comportamiento transitorio m√°s lento que determinado me‚Äê
diante identificaci√≥n

Agresividad = 0

Comportamiento de estabilizaci√≥n como determinado median‚Äê
te identificaci√≥n

0 < agresividad ‚â§ 1

Comportamiento transitorio m√°s r√°pido que determinado me‚Äê
diante identificaci√≥n

Salida del regulador

Diferencias de los reguladores
B√°sicamente los reguladores FM 355, FM 355-2 y FM 455 pueden dividirse en dos tipos: en
reguladores paso a paso y reguladores continuos. Los reguladores paso a paso van
acompa√±ados de una S complementaria, a saber, FM 355 S, FM 355-2 S y FM 455 S, mientras
que los reguladores continuos van acompa√±ados de una C, a saber, FM 355 C, FM 355-2 C y
FM 455 C. El restante funcionamiento de los m√≥dulos de regulaci√≥n no se diferencia, un
FM 355 S y un FM 355 C poseen algoritmos id√©nticos. Las diferencias se encuentran en la
salida del regulador.

Regulador paso a paso
El regulador continuo paso a paso posee salidas digitales. De este modo, una v√°lvula de
control s√≥lo puede activarse a trav√©s de las se√±ales "abierta" o "cerrada". Por ejemplo, si una
v√°lvula de control se regula al 50% de la capacidad, esto s√≥lo puede conseguirse si se efect√∫a
un ajuste igual de largo de "abierta" y "cerrada".
Encontrar√° m√°s informaci√≥n acerca de los reguladores paso a paso en los puntos siguientes:
‚óè Salidas digitales del regulador (P√°gina 1019)
‚óè Regulador paso a paso con realimentaci√≥n de posici√≥n (P√°gina 1020)
‚óè Regulador paso a paso con realimentaci√≥n de posici√≥n (P√°gina 1020)
‚óè Regulador de impulsos (P√°gina 1020)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1017

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Regulador continuo
El regulador continuo paso a paso posee salidas anal√≥gicas. As√≠ pues, una v√°lvula de control
no s√≥lo puede estar "abierta" o "cerrada", sino que tambi√©n puede abrirse en determinadas
proporciones. Por ejemplo, si una v√°lvula de control se regula al 50% de la capacidad, el
m√≥dulo de regulaci√≥n emite el valor "50%" y la v√°lvula se abre a la mitad.
Encontrar√° m√°s informaci√≥n acerca de los reguladores continuos en los puntos siguientes:
‚óè Salidas anal√≥gicas del regulador (P√°gina 1018)
‚óè Regulador continuo (P√°gina 1019)

Salidas anal√≥gicas del regulador
Salidas anal√≥gicas
Para cada salida anal√≥gica se pueden parametrizar las siguientes funciones:
‚óè Origen de la se√±al
‚óè Tipo de se√±al

Selecci√≥n del origen para la se√±al en las salidas anal√≥gicas
Con la selecci√≥n del origen de la se√±al se puede determinar qu√© valor de se√±al se emite en la
correspondiente salida anal√≥gica.
Se pueden parametrizar los siguientes or√≠genes de la se√±al:
‚óè El valor cero
‚óè El valor anal√≥gico √¢condicionado de una de las entradas anal√≥gicas
‚óè La variable manipulada A de uno de los canales de regulaci√≥n
‚óè La variable manipulada B de uno de los canales de regulaci√≥n
El FM 355 y el FM 355-2 tienen cuatro entradas anal√≥gicas y cuatro canales de regulaci√≥n cada
uno.
El FM 455 tiene 16 entradas anal√≥gicas y 16 canales de regulaci√≥n.

Tipo de se√±al en las salidas anal√≥gicas
Para cada salida anal√≥gica se puede determinar el tipo de se√±al.
Se pueden parametrizar los siguientes tipos de se√±al:
‚óè Salida de intensidad 0 ... 20 mA
‚óè Salida de intensidad 4 ... 20 mA
‚óè Salida de tensi√≥n 0 ... 10 V
‚óè Salida de tensi√≥n -10 ... 10 V

1018

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Salidas digitales del regulador
Salidas digitales del regulador
Las salidas digitales del regulador sirven para controlar elementos finales de control
integradores o no integradores.
Para cada salida digital se pueden parametrizar las siguientes funciones:
‚óè Tipo de salida
‚óè Selecci√≥n de se√±al
‚óè Procesamiento de se√±al

Tipo de salida de la se√±al en la salida digital
Para cada salida digital se puede determinar el tipo de se√±al.
Los siguientes tipos de se√±ales est√°n disponibles:
‚óè Regulador paso a paso sin entrada de realimentaci√≥n de posici√≥n
‚óè Regulador paso a paso con entrada de realimentaci√≥n de posici√≥n
‚óè Regulador de impulsos

Selecci√≥n de se√±al
Seg√∫n el tipo de se√±al en la salida, se pueden parametrizar diferentes valores para la selecci√≥n
de la se√±al:
‚óè Variable manipulada externa (P√°gina 1021)
‚óè Modo de seguimiento (P√°gina 1021)
‚óè Entrada de realimentaci√≥n de posici√≥n (P√°gina 1022)
‚óè Variable manipulada de seguridad (P√°gina 1024)

Procesamiento de se√±al
Seg√∫n el tipo de se√±al en la salida, se pueden parametrizar diferentes valores para el
procesamiento de la se√±al:
‚óè L√≠mite se√±al de salida (P√°gina 1024)
‚óè Rango partido (P√°gina 1025)
‚óè Formador de impulsos (P√°gina 1027)

Regulador continuo
Tipo de se√±al en las salidas digitales
Los siguientes par√°metros s√≥lo se pueden ajustar en un m√≥dulo anal√≥gico.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Par√°metros ajustables
‚óè Activar variable manipulada externa (P√°gina 1021)
‚óè Activar modo de seguimiento (P√°gina 1021)
‚óè Ajustar variable manipulada de seguridad (P√°gina 1024)
‚óè Limitar la variable manipulada (P√°gina 1024)
‚óè Controlar dos actuadores (P√°gina 1025)
‚óè Seleccionar se√±al de salida y tipo de se√±al (P√°gina 1028)

Regulador paso a paso con realimentaci√≥n de posici√≥n
Tipo de se√±al en las salidas digitales
Los siguientes par√°metros s√≥lo se pueden ajustar en un m√≥dulo digital.

Par√°metros ajustables
‚óè Activar variable manipulada externa (P√°gina 1021)
‚óè Ajustar variable manipulada de seguridad (P√°gina 1024)
‚óè Formador de impulsos (P√°gina 1027)

Regulador paso a paso con realimentaci√≥n de posici√≥n
Tipo de se√±al en las salidas digitales
Los siguientes par√°metros s√≥lo se pueden ajustar en un m√≥dulo digital.

Par√°metros ajustables
‚óè Activar variable manipulada externa (P√°gina 1021)
‚óè Activar modo de seguimiento (P√°gina 1021)
‚óè Ajustar variable manipulada de seguridad (P√°gina 1024)
‚óè Limitar la variable manipulada (P√°gina 1024)
‚óè Ajustar realimentaci√≥n de posici√≥n (P√°gina 1022)
‚óè Formador de impulsos (P√°gina 1027)

Regulador de impulsos
Tipo de se√±al en las salidas digitales
Los siguientes par√°metros s√≥lo se pueden ajustar en un m√≥dulo digital.

1020

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Par√°metros ajustables
‚óè Activar variable manipulada externa (P√°gina 1021)
‚óè Activar modo de seguimiento (P√°gina 1021)
‚óè Ajustar variable manipulada de seguridad (P√°gina 1024)
‚óè Limitar la variable manipulada (P√°gina 1024)
‚óè Preparar se√±al anal√≥gica para la conversi√≥n a una se√±al digital (P√°gina 1025)
‚óè Convertir se√±al anal√≥gica en se√±al digital (P√°gina 991)

Funciones de la salida del regulador
Variable manipulada externa
Resumen
En la salida del regulador se han implantado varias posibilidades de interconexi√≥n para la
variable manipulada, la entrada de correcci√≥n y la variable manipulada de seguridad
(conmutaci√≥n de variable manipulada).
Para evitar que la variable manipulada pueda aceptar valores no admisibles para el proceso,
se ha previsto una limitaci√≥n.

Activar variable manipulada externa
La conmutaci√≥n entre la variable manipulada externa y la variable manipulada efectiva del
regulador se realiza de manera alternativa por
‚óè un valor binario del bloque de funci√≥n
‚óè una se√±al que se produce por combinaci√≥n l√≥gica con O de un valor binario del bloque de
funci√≥n y una entrada digital

Modo de seguimiento
Resumen
La correcci√≥n de la variable manipulada evita un salto de la variable manipulada durante la
conmutaci√≥n de manual a autom√°tico.
En la conmutaci√≥n de manual a autom√°tico la variable manipulada permanece inalterada. La
correcci√≥n de la variable manipulada no est√° activa si se realiza un regulador P puro con punto
de operaci√≥n fijo (en la m√°scara Regulador PID no est√° seleccionada la opci√≥n "autom√°tico").

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1021

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Entrada de correcci√≥n
Existen los siguientes ajustes alternativos:
‚óè La entrada de correcci√≥n tiene el valor cero
‚óè La entrada de correcci√≥n es el valor anal√≥gico acondicionado de una entrada anal√≥gica

Activar seguimiento
La conmutaci√≥n entre variable ipulada y entrada de correcci√≥n se realiza alternativamente por
‚óè un valor binario del bloque de funci√≥n
‚óè una se√±al que se produce por combinaci√≥n l√≥gica con O de un valor binario del bloque de
funci√≥n y una entrada digital

Realimentaci√≥n de posici√≥n
Resumen
La entrada de realimentaci√≥n de posici√≥n s√≥lo est√° disponible en reguladores S.

Entrada de realimentaci√≥n de posici√≥n
Existen los siguientes ajustes alternativos:
‚óè La entrada de realimentaci√≥n de posici√≥n tiene el valor cero
‚óè La entrada de realimentaci√≥n de posici√≥n es el valor anal√≥gico acondicionado de una
entrada anal√≥gica

1022

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

salida del regulador paso a paso
La figura siguiente muestra el esquema de la salida del regulador S (modo de operaci√≥n
Regulador paso a paso con realimentaci√≥n de posici√≥n)
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDU
YDORU
PDQLSXODGR
H[WHUQR

9DORU
PDQLSXODGR
$FWLYDU
VHJXLPLHQWR

$FWLYDUYDORU /LPLWDU
PDQLSXODGR
GHVHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

(QWUDGDGHFRUUHFFL¬µQ

6HJXLPLHQWRGHYDORUPDQLSXODGR

(QWUDGDGHUHVSXHVWDGHSRVLFL¬µQ

La figura siguiente muestra el esquema de la salida del regulador S (modo de operaci√≥n
Regulador paso a paso sin realimentaci√≥n de posici√≥n)
9DORUPDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDUYDORU
PDQLSXODGR
H[WHUQR

$FWLYDUYDORU
PDQLSXODGR
GHVHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

En el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica, la variable manipulada
externa y la variable manipulada de seguridad act√∫an de la siguiente manera:
Si se asigna un valor entre 40,0% y 60,0%, entonces no se activa ninguna salida binaria y el
elemento final de control permanece sin cambios.
Si se establece un valor > 60,0%, se devuelve "Se√±al de posicionamiento alta" hasta que se
active la realimentaci√≥n "Actuador en tope superior".
Si se establece un valor < 40,0%, se emite "Se√±al de posicionamiento baja" hasta que la
realimentaci√≥n accede a "Actuador en tope inferior".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1023

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Variable manipulada de seguridad
Resumen
En la salida del regulador se han implantado varias posibilidades de interconexi√≥n para la
variable manipulada, la entrada de correcci√≥n y la variable manipulada de seguridad
(conmutaci√≥n de variable manipulada).

Conmutar a variable manipulada de seguridad
‚óè Determinaci√≥n de la variable manipulada de seguridad
‚óè Reacci√≥n alternativa del m√≥dulo de funci√≥n al arrancar:
‚Äì El m√≥dulo de funci√≥n pasa a lazo cerrado.
‚Äì Como variable manipulada se devuelve la variable manipulada de seguridad
‚óè La conmutaci√≥n a la variable manipulada de seguridad se realiza de forma alternativa por
‚Äì un valor binario del bloque de funci√≥n
‚Äì una se√±al que se produce por combinaci√≥n l√≥gica con O de un valor binario del bloque
de funci√≥n y una entrada digital
‚óè Respuesta a fallo del transductor de medida del valor real A:
‚Äì Con el ajuste "Lazo cerrado", el modo de operaci√≥n del regulador permanece sin
cambios
‚Äì Con el ajuste "Variable manipulada = variable manipulada de seguridad" se conmuta a
la variable manipulada de seguridad
‚óè Reacci√≥n en caso de fallo del transductor de medida de una entrada anal√≥gica:
‚Äì Con el ajuste "Lazo cerrado", el modo de operaci√≥n del regulador permanece sin
cambios
‚Äì Con el ajuste "Variable manipulada = variable manipulada de seguridad" se conmuta a
la variable manipulada de seguridad

Limitaci√≥n de la variable manipulada
Resumen
Para evitar que la variable manipulada pueda aceptar valores no admisibles para el proceso,
se ha previsto una limitaci√≥n.

Limitaci√≥n de la variable manipulada
‚óè Limitaci√≥n superior e inferior (no puede desactivarse)

1024

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Rango partido
Resumen
La funci√≥n de rango partido genera a partir de la variable manipulada como se√±al de entrada
dos se√±ales de salida normalizables: variable manipulada A y variable manipulada B. De esta
forma se pueden controlar p. ej. dos v√°lvulas con una variable manipulada.

Formaci√≥n de los valores de rango partido
‚óè On/Off (s√≥lo reguladores K)
‚óè Valor inicial y valor final se√±al de entrada
‚óè Valor inicial y valor final se√±al de salida

Rango partido
Con la funci√≥n de rango partido se pueden controlar dos v√°lvulas de control con una magnitud
manipulada. La funci√≥n de rango partido genera a partir de la variable manipulada LMN como
se√±al de entrada las dos se√±ales de salida variable manipulada A y variable manipulada B.
La figura siguiente muestra el efecto de los par√°metros para la salida de la variable manipulada
A:
6H¬≥DOGHVDOLGD
YDORUPDQLSXODGR$

)LQDOGHO¬£UHDGHOD
VH¬≥DOGHVDOLGD

,QLFLRGHO¬£UHDGHOD
VH¬≥DOGHVDOLGD

,QLFLRGHO¬£UHDGHOD
VH¬≥DOGHHQWUDGD

6H¬≥DOGHHQWUDGD
YDORUPDQLSXODGR
/01
)LQDOGHO¬£UHDGHOD
VH¬≥DOGHHQWUDGD

La figura siguiente muestra el efecto de los par√°metros para la salida de la variable manipulada
B:

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1025

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
6H¬≥DOGHVDOLGD
YDORUPDQLSXODGR%
,QLFLRGHO¬£UHDGHOD
VH¬≥DOGHVDOLGD

)LQDOGHO¬£UHDGHOD
VH¬≥DOGHVDOLGD

,QLFLRGHO¬£UHDGHOD
VH¬≥DOGHHQWUDGD

)LQDOGHO¬£UHDGHOD
VH¬≥DOGHHQWUDGD

6H¬≥DOGHHQWUDGD
YDORUPDQLSXODGR
/01

El inicio del √°rea de la se√±al de entrada tiene que ser inferior que el final del √°rea de la se√±al
de entrada.

Rango partido/formador de impulsos
La funci√≥n de rango partido es la preparaci√≥n de la se√±al anal√≥gica para la conversi√≥n en una
se√±al binaria.
En un regulador de dos puntos (p. ej. un regulador de calefacci√≥n) s√≥lo es relevante la variable
manipulada A. La conversi√≥n de la variable manipulada en la variable manipulada A se
representa en la siguiente figura. La conversi√≥n en una se√±al de salida binaria se realiza de
manera que, en la salida digital correspondiente, la relaci√≥n entre el ancho de impulso y la
duraci√≥n del periodo se corresponda con la variable manipulada A.
Por ejemplo, una variable manipulada A del 40% con una duraci√≥n del periodo de 60 segundos
da un ancho de impulso de 24 segundos y una longitud de pausa de 36 segundos.
La figura siguiente muestra la funci√≥n de rango partido en un regulador de dos puntos:
6H¬≥DOGHVDOLGD
YDORUPDQLSXODGR$
)LQDOGHO¬£UHDGHOD
VH¬≥DOGHVDOLGD

,QLFLRGHO¬£UHDGHOD
VH¬≥DOGHVDOLGD

1026

6H¬≥DOGHHQWUDGD
YDORUPDQLSXODGR
,QLFLRGHO¬£UHDGHOD )LQDOGHO¬£UHDGHOD /01
VH¬≥DOGHHQWUDGD
VH¬≥DOGHHQWUDGD

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

En un regulador de tres puntos (p. ej. un regulador de calefacci√≥n y enfriamiento) se aplican las
afirmaciones anteriores para la variable manipulada A. La segunda se√±al para el control del
enfriamiento se genera a trav√©s de la variable manipulada B. La conversi√≥n de la variable
manipulada en las variables manipuladas A y B se representa en la figura inferior. La
conversi√≥n en una se√±al de salida binaria se realiza de manera que, en las salidas digitales
correspondientes, la relaci√≥n entre el ancho de impulso y la duraci√≥n del periodo se
corresponda con las variables manipuladas A o B.
La figura siguiente muestra la funci√≥n de rango partido en un regulador de tres puntos:

,QLFLRGHUDQJR
VH¬≥DOGHVDOLGD
YDORUPDQLSXODGR%

,QLFLRGHUDQJR
VH¬≥DOGHHQWUDGD
YDORUPDQLSXODGR%

6H¬≥DOHVGHVDOLGDYDORU
PDQLSXODGR$\%

)LQDOGHUDQJRGH
VH¬≥DOGHHQWUDGD
YDORUPDQLSXODGR%

)LQDOGHUDQJR
VH¬≥DOGHVDOLGD
YDORUPDQLSXODGR%

9DORUPDQLSXODGR$
9DORUPDQLSXODGR%

6H¬≥DOGHHQWUDGD
YDORUPDQLSXODGR
/01

Formador de impulsos del regulador paso a paso
Resumen
El formador de impulsos s√≥lo est√° disponible para reguladores paso a paso (FM 355 S, FM
355-2 S y FM 455). Existen las siguientes posibilidades de ajuste.

Formador de impulsos (s√≥lo regulador S)
‚óè Tiempo de posicionamiento del motor
‚óè Duraci√≥n m√≠nima del impulso
‚óè Duraci√≥n m√≠nima de la pausa

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1027

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Seleccionar la se√±al de salida y el tipo de se√±al
Salida anal√≥gica
En la salida anal√≥gica se puede seleccionar para cada canal qu√© se√±al debe emitirse. La
mayor√≠a de las veces es la variable manipulada A de un regulador. Sin embargo, tambi√©n se
puede seleccionar la variable manipulada B de un regulador o un valor de entrada anal√≥gica.
Este √∫ltimo se puede utilizar para linealizar un valor anal√≥gico. De esta forma se puede
linealizar p. ej. la se√±al proporcionada por un termopar y convertirla en 0 a 10 V.

Salida del regulador de impulso
La figura siguiente muestra la salida del regulador S (modo de operaci√≥n Regulador de
impulsos)
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDU
YDORU
PDQLSXODGR
H[WHUQR

9DORUPDQLSXODGR
$FWLYDU
VHJXLPLHQWR

$FWLYDUYDORU /LPLWDU
PDQLSXODGR
GHVHJXULGDG

5DQJR
SDUWLGRIRUPDGRU
GHLPSXOVRV

(QWUDGDGHFRUUHFFL¬µQ

6HJXLPLHQWRGHOYDORUPDQLSXODGR

1028

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Salida del regulador paso a paso
La figura siguiente muestra la salida del regulador S (modo de operaci√≥n Regulador paso a
paso con realimentaci√≥n de posici√≥n):
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDUYDORU
PDQLSXODGR
H[WHUQR

9DORU
PDQLSXODGR
$FWLYDU
VHJXLPLHQWR

$FWLYDUYDORU /LPLWDU
PDQLSXODGR
GHVHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

(QWUDGDGHFRUUHFFL¬µQ

6HJXLPLHQWRGHYDORUPDQLSXODGR

(QWUDGDGHUHVSXHVWDGHSRVLFL¬µQ

La figura siguiente muestra la salida del regulador S (modo de operaci√≥n Regulador paso a
paso sin realimentaci√≥n de posici√≥n):
9DORUPDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDUYDORU
PDQLSXODGR
H[WHUQR

$FWLYDUYDORU
PDQLSXODGR
GHVHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

En el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica, la variable manipulada
externa y la variable manipulada de seguridad act√∫an de la siguiente manera:
Si se asigna un valor entre el 40,0% y el 60,0%, no se activa ninguna salida binaria y el
actuador permanece sin cambios.
Si se establece un valor > 60,0%, se devuelve "Se√±al de posicionamiento alta" hasta que se
activa la realimentaci√≥n "Actuador en tope superior".
Si se establece un valor < 40,0%, se emite "Se√±al de posicionamiento baja" hasta que la
realimentaci√≥n accede a "Actuador en tope inferior".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1029

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3.5.4.5

Soporte de Shared Device
Los m√≥dulos de regulaci√≥n FM 355 y FM 355-2 soportan la funcionalidad Shared Device al
utilizar un m√≥dulo de interfaz ET 200M.
Encontrar√° informaci√≥n general sobre Shared Device en Configurar un Shared Device.

Uso de Shared Device con los m√≥dulos de regulaci√≥n
Para utilizar Shared Device con los m√≥dulos de regulaci√≥n, su programa debe contener
adicionalmente los siguientes bloques de organizaci√≥n:
‚óè OB de cambio de m√≥dulo (OB 83):
En la configuraci√≥n como Shared Device se debe integrar OB 83 en la lista de bloques para
que en la transici√≥n de STOP a RUN se generen las llamadas alarmas "return of
submodule". Estas alarmas son capturadas por el OB 83; de lo contrario, la CPU entrar√≠a
en STOP con el evento "STOP por cambio de m√≥dulo".
‚óè OB de error de acceso a la periferia (OB 122):
Mientras la CPU A se encuentre en STOP y la CPU B en RUN, en la CPU B se producir√°n
"errores de acceso de escritura a la periferia" si se llaman instrucciones de las librer√≠as "FM
355 PID Control" o "FM 355-2 Temp Control" en el programa o si se ejecutan otros accesos
de escritura a las direcciones de m√≥dulo. Estos errores son capturados por el OB 122; de
lo contrario, la CPU B entrar√≠a en STOP con el evento "STOP por error de acceso a la
periferia".
‚óè OB de error de ejecuci√≥n del programa (OB 85):
El OB 85 solo tiene que estar incluido si no se ha configurado la opci√≥n "Sin llamada OB85"
en las propiedades de la CPU bajo "Ciclo" para el ajuste "Llamar al OB85 en caso de error
de acceso a la periferia". Para las dem√°s opciones se requiere tambi√©n una llamada de OB
85 para los errores de acceso a la periferia descritos anteriormente para el OB 122. Si el OB
85 no est√° presente en este caso, la CPU pasa a STOP con el evento "STOP por error de
ejecuci√≥n del programa".
Ambas CPU deben encontrarse en "RUN" para que se puedan ejecutar correctamente los
accesos de escritura a direcciones de m√≥dulo y las instrucciones de las librer√≠as "FM 355 PID
Control" y "FM 355-2 Temp Control".
Mientras una CPU se encuentra en STOP y la otra en RUN, todos los m√≥dulos de regulaci√≥n
de este m√≥dulo de interfaz funcionan en el modo de respaldo. Esto es independiente del
"Acceso" que se ha efectuado en los ajustes de "Shared Device" del m√≥dulo de interfaz. Solo
si todas las CPU se encuentran en RUN, los m√≥dulos de regulaci√≥n funcionan en el modo
normal.

1030

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3.5.5

Uso del FM 355

3.5.5.1

Configuraci√≥n del FM 355

Configuraci√≥n hardware
Procedimiento
Para poder configurar el hardware debe haber creado previamente un proyecto donde pueda
guardar la parametrizaci√≥n. A continuaci√≥n se explican √∫nicamente los pasos m√°s importantes.
1. Inicie el TIA Portal y abra la configuraci√≥n de dispositivos.
2. Seleccione un rack.
3. Seleccione un m√≥dulo de regulaci√≥n del cat√°logo de m√≥dulos.
4. Arrastre el m√≥dulo de regulaci√≥n hasta la posici√≥n correspondiente del rack.
5. Anote la direcci√≥n de entrada del m√≥dulo a partir de la tabla de configuraci√≥n, p. ej. 272.
El valor le√≠do se muestra en formato decimal.

3.5.5.2

Parametrizaci√≥n del FM 355

Par√°metros del m√≥dulo
Procedimiento
Al parametrizar se configuran los par√°metros del m√≥dulo.
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros". En la
ventana de inspecci√≥n, seleccione la ficha "Propiedades".
Resultado: Las propiedades se muestran en la ventana de inspecci√≥n.
2. Parametrice los par√°metros b√°sicos del m√≥dulo y los par√°metros restantes.
3. Parametrice los otros par√°metros de bloque en la vista de configuraci√≥n.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".
5. Compile el proyecto con "Edici√≥n > Compilar".
6. Cargue los datos de parametrizaci√≥n a la CPU en estado STOP mediante "Online > Cargar
en dispositivo..."
Resultado: Los datos se encuentran en la memoria de la CPU y se transfieren directamente
desde all√≠ hasta el m√≥dulo.
7. Efect√∫e un rearranque de la CPU.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1031

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Par√°metros de la entrada anal√≥gica
Evaluaci√≥n de la entrada anal√≥gica
Procedimiento
Para seleccionar el tipo de sensor, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue por la vista de edici√≥n hasta "Entrada anal√≥gica > Entrada [n¬∫] > Evaluaci√≥n de la
entrada anal√≥gica".
3. Defina los siguientes par√°metros:
‚Äì Resoluci√≥n entrada anal√≥gica
‚Äì Tipo de sensor entrada anal√≥gica
La opci√≥n "Vigilancia de rotura de hilo" se habilita para diversos tipos de sensor. La
opci√≥n se puede activar seg√∫n se requiera.
‚Äì Temperatura de referencia
4. Guarde los par√°metros introducidos con "Proyecto > Guardar".

Funciones de filtro
Procedimiento
Para establecer las funciones de filtro, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. En la vista de configuraci√≥n seleccione "Entrada anal√≥gica > Entrada [n¬∞] > Funciones de
filtro".
3. Establezca los siguientes par√°metros:
‚Äì Para filtrar en funci√≥n de una constante de tiempo, active la opci√≥n "Filtro de se√±al".
Si la opci√≥n "Filtro de se√±al" est√° seleccionada, se puede establecer la constante de
tiempo del filtro.
‚Äì Constante de tiempo del filtro
Se puede activar solamente si la opci√≥n "Filtro de se√±al" se encuentra activada.
‚Äì Para linealizar de la se√±al del enc√≥der active la opci√≥n "Filtro de ra√≠z cuadrada".
‚Äì Para linealizar la curva caracter√≠stica de la se√±al del enc√≥der, active la opci√≥n "Filtro de
pol√≠gono"
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Filtro de se√±al
Filtro 1. Orden cuya rapidez de respuesta se establece mediante la constante de tiempo.

1032

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Filtro de ra√≠z cuadrada
Sirve para linealizar se√±ales de enc√≥der, en las que el valor real existe como magnitud f√≠sca,
que se encuentra en relaci√≥n cuadr√°tica con la magnitud de proceso medida.

Filtro de pol√≠gono
Sirve para linealizar de caracter√≠sticas de enc√≥ders.
Los 13 nodos disponibles pueden seleccionarse en:
‚óè mA en la entrada de corriente
‚óè mV en la entrada de tensi√≥n

Normalizaci√≥n
Procedimiento
Para convertir la se√±al de entrada en una unidad f√≠sica, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Entrada [n¬∫] > Normalizar".
3. Establezca los siguientes par√°metros:
‚Äì Valor superior
‚Äì Valor inferior
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Normalizaci√≥n
Para convertir la se√±al de entrada en otra unidad f√≠sica mediante interpolaci√≥n lineal entre el
valor inicial (valor inferior) y el valor final (valor superior).

Error de regulaci√≥n
Realizar un regulador de valor fijo o en cascada
Regulador de valor fijo o en cascada
En las estructuras de regulaci√≥n del regulador de valor fijo o en cascada, el valor real efectivo
es id√©ntico al valor real A.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1033

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Seleccionar tipo de regulador
Para realizar un regulador de valor fijo o en cascada, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de configuraci√≥n hasta "Entrada anal√≥gica > Canal [n¬∫]".
3. Seleccione en el √°rea "Tipo de regulador" la opci√≥n "Regulador de valor fijo o en cascada".
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para acondicionar la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫] > Error de regulaci√≥n".
3. Establezca, en las distintas √°reas, los par√°metros correspondientes:
‚Äì Origen de consigna
Seleccione el origen de la consigna.
‚Äì Consigna de seguridad
Ajuste aqu√≠ la consigna de seguridad. Asimismo, establezca la reacci√≥n en caso de un
fallo de la CPU y el comportamiento en el arranque.
‚Äì Rampa de consigna
Establezca el tiempo de subida de rampa.
‚Äì L√≠mite de consigna
Seleccione aqu√≠ el l√≠mite superior y el l√≠mite inferior de consigna.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Seleccionar el origen de la se√±al para el valor real A
Para seleccionar el origen de la se√±al para el valor real A, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫] > Error de regulaci√≥n".
3. Seleccione el origen correspondiente en el √°rea "Variable manipulada". Est√°n disponibles
las siguientes opciones:
‚Äì Cero
‚Äì Entrada anal√≥gica acondicionada
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

1034

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Realizar un regulador de tres componetes
Regulador de tres componentes
En la estructura del regulador de tres componentes, el valor real efectivo se forma a partir de
la suma de los tres valores reales A, B y C y mediante la adici√≥n de un offset ajustable. Los
valores reales B y C se pueden evaluar adicionalmente mediante factores.

Seleccionar el tipo de regulador
Para realizar un regulador de tres componentes, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫]".
3. Seleccione en el √°rea "Tipo de regulador" la opci√≥n "Regulador de tres componentes".
4. Guarde los par√°metros introducidos con "Proyecto > Guardar".

Acondicionamiento de la consigna
Para ajustar c√≥mo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫] > Error de regulaci√≥n".
3. Seleccione, en el √°rea "Origen de consigna", de d√≥nde debe proceder la consigna.
4. Introduzca, en el √°rea "Consigna de seguridad", un valor que debe servir como valor de
seguridad, en caso de un fallo de la CPU y para el arranque.
5. Seleccione el comportamiento del m√≥dulo de regulaci√≥n, que debe ser v√°lido como
"Reacci√≥n a fallo de la CPU" y para el "Comportamiento en arranque". Para ello, se dispone
de las siguientes opciones:
‚Äì Consigna = √∫ltima consigna v√°lida: al producirse el evento, se asigna la √∫ltima consigna
v√°lida a la consigna. La √∫ltima consigna v√°lida se mantiene.
‚Äì Consigna = consigna de seguridad: al producirse el evento, se asigna la consigna de
seguridad a la consigna. As√≠ se puede realizar un funcionamiento de emergencia
protegido.
6. Establezca, en el √°rea "Rampa de consigna", el tiempo de subida que debe respetarse, en
caso de una modificaci√≥n de la consigna, con el fin de reducir una sobreoscilaci√≥n.
7. Establezca en el √°rea "L√≠mite de consigna" tanto un l√≠mite superior como tambi√©n uno
inferior para la consigna.
8. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1035

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Seleccionar el origen de la se√±al para el valor real A, B y C
Para establecer los or√≠genes de la se√±al para los valores reales A, B y C, proceda del siguiente
modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫] > Error de regulaci√≥n".
3. Seleccione, en el √°rea "Variable manipulada", el origen de la se√±al correspondiente para
cada valor real. Puede seleccionar si no utiliza ninguna se√±al ("cero") como origen o si
utiliza una de las entradas anal√≥gicas acondicionadas.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Introducir factores para los valores reales B y C as√≠ como offset
Para establecer los or√≠genes de la se√±al para los valores reales A, B y C, proceda del siguiente
modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫] > Error de regulaci√≥n".
3. En el √°rea "Sumar los valores reales", establezca el factor de ponderaci√≥n necesario para
los valores reales B y C.
4. Establezca el "Offset" necesario que debe sumarse a los valores reales.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Realizar una regulaci√≥n de relaci√≥n o de mezcla
Seleccionar el tipo de regulador
Para realizar un regulador de relaci√≥n o de mezcla, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫]".
3. Seleccione en el √°rea "Tipo de regulador" la opci√≥n "Regulador de relaci√≥n o regulador de
mezcla".
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para ajustar c√≥mo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫] > Error de regulaci√≥n".
3. Seleccione en el √°rea "Origen de consigna", de d√≥nde debe proceder la consigna.
4. Introduzca, en el √°rea "Consigna de seguridad", un valor que debe servir como valor de
seguridad, en caso de un fallo de la CPU y para el arranque.

1036

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
5. Seleccione el comportamiento del m√≥dulo de regulaci√≥n, que debe ser v√°lido como
"Reacci√≥n a fallo de la CPU" y para el "Comportamiento en arranque". Para ello, dispone de
la selecci√≥n siguiente:
‚Äì Consigna = √∫ltima consigna v√°lida: al producirse el evento, se asigna la √∫ltima consigna
v√°lida a la consigna. Por consiguiente, a √∫ltima consigna v√°lida se mantiene.
‚Äì Consigna = consigna de seguridad: al aparecer el evento se asigna la consigna de
seguridad a la consigna. As√≠ se puede realizar un funcionamiento de emergencia
seguro.
6. Establezca, en el √°rea "Rampa de consigna", el tiempo de subida que debe respetarse, en
caso de una modificaci√≥n de la consigna, con el fin de reducir una sobreoscilaci√≥n.
7. Establezca en el √°rea "L√≠mite de consigna" tanto un l√≠mite superior como tambi√©n uno
inferior para la consigna.
8. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Seleccionar el origen de la se√±al para los valores reales A y D
Para establecer los or√≠genes de la se√±al para los valores reales A y D, proceda del siguiente
modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫] > Error de regulaci√≥n".
3. Seleccione, en el √°rea "Variable manipulada", el origen de la se√±al correspondiente para
cada valor real. Puede especificar no utilizar ninguna se√±al ("cero") como origen o utilizar
una de las entradas anal√≥gicas acondicionadas, para el valor real D puede seleccionar
tambi√©n el valor manipulado de uno de los reguladores.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Introducir multiplicador
Para establecer los or√≠genes de la se√±al para los valores reales A y D, proceda del siguiente
modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫] > Error de regulaci√≥n".
3. Seleccione el offset deseado en el √°rea "Multiplicar".
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".
Para el regulador de relaci√≥n, se utiliza el valor real A como magnitud regulada y el valor real
D como magnitud de relaci√≥n. La entrada de consigna funciona como factor de relaci√≥n. √âsta
se acondiciona para obtener una consigna efectiva mediante multiplicaci√≥n por el valor real D
y adici√≥n de un offset ajustable. Si el valor real D se desactiva, entonces s√≥lo se suma el offset
a la consigna.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1037

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Ajustar la generaci√≥n de alarma
Procedimiento
Para ajustar la generaci√≥n de alarma, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Entrada anal√≥gica > Canal [n¬∫] > Error de regulaci√≥n".
3. Seleccione las opciones necesarias en el √°rea "Generar alarma":
‚Äì Seleccione, en "Avisador de valor l√≠mite de", para qu√© se√±al se debe fijar la alarma.
‚Äì Bajo "Alarma l√≠mite superior", establezca a partir de qu√© valor se activa la alarma al
alcanzarse el l√≠mite superior.
‚Äì Bajo "Advertencia l√≠mite superior", establezca a partir de que valor se activa una
advertencia, cuando se produce una aproximaci√≥n al l√≠mite superior.
‚Äì Bajo "Advertencia l√≠mite inferior", establezca a partir de qu√© valor activa una
advertencia, cuando se produce una aproximaci√≥n al l√≠mite inferior.
‚Äì Bajo "Alarma l√≠mite inferior", establezca a partir de qu√© valor se activa la alarma al
alcanzarse el l√≠mite inferior.
‚Äì Para evitar que centelleen los indicadores de vigilancia, se puede parametrizar una
hist√©resis bajo "Hist√©resis".
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Algoritmo de regulaci√≥n
Realizar una regulaci√≥n P
Procedimiento
Para realizar una regulaci√≥n P, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Seleccione, en el √°rea "Tipo", la opci√≥n "Regulador PID".
4. Seleccione en el √°rea "General", bajo "Modo de operaci√≥n", la opci√≥n "P".
Todas las opciones que son parametrizables para una regulaci√≥n P se activan; todas las
opciones restantes se desactivan.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

1038

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Realizar una regulaci√≥n PI
Procedimiento
Para realizar una regulaci√≥n PI, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Seleccione, en el √°rea "Tipo", la opci√≥n "Regulador PID".
4. Seleccione en el √°rea "General", bajo "Modo de operaci√≥n", la opci√≥n "PI".
Todas las opciones que son parametrizables para una regulaci√≥n PI se activan; todas las
opciones restantes se desactivan.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Crear regulaci√≥n I
Procedimiento
Para realizar una regulaci√≥n I, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Seleccione, en el √°rea "Tipo", la opci√≥n "Regulador PID".
4. Seleccione en el √°rea "General", bajo "Modo de operaci√≥n", la opci√≥n "I".
Todas las opciones que son parametrizables para una regulaci√≥n I se activan; todas las
opciones restantes se desactivan.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Crear una regulaci√≥n PID
Procedimiento
Para realizar una regulaci√≥n PID, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Seleccione, en el √°rea "Tipo", la opci√≥n "Regulador PID".
4. Seleccione en el √°rea "General", bajo "Modo de operaci√≥n", la opci√≥n "PID".
Todas las opciones que son parametrizables para una regulaci√≥n PID se activan; todas las
opciones restantes se desactivan.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1039

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Crear una regulaci√≥n PD
Procedimiento
Para realizar una regulaci√≥n PD, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Seleccione, en el √°rea "Tipo", la opci√≥n "Regulador PID".
4. Seleccione en el √°rea "General", bajo "Modo de operaci√≥n", la opci√≥n "PD".
Todas las opciones que son parametrizables para una regulaci√≥n PD se activan; todas las
opciones restantes se desactivan.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Realizar una regulaci√≥n de temperatura por l√≥gica difusa
Procedimiento
Para llevar a cabo una regulaci√≥n de temperatura por l√≥gica difusa, proceda del modo
siguiente:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Seleccione, en el √°rea "Tipo", la opci√≥n "M√≥dulo de regulaci√≥n de temperatura por l√≥gica
difusa".
Todas las opciones que son parametrizables para una regulaci√≥n de temperatura por l√≥gica
difusa se activan; todas las opciones restantes se desactivan.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Suprimir nivel de ruido del error de regulaci√≥n
Procedimiento
Para suprimir el nivel de ruido del error de regulaci√≥n, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Establezca, en el √°rea "General", el ajuste de "Ancho de zona muerta".
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

1040

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Control anticipativo
Procedimiento
Para aplicar adicionalmente una perturbaci√≥n, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. En el √°rea "General", en la lista "Fuente de perturbaci√≥n", seleccione la fuente de la
perturbaci√≥n.
Seleccione la entrada "Cero" para no aplicar ninguna perturbaci√≥n adicionalmente.
4. Introduzca, bajo "Factor de perturbaci√≥n", un valor, con el que desea ponderar la
perturbaci√≥n.
Un valor < 0 debilita la perturbaci√≥n, un valor > 0 aumenta la perturbaci√≥n. Con un valor de
1, la perturbaci√≥n no cambia.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Poner la acci√≥n P por rama de realimentaci√≥n
Procedimiento
Para realizar un regulador de valor fijo o en cascada, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en la "Puesta en servicio".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Seleccione en el √°rea "Acci√≥n P" la opci√≥n "Por rama de realimentaci√≥n".
Si la opci√≥n est√° desactivada, la acci√≥n P est√° puesta en rama de realimentaci√≥n.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Debilitar la acci√≥n D en caso de cambios de consigna
Seleccionar el tipo de regulador
Para realizar un regulador de valor fijo o en cascada, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Seleccione, en el √°rea "Acci√≥n D", con la opci√≥n "Acci√≥n D", el origen para la acci√≥n D.
4. Establezca el factor para la acci√≥n D en el √°rea "Factor derivativo".
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1041

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Invertir el efecto del regulador
Principio
La inversi√≥n del regulador de la asignaci√≥n "error de regulaci√≥n creciente = magnitud
manipulada creciente" a "error de regulaci√≥n creciente = magnitud manipulada decreciente",
se logra mediante el ajuste de una ganancia proporcional negativa (GAIN).

Procedimiento
Para invertir el efecto del regulador, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Algoritmo de regulaci√≥n".
3. Establezca, en el √°rea "General", una ganancia proporcional con signo invertido.
Si se indica una ganancia proporcional positiva y el efecto del regulador debe invertirse,
establezca una ganancia proporcional negativa.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Salida del regulador
Crear un regulador continuo
Un regulador continuo s√≥lo puede realizarse con un m√≥dulo anal√≥gico.

Procedimiento
1. Conectar una variable manipulada externo (P√°gina 1044)
2. Ajustar la variable manipulada de seguridad (P√°gina 1045)
3. Conectar el modo de seguimiento (P√°gina 1044)
4. Limitar la variable manipulada (P√°gina 1045)
5. Controlar dos actuadores - Rango partido (P√°gina 1046)
6. Seleccionar la se√±al de salida y el tipo de se√±al (P√°gina 1047)

Regulador paso a paso sin realimentaci√≥n de posici√≥n
Un regulador paso a paso sin realimentaci√≥n de posici√≥n s√≥lo puede realizarse con un m√≥dulo
digital.

Procedimiento
1. Seleccionar regulador paso a paso sin realimentaci√≥n de posici√≥n
2. Conectar una variable manipulada externo (P√°gina 1044)

1042

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Ajustar la variable manipulada de seguridad (P√°gina 1045)
4. Formador de impulsos del regulador paso a paso (P√°gina 1046)

Crear un regulador paso a paso con realimentaci√≥n de posici√≥n
Un regulador paso a paso con realimentaci√≥n de posici√≥n s√≥lo puede realizarsese con un
m√≥dulo digital.

Procedimiento
1. Seleccionar regulador paso a paso con realimentaci√≥n de posici√≥n
2. Conectar una variable manipulada externo (P√°gina 1044)
3. Conectar el modo de seguimiento (P√°gina 1044)
4. Ajustar la variable manipulada de seguridad (P√°gina 1045)
5. Limitar la variable manipulada (P√°gina 1045)
6. Ajustar la realimentaci√≥n de posici√≥n (P√°gina 1044)
7. Formador de impulsos del regulador paso a paso (P√°gina 1046)

Crear regulador de impulsos
Un regulador de impulsos s√≥lo puede realizarse con un m√≥dulo digital.

Procedimiento
1. Seleccionar salida del regulador de impulsos
2. Conectar una variable manipulada externo (P√°gina 1044)
3. Conectar el modo de seguimiento (P√°gina 1044)
4. Ajustar la variable manipulada de seguridad (P√°gina 1045)
5. Limitar la variable manipulada (P√°gina 1045)
6. Preparar se√±al anal√≥gica para la conversi√≥n en se√±al digital
7. Convertir la se√±al anal√≥gica en se√±al digital (P√°gina 1047)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1043

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Parametrizar las funciones de la salida del regulaldor
Conectar una variable manipulada externo
Procedimiento
Para conectar la variable manipulada externa, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Salida del regulador".
3. En el √°rea "Variable manipulada externa", seleccione la opci√≥n con la cual debe activarse
la variable manipulada externa. Para ello, dispone de las siguientes opciones:
‚Äì Activaci√≥n del bloque de funci√≥n.
‚Äì Activaci√≥n del bloque de funci√≥n o de una de las entradas digitales.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Conectar el modo de seguimiento
Procedimiento
Para realizar un regulador de valor fijo o en cascada, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Salida del regulador".
3. En el √°rea "Modo de seguimiento", seleccione la opci√≥n mediante la cual se debe activar la
variable manipulada externa. Para ello, dispone de las siguientes opciones:
‚Äì Activaci√≥n del bloque de funci√≥n.
‚Äì Activaci√≥n del bloque de funci√≥n o de una de las entradas digitales.
4. En el √°rea "Modo de seguimiento", seleccione el origen de la se√±al para el modo de
seguimiento. Para ello, dispone de las siguientes opciones:
‚Äì Cero, en este caso, no se utilizar ning√∫n origen.
‚Äì Una de las entradas anal√≥gicas.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Ajustar la realimentaci√≥n de posici√≥n
Procedimiento
Para ajustar la realimentaci√≥n de posici√≥n, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Salida digital > Salida [n¬∫]".

1044

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. En el √°rea "Entrada de realimentaci√≥n de posici√≥n", seleccione la opci√≥n "Origen", para
seleccionar la se√±al para la realimentaci√≥n de posici√≥n.
‚Äì Cero: ninguna realimentaci√≥n de posici√≥n.
‚Äì Una de las entradas anal√≥gicas acondicionadas.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Ajustar la variable manipulada de seguridad
Procedimiento
Para ajustar la variable manipulada de seguridad, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Salida del regulador".
3. En el √°rea "Variable manipulada de seguridad", establezca el valor que debe utilizarse
como variable manipulada de seguridad.
4. Bajo "Activaci√≥n", seleccione la opci√≥n mediante la cual se debe activar la variable
manipulada externa. Para ello, dispone de las siguientes opciones:
‚Äì Activaci√≥n del bloque de funci√≥n.
‚Äì Activaci√≥n del bloque de funci√≥n o de una de las entradas digitales.
5. Bajo "Reacci√≥n al arrancar el m√≥dulo", seleccione la opci√≥n que debe llevarse a cabo en el
arranque del m√≥dulo. Dispone de las siguientes opciones para su elecci√≥n:
‚Äì Lazo cerrado: en el arranque, el m√≥dulo pasa inmediatamente al modo de regulaci√≥n.
‚Äì Variable manipulada de seguridad: primero se regula a la variable manipulada de
seguridad.
6. Bajo "Reacci√≥n si falla el transductor valor real A", seleccione la opci√≥n que debe llevarse
a cabo, en caso de fallo del transductor de medida del valor real A.
7. Bajo "Reacci√≥n a fallo transductor entrada", seleccione la opci√≥n que debe llevarse a cabo,
en caso de fallo del transductor de medida de una entrada.
8. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Limitar la variable manipulada
Procedimiento
Para limitar la variable manipulada, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Salida del regulador".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1045

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. En el √°rea "L√≠mite de se√±al de salida", establezca los siguientes valores:
‚Äì Valor superior: representa el valor l√≠mite superior para la se√±al de salida.
‚Äì Valor inferior: representa el valor l√≠mite inferior para la se√±al de salida.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Controlar dos actuadores - Rango partido
Procedimiento
Para activar dos actuadores, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Regulador > Canal [n¬∫] > Salida del regulador".
3. En el √°rea "Rango partido", seleccione la opci√≥n "Activar", para activar dos elementos
finales de control.
4. Establezca los siguientes valores tanto para las se√±ales de entrada y salida A como
tambi√©n para las se√±ales de entrada y salida B:
‚Äì Se√±al de entrada inferior.
‚Äì Se√±al de entrada superior.
‚Äì Se√±al de salida inferior.
‚Äì Se√±al de salida superior.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Formador de impulsos del regulador paso a paso
Procedimiento
Para parametrizar el formador de impulsos, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Salida digital > Salida [n¬∫]".
3. En el √°rea "formador de impulsos", establezca los siguientes par√°metros:
‚Äì Tiempo de posicionamiento del motor.
‚Äì Duraci√≥n m√≠nima de impulso.
‚Äì Duraci√≥n m√≠nima de pausa.
4. Seleccione la opci√≥n adecuada de la que se debe tomar el valor para el valor superior y el
inferior:
‚Äì Del bloque de funci√≥n.
‚Äì Del bloque de funci√≥n o de una de las entradas digitales.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

1046

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Convertir la se√±al anal√≥gica en se√±al digital
Procedimiento
Para convertir una se√±al anal√≥gica en una se√±al digital, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Salida digital > Canal [n¬∫]".
3. En el √°rea "formador de impulsos", establezca los siguientes par√°metros:
‚Äì Duraci√≥n m√≠nima de impulso.
‚Äì Duraci√≥n m√≠nima de pausa.
4. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Seleccionar la se√±al de salida y el tipo de se√±al
Procedimiento
Para seleccionar la se√±al de salida y el tipo de se√±al, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el m√≥dulo del "Ajuste de par√°metros".
2. Navegue en la vista de edici√≥n hasta "Salida anal√≥gica > Salida [n¬∫]".
3. Bajo la opci√≥n "Origen", seleccione qu√© se√±al se debe utilizar como se√±al de salida.
Dispone de las siguientes opciones:
‚Äì Cero: ning√∫n origen para la se√±al de salida.
‚Äì Una de las entradas anal√≥gicas.
‚Äì Uno de los valores manipulados para el regulador A o B.
4. Bajo la opci√≥n "Tipo de se√±al", seleccione el tipo en el que debe emitirse la se√±al de salida.
5. Guarde los par√°metros introducidos mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1047

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3.5.5.3

Programaci√≥n del FM 355

3.5.5.4

Puesta en servicio del FM 355

Crear y configurar DBs de instancia
Procedimiento
Para satisfacer los requisitos para la puesta en marcha, proceda de la manera siguiente:
1. Cree un programa de usuario que efect√∫e c√≠clicamente una llamada a la instrucci√≥n
PID_FM en un OB de alarma c√≠clica.
2. En el programa del usuario, ponga READ_VAR c√≠clicamente a TRUE.
3. Genere para cada canal del regulador un DB de instancia individual de la
instrucci√≥nPID_FM.
4. Para cada DB de instancia, introduzca la direcci√≥n de m√≥dulo en el par√°metro
PID_FM.MOD_ADDR.
Utilice como direcci√≥n de m√≥dulo del FM 355 la direcci√≥n inicial especificada al configurar
el hardware.
5. Introduzca en el par√°metro PID_FM.CHANNEL el n√∫mero del canal de regulaci√≥n (1 ... 4).
6. Si utiliza la instrucci√≥n PID_PAR, introduzca en el par√°metro PID_PAR.CHANNEL el
n√∫mero del canal del regulador.
7. Compruebe que est√© activado el "Tipo de sensor Entrada anal√≥gica" del canal en cuesti√≥n.
Si no se procesa la entrada anal√≥gica, todos los par√°metros PID se ajustan a cero, y no se
calcula ninguna variable manipulada.
Nota
DBs multiinstancia
Si utiliza DBs multiinstancia en su proyecto, los FM se deben poner en servicio a trav√©s de
una tabla de observaci√≥n.

Puesta en servicio del regulador
Introducci√≥n
Los par√°metros PID se pueden optimizar del modo siguiente:
‚óè Regulador PID/PI (regulador paso a paso, regulador continuo, regulador de impulsos):
Manual
‚óè Regulador de temperatura por l√≥gica difusa: Ciclo continuo
‚óè Regulador paso a paso: Autom√°ticamente con la instrucci√≥n TUN_ES
‚óè Regulador continuo: Autom√°ticamente con la instrucci√≥n TUN_EC
‚óè Regulador de impulsos: Autom√°ticamente con la instrucci√≥n TUN_EC

1048

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para optimizar un regulador, proceda del siguiente modo:
1. Coloque la CPU en el estado RUN.
2. Si utiliza un regulador paso a paso, mida el tiempo de posicionamiento del motor.
3. Optimice los par√°metros PID con alguna de las posibilidades citadas anteriormente.
4. Observe el lazo de regulaci√≥n con el registrador de curvas.

Consulte tambi√©n
Medir el tiempo de posicionamiento del motor (P√°gina 1056)

Optimizar los par√°metros PID manualmente
Requisitos
En la parametrizaci√≥n del algoritmo de regulaci√≥n ha elegido el "Regulador PID".

Procedimiento
Para ajustar manualmente un regulador PI/PID, proceda del modo siguiente:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. Introduzca los valores correspondientes para la acci√≥n P, la acci√≥n I, la acci√≥n D y el retardo.
4. En el grupo "Optimizaci√≥n", haga clic en el s√≠mbolo

"Enviar par√°metros PID al FM".

5. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna".
6. Introduzca una nueva consigna.
7. Desactive en caso necesario la casilla de verificaci√≥n "Modo manual" y, en el grupo
"Valores actuales", haga clic en el s√≠mbolo .
El regulador trabaja con los nuevos par√°metros y regula seg√∫n la nueva consigna.
8. Compruebe la calidad de los par√°metros PID mediante los recorridos de la curva.
9. Repita los pasos del 3 hasta el 8, hasta que est√© satisfecho/a con el resultado de la
regulaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1049

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Identificaci√≥n del sistema por l√≥gica difusa
Requisitos del proceso para un regulador de temperatura por l√≥gica difusa
Requisitos
Para conseguir una regulaci√≥n √≥ptima con la ayuda del regulador de temperatura por l√≥gica
difusa, el proceso debe satisfacer los requisitos siguientes:
‚óè En caso de calefacciones de ba√±os, el l√≠quido calefactor debe estar bien mezclado.
‚óè En caso de regulaciones tipo ba√±o en ba√±o, ambos l√≠quidos deben estar bien agitados.
Simult√°neamente, se debe proporcionar una buena transferencia de calor entre todos los
medios caloportadores. Si se emplean materiales que son malos caloportadores, para
conseguir un buen transporte del calor se deben utilizar superficies de transferencia de gran
tama√±o.
‚óè En caso de regulaci√≥n de la temperatura del aire ambiental, se debe proporcionar una
buena mezcla (p. ej., mediante ventiladores).
‚óè La ganancia del sistema regulado no debe superar un factor 3.
‚óè El tiempo de retardo debe equivaler como m√°ximo al 3% del tiempo de compensaci√≥n.
‚óè Durante el periodo de muestreo del regulador, y con la salida de la variable manipulada en
el valor m√°ximo, la temperatura que se desea regular debe variar como m√°ximo un 1‚Ä∞ de
la temperatura m√°xima preajustada.

Clasificaci√≥n de los sistemas regulados
Un sistema regulado, o bien un proceso que se desea regular, se caracteriza por par√°metros
como, p. ej., la potencia de calefacci√≥n, la masa que se debe calentar o la capacidad t√©rmica
del medio que se desea calentar. En lo que se refiere al regulador por l√≥gica difusa, se efect√∫a
una distinci√≥n entre sistemas de temperatura regulada "cr√≠ticos" y "no cr√≠ticos" del modo
siguiente: La regulaci√≥n es tanto m√°s cr√≠tica
‚óè cuanto mayor es la potencia de calefacci√≥n,
‚óè cuanto mayor es la capacidad t√©rmica de la calefacci√≥n,
‚óè cuanto menor es la capacidad t√©rmica del medio que se desea calentar,
‚óè cuanto mayor es la resistencia a la transmisi√≥n de calor,
‚óè cuanto menor es la superficie de transferencia de calor.
Tras el seguimiento autom√°tico de un salto en la variable manipulada por parte del sistema
regulado, √©ste reacciona con una respuesta a un escal√≥n. La clasificaci√≥n de los sistemas
regulados tambi√©n se puede llevar a cabo en funci√≥n de esta respuesta a un escal√≥n: La
regulaci√≥n es tanto m√°s cr√≠tica cuanto mayor es el cociente tu / tg y cuanto mayor es la ganancia
del sistema regulado. Si tu / tg < 1/10, el sistema regulado no es cr√≠tico.

Consulte tambi√©n
Valores caracter√≠sticos del sistema regulado (P√°gina 645)

1050

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Desarrollo de la identificaci√≥n del sistema por l√≥gica difusa
Desarrollo de la optimizaci√≥n de par√°metros con un regulador de temperatura por l√≥gica difusa
La optimizaci√≥n de par√°metros se basa en un regulador por l√≥gica difusa autooptimizante.
La identificaci√≥n del sistema regulado comienza con una fase de observaci√≥n, durante la cual
la potencia de calefacci√≥n emitida es nula. Esta fase de observaci√≥n dura lo siguiente:
‚óè Fase de observaci√≥n de un regulador continuo: aprox. 1 minuto
‚óè Fase de observaci√≥n de un regulador paso a paso: aprox. 1 minuto + 1/2 x tiempo de
desplazamiento del actuador
Este tiempo se emplea para poder detectar tendencias de temperatura en el medio calefactor.
A continuaci√≥n se emite el 100% de la potencia m√°xima de calefacci√≥n; esto se aprecia en el
par√°metro de salida LMN del DB de instancia de la instrucci√≥n PID_FM.
El √°rea del primer 4% de incremento de la temperatura del rango de consigna se utiliza para
la identificaci√≥n, ya que tanto en el 1% como en el 4% del incremento de temperatura se
obtiene informaci√≥n sobre el comportamiento del proceso a partir del tiempo transcurrido.
La identificaci√≥n concluye cuando la potencia de calefacci√≥n pasa a ser inferior al 100%. Este
comportamiento se puede utilizar, p. ej., para desconectar la identificaci√≥n a trav√©s del
programa de usuario. Tras la fase de identificaci√≥n, el regulador sigue funcionando con los
par√°metros obtenidos.
Si la divergencia provocada por el salto de consigna no se compensa y la potencia de
calefacci√≥n permanece a cero de manera continua, significa que la identificaci√≥n ha resultado
fallida, es decir, el regulador no puede regular el sistema regulado al que est√° conectado.

Comportamiento del regulador para distintos sistemas regulados
Si el sistema regulado es "no cr√≠tico", no hay problemas en la identificaci√≥n ni en la regulaci√≥n.
La identificaci√≥n de un sistema regulado "demasiado cr√≠tico" queda cancelada. Si un sistema
regulado se identifica como "cr√≠tico", su regulaci√≥n se efect√∫a con mucha "precauci√≥n", es
decir, despacio.

Efectuar la identificaci√≥n de sistema por l√≥gica difusa.
Requisitos
En la parametrizaci√≥n del algoritmo de regulaci√≥n ha elegido el "Regulador por l√≥gica difusa".
Si es posible, aseg√∫rese de que antes de la identificaci√≥n el sistema regulado se haya
estabilizado (ning√∫n proceso activo de calefacci√≥n o refrigeraci√≥n) o var√≠e con lentitud y de
forma mon√≥tona. Se puede utilizar como criterio al respecto que el comportamiento de la
variaci√≥n de temperatura durante un minuto se pueda aproximar por una recta. En procesos
r√°pidos, este requisito resulta especialmente actual.
Dado que el valor emitido para la variable manipulada es nulo durante aprox. un minuto al
principio de la identificaci√≥n del regulador, la temperatura que se desea regular debe ser
cercana a la temperatura ambiente.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1051

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Iniciar la identificaci√≥n del sistema por l√≥gica difusa
Para optimizar un regulador por l√≥gica difusa, proceda del modo siguiente:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el s√≠mbolo "Start".
Si a√∫n no existe ninguna conexi√≥n online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. En el grupo "Optimizaci√≥n" introduzca una nueva consigna (SP_OP).
La nueva consigna debe cumplir las condiciones siguientes:
‚Äì Salto de consigna > 5%
‚Äì Nueva consigna > valor real + l√≠mite superior de la consigna x 0,12
4. En el grupo "Optimizaci√≥n", haga clic en el s√≠mbolo
difusa".

"Identificaci√≥n del sistema por l√≥gica

Resultado
La nueva consigna (SP_OP), SP_OP_ON = TRUE y FUZID_ON = TRUE se env√≠an al FM. La
identificaci√≥n del sistema por l√≥gica difusa comienza. El par√°metro IDSTATUS de la
instrucci√≥n CH_DIAG proporciona informaci√≥n sobre el estado de la identificaci√≥n. En el
cuadro de visualizaci√≥n de estado puede ver si hay una identificaci√≥n del sistema por l√≥gica
difusa en estado activo o en ejecuci√≥n.

Desactivar la identificaci√≥n del sistema por l√≥gica difusa
Mientras el bit FUZID_ON = TRUE, cada vez que se produzca un salto de consigna
suficientemente grande se iniciar√° la identificaci√≥n siguiente.
Para desconectar el modo de optimizaci√≥n, proceda del modo siguiente:
1. Inserte FUZID_ON en una tabla de observaci√≥n.
2. Defina FUZID_ON = FALSE.
Nota
La desconexi√≥n del modo de optimizaci√≥n FUZID_ON = FALSE antes de terminar la
identificaci√≥n no provoca que esta se detenga. Una vez iniciada la identificaci√≥n, esta sigue
adelante pase lo que pase, excepto si se produce un salto de consigna negativo.

Repetir la identificaci√≥n del sistema por l√≥gica difusa
Cada vez que se produce un salto de consigna ‚â•12% se efect√∫a una nueva identificaci√≥n, a no
ser que esta se desconecte de nuevo con FUZID_ON = FALSE.
Tambi√©n existe la posibilidad de iniciar de nuevo la identificaci√≥n disminuyendo y, a
continuaci√≥n, aumentando de nuevo la consigna en un valor >12%.

1052

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Cancelar la identificaci√≥n del sistema por l√≥gica difusa
La identificaci√≥n se puede cancelar en los casos siguientes:
‚óè Por parte del regulador, si se identifica un sistema regulado "cr√≠tico". Tras la cancelaci√≥n,
el regulador se encuentra en estado de error. Este estado se manifiesta en que el regulador
desactiva la variable manipulada de forma permanente. Este estado no var√≠a aunque se
desconecte la optimizaci√≥n. El inicio de una nueva identificaci√≥n anula el estado de error.
Se puede obtener informaci√≥n sobre el estado de la identificaci√≥n a trav√©s del par√°metro
IDSTATUS del FB CH_DIAG. M√°s detalles al respecto al final de este cap√≠tulo, en la
secci√≥n "Informaci√≥n sobre el estado del regulador".
‚óè Por parte del operador, generando un salto de consigna negativo, siempre y cuando la
consigna rebase por defecto la condici√≥n 2 (v√©ase m√°s arriba, "¬øC√≥mo iniciar la
identificaci√≥n?").
Para cancelar la optimizaci√≥n, proceda del modo siguiente:
1. Introduzca una nueva consigna que sea inferior al valor real actual y que cumpla las mismas
condiciones que al principio de la identificaci√≥n del sistema por l√≥gica difusa.
2. En el grupo "Optimizaci√≥n", haga clic en el s√≠mbolo
difusa".

"Identificaci√≥n del sistema por l√≥gica

Cargar los par√°metros optimizados en el dispositivo
Introducci√≥n
Para impedir que los par√°metros del FM se sobrescriban con los datos del sistema en el
siguiente arranque de la CPU, se puede proceder del modo siguiente:
‚óè Tras cada arranque del FM , cargue en este con LOAD_PAR=TRUE los par√°metros PID
optimizados del DB de instancia del PID_FM.
‚óè Cargue los par√°metros PID optimizados en el SDB.
Nota
Los juegos de par√°metros PI, PID y SAVE no se pueden guardar en el SDB.

Procedimiento
Para cargar los par√°metros en el SDB, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo
"Transfiera datos online al proyecto offline".
Los par√°metros PID se guardan en el ajuste de par√°metros del FM.
2. Pare la CPU.
3. Haga clic en el s√≠mbolo

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

"Cargar en dispositivo".

1053

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Trabajar con el registrador de curvas
Observar
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Puesta en servicio".
2. Navegue en la vista de configuraci√≥n hasta "Registrador de curvas".
3. Seleccione el DB de instancia que desee observar. Tras la selecci√≥n se muestra el canal al
que est√° asignado el DB de instancia.
4. Defina el tiempo de actualizaci√≥n con el que debe registrarse el registrador de curvas.
5. Haga clic en "Medici√≥n activada" para iniciar la medici√≥n.
6. Haga clic en "Medici√≥n desactivada" para finalizar la medici√≥n.

Procedimiento
Para adaptar la escala, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Puesta en servicio".
2. Navegue en la vista de configuraci√≥n hasta "Registrador de curvas".
3. Para modificar el eje de tiempo:
‚Äì Haga clic en el bot√≥n de flecha junto a la fecha, para abrir un calendario. Seleccione una
fecha en el calendario. Para bloquear la selecci√≥n, haga clic en el candado azul. Esta
posibilidad existe tanto para la fecha inicial como para la fecha final.
‚Äì Haga clic con el puntero del rat√≥n en la escala de tiempo. El puntero del rat√≥n se
representa como flecha a la izquierda/derecha. Mantenga el puntero del rat√≥n
presionado y arr√°strelo hacia la izquierda o derecha.
Si el tiempo inicial o final est√° bloqueado, se modifica la escala del tiempo.
Si no est√° bloqueado el tiempo inicial ni el final, se modifica el per√≠odo indicado; la escala
se mantiene igual.
4. Para modificar el eje de tiempo:
‚Äì Haga clic en el campo de entrada para el valor superior o el valor inferior mostrado.
Introduzca ah√≠ el valor deseado. Para bloquear la selecci√≥n, haga clic en el candado
azul. Esta posibilidad existe tanto para el valor superior como tambi√©n para el inferior.
‚Äì Haga clic con el puntero del rat√≥n en la escala de valores. El puntero del rat√≥n se
representa como flecha arriba/abajo. Mantenga el puntero del rat√≥n presionado y
arr√°strelo hacia arriba o abajo.
Si el valor superior o inferior est√° bloqueado, se modifica la escala del eje de valores.
Si no est√° bloqueado el valor superior ni el valor inferior, se modifica el rango indicado;
la escala se mantiene igual.

1054

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Modificar los par√°metros a trav√©s de la HMI
Procedimiento
Si desea modificar los par√°metros del regulador de la instrucci√≥n PID_FM mediante el manejo
a trav√©s de la HMI, proceda del modo siguiente:
1. Desde la HMI, escriba en la CPU (v√©ase ‚ë†) en un DB auxiliar los par√°metros que se deben
modificar.
2. Ponga PID_FM.COM_RST a TRUE.
La instrucci√≥n ejecuta una inicializaci√≥n. Los par√°metros se sincronizan entre el FM y la
CPU (v√©ase ‚ë°).
3. Transfiera los par√°metros que se deben modificar desde el DB auxiliar hasta el DB de
instancia de la instrucci√≥n PID_FM (v√©ase ‚ë¢).
4. Ponga PID_FM.LOAD_PAR a TRUE.
Los par√°metros modificados se transfieren al FM (v√©ase ‚ë£).
Resulta necesario depositar los par√°metros en un DB auxiliar porque, tras el arranque de la
CPU, PID_FM lee con COM_RST = TRUE aquellos par√°metros del m√≥dulo que la CPU ha
transferido previamente desde los datos del sistema al FM.
&38

23



'%GHD\XGD


WUDVODLQLFLDOL]DFL¬µQFRQ
&20B567 758(
'%GH
LQVWDQFLDGHO
)%
3,'B)0

)%
3,'B)0

)0


/2$'B3$5 758(
&20B567 758(


'DWRVGHO
VLVWHPD

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

&DUJDGHORVGDWRVGHO
VLVWHPDDUUDQTXH
6723 ‡µ∫ 581 OD&38

1055

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Medir el tiempo de posicionamiento del motor
Introducci√≥n
Para conseguir un buen resultado de la regulaci√≥n, el tiempo de posicionamiento del motor
debe ser lo m√°s preciso posible. Los datos de la documentaci√≥n del elemento final de control
son valores medios para este tipo de elemento final de control. El valor puede variar para el
elemento final de control que se use en cada momento.
Si utiliza actuadores con realimentaci√≥n de posici√≥n o con se√±ales de tope, es posible medir
el tiempo de posicionamiento del motor durante la puesta en servicio. Si no se dispone de una
realimentaci√≥n de posici√≥n ni de se√±ales de tope, no es posible medir el tiempo de
posicionamiento del motor.

Requisitos
‚óè El valor parametrizado del tiempo de posicionamiento del motor debe equivaler como
m√≠nimo a la mitad del tiempo de posicionamiento real. El actuador se desplaza en un
sentido durante el doble del tiempo de posicionamiento como m√°ximo.
‚óè En los actuadores con realimentaci√≥n de posici√≥n anal√≥gica, la realimentaci√≥n de posici√≥n
debe estar interconectada.
‚óè En los actuadores con se√±ales de tope, las se√±ales de tope deben estar interconectadas.

Actuadores con realimentaci√≥n de posici√≥n anal√≥gica
Para medir el tiempo de posicionamiento del motor con realimentaci√≥n de posici√≥n, proceda
del siguiente modo:
1. Elija el DB instancia para el que se debe medir el tiempo de posicionamiento del motor.
2. Active la casilla de verificaci√≥n "Utilizar realimentaci√≥n de posici√≥n".
3. En el campo de entrada "Posici√≥n de destino" indique hacia d√≥nde desea mover el
elemento final de control.
La realimentaci√≥n de posici√≥n actual (posici√≥n de inicio) se muestra. Haga clic en el
bot√≥n
"Iniciar medici√≥n tiempo de posicionamiento".

Resultado
El elemento final de control se desplaza hasta la posici√≥n de destino desde la posici√≥n de
inicio. La medici√≥n del tiempo se inicia de inmediato y finaliza en cuanto el elemento final de
control ha alcanzado la posici√≥n de destino. El tiempo de posicionamiento del motor se calcula
seg√∫n la f√≥rmula:
Tiempo de posicionamiento del motor = (L√≠mite superior del valor de salida - L√≠mite inferior del
valor de salida) x Tiempo de medici√≥n /VALOR ABSOLUTO(Posici√≥n de destino - Posici√≥n de
inicio).
Se muestran el progreso y el estado de la medici√≥n del tiempo de posicionamiento. El tiempo
de posicionamiento medido se muestra en el campo "Tiempo de actuaci√≥n medido". Una vez
finalizada la medici√≥n del tiempo de posicionamiento se conecta el modo manual de las

1056

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
se√±ales de posicionamiento (LMNSOPON = TRUE). El elemento final de control deja de
moverse.

Actuadores con se√±ales de tope
Para medir el tiempo de posicionamiento del motor con se√±ales de tope, proceda del siguiente
modo:
1. Elija el DB instancia para el que se debe medir el tiempo de posicionamiento del motor.
2. Active la casilla de verificaci√≥n "Utilizar se√±ales de tope del actuador".
3. Haga clic en el bot√≥n

"Iniciar medici√≥n tiempo de posicionamiento".

Resultado
El elemento final de control se mueve primero hasta el tope inferior, despu√©s, hasta el tope
superior y, de nuevo, hasta el tope inferior. La medici√≥n del tiempo se inicia cuando el actuador
ha alcanzado el tope inferior y finaliza cuando el actuador alcanza por segunda vez el tope
inferior. El tiempo medido dividido entre dos da lugar al tiempo de posicionamiento del motor.
Se muestran el progreso y el estado de la medici√≥n del tiempo de posicionamiento. El tiempo
de posicionamiento medido se muestra en el campo "Tiempo de actuaci√≥n medido". Una vez
finalizada la medici√≥n del tiempo de posicionamiento se conecta el modo manual de las
se√±ales de posicionamiento (LMNSOPON = TRUE). El elemento final de control deja de
moverse.

Cargar el tiempo de ajuste medido
1. Para guardar en el proyecto el tiempo de posicionamiento del motor medido, haga clic en
el s√≠mbolo
"Transfiere datos online al proyecto offline".
El tiempo de ajuste medido se guarda en el ajuste de par√°metros del FM.
2. Para que los cambios surtan efecto en el arranque siguiente de la CPU, haga clic en el
icono
"Cargar en dispositivo".

Cancelar medici√≥n del tiempo de posicionamiento
Si cancela la medici√≥n del tiempo de posicionamiento, el modo manual de las se√±ales de
posicionamiento se conecta (LMNSOPON = TRUE) y el modo manual con especificaci√≥n de
la variable manipulada se desconecta (LMNOP_ON = FALSE). El elemento final de control
deja de moverse.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1057

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3.5.5.5

FM 355: Diagn√≥stico a trav√©s de indicadores LED

Indicaci√≥n de errores mediante el LED de error de grupo
Introducci√≥n
Si el LED rojo de error de grupo se enciende, significa que se ha producido un error en el
m√≥dulo (error interno) o en las conexiones (error externo).
Si el LED amarillo parpadea, el firmware se borra. Este estado s√≥lo puede aparecer si existe
un defecto en el hardware o si el proceso de carga del firmware se cancela.

¬øQu√© errores se muestran?
Cuando se ilumina el LED de error de grupo se se√±alan los errores siguientes:
Tipo de
error

Aviso de diagn√≥stico

Errores in‚Äê M√≥dulo defectuoso
ternos
Vigilancia de tiempo
(watch dog) activado

Errores
externos

Causa posible

Soluci√≥n

Error de hardware

Cambie el m√≥dulo

Error de hardware

Cambie el m√≥dulo

Contenido EEPROM no
v√°lido

Fallo de la tensi√≥n de alimenta‚Äê
ci√≥n al parametrizar

Vuelva a parametrizar el
m√≥dulo

Par√°metro err√≥neo en el
m√≥dulo

Se han transferido par√°metros in‚Äê Vuelva a parametrizar el
correctos al m√≥dulo
m√≥dulo

Error en las entradas o las
salidas anal√≥gicas

Error de hardware en la entrada
anal√≥gica

Cambie el m√≥dulo

Rotura de hilo en la entrada ana‚Äê Solucione la rotura de hilo
l√≥gica
Rebase por defecto del rango de Revise la se√±al de medi‚Äê
medici√≥n en la entrada anal√≥gica ci√≥n
Rebase por exceso del rango de Revise la se√±al de medi‚Äê
medici√≥n en la entrada anal√≥gica ci√≥n
Rotura de hilo en la salida anal√≥‚Äê Solucione la rotura de hilo
gica
Cortocircuito en la salida anal√≥gi‚Äê Solucione el cortocircuito
ca
Falta tensi√≥n auxiliar ex‚Äê
terna

Fallo en la alimentaci√≥n 24 V

Restablezca la alimenta‚Äê
ci√≥n de 24 V

Alarma de diagn√≥stico en caso de error
Todos los errores pueden disparar una alarma de diagn√≥stico si √©sta se ha habilitado en la
pantalla de parametrizaci√≥n correspondiente. En los registros de diagn√≥stico DS0 y DS1
puede ver qu√© error ha provocado que se encienda el LED. La asignaci√≥n de los registros de
diagn√≥stico DS0 y DS1 est√° descrita en el siguiente apartado.

1058

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Disparo de alarmas de diagn√≥stico
¬øQu√© es una alarma de diagn√≥stico?
Si se quiere que un programa de usuario responda a un error interno o externo, se puede
parametrizar una alarma de diagn√≥stico que interrumpa el programa c√≠clico de la CPU y llame
al OB de alarma de diagn√≥stico (OB 82).

¬øQu√© eventos pueden disparar una alarma de diagn√≥stico?
La siguiente lista muestra qu√© eventos pueden disparar una alarma de diagn√≥stico:
‚óè M√≥dulo no parametrizado o errores en la parametrizaci√≥n
‚óè M√≥dulo defectuoso
‚óè Rotura de hilo en entradas anal√≥gicas (s√≥lo 4 a 20 mA)
‚óè Rebase por exceso y por defectos en entradas anal√≥gicas
‚óè Rotura de carga y cortocircuito en salidas anal√≥gicas

Ajuste por defecto
La alarma de diagn√≥stico est√° bloqueada de forma predeterminada.

Habilitaci√≥n de la alarma de diagn√≥stico
La pantalla "Par√°metros b√°sicos" permite bloquear o habilitar la alarma de diagn√≥stico para el
m√≥dulo.

Respuestas a un evento que dispara una alarma
Cuando se produce un evento que puede disparar una alarma de diagn√≥stico ocurre lo
siguiente:
‚óè La informaci√≥n de diagn√≥stico se registra en los registros de diagn√≥stico DS0 y DS1 del
m√≥dulo.
‚óè El LED de error de grupo se enciende.
‚óè Se llama al OB de alarma de diagn√≥stico (OB 82).
‚óè El registro de diagn√≥stico DS0 se graba en la informaci√≥n de arranque del OB de alarma de
diagn√≥stico.
‚óè Si no hay ning√∫n defecto de hardware, el m√≥dulo sigue regulando.
La CPU pasa a modo STOP si no se ha programado el OB 82.

Registro de diagn√≥stico DS0 y DS1
La informaci√≥n que indica qu√© evento ha provocado una alarma de diagn√≥stico se guarda en
los registros de diagn√≥stico DS0 y DS1. El registro de diagn√≥stico DS0 consta de cuatro bytes;
DS1 consta de 16 bytes, siendo los cuatro primeros id√©nticos a DS0.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1059

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Registros de diagn√≥stico DS0 y DS1
Leer el registro desde el m√≥dulo
El registro de diagn√≥stico DS0 se transfiere autom√°ticamente a la informaci√≥n de arranque en
la llamada del OB de diagn√≥stico. All√≠, estos cuatro bytes se guardan en los datos locales
(bytes 8-11) del OB 82.
El registro de diagn√≥stico DS1 se puede leer (y en consecuencia tambi√©n el contenido de DS0)
desde el m√≥dulo con la instrucci√≥n "CH_DIAG". Esta lectura s√≥lo tiene sentido si en el DS0 se
notifica un error en un canal.
La instrucci√≥n "CH_DIAG" debe llamarse en el mismo OB que el FB "PID_FM". Esto se
consigue con la medida siguiente: Ajuste un bit mientras el OB 82 se procesa. Consulte este
bit en el OB, en el que tambi√©n se llama el FB "PID_FM" y llame la instrucci√≥n "CH_DIAG" en
el bit definido.

¬øC√≥mo aparecen los textos de diagn√≥stico en el b√∫fer de diagn√≥stico?
Si se desea registrar el aviso de diagn√≥stico en el b√∫fer de diagn√≥stico, se debe llamar la
instrucci√≥n "WR_REC" "Introducir avisos espec√≠ficos de usuario en el b√∫fer de diagn√≥stico"
dentro del programa de usuario. En cada caso, el n√∫mero de evento del aviso de diagn√≥stico
se especifica en el par√°metro de entrada EVENTN. La alarma se introduce en el b√∫fer de
diagn√≥stico con x=1 como entrante y con x=0 como saliente. El b√∫fer de diagn√≥stico contiene
los textos de diagn√≥stico correspondientes en la columna de "Significado", as√≠ como el
momento en que se produjo la entrada.

1060

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Asignaci√≥n del registro de diagn√≥stico DS0 en la informaci√≥n de arranque
La tabla siguiente muestra la asignaci√≥n del registro de diagn√≥stico DS0 en la informaci√≥n de
arranque. Todos los bits que no se incluyen en la tabla son irrelevantes y tienen el valor cero.
Tabla 3-3
Byte
0

Asignaci√≥n del registro de diagn√≥stico DS0
Bit

Significado

Nota

N¬∫ de evento

0

Aver√≠a en m√≥dulo

Se activa en todos los eventos de diagn√≥stico

8:x:00

1

Error interno

Se activa en todos los errores internos:

8:x:01

‚óè Vigilancia de tiempo activada
‚óè Contenido de la EEPROM no v√°lido; el
m√≥dulo arranca sin regular y espera a que
la CPU realice una nueva parametrizaci√≥n
‚óè Error EPROM
‚óè Error ADC/DAC
‚óè Error de hardware en la entrada anal√≥gica
2

Error externo

Se activa en todos los errores externos:

8:x:02

‚óè Falta tensi√≥n auxiliar externa
‚óè Error de parametrizaci√≥n
‚óè Rotura de hilo en la entrada anal√≥gica (s√≥lo
en el margen 4 a 20 mA)
‚óè Rebase por defecto del rango de medici√≥n
en la entrada anal√≥gica
‚óè Rebase del rango de medici√≥n en la
entrada anal√≥gica
‚óè Rotura de hilo en la salida anal√≥gica
‚óè Cortocircuito en la salida anal√≥gica
3

Fallo en un canal

Consultar el DS1, a partir del byte 7, para m√°s
detalles

8:x:03

4

Falta tensi√≥n auxiliar
externa

Fallo en la alimentaci√≥n 24 V del FM 355

8:x:04

6

Contenido EEPROM
no v√°lido

Fallo de la tensi√≥n de alimentaci√≥n durante un
proceso de escritura en la EEPROM. El m√≥dulo
arranca con los par√°metros predeterminados.

8:x:03

7

Error de parametriza‚Äê El m√≥dulo no puede utilizar un par√°metro. Mo‚Äê
ci√≥n
tivo: Par√°metro desconocido o combinaci√≥n de
par√°metros no permitida.

8:x:07

Consulte el men√∫ Sistema de destino > Mostrar
errores de parametrizaci√≥n
1

0 ... 3

Clase de m√≥dulo

4

Diagn√≥stico espec√≠fi‚Äê Se activa cuando el m√≥dulo puede proporcio‚Äê
co de canal
nar informaci√≥n del canal adicional y hay un
error de canal (consulte DS1 bytes 7 a 12)

2

3

Vigilancia de tiempo Error de hardware
(watch dog) activado

8:x:33

3

2

Error EPROM

M√≥dulo defectuoso

8:x:42

4

Error ADC/DAC

M√≥dulo defectuoso

8:x:44

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Siempre tiene asignado un 8

‚Äì
‚Äì

1061

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Asignaci√≥n del registro de diagn√≥stico DS1
El registro de diagn√≥stico DS1 se compone de 16 bytes. Los 4 primeros bytes son id√©nticos a
los del registro de diagn√≥stico DS0. La siguiente tabla muestra la asignaci√≥n de los bytes
restantes. Todos los bits que no se incluyen en la tabla son irrelevantes y tienen el valor cero.
Tabla 3-4

Asignaci√≥n de los bytes del 4 a 12 del registro de diagn√≥stico DS1

Byte

Bit

Significado

Nota

N¬∫ de evento

4

0 ... 7

Tipo de canal

Siempre tiene asignado 75H

‚Äì

5

0 ... 7

Longitud de la informaci√≥n de
diagn√≥stico

Siempre tiene asignado un 8

‚Äì

6

0 ... 7

Cantidad de canales

Siempre tiene asignado un 5 (4 regu‚Äê
ladores + 1 canal de referencia)

‚Äì

7

0 ... 7

Vector de error de canal

Cada bit tiene asignado un canal

‚Äì

8

0

Error de hardware en la entra‚Äê Diagn√≥stico espe‚Äê
da anal√≥gica
c√≠fico del canal 1

8:x:B0

1

sin usar

8:x:B1

2

Rotura de hilo en la entrada
anal√≥gica (s√≥lo en el margen
4 a 20 mA)

8:x:B2

3

sin usar

8:x:B3

4

Rebase por defecto del rango
de medici√≥n en la entrada
anal√≥gica

8:x:B4

5

Rebase del rango de medi‚Äê
ci√≥n en la entrada anal√≥gica

8:x:B5

6

Rotura de hilo en la salida ana‚Äê
l√≥gica

S√≥lo en la salida
de intensidad
del regulador K

8:x:B6

7

Cortocircuito en la salida ana‚Äê
l√≥gica

S√≥lo en la salida
de tensi√≥n del
regulador K

8:x:B7

9

0 ... 7

V√©ase byte 8

Diagn√≥stico espec√≠fico del canal 2

v√©ase arriba

10

0 ... 7

v√©ase byte 8

Diagn√≥stico espec√≠fico del canal 3

v√©ase arriba

11

0 ... 7

v√©ase byte 8

Diagn√≥stico espec√≠fico del canal 4

v√©ase arriba

12

0 ... 5

v√©ase byte 8

Diagn√≥stico para el canal de referen‚Äê
cia

v√©ase arriba

Informaci√≥n adicional
Para obtener m√°s informaci√≥n sobre el par√°metro "RET_REALU", consulte Lista de los avisos
RET_REALU (P√°gina 1064) y el √°rea de instrucciones avanzadas del sistema de ayuda.

1062

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Fallo del transductor de medida
Aver√≠as en los transductores de medida
El m√≥dulo de regulaci√≥n puede detectar los siguientes fallos en el transductor de medida:
‚óè Rebase por defecto del rango de medici√≥n
‚óè Rebase del margen de medici√≥n
‚óè Rotura de hilo (no se muestra en todos los m√°rgenes de medici√≥n)
Si se produce una de estas aver√≠as en el registro de diagn√≥stico DS0 se define el bit de error
de grupo "Error externo" y, en el registro de diagn√≥stico DS1, bits de error espec√≠ficos del canal
(consulte las tablas en la secci√≥n anterior). Cuando desaparecen estas aver√≠as los bits
correspondientes se desactivan.
La siguiente tabla muestra los l√≠mites de los diferentes m√°rgenes de medici√≥n en los que los
bits de error se activan o desactivan:
Rango de medida

Bit de error Rebase por defec‚Äê
to del rango de medici√≥n en ...

Bit de error Rebase del rango
de medici√≥n en ...

Bit de error Mostrar rotura de hi‚Äê
lo

DS1: Byte 10 a 26, Bit 4

DS1: Byte 10 a 26, Bit 5

DS1: Byte 10 a 26, Bit 2

0 a 20 mA

< ‚Äì3,5 mA

> 23,5 mA

‚Äì

4 a 20 mA

Bit de error = 1 a < 3,6 mA

> 22,8 mA

Bit de error = 1 a < 3,6 mA

Bit de error = 0 a > 3,8 mA

Bit de error = 0 a > 3,8 mA

0 a 10 V

< ‚Äì1,175 V

> 11,75 V

‚Äì

Pt 100

< 30,82 mV

> 650,46 mV

‚Äì

< 30,82 mV

> 499,06 mV

‚Äì

< 30,82 mV

> 254,12 mV

‚Äì

Termoelemento tipo B

< 0 mV

> 13,81 mV

‚Äì

Termoelemento tipo J

< ‚Äì8,1 mV

> 69,54 mV

‚Äì

Termoelemento tipo K

< ‚Äì6,45 mV

> 54,88 mV

‚Äì

Termoelemento tipo R

< ‚Äì0,23 mV

> 21,11 mV

‚Äì

Termoelemento tipo S

< ‚Äì0,24 mV

> 18,7 mV

‚Äì

Termopar libre

< Valor de entrada inferior de
la l√≠nea poligonal

> Valor de entrada superior de
la l√≠nea poligonal

‚Äì

(‚Äì200 a 850 ¬∞C)
(‚Äì328 a 1562 ¬∞F)
Pt 100
(‚Äì200 a 556 ¬∞C)
(‚Äì328 a 1032 ¬∞F)
Pt 100
(‚Äì200 a 130 ¬∞C)
(‚Äì328 a 264 ¬∞F)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1063

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Lista de los avisos RET_REALU
Avisos RET_REALU

1064

JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

7000

28672

-32624

Primera llamada con REQ=0: No hay ninguna transferencia de
datos activa; BUSY tiene el valor 0.

7001

28673

-32624

Primera llamada con REQ=1: Transferencia de datos lanzada;
BUSY tiene el valor 1.

7002

28674

-32624

Llamada intermedia (REQ irrelevante). Transferencia de datos
ya activa; BUSY tiene el valor 1.

8090

32912

-32624

La direcci√≥n base l√≥gica indicada no es v√°lida: No existe nin‚Äê
guna asignaci√≥n en el SDB1/SDB2x, o no se trata de una di‚Äê
recci√≥n base.

80A0

32928

-32608

Acuse negativo al leer el m√≥dulo. M√≥dulo extra√≠do durante la
lectura o m√≥dulo defectuoso.

80A1

32929

-32607

Acuse negativo al escribir en el m√≥dulo. M√≥dulo extra√≠do du‚Äê
rante la escritura o m√≥dulo defectuoso.

80A2

32930

-32606

Error de protocolo para capa 2

80A3

32931

-32605

Error de protocolo en User-Interface / User

80A4

32932

-32604

Fallo de comunicaci√≥n en el bus K

80B1

32945

-32591

Indicaci√≥n de longitud err√≥nea. Par√°metro FM_TYPE del DB de
canal para el m√≥dulo utilizado no activado correctamente.

80B2

32946

-32590

El slot configurado no est√° ocupado.

80B3

32947

-32589

El tipo de m√≥dulo real no es igual al tipo de m√≥dulo te√≥rico.

80C0

32960

-32576

El m√≥dulo a√∫n no tiene preparados los datos que hay que leer.

80C1

32961

-32575

Los datos de una petici√≥n de escritura semejante todav√≠a no se
han procesado en el m√≥dulo.

80C2

32962

-32574

El m√≥dulo procesa de instante el n√∫mero m√°ximo posible de
peticiones.

80C3

32963

-32573

Los recursos necesarios (memoria, etc.) est√°n ocupados en
estos momentos.

80C4

32964

-32572

Error de comunicaci√≥n

80C5

32965

-32571

La periferia descentralizada no est√° disponible.

80C6

32966

-32570

Cancelaci√≥n de las clases de prioridad (rearranque normal o en
segundo plano)

8522

34082

-31454

DB del canal o DB de par√°metros demasiado corto. No se pue‚Äê
den leer los datos del DB. (petici√≥n de escritura).

8532

34098

-31438

El n√∫mero de DB del DB de par√°metros es demasiado grande.
(petici√≥n de escritura).

853A

34106

-31430

DB de par√°metros no presente. (petici√≥n de escritura).

8544

34116

-31420

Error en el en√©simo (n > 1) acceso de lectura a un DB tras
aparecer un error. (petici√≥n de escritura).

8723

34595

-30941

DB del canal o DB de par√°metros demasiado corto. No se pue‚Äê
den escribir los datos en el DB. (petici√≥n de lectura).

8730

34608

-30928

DB de par√°metros protegido contra escritura en la CPU. No se
pueden escribir los datos en el DB (petici√≥n de lectura)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

8732

34610

-30926

El n√∫mero de DB del DB de par√°metros es demasiado grande.
(petici√≥n de lectura).

873A

34618

-30918

DB de par√°metros no presente. (petici√≥n de lectura).

8745

34629

-30907

Error en el en√©simo (n > 1) acceso de escritura a un DB tras
aparecer un error. (petici√≥n de lectura).

80ff

33023

-32513

Indicaci√≥n de √≠ndice incorrecta en el bloque FMT_PAR

Los errores 80A2..80A4 as√≠ como 80Cx son temporales, es decir, se pueden eliminar tras un tiempo de
espera sin la intervenci√≥n del usuario. Los avisos con la estructura 7xxx indican situaciones temporales
de la comunicaci√≥n.

3.5.5.6

Proyectos de ejemplo de FM 355

3.5.6

Utilizaci√≥n del FM 355-2

3.5.6.1

Configuraci√≥n del FM 355-2

Configurar el hardware
Procedimiento
Para poder configurar el hardware debe haber creado previamente un proyecto donde pueda
guardar la parametrizaci√≥n. A continuaci√≥n se explican √∫nicamente los pasos m√°s importantes.
1. Inicie el TIA portal y abra la configuraci√≥n de dispositivos.
2. Seleccione un rack.
3. Seleccione un m√≥dulo de regulaci√≥n del cat√°logo de m√≥dulos.
4. Arrastre el m√≥dulo de regulaci√≥n hasta la posici√≥n correspondiente del rack.
5. Anote la direcci√≥n de entrada del m√≥dulo a partir de la tabla de configuraci√≥n, p. ej. 272.
El valor le√≠do se muestra en formato decimal.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1065

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3.5.6.2

Parametrizaci√≥n del FM 355-2

Par√°metros del m√≥dulo
Procedimiento
A trav√©s de la parametrizaci√≥n se configuran los par√°metros del m√≥dulo.
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
Seleccione en la ventana de inspecci√≥n la pesta√±a "Propiedades".
Resultado: Las propiedades se muestran en la ventana de inspecci√≥n.
2. Configure los par√°metros b√°sicos del m√≥dulo y el resto de par√°metros.
3. Configure los dem√°s par√°metros del bloque en la vista de configuraci√≥n.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".
5. Compile el proyecto con "Editar > Compilar".
6. Cargue los datos de parametrizaci√≥n en el estado de STOP de la CPU con "Online > Cargar
en dispositivo..."
Resultado: Los datos se encuentran en la memoria de la CPU y se transfieren desde √©sta
directamente al m√≥dulo.
7. Arranque la CPU.

Par√°metros de la entrada anal√≥gica
Evaluaci√≥n de la entrada anal√≥gica
Procedimiento
Para seleccionar un tipo de sensor proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Entrada anal√≥gica > Entrada [n¬∞] > Evaluaci√≥n de
la entrada anal√≥gica".
3. Defina los siguientes par√°metros:
‚Äì Tipo de sensor entrada anal√≥gica
La opci√≥n "Vigilancia de rotura de hilo" se habilita para diversos tipos de sensor. Se
puede activar la opci√≥n seg√∫n requerimiento.
‚Äì Temperatura de referencia
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

1066

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Funciones de filtro
Procedimiento
Para definir las funciones de filtro proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Entrada anal√≥gica > Entrada [n¬∞] > Funciones de
filtro".
3. Defina los siguientes par√°metros:
‚Äì Active la opci√≥n "Filtro de se√±al" para filtrar por una constante de tiempo.
Si la opci√≥n "Filtro de se√±al" se encuentra seleccionada se puede activar la constante de
tiempo del filtro.
‚Äì Constante de tiempo del filtro
Se puede activar solamente si la opci√≥n "Filtro de se√±al" se encuentra activada.
‚Äì Active la opci√≥n "Filtro de ra√≠z cuadrada" para linealizar la se√±al del sensor.
‚Äì Active la opci√≥n "Filtro de pol√≠gono" para linealizar la caracter√≠stica de la se√±al del
sensor.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Filtro de se√±al
Filtro de primer orden cuya respuesta temporal viene determinada por la constante de tiempo.

Filtro de ra√≠z cuadrada
Su finalidad es linealizar se√±ales de sensores que est√°n en relaci√≥n cuadrada con la magnitud
de proceso medida, en las cuales el valor real obedece a una magnitud f√≠sica.

Filtro de pol√≠gono
Su finalidad es linealizar caracter√≠sticas de sensores.
Los 13 nodos seleccionables se pueden seleccionar en:
‚óè mA en entrada de corriente
‚óè mV en entrada de tensi√≥n

Normalizaci√≥n
Procedimiento
Para convertir la se√±al de entrada en una unidad f√≠sica proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Entrada anal√≥gica > Entrada [n¬∞] > Normalizaci√≥n".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1067

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Defina los siguientes par√°metros:
‚Äì Valor superior
‚Äì Valor inferior
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Normalizaci√≥n
Para convertir la se√±al de entrada en otra unidad f√≠sica mediante interpolaci√≥n lineal entre el
valor inicial (valor inferior) y el valor final (valor superior).

Error de regulaci√≥n
Realizar un regulador de valor fijo o en cascada
Regulador de valor fijo o en cascada
En las estructuras de regulaci√≥n 'Regulador de valor fijo o en cascada' el valor real efectivo es
id√©ntico al valor real A.

Seleccionar el tipo de regulador
Para realizar un regulador de valor fijo o en cascada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞]".
3. En el √°rea "Tipo de regulador" seleccione la opci√≥n "Regulador de valor fijo o en cascada".
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para acondicionar la consigna proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".

1068

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Active los par√°metros correspondientes en las diferentes √°reas:
‚Äì Origen de la consigna
Seleccione el origen de la consigna.
‚Äì Consigna de seguridad
Ajuste aqu√≠ la consigna de seguridad. Defina asimismo la reacci√≥n a un fallo de la CPU
y el comportamiento en arranque.
‚Äì Rampa de consigna
Defina el tiempo de subida de rampa.
‚Äì L√≠mite de consigna
Seleccione aqu√≠ los l√≠mites superior e inferior de consigna.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Seleccionar origen de la se√±al para el valor real A
Para seleccionar el origen de la se√±al para el valor real A proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. Seleccione el origen correspondiente en el √°rea "Variable manipulada". Se dispone de las
siguientes opciones:
‚Äì Cero
‚Äì Entrada anal√≥gica acondicionada
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Realizar un regulador de 3 componentes
Regulador de 3 componentes
En la estructura de regulaci√≥n 'Regulador de 3 componentes', el valor real efectivo se define
a trav√©s de la suma de los tres valores reales A, B y C, y mediante adici√≥n de un Offset
ajustable. Los valores reales B y C se pueden evaluar adicionalmente mediante factores.

Seleccionar el tipo de regulador
Para materializar un regulador de tres componentes, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞]".
3. En el √°rea "Tipo de regulador" seleccione la opci√≥n "Regulador de 3 componentes".
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1069

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Acondicionamiento de la consigna
Para ajustar c√≥mo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. Seleccione en el √°rea "Origen de la consigna" el origen de referencia de la consigna.
4. Especifique un valor en el √°rea "Consigna de seguridad", el cual ser√° tomado como
consigna de seguridad en caso de fallo de la CPU y durante el arranque.
5. Especifique el comportamiento del m√≥dulo de regulaci√≥n v√°lido como "Reacci√≥n a fallo de
la CPU" y para el "Comportamiento en arranque". Las opciones posibles son:
‚Äì Consigna = √∫ltima consigna v√°lida: al producirse el evento se asigna a la consigna la
√∫ltima consigna v√°lida. Es decir, se mantiene la √∫ltima consigna v√°lida.
‚Äì Consigna = consigna de seguridad: al producirse el evento se asigna a la consigna la
consigna de seguridad. De esta forma se puede realizar un funcionamiento de
emergencia seguro.
6. Especifique en el √°rea "Rampa de consigna" el tiempo de rampa que se debe mantener al
modificarse la consigna, para evitar una sobreoscilaci√≥n.
7. Especifique en el √°rea "L√≠mite de consigna" un l√≠mite superior e inferior para la consigna.
8. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Seleccionar el origen de la se√±al para los valores reales A, B y C
Para especificar los or√≠genes de la se√±al para los valores reales A, B y C proceda del siguiente
modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. Seleccione en el √°rea "Variable maniuplada" el origen de la se√±al correspondiente para
cada valor real. Puede seleccionar si no utiliza ninguna se√±al ("cero") como origen o si
utiliza una de las entradas anal√≥gicas acondicionadas.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Registrar factores para los valores reales B y C, as√≠ como para el Offset
Para especificar los or√≠genes de la se√±al para los valores reales A, B y C proceda del siguiente
modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. Especifique en el √°rea "Sumar" el factor de ponderaci√≥n requerido para los valores actuales
B y C.
4. Especifique el "Offset" necesario que se debe adicionar a los valores reales.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

1070

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Realizar un regulador de relaci√≥n o mezcla
Seleccionar el tipo de regulador
Para materializar un regulador de relaci√≥n o de mezcla, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞]".
3. En el √°rea "Tipo de regulador" seleccione la opci√≥n "Regulador de relaci√≥n o mezcla".
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para ajustar c√≥mo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. Seleccione en el √°rea "Origen de la consigna" el origen de referencia de la consigna.
4. Especifique un valor en el √°rea "Consigna de seguridad", el cual ser√° tomado como
consigna de seguridad en caso de fallo de la CPU y durante el arranque.
5. Especifique el comportamiento del m√≥dulo de regulaci√≥n v√°lido como "Reacci√≥n a fallo de
la CPU" y para el "Comportamiento en arranque". Las opciones posibles son:
‚Äì Consigna = √∫ltima consigna v√°lida: al producirse el evento se asigna a la consigna la
√∫ltima consigna v√°lida. Es decir, se mantiene la √∫ltima consigna v√°lida.
‚Äì Consigna = consigna de seguridad: al producirse el evento se asigna a la consigna la
consigna de seguridad. De esta forma se puede realizar un funcionamiento de
emergencia seguro.
6. Especifique en el √°rea "Rampa de consigna" el tiempo de rampa que se debe mantener al
modificarse la consigna, para evitar una sobreoscilaci√≥n.
7. Especifique en el √°rea "L√≠mite de consigna" un l√≠mite superior e inferior para la consigna.
8. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Seleccionar origen de la se√±al para los valores reales A y D
Para especificar los or√≠genes de la se√±al para los valores reales A y D proceda del siguiente
modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. Seleccione en el √°rea "Variable manipulada" el origen de la se√±al correspondiente para
cada valor real. Puede especificar no utilizar ninguna se√±al ("cero") como origen o utilizar
una de las entradas anal√≥gicas acondicionadas, para el valor real D puede seleccionar
tambi√©n el valor manipulado de uno de los reguladores.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1071

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Registrar multiplicador
Para especificar los or√≠genes de la se√±al para los valores reales A y D proceda del siguiente
modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. Seleccione en el √°rea "Multiplicar" el Offset deseado.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".
En el regulador de relaci√≥n, el valor real A se utiliza como magnitud de regulaci√≥n y el valor real
D como magnitud de relaci√≥n. La entrada de consigna sirve de factor de relaci√≥n. √âsta se
acondiciona para obtener una consigna efectiva mediante multiplicaci√≥n por el valor real D y
adici√≥n de un offset ajustable. Si se desactiva el valor real D, solamente se suma el Offset a la
consigna.

Ajustar la generaci√≥n de alarmas
Procedimiento
Para ajustar la generaci√≥n de alarma, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. En el √°rea "Generar alarma" seleccione las opciones necesarias:
‚Äì En el √°rea "Avisador de valor l√≠mite de" seleccione la se√±al a la que se debe aplicar la
alarma.
‚Äì En "Alarma l√≠mite superior" especifique el valor a partir del cual se disparar√° la alarma
al alcanzarse el l√≠mite superior.
‚Äì En "Advertencia l√≠mite superior" especifique el valor a partir del cual se disparar√° una
advertencia cuando se produzca una aproximaci√≥n al l√≠mite superior.
‚Äì En "Advertencia l√≠mite inferior" especifique el valor a partir del cual se disparar√° una
advertencia cuando se produzca una aproximaci√≥n al l√≠mite inferior.
‚Äì En "Alarma l√≠mite inferior" especifique el valor a partir del cual se disparar√° la alarma al
alcanzarse el l√≠mite inferior.
‚Äì Para evitar que centelleen los indicadores de vigilancia se puede configurar una
hist√©resis en "Hist√©resis".
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

1072

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Algoritmo de regulaci√≥n
Realizar una regulaci√≥n P
Procedimiento
Para realizar una regulaci√≥n P proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. En el √°rea "Tipo" seleccione la opci√≥n "Regulador PID".
4. En el √°rea "General" seleccione la opci√≥n "P", en "Modo de operaci√≥n".
Todas las opciones parametrizables para una regulaci√≥n P se activan, el resto de opciones
se desactivan.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Realizar una regulaci√≥n PI
Procedimiento
Para realizar una regulaci√≥n PI proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. En el √°rea "Tipo" seleccione la opci√≥n "Regulador PID".
4. En el √°rea "General" seleccione la opci√≥n "PI", en "Modo de operaci√≥n".
Todas las opciones parametrizables para una regulaci√≥n PI se activan, el resto de opciones
se desactivan.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Realizar una regulaci√≥n I
Procedimiento
Para realizar una regulaci√≥n I proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. En el √°rea "Tipo" seleccione la opci√≥n "Regulador PID".
4. En el √°rea "General" seleccione la opci√≥n "I", en "Modo de operaci√≥n".
Todas las opciones parametrizables para una regulaci√≥n I se activan, el resto de opciones
se desactivan.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1073

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Realizar una regulaci√≥n PID
Procedimiento
Para realizar una regulaci√≥n PID proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. En el √°rea "Tipo" seleccione la opci√≥n "Regulador PID".
4. En el √°rea "General" seleccione la opci√≥n "PID", en "Modo de operaci√≥n".
Todas las opciones parametrizables para una regulaci√≥n PID se activan, el resto de
opciones se desactivan.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Realizar una regulaci√≥n PD
Procedimiento
Para realizar una regulaci√≥n PD proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. En el √°rea "Tipo" seleccione la opci√≥n "Regulador PID".
4. En el √°rea "General" seleccione la opci√≥n "PD", en "Modo de operaci√≥n".
Todas las opciones parametrizables para una regulaci√≥n PD se activan, el resto de
opciones se desactivan.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Realizar un regulador de temperatura con l√≥gica difusa
Procedimiento
Para realizar una regulaci√≥n P proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. En el √°rea "Tipo" seleccione la opci√≥n "M√≥dulo de regulaci√≥n de temperatura por l√≥gica
difusa".
Todas las opciones parametrizables para m√≥dulo de regulaci√≥n de temperatura por l√≥gica
difusa se activan, el resto de opciones se desactivan.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

1074

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Suprimir el nivel de ruido del error de regulaci√≥n
Procedimiento
Para suprimir el nivel de ruido del error de regulaci√≥n proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. Especifique en el √°rea "General" el ajuste "Ancho de zona muerta".
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Control anticipativo
Procedimiento
Para conectar una variable perturbadora para control anticipativo proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. En el √°rea "General" seleccione de la lista "Origen de la perturbaci√≥n" el origen de la
variable perturbadora.
Seleccione la entrada "Cero" para no conectar ninguna variable perturbadora para control
anticipativo.
4. En "Factor de perturbaci√≥n" especifique un valor de ponderaci√≥n para la variable
perturbadora.
Un valor < 0 debilita la perturbaci√≥n, un valor > 0 amplifica la perturbaci√≥n. La perturbaci√≥n
permanece invariable si se especifica el valor 1.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Poner la acci√≥n P en rama de realimentaci√≥n
Procedimiento
Para realizar un regulador de valor fijo o en cascada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. En el √°rea "Acci√≥n P" seleccione la opci√≥n "Por rama de realimentaci√≥n".
Si la opci√≥n est√° activada, la acci√≥n P queda configurada por rama de realimentaci√≥n.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1075

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Debilitar la acci√≥n D cuando se producen modificaciones en la consigna
Seleccionar el tipo de regulador
Para realizar un regulador de valor fijo o en cascada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. En el √°rea "Acci√≥n D" seleccione con opci√≥n "Acci√≥n D" el origen de la acci√≥n D.
4. En el √°rea "Factor derivativo" especifique el factor para la acci√≥n D.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Invertir el efecto del regulador
Principio
La inversi√≥n del regulador, cambiando la asignaci√≥n de "error de regulaci√≥n ascendente =
magnitud manipulada ascendente" a "error de regulaci√≥n ascendente = magnitud manipulada
descendente", se realiza ajustando una ganancia proporcional (GAIN).

Procedimiento
Para invertir el efecto del regulador proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Algoritmo de regulaci√≥n".
3. Especifique en el √°rea "General" una ganancia proporcional con signo inverso.
Si se encuentra especificada una ganancia proporcional positiva y se desea invertir el
efecto del regulador, especifique una ganancia proporcional negativa.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Salida del regulador
Realizar un regulador continuo
Para realizar un regulador continuo se requiere un m√≥dulo anal√≥gico.

Procedimiento
1. Aplicar una variable manipulada externa (P√°gina 1078)
2. Ajustar la variable manipulada de seguridad (P√°gina 1079)
3. Activar el modo de seguimiento (P√°gina 1078)
4. Limitar la variable manipulada (P√°gina 1080)

1076

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
5. Controlar dos actuadores - rango partido (P√°gina 1080)
6. Seleccionar la se√±al de salida y el tipo de se√±al (P√°gina 1081)

Regulador paso a paso sin realimentaci√≥n de posici√≥n
Para realizar un regulador paso a paso sin realimentaci√≥n de posici√≥n se requiere un m√≥dulo
digital.

Procedimiento
1. Seleccionar la salida del regulador Regulador paso a paso sin realimentaci√≥n de posici√≥n
2. Aplicar una variable manipulada externa (P√°gina 1078)
3. Ajustar la variable manipulada de seguridad (P√°gina 1079)
4. Formador de impulsos de la regulaci√≥n paso a paso (P√°gina 1080)

Realizar un regulador paso a paso con realimentaci√≥n de posici√≥n
Para realizar un regulador paso a paso con realimentaci√≥n de posici√≥n se requiere un m√≥dulo
digital.

Procedimiento
1. Seleccionar la salida del regulador Regulador paso a paso con realimentaci√≥n de posici√≥n
2. Aplicar una variable manipulada externa (P√°gina 1078)
3. Activar el modo de seguimiento (P√°gina 1078)
4. Ajustar la variable manipulada de seguridad (P√°gina 1079)
5. Limitar la variable manipulada (P√°gina 1080)
6. Ajustar la realimentaci√≥n de posici√≥n (P√°gina 1079)
7. Formador de impulsos de la regulaci√≥n paso a paso (P√°gina 1080)

Realizar un regulador de impulsos
Para realizar un regulador de impulsos se requiere un m√≥dulo digital.

Procedimiento
1. Seleccionar la salida del regulador Regulador de impulsos
2. Aplicar una variable manipulada externa (P√°gina 1078)
3. Activar el modo de seguimiento (P√°gina 1078)
4. Ajustar la variable manipulada de seguridad (P√°gina 1079)
5. Limitar la variable manipulada (P√°gina 1080)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1077

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
6. Acondicionar la se√±al anal√≥gica para la conversi√≥n en se√±al digital
7. Convertir una se√±al anal√≥gica en una se√±al digital (P√°gina 1081)

Parametrizar las funciones de la salida del regulador
Aplicar una variable manipulada externa
Procedimiento
Para aplicar la magnitud manipulada externa proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Salida del regulador".
3. Seleccione en el √°rea "Magnitud manipulada externa" la opci√≥n que debe activar la
magnitud manipulada externa. Para ello puede seleccionar las siguientes opciones:
‚Äì Activaci√≥n del bloque de funci√≥n.
‚Äì Activaci√≥n del bloque de funci√≥n o de una de las entradas digitales.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Activar el modo de seguimiento
Procedimiento
Para activar el modo de seguimiento proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Salida del regulador".
3. Seleccione en el √°rea "Modo de seguimiento" la opci√≥n que debe activar la magnitud
manipulada externa. Para ello puede seleccionar las siguientes opciones:
‚Äì Activaci√≥n del bloque de funci√≥n.
‚Äì Activaci√≥n del bloque de funci√≥n o de una de las entradas digitales.
4. Seleccione en el √°rea "Modo de seguimiento" el origen de la se√±al a aplicar para el
seguimiento. Para ello puede seleccionar las siguientes opciones:
‚Äì Cero, con lo cual no se emplea ning√∫n origen.
‚Äì Una de las entradas anal√≥gicas.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

1078

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Ajustar la realimentaci√≥n de posici√≥n
Procedimiento
Para ajustar la realimentaci√≥n de posici√≥n proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Salida digital > Salida [n¬∞]".
3. Seleccione en el √°rea "Entrada de realimentaci√≥n de posici√≥n" la opci√≥n "Origen" para
especificar la se√±al de realimentaci√≥n de posici√≥n.
‚Äì Cero: no se produce ninguna realimentaci√≥n de posici√≥n.
‚Äì Una de las entradas anal√≥gicas acondicionadas.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Ajustar la variable manipulada de seguridad
Procedimiento
Para ajustar la variable manipulada de seguridad proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Salida del regulador".
3. Especifique en el √°rea "Variable manipulada de seguridad" el valor a utilizar como variable
manipulada de seguridad.
4. Seleccione en el √°rea "Activaci√≥n" la opci√≥n que debe activar la magnitud manipulada
externa. Para ello puede seleccionar las siguientes opciones:
‚Äì Activaci√≥n del bloque de funci√≥n.
‚Äì Activaci√≥n del bloque de funci√≥n o de una de las entradas digitales.
5. Seleccione en "Reacci√≥n al arrancar el m√≥dulo" la opci√≥n a ejecutar al arrancar el m√≥dulo.
Para ello puede seleccionar las siguientes opciones:
‚Äì Lazo cerrado: el m√≥dulo entra inmediatamente en este modo al arrancar.
‚Äì Variable manipulada de seguridad: primero se regula a la variable manipulada de
seguridad.
6. Seleccione en el √°rea "Reacci√≥n si falla el transductor de medida del valor real A" la opci√≥n
a ejecutar si falla el transductor de medida del valor real A.
7. Seleccione en el √°rea "Reacci√≥n si falla el transductor de medida de una entrada" la opci√≥n
a ejecutar si falla el transductor de medida de una entrada.
8. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1079

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Limitar la variable manipulada
Procedimiento
Para limitar la variable manipulada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Salida del regulador".
3. Especifique en el √°rea "L√≠mite de se√±al de salida" los siguientes valores:
‚Äì Valor superior: representa el l√≠mite superior para la se√±al de salida.
‚Äì Valor inferior: representa el l√≠mite interior para la se√±al de salida.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Controlar dos actuadores - rango partido
Procedimiento
Para controlar dos actuadores proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Salida del regulador".
3. Seleccione en el √°rea "Rango partido" la opci√≥n "Activar" para controlar dos actuadores.
4. Especifique los siguientes valores, para las se√±ales de entrada y salida A y tambi√©n para
las entradas de entrada y salida B.
‚Äì Se√±al de entrada inferior.
‚Äì Se√±al de entrada superior.
‚Äì Se√±al de salida inferior.
‚Äì Se√±al de salida superior.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Formador de impulsos de la regulaci√≥n paso a paso
Procedimiento
Para parametrizar el formador de impulsos proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Salida digital > Salida [n¬∞]".

1080

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Especifique en el √°rea "Formador de impulsos" los siguientes par√°metros:
‚Äì Tiempo de posicionamiento del motor.
‚Äì Duraci√≥n m√≠nima de impulso.
‚Äì Duraci√≥n m√≠nima de pausa.
4. Seleccione la opci√≥n adecuada para los valores superior e inferior, a partir de la cual se
aplicar√° el valor:
‚Äì del bloque de funci√≥n.
‚Äì Del bloque de funci√≥n o de una de las entradas digitales.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Convertir una se√±al anal√≥gica en una se√±al digital
Procedimiento
Para convertir una se√±al anal√≥gica en una se√±al digital proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Salida digital > Canal [n¬∞]".
3. Especifique en el √°rea "Formador de impulsos" los siguientes par√°metros:
‚Äì Duraci√≥n m√≠nima de impulso.
‚Äì Duraci√≥n m√≠nima de pausa.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Seleccionar la se√±al de salida y el tipo de se√±al
Procedimiento
Para seleccionar la se√±al de salida y el tipo de se√±al proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Salida anal√≥gica > Salida [n¬∞]".
3. Seleccione en la opci√≥n "Origen" la se√±al a utilizar como se√±al de salida. Se dispone de las
siguientes opciones:
‚Äì Cero: ning√∫n origen para la se√±al de salida.
‚Äì Una de las entradas anal√≥gicas.
‚Äì Uno de los valores manipulados para el regulador A o B.
4. Seleccione en la opci√≥n "Tipo de se√±al" el tipo de se√±al en que se emitir√° la se√±al de salida.
5. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1081

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3.5.6.3

Puesta en servicio del FM 355-2

Crear y configurar un DB de instancia
Crear y configurar un DB de instancia
1. Cree un programa de usuario que efect√∫e c√≠clicamente una llamada a la instrucci√≥n
FMT_PID.
2. En el programa del usuario, ponga READ_OUT c√≠clicamente a TRUE.
3. Genere para cada canal del regulador un DB de instancia de la instrucci√≥n FMT_PID.
4. Para cada DB de instancia, introduzca la direcci√≥n de m√≥dulo en el par√°metro MOD_ADDR.
Utilice como direcci√≥n de m√≥dulo del FM 355-2 la direcci√≥n inicial que ha especificado al
configurar el hardware.
5. Introduzca en el par√°metro FMT_PID.CHANNEL el n√∫mero del canal del regulador (0, 1, 2
o 3).
1. Si utiliza las instrucciones FMT_PAR y FMT_TUN, introduzca en los par√°metros
FMT_PAR.CHANNEL y FMT_TUN.CHANNEL el n√∫mero del canal del regulador.
2. Compruebe que est√© activado el "Tipo de sensor Entrada anal√≥gica" del canal en cuesti√≥n.
Si no se procesa la entrada anal√≥gica, todos los par√°metros PID se ajustan a cero, y no se
calcula ninguna variable manipulada.
Nota
DBs multiinstancia
Si utiliza DBs multiinstancia en su proyecto, los FM se deben poner en servicio a trav√©s de
una tabla de observaci√≥n.

Puesta en servicio del regulador
Introducci√≥n
Los par√°metros PID se pueden optimizar del modo siguiente:
‚óè Optimizaci√≥n inicial
‚óè Optimizaci√≥n fina de la calefacci√≥n
‚óè Optimizaci√≥n fina de la refrigeraci√≥n
‚óè Optimizaci√≥n fina manual

Procedimiento
Para optimizar un regulador, proceda del siguiente modo:
1. Coloque la CPU en el estado RUN.
2. Al utilizar un regulador S se mide el tiempo de posicionamiento del motor.

1082

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Realice una optimizaci√≥n del regulador.
4. Observe el lazo de regulaci√≥n con el registrador de curvas.

Posibilidades de optimizaci√≥n del regulador
Optimizaci√≥n inicial
Durante esta optimizaci√≥n, el punto de operaci√≥n del estado fr√≠o se pone en marcha a trav√©s
de un escal√≥n de consigna.
Con TUN_ON = TRUE, cree la disposici√≥n de optimizaci√≥n. El regulador cambia de PHASE = 0
a PHASE = 1.
3+$6( 

3+$6( 

3+$6(


3+$6( 

3+$6( 

63

r&
/01

(VWDGRGH
SURFHVR
HQFDOLHQWH
SXQWRGH
WUDEDMR

39
781B'/01
3XQWRGH
LQYHUVL¬µQ

/01

(VWDGRGH
SURFHVRHQ
IU¬ØR
W
781B21
W

La variable manipulada de la optimizaci√≥n (LMN0 + TUN_DLMN) se aplica mediante
modificaci√≥n de la consigna (transici√≥n PHASE 1 -> 2). La consigna no es efectiva hasta que
se alcanza el punto de inversi√≥n (s√≥lo entonces se conmutar√° al modo Autom√°tico).
El delta de la excitaci√≥n manipulada (TUN_DLMN) se define de acuerdo con la modificaci√≥n
admisible del valor real bajo responsabilidad propia. El signo de TUN_DLMN debe estar en
concordancia con la modificaci√≥n prevista del valor real (observar el sentido de regulaci√≥n).
El escal√≥n de consigna y TUN_DLMN deben estar coordinados. Un TUN_DLMN demasiado
grande conlleva el peligro de que el punto de inversi√≥n no est√© dentro del 75% del escal√≥n de
consigna.
Sin embargo, TUN_DLMN debe ser lo suficientemente grande como para que el valor real
alcance como m√≠nimo el 22% del escal√≥n de consigna. En caso contrario, el procedimiento
permanece en modo Optimizaci√≥n (fase 2).

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1083

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Soluci√≥n: reduzca la consigna durante la b√∫squeda del punto de inversi√≥n.
Nota
En procesos con un fuerte retardo, es aconsejable definir para la optimizaci√≥n una consigna de
destino un poco m√°s baja que el punto de operaci√≥n deseado y observar con detenimiento los
bits de estado y el PV (peligro de sobreoscilaciones).
Optimizaci√≥n √∫nicamente en el rango lineal:
Determinados sistemas regulados (p. ej., calderas de fusi√≥n de zinc o magnesio) pasan por un
rango no lineal poco antes del punto de operaci√≥n (modificaci√≥n del estado de agregaci√≥n).
Si se selecciona con habilidad el escal√≥n de consigna es posible limitar la optimizaci√≥n al rango
lineal. Si el valor real ha pasado del 75% del escal√≥n de consigna (SP_INT-PV0), la
optimizaci√≥n concluye.
Paralelamente, TUN_DLMN deber√≠a reducirse hasta que el punto de inversi√≥n se encuentre
con seguridad antes de alcanzar el 75% del escal√≥n de consigna.

Optimizaci√≥n fina de la calefacci√≥n
Durante esta optimizaci√≥n, el proceso se excita, en caso de una consigna constante, mediante
un salto de la variable manipulada.

r&
/01

3+$6( 

3+$6( 

7LSRGHVLVWHPD, 3+$6( 
3+$6(
 7LSRGHVLVWHPD,,R,,, 3+$6( 

3+$6( 

39
9DORUUHDOGHOSXQWRGH
RSHUDFL¬µQ

3XQWRGH
LQYHUVL¬µQ
63

781B'/01

781B21

/01

VHGHVDFWLYD
DXWRP¬£WLFDPHQWH

9DORUPDQLSXODGRGHOSXQWRGH
RSHUDFL¬µQ

W

W
781B67
W

1084

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
La variable manipulada de la optimizaci√≥n (LMN0 + TUN_DLMN) se aplica mediante activaci√≥n
del bit de inicio TUN_ST (transici√≥n fase 1 -> 2). Si se modifica la consigna, la nueva consigna
no es efectiva hasta que no se alcanza el punto de inversi√≥n (s√≥lo entonces se conmuta al
modo Autom√°tico).
El delta de la excitaci√≥n manipulada (TUN_DLMN) se define de acuerdo con la modificaci√≥n
admisible del valor real bajo responsabilidad propia. El signo de TUN_DLMN debe estar en
concordancia con la modificaci√≥n prevista del valor real (observar el sentido de regulaci√≥n).
ATENCI√ìN
Si la excitaci√≥n se realiza mediante TUN_ST no se produce ninguna desconexi√≥n de
seguridad al 75%. La optimizaci√≥n finaliza cuando se alcanza el punto de inversi√≥n. Sin
embargo, en procesos con ruidos es posible que se sobrepase claramente el punto de
inversi√≥n.

Optimizaci√≥n fina de la refrigeraci√≥n
Durante esta optimizaci√≥n, el proceso se excita, en caso de una consigna constante, mediante
un salto de la variable manipulada.
r&
/01

3+$6( 

3+$6( 

39

7LSRGHVLVWHPD, 3+$6( 
3+$6(
 7LSRGHVLVWHPD,,R,,, 3+$6( 

63

9DORUUHDOGHOSXQWRGH
RSHUDFL¬µQ

3XQWRGH
LQYHUVL¬µQ

/01
9DORUPDQLSXODGRGHOSXQWRGH
RSHUDFL¬µQ

781B&/01

VHGHVDFWLYD
DXWRP¬£WLFDPHQWH

781B21

3+$6( 

W

W
781B&67
W

La variable manipulada de la optimizaci√≥n (LMN0 + TUN_CLMN) se aplica mediante la
activaci√≥n del bit de inicio TUN_CST (transici√≥n fase 1 -> 2). Entretanto, la variable manipulada
determinada anteriormente LMN0 se mantiene constante y TUN_CLMN se aplica
directamente en la funci√≥n de rango dividido, por lo que s√≥lo se modifica la potencia de
refrigeraci√≥n. TUN_CST se vuelve a desactivar de inmediato.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1085

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Si modifica la consigna durante la fase 2, la nueva consigna no es efectiva hasta que se
alcance el punto de inversi√≥n (s√≥lo entonces se pasa al modo autom√°tico).
El delta de la excitaci√≥n manipulada (TUN_CLMN) se define de acuerdo con la modificaci√≥n
admisible del valor real bajo responsabilidad propia. El signo de TUN_CLMN debe estar en
concordancia con la modificaci√≥n prevista del valor real (observar el sentido de regulaci√≥n).
Tenga en cuenta que un TUN_CLMN negativo provoca un aumento de la potencia de
refrigeraci√≥n. No obstante, con TUN_CLMN > 0.0 tambi√©n se puede aplicar un escal√≥n de la
variable manipulada reduciendo la potencia de refrigeraci√≥n.
ATENCI√ìN
Si la excitaci√≥n se realiza mediante TUN_CST no se produce ninguna desconexi√≥n de
seguridad al 75%. La optimizaci√≥n finaliza cuando se alcanza el punto de inversi√≥n. Sin
embargo, en procesos con ruidos es posible que se sobrepase claramente el punto de
inversi√≥n.
Funci√≥n de rango dividido
En la optimizaci√≥n, la pendiente de la funci√≥n de rango dividido se atribuye al proceso. Si
modifica la pendiente de la funci√≥n de rango dividido despu√©s de la optimizaci√≥n, tambi√©n debe
adaptar en consecuencia el par√°metro del regulador GAIN o RATIOFAC.

Optimizaci√≥n fina manual en modo de regulaci√≥n
Para conseguir un comportamiento de consigna sin sobreoscilaciones, pueden tomarse las
medidas siguientes:
‚óè Adaptar la zona de regulaci√≥n
‚óè Optimizar el comportamiento de referencia
‚óè Amortiguar los par√°metros de regulaci√≥n
‚óè Modificar los par√°metros de regulaci√≥n

Optimizaci√≥n autom√°tica
Requisitos del proceso
R√©gimen transitorio
El proceso debe presentar un r√©gimen transitorio estable, con retardo y asint√≥tico.
Despu√©s de un salto de la magnitud manipulada, el valor real debe pasar a un estado
estacionario. Con ello se excluyen procesos que presentan un comportamiento oscilante
incluso sin regulaci√≥n, as√≠ como procesos regulados sin compensaci√≥n (integrador en el
proceso regulado).

1086

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Consolidaci√≥n de un estado inicial cuasi-estacionario (fase 0)
Si el valor real presenta oscilaciones de baja frecuencia, p. ej., debido a unos par√°metros del
regulador incorrectos, antes de iniciar la optimizaci√≥n se debe situar el regulador en modo
manual y esperar a que desaparezcan las oscilaciones. Alternativamente, tambi√©n puede
conmutar a un regulador PI con ganancia proporcional peque√±a y periodo de integraci√≥n
grande.
Ahora deber√° esperar hasta que se alcance el estado estacionario, es decir, hasta que el valor
real y la variable manipulada sean estacionarios. Tambi√©n est√° permitido un r√©gimen
transitorio asint√≥tico o un desplazamiento lento del valor real (estado cuasi-estacionario,
consulte la figura siguiente). La magnitud manipulada debe ser constante u oscilar alrededor
de un valor medio constante.
Nota
Evite modificar la magnitud manipulada justo antes del inicio de la optimizaci√≥n. La variable
manipulada tambi√©n se puede modificar de manera involuntaria al alterar las condiciones de
ensayo (p. ej., cerrar una puerta abierta). Si este fuera el caso, deber√° esperar como m√≠nimo
a que el valor real experimente de nuevo un r√©gimen transitorio de forma asint√≥tica a un estado
estacionario No obstante, conseguir√° mejores par√°metros de regulaci√≥n, si espera hasta que
el proceso de r√©gimen transitorio haya finalizado completamente.
En la siguiente figura, se muestra el r√©gimen transitorio al estado estacionario:
39

9DORUUHDO

(VWDGRQRHVWDFLRQDULR
QRSHUPLWLGR

3+$6( 

3+$6( 

(VWDGRFXDVLHVWDFLRQDULR
D¬ºQSHUPLWLGR

(VPHMRUXQHVWDGR
HVWDFLRQDULRHVWDELOL]DGR

39

W

/01

9DORUPDQLSXODGR
,PSXOVRGHOYDORUPDQLSXODGR
/01

W

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1087

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Linealidad y zona de trabajo
El proceso debe presentar un comportamiento lineal en la zona de trabajo. Un comportamiento
no lineal se produce, p. ej., con un cambio de un estado de agregaci√≥n. La optimizaci√≥n debe
tener lugar en una parte lineal de la zona de trabajo.
Esto significa que, tanto para la optimizaci√≥n como para el modo de regulaci√≥n normal, los
efectos no lineales dentro de dicha zona de trabajo deben ser despreciablemente peque√±os.
Sin embargo, en caso de cambio del punto de operaci√≥n, el proceso se puede optimizar de
nuevo ejecutando la optimizaci√≥n en un margen reducido en torno al nuevo punto de operaci√≥n
y si no se atraviesa ninguna zona de no linealidad.
Si la presencia de ciertas zonas est√°ticas de no linealidad (p. ej., caracter√≠sticas de v√°lvulas)
es conocida, resulta siempre aconsejable compensarlas previamente con una l√≠nea poligonal
para linealizar el comportamiento del proceso.

Perturbaciones en procesos de temperatura
Las perturbaciones, como la transferencia de calor a zonas colindantes, no deben influir
excesivamente en el proceso global de temperatura. As√≠, p. ej., al optimizar las zonas de una
extrusionadora, todas las zonas deben calentarse simult√°neamente.

Desarrollo de la optimizaci√≥n del regulador
Par√°metros de regulador PI/PID
En el FM 355-2, con la optimizaci√≥n del regulador se ajustan autom√°ticamente los par√°metros
del regulador PI/PID. Se pueden optimizar tanto procesos de s√≥lo calefacci√≥n o s√≥lo
refrigeraci√≥n, como procesos con dos actuadores de efectos opuestos (p. ej., actuador
calefactor y actuador refrigerador).

Fases de la optimizaci√≥n del regulador
Durante la optimizaci√≥n del regulador se ejecutan fases individuales, que se indican en el
par√°metro PHASE .

PHASE = 0
No se efect√∫a ninguna optimizaci√≥n. El FM 355-2 funciona en modo autom√°tico o en modo
manual.
Mientras PHASE = 0, el sistema regulado debe cumplir con los requisitos para una
optimizaci√≥n.
Al final de la optimizaci√≥n, FM 355-2 vuelve a cambiar a PHASE = 0.

PHASE = 1
FM 355-2 se encuentra en disposici√≥n de optimizaci√≥n. La PHASE = 1 s√≥lo puede iniciarse si
se cumplen las condiciones para una optimizaci√≥n.

1088

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Mientras PHASE = 1 se calculan los siguientes valores:
‚óè Ruido del valor real NOISE_PV
‚óè Subida inicial PVDT0
‚óè Valor medio de la variable manipulada

PHASE = 2
En la fase 2 se busca el punto de inversi√≥n del valor real con una variable manipulada
constante. El procedimiento impide que el punto de inversi√≥n se detecte demasiado pronto
debido al ruido de PV:
Al principio, este c√°lculo del valor medio permanece inactivo, es decir, s√≥lo se calcula el valor
medio a lo largo de un ciclo. En cuanto el ruido excede una medida determinada, se duplica el
n√∫mero de ciclos.
Se determinan el per√≠odo y la amplitud del ruido. La b√∫squeda del punto de inversi√≥n no se
cancela y se sale de la fase 2 hasta que el gradiente es siempre menor que el ascenso m√°ximo
durante el per√≠odo estimado. Sin embargo, TU y T_P_INF se calculan en el punto de inversi√≥n
real.
De todas formas, la optimizaci√≥n no finaliza hasta que se cumplen las dos condiciones
siguientes:
1. El valor real est√° m√°s alejado del punto de inversi√≥n que 2*NOISE_PV.
2. El valor real ha superado el punto de inversi√≥n en un 20%.
Nota
En caso de excitaci√≥n mediante escal√≥n de consigna, la optimizaci√≥n finaliza a m√°s tardar
cuando el valor real ha superado el 75% del escal√≥n de consigna (SP_INT-PV0) (v√©ase
abajo).

PHASE = 3, 4, 5, 6
Cada una de las fases 3, 4, 5 y 6 dura 1 ciclo.
En la fase 3, se guardan los par√°metros PI/PID v√°lidos antes de la optimizaci√≥n y se calculan
los par√°metros del proceso.
En la fase 4, se calculan los nuevos par√°metros PI/PID.
En las fases 5 y 6 se calcula la nueva variable manipulada y se env√≠a al sistema regulado.
Si se ha identificado un sistema regulado del tipo I, el modo de optimizaci√≥n finaliza y la
optimizaci√≥n se encuentra de nuevo en la fase 0. A continuaci√≥n, el regulador arranca siempre
con LMN = LMN0 + 0.75*TUN_DLMN en el modo autom√°tico (aunque lo hubiera regulado en
el modo manual antes del inicio de la optimizaci√≥n).
Si se ha identificado un sistema regulado del tipo II o III, la optimizaci√≥n pasa a la fase 7.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1089

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

PHASE = 7
En los sistemas t√≠picos de temperatura (tipo de sistema l) se corre el riesgo de detectar el punto
de inversi√≥n demasiado pronto a causa del ruido. En tal caso, el escaso tiempo necesario para
alcanzar el punto de inversi√≥n T_P_INF puede provocar que se detecte el tipo de sistema II o
III.
Por ello, en la fase 7 se comprueba si el tipo de sistema es correcto. Esta comprobaci√≥n se
efect√∫a en el modo autom√°tico con los par√°metros del regulador reci√©n calculados y finaliza,
a m√°s tardar, al cabo de 6*TA (tiempo de compensaci√≥n) tras el punto de inversi√≥n. Si se
detecta el tipo de sistema I, los par√°metros del regulador se calculan de nuevo
(STATUS_D = 122); de lo contrario, los par√°metros del regulador se mantienen sin cambios.
La comprobaci√≥n del tipo de sistema se cancela si el valor real durante la optimizaci√≥n del
punto de trabajo alcanza de nuevo el valor real previo a la optimizaci√≥n PV0.
Si la fase 7 se cancela con TUN_ON = FALSE, se conservan los par√°metros del regulador ya
calculados.
Nota
En principio, la optimizaci√≥n de la calefacci√≥n puede comenzar durante la refrigeraci√≥n. En tal
caso, la comprobaci√≥n de orden en la fase 7 no se efect√∫a.
El caso contrario (inicio de la optimizaci√≥n de la refrigeraci√≥n durante la calefacci√≥n) no resulta
cr√≠tico ya que, en principio, la fase 7 de la optimizaci√≥n de refrigeraci√≥n no se efect√∫a.

Cancelaci√≥n anticipada de la optimizaci√≥n
En las fases 1, 2 √≥ 3, la optimizaci√≥n se puede cancelar sin calcular par√°metros nuevos
mediante el restablecimiento de TUN_ON = FALSE. El regulador empieza en modo autom√°tico
con LMN = LMN0. Si el regulador se encontraba en modo manual antes de la optimizaci√≥n, se
emitir√° la variable manipulada manual antigua.
Si la optimizaci√≥n se cancela en la fase 4, 5, 6 o 7 con TUN_ON = FALSE, los par√°metros del
regulador calculados hasta ese momento se conservan.

Resultado de la optimizaci√≥n
Estado de optimizaci√≥n
La cifra izquierda de STATUS_H y STATUS_C muestra el estado de optimizaci√≥n.
STATUS_H
STATUS_C

1090

Resultado

0

Se han encontrado par√°metros del regulador predeterminados, ninguno o nin‚Äê
guno nuevo.

10000

Encontrados par√°metros de regulador apropiados

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
STATUS_H
STATUS_C

Resultado

2xxxx

Se han encontrado par√°metros del regulador superiores a los valores estima‚Äê
dos; compruebe el comportamiento de regulaci√≥n, lea el aviso de diagn√≥stico
STATUS_H/C y repita la optimizaci√≥n del regulador.

3xxxx

Se han producido errores de operador; lea el aviso de diagn√≥stico STATUS_H/
C y repita la optimizaci√≥n del regulador.

Los siguientes par√°metros del regulador se actualizan tras detectar el punto de inversi√≥n en la
fase 6 en el FM 355-2 y en el DB de instancia online de la instrucci√≥n FMT_PID:
‚óè Factor de atenuaci√≥n del componente proporcional PFAC_SP = 0,8
‚óè Ganancia del regulador GAIN
‚óè Periodo de integraci√≥n TI (limitado a ‚â•0,5 s)
‚óè Periodo de derivaci√≥n TD (limitado a ‚â•1,0 s)
‚óè Factor diferencial D_F = 5,0
‚óè Zona de regulaci√≥n on/off CONZ_ON=TRUE/FALSE
‚óè Ancho de zona de regulaci√≥n CON_ZONE=250/GAIN
‚óè P_SEL = TRUE (aunque previamente el regulador integral puro)
Si RATIOFAC<>0,0, CON_ZONE se multiplica por 1,5.
Si el TD calculado por la optimizaci√≥n es <1,0 s, s√≥lo se detecta un regulador PI y tanto PID_ON
como los par√°metros PID se ponen a 0.
La zona de regulaci√≥n s√≥lo se activa si el tipo de sistema es adecuado (tipo de sistema I y II)
y si el regulador PID est√° activado (CONZ_ON = TRUE).
En funci√≥n de PID_ON se regula con el regulador PI o PID. Los par√°metros antiguos del
regulador se guardan y pueden volver a activarse mediante UNDO_PAR. Adem√°s, tambi√©n se
guarda un juego de par√°metros PI y un juego de par√°metros PID. Mediante LOAD_PID y la
activaci√≥n correspondiente de PID_ON, tambi√©n es posible cambiar m√°s adelante entre los
par√°metros optimizados PI o PID.
Si previamente exist√≠a una descomposici√≥n de la estructura (componente diferencial en la
realimentaci√≥n), √©sta se mantiene.
Nota
Nada m√°s terminar la optimizaci√≥n del regulador, compruebe el funcionamiento correcto de los
par√°metros del regulador.
Funci√≥n de rango dividido
En la optimizaci√≥n, la pendiente de la funci√≥n de rango dividido se atribuye al proceso. Si
modifica la pendiente de la funci√≥n de rango dividido despu√©s de la optimizaci√≥n, tambi√©n debe
adaptar en consecuencia el par√°metro del regulador GAIN.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1091

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

S√≠ntomas de error y soluciones posibles
Interceptar errores de operador
Todos los errores recogidos en esta tabla provocan que la optimizaci√≥n quede cancelada.
Error
Activaci√≥n simult√°nea de TUN_ON y
TUN_ST o TUN_CST

STATUS y medidas
STATUS_H/C = 30001
‚óè Transici√≥n a la fase 0
‚óè TUN_ON = FALSE

El signo de la modificaci√≥n de la consigna
no concuerda con el cambio del valor real.

Comentario
No puede aparecer con los asistentes,
ya que en la primera pantalla TUN_ST y
TUN_CST se ponen a FALSE.

Finalizaci√≥n de la optimizaci√≥n en el
punto de inversi√≥n
Desconexi√≥n de seguridad al 75%
sin efecto

|TUN_DLMN| o |TUN_DLMN efectivo| < 5%
(fin de la fase 1)

STATUS_H/C = 30002/30004

‚óè Transici√≥n a fase 99 (fase 0 en
Caso especial STATUS_H=30004:
optimizaci√≥n paralela)
Diferencia efectiva de la variable manipula‚Äê
‚óè Se emite LMN = LMN0
da limitada por los l√≠mites de rango dividido
y no por los l√≠mites de la variable manipulada

Puede que haya parametrizado un valor
demasiado bajo para TUN_DLMN o que
la variable manipulada estuviera pr√≥xi‚Äê
ma a un l√≠mite de posicionamiento antes
del inicio de la optimizaci√≥n.
Si STATUS_H=30004: Recuerde ade‚Äê
m√°s que, p. ej., con LMN_A < 5% no es
posible una optimizaci√≥n de calenta‚Äê
miento con TUN_DLMN negativo (ra‚Äê
z√≥n: La potencia de refrigeraci√≥n no
puede modificarse).
En ese caso hay que impedir que el re‚Äê
gulador se ajuste a la nueva consigna y
abandone innecesariamente el punto
de operaci√≥n estacionario (no es posi‚Äê
ble en la optimizaci√≥n paralela).
Proceda del siguiente modo:
‚óè Reducir consigna
‚óè TUN_ON=FALSE
‚óè Corregir TUN_DLMN
‚óè Iniciar de nuevo la optimizaci√≥n

S√≥lo en el regulador paso a paso sin reali‚Äê
mentaci√≥n de posici√≥n anal√≥gica:

STATUS_H = 30002

Si TUN_CST:

STATUS_C = 30002/30004

|TUN_CLMN| o |TUN_CLMN efectivo| < 5%
(fin de la fase 1)

‚óè Transici√≥n a la fase 0

‚óè Transici√≥n a la fase 0
|TUN_DLMN efectivo| < 5% (inicio de la fase ‚óè TUN_ON = FALSE
2)

Caso especial STATUS_H=30004:
Diferencia efectiva de la variable manipula‚Äê
da limitada por los l√≠mites de rango dividido
y no por los l√≠mites de la variable manipula‚Äê
da.

1092

‚óè TUN_ON = FALSE

El error aparece si |TUN_DLMN| >= 5%
pero la variable manipulada estaba pr√≥‚Äê
xima a un l√≠mite de posicionamiento an‚Äê
tes del inicio de la optimizaci√≥n.
Puede que haya parametrizado un valor
demasiado bajo para TUN_CLMN o que
la variable manipulada estuviera pr√≥xi‚Äê
ma a un l√≠mite de posicionamiento antes
del inicio de la optimizaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Error

STATUS y medidas

Si TUN_CST:

STATUS_C = 30003

Caso especial de "|TUN_CLMN efectivo| <
5% (fin de la fase 1)":

‚óè Transici√≥n a la fase 0

TUN_CLMN <= -5%, pero LMN_LLM > -5%.

‚óè TUN_ON = FALSE

Comentario
El l√≠mite inferior LMN_LLM es demasia‚Äê
do alto (p. ej., 0%) e impide por ello la
indicaci√≥n de una potencia de refrigera‚Äê
ci√≥n.

TUN_CST pero ninguna optimizaci√≥n ante‚Äê STATUS_C = 30008
rior de calentamiento
‚óè Transici√≥n a la fase 0
‚óè TUN_ON = FALSE
Modo de seguridad

STATUS_C = 30009
‚óè Transici√≥n a la fase 0
‚óè TUN_ON = FALSE

Si el FM 355-2 pasa en PHASE > 2 al
modo de seguridad, esta circunstancia
se muestra con STATUS_C=30009.

Punto de inversi√≥n no alcanzado (s√≥lo en caso de excitaci√≥n mediante escal√≥n de consigna)
La optimizaci√≥n finaliza como muy tarde cuando el valor real ha pasado el 75 % del escal√≥n de
consigna (SP_INT-PV0). Esta circunstancia se notifica mediante "Punto de inversi√≥n no
alcanzado" en STATUS_H/STATUS_C (2xx2x).
Siempre rige la consigna que est√° ajustada en cada momento. As√≠ pues, si se reduce la
consigna, es posible que la optimizaci√≥n finalice anticipadamente.
En casos de procesos de temperatura t√≠picos, suele bastar con cancelar la optimizaci√≥n al 75
% del escal√≥n de consigna para impedir sobreoscilaciones. Sin embargo, hay que tomar
precauciones, especialmente en procesos con un retardo considerable (TU/TA > 0.1, tipo III).
Si la excitaci√≥n manipulada es demasiado fuerte en comparaci√≥n con el escal√≥n de consigna,
el valor real tendr√° muchas sobreoscilaciones (hasta el factor 3).
Si, en procesos de orden superior, el punto de inversi√≥n sigue muy alejado una vez alcanzado
el 75 % del escal√≥n de consigna, hay una sobreoscilaci√≥n clara. Adem√°s, los par√°metros del
regulados son demasiado rigurosos. En este caso, aten√∫e los par√°metros del regulador o
repita el ensayo.
La figura siguiente representa la sobreoscilaci√≥n del valor real en caso de excitaci√≥n
demasiado fuerte (tipo de sistema III):

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1093

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3+$6( 

3+$6( 

r&
/01

3+$6( 

3+$6( 

3+$6( 

/01
/01781B'/01
781B'/01

39TXHUHVXOWDU¬ØDVL
HO/01QRKD
FDPELDGR

3XQWRGHLQYHUVL¬µQ
39

(VWDGRGHSURFHVR
HQFDOLHQWH SXQWRGH
WUDEDMR

63
63

(VWDGRGH
SURFHVRHQIU¬ØR

W
781B21
W

En procesos de temperatura t√≠picos, una cancelaci√≥n justo ante de alcanzar el punto de
inversi√≥n no es cr√≠tica respecto de los par√°metros del regulador.
Si repite el ensayo, reduzca TUN_DLMN o TUN_CLMN o bien aumente el escal√≥n de consigna.
Principio: la variable manipulada de optimizaci√≥n debe concordar con el escal√≥n de consigna.

Error de estimaci√≥n con tiempo de retardo u orden
El tiempo de retardo (STATUS_H/STATUS_C = 2x1xx, 2x2xx o 2x3xx) o el orden (STATUS_H/
STATUS_C = 21xxx o 22xxx) no se han podido registrar correctamente. Se sigue trabajando
con un valor estimado que puede provocar par√°metros no √≥ptimos del regulador.
Repita la optimizaci√≥n y aseg√∫rese de que no se produzcan perturbaciones en el valor real.
Nota
El caso especial de un proceso PT1 puro tambi√©n se notifica con STATUS_H/STATUS_C =
2x2xx (TU < CYCLE). En este caso no es necesario repetir el ensayo. Aten√∫e los par√°metros
del regulador si la regulaci√≥n oscila.

1094

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Calidad de las se√±ales medidas (ruido medido, perturbaciones de baja frecuencia)
El resultado de la optimizaci√≥n puede verse entorpecido por ruidos medidos o perturbaciones
de baja frecuencia. En tal caso, considere lo siguiente:
‚óè Dentro de un per√≠odo de ruido, el valor real debe muestrearse como m√≠nimo dos veces. La
medida de ruido no debe superar un 5% del cambio de se√±al √∫til.
‚óè Las perturbaciones radioel√©ctricas ya no se pueden filtrar con un m√≥dulo software. Dichas
perturbaciones ya deber√≠an haberse filtrado en el sensor de medici√≥n para impedir el efecto
aliasing.
La figura siguiente representa el efecto aliasing con un tiempo de muestreo demasiado
grande:
;

W

‚óè Si las perturbaciones son de baja frecuencia, se puede asumir que el per√≠odo de muestreo
del FM 355-2 es suficientemente peque√±o. Por otro lado, en tal caso el FM 355-2 debe
generar una se√±al medida homog√©nea debido al amplio intervalo de filtrado por valor
medio. Una filtraci√≥n de valores medios debe abarcar como m√≠nimo dos per√≠odos de ruido.
De esta forma, dentro del bloque se generan r√°pidamente tiempos de muestreo m√°s
grandes, de modo que se merma la precisi√≥n de la optimizaci√≥n. Una precisi√≥n suficiente
se garantiza con un m√≠nimo de 40 per√≠odos de ruido hasta el punto de inversi√≥n. Medidas
posibles al repetir el ensayo: aumentar TUN_DLMN/TUN_CLMN.

Sobreoscilaci√≥n
En las situaciones siguientes pueden producirse sobreoscilaciones:
Situaci√≥n

Causa

Fin de la optimi‚Äê ‚óè Excitaci√≥n mediante un cambio
zaci√≥n
demasiado brusco de la variable
manipulada en comparaci√≥n con el
escal√≥n de consigna (v√©ase arriba).
‚óè Regulador PI activado mediante
PID_ON = FALSE.
Optimizaci√≥n
en fase 7

Soluci√≥n
‚óè Aumentar el escal√≥n de consigna o
reducir el escal√≥n de la variable
manipulada
‚óè Si el proceso admite un regulador
PID, inicie la optimizaci√≥n con
PID_ON = TRUE.

Primero se han determinado par√°metros m√°s suaves para el regulador (tipo de sis‚Äê
tema III) que pueden provocar sobreosci‚Äê
laciones en la fase 7.

Modo de regula‚Äê Regulador PI y con PFAC_SP = 1.0 para el Si el proceso admite un regulador PID,
ci√≥n
tipo de sistema I.
inicie la optimizaci√≥n con PID_ON =
TRUE.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1095

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Optimizaci√≥n con regulador paso a paso
Introducci√≥n
En general son v√°lidas las explicaciones de la optimizaci√≥n del regulador.

Particularidades para el regulador paso a paso
‚óè Los reguladores paso a paso del FM 355-2 funcionan sin zona de regulaci√≥n.
‚óè La fase 7 no se lleva a cabo.
‚óè Sin optimizaci√≥n de refrigeraci√≥n.
Nota
El tiempo de posicionamiento del motor no es determinado por la optimizaci√≥n, por lo que
se debe medir o especificar antes del inicio de la optimizaci√≥n.

Dise√±o del regulador
El tiempo de posicionamiento del motor MTR_TM debe ser lo m√°s peque√±o posible en
comparaci√≥n con el tiempo necesario para alcanzar el punto de inversi√≥n T_P_INF y el tiempo
de retardo TU.
Para valores m√°s grandes del tiempo de posicionamiento del motor, autom√°ticamente los
reguladores dise√±ados resultan m√°s suaves.
Cuanto mayor sea la excitaci√≥n manipulada TUN_DLMN, tanto m√°s afecta el tiempo de
posicionamiento del motor en el dise√±o del regulador.

Par√°metros PI o PID
En comparaci√≥n con el dise√±o para reguladores continuos y reguladores de impulsos, los
par√°metros PI se reducen aprox. un 25%. Los par√°metros PID tambi√©n se calculan (pero sin
el 25% de seguridad). Los par√°metros PID √∫nicamente se deben utilizar si el tiempo de
posicionamiento del motor no es demasiado grande en comparaci√≥n con los par√°metros del
proceso y si la solicitaci√≥n del actuador por el componente diferencial no resulta excesiva.

Regulador paso a paso sin realimentaci√≥n anal√≥gica de posici√≥n
La emisi√≥n de √≥rdenes Abrir/Cerrar se detiene ya al principio de la fase 1 (cuasi-manual).
En la fase 1 no se calcula el valor medio de la variable manipulada (LMN0).
Al principio de la fase 2, durante el tiempo MTR_TM * TUN_DLMN / 100, se emite una orden
Abrir (o bien, si TUN_DLMN es negativo, una orden Cerrar).
Si una se√±al de tope se activa durante la pulsaci√≥n en la fase 2, TUN_DLMN efectivo se calcula
como: 100 * tiempo / MTR_TM.
Si el valor de TUN_DLMN efectivo es < 5%, se emite el mensaje de error STATUS_H=30002
y la optimizaci√≥n se cancela. Este error s√≥lo puede ocurrir si, contra toda previsi√≥n, el actuador
se encontraba cerca de un l√≠mite.

1096

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Fin o cancelaci√≥n de la optimizaci√≥n
El regulador se inicia con LMN = LMN0 + TUN_DLMN.

Realizar una optimizaci√≥n inicial
Requisitos
‚óè Las exigencias planteadas al proceso se cumplen.
‚óè Se ha creado y configurado un DB de instancia para el canal.
‚óè Como origen del valor real est√° parametrizado "Instrucci√≥n".
‚óè El FM 355-2 no se encuentra en el modo de seguridad (SAFE_ON = FALSE). Si el modo de
seguridad se activa, la optimizaci√≥n en ejecuci√≥n queda cancelada.

Procedimiento
ADVERTENCIA
Pueden producirse da√±os materiales considerables, lesiones f√≠sicas graves o incluso la
muerte.
Durante una optimizaci√≥n, el par√°metro LMN_REON no tiene efecto alguno. Tampoco
intervienen los circuitos de seguimiento, p. ej., derivados de los l√≠mites de alarma. Por ello, la
variable manipulada o el valor real pueden tomar valores no deseados, e incluso extremos.
La variable manipulada se especifica mediante optimizaci√≥n. Para cancelar la optimizaci√≥n
se debe activar TUN_ON = FALSE. De este modo, LMN_REON vuelve a ser efectivo.
Para determinar los par√°metros PID √≥ptimos en la primera puesta en servicio, proceda del
siguiente modo:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el s√≠mbolo
"Medici√≥n activada".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. En la lista "Modo" seleccione la entrada "Optimizaci√≥n inicial".
El FM 355-2 se encuentra en disposici√≥n de optimizaci√≥n (PHASE = 1).
4. Espere hasta que alcance el estado estacionario.
5. En el campo "Escal√≥n de la variable manipulada" indique el valor en el que debe
aumentarse la variable manipulada.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1097

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
6. En el campo "Consigna", indique una consigna. El escal√≥n de la variable manipulada se
hace efectivo s√≥lo con una nueva consigna.
7. Haga clic en el s√≠mbolo
"Iniciar optimizaci√≥n".
Se inicia la optimizaci√≥n inicial. Se muestra el estado de la optimizaci√≥n.
Nota
En la fase 1, una modificaci√≥n de consigna muy peque√±a (p. ej., ruido de medici√≥n de una
entrada anal√≥gica) puede activar una optimizaci√≥n. En ese caso, la optimizaci√≥n concluye
muy r√°pidamente (par√°metros de regulador err√≥neos; peligro de inestabilidad).

Realizar optimizaci√≥n fina de calefacci√≥n
Requisitos
‚óè Las exigencias planteadas al proceso se cumplen.
‚óè Se ha creado y configurado un DB de instancia para el canal.
‚óè Como origen del valor real est√° parametrizado "Instrucci√≥n".
‚óè El FM 355-2 no se encuentra en el modo de seguridad (SAFE_ON = FALSE). Si el modo de
seguridad se activa, la optimizaci√≥n en ejecuci√≥n queda cancelada.

Procedimiento
Para determinar los par√°metros PID √≥ptimos en el punto de operaci√≥n, proceda del siguiente
modo:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el s√≠mbolo
"Medici√≥n activada".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. En la lista "Modo" seleccione la entrada "Optimizaci√≥n fina de calefacci√≥n".
El FM 355-2 se encuentra en disposici√≥n de optimizaci√≥n (PHASE = 1).
4. En el campo "Escal√≥n de la variable manipulada" indique el valor en el que debe
aumentarse la variable manipulada.
5. Haga clic en el s√≠mbolo
"Iniciar optimizaci√≥n".
Se inicia la optimizaci√≥n fina. Se muestra el estado de la optimizaci√≥n.

1098

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Realizar optimizaci√≥n fina de refrigeraci√≥n
Introducci√≥n
En las regulaciones que funcionan con dos actuadores de efectos opuestos (actuador
calefactor y actuador refrigerador), el FM355-2 determina con un escal√≥n de la variable
manipulada del actuador refrigerador la relaci√≥n entre las ganancias de proceso RATIOFAC
(ganancia de calefacci√≥n/ganancia de refrigeraci√≥n). El ancho de la zona de regulaci√≥n
CON_ZONE tambi√©n se calcula de nuevo. Los dem√°s par√°metros del regulador se mantienen
sin cambios.

Requisitos
‚óè Como origen del valor real est√° parametrizado "Instrucci√≥n".
‚óè El FM 355-2 no se encuentra en el modo de seguridad (SAFE_ON = FALSE). Si el modo de
seguridad se activa, la optimizaci√≥n en ejecuci√≥n queda cancelada.
‚óè La optimizaci√≥n fina de calefacci√≥n para el canal ha concluido correctamente. Tras una falta
de corriente del FM 355-2, la optimizaci√≥n de calefacci√≥n se debe repetir.
‚óè En una instalaci√≥n con varias zonas de temperatura acopladas (p. ej., m√°quinas de
pl√°stico), la optimizaci√≥n fina ha concluido correctamente para todas las zonas y se ha
alcanzado el estado estabilizado.
‚óè La variable manipulada A se debe usar para la calefacci√≥n y la variable manipulada B para
la refrigeraci√≥n.
‚óè RATIOFAC es efectivo si LMN<0,0, por lo que la funci√≥n de rango dividido debe estar
definida en consecuencia: A para LMN>=0,0 y B para LMN<0,0.
‚óè Para que la optimizaci√≥n fina de la refrigeraci√≥n pueda comenzar durante la calefacci√≥n, las
se√±ales de calefacci√≥n y refrigeraci√≥n deben poder ser efectivas en el proceso
simult√°neamente.

Procedimiento
Para determinar los par√°metros PID √≥ptimos en el punto de operaci√≥n, proceda del siguiente
modo:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el s√≠mbolo
"Medici√≥n activada".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. En la lista "Modo" seleccione la entrada "Optimizaci√≥n fina de la refrigeraci√≥n".
El FM 355-2 se encuentra en disposici√≥n de optimizaci√≥n (PHASE = 1).
4. En el campo "Escal√≥n de la variable manipulada" indique el valor en el que debe
aumentarse o disminuirse la variable manipulada.
5. Haga clic en el s√≠mbolo
"Iniciar optimizaci√≥n".
Se inicia la optimizaci√≥n fina. Se muestra el estado de la optimizaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1099

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Resultado
En cuanto se encuentra un punto de inversi√≥n en la evoluci√≥n del valor real, el FM 355-2
retorna de nuevo al modo de regulaci√≥n (FASE 0).
A diferencia de lo que ocurre en la optimizaci√≥n de la calefacci√≥n, los par√°metros antiguos del
regulador no se guardan (el RATIOFAC antiguo ya se hab√≠a guardado durante la optimizaci√≥n
de la calefacci√≥n) y la fase 4 no se lleva a cabo.
STATUS_D permanece inalterado y sigue siempre refiri√©ndose a la optimizaci√≥n de la
calefacci√≥n. Tambi√©n se conservan los juegos de par√°metros PI y PID de la √∫ltima
optimizaci√≥n de la calefacci√≥n, de tal modo que se pueden cargar con LOAD_PID despu√©s de
una optimizaci√≥n de la refrigeraci√≥n.

Optimizaci√≥n paralela de los canales del regulador
Zonas vecinas con fuerte acoplamiento t√©rmico
Si dos o m√°s reguladores de un m√≥dulo regulan la temperatura p. ej. de una placa (p. ej. dos
calefacciones y dos valores reales medidos con fuerte acoplamiento de calor), existe la
posibilidad de realizar una optimizaci√≥n paralela para estos reguladores.

Procedimiento
Para optimizar simult√°neamente varios canales, proceda del modo siguiente:
1. Parametrice los canales correspondientes en la zona A o en la zona B.
2. Inicie la optimizaci√≥n en uno de los canales. La optimizaci√≥n de los canales conexos se
inicia entonces autom√°ticamente.
Nota
En caso de excitaci√≥n por escal√≥n de consigna, el usuario debe garantizar la activaci√≥n
simult√°nea de los escalones de consigna. Los par√°metros PID_ON y TUN_DLMN/
TUN_CLMN s√≥lo se pueden especificar para un canal. Los par√°metros para los dem√°s
canales se deben predefinir a trav√©s de los correspondientes DBs de instancia de la
instrucci√≥n FMT_PID antes de iniciar la optimizaci√≥n.
Cancelaci√≥n de la optimizaci√≥n
Si aparece un error en uno de los canales (fase 0 o final de la fase 1), se cancela la optimizaci√≥n
de todos los canales.
El usuario puede restablecer la optimizaci√≥n poniendo TUN_ON=FALSE en alguno de los
canales implicados.
Si un canal pasa al modo de seguridad, tambi√©n se desactiva la optimizaci√≥n de los canales
implicados.
S√≥lo se muestra la informaci√≥n de estado del canal seleccionado. Encontrar√° las causas de
error de los canales restantes en los correspondientes DBs de instancia.

1100

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Ventaja
Los reguladores implicados emiten su correspondiente magnitud manipulada de optimizaci√≥n
hasta que todos los reguladores hayan abandonado la fase 2. De esta forma se evita que el
regulador que primero finalice la optimizaci√≥n falsifique el resultado de optimizaci√≥n del resto
de reguladores al modificar su magnitud manipulada.
PRECAUCI√ìN
El hecho de alcanzar el 75% del escal√≥n de consigna en uno de los canales implicados no
finaliza la optimizaci√≥n (peligro de sobreoscilaci√≥n). El modo autom√°tico se inicia cuando
todos los reguladores implicados han finalizado su optimizaci√≥n.

Zonas vecinas con escaso acoplamiento t√©rmico
En general se aplica la norma de que habr√≠a que optimizar tal y como se vaya a regular
despu√©s. Si en el modo de producci√≥n las zonas se recorren juntas en paralelo, de forma que
las diferencias de temperatura entre las zonas se mantienen iguales, durante la optimizaci√≥n
tambi√©n deber√≠a aumentarse correspondientemente el nivel de temperatura de las zonas
vecinas.
Las diferencias de temperatura al principio del ensayo no son relevantes, porque se
compensan mediante una calefacci√≥n inicial adecuada (‚Üípendiente inicial = 0).

Optimizaci√≥n fina manual en modo de regulaci√≥n
Introducci√≥n
Para conseguir una respuesta de regulaci√≥n sin sobreoscilaciones se pueden tomar las
medidas que se describen a continuaci√≥n:

Adaptar la zona de regulaci√≥n
En la optimizaci√≥n, el FM 355-2 determina un ancho de zona de regulaci√≥n CON_ZONE y, si
el tipo de sistema es correcto (tipos de sistema I y II), el regulador PID se activa: CONZ_ON =
TRUE. En el modo de regulaci√≥n es posible modificar la zona de regulaci√≥n o desactivarla
completamente (con CONZ_ON = FALSE).
Ninguna zona de regulaci√≥n para el tipo de sistema III ni para los reguladores PI y paso a paso.
Activar la zona de regulaci√≥n en procesos de orden superior (tipo de sistema III) no suele
suponer ninguna ventaja, porque en ese caso la zona de regulaci√≥n es mayor que el rango de
regulaci√≥n asequible con el 100% de la variable manipulada. Tampoco es ventajoso activar la
zona de regulaci√≥n para regulador PI.
Nota
Antes de activar a mano la zona de regulaci√≥n, aseg√∫rese de no ajustar un ancho de zona de
regulaci√≥n demasiado peque√±o. Si el ancho ajustado para la zona de regulaci√≥n fuera
insuficiente, se producir√°n oscilaciones en las curvas de la variable manipulada y del valor real.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1101

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Atenuar continuamente la respuesta de regulaci√≥n con PFAC_SP
La zona de regulaci√≥n es la mejor posibilidad din√°mica para conseguir una respuesta de
regulaci√≥n sin sobreoscilaciones. Util√≠cela siempre que resulte posible, es decir, con los
reguladores PID para los tipos de sistema I y II.
Con los reguladores PI, tipo de sistema III, o en caso de escal√≥n de consigna en la zona de
regulaci√≥n, la respuesta de regulaci√≥n se puede atenuar con el par√°metro PFAC_SP. Dicho
par√°metro determina qu√© proporci√≥n de la acci√≥n P ser√° efectiva en casos de escalones de
consigna.
PFAC_SP es preajustado por la optimizaci√≥n a 0,8, independientemente del tipo de sistema;
el valor se puede modificar a continuaci√≥n. Para limitar las sobreoscilaciones provocadas por
escalones de consigna a aprox. un 2% (si los dem√°s par√°metros del regulador son correctos),
resultan suficientes los valores siguientes para PFAC_SP:
Tipo de sistema I

Tipo de sistema II

Tipo de sistema III

Proceso de temperatura t√≠pico

Rango de transici√≥n

Proceso de temperatura de or‚Äê
den superior

PI

0.8

0.82

0.8

PID

0.6

0.75

0.96

Ajuste el factor predeterminado (0.8), especialmente en los casos siguientes:
‚óè Tipo de sistema I con PID (0,8 ‚Üí 0,6): Con PFAC_SP = 0,8, los escalones de consigna
dentro de la zona de regulaci√≥n siguen provocando una sobreoscilaci√≥n del 18%.
‚óè Tipo de sistema III con PID (0,8 ‚Üí 0,96): Con PFAC_SP = 0,8 los escalones de consigna
se amortiguan demasiado. Se regala un tiempo de ajuste claro.

Amortiguar los par√°metros de regulaci√≥n
Si en el lazo cerrado de regulaci√≥n se producen oscilaciones, o si hay sobreoscilaciones
despu√©s de escalones de consigna, se puede reducir la ganancia del regulador GAIN (p. ej.,
al 80% del valor original) y aumentar el periodo de integraci√≥n TI (p. ej., al 150% del valor
original). Si la variable manipulada anal√≥gica del regulador continuo se convierte en se√±ales
manipuladas binarias con un generador de impulsos, es posible que aparezcan peque√±as
oscilaciones continuas debido a los efectos de cuantificaci√≥n. √âstas se pueden eliminar
ampliando la zona muerta DEADB_W.

Optimizar los par√°metros PID manualmente
Requisitos
‚óè Las exigencias planteadas al proceso se cumplen.
‚óè Se ha creado y configurado un DB de instancia para el canal.
‚óè Como origen del valor real est√° parametrizado "Instrucci√≥n".

1102

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para ajustar manualmente el regulador, proceda del modo siguiente:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el s√≠mbolo
"Medici√≥n activada".
Si a√∫n no existe ninguna conexi√≥n online, √©sta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. Introduzca los valores correspondientes para los par√°metros siguientes:
‚Äì Acci√≥n P
‚Äì Ponderaci√≥n del componente proporcional para escalones de consigna
‚Äì Acci√≥n I
‚Äì Acci√≥n D
‚Äì Coeficiente DT1
‚Äì Coeficiente calefacci√≥n/refrigeraci√≥n
4. En el grupo "Optimizaci√≥n", haga clic en el s√≠mbolo

"Enviar par√°metros PID al FM".

5. En el grupo "Valores actuales", active la casilla de verificaci√≥n "Especificar consigna" .
6. Introduzca una nueva consigna.
7. Desactive en caso necesario la casilla de verificaci√≥n "Modo manual" y, en el grupo
"Valores actuales", haga clic en el s√≠mbolo .
El regulador trabaja con los nuevos par√°metros y regula seg√∫n la nueva consigna.
8. Compruebe la calidad de los par√°metros PID mediante los recorridos de la curva.
9. Repita los pasos del 3 hasta el 8, hasta que est√© satisfecho/a con el resultado de la
regulaci√≥n.
Nota
FMT_PID.OP.UNDO_PAR = TRUE permite ajustar de nuevo los par√°metros antiguos del
regulador.

Cargar los par√°metros optimizados en el dispositivo
Introducci√≥n
Para impedir que los par√°metros del FM se sobrescriban con los datos del sistema en el
siguiente arranque de la CPU, se puede proceder del modo siguiente:
‚óè Tras cada arranque del FM 355-2, cargue en este con LOAD_PAR = TRUE los par√°metros
PID optimizados del DB de instancia del FMT_PID.
‚óè Cargue los par√°metros PID optimizados en el SDB.
Nota
Los juegos de par√°metros PI, PID y SAVE no se pueden guardar en el SDB.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1103

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Procedimiento
Para cargar los par√°metros en el SDB, proceda del siguiente modo:
1. Haga clic en el s√≠mbolo
"Transfiera datos online al proyecto offline".
Los par√°metros PID se guardan en el ajuste de par√°metros del FM.
2. Pare la CPU.
3. Haga clic en el s√≠mbolo

"Cargar en dispositivo".

Guardar y volver a cargar los par√°metros del regulador
Juego de par√°metros guardado
En el FM 355-2 se dispone de un juego de par√°metros guardado adem√°s del juego de
par√°metros efectivo. Para guardarlo y volverlo a cargar se emplea SAVE_PAR y UNDO_PAR
en la estructura OP de la instrucci√≥n FMT_PID.
As√≠ se puede, p. ej., guardar los par√°metros actuales con SAVE_PAR = TRUE antes de
introducir un cambio manual. Por medio de UNDO_PAR = TRUE se pueden volver a activar
para el regulador los par√°metros de √©ste guardados en √∫ltimo lugar. Una vez finalizada la
acci√≥n, FMT_PID desactiva SAVE_PAR o UNDO_PAR.
Si desea saber qu√© valores se encuentran en el juego de par√°metros actual y cu√°les hay en el
juego de par√°metros guardado, puede leerlos por medio de FMT_PID.READ_PAR = TRUE o
FMT_TUN.READ_OUT = TRUE:
Par√°metros actuales en la estructura del PAR del
FMT_PID:

Par√°metros guardados en los par√°metros de sali‚Äê
da del FMT_TUN:

PFAC_SP

SAV_PFAC

GAIN

SAV_GAIN

TI

SAV_TI

TD

SAV_TD

D_F

SAV_D_F

CON_ZONE

SAV_CONZ

RATIOFAC

SAV_RATI

CONZ_ON

SAV_CZON

P_SEL

SAV_PSEL

Nota
Al final de una optimizaci√≥n del regulador, los par√°metros guardados se sobrescriben con los
valores v√°lidos antes de la optimizaci√≥n (excepci√≥n: en la optimizaci√≥n de la refrigeraci√≥n se
suprime este almacenamiento intermedio).

1104

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Cambio entre par√°metros PI y PID
Despu√©s de una optimizaci√≥n, tanto los par√°metros PI como los PID se guardan en el
FM355-2. La carga de estos juegos de par√°metros se lleva a cabo activando
FMT_PID.OP.LOAD_PID. Si PID_ON es en la estructura PAR = TRUE, el juego de par√°metros
PID se copia en los par√°metros efectivos del regulador; de lo contrario, se copia el juego de
par√°metros PI. Una vez finalizada la acci√≥n, FMT_PID desactiva LOAD_PID. El valor de
PID_ON se mantiene, lo que resulta l√≥gico pues no se trata de un par√°metro de operaci√≥n.
Si desea saber qu√© valores hay en el juego de par√°metros PI o PID, puede averiguarlo a trav√©s
de FMT_TUN. Leer READ_OUT = TRUE:
Juego de par√°metros PI
Ganancia del regulador

Juego de par√°metros PID

PI_GAIN

PID_GAIN

Per√≠odo de integraci√≥n

PI_TI

PID_TI

Tiempo de acci√≥n derivativa

0.0

PID_TD

Nota
Tenga en cuenta lo siguiente:
‚óè Los par√°metros del regulador s√≥lo se rescriben con UNDO_PAR o LOAD_PID si la
ganancia del regulador (SAV_GAIN, PID_GAIN o PI_GAIN) es distinta de cero:
‚óè Con ello se tiene en cuenta el caso de que a√∫n no se haya llevado a cabo ninguna
optimizaci√≥n o de que falte alg√∫n par√°metro PID. Si eran, p. ej., PID_ON = TRUE y
PID_GAIN = 0.0, PID_ON se pone a FALSE y los par√°metros PI se copian.
‚óè D_F, PFAC_SP se preajustan con la optimizaci√≥n. Seguidamente pueden ser modificados
por el usuario. LOAD_PID no modifica este par√°metro.
‚óè La zona de regulaci√≥n siempre se calcula de nuevo con LOAD_PID (CON_ZONE = 250/
GAIN o 375/GAIN si RATIOFAC <> 0.0), incluso si CONZ_ON = FALSE.

Conmutaci√≥n sin discontinuidad con LOAD_PID y UNDO_PAR
La conmutaci√≥n se efect√∫a de manera que la suma del componente proporcional y el
componente integral permanece constante. Al conmutar de PID a PI se produce un salto en la
magnitud de ajuste, ya que el componente diferencial desaparece. El paso de PI a PID no
provoca discontinuidad alguna en un principio. No obstante, al cabo de algunos ciclos, el
componente diferencial provoca un cambio r√°pido.

Realizar medici√≥n del tiempo de posicionamiento del motor
Introducci√≥n
Para conseguir un buen resultado de la regulaci√≥n, el tiempo de posicionamiento del motor
debe ser lo m√°s preciso posible. Los datos de la documentaci√≥n del elemento final de control
son valores medios para este tipo de elemento final de control. El valor puede variar para el
elemento final de control que se use en cada momento.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1105

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Si utiliza actuadores con realimentaci√≥n de posici√≥n o con se√±ales de tope, es posible medir
el tiempo de posicionamiento del motor durante la puesta en servicio. Si no se dispone de una
realimentaci√≥n de posici√≥n ni de se√±ales de tope, no es posible medir el tiempo de
posicionamiento del motor.

Requisitos
‚óè El valor parametrizado del tiempo de posicionamiento del motor debe equivaler como
m√≠nimo a la mitad del tiempo de posicionamiento real. El actuador se desplaza en un
sentido durante el doble del tiempo de posicionamiento como m√°ximo.
‚óè En los actuadores con realimentaci√≥n de posici√≥n anal√≥gica, la realimentaci√≥n de posici√≥n
debe estar interconectada.
‚óè En los actuadores con se√±ales de tope, las se√±ales de tope deben estar interconectadas.

Actuadores con realimentaci√≥n de posici√≥n anal√≥gica
Para medir el tiempo de posicionamiento del motor con realimentaci√≥n de posici√≥n, proceda
del siguiente modo:
1. Elija el DB instancia para el que se debe medir el tiempo de posicionamiento del motor.
2. Active la casilla de verificaci√≥n "Utilizar realimentaci√≥n de posici√≥n".
3. En el campo de entrada "Posici√≥n de destino" indique hacia d√≥nde desea mover el
elemento final de control.
La realimentaci√≥n de posici√≥n actual (posici√≥n de inicio) se muestra. Haga clic en el
bot√≥n
"Iniciar medici√≥n tiempo de posicionamiento".

Resultado
El elemento final de control se desplaza hasta la posici√≥n de destino desde la posici√≥n de
inicio. La medici√≥n del tiempo se inicia de inmediato y finaliza en cuanto el elemento final de
control ha alcanzado la posici√≥n de destino. El tiempo de posicionamiento del motor se calcula
seg√∫n la f√≥rmula:
Tiempo de posicionamiento del motor = (L√≠mite superior del valor de salida - L√≠mite inferior del
valor de salida) x Tiempo de medici√≥n /VALOR ABSOLUTO(Posici√≥n de destino - Posici√≥n de
inicio).
Se muestran el progreso y el estado de la medici√≥n del tiempo de posicionamiento. El tiempo
de posicionamiento medido se muestra en el campo "Tiempo de actuaci√≥n medido". Una vez
finalizada la medici√≥n del tiempo de posicionamiento se conecta el modo manual de las
se√±ales de posicionamiento (OP.LMNS_ON = TRUE). El elemento final de control deja de
moverse.

1106

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Actuadores con se√±ales de tope
Para medir el tiempo de posicionamiento del motor con se√±ales de tope, proceda del siguiente
modo:
1. Elija el DB instancia para el que se debe medir el tiempo de posicionamiento del motor.
2. Active la casilla de verificaci√≥n "Utilizar se√±ales de tope del actuador".
3. Haga clic en el bot√≥n

"Iniciar medici√≥n tiempo de posicionamiento".

Resultado
El elemento final de control se mueve primero hasta el tope inferior, despu√©s, hasta el tope
superior y, de nuevo, hasta el tope inferior. La medici√≥n del tiempo se inicia cuando el actuador
ha alcanzado el tope inferior y finaliza cuando el actuador alcanza por segunda vez el tope
inferior. El tiempo medido dividido entre dos da lugar al tiempo de posicionamiento del motor.
Se muestran el progreso y el estado de la medici√≥n del tiempo de posicionamiento. El tiempo
de posicionamiento medido se muestra en el campo "Tiempo de actuaci√≥n medido". Una vez
finalizada la medici√≥n del tiempo de posicionamiento se conecta el modo manual de las
se√±ales de posicionamiento (OP.LMNS_ON = TRUE). El elemento final de control deja de
moverse.

Cargar el tiempo de ajuste medido
1. Para guardar en el proyecto el tiempo de posicionamiento del motor medido, haga clic en
el s√≠mbolo
"Transfiere datos online al proyecto offline".
El tiempo de ajuste medido se guarda en el ajuste de par√°metros del FM.
2. Para que los cambios surtan efecto en el arranque siguiente de la CPU, haga clic en el
icono
"Cargar en dispositivo".

Cancelar medici√≥n del tiempo de posicionamiento
Si cancela la medici√≥n del tiempo de posicionamiento, el modo manual de las se√±ales de
posicionamiento se conecta (OP.LMNS_ON = TRUE) y el modo manual con especificaci√≥n de
la variable manipulada se desconecta (OP.LMN_REON = FALSE). El elemento final de control
deja de moverse.

Trabajar con el registrador de curvas
Observar
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Puesta en servicio".
2. Navegue en la vista de configuraci√≥n hasta "Registrador de curvas".
3. Seleccione el DB de instancia que desee observar. Tras seleccionarlo se muestra el canal
al que est√° asignado el DB de instancia.
4. Defina el tiempo de actualizaci√≥n con el que debe registrar el registrador de curvas.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1107

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
5. Haga clic en "Medici√≥n activada" para iniciar la medici√≥n.
6. Haga clic en "Medici√≥n desactivada" para finalizar la medici√≥n.

Procedimiento
Para adaptar la escala, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el m√≥dulo, haga doble clic en "Puesta en servicio".
2. Navegue en la vista de configuraci√≥n hasta "Registrador de curvas".
3. Para modificar el eje de tiempo:
‚Äì Haga clic en el bot√≥n de flecha junto a la fecha, para abrir un calendario. Seleccione una
fecha en el calendario. Para bloquear la selecci√≥n, haga clic en el candado azul. Esta
posibilidad existe tanto para la fecha de inicio como para la fecha de fin.
‚Äì Haga clic con el puntero del rat√≥n en la escala de tiempo. El puntero del rat√≥n se
representa como flecha a la izquierda/derecha. Mantenga el puntero del rat√≥n
presionado y arr√°strelo hacia la izquierda o derecha.
Si el tiempo de inicio o fin est√° bloqueado, se modifica el escalado del tiempo.
Si no est√° bloqueado ni el tiempo de inicio ni el de fin, se modifica el per√≠odo indicado;
el escalado se mantiene igual.
4. Para modificar el eje de tiempo:
‚Äì Haga clic en el campo de entrada para el valor superior o el valor inferior mostrado.
Introduzca ah√≠ el valor deseado. Para bloquear la selecci√≥n, haga clic en el candado
azul. Esta posibilidad existe tanto para el valor superior como tambi√©n para el inferior.
‚Äì Haga clic con el puntero del rat√≥n en la escala de valores. El puntero del rat√≥n se
representa como flecha arriba/abajo. Mantenga el puntero del rat√≥n presionado y
arr√°strelo hacia arriba o abajo.
Si el valor superior o inferior est√° bloqueado, se modifica la escala del eje de valores.
Si no est√° bloqueado el valor superior ni el valor inferior, se modifica el rango indicado;
la escala se mantiene igual.

3.5.6.4

FM 355-2: Diagn√≥stico a trav√©s de indicadores LED

Indicaci√≥n de errores mediante el LED de error de grupo
Introducci√≥n
Si el LED rojo de error de grupo se enciende, significa que se ha producido un error en el
m√≥dulo (error interno) o en las conexiones (error externo).
Si el LED amarillo parpadea, el firmware se borra. Este estado s√≥lo puede aparecer si existe
un defecto en el hardware o si el proceso de carga del firmware se cancela.

1108

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

¬øQu√© errores se muestran?
Cuando se ilumina el LED de error de grupo se se√±alan los errores siguientes:
Tipo de
error

Aviso de diagn√≥stico

Errores in‚Äê M√≥dulo defectuoso
ternos
Vigilancia de tiempo
(watch dog) activado

Errores
externos

Causa posible

Soluci√≥n

Error de hardware

Cambie el m√≥dulo

Error de hardware

Cambie el m√≥dulo

Contenido EEPROM no
v√°lido

Fallo de la tensi√≥n de alimenta‚Äê
ci√≥n al parametrizar

Vuelva a parametrizar el
m√≥dulo

Par√°metro err√≥neo en el
m√≥dulo

Se han transferido par√°metros in‚Äê Vuelva a parametrizar el
correctos al m√≥dulo
m√≥dulo

Error en las entradas o las
salidas anal√≥gicas

Error de hardware en la entrada
anal√≥gica

Cambie el m√≥dulo

Rotura de hilo en la entrada ana‚Äê Solucione la rotura de hilo
l√≥gica
Rebase por defecto del rango de Revise la se√±al de medi‚Äê
medici√≥n en la entrada anal√≥gica ci√≥n
Rebase por exceso del rango de Revise la se√±al de medi‚Äê
medici√≥n en la entrada anal√≥gica ci√≥n
Rotura de hilo en la salida anal√≥‚Äê Solucione la rotura de hilo
gica
Cortocircuito en la salida anal√≥gi‚Äê Solucione el cortocircuito
ca
Falta tensi√≥n auxiliar ex‚Äê
terna

Fallo en la alimentaci√≥n 24 V

Restablezca la alimenta‚Äê
ci√≥n de 24 V

Alarma de diagn√≥stico en caso de error
Todos los errores pueden disparar una alarma de diagn√≥stico si √©sta se ha habilitado en la
pantalla de parametrizaci√≥n correspondiente. En los registros de diagn√≥stico DS0 y DS1
puede ver qu√© error ha provocado que se encienda el LED. La asignaci√≥n de los registros de
diagn√≥stico DS0 y DS1 est√° descrita en el siguiente apartado.

Disparo de alarmas de diagn√≥stico
¬øQu√© es una alarma de diagn√≥stico?
Si el programa de usuario reacciona a un error interno o externo, es posible parametrizar una
alarma de diagn√≥stico. El programa c√≠clico de la CPU se interrumpe y se llama la alarma de
diagn√≥stico OB, OB 82.

¬øQu√© eventos pueden disparar una alarma de diagn√≥stico?
La siguiente lista muestra qu√© eventos pueden disparar una alarma de diagn√≥stico:
‚óè M√≥dulo no parametrizado o errores en la parametrizaci√≥n
‚óè M√≥dulo defectuoso

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1109

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
‚óè Rotura de hilo en entradas anal√≥gicas (s√≥lo 4 a 20 mA)
‚óè Rebase por exceso y por defectos en entradas anal√≥gicas
‚óè Rotura de carga y cortocircuito en salidas anal√≥gicas

Habilitaci√≥n de la alarma de diagn√≥stico
La ficha Par√°metros b√°sicos permite bloquear o habilitar la alarma de diagn√≥stico para el
m√≥dulo.
La alarma de diagn√≥stico est√° bloqueada de forma predeterminada.

Respuestas a un evento que dispara una alarma
Cuando se produce un evento que puede disparar una alarma de diagn√≥stico ocurre lo
siguiente:
‚óè La informaci√≥n de diagn√≥stico se registra en los registros de diagn√≥stico DS0 y DS1 del
m√≥dulo.
‚óè El LED de error de grupo se enciende.
‚óè Se llama al OB de alarma de diagn√≥stico (OB 82).
‚óè El registro de diagn√≥stico DS0 se graba en la informaci√≥n de arranque del OB de alarma de
diagn√≥stico.
‚óè Si no hay ning√∫n defecto de hardware, el m√≥dulo sigue regulando.
La CPU pasa a modo STOP si no se ha programado el OB 82.

Registro de diagn√≥stico DS0 y DS1
La informaci√≥n que indica qu√© evento ha provocado una alarma de diagn√≥stico se guarda en
los registros de diagn√≥stico DS0 y DS1. El registro de diagn√≥stico DS0 consta de cuatro bytes;
DS1 consta de 16 bytes, siendo los cuatro primeros id√©nticos a DS0.

Registros de diagn√≥stico DS0 y DS1
Leer el registro desde el m√≥dulo
El registro de diagn√≥stico DS0 se transfiere autom√°ticamente a la informaci√≥n de arranque en
la llamada del OB de diagn√≥stico. All√≠, estos cuatro bytes se guardan en los datos locales
(bytes 8-11) del OB 82.
El registro de datos DS1 (y, con ello, tambi√©n el contenido del DS0) puede leerse con el FB 55
"FMT_DS1" del m√≥dulo. Esta lectura s√≥lo tiene sentido si en el DS0 se notifica un error en un
canal.
El FB 55 "FMT_DS1" debe llamarse en el mismo OB que un posible FB FMT_PID existente (por
ejemplo, OB 35). Esto se consigue con la medida siguiente: Ajuste el bit READ_DS1 mientras
se procesa el OB 82. El FMT_DS1 del OB 35 lee a continuaci√≥n el registro de diagn√≥stico DS1.

1110

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

¬øC√≥mo aparecen los textos de diagn√≥stico en el b√∫fer de diagn√≥stico?
Si se desea registrar el aviso de diagn√≥stico en el b√∫fer de diagn√≥stico, se debe llamar la
instrucci√≥n "WR_REC" "Introducir avisos espec√≠ficos de usuario en el b√∫fer de diagn√≥stico"
dentro del programa de usuario. En cada caso, el n√∫mero de evento del aviso de diagn√≥stico
se especifica en el par√°metro de entrada EVENTN. La alarma se introduce en el b√∫fer de
diagn√≥stico con x=1 como entrante y con x=0 como saliente. El b√∫fer de diagn√≥stico contiene
los textos de diagn√≥stico correspondientes en la columna de "Significado", as√≠ como el
momento en que se produjo la entrada.

Asignaci√≥n del registro de diagn√≥stico DS0 y de la informaci√≥n de arranque
La tabla siguiente muestra la asignaci√≥n del registro de diagn√≥stico DS0 en la informaci√≥n de
arranque. Todos los bits que no se incluyen en la tabla son irrelevantes y tienen el valor cero.
Tabla 3-5
Byte
0

Asignaci√≥n del registro de diagn√≥stico DS0
Bit

Significado

0

Aver√≠a en m√≥dulo

1

Error interno

Nota

N¬∫ de evento

Se activa en todos los eventos de diagn√≥stico

8:x:00

Se activa en todos los errores internos:

8:x:01

‚óè Vigilancia de tiempo activada
‚óè Error EPROM
‚óè Error ADC/DAC
‚óè Error de hardware en la entrada anal√≥gica
2

Error externo

Se activa en todos los errores externos:

8:x:02

‚óè Falta tensi√≥n auxiliar externa
‚óè Error de parametrizaci√≥n
‚óè Rotura de hilo en la entrada anal√≥gica (s√≥lo
en el margen 4 a 20 mA)
‚óè Rebase por defecto del rango de medici√≥n
en la entrada anal√≥gica
‚óè Rebase del rango de medici√≥n en la
entrada anal√≥gica
‚óè Rotura de carga de la salida anal√≥gica
‚óè Cortocircuito en la salida anal√≥gica
3

Fallo en un canal

Consultar el DS1, a partir del byte 7, para m√°s
detalles

8:x:03

4

Falta tensi√≥n auxiliar
externa

Fallo en la alimentaci√≥n 24 V del FM 355-2

8:x:04

6

sin usar

-

7

Error de parametriza‚Äê El m√≥dulo no puede utilizar un par√°metro. Mo‚Äê
ci√≥n
tivo: Par√°metro desconocido o combinaci√≥n de
par√°metros no permitida.

8:x:07

Consulte el men√∫ Sistema de destino > Mostrar
error de parametrizaci√≥n.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1111

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Byte
1

Bit

Significado

Nota

N¬∫ de evento

0 ... 3

Clase de m√≥dulo

Siempre tiene asignado un 8.

-

4

Diagn√≥stico espec√≠fi‚Äê Se activa cuando el m√≥dulo puede proporcio‚Äê
co de canal
nar informaci√≥n del canal adicional y hay un
error de canal (consulte DS1 bytes 7 a 12)

2

3

Vigilancia de tiempo Error de hardware
(watch dog) activado

8:x:33

3

2

Error EPROM

M√≥dulo defectuoso

8:x:42

4

Error ADC/DAC

M√≥dulo defectuoso

8:x:44

-

Registro de diagn√≥stico DS1
El registro de diagn√≥stico DS1 se compone de 16 bytes. Los 4 primeros bytes son id√©nticos a
los del registro de diagn√≥stico DS0. La siguiente tabla muestra la asignaci√≥n de los bytes
restantes. Todos los bits que no se incluyen en la tabla son irrelevantes y tienen el valor cero.

Registro de diagn√≥stico DS1 del FM 355-2
Tabla 3-6
Byte

Asignaci√≥n de los bytes del 4 a 12 del registro de diagn√≥stico DS1 del FM 355-2
Bit

Nota

N¬∫ de evento

4

0 ... 7

Tipo de canal

Siempre tiene asignado 75H

-

5

0 ... 7

Longitud de la informaci√≥n de
diagn√≥stico

Siempre tiene asignado un 8.

-

6

0 ... 7

Cantidad de canales

Siempre tiene asignado un 5 (4 regu‚Äê
ladores + 1 canal de referencia)

-

7

0 ... 4

Vector de error de canal

Cada bit tiene asignado un canal (0 a
3, 4 para el canal de referencia).

-

8

0

Error de hardware en la entra‚Äê
da anal√≥gica

8:x:B0

1

sin usar

8:x:B1

2

Rotura de hilo en la entrada
anal√≥gica (s√≥lo en el margen
4 a 20 mA)

8:x:B2

3

sin usar

8:x:B3

4

Rebase por defecto del rango
de medici√≥n en la entrada ana‚Äê
Diagn√≥stico espe‚Äê
l√≥gica
c√≠fico del canal 0
Rebase del rango de medi‚Äê

8:x:B4

5

1112

Significado

8:x:B5

ci√≥n en la entrada anal√≥gica

6

Rotura de hilo en la salida ana‚Äê
l√≥gica

S√≥lo en la salida
de intensidad
del regulador K

8:x:B6

7

Cortocircuito en la salida ana‚Äê
l√≥gica

S√≥lo en la salida
de tensi√≥n del
regulador K

8:x:B7

9

0 ... 7

v√©ase byte 8

Diagn√≥stico espec√≠fico del canal 1

v√©ase arriba

10

0 ... 7

v√©ase byte 8

Diagn√≥stico espec√≠fico del canal 2

v√©ase arriba

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Byte

Bit

Significado

Nota

N¬∫ de evento

11

0 ... 7

v√©ase byte 8

Diagn√≥stico espec√≠fico del canal 3

v√©ase arriba

12

0 ... 5

v√©ase byte 8

Diagn√≥stico para el canal de referen‚Äê
cia

v√©ase arriba

Informaci√≥n adicional
Para obtener m√°s informaci√≥n sobre el par√°metro "RET_REALU", consulte Lista de los avisos
RET_REALU (P√°gina 1114) y el √°rea de instrucciones avanzadas del sistema de ayuda.

Fallo del transductor de medida
Aver√≠as en los transductores de medida
El FM 355-2 puede detectar los siguientes fallos en el transductor de medida:
‚óè Rebase por defecto del rango de medici√≥n
‚óè Rebase del margen de medici√≥n
‚óè Rotura de hilo (no se muestra en todos los m√°rgenes de medici√≥n)
Si se produce una de estas aver√≠as en el registro de diagn√≥stico DS0 se define el bit de error
de grupo "Error externo" y, en el registro de diagn√≥stico DS1, bits de error espec√≠ficos del canal
(consulte las tablas anteriores). Cuando desaparecen estas aver√≠as los bits correspondientes
se desactivan.
La siguiente tabla muestra los l√≠mites de los diferentes m√°rgenes de medici√≥n en los que los
bits de error se activan o desactivan:
Rango de medida

Bit de error Rebase por defecto
del rango de medici√≥n en ...

Bit de error Rebase del rango
de medici√≥n en ...

Bit de error Mostrar rotura de
hilo

DS1: Byte 10 a 26, Bit 4

DS1: Byte 10 a 26, Bit 5

DS1: Byte 10 a 26, Bit 2

0 a 20 mA

< - 3,5 mA

> 23,5 mA

-

4 a 20 mA

Bit de error = 1 a < 3,6 mA

> 22,8 mA

Bit de error = 1 a < 3,6 mA

Bit de error = 0 a > 3,8 mA

Bit de error = 0 a > 3,8 mA

0 a 10 V

< - 1,175 V

> 11,75 V

-

Pt 100

< 30,82 mV

> 650,46 mV

-

< 30,82 mV

> 499,06 mV

-

< 30,82 mV

> 254,12 mV

-

Termoelemento tipo B

< 0 mV

> 13,81 mV

-

Termoelemento tipo E

< -9,84 mV

> 76,36 mV

-

(-200 a 850 ¬∞C)
(-328 a 1562 ¬∞F)
Pt 100
(-200 a 556 ¬∞C)
(-328 a 1032 ¬∞F)
Pt 100
(-200 a 130 ¬∞C)
(-328 a 264 ¬∞F)

(-270,0 a 1000,03 ¬∞C)

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1113

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
Rango de medida

Bit de error Rebase por defecto
del rango de medici√≥n en ...

Bit de error Rebase del rango
de medici√≥n en ...

Bit de error Mostrar rotura de
hilo

DS1: Byte 10 a 26, Bit 4

DS1: Byte 10 a 26, Bit 5

DS1: Byte 10 a 26, Bit 2

Termoelemento tipo J

< - 8,1 mV

> 69,54 mV

-

Termoelemento tipo K

< - 6,45 mV

> 54,88 mV

-

Termoelemento tipo R

< - 0,23 mV

> 21,11 mV

-

Termoelemento tipo S

< - 0,24 mV

> 18,7 mV

-

Termopar libre

< Valor de entrada inferior de la
l√≠nea poligonal

> Valor de entrada superior de
la l√≠nea poligonal

-

Lista de los avisos RET_REALU
Avisos RET_REALU

1114

JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

7000

28672

-32624

Primera llamada con REQ=0: No hay ninguna transferencia de
datos activa; BUSY tiene el valor 0.

7001

28673

-32624

Primera llamada con REQ=1: Transferencia de datos lanzada;
BUSY tiene el valor 1.

7002

28674

-32624

Llamada intermedia (REQ irrelevante). Transferencia de datos
ya activa; BUSY tiene el valor 1.

8090

32912

-32624

La direcci√≥n base l√≥gica indicada no es v√°lida: No existe nin‚Äê
guna asignaci√≥n en el SDB1/SDB2x, o no se trata de una di‚Äê
recci√≥n base.

80A0

32928

-32608

Acuse negativo al leer el m√≥dulo. M√≥dulo extra√≠do durante la
lectura o m√≥dulo defectuoso.

80A1

32929

-32607

Acuse negativo al escribir en el m√≥dulo. M√≥dulo extra√≠do du‚Äê
rante la escritura o m√≥dulo defectuoso.

80A2

32930

-32606

Error de protocolo DP en capa 2

80A3

32931

-32605

Error de protocolo de DP con User-Interface/User

80A4

32932

-32604

Fallo de comunicaci√≥n en el bus K

80B1

32945

-32591

Indicaci√≥n de longitud err√≥nea. Par√°metro FM_TYPE del DB de
canal para el m√≥dulo utilizado no activado correctamente.

80B2

32946

-32590

El slot configurado no est√° ocupado.

80B3

32947

-32589

El tipo de m√≥dulo real no es igual al tipo de m√≥dulo te√≥rico.

80C0

32960

-32576

El m√≥dulo a√∫n no tiene preparados los datos que hay que leer.

80C1

32961

-32575

Los datos de una petici√≥n de escritura semejante todav√≠a no se
han procesado en el m√≥dulo.

80C2

32962

-32574

El m√≥dulo procesa de instante el n√∫mero m√°ximo posible de
peticiones.

80C3

32963

-32573

Los recursos necesarios (memoria, etc.) est√°n ocupados en
estos momentos.

80C4

32964

-32572

Error de comunicaci√≥n

80C5

32965

-32571

La periferia descentralizada no est√° disponible.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

80C6

32966

-32570

Cancelaci√≥n de las clases de prioridad (rearranque normal o en
segundo plano)

8522

34082

-31454

DB del canal o DB de par√°metros demasiado corto. No se pue‚Äê
den leer los datos del DB. (petici√≥n de escritura).

8532

34098

-31438

El n√∫mero de DB del DB de par√°metros es demasiado grande.
(petici√≥n de escritura).

853A

34106

-31430

DB de par√°metros no presente. (petici√≥n de escritura).

8544

34116

-31420

Error en el en√©simo (n > 1) acceso de lectura a un DB tras
aparecer un error (petici√≥n de escritura).

8723

34595

-30941

DB del canal o DB de par√°metros demasiado corto. No se pue‚Äê
den escribir los datos en el DB. (petici√≥n de lectura).

8730

34608

-30928

DB de par√°metros protegido contra escritura en la CPU. No se
pueden escribir los datos en el DB (petici√≥n de lectura)

8732

34610

-30926

El n√∫mero de DB del DB de par√°metros es demasiado grande.
(petici√≥n de lectura).

873A

34618

-30918

DB de par√°metros no presente. (petici√≥n de lectura).

8745

34629

-30907

Error en el en√©simo (n > 1) acceso de escritura a un DB tras
aparecer un error. (petici√≥n de lectura).

80ff

33023

-32513

Indicaci√≥n de √≠ndice incorrecta en el bloque FMT_PAR

Los errores 80A2..80A4 as√≠ como 80Cx son temporales, es decir, se pueden eliminar tras un tiempo de
espera sin la intervenci√≥n del usuario. Los avisos con la estructura 7xxx indican situaciones temporales
de la comunicaci√≥n.

3.5.7

Utilizar el FM 455

3.5.7.1

Configuraci√≥n del FM 455

Configuraci√≥n hardware
Procedimiento
Para poder configurar el hardware debe haber creado previamente un proyecto donde pueda
guardar la parametrizaci√≥n. A continuaci√≥n se explican √∫nicamente los pasos m√°s importantes.
1. Inicie el TIA portal y abra la configuraci√≥n de dispositivos.
2. Seleccione un rack.
3. Seleccione un m√≥dulo de regulaci√≥n del cat√°logo de m√≥dulos.
4. Arrastre el m√≥dulo de regulaci√≥n hasta la posici√≥n correspondiente del rack.
5. Anote la direcci√≥n de entrada del m√≥dulo a partir de la tabla de configuraci√≥n, p. ej. 512.
El valor le√≠do se muestra en formato decimal.

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1115

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

3.5.7.2

Parametrizar el FM 455

Par√°metros del m√≥dulo
Procedimiento
A trav√©s de la parametrizaci√≥n se configuran los par√°metros del m√≥dulo.
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
Seleccione en la ventana de inspecci√≥n la pesta√±a "Propiedades".
Resultado: Las propiedades se muestran en la ventana de inspecci√≥n.
2. Configure los par√°metros b√°sicos del m√≥dulo y el resto de par√°metros.
3. Configure los dem√°s par√°metros del bloque en la vista de configuraci√≥n.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".
5. Compile el proyecto con "Editar > Compilar".
6. Cargue los datos de parametrizaci√≥n en el estado de STOP de la CPU con "Online > Cargar
en dispositivo..."
Resultado: Los datos se encuentran en la memoria de la CPU y se transfieren desde √©sta
directamente al m√≥dulo.
7. Arranque la CPU.

Par√°metros de la entrada anal√≥gica
Evaluaci√≥n de la entrada anal√≥gica
Procedimiento
Para seleccionar un tipo de sensor proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Entrada anal√≥gica > Entrada [n¬∞] > Evaluaci√≥n de
la entrada anal√≥gica".
3. Defina los siguientes par√°metros:
‚Äì Resoluci√≥n entrada anal√≥gica
‚Äì Tipo de sensor entrada anal√≥gica
La opci√≥n "Vigilancia de rotura de hilo" se habilita para diversos tipos de sensor. Se
puede activar la opci√≥n seg√∫n requerimiento.
‚Äì Temperatura de referencia
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

1116

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Funciones de filtro
Procedimiento
Para definir las funciones de filtro proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Entrada anal√≥gica > Entrada [n¬∞] > Funciones de
filtro".
3. Defina los siguientes par√°metros:
‚Äì Active la opci√≥n "Filtro de se√±al" para filtrar por una constante de tiempo.
Si la opci√≥n "Filtro de se√±al" se encuentra seleccionada se puede activar la constante de
tiempo del filtro.
‚Äì Constante de tiempo del filtro
Se puede activar solamente si la opci√≥n "Filtro de se√±al" se encuentra activada.
‚Äì Active la opci√≥n "Filtro de ra√≠z cuadrada" para linealizar la se√±al del sensor.
‚Äì Active la opci√≥n "Filtro de pol√≠gono" para linealizar la caracter√≠stica de la se√±al del
sensor.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Filtro de se√±al
Filtro de primer orden cuya respuesta temporal viene determinada por la constante de tiempo.

Filtro de ra√≠z cuadrada
Su finalidad es linealizar se√±ales de sensores que est√°n en relaci√≥n cuadrada con la magnitud
de proceso medida, en las cuales el valor real obedece a una magnitud f√≠sica.

Filtro de pol√≠gono
Su finalidad es linealizar caracter√≠sticas de sensores.
Los 13 nodos seleccionables se pueden seleccionar en:
‚óè mA en entrada de corriente
‚óè mV en entrada de tensi√≥n

Normalizaci√≥n
Procedimiento
Para convertir la se√±al de entrada en una unidad f√≠sica proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Entrada anal√≥gica > Entrada [n¬∞] > Normalizaci√≥n".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1117

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Defina los siguientes par√°metros:
‚Äì Valor superior
‚Äì Valor inferior
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Normalizaci√≥n
Para convertir la se√±al de entrada en otra unidad f√≠sica mediante interpolaci√≥n lineal entre el
valor inicial (valor inferior) y el valor final (valor superior).

Error de regulaci√≥n
Realizar un regulador de valor fijo o en cascada
Regulador de valor fijo o en cascada
En las estructuras de regulaci√≥n 'Regulador de valor fijo o en cascada' el valor real efectivo es
id√©ntico al valor real A.

Seleccionar el tipo de regulador
Para realizar un regulador de valor fijo o en cascada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞]".
3. En el √°rea "Tipo de regulador" seleccione la opci√≥n "Regulador de valor fijo o en cascada".
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para acondicionar la consigna proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".

1118

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)
3. Active los par√°metros correspondientes en las diferentes √°reas:
‚Äì Origen de la consigna
Seleccione el origen de la consigna.
‚Äì Consigna de seguridad
Ajuste aqu√≠ la consigna de seguridad. Defina asimismo la reacci√≥n a un fallo de la CPU
y el comportamiento en arranque.
‚Äì Rampa de consigna
Defina el tiempo de subida de rampa.
‚Äì L√≠mite de consigna
Seleccione aqu√≠ los l√≠mites superior e inferior de consigna.
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Seleccionar origen de la se√±al para el valor real A
Para seleccionar el origen de la se√±al para el valor real A proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. Seleccione el origen correspondiente en el √°rea "Variable manipulada". Se proporcionan
las siguientes posibilidades de selecci√≥n:
‚Äì Cero
‚Äì Entrada anal√≥gica acondicionada
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Realizar un regulador de 3 componentes
Regulador de 3 componentes
En la estructura de regulaci√≥n 'Regulador de 3 componentes', el valor real efectivo se define
a trav√©s de la suma de los tres valores reales A, B y C, y mediante adici√≥n de un Offset
ajustable. Los valores reales B y C se pueden evaluar adicionalmente mediante factores.

Seleccionar el tipo de regulador
Para materializar un regulador de tres componentes, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞]".
3. En el √°rea "Tipo de regulador" seleccione la opci√≥n "Regulador de 3 componentes".
4. Guarde los par√°metros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnol√≥gicas
Manual de programaci√≥n y manejo, 11/2019

1119

Regulaci√≥n PID
3.5 Regulaci√≥n PID (S7-300, S7-400)

Acondicionamiento de la consigna
Para ajustar c√≥mo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuraci√≥n de par√°metros" del m√≥dulo.
2. En la vista de configuraci√≥n seleccione "Regulador > Canal [n¬∞] > Error de regulaci√≥n".
3. Seleccione en el √°rea "Origen de la consigna" el origen de referencia de la consigna.
4. Especifique un valor en el √°rea "Consigna de seguridad", el cual ser√° tomado como
consigna de seguridad en caso de fallo de la CPU y durante el arranque.
5. Especifique el comportamiento del m√≥dulo de regulaci√≥n v√°lido como "Reacci√≥n a fallo de
la CPU" y para el "Comportamiento en arranque". Las posibilidades de selecci√≥n son:
‚Äì Consigna = √∫ltima consigna v√°lida: al producirse el evento 