en la entrada I1, tiene que ser mayor
que 2 ms.

Alarmas de proceso
El inicio y el fin de una medición pueden notificarse con alarmas de proceso en el FM 452.

Medición con errores
En caso de una medición de longitud/captura de bordes con errores, el FM 452 devuelve el
valor -1 para la longitud.
Una "Medición de longitud" o "Captura de bordes" debería ejecutar un máximo de 126 cambios
a cero en un sentido. Un cambio a cero es el cambio del eje rotativo del valor final del eje
rotativo a 0 y a la inversa. En cuanto el FM 452 detecta más de 126 pasos por cero en un
sentido, notifica una "Medición de longitud" o una "Captura de bordes" errónea, aunque luego
haya detectado nuevamente pasos por cero en el otro sentido.
Una medición también es errónea si
● en un eje rotativo la longitud medida es superior a 231 ,
● el FM 452 simultáneamente el flanco de activación y el de desactivación (p. ej. por rebotes
del conector).
Este evento se puede comunicar como alarma de proceso.

Desplazamiento del sistema de coordenadas durante una medición de longitud
Los desplazamientos de coordenadas afectan a la longitud medida bajo las condiciones
siguientes:
● Se utiliza un encóder incremental o un detector de proximidad, o bien el FM 452 en el modo
de simulación.
● Se ejecuta "Definir punto de referencia" o "Redisparar punto de referencia" durante una
medición de longitud.

Ejemplo
Es posible emplear la influencia arriba indicada de la longitud medida del modo que sigue:
Se dispone de un sistema en el que durante una medición de longitud siempre se produce un
deslizamiento.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

577

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Con el "Redisparo del punto de referencia" es posible corregir este deslizamiento de forma que
se emitan los valores medidos de longitud correctos.

Redisparar punto de referencia
Definición
Con la función "Redisparar punto de referencia" es posible sincronizar el eje en función de un
evento externo repetitivo.
La función se mantiene activa hasta que se desactiva de nuevo.

Requisitos
● Se emplea un encóder incremental o un detector de proximidad.
● El evento externo puede ser una señal de paso por cero de un encóder incremental o un
sensor del punto de referencia en la entrada I2.

Desarrollo de la función
1. Introduzca el valor de la coordenada del punto de referencia en el DB de parámetros.
2. Introduzca el tipo de "Redisparar el punto de referencia" en el DB de parámetros.
Para ello, existen las posibilidades siguientes:
– Sólo se evalúa la señal de paso por cero del encóder (RETR_TYPE = 7).
– Sólo se evalúa el sensor del punto de referencia (RETR_TYPE = 6).
– Se evalúa la señal de paso por cero
en sentido positivo: Se evalúa el primer flanco ascendente de la señal de paso por cero
tras abandonar el sensor del punto de referencia en sentido positivo (RETR_TYPE = 0).
en sentido negativo: Se evalúa el primer flanco descendente de la señal de paso por
cero tras abandonar el sensor del punto de referencia en sentido negativo (RETR_TYPE
= 1).
3. Escriba y active los datos máquina.
4. Active el selector de función del DB de canal.

Datos utilizados en el DB de canal
Dirección

Nombre

34.3

REFTR_ON

25.0

SYNC

578

Tipo

valor inicial

Comentarios

BOOL

FALSE

1 = Redisparar el punto de referencia

BOOL

FALSE

1 = Eje sincronizado

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

44.0

REFPT

DINT

L#0

Coordenada del punto de referencia

52.0

RETR_TYPE

DINT

L#0

Forma de "Redisparar el punto de referencia"

Efectos de la función
● El FM x52 evalúa la señal de paso por cero y el sensor del punto de referencia en función
del sentido del movimiento del eje.
– En caso de un sentido positivo se evalúan los flancos ascendentes.
– En caso de un sentido de movimiento negativo se evalúan los flancos descendentes.
● La posición real se fija en el valor de la coordenada del punto de referencia.
● La zona de trabajo se desplaza físicamente en el eje.
● Cada uno de los puntos conserva su valor original, pero se encuentran en posiciones físicas
nuevas.
● Los cambios de estado de la leva que normalmente dispararían una alarma, se pueden
perder.
● El bit SYNC de las señales de realimentación se activa.
Nota
Tenga en cuenta el comportamiento de conmutación con las levas de tiempo (Página 563).

Ejemplo
Para este ejemplo rige:
● Del sensor del punto de referencia y la señal de paso por cero se evalúan los flancos
ascendentes (sentido positivo del eje).
● La coordenada del punto de referencia tiene el valor 300 mm.
● En el instante de la ejecución no hay activo ningún decalaje de señal cero.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

579

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra el desplazamiento de la zona de trabajo en el eje a través de la
función "Redisparar punto de referencia".
Redisparar punto de referencia
)&6,

5($/
 

DGH
WUDE
=RQ
 )&6,



REF

REAL

FCSF

[mm]

[mm]

[mm]

[mm]

-400

300

100

400

-400

300

300

400

)&6) 6LVWHPDGHFRRUGHQDGDVDQWHULRU

5()



>PP@

'HFDODMH
GHOD]RQDGH
WUDEDMRSRU
UHGLVSDUDUSWR
GHUHIHUHQFLDD
PP

DMR

(MH



FCSI

>PP@


)&6)
5($/ 5()

1XHYRVLVWHPDGHFRRUGHQDGDV

Consideración de un decalaje de señal cero
Cuando hay un decalaje de señal cero activo, se tiene en cuenta en la función "Redisparar
punto de referencia". Esto significa que la coordenada del punto de referencia que se activará,
se calculará conforme a la fórmula siguiente:
Ref = RefDM - Decalaje de señal cero
RefDM es el valor depositado en los datos máquina a modo de coordenada del punto de
referencia.

580

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra el desplazamiento de la zona de trabajo en el eje a través de la
función "Redisparar punto de referencia" con decalaje de señal cero.
Redisparar punto de referencia

FCSI

REF

REAL

FCSF

[mm]

[mm]

[mm]

[mm]

-500

300

0

300

-400

400

100

400

-400

400

400

400

6LVWHPDGHFRRUGHQDGDVDQWHULRU
)&6,

)&6)

5($/



5()



>PP@

(MH



'6& 

DMR



=R

QD
G

HW

UDE

'HFDODMH
GHOD]RQDGH
WUDEDMRSRU
UHGLVSDUDUSWR
GHUHIHUHQFLD



 )&6,

>PP@



)&6) 5() 5()'6&
'0
1XHYRVLVWHPDGHFRRUGHQDGDV

Desconectar el final de carrera por software
Definición
La función "Desconectar final de carrera por software" desactiva la vigilancia del final de
carrera por software de un eje lineal.
La función se mantiene activa hasta que se desactiva de nuevo. Entonces se vuelven a activar
los finales de carrera parametrizados originalmente.

Desarrollo de la función
Active el selector de función en el DB de canal.

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

Valor inicial

Comentarios

34.4

SSW_OFF

BOOL

FALSE

1 = Final de carrera por software desconectado

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

581

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

Valor inicial

Comentarios

64.0

SSW_STRT

DINT

L# -1000000000

Final de carrera por software Inicio

68.0

SSW_END

DINT

L#1000000000

Final de carrera por software Fin

Efectos de la función
● Simulación
– Si en el modo de simulación se rebasa un final de carrera por software se detiene el
modo de simulación.
– Si desactiva entonces la vigilancia del final de carrera por software, el modo de
simulación prosigue. El eje se desplaza en la dirección indicada.
● Decalaje de señal cero con vigilancia desactivada
Si se define un decalaje de señal cero en el que los finales de carrera por software se
encuentran todavía dentro de los límites de la zona de desplazamiento, el valor real puede
encontrarse fuera del rango de contaje admisible.
● Las levas que se encuentran fuera del final de carrera por software parametrizado, se
pueden activar.
PRECAUCIÓN
Se pueden producir daños materiales.
Si limita la zona de desplazamiento con finales de carrera por software y protege con ello
su instalación, al desconectar los finales de carrera por software se pueden producir daños
materiales.
Por ello, al planificar la instalación cuide que el accionamiento pueda desplazarse por toda
la zona de desplazamiento física.

Ejecutar la "Simulación"
Definición
La función "Simulación" brinda la posibilidad de activar la leva electrónica sin un encóder
conectado.

Desarrollo de la función
1. Introduzca la velocidad de simulación en el DB de parámetros.
2. Escriba y active los datos máquina.
3. En el DB de canal seleccione como sentido de la simulación el sentido positivo o negativo.
4. Active el selector de función del DB de canal.

582

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

valor inicial

Comentarios

15.2

DIR_M

BOOL

FALSE

1 = Simulación en el sentido negativo

15.3

DIR_P

BOOL

FALSE

1 = Simulación en el sentido positivo

34.1

SIM_ON

BOOL

FALSE

1 = Simulación activa

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

84.0

SIM_SPD

DINT

L#0

Velocidad de simulación

Efectos al activar la simulación
● Las señales de encóder dejan de evaluarse.
● Todas las supervisiones referidas a la entrada del encóder se desconectan.
● Los errores que se hayan notificado con respecto al encóder, se desactivan.
● El FM x52 simula el movimiento de un eje a una velocidad de simulación constante.
● El procesamiento de levas se desactiva con la activación de la simulación. Sin embargo, es
posible activarlo de nuevo. La sincronización se mantiene.
● El valor real de la posición cambia a partir del valor real actual, dependiendo de la velocidad
y del sentido de la simulación.

Efectos al desactivar la simulación
● El procesamiento de levas se desactiva.
● En caso de un encóder incremental o un detector de proximidad, la sincronización se borra.
Entonces como valor real se define el valor de la coordenada del punto de referencia.
● En el caso de un encóder absoluto se notifica el valor real de la posición, que se
corresponde con la posición actual del encóder. Las señales del encóder se evalúan de
nuevo tal como se han parametrizado en los datos máquina.

Valores límite
Los límites máximo y mínimo de la velocidad de simulación dependen de la resolución
(Página 599).

Velocidad
Entre la velocidad definida y la velocidad real (Página 599) a la que funciona el módulo, puede
haber diferencias.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

583

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Leer "Valores de contaje de las pistas de leva de contaje"
Definición
La función "Valores de contaje de las pistas de leva de contaje" permite leer los valores de
contaje actuales.

Desarrollo de la función
1. Defina las pistas de la leva de contaje y los valores de contaje superiores en los datos
máquina.
2. Escriba y active los datos máquina.
3. Habilite la función de contaje.
4. El valor de contaje se fijará en el valor de contaje superior.
5. Con cada flanco ascendente del resultado de la pista el valor de contaje se reducirá en 1.
6. Active el bit de inicio en el DB de canal para la lectura de los valores de contaje.
7. Los valores de contaje de las dos pistas se escriben en el DB de canal. Para una pista no
parametrizada como pista de leva de contaje se emite 0.
8. Si el valor de contaje alcanza el valor 0, el bit identificador de la pista de leva de contaje se
pone a 1.
9. Con el siguiente flanco descendente del resultado de pista, el bit identificador vuelve a 0 y
el contador se pone al valor de contaje superior.

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

valor inicial

Comentarios

15.5

CNTC0_EN

BOOL

FALSE

1 = Habilitar la función de contaje de la pista de leva de
contaje 0

15.6

CNTC1_EN

BOOL

FALSE

1 = Habilitar la función de contaje de la pista de leva de
contaje 1

38.3

CNTTRC_EN

BOOL

FALSE

1 = Leer valores de contaje de la pista de leva de contaje

124.0

CNT_TRC0

INT

0

Valor de contaje actual para la pista de leva de contaje 0

126.0

CNT_TRC1

INT

0

Valor de contaje actual para la pista de leva de contaje 1

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

99.0

SPEC_TRC0

BOOL

FALSE

1 = Pista 0 es pista de leva de contaje

99.1

SPEC_TRC1

BOOL

FALSE

1 = Pista 1 es pista de leva de contaje

100.0

CNT_LIM0

DINT

L#2

Valor de contaje superior para la pista de leva de contaje
0

104.0

CNT_LIM1

DINT

L#2

Valor de contaje superior para la pista de leva de contaje
1

584

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Leer "Datos de posición y pista"
Definición
Con la función "Datos de posición y pista" se lee la posición, la velocidad y el bit identificador
de pista en ese instante. Los bits identificadores de pista se capturan antes de combinarlos con
los datos máquina y de canal.
El algoritmo de cálculo implantado en el FM x52 calcula cambios de velocidad mayores que 1
impulso por 4 ms. La velocidad que se muestra, por lo tanto, incluye imprecisión y no es
conveniente para fines de cálculo. La velocidad interna que se emplea para dinamizar las levas
es más precisa.

Desarrollo de la función
1. Active el bit de inicio en el DB de canal.
2. Los datos se depositan en el DB de canal.

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

valor inicial

Comentarios

38.4

ACTPOS_EN

BOOL

FALSE

1 = Leer Datos de posición y pista

128.0

ACTPOS

DINT

L#0

Posición actual

132.0

ACTSPD

DINT

L#0

Velocidad actual

136.0

TRACK_ID

DWORD

DW#16#0

Bits identificadores de pista de las pistas 0 a 31

Leer "Datos de encóder"
Definición
Con la función "Datos de encóder" se leen los datos actuales del encóder así como el valor del
reajuste del encóder absoluto.

Requisitos
Es posible leer el valor para el reajuste del encóder absoluto (Página 594) después de
ejecutar la función "Definir punto de referencia (Página 569)".

Desarrollo de la función
1. Active el bit de inicio en el DB de canal.
2. Los datos se depositan en el DB de canal.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

585

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

valor inicial

Comentarios

38.5

ENCVAL_EN

BOOL

FALSE

1 = Leer valores del encóder

140.0

ENCVAL

DINT

L#0

Valor de encóder / Lectura del contador (representación
interna)

144.0

ZEROVAL

DINT

L#0

Lectura del contador en la última señal de paso por cero
(representación interna)

148.0

ENC_ADJ

DINT

L#0

Reajuste del encóder absoluto

Leer los "Datos de leva y pista"
Definición
Con la función "Datos de leva y pista" se leen los bits identificadores de leva y de pista actuales
así como la posición en ese instante. Los bits identificadores de pista se capturan antes de
combinarlos con los datos máquina y de canal.

Desarrollo de la función
1. Introduzca como identificador de tipo un 1 en el parámetro FM_TYPE del DB de canal. Con
ello es posible leer los datos de leva y de pista de 24 bytes.
Si introduce 0 como identificador de tipo sólo se leerán los bits identificadores de la leva (16
byte).
2. Los datos se depositan en el DB de canal.

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

valor inicial

Comentarios

12.0

FM_TYPE

BOOL

FALSE

0 = FM 352 a V4.0

38.6

CAMOUT_EN

BOOL

FALSE

1 = Leer datos de leva y pista

152.0

CAM_00_31

DWORD

DW#16#0

Bits identificadores de la leva para las levas de 0 a 31

156.0

CAM_32_63

DWORD

DW#16#0

Bits identificadores de leva para las levas de 32 a 63

160.0

CAM_64_95

DWORD

DW#16#0

Bits identificadores de la leva para las levas de 64 a 95

164.0

CAM_96_127

DWORD

DW#16#0

Bits identificadores de la leva para las levas de 96 a 127

168.0

TRACK_ID1

DWORD

DW#16#0

Bits identificadores de pista de las pistas 0 a 31

172.0

ACTPOS1

DINT

L#0

Posición actual

1 = FM 352 a partir de V5.0 y FM 452

Activar "Señales de control de la leva electrónica"
Definición
Con la función "Señales de control de la leva electrónica" se habilita el procesamiento de levas
así como las pistas.

586

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Proceso de la función
1. Active los bits que desee en el DB de canal.
2. Con cada llamada de la instrucción CAM_CTRL o CAM_CTRL_452 los datos se transfieren
al módulo.

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

valor inicial

Comentarios

15.4

CAM_EN

BOOL

FALSE

1 = Habilitar el procesamiento de levas

16.0

TRACK_EN

WORD

W#16#0

Habilitar pistas de leva de 0 a 12
Bit 0 = Pista 0

Efectos
El procesamiento de levas se inicia o se detiene según la habilitación.
Los bits identificadores de pista de las pistas habilitadas se transfieren a las señales de pista
y a las salidas digitales.

Consultar "Señales de realimentación de la leva electrónica"
Definición
Con la función "Señales de respuesta de la leva electrónica" se informa del estado actual de
la leva y de las señales de pista. La coherencia entre la posición indicada y las señales de pista
no está asegurada.

Proceso de la función
Con cada llamada de la instrucción CAM_CTRL o CAM_CTRL_452 los datos se depositan en
el DB de canal.

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

valor inicial

Comentarios

23.4

CAM_ACT

BOOL

FALSE

1 = Procesamiento de levas activo

26.0

ACT_POS

DINT

L#0

Posición actual del eje

30.0

TRACK_OUT

DWORD

DW#16#0

Señales de pista actuales de las pistas 0 a 31
Bit 0 = Pista 0

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

587

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Consultar "Señales de realimentación del diagnóstico"
Definición
Con el ajuste "Señales de realimentación del diagnóstico" se recibe información sobre los
eventos de diagnóstico que se han producido.

Proceso de ajuste
1. Cuando el módulo realiza una nueva entrada en el búfer de diagnóstico, activa el bit DIAG
en la interfaz de realimentación. Cada aparición de un error (Página 632) provoca una
entrada en el búfer de diagnóstico.
2. Cuando el módulo detecta una petición de escritura con datos erróneos, activa el bit
DATA_ERR en la interfaz de realimentación. La causa del error se registra en el búfer de
diagnóstico.
3. La instrucción CAM_CTRL o CAM_CTRL_452 coloca la interfaz de realimentación en el DB
de canal.
4. Una vez que la instrucción CAM_DIAG o CAM_DIAG_452 haya leído el búfer de
diagnóstico, el módulo restablece el bit DIAG a 0.

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

valor inicial

Comentarios

22.2

DIAG

BOOL

FALSE

1 = Búfer de diagnóstico modificado

22.4

DATA_ERR

BOOL

FALSE

1 = Error de datos

2.1.4.3

Configurar FM 452

2.1.4.4

Parametrizar el FM 452

Sistema de medición
Seleccionar sistema de medidas
Seleccionar sistema de medidas
Para la entrada y salida de datos es posible elegir entre los siguientes sistemas de medida:
● Milímetros (ajuste predeterminado)
● Inch
● Grados
● Impulsos

588

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Nota
Si se modifica el sistema de medida en el cuadro de diálogo "Sistema de medida", los valores
se convierten al nuevo sistema. Aquí se pueden producir errores de redondeo.
Si se modifica el sistema de medida mediante el dato máquina, los valores no se convierten
automáticamente.
Si el sistema de medida cambia de o a "impulsos", el procesamiento de levas se desactivará
y el eje dejará de estar sincronizado.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentario

8.0

UNITS

DINT

L#1

Sistema de medida
Valores permitidos:
● 1 = 10-3 mm
● 2 = 10-4 pulgadas
● 3 = 10-4 grados
● 4 = 10-2 grados
● 5 = Impulsos
● 6 = 10-3 grados

Sistema de medida estándar en la ayuda en pantalla
Para la indicación de valores límite se utiliza el sistema de medida mm. Por ello, para
determinar los valores límite en los otros sistemas de medida, realice la conversión siguiente:
Para convertir de

calcule

mm → pulgadas
mm → grados

Valor límite (inch) = valor límite (mm) × 0,1 1)

10 (4 decimales)

Valor límite (grados) = valor límite (mm) × 0,1

10-3 (3 decimales)

Valor límite (grados) = valor límite (mm) × 1

10 (2 decimales)

Valor límite (grados) = valor límite (mm) × 10

-4

-2

mm → impulsos
1)

Valor límite (impulsos) = valor límite (mm) x 1000

En el valor máximo el número de decimales repercute en el número de dígitos que preceden a la
coma. En el sistema de medida Inch se utilizan 4 decimales, por lo tanto se pueden introducir como
máximo 100 000,0000 inch. El sistema de medida Milímetros utiliza 3 decimales y por lo tanto se
pueden introducir como máximo 1 000 000,000 mm.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

589

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Eje
Definir tipo de eje
Seleccionar tipo de eje
Tipos de eje
La leva electrónica soporta los siguientes tipos de ejes:
● Eje lineal
El eje lineal es un eje con una zona de desplazamiento física limitada.

,QLFLRI¯VLFR

)LQDOI¯VLFR

● Eje rotativo
El eje rotativo es un eje cuya zona de desplazamiento no está limitada por topes mecánicos.
,QLFLRGHOHMHURWDWLYR 
)LQDOGHOHMHURWDWLYR

(OYDORUPD\RULQGLFDGR

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

12.0

AXIS_TYPE

DINT

L#0

Tipo de eje
Valores permitidos:
● 0 = Eje lineal
● 1 = Eje rotativo

Definir final de carrera por software
Final de carrera por software
Los finales de carrera por software existen sólo para el eje lineal.
El área limitada por el final de carrera por software es la zona de trabajo. Los límites de la zona
de trabajo pueden ser vigilados por el FM x52.
El inicio del final de carrera por software (FCSI) debe ser siempre menor que el fin del final de
carrera por software (FCSF).

590

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Los finales de carrera por software están activos cuando el FM x52 está sincronizado.
● Si se utiliza un encóder incremental o un detector de proximidad:
Después de cada arranque del FM x52 el eje no está sincronizado. Sólo tras una
sincronización se vigilan los finales de carrera por software parametrizados.
● Si se utiliza un encóder absoluto (SSI):
El FM x52 está sincronizado después de haber recibido un telegrama completo y sin
errores. A partir de este instante los finales de carrera por software son vigilados. El
encóder absoluto utilizado tiene que abarcar por lo menos la zona de trabajo, incluido el
final de carrera por software.

Relación entre la zona de trabajo, del encóder y la zona de desplazamiento
● La zona de trabajo es el área que el usuario define para sus tareas mediante los finales de
carrera por software.
● El zona del encóder es el área que el encóder cubre claramente. En el caso de un eje lineal
del módulo, el área del encóder se define de forma simétrica por encima de la zona de
trabajo. Es decir, el módulo desplaza la zona del encóder de tal modo que las distancias
entre los finales de carrera por software y los finales de la zona del encóder son iguales en
cada caso (véase la figura en la parte de abajo).
● La zona de desplazamiento es el rango de valores que puede procesar el FM x52. La zona
de desplazamiento depende de la resolución.
Se debe considerar: Zona de desplazamiento ≥ Rango del encóder ≥ Zona de trabajo
La figura siguiente muestra la relación entre los finales de carrera por software, la zona de
trabajo, el rango del encóder y la zona de desplazamiento.
=RQDGHWUDEDMR

(MH

)&6,



=RQDGHDOFDQFHGHOHQFµGHU
0DUJHQGHGHVSOD]DPLHQWR

)&6)





Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

64.0

SSW_STRT

DINT

L# -100.000.000

Final de carrera por software Inicio

68.0

SSW_END

DINT

L# 100.000.000

Final de carrera por software Fin
Rango de valores admisible:
● -1 000 000 000 µm a 1 000 000 000 µm

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

591

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Definir final del eje rotativo
Final del eje rotativo
El valor "Final del eje rotativo" es el valor máximo teórico que el valor real puede alcanzar. Sin
embargo, el máximo valor teórico nunca se indica porque físicamente identifica la misma
posición que el inicio del eje rotativo (0).
El valor más grande que se muestra en el caso de un eje rotativo es:
Final del eje rotativo [µm] - Resolución [µm/impulso] × 1 [impulso]
Ejemplo: Final del eje rotativo 1000 mm
La visualización pasa:
● Con un sentido de giro positivo, de 999 mm a 0 mm.
● con un sentido de giro negativo, de 0 mm a 999 mm.

Eje rotativo con encóders absolutos
En el caso de un eje rotativo con un encóder absoluto, el área del eje rotativo (0 hasta el final
del eje rotativo) tiene que coincidir exactamente con el total de pasos del encóder absoluto.
wP
3DVRV HQFRGHU >SXO@
)LQGHHMHURWDWLYR>wP@ Q¼PHURGHYXHOWDV HQFRGHU   5(6>@
9XHOWD
3XOVR

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

16.0

ENDROTAX

DINT

L#100000

Final del eje rotativo
Rango de valores admisible:
● 1 µm a +1 000 000 000 µm

Definir sincronización
Seleccionar la "Forma de redisparar el punto de referencia"
Redisparar el punto de referencia
Con la forma de "Redisparar el punto de referencia (Página 578)" se definen las condiciones
de sincronización del eje para el funcionamiento con un encóder incremental o un detector de
proximidad.

592

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

52.0

RETR_TYPE

DINT

L#0

Forma de "Redisparar el punto de referencia"
Valores permitidos:
● 0 = sensor del punto de referencia y señal de paso por
cero en sentido +
● 1 = sensor del punto de referencia y señal de paso por
cero en sentido ● 6 = sólo sensor del punto de referencia
● 7 = sólo señal de paso por cero

Definir la coordenada del punto de referencia
Coordenada del punto de referencia
● Encóder incremental y detector de proximidad:
Con el selector de función "Redisparar punto de referencia" y un evento de sincronización,
definido por la forma de "Redisparar el punto de referencia" (Página 592), se asigna a este
evento la coordenada del punto de referencia.
● Encóder absoluto (SSI)
Un eje parametrizado con un encóder absoluto siempre está sincronizado después de la
transmisión del primer telegrama SSI sin errores.
Consulte al respecto también la descripción del reajuste del encóder absoluto
(Página 594), en la que se explica la interacción de dicho ajuste con el resto de datos.
El valor de la coordenada del punto de referencia se encuentra dentro de la zona de trabajo:
● Eje lineal
Incluido el final de carrera por software.
● Eje rotativo
Mayor o igual que 0 y menor que el valor "Final del eje rotativo" (0 ≤ coordenada del punto
de referencia < final del eje rotativo).

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

44.0

REFPT

DINT

L#0

Coordenada del punto de referencia
Rango de valores admisible:
● -1.000.000.000 µm a +1.000.000.000 µm

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

593

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Definir reajuste del encóder absoluto
Calcular reajuste del encóder absoluto
Definición
El reajuste del encóder absoluto sólo es necesario para un encóder absoluto (SSI).
Con el reajuste del encóder absoluto y las coordenadas del punto de referencia el rango de
valores del sensor se reproduce claramente en el sistema de coordenadas del eje. Se calcula
el valor del encóder que equivale a la coordenada del punto de referencia en el eje. El valor
tiene que ser menor que el total de pasos del encóder absoluto.
Encontrará más información al respecto en "Procedimiento de reajuste del encóder absoluto
(Página 594)", así como en un ejemplo (Página 595).

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

48.0

ENC_ADJ

DINT

L#0

Reajuste del encóder absoluto
Rango de valores admisible:
● 0 a (225 - 1)

Datos utilizados en el DB de canal
Dirección

Nombre

Tipo

valor inicial

Comentarios

98.0

REFPT

DINT

L#0

Coordenada del punto de referencia
Rango de valores admisible:
● -1.000.000.000 µm a +1.000.000.000 µm

Procedimiento para un reajuste del encóder absoluto
Determinar el reajuste correcto del encóder absoluto
Tras la primera parametrización hay que llevar a cabo otros pasos para que se establezca una
relación correcta entre el encóder y el sistema de coordenadas. El proceso se representa
utilizando el cuadro de diálogo de parametrización.
1. Desplace el eje a un punto definido y reproducible que físicamente sea único.
Puede ser, por ejemplo, el "Fin del final de carrera por software".
2. Llame el ajuste "Definir punto de referencia (Página 569)" con la coordenada del punto
definido en 1.
El FM x52 determina entonces un valor de encóder para la coordenada del punto de
referencia registrada en el eje en el DB de canal (REFPT): el reajuste del encóder absoluto.
Este valor se puede leer con el ajuste "Datos de encóder (Página 585)".
3. Registre el valor leído en el campo "Reajuste del encóder absoluto".

594

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
4. Guarde la parametrización en el DB de parámetros correspondiente con la función de
exportación.
5. Cargue los datos de HWCN en la CPU.
6. Para activar los datos, rearranque la CPU.
Nota
Esta sincronización se realiza una vez en la puesta en marcha. Tras una parametrización, el
FM x52 queda sincronizado durante el arranque en cuanto se recibe un telegrama sin errores
del encóder.

Alternativa: Reajuste mecánico de un encóder
También se puede obtener una relación correcta entre el sistema de coordenadas y el encóder
del modo siguiente:
1. Desplace el eje a un punto definido y reproducible que físicamente sea único.
Puede ser, por ejemplo, el "Inicio del final de carrera por software".
2. Introduzca este valor de coordenadas en los datos máquina a modo de "coordenada del
punto de referencia".
3. Lea el valor de encóder que se muestra en esta posición con el ajuste "Datos de encóder
(Página 585)".
4. Introduzca este valor como reajuste del encóder absoluto en los datos máquina.
Tras la parametrización se mostrará siempre un valor real correcto.
En lugar del paso 3 y 4 también es posible resetear a cero el codificador a través de la opción
"Reset", si está disponible. A continuación, introduzca el valor "0" como reajuste del encóder
absoluto en los datos máquina.

Ejemplo para un reajuste del encóder absoluto
Ejemplo para un reajuste del encóder absoluto
Para este ejemplo se parte de las premisas siguientes:
● Coordenada del punto de referencia = -125 mm
● Área de trabajo de SSW_STRT = -1.000 mm a SSW_END = 1.000 mm
● Reajuste del encóder absoluto = 0
● Área del encóder = 2.048 incrementos con una resolución de 1 mm/impulso
● El encóder absoluto utilizado no permite un ajuste mecánico exacto y tampoco ofrece la
posibilidad de definir el valor del encóder.
La figura siguiente muestra un ejemplo de reajuste del encóder absoluto.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

595

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

GHVHDGR

(MH
9DORUGHOHQFµGHUDEVROXWR

(QFµGHU

9DORUUHDO  






9DORUGHOHQFµGHU



(MH

DFWXDOPHQWH




 



1)

Asignación del sistema de coordenadas a los valores del sensor con el reajuste de encóder
absoluto definido. El valor del encóder 0 equivale al valor real -125.

2)

Asignación deseada del sistema de coordenadas con respecto al encóder. En esta posición, la
coordenada tiene que ser -125.

Resultado tras "Definir el punto de referencia"
Tras "Definir el punto de referencia", la relación es la siguiente:
La coordenada del punto de referencia en el eje (-125) se asigna al valor del encóder calculado
(1798) a partir del reajuste del encóder absoluto. La figura siguiente muestra esta asignación.
$OFDQFHTXHSXHGHFXEULUVHFODUDPHQWHFRQHVWHHQFµGHU

(MH



 






)&6)

9DORUGHOHQFµGHUDEVROXWR

)&6,







9DORUFDOFXODGRGHO
UHDMXVWHGHOHQFµGHU
DEVROXWR




El encóder devuelve 2.048 valores unívocos. La zona de trabajo está definida por el final de
carrera por software. Sin embargo, debido a la resolución seleccionada de 1 mm por impulso,
el encóder puede abarcar una zona de trabajo mayor que la prevista por el final de carrera por
software.
Con la resolución definida, la zona de trabajo está ya cubierta con 2.001 valores. Por ello en
el ejemplo quedan 47 impulsos "sobrantes" dispuestos simétricamente alrededor de la zona de
trabajo.

596

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Definir histéresis
Histéresis
El rango de valores de la histéresis (Página 470) depende de la resolución (Página 603).
El valor máximo de entrada es como sigue:
● En el caso de ejes lineales: Valor de entrada máximo < ¼ de la zona de trabajo
● En el caso de los ejes rotativos: Valor de entrada máximo < ¼ del área del eje rotativo

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

80.0

HYS

DINT

L#0

Histéresis
Rango de valores admisible:
● 0 … 65.535 [Imp] × resolución [µm/Imp]

Leva de recorrido con histéresis
Una leva de recorrido se acciona cuando se cumplen las siguientes condiciones:
● el valor real detectado se encuentra dentro de la leva de recorrido
● la histéresis no está activada.
Según la posición en la que tiene lugar el cambio de sentido, puede variar la posición de un
punto de cambio.
La siguiente figura muestra el comportamiento de conmutación de una leva de recorrido en el
caso de una histéresis.



6HQWLGRGHDFWXDFLµQ
,/
)/
      






&DPELRGHVHQWLGR


&DPELRGHVHQWLGR





Leva
Histéresis
1)

La leva se activa porque el principio de leva se rebasa en sentido de actuación positivo.

2)

A pesar del cambio de sentido, la leva permanece activada debido a la histéresis.

3)

La leva se desactiva al final de la histéresis.

4)

La leva permanece desactivada tras el cambio de sentido.

5)

Tras el final de la histéresis la leva se activa nuevamente.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

597

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Nota
Las levas de recorrido que son más cortas que la histéresis no pueden ser acortadas por la
histéresis en caso de un cambio de sentido.

Levas de tiempo con histéresis
La leva de tiempo se acciona cuando se cumplen las siguientes condiciones:
● El principio de leva se rebasa en el sentido de actuación.
● la histéresis no está activada.
Nota
Si el área comprendida entre el punto de inversión y el principio de leva de tiempo es menor
que la histéresis la leva de tiempo quedará oculta por la histéresis.
La siguiente figura muestra el comportamiento de conmutación de una leva de tiepo en el caso
de una histéresis. Se representa una leva de tiempo que no se activa de nuevo.

 

6HQWLGRGHDFWXDFLµQ
,/
      




&DPELRGHVHQWLGR

&DPELRGHVHQWLGR


Leva
Histéresis

598

1)

La leva se activa porque el principio de leva se rebasa en sentido de actuación positivo.

2)

Tras el cambio de sentido y hasta que ha transcurrido el tiempo de conexión la leva se
mantiene activada, independientemente de la histéresis.

3)

El principio de leva queda oculto por la histéresis, la leva no se activa.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Definir velocidad de simulación
Velocidad de simulación
Este dato máquina define la velocidad de la "simulación". Tenga en cuenta a este respecto la
información incluida en "Influencia de los ajustes en el comportamiento de conmutación de las
levas de tiempo (Página 563)".
La velocidad de simulación real Vsim puede diferir de la velocidad de simulación introducida Vsim,
V y se calcula conforme a la fórmula siguiente:
9
6LP 

 H[S 5(6
(QWHUR

 H[S 5(6


9
6LP9

En esta fórmula:
● Vsim: es la velocidad de simulación definida por el FM 352. Unidad: µm/min
● Vsim, V: es la velocidad de simulación que el usuario define en los datos máquina.
Unidad: µm/min
● RES: Resolución calculada a partir de los datos del encóder. Unidad: µm/Impulso
● Entero ( ): a partir de esta expresión, sólo se tiene en cuenta el valor previo al decimal para
otros cálculos. Esta expresión tiene que encontrarse dentro del rango de 2 ... 65.536 en
todos los cálculos.
Las diferentes relaciones (véase la fórmula anterior) provocan cambios inesperados en la
velocidad de simulación real.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

84.0

SIM_SPD

DINT

L#0

Velocidad de simulación
Rango de valores admisible:
● 0 = Parada
● 5 × 108 = Ajuste máximo del módulo
Dentro de este rango la velocidad de simulación depende
de la resolución (Página 603):
1000 × resolución ≤ velocidad de simulación
≤ 3 × 107 × resolución

Definir distancia mínima entre bordes
Distancia mínima entre bordes
En una captura de bordes, con este dato máquina se define un área tras detectar el inicio de
la medición. Si el final del proceso de medición se encuentra dentro de este rango, la medición
se desestima.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

599

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
El inicio de la medición se notifica en cuanto se ha recorrido la distancia mínima entre bordes.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

4.0

EDGEDIST

DINT

L#0

Distancia mínima entre bordes
Rango de valores admisible:
● 0 ... 1.000.000.000 µm

Encóder
Seleccionar tipo de señal
Tipo de señal
El encóder da información de recorrido al módulo, el cual la evalúa y la convierte en un valor
real con la resolución.
Es posible seleccionar un tipo de señal de uno de los encóders (Página 474) siguientes:
● Señal diferencial de 5 V (Página 475)
Seleccione el tipo de señal "5 V Señal diferencial" si utiliza un encóder incremental de 5 V
con señales diferenciales A, /A, B, /B y N, /N.
● 24 V Pista A+B desfasado (Página 475)
Seleccione el tipo de señal "24 V Pista A+B desfasado" si desea utilizar un encóder
incremental de 24 V con las señales A*, B* y N*.
● SSI absoluto (Página 477)
Seleccione el tipo de señal "SSI absoluto" si desea utilizar un encóder absoluto con una
interfaz en serie.
● 24 V Detector de proximidad (Página 477)
Seleccione el tipo de señal "Detector de proximidad de 24 V" si desea utilizar un detector de
24V con la señal A*.

600

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

20.0

ENC_TYPE

DINT

L#1

Tipo de señal
Valores permitidos:
● 1 = 5 V incremental
● 2 = 24 V incremental
● 3 = SSI longitud del telegrama 13 bits
● 4 = SSI longitud del telegrama 25 bits
● 5 = Escuchar
● 6 = 24 V Detector de proximidad ascendente (positivo)
● 7 = 24 V Detector de proximidad descendente (negativo)
● 8 = SSI longitud del telegrama 13 bits (alineación
derecha)
● 9 = SSI longitud del telegrama 25 bits (alineación
derecha)
● 10 = Escuchar (alineación derecha)

Definir resolución
Definir el recorrido por vuelta del encóder
recorrido por vuelta del encóder
Con el dato máquina "Recorrido por vuelta del encóder" se indica al FM x52 qué recorrido
realiza el sistema de accionamiento en cada vuelta.
El valor "Recorrido por vuelta del encóder" depende de la estructura del eje y del modo en que
está colocado el encóder. Debe tener en cuenta todos los elementos de transmisión, como
acoplamientos o engranajes. La figura siguiente muestra dos disposiciones de encóder
distintas a modo de ejemplo.

0RWRU

(QFµGHU

0RWRU

5HGXFWRUHV

5HGXFWRUHV

(QFµGHU

La relación entre los datos máquina "Recorrido por vuelta del encóder" e "Incrementos por
vuelta del encóder" se describe en el apartado Resolución (Página 603).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

601

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

24.0

DISP_REV

DINT

L#80000

Recorrido por vuelta del encóder
Rango de valores admisible:
● 1 µm a 1.000.000.000 µm

Definir los incrementos por vuelta del encóder
Incrementos por vuelta del encóder
El dato máquina "Incrementos por vuelta del encóder" indica la cantidad de incrementos que
proporciona un encóder en cada vuelta. A partir de este valor y del dato máquina "Recorrido
por vuelta del encóder", el FM x52 calcula la resolución.
Encóder incremental
Como entrada (Página 475) es posible indicar cualquier valor dentro del rango de valores. El
módulo evalúa los incrementos en múltiplos de 4.
Detector de proximidad
Es posible indicar cualquier valor dentro del rango de valores.
Encóder absoluto
Los límites varían según el tipo de encóder:
Tipo de encóder

Longitud/tipo de telegrama

Valores posibles

utilizable como
eje lineal

Encóder monovuel‐
ta

13 bits medio abeto

64 ... 8192 en potencias de 2

Encóder monovuel‐
ta

13 bits alineación derecha

64 ... 8192 todos los valores

X

Encóder monovuel‐
ta

25 bits alineación derecha

64 ... 225 todos los valores

X

Encóder multivuelta

25 bits abeto

64 ... 8192 en potencias de 2

Encóder multivuelta

25 bits alineación derecha

64 ... 224 todos los valores

Escuchar

Abeto

64 ... 8192 en potencias de 2

Escuchar

alineación derecha

64 ... 225 todos los valores

25 bits medio abeto

64 ... 8192 en potencias de 2

X

Ajuste especial:
Encóder multivuelta
como encóder mo‐
novuelta

Nota
La cantidad de impulsos de un encóder se calcula a partir de los dos datos "Incrementos por
vuelta del encóder" multiplicado por "Número de vueltas" (véase el apartado "Resolución
(Página 603)").

602

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

32.0

INC_REV

DINT

L#500

Incrementos por vuelta del encóder
Rango de valores admisible:
● 1 a 225
Atención:
En el sistema de medida "Impulsos" esta entrada carece de
importancia.

Resolución
Resolución
La resolución es una medida para la precisión del procesamiento de levas. Determina también
la zona de desplazamiento máxima posible.
Para calcular la resolución (RES) se procede tal como se indica en la tabla siguiente:

Valores de entra‐
da

Encóder incremental

Encóder absoluto/detector de proximi‐
dad

● Recorrido por vuelta

● Recorrido por vuelta del encóder

● Incrementos por vuelta del encóder: ● Incrementos por vuelta del encóder.
–

Evaluación de impulsos:
Cuádruple

–

1 Incremento = 4 Impulsos

Cálculo

–

1 Incremento = 1 Impulso

7UD\HFWR
5(6

9XHOWDGHOHQFµGHU
,PSXOVRV
9XHOWDGHOHQFµGHU

Nota
En el sistema de medida "Impulsos" la resolución siempre tiene el valor 1.
Todos los datos de posición se redondean al múltiplo entero de la resolución. De este modo es
posible diferenciar entre los valores introducidos y los utilizados.

Rango de valores de la resolución
Es preciso convertir el rango de valores admitidos de la resolución al sistema de medida
subyacente. Con la elección de los dos valores "Recorrido por vuelta" e "Incrementos por
vuelta" la resolución se define dentro de este rango de valores.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

603

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
El sistema de medida seleccionado determina el margen de valores de la resolución:
Sistema de
medición

Datos en ...

Rango de valores de la resolución

mm

10-3 mm

0,1 × 10-3 mm .... 1000 × 10-3 mm/impulso

pulgadas

10-4 pulgadas

0,1 × 10-4 pulgadas .... 1000 × 10-4 pulgadas/impulso

grados

10 grados

0,1 × 10-4 grados .... 1000 × 10-4 grados/impulso

10-3 grados

0,1 × 10-3 grados .... 1000 × 10-3 grados/impulso

10 grados

0,1 × 10-2 grados .... 1000 × 10-2 grados/impulso

1 impulso

1

-4

-2

Impulsos

Ejemplo
● Un encóder incremental tiene los datos siguientes:
– Incrementos por vuelta: 5000
– Recorrido por vuelta del encóder: 1000 mm
– 1 incremento = 4 impulsos
De ello resulta la resolución (evaluación cuádruple):
5HVROXFLµQ

PP
LQFUHPHQWRV




PP
,QFUHPHQWR



PP
LPSXOVRV

PP
,QFUHPHQWR



PP
,PSXOVR

PP
,PSXOVR

● Un encóder SSI tiene los datos siguientes:
– Incrementos por vuelta: 4096
– Recorrido por vuelta del encóder: 1000 mm
– 1 incremento = 1 impulso
De ello resulta la resolución:
5HVROXFLµQ

PP
LQFUHPHQWRV



Dependencia entre la zona de desplazamiento y la resolución
La zona de desplazamiento está limitada por la representación numérica en el FM x52. Esta
representación numérica varía en función de la resolución. Por ello, al definir valores hay que
procurar mantenerse siempre dentro de los límites admitidos.
La siguiente tabla muestra la zona de desplazamiento máxima:

604

Resolución (RES) dentro de la zona

Zona de desplazamiento máxima

0,1 µm/impulso ≦ RES < 1 µm/impulso

-108 µm a 108 µm (-100 m a +100 m)

1 µm/impulso ≦RES ≦ 1000 µm/impulso

-109 µm a 109 µm (-1000 m a +1000 m)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Dependencia de la velocidad de la resolución
La velocidad que se muestra puede oscilar dentro de los márgenes que se indican según sea
la resolución (los datos se expresan en el sistema de medida mm):
● de 1 µm/min a 90 m/min a una resolución < 1 µm/impulso
● de 1 µm/min a 900 m/min a una resolución ≥ 1 µm/impulso
La velocidad es calculada y suavizada por el módulo cada 4 ms.
Tiene por lo menos una imprecisión de un impulso/4 ms y no resulta adecuada para fines de
regulación.

Seleccionar sentido de contaje
Dirección de contaje
Con el dato máquina "Dirección de contaje" se adapta la dirección de la captura del recorrido
al sentido del movimiento del eje. Para ello, tenga en cuenta todos los sentidos de giro de los
elementos de transmisión (como p. ej., acoplamientos y engranajes).
● normal = los impulsos de contaje adelantes (encóder incremental) o valores del sensor
(encóder absoluto) equivalen a los valores de posición real ascendentes
● invertida = los impulsos de contaje adelantes (encóder incremental) o valores del sensor
(encóder absoluto) equivalen a los valores de posición real descendentes
Nota:
No se permite un tiempo de anticipación en combinación con un encóder absoluto (SSI) y con
sentido de contaje invertido.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

Valor inicial

Comentario

59.0

CNT_DIR

BOOL

FALSE

Sentido de contaje
Valores permitidos:
● 0 = normal
● 1 = invertida

Seleccionar vigilancia
Vigilancia
Rotura de hilo

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

605

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Con la activación de la vigilancia, el FM x52 vigila, en el caso de un encóder incremental, las
señales A, /A, B, /B, N y /N. La vigilancia detecta:
● Rotura de hilo
● Cortocircuito de los distintos cables
En los encóders incrementales sin marcas cero, como alternativa tiene que
– desconectar la vigilancia de rotura de hilo
– interconectar externamente las señales N y /N (Página 474)
● Distancia de flancos de los impulsos de contaje
● Corte de la alimentación del encóder
Error del telegrama
La monitorización de errores de telegrama en los encóders absolutos (SSI) no puede
desactivarse. Supervisa:
● el telegrama para ver si hay errores del bit de inicio y del bit de parada
● el tiempo monoestable del encóder conectado
Impulsos erróneos (encóder incremental)
Entre dos marcas cero consecutivas, un encóder incremental siempre tiene que proporcionar
el mismo número de incrementos.
El FM x52 comprueba si la marca cero de un encóder incremental aparece en el estado
adecuado del encóder.
En el caso de encóders sin marca cero es preciso desactivar la vigilancia de los impulsos de
error.
Igualmente es preciso desactivar la vigilancia de rotura de hilo o bien interconectar las
entradas de marca cero N y /N de forma externa.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

Valor inicial

Comentarios

63.0

MON_WIRE

BOOL

TRUE

1 = Rotura de hilo

63.1

MON_FRAME

BOOL

TRUE

1 = Error de telegrama (tiene que ser siempre 1)

63.2

MON_PULSE

BOOL

TRUE

1 = Impulsos de error

Vigilancias

606

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Seleccionar datos para el encóder absoluto (SSI)
Número de vueltas
Número de vueltas del encóder
El dato máquina "Número de vueltas del encóder" sólo existe en encóders absolutos. Con él
se indica el número de vueltas posibles con este encóder. Encontrará más información en el
apartado "Encóder absoluto (SSI) (Página 477)".
● Encóder monovuelta
Sólo es posible el valor 1.
● Encóder multivuelta
– Encóder Multivuelta / Escuchar (abeto): 2 ... 4096 en potencias de 2
– Encóder multivuelta / Escuchar (alineación derecha): 1 ... 4096 todos los valores
● Escala lineal
También es posible conectar una escala lineal. Introduzca para ello el valor 1.
El total de pasos del encóder no es un dato máquina. Se calcula del modo siguiente:
Total de pasos = Incremento por vuelta x Número de vueltas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentario

36.0

NO_REV

DINT

L#1024

Número de vueltas del encóder
Rango de valores admisible:
● 1 (encóder monovuelta)
● 1 a 4096 (encóder multivuelta)

Velocidad de transferencia
Velocidad de transferencia
Con el dato máquina "Velocidad de transferencia" se define la velocidad de la transferencia de
datos del encóder SSI al FM x52.
La velocidad de transferencia máxima depende de la velocidad de transferencia:
● 320 m → 125 kHz
● 160 m → 250 kHz
● 63 m → 500 kHz
● 20 m → 1000 kHz

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

607

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

40.0

BAUDRATE

DINT

L#0

Velocidad de transferencia
Valores permitidos:
● 0 = 125 kHz
● 1 = 250 kHz
● 2 = 500 kHz
● 3 = 1000 kHz

Longitud de telegrama
Longitud de telegrama
Con la "longitud de telegrama" se define el marco de impulsos que emite el FM x52.
Seleccionando "Escuchar", se desactiva el reloj del FM x52. Entonces el FM x52 puede
escuchar también otros telegramas SSI con un marco de telegramas de 13 ó 25 bits. La
velocidad de la transferencia se basa en la velocidad de reloj del módulo maestro.

Datos utilizados en el DB de parámetros
La longitud de telegrama seleccionada aquí se dispone en el DB de parámetro con el
dato ENC_TYPE (Página 600).

Sentido del detector de proximidad
Sentido del detector de proximidad
Con el sentido del detector es posible determinar el sentido de un detector de proximidad
conectado:
● Positivo: corresponde al sentido de avance (impulsos de contaje ascendentes)
● Negativo: corresponde al sentido de retroceso (impulsos de contaje descendentes)

608

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Pistas
Seleccionar el modo de control de las salidas de pista
Control de las salidas de pista
Con el dato máquina "Control de las salidas de pista" se define el modo de control de las
salidas de pista de las pistas 0 a 15. El control es posible mediante:
● Leva electrónica: Las señales de pista son activadas y desactivadas por el procesamiento
de levas del FM 452.
● CPU: Las señales de pista reproducen directamente los valores correspondientes de las
habilitaciones de pistas en el DB de canal.
De este modo las salidas de pista se pueden controlar directamente desde su programa.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

90.0

TRACK_OUT

WORD

W#16#0

Control de las salidas de pista
Valores permitidos:
● 0 = Leva electrónica
● 1 = CPU
Número de bit = Número de pista

Seleccionar pistas especiales
Pistas especiales
Es posible parametrizar las pistas 0, 1 y 2 como pistas especiales.
● Pista 0 y pista 1 como pista de leva de contaje (Página 469)
● Pista 2 como pista de leva de freno (Página 469)

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios
Pistas especiales

99.0

SPEC_TRC0

BOOL

FALSE

1 = Pista 0 es pista de leva de contaje

99.1

SPEC_TRC1

BOOL

FALSE

1 = Pista 1 es pista de leva de contaje

99.2

SPEC_TRC2

BOOL

FALSE

1 = Pista 2 es pista de leva de freno

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

609

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Definir valor de contaje superior para la pista de leva de contaje
Valor de contaje superior pista de leva de contaje
Con este dato máquina se define el valor de contaje superior para la pista de leva de contaje
parametrizada.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

100.0

CNT_LIM0

DINT

L#2

104.0

CNT_LIM1

DINT

L#2

Valor de contaje superior para pista de leva de conta‐
je(Pista 0)
Valor de contaje superior para pista de leva de conta‐
je(Pista 1)
Rango de valores admisible:
● 2 … 65535

Seleccionar entrada de habilitación
Entrada de habilitación
La señal de pista Q3 a Q10 se activa cuando se cumplen todas las condiciones siguientes:
● La pista está habilitada.
● La entrada de habilitación externa correspondiente I3 a I10 está activada.
● El resultado de pista es = 1.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios
Entrada de habilitación

95.0

EN_IN_I3

BOOL

FALSE

…

…

…

…

95.7

EN_IN_I10

BOOL

FALSE

610

1 = La señal de pista Pista 3 está combinada con la en‐
trada de habilitación I3 con la operación lógica AND
…
1 = La señal de pista Pista 10 está combinada con la
entrada de habilitación I10 con la operación lógica AND

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Leva
Alcance
Alcance
El alcance determina el número máximo de levas parametrizables y, con ello, el tiempo de ciclo
de la leva.
Alcance

Tiempo de ciclo de la leva

16 levas

20,48 µs

32 levas

40,96 µs

64 levas

81,92 µs

128 levas

163,84 µs

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

76.0

C_QTY

DINT

UDT3: L#0

0 = máx. 16 levas

UDT4: L#1

1 = máx. 32 levas

UDT5: L#2

2 = máx. 64 levas

UDT6: L#3

3 = máx. 128 levas

Alcance

Datos de leva
Datos de leva
Datos de leva
Los datos de leva describen las propiedades de una leva, la asignación de cada una de ellas
a una pista y el comportamiento de conmutación de la leva.
Los datos de leva que se listan a continuación se ajustan por separado para cada leva.
● Validez (Página 612)
● Número de pista (Página 612)
● Tipo de leva (Página 613)
● Principio y final de la leva para levas de recorrido (Página 613)
● Inicio de leva y tiempo de conexión para levas de tiempo (Página 614)
● Tiempo de anticipación (Página 615)
● Sentido de actuación (Página 617)
● Alarma de proceso (Página 619)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

611

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Por lo general, para el procesamiento de levas se aplica lo siguiente:
● Sólo las levas ajustadas como "válidas" son interpretadas y procesadas por el módulo.
● Las levas 0 ... 7 soportan alarmas de proceso
● La cantidad de levas parametrizables depende del alcance.

Validez de una leva
Leva "válida"
Es preciso activar como válidas todas las levas que deben ser procesadas por la leva
electrónica.
Nota
Configure siempre las levas no utilizadas como "no válidas" (CAMVALID = FALSE).

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

CAMVALID

BOOL

FALSE

1 = Leva "válida"

relativa
+0.0

Definir número de pista para una leva
Número de pista
Al escoger el número de pista se define para cada leva la pista en la que dicha leva tiene que
tener efecto.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

TRACK_NO

BYTE

B#16#0

Número de pista

relativo
+1.0

Rango de valores admisible:
● 0 a 31

612

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Seleccionar tipo de leva
Tipo de leva
Seleccione el tipo de leva deseado.
● Leva de recorrido
● Leva de tiempo

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

CAM_TYPE

BOOL

FALSE

Tipo de leva

relativo
+0.3

Valores permitidos:
● 0 = Leva de recorrido
● 1 = Leva de recorrido

Definir inicio y final de la leva para levas de recorrido
Inicio de leva (IL) / Fin de leva (FL) en levas de recorrido
El inicio y el final de leva definen la longitud de leva en una leva de recorrido.
Longitud mínima de una leva de recorrido
La siguiente figura muestra la leva más corta con sentido de movimiento positivo del eje.
3XOVRVGHWHUPLQDGRVDSDUWLUGH
ODVVH³DOHVGHOHQFRGHU

     
,/ )/

)/

V

,/

V

/HYDP£VFRUWD,/ \
)/ 
/HYDP£VFRUWDQRDFWLYDVL
,/HVPD\RUTXH)/,/ \
)/ 

Por regla general, rige lo siguiente:
● La parte no activa de una leva siempre tiene que mantener una distancia mínima de 4
impulsos entre el fin de leva (FL) y el inicio de leva (IL).
● En el caso de FL = IL la leva se activa por un impulso.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

613

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

relativo

para levas de recorrido

+2.0

CBEGIN

DINT

L#-100000000

Inicio de leva (IL)

+6.0

CEND

DINT

L#100000000

Fin de leva (FL)
Rango de valores admisible:
● -1.000.000.000 µm a 1 000 000
000 µm

Definir principio de leva y tiempo de conexión para levas de tiempo
Inicio de leva (IL) / Final de leva (FL) ≙ Tiempo de conexión en levas de tiempo
En el caso de una leva de tiempo es preciso definir un inicio de leva y, en lugar del fin de leva,
un tiempo de conexión. El tiempo de conexión se define en pasos de 100 µs. El tiempo empieza
a transcurrir a partir de la conexión de la leva.
Para la definición de estos tiempos rigen las condiciones siguientes:
● 0 µs: Una leva con el tiempo de conexión 0 µs no se activa nunca
● 0 µs < t ≤ 400 µs: El FM x52 ajusta un tiempo de leva mínimo de unos 330 µs.
● t > 400 µs: El FM x52 calcula el tiempo de conexión real treal a partir del tiempo de conexión
especificado tdef según la fórmula siguiente:
W
UHDO Q¼PHURHQWHUR

W GHI
7LHPSRGHFLFORGH
ODOHYD



7LHPSRGHFLFORGHODOHYD

El error máximo siempre es menor que el tiempo de ciclo de la leva.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

relativo

Comentarios
para levas de tiempo

+2.0

CBEGIN

DINT

L#-100000000

Inicio de leva (IL)

+6.0

CEND

DINT

L#100000000

Final de leva (FL) ≙ Tiempo de conexión
Rango admisible de valores para inicio de leva:
● -1.000.000.000 µm a 1 000 000 000 µm
Rango admisible de valores para tiempo de conexión:
● (0 a 13421) × 100 µs con un máximo de 16 levas
● (0 a 26843) × 100 µs con un máximo de 32 levas
● (0 a 53686) × 100 µs con un máximo de 64 levas
● (0 a 65535) × 100 µs con un máximo de 128 levas

614

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Definir tiempo de anticipación
Tiempo de anticipación
Los retardos de los elementos de maniobra conectados se pueden compensar definiendo un
tiempo de anticipación. El tiempo de anticipación se define en pasos de 100 µs. Es posible
conceder un tiempo de anticipación por leva. El tiempo de anticipación es válido para el inicio
y el final de la leva.
Recorrido de anticipación
El recorrido de anticipación de una leva se calcula continuamente en función de la velocidad
actual y del tiempo de anticipación. Toda la leva se desplaza ese recorrido en la dirección del
valor real. El área parametrizada se denomina "área estática" y el área calculada atendiendo
al tiempo de anticipación se denomina "área dinámica".
Recorrido de anticipación = tiempo de anticipación × velocidad actual
El cálculo de los recorridos de anticipación de todas las levas se realiza dentro de ¼ del tiempo
de anticipación más largo parametrizado en el FM x52. Si parametriza un tiempo de
anticipación muy prolongado para una leva, el ajuste dinámico se calcula con menos
frecuencia.
Tiempo de anticipación real
El tiempo de anticipación real se calcula del modo siguiente:
1. Calcule el tiempo de ciclo de la leva: Es el tiempo en el que el FM x52 ha procesado por
completo todas las levas. Depende del alcance parametrizado.
2. Calcule el tiempo de anticipación real con la fórmula siguiente:
7LHPSRGHGLVSRQLELOLGDGUHDO Q¼PHURHQWHUR

7LHPSRGHGLVSRQLELOLGDG

7LHPSRGHFLFORGHOD
'

7LHPSRGHFLFORGHODOHYD 

OHYD 

Significados:
– Tiempo de anticipaciónreales el tiempo de anticipación ajustado por el FM x52.
– Tiempo de anticipación D es el tiempo de anticipación preseleccionado.
– Número entero ( ) significa que para el cálculo de lo comprendido entre paréntesis sólo
se tiene en cuenta el valor anterior al decimal.
El error máximo del tiempo de anticipaciónreal siempre es menor que el tiempo de ciclo de la leva
× 4.
Ejemplo:
Se especifican los valores siguientes:
● Alcance: máximo 32 levas
● Tiempo de ciclo de la leva: 40,96 µs
● Tiempo de anticipaciónD = 1000 µs
Resultado: Se obtiene un tiempo de anticipación real de 983 µs.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

615

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Nota
El tiempo de anticipación real siempre es menor que el tiempo de anticipación parametrizado.
Puede ser 0 aunque el tiempo de anticipación parametrizado sea ≥100 µs.
El recorrido de anticipación en un eje rotativo tiene que ser menor que el área del eje rotativo
y la parte no activa de la leva. Esto tiene que estar garantizado para todas las velocidades.
Nota
No se soporta un tiempo de anticipación en relación con un encóder absoluto (SSI) ni con una
dirección de contaje parametrizada como invertida.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

LTIME

INT

0

Tiempo de anticipación

relativo
+ 10.0

Rango de valores admisible:
● (0 a 53686) × 100 µs con un máx. de 16 levas
● (0 a 65535) × 100 µs con un máx. 32, 64 o 128 levas

Ajuste dinámico de una leva
Para el rango de la leva se distinguen dos casos:
1. El rango estático y el rango dinámico de la leva están superpuestos.
2. El rango estático y el rango dinámico de la leva no están superpuestos.

616

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra para ambos casos el cálculo del ajuste dinámico.
Ajuste dinámico

Descripción
,/

6HQWLGRGHOPRYLPLHQWR

)/

9DORUUHDO
/HYDQ

5HFRUULGRGHGLVSRQLELOLGDG
$MXVWHGLQ£PLFR

Cuando el rango dinámico se superpone al rango estático de
la leva, rige lo siguiente:
● Cuando se alcanza el área dinámica de la leva, ésta se
activa. Simultáneamente se bloquea el cálculo de un
nuevo ajuste dinámico.
● Si el valor real alcanza el área estática de la leva, se
vuelve a habilitar el cálculo de un ajuste dinámico nuevo
y un cambio de velocidad actúa al final de la leva.
● Si la leva se desactiva al final del área dinámica, el ajuste
dinámico vuelve a estar bloqueado hasta el final del área
estática de la leva.

,/

6HQWLGRGHOPRYLPLHQWR
9DORUUHDO
/HYDQ

5HFRUULGRGHGLVSRQLELOLGDG

)/

Cuando el área dinámica no se superpone al área estática de
la leva, rige lo siguiente:
● Cuando se alcanza el rango dinámico de la leva, ésta se
activa. Simultáneamente se bloquea el cálculo de un
nuevo ajuste dinámico.
● Al final del área estática de la leva se vuelve a habilitar el
ajuste dinámico.

$MXVWH
GLQ£PLFR

Área dinámica
Área estática
Es posible un nuevo ajuste dinámico

Nota
Modificando la dirección de giro se vuelve a habilitar la determinación del ajuste dinámico.

Selección sentido de actuación
Sentido de actuación
Existen dos sentidos de actuación posibles:
● Positivo: la leva se activa al inicio, cuando el eje se desplaza en sentido ascendente
respecto al valor real.
● Negativo: la leva se activa al final, cuando el eje se desplaza en sentido descendente
respecto al valor real.
Es posible también ajustar simultáneamente ambos sentidos de actuación.
Si se selecciona "Ninguno" la leva queda sin efecto.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

617

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Comportamiento de conmutación de la leva dependiendo del sentido de actuación
La siguiente tabla muestra el comportamiento de actuación de las levas de recorrido y de
tiempo dependiendo del sentido de actuación. Excepto en el ejemplo 5 se parte siempre de un
sentido de actuación positivo.
Nº
1

2

3

Descripción

Leva de recorrido

Leva de tiempo

,/

,/

Una leva se rebasa en el sentido de actuación

Una leva se rebasa en el sentido contrario al de
actuación

Una leva se desplaza en el sentido de actuación;
mientras está activada, cambia el
sentido del movimiento del eje

)/

,/

)/

,/

)/

,/

7LHPSRGHDFWLYDFLµQ

7LHPSRGHDFWLYDFLµQ

7LHPSRGHDFWLYDFLµQ

,/

[
W
W
7LHPSRGHDFWLYDFLµQ[ WW

4

5

Una leva se desplaza en sentido opuesto al de ac‐
tuación; en la leva el sentido de movimiento del eje
cambia al sentido de actuación

Una leva se desplaza y se abandona en un sentido
cualquiera; el sentido de actuación está ajustado
para ambas direcciones

La leva no se activa
,/

)/

,/

)/

,/

7LHPSRGHDFWLYDFLµQ
[
W
W
W

7LHPSRGHDFWLYDFLµQ[ WWW

Leva parametrizada
Leva activada

618

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

+0.1

EFFDIR_P

BOOL

TRUE

1 = Sentido de actuación positivo (+)

+0.2

EFFDIR_M

BOOL

TRUE

1 = Sentido de actuación negativo (-)

relativo

Seleccionar alarma de proceso para levas
Alarma de proceso al activar/desactivar levas
Para las levas 0 a 7 se puede definir si, al conectar, desconectar o al conectar y desconectar
la leva, debe generarse una alarma de proceso.

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

+0.4

PI_SW_ON

BOOL

FALSE

1 = Alarma de proceso al activar

+0.5

PI_SW_OFF

BOOL

FALSE

1 = Alarma de proceso al desactivar

relativo

Habilitar alarma de proceso
Habilitar las alarmas de proceso
Habilitar las alarmas de proceso
Los datos máquina permiten habilitar alarmas de proceso.
Es posible ajustar cuándo deben generarse las alarmas de proceso:
● Comienzo de la medición
En el ajuste "Captura de bordes (Página 575)", un flanco ascendente de la entrada digital
I1 puede iniciar una alarma de proceso.
● Fin de la medición
Tanto en el ajuste "Captura de bordes (Página 575)" como en el ajuste "Medición de
longitud (Página 575)", un flanco ascendente de la entrada digital I1 puede iniciar una
alarma de proceso.
● Leva activa / inactiva
En los datos de leva (Página 619) es posible establecer si se tienen que generar alarmas
de proceso al activar y/o desactivar las levas 0 a 7.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

619

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Datos utilizados en el DB de parámetros
Dirección

Nombre

Tipo

valor inicial

Comentarios

3.1

PI_MEND

BOOL

FALSE

1 = Habilitar la alarma de proceso: Fin de la medición

3.2

PI_CAM

BOOL

FALSE

1 = Habilitar la alarma de proceso: Leva activa / inactiva

3.5

PI_MSTRT

BOOL

FALSE

1 = Habilitar la alarma de proceso: Comienzo de la medición

Evaluación de una alarma de proceso
Cuando el FM 452 dispara una alarma de proceso, en las variables OB4x_POINT_ADDR del
OB de alarma de procesos se encuentra disponible la información sobre alarmas.
La tabla siguiente muestra el formato del tipo de datos OB4x_POINT_ADDR:
Byte

Bit 7

Bit 6

Bit 5

Bit 4

Bit 3

Bit 2

Bit 1

Bit 0

0

0

0

0

0

0

0

0

0

1

0

0

Comien‐
zo de la
medición

0

0

Leva

Fin de la
medición

0

2

Leva 7
activa

Leva 7
inactiva

Leva 6
activa

Leva 6
inactiva

Leva 5
activa

Leva 5
inactiva

Leva 4
activa

Leva 4
inactiva

3

Leva 3
activa

Leva 3
inactiva

Leva 2
activa

Leva 2
inactiva

Leva 1
activa

Leva 1
inactiva

Leva 0
activa

Leva 0
inactiva

La causa de la alarma se puede consultar en el byte 1.
● Leva:
Evalúe los bytes 2 y 3 según la tabla.
● Comienzo / Final de la medición:
Con la instrucción CAM_MSRM_452 es posible leer los valores de medición actuales del
módulo.

Alarmas de proceso perdidas
Si una alarma de proceso todavía no se ha terminado de procesar en el OB de alarma de
proceso, el módulo memoriza todos los eventos siguientes de alarma de proceso. Si vuelve a
aparecer un evento antes de que la alarma de proceso se haya podido disparar, el módulo
disparará la alarma de diagnóstico "Alarma de proceso perdida".

Interfaz de control y realimentación del FM 452
Aplicación
En aplicaciones especiales o en el nivel de las alarmas es preciso un acceso especialmente
rápido a las señales de respuesta y de control. Estos datos se alcanzan directamente por
medio de las áreas de entrada y salida del módulo.

620

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Para coordinar el arranque cada vez que arranca el módulo (p. ej. tras insertar el módulo o
después de una transición STOP-RUN de la CPU), la instrucción CAM_CTRL debe llamarse
hasta que se muestre el final del arranque a través de RETVAL = 0.
Nota
Para acceder directamente a los datos del FM 452 sólo se deben emplear los datos no internos
aquí descritos del modo indicado. De lo contrario, el acceso de su programa de usuario al
módulo puede sufrir anomalías.

Leer señales de respuesta mediante acceso directo
Las direcciones de byte se indican de forma relativa con respecto a la dirección de salida del
módulo. Los nombres de los parámetros corresponden a los nombres del DB de canal.
En AWL se accede a los datos con los comandos PEB (leer 1 byte) y PED (leer 4 bytes).
Dirección

Número de bit
7

6

5

4

3

2

1

0

Byte 0

PARA

interno

interno

DATA_ERR

interno

DIAG

interno

interno

Byte 1

0

0

0

CAM_ACT

0

0

0

0

GO_M

MSR_DONE

SYNC

Byte 2
Byte 3

interno
0

0

FVAL_DONE

HYS

GO_P

Byte 4

ACT_POS

Byte 5
Byte 6
Byte 7
Byte 8

TRACK_OUT

Byte 9
Byte 10
Byte 11

Escribir las señales de control mediante acceso directo
Las direcciones de byte se indican de forma relativa respecto a la dirección de entrada del
módulo. Los nombres de los parámetros corresponden a los nombres del DB de canal.
En AWL se accede a los datos con los comandos PAB (escribir 1 byte) y PAW (escribir 2 bytes).
Dirección

Número de bit
7

6

5

Byte 0
Byte 1

4

3

2

1

0

DIR_P

DIR_M

0

0

interno
0

Byte 2

CNTC1_EN

CNTC0_EN

CAM_EN
TRACK_EN

Byte 3

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

621

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Ejemplo: Valor real de posición ACT_POS
La dirección inicial del módulo es 512.
AWL
L PED 516

//Leer el valor real de posición (ACT_POS) con acceso directo:
//Dirección inicial del módulo + 4

Vías de transferencia de parámetros
Se entiende por parámetros los datos máquina y los datos de leva que siguen a continuación.
La figura siguiente muestra las vías de transferencia de parámetros al FM 452.

622

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

3*3&
RIIOLQH

&DUJDU
,QWHUID]GH
SURJUDPDFLµQ

)0

&38
RQOLQH



E
'%



D

'%

D


&DUJDUHQOD3*

E






3URJUDPD
GHXVXDULR




&$0B&75/

+:&RQILJ

3DU£PHWURV
'DWRV
P£TXLQD
\GHOHYD




'DWRVGH
VLVWHPD
6'%

D
&DUJDU

'DWRVGH
VLVWHPD
6'%



1

Guardar los parámetros en la interfaz de parametrización.

2

Guardar, compilar y cargar la configuración de hardware en la CPU.

3

La CPU escribe los parámetros en el módulo en parametrizaciones de sistema.

4

Cargar los parámetros del módulo en la programadora con el comando "Cargar sistema de
destino en PG".

5

Cargar los parámetros en el módulo desde la interfaz de parametrización con el comando "Car‐
gar sistema de destino".

6

Escribir los parámetros en el módulo con tareas del programa de usuario.

7

Leer los parámetros desde el módulo con tareas del programa de usuario.

8

Almacenar parámetros del programa de usuario en el DB Online.

9

Leer parámetros del DB Online en el programa de usuario.

10

Exportar parámetros desde la interfaz de parametrización hasta el DB (DB Offline o DB Online);
posteriormente, también debe cargarse un DB Offline en la CPU.

11

Importar parámetros de un DB Online o DB Offline a la interfaz de parametrización.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

623

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Casos de aplicación de la transferencia de parámetros
Caso de aplicación

Pasos

Los parámetros se editan con la interfaz de parametrización. A con‐ Ejecute los pasos 1, 2 y 3.
tinuación, el módulo se tiene que parametrizar automáticamente en
el arranque.
Los parámetros se modifican durante la puesta en servicio en el mo‐ Ejecute los pasos 4 y 5
do Test en la interfaz de parametrización.
Los parámetros modificados durante la puesta en servicio se tienen
que cargar automáticamente durante el arranque.

Ejecute los pasos 1, 2 y 3.

Los parámetros se crean con la interfaz de parametrización. En el
arranque, el módulo sólo se debe parametrizar con el programa de
usuario mediante bloques de datos.

Ejecute los pasos 10 y 6.

Para crear cómodamente datos de reserva para recetas.

Ejecute el paso 10.

Los parámetros se crean con la interfaz de parametrización. Éstos
tienen que estar a disposición del programa de usuario para modifi‐
caciones provisionales.

Ejecute los pasos 1, 2 y 3 para
la parametrización automática.
Ejecute los pasos 10 y 7 para el
acceso por medio del programa
de usuario.

Los parámetros existentes se modifican (exclusivamente) con el pro‐ Ejecute los pasos 7, 9, 8 y 6.
grama de usuario.
Para ver los datos modificados por el programa de usuario con la
interfaz de parametrización.

Ejecute el paso 11.

Los parámetros modificados por el programa de usuario se tienen
que cargar automáticamente también en el arranque.

Ejecute los pasos 6, 11, 1, 2 y 3.

2.1.4.5

Puesta en servicio del FM 452

2.1.4.6

Uso del FM 452 desde el programa de usuario

Inclusión del FM 452 en un programa de usuario
Para integrar el FM 452 en un programa de usuario pueden utilizarse instrucciones que le
facilitarán en lo posible el manejo de las funciones deseadas:
Las instrucciones CAM_INIT y CAM_CTRL o CAM_CTRL_452 se activan en el programa de
usuario de la CPU. Éstas realizan la comunicación entre la CPU y el FM 452.
Si integra la instrucción CAM_CTRL en el proyecto, el DB de canal se creará automáticamente
como DB de instancia en la instrucción CAM_CTRL.
Si integra la instrucción CAM_CTRL_452 en el proyecto, entonces deberá insertar en su
programa como DB de canal un bloque de datos del tipo CAM_CHANTYPE mediante "Bloques
de programa > Agregar bloque".
Todos los datos de parámetros pertenecientes a un canal del módulo (datos máquina, datos
leva) se encuentran en el DB de parámetros del módulo. Inserte un bloque de datos del tipo

624

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
CAM_PxxxTYPE en el proyecto mediante "Bloques de programa > Agregar bloque".
Dependiendo del alcance se requieren los siguientes tipos de DB:
● Hasta 16 levas: CAM_P016TYPE
● Hasta 32 levas: CAM_P032TYPE
● Hasta 64 levas: CAM_P064TYPE
● Hasta 128 levas: CAM_P128TYPE
La instrucción CAM_MSRM_452 se utiliza para la evaluación inmediata de los datos de
medición de la medición de longitud o de la captura de bordes de un FM 452 en el OB de la
alarma de proceso.
Además, para el FM 452 se puede utilizar también la instrucción CAM_DIAG o
CAM_DIAG_452, que permite transferir informaciones de diagnóstico al DB de diagnóstico.
Si integra la instrucción CAM_DIAG en el proyecto, el DB de diagnóstico se creará
automáticamente como DB de instancia en la instrucción CAM_DIAG.
Si integra la instrucción CAM_DIAG_452 en el proyecto, entonces deberá insertar en el
programa como DB de diagnóstico un bloque de datos del tipo CAM_DIAGTYPE mediante
"Bloques de programa > Agregar bloque".

Puesta en servicio del módulo
Incluso sin programa de usuario es posible realizar un primer test del módulo con el cuadro de
diálogo "Puesta en servicio". Tenga en cuenta particularmente la advertencia siguiente.
ADVERTENCIA
Se pueden producir daños personales y materiales.
Para evitar daños personales y materiales observe los puntos siguientes:
● Instale un interruptor de PARADA DE EMERGENCIA en las inmediaciones del equipo.
Sólo así puede garantizarse que en caso de un fallo del software o del equipo sea posible
desconectar la instalación de modo seguro.
● Instale finales de carrera por hardware que actúen directamente en las etapas de potencia
de todos los accionamientos.
● Asegúrese de que ninguna persona tenga acceso al área de la instalación donde hay
piezas en movimiento.
● Si controla y vigila paralelamente el FM 452 desde el programa y desde el cuadro de
diálogo "Puesta en servicio" pueden producirse conflictos cuyos efectos no están
definidos. Por lo tanto, conmute siempre la CPU al estado STOP cuando trabaje con el
cuadro de diálogo "Puesta en servicio" o bien desactive el programa.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

625

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

2.1.4.7

FM 452: Diagnóstico online

Información actual sobre el módulo
Diagnóstico estándar
Indicación de errores mediante los diodos de error del FM 452
¿Dónde se indica el error?
Los diodos rojos de error del módulo indican diferentes estados de error. Los LED se
encienden también en caso de errores que aparecen brevemente, por lo menos, durante 3 s.
En la figura siguiente se muestra la posición de los diodos de error en el FM 452.
,17)
(;7)

626

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

¿Qué errores se indican?
La tabla siguiente contiene los tipos de error que se indican mediante los diodos de error.
LED

Significado

Explicación

INTF

Error de grupo pa‐ Este diodo indica los siguientes estados de error del FM 452:
ra errores internos ● Alarma de proceso perdida
● Vigilancia de tiempo transcurrida
● FM 452 no configurado
● FM 452 parametrizado con errores
Para eliminar el error, ver Clases de error (Página 632).

EXTF

Error de grupo pa‐ Este LED indica los siguientes estados de error:
ra errores externos ● Falta tensión auxiliar externa de 24 V
● Falta conector frontal
● Rotura de hilo encóder
● Fallo operativo
● Error de telegrama encóder absoluto
● Error en señal encóder incremental o falta marca cero

INTF + EXTF

Módulo defectuo‐
so

Todas las salidas se desconectan. El módulo debe ser sustituido.

Diagnóstico específico de canal
Disparo de alarmas de diagnóstico
Procesamiento de las alarmas
El FM 452 puede disparar alarmas de proceso y de diagnóstico. Estas alarmas se procesan en
un OB de alarma. Cuando se dispara una alarma sin que se encuentre cargado el OB
correspondiente, la CPU pasa a STOP.
Para habilitar las alarmas de diagnóstico se procede del modo siguiente:
1. Seleccione el módulo en HWCN
2. Habilite la alarma de diagnóstico en Edición > Propiedades del objeto > Parámetros
básicos.
3. Guardar y compilar la configuración.
4. Cargue la configuración en la CPU

Visión de conjunto de las alarmas de diagnóstico
Los eventos y errores siguientes disparan una alarma de diagnóstico:
● Fallo operativo
● Datos máquina erróneos

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

627

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
● Datos de levas erróneos
● Error de diagnóstico
Estos errores se describen con detalle en el apartado "Clases de error (Página 632)".

Reacción del módulo en caso de error con alarma de diagnóstico
● El procesamiento de levas se desactiva.
● Con las alarmas de diagnóstico siguientes se borra la sincronización:
– Falta conector frontal, falta tensión auxiliar externa
– se ha detectado un error de señal cero, error de línea (señales de encóder de 5 V)
– se ha rebasado la zona de desplazamiento (se notifica con un error de operador)
– Ajustar valor real no se puede ejecutar (se notifica con un error de operador)
● Las señales de control dejan de procesarse excepto en un caso.
Excepción:
En caso de desbordamiento del final de carrera por software todavía es posible un cambio
de sentido en el modo de simulación.
● Los selectores de función y las tareas se continúan procesando.

El módulo detecta un fallo ("entrante")
Una alarma de diagnóstica es "entrante" cuando por lo menos hay un error en cola de espera.
Si no se han solventado todos los fallos los demás que queden en cola de espera, se
notificarán de nuevo como "entrantes".
Secuencia:
1. El FM 452 detecta uno o varios fallos y dispara una alarma de diagnóstico. El LED de error
se enciende. El error se registra en el búfer de diagnóstico.
2. El sistema operativo de la CPU solicita el OB de alarma de diagnóstico, por ejemplo, OB 82.
3. Es posible evaluar la información de inicio del OB 82.
4. Con el parámetro OB82_MOD_ADDR se lee qué módulo ha disparado la alarma.
5. Encontrará más información si llama la instrucción CAM_DIAG o CAM_DIAG_452.

El módulo detecta el paso al estado libre de fallos ("saliente")
Una alarma sólo es "saliente" cuando se ha eliminado el último error del módulo.
Secuencia:
1. El FM 452 detecta que todos los fallos han sido eliminados y dispara una alarma de
diagnóstico. El LED de error está apagado. El búfer de diagnóstico no se modifica.
2. El sistema operativo de la CPU solicita el OB de alarma de diagnóstico, por ejemplo, OB 82.
3. Con el parámetro OB82_MOD_ADDR se lee qué módulo ha disparado la alarma.
4. Evalúe el bit OB82_MDL_DEFECT.
Si este bit es "0", no hay errores en el módulo. Su evaluación puede finalizar aquí.

628

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Alarmas de diagnóstico según el estado de la CPU
● En estado STOP de la CPU las alarmas de diagnóstico están bloqueadas por el FM 452.
● Si con la CPU en estado STOP no se eliminan todos los fallos pendientes, el FM 452 vuelve
a notificar como "entrantes" los errores todavía no eliminados tras la transición al estado
RUN.
● Si se eliminan todos los errores pendientes con la CPU en estado STOP, el estado libre de
errores del FM 452no se notificará con una alarma de diagnóstico tras la transición al
estado RUN.

Evaluación de errores en el programa de usuario
Reacción de errores en el programa de usuario
En el programa de usuario es posible reaccionar de forma precisa a los errores que aparecen.
Para ello se dispone de los siguientes recursos:
● Los valores de retorno RET_VAL de las instrucciones integradas como indicador de grupo
de los errores que han aparecido durante el transcurso de las instrucciones.
● Los bits de error _ERR de las peticiones como indicador de grupo de errores que se han
producido durante la ejecución de una petición.
● El bit de error DATA_ERR como indicador de grupo de un error que el FM 452 ha detectado
durante una petición de escritura.
● La identificación de errores en JOB_ERR de la causa de error en la comunicación entre la
instrucción y el FM 452.
● La instrucción CAM_DIAG o CAM_DIAG_452 para leer el búfer de diagnóstico del FM 452.
Aquí es posible averiguar las causas de error de las peticiones y los eventos asíncronos
(fallos operativos y errores de diagnóstico).
● Alarma de diagnóstico para una respuesta rápida a eventos.

Búfer de diagnóstico del módulo
Eventos de diagnóstico
El búfer de diagnóstico del módulo contiene como máximo 4 eventos de diagnóstico y está
organizado como búfer anular.
Un evento de diagnóstico se escribe en el búfer cuando se detecta un aviso (de error) entrante.
Esto puede ser un aviso, un error isócrono (error de datos) o incluso un error asíncrono (error
de servicio y error de diagnóstico). De una causa de un error pueden surgir también varias
entradas como errores consiguientes. Los avisos salientes no generan entradas en el búfer de
diagnóstico.
Para cada evento de diagnóstico se indican:
● Estado (siempre entrante)
● Error interno

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

629

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
● Error externo
● Clase de error
● Número de error
● Número de canal
● Número de levas (si hay errores de datos de levas)
Cuando se escribe un evento de diagnóstico en el búfer de diagnóstico, la señal de
realimentación DIAG = 1 se activa.
El búfer de diagnóstico puede transferirse como un todo con la instrucción CAM_DIAG o
CAM_DIAG_452 a un bloque de datos (DB de diagnóstico) o a través de un cuadro de diálogo
de evaluación de errores del software de configuración. Si se lee el búfer de diagnóstico, el
módulo activa la señal de realimentación DIAG = 0.
Nota
Si el búfer de diagnóstico se lee al mismo tiempo con la instrucción CAM_DIAG o
CAM_DIAG_452 y el cuadro de diálogo de evaluación de errores, puede ocurrir que uno de los
eventos de diagnóstico que se ha producido no sea detectado por el programa.

Datos y estructura del DB de diagnóstico
Datos y estructura del DB de diagnóstico
Nota
Los datos que no se indican en esta tabla no deben ser modificados.

La tabla siguiente muestra la estructura del DB de diagnóstico.
Dirección

Nombre

Tipo

valor inicial

Comentarios

0.0

MOD_ADDR
(registrar)

INT

0

Dirección del módulo

256.0

JOB_ERR

INT

0

Error de comunicación

258.0

JOBBUSY

BOOL

FALSE

1 = Petición activa

258.1

DIAGRD_EN

BOOL

FALSE

1 = Leer el búfer de diagnóstico necesaria‐
mente

260.0

DIAG_CNT

INT

0

Número de entradas válidas de la lista

262.0

DIAG[1]

STRUCT

Entrada más reciente de datos de diagnós‐
tico

272.0

DIAG[2]

STRUCT

Segunda entrada de datos de diagnóstico

282.0

DIAG[3]

STRUCT

Tercera entrada de datos de diagnóstico

292.0

DIAG[4]

STRUCT

Última entrada de datos de diagnóstico

630

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra la estructura de una entrada de diagnóstico DIAG[n].
Dirección

Nombre

Tipo

valor inicial

Comentarios

+0.0

STATE

BOOL

FALSE

0 = Evento saliente
1 = Evento entrante

+0.1

INTF

BOOL

FALSE

1 = Error interno

+0.2

EXTF

BOOL

FALSE

1 = Error externo

+2.0

FCL

INT

0

Clase de error
1: Fallo operativo
4: Fallo de datos
5: Fallo de datos máquina
7: Fallo de datos de leva
15: Avisos
128: Error de diagnóstico

+4.0

FNO

INT

0

Número de error 0 a 255

+6.0

CH_NO

INT

0

Número de canal (siempre 1)

+8.0

CAMNO

INT

0

Número de leva de 0 a 127 con clase de error = error de datos de
leva

Lista de los avisos JOB_ERR
Avisos JOB_ERR
JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

80A0

32928

-32608

Acuse negativo al leer el módulo. Módulo extraído durante la lectura o mó‐
dulo defectuoso.

80A1

32929

-32607

Acuse negativo al escribir en el módulo. Módulo extraído durante la escritura
o módulo defectuoso.

80A2 1)

32930

-32606

Error de protocolo en la capa 2 (transferencia de datos dentro de PROFI‐
NET / PROFIBUS DP interrumpida, p. ej. por rotura de hilo, ausencia de
conector de cierre, error de parametrización, etc.)

80A3 1)

32931

-32605

Error de protocolo en User-Interface/User (transferencia de datos dentro de
PROFINET / PROFIBUS DP interrumpida, p. ej. por rotura de hilo, ausencia
de conector de cierre, error de parametrización, etc.)

80A4 1)

32932

-32604

Anomalía en la comunicación del bus K

80B1

32945

-32591

Indicación de longitud errónea. Parámetro FM_TYPE del DB de canal para el
módulo utilizado no activado correctamente.

80B2

32946

-32590

El slot configurado no está ocupado.

32947

-32589

El tipo de módulo real no es igual al tipo de módulo teórico.

80B3
1)

32960

-32576

El módulo aún no tiene preparados los datos que hay que leer.

80C1 1)

80C0

32961

-32575

Los datos de una tarea de escritura semejante todavía no se han procesado
en el módulo.

80C2 1)

32962

-32574

El módulo procesa de instante el número máximo posible de peticiones.

80C3

1)

32963

-32573

Los recursos necesarios (memoria, etc.) están ocupados de instante.

80C4

1)

32964

-32572

Error de comunicación

80C5 1)

32965

-32571

La periferia descentralizada no está disponible.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

631

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

80C6 1)

32966

-32570

Cancelación de las clases de prioridad (rearranque normal o en segundo
plano)

8522

34082

-31454

DB del canal o DB de parámetros demasiado corto. No se pueden leer los
datos del DB. (Petición de escritura)

8532

34098

-31438

El número de DB del DB de parámetros es demasiado grande. (Petición de
escritura)

853A

34106

-31430

DB de parámetros no presente. (Petición de escritura)

8544

34116

-31420

Error en el enésimo (n > 1) acceso de lectura a un DB tras un error. (Petición
de escritura)

8723

34595

-30941

DB del canal o DB de parámetros demasiado corto. No se pueden escribir los
datos en el DB. (Petición de lectura)

8730

34608

-30928

DB de parámetros protegido contra escritura en la CPU No se pueden es‐
cribir los datos en el DB (petición de lectura)

8732

34610

-30926

El número de DB del DB de parámetros es demasiado grande. (Petición de
lectura)

873A

34618

-30918

DB de parámetros no presente. (Petición de lectura)

8745

34629

-30907

Error en el enésimo (n > 1) acceso de escritura a un DB tras un error. (Peti‐
ción de lectura)

1)

Los errores 80A2 a 80A4 así como 80Cx son temporales, es decir, se pueden eliminar tras un tiempo de espera sin la
intervención del usuario. Los avisos con la estructura 7xxx indican situaciones temporales de la comunicación.

Clases de error
Fallo operativo
Clase de error 1: Fallo operativo
Los fallos operativos se detectan de forma asíncrona respecto a un control.
La tabla siguiente muestra los fallos operativos posibles y sus causas.
Nº

Significado

1

Rebase del inicio del final de carrera por software

Sí

2

Rebase del fin del final de carrera por software

Sí

3

Rebase del inicio de la zona de desplazamiento

Sí

4

Rebase del fin de la zona de desplazamiento

Sí

Ajustar valor real al vuelo no ejecutable

Sí

13

Causa

Alarma de diag‐
nóstico

Los finales de carrera por software, tras ajustar valor real al vuelo, se en‐
cuentran fuera de la zona de desplazamiento
(-100 m...+100 m o -1.000 m...+1.000 m).
El decalaje resultante de Ajustar valor real / Ajustar valor real al vuelo es
mayor que ±100 m o ±1.000 m.

Efecto

632

Eje no sincronizado.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas

Error de datos
Clase de error 4: Error de datos
Los errores de datos se detectan de forma síncrona respecto a un control/mando.
La tabla siguiente muestra los errores de datos posibles y sus causas.
Nº

Significado

10

Decalaje de señal cero erróneo
Causa

Alarma de diag‐
nóstico
No

El decalaje de señal cero es mayor que ± 100 m o ± 1.000 m.
Los finales de carrera por software, tras ajustar el decalaje de señal cero, se
encuentran fuera de la zona de desplazamiento
(-100 m...+100 m o -1.000 m...+1.000 m).
Eje rotativo: El valor del decalaje de señal cero es mayor que el final del eje
rotativo.

11

Indicación del valor real errónea
Causa

no

Eje lineal: La coordenada se encuentra fuera del final de carrera por soft‐
ware actual (que puede estar desplazado).
Eje rotativo: La coordenada es < 0 o mayor que el final del eje rotativo.

12

Punto de referencia erróneo
Causa

no

Eje lineal: La coordenada se encuentra fuera del final de carrera por soft‐
ware actual (que puede estar desplazado).
Eje rotativo: La coordenada es < 0 o mayor que el final del eje rotativo.

20

Activar datos máquina no admisible
Causa

21

27

En el módulo no hay datos máquina nuevos (sin errores)

Ajustar valor real al vuelo no admisible
Causa

no

Se ha intentado ejecutar "Ajustar valor real al vuelo" teniendo "Redisparar
punto de referencia" activado.

Ajuste codificado en bits no permitido
Causa

no

no

Los bits no utilizados y no descritos aquí son distintos a 0.
Se ha intentado seleccionar simultáneamente" Medición de longitud" y
"Captura de bordes".

28

Redisparar el punto de referencia no admisible
Causa

no

Se ha intentado ejecutar "Redisparar el punto de referencia" estando "Ajus‐
tar valor real al vuelo" pendiente.
Se ha intentado ejecutar "Redisparar el punto de referenciao" con un encó‐
der SSI.

29

Comando codificado en bits no permitido
Causa

no

Los bits no utilizados y no descritos aquí son distintos a 0.

30

Tiempo de anticipación erróneo

no

31

Número de leva erróneo

no

Causa

La leva no es válida.
El número de leva no se encuentra en el rango 0..127.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

633

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Nº

Significado

32

Inicio de leva erróneo
Causa

Alarma de diag‐
nóstico
no

El inicio de leva se encuentra fuera de la zona de desplazamiento
(-100 m...+100 m ó -1000 m...+1000 m).
Eje rotativo: El principio de leva es < 0 o mayor que el final del eje rotativo.

33

Fin de leva erróneo / Tiempo de activación erróneo
Causa

no

El fin de leva se encuentra fuera de la zona de desplazamiento
(-100 m...+100 m ó -1000 m...+1000 m).
Eje rotativo: El final de leva es < 0 o mayor que el final del eje rotativo.
La leva no está activada por lo menos en la duración de un impulso.
En una leva invertida no hay una distancia mínima de 4 impulsos entre inicio
de leva y fin de leva.

34

No es posible cancelar la activación del valor real
Causa

35

no

Con un encóder SSI y un eje líneal, tras la ejecución del ajuste el valor real
de posición se encontraría fuera de la zona de trabajo.

Indicación del valor real errónea al Ajustar valor real / Ajustar valor real al vuelo
Causa

no

La indicación del valor real se encuentra fuera del margen numérico admi‐
sible de ± 100 m ó ± 1.000 m.
Tras la ejecución del ajuste, los finales de carrera por software se encon‐
trarían fuera de la zona de desplazamiento
(-100 m...+1000 m ó -1.000 m...+1.000 m).
El decalaje resultante de Ajustar valor real / Ajustar valor al vuelo sería
mayor que ±100 m ó ±1.000 m.

107

Eje no parametrizado
Causa

no

En el eje no hay ningún dato máquina disponible.
En el eje no hay ningún dato máquina activado.

108

Eje no sincronizado
Causa

no

Uno de los ajustes "Ajustar valor real" o "Ajustar valor real al vuelo" se ha
activado a pesar de que el eje no está sincronizado.

109

Procesamiento de levas en curso.

no

110

Número erróneo de levas a modificar

no

Error de datos máquina
Clase de error 5: Error de datos máquina
La alarma de diagnóstico sólo se disparará con un módulo de datos del sistema (SDB) con
errores.
La tabla siguiente muestra errores de datos máquina posibles y sus causas.
Nº

Significado

Alarma de
diagnóstico

5

Error en el ajuste de la alarma de proceso

Sí

Causa

634

Ha intentado seleccionar una alarma de proceso que el módulo no soporta.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Nº

Significado

6

Distancia mínima entre bordes errónea
Causa

8

Sí

El valor del final del eje rotativo se encuentra fuera del rango admitido de 1 a
109 µm o respectivamente de 1 a 108 µm (según sea la resolución).
Sí

El valor del tipo de encóder se encuentra fuera del rango admisible de 1 a 10

Recorrido erróneo por vuelta
Causa

Sí

Como tipo de eje no ha indicado ni 0 ni 1.

Tipo de encóder erróneo
Causa

11

Ha indicado como distancia mínima entre bordes un valor < 0 ó > 10 µm.

Final erróneo del eje rotativo
Causa

10

Sí
9

Tipo de eje erróneo
Causa

9

Alarma de
diagnóstico

Sí

El valor del recorrido/vuelta se encuentra fuera del margen admisible de 1 a
109 µm (independientemente de la resolución).

13

Número erróneo de incrementos/vuelta del encóder(véase el apartado "Incrementos por vuelta
del encóder (Página 602)")

Sí

14

Número erróneo de vueltas (véase el apartado ""Número de vueltas de encóder (Página 607)")

Sí

15

Velocidad de transferencia errónea

Sí

Causa
16

Para la velocidad de transferencia ha indicado un valor fuera del rango admi‐
sible de 0 a 3.

Coordinada del punto de referencia errónea
Causa

Sí

La coordenada se encuentra fuera del margen de -100 m a +100 m o, res‐
pectivamente, de -1000 m a +1000 m, según la resolución.
Eje lineal: La coordenada se encuentra fuera de la zona de trabajo.
Eje rotativo: La coordenada es < 0 o mayor que el final del eje rotativo.

17

Reajuste erróneo del encóder absoluto
Causa

18

21

Sí

Ha puesto en "FALSE" la vigilancia de errores de telegrama en el DB de pa‐
rámetros.

Inicio erróneo del final de carrera por software
Causa

Sí

Ha indicado un valor fuera de los valores admisibles 0 y 1.

Supervisión de hardware no posible
Causa

Sí

Ha indicado un valor fuera de los valores admisibles 0, 1, 6 y 7.

Ajuste erróneo del sentido
Causa

20

Encóder SSI de recorrido: El valor del reajuste del encóder absoluto no se
encuentra dentro del rango del encóder
(Incrementos por vuelta × Cantidad de vueltas - 1).

Forma errónea para redisparar el punto de referencia
Causa

19

Sí

Sí

Eje lineal: El inicio del final de carrera por software se encuentra fuera de la
zona de desplazamiento (-100 m...+100 m ó
-1000 m...+1000 m, dependiendo de la resolución).
Eje lineal: El inicio del final de carrera por software (dado el caso, incluido un
decalaje de señal cero presente) es menor que -100 m ó -1000 m (según la
resolución).

22

Fin erróneo del final de carrera por software

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Sí

635

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Nº

Significado
Causa

Alarma de
diagnóstico
Eje lineal: El fin del final de carrera por software se encuentra fuera de la zona
de desplazamiento (-100 m...+100 m ó
-1000 m...+1000 m, dependiendo de la resolución) o es menor que el inicio del
final de carrera por software.
El fin del final de carrera por software (dado el caso, incluido un decalaje de
señal cero presente) es mayor que +100 m ó +1000 m (según la resolución).

144

Alcance erróneo
Causa

145

Sí
Para el alcance ha indicado un valor distinto de 0 a 3.

Histéresis errónea
Causa

Sí
La histéresis se encuentra fuera del rango 0..65535 × resolución.
El decalaje de señal cero es mayor que ¼ × zona de trabajo o ¼ × área de eje
rotativo.

146

Velocidad de simulación errónea
Causa

Sí

La velocidad de simulación se encuentra fuera del rango 1000 × RES hasta 3
× 107 × RES o es mayor que 5 × 108 µm/min.
La velocidad de simulación no puede ajustarse internamente.

147

Pista errónea
Causa

148

Se ha seleccionado el control de una pista fuera de 0..15 (bit 0..15).

Selección errónea de entradas de habilitación
Causa

149

Sí

Ha querido habilitar una pista fuera de 3..10 (bit 0..7) mediante una señal
externa.

Selección errónea de una pista especial
Causa

Sí

Ha querido definir una pista fuera de 0, 1 y 2 (bit 0, 1 y 2) a modo de pista
especial

150

Valor de contaje superior erróneo pista 0

151

Valor de contaje superior erróneo pista 1

Causa

Sí

Ha indicado un valor de contaje < 2 ó > 65535 como valor de contaje superior.

Causa
200

Sí

Sí

Ha indicado un valor de contaje < 2 ó > 65535 como valor de contaje superior.

Resolución errónea
Causa

Sí

Ha indicado una resolución < 0,1 µm/impulso ó >1000 µm/impulso.
Ha indicado un recorrido/vuelta y una cantidad de impulsos/vuelta que dan
una resolución < 0,1 ó > 1000.

201

El encóder de recorrido no se adapta a la zona de trabajo / área del eje rotativo
Causa

Sí

Encóder SSI de recorrido y eje rotativo: El encóder de recorrido no cubre
exactamente el área del eje rotativo.
Eje lineal: El encóder de recorrido no cubre ni siquiera la zona de trabajo
(finales de carrera por software incluidos).

Error de datos de leva
Clase de error 7: Error de datos de leva
La alarma de diagnóstico sólo se disparará con un bloque de datos del sistema (SDB) con
errores.

636

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
La tabla siguiente muestra los errores de datos de leva posibles y sus causas.
Nº

Significado

1

Alarma de proceso no admisible
Causa

2

Alarma de diag‐
nóstico
Ha querido indicar una alarma de proceso con una leva con un número > 7.

Número de pista erróneo
Causa

3

Sí
Sí

El número de pista se encuentra fuera del margen 0 a 31.

Inicio de leva erróneo
Causa

Sí

El inicio de leva se encuentra fuera de la zona de desplazamiento
(-100 m...+100 m ó -1000 m...+1000 m).
Eje rotativo: El principio de leva es < 0 o mayor que el final del eje rotativo.

4

Final de leva erróneo
Causa

Sí

El fin de leva se encuentra fuera de la zona de desplazamiento
(-100 m...+100 m ó -1000 m...+1000 m).
La leva no tiene una longitud de por lo menos 1 impulso.
Eje rotativo: El final de leva es < 0 o mayor que el final del eje rotativo.
En una leva invertida no hay una distancia mínima de 4 impulsos entre inicio
de leva y fin de leva.

5

Tiempo de activación erróneo

6

Tiempo de anticipación erróneo1)

Demasiados juegos de levas
Causa

51

Eje en funcionamiento

Sí

Ha querido indicar juegos de levas con la leva electrónica activada.

Eje no parametrizado
Causa

1)

Sí

Ha querido indicar más juegos de levas de los posibles con este alcance.

Causa
52

Sí

El tiempo de anticipación es < 0 µs. El valor máximo (Página 615) depende
del alcance.

Causa
50

Sí

El tiempo de conexión es < 0µs. El valor máximo (Página 614) depende del
alcance.

Causa

Sí

Ha querido indicar datos de levas a pesar de que todavía no hay datos má‐
quina activos.

El mensaje de error también puede aparecer si ha parametrizado el sentido de contaje "invertido" en combinación con un
encóder absoluto (SSI).

Avisos
Clase de error 15: Avisos
La tabla siguiente muestra los avisos posibles y sus causas.
Nº

Significado

1

Inicio de parametrización
Causa

Alarma de diag‐
nóstico
no

El módulo ha detectado una parametrización mediante un bloque de datos
del sistema.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

637

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Nº

Significado

2

Final de la parametrización
Causa

Alarma de diag‐
nóstico
no

El módulo ha procesado sin problemas la parametrización mediante un blo‐
que de datos del sistema.

Error de diagnóstico
Clase de error 128: Error de diagnóstico
La tabla siguiente muestra los errores de datos posibles y sus causas, así como los efectos y
las soluciones posibles.
Nº

Significado

Alarma de diag‐
nóstico

4

Falta tensión auxiliar externa

Sí

Causa

La tensión auxiliar externa de 24 V no se ha conectado o ha caído, falta el
conector frontal

Efecto

Consulte "Activación de alarmas de diagnóstico (Página 627)":
● El procesamiento de levas se desactivará
● Desconexión de las salidas de pista:
● Borrado de la sincronización, con encóders incrementales
● El FM 452 no está parametrizado (señal de realimentación PARA = 0).

Solución
5

Comprobar que la conexión de 24 V sea correcta (si la conexión de 24 V es
correcta, el módulo está averiado).

Falta conector frontal
Causa

El conector frontal no está insertado

Efecto

● Falta tensión auxiliar externa de 24 V

Sí

● El módulo no está listo para funcionar
Solución
51

Enchufar el conector frontal

Vigilancia de tiempo transcurrida
Causa

● Interferencias fuertes en el FM 452

Efecto

● El módulo se resetea

Sí

● Error en el FM 452
● Siempre que tras el reseteado del módulo no se detecte ningún defecto en
el módulo, este vuelve a estar listo para funcionar.
● El módulo notifica el transcurso de la vigilancia del tiempo (watchdog) con
"entrante" y "saliente"
Solución

● Eliminación de interferencias
● Consulte al departamento comercial correspondiente cuando las
circunstancias exactas que han dado lugar al error son de mayor entidad.
● Cambio del FM 452

638

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Nº

Significado

Alarma de diag‐
nóstico

52

Caída de la alimentación interna del módulo
Causa

Error en el FM 452

Efecto

● El módulo se resetea

Sí

● Siempre que tras el reseteado del módulo no se detecte ningún defecto en
el módulo, este vuelve a estar listo para funcionar.
Solución
70

Cambio del FM 452

Alarma de proceso perdida
Causa

El FM 452 ha detectado un evento de alarma de proceso, que no puede ser
notificado porque el mismo evento todavía no ha sido procesado por el pro‐
grama de usuario o la CPU.

Efecto

● El procesamiento de levas se desactivará

Sí

● Desconexión de las salidas de pista:
● Borrado de la sincronización, con encóders incrementales
Solución

● Incorporar el OB 40 en el programa de usuario
● Comprobar la conexión de bus del módulo
● Desactivar la alarma de proceso
● Adapte el hardware y software a las necesidades de su proceso (p. ej.
CPU más rápida, optimizar el programa de usuario)

144

Rotura de hilo Encóder
Causa

Sí

● El cable del encóder no está enchufado o está cortado
● Encóder sin señales de cuadratura
● Asignación de pines errónea
● Longitud de cable excesiva
● Cortocircuito de las señales del encóder

Efecto

● El procesamiento de levas se desactivará
● Desconexión de las salidas de pista:
● Borrado de la sincronización, con encóders incrementales

Solución

● Comprobar el cable del encóder
● Guardar los datos técnicos del encóder
● La vigilancia puede desactivarse de forma provisional con el cuadro de
diálogo de parametrización bajo la responsabilidad del operador.
● Guardar las especificaciones técnicas del módulo

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

639

Leva electrónica (S7-300, S7-400)
2.1 Control por levas
Nº

Significado

145

Error de telegrama Encóder absoluto
Causa

Alarma de diag‐
nóstico
Sí

El tráfico de telegramas entre el FM 452 y el encóder absoluto (SSI) tiene
errores o está interrumpido:
● El cable del encóder no está enchufado o está cortado
● Tipo de encóder erróneo
● Encóder mal configurado (encóders programables)
● Longitud de telegrama mal indicada
● El encóder proporciona valores erróneos (encóder defectuoso)
● Interferencia en el cable del sistema de medición
● Velocidad de transferencia escogida demasiado alta

Efecto

● El procesamiento de levas se desactivará
● Desconexión de las salidas de pista:
● el último valor real correcto se mantiene sin cambios hasta el final de la
siguiente transferencia SSI correcta

Solución

● Comprobar el cable del encóder
● Comprobar el encóder
● Comprobar el tráfico de telegramas entre el encóder y el FM 452

146

Impulsos erróneos (encóder incremental)
Causa

Sí

● Vigilancia del encóder ha detectado impulsos erróneos
● La cantidad de incrementos por vuelta está mal introducida
● Encóder defectuoso: no proporciona la cantidad de impulsos indicada
● Marca cero errónea o no presente
● Interferencias en el cable del encóder

Efecto

● El procesamiento de levas se desactivará
● Desconexión de las salidas de pista:
● Borrado de la sincronización

Solución

● Indicar correctamente el número de incrementos/vuelta.
● Comprobar el encóder y su cable
● Cumplir las normas de apantallamiento y de conexión a tierra
● La vigilancia puede desactivarse de forma provisional con el cuadro de
diálogo de parametrización bajo la responsabilidad del operador.

640

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

3

Regulación PID
3.1

Principios básicos de la regulación

3.1.1

Lazo de regulación y elementos finales de control

Lazo de regulación
Un ejemplo sencillo de un lazo de regulación es la regulación de la temperatura ambiente
mediante una calefacción. La temperatura ambiente se mide con un sensor y se transmite a un
regulador. Este compara la temperatura ambiente actual con una consigna y calcula un valor
de salida (variable manipulada) para controlar la calefacción.
&RQVLJQD
9DORUUHDO

5HJXODGRU

9DULDEOH
PDQLSXODGD

$FWXDGRU

6HQVRU

&DOHIDFFLµQ

7HPSHUDWXUD

Un regulador PID ajustado correctamente alcanza la consigna lo más rápido posible y luego la
mantiene constante. Tras un cambio del valor de salida el valor real suele cambiar de forma
retardada. Este comportamiento debe compensarse con el regulador.

Elementos finales de control
El elemento final de control es un componente del lazo de regulación y se ve influenciado por
el regulador. De esta manera se modifica un flujo másico o energético.
La tabla siguiente muestra los campos de aplicación de los elementos finales de control
Aplicación para

Elemento final de control

Flujo másico de líquidos y gases

Válvula, compuerta, corredera

Flujo másico sólido p. j. carga a granel

Válvula de descarga, cinta transportadora, canal vibra‐
torio

Flujo eléctrico

Conmutador, contactor, relé, tiristor
Resistor variable, transformador de regulación, transis‐
tor

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

641

Regulación PID
3.1 Principios básicos de la regulación
Los elementos finales de control se diferencian del modo siguiente:
● Elementos finales de control proporcionales con señal de posicionamiento constante
Los ángulos de apertura, ángulos de rotación o posiciones se adoptan proporcionalmente
al valor de salida. Dentro del rango de ajuste el valor de salida incide en el proceso de
manera análoga.
A los elementos finales de control de este grupo pertenecen los accionamientos
neumáticos cargados por resorte, así como los accionamientos motorizados con
realimentación de posición en los que se conforma un lazo de regulación de
posicionamiento.
El valor de salida es generado por un regulador continuo, p. ej. PID_Compact.
● Elementos finales de control proporcionales mediante señal con modulación de ancho de
impulsos
En estos elementos finales de control (actuadores) se emite un impulso con una frecuencia
equivalente al tiempo de muestreo y cuya longitud es proporcional al valor de salida. El
elemento final de control, p. ej. una resistencia calefactora o un grupo frigorífico, se conecta
de forma sincronizada con el ciclo por un tiempo variable en función del valor de salida.
La señal de posicionamiento puede adoptar unipolarmente los estados "Conectado" o
"Desconectado" o bien representar bipolarmente los valores "Abierto/Cerrado", "Adelante/
Atrás", "Acelerar/Decelerar" etc.
El valor de salida es generado por un regulador de dos puntos, p. ej. PID_Compact con
modulación de ancho de impulsos.
● Elementos finales de control de acción integral con señal de salida de tres puntos
Frecuentemente los elementos finales de control se accionan con motores cuya duración
de conexión es proporcional al trayecto de ajuste del órgano de regulación. A este grupo
pertenecen p. ej. válvulas, compuertas y correderas. A pesar de que su diseño varía
considerablemente, estos elementos finales de control se asemejan en cuanto a que tienen
el efecto de una acción I en la entrada del sistema regulado.
El valor de salida es generado por un regulador paso a paso, p. ej. PID_3Step.

3.1.2

Sistemas regulados
Las propiedades de un sistema regulado están definidas por aspectos tecnológicos y
mecánicos que dejan un margen de influencia muy reducido. Para que la regulación arroje
buenos resultados es imprescindible elegir un tipo de regulador apropiado, que pueda ser
adaptado óptimamente a la rapidez de respuesta del sistema regulado. Por lo tanto, es
esencial conocer a fondo los datos característicos y el tipo del sistema regulado para poder
configurar la acción P, I y D del regulador.

Tipos de sistema regulado
Los sistemas regulados se clasifican en función de su rapidez de respuesta a cambios bruscos
del valor de salida.

642

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.1 Principios básicos de la regulación
Se distinguen los siguientes sistemas regulados:
● Sistemas regulados con compensación
– Sistemas regulados tipo P
– Sistemas regulados tipo PT1
– Sistemas regulados tipo PT2
● Sistemas regulados sin compensación
● Sistemas regulados con y sin tiempo muerto

Sistemas regulados con compensación
Sistemas regulados tipo P
En los sistemas proporcionales el valor real sigue al valor de salida casi instantáneamente. La
relación entre el valor real y el valor de salida se expresa mediante la ganancia proporcional
Gain del sistema regulado.
Ejemplos:
● Válvula deslizante en un sistema de tuberías
● Divisor de tensión
● Reducción en sistemas hidráulicos
Sistemas regulados tipo PT1
En un sistema regulado tipo PT1 el valor real varía en un principio de manera proporcional al
cambio del valor de salida. A medida que transcurre el tiempo, el valor real cambia más
lentamente (con retardo) hasta alcanzar un valor final.
Ejemplos:
● Sistemas de amortiguación por resorte
● Carga de componentes RC
● Depósito de agua calentado con vapor.
Frecuentemente rigen las mismas constantes de tiempo para procesos de calefacción y
refrigeración o curvas de carga y descarga. Si las constantes de tiempo son divergentes, la
regulación se torna mucho más complicada.
Sistemas regulados tipo PT2
En un sistema regulado tipo PT2 el valor real en un principio no cambia ante un escalón del
valor de salida, pero luego aumenta en rampa de subida hasta finalmente aproximarse a la
consigna con una rampa de bajada. El sistema regulado presenta un comportamiento de
transferencia proporcional con retardo de 2º grado.
Ejemplos:
● Regulación de presión
● Regulación de caudal
● Regulación de temperatura

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

643

Regulación PID
3.1 Principios básicos de la regulación

Sistemas regulados sin compensación
Los sistemas regulados sin compensación presentan un comportamiento integral. El valor real
persigue un valor infinitamente grande.
Ejemplo:
● Entrada de un líquido determinado a un depósito

Sistemas regulados con tiempo muerto
Un tiempo muerto es siempre el tiempo de ejecución o de transporte hasta que un cambio en
la entrada del sistema pueda ser medido en la salida del mismo.
En los sistemas regulados con tiempo muerto el valor real varía con retardo en función del
tiempo muerto.
Ejemplo:
Cinta transportadora

644

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.1 Principios básicos de la regulación

3.1.3

Valores característicos del sistema regulado

Determinar el comportamiento de tiempo a partir de la respuesta indicial
La respuesta temporal del sistema regulado se puede determinar a partir de la evolución
temporal del valor real x tras un cambio brusco del valor de salida y. En la mayoría de los casos
se trata de sistemas regulados con compensación.
\



W

[
7J
;PD[

ෙ[

ෙW

7X

W

El comportamiento de tiempo se puede definir aproximadamente con las magnitudes tiempo
de retardo Tu, tiempo de compensación Tg y valor máximo Xmax. Las magnitudes se determinan
posicionando tangentes en el valor máximo y en el punto de inflexión de la respuesta indicial.
En muchos casos no es posible aceptar la respuesta transitoria hasta el valor máximo debido
a que el valor real no puede rebasar ciertos valores. Luego se utiliza la velocidad de aumento
vmax para identificar el sistema regulado (vmax = Δx/Δt).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

645

Regulación PID
3.1 Principios básicos de la regulación
La regulabilidad del sistema regulado se puede estimar a partir de la relación Tu/Tg o bien Tu ×
vmax/Xmax Rige lo siguiente:
Tipo de sistema

Tu / Tg

Regulabilidad del sistema regulado

I

< 0,1

Altamente regulable

II

0,1 hasta 0,3

Todavía regulable

III

> 0,3

Difícil de regular

Incidencia del tiempo muerto en la regulabilidad del sistema regulado
Un sistema regulado con tiempo muerto y compensación presenta la respuesta siguiente ante
un escalón del valor de salida
\

W
[

7J

W
7X

7W
7D

Tt

Tiempo muerto

Tu

Tiempo de retardo

Tg

Tiempo de compensación

y

Valor de salida

x

Valor real

La regulabilidad de un sistema regulado con tiempo muerto está determinada por la relación
existente entre Tt y Tg. El valor de Tt debe ser pequeño en relación a Tg. Rige:
Tt/Tg ≤ 1

Velocidad de reacción de sistemas regulados
Los sistemas regulados se pueden catalogar en función de los valores siguientes:
Tu < 0,5 min, Tg < 5 min = sistema regulado rápido

646

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.1 Principios básicos de la regulación
Tu > 0,5 min, Tg > 5 min = sistema regulado lento

Valores característicos de algunos sistemas regulados
Magnitud físi‐
ca
Temperatura

Sistema regulado

Tiempo de retardo Tu

Tiempo de com‐
pensación Tg

Velocidad de au‐
mento vmax

Horno pequeño calentado eléctricamente

0,5 hasta 1 min

5 hasta 15 min

hasta 60 K/min

Horno de recocer grande calentado eléctri‐
camente

1 hasta 5 min

10 hasta 20 min

hasta 20 K/min

Horno de recocer grande calentado por gas

0,2 hasta 5 min

3 hasta 60 min

1 hasta 30 K/min

1 hasta 7 min

40 hasta 60 min

0,1 hasta 0,5 °C/s

Autoclave (2,5 m3)

0,5 hasta 0,7 min

10 hasta 20 min

ninguna indica‐
ción

Autoclave de alta presión

12 hasta 15 min

200 hasta 300 min

ninguna indica‐
ción

Columna de destilación fraccionada

Recalentador de vapor
Máquinas de moldeo por inyección
Extrusora
Máquinas de envasado y embalaje
Calefacción de locales
Caudal
Presión

Tubería con gas

30 s hasta 2,5 min

1 hasta 4 min

2 °C/s

0,5 hasta 3 min

3 hasta 30 min

5 hasta 20 K/min

1 hasta 6 min

5 hasta 60 min

0,5 hasta 4 min

3 hasta 40 min

2 hasta 35 K/min

1 hasta 5 min

10 hasta 60 min

1 °C/min
no aplicable

0 hasta 5 s

0,2 hasta 10 s

Tubería con líquido

Sin

Sin

Tubería de gas

Sin

0,1 s

no aplicable

Caldera de tambor calentada con gas o
fuel oil

Sin

150 s

no aplicable

2 hasta 5 min

no aplicable

Caldera de tambor con molinos batidores

1 hasta 2 min

Nivel del de‐
pósito (nivel)

Caldera de tambor

Velocidad

Accionamiento eléctrico pequeño

Sin

0,2 hasta 10 s

no aplicable

Accionamiento eléctrico grande

Sin

5 hasta 40 s

no aplicable

Turbina de gas

Sin

ninguna indicación

50 rpm

Generadores pequeños

Sin

1 hasta 5 s

no aplicable

Generadores grandes

Sin

5 hasta 10 s

no aplicable

Tensión eléc‐
trica

3.1.4

0,6 hasta 1 min

ninguna indicación 0,1 hasta 0,3 cm/s

Regulador de impulsos

Regulador de dos puntos sin realimentación
Los reguladores de dos puntos tienen como función de conmutación el estado "ON" y "OFF".
Esto corresponde al 100 % o bien al 0 % de la potencia. Este comportamiento origina una
oscilación continua del valor real x en torno a la consigna w.
La amplitud y la duración de periodo de la oscilación aumentan con la relación existente entre
el tiempo de retardo Tu y el tiempo de compensación Tg presente en el sistema regulado. Estos

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

647

Regulación PID
3.1 Principios básicos de la regulación
reguladores se utilizan principalmente en regulaciones de temperatura simples (p. ej. hornos
eléctricos de calefacción directa) o como señalizadores de límite.
El gráfico siguiente muestra la curva característica de un regulador de dos puntos
\



<K


Z

①
②

OFF

Yh

Rango

w

Consigna

[

ON

El gráfico siguiente muestra la función de regulación de un regulador de dos puntos

648

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.1 Principios básicos de la regulación

[

7J





Z
;
6G

7X

W

\




W

①
②

Respuesta transitoria con regulador de dos puntos

Tu

Tiempo de retardo

Tg

Tiempo de compensación

XSd

Ganancia diferencial

Respuesta transitoria sin regulador

Regulador de dos puntos con realimentación
El comportamiento de los reguladores de dos puntos en sistemas regulados que presentan
grandes tiempos de retardo (p. ej. hornos en los que la capacidad útil está separada de la
calefacción) se puede mejorar con realimentaciones electrónicas.
Con la realimentación se eleva la frecuencia de conmutación del regulador, con lo que se
reduce la amplitud del valor real. Además, se pueden mejorar considerablemente los
resultados de la regulación en el funcionamiento dinámico. El límite de la frecuencia de
conmutación está definido por la etapa de salida. La frecuencia de conmutación de elementos
finales de control mecánicos como relés y contactores no debe ser mayor de 1 a 5
conmutaciones por minuto. Para las salidas de corriente y tensión binarias con tiristores o
triacs postconectados se pueden elegir altas frecuencias de conmutación ubicadas muy por
encima de la frecuencia de corte del sistema regulado.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

649

Regulación PID
3.1 Principios básicos de la regulación
Dado que los impulsos de conmutación en la salida del sistema regulado ya no se pueden
determinar, se obtienen resultados comparables a los de los reguladores continuos.
El valor de salida se genera por modulación del ancho de impulsos del valor de salida de un
regulador continuo.
Los reguladores de dos puntos con realimentación se utilizan para regular la temperatura en
hornos, máquinas para procesar plástico, textiles, papel, goma y alimentos, así como en
enfriadores y calefactores.

Regulador de tres puntos
Los reguladores de tres puntos se utilizan en calefacción/refrigeración. Estos reguladores
tienen dos puntos de conmutación como salida. Los resultados de la regulación se optimizan
con estructuras de realimentación electrónicas. Los campos de aplicación de estos
reguladores son las cámaras térmicas, frigoríficas y climatizadas, así como el
precalentamiento de herramientas de máquinas transformadoras de plástico.
El gráfico siguiente muestra la curva característica de un regulador de tres puntos
\
\

\

\

\
[

Z
[ 6K

y

Valor de salida, p. ej.
y11 = 100 % calefacción
y12 = 0 % calefacción
y21 = 0 % refrigeración
y22 = 100 % refrigeración

650

x

Unidad física del valor real, p. ej. la temperatura en °C

w

Consigna

xSh

Distancia entre los puntos de conmutación 1 y 2

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.1 Principios básicos de la regulación

3.1.5

Respuesta de regulación y a perturbaciones

Respuesta de regulación
El valor real debe seguir un cambio de la consigna lo más rápido posible. La respuesta de
regulación mejora cuanto más corto sea el tiempo necesario para alcanzar la nueva consigna
y menor la fluctuación del valor real.
[

Z

W

x

Valor real

w

Consigna

Respuesta a perturbaciones
La consigna se ve afectada por magnitudes perturbadoras. El regulador debe eliminar lo más
rápido posible el error de regulación resultante. La respuesta a perturbaciones mejora cuanto
más corto sea el tiempo necesario para alcanzar la nueva consigna consigna y menor la
fluctuación del valor real.
[



Z

W

x

Valor real

w

Consigna

①

Incidencia de una magnitud perturbadora

Una magnitud perturbadora se compensa con reguladores con acción I. La calidad de la
regulación no se reduce por una magnitud perturbadora que incida constantemente, ya que el

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

651

Regulación PID
3.1 Principios básicos de la regulación
error de regulación es relativamente constante. Una magnitud perturbadora dinámica afecta
en mayor medida a la calidad de la regulación porque el error de regulación fluctúa. Sólo a
través de la acción I, que se forma lentamente, se vuelve a reducir el error de regulación.
Una magnitud perturbadora medible puede entrar en el lazo de regulación. Esto puede
acelerar considerablemente la reacción del regulador.

3.1.6

Respuesta de regulación con diferentes estructuras de realimentación

Comportamientos de regulador
Cuanto mayor sea la precisión de adaptación del regulador al comportamiento de tiempo del
sistema regulado, mayor será la precisión de ajuste de la consigna, de modo que la respuesta
a magnitudes perturbadores será óptima.
La inclusión en la realimentación puede tener un comportamiento proporcional (P),
proporcional diferencial (PD), proporcional integral (PI) o proporcional integral diferencial (PID).
Si se le aplica una función de escalón al error de regulación, se generarán distintas respuestas
indiciales en función del regulador.

652

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.1 Principios básicos de la regulación

Respuesta indicial de un regulador P


[

W


\

W
\






①
②
③

W

Error de regulación
Valor de salida de un regulador continuo
Valor de salida de un regulador de impulsos

Fórmula para reguladores P
El valor de salida y el error de regulación son directamente proporcionales, es decir:
Valor de salida = ganancia proporcional × error de regulación
y = GAIN × x

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

653

Regulación PID
3.1 Principios básicos de la regulación

Respuesta indicial de un regulador PD


[

W
\


70B/$*

W
\





W

①
②
③

Valor de salida de un regulador continuo

TM_LAG

Retardo de la acción D

Error de regulación
Valor de salida de un regulador de impulsos

Fórmula para reguladores PD
Para la respuesta indicial del regulador PD en el dominio temporal rige lo siguiente:
W
7'
\ *$,1y;:y 
70B/$*

70B/$*
yH

t = duración desde el escalón del error de regulación
La acción D genera un valor de salida en función de la velocidad con la que cambia el valor real.
Una acción D pura no es apta para la regulación, pues sólo un cambio del valor real puede

654

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.1 Principios básicos de la regulación
generar un cambio del valor de salida. Si el valor real permanece constante, el valor de salida
tampoco cambia.
La acción D, en combinación con una acción P, mejora la respuesta a perturbaciones. Las
perturbaciones no se eliminan por completo. El comportamiento beneficioso es el bueno y
dinámico. Durante el desplazamiento y al cambiar la consigna se alcanza una transición bien
amortiguada y exenta de vibraciones.
Un regulador con acción D no es apropiado si el sistema regulado tiene magnitudes de
medición pulsantes, p. ej. en la regulación de presión o de caudal.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

655

Regulación PID
3.1 Principios básicos de la regulación

Respuesta indicial de un regulador PI
[


W
\



W
\





W

①
②
③

Error de regulación
Valor de salida de un regulador continuo
Valor de salida de un regulador de impulsos

Una acción I en el regulador totaliza el error de regulación en el tiempo. De este modo el
regulador sigue reajustándose hasta eliminar el error de regulación. En un regulador P puro se
presenta un error de regulación permanente. Éste se puede eliminar con una acción I en el
regulador.
Dependiendo de los requisitos que deba cumplir la respuesta de regulación, en la práctica
resulta idónea una combinación de las acciones P, I y D. El comportamiento de tiempo de las
distintas acciones se puede describir con los siguientes parámetros del regulador: ganancia
proporcional GAIN, tiempo de acción integral TI (acción I) y tiempo de anticipación TD (acción
D).

656

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.1 Principios básicos de la regulación
Fórmula para reguladores PI
Para la respuesta indicial del regulador PI en el dominio temporal rige lo siguiente:
\ *$,1y;:y 


7,yW

t = duración desde el escalón del error de regulación

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

657

Regulación PID
3.1 Principios básicos de la regulación

Respuesta indicial de un regulador PID
[


W

\

70B/$*

W

7,

\



W

①
②
③

Valor de salida de un regulador continuo

TM_LAG

Retardo de la acción D

Ti

Tiempo de integración

Error de regulación
Valor de salida de un regulador de impulsos

Fórmula para reguladores PID
Para la respuesta indicial del regulador PID en el dominio temporal rige lo siguiente:

658

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.1 Principios básicos de la regulación

\ *$,1y;:y




7,yW

7'

 70B/$* yH

W
70B/$*

t = duración desde el escalón del error de regulación

Comportamiento de un sistema regulado con distintas estructuras de regulación
La mayoría de regulaciones que se aplican en la técnica de procesos se puede controlar con
un regulador con comportamiento PI. En sistemas regulados lentos con grandes tiempos de
retardo, p. ej. regulación de temperatura, el resultado de la regulación se puede mejorar con
un regulador con comportamiento PID.
[






Z




W

①
②
③

Regulador PID

w

Consigna

x

Valor real

Sin regulador
Regulador PD

Los reguladores con comportamiento PI y PID ofrecen la ventaja de que tras la fase de
estabilización el valor real no muestra ninguna desviación frente a la consigna. Durante el
desplazamiento el valor real oscila sobre la consigna.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

659

Regulación PID
3.1 Principios básicos de la regulación

3.1.7

Elección de la estructura del regulador con un sistema regulado definido

Selección de las estructuras de regulador apropiadas
Un resultado de regulación óptimo sólo se puede alcanzar si se elige una estructura de
regulador que sea afín al sistema regulado, y que se pueda adaptar al mismo dentro de
determinados límites.
La tabla siguiente ofrece una vista general de las estructuras de regulador adecuadas en
función del sistema regulado.
Sistema regulado

Estructura de regulador
P

PD

PI

PID

Sólo con tiempo muerto No apta

No apta

Apta

No apta

PT1 con tiempo muerto No apta

No apta

Muy apta

Muy apta

PT2 con tiempo muerto No apta

Apta con limitacio‐
nes

Muy apta

Muy apta

Alto grado

No apta

No apta

Apta con limitacio‐
nes

Muy apta

Sin compensación

Muy apta

Muy apta

Muy apta

Muy apta

La tabla siguiente ofrece una vista general de las estructuras de regulador adecuadas en
función de la magnitud física.
Magnitud física

Estructura de regulador
P

PD

Error de regulación permanente

660

PI

PID

Error de regulación no permanente

Temperatura

Para exigencias
reducidas y siste‐
mas P con Tu/Tg <
0,1

Muy apta

Estructuras de regulador idóneas para
exigencias elevadas (con excepción de
reguladores especiales adaptados)

Presión

Apta, si el tiempo
de retardo no es
significativo

No apta

Estructuras de regulador idóneas para
exigencias elevadas (con excepción de
reguladores especiales adaptados)

Caudal

No apta, porque el No apta
rango GAIN reque‐
rido suele ser de‐
masiado grande

Válido, pero el re‐ Casi no es necesa‐
gulador I solo sue‐ ria
le ser mejor

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

3.1.8

Ajuste de los parámetros PID

Fórmula empírica para ajustar los parámetros
Estructura de regulador
P
PI

Ajuste
GAIN ≈ vmax × Tu [ °C ]
GAIN ≈ 1,2 × vmax × Tu [ °C ]
TI ≈ 4 × Tu [ min ]

PD

GAIN ≈ 0,83 × vmax × Tu [ °C ]
TD ≈ 0,25 × vmax × Tu [ min ]
TM_LAG ≈ 0,5 × TD[ min ]

PID

GAIN ≈ 0,83 × vmax × Tu [ °C ]
TI ≈ 2 × Tu [ min ]
TD ≈ 0,4 × Tu [ min ]
TM_LAG ≈ 0,5 × TD[ min ]

PD/PID

GAIN ≈ 0,4 × vmax × Tu [ °C ]
TI ≈ 2 × Tu [ min ]
TD ≈ 0,4 × Tu [ min ]
TM_LAG ≈ 0,5 × TD[ min ]

En vez de vmax = ∆x / ∆t se puede utilizar Xmax / Tg.
En los reguladores con estructura PID el ajuste del tiempo de acción integral está acoplado por
lo general al ajuste del tiempo de anticipación.
La relación TI / TD es de 4 a 5 y por lo tanto óptima para la mayoría de sistemas regulados.
La inobservancia del tiempo de anticipación TD no es grave en los reguladores PD.
En los reguladores PI o PID ocurren oscilaciones en la regulación si el tiempo de acción integral
TI se ha ajustado por debajo de la mitad del nivel requerido.
Un tiempo de acción integral demasiado grande retarda la eliminación de perturbaciones. No
se puede pretender que los lazos de regulación trabajen óptimamente después de haber
ajustado por primera vez los parámetros. La experiencia ha demostrado que es necesario
efectuar un reajuste de parámetros si se trata de un sistema "difícil de regular" con Tu / Tg > 0,3.

3.2

Configuración de un regulador por software

3.2.1

Vista general de los reguladores de software
Para la configuración de un regulador por software, se requiere una instrucción con el
algoritmo de regulación y un objeto tecnológico. El objeto tecnológico para un regulador de
software equivale al DB de instancia de la instrucción. En el objeto tecnológico, se guarda la
configuración del regulador. A diferencia de los DB de instancia de otras instrucciones, los
objetos tecnológicos no se guardan junto a los recursos del programa, sino en CPU > Objetos
tecnológicos.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

661

Regulación PID
3.2 Configuración de un regulador por software

Objetos tecnológicos e instrucciones
CPU

Librería

Instrucción

Objeto tecnológi‐
co

Descripción

S7-1200

Compact PID

PID_Compact
V1.x

PID_Compact
V1.x

Regulador PID universal con optimización in‐
tegrada

S7-1200

PID_3Step V1.x

PID_3Step V1.x

Regulador PID para válvulas con optimiza‐
ción integrada

S7-1500
S7-1200 V4.x

PID_Compact
V2.x

PID_Compact
V2.x

Regulador PID universal con optimización in‐
tegrada

S7-1500

PID_3Step V2.x

PID_3Step V2.x

Regulador PID para válvulas con optimiza‐
ción integrada

PID_Temp V1.x

PID_Temp V1.x

Regulador de temperatura PID universal con
optimización integrada

CONT_C

CONT_C

Regulador continuo

S7-1500/300/4
00

CONT_S

CONT_S

Regulador paso a paso para elementos fina‐
les de control de acción integrativa

S7-1500/300/4
00

PULSEGEN

-

Generador de impulsos para elementos fina‐
les de control de acción proporcional

S7-1500/300/4
00

TCONT_CP

TCONT_CP

Regulador de temperatura continuo con ge‐
nerador de impulsos

S7-1500/300/4
00

TCONT_S

TCONT_S

Regulador de temperatura para accionado‐
res integrables

TUN_EC

TUN_EC

Optimización de un regulador continuo

TUN_ES

TUN_ES

Optimización de un regulador paso a paso

PID_CP

Regulador continuo con generador de impul‐
so

PID_ES

Regulador paso a paso para elementos fina‐
les de control de acción integrativa

-

Distribuir llamadas del regulador

S7-1200 V4.x
S7-1500 ≥ V1.7
S7-1200 ≥ V4.1
S7-1500/300/4
00

S7-300/400
S7-300/400
S7-300/400
S7-300/400
S7-300/400

662

Funciones básicas
de PID

PID Self Tuner

Standard PID Con‐ PID_CP
trol (paquete op‐
cional PID Profes‐ PID_ES
sional)
LP_SCHED

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software
CPU

Librería

Instrucción

Objeto tecnológi‐
co

Descripción

S7-300/400

Modular PID Con‐
trol (paquete op‐
cional PID Profes‐
sional)

A_DEAD_B

-

Filtrar señales perturbadoras del error de re‐
gulación

CRP_IN

-

Escalar señal de entrada analógica

CRP_OUT

-

Escalar señal de salida analógica

S7-300/400

DEAD_T

-

Emitir señal de entrada retardada

S7-300/400

DEADBAND

-

Inhibir pequeñas oscilaciones del valor real

S7-300/400

DIF

-

Diferenciar señal de entrada en el tiempo

S7-300/400

ERR_MON

S7-300/400

INTEG

S7-300/400
S7-300/400

S7-300/400
S7-300/400

Vigilar error de regulación
-

Integrar señal de entrada en el tiempo

LAG1ST

-

Elemento de retardo de primer orden

LAG2ND

-

Elemento de retardo de segundo orden

S7-300/400

LIMALARM

-

Notificar valores límite

S7-300/400

LIMITER

-

Limitar la variable manipulada

S7-300/400

LMNGEN_C

-

Determinar variable manipulada para regula‐
dor continuo

S7-300/400

LMNGEN_S

-

Determinar variable manipulada para regula‐
dor paso a paso

S7-300/400

NONLIN

-

Linealizar señal del encóder

S7-300/400

NORM

-

Normalizar el valor real físicamente

S7-300/400

OVERRIDE

-

Aplicar variables manipuladas de 2 regulado‐
res PID en 1 actuador

S7-300/400

PARA_CTL

-

Conmutar juegos de parámetros

S7-300/400

PID

-

Algoritmo PID

S7-300/400

PUSLEGEN_M

-

Generar impulsos para actuadores de acción
proporcional

S7-300/400

RMP_SOAK

-

Especificar consignas según perfil

S7-300/400

ROC_LIM

-

Limitar la velocidad de cambio

S7-300/400

SCALE_M

-

Escalar valor real

S7-300/400

SP_GEN

-

Especificar consigna manualmente

S7-300/400

SPLT_RAN

-

Dividir rangos de variable manipulada

S7-300/400

SWITCH

-

Aplicar valores analógicos

S7-300/400

LP_SCHED_M

-

Distribuir llamadas del regulador

3.2.2

Pasos para la configuración de un regulador por software
Todos los reguladores de software se proyectan según el mismo esquema:
Paso

Descripción

1

Agregar objeto tecnológico (Página 664)

2

Configurar objeto tecnológico (Página 665)

3

Llamar la instrucción en el programa de usuario (Página 666)

4

Cargar objeto tecnológico en el dispositivo (Página 667)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

663

Regulación PID
3.2 Configuración de un regulador por software

3.2.3

Paso

Descripción

5

Poner en marcha el regulador de software (Página 668)

6

Guardar los parámetros PID optimizados en el proyecto (Página 669)

7

Comparar valores (Página 670)

8

Mostrar instancias de un objeto tecnológico (Página 691)

Agregar objetos tecnológicos

Agregar objeto tecnológico en el árbol del proyecto
Al agregar un objeto tecnológico, se genera un DB de instancia de la instrucción para este
objeto tecnológico. En él se guarda la configuración del objeto tecnológico.

Requisitos
Hay un proyecto creado con una CPU.

Procedimiento
Para agregar un objeto tecnológico, proceda del siguiente modo:
1. Abra la carpeta de la CPU en el árbol del proyecto.
2. Abra la carpeta "Objetos tecnológicos".
3. Haga doble clic en "Agregar objeto".
Se abre el cuadro de diálogo "Agregar objeto".
4. Haga clic en el botón "Regulador PID".
Se muestran todos los reguladores PID disponibles para esta CPU.
5. Seleccione la instrucción para el objeto tecnológico, p. ej., PID_Compact.
6. En el campo de entrada "Nombre", introduzca un nombre personalizado para el objeto
tecnológico.
7. Seleccione la opción "manual" si desea modificar el número de bloque de datos propuesto
para el DB de instancia.
8. Haga clic en "Más información" para guardar información propia sobre el objeto tecnológico.
9. Confirme con "OK".

664

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

Resultado
El nuevo objeto tecnológico se genera y se guarda en la capeta "Objetos tecnológicos" del
árbol del proyecto. El objeto tecnológico se utiliza, cuando la instrucción para este objeto
tecnológico se llama en un OB de alarma cíclica.
Nota
Existe la posibilidad de activar la casilla de verificación "Agregar nuevo y abrir" situada en la
parte inferior del diálogo. De ese modo, la configuración del objeto tecnológico se abrirá una
vez agregado.

3.2.4

Configurar objetos tecnológicos
Puede configurar las propiedades de un objeto tecnológico en una CPU S7-1200 de dos
maneras.
● En la ventana de inspección del editor de programación
● En el editor de configuración
Puede configurar las características de un objeto tecnológico en una CPU S7-300/400 sólo en
el editor de configuración.

Ventana de inspección del editor de programación
En la ventana de inspección del editor de programación, sólo es posible configurar los
parámetros que son necesarios para el funcionamiento.
También en el modo en línea, se muestran los valores fuera de línea de los parámetros. Los
valores en línea se pueden modificar sólo en la ventana de puesta en servicio.
Para abrir la ventana de inspección del objeto tecnológico, proceda del siguiente modo:
1. Abra la carpeta "Bloques de programa" en el árbol del proyecto.
2. Haga doble clic en el bloque (OB de alarma cíclica) en el que llama la instrucción del
regulador de software.
El bloque se abre en el área de trabajo.
3. Haga clic en la instrucción del regulador de software.
4. En la ventana de inspección, seleccione una tras otra las fichas "Propiedades" y
"Configuración".

Ventana de configuración
Para cada objeto tecnológico, hay una ventana de configuración específica, en la que se
configuran todas las características.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

665

Regulación PID
3.2 Configuración de un regulador por software
Para abrir la ventana de configuración de un objeto tecnológico, proceda del siguiente modo:
1. Abra la carpeta "Objetos tecnológicos" en el árbol del proyecto.
2. Abra el objeto tecnológico en el árbol del proyecto.
3. Haga doble clic en el objeto "Configuración".

Símbolos
Los símbolos que aparecen en la navegación local de la configuración y de la ventana de
inspección muestran más detalles sobre la integridad de la configuración:
La configuración contiene valores predeterminados y está completa.
La configuración sólo contiene valores predeterminados. Con ellos es posible utilizar el objeto
tecnológico sin más modificaciones.
La configuración contiene valores definidos por el usuario o adaptados automáticamente y está
completa
Todos los campos de entrada de la configuración contienen valores válidos y se ha modificado
como mínimo un valor predeterminado.
La configuración es incompleta o errónea
Como mínimo un campo de entrada o una lista desplegable está vacío o contiene un valor no válido.
El campo o la lista desplegable en cuestión se marca en rojo. Al hacer clic, el roll out con el aviso
de error indica la causa del error.

La características de un objeto tecnológico se describen con detalle en el capítulo para el
objeto tecnológico.

3.2.5

Llamar la instrucción en el programa de usuario
La instrucción del regulador de software se debe llamar en el OB de alarma cíclica. El tiempo
de muestreo del regulador de software se determina a partir del intervalo transcurrido entre las
llamadas en el OB de alarma cíclica.

Requisitos
El OB de alarma cíclica está creado y el tiempo de ciclo del OB de alarma cíclica está
configurado correctamente.

Procedimiento
Para llamar la instrucción en el programa de usuario, proceda del siguiente modo:
1. Abra la carpeta de la CPU en el árbol del proyecto.
2. Abra la carpeta "Árbol del proyecto".
3. Haga doble clic en el OB de alarma cíclica.
El bloque se abre en el área de trabajo.
4. Abra, en la ventana "Instrucciones", el grupo "Tecnología" y la carpeta "PID Control".
La carpeta contiene todas las instrucciones para los reguladores del software que se
pueden configurar en la CPU.

666

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software
5. Seleccione una instrucción y arrástrela al OB de alarma cíclica correspondiente mediante
Drag & Drop.
Se abre el cuadro de diálogo "Opciones de llamada".
6. En la lista "Nombre" seleccione un objeto tecnológico o introduzca el nombre del nuevo
objeto tecnológico.

Resultado
Si el objeto tecnológico no existe todavía, éste se agrega. La instrucción se agrega en el OB
de alarma cíclica. El objeto tecnológico está asignado a esta llamada de la instrucción.

3.2.6

Cargar objetos tecnológicos en el dispositivo
Para poder utilizar una configuración nueva o modificada en el modo online es necesario
cargarla en la CPU. Al cargar datos remanentes, hay que tener en cuenta las siguientes
particularidades:
● Software (solo modificaciones)
– S7-1200, S7-1500:
Los datos remanentes se conservan.
– S7-300/400:
Los datos remanentes se actualizan de inmediato. La CPU no pasa a Stop.
●

Cargar e inicializar programa PLC en el dispositivo
– S7-1200, S7-1500:
Los datos remanentes se actualizan con la siguiente transición de Stop a RUN. El
programa PLC solo puede cargarse completo.
– S7-300/400:
Los datos remanentes se actualizan con la siguiente transición de Stop a RUN.

Cargar datos remanentes en una CPU S7-1200 o S7-1500
Nota
La carga e inicialización del programa PLC con la instalación en marcha puede causar
importantes daños materiales y personales en caso de fallos de funcionamiento o errores de
programa.
Asegúrese de que no puedan darse situaciones de peligro antes de cargar e inicializar el
programa PLC.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

667

Regulación PID
3.2 Configuración de un regulador por software
Para cargar datos remanentes, proceda del siguiente modo:
1. Seleccione la entrada de la CPU en el árbol del proyecto.
2. Seleccione el comando "Cargar e inicializar programa PLC en el dispositivo" en el menú
"Online".
– Si hasta ahora no se ha establecido ninguna conexión online, se abre el cuadro de
diálogo "Carga avanzada". Ajuste en este caso todos los parámetros necesarios para la
conexión y haga clic en "Cargar".
– Una vez definida la conexión online, los datos de proyecto se compilan si es necesario
y se abre el cuadro de diálogo "Cargar vista preliminar". En este cuadro de diálogo se
muestran avisos y se indican acciones necesarias para la carga.
3. Compruebe los avisos.
Cuando la carga pueda efectuarse, el botón "Cargar" se activa.
4. Haga clic en "Cargar".
El programa PLC completo se carga y se abre el cuadro de diálogo "Cargar resultados".
Este cuadro de diálogo muestra el estado y las acciones tras el proceso de carga.
5. Si los módulos deben volver a arrancarse directamente tras la carga, active la casilla de
verificación "Arrancar todos".
6. Cierre el cuadro de diálogo "Cargar resultados" con "Finalizar".

Resultado
El programa PLC completo se carga en el dispositivo. Se borran los bloques que solo existen
online en el dispositivo. Cargando todos los bloques implicados y borrando los bloques no
necesarios en el dispositivo, se evitan incoherencias entre los bloques en el programa de
usuario.
Los avisos de la ventana de inspección (en "Información > General") indican si el proceso de
carga ha finalizado correctamente.

3.2.7

Poner en marcha el regulador de software

Procedimiento
Para abrir la zona de trabajo "Puesta en servicio" de un objeto tecnológico, proceda del
siguiente modo:
1. Abra la carpeta "Objetos tecnológicos" en el árbol del proyecto.
2. Abra el objeto tecnológico en el árbol del proyecto.
3. Haga doble clic en el objeto "Puesta en servicio".
Las funciones para la puesta en servicio son específicas para cada regulador y se describen
allí.

668

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

3.2.8

Guardar los parámetros PID optimizados en el proyecto
El regulador de software se optimiza en la CPU. De este modo, los valores ya no coinciden con
su proyecto en el DB de instancia en la CPU.
Para actualizar los parámetros PID en el proyecto con los parámetros PID optimizados en la
CPU, proceda del siguiente modo:

Requisitos
● Hay establecida una conexión online con la CPU y esta se encuentra en el estado operativo
"RUN".
● Las funciones de la ventana de puesta en servicio se han habilitado con el botón "Iniciar".

Procedimiento
1. Abra la carpeta de la CPU en el árbol del proyecto.
2. Abra la carpeta "Objetos tecnológicos".
3. Abra un objeto tecnológico.
4. Haga doble clic en "Puesta en servicio".
5. Haga clic en el símbolo

"Cargar parámetros PID".

6. Guarde el proyecto.

Resultado
Los parámetros PID efectivos en ese momento se guardan en los datos del proyecto. Al cargar
nuevamente los datos de proyecto en la CPU, se utilizan los parámetros optimizados.

3.2.9

Comparar valores

3.2.9.1

Visualización de comparación y condiciones
La función "Comparar valores" ofrece las siguientes opciones:
● Comparación de los valores de arranque configurados del proyecto con los valores de
arranque de la CPU y los valores actuales
● Procesamiento directo de los valores actuales y de los valores de arranque del proyecto
● Detección y visualización inmediatas de errores de introducción con ayuda para su
corrección
● Copia de seguridad de los valores actuales en el proyecto
● Transferencia de los valores de arranque del proyecto a la CPU como valores actuales

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

669

Regulación PID
3.2 Configuración de un regulador por software

Símbolos y elementos de control
Están disponibles los siguientes símbolos y elementos de control:
Símbolo

Función
El valor de arranque en la CPU es igual al valor de arranque configurado en el proyecto
El valor de arranque en la CPU es diferente al valor de arranque configurado en el
proyecto
No se puede realizar la comparación entre valor de arranque en la CPU y valor de arran‐
que configurado en el proyecto
Por lo menos uno de los dos valores de comparación es incorrecto desde el punto de
vista tecnológico o sintáctico.
Los valores actuales se transmiten al proyecto offline
Los valores de arranque actualizados en el proyecto se transfieren a la CPU (inicializar
valores de ajuste)
Se abre el cuadro de diálogo "Comparar valores"

Condiciones
La función "Comparar valores" está disponible de forma ilimitada para S7-1200 y S7-1500.
Para S7-300 y S7-400 rige la siguiente limitación:
En el modo de observación una S7-300/S7-400 no puede transferir los valores de arranque a
la CPU. Estos valores no pueden mostrarse online con "Comparar valores".
Los valores actuales del objeto tecnológico se muestran y se pueden modificar directamente.

3.2.9.2

Comparar valores
A continuación se muestra el procedimiento con el ejemplo de los "parámetros PID".

Requisitos
● Está configurado un proyecto con un regulador de software.
● El proyecto está cargado en la CPU.
● En el navegador de proyecto está abierto el diálogo de configuración.

Procedimiento
1. Abra el regulador de software deseado en el árbol del proyecto.
2. Haga doble clic en el objeto "Configuración".
3. Navegue al cuadro de diálogo "Parámetros PID" en la ventana de configuración.
4. Haga clic en el símbolo
para activar el modo de observación.
Se muestran los símbolos y elementos de control (Página 669) de la función "Comparar
valores" detrás de los parámetros.

670

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software
5. Haga clic en el campo de entrada del parámetro deseado y modifique manualmente los
valores de parámetro mediante entrada directa.
– Si el fondo del campo de entrada es gris, los valores solo son legibles, no modificables.
– Para modificar los valores en el cuadro de diálogo "Parámetros PID", active primero la
entrada manual haciendo clic en la casilla de verificación "Activar entrada manual".
6. Haga clic en el símbolo
para abrir el cuadro de diálogo de los valores de arranque.
Este cuadro de diálogo muestra dos valores del parámetro:
– Valor de arranque en la CPU: En la parte superior se muestra el valor de arranque en la
CPU.
– Valor de arranque en el proyecto: En la parte inferior se muestra el valor de arranque
configurado en el proyecto.
7. Introduzca el valor deseado en el campo de entrada para el proyecto.

Detección
Se detecta la entrada de valores incorrectos. En ese caso, se ofrece ayuda para la corrección.
Si introduce un valor sintácticamente erróneo, debajo del parámetro se abre una ventana
desplegable con el correspondiente aviso de error. No se aplica el valor medido incorrecto.
Si introduce un valor tecnológicamente incorrecto, se abre un cuadro de diálogo en el que se
notifica el error y se muestra información para la corrección:
● Haciendo clic en "No" puede adoptar la corrección y corregir su entrada.
● Haciendo clic en "OK" se aplica el valor incorrecto.
ATENCIÓN
Mal funcionamiento del regulador
Los valores tecnológicamente incorrectos pueden producir un mal funcionamiento del
regulador.

Copia de seguridad de los valores actuales
Haciendo clic en el símbolo
se transfieren los valores actuales del regulador a los valores
de arranque de su proyecto configurado.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

671

Regulación PID
3.2 Configuración de un regulador por software

Transferir valores de proyecto a la CPU
Haciendo clic en el símbolo

se transfieren los valores configurados de su proyecto a la CPU.

PRECAUCIÓN
Evitar daños personales y materiales
La carga e inicialización del programa de usuario en la instalación en marcha puede causar
importantes daños materiales y personales en caso de fallos de funcionamiento o errores de
programa.
Asegúrese de que no puedan darse situaciones de peligro antes de cargar e inicializar el
programa de usuario.

3.2.10

Vista de parámetros

3.2.10.1

Introducción a la vista de parámetros
La vista de parámetros le ofrece una visión de conjunto de todos los parámetros relevantes de
un objeto tecnológico. Proporciona una vista general de los ajustes de los parámetros, de
manera que usted puede modificarlos cómodamente en el modo offline y online.

①
②
③
④

672

Ficha "Vista de parámetros"
Barra de herramientas (Página 674)
Navegación (Página 675)
Tabla de parámetros (Página 675)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

Funcionalidad
Para analizar los parámetros de los objetos tecnológicos, y para poderlos observar y forzar de
manera selectiva, hay disponibles las siguientes funciones.
Funciones de indicación:
● Indicación de los valores de parámetros en modo offline y online
● Indicación de la información de estado de los parámetros
● Indicación de desviaciones de los valores y posibilidad de corregirlas directamente
● Indicación de errores de configuración
● Indicación de variaciones de valores como consecuencia de dependencias de parámetros
● Indicación de todos los valores almacenados de un parámetro: valor de arranque en la
CPU, valor de arranque en el proyecto, valor de observación
● Indicación de la comparación de parámetros de los valores almacenados de un parámetro
Funciones de manejo:
● Navegación, para cambiar rápidamente entre los parámetros y las estructuras de
parámetros.
● Filtro de texto, para encontrar más rápidamente determinados parámetros.
● Función de ordenación, para adaptar el orden de parámetros y grupos de parámetros en
función de las necesidades.
● Función de almacenamiento, para guardar ajustes estructurales de la vista de parámetros.
● Observar y forzar online valores de parámetro.
● Cambiar el formato de visualización del valor.
● Guardar instantánea de valores de parámetros de la CPU para reproducir situaciones
transitorias y reaccionar a ellas.
● Aplicar instantánea de valores de parámetros como valores de arranque.
● Cargar en la CPU valores de arranque modificados.
● Funciones de comparación, para comparar entre sí valores de parámetros.

Validez
La vista de parámetros aquí descrita está disponible para los siguientes objetos tecnológicos:
● PID_Compact
● PID_3Step
● PID_Temp
● CONT_C (solo S7-1500)
● CONT_S (solo S7-1500)
● TCONT_CP (solo S7-1500)
● TCONT_S (solo S7-1500)
● TO_Axis_PTO (S7-1200 Motion Control)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

673

Regulación PID
3.2 Configuración de un regulador por software
● TO_Positioning_Axis (S7-1200 Motion Control)
● TO_CommandTable_PTO (S7-1200 Motion Control)
● TO_CommandTable (S7-1200 Motion Control)

3.2.10.2

Estructura de la vista de parámetros

Barra de herramientas
En la barra de herramientas de la vista de parámetros pueden seleccionarse las siguientes
funciones:
Símbolo

Función

Explicación

Observar todos

Inicia la observación de los parámetros visibles en la vista de pará‐
metros activa (modo online).

Crear instantánea de los Aplica los valores de observación actuales a la columna "Instantánea"
valores de observación y actualiza los valores de arranque en el proyecto.
y aplicar valores de ajus‐ Solo en modo online con PID_Compact, PID_3Step y PID_Temp.
te de esa instantánea co‐
mo valores de arranque
Inicializar valores de
ajuste

Transfiere a la CPU los valores de arranque actualizados en el pro‐
yecto.
Solo en modo online con PID_Compact, PID_3Step y PID_Temp.

Crear instantánea de los
valores de observación

Aplica los valores de observación actuales a la columna "Instantánea".
Solo en modo online.

Forzar una vez e inme‐ Este comando se ejecuta una sola vez y lo antes posible, sin referen‐
diatamente todos los pa‐ cia a un punto determinado del programa de usuario.
rámetros seleccionados Solo en modo online.
Seleccionar la estructu‐
ra de navegación

Cambia entre la navegación orientada a funciones y la navegación
orientada a datos.

Filtro de texto...

Tras introducir una cadena de caracteres: indicación de todos los pa‐
rámetros que contienen la cadena de caracteres introducida en una de
las columnas visibles actualmente.

Seleccionar valores de
comparación

Selección de los valores de parámetros que deben compararse entre
sí en modo online (valor de arranque en el proyecto, valor de arranque
en la CPU, instantánea)
Solo en modo online.

Memorizar disposición

674

Guarda los ajustes de visualización de la vista de parámetros realiza‐
dos (p. ej., estructura de navegación seleccionada, columnas activa‐
das de la tabla, etc.).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

Navegación
Dentro de la ficha "Vista de parámetros" pueden seleccionarse como alternativa las siguientes
estructuras de navegación:
Navegación

Explicación

Navegación orien‐
tada a funciones

En la navegación orientada a funciones, la estructura de los pará‐
metros se basa en la estructura de los cuadros de diálogo de con‐
figuración (ficha "Vista de funciones"), puesta en marcha y diag‐
nóstico.
El último grupo "Otros parámetros" contiene los restantes paráme‐
tros del objeto tecnológico.
En la navegación orientada a datos, la estructura de los parámetros
se basa en la estructura del DB de instancia/DB tecnológico.

Navegación orien‐
tada a datos

El último grupo "Otros parámetros" contiene los parámetros que no
están incluidos en el DB de instancia/DB tecnológico.

Con la lista desplegable "Seleccionar la estructura de navegación" puede cambiar la estructura
de navegación.

Tabla de parámetros
La tabla siguiente muestra el significado de las distintas columnas de la tabla de parámetros.
Las columnas pueden mostrarse u ocultarse según convenga.
● Columna "Offline" = X: la columna es visible en modo offline.
● Columna "Online" = X: la columna es visible en modo online (conexión online con la CPU).
Columna

Explicación

Offline

Online

Nombre en la vista
de funciones

Nombre del parámetro en la vista de funciones.

X

X

Nombre completo en Ruta completa del parámetro en el DB de instancia/DB tecnológico.
DB
Este campo de visualización está vacío en el caso de parámetros que no están
incluidos en el DB de instancia/DB tecnológico.

X

X

Nombre en DB

X

X

Este campo de visualización está vacío en el caso de parámetros que no se
configuran por medio del objeto tecnológico.

Nombre del parámetro en el DB de instancia/DB tecnológico.
Si el parámetro es parte de una estructura o UDT, se añade el prefijo ". ./".
Este campo de visualización está vacío en el caso de parámetros que no están
incluidos en el DB de instancia/DB tecnológico.

Estado de la configu‐ Indicación de la integridad de la configuración mediante símbolos de estado
ración
ver Estado de la configuración (offline) (Página 683)
Resultado de la com‐ Resultado de la función "Comparar valores".
paración
Esta columna aparece si existe una conexión online y el botón
todos" está seleccionado.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

X
X

"Observar

675

Regulación PID
3.2 Configuración de un regulador por software
Columna

Offline

Online

Valor de arranque en Valor de arranque configurado en el proyecto.
el proyecto
Indicación de errores en caso de valores mal introducidos desde el punto de
vista sintáctico o tecnológico.

X

X

Valor predetermina‐
do

X

X

X

X

Instantánea

Explicación

Valor predeterminado del parámetro.
Este campo de visualización está vacío en el caso de parámetros que no están
incluidos en el DB de instancia/DB tecnológico.
Instantánea de los valores actuales en la CPU (valores de observación).
Indicación de errores en caso de valores incorrectos desde el punto de vista
tecnológico.

Valor de arranque en Valor de arranque en la CPU.
la CPU
Esta columna aparece si existe una conexión online y el botón
todos" está seleccionado.

X
"Observar

Indicación de errores en caso de valores incorrectos desde el punto de vista
tecnológico.
X

Valor de observación Valor actual en la CPU.
Esta columna aparece si existe una conexión online y el botón
todos" está seleccionado.

"Observar

Indicación de errores en caso de valores incorrectos desde el punto de vista
tecnológico.
Valor de forzado

Valor con que debe modificarse el valor de observación.

X

Esta columna aparece si existe una conexión online y el botón
todos" está seleccionado.

"Observar

Indicación de errores en caso de valores mal introducidos desde el punto de
vista sintáctico o tecnológico.
Selección del valor
de forzado

Selección de los valores de forzado que deben transferirse por medio del botón
"Forzar una vez e inmediatamente todos los parámetros seleccionados".

X

Esta columna aparece junto con la columna "Valor de forzado".
X

X

X

X

Valor de ajuste

Identifica el parámetro como valor de ajuste. Estos parámetros pueden iniciali‐ X
zarse online.

X

Tipo de datos

Tipo de datos del parámetro.

X

X

X

X

Accesible desde HMI Indica si HMI puede acceder a este parámetro durante el tiempo de ejecución. X

X

Valor mínimo

Valor tecnológico más bajo del parámetro.
Si el valor mínimo depende de otros parámetros, entonces viene determinado:
● Offline: por los valores de arranque en el proyecto.
● Online: por los valores de observación.

Valor máximo

Valor tecnológico más alto del parámetro.
Si el valor máximo depende de otros parámetros, entonces viene determinado:
● Offline: por los valores de arranque en el proyecto.
● Online: por los valores de observación.

Este campo de visualización está vacío en el caso de parámetros que no están
incluidos en el DB de instancia/DB tecnológico.
Remanencia

Identifica el valor como remanente.
Los valores de los parámetros remanentes se conservan incluso después de
desconectar la tensión de alimentación.

Visible en HMI

Indica si el parámetro es visible por defecto en la lista de selección de HMI.

X

X

Comentario

Descripción abreviada del parámetro.

X

X

676

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

Consulte también
Comparar valores (Página 669)

3.2.10.3

Abrir la vista de parámetros

Requisitos
El objeto tecnológico se ha agregado al árbol de proyectos, lo que significa que se ha generado
el correspondiente DB de instancia/DB tecnológico de la instrucción.

Procedimiento
1. Abra la carpeta "Objetos tecnológicos" en el árbol del proyecto.
2. Abra el objeto tecnológico en el árbol del proyecto.
3. Haga doble clic en el objeto "Configuración".
4. Seleccione en la esquina superior derecha la ficha "Vista de parámetros".

Resultado
Se abre la vista de parámetros. En la tabla de parámetros cada parámetro mostrado viene está
representado por una fila de la tabla.
Las propiedades visualizables de los parámetros (columnas de la tabla) dependen de si la vista
de parámetros está en modo offline u online.
Además, es posible mostrar y ocultar las distintas columnas de la tabla de manera selectiva.

Consulte también
Ajuste predeterminado de la vista de parámetros (Página 677)

3.2.10.4

Ajuste predeterminado de la vista de parámetros

Ajustes predeterminados
Para trabajar de forma efectiva con la vista de parámetros, puede adaptar la representación de
los parámetros y guardar los ajustes realizados.
Pueden efectuarse y guardarse los siguientes ajustes:
● Mostrar y ocultar columnas
● Modificar el ancho de las columnas
● Modificar el orden de las columnas
● Cambiar la navegación

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

677

Regulación PID
3.2 Configuración de un regulador por software
● Seleccionar un grupo de parámetros en la navegación
● Seleccionar valores de comparación

Mostrar y ocultar columnas
Para mostrar y ocultar columnas en la tabla de parámetros, proceda del siguiente modo:
1. Sitúe el puntero del ratón en el encabezado de la tabla de parámetros.
2. En el menú contextual, seleccione el comando "Mostrar/ocultar".
Se muestra la selección de las columnas disponibles.
3. Para mostrar una columna, active la casilla de verificación de la columna.
4. Para ocultar una columna, desactive la casilla de verificación de la columna.
o bien
1. Sitúe el puntero del ratón en el encabezado de la tabla de parámetros.
2. En el menú contextual, seleccione el comando "Mostrar todas las columnas" si desea
mostrar todas las columnas del modo offline u online.
Algunas columnas solo pueden mostrarse en modo online: ver Tabla de parámetros
(Página 675).

Modificar el ancho de las columnas
Para adaptar el ancho de una columna al contenido de manera que pueda leerse todo el texto
de las filas, proceda del siguiente modo:
1. Sitúe el puntero del ratón en el encabezado de la tabla de parámetros, a la derecha junto
a la columna que se desea optimizar, hasta que el puntero del ratón adopte la forma de una
cruz.
2. Haga doble clic en este punto.
o bien
1. Abra el menú contextual del encabezado de la tabla de parámetros.
2. Haga clic en
– "Optimizar ancho de columna" o
– "Optimizar ancho de todas las columnas".
Situando brevemente el puntero del ratón sobre el campo en cuestión, aparece el contenido
completo de los distintos campos en las columnas de ancho insuficiente.

Modificar el orden de las columnas
Las columnas de la tabla de parámetros pueden situarse donde se desee.
Para modificar el orden de las columnas, proceda del siguiente modo:
1. Haga clic sobre el encabezado de la columna, arrástrelo y suéltelo en el lugar deseado.
Cuando suelte el botón del ratón, la columna se anclará en la nueva posición.

678

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

Cambiar la navegación
Para cambiar la estructura de visualización de los parámetros, proceda del siguiente modo:
1. Seleccione la navegación que desee en la lista desplegable "Seleccionar la estructura de
navegación":
– Navegación orientada a datos
– Navegación orientada a funciones
Ver también Navegación (Página 675).

Seleccionar un grupo de parámetros en la navegación
Dentro de la navegación elegida puede optar entre la visualización "Todos los parámetros" o
la visualización de un grupo de parámetros subordinado deseado.
1. Haga clic sobre el grupo de parámetros deseado en la navegación.
En la tabla de parámetros se muestran solo los parámetros del grupo de parámetros.

Seleccionar valores de comparación (online)
Para ajustar los valores de comparación para la función "Comparar valores", proceda del
siguiente modo:
1. Seleccione en la lista desplegable "Seleccionar valores de comparación" los valores de
comparación que desee:
– Valor de arranque en el proyecto / valor de arranque en la CPU
– Valor de arranque en el proyecto / instantánea
– Valor de arranque en la CPU / instantánea
Por defecto está ajustada la opción "Valor de arranque en el proyecto / Valor de arranque en
la CPU".

Guardar el ajuste predeterminado de la vista de parámetros
Para guardar las modificaciones anteriores de la vista de parámetros, proceda del siguiente
modo:
1. Adapte la vista de parámetros en función de sus necesidades.
2. Haga clic en el botón
vista de parámetros.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

"Memorizar disposición" situado en la parte superior derecha de la

679

Regulación PID
3.2 Configuración de un regulador por software

3.2.10.5

Trabajar con la vista de parámetros

Sinopsis
La siguiente tabla ofrece una vista general de las funciones de la vista de parámetros que se
describen a continuación en los modos online y offline.
● Columna "Offline" = X: esta función está disponible en modo offline.
● Columna "Online" = X: esta función está disponible en modo online.
Función/acción

Offline

Online

Filtrar la tabla de parámetros (Página 680)

X

X

Ordenar la tabla de parámetros (Página 681)

X

X

Aplicar datos de parámetros en otros editores (Página 681)

X

X

Mostrar errores (Página 682)

X

X

Editar valores de arranque en el proyecto (Página 682)

X

X

Estado de la configuración (offline) (Página 683)

X

Observar online los valores en la vista de parámetros (Página 684)

X

Crear instantánea de los valores de observación (Página 686)

X

Forzar valores (Página 687)

X

Comparar valores (Página 688)

X

Aplicar valores como valores de arranque desde el programa online (Pági‐
na 689)

X

Inicializar los valores de ajuste en el programa online (Página 690)

X

Filtrar la tabla de parámetros
Los parámetros de la tabla de parámetros pueden filtrarse de las siguientes maneras:
● Con el filtro de texto
● Con los subgrupos de la navegación
Los dos métodos de filtrado pueden utilizarse simultáneamente.

Con el filtro de texto
Puede filtrarse por los textos que son visibles en la tabla de parámetros. Esto significa que solo
se puede filtrar por los textos de las líneas de parámetros y columnas mostradas.
1. Introduzca en el campo de entrada "Filtro de texto..." la cadena de caracteres por la que
desee filtrar.
La tabla de parámetros solo muestra aquellos parámetros que contienen la cadena de
caracteres.
El filtro de texto se restablece:
● Seleccionando otro grupo de parámetros en la navegación.
● Cambiando entre la navegación orientada a datos y a funciones.

680

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

Con los subgrupos de la navegación
1. Haga clic sobre el grupo de parámetros deseado en la navegación, p. ej., "Static".
En la tabla de parámetros se muestran solo los parámetros "Static". En algunos grupos de
la navegación puede seleccionar otros subgrupos.
2. Haga clic sobre "Todos los parámetros" en la navegación si desea volver a mostrar todos
los parámetros.

Ordenar la tabla de parámetros
Los valores de los parámetros están dispuestos por filas. La tabla de parámetros puede
ordenarse según cualquiera de las columnas mostradas.
● En las columnas con valores numéricos se ordena según la altura del valor numérico.
● En las columnas con texto se ordena alfabéticamente.

Ordenar por columnas
1. Sitúe el puntero del ratón en el encabezado de la columna deseada.
El fondo de esta celda se marca en azul.
2. Haga clic sobre el encabezado de la columna.

Resultado
Toda la tabla de parámetros se ordena según la columna marcada. En el encabezado de la
columna aparece un triángulo con la punta hacia arriba.
Haciendo clic de nuevo sobre el encabezado de la columna, el orden cambia de la siguiente
manera:
● Símbolo "▲": la tabla de parámetros se ordena de manera ascendente.
● Símbolo "▼": la tabla de parámetros se ordena de manera descendente.
● Ningún símbolo: se anula la ordenación. La tabla de parámetros adopta la vista
predeterminada.
En la ordenación se ignora el prefijo "../" de la columna "Nombre en DB".

Aplicar datos de parámetros en otros editores
Una vez seleccionada toda una fila de parámetros de la tabla de parámetros, con
● arrastrar y soltar
● <Ctrl+C>/<Ctrl+V>
● copiar/pegar por medio del menú contextual
pueden aplicarse parámetros en los siguientes editores del TIA Portal:
● en el editor de programas;
● en la tabla de observación;
● en la tabla de señales para Trace.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

681

Regulación PID
3.2 Configuración de un regulador por software
El parámetro se añade con el nombre completo: ver indicación en la columna "Nombre
completo en DB".

Mostrar errores
Señalización de errores
Los errores de parametrización que conllevan errores de compilación (p. ej., rebase de límite),
se indican en la vista de parámetros.
Cada vez que se introduce un valor en la vista de parámetros, se comprueba y muestra de
inmediato la corrección tecnológica y sintáctica.
Los valores erróneos se indican con:
● Un símbolo de error rojo en las columnas "Estado de la configuración" (modo offline) o
"Resultado de la comparación" (modo online, en función del tipo de comparación elegido)
y/o
● El campo de la tabla con el fondo rojo
Al hacer clic sobre el campo erróneo, se muestra el mensaje de error desplegable que
indica el rango de valores admisible o la sintaxis requerida (formato)

Errores de compilación
Desde el mensaje de error del compilador puede abrirse directamente la vista de parámetros
(navegación orientada a funciones) con el parámetro causante del error para aquellos
parámetros que no se muestren en el cuadro de diálogo de configuración.

Editar valores de arranque en el proyecto
Con la vista de parámetros pueden editarse los valores de arranque en el proyecto en los
modos offline y online:
● Los valores se modifican en la columna "Valor de arranque en el proyecto" de la tabla de
parámetros.
● En la columna "Estado de la configuración" de la tabla de parámetros se muestra el
progreso de la configuración mediante los símbolos de estado conocidos del cuadro de
diálogo de configuración del objeto tecnológico.

Condiciones
● Si hay otros parámetros que dependen del parámetro cuyo valor de arranque se ha
modificado, el valor de arranque del parámetro dependiente se adapta igualmente.
● Si un parámetro de un objeto tecnológico no es editable, tampoco lo es en la vista de
parámetros. La posibilidad de edición de un parámetro puede depender también de los
valores de otros parámetros.

682

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

Definir nuevos valores de arranque
Para especificar valores de arranque para parámetros en la vista de parámetros, proceda del
siguiente modo:
1. Abra la vista de parámetros del objeto tecnológico.
2. Introduzca en la columna "Valor de arranque en el proyecto" los valores de arranque
deseados. El valor debe ser conforme al tipo de datos del parámetro y no debe rebasar el
rango de valores del parámetro.
En las columnas "Valor máximo" y "Valor mínimo" se muestran los valores límite del rango
de valores.
En la columna "Estado de la configuración" se muestra el "progreso" de la configuración
mediante símbolos de colores.
Ver también Estado de la configuración (offline) (Página 683)
Una vez adaptados los valores de arranque y cargado el objeto tecnológico en la CPU, los
parámetros adoptan durante el arranque el valor definido, siempre y cuando estos parámetros
estén declarados como remanentes (columna "Remanencia").

Señalización de errores
Cuando se introduce un valor de arranque, se comprueba y muestra de inmediato la corrección
tecnológica y sintáctica:
Los valores de arranque erróneos se indican con
● Un símbolo de error rojo en las columnas "Estado de la configuración" (modo offline) o
"Resultado de la comparación" (modo online, en función del tipo de comparación elegido)
y/o
● Un fondo rojo en el campo "Valor de arranque en el proyecto"
Al hacer clic sobre el campo erróneo, se muestra el mensaje de error desplegable que
indica el rango de valores admisible o la sintaxis requerida (formato)

Corregir valores de arranque erróneos
1. Corrija los valores de arranque erróneos con ayuda de la información del mensaje de error
desplegable.
El símbolo de error rojo, el fondo rojo del campo y el mensaje de error desplegable dejarán
de mostrarse.
El proyecto solo puede compilarse correctamente con valores de arranque correctos.

Estado de la configuración (offline)
El estado de la configuración se indica mediante símbolos:
● En la columna "Estado de la configuración" en la tabla de parámetros
● En la estructura de navegación de la navegación orientada a funciones o la navegación
orientada a datos

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

683

Regulación PID
3.2 Configuración de un regulador por software

Símbolo en la columna "Estado de la configuración"
Símbolo

Significado
El valor de arranque del parámetro coincide con el valor predeterminado y es válido. El
usuario todavía no ha definido ningún valor de arranque.
El valor de arranque del parámetro contiene un valor definido por el usuario o adaptado
automáticamente. El valor de arranque difiere del valor predeterminado. El valor de
arranque no contiene errores y es válido.
El valor de arranque del parámetro no es válido (error sintáctico o tecnológico).
El campo de entrada tiene fondo rojo. Al hacer clic, el roll out con el aviso de error indica
la causa del error.
Solo con S7-1200 Motion Control:
El valor de arranque del parámetro es válido, pero contiene advertencias.
El campo de entrada tiene fondo amarillo.
El parámetro no es relevante en la configuración actual.

Símbolo en la navegación
Los símbolos en la navegación muestran el "progreso" de la configuración de la misma manera
que en el cuadro de diálogo de configuración del objeto tecnológico.

Consulte también
Configurar objetos tecnológicos (Página 665)

Observar online los valores en la vista de parámetros
Es posible observar directamente en la vista de parámetros los valores que los parámetros del
objeto tecnológico van adoptando actualmente en la CPU (valores de observación).

Requisitos
● Existe una conexión online.
● El objeto tecnológico está cargado en la CPU.
● La ejecución del programa está activa (CPU en "RUN").
● La vista de parámetros del objeto tecnológico está abierta.

684

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

Procedimiento
1. Inicie la observación haciendo clic en el símbolo
.
En cuanto la vista de parámetros esté online, se mostrarán también las siguientes
columnas:
– Resultado de la comparación
– Valor de arranque en la CPU
– Valor de observación
– Valor de forzado
– Selección del valor de forzado
La columna "Valor de observación" muestra los valores actuales de los parámetros en la
CPU.
Significado de las demás columnas: ver Tabla de parámetros (Página 675)
2. La observación se finaliza haciendo clic de nuevo en el símbolo

.

Indicación
Todas las columnas disponibles únicamente online tienen fondo naranja:
● Los valores de las celdas naranja claro
● Los valores de las celdas con fondo naranja oscuro

se pueden modificar.
no admiten modificaciones.

Cambio del formato de visualización del valor
El formato de visualización del valor puede seleccionarse en el menú contextual de una fila en
la vista de parámetros del objeto tecnológico.
El formato de visualización de los siguientes valores puede cambiarse tanto en modo online
como offline:
● Valor de arranque en el proyecto
● Valor de arranque en la CPU
● Valor máximo
● Valor mínimo
● Instantánea
● Valor de observación
● Valor predeterminado
● Valor de forzado
El formato de visualización configurado se aplica a todos los valores de la fila.
Pueden modificarse los siguientes formatos de visualización del valor:
● Predeterminado
● Hex
● Octal

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

685

Regulación PID
3.2 Configuración de un regulador por software
● Bin
● Dec (+/-)
● DEC
Solo pueden elegirse los formatos de visualización soportados dependiendo del parámetro
seleccionado en la vista de parámetros.

Requisitos
● La vista de parámetros del objeto tecnológico está abierta.

Procedimiento
Para cambiar el formato de visualización del valor, haga lo siguiente:
1. Seleccione una o varias filas en las que desee cambiar el formato de visualización.
2. Seleccione el comando "Formato visualización" en el menú contextual.
3. Seleccione el formato de visualización deseado.
Nota
Para modificar el formato de visualización de un tipo de datos determinado en varias filas,
ordene la vista de parámetros por este tipo de datos. A continuación, seleccione la primera y
la última fila con este tipo de datos manteniendo pulsada la tecla <Mayús> y modifique el
formato de visualización de las filas seleccionadas.

Crear instantánea de los valores de observación
Es posible guardar los valores actuales del objeto tecnológico en la CPU (valores de
observación) y mostrarlos en la vista de parámetros.

Requisitos
● Existe una conexión online.
● El objeto tecnológico está cargado en la CPU.
● La ejecución del programa está activa (CPU en "RUN").
● La vista de parámetros del objeto tecnológico está abierta.
● El botón "Observar todos"

está activado.

Procedimiento
Para mostrar los valores actuales de los parámetros, proceda del siguiente modo:
1. Haga clic en la vista de parámetros sobre el símbolo
de observación".

686

"Crear instantánea de los valores

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software

Resultado
Los valores de observación actuales se aplican una vez en la columna "Instantánea" de la tabla
de parámetros.
Los valores "congelados" así pueden analizarse mientras que los valores de observación de
la columna "Valores de observación" se siguen actualizando.

Forzar valores
Con la vista de parámetros puede forzar los valores del objeto tecnológico en la CPU.
Puede asignar valores al parámetro (valor de forzado) una sola vez y forzarlos de inmediato.
Al ejecutar esta función la orden de forzado se lleva a cabo lo antes posible, sin referencia a
un punto determinado del programa de usuario.

PELIGRO
Peligro en el forzado:
Una modificación de los valores de los parámetros con la instalación en marcha puede causar
importantes daños materiales y personales en caso de fallos de funcionamiento o errores de
programa.
Asegúrese de que no puedan darse situaciones de peligro antes de ejecutar la función
"Forzar".

Requisitos
● Existe una conexión online.
● El objeto tecnológico está cargado en la CPU.
● La ejecución del programa está activa (CPU en "RUN").
● La vista de parámetros del objeto tecnológico está abierta.
● El botón "Observar todos"

está activado.

● El parámetro puede forzarse (el campo correspondiente en la columna "Valor de forzado"
tiene fondo naranja claro).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

687

Regulación PID
3.2 Configuración de un regulador por software

Procedimiento
Para forzar parámetros inmediatamente, proceda del siguiente modo:
1. Introduzca los valores de forzado deseados en la columna "Valores de forzado" de la tabla
de parámetros.
2. Compruebe si se ha activado la casilla de verificación para el forzado en la columna
"Selección del valor de forzado".
Los valores de forzado y las casillas de verificación correspondientes de los parámetros
dependientes se adaptan también automáticamente.
3. Haga clic en el símbolo
seleccionados".

"Forzar una vez e inmediatamente todos los parámetros

Los parámetros seleccionados se fuerzan una vez e inmediatamente con los valores
especificados y pueden observarse en la columna "Valores de observación". Las casillas de
verificación para el forzado en la columna "Selección del valor de forzado" se desactivan
automáticamente una vez ejecutada la orden de forzado.

Señalización de errores
Cuando se introduce un valor de forzado, se comprueba y muestra de inmediato la corrección
tecnológica y sintáctica:
Los valores de forzado erróneos se indican con
● Un fondo rojo en el campo "Valor de forzado"
y
● Al hacer clic sobre el campo erróneo, se muestra el mensaje de error desplegable que
indica el rango de valores admisible o la sintaxis requerida (formato)

Valores de forzado erróneos
● Los valores de forzado erróneos desde el punto de vista tecnológico pueden transferirse.
● Los valores de forzado erróneos desde el punto de vista sintáctico no pueden transferirse.

Comparar valores
Las funciones de comparación permiten comparar los siguientes valores almacenados de un
parámetro:
● Valor de arranque en el proyecto
● Valor de arranque en la CPU
● Instantánea

Requisitos
● Existe una conexión online.
● El objeto tecnológico está cargado en la CPU.
● La ejecución del programa está activa (CPU en "RUN").

688

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software
● La vista de parámetros del objeto tecnológico está abierta.
● El botón "Observar todos"

está activado.

Procedimiento
Para comparar los valores de arranque de los diversos sistemas de destino, proceda del
siguiente modo:
1. Haga clic en el símbolo
"Seleccionar valores de comparación".
Se abre una lista de selección con las opciones de comparación:
– Valor de arranque en el proyecto - valor de arranque en la CPU (ajuste predeterminado)
– Valor de arranque en el proyecto - instantánea
– Valor de arranque en la CPU - instantánea
2. Elija la opción de comparación que desee.
La opción de comparación seleccionada se ejecuta de la siguiente manera:
– En las celdas del encabezado de las dos columnas seleccionadas para la comparación
aparece un símbolo con una balanza.
– En la columna "Resultado de la comparación" se muestra mediante símbolos el
resultado de la comparación de las columnas seleccionadas.

Símbolo en la columna "Resultado de la comparación"
Símbolo

Significado
Los valores de comparación son iguales y no contienen errores.
Los valores de comparación son distintos y no contienen errores.
Por lo menos uno de los dos valores de comparación es incorrecto desde el punto de
vista tecnológico o sintáctico.
No se ha podido llevar a cabo la comparación. Por lo menos uno de los dos valores de
comparación no está disponible (p. ej., instantánea).
No tiene sentido comparar el valor, ya que no es relevante en una de las configuraciones.

Símbolo en la navegación
Los símbolos se muestran de la misma manera en la navegación cuando el resultado de la
comparación se cumple como mínimo para uno de los parámetros de debajo de la estructura
de navegación mostrada.

Aplicar valores como valores de arranque desde el programa online
Para aplicar al proyecto en un paso valores optimizados de la CPU como valores de arranque,
genere una instantánea de los valores de observación. A continuación, los valores de la
instantánea marcados como "Valor de ajuste" se aplicarán como valores de arranque en el
proyecto.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

689

Regulación PID
3.2 Configuración de un regulador por software

Requisitos
● El objeto tecnológico es de tipo "PID_Compact" o "PID_3Step".
● Existe una conexión online.
● El objeto tecnológico está cargado en la CPU.
● La ejecución del programa está activa (CPU en "RUN").
● La vista de parámetros del objeto tecnológico está abierta.
● El botón "Observar todos"

está activado.

Procedimiento
Para aplicar valores optimizados de la CPU, proceda del siguiente modo:
1. Haga clic en el símbolo
"Crear instantánea de los valores de observación y aplicar
valores de ajuste de esa instantánea como valores de arranque".

Resultado
Los valores de observación actuales se aplican a la columna "Instantánea" y sus valores de
ajuste se copian como valores de arranque nuevos en la columna "Valor de arranque en el
proyecto".

Nota
Aplicar valores de parámetros individuales
También es posible aplicar los valores de determinados parámetros que no estén marcados
como valor de ajuste de la columna "Instantánea" a la columna "Valores de arranque en el
proyecto". Para ello copie los valores con ayuda de los comandos "Copiar"·y "Pegar" del menú
contextual y péguelos en la columna "Valor de arranque en el proyecto".

Inicializar los valores de ajuste en el programa online
Todos los parámetros marcados en la vista de parámetros como "Valor de ajuste" se pueden
inicializar en la CPU con nuevos valores en un solo paso. Para ello se deben cargar los valores
de arranque del proyecto en la CPU. La CPU se mantiene en el estado operativo "RUN".

690

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.2 Configuración de un regulador por software
Para evitar una pérdida de datos en la CPU al arrancar en frío o al reiniciar (arranque en
caliente), es necesario cargar también el objeto tecnológico en la CPU.
PELIGRO
Peligro al modificar valores de parámetros
Una modificación de los valores de los parámetros con la instalación en marcha puede causar
importantes daños materiales y personales en caso de fallos de funcionamiento o errores de
programa.
Asegúrese de que no puedan darse situaciones de peligro antes de reinicializar los valores de
ajuste.

Requisitos
● El objeto tecnológico es de tipo "PID_Compact" o "PID_3Step".
● Existe una conexión online.
● El objeto tecnológico está cargado en la CPU.
● La ejecución del programa está activa (CPU en "RUN").
● La vista de parámetros del objeto tecnológico está abierta.
● El botón "Observar todos"

está activado.

● Los parámetros marcados como "Valor de ajuste" disponen de un "Valor de arranque en el
proyecto" sin errores tecnológicos o sintácticos.

Procedimiento
Para inicializar todos los valores de ajuste, proceda del siguiente modo:
1. Introduzca los valores deseados en la columna "Valor de arranque en el proyecto".
Compruebe que los valores de arranque no contengan errores tecnológicos o sintácticos.
2. Haga clic en el símbolo

"Inicializar valores de ajuste".

Resultado
Los valores de ajuste de la CPU se inicializan con los valores de arranque del proyecto.

3.2.11

Mostrar el DB de instancia de un objeto tecnológico
Para cada objeto tecnológico, se crea un DB de instancia, en el que están guardados los
parámetros y las variables estáticas.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

691

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Procedimiento
Para mostrar el DB de instancia de un objeto tecnológico, proceda del siguiente modo:
1. Abra la carpeta de la CPU en el árbol del proyecto.
2. Abra la carpeta "Objetos tecnológicos".
3. Marque un objeto tecnológico.
4. Seleccione la orden "Abrir en el editor DP" en el menú contextual.

3.3

Regulación PID (S7-1200, S7-1500)

3.3.1

Utilizar PID_Compact

3.3.1.1

Objeto tecnológico PID_Compact
El objeto tecnológico PID_Compact ofrece un regulador PID continuo con optimización
integrada. Asimismo, también es posible configurar un regulador de impulsos. Es posible elegir
entre el modo manual y el automático.
PID-Compact registra de forma continua el valor real medido dentro de un lazo de regulación
y lo compara con la consigna deseada. A partir del error de regulación resultante, la instrucción
PID_Compact calcula un valor de salida, con el que el valor real se iguala con la consigna con
la máxima rapidez y estabilidad. En los reguladores PID, el valor de salida se compone de tres
acciones:
● Acción P
La acción P del valor de salida aumenta proporcionalmente al error de regulación.
● Acción I
La acción I del valor de salida aumenta hasta que se compensa el error de regulación.
● Acción D
La acción D aumenta con una velocidad de variación creciente del error de regulación. El
valor real se iguala lo más rápidamente posible con la consigna. Si la velocidad de variación
del error de regulación vuelve a reducirse, también lo hace la acción D.
La instrucción PID_Compact calcula los parámetros P, I y D para su sistema regulado de forma
autónoma durante la optimización inicial. Los parámetros pueden optimizarse aún más a
través de una optimización fina. No es necesario determinar los parámetros manualmente.

Información adicional
● Vista general de los reguladores de software (Página 661)
● Agregar objetos tecnológicos (Página 664)
● Configurar objetos tecnológicos (Página 665)
● Configurar PID_Compact V2 (Página 693)
● Configurar PID_Compact V1 (Página 714)

692

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Preguntas frecuentes (FAQ)
Para más información al respecto, consulte la siguiente pregunta frecuente (FAQ) en el
Siemens Industry Online Support:
● ID de artículo 79047707 (https://support.industry.siemens.com/cs/ww/en/view/79047707)

3.3.1.2

PID_Compact V2

Configurar PID_Compact V2
Ajustes básicos V2
Introducción V2
Configure las propiedades siguientes del objeto tecnológico PID_Compact en el área de
ajustes básicos de la ventana de inspección o de configuración.
● Magnitud física
● Sentido de regulación
● Comportamiento en arranque después de un reset
● Consigna (sólo en la ventana de inspección)
● Valor real (sólo en la ventana de inspección)
● Valor de salida (sólo en la ventana de inspección)

Consigna, valor real y valor de salida
La consigna, el valor real y el valor de salida sólo pueden configurarse en la ventana de
inspección del editor de programación. Para cada salida digital elija la fuente:
● DB de instancia
Se utiliza el valor que se encuentra almacenado en el DB de instancia.
El valor debe actualizarse en el DB de instancia del programa de usuario.
En la instrucción no puede haber ningún valor.
Modificación posible desde HMI.
● Instrucción
Se utiliza el valor que se conecta con la instrucción.
Cada vez que se llama la instrucción, el valor se escribe en el DB de instancia.
No se puede modificar desde HMI.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

693

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Tipo de regulación V2
Magnitud física
En el grupo "Tipo de regulación", seleccione la magnitud física y la unidad para la consigna, el
valor real y la magnitud perturbadora. La consigna, el valor real y la magnitud perturbadora se
mostrarán en dicha unidad.

Sentido de regulación
Por lo general, un aumento del valor de salida debe lograr un aumento del valor real. En este
caso, se habla de un sentido de regulación normal.
PID_Compact no funciona con ganancia proporcional negativa. Para reducir el valor real con
un valor de salida más elevado, active la casilla de verificación "Inversión sentido de
regulación".
Ejemplos
● Al abrir una válvula de escape se reduce el nivel de llenado de un recipiente.
● Si se aumenta la potencia de refrigeración, disminuye la temperatura.

Comportamiento en arranque
1. Para cambiar inmediatamente al modo de operación "Inactivo" tras el rearranque de la
CPU, desactive la casilla de verificación "Activar Mode tras rearrancar la CPU".
Para cambiar inmediatamente, tras el rearranque de la CPU, al modo de operación
almacenado en Mode, active la casilla de verificación "Activar Mode tras rearrancar la
CPU".
2. En la lista desplegable "Poner Mode a", seleccione el modo de operación que debe
activarse tras una carga completa en el dispositivo.
Tras una carga completa en el dispositivo, PID_Compact arranca en el modo de operación
seleccionado. Con cada rearranque, PID_Compact arranca en el último modo de operación
almacenado en Mode.
Ejemplo
Se ha activado la casilla de verificación "Activar Mode tras rearrancar la CPU" y se ha
seleccionado la entrada "Optimización inicial" en la lista "Poner Mode a". Tras una carga
completa en el dispositivo, PID_Compact arranca en el modo de operación "Optimización
inicial". Si la optimización inicial aún está activa y se rearranca la CPU, PID_Compact arranca
de nuevo en el modo de operación "Optimización inicial". Si la optimización inicial ha finalizado
correctamente, el modo automático aún está activo y se rearranca la CPU, PID_Compact
arranca en "Modo automático".

694

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Consigna V2
Procedimiento
Para especificar una consigna fija, proceda del siguiente modo:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 °C.
3. En caso necesario, elimine una entrada de la instrucción.
Para especificar una consigna variable, proceda del siguiente modo:
1. Seleccione "Instrucción".
2. Indique el nombre de la variable REAL en la que está almacenada la consigna.
Es posible asignar varios valores controlados por programa a la variable REAL para, por
ejemplo, modificar la consigna de tiempo de forma controlada.

Valor real V2
Si utiliza directamente el valor de la entrada analógica, PID_Compact escala el valor de la
entrada analógica al tamaño físico.
Si se desea acondicionar el valor de la entrada analógica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada analógica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada analógica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucción" como fuente.
3. Introduzca la dirección de la entrada analógica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucción" como fuente.
3. Indique el nombre de la variable en la que está almacenado el valor real acondicionado.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

695

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Valor de salida V2
PID_Compact ofrece tres valores de salida. El valor de salida que se utilice dependerá del
actuador.
● Output_PER
El actuador se activa a través de una salida analógica y se controla con una señal continua,
como puede ser 0 a 10 V, 4 a 20 mA.
● Output
El valor de salida debe acondicionarse mediante el programa de usuario, por ejemplo,
porque el actuador muestra un comportamiento no lineal.
● Output_PWM
El actuador se controla a través de una salida digital. Una modulación de ancho de impulsos
permite formar tiempos de conexión y desconexión variables.

Procedimiento
Para utilizar el valor de salida analógico, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output_PER" (analógica).
2. Seleccione "Instrucción".
3. Introduzca la dirección de la salida analógica.
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "Output", seleccione la entrada "Output".
2. Seleccione "DB de instancia".
El valor de salida calculado se guarda en DB de instancia.
3. Para acondicionar el valor de salida utilice el parámetro de salida Output.
4. Transfiera el valor de salida acondicionado hasta el actuador a través de una salida digital
o analógica de la CPU.
Para utilizar el valor de salida digital, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output_PWM".
2. Seleccione "Instrucción".
3. Introduzca la dirección de la salida digital.

Ajustes de valor real V2
Escalar valor real V2
Si en los ajustes básicos ha configurado el uso de Input_PER, deberá convertir el valor de la
entrada analógica a la magnitud física del valor real. En el cuadro de visualización Input_PER
se muestra la configuración actual.
Si el valor real es directamente proporcional al valor de la entrada analógica, Input_PER se
escalará a partir de un par de valores inferior y superior.

696

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Procedimiento
Para escalar el valor real, haga lo siguiente:
1. En los campos de entrada "Valor real inferior escalado" y "abajo", introduzca el par de
valores inferior.
2. En los campos de entrada "Valor real superior escalado" y "arriba", introduzca el par de
valores superior.
La configuración hardware contiene pares de valores predeterminados. Para utilizar los pares
de valores contenidos en la configuración hardware, haga lo siguiente:
1. Seleccione en el editor de programación la instrucción PID_Compact.
2. En los ajustes básicos, interconecte Input_PER con una entrada analógica.
3. En los ajustes del valor real, haga clic en el botón "Ajuste automático".
Los valores existentes se sobrescribirán con los valores de la configuración hardware.

Límites de valor real V2
Como valores límite para el sistema regulado defina los límites superior e inferior absolutos del
valor real de modo que sean razonables. Tan pronto como dichos valores se rebasen por
exceso o defecto, se producirá un error (ErrorBits = 0001h). La optimización se cancela cuando
se rebasan los valores reales. Configure en los ajustes de los valores de salida cómo debe
reaccionar PID_Compact en caso de error en el modo automático.

Ajustes avanzados V2
Vigilancia de valor real V2
Configure un límite de advertencia inferior y uno superior para el valor real en la ventana de
configuración "Monitorización del valor real". Si durante el funcionamiento se rebasa uno de los
límites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucción
"PID_Compact".
● En el parámetro de salida "InputWarning_H", si se ha rebasado por exceso el límite superior
de advertencia
● En el parámetro de salida "InputWarning_L", si se ha rebasado por defecto el límite inferior
de advertencia
Los límites de advertencia deben encontrarse dentro de los límites superior e inferior del valor
real.
Si no introduce ningún valor, se utilizan los límites superior e inferior del valor real.

Ejemplo
Límite superior del valor real = 98 °C; límite superior de advertencia = 90 °C
Límite inferior de advertencia = 10 ℃; límite inferior del valor real = 0 ℃

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

697

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
PID_Compact se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

ErrorBits

Modo de opera‐
ción

> 98 °C

TRUE

FALSE

0001h

Inactivo o
valor de salida sus‐
titutivo con monito‐
rización de errores

≤ 98 °C y > 90 °C

TRUE

FALSE

0000h

Modo automático

≤ 90 °C y ≥ 10 °C

FALSE

FALSE

0000h

Modo automático

< 10°C y ≥ 0 °C

FALSE

TRUE

0000h

Modo automático

< 0 °C

FALSE

TRUE

0001h

Inactivo o
valor de salida sus‐
titutivo con monito‐
rización de errores

Configure en los ajustes de los valores de salida cómo debe reaccionar PID_Compact si se
rebasa el límite superior o inferior del valor real.

Limitaciones de PWM V2
Una modulación de ancho de impulsos transforma el valor del parámetro de salida Output en
un tren de impulsos que se emite por el parámetro de salida Output_PWM.
Output se calcula en el tiempo de muestreo Algoritmo PID. El tiempo de muestreo se utiliza
como duración del período de la modulación por ancho de impulso.
El tiempo de muestreo Algoritmo PID se determina durante la optimización inicial o la
optimización fina. Al ajustar los parámetros PID manualmente, debe configurarse también ahí
el tiempo de muestreo Algoritmo PID.
Output_PWM se emite en el tiempo de muestreo PID_Compact. El tiempo de muestreo
PID_Compact equivale al tiempo de ciclo del OB invocante.
La duración del impulso es proporcional al valor de Output y es siempre un múltiplo entero del
tiempo de muestreo PID_Compact.

698

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
2XWSXW





W PV

2XWSXWB3:0
758(
)$/6(

W PV





①
②
③
④



Tiempo de muestreo PID_Compact
Tiempo de muestreo Algoritmo PID
Duración del impulso
Duración de la pausa

"Tiempo conexión mín." y "Tiempo de desconex. mín." se redondean a un múltiplo entero del
tiempo de muestreo PID_Compact.
Un impulso o una pausa nunca son más cortas que los tiempos de conexión o desconexión
mínimos. Las imprecisiones que se producen se suman y se compensan en el siguiente ciclo.
Ejemplo
Tiempo de muestreo PID_Compact (equivale al tiempo de ciclo del OB que efectúa la llamada)
= 100 ms
Tiempo de muestreo Algoritmo PID (equivale a la duración del periodo)= 1000 ms
Tiempo conexión mín. = 200 ms
Output es constante del 15%. El mínimo impulso que PID_Compact puede emitir es del 20 %
En el primer ciclo no se emite ningún impulso. En el segundo ciclo, el impulso no emitido del
primer ciclo se agrega al impulso del segundo ciclo.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

699

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
2XWSXW





2XWSXWB3:0

W PV

758(
)$/6(

W PV





①
②
⑤

Tiempo de muestreo PID_Compact
Tiempo de muestreo Algoritmo PID
Tiempo conexión mín.

Para reducir la frecuencia de conmutación y proteger el actuador, prolongue los tiempos de
conexión y desconexión mínimos.
Si se utiliza "Output" o "Output_PER", los tiempos mínimos de conexión y desconexión deben
configurarse con el valor 0.0.
Nota
Los tiempos mínimos de conexión y desconexión actúan solo en el parámetro de salida
Output_PWM y no se utilizan para posibles generadores de impulsos integrados en la CPU.

Valor de salida V2
Límites del valor de salida
Configure en tantos por ciento los límites absolutos del valor de salida en la ventana de
configuración "Límites del valor de salida". Los límites del valor de salida absolutos no se
rebasan ni por exceso ni por defecto ni en el modo manual ni en el automático. Si en el modo
manual se especifica un valor de salida fuera de los límites, el valor efectivo se limitará en la
CPU a los límites configurados.
Los límites del valor de salida deben ser compatibles con el sentido de regulación.

700

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Los valores válidos para los límites del valor de salida dependen del Output utilizado.
Output

de -100.0 a 100.0%

Output_PER

de -100.0 a 100.0%

Output_PWM

de -0.0 a 100.0%

Comportamiento en caso de error
ATENCIÓN
Su instalación puede sufrir daños.
Si en caso de fallo se emite "Valor actual para la duración del error" o "Valor de salida
sustitutivo mientras dure el error", PID_Compact se mantiene en modo automático. De este
modo, los límites del valor real pueden rebasarse y su instalación puede sufrir daños.
Configure un comportamiento en caso de error para su sistema regulado que proteja su
instalación de daños.
PID_Compact está preajustado de manera que, en caso de error, la regulación permanece
activa en la mayoría de los casos. Si en el modo de regulación se producen errores con
frecuencia, este ajuste empeorará el comportamiento de regulación. Compruebe en tal caso el
parámetro Errorbits y elimine la causa de error.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

701

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
En caso de error, PID_Compact emite un valor de salida configurable:
● Cero (inactivo)
PID_Compact emite 0.0 como valor de salida para todos los errores y conmuta al modo de
operación "Inactivo". El regulador no se reactiva hasta que no se detecta un flanco
descendente en Reset o un flanco ascendente en ModeActivate.
● Valor actual mientras dure el error
Si se producen los siguientes errores en el modo automático, PID_Compact regresa a dicho
modo en cuanto los errores en cuestión dejan de existir.
Si se producen uno o varios de los errores siguientes, PID_Compact permanece en
modo automático:
– 0001h: El parámetro "Input" se encuentra fuera de los límites del valor real.
– 0800h: Error en tiempo de muestreo
– 40000h: Valor no válido en el parámetro Disturbance.
Si en el modo automático se producen uno o varios de los errores siguientes, PID_Compact
pasa al modo "Valor de salida sustitutivo con monitorización de errores" y emite el último
valor de salida válido:
– 0002h: Valor no válido en el parámetro Input_PER.
– 0200h: Valor no válido en el parámetro Input.
– 0400h: Error al calcular el valor de salida.
– 1000h: Valor no válido en el parámetro Setpoint.
Si se produce un error en modo manual, PID_Compact sigue utilizando como valor de
salida el valor manual. Si el valor manual no es válido, se utiliza el valor de salida sustitutivo.
Si el valor manual y el valor de salida sustitutivo no son válidos, se utiliza el límite inferior del
valor de salida.
Si durante una optimización inicial u optimización fina aparece el siguiente error,
PID_Compact se mantiene en el modo de operación activo:
– 0020h: La optimización inicial no está permitida durante la optimización fina.
Con todos los demás errores, PID_Compact interrumpe la optimización y cambia al modo
desde el que se inició la optimización.
En cuanto no aparezcan errores, PID_Compact pasa de nuevo al modo automático.
● Valor de salida sustitutivo mientras dure el error
PID_Compact emite el valor de salida sustitutivo.
Si se produce el siguiente error, PID_Compact se mantiene en el modo "Valor de salida
sustitutivo con monitorización de errores" y emite el límite inferior del valor de salida:
– 20000h: Valor no válido en la variable SubstituteOutput.
Con el resto de los errores, PID_Compact se comporta del modo descrito en "Valor actual
mientras dure el error".

702

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Parámetros PID V2
En la ventana de configuración "Parámetros PID" se visualizan los parámetros PID. Durante la
optimización los parámetros PID se adaptan al sistema regulado. No es necesario introducir
los parámetros PID de forma manual.
Nota
Los parámetros PID efectivos actualmente están en la estructura sRet con PID_Compact V1
y en la estructura Retain.CtrlParams con PID_Compact V2.
Para prevenir un comportamiento erróneo del regulador PID, los parámetros PID efectivos
actualmente solo deben modificarse online en el modo de operación "Inactivo".
Si desea modificar online los parámetros PID en los modos de operación "Automático" o
"Manual", debe hacerlo del siguiente modo:
● PID_Compact V1: Modifique los parámetros PID en la estructura sBackUp y aplique los
cambios poniendo sPid_Cmpt.b_LoadBackUp = TRUE en la estructura sRet.
● PID_Compact V2: Modifique los parámetros PID en la estructura CtrlParamsBackUp y
aplique los cambios poniendo LoadBackUp = TRUE en la estructura Retain.CtrlParams.
Los cambios online en los parámetros PID realizados en el modo de operación "Automático"
pueden provocar saltos en el valor de salida.
El algoritmo PID funciona de acuerdo con la siguiente fórmula:

1

y = Kp

[ (b · w - x) + T · s

(w - x) +

I

y

Valor de salida del algoritmo PID

Kp

Ganancia proporcional

s

Operador laplaciano

b

Ponderación de la acción P

w

Consigna

x

Valor real

TI

Tiempo de integración

TD · s
a · TD · s + 1

(c · w - x)

]

a

Coeficiente para el retardo de la acción derivada (retardo de la acción derivada T1 = a ×TD)

TD

Tiempo derivativo

c

Ponderación de la acción D

El gráfico siguiente muestra cómo entran los parámetros en el algoritmo PID.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

703

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
6HWSRLQW Z

E



$QWL:LQGXS
/,0,7

.3

,

\


F

6FDOHG,QSXW [



'7

Todos los parámetros PID son remanentes. Si introduce manualmente los parámetros PID,
debe cargar PID_Compact por completo.
Cargar objetos tecnológicos en el dispositivo (Página 667)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_Compact no funciona con una
ganancia proporcional negativa. El sentido de regulación se invierte en Ajustes básicos > Tipo
de regulación.

Tiempo de integración
El tiempo de integración determina el comportamiento temporal de la acción I. La desconexión
de la acción I se realiza con el tiempo de integración = 0,0. Si el tiempo de integración se
modifica online en el modo de operación "Automático" de un valor cualquiera a 0.0, la acción
I actual se borra y se produce un salto del valor de salida.

Tiempo derivativo
El tiempo de la acción derivada determina el comportamiento temporal de la acción D. La
desconexión de la acción D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acción derivada
El efecto de la acción D se retrasa mediante el coeficiente de retardo de la acción derivada.

704

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Retardo de la acción derivada = Tiempo derivativo x coeficiente de retardo de la acción
derivada
● 0.0: la acción D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
● 0.5: Este valor se ha acreditado en la práctica para sistemas regulados con una constante
de tiempo dominante.
● > 1.0: Cuanto mayor sea el coeficiente, más se retrasará el efecto de la acción D.

Ponderación de la acción P
En el caso de que se produzcan cambios en la consigna, es posible atenuar la acción P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción P es totalmente efectiva cuando se cambia la consigna
● 0.0: La acción P no actúa al cambiar la consigna
Si se produce una modificación del valor real, la acción P es totalmente efectiva.

Ponderación de la acción D
En el caso de que se produzcan cambios en la consigna, es posible atenuar la acción D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción D es totalmente efectiva cuando se cambia la consigna.
● 0.0: La acción D no actúa al cambiar la consigna
Si se produce una modificación del valor real, la acción D es totalmente efectiva.

Tiempo de muestreo Algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo del algoritmo
PID es el tiempo entre dos cálculos del valor de salida. Este se determina durante la
optimización y se redondea a un múltiplo del tiempo de ciclo. Todas las demás funciones de
PID_Compact se ejecutan con cada llamada.
Si se utiliza Output_PWM, el tiempo de muestreo del algoritmo PID se utiliza como duración del
periodo de la modulación por ancho de impulsos. La precisión de la señal de salida está
determinada por la relación entre el tiempo de muestreo del algoritmo PID y el tiempo de ciclo
del OB. Por eso se recomienda que el tiempo de ciclo sea como máximo una décima parte del
tiempo de muestreo del algoritmo PID.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

705

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Regla para la optimización
En la lista desplegable "Estructura del regulador" seleccione si van a calcular los parámetros
PI o PID.
● PID
Se calcula durante la optimización inicial y la optimización fina del parámetro PID.
● PI
Se calcula durante la optimización inicial y la optimización fina del parámetro PI.
● Definido por el usuario
Si se han ajustado diferentes estructuras del regulador para la optimización inicial y la
optimización fina en un programa de usuario, en la lista desplegable aparece "Definido por
el usuario".

Consulte también
Elección de la estructura del regulador con un sistema regulado definido (Página 660)

Poner en servicio PID_Compact V2
Optimización inicial V2
La optimización inicial determina el comportamiento del proceso a un escalón del valor de
salida y busca el punto de inflexión. Los parámetros PID óptimos se calculan a partir de la
pendiente máxima y el tiempo muerto del sistema regulado. Para obtener los mejores
parámetros PID, debe efectuarse una optimización inicial y una optimización fina.
Cuanto más estable es el valor real, con mayor facilidad y precisión se pueden calcular los
parámetros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea
considerablemente mayor que el ruido. Esto tiene más probabilidades de suceder en los
modos "Inactivo" o "Manual". Es preciso realizar una copia de seguridad de los parámetros PID
antes de volver a calcularlos.

Requisitos
● La instrucción "PID_Compact" se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● Reset = FALSE
● PID_Compact se encuentra en el modo de operación "Modo manual", "Inactivo" o "Modo
automático".
● La consigna y el real se encuentran dentro de los límites configurados (véase la
configuración "Monitorización del valor real").
● La diferencia entre la consigna y el valor real es mayor del 30% de la diferencia entre el
límite superior e inferior del valor real.
● La diferencia entre la consigna y el valor real es superior al 50% de la consigna.

706

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimización inicial, proceda del siguiente modo:
1. Haga doble clic en la navegación del proyecto en la entrada "PID_Compact" > Puesta en
servicio".
2. En la lista desplegable "Modo de optimización" seleccione la entrada "Optimización inicial".
3. Haga clic en el símbolo "Start".
– Se establece una conexión online.
– Se inicia el registro de los valores.
– Se inicia la optimización inicial.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Haga clic en el símbolo "Stop" cuando la barra de progreso haya alcanzado el 100% y
se deba presuponer un bloqueo de la optimización. Compruebe la configuración del
objeto tecnológico y, si procede, vuelva a iniciar la optimización.

Resultado
Si la optimización inicial ha finalizado sin ningún mensaje de error, significa que los parámetros
PID se han optimizado. PID_Compact cambia al modo automático y utiliza los parámetros
optimizados. Los parámetros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es posible realizar la optimización inicial, PID_Compact se comporta del modo
configurado en Comportamiento en caso de error.

Optimización fina V2
La optimización fina genera una oscilación constante y limitada del valor real. Los parámetros
PID se optimizan para el punto de operación a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular todos los parámetros PID. Los parámetros PID existentes
después de la optimización fina muestran en su mayoría un comportamiento de guía y ante
fallos mucho mejor que los parámetros PID de la optimización inicial. Para obtener los mejores
parámetros PID, debe efectuarse una optimización inicial y una optimización fina.
PID_Compact intenta generar automáticamente una oscilación que es mayor que el ruido del
valor real. La estabilidad del valor real ejerce tan solo una mínima influencia sobre la
optimización fina. Es preciso realizar una copia de seguridad de los parámetros PID antes de
volver a calcularlos.

Requisitos
● La instrucción "PID_Compact" se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● Reset = FALSE

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

707

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
● La consigna y el valor real se encuentran dentro de los límites configurados.
● El lazo de regulación es estacionario en el punto de operación. El punto de operación se ha
alcanzado cuando el valor real coincide con la consigna.
● No se esperan perturbaciones.
● PID_Compact se encuentra en el modo de operación inactivo, automático o manual.

El proceso depende de la situación de inicio
La optimización fina puede iniciarse desde los modos de operación "Inactivo", "Automático" o
"Manual". Al inicio, la optimización fina se desarrolla del modo siguiente:
● Modo automático
Si desea mejorar los parámetros PID existentes mediante optimización, inicie la
optimización fina desde el modo automático.
PID_Compact regula con los parámetros PID existentes hasta que el lazo de regulación es
estacionario y se cumplen las condiciones para la optimización fina. Sólo entonces
comienza la optimización fina.
● Inactivo o manual
Si se cumplen las condiciones para optimización inicial, ésta se inicia. Con los parámetros
PID calculados, la regulación se realiza hasta que el lazo de regulación es estacionario y se
han cumplido las condiciones para una optimización fina. Sólo entonces comienza la
optimización fina. Si no es posible realizar la optimización inicial, PID_Compact se
comporta del modo configurado en Comportamiento en caso de error.
Si el valor real para una optimización inicial se encuentra ya muy cerca de la consigna, se
intenta alcanzar la consigna con el valor de salida máximo o mínimo, lo que puede
ocasionar una sobreoscilación muy alta.

Procedimiento
Para poder realizar una optimización fina, proceda del siguiente modo:
1. En la lista desplegable "Modo de optimización" seleccione la entrada "Optimización fina".
2. Haga clic en el símbolo "Start".
– Se establece una conexión online.
– Se inicia el registro de los valores.
– Se inicia el proceso de optimización fina.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de optimización" haga clic en el símbolo "Stop" cuando la barra de
progreso haya alcanzado el 100% y se deba presuponer un bloqueo de la optimización.
Compruebe la configuración del objeto tecnológico y, si procede, vuelva a iniciar la
optimización.

708

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Resultado
Si durante la optimización fina no se producen errores, significa que los parámetros PID se han
optimizado. PID_Compact cambia al modo automático y utiliza los parámetros optimizados.
Los parámetros PID optimizados se conservan al desconectar (Power OFF) y al rearrancar por
completo la CPU.
Si se han producido errores durante la "optimización fina", PID_Compact se comporta del
modo configurado en Comportamiento en caso de error.

Modo de operación "Modo manual" V2
A continuación se describe cómo utilizar el modo de operación "Modo manual" en la ventana
de puesta en servicio del objeto tecnológico "PID_Compact". El modo manual es posible
aunque haya un error pendiente.

Requisitos
● La instrucción "PID_Compact" se llama en un OB de alarma cíclica.
● Hay establecida una conexión online con la CPU y ésta se encuentra en el estado operativo
"RUN".

Procedimiento
Utilice "Modo manual" en la ventana de puesta en servicio si desea probar el sistema regulado
especificando un valor manual. Para especificar un valor manual, proceda del siguiente modo:
1. Haga clic en el símbolo "Start".
2. Active la casilla de verificación "Modo manual" en el área "Estado online del regulador".
PID_Compact funciona en modo manual. El último valor de salida actual permanece activo.
3. Introduzca el valor manual en la unidad % en el campo "Output".
4. Haga clic en el símbolo

.

Resultado
El valor manual se escribe en la CPU y es efectivo de forma inmediata.
Desactive la casilla de verificación "Modo manual" si desea que el regulador PID vuelva a
especificar el valor de salida. El cambio al modo automático se efectúa sin discontinuidad.

Regulación de transición con PID_Compact V2
Regulación de transición
En caso de regulación de transición, dos o más reguladores comparten un actuador común. En
cada instante, solo un regulador tiene acceso al actuador y actúa sobre el proceso.
Una lógica decide qué regulador obtiene acceso al actuador. A menudo, esta decisión se toma
en función de una comparación de los valores de salida de todos los reguladores, p. ej., el

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

709

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
regulador con el mayor valor de salida obtiene acceso al actuador en caso de selección del
máximo.
La selección en función del valor de salida hace necesario que todos los reguladores funcionen
en el modo automático. Los reguladores que no tengan efecto sobre el actuador se corrigen.
Esto es necesario para evitar los efectos de Windup y sus repercusiones negativas sobre el
comportamiento de regulación y la conmutación entre los reguladores.
A partir de la versión 2.3, PID_Compact soporta regulaciones de transición, pues el regulador
ofrece un procedimiento simplificado para corregir el regulador no activo:
● Mediante las variables OverwriteInitialOutputValue y PIDCtrl.PIDInit es posible preasignar
la acción I del regulador en el modo automático como si el algoritmo PID hubiera calculado
Output = OverwriteInititalOutputValue para el valor de salida en el último ciclo.
● Para ello, OverwriteInitialOutputValue se interconecta con el valor de salida del regulador
que tenga acceso en este momento al actuador.
● Ajustando el bit PIDCtrl.PIDInit se lanza la preasignación de la acción I, así como el reinicio
del ciclo del regulador y el período de PWM.
● El subsiguiente cálculo del valor de salida en el ciclo actual se realiza basándose en la
acción I preasignada (e igualada para todos los reguladores), así como en la acción P e I
del actual error de regulación.
● La acción D no está activa durante la llamada con PIDCtrl.PIDInit = TRUE y, por tanto, no
contribuye al valor de salida.
Este procedimiento garantiza que el cálculo del valor de salida actual y, con ello, la decisión
sobre qué regulador tiene acceso al actuador solo tengan lugar considerando el estado actual
del proceso y los parámetros PI. Así se evitan los efectos de Windup en los reguladores no
activos y, con ello, las decisiones erróneas de la lógica de conmutación.

Requisitos
● PIDCtrl.PIDInit solo es efectivo si la acción I está activada (variable Retain.CtrlParams.Ti >
0.0).
● Debe asignar PIDCtrl.PIDInit y OverwriteInitialOutputValue usted mismo en su programa
de usuario (ver ejemplo más abajo). PID_Compact no realiza ningún cambio automático en
estas variables.
● PIDCtrl.PIDInit solo es efectivo si PID_Compact se encuentra en el modo automático
(parámetro State = 3).
● Si es posible, seleccione el tiempo de muestreo del algoritmo PID (variable
Retain.CtrlParams.Cycle) de forma que sea idéntico para todos los reguladores y llame
todos los reguladores en el mismo OB de alarma cíclica. De esta forma se asegurará de que
la conmutación no suceda dentro de un ciclo de regulador o de un período de PWM.

710

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Nota
Adaptación continua de los límites de los valores de salida
En lugar de la corrección activa de reguladores sin acceso al actuador aquí descrita, en otros
sistemas de regulador se realiza alternativamente una adaptación continua de los límites de
los valores de salida.
Esto no es posible con PID_Compact, pues no se soporta el cambio de los límites de los
valores de salida en el modo automático.

Ejemplo: regulación de un gasoducto
PID_Compact se utiliza para regular un gasoducto
El objetivo principal es regular el caudal Input1. Para ello se utiliza el regulador
PID_Compact_1. Además, con el regulador de limitación PID_Compact_2 debe mantenerse la
presión Input2 (medida en el sentido de flujo antes de la válvula) por debajo de un límite
superior.
El caudal y la presión se modifican a través de una única electroválvula. El valor de salida del
regulador se corresponde con la apertura de la válvula: si aumenta el valor de salida, la válvula
se abre. Con ello aumenta el caudal (sentido normal de regulación) mientras cae la presión
(sentido inverso de regulación).

Input1

PID_Compact_1

>
Input2

PID_Compact_2

La válvula se acciona mediante el valor de salida de PID_Compact en el formato de periferia
(parámetro Output_PER), escribiendo la variable de programa ActuatorInput.
La preasignación de la consigna para el caudal se realiza en el parámetro
PID_Compact_1.Setpoint.
El límite superior de presión se preasigna como consigna en el parámetro
PID_Compact_2.Setpoint.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

711

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Input1

PID_Compact_1
Input

Output_PER

Setpoint

Output

1

ActuatorInput

0

PIDCtrl.PIDInit
OverwriteInitial
OutputValue

>

PID_Compact_2
Input

Output_PER

Setpoint

Output

1

0

PIDCtrl.PIDInit
OverwriteInitial
OutputValue

Input2

Ambos reguladores disponen únicamente de una válvula como actuador común. La lógica que
decide qué regulador obtiene acceso al actuador se implementa aquí a través de una selección
de máximo del valor de salida (en formato Real, parámetro Output). Puesto que el valor de
salida corresponde a la apertura de la válvula, el regulador obtiene el control que requiere la
mayor apertura de la válvula.
Nota
Activación de la inversión del sentido de regulación
Puesto que para el regulador de presión PID_Compact_2 debe alcanzarse una reducción del
valor real (presión) al aumentar el valor de salida (apertura de la válvula), debe activarse la
inversión del sentido de regulación: PID_Compact_2.Config.InvertControl = TRUE.
En el funcionamiento normal de la instalación, el valor real del caudal corresponde a la
consigna. El regulador de caudal PID_Compact_1 se ha estabilizado en un valor de salida
estacionario PID_Compact_1.Output. En el modo normal, el valor real de la presión está
claramente por debajo del límite superior que se ha preasignado como consigna para
PID_Compact_2. Por tanto, el regulador de presión debe seguir cerrando la válvula para
aumentar la presión, es decir, calculará un valor de salida PID_Compact_2.Output que será
inferior al del regulador de caudal PID_Compact_1.Output. Por tanto, la selección máxima de
la lógica de conmutación sigue permitiendo al regulador de caudal PID_Compact_1 el acceso
al actuador. Además, mediante las asignaciones PID_Compact_2.OverwriteInitialOutputValue
= PID_Compact_1.Output y PID_Compact_2.PIDCtrl.PIDInit = TRUE se garantiza que se
corregirá PID_Compact_2.
Si ahora la presión se acerca al límite superior o lo rebasa, por ejemplo, debido a una avería,
el regulador de presión PID_Compact_2 calculará un valor de salida mayor para seguir
abriendo la válvula y así reducir la presión. Si PID_Compact_2.Output es mayor que
PID_Compact_1.Output, el regulador de presión PID_Compact_2 obtiene acceso al actuador
a través de la selección de valor máximo y lo abre. Mediante las asignaciones
PID_Compact_1.OverwriteInitialOutputValue = PID_Compact_2.Output y
PID_Compact_1.PIDCtrl.PIDInit = TRUE se garantiza que se corregirá PID_Compact_1.

712

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
La presión se reduce mientras el caudal aumenta y deja de poder mantenerse en la consigna.
Si la avería deja de producirse, la presión seguirá cayendo, y la apertura de la válvula se
reducirá mediante el regulador de presión. Si el regulador de caudal calcula una apertura
mayor como valor de salida, la instalación regresa al modo normal, de forma que el regulador
de caudal PID_Compact_1 vuelve a obtener acceso al actuador.
Este ejemplo se puede implementar con el siguiente código de programa SCL:
"PID_Compact_1"(Input := "Input1");
"PID_Compact_2"(Input := "Input2");
IF "PID_Compact_1".Output >= "PID_Compact_2".Output THEN
"ActuatorInput" := "PID_Compact_1".Output_PER;
"PID_Compact_1".PIDCtrl.PIDInit := FALSE;
"PID_Compact_2".PIDCtrl.PIDInit := TRUE;
"PID_Compact_2".OverwriteInitialOutputValue :=
"PID_Compact_1".Output;
ELSE
"ActuatorInput" := "PID_Compact_2".Output_PER;
"PID_Compact_1".PIDCtrl.PIDInit := TRUE;
"PID_Compact_2".PIDCtrl.PIDInit := FALSE;
"PID_Compact_1".OverwriteInitialOutputValue :=
"PID_Compact_2".Output;
END_IF;

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

713

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Simulación de PID_Compact V2 con PLCSIM
Nota
Simulación con PLCSIM
La simulación de PID_Compact V2.x con PLCSIM para CPU S7-1200 no se soporta.
PID_Compact V2.x solo puede simularse con PLCSIM para CPU S7-1500.
En la simulación con PLCSIM, el comportamiento temporal del PLC simulado no es idéntico al
de un PLC "auténtico". El verdadero ciclo de un OB de alarma cíclica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "auténtico".
En la configuración estándar, PID_Compact determina automáticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_Compact con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
Esto provoca la cancelación de las optimizaciones en curso.
La reacción en el modo automático depende del valor de la variable ActivateRecoverMode.
Para evitarlo, debe configurarse PID_Compact en la simulación con PLCSIM del modo
siguiente:
● CycleTime.EnEstimation = FALSE
● CycleTime.EnMonitoring = FALSE
● CycleTime.Value: Asigne a estas variables el ciclo del OB de alarma cíclica que se debe
llamar en la unidad segundos.

3.3.1.3

PID_Compact V1

Configurar PID_Compact V1
Ajustes básicos V1
Introducción V1
Configure las propiedades siguientes del objeto tecnológico PID_Compact en el área de
ajustes básicos de la ventana de inspección o de configuración.
● Magnitud física
● Sentido de regulación
● Comportamiento en arranque después de un reset
● Consigna (sólo en la ventana de inspección)
● Valor real (sólo en la ventana de inspección)
● Valor de salida (sólo en la ventana de inspección)

714

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Consigna, valor real y valor de salida
La consigna, el valor real y el valor de salida sólo pueden configurarse en la ventana de
inspección del editor de programación. Para cada salida digital elija la fuente:
● DB de instancia
Se utiliza el valor que se encuentra almacenado en el DB de instancia.
El valor debe actualizarse en el DB de instancia del programa de usuario.
En la instrucción no puede haber ningún valor.
Modificación posible desde HMI.
● Instrucción
Se utiliza el valor que se conecta con la instrucción.
Cada vez que se llama la instrucción, el valor se escribe en el DB de instancia.
No se puede modificar desde HMI.

Tipo de regulación V1
Magnitud física
En el grupo "Tipo de regulación" seleccione la magnitud física y la unidad de la consigna y el
valor real. La consigna y el valor real se muestran en esta unidad.

Sentido de regulación
Por lo general, un aumento del valor de salida debe lograr un aumento del valor real. En este
caso, se habla de un sentido de regulación normal.
PID_Compact no funciona con ganancia proporcional negativa. Para reducir el valor real con
un valor de salida más elevado, active la casilla de verificación "Inversión sentido de
regulación".
Ejemplos
● Al abrir una válvula de escape se reduce el nivel de un recipiente.
● Si se aumenta la potencia de refrigeración, disminuye la temperatura.

Comportamiento en arranque tras un reset
Para cambiar inmediatamente al último modo de operación activo tras el rearranque de la
CPU, active la casilla de verificación "Activar último modo de operación después del
rearranque de la CPU".
Si la casilla de verificación está desactivada, PID_Compact se queda en el modo de operación
"Inactivo".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

715

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Consigna V1
Procedimiento
Para especificar una consigna fija, proceda del siguiente modo:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 °C.
3. En caso necesario, elimine una entrada de la instrucción.
Para especificar una consigna variable, proceda del siguiente modo:
1. Seleccione "Instrucción".
2. Indique el nombre de la variable REAL en la que está almacenada la consigna.
Es posible asignar varios valores controlados por programa a la variable REAL para, por
ejemplo, modificar la consigna de tiempo de forma controlada.

Valor real V1
Si utiliza directamente el valor de la entrada analógica, PID_Compact escala el valor de la
entrada analógica al tamaño físico.
Si se desea acondicionar el valor de la entrada analógica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada analógica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada analógica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucción" como fuente.
3. Introduzca la dirección de la entrada analógica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucción" como fuente.
3. Indique el nombre de la variable en la que está almacenado el valor real acondicionado.

716

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Valor de salida V1
PID_Compact ofrece tres valores de salida. El valor de salida que se utilice dependerá del
actuador.
● Output_PER
El actuador se activa a través de una salida analógica y se controla con una señal continua,
como puede ser 0 a 10 V, 4 a 20 mA.
● Output
El valor de salida debe acondicionarse mediante el programa de usuario, por ejemplo,
porque el actuador muestra un comportamiento no lineal.
● Output_PWM
El actuador se controla a través de una salida digital. Una modulación de ancho de impulsos
permite formar tiempos de conexión y desconexión variables.

Procedimiento
Para utilizar el valor de salida analógico, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output_PER" (analógica).
2. Seleccione "Instrucción".
3. Introduzca la dirección de la salida analógica.
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "Output", seleccione la entrada "Output".
2. Seleccione "DB de instancia".
El valor de salida calculado se guarda en DB de instancia.
3. Para acondicionar el valor de salida utilice el parámetro de salida Output.
4. Transfiera el valor de salida acondicionado hasta el actuador a través de una salida digital
o analógica de la CPU.
Para utilizar el valor de salida digital, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output_PWM".
2. Seleccione "Instrucción".
3. Introduzca la dirección de la salida digital.

Ajuste de valor real V1
Configure la normalización del valor real en la ventana de configuración "Ajustes del valor real"
y fije los límites absolutos del valor real.

Escalar valor real
Si en los ajustes básicos se ha elegido el uso de Input_PER, el valor de la entrada analógica
debe convertirse en el tamaño físico del valor real. En el cuadro de visualización Input_PER se
muestra la configuración actual.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

717

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Si el valor real es directamente proporcional al valor de la entrada analógica, Input_PER se
escala a partir de una pareja de valores inferiores y superiores.
1. En los campos de entrada "Valor real inferior escalado" y "Abajo" introduzca la pareja de
valores inferiores.
2. En los campos de entrada "Valor real inferior escalado" y "Abajo" introduzca la pareja de
valores inferiores.
La configuración de hardware incluye una configuración predeterminada para los pares de
valores. Para utilizar los pares de valores a partir de la configuración de hardware, proceda del
siguiente modo:
1. Seleccione la instrucción PID_Compact en el editor de programación.
2. En los ajustes básicos, interconecte Input_PER con una entrada analógica.
3. En la configuración del valor real, haga clic en el botón "Ajuste automático".
Los valores existentes se sobrescriben con los valores de la configuración de hardware.

Monitorizar el valor real
Defina los límites absolutos superior e inferior del valor real. En cuanto dichos valores se
rebasen por exceso o por defecto durante el funcionamiento, la regulación se desconectará y
el valor de salida se ajustará al 0%. Como límites, se deben introducir valores razonables para
el sistema regulado. Durante la optimización es importante disponer de valores límite
razonables para obtener los parámetros PID óptimos.
La preasignación del "Límite superior del valor real" es 120%. En la entrada de periferia, el
valor real puede encontrarse como máximo un 18% por encima del rango normalizado
(margen de saturación). No se comunica ningún error más debido al rebasamiento por exceso
del "Límite superior del valor real". Únicamente se detectan la rotura de hilo y el cortocircuito
y PID_Compact pasa al modo de operación "Inactivo".
ADVERTENCIA
Si ajusta valores muy altos (z. B. -3,4*1038...+3,4*1038) como límites del valor real, se
desactiva la monitorización del valor real. Esto puede dar lugar a daños en la instalación.

Consulte también
Vigilancia de valor real V1 (Página 719)
Limitaciones de PWM V1 (Página 719)
Límites del valor de salida V1 (Página 721)
Parámetros PID V1 (Página 722)

718

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Ajustes avanzados V1
Vigilancia de valor real V1
Configure un límite de advertencia inferior y uno superior para el valor real en la ventana de
configuración "Monitorización del valor real". Si durante el funcionamiento se rebasa uno de los
límites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucción
"PID_Compact".
● En el parámetro de salida "InputWarning_H", si se ha rebasado por exceso el límite superior
de advertencia
● En el parámetro de salida "InputWarning_L", si se ha rebasado por defecto el límite inferior
de advertencia
Los límites de advertencia deben encontrarse dentro de los límites superior e inferior del valor
real.
Si no introduce ningún valor, se utilizan los límites superior e inferior del valor real.

Ejemplo
Límite superior del valor real = 98 °C; límite superior de advertencia = 90 °C
Límite inferior de advertencia = 10 ℃; límite inferior del valor real = 0 ℃
PID_Compact se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

Modo de operación

> 98 °C

TRUE

FALSE

Inactivo

≤ 98 °C y > 90 °C

TRUE

FALSE

Modo automático

≤ 90 °C y ≥ 10 °C

FALSE

FALSE

Modo automático

< 10°C y ≥ 0 °C

FALSE

TRUE

Modo automático

< 0 °C

FALSE

TRUE

Inactivo

Consulte también
Ajuste de valor real V1 (Página 717)
Limitaciones de PWM V1 (Página 719)
Límites del valor de salida V1 (Página 721)
Parámetros PID V1 (Página 722)

Limitaciones de PWM V1
Una modulación de ancho de impulsos transforma el valor del parámetro de salida Output en
un tren de impulsos que se emite por el parámetro de salida Output_PWM.
Output se calcula en el tiempo de muestreo Algoritmo PID. El tiempo de muestreo se utiliza
como duración del período de la modulación por ancho de impulso.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

719

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
El tiempo de muestreo Algoritmo PID se determina durante la optimización inicial o la
optimización fina. Al ajustar los parámetros PID manualmente, debe configurarse también ahí
el tiempo de muestreo Algoritmo PID.
Output_PWM se emite en el tiempo de muestreo PID_Compact. El tiempo de muestreo
PID_Compact equivale al tiempo de ciclo del OB invocante.
La duración del impulso es proporcional al valor de Output y es siempre un múltiplo entero del
tiempo de muestreo PID_Compact.
2XWSXW





W PV

2XWSXWB3:0
758(
)$/6(

W PV





①
②
③
④



Tiempo de muestreo PID_Compact
Tiempo de muestreo Algoritmo PID
Duración del impulso
Duración de la pausa

"Tiempo conexión mín." y "Tiempo de desconex. mín." se redondean a un múltiplo entero del
tiempo de muestreo PID_Compact.
Un impulso o una pausa nunca son más cortas que los tiempos de conexión o desconexión
mínimos. Las imprecisiones que se producen se suman y se compensan en el siguiente ciclo.
Ejemplo
Tiempo de muestreo PID_Compact (equivale al tiempo de ciclo del OB que efectúa la llamada)
= 100 ms
Tiempo de muestreo Algoritmo PID (equivale a la duración del periodo)= 1000 ms
Tiempo conexión mín. = 200 ms
Output es constante del 15%. El mínimo impulso que PID_Compact puede emitir es del 20 %
En el primer ciclo no se emite ningún impulso. En el segundo ciclo, el impulso no emitido del
primer ciclo se agrega al impulso del segundo ciclo.

720

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
2XWSXW





2XWSXWB3:0

W PV

758(
)$/6(

W PV





①
②
⑤

Tiempo de muestreo PID_Compact
Tiempo de muestreo Algoritmo PID
Tiempo conexión mín.

Para reducir la frecuencia de conmutación y proteger el actuador, prolongue los tiempos de
conexión y desconexión mínimos.
Si se utiliza "Output" o "Output_PER", los tiempos mínimos de conexión y desconexión deben
configurarse con el valor 0.0.
Nota
Los tiempos mínimos de conexión y desconexión actúan solo en el parámetro de salida
Output_PWM y no se utilizan para posibles generadores de impulsos integrados en la CPU.

Consulte también
Ajuste de valor real V1 (Página 717)
Vigilancia de valor real V1 (Página 719)
Límites del valor de salida V1 (Página 721)
Parámetros PID V1 (Página 722)

Límites del valor de salida V1
Configure en tantos por ciento los límites absolutos del valor de salida en la ventana de
configuración "Límites del valor de salida". Los límites absolutos del valor de salida no se
rebasan ni por exceso ni por defecto ni en el modo manual ni en el automático. Si en el modo
manual se especifica un valor de salida fuera de los límites, el valor efectivo se limitará en la
CPU a los límites configurados.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

721

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Los valores válidos para los límites del valor de salida dependen del Output utilizado.
Output

-100,0 a 100,0

Output_PER

-100,0 a 100,0

Output_PWM

0,0 a 100,0

En caso de error, PID_Compact ajusta el valor de salida a 0.0. Así pues, 0.0 debe encontrarse
siempre dentro de los límites del valor de salida. Para obtener un límite inferior del valor de
salida mayor que 0.0, en el programa de usuario debe sumarse un offset a Output y
Output_PER.

Consulte también
Ajuste de valor real V1 (Página 717)
Vigilancia de valor real V1 (Página 719)
Limitaciones de PWM V1 (Página 719)
Parámetros PID V1 (Página 722)

Parámetros PID V1
En la ventana de configuración "Parámetros PID" se visualizan los parámetros PID. Durante la
optimización los parámetros PID se adaptan al sistema regulado. No es necesario introducir
los parámetros PID de forma manual.
Nota
Los parámetros PID efectivos actualmente están en la estructura sRet con PID_Compact V1
y en la estructura Retain.CtrlParams con PID_Compact V2.
Para prevenir un comportamiento erróneo del regulador PID, los parámetros PID efectivos
actualmente solo deben modificarse online en el modo de operación "Inactivo".
Si desea modificar online los parámetros PID en los modos de operación "Automático" o
"Manual", debe hacerlo del siguiente modo:
● PID_Compact V1: Modifique los parámetros PID en la estructura sBackUp y aplique los
cambios poniendo sPid_Cmpt.b_LoadBackUp = TRUE en la estructura sRet.
● PID_Compact V2: Modifique los parámetros PID en la estructura CtrlParamsBackUp y
aplique los cambios poniendo LoadBackUp = TRUE en la estructura Retain.CtrlParams.
Los cambios online en los parámetros PID realizados en el modo de operación "Automático"
pueden provocar saltos en el valor de salida.
El algoritmo PID funciona de acuerdo con la siguiente fórmula:

722

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
1

y = Kp

[ (b · w - x) + T · s

(w - x) +

I

TD · s
a · TD · s + 1

(c · w - x)

]

y

Valor de salida del algoritmo PID

Kp

Ganancia proporcional

s

Operador laplaciano

b

Ponderación de la acción P

w

Consigna

x

Valor real

TI

Tiempo de integración

a

Coeficiente para el retardo de la acción derivada (retardo de la acción derivada T1 = a ×TD)

TD

Tiempo derivativo

c

Ponderación de la acción D

El gráfico siguiente muestra cómo entran los parámetros en el algoritmo PID.
6HWSRLQW Z

E



$QWL:LQGXS
/,0,7

,

.3

\


F

6FDOHG,QSXW [



'7

Todos los parámetros PID son remanentes. Si introduce manualmente los parámetros PID,
debe cargar PID_Compact por completo.
Cargar objetos tecnológicos en el dispositivo (Página 667)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_Compact no funciona con una
ganancia proporcional negativa. El sentido de regulación se invierte en Ajustes básicos > Tipo
de regulación.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

723

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Tiempo de integración
El tiempo de integración determina el comportamiento temporal de la acción I. La desconexión
de la acción I se realiza con el tiempo de integración = 0,0. Si el tiempo de integración se
modifica online en el modo de operación "Automático" de un valor cualquiera a 0.0, la acción
I actual se borra y se produce un salto del valor de salida.

Tiempo derivativo
El tiempo de la acción derivada determina el comportamiento temporal de la acción D. La
desconexión de la acción D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acción derivada
El efecto de la acción D se retrasa mediante el coeficiente de retardo de la acción derivada.
Retardo de la acción derivada = Tiempo derivativo x coeficiente de retardo de la acción
derivada
● 0.0: la acción D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
● 0.5: Este valor se ha acreditado en la práctica para sistemas regulados con una constante
de tiempo dominante.
● > 1.0: Cuanto mayor sea el coeficiente, más se retrasará el efecto de la acción D.

Ponderación de la acción P
En el caso de que se produzcan cambios en la consigna, es posible atenuar la acción P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción P es totalmente efectiva cuando se cambia la consigna
● 0.0: La acción P no actúa al cambiar la consigna
Si se produce una modificación del valor real, la acción P es totalmente efectiva.

Ponderación de la acción D
En el caso de que se produzcan cambios en la consigna, es posible atenuar la acción D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción D es totalmente efectiva cuando se cambia la consigna.
● 0.0: La acción D no actúa al cambiar la consigna
Si se produce una modificación del valor real, la acción D es totalmente efectiva.

724

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Tiempo de muestreo Algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo del algoritmo
PID es el tiempo entre dos cálculos del valor de salida. Este se determina durante la
optimización y se redondea a un múltiplo del tiempo de ciclo. Todas las demás funciones de
PID_Compact se ejecutan con cada llamada.
Si se utiliza Output_PWM, el tiempo de muestreo del algoritmo PID se utiliza como duración del
periodo de la modulación por ancho de impulsos. La precisión de la señal de salida está
determinada por la relación entre el tiempo de muestreo del algoritmo PID y el tiempo de ciclo
del OB. Por eso se recomienda que el tiempo de ciclo sea como máximo una décima parte del
tiempo de muestreo del algoritmo PID.

Regla para la optimización
En la lista desplegable "Estructura del regulador" seleccione si van a calcular los parámetros
PI o PID.
● PID
Se calcula durante la optimización inicial y la optimización fina del parámetro PID.
● PI
Se calcula durante la optimización inicial y la optimización fina del parámetro PI.
● Definido por el usuario
Si se han ajustado diferentes estructuras del regulador para la optimización inicial y la
optimización fina en un programa de usuario, en la lista desplegable aparece "Definido por
el usuario".

Consulte también
Elección de la estructura del regulador con un sistema regulado definido (Página 660)

Poner en servicio PID_Compact V1
Puesta en servicio V1
La ventana de puesta en servicio ayuda durante la puesta en servicio del regulador PID. En el
visor de curvas se puede observar los valores de la consigna, valor real y valor de salida a lo
largo del eje de tiempo. En la ventana de puesta en servicio se soportan las siguientes
funciones:
● Optimización inicial del regulador
● Optimización fina del regulador
Utilice la optimización fina si desea realizar un ajuste de precisión del parámetro PID.
● Observación de la regulación en curso en la ventana de curvas
● Probar el sistema regulado especificando un valor de salida manual
Para todas las funciones es preciso realizar una conexión online a la CPU.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

725

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Principios básicos del manejo
● Seleccione el tiempo de actualización que desee en la lista desplegable "Tiempo de
actualización".
Todos los valores de la ventana de puesta en servicio se actualizan en el tiempo de
actualización seleccionado.
● Haga clic en el botón "Inicio" en el grupo Medición si desea utilizar las funciones de puesta
en servicio.
Se inicia el registro de los valores. En el visor de curvas se registran los valores actuales de
consigna, valor real y valor de salida. Se habilita el manejo de la ventana de puesta en
servicio.
● Haga clic en el botón "Parar" si desea finalizar las funciones de puesta en servicio.
Los valores mostrados en el visor de curvas pueden continuar analizándose.
Al cerrar la ventana de puesta en servicio finaliza el registro en el visor de curvas y los valores
registrados se borran.

Consulte también
Optimización inicial V1 (Página 726)
Optimización fina V1 (Página 727)
Modo de operación "Modo manual" V1 (Página 729)

Optimización inicial V1
La optimización inicial determina el comportamiento del proceso a un escalón del valor de
salida y busca el punto de inflexión. A partir de la inclinación máxima y del tiempo muerto del
sistema regulado se calculan los parámetros PID óptimos.
Cuanto más estable es el valor real, con mayor facilidad y precisión se pueden calcular los
parámetros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea
considerablemente mayor que el ruido. Es preciso realizar una copia de seguridad de los
parámetros PID antes de volver a calcularlos.

Requisitos
● La instrucción "PID_Compact" se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● PID_Compact se encuentra en el modo de operación "Inactivo" o "Manual".
● La consigna no puede modificarse durante la optimización. De lo contrario se desactiva
PID_Compact.
● La consigna y el real se encuentran dentro de los límites configurados (véase la
configuración "Monitorización del valor real").
● La diferencia entre la consigna y el valor real es mayor del 30% de la diferencia entre el
límite superior e inferior del valor real.
● La diferencia entre la consigna y el valor real es superior al 50% de la consigna.

726

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimización inicial, proceda del siguiente modo:
1. Haga doble clic en la navegación del proyecto en la entrada "PID_Compact" > Puesta en
servicio".
2. En la lista desplegable "Modo de optimización" seleccione la entrada "Optimización inicial".
3. Haga clic en el símbolo "Start".
– Se establece una conexión online.
– Se inicia el registro de los valores.
– Se inicia la optimización inicial.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Haga clic en el símbolo "Stop" cuando la barra de progreso haya alcanzado el 100% y
se deba presuponer un bloqueo de la optimización. Compruebe la configuración del
objeto tecnológico y, si procede, vuelva a iniciar la optimización.

Resultado
Si la optimización inicial ha finalizado sin ningún mensaje de error, significa que los parámetros
PID se han optimizado. PID_Compact cambia al modo automático y utiliza los parámetros
optimizados. Los parámetros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es preciso realizar la optimización inicial, PID_Compact cambia al modo de operación
"Inactivo".

Consulte también
Puesta en servicio V1 (Página 725)
Optimización fina V1 (Página 727)
Modo de operación "Modo manual" V1 (Página 729)

Optimización fina V1
La optimización fina genera una oscilación constante y limitada del valor real. Los parámetros
PID se optimizan para el punto de operación a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular todos los parámetros PID. Los parámetros PID existentes
después de la optimización fina muestran en su mayoría un comportamiento de guía y ante
fallos mucho mejor que los parámetros PID de la optimización inicial.
PID_Compact intenta generar automáticamente una oscilación que es mayor que el ruido del
valor real. La estabilidad del valor real ejerce tan sólo una mínima influencia sobre la
optimización fina. Es preciso realizar una copia de seguridad de los parámetros PID antes de
volver a calcularlos.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

727

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Requisitos
● La instrucción "PID_Compact" se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● La consigna y el real se encuentran dentro de los límites configurados (véase la
configuración "Monitorización del valor real").
● El lazo de regulación es estacionario en el punto de operación. El punto de operación se ha
alcanzado cuando el valor real coincide con la consigna.
● No se esperan perturbaciones.
● La consigna no puede modificarse durante la optimización.
● PID_Compact se encuentra en el modo de operación inactivo, automático o manual.

El proceso depende de la situación de inicio
La optimización fina puede iniciarse desde los modos de operación "Inactivo", "Automático" o
"Manual". La optimización fina se realiza en el momento del inicio tal como se indica a
continuación:
● Modo automático
Si desea mejorar los parámetros PID existentes mediante optimización, inicie la
optimización fina a partir del modo automático.
PID_Comact regula con los parámetros PID existentes hasta que el lazo de regulación es
estacionario y se han cumplido las condiciones para una optimización fina. Sólo entonces
comienza la optimización fina.
● Inactivo o manual
Si se cumplen las condiciones para optimización inicial, ésta se inicia. Con los parámetros
PID calculados la regulación se realiza hasta que el lazo de regulación es estacionario y se
han cumplido las condiciones para una optimización fina. Sólo entonces comienza la
optimización fina. Si no es posible realizar la optimización inicial, PID_Compact cambia al
modo de operación "Inactivo".
Si el valor real para una optimización inicial se encuentra ya muy cerca de la consigna, se
intenta alcanzar la consigna con el valor de salida máximo o mínimo. lo que puede
ocasionar una sobreoscilación muy alta.

728

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimización fina, proceda del siguiente modo:
1. En la lista desplegable "Modo de optimización" seleccione la entrada "Optimización fina".
2. Haga clic en el símbolo "Start".
– Se establece una conexión online.
– Se inicia el registro de los valores.
– Se inicia el proceso de optimización fina.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de optimización" haga clic en el símbolo "Stop" cuando la barra de
progreso haya alcanzado el 100% y se deba presuponer un bloqueo de la optimización.
Compruebe la configuración del objeto tecnológico y, si procede, vuelva a iniciar la
optimización.

Resultado
Si la optimización fina se ha completado sin ningún aviso de error, significa que los parámetros
PID se han optimizado. PID_Compact cambia al modo automático y utiliza los parámetros
optimizados. Los parámetros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si se produjeran errores durante la optimización fina, PID_Compact cambia al modo de
operación "Inactivo".

Consulte también
Puesta en servicio V1 (Página 725)
Optimización inicial V1 (Página 726)
Modo de operación "Modo manual" V1 (Página 729)

Modo de operación "Modo manual" V1
A continuación se describe cómo utilizar el modo de operación "Modo manual" en la ventana
de puesta en servicio del objeto tecnológico "PID Compact".

Requisitos
● La instrucción "PID_Compact" se llama en un OB de alarma cíclica.
● Hay establecida una conexión online con la CPU y ésta se encuentra en el estado operativo
"RUN".
● Las funciones de la ventana de puesta en marcha se han habilitado con el botón "Medición
on".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

729

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Procedimiento
Utilice "Modo manual" en la ventana de puesta en servicio si desea probar el sistema regulado
especificando un valor manual. Para especificar un valor manual, proceda del siguiente modo:
1. Active la casilla de verificación "Modo manual" en el área "Estado online del regulador".
PID_Compact funciona en modo manual. El último valor de salida actual permanece activo.
2. Introduzca el valor manual en la unidad % en el campo "Output".
3. Haga clic en el botón

.

Resultado
El valor manual se escribe en la CPU y es efectivo de forma inmediata.
Nota
PID_Compact sigue monitorizando el valor real. Cuando se exceden los límites del valor real,
se desactiva PID_Compact.
Desactive la casilla de verificación "Modo manual" si desea que el regulador PID vuelva a
especificar el valor de salida. El cambio al modo automático se efectúa sin discontinuidad.

Consulte también
Puesta en servicio V1 (Página 725)
Optimización inicial V1 (Página 726)
Optimización fina V1 (Página 727)

730

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Simulación de PID_Compact V1 con PLCSIM
Nota
Simulación con PLCSIM
En la simulación con PLCSIM, el comportamiento temporal del PLC simulado no es idéntico al
de un PLC "auténtico". El verdadero ciclo de un OB de alarma cíclica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "auténtico".
En la configuración estándar, PID_Compact determina automáticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_Compact con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
PID_Compact cambia en este caso al modo de operación Inactivo (State = 0).
Para evitarlo, debe configurarse PID_Compact en la simulación con PLCSIM del modo
siguiente:
● sb_EnCyclEstimation = FALSE
● sb_EnCyclMonitoring = FALSE
● sPid_Calc.r_Cycle: Asigne a estas variables el ciclo del OB de alarma cíclica que se debe
llamar en la unidad segundos.

3.3.2

Utilizar PID_3Step

3.3.2.1

Objeto tecnológico PID_3Step
El objeto tecnológico PID_3Step proporciona un regulador PID con optimización para válvulas
o actuadores con comportamiento integrador.
Es posible configurar los siguientes reguladores:
● Regulador paso a paso de tres puntos con realimentación de posición
● Regulador paso a paso de tres puntos sin realimentación de posición
● Regulador de válvula con valor de salida analógico
PID_3Step registra de forma continua el valor real medido dentro de un lazo de regulación y lo
compara con la consigna. A partir del error de regulación resultante, PID_3Step calcula un
valor de salida, con el que el valor real se iguala con la consigna con la máxima rapidez y
estabilidad. En los reguladores PID, el valor de salida se compone de tres acciones:
● Acción P
La acción P del valor de salida aumenta proporcionalmente al error de regulación.
● Acción I
La acción I del valor de salida aumenta hasta que se compensa el error de regulación.
● Acción D
La acción D aumenta con una velocidad de variación creciente del error de regulación. El
valor real se igual lo más rápidamente posible con la consigna. Si la velocidad de variación
del error de regulación vuelve a reducirse, también lo hace la acción D.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

731

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
La instrucción PID_3Step calcula los parámetros P, I y D para su sistema regulado de forma
autónoma durante la optimización inicial. Los parámetros pueden optimizarse aún más a
través de una optimización fina. No es necesario determinar los parámetros manualmente.

Información adicional
● Vista general de los reguladores de software (Página 661)
● Agregar objetos tecnológicos (Página 664)
● Configurar objetos tecnológicos (Página 665)
● Configuración de PID_3Step V2 (Página 732)
● Configuración de PID_3Step V1 (Página 751)

Principio
Para más información al respecto, consulte la siguiente pregunta frecuente (FAQ) en el
Siemens Industry Online Support:
● ID de artículo 68011827 (https://support.industry.siemens.com/cs/ww/en/view/68011827)

3.3.2.2

PID_3Step V2

Configuración de PID_3Step V2
Ajustes básicos V2
Introducción V2
Configure las propiedades siguientes del objeto tecnológico PID_3Step en el área de ajustes
básicos de la ventana de inspección o de configuración.
● Magnitud física
● Sentido de regulación
● Comportamiento en arranque tras un reset
● Consigna (sólo en la ventana de inspección)
● Valor real (sólo en la ventana de inspección)
● Valor de salida (sólo en la ventana de inspección)
● Realimentación de posición (sólo en la ventana de inspección)

732

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Consigna, valor real, valor de salida y realimentación de posición
La consigna, el valor real, el valor de salida y la realimentación de posición sólo pueden
configurarse en la ventana de inspección del editor de programación. Para cada valor elija el
origen:
● DB de instancia
Se utiliza el valor que se encuentra almacenado en el DB de instancia.
El valor debe actualizarse en el DB de instancia del programa de usuario.
En la instrucción no puede haber ningún valor.
Modificación posible desde HMI.
● Instrucción
Se utiliza el valor que se interconecta a la instrucción.
Cada vez que se llama la instrucción, el valor se escribe en el DB de instancia.
No se puede modificar desde HMI.

Tipo de regulación V2
Magnitud física
En el grupo "Tipo de regulación", seleccione la magnitud física y la unidad para la consigna, el
valor real y la magnitud perturbadora. La consigna, el valor real y la magnitud perturbadora se
mostrarán en dicha unidad.

Sentido de regulación
Por lo general, un aumento del valor de salida debe lograr un aumento del valor real. En este
caso, se habla de un sentido de regulación normal.
PID_3Step no funciona con ganancia proporcional negativa. Para reducir el valor real con un
valor de salida más elevado, active la casilla de verificación "Inversión sentido de regulación".
Ejemplos
● Al abrir una válvula de escape se reduce el nivel de llenado de un recipiente.
● Si se aumenta la potencia de refrigeración, disminuye la temperatura.

Comportamiento en arranque
1. Para cambiar inmediatamente al modo de operación "Inactivo" tras el rearranque de la
CPU, desactive la casilla de verificación "Activar Mode tras rearrancar la CPU".
Para cambiar inmediatamente, tras el rearranque de la CPU, al modo de operación
almacenado en Mode, active la casilla de verificación "Activar Mode tras rearrancar la
CPU".
2. En la lista desplegable "Poner Mode a", seleccione el modo de operación que debe
activarse tras una carga completa en el dispositivo.
Tras una carga completa en el dispositivo, PID_3Step arranca en el modo de operación
seleccionado. Con cada rearranque, PID_3Step arranca en el último modo de operación
almacenado en Mode.
Ejemplo

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

733

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Se ha activado la casilla de verificación "Activar Mode tras rearrancar la CPU" y se ha
seleccionado la entrada "Optimización inicial" en la lista "Poner Mode a". Tras una carga
completa en el dispositivo, PID_3Step arranca en el modo de operación "Optimización inicial".
Si la optimización inicial aún está activa y se rearranca la CPU, PID_3Step arranca de nuevo
en el modo de operación "Optimización inicial". Si la optimización inicial ha finalizado
correctamente, el modo automático aún está activo y se rearranca la CPU, PID_3Step arranca
en "Modo automático".

Consigna V2
Procedimiento
Para especificar una consigna fija, proceda del siguiente modo:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 °C.
3. En caso necesario, elimine una entrada de la instrucción.
Para especificar una consigna variable, proceda del siguiente modo:
1. Seleccione "Instrucción".
2. Indique el nombre de la variable REAL en la que está almacenada la consigna.
Es posible asignar varios valores de forma controlada por programa a la variable REAL
para, por ejemplo, modificar la consigna de tiempo de forma controlada.

Valor real V2
Si utiliza directamente el valor de la entrada analógica, PID_3Step escala el valor de la entrada
analógica al tamaño físico.
Si desea acondicionar primero el valor de la entrada analógica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada analógica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada analógica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucción" como fuente.
3. Introduzca la dirección de la entrada analógica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucción" como fuente.
3. Indique el nombre de la variable en la que está almacenado el valor real acondicionado.

734

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Realimentación de posición V2
La configuración de la realimentación de posición depende del elemento final de control
utilizado.
● Actuador sin realimentación de posición
● Elemento final de control con señales de tope digitales
● Actuador con realimentación de posición analógica
● Actuador con realimentación de posición analógico y señales de tope

Elemento final de control sin realimentación de posición
Para configurar PID_3Step para un elemento final de control sin realimentación de posición,
proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "No Feedback".

Elemento final de control con señales de tope digitales
Para configurar PID_3Step para un elemento final de control con señales de tope, proceda del
siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "No Feedback".
2. Active la casilla de verificación "Señal tope del actuador".
3. Seleccione "Instrucción" como fuente para Actuator_H y Actuator_L.
4. Introduzca las direcciones de las entradas digitales para Actuator_H y Actuator_L.

Elemento final de control con realimentación de posición analógica
Para configurar PID_3Step para un elemento final de control con realimentación de posición
analógica, proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "Feedback" o "Feedback_PER".
– En Feedback_PER utilice el valor de la entrada analógica. El escalado de
Feedback_PER se configura en la configuración del elemento final de control.
– En Feedback procese el valor de la entrada analógica a través de su programa de
usuario.
2. Seleccione "Instrucción" como fuente.
3. Introduzca la dirección de la entrada analógica o la variable de su programa de usuario.

Elemento final de control con realimentación de posición analógica y señales de tope
Para configurar PID_3Step para un elemento final de control con realimentación de posición
analógica y señales de tope, proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "Feedback" o "Feedback_PER".
2. Seleccione "Instrucción" como fuente.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

735

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
3. Introduzca la dirección de la entrada analógica o la variable de su programa de usuario.
4. Active la casilla de verificación "Señal tope del actuador".
5. Seleccione "Instrucción" como fuente para Actuator_H y Actuator_L.
6. Introduzca las direcciones de las entradas digitales para Actuator_H y Actuator_L.

Valor de salida V2
PID_3Step ofrece un valor de salida analógico (Output_PER) y valores de salida digitales
(Output_UP, Output_DN). El valor de salida que se utilice dependerá del actuador.
● Output_PER
El actuador dispone de un tiempo de posicionamiento del motor relevante, se activa a
través de una salida analógica y se controla con una señal continua, como puede ser 0 a
10 V, 4 a 20 mA. El valor de Output_PER se corresponde con la posición de destino de la
válvula, p. ej., Output_PER = 13824, cuando la válvula debe abrirse hasta un 50 %.
PID_3Step tiene en cuenta, p. ej., para la optimización automática y el comportamiento AntiWindup, que el valor de salida analógico actúa en el proceso con un retardo debido al
tiempo de posicionamiento del motor. Si en su proceso no actúa ningún tiempo de
posicionamiento del motor relevante (p. ej., con electroválvulas), de forma que el valor de
salida actúa directamente y en toda su magnitud sobre el proceso, utilice PID_Compact en
su lugar.
● Output_UP, Output_DN
El actuador dispone de un tiempo de posicionamiento del motor relevante y se controla
mediante dos salidas digitales.
Output_UP desplaza la válvula hacia el estado abierto.
Output_DN desplaza la válvula hacia el estado cerrado.
El tiempo de posicionamiento del motor se tiene en cuenta tanto en el cálculo del valor de
salida analógico como en el cálculo de los valores de salida digitales. Es necesario para el
correcto funcionamiento, sobre todo, durante la optimización automática y el comportamiento
Anti-Windup. Por tanto, configure el tiempo de posicionamiento del motor en "Ajustes del
actuador" con el valor que requiere el motor para desplazar el actuador del estado cerrado al
estado abierto.

Procedimiento
Para utilizar el valor de salida analógico, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada Output (analógica).
2. Seleccione "Instrucción".
3. Introduzca la dirección de la salida analógica.
Para utilizar el valor de salida digital, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output (digital)".
2. Seleccione "Instrucción" para Output_UP y Output_DN.
3. Introduzca las direcciones de las salidas digitales.

736

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "Output" seleccione la entrada adecuada al actuador.
2. Seleccione "Instrucción".
3. Indique el nombre de la variable que utilizará para acondicionar el valor de salida.
4. Transfiera el valor de salida acondicionado hasta el actuador a través de una salida
analógica o digital de la CPU.

Ajustes de valor real V2
Escalar valor real V2
Si en los ajustes básicos ha configurado el uso de Input_PER, deberá convertir el valor de la
entrada analógica a la magnitud física del valor real. En el cuadro de visualización Input_PER
se muestra la configuración actual.
Si el valor real es directamente proporcional al valor de la entrada analógica, Input_PER se
escalará a partir de un par de valores inferior y superior.

Procedimiento
Para escalar el valor real, haga lo siguiente:
1. En los campos de entrada "Valor real inferior escalado" y "abajo", introduzca el par de
valores inferior.
2. En los campos de entrada "Valor real superior escalado" y "arriba", introduzca el par de
valores superior.
La configuración hardware contiene pares de valores predeterminados. Para utilizar los pares
de valores contenidos en la configuración hardware, haga lo siguiente:
1. Marque la instrucción PID_3Step en el editor de programación.
2. En los ajustes básicos, interconecte Input_PER con una entrada analógica.
3. En los ajustes del valor real, haga clic en el botón "Ajuste automático".
Los valores existentes se sobrescribirán con los valores de la configuración hardware.

Límites de valor real V2
Como valores límite para el sistema regulado defina los límites superior e inferior absolutos del
valor real de modo que sean razonables. Tan pronto como dichos valores se rebasen por
exceso o defecto, se producirá un error (ErrorBits = 0001h). La optimización se cancela cuando
se rebasan los valores reales. Defina en los ajustes del actuador cómo debe reaccionar
PID_3Step en caso de error en el modo automático.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

737

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Ajustes de actuador V2
Actuador V2
Tiempos específicos del actuador
Para proteger el elemento final de control frente a daños, ajuste el tiempo de posicionamiento
del motor y los tiempos mínimos de conexión y desconexión. Los datos figuran en la hoja de
datos del elemento final de control.
El tiempo de posicionamiento del motor es el tiempo en segundos que requiere el motor para
desplazar el elemento final de control del estado cerrado al estado abierto. El tiempo de
posicionamiento del motor puede calcularse durante la puesta en marcha.
El tiempo de posicionamiento del motor se tiene en cuenta tanto en el cálculo del valor de
salida analógico como en el cálculo de los valores de salida digitales. Es necesario para el
correcto funcionamiento, sobre todo, durante la optimización automática y el comportamiento
Anti-Windup.
Si en su proceso no actúa ningún tiempo de posicionamiento del motor relevante (p. ej., con
electroválvulas), de forma que el valor de salida actúa directamente y en toda su magnitud
sobre el proceso, utilice PID_Compact en su lugar.
El tiempo de posicionamiento del motor es remanente. Si modifica manualmente el tiempo de
posicionamiento del motor, debe cargar PID_3Step por completo.
Cargar objetos tecnológicos en el dispositivo (Página 667)
Si se utiliza Output_UP y Output_DN, debe reducirse la frecuencia de conmutación con los
tiempos mínimos de conexión y desconexión.
En el modo automático se acumulan los tiempos calculados de conexión y desconexión y estos
no surten efecto hasta que la suma sea igual o superior al tiempo mínimo de conexión o
desconexión.
En el modo manual, Manual_UP = TRUE o Manual_DN = TRUE permiten controlar el elemento
final de control al menos en el tiempo mínimo de conexión o desconexión.
Si en los ajustes básicos ha elegido el valor analógico de salida Output_PER, el tiempo de
conexión mínimo y el tiempo de desconexión mínimo no se evalúan ni se pueden modificar.

738

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Comportamiento en caso de error
PID_3Step está preajustado de manera que, en caso de error, la regulación permanece activa
en la mayoría de los casos. Si en el modo de regulación se producen errores con frecuencia,
este ajuste empeorará el comportamiento de regulación. Compruebe en tal caso el parámetro
Errorbits y elimine la causa de error.
ATENCIÓN
Su instalación puede sufrir daños.
Si en caso de error se emite "Valor actual para la duración del error" o "Valor de salida
sustitutivo mientras dure el error", PID_3Step se mantiene en modo automático también
cuando se rebasan los límites del valor real. De este modo, su instalación puede sufrir daños.
Configure un comportamiento en caso de error para su sistema regulado que proteja su
instalación de daños.
En caso de error, PID_3Step emite un valor de salida configurable:
● Valor actual
PID_3Step está desconectado y ya no modifica la posición del elemento final de control.
● Valor actual para la duración del error
Las funciones de regulación de PID_3Step están desactivadas y ya no se modifica la
posición del elemento final de control.
Si se producen los siguientes errores en el modo automático, PID_3Step regresa a dicho
modo en cuanto los errores en cuestión dejan de existir.
– 0002h: Valor no válido en el parámetro Input_PER.
– 0200h: Valor no válido en el parámetro Input.
– 0400h: Error al calcular el valor de salida.
– 1000h: Valor no válido en el parámetro Setpoint.
– 2000h: Valor no válido en el parámetro Feedback_PER.
– 4000h: Valor no válido en el parámetro Feedback.
– 8000h: Error en la realimentación digital de posición.
– 20000h: Valor no válido en la variable SavePosition.
Si se producen uno o varios de los errores siguientes, PID_3Step permanece en
modo automático:
– 0001h: El parámetro Input se encuentra fuera de los límites del valor real.
– 0800h: Error en tiempo de muestreo
– 40000h: Valor no válido en el parámetro Disturbance.
Si aparece un error en el modo manual, PID_3Step permanece en dicho modo.
Si durante la optimización o la medición del tiempo de posicionamiento se produce un error,
PID_3Step cambia al modo de operación en que se había comenzado la optimización o la
medición del tiempo de posicionamiento. La optimización no se cancela con los siguientes
errores únicamente:
– 0020h: La optimización inicial no está permitida durante la optimización fina.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

739

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
● Valor de salida sustitutivo
PID_3Step desplaza el elemento final de control (actuador) al valor de salida sustitutivo y
se desconecta.
● Valor de salida sustitutivo mientras dure el error
PID_3Step desplaza el elemento final de control (actuador) al valor de salida sustitutivo.
Una vez alcanzado el valor de salida sustitutivo, PID_3Step se comporta como se describe
en "Valor actual mientras dure el error".
El valor de salida sustitutivo se introduce en "%".
En los actuadores sin realimentación de posición analógica, solo es posible aproximar de
forma exacta los valores de salida sustitutivos 0% y 100%. Un valor de salida sustitutivo
diferente del 0% o del 100% se aproxima a través de una realimentación de posición simulada
internamente. Sin embargo, con este procedimiento el valor de salida sustitutivo no podrá
aproximarse nunca de forma exacta.
En los actuadores con realimentación de posición analógica, es posible aproximar de forma
exacta todos los valores de salida sustitutivos.

Escalar realimentación de posición V2
Escalar realimentación de posición
Si con el ajuste básico se ha elegido el uso de Feedback_PER, el valor de la entrada analógica
debe convertirse en %. En el cuadro de visualización "Feedback" se muestra el ajuste actual.
Feedback_PER se escala a partir de una pareja de valores inferiores y superiores.
1. En los campos de entrada "Tope inferior" y "Abajo" introduzca la pareja de valores
inferiores.
2. En los campos de entrada "Tope superior" y "Arriba" introduzca la pareja de valores
superiores.
El valor de "Tope inferior" debe ser inferior al de "Tope superior"; por su parte, "Abajo" debe ser
inferior a "Arriba".
Los valores válidos para el "tope superior" y el "tope inferior" dependen de:
● Sin Feedback, Feedback, Feedback_PER
● Output (analógico), Output (digital)

740

Output

Feedback

Tope inferior

Tope superior

Output (digital)

Sin Feedback

No ajustable (0.0 %)

No ajustable (100.0 %)

Output (digital)

Feedback

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (digital)

Feedback_PER

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (analógico)

Sin Feedback

No ajustable (0.0 %)

No ajustable (100.0 %)

Output (analógico)

Feedback

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (analógico)

Feedback_PER

-100.0 % o 0.0 %

0.0 % o +100.0 %

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Límites del valor de salida V2
Limitar el valor de salida
Los límites del valor de salida pueden rebasarse por exceso o por defecto durante la medición
del tiempo de posicionamiento y en el modo = 10. En los demás modos de operación, el valor
de salida se limita a estos valores.
Introduzca en los campos de entrada "Lím. sup. v. de salida" y "Lím. inf. v. de salida" los límites
absolutos del valor de salida. Los límites del valor de salida deben encontrarse dentro del
"Tope inferior" o el "Tope superior".
Si no existe ningún Feedback y está ajustado Output (digital), no se puede limitar el valor de
salida. Output_UP y Output_DN se restablecen entonces si se cumple Actuator_H = TRUE o
Actuator_L = TRUE. Si tampoco existen señales de tope, Output_UP y Output_DN se
restablecen después de un tiempo de desplazamiento del 150% del tiempo de
posicionamiento del motor.
El valor predeterminado 150% puede modificarse mediante la variable
Config.VirtualActuatorLimit. A partir de PID_3Step versión 2.3 puede desactivarse la vigilancia
y limitación del tiempo de desplazamiento con Config.VirtualActuatorLimit = 0.0.

Ajustes avanzados V2
Vigilancia valor real V2
Configure un límite de advertencia inferior y uno superior para el valor real en la ventana de
configuración "Monitorización del valor real". Si durante el funcionamiento se rebasa uno de los
límites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucción
"PID_3Step".
● En el parámetro de salida "InputWarning_H", si se ha rebasado por exceso el límite superior
de advertencia.
● En el parámetro de salida "InputWarning_L", si se ha rebasado por defecto el límite inferior
de advertencia.
Los límites de advertencia deben encontrarse dentro de los límites superior e inferior del valor
real.
Si no introduce ningún valor, se utilizan los límites superior e inferior del valor real.

Ejemplo
Límite superior del valor real = 98 °C; límite superior de advertencia = 90 °C
Límite inferior de advertencia = 10 ℃; límite inferior del valor real = 0 ℃

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

741

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
PID_3Step se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

ErrorBits

Modo de opera‐
ción

> 98 °C

TRUE

FALSE

0001h

Según configura‐
ción

≤ 98 °C y > 90 °C

TRUE

FALSE

0000h

Modo automático

≤ 90 °C y ≥ 10 °C

FALSE

FALSE

0000h

Modo automático

< 10°C y ≥ 0 °C

FALSE

TRUE

0000h

Modo automático

< 0 °C

FALSE

TRUE

0001h

Según configura‐
ción

Configure en los ajustes del actuador cómo debe reaccionar PID_3Step si se rebasa el límite
superior o inferior del valor real.

Parámetros PID V2
En la ventana de configuración "Parámetros PID" se visualizan los parámetros PID. Durante la
optimización los parámetros PID se adaptan al sistema regulado. No es necesario introducir
los parámetros PID de forma manual.
Nota
Los parámetros PID efectivos actualmente están en la estructura Retain.CtrlParams.
Para prevenir un comportamiento erróneo del regulador PID, los parámetros PID efectivos
actualmente solo deben modificarse online en el modo de operación "Inactivo".
Si desea modificar online los parámetros PID en los modos de operación "Automático" o
"Manual", modifique los parámetros PID en la estructura CtrlParamsBackUp y aplique los
cambios en la estructura Retain.CtrlParams, del siguiente modo:
● PID_3Step V1: Aplique los cambios poniendo Config.LoadBackUp = TRUE
● PID_3Step V2: Aplique los cambios poniendo LoadBackUp = TRUE
Los cambios online en los parámetros PID realizados en el modo de operación "Automático"
pueden provocar saltos en el valor de salida.
El algoritmo PID funciona de acuerdo con la siguiente fórmula:

742

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
1

[

Δ y = K p · s · (b · w - x) +

TI · s

(w - x) +

TD · s
a · TD · s + 1

(c · w - x)

]

Δy

Valor de salida del algoritmo PID

Kp

Ganancia proporcional

s

Operador laplaciano

b

Ponderación de la acción P

w

Consigna

x

Valor real

TI

Tiempo de integración

a

Coeficiente para el retardo de la acción derivada (retardo de la acción derivada T1 = a × TD)

TD

Tiempo derivativo

c

Ponderación de la acción D

El gráfico siguiente muestra cómo entran los parámetros en el algoritmo PID.
E

6HWSRLQW Z



'7

F

'

.

3

˂\



'HDGB%





7L

,

6FDOHG,QSXW [
)DF7W

$QWL:LQGXS

Todos los parámetros PID son remanentes. Si introduce manualmente los parámetros PID,
debe cargar PID_3Step por completo.
Cargar objetos tecnológicos en el dispositivo (Página 667)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_3Step no funciona con una
ganancia proporcional negativa. El sentido de regulación se invierte en Ajustes básicos > Tipo
de regulación.

Tiempo de integración
El tiempo de integración determina el comportamiento temporal de la acción I. La desconexión
de la acción I se realiza con el tiempo de integración = 0,0. Si el tiempo de integración se
modifica online en el modo de operación "Automático" de un valor cualquiera a 0.0, la acción
I actual se borra y se produce un salto del valor de salida.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

743

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Tiempo derivativo
El tiempo de la acción derivada determina el comportamiento temporal de la acción D. La
desconexión de la acción D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acción derivada
El efecto de la acción D se retrasa mediante el coeficiente de retardo de la acción derivada.
Retardo de la acción derivada = Tiempo derivativo x coeficiente de retardo de la acción
derivada
● 0.0: la acción D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
● 0.5: Este valor se ha acreditado en la práctica para sistemas regulados con una constante
de tiempo dominante.
● > 1.0: Cuanto mayor sea el coeficiente, más se retrasará el efecto de la acción D.

Ponderación de la acción P
En el caso de que se modifique la consigna, es posible atenuar la acción P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción P es totalmente efectiva al cambiar la consigna
● 0.0: La acción P no es efectiva al cambiar la consigna
Si se produce una modificación del valor real, la acción P es totalmente efectiva.

Ponderación de la acción D
En el caso de que se modifique la consigna, es posible atenuar la acción D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción D es totalmente efectiva cuando se cambia la consigna.
● 0.0: la acción D no es efectiva cuando cambia la consigna.
Si se produce una modificación del valor real, la acción D es totalmente efectiva.

Tiempo de muestreo algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo del algoritmo
PID es el tiempo entre dos cálculos del valor de salida. Este se determina durante la
optimización y se redondea a un múltiplo del tiempo de muestreo PID_3Step. Todas las demás
funciones de PID_3Step se ejecutan con cada llamada.

Ancho de zona muerta
La zona muerta suprime los niveles del ruido en el estado estabilizado del regulador. El ancho
de zona muerta indica el tamaño de la zona muerta. Con un ancho de zona muerta de 0.0, la
zona muerta se encuentra desactivada.

744

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Si para la ponderación de la acción P o de la acción D se han configurado valores diferentes
de 1.0, los cambios de la consigna también tendrán efecto sobre el valor de salida en la zona
muerta.
Los cambios del valor real comprendidos dentro de la zona muerta no tienen efecto sobre el
valor de salida, independientemente de la ponderación.

Consulte también
Elección de la estructura del regulador con un sistema regulado definido (Página 660)

Puesta en servicio de PID_3Step V2
Optimización inicial V2
La optimización inicial determina el comportamiento del proceso a un impulso del valor de
salida y busca el punto de inflexión. A partir de la inclinación máxima y del tiempo muerto del
sistema regulado se calculan los parámetros PID óptimos. Para obtener los mejores
parámetros PID, debe efectuarse una optimización inicial y una optimización fina.
Cuanto más estable es el valor real, con mayor facilidad y precisión se pueden calcular los
parámetros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea
considerablemente mayor que el ruido. Esto tiene más probabilidades de suceder en los
modos "Inactivo" o "Manual". Es preciso realizar una copia de seguridad de los parámetros PID
antes de volver a calcularlos.
La consigna se congela durante la optimización inicial.

Requisitos
● La instrucción "PID_3Step" se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● Reset = FALSE
● El tiempo de posicionamiento del motor está configurado o medido.
● PID_3Step se encuentra en el modo de operación "Inactivo", "Modo manual" o "Modo
automático".
● La consigna y el valor real se encuentran dentro de los límites configurados (véase la
configuración "Configuración del valor real").

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

745

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimización inicial, proceda del siguiente modo:
1. Haga doble clic en la navegación del proyecto en la entrada "PID_3Step > Puesta en
servicio".
2. En la lista desplegable "Modo de optimización" del área de trabajo "Optimización"
seleccione la entrada "Optimización inicial".
3. Haga clic en el símbolo "Start".
– Se establece una conexión online.
– Se inicia el registro de los valores.
– Se inicia la optimización inicial.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Haga clic en el símbolo "Stop" cuando la barra de progreso haya alcanzado el 100% y
se deba presuponer un bloqueo de la optimización. Compruebe la configuración del
objeto tecnológico y, si procede, vuelva a iniciar la optimización.

Resultado
Si la optimización inicial ha finalizado sin ningún mensaje de error, significa que los parámetros
PID se han optimizado. PID_3Step cambia al modo automático y utiliza los parámetros
optimizados. Los parámetros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es posible realizar la optimización inicial, PID_3Step se comporta del modo configurado
en Comportamiento en caso de error.

Optimización fina V2
La optimización fina genera una oscilación constante y limitada del valor real. Los parámetros
PID se optimizan para el punto de operación a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular todos los parámetros PID. Los parámetros PID existentes
después de la optimización fina muestran en su mayoría un comportamiento de guía y ante
fallos mucho mejor que los parámetros PID de la optimización inicial. Para obtener los mejores
parámetros PID, debe efectuarse una optimización inicial y una optimización fina.
PID_3Step intenta generar automáticamente una oscilación que es mayor que el ruido del
valor real. La estabilidad del valor real ejerce tan sólo una mínima influencia sobre la
optimización fina. Es preciso realizar una copia de seguridad de los parámetros PID antes de
volver a calcularlos.
La consigna se congela durante la optimización fina.

746

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Requisitos
● La instrucción "PID_3Step" se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● Reset = FALSE
● El tiempo de posicionamiento del motor está configurado o medido.
● La consigna y el valor real se encuentran dentro de los límites configurados (véase la
configuración "Configuración del valor real").
● El lazo de regulación es estacionario en el punto de operación. El punto de operación se ha
alcanzado cuando el valor real coincide con la consigna.
● No se esperan perturbaciones.
● PID_3Step se encuentra en el modo de operación inactivo, automático o manual.

El proceso depende de la situación de inicio
La optimización fina se desarrolla del modo siguiente en el momento del inicio:
● Modo automático
Si desea mejorar los parámetros PID existentes mediante optimización, inicie la
optimización fina desde el modo automático.
PID_3Step regula con los parámetros PID existentes hasta que el lazo de regulación es
estacionario y se han cumplido las condiciones para una optimización fina. Sólo entonces
comienza la optimización fina.
● Inactivo o manual
Se realiza primero una optimización inicial. Con los parámetros PID calculados, la
regulación se realiza hasta que el lazo de regulación es estacionario y se han cumplido las
condiciones para una optimización fina. Sólo entonces comienza la optimización fina.

Procedimiento
Para poder realizar una optimización fina, proceda del siguiente modo:
1. En la lista desplegable "Modo de optimización" seleccione la entrada "Optimización fina".
2. Haga clic en el símbolo "Start".
– Se establece una conexión online.
– Se inicia el registro de los valores.
– Se inicia el proceso de optimización fina.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los errores
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de optimización" haga clic en el símbolo "Stop" cuando la barra de
progreso haya alcanzado el 100% y se deba presuponer un bloqueo de la optimización.
Compruebe la configuración del objeto tecnológico y, si procede, vuelva a iniciar la
optimización.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

747

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Resultado
Si durante la optimización fina no se producen errores, significa que los parámetros PID se han
optimizado. PID_3Step cambia al modo automático y utiliza los parámetros optimizados. Los
parámetros PID optimizados se conservan al desconectar (Power OFF) y al rearrancar por
completo la CPU.
Si se han producido errores durante la optimización fina, PID_3Step se comporta del modo
configurado en Comportamiento en caso de error.

Realizar la puesta en servicio con parámetros PID manuales V2
Requisitos
● La instrucción "PID_3Step" se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● Reset = FALSE
● El tiempo de posicionamiento del motor está configurado o medido.
● PID_3Step se encuentra en el modo de operación "Inactivo".
● La consigna y el valor real se encuentran dentro de los límites configurados (véase la
configuración "Configuración del valor real").

Procedimiento
Para poner en marcha PID_3Step con parámetros PID manuales, proceda del siguiente modo:
1. Haga doble clic en la navegación del proyecto en la entrada "PID_3Step" > Configuración".
2. En la ventana de configuración haga clic en "Ajustes avanzados > Parámetros PID".
3. Active la casilla de verificación "Activar entrada manual".
4. Introduzca los parámetros PID.
5. Haga doble clic en la navegación del proyecto en la entrada "PID_3Step > Puesta en
servicio".
6. Establezca una conexión online con la CPU.
7. Cargue los parámetros PID en la CPU.
8. Haga clic en el símbolo "Start PID_3Step".

Resultado
PID_3Step cambia al modo automático y realiza la regulación con los parámetros PID actuales.

Consulte también
Parámetros PID V2 (Página 742)

748

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Medir el tiempo de posicionamiento del motor V2
Introducción
PID_3Step necesita un tiempo de posicionamiento del motor lo más preciso posible para
alcanzar un buen resultado de regulación. Los datos de la documentación del elemento final
de control son valores medios para este tipo de elemento final de control. El valor puede variar
para el elemento final de control que se use en cada momento.
Si utiliza actuadores con realimentación de posición o con señales de tope, es posible medir
el tiempo de posicionamiento del motor durante la puesta en servicio. Los límites del valor de
salida no se tienen en cuenta durante la medición del tiempo de posicionamiento del motor. El
actuador puede desplazarse hasta el tope superior o inferior.
Si no se dispone de una realimentación de posición ni de señales de tope, no es posible medir
el tiempo de posicionamiento del motor.

Actuadores con realimentación de posición analógica
Para medir el tiempo de posicionamiento del motor con realimentación de posición, proceda
del siguiente modo:
Requisitos
● En la configuración básica se ha seleccionado Feedback o Feedback_PER y la señal se
interconecta.
● Se ha establecido una conexión online con la CPU.
1. Active la casilla de verificación "Utilizar realimentación de posición".
2. En el campo de entrada "Posición de destino" indique hacia dónde desea mover el
elemento final de control.
La realimentación de posición actual (posición de inicio) se muestra. La diferencia entre
"Posición de destino" y "Realimentación de posición" debe ser al menos el 50% del rango
admisible para el valor de salida.
3. Haga clic en el símbolo "Start".

Resultado
El elemento final de control se desplaza hasta la posición de destino desde la posición de
inicio. La medición del tiempo se inicia de inmediato y finaliza en cuanto el elemento final de
control ha alcanzado la posición de destino. El tiempo de posicionamiento del motor se calcula
según la fórmula:
Tiempo de posicionamiento del motor = (Límite superior del valor de salida - Límite inferior del
valor de salida) x Tiempo de medición /VALOR ABSOLUTO(Posición de destino - Posición de
inicio).
Se muestran el progreso y el estado de la medición del tiempo de posicionamiento. El tiempo
de posicionamiento medido se almacena en el bloque de datos de instancia de la CPU y se
muestra en el campo "Tiempo de actuación medido" Si ha finalizado la medición del tiempo de
posicionamiento y ActivateRecoverMode = TRUE, PID_3Step pasa al modo desde el que se

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

749

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
inició la medición. Si ha finalizado la medición del tiempo de posicionamiento y
ActivateRecoverMode = FALSE, PID_3Step pasa al modo de operación "Inactivo".
Nota
Para adoptar el tiempo de posicionamiento del motor medido en el proyecto, haga clic en el
icono
"Cargar tiempo pos. medido".

Actuadores con señales de tope
Para medir el tiempo de posicionamiento de los actuadores con señales de tope, proceda del
siguiente modo:
Requisitos
● En la configuración básica la casilla de verificación "Señales de tope" está activada y los
actuadores H y L están interconectados.
● Se ha establecido una conexión online con la CPU.
Para medir el tiempo de posicionamiento del motor con señales de tope, proceda del siguiente
modo:
1. Active la casilla de verificación "Utilizar señales de tope del actuador".
2. Seleccione el sentido en el que desee mover el elemento final de control.
– Abrir - Cerrar - Abrir
El elemento final de control se mueve primero hasta el tope superior, después, hasta el
tope inferior y, de nuevo, hasta el tope superior.
– Cerrar - Abrir - Cerrar
El elemento final de control se mueve primero hasta el tope inferior, después, hasta el
tope superior y, de nuevo, hasta el tope inferior.
3. Haga clic en el símbolo "Start".

Resultado
El elemento final de control se mueve en el sentido seleccionado. La medición del tiempo se
inicia cuando el elemento final de control ha alcanzado el primer tope y finaliza cuando el
elemento final de control alcanza este tope por segunda vez. El tiempo medido dividido entre
dos da lugar al tiempo de posicionamiento del motor.
Se muestran el progreso y el estado de la medición del tiempo de posicionamiento. El tiempo
de posicionamiento medido se almacena en el bloque de datos de instancia de la CPU y se
muestra en el campo "Tiempo de actuación medido" Si ha finalizado la medición del tiempo de
posicionamiento y ActivateRecoverMode = TRUE, PID_3Step pasa al modo desde el que se
inició la medición. Si ha finalizado la medición del tiempo de posicionamiento y
ActivateRecoverMode = FALSE, PID_3Step pasa al modo de operación "Inactivo".

Cancelar medición del tiempo de posicionamiento
Una vez cancelada la medición del tiempo de posicionamiento con el botón Stop, PID_3Step
cambia al modo de operación "Inactivo".

750

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Simulación de PID_3Step V2 con PLCSIM
Nota
Simulación con PLCSIM
La simulación de PID_3Step V2.x con PLCSIM para CPU S7-1200 no se soporta.
PID_3Step V2.x solo puede simularse con PLCSIM para CPU S7-1500.
En la simulación con PLCSIM, el comportamiento temporal del PLC simulado no es idéntico al
de un PLC "auténtico". El verdadero ciclo de un OB de alarma cíclica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "auténtico".
En la configuración estándar, PID_3Step determina automáticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_3Step con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
Esto provoca la cancelación de las optimizaciones en curso.
La reacción en el modo automático depende del valor de la variable ActivateRecoverMode.
Para evitarlo, debe configurarse PID_3Step en la simulación con PLCSIM del modo siguiente:
● CycleTime.EnEstimation = FALSE
● CycleTime.EnMonitoring = FALSE
● CycleTime.Value: Asigne a estas variables el ciclo del OB de alarma cíclica que se debe
llamar en la unidad segundos.

3.3.2.3

PID_3Step V1

Configuración de PID_3Step V1
Ajustes básicos V1
Introducción V1
Configure las propiedades siguientes del objeto tecnológico PID_3Step en el área de ajustes
básicos de la ventana de inspección o de configuración.
● Magnitud física
● Sentido de regulación
● Comportamiento en arranque tras un reset
● Consigna (sólo en la ventana de inspección)
● Valor real (sólo en la ventana de inspección)
● Valor de salida (sólo en la ventana de inspección)
● Realimentación de posición (sólo en la ventana de inspección)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

751

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Consigna, valor real, valor de salida y realimentación de posición
La consigna, el valor real, el valor de salida y la realimentación de posición sólo pueden
configurarse en la ventana de inspección del editor de programación. Para cada valor elija el
origen:
● DB de instancia
Se utiliza el valor que se encuentra almacenado en el DB de instancia.
El valor debe actualizarse en el DB de instancia del programa de usuario.
En la instrucción no puede haber ningún valor.
Modificación posible desde HMI.
● Instrucción
Se utiliza el valor que se interconecta a la instrucción.
Cada vez que se llama la instrucción, el valor se escribe en el DB de instancia.
No se puede modificar desde HMI.

Tipo de regulación V1
Magnitud física
En el grupo "Tipo de regulación" seleccione la magnitud física y la unidad de la consigna y el
valor real. La consigna y el valor real se muestran en esta unidad.

Sentido de regulación
Por lo general, un aumento del valor de salida debe lograr un aumento del valor real. En este
caso, se habla de un sentido de regulación normal.
PID_3Step no funciona con ganancia proporcional negativa. Para reducir el valor real con un
valor de salida más elevado, active la casilla de verificación "Inversión sentido de regulación".
Ejemplos
● Al abrir una válvula de escape se reduce el nivel de llenado de un recipiente.
● Si se aumenta la potencia de refrigeración, disminuye la temperatura.

Comportamiento en arranque tras un reset
Para cambiar inmediatamente al último modo de operación activo tras un rearranque completo
de la CPU, active la casilla de verificación "Activar último modo de operación después del
rearranque de la CPU".
Si la casilla de verificación está desactivada, PID_3Step se queda en el modo de operación
"Inactivo".

752

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Consigna V1
Procedimiento
Para especificar una consigna fija, proceda del siguiente modo:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 °C.
3. En caso necesario, elimine una entrada de la instrucción.
Para especificar una consigna variable, proceda del siguiente modo:
1. Seleccione "Instrucción".
2. Indique el nombre de la variable REAL en la que está almacenada la consigna.
Es posible asignar varios valores de forma controlada por programa a la variable REAL
para, por ejemplo, modificar la consigna de tiempo de forma controlada.

Valor real V1
Si utiliza directamente el valor de la entrada analógica, PID_3Step escala el valor de la entrada
analógica al tamaño físico.
Si desea acondicionar primero el valor de la entrada analógica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada analógica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada analógica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucción" como fuente.
3. Introduzca la dirección de la entrada analógica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucción" como fuente.
3. Indique el nombre de la variable en la que está almacenado el valor real acondicionado.

Realimentación de posición V1
La configuración de la realimentación de posición depende del elemento final de control
utilizado.
● Actuador sin realimentación de posición
● Elemento final de control con señales de tope digitales

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

753

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
● Actuador con realimentación de posición analógica
● Actuador con realimentación de posición analógico y señales de tope

Elemento final de control sin realimentación de posición
Para configurar PID_3Step para un elemento final de control sin realimentación de posición,
proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "No Feedback".

Elemento final de control con señales de tope digitales
Para configurar PID_3Step para un elemento final de control con señales de tope, proceda del
siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "No Feedback".
2. Active la casilla de verificación "Señal tope del actuador".
3. Seleccione "Instrucción" como fuente para Actuator_H y Actuator_L.
4. Introduzca las direcciones de las entradas digitales para Actuator_H y Actuator_L.

Elemento final de control con realimentación de posición analógica
Para configurar PID_3Step para un elemento final de control con realimentación de posición
analógica, proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "Feedback" o "Feedback_PER".
– En Feedback_PER utilice el valor de la entrada analógica. El escalado de
Feedback_PER se configura en la configuración del elemento final de control.
– En Feedback procese el valor de la entrada analógica a través de su programa de
usuario.
2. Seleccione "Instrucción" como fuente.
3. Introduzca la dirección de la entrada analógica o la variable de su programa de usuario.

Elemento final de control con realimentación de posición analógica y señales de tope
Para configurar PID_3Step para un elemento final de control con realimentación de posición
analógica y señales de tope, proceda del siguiente modo:
1. En la lista desplegable "Feedback", seleccione la entrada "Feedback" o "Feedback_PER".
2. Seleccione "Instrucción" como fuente.
3. Introduzca la dirección de la entrada analógica o la variable de su programa de usuario.
4. Active la casilla de verificación "Señal tope del actuador".
5. Seleccione "Instrucción" como fuente para Actuator_H y Actuator_L.
6. Introduzca las direcciones de las entradas digitales para Actuator_H y Actuator_L.

754

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Valor de salida V1
PID_3Step ofrece un valor de salida analógico (Output_PER) y valores de salida digitales
(Output_UP, Output_DN). El valor de salida que se utilice dependerá del actuador.
● Output_PER
El actuador dispone de un tiempo de posicionamiento del motor relevante, se activa a
través de una salida analógica y se controla con una señal continua, como puede ser 0 a
10 V, 4 a 20 mA. El valor de Output_PER se corresponde con la posición de destino de la
válvula, p. ej., Output_PER = 13824, cuando la válvula debe abrirse hasta un 50 %.
PID_3Step tiene en cuenta, p. ej., para la optimización automática y el comportamiento AntiWindup, que el valor de salida analógico actúa en el proceso con un retardo debido al
tiempo de posicionamiento del motor. Si en su proceso no actúa ningún tiempo de
posicionamiento del motor relevante (p. ej., con electroválvulas), de forma que el valor de
salida actúa directamente y en toda su magnitud sobre el proceso, utilice PID_Compact en
su lugar.
● Output_UP, Output_DN
El actuador dispone de un tiempo de posicionamiento del motor relevante y se controla
mediante dos salidas digitales.
Output_UP desplaza la válvula hacia el estado abierto.
Output_DN desplaza la válvula hacia el estado cerrado.
El tiempo de posicionamiento del motor se tiene en cuenta tanto en el cálculo del valor de
salida analógico como en el cálculo de los valores de salida digitales. Es necesario para el
correcto funcionamiento, sobre todo, durante la optimización automática y el comportamiento
Anti-Windup. Por tanto, configure el tiempo de posicionamiento del motor en "Ajustes del
actuador" con el valor que requiere el motor para desplazar el actuador del estado cerrado al
estado abierto.

Procedimiento
Para utilizar el valor de salida analógico, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada Output (analógica).
2. Seleccione "Instrucción".
3. Introduzca la dirección de la salida analógica.
Para utilizar el valor de salida digital, proceda del siguiente modo:
1. En la lista desplegable "Output", seleccione la entrada "Output (digital)".
2. Seleccione "Instrucción" para Output_UP y Output_DN.
3. Introduzca las direcciones de las salidas digitales.
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "Output" seleccione la entrada adecuada al actuador.
2. Seleccione "Instrucción".
3. Indique el nombre de la variable que utilizará para acondicionar el valor de salida.
4. Transfiera el valor de salida acondicionado hasta el actuador a través de una salida
analógica o digital de la CPU.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

755

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Ajuste de valor real V1
Configure la normalización del valor real en la ventana de configuración "Ajustes del valor real"
y fije los límites absolutos del valor real.

Escalar valor real
Si en los ajustes básicos se ha elegido el uso de Input_PER, el valor de la entrada analógica
debe convertirse en el tamaño físico del valor real. En el cuadro de visualización Input_PER se
muestra la configuración actual.
Si el valor real es directamente proporcional al valor de la entrada analógica, Input_PER se
escala a partir de una pareja de valores inferiores y superiores.
1. En los campos de entrada "Valor real inferior escalado" y "Abajo" introduzca la pareja de
valores inferior.
2. En los campos de entrada "Valor real superior escalado" y "arriba", introduzca el par de
valores superior.
La configuración hardware incluye una configuración predeterminada de las parejas de
valores. Para utilizar los pares de valores a partir de la configuración hardware, proceda del
siguiente modo:
1. Marque la instrucción PID_3Step en el editor de programación.
2. En los ajustes básicos, interconecte Input_PER con una entrada analógica.
3. En los ajustes del valor real, haga clic en el botón "Ajuste automático".
Los valores existentes se sobrescriben con los valores de la configuración hardware.

Monitorizar el valor real
Defina los límites absolutos superior e inferior del valor real. Como límites, se deben introducir
valores razonables para el sistema regulado. Durante la optimización es importante disponer
de valores límite razonables para obtener los parámetros PID óptimos. La preasignación del
"Límite superior del valor real" es 120%. En la entrada de periferia, el valor real puede
encontrarse como máximo un 18% por encima del rango normalizado (margen de saturación).
No se comunica ningún error más con este ajuste debido al rebase por exceso del "Límite
superior del valor real". Únicamente se detectan la rotura de hilo y el cortocircuito y PID_3Step
se comporta según la reacción configurada en caso de error.
ATENCIÓN
Su instalación puede sufrir daños.
Si ajusta valores muy altos (z. B. -3,4*1038...+3,4*1038) como límites del valor real, se
desactiva la monitorización del valor real. Esto puede dar lugar a daños en la instalación.
Configure límites del valor real razonables para su sistema regulado.

756

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Ajuste de actuador V1
Tiempos específicos del actuador
Para proteger el elemento final de control frente a daños, ajuste el tiempo de posicionamiento
del motor y los tiempos mínimos de conexión y desconexión. Los datos figuran en la hoja de
datos del elemento final de control.
El tiempo de posicionamiento del motor es el tiempo en segundos que requiere el motor para
desplazar el elemento final de control del estado cerrado al estado abierto. El actuador se
mueve en un sentido a como máximo el 110 % del tiempo de posicionamiento del motor. El
tiempo de posicionamiento del motor puede medirse durante la puesta en servicio.
El tiempo de posicionamiento del motor se tiene en cuenta tanto en el cálculo del valor de
salida analógico como en el cálculo de los valores de salida digitales. Es necesario para el
correcto funcionamiento, sobre todo, durante la optimización automática y el comportamiento
Anti-Windup.
Si en su proceso no actúa ningún tiempo de posicionamiento del motor relevante (p. ej., con
electroválvulas), de forma que el valor de salida actúa directamente y en toda su magnitud
sobre el proceso, utilice PID_Compact en su lugar.
Si se utiliza Output_UP y Output_DN, debe reducirse la frecuencia de conmutación con los
tiempos mínimos de conexión y desconexión.
En el modo automático se acumulan los tiempos calculados de conexión y desconexión y estos
no surten efecto hasta que la suma sea igual o superior al tiempo mínimo de conexión o
desconexión.
En el modo manual, un flanco ascendente en Manual_UP o Manual_DN permite controlar el
elemento final de control al menos en el tiempo mínimo de conexión o desconexión.
Si en los ajustes básicos ha elegido el valor analógico de salida Output_PER, el tiempo de
conexión mínimo y el tiempo de desconexión mínimo no se evalúan ni se pueden modificar.

Comportamiento en caso de error
PID_3Step está preajustado de manera que, en caso de error, la regulación permanece activa
en la mayoría de los casos. Si en el modo de regulación se producen errores con frecuencia,
este ajuste empeorará el comportamiento de regulación. Compruebe en tal caso el parámetro
Errorbits y elimine la causa de error.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

757

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
En caso de error, PID_3Step emite un valor de salida configurable:
● Valor actual
PID_3Step está desconectado y ya no modifica la posición del elemento final de control.
● Valor actual para la duración del error
Las funciones de regulación de PID_3Step están desactivadas y ya no se modifica la
posición del elemento final de control.
Si se producen los siguientes errores en el modo automático, PID_3Step regresa a dicho
modo en cuanto los errores en cuestión dejan de existir.
– 0002h: Valor no válido en el parámetro Input_PER.
– 0200h: Valor no válido en el parámetro Input.
– 0800h: Error en tiempo de muestreo
– 1000h: Valor no válido en el parámetro Setpoint.
– 2000h: Valor no válido en el parámetro Feedback_PER.
– 4000h: Valor no válido en el parámetro Feedback.
– 8000h: Error en la realimentación digital de posición.
Si aparece alguno de los errores siguientes en el modo manual, PID_3Step permanece en
dicho modo.
Si se produce un error durante la optimización o durante la medición del tiempo de
posicionamiento, PID_3Step se desconecta.
● Valor de salida sustitutivo
PID_3Step desplaza el elemento final de control (actuador) al valor de salida sustitutivo y
se desconecta.
● Valor de salida sustitutivo mientras dure el error
PID_3Step desplaza el elemento final de control (actuador) al valor de salida sustitutivo.
Una vez alcanzado el valor de salida sustitutivo, PID_3Step se comporta como se describe
en "Valor actual mientras dure el error".
El valor de salida sustitutivo se introduce en "%".
En los actuadores sin realimentación de posición analógica, solo es posible aproximar de
forma exacta los valores de salida sustitutivos 0% y 100%. Para poder alcanzar el tope superior
e inferior, el elemento final de control se desplaza en un sentido con un 110% del tiempo de
posicionamiento del motor. Las señales de tope tienen prioridad. Un valor de salida sustitutivo
diferente del 0% o del 100% se aproxima a través de una realimentación de posición simulada
internamente. Sin embargo, con este procedimiento el valor de salida sustitutivo no podrá
aproximarse nunca de forma exacta.
En los actuadores con realimentación de posición analógica, es posible aproximar de forma
exacta todos los valores de salida sustitutivos.

Escalar realimentación de posición
Si con el ajuste básico se ha elegido el uso de Feedback_PER, el valor de la entrada analógica
debe convertirse en %. En el cuadro de visualización "Feedback" se muestra el ajuste actual.

758

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Feedback_PER se escala a partir de una pareja de valores inferiores y superiores.
1. En los campos de entrada "Tope inferior" y "Abajo" introduzca la pareja de valores
inferiores.
2. En los campos de entrada "Tope superior" y "Arriba" introduzca la pareja de valores
superiores.
El valor de "Tope inferior" debe ser inferior al de "Tope superior"; por su parte, "Abajo" debe ser
inferior a "Arriba".
Los valores válidos para el "Tope superior" y el "Tope inferior" dependen de:
● Sin Feedback, Feedback, Feedback_PER
● Output (analógico), Output (digital)
Output

Feedback

Tope inferior

Tope superior

Output (digital)

Sin Feedback

No ajustable (0.0 %)

No ajustable (100.0 %)

Output (digital)

Feedback

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (digital)

Feedback_PER

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (analógico)

Sin Feedback

No ajustable (0.0 %)

No ajustable (100.0 %)

Output (analógico)

Feedback

-100.0 % o 0.0 %

0.0 % o +100.0 %

Output (analógico)

Feedback_PER

-100.0 % o 0.0 %

0.0 % o +100.0 %

Limitar el valor de salida
Los límites del valor de salida solo pueden rebasarse por exceso o por defecto durante la
medición del tiempo de posicionamiento. En los demás modos de operación, el valor de salida
se limita a estos valores.
Introduzca en los campos de entrada "Lím. sup. v. de salida" y "Lím. inf. v. de salida" los límites
absolutos del valor de salida. Los límites del valor de salida deben encontrarse dentro del
"Tope inferior" o el "Tope superior".
Si no hay ningún Feedback y se ha ajustado Output (digital), el valor de salida no se puede
limitar. Las salidas digitales deben desactivarse en Actuator_H = TRUE o Actuator_L = TRUE
o después de un tiempo de desplazamiento del 110% del tiempo de posicionamiento del motor.

Ajustes avanzados V1
Vigilancia valor real V1
Configure un límite de advertencia inferior y uno superior para el valor real en la ventana de
configuración "Monitorización del valor real". Si durante el funcionamiento se rebasa uno de los
límites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucción
"PID_3Step".
● En el parámetro de salida "InputWarning_H", si se ha rebasado por exceso el límite superior
de advertencia.
● En el parámetro de salida "InputWarning_L", si se ha rebasado por defecto el límite inferior
de advertencia.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

759

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Los límites de advertencia deben encontrarse dentro de los límites superior e inferior del valor
real.
Si no introduce ningún valor, se utilizan los límites superior e inferior del valor real.

Ejemplo
Límite superior del valor real = 98 °C; límite superior de advertencia = 90 °C
Límite inferior de advertencia = 10 ℃; límite inferior del valor real = 0 ℃
PID_3Step se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

Modo de operación

> 98 °C

TRUE

FALSE

Inactivo

≤ 98 °C y > 90 °C

TRUE

FALSE

Modo automático

≤ 90 °C y ≥ 10 °C

FALSE

FALSE

Modo automático

< 10°C y ≥ 0 °C

FALSE

TRUE

Modo automático

< 0 °C

FALSE

TRUE

Inactivo

Parámetros PID V1
En la ventana de configuración "Parámetros PID" se visualizan los parámetros PID. Durante la
optimización los parámetros PID se adaptan al sistema regulado. No es necesario introducir
los parámetros PID de forma manual.
Nota
Los parámetros PID efectivos actualmente están en la estructura Retain.CtrlParams.
Para prevenir un comportamiento erróneo del regulador PID, los parámetros PID efectivos
actualmente solo deben modificarse online en el modo de operación "Inactivo".
Si desea modificar online los parámetros PID en los modos de operación "Automático" o
"Manual", modifique los parámetros PID en la estructura CtrlParamsBackUp y aplique los
cambios en la estructura Retain.CtrlParams, del siguiente modo:
● PID_3Step V1: Aplique los cambios poniendo Config.LoadBackUp = TRUE
● PID_3Step V2: Aplique los cambios poniendo LoadBackUp = TRUE
Los cambios online en los parámetros PID realizados en el modo de operación "Automático"
pueden provocar saltos en el valor de salida.
El algoritmo PID funciona de acuerdo con la siguiente fórmula:

760

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
1

[

Δ y = K p · s · (b · w - x) +

TI · s

(w - x) +

TD · s
a · TD · s + 1

(c · w - x)

]

Δy

Valor de salida del algoritmo PID

Kp

Ganancia proporcional

s

Operador laplaciano

b

Ponderación de la acción P

w

Consigna

x

Valor real

TI

Tiempo de integración

a

Coeficiente para el retardo de la acción derivada (retardo de la acción derivada T1 = a × TD)

TD

Tiempo derivativo

c

Ponderación de la acción D

El gráfico siguiente muestra cómo entran los parámetros en el algoritmo PID.
E

6HWSRLQW Z



'7

F

'

.

3

˂\



'HDGB%





7L

,

6FDOHG,QSXW [
)DF7W

$QWL:LQGXS

Todos los parámetros PID son remanentes. Si introduce manualmente los parámetros PID,
debe cargar PID_3Step por completo.
Cargar objetos tecnológicos en el dispositivo (Página 667)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_3Step no funciona con una
ganancia proporcional negativa. El sentido de regulación se invierte en Ajustes básicos > Tipo
de regulación.

Tiempo de integración
El tiempo de integración determina el comportamiento temporal de la acción I. La desconexión
de la acción I se realiza con el tiempo de integración = 0,0. Si el tiempo de integración se
modifica online en el modo de operación "Automático" de un valor cualquiera a 0.0, la acción
I actual se borra y se produce un salto del valor de salida.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

761

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Tiempo derivativo
El tiempo de la acción derivada determina el comportamiento temporal de la acción D. La
desconexión de la acción D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acción derivada
El efecto de la acción D se retrasa mediante el coeficiente de retardo de la acción derivada.
Retardo de la acción derivada = Tiempo derivativo x coeficiente de retardo de la acción
derivada
● 0.0: la acción D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
● 0.5: Este valor se ha acreditado en la práctica para sistemas regulados con una constante
de tiempo dominante.
● > 1.0: Cuanto mayor sea el coeficiente, más se retrasará el efecto de la acción D.

Ponderación de la acción P
En el caso de que se modifique la consigna, es posible atenuar la acción P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción P es totalmente efectiva al cambiar la consigna
● 0.0: La acción P no es efectiva al cambiar la consigna
Si se produce una modificación del valor real, la acción P es totalmente efectiva.

Ponderación de la acción D
En el caso de que se modifique la consigna, es posible atenuar la acción D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción D es totalmente efectiva cuando se cambia la consigna.
● 0.0: la acción D no es efectiva cuando cambia la consigna.
Si se produce una modificación del valor real, la acción D es totalmente efectiva.

Tiempo de muestreo algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo del algoritmo
PID es el tiempo entre dos cálculos del valor de salida. Este se determina durante la
optimización y se redondea a un múltiplo del tiempo de muestreo PID_3Step. Todas las demás
funciones de PID_3Step se ejecutan con cada llamada.

Ancho de zona muerta
La zona muerta suprime los niveles del ruido en el estado estabilizado del regulador. El ancho
de zona muerta indica el tamaño de la zona muerta. Con un ancho de zona muerta de 0.0, la
zona muerta se encuentra desactivada.

762

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Si para la ponderación de la acción P o de la acción D se han configurado valores diferentes
de 1.0, los cambios de la consigna también tendrán efecto sobre el valor de salida en la zona
muerta.
Los cambios del valor real comprendidos dentro de la zona muerta no tienen efecto sobre el
valor de salida, independientemente de la ponderación.

Consulte también
Elección de la estructura del regulador con un sistema regulado definido (Página 660)

Puesta en servicio de PID_3Step V1
Puesta en servicio V1
En la zona de trabajo "Optimización" es posible observar la consigna, el valor real y el valor de
salida en función del tiempo. En el registrador de curvas se soportan las siguientes funciones
de puesta en servicio:
● Optimización inicial del regulador
● Optimización fina del regulador
● Observación de la regulación en curso en la ventana de curvas
Para todas las funciones es preciso realizar una conexión online a la CPU.

Principios básicos del manejo
● Seleccione el tiempo de actualización que desee en la lista desplegable "Tiempo de
actualización".
Todos los valores del área de trabajo de optimización se actualizan en el tiempo de
actualización seleccionado.
● Haga clic en el botón "Inicio" en el grupo Medición si desea utilizar las funciones de puesta
en servicio.
Se inicia el registro de los valores. En el visor de curvas se registran los valores actuales de
consigna, valor real y valor de salida. Se habilita el manejo de la ventana de puesta en
servicio.
● Haga clic en el botón "Parar" si desea finalizar las funciones de puesta en servicio.
Los valores mostrados en el visor de curvas pueden continuar analizándose.
● Al cerrar la ventana de puesta en servicio finaliza el registro en el visor de curvas y los
valores registrados se borran.

Optimización inicial V1
La optimización inicial determina el comportamiento del proceso a un impulso del valor de
salida y busca el punto de inflexión. A partir de la inclinación máxima y del tiempo muerto del
sistema regulado se calculan los parámetros PID óptimos.
Cuanto más estable es el valor real, con mayor facilidad y precisión se pueden calcular los
parámetros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

763

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
considerablemente mayor que el ruido. Es preciso realizar una copia de seguridad de los
parámetros PID antes de volver a calcularlos.
La consigna se congela durante la optimización inicial.

Requisitos
● La instrucción "PID_3Step" se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● PID_3Step se encuentra en el modo de operación "Inactivo" o "Manual".
● La consigna y el valor real se encuentran dentro de los límites configurados (véase la
configuración "Configuración del valor real").

Procedimiento
Para poder realizar una optimización inicial, proceda del siguiente modo:
1. Haga doble clic en la navegación del proyecto en la entrada "PID_3Step > Puesta en
servicio".
2. En la lista desplegable "Modo de optimización" del área de trabajo "Optimización"
seleccione la entrada "Optimización inicial".
3. Haga clic en el símbolo "Start".
– Se establece una conexión online.
– Se inicia el registro de los valores.
– Se inicia la optimización inicial.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los fallos
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Haga clic en el símbolo "Stop" cuando la barra de progreso haya alcanzado el 100% y
se deba presuponer un bloqueo de la optimización. Compruebe la configuración del
objeto tecnológico y, si procede, vuelva a iniciar la optimización.

Resultado
Si la optimización inicial ha finalizado sin ningún mensaje de error, significa que los parámetros
PID se han optimizado. PID_3Step cambia al modo automático y utiliza los parámetros
optimizados. Los parámetros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es posible realizar la optimización inicial, PID_3Step cambia al modo de operación
"Inactivo".

764

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Optimización fina V1
La optimización fina genera una oscilación constante y limitada del valor real. Los parámetros
PID se optimizan para el punto de operación a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular todos los parámetros PID. Los parámetros PID existentes
después de la optimización fina muestran en su mayoría un comportamiento de guía y ante
fallos mucho mejor que los parámetros PID de la optimización inicial.
PID_3Step intenta generar automáticamente una oscilación que es mayor que el ruido del
valor real. La estabilidad del valor real ejerce tan sólo una mínima influencia sobre la
optimización fina. Es preciso realizar una copia de seguridad de los parámetros PID antes de
volver a calcularlos.
La consigna se congela durante la optimización fina.

Requisitos
● La instrucción PID_3Step se llama en un OB se alarma cíclica.
● ManualEnable = FALSE
● El tiempo de posicionamiento del motor está configurado o medido.
● La consigna y el valor real se encuentran dentro de los límites configurados (véase la
configuración "Configuración del valor real").
● El lazo de regulación es estacionario en el punto de operación. El punto de operación se ha
alcanzado cuando el valor real coincide con la consigna.
● No se esperan perturbaciones.
● PID_3Step se encuentra en el modo de operación inactivo, automático o manual.

El proceso depende de la situación de inicio
La optimización fina se desarrolla del modo siguiente en el momento del inicio:
● Modo automático
Si desea mejorar los parámetros PID existentes mediatne optimización, inicie la
optimización fina desde el modo automático.
PID_3Step regula con los parámetros PID existentes hasta que el lazo de regulación es
estacionario y se han cumplido las condiciones para una optimización fina. Sólo entonces
comienza la optimización fina.
● Inactivo o manual
Se realiza primero una optimización inicial. Con los parámetros PID calculados, la
regulación se realiza hasta que el lazo de regulación es estacionario y se han cumplido las
condiciones para una optimización fina. Sólo entonces comienza la optimización fina.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

765

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Procedimiento
Para poder realizar una optimización fina, proceda del siguiente modo:
1. En la lista desplegable "Modo de optimización" seleccione la entrada "Optimización fina".
2. Haga clic en el símbolo "Start".
– Se establece una conexión online.
– Se inicia el registro de los valores.
– Se inicia el proceso de optimización fina.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los errores
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de optimización" haga clic en el símbolo "Stop" cuando la barra de
progreso haya alcanzado el 100% y se deba presuponer un bloqueo de la optimización.
Compruebe la configuración del objeto tecnológico y, si procede, vuelva a iniciar la
optimización.

Resultado
Si la optimización fina ha finalizado sin ningún mensaje de error, significa que los parámetros
PID se han optimizado. PID_3Step cambia al modo automático y utiliza los parámetros
optimizados. Los parámetros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si se produjeran errores durante la optimización fina, PID_3Step cambia al modo de operación
"Inactivo".

Realizar la puesta en servicio con parámetros PID manuales V1
Procedimiento
Para poner en marcha PID_3Step con parámetros PID manuales, proceda del siguiente modo:
1. Haga doble clic en la navegación del proyecto en la entrada "PID_3Step" > Configuración".
2. En la ventana de configuración haga clic en "Ajustes avanzados > Parámetros PID".
3. Active la casilla de verificación "Activar entrada manual".
4. Introduzca los parámetros PID.
5. Haga doble clic en la navegación del proyecto en la entrada "PID_3Step" > Puesta en
servicio".
6. Establezca una conexión online con la CPU.
7. Cargue los parámetros PID en la CPU.
8. Haga clic en el símbolo "Activar regulador".

766

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Resultado
PID_3Step cambia al modo automático y realiza la regulación con los parámetros PID actuales.

Medir el tiempo de posicionamiento del motor V1
Introducción
PID_3Step necesita un tiempo de posicionamiento del motor lo más preciso posible para
alcanzar un buen resultado de regulación. Los datos de la documentación del elemento final
de control son valores medios para este tipo de elemento final de control. El valor puede variar
para el elemento final de control que se use en cada momento.
Si utiliza actuadores con realimentación de posición o con señales de tope, es posible medir
el tiempo de posicionamiento del motor durante la puesta en servicio. Los límites del valor de
salida no se tienen en cuenta durante la medición del tiempo de posicionamiento del motor. El
actuador puede desplazarse hasta el tope superior o inferior.
Si no se dispone de una realimentación de posición ni de señales de tope, no es posible medir
el tiempo de posicionamiento del motor.

Actuadores con realimentación de posición analógica
Para medir el tiempo de posicionamiento del motor con realimentación de posición, proceda
del siguiente modo:
Requisitos
● En la configuración básica se ha seleccionado Feedback o Feedback_PER y la señal se
interconecta.
● Se ha establecido una conexión online con la CPU.
1. Active la casilla de verificación "Utilizar realimentación de posición".
2. En el campo de entrada "Posición de destino" indique hacia dónde desea mover el
elemento final de control.
La realimentación de posición actual (posición de inicio) se muestra. La diferencia entre
"Posición de destino" y "Realimentación de posición" debe ser al menos el 50% del rango
admisible para el valor de salida.
3. Haga clic en el botón

"Iniciar medición tiempo de posicionamiento".

Resultado
El elemento final de control se desplaza hasta la posición de destino desde la posición de
inicio. La medición del tiempo se inicia de inmediato y finaliza en cuanto el elemento final de
control ha alcanzado la posición de destino. El tiempo de posicionamiento del motor se calcula
según la fórmula:
Tiempo de posicionamiento del motor = (Límite superior del valor de salida - Límite inferior del
valor de salida) x Tiempo de medición /VALOR ABSOLUTO(Posición de destino - Posición de
inicio).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

767

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Se muestran el progreso y el estado de la medición del tiempo de posicionamiento. El tiempo
de posicionamiento medido se almacena en el bloque de datos de instancia de la CPU y se
muestra en el campo "Tiempo de actuación medido" Una vez finalizada la medición del tiempo
de posicionamiento, PID_3Step cambia al modo de operación "Inactivo".
Nota
Para adoptar el tiempo de posicionamiento del motor medido en el proyecto, haga clic en el
icono
"Cargar tiempo pos. medido".

Actuadores con señales de tope
Para medir el tiempo de posicionamiento de los actuadores con señales de tope, proceda del
siguiente modo:
Requisitos
● En la configuración básica la casilla de verificación "Señales de tope" está activada y los
actuadores H y L están interconectados.
● Se ha establecido una conexión online con la CPU.
Para medir el tiempo de posicionamiento del motor con señales de tope, proceda del siguiente
modo:
1. Active la casilla de verificación "Utilizar señales de tope del actuador".
2. Seleccione el sentido en el que desee mover el elemento final de control.
– Abrir - Cerrar - Abrir
El elemento final de control se mueve primero hasta el tope superior, después, hasta el
tope inferior y, de nuevo, hasta el tope superior.
– Cerrar - Abrir - Cerrar
El elemento final de control se mueve primero hasta el tope inferior, después, hasta el
tope superior y, de nuevo, hasta el tope inferior.
3. Haga clic en el botón

"Iniciar medición tiempo de posicionamiento".

Resultado
El elemento final de control se mueve en el sentido seleccionado. La medición del tiempo se
inicia cuando el elemento final de control ha alcanzado el primer tope y finaliza cuando el
elemento final de control alcanza este tope por segunda vez. El tiempo medido dividido entre
dos da lugar al tiempo de posicionamiento del motor.
Se muestran el progreso y el estado de la medición del tiempo de posicionamiento. El tiempo
de posicionamiento medido se almacena en el bloque de datos de instancia de la CPU y se
muestra en el campo "Tiempo de actuación medido" Una vez finalizada la medición del tiempo
de posicionamiento, PID_3Step cambia al modo de operación "Inactivo".

768

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Cancelar medición del tiempo de posicionamiento
Una vez finalizada la medición del tiempo de posicionamiento, PID_3Step cambia de
inmediato al modo de operación "Inactivo". El elemento final de control deja de moverse. Es
posible volver a activar PID-3Step en el registrador de curvas.

Simulación de PID_3Step V1 con PLCSIM
Nota
Simulación con PLCSIM
En la simulación con PLCSIM, el comportamiento temporal del PLC simulado no es idéntico al
de un PLC "auténtico". El verdadero ciclo de un OB de alarma cíclica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "auténtico".
En la configuración estándar, PID_3Step determina automáticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_3Step con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
Esto provoca la cancelación de las optimizaciones en curso.
La reacción en el modo automático depende del valor de la variable ActivateRecoverMode.
Para evitarlo, debe configurarse PID_3Step en la simulación con PLCSIM del modo siguiente:
● CycleTime.EnEstimation = FALSE
● CycleTime.EnMonitoring = FALSE
● CycleTime.Value: Asigne a estas variables el ciclo del OB de alarma cíclica que se debe
llamar en la unidad segundos.

3.3.3

Utilizar PID_Temp

3.3.3.1

Objeto tecnológico PID_Temp
El objeto tecnológico PID_Temp ofrece un regulador PID continuo con optimización integrada.
PID_Temp está diseñado especialmente para regular la temperatura y es apto para
aplicaciones de calefacción o calefacción/refrigeración. Para ello se dispone de dos salidas,
una para calefacción y otra para refrigeración. Además, PID_Temp también se puede utilizar
para otras tareas de regulación. PID_Temp puede conectarse en cascada y emplearse en
modo manual o en modo automático.
PID_Temp captura de forma continua el valor real medido dentro de un lazo de regulación y lo
compara con la consigna ajustada. A partir de los errores de regulación que se producen, la
instrucción PID_Temp calcula el valor de salida para la calefacción o la refrigeración, a través

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

769

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
del cual el valor real se iguala a la consigna. En el regulador PID, los valores de salida se
componen de tres acciones:
● Acción P
La acción P del valor de salida aumenta proporcionalmente al error de regulación.
● Acción I
La acción I del valor de salida aumenta hasta que se compensa el error de regulación.
● Acción D
La acción D aumenta con una velocidad de variación creciente del error de regulación. El
valor real se iguala lo más rápidamente posible con la consigna. Si la velocidad de variación
del error de regulación vuelve a reducirse, también lo hace la acción D.
La instrucción PID_Temp calcula los parámetros P, I y D para el sistema regulado de forma
autónoma durante la "optimización inicial". Los parámetros pueden optimizarse aún más a
través de una "optimización fina". No es necesario determinar los parámetros manualmente.
Para aplicaciones de calefacción/refrigeración puede utilizarse un factor de enfriamiento fijo o
bien dos juegos de parámetros PID.

Información adicional
● Vista general de los reguladores de software (Página 661)
● Agregar objetos tecnológicos (Página 664)
● Configurar objetos tecnológicos (Página 665)
● Configurar PID_Temp (Página 770)

3.3.3.2

Configurar PID_Temp

Ajustes básicos
Introducción
Configure las propiedades siguientes del objeto tecnológico PID_Temp en el área de ajustes
básicos de la ventana de inspección o de configuración.
● Magnitud física
● Comportamiento en arranque tras un reset
● Origen e introducción de la consigna (solo en la ventana de inspección)
● Selección del valor real
● Origen e introducción del valor real (solo en la ventana de inspección)
● Selección del valor de salida para calefacción
● Origen e introducción del valor de salida para calefacción (solo en la ventana de inspección)
● Activación y selección del valor de salida para refrigeración
● Origen e introducción del valor de salida para refrigeración (solo en la ventana de
inspección)

770

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
● Activar PID_Temp como maestro o esclavo de una cascada
● Número de esclavos
● Selección del maestro (solo en la ventana de inspección)

Consigna, valor real, valor de salida para calefacción y valor de salida para refrigeración
Para la consigna, el valor real, el valor de salida para calefacción y el valor de salida para
refrigeración, en la ventana de inspección del editor de programación puede seleccionar el
origen e introducir valores o variables.
Para cada valor elija el origen:
● DB de instancia:
Se utiliza el valor que se encuentra almacenado en el DB de instancia. El valor debe
actualizarse en el DB de instancia del programa de usuario. En la instrucción no puede
haber ningún valor. Modificación posible desde HMI.
● Instrucción:
Se utiliza el valor que se interconecta a la instrucción. Cada vez que se llama la instrucción,
el valor se escribe en el DB de instancia. No se puede modificar desde HMI.

Tipo de regulación
Magnitud física
En el grupo "Tipo de regulación", seleccione la magnitud física y la unidad de la consigna y del
valor real. La consigna y el valor real se mostrarán en esta unidad.

Comportamiento en arranque
1. Para cambiar inmediatamente al modo de operación "Inactivo" tras el rearranque de la
CPU, desactive la casilla de verificación "Activar Mode tras rearrancar la CPU".
Para cambiar inmediatamente, tras el rearranque de la CPU, al modo de operación
almacenado en Mode, active la casilla de verificación "Activar Mode tras rearrancar la
CPU".
2. En la lista desplegable "Poner Mode a", seleccione el modo de operación que debe
activarse tras una carga completa en el dispositivo.
Tras una operación de "Cargar en dispositivo" completa, PID_Temp arranca en el modo de
operación seleccionado. Con cada rearranque, PID_Temp arranca en el último modo de
operación almacenado en Mode.
Al seleccionar la optimización inicial o la optimización fina, es preciso además setear o
resetear las variables Heat.EnableTuning y Cool.EnableTuning para elegir entre
optimización para calefacción y optimización para refrigeración.
Ejemplo:
Se ha activado la casilla de verificación "Activar Mode tras rearrancar la CPU" y en la lista
"Poner Mode a" se ha seleccionado la entrada "Optimización inicial". Tras una operación de
"Cargar en dispositivo" completa, PID_Temp arranca en el modo de operación "Optimización
inicial". Si la optimización inicial aún está activa y se rearranca la CPU, PID_Temp arranca de
nuevo en el modo de operación "Optimización inicial" (calefacción/refrigeración dependiendo

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

771

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
de las variables Heat.EnableTuning y Cool.EnableCooling). Si la optimización inicial ha
finalizado correctamente, el modo automático aún está activo y se rearranca la CPU,
PID_Temp arranca en "Modo automático".

Consigna
Procedimiento
Para especificar una consigna fija, proceda de la siguiente manera:
1. Seleccione "DB de instancia".
2. Introduzca una consigna, como puede ser 80 °C.
3. En caso necesario, elimine una entrada de la instrucción.
Para especificar una consigna variable, proceda de la siguiente manera:
1. Seleccione "Instrucción".
2. Indique el nombre de la variable REAL en la que está almacenada la consigna.
Es posible asignar varios valores de forma controlada por programa a la variable REAL
para, por ejemplo, modificar la consigna de forma controlada por tiempo.

Valor real
Si utiliza directamente el valor de la entrada analógica, PID_Temp escala el valor de la entrada
analógica a la magnitud física.
Si desea acondicionar primero el valor de la entrada analógica, es preciso escribir un programa
propio para su acondicionamiento. Por ejemplo, el valor real no es directamente proporcional
al valor de la entrada analógica. El valor real acondicionado debe estar en formato de coma
flotante.

Procedimiento
Para utilizar directamente el valor de la entrada analógica, proceda del siguiente modo:
1. En la lista desplegable "Input", seleccione la entrada "Input_PER".
2. Seleccione "Instrucción" como fuente.
3. Introduzca la dirección de la entrada analógica.
Para utilizar el valor real acondicionado en el formato de coma flotante, proceda del siguiente
modo:
1. En la lista desplegable "Input", seleccione la entrada "Input".
2. Seleccione "Instrucción" como fuente.
3. Indique el nombre de la variable en la que está almacenado el valor real acondicionado.

772

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Valor de salida para calefacción y refrigeración
La instrucción PID_Temp ofrece un regulador PID con optimización integrada para procesos
de temperatura. PID_Temp es apta para aplicaciones de calefacción o de calefacción/
refrigeración.
PID_Temp ofrece los siguientes valores de salida. El valor de salida que se utilice dependerá
del actuador.
● OutputHeat
Valor de salida para calefacción (formato de coma flotante): El valor de salida para
calefacción debe acondicionarse mediante el programa de usuario, por ejemplo, porque el
actuador presenta un comportamiento no lineal.
● OutputHeat_PER
Valor de salida analógico para calefacción: El actuador para calefacción se activa a través
de una salida analógica y se controla con una señal continua, como puede ser 0 a 10 V, 4
a 20 mA.
● OutputHeat_PWM
Valor de salida modulado por ancho de impulso para calefacción: El actuador para
calefacción se controla a través de una salida digital. Una modulación de ancho de
impulsos permite formar tiempos de conexión y desconexión variables.
● OutputCool
Valor de salida para refrigeración (formato de coma flotante): El valor de salida para
refrigeración debe acondicionarse mediante el programa de usuario, por ejemplo, porque
el actuador muestra un comportamiento no lineal.
● OutputCool_PER
Valor de salida analógico para refrigeración: El actuador para refrigeración se activa a
través de una salida analógica y se controla con una señal continua, como puede ser 0 a
10 V, 4 a 20 mA.
● OutputCool_PWM
Valor de salida modulado por ancho de impulso para refrigeración: El actuador para
refrigeración se controla a través de una salida digital. Una modulación de ancho de
impulsos permite formar tiempos de conexión y desconexión variables.
La salida de refrigeración solo está disponible si se ha activado a través de la casilla de
verificación "Activar refrigeración".
● Si la casilla de verificación está desactivada, el valor de salida del algoritmo PID
(PidOutputSum) se escala y se emite en las salidas para calefacción.
● Si la casilla de verificación está activada, los valores de salida positivos del algoritmo PID
(PidOutputSum) se escalan y se emiten en las salidas para calefacción. Los valores de
salida negativos del algoritmo PID se escalan y se emiten en las salidas para refrigeración.
En los ajustes de salida se puede elegir entre dos métodos de cálculo del valor de salida.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

773

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Nota
Tenga en cuenta lo siguiente:
● Las salidas OutputHeat_PWM, OutputHeat_PER, OutputCool_PWM, OutputCool_PER
únicamente se calculan si se seleccionan en la lista desplegable.
● La salida OutputHeat siempre se calcula.
● La salida OutputCool se calcula si la casilla de verificación para la refrigeración está
activada.
● La casilla de verificación "Activar refrigeración" únicamente está disponible si el regulador
no está configurado como maestro en una cascada.

Procedimiento
Para utilizar el valor de salida analógico, proceda del siguiente modo:
1. En la lista desplegable "OutputHeat" o "OutputCool", seleccione la entrada
"OutputHeat_PER" o "OutputCool_PER".
2. Seleccione "Instrucción".
3. Introduzca la dirección de la salida analógica.
Para utilizar el valor de salida modulado por ancho de impulso, proceda de la siguiente manera:
1. En la lista desplegable "OutputHeat" o "OutputCool", seleccione la entrada
"OutputHeat_PWM" o "OutputCool_PWM".
2. Seleccione "Instrucción".
3. Introduzca la dirección de la salida digital.
Para acondicionar el valor de salida mediante el programa de usuario, proceda del siguiente
modo:
1. En la lista desplegable "OutputHeat" o "OutpuCool", seleccione la entrada "OutputHeat" o
"OutputCool".
2. Seleccione "Instrucción".
3. Indique el nombre de la variable que utilizará para acondicionar el valor de salida.
4. Transfiera el valor de salida acondicionado hasta el actuador a través de una salida
analógica o digital de la CPU.

Cascada
Si una instancia PID_Temp recibe su consigna de un regulador maestro superior y transmite
su propio valor de salida a un regulador esclavo inferior, esa instancia PID_Temp es regulador
maestro y regulador esclavo al mismo tiempo. Para esa instancia PID_Temp deben realizarse
entonces las dos configuraciones descritas a continuación. Esto es lo que ocurre, por ejemplo,
con la instancia PID_Temp central de una regulación en cascada con tres magnitudes
concatenadas y tres instancias PID_Temp.

774

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Configurar un regulador como maestro en una cascada
La salida de un regulador maestro es la consigna de un regulador esclavo.
Para utilizar PID_Temp como maestro en una cascada, debe desactivarse la refrigeración en
los ajustes básicos. Para configurar esa instancia PID_Temp como regulador maestro en una
cascada, active la casilla de verificación "El regulador es maestro". La selección del valor de
salida para calefacción se ajusta automáticamente a OutputHeat.
OutputHeat_PWM y OutputHeat_PER no pueden utilizarse para un maestro en una cascada.
A continuación, indique el número de reguladores esclavos directamente subordinados y que
reciben su consigna de ese regulador maestro.
Si al asignar el parámetro OutputHeat del maestro al parámetro Setpoint del esclavo no se
utiliza una función de escalado propia, puede que sea necesario adaptar los límites y la escala
del valor de salida del maestro al rango de consignas/valores reales del esclavo. Esto puede
realizarse en los ajustes de salida del maestro, en el área "OutputHeat / OutputCool".

Configurar un regulador como esclavo en una cascada
Un regulador esclavo recibe su consigna (parámetro Setpoint) de la salida de su regulador
maestro (parámetro OutputHeat).
Para configurar esa instancia PID_Temp como regulador esclavo en una cascada, active la
casilla de verificación "El regulador es esclavo" en los ajustes básicos.
A continuación, en la ventana de inspección del editor de programación, seleccione la
instancia PID_Temp que habrá de utilizarse como regulador maestro para ese regulador
esclavo. Al realizar esta selección, los parámetros Master y Setpoint del regulador esclavo se
interconectan con el regulador maestro elegido (las interconexiones anteriores de estos
parámetros se sobrescriben). Esta interconexión permite el intercambio de información y la
especificación de consigna entre maestro y esclavo. Si es necesario, la interconexión del
parámetro Setpoint del regulador esclavo puede modificarse posteriormente, p. ej., para añadir
un filtro adicional. La interconexión del parámetro Maestro no puede modificarse
posteriormente.
En el regulador maestro seleccionado, la casilla de verificación "El regulador es maestro" debe
estar activada, y el número de esclavos debe estar correctamente configurado. El regulador
maestro debe llamarse antes que el regulador esclavo en el mismo OB de alarma cíclica.

Información adicional
Para más información sobre creación de programas, configuración y puesta en marcha en
relación con el uso de PID_Temp en regulaciones en cascada, ver Regulación en cascada con
PID_Temp (Página 803).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

775

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Ajustes del valor real
Límites del valor real
Como valores límite para el sistema regulado, defina los límites superior e inferior absolutos del
valor real de modo que sean razonables. Tan pronto como dichos valores se rebasen por
exceso o defecto, se producirá un error (ErrorBits = 0001h). La optimización se cancela cuando
se rebasan los límites del valor real. La manera como debe reaccionar PID_Temp en caso de
fallo en el modo automático se define en los ajustes de salida.

Escalar valor real
Si en los ajustes básicos ha configurado el uso de Input_PER, deberá convertir el valor de la
entrada analógica a la magnitud física del valor real. En el cuadro de visualización Input_PER
se muestra la configuración actual.
Si el valor real es directamente proporcional al valor de la entrada analógica, Input_PER se
escalará a partir de un par de valores inferior y superior.

Procedimiento
Para escalar el valor real, haga lo siguiente:
1. En los campos de entrada "Valor real inferior escalado" y "abajo", introduzca el par de
valores inferior.
2. En los campos de entrada "Valor real superior escalado" y "arriba", introduzca el par de
valores superior.
La configuración hardware contiene pares de valores predeterminados. Para utilizar los pares
de valores contenidos en la configuración hardware, haga lo siguiente:
1. Marque la instrucción PID_Temp en el editor de programación.
2. En los ajustes básicos, interconecte Input_PER con una entrada analógica.
3. En los ajustes del valor real, haga clic en el botón "Ajuste automático".
Los valores existentes se sobrescribirán con los valores de la configuración hardware.

776

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Ajustes de salida
Ajustes básicos salida
Método para calefacción y refrigeración
Si la refrigeración está activada en los ajustes básicos, para el cálculo del valor de salida PID
hay dos métodos disponibles:
● Conmutación de parámetros PID (Config.AdvancedCooling = TRUE):
El cálculo del valor de salida para la refrigeración se lleva a cabo mediante un juego de
parámetros PID propio. El algoritmo PID, a partir del valor de salida calculado y el error de
regulación, decide si los parámetros PID se utilizarán para calefacción o para refrigeración.
Este método es adecuado si el actuador de calefacción y el actuador de refrigeración
presentan un comportamiento temporal diferente y ganancias diferentes.
La optimización inicial y la optimización fina para refrigeración únicamente están
disponibles si se elige este método.
● Factor de enfriamiento (Config.AdvancedCooling = FALSE):
El valor de salida para la refrigeración se calcula con los parámetros PID para calefacción
teniendo en cuenta el factor de enfriamiento configurable Config.CoolFactor. Este método
es adecuado si el actuador de calefacción y el actuador de refrigeración presentan un
comportamiento temporal similar pero ganancias diferentes. Si se elige este método, la
optimización inicial y la optimización fina para refrigeración, así como el juego de
parámetros PID para refrigeración, no están disponibles. Tan solo pueden realizarse
optimizaciones para calefacción.

Factor de enfriamiento
Si como método para calefacción/refrigeración se ha elegido el factor de enfriamiento, este se
tiene en cuenta como factor a la hora de calcular el valor de salida para refrigeración. De esta
forma es posible tener en cuenta ganancias diferentes del actuador de calefacción y el
actuador de refrigeración.
El factor de enfriamiento no se ajusta automáticamente ni se adapta durante la optimización.
Debe configurar el factor de enfriamiento correctamente de forma manual con la relación
"ganancia actuador de calefacción / ganancia actuador de refrigeración".
Ejemplo: un factor de enfriamiento = 2.0 significa que la ganancia del actuador de calefacción
es el doble que la ganancia del actuador de refrigeración.
El factor de enfriamiento únicamente actúa y puede modificarse si como método para
calefacción / refrigeración se ha elegido "Factor de enfriamiento".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

777

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Comportamiento en caso de error
ATENCIÓN
Su instalación puede sufrir daños.
Si en caso de fallo se emite "Valor actual mientras dure el error" o "Valor de salida sustitutivo
mientras dure el error", PID_Temp se mantiene en modo automático o en modo manual. De
este modo, los límites del valor real pueden rebasarse y su instalación puede sufrir daños.
Configure un comportamiento en caso de fallo para su sistema regulado que proteja la
instalación de daños.
PID_Temp está preajustado de manera que, en caso de fallo, la regulación permanece activa
en la mayoría de los casos.
Si en el modo de regulación se producen errores con frecuencia, este ajuste empeorará el
comportamiento de regulación. Compruebe en tal caso el parámetro ErrorBits y elimine la
causa de error.

778

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
En caso de fallo, PID_Temp emite un valor de salida configurable:
● Cero (inactivo)
Cuando se produce cualquier error, PID_Temp cambia al modo de operación "Inactivo" y
emite lo siguiente:
– 0.0 como valor de salida PID (PidOutputSum)
– 0.0 como valor de salida para calefacción (OutputHeat) y valor de salida para
refrigeración (OutputCool)
– 0 como valor de salida analógico para calefacción (OutputHeat_PER) y valor de salida
analógico para refrigeración (OutputCool_PER)
– FALSE como valor de salida modulado por ancho de impulso para calefacción
(OutputHeat_PWM) y valor de salida modulado por ancho de impulso para refrigeración
(OutputCool_PWM)
Esto es independiente de los límites y la escala del valor de salida que se hayan
configurado. El regulador no se reactiva hasta que no se detecta un flanco descendente en
Reset o un flanco ascendente en ModeActivate.
● Valor actual mientras dure el error
La reacción a fallo depende del error ocurrido y del modo de operación.
Si en el modo automático se producen uno o varios de los errores siguientes, PID_Temp
permanece en modo automático:
– 0000001h: El parámetro Input se encuentra fuera de los límites del valor real.
– 0000800h: Error en tiempo de muestreo
– 0040000h: Valor no válido en el parámetro Disturbance.
– 8000000h: Error durante el cálculo de los parámetros PID.
Si en el modo automático se producen uno o varios de los errores siguientes, PID_Temp
pasa al modo "Valor de salida sustitutivo con monitorización de errores" y emite el último
valor de salida PID válido (PidOutputSum):
– 0000002h: Valor no válido en el parámetro Input_PER.
– 0000200h: Valor no válido en el parámetro Input.
– 0000400h: Error al calcular el valor de salida.
– 0001000h: Valor no válido en el parámetro Setpoint o SubstituteSetpoint.
Los valores resultantes del valor de salida PID en las salidas para calefacción y
refrigeración se obtienen del escalado de salida configurado.
En cuanto los errores dejan de estar activos, PID_Temp pasa de nuevo al modo automático.
Si se produce un error en el modo manual, PID_Temp permanece en el modo manual y
continúa utilizando el valor manual como valor de salida PID.
Si el valor manual no es válido, se utiliza el valor de salida sustitutivo configurado.
Si el valor manual y el valor de salida sustitutivo no son válidos, se utiliza el límite inferior del
valor de salida PID para calefacción (Config.Output.Heat.PidLowerLimit).
Si durante una optimización inicial u optimización fina aparece el siguiente error, PID_Temp
se mantiene en el modo de operación activo:
– 0000020h: La optimización inicial no está permitida durante la optimización fina.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

779

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Con todos los demás errores, PID_Temp interrumpe la optimización y cambia al modo
desde el que se inició la optimización.
● Valor de salida sustitutivo mientras dure el error
PID_Temp se comporta del modo descrito en "Valor actual mientras dure el error", pero en
el modo de operación "Valor de salida sustitutivo con monitorización de errores" emite el
valor de salida sustitutivo configurado (SubstituteOutput) como valor de salida PID
(PidOutputSum).
Los valores resultantes del valor de salida PID en las salidas para calefacción y
refrigeración se obtienen del escalado de salida configurado.
Para reguladores con salida de refrigeración activada (Config.ActivateCooling = TRUE),
– introduzca un valor de salida sustitutivo positivo para emitir el valor en las salidas para
calefacción.
– introduzca un valor de salida sustitutivo negativo para emitir el valor en las salidas para
refrigeración.
Si se produce el siguiente error, PID_Temp se mantiene en el modo "Valor de salida
sustitutivo con monitorización de errores" y emite el límite inferior del valor de salida PID
para calefacción (Config.Output.Heat.PidLowerLimit):
– 0020000h: Valor no válido en la variable SubstituteOutput.

Límites y escalado del valor de salida
El valor de salida PID (PidOutputSum) se calcula automáticamente con el algoritmo PID en
función del modo de operación o bien está predeterminado por el valor manual (ManualValue)
o por el valor de salida sustitutivo configurado (SubstituteOutput).
El valor de salida PID se limita dependiendo de la configuración:
● Si la refrigeración está desactivada en los ajustes básicos (Config.ActivateCooling =
FALSE), el valor se limita al límite superior del valor de salida PID (calefacción)
(Config.Output.Heat.PidUpperLimit) y al límite inferior del valor de salida PID (calefacción)
(Config.Output.Heat.PidLowerLimit).
Ambos valores límite pueden configurarse en el apartado "OutputHeat / OutputCool" en el
eje horizontal de la característica de escala. En los apartados "OutputHeat_PWM /
OutputCool_PWM" y "OutputHeat_PER / OutputCool_PER" se muestran dichos valores
límite, pero no es posible modificarlos.
● Si la refrigeración está activada en los ajustes básicos (Config.ActivateCooling = TRUE), el
valor se limita al límite superior del valor de salida PID (Config.Output.Heat.PidUpperLimit)
y al límite inferior del valor de salida PID (refrigeración) (Config.Output.Cool.PidLowerLimit).
Ambos valores límite pueden configurarse en el apartado "OutputHeat / OutputCool" en el
eje horizontal de la característica de escala. En los apartados "OutputHeat_PWM /
OutputCool_PWM" y "OutputHeat_PER / OutputCool_PER" se muestran dichos valores
límite, pero no es posible modificarlos.
El límite inferior del valor de salida PID (calefacción) (Config.Output.Heat.PidLowerLimit) y
el límite superior del valor de salida PID (refrigeración) (Config.Output.Cool.PidUpperLimit)
no pueden modificarse y deben estar configurados con el valor 0.0.

780

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
El valor de salida PID se escala y se emite en las salidas para calefacción y refrigeración. El
escalado puede especificarse por separado para cada salida y se define mediante 2 pares de
valores en cada caso: un valor límite del valor de salida PID y un valor de escalado.
Salida

Par de valores

Parámetro

OutputHeat

Par de valores
1

Límite superior del valor de salida PID (calefacción)
Config.Output.Heat.PidUpperLimit,
Valor de salida superior escalado (calefacción) Config.Out‐
put.Heat.UpperScaling

Par de valores
2

Límite inferior del valor de salida PID (calefacción)
Config.Output.Heat.PidLowerLimit,
Valor de salida inferior escalado (calefacción) Config.Out‐
put.Heat.LowerScaling

OutputHeat_PWM

Par de valores
1

Límite superior del valor de salida PID (calefacción)
Config.Output.Heat.PidUpperLimit,
Valor de salida PWM superior escalado (calefacción)
Config.Output.Heat.PwmUpperScaling

Par de valores
2

Límite inferior del valor de salida PID (calefacción)
Config.Output.Heat.PidLowerLimit,
Valor de salida PWM inferior escalado (calefacción)
Config.Output.Heat.PwmLowerScaling

OutputHeat_PER

Par de valores
1

Límite superior del valor de salida PID (calefacción)
Config.Output.Heat.PidUpperLimit,
Valor de salida analógico superior escalado (calefacción)
Config.Output.Heat.PerUpperScaling

Par de valores
2

Límite inferior del valor de salida PID (calefacción)
Config.Output.Heat.PidLowerLimit,
Valor de salida analógico inferior escalado (calefacción)
Config.Output.Heat.PerLowerScaling

OutputCool

Par de valores
1

Límite inferior del valor de salida PID (refrigeración)
Config.Output.Cool.PidLowerLimit,
Valor de salida superior escalado (refrigeración)
Config.Output.Cool.UpperScaling

Par de valores
2

Límite superior del valor de salida PID (refrigeración)
Config.Output.Cool.PidUpperLimit,
Valor de salida inferior escalado (refrigeración)
Config.Output.Cool.LowerScaling

OutputCool_PWM

Par de valores
1

Límite inferior del valor de salida PID (refrigeración)
Config.Output.Cool.PidLowerLimit,
Valor de salida PWM superior escalado (refrigeración)
Config.Output.Cool.PwmUpperScaling

Par de valores
2

Límite superior del valor de salida PID (refrigeración)
Config.Output.Cool.PidUpperLimit,
Valor de salida PWM inferior escalado (refrigeración)
Config.Output.Cool.PwmLowerScaling

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

781

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Salida

Par de valores

Parámetro

OutputCool_PER

Par de valores
1

Límite inferior del valor de salida PID (refrigeración)
Config.Output.Cool.PidLowerLimit,
Valor de salida analógico superior escalado (refrigeración)
Config.Output.Cool.PerUpperScaling

Par de valores
2

Límite superior del valor de salida PID (refrigeración)
Config.Output.Cool.PidUpperLimit,
Valor de salida analógico inferior escalado (refrigeración)
Config.Output.Cool.PerLowerScaling

El límite inferior del valor de salida PID (calefacción) (Config.Output.Heat.PidLowerLimit) debe tener el
valor 0.0 si la refrigeración está activada (Config.ActivateCooling = TRUE).
El límite superior del valor de salida PID (refrigeración) (Config.Output.Cool.PidUpperLimit) debe tener
siempre el valor 0.0.

Ejemplo:
Escalado de salida si se utiliza la salida OutputHeat (refrigeración desactivada; el límite inferior
del valor de salida PID (calefacción) (Config.Output.Heat.PidLowerLimit) puede ser distinto de
0.0):
2XWSXW+HDW
&RQILJ2XWSXW+HDW
8SSHU6FDOLQJ
&RQILJ2XWSXW+HDW
/RZHU6FDOLQJ

&RQILJ2XWSXW+HDW
3LG/RZHU/LPLW

3LG2XWSXW6XP
&RQILJ2XWSXW+HDW
3LG8SSHU/LPLW

Ejemplo:
Escalado de salida si se utiliza la salida OutputHeat_PWM y OutputCool_PER (refrigeración
activada; el límite inferior del valor de salida PID (calefacción)
(Config.Output.Heat.PidLowerLimit) debe ser 0.0):
OutputCool_PER OutputHeat_PWM
Config.Output.Cool.
PerUpperScaling

Config.Output.Heat.
PwmUpperScaling
Config.Output.Heat.
PwmLowerScaling

Config.Output.Cool.
PerLowerScaling

PidOutputSum

Config.Output.Heat.
Config.Output.Cool.
Config.Output.Heat.
PidLowerLimit
PidLowerLimit
PidUpperLimit
=Config.Output.Cool.
PidUpperLimit=0.0

Con la excepción del modo de operación "Inactivo", el valor en una salida está siempre
comprendido entre su valor de salida superior escalado y el valor de salida inferior escalado;

782

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
p. ej., para OutputHeat está siempre entre el valor de salida superior escalado (calefacción)
(Config.Output.Heat.UpperScaling) y el valor de salida inferior escalado (calefacción)
(Config.Output.Heat.LowerScaling).
Por lo tanto, si se quiere limitar el valor en la salida correspondiente, también deben limitarse
estos valores de escalado.
Los valores de escalado de una salida pueden configurarse en el eje vertical de la
característica de escala. Cada salida dispone de dos valores de escalado propios. Para
OutputHeat_PWM, OutputCool_PWM, OutputHeat_PER y OutputCool_PER, dichos valores
únicamente pueden modificarse si la salida correspondiente está seleccionada en los ajustes
básicos. Para todas las salidas para refrigeración es necesario, además, que la refrigeración
esté activada en los ajustes básicos.
El visor de curvas que hay en el cuadro de diálogo de puesta en marcha tan solo registra los
valores de OutputHeat y OutputCool, con independencia de la salida seleccionada en los
ajustes básicos. Por lo tanto, los valores de escalado para OutputHeat o OutputCool también
deben adaptarse si se está utilizando OutputHeat_PWM o OutputHeat_PER, o bien
OutputCool_PWM o OutputCool_PER, y se quiere emplear el visor de curvas del cuadro de
diálogo de puesta en marcha.

Ajustes avanzados
Monitorización de valor real
Configure un límite de advertencia inferior y uno superior para el valor real en la ventana de
configuración "Monitorización del valor real". Si durante el funcionamiento se rebasa uno de los
límites de advertencia por defecto o por exceso, se muestra una advertencia en la instrucción
PID_Temp:
● En el parámetro de salida "InputWarning_H", si se ha rebasado por exceso el límite superior
de advertencia
● En el parámetro de salida "InputWarning_L", si se ha rebasado por defecto el límite inferior
de advertencia
Los límites de advertencia deben encontrarse dentro de los límites superior e inferior del valor
real.
Si no introduce ningún valor, se utilizan los límites superior e inferior del valor real.

Ejemplo
Límite superior del valor real = 98 °C; límite superior de advertencia = 90 °C
Límite inferior de advertencia = 10 °C; límite inferior del valor real = 0 °C
PID_Temp se comporta del modo siguiente:
Valor real

InputWarning_H

InputWarning_L

ErrorBits

> 98 °C

TRUE

FALSE

0001h

≤ 98 °C y > 90 °C

TRUE

FALSE

0000h

≤ 90 °C y ≥ 10 °C

FALSE

FALSE

0000h

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

783

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Valor real

InputWarning_H

InputWarning_L

ErrorBits

< 10 °C y ≥ 0 °C

FALSE

TRUE

0000h

< 0 °C

FALSE

TRUE

0001h

La manera en que debe reaccionar PID_Temp si se rebasan el límite superior o inferior del
valor real se configura en los ajustes de salida.

Limitaciones PWM
El valor de salida PID PidOutputSum se escala y, mediante una modulación de ancho de
impulsos, se transforma en una secuencia de impulsos que se emite en el parámetro de salida
OutputHeat_PWM o OutputCool_PWM.
El "Tiempo muestreo algoritmo PID" es el tiempo que transcurre entre dos cálculos del valor de
salida PID. El tiempo de muestreo se utiliza como duración de período de la modulación por
ancho de impulso.
Durante la calefacción, el valor de salida PID se calcula siempre en el "Tiempo muestreo
algoritmo PID para calefacción".
El cálculo del valor de salida PID durante la refrigeración depende del tipo de refrigeración
seleccionado en "Ajustes básicos Salida":
● Si se utiliza el factor de enfriamiento, se aplica el "Tiempo muestreo algoritmo PID para
calefacción".
● Si se utiliza la conmutación de parámetros PID, se aplica el "Tiempo muestreo algoritmo
PID para refrigeración".
El tiempo de muestreo del algoritmo PID para calefacción o refrigeración se determina durante
la optimización inicial o la optimización fina. Si los parámetros PID se ajustan manualmente,
debe configurarse también ahí el tiempo de muestreo del algoritmo PID para calefacción o
refrigeración.
OutputHeat_PWM y OutputCool_PWM se emiten en el tiempo de muestreo PID_Temp. El
tiempo de muestreo PID_Temp equivale al tiempo de ciclo del OB que efectúa la llamada.
La duración del impulso es proporcional al valor de salida PID y es siempre un múltiplo entero
del tiempo de muestreo PID_Temp.
Ejemplo de OutputHeat_PWM

784

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
3LG2XWSXW6XP





W PV

2XWSXW+HDWB3:0
758(
)$/6(

W PV





①
②
③
④



Tiempo de muestreo PID_Temp
Tiempo de muestreo del algoritmo PID para calefacción
Duración del impulso
Duración de la pausa

"Tiempo conexión mín." y "Tiempo desconex. mín." pueden utilizarse por separado para
calefacción y refrigeración, redondeados a un múltiplo entero del tiempo de muestreo
PID_Temp.
Un impulso o una pausa nunca son más cortas que los tiempos de conexión o desconexión
mínimos. Las imprecisiones que se producen se suman y se compensan en el siguiente ciclo.
Ejemplo de OutputHeat_PWM
Tiempo de muestreo PID_Temp (equivale al tiempo de ciclo del OB que efectúa la llamada) =
100 ms
Tiempo de muestreo Algoritmo PID (equivale a la duración del periodo) = 1000 ms
Tiempo conexión mín. = 200 ms
El valor de salida PID PidOutputSum es del 15% en todo momento. El impulso mínimo que
PID_Temp puede emitir es del 20% En el primer ciclo no se emite ningún impulso. En el
segundo ciclo, el impulso no emitido del primer ciclo se agrega al impulso del segundo ciclo.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

785

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
3LG2XWSXW6XP





2XWSXW+HDWB3:0

W PV

758(
)$/6(

W PV





①
②
⑤

Tiempo de muestreo PID_Temp
Tiempo de muestreo del algoritmo PID para calefacción
Tiempo conexión mín.

Para reducir la frecuencia de conmutación y proteger el actuador, prolongue los tiempos de
conexión y desconexión mínimos.
Si en los ajustes básicos se ha seleccionado como salida OutputHeat o OutputCool, o bien
OutputHeat_PER o OutputCool_PER, el tiempo de conexión mínimo y el tiempo de
desconexión mínimo no se evalúan y no pueden modificarse.
Si en caso de utilizar OutputHeat_PWM o OutputCool_PWM el "Tiempo de muestreo Algoritmo
PID" (Retain.CtrlParams.Heat.Cycle o Retain.CtrlParams.Cool.Cycle) y, con ello, la duración
del periodo de la modulación de ancho de impulsos es muy larga, puede especificarse una
duración del período más corta en los parámetros Config.Output.Heat.PwmPeriode o
Config.Output.Cool.PwmPeriode (v. también Variable PwmPeriode) para así mejorar el filtrado
del valor real.
Nota
Los tiempos mínimos de conexión y desconexión actúan solo en los parámetros de salida
OutputHeat_PWM o OutputCool_PWM y no se utilizan para posibles generadores de impulsos
integrados en la CPU.

Parámetros PID
En la ventana de configuración "Parámetros PID" se visualizan los parámetros PID.
Si en los ajustes básicos está activada la refrigeración y en los ajustes de salida se ha
seleccionado la conmutación de parámetros PID como método para calefacción/refrigeración,
están disponibles dos juegos de parámetros: uno para calefacción y otro para refrigeración.

786

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
En tal caso, el algoritmo PID, a partir del valor de salida calculado y el error de regulación,
decide si los parámetros PID se utilizarán para calefacción o para refrigeración.
Si la refrigeración está desactivada o se ha seleccionado el factor de enfriamiento como
método para calefacción/refrigeración, siempre se utiliza el juego de parámetros para
calefacción.
Durante la optimización, los parámetros PID se adaptan al sistema regulado, con excepción
del ancho de zona muerta, que debe configurarse manualmente.
Nota
Los parámetros PID efectivos actualmente están en la estructura Retain.CtrlParams.
Para prevenir un comportamiento erróneo del regulador PID, los parámetros PID efectivos
actualmente solo deben modificarse online en el modo de operación "Inactivo".
Si desea modificar online los parámetros PID en los modos de operación "Automático" o
"Manual", modifique los parámetros PID en la estructura CtrlParamsBackUp y aplique los
cambios poniendo LoadBackUp = TRUE en la estructura Retain.CtrlParams.
Los cambios online en los parámetros PID realizados en el modo de operación "Automático"
pueden provocar saltos en el valor de salida.
PID_Temp es un regulador PIDT1 con Anti-Windup y ponderación de las acciones P y D.
El algoritmo PID funciona de acuerdo con la siguiente fórmula (zona de regulación y zona
muerta desactivadas):

1

y = Kp

[ (b · w - x) + T · s

(w - x) +

I

TD · s
a · TD · s + 1

(c · w - x)

]

Símbolo

Descripción

Parámetro correspondiente de la instrucción
PID_Temp

y

Valor de salida del algoritmo PID

-

Kp

Ganancia proporcional

Retain.CtrlParams.Heat.Gain
Retain.CtrlParams.Cool.Gain
CoolFactor

s

Operador laplaciano

-

b

Ponderación de la acción P

Retain.CtrlParams.Heat.PWeighting

w

Consigna

CurrentSetpoint

x

Valor real

ScaledInput

TI

Tiempo de integración

Retain.CtrlParams.Heat.Ti

Retain.CtrlParams.Cool.PWeighting

Retain.CtrlParams.Cool.Ti
TD

Tiempo derivativo

Retain.CtrlParams.Heat.Td
Retain.CtrlParams.Cool.Td

a
c

Coeficiente para el retardo de acción derivativa

Retain.CtrlParams.Heat.TdFiltRatio

(retardo de la acción derivada T1 = a x TD)

Retain.CtrlParams.Cool.TdFiltRatio

Ponderación de la acción D

Retain.CtrlParams.Heat.DWeighting
Retain.CtrlParams.Cool.DWeighting

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

787

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Símbolo

Descripción

Parámetro correspondiente de la instrucción
PID_Temp

DeadZone

Ancho de zona muerta

Retain.CtrlParams.Heat.DeadZone

ControlZone

Ancho de zona de regulación

Retain.CtrlParams.Cool.DeadZone
Retain.CtrlParams.Heat.ControlZone
Retain.CtrlParams.Cool.ControlZone

El gráfico siguiente muestra cómo entran los parámetros en el algoritmo PID.
E

&XUUHQW6HWSRLQW Z

&RQILJ2XWSXW+HDW
3LG8SSHU/LPLW


F

'7

.S

\




&RQILJ2XWSXW+HDW
3LG/RZHU/LPLW
&RQILJ2XWSXW&RRO
3LG/RZHU/LPLW

'HDG=RQH







$QWL:LQGXS

6FDOHG,QSXW [

/LPLW

,

&RQWURO=RQH




Todos los parámetros PID son remanentes. Si introduce manualmente los parámetros PID,
debe cargar PID_Temp por completo (Cargar objetos tecnológicos en el dispositivo
(Página 667)).

788

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Diagrama de bloques PID_Temp
El siguiente diagrama de bloques muestra cómo está integrado el algoritmo PID en PID_Temp.
InputPEROn

Scale

PV_ALRM

InputWarning_H

Input_PER
1

InputWarning_L

0

Input

z -1

sgn

CtrlParams
Heat.Gain
Heat Ti …
Cool.Gain
Cool.Ti ...
SubstituteSetpointOn
Setpoint
SubstituteSetpoint

0

ScaledInput
Limit
CurrentSetpoint

PIDT1
Anti Windup

1

Disturbance

State
Limit

=3

PidOutputSum

ManualValue
=4

Scale
OutputHeat

PidOutput
OffsetHeat

Scale

Config.Output.Heat.Select

PWM

PIDSelfTune.TIR.
OutputOffsetHeat
Split

=1
FALSE
≠1

OutputHeat_PWM

Scale

Limit

=2
0

OutputHeat_PER

≠2

Limit

Split

Config.ActivateCooling

Scale

OutputCool

-1

1
0.0
0

PIDSelfTune.TIR.
OutputOffsetCool

Scale

Config.Output.Cool.Select

PWM
1

PidOutput
OffsetCool

FALSE
0

=1
FALSE
≠1

OutputCool_PWM

Scale
1
0
0

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

=2
0

OutputCool_PER

≠2

789

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Ganancia proporcional
El valor indica la ganancia proporcional del regulador. PID_Temp no funciona con una
ganancia proporcional negativa y tan solo soporta el sentido de regulación normal, es decir, al
aumentar el valor de salida PID (PidOutputSum) debe aumentar el valor real.

Tiempo de integración
El tiempo de integración determina el comportamiento temporal de la acción I. La desconexión
de la acción I se realiza con el tiempo de integración = 0,0. Si el tiempo de integración se
modifica online en el modo de operación "Automático" de un valor cualquiera a 0.0, la acción
I actual se borra y se produce un salto del valor de salida.

Tiempo derivativo
El tiempo de la acción derivada determina el comportamiento temporal de la acción D. La
desconexión de la acción D se realiza con el tiempo derivativo = 0,0.

Coeficiente para el retardo de la acción derivada
El efecto de la acción D se retrasa mediante el coeficiente de retardo de la acción derivada.
Retardo de la acción derivada = Tiempo derivativo x coeficiente de retardo de la acción
derivada
● 0.0: la acción D solo surte efecto para un ciclo y, por ello, casi no es efectiva.
● 0.5: Este valor se ha acreditado en la práctica para sistemas regulados con una constante
de tiempo dominante.
● > 1.0: Cuanto mayor sea el coeficiente, más se retrasará el efecto de la acción D.

Ponderación de la acción P
En el caso de que se modifique la consigna, es posible atenuar la acción P.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción P es totalmente efectiva al cambiar la consigna
● 0.0: La acción P no es efectiva al cambiar la consigna
Si se produce una modificación del valor real, la acción P es totalmente efectiva.

Ponderación de la acción D
En el caso de que se modifique la consigna, es posible atenuar la acción D.
Se recomiendan valores comprendidos entre 0.0 y 1.0.
● 1.0: La acción D es totalmente efectiva cuando se cambia la consigna.
● 0.0: la acción D no es efectiva cuando cambia la consigna.
Si se produce una modificación del valor real, la acción D es totalmente efectiva.

790

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Tiempo de muestreo algoritmo PID
Dado que el sistema regulado necesita cierto tiempo para responder a un cambio del valor de
salida, no es razonable calcular este valor en cada ciclo. El tiempo de muestreo "Algoritmo
PID" es el tiempo que transcurre entre dos cálculos del valor de salida PID. Este se determina
durante la optimización y se redondea a un múltiplo del tiempo de muestreo PID_Temp (tiempo
de ciclo del OB de alarma cíclica). Todas las demás funciones de PID_Temp se ejecutan con
cada llamada.
Si se utiliza OutputHeat_PWM o OutputCool_PWM, el tiempo de muestreo del algoritmo PID
se utiliza como duración de período de la modulación de ancho de impulsos. La precisión de
la señal de salida se determina mediante la relación entre el tiempo de muestreo del algoritmo
PID y el tiempo de ciclo del OB. El tiempo de ciclo debe ser como máximo una décima parte
del tiempo de muestreo del algoritmo PID.
El tiempo de muestreo del algoritmo PID que se utilice como duración de período de la
modulación por ancho de impulso con OutputCool_PWM depende del método seleccionado
en los "Ajustes básicos Salida" para calefacción/refrigeración:
● Si se utiliza el factor de enfriamiento, con OutputCool_PWM también se aplica el "Tiempo
de muestreo del algoritmo PID para calefacción".
● Si se utiliza la conmutación de parámetros PID, el "Tiempo de muestreo del algoritmo PID
para refrigeración" se aplica como duración de período para OutputCool_PWM.
En caso de utilizarse OutputHeat_PWM o OutputCool_PWM, si el tiempo de muestreo del
algoritmo PID y, por tanto, la duración de período de la modulación de ancho de impulsos es
muy larga, en los parámetros Config.Output.Heat.PwmPeriode o
Config.Output.Cool.PwmPeriode se puede especificar una duración de período más corta con
el fin de reducir las fluctuaciones del valor real.

Ancho de zona muerta
Si el valor real está perturbado, la componente de ruido también se verá reflejada en el valor
de salida. Si la ganancia del regulador es elevada y la acción D está activada, el valor de salida
puede variar en gran medida. Si el valor real se encuentra dentro de la zona muerta en torno
a la consigna, el error de regulación se suprime para que el algoritmo PID no reaccione y las
fluctuaciones innecesarias del valor de salida se reduzcan.
El ancho de zona muerta para la calefacción o la refrigeración no se ajusta automáticamente
durante la optimización. El ancho de zona muerta correcto debe configurarse de forma manual.
La desconexión de la zona muerta tiene lugar con un ancho de zona muerta = 0.0.
Si la zona muerta está conectada, es posible ajustar un error de regulación (desviación entre
consigna y valor real) permanente. Esto puede tener un efecto negativo al realizar una
optimización fina.
Si en los ajustes básicos está activada la refrigeración y en los ajustes de salida se ha
seleccionado la conmutación de parámetros PID como método para calefacción/refrigeración,
la zona muerta se encuentra entre "consigna - ancho de zona muerta (calefacción)" y
"consigna + ancho de zona muerta (refrigeración)".
Si en los ajustes básicos está desactivada la refrigeración o bien se utiliza el factor de
enfriamiento, la zona muerta se encuentra justo entre "consigna - ancho de zona muerta
(calefacción)" y "consigna + ancho de zona muerta (calefacción)".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

791

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Si para la ponderación de la acción P o de la acción D se han configurado valores diferentes
de 1.0, los cambios de la consigna también tendrán efecto sobre el valor de salida en la zona
muerta.
Los cambios del valor real comprendidos dentro de la zona muerta no tienen efecto sobre el
valor de salida, independientemente de la ponderación.

5HWDLQ&WUO3DUDPV
+HDW'HDG=RQH

5HWDLQ&WUO3DUDPV
&RRO'HDG=RQH

5HWDLQ&WUO3DUDPV
+HDW'HDG=RQH

Zona muerta con factor de enfriamiento o refrigeración desactivados (izquierda) o con
refrigeración activada y conmutación de parámetros PID (derecha). El eje x / horizontal
muestra el error de regulación = consigna - valor real. El eje y / vertical muestra la señal de
salida de la zona muerta que se transmite al algoritmo PID.

Ancho de zona de regulación
Si el valor real se sale de la zona de regulación que hay en torno a la consigna, se emite el valor
de salida mínimo o máximo. De este modo el valor real alcanza más rápido la consigna.
Si el valor real está dentro de la zona de regulación que hay en torno a la consigna, se calcula
el valor de salida del algoritmo PID.
El ancho de la zona de regulación para calefacción o refrigeración únicamente se ajusta
automáticamente durante la optimización inicial si como estructura de regulador para
calefacción o refrigeración se ha seleccionado "PID (temperatura)".
La desconexión de la zona de regulación tiene lugar con un ancho de zona de regulación =
3.402822e+38.
Si en los ajustes básicos está desactivada la refrigeración o bien se utiliza el factor de
enfriamiento, la zona de regulación se encuentra justo entre "consigna - ancho de zona de
regulación (calefacción)" y "consigna + ancho de zona de regulación (calefacción)".
Si en los ajustes básicos está activada la refrigeración y en los ajustes de salida se ha
seleccionado la conmutación de parámetros PID como método para calefacción/refrigeración,
la zona de regulación se encuentra entre "consigna - ancho de zona de regulación
(calefacción)" y "consigna + ancho de zona de regulación (refrigeración)".

792

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
,QSXW
3LG2XWSXW6XP 
&RQILJ2XWSXW+HDW3LG/RZHU/LPLW
3LG2XWSXW6XP 
&RQILJ2XWSXW&RRO3LG/RZHU/LPLW

6HWSRLQW
5HWDLQ&WUO3DUDPV
+HDW&RQWURO=RQH
6HWSRLQW

3LG2XWSXW6XP 
&RQILJ2XWSXW+HDW3LG8SSHU/LPLW

6HWSRLQW
5HWDLQ&WUO3DUDPV
+HDW&RQWURO=RQH

W

Zona de regulación con factor de enfriamiento o refrigeración desactivados.
,QSXW
3LG2XWSXW6XP 
&RQILJ2XWSXW&RRO3LG/RZHU/LPLW

6HWSRLQW
5HWDLQ&WUO3DUDPV
&RRO&RQWURO=RQH
6HWSRLQW

3LG2XWSXW6XP 
&RQILJ2XWSXW+HDW3LG8SSHU/LPLW

6HWSRLQW
5HWDLQ&WUO3DUDPV
+HDW&RQWURO=RQH
W

Zona de regulación con refrigeración activada y conmutación de parámetros PID.

Regla para la optimización
En la lista desplegable "Estructura del regulador" seleccione si se van a calcular los
parámetros PI o PID. Las reglas de optimización para calefacción y optimización para
refrigeración pueden especificarse por separado.
● PID (temperatura)
Se calcula durante la optimización inicial y la optimización fina del parámetro PID.
La optimización inicial está diseñada para procesos de temperatura y provoca un
comportamiento de regulación más lento y más bien asintótico, con menos
sobreoscilaciones que con la opción "PID". La optimización fina es idéntica que con la
opción "PID".
El ancho de la zona de regulación se determina automáticamente durante la optimización
inicial únicamente si se selecciona esta opción.
● PID
Se calcula durante la optimización inicial y la optimización fina del parámetro PID.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

793

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
● PI
Se calcula durante la optimización inicial y la optimización fina del parámetro PI.
● Definido por el usuario
Si se han ajustado diferentes estructuras del regulador para la optimización inicial y la
optimización fina mediante un programa de usuario o la vista de parámetros, en la lista
desplegable aparece "Definido por el usuario".

3.3.3.3

Puesta en servicio de PID_Temp

Puesta en servicio
La ventana de puesta en servicio ayuda durante la puesta en servicio del regulador PID. En el
visor de curvas se pueden observar la consigna, el valor real y los valores de salida para
calefacción y refrigeración a lo largo del eje de tiempo. En la ventana de puesta en servicio se
soportan las siguientes funciones:
● Optimización inicial del regulador
● Optimización fina del regulador
Utilice la optimización fina si desea realizar un ajuste de precisión del parámetro PID.
● Observación de la regulación en curso en la ventana de curvas
● Prueba del sistema regulado especificando un valor de salida PID manual y una consigna
sustitutiva
● Almacenamiento de los valores actuales de los parámetros PID en el proyecto offline
Para todas las funciones es preciso realizar una conexión online a la CPU.
Mediante los botones "Observar todos"
o "Inicio" del visor de curvas se establece la
conexión online con la CPU, si no estaba ya establecida, y se habilita el manejo de la ventana
de puesta en servicio.

Manejo del visor de curvas
● Seleccione el tiempo de muestreo que desee en la lista desplegable "Tiempo de muestreo".
Todos los valores del visor de curvas se actualizan en el tiempo de muestreo seleccionado.
● Haga clic en el símbolo "Iniciar" del grupo Medición si desea utilizar el visor de curvas.
Se inicia el registro de los valores. En el visor de curvas se registran los valores actuales de
consigna, valor real y valores de salida para calefacción y refrigeración.
● Haga clic en el símbolo "Parar" si desea finalizar el visor de curvas.
Los valores mostrados en el visor de curvas pueden continuar analizándose.
Al cerrar la ventana de puesta en servicio finaliza el registro en el visor de curvas y los valores
registrados se borran.

794

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Optimización inicial
La optimización inicial determina el comportamiento del proceso a un escalón del valor de
salida y busca el punto de inflexión. A partir de la inclinación máxima y del tiempo muerto del
sistema regulado se calculan los parámetros PID óptimos. Para obtener los mejores
parámetros PID, debe efectuarse una optimización inicial y una optimización fina.
Cuanto más estable es el valor real, con mayor facilidad y precisión se pueden calcular los
parámetros PID. Un ruido del valor real es aceptable siempre que la subida del valor real sea
considerablemente mayor que el ruido. Esto tiene más probabilidades de suceder en los
modos "Inactivo" o "Manual". Es preciso realizar una copia de seguridad de los parámetros PID
antes de volver a calcularlos.
PID_Temp ofrece varios tipos de optimización inicial en función de la configuración:
● Optimización inicial calefacción
Se emite un salto en el valor de salida de calefacción, se calculan los parámetros PID para
calefacción y a continuación se ajusta la consigna en el modo automático.
● Optimización inicial de la calefacción y la refrigeración
Se emite un salto en el valor de salida para calefacción.
En cuanto el valor real se encuentra cerca de la consigna, se emite un salto en el valor de
salida para refrigeración.
Se calculan los parámetros PID para calefacción (estructura Retain.CtrlParams.Heat) y
refrigeración (estructura Retain.CtrlParams.Cool) y a continuación se ajusta la consigna en
modo automático.
● Optimización inicial para refrigeración
Se emite un salto en el valor de salida para refrigeración.
Se calculan los parámetros PID para refrigeración y a continuación se ajusta la consigna en
modo automático.
Si quiere optimizar los parámetros PID para calefacción y refrigeración, realizando una
"Optimización inicial calefacción" y seguidamente una "Optimización inicial refrigeración" se
consigue un comportamiento de regulación mejor que realizando una "Optimización inicial
calefacción y refrigeración". Sin embargo, realizar la optimización inicial en dos pasos requiere
más tiempo.

Requisitos generales
● La instrucción PID_Temp se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● Reset = FALSE
● PID_Temp se encuentra en el modo de operación "Inactivo", "Modo manual" o "Modo
automático".
● La consigna y el valor real se encuentran dentro de los límites configurados (ver la
configuración Monitorización de valor real (Página 783)).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

795

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Requisitos para la optimización inicial de la calefacción
● La diferencia entre la consigna y el valor real es mayor del 30% de la diferencia entre el
límite superior e inferior del valor real.
● La diferencia entre la consigna y el valor real es superior al 50% de la consigna.
● La consigna es mayor que el valor real.

Requisitos para la optimización inicial de la calefacción y la refrigeración
● La salida de refrigeración está activada en los "Ajustes básicos" (Config.ActivateCooling =
TRUE).
● La conmutación de parámetros PID está activada en los "Ajustes básicos Valor de salida"
(Config.AdvancedCooling = TRUE).
● La diferencia entre la consigna y el valor real es mayor del 30% de la diferencia entre el
límite superior e inferior del valor real.
● La diferencia entre la consigna y el valor real es superior al 50% de la consigna.
● La consigna es mayor que el valor real.

Requisitos para la optimización inicial para refrigeración
● La salida de refrigeración está activada en los "Ajustes básicos" (Config.ActivateCooling =
TRUE).
● La conmutación de parámetros PID está activada en los "Ajustes básicos Valor de salida"
(Config.AdvancedCooling = TRUE).
● Se ha realizado correctamente una "Optimización inicial calefacción" o una "Optimización
inicial calefacción y refrigeración" (PIDSelfTune.SUT.ProcParHeatOk = TRUE). Debe
utilizarse la misma consigna para todas las optimizaciones.
● La diferencia entre la consigna y el valor real es inferior al 5% de la diferencia entre el límite
superior e inferior del valor real.

Procedimiento
Para poder realizar una optimización inicial, proceda del siguiente modo:
1. En el árbol del proyecto, haga clic en la entrada "PID_Temp > Puesta en servicio".
2. Active el botón "Observar todos"
Se establece una conexión online.

796

o inicie el visor de curvas.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
3. Seleccione la opción de optimización inicial que desee en la lista desplegable "Modo de
ajuste".
4. Haga clic en el símbolo "Start".
– Se inicia la optimización inicial.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los errores
ocurridos. La barra de progreso muestra el progreso del paso actual.
Nota
Si la barra de progreso (variable "Progress") lleva mucho tiempo sin avanzar y se debe
presuponer un bloqueo de la optimización, haga clic en el símbolo "Stop". Compruebe
la configuración del objeto tecnológico y, si procede, vuelva a iniciar la optimización.

Resultado
Si la optimización inicial ha finalizado sin ningún mensaje de error, significa que los parámetros
PID se han optimizado. PID_Temp cambia al modo automático y utiliza los parámetros
optimizados. Los parámetros PID optimizados se conservan al desconectar (Power OFF) y al
rearrancar por completo la CPU.
Si no es posible realizar una optimización inicial, PID_Temp se comporta del modo configurado
en Comportamiento en caso de error.

Optimización fina
La optimización fina genera una oscilación constante y limitada del valor real. Los parámetros
PID se optimizan para el punto de operación a partir de la amplitud y la frecuencia. A partir de
los resultados se vuelven a calcular los parámetros PID. Los parámetros PID existentes
después de la optimización fina muestran en su mayoría un comportamiento de guía y ante
fallos mucho mejor que los parámetros PID de la optimización inicial. Para obtener los mejores
parámetros PID, debe efectuarse una optimización inicial y una optimización fina.
PID_Temp intenta generar automáticamente una oscilación que es mayor que el ruido del valor
real. La estabilidad del valor real ejerce tan solo una mínima influencia sobre la optimización
fina. Es preciso realizar una copia de seguridad de los parámetros PID antes de volver a
calcularlos.
PID_Temp ofrece distintos tipos de optimización fina en función de la configuración:
● Optimización fina para calefacción:
Mediante cambios periódicos en el valor de salida para calefacción, PID_Temp genera una
oscilación del valor real y calcula los parámetros PID para calefacción.
● Optimización fina para refrigeración:
Mediante cambios periódicos en el valor de salida para refrigeración, PID_Temp genera
una oscilación del valor real y calcula los parámetros PID para refrigeración.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

797

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Offset temporal de la optimización para el regulador de calefacción y refrigeración
Si se utiliza PID_Temp como regulador de calefacción y refrigeración (Config.ActivateCooling
= TRUE), el valor de salida PID (PidOutputSum) en la consigna debe cumplir la siguiente
condición para que se genere una oscilación del valor real y la optimización fina pueda llevarse
a cabo correctamente:
● Valor de salida PID positivo para la optimización fina para calefacción
● Valor de salida PID negativo para la optimización fina para refrigeración
Si esta condición no se cumple, es posible especificar un offset temporal para la optimización
fina (este offset se emite en la salida opuesta).
● Offset para la salida de refrigeración (PIDSelfTune.TIR.OutputOffsetCool) en caso de
optimización fina para calefacción.
Antes de iniciar la optimización debe especificarse un valor de offset de optimización para
refrigeración negativo que sea menor que el valor de salida PID (PidOutputSum) de la
consigna en estado estacionario.
● Offset para la salida de calefacción (PIDSelfTune.TIR.OutputOffsetHeat) en caso de
optimización fina para refrigeración.
Antes de iniciar la optimización debe especificarse un valor de offset de optimización para
calefacción positivo que sea mayor que el valor de salida PID (PidOutputSum) de la
consigna en estado estacionario.
Entonces, el algoritmo PID compensa el offset especificado de manera que el valor real se
mantenga en la consigna. A través de la magnitud del offset, el valor de salida PID se puede
adaptar para que cumpla la condición antes mencionada.
Para evitar sobreoscilaciones mayores del valor real al especificar el offset, esta también
puede incrementarse en varios pasos.
Si PID_Temp sale del modo Optimización fina, se restablece el offset de optimización.

Ejemplo: especificación de un offset para Optimización fina refrigeración
● Sin offset
– Consigna (Setpoint) = valor real (ScaledInput) = 80 °C
– Valor de salida PID (PidOutputSum) = 30.0
– Valor de salida para calefacción (OutputHeat) = 30.0
– Valor de salida para refrigeración (OutputCool) = 0.0
La salida de refrigeración por si sola no permite generar una oscilación del valor real en
torno a la consigna. En ese caso fallaría la optimización fina.
● Con offset para la salida de calefacción (PIDSelfTune.TIR.OutputOffsetHeat) = 80.0
– Consigna (Setpoint) = valor real (ScaledInput) = 80 °C
– Valor de salida PID (PidOutputSum) = -50.0
– Valor de salida para calefacción (OutputHeat) = 80.0
– Valor de salida para refrigeración (OutputCool) = -50.0
Especificando un offset para la salida de calefacción, la salida de refrigeración puede
generar una oscilación del valor real en torno a la consigna. De este modo la
optimización fina puede llevarse a cabo correctamente.

798

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Requisitos generales
● La instrucción PID_Temp se llama en un OB de alarma cíclica.
● ManualEnable = FALSE
● Reset = FALSE
● La consigna y el valor real se encuentran dentro de los límites configurados (véase la
configuración "Configuración del valor real").
● El lazo de regulación es estacionario en el punto de operación. El punto de operación se ha
alcanzado cuando el valor real coincide con la consigna.
Si la zona muerta está conectada, es posible ajustar un error de regulación (desviación
entre consigna y valor real) permanente. Esto puede tener un efecto negativo al realizar la
optimización fina.
● No se esperan perturbaciones.
● PID_Temp se encuentra en el modo de operación inactivo, automático o manual.

Requisitos para Optimización fina calefacción
● Heat.EnableTuning = TRUE
● Cool.EnableTuning = FALSE
● Si PID_Temp está configurado como regulador de calefacción y refrigeración
(Config.ActivateCooling = TRUE), la salida de calefacción debe estar activa en el punto de
operación donde vaya a realizarse la optimización.
PidOutputSum > 0.0 (ver Offset de optimización)

Requisitos para Optimización fina refrigeración
● Heat.EnableTuning = FALSE
● Cool.EnableTuning = TRUE
● La salida de refrigeración está activada (Config.ActivateCooling = TRUE).
● La conmutación de parámetros PID está activada (Config.AdvancedCooling = TRUE).
● La salida de refrigeración debe estar activa en el punto de operación donde vaya a
realizarse la optimización.
PidOutputSum < 0.0 (ver Offset de optimización)

El proceso depende de la situación de inicio
La optimización fina puede iniciarse desde los modos de operación "Inactivo", "Automático" o
"Manual".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

799

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
La optimización fina se desarrolla del modo siguiente en el momento del inicio:
● Modo automático con PIDSelfTune.TIR.RunIn = FALSE (ajuste predeterminado)
Si desea mejorar los parámetros PID existentes mediante optimización, inicie la
optimización fina desde el modo automático.
PID_Temp regula con los parámetros PID existentes hasta que el lazo de regulación es
estacionario y se cumplen las condiciones para la optimización fina. Solo entonces
comienza la optimización fina.
● Modo inactivo, modo manual o modo automático con PIDSelfTune.TIR.RunIn = TRUE
Se intenta alcanzar la consigna con el valor de salida mínimo o máximo (regulación de dos
puntos):
– con el valor de salida mínimo o máximo para calefacción en caso de optimización fina
para calefacción.
– con el valor de salida mínimo o máximo para refrigeración en caso de optimización fina
para refrigeración.
Esto puede ocasionar una sobreoscilación muy alta. La optimización fina comienza cuando
se alcanza la consigna.
Si no es posible alcanzar la consigna, PID_Temp no cancela automáticamente la
optimización.

Procedimiento
Para poder realizar una optimización fina, proceda del siguiente modo:
1. En el árbol del proyecto, haga doble clic en la entrada "PID_Temp > Puesta en servicio".
2. Active el botón "Observar todos"
Se establece una conexión online.

o inicie el visor de curvas.

3. Seleccione la opción de optimización fina que desee en la lista desplegable "Modo de
ajuste".

800

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
4. Si es necesario (ver Offset de optimización), especifique un offset de optimización y espere
a que se alcance de nuevo el estado estacionario.
5. Haga clic en el símbolo "Start".
– Se inicia el proceso de optimización fina.
– En el campo "Estado" se muestran los pasos actuales y, de haberlos, los errores
ocurridos.
La barra de progreso muestra el progreso del paso actual.
Nota
En el grupo "Modo de ajuste", haga clic en el símbolo "Stop" si la barra de progreso (variable
"Progress") lleva mucho tiempo sin avanzar y se debe presuponer un bloqueo de la
optimización. Compruebe la configuración del objeto tecnológico y, si procede, vuelva a
iniciar la optimización.
En particular en las fases siguientes, la optimización no se cancela de forma automática si
no es posible alcanzar la consigna.
● "Intentar alcanzar la consigna para la calefacción con regulación de dos puntos."
● "Intentar alcanzar la consigna para la refrigeración con regulación de dos puntos."

Resultado
Si durante la optimización fina no se produjeron errores, significa que los parámetros PID se
optimizaron. PID_Temp pasa al modo automático y utiliza los parámetros optimizados. Los
parámetros PID optimizados se conservan al desconectar (Power OFF) y al rearrancar por
completo la CPU.
Si se han producido errores durante la optimización fina, PID_Temp se comporta del modo
configurado en Comportamiento en caso de error.

Modo de operación "Modo manual"
A continuación se describe cómo utilizar el modo de operación "Modo manual" en la ventana
de puesta en servicio del objeto tecnológico "PID_Temp".
El modo manual es posible aunque haya un error pendiente.

Requisitos
● La instrucción "PID_Temp" se llama en un OB de alarma cíclica.
● Se ha establecido una conexión online con la CPU.
● La CPU se encuentra en el estado operativo "RUN".

Procedimiento
Si quiere probar el sistema regulado especificando un valor manual, utilice el "Modo manual"
en la ventana de puesta en servicio.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

801

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Para especificar un valor manual, proceda del siguiente modo:
1. En el árbol del proyecto, haga doble clic en la entrada "PID_Temp > Puesta en servicio".
2. Active el botón "Observar todos"
Se establece una conexión online.

o inicie el visor de curvas.

3. Active la casilla de verificación "Modo manual" en el área "Estado online del regulador".
PID_Temp opera en modo manual. El último valor de salida actual permanece activo.
4. Introduzca el valor manual en la unidad % en el campo editable.
Si está activada la refrigeración en los ajustes básicos, introduzca el valor manual de la
siguiente manera:
– Para emitir el valor en las salidas para calefacción, introduzca un valor manual positivo.
– Para emitir el valor en las salidas para refrigeración, introduzca un valor manual
negativo.
5. Haga clic en el símbolo

.

Resultado
El valor manual se escribe en la CPU y es efectivo de forma inmediata.
Desactive la casilla de verificación "Modo manual" si desea que el regulador PID vuelva a
especificar el valor de salida.
El cambio al modo automático se efectúa sin discontinuidad.

Consigna sustitutiva
A continuación se describe cómo utilizar la consigna sustitutiva en la ventana de puesta en
servicio del objeto tecnológico "PID_Temp".

Requisitos
● La instrucción "PID_Temp" se llama en un OB de alarma cíclica.
● Se ha establecido una conexión online con la CPU.
● La CPU se encuentra en el estado operativo "RUN".

Procedimiento
Si temporalmente quiere utilizar como consigna un valor distinto al del parámetro "Setpoint"
(p. ej., para optimizar un esclavo en una cascada), utilice la consigna sustitutiva en la ventana
de puesta en servicio.
Para especificar una consigna sustitutiva, proceda del siguiente modo:
1. En el árbol del proyecto, haga doble clic en la entrada "PID_Temp > Puesta en servicio".
2. Active el botón "Observar todos"
Se establece una conexión online.

802

o inicie el visor de curvas.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
3. Active la casilla de verificación "Subst.Setpoint" en el área "Estado online del regulador".
La consigna sustitutiva (variable SubstituteSetpoint) se inicializa con la última consigna
actual y se utiliza ahora.
4. Introduzca la consigna sustitutiva en el campo editable.
5. Haga clic en el símbolo

.

Resultado
La consigna sustitutiva se escribe en la CPU y es efectiva de forma inmediata.
Desactive la casilla de verificación "Subst.Setpoint" cuando de nuevo quiera utilizar como
consigna el valor del parámetro "Setpoint".
El cambio no tiene lugar sin discontinuidad.

Puesta en servicio en cascada
Para más información sobre la puesta en servicio en cascada con PID_Temp, ver Puesta en
servicio (Página 808).

3.3.3.4

Regulación en cascada con PID_Temp

Introducción
Para la regulación en cascada se imbrican varios lazos de regulación entre sí. Las consignas
(Setpoint) de los esclavos son los valores de salida (OutputHeat) de los respectivos maestros
superiores.
La condición para establecer una conexión en cascada es que el sistema regulado pueda
dividirse en sistemas parciales, cada uno de ellos con una magnitud propia.
La especificación de consigna para la variable regulada se lleva a cabo en el maestro más
exterior.
El valor de salida del esclavo más interior se aplica en el actuador y actúa sobre el sistema
regulado.
El uso de una regulación en cascada ofrece las siguientes ventajas principales en
comparación con un lazo de regulación simple:
● Al haber más lazos de regulación subordinados, los errores que ocurren se corrigen más
rápido. Su influencia en la variable regulada disminuye considerablemente. Esto mejora el
comportamiento ante fallos.
● Los lazos de regulación subordinados tienen un efecto linealizante. Esto reduce las
consecuencias negativas de tales faltas de linealidad sobre la variable regulada.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

803

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
PID_Temp ofrece las siguientes funciones especialmente para uso en regulaciones en
cascada:
● especificación de una consigna sustitutiva;
● intercambio de información de estado entre maestro y esclavo (p. ej., modo de operación
actual);
● varios modos Anti-Wind-Up (reacción del maestro a la limitación de sus esclavos).

Ejemplo
El siguiente diagrama de bloques muestra una regulación en cascada con PID_Temp tomando
como ejemplo el proceso simplificado de un fundidor de chocolate:
7HPS&KRFRODWH
7HPS:DWHU

3,'B7HPSB

3,'B7HPSB

,QSXW

2XWSXW+HDW

,QSXW

2XWSXW+HDW

6HWSRLQW

2XWSXW&RRO

6HWSRLQW

2XWSXW&RRO

3,'B7HPSB
6ODYH

0DVWHU
6ODYH

&KRFRODWH
:DWHU

0DVWHU
6ODYH

,V0DVWHU
758(
,V6ODYH
)$/6(
&RXQW6ODYHV


,V0DVWHU
,V6ODYH
&RXQW6ODYHV

)$/6(
758(


El maestro PID_Temp_1 compara el valor real de la temperatura del chocolate
(TempChocolate) con la consigna especificada por el usuario con el parámetro Setpoint. El
valor de salida OutputHeat es la consigna del esclavo PID_Temp_2.
PID_Temp_2 intenta que el valor real de la temperatura del baño María (TempWater) llegue
hasta esa consigna. El valor de salida de PID_Temp_2 se aplica directamente sobre el
actuador del sistema regulado (calefacción del baño María) y de este modo influye en la
temperatura del agua. A su vez, la temperatura del agua influye en la temperatura del
chocolate.

Preguntas frecuentes (FAQ)
Para más información al respecto, consulte la siguiente pregunta frecuente (FAQ) en el
Siemens Industry Online Support:
● ID de artículo 103526819 (https://support.industry.siemens.com/cs/ww/en/view/
103526819)

804

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Consulte también
Creación del programa (Página 805)

Creación del programa
A la hora de crear el programa deben tenerse en cuenta los siguientes puntos:
● Número de instancias de PID_Temp
Deben llamarse tantas instancias PID_Temp diferentes en un OB de alarma cíclica como
magnitudes concatenadas haya en el proceso.
En el ejemplo hay dos magnitudes concatenadas: TempChocolate y TempWater. Por lo
tanto, se necesitan dos instancias PID_Temp.
● Orden de llamada
El maestro debe llamarse antes que sus esclavos en el mismo OB de alarma cíclica.
Primero se llama al maestro más exterior, en el que se especifica la consigna de usuario.
A continuación se llama al esclavo cuya consigna procede de ese maestro más exterior, y
así sucesivamente.
El esclavo más interior, cuyo valor de salida se aplica al actuador del proceso, es el último
en ser llamado.
En el ejemplo se llama a PID_Temp_1 antes que a PID_Temp_2.
● Interconexión de las magnitudes
El maestro más exterior se interconecta con la magnitud más exterior, que debe regularse
hasta coincidir con la consigna de usuario.
El esclavo más interior se interconecta con la magnitud más interior, que recibe la influencia
directa del actuador.
La interconexión de las magnitudes con PID_Temp se lleva a cabo con los parámetros Input
o Input_PER.
En el ejemplo, la magnitud exterior TempChocolate se interconecta con PID_Temp_1, y la
magnitud interior TempWater se interconecta con PID_Temp_2.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

805

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
● Interconexión del valor de salida del maestro con la consigna del esclavo
El valor de salida (OutputHeat) de un maestro debe asignarse a la consigna (Setpoint) de
su esclavo.
Esta interconexión puede realizarse manualmente en el editor de programación o bien
automatizarse en la ventana de inspección del esclavo, seleccionando al maestro en los
ajustes básicos.
Si es necesario, pueden añadirse funciones de filtro o escalado propias, p. ej., para adaptar
el rango de valores de salida del maestro al rango de consignas/valores reales del esclavo.
En el ejemplo, OutputHeat de PID_Temp_1 se asigna a Setpoint de PID_Temp_2.
● Interconexión de la interfaz para el intercambio de información entre maestro y esclavo
El parámetro "Slave" de un maestro debe asignarse al parámetro "Master" de todos los
esclavos directamente subordinados (que reciben su consigna de ese maestro). Para
poder interconectar un maestro con varios esclavos y visualizar la interconexión en la
ventana de inspección del esclavo en los ajustes básicos, debe realizarse la asignación a
través de la interfaz del esclavo.
Esta interconexión puede realizarse manualmente en el editor de programación o bien
automatizarse en la ventana de inspección del esclavo, seleccionando al maestro en los
ajustes básicos.
La funcionalidad Anti-Wind-Up y la evaluación de los modos de operación de esclavo en el
maestro solo pueden funcionar correctamente si se ha realizado esa interconexión.
En el ejemplo, el parámetro "Slave" de PID_Temp_1 se asigna al parámetro "Master" de
PID_Temp_2.
Código de programa del ejemplo en lenguaje SCL (sin asignación del valor de salida del
esclavo al actuador):
"PID_Temp_1"(Input:="TempChocolate");
"PID_Temp_2"(Input:="TempWater", Master := "PID_Temp_1".Slave,
Setpoint := "PID_Temp_1".OutputHeat);

Configuración
La configuración puede realizarse a través del programa de usuario, el editor de configuración
o la ventana de inspección de la llamada a PID_Temp.
A la hora de utilizar PID_Temp en una regulación en cascada, debe tenerse en cuenta la
correcta configuración de los ajustes mencionados a continuación.
Si una instancia PID_Temp recibe su consigna de un maestro superior y transmite su valor de
salida a un esclavo inferior, esa instancia PID_Temp es maestro y esclavo al mismo tiempo.
Para esa instancia PID_Temp deben realizarse las dos configuraciones descritas a
continuación. Esto es lo que ocurre, por ejemplo, con la instancia PID_Temp central de una
regulación en cascada con tres magnitudes concatenadas y tres instancias PID_Temp.

806

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Configuración de un maestro
Ajuste en el editor de configuración o la
ventana de inspección

Parámetro del DB

Explicación

Ajustes básicos → Cascada:

Config.Cascade.IsMaster =
TRUE

Activa ese regulador como maestro en una cas‐
cada.

Config.Cascade.CountSlaves

Número de esclavos

Número de esclavos directamente subordina‐
dos que reciben sus consignas de ese maestro.

Ajustes básicos → Parámetros de entra‐ Config.Output.Heat.Select = 0
da/salida:

El maestro utiliza exclusivamente el parámetro
de salida OutputHeat.

Selección del valor de salida (calefac‐
ción) = OutputHeat

OutputHeat_PWM y OutputHeat_PER están de‐
sactivados.

Ajustes básicos → Parámetros de entra‐ Config.ActivateCooling = FAL‐
SE
da/salida:

En un maestro, la refrigeración debe estar de‐
sactivada.

Activar la casilla de verificación "El re‐
gulador es maestro"
Ajustes básicos → Cascada:

Desactivar la casilla de verificación "Ac‐
tivar refrigeración"
Ajustes de la salida → Límites y escala
del valor de salida → OutputHeat / Out‐
putCool:
Límite inferior del valor de salida PID
(calefacción),
Límite superior del valor de salida PID
(calefacción),
Valor de salida inferior escalado (cale‐
facción),
Valor de salida superior escalado (cale‐
facción)
Esta variable no está disponible en la
ventana de inspección ni en la vista de
funciones del editor de configuración.
Puede modificarse a través de la vista
de parámetros del editor de configura‐
ción.

Config.Output.Heat.PidLower‐
Limit,
Config.Output.Heat.PidUpper‐
Limit,
Config.Output.Heat.LowerSca‐
ling,

Si al asignar OutputHeat del maestro a Setpoint
del esclavo no se utiliza una función de escalado
propia, puede que sea necesario adaptar los lí‐
mites y la escala del valor de salida del maestro
al rango de consignas/valores reales del escla‐
vo.

Config.Output.Heat.UpperSca‐
ling

Config.Cascade.AntiWindUp‐
Mode

El modo Anti-Wind-Up determina cómo se trata
la acción I de ese maestro si los esclavos direc‐
tamente subordinados alcanzan sus límites de
valor de salida.
Posibilidades:
● AntiWindUpMode = 0:
La funcionalidad AntiWindUp está
desactivada. El maestro no reacciona
cuando sus esclavos están en el límite.
● AntiWindUpMode = 1 (ajuste
predeterminado):
La acción I del maestro se reduce en la
proporción "esclavos en el límite / número de
esclavos". De este modo se reducen las
repercusiones de la limitación en el
comportamiento de regulación.
● AntiWindUpMode = 2:
La acción I del maestro se detiene en cuanto
un esclavo está en la limitación.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

807

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)

Configuración de un esclavo
Ajuste en el editor de configuración o la
ventana de inspección

Parámetro del DB

Explicación

Ajustes básicos → Cascada:

Config.Cascade.IsSlave =
TRUE

Activa ese regulador como esclavo en una cas‐
cada.

Activar la casilla de verificación "El re‐
gulador es esclavo"

Puesta en servicio
Después de compilar y cargar el programa, puede iniciarse la puesta en marcha de la
regulación en cascada.
Comience la puesta en marcha (ejecución de una optimización o cambio al modo automático
con parámetros PID existentes) con el esclavo más interior y continúe hacia fuera hasta llegar
al maestro más exterior.
En el ejemplo anterior, la puesta en servicio comienza con PID_Temp_2 y prosigue con
PID_Temp_1.

Optimización del esclavo
La optimización de PID_Temp requiere una consigna constante. Por lo tanto, para optimizar un
esclavo hay que activar su consigna sustitutiva (variables SubstituteSetpoint y
SubstituteSetpointOn) o poner el maestro correspondiente en modo manual con el valor
manual correspondiente. De esta forma se garantiza que la consigna del esclavo permanezca
constante durante la optimización.

Optimización del maestro
Para que un maestro pueda influir en el proceso o realizar una optimización, todos los esclavos
posteriores deben estar en modo automático y haber desactivado la consigna sustitutiva. A
través de la interfaz para intercambio de información entre maestro y esclavo (parámetros
Master y Slave), un maestro evalúa estas condiciones y muestra el estado actual en las
variables AllSlaveAutomaticState y NoSlaveSubstituteSetpoint. En el editor de puesta en
marcha se emiten los avisos de estado correspondientes.
Aviso de estado en el editor de puesta
en servicio del maestro

Parámetro de DB del maestro

Uno o varios esclavos no están en modo AllSlaveAutomaticState = FAL‐
automático.
SE,
NoSlaveSubstituteSetpoint =
TRUE
Uno o varios esclavos han activado la
consigna sustitutiva.

AllSlaveAutomaticState =
TRUE,
NoSlaveSubstituteSetpoint =
FALSE

Uno o varios esclavos no están en modo AllSlaveAutomaticState = FAL‐
automático y han activado la consigna SE,
sustitutiva.
NoSlaveSubstituteSetpoint =
FALSE

808

Solución
Realice primero la puesta en servicio de todos
los esclavos posteriores.
Antes de realizar una optimización o de activar
el modo manual o automático del maestro, ase‐
gúrese de que se cumplen las condiciones si‐
guientes:
● Todos los esclavos siguientes están en
modo automático (State = 3).
● Todos los esclavos posteriores tienen la
consigna sustitutiva desactivada
(SubstituteSetpointOn = FALSE).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Si se inicia una optimización inicial o una optimización fina para un maestro, PID_Temp
cancela la optimización y muestra un error con ErrorBits = DW#16#0200000 en los casos
siguientes:
● Uno o varios esclavos no están en modo automático (AllSlaveAutomaticState = FALSE).
● Uno o varios esclavos han activado la consigna sustitutiva (NoSlaveSubstituteSetpoint =
FALSE).
El siguiente cambio de modo de operación depende de ActivateRecoverMode.

Consigna sustitutiva
Para la especificación de una consigna, PID_Temp ofrece, además del parámetro Setpoint,
una consigna sustitutiva en la variable SubstituteSetpoint. Esta puede activarse con
SubstituteSetpointOn = TRUE o marcando la casilla de verificación correspondiente en el
editor de puesta en servicio.
Con la consigna sustitutiva se puede especificar la consigna directamente en el esclavo de
forma temporal, p. ej., para la puesta en servicio u optimización.
Para ello, en el programa no debe modificarse la interconexión del valor de salida del maestro
con la consigna del esclavo (interconexión necesaria para el funcionamiento normal de la
regulación en cascada).
Para que un maestro pueda influir en el proceso o realizar una optimización, todos los esclavos
posteriores deben haber desactivado la consigna sustitutiva.
La consigna actualmente activa, utilizada por el algoritmo PID para el cálculo, puede verse en
la variable CurrentSetpoint.

Modos de operación y reacción a fallo
El maestro o esclavo de una instancia PID_Temp no cambian el modo de operación de dicha
instancia PID_Temp.
Si se produce un error en uno de sus esclavos, el maestro permanece en su modo de
operación actual.
Si se produce un error en su maestro, el esclavo permanece en su modo de operación actual.
Sin embargo, el funcionamiento posterior del esclavo depende del error y de la reacción a fallo

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

809

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
configurada en el maestro, ya que el valor de salida del maestro se utiliza como consigna del
esclavo:
● Si en el maestro está configurado ActivateRecoverMode = TRUE y el error no impide el
cálculo de OutputHeat, el error no afecta al esclavo.
● Si en el maestro está configurado ActivateRecoverMode = TRUE y el error impide el cálculo
de OutputHeat, el maestro, en función de SetSubstituteOutput, emite el último valor de
salida válido o el valor de salida sustitutivo configurado SubstituteOutput. Este valor es
utilizado por el esclavo como consigna.
PID_Temp está preajustado de manera que en este caso se emite el valor de salida
sustitutivo 0.0 (ActivateRecoverMode = TRUE, SetSubstituteOutput = TRUE,
SubstituteOutput = 0.0). Configure para su aplicación un valor de salida sustitutivo
adecuado o bien active el uso del último valor de salida PID válido (SetSubstituteOutput =
FALSE).
● Si en el maestro está configurado ActivateRecoverMode = FALSE, en caso de fallo el
maestro cambia al modo de operación "Inactivo" y emite OutputHeat = 0.0. El esclavo utiliza
0.0 como consigna.
La reacción a fallo puede consultarse en los ajustes de salida, en el editor de configuración.

3.3.3.5

Regulación multizona con PID_Temp

Introducción
La regulación multizona consiste en que varias subáreas de una instalación, llamadas zonas,
se regulan simultáneamente a temperaturas diferentes. La característica de la regulación
multizona es la influencia mutua de las zonas de temperatura mediante acoplamiento térmico,
es decir, el valor real de una zona puede influir en el valor real de otra zona debido al
acoplamiento térmico. El efecto de esta influencia depende del diseño de la instalación y de los
puntos de operación seleccionados en las zonas.
Ejemplo: una extrusora de las que se utilizan para la transformación de plásticos, entre otras
cosas.
Para que la transformación se lleve a cabo de manera óptima, la mezcla que pasa por la
extrusora debe regularse a temperaturas diferentes. Así, por ejemplo, en la zona de llenado de
la extrusora pueden necesitarse temperaturas diferentes que en la tobera de salida. Las
distintas zonas de temperatura influyen unas en otras debido al acoplamiento térmico.
Si se utiliza PID_Temp en regulaciones multizona, cada zona de temperatura es regulada por
una instancia PID_Temp propia.
Debe tener en cuenta las indicaciones siguientes cuando utilice PID_Temp en una regulación
multizona.

Optimización inicial separada para calefacción y refrigeración
La primera puesta en servicio de una instalación generalmente comienza con una optimización
inicial, para realizar un primer ajuste de los parámetros PID y para regular el punto de
operación. La optimización inicial para regulaciones multizona suele realizarse
simultáneamente para todas las zonas.

810

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Para reguladores con refrigeración activada y conmutación de parámetros PID como método
para calefacción/refrigeración (Config.ActivateCooling = TRUE, Config.AdvancedCooling =
TRUE), PID_Temp ofrece la posibilidad de realizar la optimización inicial para calefacción y
refrigeración en un solo paso (Mode = 1, Heat.EnableTuning = TRUE, Cool.EnableTuning =
TRUE).
No obstante, se recomienda no utilizar esta optimización en caso de optimización inicial
simultánea de varias instancias PID_Temp en una regulación multizona. En lugar de ello,
realice la optimización inicial para calefacción (Mode = 1, Heat.EnableTuning = TRUE,
Cool.EnableTuning = FALSE) y la optimización inicial para refrigeración (Mode = 1,
Heat.EnableTuning = FALSE, Cool.EnableTuning = TRUE) por separado.
La optimización inicial para refrigeración no debe iniciarse hasta que todas las zonas hayan
concluido la optimización inicial para calefacción y hayan alcanzado su punto de operación.
De esta manera, se reducen las influencias mutuas debidas a acoplamientos térmicos entre
las zonas durante la optimización.

Adaptación del tiempo de retardo
Si se utiliza PID_Temp en una regulación multizona con fuertes acoplamientos térmicos entre
las zonas, hay que cerciorarse de que la adaptación del tiempo de retardo para la optimización
inicial esté desactivada con PIDSelfTune.SUT.AdaptDelayTime = 0. De lo contrario, la
determinación del tiempo de retardo puede verse falseada si durante la adaptación del tiempo
de retardo (la calefacción está desactivada en esa fase) se impide la refrigeración de esa zona
debido a la entrada de calor procedente de otras zonas.

Desconexión temporal de la refrigeración
Para reguladores con refrigeración activada (Config.ActivateCooling = TRUE), PID_Temp
ofrece la posibilidad de desactivar temporalmente la refrigeración en modo automático
ajustando DisableCooling = TRUE.
De esta manera durante la puesta en servicio puede impedirse que ese regulador enfríe en
modo automático mientras los reguladores de otras zonas todavía no han concluido la
optimización de la calefacción. Si eso ocurriera, la optimización podría verse afectada
negativamente debido al acoplamiento térmico entre las zonas.

Procedimiento
Para la puesta en servicio de regulaciones multizona con acoplamientos térmicos relevantes,
puede proceder del siguiente modo:
1. Para todos los reguladores con refrigeración activada, ajuste DisableCooling = TRUE.
2. Para todos los reguladores, ajuste PIDSelfTune.SUT.AdaptDelayTime = 0.
3. Especifique las consignas que desee (parámetro Setpoint) e inicie simultáneamente para
todos los reguladores la optimización inicial para calefacción (Mode = 1,
Heat.EnableTuning = TRUE, Cool.EnableTuning = FALSE).
4. Espere a que todos los reguladores hayan concluido la optimización inicial de la calefacción.
5. Para todos los reguladores con refrigeración activada, ajuste DisableCooling = FALSE.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

811

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
6. Espere a que los valores reales de todas las zonas se hayan estabilizado y estén próximos
a las consignas correspondientes.
Si en una zona no es posible alcanzar la consigna de manera permanente, significa que el
actuador de calefacción o refrigeración está infradimensionado.
7. Para todos los reguladores con refrigeración activada, inicie la optimización inicial de la
refrigeración (Mode = 1, Heat.EnableTuning = FALSE, Cool.EnableTuning = TRUE).
Nota
Rebase de los límites del valor real
Si la refrigeración en modo automático se desactiva con DisableCooling = TRUE, puede ocurrir
que el valor real rebase la consigna y los límites de valor real mientras DisableCooling = TRUE.
Observe los valores reales y esté preparado para intervenir si utiliza DisableCooling.
Nota
Regulaciones multizona
En las regulaciones multizona, los acoplamientos térmicos entre las zonas pueden causar
fuertes sobreoscilaciones, rebasamientos permanentes o transitorios de valores límite, y
errores de regulación permanentes o transitorios durante la puesta en servicio y durante el
funcionamiento. Observe los valores reales y esté preparado para intervenir. Dependiendo de
la instalación, puede que sea necesario actuar de manera diferente al procedimiento descrito.

Sincronización de varias optimizaciones finas
Si la optimización fina se inicia desde el modo automático con PIDSelfTune.TIR.RunIn =
FALSE, PID_Temp intenta alcanzar la consigna con regulación PID y con los parámetros PID
actuales. La optimización propiamente dicha no comienza hasta que se alcanza la consigna.
El tiempo necesario para alcanzar la consigna puede diferir en las diferentes zonas de una
regulación multizona.
Si se quiere realizar la optimización fina para varias zonas a la vez, PID_Temp ofrece la
posibilidad de sincronizarlas retrasando el resto de los pasos de optimización hasta que se
alcance la consigna.

Procedimiento
De esta manera puede asegurarse de que todos los reguladores hayan alcanzado su consigna
cuando comiencen los pasos de optimización propiamente dichos. Así se reducen las
influencias mutuas debidas a acoplamientos térmicos entre las zonas durante la optimización.
Con los reguladores para cuyas zonas quiera realizar la optimización fina de manera
simultánea, proceda del siguiente modo:
1. Ajuste PIDSelfTune.TIR.WaitForControlIn = TRUE para todos los reguladores.
Esos reguladores deben estar en modo automático con PIDSelfTune.TIR.RunIn = FALSE.
2. Especifique las consignas que desee (parámetro Setpoint) e inicie la optimización fina para
todos los reguladores.

812

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
3. Espere hasta que en todos los reguladores esté ajustado PIDSelfTune.TIR.ControlInReady
= TRUE.
4. Ajuste PIDSelfTune.TIR.FinishControlIn = TRUE Para todos los reguladores.
Todos los reguladores inician la optimización en sí simultáneamente.

3.3.3.6

Regulación de transición con PID_Temp

Regulación de transición
En caso de regulación de transición, dos o más reguladores comparten un actuador común. En
cada instante, solo un regulador tiene acceso al actuador y actúa sobre el proceso.
Una lógica decide qué regulador obtiene acceso al actuador. A menudo, esta decisión se toma
en función de una comparación de los valores de salida de todos los reguladores, p. ej., el
regulador con el mayor valor de salida obtiene acceso al actuador en caso de selección del
máximo.
La selección en función del valor de salida hace necesario que todos los reguladores funcionen
en el modo automático. Los reguladores que no tengan efecto sobre el actuador se corrigen.
Esto es necesario para evitar los efectos de Windup y sus repercusiones negativas sobre el
comportamiento de regulación y la conmutación entre los reguladores.
A partir de la versión 1.1, PID_Temp soporta regulaciones de transición, pues el regulador
ofrece un procedimiento simplificado para corregir el regulador no activo: mediante las
variables OverwriteInitialOutputValue y PIDCtrl.PIDInit es posible preasignar la acción I del
regulador en el modo automático como si el algoritmo PID hubiera calculado PidOutputSum =
OverwriteInitialOutputValue para el valor de salida PID en el último ciclo. Para ello,
OverwriteInititalOutputValue se interconecta con el valor de salida PID del regulador que tenga
acceso en este momento al actuador. Ajustando el bit PIDCtrl.PIDInit se lanza la preasignación
de la acción I, así como el reinicio del ciclo del regulador y el período de PWM. El subsiguiente
cálculo del valor de salida PID en el ciclo actual se realiza basándose en la acción I
preasignada (e igualada para todos los reguladores), así como en la acción P e I del actual
error de regulación. La acción D no está activa durante la llamada con PIDCtrl.PIDInit = TRUE
y, por tanto, no contribuye al valor de salida.
Este procedimiento garantiza que el cálculo del valor de salida PID actual y, con ello, la
decisión sobre qué regulador tiene acceso al actuador solo tengan lugar considerando el
estado actual del proceso y los parámetros PI. Así se evitan los efectos de Windup en los
reguladores no activos y, con ello, las decisiones erróneas de la lógica de conmutación.

Requisitos
● PIDCtrl.PIDInit solo es efectivo si la acción I está activada (variables
Retain.CtrlParams.Heat.Ti y Retain.CtrlParams.Cool.Ti > 0.0).
● Debe asignar PIDCtrl.PIDInit y OverwriteInitialOutputValue usted mismo en su programa
de usuario (ver ejemplo más abajo). PID_Temp no realiza ningún cambio automático en
estas variables.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

813

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
● PIDCtrl.PIDInit solo es efectivo si PID_Temp se encuentra en el modo automático
(parámetro State = 3).
● Si es posible, seleccione el tiempo de muestreo del algoritmo PID (variables
Retain.CtrlParams.Heat.Cycle y Retain.CtrlParams.Cool.Cycle) de forma que sea idéntico
para todos los reguladores y llame todos los reguladores en el mismo OB de alarma cíclica.
De esta forma se asegurará de que la conmutación no suceda dentro de un ciclo de
regulador o de un período de PWM.
Nota
Adaptación continua de los límites de los valores de salida
En lugar de la corrección activa de reguladores sin acceso al actuador aquí descrita, en otros
sistemas de regulador se realiza alternativamente una adaptación continua de los límites de
los valores de salida.
Esto no es posible con PID_Temp, pues no se soporta el cambio de los límites de los valores
de salida en el modo automático.

Ejemplo: regulación de una gran caldera
PID_Temp se utiliza para la regulación de una gran caldera
El objetivo principal es regular la temperatura Input1. Para ello se utiliza el regulador
PID_Temp_1. Además, con el regulador de limitación PID_Temp_2 debe mantenerse la
temperatura Input2 en un punto de medición adicional por debajo de un límite superior.
Las dos temperaturas se modifican a través de una única calefacción. El valor de salida del
regulador se corresponde con la potencia de calefacción.

Input1

PID_Temp_1

<
Input2

PID_Temp_2

La calefacción se acciona mediante el valor de salida modulado por ancho de impulso de
PID_Temp (parámetro OutputHeat_PWM), escribiendo la variable de programa ActuatorInput.

814

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
La preasignación de la consigna para la temperatura Input1 se realiza en el parámetro
PID_Temp_1.Setpoint. El límite superior de temperatura para el punto de medición adicional
se preasigna como consigna en el parámetro PID_Temp_2.Setpoint.
Input1

PID_Temp_1
Input

OutputHeat_PWM

Setpoint

PidOutputSum

1

ActuatorInput

0

PIDCtrl.PIDInit
OverwriteInitial
OutputValue

<

PID_Temp_2
Input

OutputHeat_PWM

Setpoint

PidOutputSum

1

0

PIDCtrl.PIDInit
OverwriteInitial
OutputValue

Input2

Ambos reguladores disponen únicamente de una calefacción como actuador común. La lógica
que decide qué regulador obtiene acceso al actuador se implementa aquí a través de una
selección de mínimo del valor de salida PID (en formato Real, parámetro PidOutputSum).
Puesto que el valor de salida PID corresponde a la potencia de calefacción, el regulador
obtiene el control que requiere la menor potencia de calefacción.
En el funcionamiento normal de la instalación, el valor real de la magnitud regulada principal
corresponde a la consigna. El regulador principal PID_Temp_1 se ha estabilizado en un valor
de salida PID estacionario PID_Temp_1.PidOutputSum. En el modo normal, el valor real del
regulador de limitación Input2 está claramente por debajo del límite superior que se ha
preasignado como consigna para für PID_Temp_2. Por tanto, el regulador de limitación debe
seguir aumentando la potencia de calefacción para aumentar su valor real, es decir, calculará
un valor de salida PID PID_Temp_2.PidOutputSum que será superior al del regulador principal
PID_Temp_1.PidOutputSum. Por tanto, la selección mínima de la lógica de conmutación sigue
permitiendo al regulador principal PID_Temp_1 el acceso al actuador. Además, mediante las
asignaciones PID_Temp_2.OverwriteInitialOutputValue = PID_Temp_1.PidOutputSum y
PID_Temp_2.PIDCtrl.PIDInit = TRUE se garantiza que se corregirá PID_Temp_2.
Si ahora Input2 se acerca al límite superior o lo rebasa, por ejemplo, debido a una avería, el
regulador de limitación PID_Temp_2 calculará un valor de salida PID menor para seguir
moderando la potencia de calefacción y así reducir Input2. Si PID_Temp_2.PidOutputSum es
menor que PID_Temp_1.PidOutputSum, el regulador de limitación PID_Temp_2 obtiene
acceso al actuador a través de la selección de valor mínimo y reduce la potencia de
calefacción. Mediante las asignaciones PID_Temp_1.OverwriteInitialOutputValue =
PID_Temp_2.PidOutputSum y PID_Temp_1.PIDCtrl.PIDInit = TRUE se garantiza que se
corregirá PID_Temp_1.
La temperatura en el punto de medición adicional Input2 se reduce. La temperatura de la
magnitud regulada principal Input1 cae también y ya no puede mantenerse en la consigna.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

815

Regulación PID
3.3 Regulación PID (S7-1200, S7-1500)
Si la avería deja de producirse, Input2 seguirá cayendo, y la potencia de calefacción del
regulador de limitación volverá a aumentar. En cuanto el regulador principal calcula una
potencia de calefacción menor como valor de salida, la instalación regresa al modo normal, de
forma que el regulador principal PID_Temp_1 vuelve a obtener acceso al actuador. Este
ejemplo se puede implementar con el siguiente código de programa SCL:
"PID_Temp_1"(Input := "Input1");
"PID_Temp_2"(Input := "Input2");
IF "PID_Temp_1".PidOutputSum <= "PID_Temp_2".PidOutputSum THEN
"ActuatorInput" := "PID_Temp_1".OutputHeat_PWM;
"PID_Temp_1".PIDCtrl.PIDInit := FALSE;
"PID_Temp_2".PIDCtrl.PIDInit := TRUE;
"PID_Temp_2".OverwriteInitialOutputValue := "PID_Temp_1".PidOutputSum;
ELSE
"ActuatorInput" := "PID_Temp_2".OutputHeat_PWM;
"PID_Temp_1".PIDCtrl.PIDInit := TRUE;
"PID_Temp_2".PIDCtrl.PIDInit := FALSE;
"PID_Temp_1".OverwriteInitialOutputValue := "PID_Temp_2".PidOutputSum;
END_IF;

3.3.3.7

Simulación de PID_Temp con PLCSIM
Nota
Simulación con PLCSIM
La simulación de PID_Temp con PLCSIM para CPU S7-1200 no se soporta.
PID_Temp solo puede simularse con PLCSIM para CPU S7-1500.
En la simulación con PLCSIM, el comportamiento temporal del PLC simulado no es idéntico al
de un PLC "auténtico". El verdadero ciclo de un OB de alarma cíclica puede presentar mayores
fluctuaciones en un PLC simulado que en un PLC "auténtico".
En la configuración estándar, PID_Temp determina automáticamente el tiempo entre las
llamadas y vigila sus fluctuaciones.
Por tanto, al simular PID_Temp con PLCSIM es posible detectar un error de tiempo de
muestreo (ErrorBits = DW#16#00000800).
Esto provoca la cancelación de las optimizaciones en curso.
La reacción en el modo automático depende del valor de la variable ActivateRecoverMode.
Para evitarlo, debe configurarse PID_Temp en la simulación con PLCSIM del modo siguiente:
● CycleTime.EnEstimation = FALSE
● CycleTime.EnMonitoring = FALSE
● CycleTime.Value: Asigne a estas variables el ciclo del OB de alarma cíclica que se debe
llamar en la unidad segundos.

816

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

3.4

Regulación PID (S7-300, S7-400, S7-1500)

3.4.1

Utilizar funciones básicas PID

3.4.1.1

CONT_C

Objeto tecnológico CONT_C
El objeto tecnológico CONT_C proporciona un regulador PID continuo para los modos
automático y manual. Equivale al bloque de datos de instancia de la instrucción CONT_C. La
instrucción PULSEGEN permite configurar un regulador de impulsos.
Los componentes proporcional, integrativo (INT) y diferencial (DIF) están conectados en
paralelo y se pueden conectar o desconectar de forma independiente. Con ello se pueden
parametrizar los reguladores P, PI, PD y PID.
S7-1500
Todos los parámetros y variables del objeto tecnológico son remanentes y, al efectuarse la
carga en el dispositivo, solo pueden modificarse si se carga CONT_C por completo.

Consulte también
Vista general de los reguladores de software (Página 661)
Agregar objetos tecnológicos (Página 664)
Configurar objetos tecnológicos (Página 665)
Cargar objetos tecnológicos en el dispositivo (Página 667)

Configurar el error de regulación CONT_C
Utilizar el valor real de periferia
Para utilizar el valor real en el formato de periferia en el parámetro de entrada PV_PER,
proceda del siguiente modo:
1. Active la casilla de verificación "Activar periferia".
2. Si existe el valor real como magnitud física, introduzca el factor y el offset para la
normalización en porcentajes.
De este modo, el valor real se calcula según la siguiente fórmula:
PV = PV_PER × PV_FAC + PV_OFF

Utilizar el valor real interno
Para utilizar el valor real en el formato de coma flotante en el parámetro de entrada PV_IN,
proceda del siguiente modo:
1. Desactive la casilla de verificación "Activar periferia".
Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

817

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Error de regulación
Ajuste un ancho de zona muerta según los siguientes requisitos:
● La señal del valor real tiene ruido.
● La ganancia del regulador es alta.
● La acción D está activada.
El nivel de ruido del valor real provoca, en este caso, fuertes variaciones de la variable
manipulada. La zona muerta suprime el nivel de ruido, cuando el estado del regulador es
estacionario. El ancho de zona muerta indica el tamaño de la zona muerta. Con un ancho de
zona muerta de 0.0, la zona muerta se encuentra desactivada.

Configurar el algoritmo de regulación CONT_C
General
Para averiguar qué acciones del algoritmo de regulación están activadas, proceda del
siguiente modo:
1. Seleccione una entrada de la lista "Estructura de regulador".
Sólo puede introducir los parámetros necesarios para la estructura de regulación
seleccionada.

Acción P
1. Si la estructura de regulador contiene una acción P, introduzca la "Ganancia proporcional".

Acción I
1. Si la estructura de regulador contiene una acción I, introduzca la "Tiempo de integración".
2. Para asignar un valor de inicialización a la acción I, active el botón de opción "Inicializar
acción I" e introduzca el valor de inicialización.
3. Para ajustar la acción I permanentemente a este valor de inicialización, active el botón de
opción "Detener acción I".

Acción D
1. Si la estructura del regulador contiene una acción D, introduzca el tiempo derivativo, la
ponderación de la acción D y el tiempo de retardo.

818

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Configurar la variable manipulada CONT_C
General
Puede instroducir CONT_C en el modo manual o en el modo automático.
1. Para fijar una variable manipulado manual, active el botón de opción "Activar modo
manual".
Puede especificar una variable manipulado manual en el parámetro de entrada MAN.

Límites de la variable manipulada
La variable manipulada se limita hacia arriba o hacia abajo, para que sólo pueda aceptar
valores válidos. No puede desconectar la limitación. Si se sobrepasan los límites, esto se
muestra mediante los parámetros de salida QLMN_HLM y QLMN_LLM.
1. Introduzca un valor para el límite superior y el límite inferior de la variable manipulada.
Si la variable manipulada es una magnitud física, las unidades para el límite superior y el
límite inferior de la variable manipulada deben coincidir.

Normalización
La variable manipulada se puede normalizar para la salida como valor en coma flotante y valor
de periferia mediante un factor y un offset, según la siguiente fórmula.
Variable manipulada normalizada = variable manipulada × factor + offset
Están preseleccionados un factor de 1.0 y un offset de 0.0.
1. Introduzca un valor para factor y offset.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

819

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Programar regulador de impulsos
Con el regulador continuo CONT_C y el formador de impulsos PULSEGEN, es posible realizar
un regulador de valor fijo con salida de conmutación para actuadores proporcionales. La figura
siguiente muestra el proceso de señales del lazo de regulación.
&217B&

38/6(*(1
/01

,19

4326B3
41(*B3

39B3(5

5HFRUULGRFRQVDOLGD
GHFRQPXWDFLµQ

El regulador continuo CONT_C forma la variable manipulada LMN que el formador de impulsos
PULSEGEN convierte en señales de pausa de impulso QPOS_P o QNEG_P.

Poner en marcha CONT_C
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.

Procedimiento
Para determinar manualmente los parámetros PID óptimos, proceda del siguiente modo:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. Introduzca parámetros PID nuevos en los campos "P", "I", "D" y "Tiempo de retardo".
3. Haga clic en el grupo "Optimización" en el símbolo

"Enviar parámetros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna" .
5. Introduzca otra consigna y haga clic en el grupo "Valores actuales", en el símbolo

.

6. En caso necesario, desactive la casilla de verificación "Modo manual".
El regulador trabaja con los nuevos parámetros PID y regula según la nueva consigna.

820

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)
7. Compruebe la calidad de los parámetros PID mediante los recorridos de la curva.
8. Repita los pasos del 2 hasta el 6, hasta que esté satisfecho/a con el resultado de la
regulación.

3.4.1.2

CONT_S

Objeto tecnológico CONT_S
El objeto tecnológico CONT_S pone a disposición un regulador paso a paso para elementos
finales de control con comportamiento integral y sirve para regular los procesos técnicos de
temperatura con señales binarias de salida de variable manipulada. El objeto tecnológico
corresponde al bloque de datos de instancia de la instrucción CONT_S. El modo de trabajo se
basa en el algoritmo de regulación PI del regulador de muestreo. El regulador paso a paso
opera sin realimentación de posición. Es posible elegir entre el modo manual y el automático.
S7-1500
Todos los parámetros y variables del objeto tecnológico son remanentes y, al efectuarse la
carga en el dispositivo, solo pueden modificarse si se carga CONT_S por completo.

Consulte también
Vista general de los reguladores de software (Página 661)
Agregar objetos tecnológicos (Página 664)
Configurar objetos tecnológicos (Página 665)
Cargar objetos tecnológicos en el dispositivo (Página 667)

Configurar el error de regulación CONT_S
Utilizar el valor real de periferia
Para utilizar el valor real en el formato de periferia en el parámetro de entrada PV_PER,
proceda del siguiente modo:
1. Active la casilla de verificación "Activar periferia".
2. Si existe el valor real como magnitud física, introduzca el factor y el offset para la
normalización en porcentajes.
De este modo, el valor real se calcula según la siguiente fórmula:
PV = PV_PER × PV_FAC + PV_OFF

Utilizar el valor real interno
Para utilizar el valor real en el formato de coma flotante en el parámetro de entrada PV_IN,
proceda del siguiente modo:
1. Desactive la casilla de verificación "Activar periferia".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

821

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Error de regulación
Ajuste un ancho de zona muerta según los siguientes requisitos:
● La señal del valor real tiene ruido.
● La ganancia del regulador es alta.
● La acción D está activada.
La componente de ruido del valor real provoca, en este caso, fuertes variaciones de la variable
manipulada. La zona muerta suprime la componente de ruido cuando el estado del regulador
es estacionario. El ancho de zona muerta indica el tamaño de la zona muerta. Con un ancho
de zona muerta de 0.0, la zona muerta se encuentra desactivada.

Configurar el algoritmo de regulación CONT_S
Algoritmo PI
1. Introduzca la "Ganancia roporcional" para la acción P.
2. Introduzca el tiempo de integración para la rapidez de respuesta de la acción I.
Con un tiempo de integración de 0.0, la acción I se encuentra desactivada.

Configurar la variable manipulada CONT_S
General
Puede introducir CONT_S en el modo manual o en el modo automático.
1. Para fijar una variable manipulado manual, active el botón de opción "Activar modo
manual".
Especifique una variable manipulada manual en los parámetros de entrada LMNUP y
LMNDN.

Generador de impulsos
1. Introduzca la duración mínima de impulso y la duración mínima de pausa.
Los valores deben ser mayores o iguales al tiempo de ciclo en el parámetro de entrada
CYCLE. De esta manera, se reduce la frecuencia de maniobra.
2. Introduzca el tiempo de posicionamiento del motor.
El valor debe ser mayor o igual al tiempo de ciclo en el parámetro de entrada CYCLE.

Poner en marcha CONT_S
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.

822

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Procedimiento
Para determinar manualmente los parámetros PID óptimos, proceda del siguiente modo:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. Introduzca una nueva ganancia proporcional y un nuevo tiempo de integración en los
campos "P" e "I".
3. Haga clic en el grupo "Optimización" en el símbolo

"Enviar parámetros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna" .
5. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
símbolo .
6. En caso necesario, desactive la casilla de verificación "Modo manual".
El regulador trabaja con los nuevos parámetros y regula según la nueva consigna.
7. Compruebe la calidad de los parámetros PID mediante los recorridos de la curva.
8. Repita los pasos del 2 hasta el 6, hasta que esté satisfecho/a con el resultado de la
regulación.

3.4.1.3

TCONT_CP

Objeto tecnológico TCONT_CP
El objeto tecnológico TCONT_CP proporciona un regulador de temperatura continuo con
generador de impulsos. Equivale al bloque de datos instancia de la instrucción TCONT_CP. El
modo de trabajo se basa en el algoritmo de regulación PID del regulador de muestreo. Es
posible elegir entre el modo manual y el automático.
La instrucción TCONT_CP calcula los parámetros P, I y D para el sistema regulado de forma
autónoma durante la "optimización inicial". Los parámetros pueden optimizarse aún más a
través de una "optimización fina". Los parámetros PID también pueden determinarse
manualmente.
S7-1500
Todos los parámetros y variables del objeto tecnológico son remanentes y, al efectuarse la
carga en el dispositivo, solo pueden modificarse si se carga TCONT_CP por completo.

Consulte también
Vista general de los reguladores de software (Página 661)
Agregar objetos tecnológicos (Página 664)
Configurar objetos tecnológicos (Página 665)
Cargar objetos tecnológicos en el dispositivo (Página 667)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

823

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Configurar TCONT_CP
Error de regulación
Utilizar el valor real de periferia
Para utilizar el parámetro de entrada PV_PER, proceda del siguiente modo:
1. Seleccione la entrada "Periferia" en la lista "Origen".
2. Seleccione el "Tipo de sensor ".
Según el tipo de sensor, el valor real se normaliza según diferentes fórmulas.
– Termopares
estándar; PT100/NI100
PV = 0.1 × PV_PER × PV_FAC + PV_OFFS
– Climatiz.;
PT100/NI100
PV = 0.01 × PV_PER × PV_FAC + PV_OFFS
– Intensidad/tensión
PV = 100/27648 × PV_PER × PV_FAC + PV_OFFS
3. Introduzca factor y offset para la normalización del valor real de periferia.

Utilizar el valor real interno
Para utilizar el parámetro de entrada PV_IN, proceda del siguiente modo:
1. Seleccione la entrada "Interno" en la lista "Origen".

Error de regulación
Ajuste un ancho de zona muerta según los siguientes requisitos:
● La señal del valor real tiene ruido.
● La ganancia del regulador es alta.
● La acción D está activada.
La componente de ruido del valor real provoca, en este caso, fuertes variaciones de la variable
manipulada. La zona muerta suprime la componente de ruido cuando el estado del regulador
es estacionario. El ancho de zona muerta indica el tamaño de la zona muerta. Con un ancho
de zona muerta de 0.0, la zona muerta se encuentra desactivada.

824

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Algoritmo de regulación
General
1. Introduzca el "Tiempo de muestreo del algoritmo PID".
El tiempo de muestreo del regulador no debería exceder un 10 % del tiempo de integración
del regulador (TI) calculado.
2. Si la estructura de regulador contiene una acción P, introduzca la "Ganancia proporcional".
Una ganancia proporcional negativa invierte el sentido de regulación.

Acción P
En caso de modificaciones de la consigna, la acción P puede provocar sobreoscilaciones.
Mediante la ponderación de la acción P se puede elegir con qué intensidad debe actuar la
acción P al cambiar la consigna. La atenuación de la acción P se logra mediante una
compensación en la acción I.
1. Para atenuar la acción P en caso de modificaciones de la consigna, introduzca la
"Ponderación de la acción P".
– 1.0: Acción P completamente efectiva en caso de modificación de la consigna
– 0.0: Acción P inefectiva en caso de modificación de la consigna

Acción I
En caso de limitación de la variable manipulada, la acción I se detiene. En caso de un error de
regulación, que mueve la acción I en dirección al área manipulada interna, la acción I vuelve
a activarse.
1. Si la estructura de regulador contiene una acción I, introduzca el "Tiempo de integración".
Con un tiempo de integración de 0.0, la acción I se encuentra desactivada.
2. Para asignar un valor de inicialización a la acción I, active el botón de opción "Inicializar
acción I" e introduzca el "Valor de inicialización".
En caso de reinicio o COM_RST = TRUE, la acción I se pone en este valor.

Acción D
1. Si la estructura del regulador contiene una acción D, introduzca el tiempo derivativo (TD) y
el coeficiente DT1 (D_F).
Si está conectada la acción D, deberá cumplirse la siguiente ecuación:
TD = 0.5 × CYCLE× D_F.
De ahí se calcula el tiempo de retardo según la fórmula:
Tiempo de retardo = TD/D_F

Parametrizar el regulador PD con el punto de operación
1. Introduzca el tiempo de integración 0.0.
2. Active el botón de opción "Inicializar acción I".
3. Introduzca el punto de operación como valor de inicialización.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

825

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Parametrizar el regulador P con el punto de operación
1. Parametrice un regulador PD con el punto de operación.
2. Introduzca el tiempo derivativo 0.0.
La acción D se desactiva.

Zona de regulación
La zona de regulación limita el rango del error de regulación. Si el error de regulación se
encuentra fuera de este rango, se utilizan los límites de la variable manipulada.
Al entrar en la zona de regulación, la acción D conectada provoca una reducción muy rápida
de la magnitud manipulada. Por lo tanto, la zona de regulación sólo es útil, cuando la acción D
está conectada. Sin zona de regulación, principalmente sólo la acción P que va disminuyendo
reduciría la magnitud manipulada. La zona de regulación provoca un régimen transitorio rápido
sin sobreoscilaciones ni posteriores infraoscilaciones, en caso de que la magnitud manipulada
mínima o máxima emitida esté a mucha distancia de la magnitud manipulada necesaria para
el nuevo punto de operación.
1. Active el botón de opción "Activar" en el grupo "Zona de regulación".
2. Introduzca en el campo de entrada "Ancho" un valor que el valor real pueda desviarse de
la consigna por encima o por debajo.

Variable manipulada del regulador continuo
Límites de la variable manipulada
La variable manipulada se limita hacia arriba o hacia abajo, para que sólo pueda aceptar
valores válidos. No puede desconectar la limitación. Si se sobrepasan los límites, esto se
muestra mediante los parámetros de salida QLMN_HLM y QLMN_LLM.
1. Introduzca un valor para el límite superior y el límite inferior de la variable manipulada.

Normalización
La variable manipulada se puede normalizar para la salida como valor de punto flotante y valor
de periferia mediante un factor y un offset, según la siguiente fórmula.
Variable manipulada normalizada = variable manipulada × factor + offset
Hay preasignado un factor de 1.0 y un offset de 0.0.
1. Introduzca un valor para factor y offset.

Generador de impulsos
Para un regulador continuo, el generador de impulsos debe estar desconectado.
1. Desactive el botón de opción "Activar" en el grupo "Generador de impulsos".

826

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Variable manipulada del regulador de impulsos
Generador de impulsos
La variable manipulada análogo (LmnN) se puede emitir con modulación de ancho de impulsos
en el parámetro de salida QPULSE como un intervalor de impulsos.
Para utilizar el generador de impulsos, proceda del siguiente modo:
1. Active el botón de opción "Activar" en el grupo "Generador de impulsos".
2. Introduzca el "Tiempo de muestreo del generador de impulsos", la "Duración mínima de
impulso/de pausa" y la "Duración del período".
Los siguientes gráficos aclaran la relación entre el "Tiempo de muestreo del generador de
impulsos" (CYCLE_P), la "Duración mínima de impulso/de pausa" (P_B_TM) y la "Duración del
período" (PER_TM):
/PQ1








W


438/6(




W
&<&/(B3
3(5B70

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

827

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)



3B%B70
3(5B70

3B%B70
3(5B70

3(5B70

Tiempo de muestreo del generador de impulsos
El tiempo de muestreo del generador de impulsos debe coincidir con el período del OB de
alarma cíclica invocante. La duración del impulso generado es simpre un múltiplo entero de
este valor. Para una resolución exacta y adecuada de la variable manipulada, debería darse
la siguiente relación:
CYCLE_P ≤ PER_TM/50

Duración mínima de impulso/de pausa
Mediante la duración mínima de impulso/de pausa se evitan los tiempos de conexión o
desconexión cortos en el elemento final de control. Un impulso menor que P_B_TM se suprime.
Se recomienda los valores P_B_TM ≤ 0.1 × PER_TM.

Duración del período
La duración del período no debería exceder un 20 % del tiempo de integración del regulador
(TI) calculado:
PER_TM ≤ TI/5

Ejemplo de los efectos de los parámetros CYCLE_P, CYCLE y PER_TM:
Duración del período PER_TM = 10 s
Tiempo de muestreo del algoritmo PID CYCLE = 1 s
Tiempo de muestreo del generador de impulsos CYCLE_P = 100 ms.

828

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)
Cada segundo se calcula una nueva variable manipulada, cada 100 ms se produce la
comparación de la variable manipulada con la longitud de impulso o de pausa emitida hasta
entonces.
● Si se emite un impulso, existen 2 posibilidades:
– La variable manipulada calculada es mayor que la longitud de impulso/PER_TM
existente hasta entonces. En tal caso, el impulso se prolonga.
– La variable manipulada calculada es menor o igual que la longitud de impulso/PER_TM
existente hasta entonces. En tal caso, no se emiten más señales de impulso.
● Si no se emite ningún impulso, también caben 2 posibilidades:
– El valor (100 % - variable manipulada calculada) es mayor que la longitud de pausa/
PER_TM existente hasta entonces. En tal caso, la pausa se prolonga.
– El valor (100 % - variable manipulada calculada) es menor o igual que la longitud de
pausa/ PER_TM existente hasta entonces. En tal caso se emite una señal de impulso.

Poner en marcha TCONT_CP
Optimización de TCONT_CP
Posibilidades de utilización
La optimización del regulador puede utilizarse exclusivamente en los procesos de refrigeración
o en los procesos de calefacción del tipo de sistema I. Pero también para los sistemas de orden
superior del tipo II o III, puede utilizar el bloque.
Los parámetros PI/PID se calculan y ajustan automáticamente. El diseño de regulador se ha
concebido con un comportamiento óptimo frente a perturbaciones. Los parámetros "de efecto
brusco" resultantes conducirían a sobreoscilaciones de entre el 10 % y el 40 % de la amplitud
del escalón, en caso de escalones de consigna.

Fases de la optimización del regulador
Durante la optimización del regulador se ejecutan fases individuales, que se indican en el
parámetro PHASE .

PHASE = 0
No se produce ninguna optimización. TCONT_CP funciona en modo automático o manual.
Mientras PHASE = 0, el sistema regulado debe cumplir con los requisitos para una
optimización.
Al final de la optimización, TCONT_CP vuelve a cambiar en PHASE = 0.

PHASE = 1
TCONT_CP se encuentra en disposición de optimización. PHASE = 1 sólo puede iniciarse, si
se cumplen las condiciones para una optimización.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

829

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)
Mientras PHASE = 1 se calculan los siguientes valores:
● Ruido del valor real NOISE_PV
● Subida inicial PVDT0
● Valor medio de la variable manipulada
● Tiempo de muestreo algoritmo PID CYCLE
● Tiempo de muestreo del generador de impulsos CYCLE_P

PHASE = 2
En la fase 2 se busca el punto de inversión del valor real con una variable manipulada
constante. El procedimiento impide que el punto de inversión se detecte demasiado pronto
debido al ruido de PV:
En el regulador de impulsos se toma el promedio de PV mediante N ciclos de impulsos y,
seguidamente, se pone a disposición de la parte del regulador. En la parte del regulador se
realiza otra promediación: al principio, dicha promediación está inactiva, es decir, sólo se toma
el promedio de 1 ciclo cada vez. En cuanto el ruido excede una medida determinada, se
duplica el número de ciclos.
Se determinan el período y la amplitud del ruido. La búsqueda del punto de inversión no se
cancela y se sale de la fase 2 hasta que el gradiente es siempre menor que el ascenso máximo
durante el período estimado. Sin embargo, TU y T_P_INF se calculan en el punto de inversión
real.
De todas formas, la optimización no finaliza hasta que se cumplen las dos condiciones
siguientes:
1. El valor real está más alejado del punto de inversión que 2*NOISE_PV.
2. El valor real ha excedido el punto de inversión en un 20 %.
Nota
En caso de excitación mediante escalón de consigna, la optimización finaliza a muy tardar
cuando el valor real ha pasado el 75 % del escalón de consigna (SP_INT-PV0) (véase
abajo).

PHASE = 3, 4, 5
Las fases 3, 4 y 5 duran cada una 1 ciclo.
En la fase 3, se guardan los parámetros PI/PID válidos antes de la optimización y se calculan
los parámetros del proceso.
En la fase 4, se calculan los nuevos parámetros PI/PID.
En la fase 5, se calcula la nueva variable manipulada y se fija según el sistema regulado.

830

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

PHASE = 7
El tipo de sistema se comprueba en la fase 7, ya que TCONT_CP siempre cambia al modo
automático tras la optmización. El modo automático se inicia con LMN = LMN0 +
0.75*TUN_DLMN como variable manipulada. La comprobación del tipo de sistema tiene
lugar en modo automático con los parámetros del regulador que se acaban de calcular y
finaliza, a lo sumo, 0,35*TA (tiempo de compensación) tras el punto de inversión. Si el orden
de proceso se diferencia considerablemente del valor estimado, vuelven a calcularse los
parámetros del regulador y aumenta en 1 el STATUS_D, de lo contrario, los parámetros del
regulador se mantienen sin cambios.
La operación de optimización está terminada y TCONT_CP vuelve a encontrarse en PHASE
= 0. El parámetro STATUS_H indica si la optimización ha finalizado correctamente.

Cancelación anticipada de la optimización
En las fases 1, 2 ó 3 se puede cancelar la optimización sin que se calculen parámetros nuevos,
restableciendo TUN_ON = FALSE. El regulador se inicia en modo automático con LMN
= LMN0 + TUN_DLMN. Si el regulador se encontraba en modo manual antes de la
optimización, se emitirá la variable manipulada manual antigua.
Si en la fase 4, 5 ó 7 se interrumpe la optimización por medio de TUN_ON = FALSE, se
conservan los parámetros del regulador ya calculados.

Condiciones para una optimización
Régimen transitorio
El proceso debe presentar un régimen transitorio estable, con retardo y asintótico.
Después de un escalón de la magnitud manipulada, el valor real debe pasar a un estado
estacionario. Con ello se excluyen procesos que presentan un comportamiento oscilante
incluso sin regulación, así como sistemas regulados sin compensación (integrador en el
proceso regulado).

ADVERTENCIA
Pueden producirse daños materiales considerables, lesiones físicas graves o incluso la
muerte.
Durante una optimización, el parámetro MAN_ON no tiene efecto alguno. Por lo tanto, la
variable manipulada o el valor real pueden tomar valores no deseados, o también extremos.
La variable manipulada se especifica mediante optimización. Para interrumpir la
optimización, primero hay ajustar TUN_ON = FALSE. De este modo, MAN_ON vuelve a tener
efecto.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

831

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Consolidación de un estado inicial cuasi-estacionario (fase 0)
Si la magnitud regulada presentara oscilaciones de baja frecuencia, por ejemplo, debido a
unos parámetros del regulador incorrectos, habrá que controlar el regulador manualmente
antes de iniciar la optimización y esperar a que desaparezcan dichas oscilaciones. Como
alternativa, también se puede conmutar a un regulador PI de efecto "suave" (ganancia del lazo
pequeña, tiempo de integración largo).
Ahora deberá esperar hasta que se alcance el estado estacionario, es decir, hasta que el valor
real y la variable manipulada sean estacionarios. También está permitido un régimen
transitorio asintótico o un desplazamiento lento del valor real (estado cuasi-estacionario,
consulte la figura siguiente). La magnitud manipulada debe ser constante u oscilar alrededor
de un valor medio constante.
Nota
Evite modificar la magnitud manipulada justo antes del inicio de la optimización. La magnitud
manipulada también se puede modificar de manera involuntaria mediante el establecimiento
de las condiciones de ensayo (p. ej., cerrar una puerta abierta). Si este fuera el caso, deberá
esperar como mínimo a que el valor real experimente de nuevo un régimen transitorio de forma
asintótica a un estado estacionario No obstante, conseguirá mejores parámetros de
regulación, si espera hasta que el proceso de régimen transitorio haya finalizado
completamente.

En la siguiente figura, se muestra el régimen transitorio al estado estacionario:

832

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

39

9DORUUHDO

(VWDGRQRHVWDFLRQDULR
QRSHUPLWLGR

3+$6( 

3+$6( 

(VWDGRFXDVLHVWDFLRQDULR
D¼QSHUPLWLGR

(VPHMRUXQHVWDGR
HVWDFLRQDULRHVWDELOL]DGR

39

W

/01

9DORUPDQLSXODGR
,PSXOVRGHOYDORUPDQLSXODGR
/01

W

Linealidad y zona de trabajo
El proceso debe presentar un comportamiento lineal en la zona de trabajo. Un comportamiento
no lineal se produce, p. ej., con un cambio de un estado de agregación. La optimización debe
tener lugar en una parte lineal de la zona de trabajo.
Esto significa que, tanto para la optimización como para el modo de regulación normal, los
efectos no lineales dentro de dicha zona de trabajo deben ser despreciablemente pequeños.
Sin embargo, es posible optimizar de nuevo el proceso cambiando el punto de operación si la
optimización vuelve a ejecutarse en un entorno reducido del nuevo punto de operación y si
durante la optimización no se pasa por la no linealidad.
Si se conocen determinadas no linealidades estáticas (p. ej. características de válvulas), es
aconsejable compensarlas previamente con una línea poligonal para linealizar el
comportamiento del proceso.

Perturbaciones en procesos de temperatura
Las perturbaciones, como la transferencia de calor a zonas colindantes, no deben influir
excesivamente en el proceso global de temperatura. Así, p. ej., al optimizar las zonas de una
extrusionadora, todas las zonas deben calentarse simultáneamente.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

833

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Posibilidades de la optimización
Existen las siguientes posibilidades de optimización:
● Optimización inicial
● Optimización fina
● Optimización fina manual en modo de regulación

Optimización inicial
Durante esta optimización, el punto de operación del estado frío se pone en marcha a través
de un escalón de consigna.
Con TUN_ON = TRUE, cree la disposición de optimización. El regulador cambia de PHASE = 0
a PHASE = 1.
3+$6( 

3+$6( 

3+$6(


3+$6( 

3+$6( 

63

r&
/01

(VWDGRGH
SURFHVR
HQFDOLHQWH
SXQWRGH
WUDEDMR

39
781B'/01
3XQWRGH
LQYHUVLµQ

/01

(VWDGRGH
SURFHVRHQ
IU¯R
W
781B21
W

La variable manipulada de la optimización (LMN0 + TUN_DLMN) se aplica mediante
modificación de la consigna (transición fase 1 -> 2). La consigna no es efectiva hasta que se
alcanza el punto de inversión (sólo entonces se conmutará al modo Automático).
El delta de la excitación manipulada (TUN_DLMN) se define de acuerdo con la modificación
admisible del valor real bajo responsabilidad propia. El signo de TUN_DLMN debe estar en
concordancia con la modificación prevista del valor real (observar el sentido de regulación).
El escalón de consigna y TUN_DLMN deben estar coordinados. Un TUN_DLMN demasiado
grande conlleva el peligro de que el punto de inversión no esté dentro del 75 % del escalón de
consigna.
Sin embargo, TUN_DLMN debe ser lo suficientemente grande como para que el valor real
alcance como mínimo el 22 % del escalón de consigna. En caso contrario, el procedimiento
permanece en modo Optimización (fase 2).

834

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)
Solución: reduzca la consigna durante la búsqueda del punto de inversión.
Nota
En procesos con un fuerte retardo, es aconsejable definir para la optimización una consigna de
destino un poco más baja que el punto de operación deseado y observar con detenimiento los
bits de estado y el PV (peligro de sobreoscilaciones).
Optimización únicamente en el rango lineal:
Determinados sistemas regulados (p. ej. calderas de fusión de zinc o magnesio) pasan por un
rango no lineal poco antes del punto de operación (modificación del estado de agregación).
Si se selecciona con habilidad el escalón de consigna es posible limitar la optimización al rango
lineal. Si el valor real ha pasado el 75 % del escalón de consigna (SP_INT-PV0) se finaliza la
optimización.
Paralelamente, TUN_DLMN debería reducirse hasta que el punto de inversión se encuentre
con seguridad antes de alcanzar el 75 % del escalón de consigna.

Optimización fina
Durante esta optimización, el proceso se excita, en caso de una consigna constante, mediante
un salto de la variable manipulada.
r&
/01

3+$6( 

3+$6( 

3+$6(


3+$6( 

3+$6( 

39
9DORUUHDOGHOSXQWRGHWUDEDMR

3XQWRGH
LQYHUVLµQ
63

781B'/01

/01

VHGHVDFWLYD
DXWRP£WLFDPHQWH

781B21

9DORUPDQLSXODGRGHOSXQWRGHWUDEDMR

W

W
781B67
W

La variable manipulada de la optimización (LMN0 + TUN_DLMN) se aplica mediante activación
del bit de inicio TUN_ST (transición fase 1 -> 2). Si se modifica la consigna, la nueva consigna
no es efectiva hasta que no se alcanza el punto de inversión (sólo entonces se conmuta al
modo Automático).
Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

835

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)
El delta de la excitación manipulada (TUN_DLMN) se define de acuerdo con la modificación
admisible del valor real bajo responsabilidad propia. El signo de TUN_DLMN debe estar en
concordancia con la modificación prevista del valor real (observar el sentido de regulación).
ATENCIÓN
Si la excitación se realiza mediante TUN_ST no se produce ninguna desconexión de
seguridad al 75 %. La optimización finaliza cuando se alcanza el punto de inversión. Sin
embargo, en procesos con ruidos es posible que se sobrepase claramente el punto de
inversión.

Optimización fina manual en modo de regulación
Para conseguir un comportamiento de consigna sin sobreoscilaciones, pueden tomarse las
medidas siguientes:
● Adaptar la zona de regulación
● Optimizar el comportamiento de referencia
● Amortiguar los parámetros de regulación
● Modificar los parámetros de regulación

Resultado de la optimización
La cifra de la izquierda de STATUS_H muestra el estado de optimización
STATUS_H

Resultado

0

Se han encontrado parámetros del regulador predeterminados, ninguno o nin‐
guno nuevo.

10000

Se han encontrado parámetros del regulador adecuados

2xxxx

Se han encontrado parámetros del regulador superiores a los valores estimados;
compruebe el comportamiento de regulación, lea el aviso de diagnóstico STA‐
TUS_H y repita la optimización del regulador.

3xxxx

Se han producido errores de operador; lea el aviso de diagnóstico STATUS_H y
repita la optimización del regulador.

En la fase 1 ya se verificaron los tiempos de muestreo CYCLE y CYCLE_P.
Los siguientes parámetros de regulación se actualizan en TCONT_CP:
● P (ganancia proporcional GAIN)
● I (tiempo de integración TI)
● D (tiempo de acción derivativa TD)
● Ponderación de la acción P PFAC_SP
● Coeficiente DT1 (D_F)
● Zona de regulación on/off CONZ_ON
● Ancho de la zona de regulación CON_ZONE

836

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)
La zona de regulación sólo se activa si el tipo de sistema es adecuado (I y II) y si el regulador
PID está activado (CONZ_ON = TRUE).
En función de PID_ON se regula con el regulador PI o PID. Los parámetros antiguos del
regulador se guardan y pueden volver a activarse mediante UNDO_PAR. Además, se guarda
un juego de parámetros PI y PID en las estructuras PI_CON y PID_CON. Mediante LOAD_PID
y la activación correspondiente de PID_ON, también es posible cambiar más adelante entre los
parámetros optimizados PI o PID.

Optimización paralela de canales del regulador
Zonas colindantes (fuerte acoplamiento térmico)
Si hay dos o más reguladores que regulan la temperatura, p. ej. en una placa (es decir, dos
calefacciones y dos valores reales medidos con un fuerte acoplamiento térmico), proceda del
siguiente modo:
1. Combine lógicamente con la operación O las dos salidas QTUN_RUN.
2. Interconecte cada una de las dos entradas TUN_KEEP con una de las salidas del elemento
O.
3. Inicie los dos reguladores predefiniendo simultáneamente un escalón de consigna o
activando simultáneamente TUN_ST.
La figura siguiente representa la optimización paralela de canales del regulador:

7&217B&3'%B7&217B&3
781B.((3
4781B581

7&217B&3'%B7&217B&3
781B.((3

ุ

4781B581

Ventaja:
Ambos reguladores emiten LMN0 + TUN_DLMN hasta que los dos han salido de la fase 2. De
este modo se impide que el regulador que finaliza primero la optimización falsifique el resultado
de optimización del otro regulador al modificar su magnitud manipulada.
ATENCIÓN
Cuando se alcanza el 75 % del escalón de consigna se sale de la fase 2, con lo que se
desactiva la salida QTUN_RUN. Sin embargo, el modo Automático no empezará hasta que
TUN_KEEP sea 0.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

837

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Zonas colindantes (acoplamiento térmico débil)
Por norma general, debería optimizarse del mismo modo que se regula posteriormente. Si en
modo productivo las zonas se desplazan conjuntamente en paralelo, de modo que las
diferencias de temperatura entre las distintas zonas se mantienen iguales, durante la
optimización debería aumentarse el nivel de temperatura de las zonas colindantes en
correspondencia.
Las diferencias de temperatura al principio del ensayo no son relevantes, porque se
compensan mediante una calefacción inicial adecuada (→ subida inicial = 0).

Síntomas de error y soluciones posibles
Interceptar errores de operador
Error de operador

STAUTS y medida

Comentario

Activación simultánea de
TUN_ON y escalón de consigna
o TUN_ST

Transición a la fase 1 pero
sin inicio de optimización.

La modificación de la consigna se
anula. De este modo se impide que
el regulador se regule a la nueva
consigna y abandone innecesaria‐
mente el punto de operación esta‐
cionario.

● SP_INT = SPantiguo o
● TUN_ST = FALSE

TUN_DLMN < 5 % efectivo (fin de STATUS_H = 30002
la fase 1)
● Transición a la fase 0
● TUN_ON = FALSE
● SP = SPantiguo

Cancelación de la optimización.
La modificación de la consigna se
anula. De este modo se impide que
el regulador se regule a la nueva
consigna y abandone innecesaria‐
mente el punto de operación esta‐
cionario.

Punto de inversión no alcanzado (sólo en caso de excitación mediante escalón de consigna)
La optimización finaliza como muy tarde cuando el valor real ha pasado el 75 % del escalón de
consigna (SP_INT-PV0). Esto se notifica mediante "Punto de inversión no alcanzado" en
STATUS_H (2xx2x).
Siempre rige la consigna que está ajustada en cada momento. Así pues, si se reduce la
consigna, es posible que la optimización finalice anticipadamente.
En casos de procesos de temperatura típicos, suele bastar con cancelar la optimización al 75
% del escalón de consigna para impedir sobreoscilaciones. Sin embargo, hay que tomar
precauciones, especialmente en procesos con un retardo considerable(TU/TA > 0.1, tipo III).
Si la excitación manipulada es demasiado fuerte en comparación con el escalón de consigna,
el valor real tendrá muchas sobreoscilaciones (hasta el factor 3).
Si, en procesos de orden superior, el punto de inversión sigue muy alejado una vez alcanzado
el 75 % del escalón de consigna, hay una sobreoscilación clara. Además, los parámetros del
regulados son demasiado rigurosos. En este caso, atenúe los parámetros del regulador o
repita el ensayo.
La figura siguiente representa la sobreoscilación del valor real en caso de excitación
demasiado fuerte (tipo de sistema III):

838

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)
3+$6( 

3+$6( 

3+$6( 

r&
/01

3+$6( 

3+$6( 

/01
/01781B'/01
781B'/01

39TXHUHVXOWDU¯DVL
HO/01QRKD
FDPELDGR

3XQWRGHLQYHUVLµQ
39

(VWDGRGHSURFHVR
HQFDOLHQWH SXQWRGH
WUDEDMR

63
63

(VWDGRGH
SURFHVRHQIU¯R

W
781B21
W

En procesos de temperatura típicos, una cancelación justo ante de alcanzar el punto de
inversión no es crítica respecto de los parámetros del regulador.
Si repite el ensayo, reduzca TUN_DLMN o aumente el escalón de consigna.
Principio: la variable manipulada de optimización debe concordar con el escalón de consigna.

Error de estimación con tiempo de retardo u orden
El tiempo de retardo (STATUS_H = 2x1xx o 2x3xx) o el orden (STATUS_H = 21xxx o 22xxx)
no ha podido registrarse correctamente. Se sigue trabajando con un valor estimado que puede
provocar parámetros no óptimos del regulador.
Repita la optimización y asegúrese de que no se produzcan perturbaciones en el valor real.
Nota
El caso especial de un proceso PT1 puro también se señala con STATUS_H = 2x1xx (TU <=
3*CYCLE). En este caso no es necesario repetir el ensayo. Atenúe los parámetros del
regulador si la regulación oscila.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

839

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Calidad de las señales medidas (ruido medido, perturbaciones de baja frecuencia)
El resultado de la optimización puede verse entorpecido por ruidos medidos o perturbaciones
de baja frecuencia. En tal caso, considere lo siguiente:
● En caso de ruidos medidos, seleccione una frecuencia de muestreo más bien alta que baja.
Dentro de un período de ruido, el valor real debe muestrearse como mínimo dos veces. En
el modo Impulso sirve de ayuda la filtración integrada del valor medio. De todas formas,
requiere que el valor PV se transfiera a la instrucción en el ciclo de impulso rápido. La
medida de ruido no debería exceder un 5 % del cambio de señal útil.
● Las perturbaciones de alta frecuencia ya no pueden eliminarse por filtración mediante
TCONT_CP. Dichas perturbaciones ya deberían haberse filtrado en el sensor de medición
para impedir el efecto aliasing.
La figura siguiente representa el efecto aliasing con un tiempo de muestreo demasiado
grande:
;

W

● En caso de perturbaciones de baja frecuencia es relativamente fácil garantizar una tasa de
muestreo lo suficientemente elevada. Por otro lado, el TCONT_CP debe generar una señal
medida homogénea a causa de un intervalo elevado de la filtración de valores medios. Una
filtración de valores medios debe abarcar como mínimo dos períodos de ruido. De esta
forma, dentro del bloque se generan rápidamente tiempos de muestreo más grandes, de
modo que se merma la precisión de la optimización. Una precisión suficiente se garantiza
con un mínimo de 40 períodos de ruido hasta el punto de inversión.
Medidas posibles al repetir el ensayo:
aumentar TUN_DLMN.

840

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Sobreoscilación
En las situaciones siguientes pueden producirse sobreoscilaciones:
Situación

Causa

Fin de la optimi‐ ● Excitación mediante un cambio
zación
demasiado brusco de la variable
manipulada en comparación con el
escalón de consigna (véase arriba).
● Regulador PI activado mediante
PID_ON = FALSE.
Optimización
en fase 7

Solución
● Aumentar el escalón de consigna o
reducir el escalón de la variable
manipulada
● Si el proceso admite un regulador
PID, inicie la optimización con
PID_ON = TRUE.

Primero se han determinado parámetros más suaves para el regulador (tipo de sis‐
tema III) que pueden provocar sobreosci‐
laciones en la fase 7.

Modo de regula‐ Regulador PI y con PFAC_SP = 1.0 para el Si el proceso admite un regulador PID,
ción
tipo de sistema I.
inicie la optimización con PID_ON =
TRUE.

Realizar una optimización inicial
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.

Procedimiento
Para determinar los parámetros PID óptimos en la primera puesta en servicio, proceda del
siguiente modo:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimización inicial".
TCONT_CP está preparado para la optimización.
3. En el campo "Escalón de la variable manipulada" indique el valor en el que debe
aumentarse la variable manipulada.
4. En el campo "Consigna", indique una consigna. El escalón de la variable manipulada se
hace efectivo sólo con una nueva consigna.
"Iniciar optimización".
5. Haga clic en el símbolo
Se inicia la optimización inicial. Se muestra el estado de la optimización.

Realizar optimización fina
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

841

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Procedimiento
Para determinar los parámetros PID óptimos en el punto de operación, proceda del siguiente
modo:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimización fina".
TCONT_CP está disponible para la optimización.
3. En el campo "Escalón de la variable manipulada" indique el valor en el que debe
aumentarse la variable manipulada.
4. Haga clic en el símbolo
"Iniciar optimización".
Se inicia la optimización fina. Se muestra el estado de la optimización.

Cancelación de la optimización inicial o fina
Para cerrar una optimización inicial o fina, haga clic en el símbolo

"Detener optimización".

Si los parámetros PID no se han calculado y almacenado todavía, TCONT_CP se inicia en el
modo automático con LMN = LMN0 + TUN_DLMN. Si el regulador se encontraba en modo
manual antes de la optimización, se emitirá la variable manipulada manual antigua.
Si los parámetros PID calculados ya están almacenados, TCONT_CP se inicia en el modo
automático y funciona entonces con los parámetros PID calculados hasta la fecha.

Optimización fina manual en modo de regulación
Para conseguir un comportamiento de consigna sin sobreoscilaciones pueden tomarse las
medidas siguientes:

Adaptar la zona de regulación
En la optimización se determina una zona de regulación CON_ZONE del TCONT_CP y se
activa con un tipo de sistema adecuado (I y II) y un regulador PID (CONZ_ON = TRUE). En el
modo de regulación es posible modificar la zona de regulación o desactivarla completamente
(con CONZ_ON = FALSE).
Nota
Si se activa la zona de regulación en procesos de orden superior (tipo III), no suele suponer
ninguna ventaja, porque en este caso la zona de regulación es mayor que el rango de
regulación asequible con el 100 % de la magnitud manipulada. Tampoco es ventajoso activar
la zona de regulación para regulador PI.
Antes de activar a mano la zona de regulación, asegúrese de no ajustar un ancho de zona de
regulación demasiado pequeño. Si el ancho de la zona de regulación ajustado fuera
insuficiente, se producirán oscilaciones en las curvas de la magnitud manipulada y del valor
real.

842

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Atenuar continuamente la respuesta de regulación con PFAC_SP
La respuesta de regulación se atenúa con el parámetro PFAC_SP. Dicho parámetro determina
qué proporción de la acción P será efectiva en casos de escalones de consigna.
PFAC_SP se predetermina a 0.8 mediante la optimización, independientemente del tipo de
sistema; seguidamente puede modificarse el valor. Para limitar las sobreoscilaciones a un 2 %
aproximadamente en caso de escalones de consigna (si los demás parámetros del regulador
son correctos), son suficientes los valores siguientes para PFAC_SP:
Tipo de sistema I

Tipo de sistema II

Tipo de sistema III

Proceso de temperatura tí‐
pico

Rango de transición

Proceso de temperatura de orden supe‐
rior

PI

0.8

0.82

0.8

PID

0.6

0.75

0.96

Ajuste el factor predeterminado (0.8), especialmente en los casos siguientes:
● Tipo de sistema I con PID (0.8 -> 0.6): los escalones de consigna dentro de la zona de
regulación provocan todavía un 18 % de sobreoscilaciones con PFAC_SP = 0.8.
● Tipo de sistema III con PID (0.8 -> 0.96): los escalones de consigna con PFAC_SP = 0.8 se
amortiguan demasiado. Se regala un tiempo de ajuste claro.

Amortiguar los parámetros de regulación
Si en el lazo de regulación cerrado se producen oscilaciones o si hay sobreoscilaciones
después de escalones de consigna, es posible girar hacia atrás la ganancia del regulador
GAIN (p. ej. al 80 % del valor original) y aumentar el tiempo de acción integral TI (p. ej. al 150
% del valor original). Si la magnitud manipulada analógica del regulador continuo se convierte
en señales manipuladas binarias con un generador de impulsos, es posible que aparezcan
pequeñas oscilaciones continuas debido a los efectos de cuantificación. Dichas oscilaciones
se eliminan aumentando la zona muerta del regulador DEADB_W.

Modificar los parámetros de regulación
Para modificar los parámetros del regulador, proceda del siguiente modo:
1. Guarde los parámetros actuales con SAVE_PAR.
2. Modifique los parámetros.
3. Pruebe el comportamiento de regulación.
Si los parámetros nuevos fueran peores que los antiguos, vuelva a ajustar los parámetros
antiguos con UNDO_PAR.

Realizar una optimización fina manual
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

843

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Procedimiento
Para determinar manualmente los parámetros PID óptimos, proceda del siguiente modo:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Manual".
3. Introduzca los nuevos parámetros PID.
4. Haga clic en el grupo "Optimización" en el símbolo

"Enviar parámetros a la CPU".

5. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna" .
6. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
símbolo .
7. En caso necesario, desactive la casilla de verificación "Modo manual".
El regulador trabaja con los nuevos parámetros PID y regula según la nueva consigna.
8. Compruebe la calidad de los parámetros PID mediante los recorridos de la curva.
9. Repita los pasos del 3 hasta el 8, hasta que esté satisfecho/a con el resultado de la
regulación.

3.4.1.4

TCONT_S

Objeto tecnológico TCONT_S
El objeto tecnológico TCONT_S pone a disposición un regulador paso a paso para elementos
finales de control con comportamiento integrador y sirve para regular los procesos técnicos de
temperatura con señales binarias de salida de variable manipulada. El objeto tecnológico
corresponde al bloque de datos de instancia de la instrucción TCONT_S. El modo de trabajo
se basa en el algoritmo de regulación PI del regulador de muestreo. El regulador paso a paso
opera sin realimentación de posición. Es posible elegir entre el modo manual y el automático.
S7-1500
Todos los parámetros y variables del objeto tecnológico son remanentes y, al efectuarse la
carga en el dispositivo, solo pueden modificarse si se carga TCONT_S por completo.

Consulte también
Vista general de los reguladores de software (Página 661)
Agregar objetos tecnológicos (Página 664)
Configurar objetos tecnológicos (Página 665)
Cargar objetos tecnológicos en el dispositivo (Página 667)

844

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Configurar el error de regulación de TCONT_S
Utilizar el valor real de periferia
Para utilizar el parámetro de entrada PV_PER, proceda del siguiente modo:
1. Seleccione la entrada "Periferia" en la lista "Origen".
2. Seleccione el "Tipo de sensor".
Según el tipo de sensor, el valor real se normaliza según diferentes fórmulas.
– Termopares
estándar; PT100/NI100
PV = 0.1 × PV_PER × PV_FAC + PV_OFFS
– Climatiz.;
PT100/NI100
PV = 0.01 × PV_PER × PV_FAC + PV_OFFS
– Intensidad/tensión
PV = 100/27648 × PV_PER × PV_FAC + PV_OFFS
3. Introduzca factor y offset para la normalización del valor real de periferia.

Utilizar el valor real interno
Para utilizar el parámetro de entrada PV_IN, proceda del siguiente modo:
1. Seleccione la entrada "Interno" en la lista "Origen".

Error de regulación
Ajuste un ancho de zona muerta según los siguientes requisitos:
● La señal del valor real tiene ruido.
● La ganancia del regulador es alta.
● La acción D está activada.
La componente de ruido del valor real provoca, en este caso, fuertes variaciones de la variable
manipulada. La zona muerta suprime la componente de ruido cuando el estado del regulador
es estacionario. El ancho de zona muerta indica el tamaño de la zona muerta. Con un ancho
de zona muerta de 0.0, la zona muerta se encuentra desactivada.

Configurar el algoritmo de regulación TCONT_S
General
1. Introduzca el "Tiempo de muestreo del algoritmo PID".
El tiempo de muestreo del regulador no debería exceder un 10 % del tiempo de integración
del regulador (TI) calculado.
2. Si la estructura de regulador contiene una acción P, introduzca la "Ganancia proporcional".
Una ganancia proporcional negativa invierte el sentido de regulación.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

845

Regulación PID
3.4 Regulación PID (S7-300, S7-400, S7-1500)

Acción P
En caso de modificaciones de la consigna, la acción P puede provocar sobreoscilaciones.
Mediante la ponderación de la acción P se puede elegir con qué intensidad debe actuar la
acción P al cambiar la consigna. La atenuación de la acción P se logra mediante una
compensación en la acción I.
1. Para atenuar la acción P en caso de modificaciones de la consigna, introduzca la
"Ponderación de la acción P".
– 1.0: Acción P completamente efectiva en caso de modificación de la consigna
– 0.0: Acción P inefectiva en caso de modificación de la consigna

Acción I
1. Si la estructura de regulador contiene una acción I, introduzca el "Tiempo de integración".
Con un tiempo de integración de 0.0, la acción I se encuentra desactivada.

Configurar la variable manipulada TCONT_S
Generador de impulsos
1. Introduzca la duración mínima de impulso y la duración mínima de pausa.
Los valores deben ser mayores o iguales al tiempo de ciclo en el parámetro de entrada
CYCLE. De esta manera, se reduce la frecuencia de maniobra.
2. Introduzca el tiempo de posicionamiento del motor.
El valor debe ser mayor o igual al tiempo de ciclo en el parámetro de entrada CYCLE.

Poner en marcha TCONT_S
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.

Procedimiento
Para determinar manualmente los parámetros PID óptimos, proceda del siguiente modo:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. Introduzca los parámetros PID nuevos en los campos "P", "I", "D" y ponderación de la
acción P.
3. Haga clic en el grupo "Optimización" en el símbolo

"Enviar parámetros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna" .
5. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
símbolo .

846

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
6. En caso necesario, desactive la casilla de verificación "Modo manual".
El regulador trabaja con los nuevos parámetros y regula según la nueva consigna.
7. Compruebe la calidad de los parámetros PID mediante los recorridos de la curva.
8. Repita los pasos del 2 hasta el 6, hasta que esté satisfecho/a con el resultado de la
regulación.

3.5

Regulación PID (S7-300, S7-400)

3.5.1

Utilizar control PID estándar

3.5.1.1

Utilizar PID_CP

Objeto tecnológico PID_CP
El objeto tecnológico PID_CP ofrece un regulador PID continuo para los modos automático y
manual. Equivale al bloque de datos de instancia de la instrucción PID_CP. Es posible
configurar los siguientes reguladores:
● Regulación de valor fijo con regulador P, PI, PD y PID continuo
● Regulación de valor fijo con control anticipativo
● Regulación en cascada
● Regulación de relación de dos lazos
● Regulación de mezcla
Se configuran las funciones siguientes del objeto tecnológico PID_CP:
● Normalización de la señal de valor real
● Supresión de oscilaciones de alta frecuencia en la rama del valor real mediante filtrado
(retardando) la señal del valor real.
● Linealización de funciones cuadráticas del valor real (regulación de caudal con sensores de
presión diferencial)
● Llamada de "funciones propias" en la rama del valor real
● Vigilancia de rebase por exceso de los límites de alarma y advertencia del valor real
● Vigilancia de la velocidad de cambio del valor real
● Modificación de la consigna por generador ramp soak
● Normalización de una señal de consigna externa en las regulaciones de relación
● Llamada de "funciones propias" en la rama de la consigna
● Limitación de la velocidad de cambio de la consigna
● Limitación de los valores absolutos de la consigna

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

847

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
● Filtrado de la señal de error de regulación por una zona muerta
● Vigilancia de rebase por exceso de los límites de alarma y advertencia del error de
regulación
● Acciones P, I y D activables individualmente
● Efecto P y D opcional en la rama de realimentación del regulador.
● Control anticipativo
● Control de la variable manipulada en modo manual desde una programadora o un
dispositivo HMI
● Llamada de "funciones propias" en la rama de la variable manipulada
● Limitación de la velocidad de cambio de la variable manipulada
● Limitación de los valores absolutos de la variable manipulada
● Normalización de la variable manipulada
● Modulación de ancho de impulsos para reguladores de impulsos

Cálculo de error de regulación
Valor real
Normalización (PV_NORM)
Mediante la casilla de verificación "Activar periferia" se especifica la magnitud de entrada
analógica que se normaliza a la unidad física del valor real.
● Activada: la magnitud de entrada es el valor real de periferia (PV_PER)
● Desactivada: la magnitud de entrada es el valor real interno (PV_IN)
Para definir la recta de normalización de forma unívoca, defina los cuatro parámetros
siguientes:
● entrada arriba (NM_PIHR)
● entrada abajo (NM_PILR)
● salida arriba (NM_PVHR)
● salida abajo (NM_PVLR)
Los parámetros se prestablecen según el tipo de sensor.
El valor real se calcula con la fórmula siguiente a partir del respectivo valor de entrada PV_PER
o PV_IN:
MP4 = (PV_PER - NM_PILR) × (NM_PVHR - NM_PVLR) / (NM_PIHR - NM_PILR) + NM_PVLR
O bien:
MP4 = (PV_IN - NM_PILR) × (NM_PVHR - NM_PVLR) / (NM_PIHR - NM_PILR) + NM_PVLR

848

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
03
10B39+5

10B39/5

10B3,/5

39B3(5
39B,1

10B3,+5

El valor real se emite en la variable estática MP4.
No se limitan valores ni se comprueban parámetros. Si se introduce el mismo valor para la
entrada arriba y la entrada abajo, según las fórmulas anteriores se puede producir una división
por cero. Esto no se considera en la instrucción.

Funciones de filtro
Filtrar magnitud regulada (LAG1ST)
Para filtrar señales de proceso con oscilaciones rápidas superpuestas (Noise) se utiliza un
elemento de retardo de primer orden en la rama del valor real. Esta función atenúa en mayor
o menor grado la magnitud regulada analógica en función de la constante de tiempo ajustada
(PV_TMLAG). De ese modo se suprimen de forma efectiva las señales perturbadoras. Sin
embargo, con esta medida también se aumenta en general la constante de tiempo de todo el
lazo de regulación, de modo que la regulación es más lenta.
El efecto atenuador se consigue con un algoritmo de retardo de 1er orden.
La respuesta al escalón en el rango de tiempo es:
outv(t) = MP4(0) (1 - e -t/PV_TMLAG)
RXWY

03 
RXWY W

W
39B70/$*

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

 39B70/$*

849

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

MP4(0)

la altura del escalón del valor real en la entrada

outv(t)

la magnitud de salida

PV_TMLAG

la constante de tiempo de retardo

t

Tiempo

Filtrado del valor real
Si el filtrado del valor real (LAG1STON = FALSE) no está activado, la entrada de periferia
(PV_PER) o la entrada interna (PV_IN) se aplican sin retardo en la rama del valor real.

Tiempo de retardo
El parámetro de entrada PV_TMLAG determina el tiempo de retardo para el valor real. Todo el
rango de valores es admisible.
Si PV_TMLAG ≤ 0.5 * CYCLE ya no actúa ningún retardo.
Se requiere un tiempo de muestreo (CYCLE) de menos de una quinta parte del tiempo de
retardo para obtener un comportamiento de retardo aproximadamente equivalente al
comportamiento analógico.

Calcular raíz cuadrada (SQRT)
La función "Cálculo de la raíz cuadrada" (SQRT) permite linealizar la magnitud regulada. Si el
valor real proporcionado por un encóder está presente como magnitud física en relación
cuadrática con la magnitud de proceso medida, el desarrollo de la magnitud regulada debe
linealizarse antes de su procesamiento en el regulador.
La señal de medición siempre debe linealizarse extrayendo la raíz cuadrada si se realizan
mediciones de caudal con diafragmas o tubos de Venturi, etc. La presión diferencial medida
(presión efectiva) es así proporcional al cuadrado del caudal.
A través de la señal de entrada SQRT_ON = TRUE se activa la función de raíz cuadrada en la
rama de valor real. El algoritmo de la función de raíz cuadrada es el siguiente:
outv = SQRT (MP5) × (SQRT_HR – SQRT_LR) / 10.0 + SQRT_LR
outv es el valor de salida normalizado de la función de raíz cuadrada (caudal físico).
Esta fórmula presupone que el valor de entrada de la raíz está normalizado a un rango
numérico entre 0 y 100. En la normalización del valor real deben parametrizarse el "Rango de
medida superior" y el "Rango de medida inferior" a 100.0 y 0.0, respectivamente. La raíz de
este valor da como resultado un rango de medida entre 0 y 10. Este rango se normaliza
mediante el límite superior (SQRT_HR) y el límite inferior del rango de medida físico
(SQRT_LR).

850

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
RXWY

6457B+5

6457B/5
03




Ejemplo de normalización
El valor de entrada PV_IN del regulador es la presión diferencial en mbar:
Principio del rango de medida
NM_PILR

Fin del rango de medida
NM_PIHR

Ejemplo de valores de PV_IN

20,0 mbar

200,0 mbar

150,0 mbar

Con la función de normalización PV_NORM se calcula la presión diferencial normalizada,
seleccionando NM_PVHR = 100.0 y NM_PVLR = 0.0:
MP4

=
=
=

(PV_IN - NM_PILR) * (NM_PVHR - NM_PVLR) /
(NM_PIHR - NM_PILR) + NM_PVLR
(PV_IN - 20.0 mbar) * (100.0 - 0.0) /
(200.0 mbar - 20.0 mbar) + 0.0
(PV_IN - 20.0 mbar) * 100 / 180.0 mbar

Valor inicial de MP4

Valor final de MP4

Ejemplo de valores de MP4

0.0

100.0

72.222

En este ejemplo no se utiliza ningún filtrado y, por lo tanto, rige lo siguiente: MP5 = MP4.
Para la raíz de la presión diferencial normalizada MP5 resulta:
Valor inicial tras la raíz

Valor final tras la raíz

Ejemplo de valores de
SQRT(MP5)

0.0

10.0

8.498

Para el valor de salida normalizado outv de la función de raíz (caudal físico) sigue con
SQRT_HR = 20000.0 m3/h und SQRT_LR = 0.0 m3/h:
outv

=
=
=

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

SQRT(MP5) * (SQRT_HR - SQRT_LR) / 10.0 + SQRT_LR
SQRT(MP5) * (20000.0 m3/h - 0.0 m3/h) / 10.0 + 0.0 m3/h
2000.0 m3/h * SQRT(MP5)

851

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Principio del rango de medida
outv

Fin del rango de medida outv

Ejemplo de valores de outv

0,0 m3/h

20000,0 m3/h

16996,732 m3/h

Llamada de FC en la rama de valor real (PVFC)
La inserción de una función específica de usuario en la rama de valor real permite someter la
magnitud regulada a un tratamiento de señal antes de su procesamiento en el regulador (p. ej.
un retardo de señal o linealización).

Llamar una función
Para insertar una función específica de usuario en la rama del valor real, active "Activar
llamada de FC" (PVFC_ON). En el campo de entrada "Número de FC" (PVFC_NBR) se indica
el número de la función utilizada. El regulador ejecuta una llamada de la función. En ella no se
suministran valores a los parámetros de entrada y salida de la función de usuario. La
transferencia de datos debe programarla el usuario en su función.
El valor de salida de la función puede observarse en la variable estática MP6.
Nota
No se comprueba si una función está disponible. Si la función no está disponible, la CPU pasa
a STOP con un error interno de sistema.

Alarma
Vigilar los límites del valor real (PV_ALARM)
Si se rebasan por exceso o defecto determinados valores de las magnitudes del proceso
(como velocidad, presión, nivel de llenado, temperatura, etc.), en las regulaciones pueden
producirse estados no permitidos de proceso o instalación. En estos casos se aplica la
vigilancia de los límites del valor real (PV_ALARM) para controlar si el valor real rebasa el
rango de servicio admisible por exceso o por defecto. Los rebases de límite se registran y
notifican a fin de activar una respuesta adecuada.
Nota
La vigilancia de los límites del valor real no puede desactivarse. El rebase por exceso de los
límites configurados se notifica siempre.
La vigilancia de los límites del valor real (PV_ALARM) vigila la magnitud regulada PV(t) en
función de cuatro límites predefinibles en dos zonas de tolerancia. Cuando los límites se
alcanzan o rebasan, la función notifica "Advertencia" en el primer límite y "Alarma" en el
segundo.

852

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Valores límite
Los valores numéricos de los límites se ajustan en los parámetros de entrada para
"Advertencia" y "Alarma". Si el valor real (PV) rebasa estos límites por exceso o defecto, se
activan los bits de aviso de salida correspondientes para la alarma superior (QPVH_ALM), la
advertencia superior (QPVH_WRN), la advertencia inferior (QPVL_WRN) y la alarma inferior
(QPVL_ALM).
Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
QPVH_ALM

QPVH_WRN

QPVL_WRN

QPVL_ALM

si:

y:

TRUE

TRUE

FALSE

FALSE

PV ↗

PV ≥ PVH_ALM

PV ↘

PV ≥ PVH_ALM - PV_HYS

PV ↗

PV ≥ PVH_WRN

PV ↘

PV ≥ PVH_WRN - PV_HYS

PV ↘

PV ≤ PVL_WRN

PV ↗

PV ≤ PVL_WRN + PV_HYS

PV ↘

PV ≤ PVL_ALM

PV ↗

PV ≤ PVL_ALM + PV_HYS

FALSE

TRUE

FALSE

FALSE

FALSE

FALSE

FALSE
TRUE

FALSE
FALSE

TRUE

TRUE

Para que el bloque funcione de manera eficiente debe aplicarse lo siguiente:
alarma superior < advertencia superior < advertencia inferior < alarma inferior
39 W

39

39B+<6

39+B$/0
39+B:51




39/B:51
39/B$/0
W

439+B$/0
439+B:51
439/B:51
439/B$/0

①
②

1. banda de tolerancia
2. banda de tolerancia

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

853

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Histéresis
Para impedir que los bits de aviso "centelleen" con cambios muy pequeños de la magnitud de
entrada o con errores de redondeo, se ajusta una histéresis (diferencia de desactivación)
PV_HYS. La magnitud regulada debe superar la histéresis antes de que los bits de aviso se
desactiven.

Vigilar la velocidad de cambio del valor real (ROCALARM)
Si el cambio de la magnitud de proceso (p. ej. velocidad, presión, nivel de llenado, temperatura,
etc.) es demasiado elevada, en las regulaciones pueden producirse estados no permitidos de
proceso o instalación. En estos casos se aplica la vigilancia de la velocidad de cambio del valor
real (ROCALARM) para controlar si el valor real rebasa por exceso o por defecto una velocidad
de cambio admisible. Los rebases de límite se registran y notifican a fin de activar una
respuesta adecuada.
Nota
La vigilancia de la velocidad de cambio del valor real (ROCALARM) no puede desactivarse. El
rebase por exceso de los límites configurados se notifica siempre.
La función ROCALARM vigila la magnitud regulada PV(t) respecto a límites admisibles de
velocidad de cambio, los cuales pueden ajustarse de forma diferente según el signo
correspondiente.
Los valores numéricos de las pendientes límite se ajustan en los parámetros de entrada
"Rampa de subida máxima" y "Rampa de bajada máxima" en el rango positivo y negativo de
la magnitud regulada. Las pendientes se refieren a la subida o bajada en porcentaje por
segundo. Si la velocidad de cambio de la magnitud regulada supera estos límites, se activan
los bits de aviso de salida correspondientes QPVURLMP ... QPVDRLMN.
39

39 W
3985/0B3
39'5/0B3
39'5/0B1
3985/0B1

W

3985/0B1

43985/0B3
439'5/0B3
439'5/0B1
43985/0B1

854

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
La identificación de los parámetros de las rampas se realiza según el siguiente esquema:
Parámetro

Cambio de PV

Rampa de subida máxima en el
rango positivo (PVURLM_P)

PV > 0 y |PV| ascendente

Rampa de bajada máxima en el
rango positivo (PVDRLM_P)

PV > 0 y |PV| descendente

Rampa de subida máxima en el
rango negativo (PVURLM_N)

PV < 0 y |PV| ascendente

Rampa de bajada máxima en el
rango negativo (PVDRLM_N)

PV < 0 y |PV| descendente

Consigna
Definir la consigna
Seleccione un origen para la consigna. Las posibilidades son las siguientes:
● Consigna interna
El parámetro de entrada SP_INT se utiliza como consigna
● Generador de consigna
El parámetro de entrada SP_INT se utiliza como consigna y puede aumentarse o
disminuirse mediante las variables estáticas SPUP y SPDN.
● Generador ramp soak
El parámetro de entrada SP_INT se utiliza como consigna y puede modificarse siguiendo
un perfil predefinido.
● Consigna externa
En los reguladores de mezcla, relación y cascada se utiliza el parámetro de entrada
SP_EXT como consigna. La consigna externa puede normalizarse.
En el parámetro de salida SP se muestra la consigna efectiva.

Generador de consigna (SP_GEN)
La consigna interna SP_INT se aumenta o disminuye progresivamente utilizando los
interruptores SPUP y SPDN. El valor modificado puede observarse en MP1. Se tienen en
cuenta los límites configurados de la consigna.

Repercusión de los interruptores SPUP y SPDN
Para poder realizar un cambio graduado finamente, el regulador debe tener un tiempo de
muestreo de 100 ms como máximo.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

855

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
La velocidad de cambio de la magnitud de salida depende de la duración de pulsación de los
interruptores SPUP y SPDN así como de los límites ajustados de acuerdo con la relación
siguiente:
● durante los primeros 3 segundos después de activar SPUP o SPDN rige:
doutv/dt = (SP_HLM - SP_LLM) / 100 s
● a continuación
doutv/dt = (SP_HLM - SP_LLM) / 10 s
RXWY
63B+/0

V
W
V

V

63B//0

6383

63'1

W
V
W

Con un tiempo de muestreo de 100 ms y un rango de consigna de -100,0 a 100,0, la consigna
cambia en 0,2 por ciclo en los tres primeros segundos, por ejemplo. Si SPUP permanece en
TRUE durante más de 3 segundos, la velocidad de cambio aumenta a diez veces el valor, en
este caso a 2 por ciclo.

Arranque y funcionamiento del generador de consigna
● Durante el rearranque la salida outv se pone a 0.0.
● Al activar el generador de consigna (SPGEN_ON = TRUE), en la salida outv se muestra
primero el valor de señal SPFC_IN. Por este motivo, la conmutación al generador de
consigna desde otro modo de operación se produce siempre suavemente. Mientras los
interruptores SPUP y SPDN (teclas arriba y abajo) no se activan, SPFC_IN permanece en
la salida.

856

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Parámetros de la función SP_GEN
El parámetro de salida outv es un parámetro implícito. Este puede observarse en la
herramienta de configuración mediante el punto de medición MP1.
Parámetro

Significado

Rango admisible

SPFC_IN

Consigna de la entrada de FC

Rango técnico

SP_INT

Consigna interna

Rango técnico

63B*(1

63*(1B21 %22/

)$/6(

6383

%22/

)$/6(

63'1

%22/

)$/6(

63B+/0

5($/



63B//0

5($/




63)&B,1

5($/



RXWY




63B,17

Figura 3-1

5($/

03

5($/





Esquema funcional y parámetros del generador de consigna

Generador ramp soak (RMP_SOAK)
Si la consigna SP_INT debe cambiar por sí misma en función del tiempo, p. ej. en la regulación
de procesos conforme a un programa de temperatura controlado por tiempo, es posible
hacerlo configurando un perfil y activando el generador ramp soak. El cambio de la consigna
se calcula a partir de segmentos con un máximo de 256 nodos.
Nota
La función del bloque no comprueba si existe un DB global con el número "DB_NBR" ni
tampoco si el parámetro "Número de nodos" NBR_PTS coincide con la longitud del DB. Si la
parametrización es incorrecta, la CPU cambia al estado STOP con un error de sistema interno.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

857

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Funcionamiento del generador ramp soak
El generador ramp soak proporciona una función de la magnitud de salida outv que se ejecuta
de acuerdo con una programación determinada. El desarrollo del perfil se define con una serie
de nodos en un bloque de datos global DB_RMPSK con los valores de tiempo PI[i].TMV y los
correspondientes valores de salida PI[i].OUTV.
● PID-CP
AUTOHOTSPOT no está incluido en la librería. Debe crear usted mismo este bloque de
datos global.
● PID-ES
AUTOHOTSPOT no está incluido en la librería. Debe crear usted mismo este bloque de
datos global.
La figura siguiente muestra un perfil con 6 nodos.
RXWY
3,>@2879
3,>@2879




RXWY W

3,>@2879
3,>@2879








3,>@709

W
3,>@709

3,>@2879 
3,>@2879
3,>@709

3,>@709
3,>@709

3,>@709

3,>@709

PV

Para el último nodo n, el valor de tiempo PI[n].TMV = 0 ms. El tiempo de procesamiento de un
perfil se calcula partiendo del valor inicial y descendiendo hasta cero.
PI[i].TMV indica los intervalos entre nodo y nodo. Entre los nodos se interpola de acuerdo con
la función siguiente:
RXWY W  3,>Q@2879

56B70
3,>Q@709

3,>Q@28793,>Q@2879 

0 ≤ n ≤ (NBR_PTS - 1)
1RGR

3,>@2879
3,>@709

RXWY

1RGR

3XQWRLQLFLDO

3,>@2879
3,>@709

3,>@2879
3,>@709

3,>@709

3,>@709

3,>@709
W

858

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Nota
Nota
Al interpolar la curva de evolución entre los nodos, es posible que el valor de salida se
mantenga temporalmente fijo si resulta que el tiempo de muestreo CYCLE es muy pequeño
con respecto al tiempo entre los nodos PI[n].TMV. El generador ramp soak no puede linealizar
curvas planas debido a la precisión de cálculo de la CPU. Si la curva es demasiado plana, el
valor de salida permanece por un tiempo en el nodo correspondiente y, pasado cierto tiempo,
se integra en el próximo nodo con la pendiente mínima.
Solución: reduzca el tiempo entre los nodos insertando más nodos. De este modo, la curva
emitida se acercará a la curva plana deseada en forma de trapecio.

Activar el generador ramp soak
Con el cambio RMPSK_ON de FALSE a TRUE se activa el generador ramp soak. Una vez
alcanzado al último nodo se termina el perfil. Cuando el operador reinicia la función, es
necesario poner primero RMPSK_ON a 'FALSE' y a continuación a 'TRUE'.
En el rearranque, la salida outv se pone a 0.0 y se determina el tiempo total o el tiempo residual
total. En la transición al modo normal, la curva de evolución se procesa inmediatamente desde
el punto inicial de acuerdo con el modo de operación ajustado. Si no se desea que esto suceda,
el parámetro RMPSK_ON debe ponerse a FALSE en el OB de rearranque.

Funciones del generador ramp soak
La instrucción dispone de las funciones siguientes:
● Activar generador ramp soak para ejecución única
● Preasignar salida con valor fijo
● Activar repetición cíclica
● Detener generador ramp soak
● Continuar generador ramp soak
● Actualizar tiempo total de procesamiento y tiempo residual total
Para ajustar el modo de operación deseado se aplica la valencia de las entradas de control
especificada en la siguiente tabla:
Modo de operación

RMPSK_
ON

DFOUT_ RMP_
ON
HOLD

CONT_
ON

CYC_
ON

TUPDT_
ON

Señal de salida OUTV

Activar generador ramp
soak

TRUE

FALSE

**)

FALSE

**)

OUTV(t)

Especificar salida

TRUE

FALSE

El valor final se mantiene
tras el final de procesamien‐
to.

Activar repetición cíclica TRUE

TRUE

**)

**)

**)

**)

DF_OUTV

FALSE

FALSE

**)

TRUE

**)

OUTV(t)
Tras final: arranque auto‐
mático

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

859

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Modo de operación

RMPSK_
ON

DFOUT_ RMP_
ON
HOLD

CONT_
ON

CYC_
ON

TUPDT_
ON

Señal de salida OUTV

Detener generador
ramp soak

TRUE

FALSE

TRUE

FALSE

**)

**)

se mantiene el valor actual
de OUTV(t) *)

Continuar generador
ramp soak

TRUE

FALSE

TRUE

TRUE

**)

**)

OUTV (antiguo) *)

Actualizar el tiempo to‐
tal y el tiempo residual
total

**)

FALSE
**)

Se sigue con los nuevos va‐
lores predeterminados.

**)

**)

**)

FALSE

No influye en OUTV

TRUE

No influye en OUTV

*) Hasta el próximo nodo la curva no tiene la forma parametrizada por el usuario.
**) El modo de operación ajustado en cada caso se ejecuta independientemente de la valencia de las señales de control en
los campos marcados con **)

Especificar la salida del generador ramp soak
Si se activa esta función (DFRMP_ON = TRUE), el valor de salida del generador ramp soak se
pone al valor de señal SP_INT o al valor de salida SP_GEN.
Nota
La asignación previa con la consigna interna solo tiene efecto si el generador ramp soak está
activado (RMPSK_ON = TRUE).
Tras la conmutación DFRMP_ON = FALSE, outv se lleva linealmente de la consigna ajustada
(p. ej. SP_INT) al valor de salida del número de nodo actual PI[NBR_ATMS].OUTV.
El procesamiento interno de tiempo también continúa con una consigna fija aplicada
directamente (RMPSK_ON = TRUE y DFRMP_ON = TRUE).
Al iniciar la curva RMPSK_ON = TRUE se emite la consigna fija SP_INT hasta que
DFRMP_ON cambia de TRUE a FALSE después del tiempo T*.
5036.B21
')503B21

RXWY

63B,17


&XUYDFRQILJXUDGD
FXUYDDFWXDO



RXWY W









3,>@709
7

3,>@709

3,>@709 3,>@709
3,>@709

3,>@709

W

3,>@709 PV

45B6B$&7

860

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
En este momento ha transcurrido el tiempo PI[0].TMV y parte del tiempo PI[1].TMV. OUTV se
lleva de SP_INT a PI[2].OUTV, es decir, a la consigna del nodo 2.
La curva configurada se emite solo a partir del nodo 2. La coincidencia entre la curva
configurada y la actual se indica con QR_S_ACT = TRUE. Con un flanco ascendente en
DFOUT_ON durante el procesamiento de la curva, el valor de la salida OUTV salta sin retardo
a DF_OUTV.

Activar repetición cíclica
Cuando el modo de operación 'Repetición cíclica' (CYC_ON = TRUE) está activado, el
generador ramp soak vuelve automáticamente al punto inicial tras emitir el último valor de nodo
y se ejecuta de nuevo.
Entre el último nodo y el punto inicial no se interpola. Para una transición sin discontinuidad se
debe aplicar lo siguiente: PI[NBR_PTS].OUTV = PI[0].OUTV.

Detener generador ramp soak
Con RMP_HOLD = TRUE se congela el valor de la magnitud de salida (incluido el
procesamiento de tiempo). Cuando RMP_HOLD = FALSE se desactiva, PI[x].TMV continúa en
el punto de interrupción.
503B+2/'
')503B21
7
RXWY

63B,17




&XUYDFRQILJXUDGD
FXUYDDFWXDO
YDORUHVDFWXDOHV

 RXWY W








7



3,>@709
3,>@709 3,>@709
3,>@709 3,>@709
3,>@709
3,>@709
7LHPSRFRQILJXUDGR
3,>@7097
3,>@709
7LHPSRDFWXDO

W

45B6B$&7

El tiempo de procesamiento de la curva se prolonga por el tiempo T*. La curva presenta el
desarrollo configurado desde el nodo hasta el flanco ascendente en RMP_HOLD y desde el
nodo 5* hasta el nodo 6*, es decir, la señal de salida QR_S_ACT tiene el valor TRUE.
Si el interruptor CONT_ON está activado, el generador ramp soak detenido continúa en el
punto predeterminado TM_CONT con el procesamiento de la curva de desplazamiento.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

861

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Continuar generador ramp soak
Con CONT_ON se continúa una curva detenida en un punto definido. Si el generador ramp
soak no está detenido, CONT_ON no tiene efecto.
Si la entrada de control para continuar CONT_ON = TRUE está activada, el generador ramp
soak detenido continúa en el nodo TM_SNBR. TM_CONT determina el tiempo residual que
requiere el generador hasta que se alcanza el nodo TM_SNBR.
La figura siguiente muestra la influencia de RMP_HOLD y CONT_ON con la configuración
siguiente:
Continuar en el nodo 5 (TM_SNBR = 5) y continuar en T* s: TM_CONT = T*
1LQJXQDUHDFFLµQ

&217B21
503B+2/'

RXWY


7

&XUYDFRQILJXUDGD
FXUYDDFWXDOYDORUHV
DFWXDOHV



RXWY W





3,>@709 3,>@709
7LHPSRFRQILJXUDGR


3,>@709
3,>@709

7

3,>@709
3,>@709




3,>@709


W
3,>@709

7LHPSRDFWXDO
45B6B$&7

Los nodos 3 y 4 se suprimen para este ciclo de procesamiento del generador ramp soak.
Después del cambio de señal RMP_HOLD de TRUE a FALSE, el desarrollo configurado de la
curva solo se vuelve a alcanzar a partir del nodo 5.
La salida QR_S_ACT solo se activa cuando el generador ramp soak procesa la curva de
evolución parametrizada por el usuario.

Actualizar el tiempo total y el tiempo residual total
En cada ciclo se actualizan el número actual del nodo NBR_ATMS, el tiempo residual actual
hasta alcanzar el nodo RS_TM, el tiempo total T_TM y el tiempo residual total hasta alcanzar
el final de la curva RT_TM.
En caso de modificaciones online de PI[n].TMV, cambian el tiempo total y el tiempo residual
total de la curva. Ya que el cálculo de T_TM y RT_TM prolonga considerablemente el tiempo
de procesamiento del bloque de función en muchos nodos, este solo se realiza después del
rearranque o si TUPDT_ON = TRUE. Los intervalos PI[0 ... NBR_PTS].TMV entre los
diferentes nodos se suman y se muestran en la salida del tiempo total T_TM y del tiempo
residual total RT_TM.

862

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Tenga en cuenta que el cálculo de los tiempos totales requiere mucho tiempo de ejecución de
la CPU.

Procedimiento
Para configurar el generador ramp soak, proceda del siguiente modo:
1. En la lista "Origen de la consigna" seleccione la entrada "Generador ramp soak".
2. Cree un AUTOHOTSPOT (PID-CP) o un AUTOHOTSPOT (PID-ES).
3. Defina los parámetros necesarios para el perfil.
4. Introduzca el número del bloque de datos DB_RMPSK en el campo de entrada "Número de
DB".
5. Active o desactive las demás funciones del generador ramp soak.
6. Si ha activado la función "Continuar generador ramp soak", introduzca el nodo y el tiempo
en que deba continuar el generador.

Normalización
Normalización de una consigna externa
Si la consigna externa no está presente en la unidad física del valor real (p. ej. en % en una
cascada de regulador), es necesario normalizar ese valor y su rango de ajuste a la unidad física
del valor real. Para ello se utiliza la función "Normalización en la rama de consigna".
La función SP_NORM normaliza una magnitud de entrada analógica. La consigna externa
analógica se convierte a la magnitud de salida outv con la recta de normalización. El valor de
salida OUTV está accesible en la herramienta de configuración a través del punto de medición
MP2.
El valor de salida de la función es efectivo cuando la entrada de control es SPEXT_ON = TRUE.
Para definir la recta de normalización de forma unívoca, defina los cuatro parámetros
siguientes:
● Entrada arriba: SP_EXT: NM_SPEHR
● Entrada abajo: SP_EXT: NM_SPELR

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

863

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
● Salida arriba: NM_PVHR (este valor se introduce en la función de normalización del valor
real.)
● Salida abajo: NM_PVLR (este valor se introduce en la función de normalización del valor
real.)
RXWY

10B39+5

10B39/5
63B(;7
10B63(/5

10B63(+5

El valor de salida outv se calcula con la fórmula siguiente a partir del correspondiente valor de
entrada SP_EXT:
outv = (SP_EXT – NM_SPELR) x (NM_PVHR – NM_PVLR) / (NM_SPEHR – NM_SPELR) +
NM_PVLR
Para el caso especial de una función de raíz aplicada en la rama de valor real rigen como límite
superior e inferior del valor de salida outv los valores de normalización de la función de raíz
(SQRT_HR y SQRT_LR).
En ese caso, el valor de salida outv de la función de normalización se calcula con la fórmula
siguiente a partir del correspondiente valor de entrada SP_EXT:
outv = (SP_EXT – NM_SPELR) x (SQRT_HR – SQRT_LR) / (NM_SPEHR – NM_SPELR) +
SQRT_LR
Dentro de la función no se limitan los valores ni se comprueban los parámetros. Si introduce
el mismo valor para NM_SPEHR y NM_SPELR, según las fórmulas anteriores se puede
producir una división entre cero. Esto no se considera en la instrucción.

Factor de mezcla/relación
En una regulación de relación, las consignas de los lazos de regulación se adaptan unas a
otras de forma que la relación ajustada se corresponde con la relación efectiva de los valores
reales.
En una regulación de mezcla se ajusta la proporción deseada de cada uno de los
componentes. La suma de los factores de mezcla FAC debe dar 1.

864

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para configurar la normalización, proceda del siguiente modo:
1. Introduzca los valores de la normalización en los campos de entrada "Entrada arriba" y
"Entrada abajo".
2. Introduzca un factor de mezcla/relación (FAC).

Límites
Llamada de FC en la rama de consigna
La inserción de una función específica de usuario en la rama de consigna permite someter una
referencia predeterminada de forma externa a un procesamiento de señal (p. ej. un retardo de
señal o linealización) antes de aplicarla en el regulador.
Si se activa la llamada de FC en la rama de consigna, se llama una función específica de
usuario. El regulador ejecuta una llamada de la FC. En ella no se suministran valores a los
parámetros de entrada y salida de la función de usuario ya existentes. Por ello, la transmisión
de datos debe programarse manualmente con S7-AWL en la FC de usuario. La consigna
acondicionada se observa en MP3.
En ese caso, el valor de SPFC_ON determina si en el canal de la consigna se inserta en este
punto una función programada libremente en forma de FC estándar (p. ej. una curva
característica) o si la consigna continúa procesándose sin ninguna influencia de ese tipo.
Nota
La instrucción no comprueba si hay una función. Si la función no está disponible, la CPU pasa
a STOP con un error interno de sistema.

Procedimiento
Para llamar una función en la rama de la consigna, proceda del siguiente modo:
1. Active la casilla de verificación "Activar llamada de FC".
2. En el campo de entrada "FC", indique el número de la función que se va a llamar.

Limitación de la velocidad de cambio de la consigna
Las funciones de rampa en la rama de la consigna se utilizan en aquellos casos en que el
proceso no soporta cambios bruscos de la señal manipulada, ya que un cambio abrupto de la
consigna generalmente provoca también un escalón en la variable manipulada del regulador.
Estos cambios abruptos de la variable manipulada deben evitarse p. ej. en aquellos casos en
que entre el motor regulado y la carga que debe accionarse hay interpuesto un engranaje, y
una elevación muy rápida del número de revoluciones del motor derivaría en una sobrecarga
del engranaje.
La función SP_ROC limita la velocidad de cambio de las consignas procesadas en el
regulador, ya sea por separado para la rampa de subida y bajada, como por separado para los
rangos positivo y negativo de la referencia.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

865

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
En las cuatro entradas SPURLM_P, SPDRLM_P, SPURLM_N y SPDRLM_N se introducen las
limitaciones correspondiente para los aumentos de la función de rampa en los rangos positivo
y negativo de la referencia. Las rampas de subida se refieren a la subida o bajada por segundo.
Los cambios de consigna más rápidos se retardan a estas velocidades límite.
Si p. ej. SPURLM_P se parametriza a 10.0 [rango de valores tec./s], en cada ciclo de muestreo
se suman los siguientes valores al "valor antiguo" de outv mientras inv sea > outv:
Tiempo de muestreo

1s

outvantiguo + 10

100 ms

outvantiguo + 1

10 ms

outvantiguo + 0.1

La siguiente figura muestra el funcionamiento del procesamiento de la señal a partir de un
ejemplo. Las funciones de escalón en la entrada inv(t) se traducen en funciones de rampa en
la salida outv(t).
LQY
RXWY

LQY W

RXWY W
63'5/0B3

6385/0B3


6385/0B3
6385/0B1

W
63'5/0B1

Figura 3-2

Limitación de la velocidad de cambio de la referencia SP(t)

No se notifica el alcance de los límites de la pendiente.

Procedimiento
Para limitar la velocidad de cambio, proceda del siguiente modo:
1. Active la casilla de verificación "Limitar la velocidad de cambio".
2. Defina los siguientes valores tanto para el rango positivo como para el negativo:
– Rampa de subida de consigna
– Rampa de bajada de consigna

Limitación del valor absoluto de la referencia
El rango de ajuste de la referencia determina el rango dentro del cual puede oscilar la
referencia, es decir, el margen en el que se mueve el proceso dentro de los valores de estado
admisibles.
Por ello, para evitar estados de proceso críticos o no permitidos, Standard PID Control limita
el rango de ajuste de la referencia en la rama de consigna por arriba y por abajo (SP_LIMIT).
La función SP_LIMIT limita la consigna SP al valor inferior y superior predeterminable SP_LLM
y SP_HLM mientras la magnitud de entrada INV esté fuera de dichas limitaciones. Dado que

866

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
la función no puede desactivarse, en la configuración siempre hay que tener en cuenta la
indicación de los límites inferior y superior.
Los valores numéricos de los límites se ajustan en los parámetros de entrada para la limitación
inferior y superior. Si la magnitud de entrada inv(t) rebasa los límites, se emiten las
indicaciones correspondientes a través de las salidas de aviso.
LQY
63

LQY W

63B+/0

)UDQMDGHWROHUDQFLD

W


63 W
63B//0

463B+/0
463B//0

Figura 3-3

Limitación de valor absoluto de la referencia SP(t)

Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
SP =PVH_ALM

QSP_HLM

QSP_LLM

si:

SP_HLM

TRUE

FALSE

inv ≥ SP_HLM

SP_LLM

FALSE

TRUE

inv ≤ SP_LLM

inv

FALSE

FALSE

SP_HLM < inv < SP_LLM

Procedimiento
Para limitar el valor absoluto de la referencia, proceda del siguiente modo:
1. En el campo de entrada "Límite superior", indique el límite superior absoluto de la consigna
(SP_HLM).
2. En el campo de entrada "Límite inferior", indique el límite inferior absoluto de la consigna
(SP_LLM).

Error de regulación
Zona muerta

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

867

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
En caso de superposición de la magnitud regulada o la referencia con una señal perturbadora
de mayor frecuencia, en un regulador con ajuste óptimo el ruido también es efectivo en la
salida del regulador. En una amplificación elevada del regulador y con derivación activada, por
ejemplo, esto puede provocar importantes oscilaciones en la magnitud manipulada. Debido al
aumento de la frecuencia de conmutación (regulador paso a paso), eso deriva en un desgaste
elevado del actuador.
En estado forzado del regulador, la función reduce el ruido en la señal del error de regulación,
disminuyendo así la oscilación no deseada de la salida de regulador.
La zona muerta puede desactivarse.

Filtrado de señal por función de zona muerta
La función DEADBAND suprime pequeñas oscilaciones de la magnitud de entrada dentro de
un rango parametrizable alrededor de un punto cero definido. Fuera de esta franja de
oscilaciones, el error de regulación ER aumenta o cae proporcionalmente a la magnitud de
entrada. El ancho de la zona no efectiva (zona muerta) puede definirse con el parámetro
DEADB_W. El ancho de zona muerta solo debe tener valores positivos.
Si la magnitud de entrada se encuentra dentro de la zona muerta, se deposita el valor 0 (error
de regulación = 0) en la salida. Solo una vez que la magnitud de entrada abandona este rango
de insensibilidad, la salida aumenta o cae la parte correspondiente a los mismos valores de la
magnitud de entrada inv. El resultado es una falsificación de la señal transmitida, también fuera
de la zona muerta. Sin embargo, esto se tolera para evitar escalones en los límites de la zona
muerta (véase la siguiente figura). La falsificación corresponde al valor DEADB_W, por lo que
es fácilmente controlable.
La función DEADBAND trabaja según las siguientes funciones:
(ER) = inv + DEADB_W para inv < - DEADB_W
(ER) = 0 para -DEADB_W ≤ inv ≤ + DEADB_W
(ER) = inv - DEADB_W para inv > + DEADB_W
(5

LQY

'($'%B:

Las repercusiones del filtrado de señales se observan en el parámetro de salida ER.

868

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Alarma
Las desviaciones excesivas de la magnitud regulada respecto a la consigna ajustada pueden
provocar estados de proceso no deseados. En estos casos se utiliza la función ER_ALARM
para vigilar que el error de regulación no rebase el rango de servicio permitido por exceso ni
por defecto. ER_ALARM registra y notifica los rebases de límite ocurridos, para permitir una
respuesta adecuada.
Nota
La vigilancia de los límites del error de regulación no puede desactivarse. El rebase por exceso
de los límites configurados se notifica siempre.
La función ER_ALARM vigila el valor del error de regulación ER(t) en función de cuatro límites
predefinibles en dos zonas de tolerancia. Cuando los límites se alcanzan o rebasan, la función
notifica primero "Advertencia" y a continuación "Alarma" en el segundo límite.

Valores límite
Los valores numéricos de los límites se ajustan en los parámetros de entrada para
"Advertencia" y "Alarma". Si el error de regulación (ER) rebasa estos límites por exceso o
defecto, se activan los bits de aviso de salida correspondientes QERN_ALM ... QERP_ALM.
Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
QERP_ALM

QERP_WRN

QERN_WRN

QERN_ALM

si:

y:

TRUE

TRUE

FALSE

FALSE

ER ↗

ER ≥ ERP_ALM

ER ↘

ER ≥ ERP_ALM - ER_HYS

FALSE

TRUE

FALSE

FALSE

ER ↗

ER ≥ ERP_WRN

ER ↘

ER ≥ ERP_WRN - ER_HYS

FALSE

FALSE

TRUE

FALSE

ER ↘

ER ≤ ERP_WRN

ER ↗

ER ≤ ERP_WRN + ER_HYS

FALSE

FALSE

TRUE

TRUE

ER ↘

ER ≤ ERP_ALM

ER ↗

ER ≤ ERP_ALM + ER_HYS

Para que el bloque funcione de manera eficiente debe aplicarse lo siguiente:
alarma superior < advertencia superior < advertencia inferior < alarma inferior

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

869

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
(5

(5 W

(5B+<6

(53B$/0

l]RQDGHWROHUDQFLD

(53B:51

l]RQDGHWROHUDQFLD

W

(51B:51
(51B$/0

4(53B$/0
4(53B:51
4(51B:51
4(51B$/0

Histéresis
Para evitar que los bits de aviso "centelleen" con cambios muy pequeños de la magnitud de
entrada o con errores de redondeo, se ajusta una histéresis (diferencia de desactivación)
ER_HYS. El error de regulación debe superar esta histéresis antes de que los bits de aviso se
desactiven.

Regulador
Algoritmo de regulación
En el ciclo del tiempo de muestreo configurado se calcula la magnitud manipulada del
regulador continuo a partir del error de regulación en el algoritmo de posición PID. El regulador
tiene una estructura puramente paralela. Las acciones proporcional, integral o diferencial se
pueden desconectar individualmente.
',69B6(/
',69

*$,1
(5

3

,

'

870

3B6(/

,B6(/

3,'B2879

'B6(/

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Control anticipativo
A la señal de salida del regulador PID_OUTV se le puede aplicar adicionalmente una magnitud
perturbadora DISV. La activación o desactivación se realiza en la ventana PID de la
herramienta de configuración a través del conmutador de estructura DISV_SEL o mediante
"Magnitud perturbadora ON".

Acción P y D en la rama de realimentación
En la estructura paralela, cada acción del algoritmo regulador recibe el error de regulación
como señal de entrada. La magnitud manipulada es modificada directamente por la acción P
y la acción D con escalones de la consigna. Sin embargo, otra estructura del regulador en la
que la formación de la acción P y la acción D se traslada a la realimentación, garantiza una
evolución suave de la magnitud manipulada en caso de variaciones del escalón de la
referencia. En esta estructura la acción I procesa el error de regulación como señal de entrada,
en la acción P y en la acción D solo se conecta la magnitud de regulación negativa (factor = -1).
*$,1
(5

,

3

3,'B2879


39

'

Normalización de las magnitudes de entrada ER y PV
Las magnitudes de entrada ER y PV del regulador PID se normalizan antes del procesamiento
del regulador en el rango de 0 a 100, conforme a las fórmulas siguientes:
● con función de raíz desactivada (SQRT_ON = FALSE):
– ERnormalizado = ER * 100.0 / (NM_PVHR – NM_PVLR)
– PVnormalizado = (PV - NM_PVLR) * 100.0 / (NM_PVHR – NM_PVLR)
● con función de raíz activada (SQRT_ON = TRUE):
– ERnormalizado = ER * 100.0 / (SQRT_HR – SQRT_LR)
– PVnormalizado = (PV - SQRT_LR) * 100.0 / (SQRT_HR – SQRT_LR)
La normalización se lleva a cabo para que la ganancia proporcional GAIN del regulador PID
pueda introducirse sin dimensiones. De este modo, si cambia el límite superior e inferior del
rango de medida físico (p. ej. de bar a mbar), no es necesario cambiar el factor de ganancia.
Las magnitudes de entrada normalizadas ERnormalizado y PVnormalizado no pueden observarse.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

871

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Consulte también
Estructuras de regulador (Página 872)
Acción P (Página 875)
Acción D (Página 878)
Acción I (Página 876)

Estructuras de regulador
Uso y parametrización del regulador PID
La mayor parte de los procesos regulados que se dan en la industria del procesamiento y los
procesos puede regularse con la función de regulador PI/PID de Standard PID Control. Solo en
casos especiales se requieren métodos y medidas adicionales para dominar la regulación en
cuestión.
No obstante, un gran problema práctico suele ser la parametrización del regulador PI/PID, es
decir, encontrar los valores de ajuste "correctos" para los parámetros del regulador. La calidad
de esta parametrización es determinante para la efectividad de la regulación PID, y requiere
una gran experiencia práctica, conocimientos especializados o bien mucho tiempo.

Regulación P
En el regulador P están desconectadas las acciones I y D. (I_SEL y D_SEL = FALSE). Eso
significa que con un error de regulación ER = 0, la señal de salida también es OUTV = 0. Para
ajustar un punto de trabajo ≠ 0, es decir, un valor numérico para la señal de salida con un error
de regulación cero, hay que activar la rama I (véase la figura siguiente).
En la acción I se puede predeterminar un punto de trabajo ≠ 0 para el regulador P ajustando
el valor de inicialización I_ITLVAL en correspondencia. Para ello hay que activar los
conmutadores 'I_ITL_ON' y 'I_SEL' = TRUE.
3B6(/

3
*$,1
(5

,B,7/B21
 ,B6(/

,

3,'B2879


,B,7/9$/

La respuesta indicial del regulador P en el rango de tiempo es:
PID_OUTV (t) = I_ITLVAL + GAIN * ER normalizado (t)
(5 QRUPDOL]DGR

3,'B287 W

3,'B2879

(5QRUPDOL]DGR W
W

872

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

PID_OUTV(t)

es la magnitud manipulada en modo automático del regulador

I_ITLVAL

es el punto de trabajo del regulador P

GAIN

es la ganancia de regulador

ER normalizado (t)

es el error de regulación normalizado

Regulación PI
En el regulador PI está desconectada la acción D. (D_SEL = FALSE). Un regulador PI modifica
la magnitud de salida PID_OUTV con la acción I hasta que el error de regulación es ER = 0. Sin
embargo, esto solo es aplicable cuando la magnitud de salida no rebasa los límites del rango
manipulado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR    W
7,

(5 QRUPDOL]DGR
3,'B2879 W

3,'B2879
*$,1 (5 QRUPDOL]DGR


*$,1 (5 QRUPDOL]DGR W

*$,1 (5 QRUPDOL]DGR


(5QRUPDOL]DGR W
7,

PID_OUTV(t)

es la magnitud manipulada en modo automático del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escalón del error de regulación normalizado

TI

Constante de tiempo de integración

Regulación PD
En el regulador PD está desconectada la acción I (I–SEL = FALSE). Eso significa que con un
error de regulación ER = 0, la señal de salida también es OUTV = 0. Para ajustar un punto de
trabajo ≠ 0, es decir, un valor numérico para la señal de salida con un error de regulación cero,
hay que activar la rama I (véase también el diagrama de bloques de la regulación P).
En la acción I se puede predeterminar un punto de trabajo ≠ 0 para el regulador PD ajustando
el valor de inicialización I_ITLVAL en correspondencia. Para ello hay que activar los
conmutadores 'I_ITL_ON' e 'I_SEL' TRUE .
El regulador PD reproduce la magnitud de entrada ER(t) proporcionalmente sobre la señal de
salida y añade la acción D creada por la derivación de ER(t), que se calcula con el doble de
precisión según la regla del trapecio (aproximación de Padé). El comportamiento de tiempo se
determina mediante la constante derivativa (tiempo de derivación) TD.
Para el filtrado de señales y la supresión de señales perturbadoras se ha integrado un retardo
de 1er orden (tiempo ajustable: TM_LAG) en el algoritmo para formar la acción D.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

873

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Generalmente es suficiente un valor reducido para TM_LAG para conseguir el resultado
deseado. Si se parametriza TM_LAG ≤ CYCLE/2 el retardo está desactivado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR 



7'
70B/$*

W
H 70B/$*

(5 QRUPDOL]DGR

3,'B2879

*$,1

7'
(5
70B/$*  QRUPDOL]DGR

3,'B2879 W

(5QRUPDOL]DGR W

*$,1 (5 QRUPDOL]DGR

70B/$*

PID_OUTV(t)

es la magnitud manipulada en modo automático del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escalón del error de regulación normalizado

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

Regulación PID
En el regulador PID están activadas las acciones P, I y D (P–SEL = TRUE, I–SEL = TRUE,
D_SEL = TRUE). Un regulador PID modifica la magnitud de salida PID_OUTV mediante la
acción I hasta que el error de regulación es ER = 0. Sin embargo, esto solo es aplicable cuando
la magnitud de salida no rebasa los límites del rango manipulado. Si se rebasan los límites de
la variable manipulada, la acción I mantiene el valor alcanzado en el límite en (Anti-ResetWindup).
El regulador PID reproduce la magnitud de entrada normalizada ERnormalizado(t)
proporcionalmente sobre la señal de salida y añade las acciones creadas por la derivación e
integración de ERnormalizado(t), que se calculan con el doble de precisión según la regla de
trapecio (aproximación Padé). La respuesta de tiempo se determina por el tiempo de
derivación (tiempo de acción derivativa) TD y el tiempo de integración (tiempo de acción
integral) TI.
Para el filtrado y la supresión de señales perturbadoras se ha integrado un retardo de 1er orden
(constante de tiempo ajustable: TM_LAG) en el algoritmo para formar la acción D.
Generalmente es suficiente un valor reducido para TM_LAG para conseguir el resultado
deseado. Si se parametriza TM_LAG ≤ CYCLE/2 el retardo está desactivado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR 

874



 W
7'
7,
70B/$*

W
H 70B/$*

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
(5 QRUPDOL]DGR
3,'B2879

*$,1

3,'B2879 W

7'

(5 QRUPDOL]DGR
70B/$* 

3,B287 W
*$,1 (5 QRUPDOL]DGR 
*$,1 (5 QRUPDOL]DGR


*$,1 (5 QRUPDOL]DGR
W
W

70B/$*
7,

PID_OUTV(t)

es la magnitud manipulada en modo automático del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escalón del error de regulación normalizado

TI

Constante de tiempo de integración

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

Nota
Si TD cambia, conviene adaptar TM_LAG de la forma correspondiente.
Recomendación: 5 ≤ (TM / TM_LAG) ≤ 10

Consulte también
Algoritmo de regulación (Página 870)
Acción P (Página 875)
Acción D (Página 878)
Acción I (Página 876)

Acción P
Ganancia proporcional
El signo de la ganancia proporcional determina el sentido de acción del regulador continuo.
● Ganancia proporcional positiva
error de regulación ascendente → variable manipulada ascendente
● Ganancia proporcional negativa
error de regulación ascendente → variable manipulada descendente

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

875

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Aplicar la acción P en rama de realimentación
Si la acción P está aplicada en la rama de realimentación, solo el valor real tendrá efecto sobre
la acción P. Por ello, la magnitud manipulada – igual que en el caso de escalón de la consigna
– en un cambio de automático a manual no realiza ningún escalón por la acción P: la
conmutación es suave.

Consulte también
Algoritmo de regulación (Página 870)

Acción I
Función de la acción I
La acción I hace que, reajustando el punto de operación, el error de regulación pueda
convertirse en 0 para cualquier valor de la magnitud manipulada.
La acción I genera una señal de salida cuya velocidad de cambio es proporcional al cambio del
valor absoluto de la magnitud de entrada. La respuesta temporal viene determinada por el
tiempo integrativo TI.
La respuesta a un escalón de entrada inv0 es:
2879 W 


7,

ȉ

LQY W GW

LQY
/01B,

/01B, W

/01B, W    LQY W
7,
LQY W

LQY

W
7,

LMN_I(t)

la magnitud de salida de la acción I

inv0

la altura del escalón en la entrada de la acción I

TI

Tiempo integrativo

La acción I se observa en la variable estática LMN_I.
En estado desactivado (I_SEL = FALSE) la acción I, es decir, la memoria interna y la variable
estática LMN_I, se pone a cero.
La salida y la memoria de la acción I están limitados por los límites absolutos de la variable
manipulada LMN_HLM y LMN_LLM (Anti Reset Wind–up).
En caso de influir en la señal manipulada en modo manual, es decir, cuando MAN_ON,
LMNOP_ON o CAS_ON = TRUE, el valor de la memoria interna de la acción I se corrige según
el valor LMNFC_IN - LMN_P - DISV.

876

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3B6(/

3

*$,1
(5

,17B+326,17B+1(*
,B6(/

,

/0123
0$1
/0123B21
0$1B21






/01

,B,7/B21

,B,7/9$/




/01)&B,1/01B3',69

Conmutación suave de manual a automático
En el modo manual, las acciones I y D del regulador se corrigen de tal forma que el regulador
comienza la conmutación al modo automático con una magnitud manipulada adecuada.
● Conmutación suave activada (SMOO_CHG = TRUE)
La acción I se activa en modo manual de modo que la magnitud manipulada permanece
invariable en principio durante la conmutación de manual a automático.
La acción D se pone a cero en modo manual. La conmutación a automático se lleva a cabo
sin escalón de la magnitud manipulada.
Si hay un error de regulación, este se regula lentamente.
● Conmutación suave desactivada (SMOO_CHG = FALSE)
Durante la conmutación de manual a automático y partiendo de la posición actual, la
magnitud manipulada realiza un escalón cuya altura queda determinada por la acción P. La
altura del escalón de la acción P equivale al cambio de la magnitud manipulada cuando hay
un escalón de consiga del valor real actual a la consigna actual.
En modo manual, la acción D se pone a un valor que equivale al error de regulación
existente. La conmutación a automático se realiza con escalón de magnitud manipulada; el
error de regulación se regula más rápido.
Sin embargo, si la acción P está aplicada en la rama de realimentación, solo el valor real
tendrá efecto sobre la acción P. Por ello, en una conmutación de manual a automático, la
magnitud manipulada no realiza ningún escalón por la acción P; la conmutación es suave.
Lo mismo es válido para la acción D siempre que esta
se haya aplicado en la rama de realimentación (DFDB_SEL = TRUE).
El error de regulación existente se regula más rápido. Esto debe ser así, por ejemplo, en
sistemas de regulación de temperatura.

Rangos admisibles para el tiempo integrativo TI y CYCLE
Debido a la precisión limitada de los números REAL calculados en la CPU, es posible que se
produzca el efecto siguiente durante la integración: si se ha elegido un tiempo de muestreo
CYCLE de la regulación demasiado pequeño en comparación con el tiempo integrativo TI y si
el valor de entrada inv de la acción I es pequeño en comparación con su valor de salida OUTV,
la acción I no se activa y permanece en su valor de salida momentáneo.
Este efecto puede evitarse si se considera la siguiente regla de dimensionado en la
configuración:
CYCLE > 10–4 × TI

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

877

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
De este modo, la acción I reacciona incluso a cambios de los valores de entrada situados en
el rango de una millonésima parte por mil de la magnitud de salida actual:
inv > 10 –10 × OUTV
Para que el comportamiento de transferencia del algoritmo del integrador equivalga al
comportamiento analógico, el tiempo de muestreo debería ser menor que el 20 % del tiempo
integrativo ajustado o bien TI debería tener como mínimo cinco veces el valor del tiempo de
muestreo seleccionado:
CYCLE < 0,2 × TI
El algoritmo admite para el tiempo de muestreo valores hasta CYCLE ≤ 0,5 * TI.

Inicializar la acción I
Cuando se activa la inicialización de la acción I, el valor de inicialización se aplica a la variable
estática LMN_I en caso de rearranque de la CPU o si COM_RST = TRUE. Al cambiar al modo
normal reseteando la inicialización, la acción I comienza la integración de su magnitud de
entrada a partir del valor de inicialización.

Detener la acción I
Mediante las variables estáticas INT_HPOS y INT_HNEG es posible bloquear la acción I en
sentido positivo y negativo, respectivamente. Esto puede ser útil en cascadas. Si, p. ej., la
magnitud manipulada del regulador secundario se aproxima al límite superior, existe la
posibilidad de impedir que siga aumentando la magnitud manipulada del regulador piloto
mediante su acción I. Este comportamiento se programa con las instrucciones siguientes, p.
ej., en AWL:
A
"regulador secundario".QLMN_HLM
=
"regulador piloto".INT_HPOS
A
"regulador secundario".QLMN_ LLM
=
"regulador piloto".INT_HNEG

Consulte también
Algoritmo de regulación (Página 870)
Estructuras de regulador (Página 872)

Acción D
Función de la acción D
La acción D genera una señal de salida cuya magnitud cambia proporcionalmente a la
velocidad de cambio de la magnitud de entrada. La respuesta temporal se determina mediante
el tiempo derivativo TD y el tiempo de retardo TM_LAG.
La respuesta a un escalón de entrada inv0 es:

878

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
/01B'

/01B' W  

W
7'
LQY H 70B/$*
70B/$*

7' LQY

70B/$*
LQY
W
70B/$*

LMN_D(t)

la magnitud de salida de la acción D

inv0

la altura del escalón en la entrada de la acción D

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

La acción D se observa en la variable estática LMN_D.
En estado desactivado (D_SEL = FALSE) la acción D, es decir, la memoria interna y la variable
estática LMN_D, se pone a cero.

Aplicar la acción D en la rama de realimentación
Si la acción D está aplicada en la rama de realimentación, solo el valor real tendrá efecto sobre
la acción D. Por ello, en una conmutación de manual a automático, la magnitud manipulada –
igual que en el caso de un escalón de la consigna – no realiza ningún escalón por la acción D;
la conmutación es suave.

Valores admisibles para el tiempo derivativo y el tiempo de retardo
Para que la acción D pueda calcularse correctamente, deben observarse las condiciones
siguientes para el tiempo derivativo y el tiempo de retardo:
● TD ≥ CYCLE y
● TM_LAG ≥ 0,5 × CYCLE
Si TD < CYCLE, la acción D trabaja como si TD tuviera el valor CYCLE.
Si TM_LAG < 0,5 × CYCLE, la acción D trabaja sin retardo. Un escalón de entrada se multiplica
por el factor TD/CYCLE y este valor se devuelve en la salida como "impulso de aguja". Esto
significa que en el próximo ciclo de procesamiento, LMN_D se pondrá de nuevo a cero.

Coeficiente DT1
El coeficiente DT1 se calcula del modo siguiente:
Coeficiente DT1 = TD/TM_LAG

Tiempo de retardo
Para el filtrado de señales y la supresión de señales perturbadoras se ha integrado un retardo
de 1er orden (constante de tiempo ajustable: TM_LAG) en el algoritmo para formar la acción
D.
Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

879

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
La mayoría de las veces es suficiente con un valor pequeño como tiempo de retardo para
alcanzar el resultado deseado. Si se parametriza un tiempo de retardo inferior a la mitad del
tiempo de muestreo del regulador, el retardo está desactivado.

Procedimiento
Para configurar la acción D, proceda del siguiente modo:
1. Para aplicar la acción D en la rama de realimentación, active la casilla de verificación
correspondiente.
2. Introduzca el tiempo derivativo en segundos.
3. Introduzca el tiempo de retardo en segundos.

Consulte también
Algoritmo de regulación (Página 870)

Variable manipulada
Modo manual
Además del modo de operación "Automático" con la salida del algoritmo PID (PID_OUTV)
aplicada directamente en la salida, existen dos modos de operación en los que es posible influir
manualmente en la señal manipulada: "Modo manual sin manejo del interruptor" y "Modo
manual mediante interruptor de más/menos" (MAN_GEN).
A través del parámetro MAN se puede aplicar una influencia externa sobre la magnitud
manipulada, o puede venir dada por el programa de usuario. El valor de entrada MAN se limita
a los límites de magnitud manipulada LMN_HLM (superior) y LMN_LLM (inferior).
La estructura de la generación y aplicación del valor manual puede verse en la figura siguiente.
Al activar MAN_GEN desde otro modo de operación, se aplica la variable manipulada
actualmente efectiva en la salida de MAN_GEN. Así, la conmutación al generador del valor
manual siempre es suave.
/01/,0,7
0$1
0$1*1B21
/01)&B,1

0$1B*(1

03



03

0$1B21



03
/01

3,'B2879

880

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Activar el modo automático
Si se ha desactivado el modo manual (MAN_ON = FALSE)), la variable manipulada del
algoritmo PID se aplica directamente a la salida. En el modo manual (MAN_ON = TRUE), la
acción I del regulador se controla de tal forma que el regulador comienza la conmutación al
modo automático con una magnitud manipulada adecuada. La salida del algoritmo PID se
encuentra en el punto de medición MP7.
En el modo automático, el valor manual MAN sigue a la magnitud manipulada (menos la acción
D). Por ello, en la conmutación al modo manual la magnitud manipulada permanece en el
último valor calculado. Puede modificarse mediante intervención manual.
1. Desactive la casilla de verificación "Activar modo manual".

Activar el modo manual con valor manual
En este modo de operación (MANGN_ON = FALSE y MAN_ON = TRUE) se introduce la
variable manipulada manual como valor absoluto en la entrada MAN. La variable manipulada
manual se indica en el punto de medición MP8.
1. Active la casilla de verificación "Activar modo manual".
2. Seleccione la opción "Valor manual".

Activar el generador de valor manual
El valor manual MAN se aumenta o reduce progresivamente utilizando los interruptores
MANUP y MANDN. El valor modificado puede observarse en MP8. Se tienen en cuenta los
límites configurados de la variable manipulada.
1. Active la casilla de verificación "Activar modo manual".
2. Seleccione la opción "Generador del valor manual".

Repercusión de los interruptores MANUP y MANDN
Para poder realizar un cambio graduado finamente, el regulador debe tener un tiempo de
muestreo de 100 ms como máximo.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

881

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
La velocidad de cambio de la variable manipulada depende de la duración de pulsación de los
interruptores MANUP y MANDN así como de los límites ajustados de acuerdo con la relación
siguiente:
● durante los primeros 3 segundos después de activar MANUP o MANDN rige:
doutv/dt = (LMN_HLM - LMN_LLM) / 100 s
● a continuación
doutv/dt = (LMN_HLM - LMN_LLM) / 10 s
RXWY
/01B+/0

V
W
V

V

/01B//0

0$183
W
0$1'1

V
W

Con un tiempo de muestreo de 100 ms y un rango de la variable manipulada de -100,0 a 100,0,
la variable manipulada cambia en 0,2 por ciclo en los tres primeros segundos, por ejemplo. Si
MANUP se mantiene en TRUE durante más de 3 segundos, la velocidad de cambio aumenta
a diez veces el valor, en este caso a 2 por ciclo.
El generador del valor manual se activa suavemente.

Modos de operación
La tabla siguiente muestra los modos de operación posibles del regulador continuo con los
valores necesarios de los interruptores.

882

Modo de operación

MAN_ON

MANGN_ON

Modo automático

FALSE

no aplicable

Modo manual con valor manual

TRUE

FALSE

Modo manual con generador del
valor manual

TRUE

TRUE

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Límites
Llamar una función
Insertando una función específica de usuario en la rama de la magnitud manipulada se puede
someter la magnitud manipulada PID_OUTV generada en el regulador a un procesamiento de
señal (p. ej. un retardo) antes de la aplicación en la salida del regulador.
El regulador ejecuta una llamada de la función. En ella no se suministran valores a los
parámetros de entrada y salida de la función de usuario. La transferencia de datos debe
programarla el usuario en su función.
Nota
No se comprueba si hay una función disponible. Si la función no está disponible, la CPU pasa
a STOP con un error interno de sistema.
1. Active la casilla de verificación "Activar llamada de FC".
2. Introduzca el número de la función en el campo de entrada "FC".

Limitar la velocidad de cambio
Las funciones de rampa en la rama de la magnitud manipulada se utilizan cuando el proceso
no soporta cambios de la señal de entrada del proceso en forma de esalón. Los cambios
abruptos de la variable manipulada deben evitarse p. ej. en aquellos casos en que entre el
motor regulado y la carga que debe accionarse hay interpuesto un engranaje, y un aumento
muy rápido del número de revoluciones del motor derivaría en una sobrecarga del engranaje.
La velocidad de cambio de las variables manipuladas en la salida del regulador se limita por
separado para la rampa de subida y bajada de la magnitud manipulada. Para todo el rango de
valores es posible parametrizar dos rampas con valores ascendentes o descendentes
partiendo desde el punto cero. La función está activada si LMNRC_ON = TRUE.
En las dos variables estáticas LMN_URLM y LMN_DRLM se introducen las limitaciones
correspondientes para las pendientes de la función de rampa en los rangos positivo y negativo
de la magnitud manipulada. Las pendientes se refieren a la subida o bajada en porcentajes por
segundo. Los cambios más rápidos de la variable manipulada se retardan a estas velocidades
límite.
Si p. ej. 'LMN_URLM' se parametriza a 10,0 [%], en cada ciclo de muestreo se suman los
siguientes valores al "valor antiguo" de outv mientras |inv| sea > |outv|:
Tiempo 1 s
→ outvantiguo + 10 %
de mues‐
treo
100 ms → outvantiguo + 1 %
10 ms → outvantiguo + 0,1 %
La figura siguiente muestra el funcionamiento del procesamiento de las señales. Las funciones
de escalón en la entrada inv (t) se traducen en funciones de rampa en la salida outv (t).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

883

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
LQY
RXWY

LQY W

RXWY W
/01B'5/0 LQV

/01B85/0

/01B85/0

/01B85/0



W
/01B'5/0

No se notifica el alcance de los límites de la pendiente.
La identificación de los parámetros de las rampas se realiza según el siguiente esquema:
Parámetro

Rampa

LMN_URLM

|outv| ascendente

LMN_DRLM

|outv| descendente

1. Active la casilla de verificación "Limitar la velocidad de cambio".
2. Introduzca la rampa de subida máxima de la variable manipulada en el campo de entrada
"Rampa de subida máxima".
Los cambios más rápidos de la variable manipulada se retardan a ese valor.
3. Introduzca la rampa de bajada máxima de la variable manipulada en el campo de entrada
"Rampa de bajada máxima".
Los cambios más rápidos de la variable manipulada se retardan a ese valor.

Limitar el valor absoluto de la magnitud manipulada
El rango de trabajo, es decir, el rango dentro del cual puede moverse el actuador sin
abandonar las variables manipuladas admisibles, está determinado por el rango de ajuste de
la variable manipulada. Dado que, dependiendo del tipo de actuador, los límites de las
variables manipuladas permitidas no suelen cubrirse con el límite 0 % o 100 % del rango de
ajuste, es posible configurar el límite superior e inferior de la variable manipulada.
Para evitar estados no permitidos en el proceso en cuestión, en la rama de la variable
manipulada de la regulación se limita el rango de ajuste de la magnitud manipulada por arriba
y abajo.
La magnitud manipulada LMN(t) se limita a los límites superior (LMN_HLM) e inferior
(LMN_LLM) predefinibles. Sin embargo, la magnitud de entrada inv debe estar fuera de estos
límites. Dado que la función no puede desactivarse, en la configuración siempre hay que tener
en cuenta la indicación de los límites inferior y superior.
Si la magnitud de entrada inv(t) rebasa los límites, se emiten las indicaciones correspondientes
a través de las salidas de aviso.

884

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
LQY W

LQY
03
/01B+/0

W


03 W
/01B//0

4/01B+/0
4/01B//0

Arranque y funcionamiento
● En caso de rearranque, todas las salidas de aviso se ponen a cero.
● La limitación trabaja según las siguientes relaciones:
LMN =

QLMN_HLM

QLMN_LLM

si:

LMN_HLM

TRUE

FALSE

inv ≥ LMN_HLM

LMN_LLM

FALSE

TRUE

inv ≤ LMN_LLM

inv

FALSE

FALSE

LMN_HLM < inv < LMN_LLM

En la salida, es decir, en el parámetro LMN o en el punto de medición MP10, se muestra la
variable manipulada efectiva de la regulación.

Procedimiento
Para limitar el valor absoluto de la magnitud manipulada, proceda del siguiente modo:
1. Introduzca el valor más alto permitido en el campo de entrada "Límite superior".
2. Introduzca el valor más bajo permitido en el campo de entrada "Límite inferior".

Normalización
Si a la entrada del proceso regulado se requiere una magnitud física como magnitud
manipulada, los valores en coma flotante deben desnormalizarse entre 0 y 100 % al rango
físico (p. ej. 150 a 3000 rpm) de la magnitud manipulada.
Para definir la recta de normalización de forma unívoca deben definirse dos parámetros:
● el factor para la pendiente (LMN_FAC)
● el offset de la recta de normalización en el punto cero (LMN_OFF)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

885

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Valores porcentuales internos (en formato REAL) ⇒ valores físicos externos
/01

/01B)$&
/01B2))
03

,19

El valor de normalización se calcula con la función siguiente a partir del correspondiente valor
de entrada MP10:
LMN = MP10 * LMN_FAC + LMN_OFF
Ejemplo
/01
USP

USP




/01)$&

 USP
 



03

USP


/012)) USP

Dentro de la función no se limitan valores ni se comprueban parámetros.

Realizar una normalización
1. En el campo de entrada "Factor", introduzca la pendiente de la recta de normalización.
2. En el campo de entrada "Offset", introduzca el offset de la recta de normalización hacia el
punto cero.

886

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Generador de impulsos
Aplicación
El generador de impulsos transforma la magnitud de entrada "Variable manipulada del
regulador PID en el punto de medición MP10" mediante modulación de ancho de impulsos en
un tren de impulsos con duración de período constante. La duración de un impulso por período
es proporcional a la magnitud de entrada.
03









4326B3

W




W

&<&/(B3
3(5B70

Una magnitud de entrada del 30% y 10 llamadas del generador de impulsos por duración de
período significan, por tanto:
● "uno" en la salida QPOS para las tres primeras llamadas (30% de 10 llamadas),
● "cero" en la salida QPOS para otras siete llamadas (70% de 10 llamadas).

Modos de operación del regulador con salida de impulsos
Dependiendo de la parametrización del generador de impulsos es posible configurar
reguladores PID con comportamiento de tres puntos o con salida de dos puntos bipolar o
unipolar. La siguiente tabla muestra el ajuste de las combinaciones de interruptores para los
posibles modos de operación.
Modo de operación

Interruptor
MAN_ON

STEP3_ON

ST2BI_ON

Regulación de tres puntos

FALSE

TRUE

cualquiera

Regulación de dos puntos con rango de
ajuste

FALSE

FALSE

TRUE

FALSE

FALSE

FALSE

TRUE

cualquiera

cualquiera

bipolar (de –100 % a 100 %)
Regulación de dos puntos con rango de
ajuste
unipolar (de 0 % a 100 %)
Modo manual

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

887

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulación de tres puntos
En el modo de operación "Regulación de tres puntos" se pueden generar tres estados de la
señal manipulada, por ejemplo, según actuador y proceso: más – apagado – menos, adelante
– parado – atrás, calentar – apagado – enfriar, etc. Según los requisitos del proceso que se
desea regular se asignan los valores de estado de las señales de salida binarias QPOS_P y
QNEG_P a los respectivos estados operativos del actuador. La tabla muestra dos ejemplos.
calentar

apagado

enfriar

adelante

parado

atrás

QPOS_P

TRUE

FALSE

FALSE

QNEG_P

FALSE

FALSE

TRUE

El dimensionado de la duración mínima de impulso o pausa P_B_TM_P puede evitar tiempos
de conexión o desconexión muy cortos que merman la vida útil de los elementos de
conmutación y los dispositivos de control. Para ello se sobrepone un valor de reacción para la
salida de impulsos a la característica de salida proporcional mediante la que se calcula la
duración de impulso.
Nota
Se suprimen valores absolutos pequeños de la magnitud de entrada "Variable manipulada del
regulador PID en el punto de medición MP10" que podrían generar una duración de impulso
menor que P_B_TM_P. Para los valores de entrada grandes, que generarían una duración de
impulso mayor que PER_TM_P – P_B_TM_P, se ajusta la duración de impulso a 100% o –
100%.
Se recomiendan valores de ajuste P_B_TM_P ≤ 0,1 * PER_TM_P.


7LHPSRGHFRQH[LµQP¯Q
3B%B70B3

7LHPSRGHGHVFRQH[LµQP¯Q
3B%B70B3
3(5B70B3

3(5B70B3

3(5B70B3

La duración de los impulsos positivos o negativos se calcula multiplicando la magnitud de
entrada "Variable manipulada del regulador PID en el punto de medición MP10" (en %) por el
período:
'XUDFLµQGHLPSXOVR

03


3(5B70B3>V@

Debido a la supresión de la duración mínima de impulso o pausa, se forman puntos de inflexión
en el área inicial y final de la característica de conversión.
Lo dicho anteriormente también es válido para P_B_TM_N y PER_TM_N.

888

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
'XUDFLµQGHLPSXOVRSRVLWLYR

6LHPSUHFRQHFWDGR

3(5B70B3
3(5B70B33B%B70B3



3B%B70B3

6LHPSUHGHVFR
QHFWDGR
3B%B70B1

03


3(5B70B13B%B70B1
3(5B70B1
'XUDFLµQGHLPSXOVRQHJDWLYR

Regulación de tres puntos asimétrica
A través del factor de relación RATIOFAC puede modificarse la relación entre la duración de
impulsos positivos y negativos. En un proceso térmico, ello permite tener en cuenta p. ej.
constantes temporales de proceso distintas para calentar y para enfriar.
Si se desea acortar la duración de impulso en la salida de impulso negativo con respecto al
impulso positivo y si el valor absoluto "Variable manipulada del regulador PID en el punto de
medición MP10" es idéntico, se debe introducir un factor de relación menor que 1:
,PSXOVRSRV!LPSXOVRQHJ5$7,2)$&
'XUDFLµQGHLPSXOVR
QHJDWLYR

03


3(5B70B1

'XUDFLµQGHLPSXOVR
SRVLWLYR

03


3(5B70B1

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

5$7,2)$&

889

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
'XUDFLµQGHLPSXOVR
SRVLWLYR
3(5B70B3
3(5B70B33B%B70B3





3B%B70B3

03
3B%B70B1



3(5B70B13B%B70B1
3(5B70B1
'XUDFLµQGHLPSXOVR
QHJDWLYR

Figura 3-4

Característica asimétrica del regulador de tres puntos (factor de relación = 0,5)

Si, por el contrario, se desea acortar la duración de impulso en la salida de impulso positivo con
respecto al impulso negativo y si el valor absoluto |MP10| es idéntico, se debe introducir un
factor de relación mayor que 1:
,PSXOVRSRVLPSXOVRQHJ5$7,2)$&!
'XUDFLµQGHLPSXOVR
QHJDWLYR

03


'XUDFLµQGHLPSXOVR
SRVLWLYR

03 3(5B70B3
 5$7,2)$&

3(5B70B1

En lo que respecta al cálculo, esto significa que con RATIOFAC < 1 el valor de reacción para
impulsos negativos se debe multiplicar por el factor de relación y que con RATIOFAC > 1 el
valor de reacción para impulsos positivos se debe dividir por el factor de relación.
Nota
En la regulación de tres puntos asimétrica RATIOFAC ≠ 1, los límites de la variable manipulada
deben ajustarse de acuerdo con las fórmulas siguientes:
RATIOFAC < 1:
LMN_HLM = 100
LMN_LLM = –100 * (1 / RATIOFAC)
RATIOFAC > 1:
LMN_HLM = 100 * RATIOFAC
LMN_LLM = –100

890

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Ejemplos:
RATIOFAC
LMN_HLM
LMN_LLM

=
=
=

1
100
–100

RATIOFAC
LMN_HLM
LMN_LLM

=
=
=

0.5
100
–200

RATIOFAC
LMN_HLM
LMN_LLM

=
=
=

2.0
200
–100

Regulación de dos puntos
En la regulación de dos puntos solo se conecta la salida de impulsos positiva QPOS_P al
actuador de conexión/desconexión en cuestión. Dependiendo del rango de ajuste utilizado,
MP10 = -100,0% a +100,0% o MP10 = 0,0% a 100,0%, el regulador de dos puntos tiene un
rango de ajuste bipolar o unipolar.
En el modo de operación unipolar, MP10 solo debe adoptar valores entre 0,0% y 100,0%.
'XUDFLµQGHLPSXOVRSRVLWLYR
3(5B70B3
3(5B70B33B%B70B3

3B%B70B3




03

En el modo de operación bipolar, MP10 solo debe adoptar valores entre -100,0% y -100,0%.
'XUDFLµQGHLPSXOVRSRVLWLYR

6LHPSUHFRQHFWDGR

3(5B70B3
3(5B70B33B%B70B3

6LHPSUHGHVFR
QHFWDGR
3B%B70B3




03


En QNEG_P está disponible la señal de salida negada para el caso en que la interconexión del
regulador de dos puntos en el lazo de regulación exige una señal binaria invertida lógicamente
para los impulsos de la señal manipulada.
ON

OFF

QPOS_P

TRUE

FALSE

QNEG_P

FALSE

TRUE

Tiempo de muestreo del regulador CYCLE y ancho de impulso CYCLE_P
Si ha activado la etapa de formación de impulsos (PULSE_ON = TRUE), será necesario
especificar el ciclo del OB de alarma cíclica invocante en la entrada CYCLE_P. La duración del
impulso generado siempre asciende a un múltiplo entero de este valor.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

891

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
En la entrada CYCLE se especifica el tiempo de muestreo para las demás funciones de
regulación del PID_CP. PID_CP determina la reducción del ciclo y procesa las funciones de
regulación con el tiempo de muestreo CYCLE.
CYCLE debe ser un múltiplo entero de CYCLE_P. Si no se cumple esta condición, PID_CP
redondea el tiempo de muestreo para las funciones de regulación a un múltiplo entero de
CYCLE_P. Las funciones dependientes del tiempo (p. ej. filtrado, integración, diferenciación)
no trabajan con toda la corrección en este caso.
CYCLE puede ser menor que la duración de período PER_TM_P o PER_TM_N. Esto es
aconsejable si, por un lado, se desea una duración de período lo más grande posible para
proteger los actuadores y, por otro lado, el tiempo de muestreo debe ser pequeño porque el
sistema regulado es rápido.
Un valor adecuado para el tiempo de muestreo CYCLE es, al igual que en el regulador continuo
sin etapa de formación de impulsos, que CYCLE no debe ser menor que aprox. el 10% de las
constantes de tiempo dominantes en el sistema regulado.
Ejemplo de los efectos de los parámetros CYCLE_P, CYCLE y PER_TM_P o PER_TM_N:
● PER_TM_P = 10 s, CYCLE = 1 s, CYCLE_P = 100 ms.
Cada segundo se calcula una nueva variable manipulada, cada 100 ms se produce la
comparación de la variable manipulada con la longitud de impulso o pausa emitida hasta
entonces.
Cuando se emite un impulso y la variable manipulada calculada es mayor que la longitud de
impulso actual / PER_TM_P, se prolonga el impulso. En caso contrario, no se emiten más
señales de impulso. Si no se emite ningún impulso y (100% - variable manipulada calculada)
es mayor que la longitud de pausa actual / PER_TM_P, se prolonga la pausa. En caso contrario
se emite una señal de impulso.
Debido a un procedimiento especial de formación de impulsos, un aumento o una reducción de
la magnitud manipulada durante el período provoca una prolongación o reducción del impulso
emitido, respectivamente. Si, en este caso (CYCLE < PER_TM_P), la duración de período se
ha parametrizado tan grande que provocaría una oscilación del valor real, la duración de
período efectiva de PID_CP se reduce automáticamente a un valor adecuado.

Precisión de la formación de impulsos
La duración de período PER_TM no es idéntica al ciclo de procesamiento del generador de
impulsos. Una duración de período se compone de varios ciclos de procesamiento del
generador de impulsos. El número de llamadas del generador de impulsos por duración de
período es una medida para la precisión del ancho de impulso.
Cuanto menor sea el tiempo de muestreo CYCLE_P en comparación con la duración de
período PER_TM_P (o PER_TM_N), más exacta será la modulación de ancho de impulsos.
Para una regulación con una precisión suficiente debe cumplirse la condición siguiente:
&<&/(B3ื

892

3(5B70


Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Realización de tiempos de muestreo muy cortos
En un sistema regulado rápido son necesarios tiempos de muestreo muy cortos (p. ej. 10 ms).
A causa del tiempo de ejecución del programa, en este caso no es aconsejable procesar los
elementos de la regulación en el mismo OB de alarma cíclica que el cálculo de la salida de
impulsos. Es mejor trasladar el procesamiento de las funciones de regulación al OB 1 o a un
OB de alarma cíclica más lento. El procesamiento de la función de regulación en el OB 1 solo
tiene sentido si el tiempo de ciclo del OB 1 es claramente inferior al tiempo de muestreo CYCLE
del regulador.
Mediante el parámetro SELECT se especifica la parte del programa que debe procesarse. La
siguiente tabla ofrece una visión de conjunto de la parametrización del parámetro de entrada
SELECT:
SELECT

Funcionalidad utilizada en el bloque

Método subyacente

0

Elemento de regulación y salida de impulsos

Elemento de regulación y salida de
impulsos en el mismo bloque

1

Llamada en el OB 1 (elemento de regulación)

2

Llamada en el OB de alarma cíclica
(salida de impulsos)

Elemento de regulación en el OB 1,
salida de impulsos en el OB de alar‐
ma cíclica rápido

3

Llamada en el OB de alarma cíclica lento (elemen‐ Elemento de regulación en el OB de
to de regulación)
alarma cíclica lento, salida de impul‐
Llamada en el OB de alarma cíclica rápido (salida sos en el OB de alarma cíclica rápido

2

de impulsos)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

893

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
A continuación se explican con detalle los métodos citados en la tabla superior para conseguir
anchos de impulso muy cortos.
● Función de regulación en el OB 1, salida de impulsos en el OB de alarma cíclica
Cuando se llama con SELECT = 2 se calcula la salida de impulsos y se comprueba si el
tiempo de muestreo parametrizado en CYCLE ha transcurrido desde el último
procesamiento del elemento de regulación. Si dicho tiempo de muestreo ha transcurrido,
PID_CP escribe la variable QC_ACT en el DB de instancia con el valor TRUE.
Cuando se llama con SELECT = 1 se evalúa la variable QC_ACT en el DB de instancia: Si
QC_ACT tiene el valor FALSE, el bloque finaliza inmediatamente; así pues, ha necesitado
un tiempo de ejecución muy corto. Si QC_ACT tiene el valor TRUE, el elemento de
regulación se ejecuta una vez y, seguidamente, QC_ACT vuelve a ponerse a cero.
Este procedimiento hace que el tiempo de muestreo para la función de regulación no pueda
respetarse con exactitud. Oscila alrededor del tiempo de ejecución del OB 1 (incluidas
todas las interrupciones). Por consiguiente, este procedimiento solo es adecuado si el
tiempo de ejecución del OB 1 es pequeño en comparación con el tiempo de muestreo
CYCLE.
● Función de regulación en el OB de alarma cíclica lento, salida de impulsos en el OB de
alarma cíclica rápido
Si se llama con SELECT = 2 se calcula siempre la salida de impulsos.
Si se llama con SELECT = 3 se calcula siempre el elemento de regulación.
Nota
Para no tener que programar dos veces la llamada de la instrucción PID_CP con los
muchos operandos formales que contiene, es recomendable programarla una sola vez en
una FC que también tenga como parámetro de entrada un parámetro SELECT. Este
parámetro de entrada se interconecta con PID_CP.SELECT. En tal caso, en el OB 1 o en
el OB de alarma cíclica solo debe llamarse dicha FC.
Este procedimiento facilita los cambios y ahorra memoria de programa.

Puesta en servicio de PID_CP
Realizar una optimización manual
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.
● MAN_ON = FALSE

Procedimiento
Para determinar manualmente los parámetros PID óptimos, proceda del siguiente modo:
1. Haga clic en el símbolo
"Medición activada".
Si aún no existe ninguna conexión online, ésta se establece. Los valores actuales de
consigna, valor real y variable manipulada se graban.
2. Introduzca parámetros PID nuevos en los campos "P", "I", "D" y "Tiempo de retardo".

894

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Haga clic en el grupo "Optimización" en el símbolo

"Enviar parámetros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna" .
5. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
símbolo .
Si la velocidad de cambio de la consigna está limitada, se conmuta suavemente a la nueva
consigna.
6. En caso necesario, desactive la casilla de verificación "Modo manual".
El regulador trabaja con los nuevos parámetros PID y regula según la nueva consigna.
7. Compruebe la calidad de los parámetros PID basándose en la evolución de las curvas.
8. Repita los pasos del 3 hasta el 8, hasta que esté satisfecho con el resultado de la regulación.

Puesta en servicio con el PID Self Tuner
La instrucción PID_CP se pone en servicio con el PID Self-Tuner y se determinan los
parámetros PID óptimos.

Procedimiento
Para poner en servicio un regulador continuo, proceda del siguiente modo:
1. Llame la instrucción PID_CP en un OB de alarma cíclica e interconecte los parámetros de
entrada y salida.
2. Llame la instrucción TUN_EC en el mismo OB de alarma cíclica.
3. Interconecte la instrucción TUN_EC con PID_CP del siguiente modo:
– TUN_EC.PV con PID_CP.PV
– TUN_EC.LMN con PID_CP.LMN
– TUN_EC.SP_OUT con PID_CP.SP_IN o PID_CP.SP_EXT
– TUN_EC.GAIN con PID_CP.GAIN
– TUN_EC.TI con PID_CP.TI
– TUN_EC.TD con PID_CP.TD
– TUN_EC.TM_LAG con PID_CP.TM_LAG
– Si se utiliza un regulador de tres puntos, TUN_EC.RATIOFAC con PID_CP.RATIOFAC
– TUN_EC.QMAN_ON con PID_CP.MAN_ON
4. Haga clic en el símbolo
en la instrucción TUN_EC.
Se abre el editor de puesta en servicio para TUN_EC. El funcionamiento del editor de
puesta en servicio se describe en el PID Self-Tuner.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

895

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3.5.1.2

Utilizar PID_ES

Objeto tecnológico PID_ES
El objeto tecnológico PID_ES proporciona un regulador paso a paso para los modos
automático y manual. Equivale al bloque de datos de instancia de la instrucción PID_ES. Es
posible configurar los siguientes reguladores:
● Regulación de valor fijo con regulador P, PI, PD y PID paso a paso
● Regulador paso a paso con y sin realimentación de posición
● Regulación de valor fijo con control anticipativo
● Regulación en cascada con regulador paso a paso en el lazo subsiguiente
● Regulación de relación de dos lazos
● Regulación de mezcla
Se configuran las funciones siguientes del objeto tecnológico PID_ES:
● Normalización de la señal de valor real
● Supresión de oscilaciones de alta frecuencia en la rama del valor real mediante filtrado
(retardando) de la señal del valor real.
● Linealización de funciones cuadráticas del valor real (regulación de caudal con sensores de
presión diferencial)
● Llamada de "funciones propias" en la rama del valor real
● Vigilancia de rebase por exceso de los límites de alarma y advertencia del valor real
● Vigilancia de la velocidad de cambio del valor real
● Modificación de la consigna por el generador ramp soak
● Normalización de una señal de consigna externa en las regulaciones de relación
● Llamada de "funciones propias" en la rama de la consigna
● Limitación de la velocidad de cambio de la consigna
● Limitación de los valores absolutos de la consigna
● Filtrado de la señal de error de regulación por una zona muerta
● Vigilancia de rebase por exceso de los límites de alarma y advertencia del error de
regulación
● Acciones P, I y D activables individualmente
● Efecto P y D opcional en la rama de realimentación del regulador.
● Control anticipativo
● Aplicación de la realimentación de posición
● Control de la variable manipulada en modo manual desde una programadora o un
dispositivo HMI
● Limitación de los valores absolutos de la variable manipulada
● Consideración de tiempos específicos de los actuadores al generar los impulsos

896

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Cálculo de error de regulación
Valor real
Normalización (PV_NORM)
Mediante la casilla de verificación "Activar periferia" se especifica la magnitud de entrada
analógica que se normaliza a la unidad física del valor real.
● Activada: la magnitud de entrada es el valor real de periferia (PV_PER)
● Desactivada: la magnitud de entrada es el valor real interno (PV_IN)
Para definir la recta de normalización de forma unívoca, defina los cuatro parámetros
siguientes:
● entrada arriba (NM_PIHR)
● entrada abajo (NM_PILR)
● salida arriba (NM_PVHR)
● salida abajo (NM_PVLR)
Los parámetros se prestablecen según el tipo de sensor.
El valor real se calcula con la fórmula siguiente a partir del respectivo valor de entrada PV_PER
o PV_IN:
MP4 = (PV_PER - NM_PILR) × (NM_PVHR - NM_PVLR) / (NM_PIHR - NM_PILR) + NM_PVLR
O bien:
MP4 = (PV_IN - NM_PILR) × (NM_PVHR - NM_PVLR) / (NM_PIHR - NM_PILR) + NM_PVLR
03
10B39+5

10B39/5

10B3,/5

10B3,+5

39B3(5
39B,1

El valor real se emite en la variable estática MP4.
No se limitan valores ni se comprueban parámetros. Si se introduce el mismo valor para la
entrada arriba y la entrada abajo, según las fórmulas anteriores se puede producir una división
por cero. Esto no se considera en la instrucción.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

897

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Funciones de filtro
Filtrar magnitud regulada (LAG1ST)
Para filtrar señales de proceso con oscilaciones rápidas superpuestas (Noise) se utiliza un
elemento de retardo de primer orden en la rama del valor real. Esta función atenúa en mayor
o menor grado la magnitud regulada analógica en función de la constante de tiempo ajustada
(PV_TMLAG). De ese modo se suprimen de forma efectiva las señales perturbadoras. Sin
embargo, con esta medida también se aumenta en general la constante de tiempo de todo el
lazo de regulación, de modo que la regulación es más lenta.
El efecto atenuador se consigue con un algoritmo de retardo de 1er orden.
La respuesta al escalón en el rango de tiempo es:
outv(t) = MP4(0) (1 - e -t/PV_TMLAG)
RXWY

03 
RXWY W

W
39B70/$*

 39B70/$*

MP4(0)

la altura del escalón del valor real en la entrada

outv(t)

la magnitud de salida

PV_TMLAG

la constante de tiempo de retardo

t

Tiempo

Filtrado del valor real
Si el filtrado del valor real (LAG1STON = FALSE) no está activado, la entrada de periferia
(PV_PER) o la entrada interna (PV_IN) se aplican sin retardo en la rama del valor real.

Tiempo de retardo
El parámetro de entrada PV_TMLAG determina el tiempo de retardo para el valor real. Todo el
rango de valores es admisible.
Si PV_TMLAG ≤ 0.5 * CYCLE ya no actúa ningún retardo.
Se requiere un tiempo de muestreo (CYCLE) de menos de una quinta parte del tiempo de
retardo para obtener un comportamiento de retardo aproximadamente equivalente al
comportamiento analógico.

898

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Calcular raíz cuadrada (SQRT)
La función "Cálculo de la raíz cuadrada" (SQRT) permite linealizar la magnitud regulada. Si el
valor real proporcionado por un encóder está presente como magnitud física en relación
cuadrática con la magnitud de proceso medida, el desarrollo de la magnitud regulada debe
linealizarse antes de su procesamiento en el regulador.
La señal de medición siempre debe linealizarse extrayendo la raíz cuadrada si se realizan
mediciones de caudal con diafragmas o tubos de Venturi, etc. La presión diferencial medida
(presión efectiva) es así proporcional al cuadrado del caudal.
A través de la señal de entrada SQRT_ON = TRUE se activa la función de raíz cuadrada en la
rama de valor real. El algoritmo de la función de raíz cuadrada es el siguiente:
outv = SQRT (MP5) × (SQRT_HR – SQRT_LR) / 10.0 + SQRT_LR
outv es el valor de salida normalizado de la función de raíz cuadrada (caudal físico).
Esta fórmula presupone que el valor de entrada de la raíz está normalizado a un rango
numérico entre 0 y 100. En la normalización del valor real deben parametrizarse el "Rango de
medida superior" y el "Rango de medida inferior" a 100.0 y 0.0, respectivamente. La raíz de
este valor da como resultado un rango de medida entre 0 y 10. Este rango se normaliza
mediante el límite superior (SQRT_HR) y el límite inferior del rango de medida físico
(SQRT_LR).
RXWY

6457B+5

6457B/5
03




Ejemplo de normalización
El valor de entrada PV_IN del regulador es la presión diferencial en mbar:
Principio del rango de medida
NM_PILR

Fin del rango de medida
NM_PIHR

Ejemplo de valores de PV_IN

20,0 mbar

200,0 mbar

150,0 mbar

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

899

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Con la función de normalización PV_NORM se calcula la presión diferencial normalizada,
seleccionando NM_PVHR = 100.0 y NM_PVLR = 0.0:
MP4

=
=
=

(PV_IN - NM_PILR) * (NM_PVHR - NM_PVLR) /
(NM_PIHR - NM_PILR) + NM_PVLR
(PV_IN - 20.0 mbar) * (100.0 - 0.0) /
(200.0 mbar - 20.0 mbar) + 0.0
(PV_IN - 20.0 mbar) * 100 / 180.0 mbar

Valor inicial de MP4

Valor final de MP4

Ejemplo de valores de MP4

0.0

100.0

72.222

En este ejemplo no se utiliza ningún filtrado y, por lo tanto, rige lo siguiente: MP5 = MP4.
Para la raíz de la presión diferencial normalizada MP5 resulta:
Valor inicial tras la raíz

Valor final tras la raíz

Ejemplo de valores de
SQRT(MP5)

0.0

10.0

8.498

Para el valor de salida normalizado outv de la función de raíz (caudal físico) sigue con
SQRT_HR = 20000.0 m3/h und SQRT_LR = 0.0 m3/h:
outv

=
=
=

SQRT(MP5) * (SQRT_HR - SQRT_LR) / 10.0 + SQRT_LR
SQRT(MP5) * (20000.0 m3/h - 0.0 m3/h) / 10.0 + 0.0 m3/h
2000.0 m3/h * SQRT(MP5)

Principio del rango de medida
outv

Fin del rango de medida outv

Ejemplo de valores de outv

0,0 m3/h

20000,0 m3/h

16996,732 m3/h

Llamada de FC en la rama de valor real (PVFC)
La inserción de una función específica de usuario en la rama de valor real permite someter la
magnitud regulada a un tratamiento de señal antes de su procesamiento en el regulador (p. ej.
un retardo de señal o linealización).

Llamar una función
Para insertar una función específica de usuario en la rama del valor real, active "Activar
llamada de FC" (PVFC_ON). En el campo de entrada "Número de FC" (PVFC_NBR) se indica
el número de la función utilizada. El regulador ejecuta una llamada de la función. En ella no se
suministran valores a los parámetros de entrada y salida de la función de usuario. La
transferencia de datos debe programarla el usuario en su función.

900

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
El valor de salida de la función puede observarse en la variable estática MP6.
Nota
No se comprueba si una función está disponible. Si la función no está disponible, la CPU pasa
a STOP con un error interno de sistema.

Alarma
Vigilar los límites del valor real (PV_ALARM)
Si se rebasan por exceso o defecto determinados valores de las magnitudes del proceso
(como velocidad, presión, nivel de llenado, temperatura, etc.), en las regulaciones pueden
producirse estados no permitidos de proceso o instalación. En estos casos se aplica la
vigilancia de los límites del valor real (PV_ALARM) para controlar si el valor real rebasa el
rango de servicio admisible por exceso o por defecto. Los rebases de límite se registran y
notifican a fin de activar una respuesta adecuada.
Nota
La vigilancia de los límites del valor real no puede desactivarse. El rebase por exceso de los
límites configurados se notifica siempre.
La vigilancia de los límites del valor real (PV_ALARM) vigila la magnitud regulada PV(t) en
función de cuatro límites predefinibles en dos zonas de tolerancia. Cuando los límites se
alcanzan o rebasan, la función notifica "Advertencia" en el primer límite y "Alarma" en el
segundo.

Valores límite
Los valores numéricos de los límites se ajustan en los parámetros de entrada para
"Advertencia" y "Alarma". Si el valor real (PV) rebasa estos límites por exceso o defecto, se
activan los bits de aviso de salida correspondientes para la alarma superior (QPVH_ALM), la
advertencia superior (QPVH_WRN), la advertencia inferior (QPVL_WRN) y la alarma inferior
(QPVL_ALM).
Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
QPVH_ALM

QPVH_WRN

QPVL_WRN

QPVL_ALM

si:

y:

TRUE

TRUE

FALSE

FALSE

PV ↗

PV ≥ PVH_ALM

PV ↘

PV ≥ PVH_ALM - PV_HYS

PV ↗

PV ≥ PVH_WRN

PV ↘

PV ≥ PVH_WRN - PV_HYS

FALSE

TRUE

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

FALSE

FALSE

901

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
QPVH_ALM

QPVH_WRN

QPVL_WRN

QPVL_ALM

si:

y:

FALSE

FALSE

TRUE

FALSE

PV ↘

PV ≤ PVL_WRN

PV ↗

PV ≤ PVL_WRN + PV_HYS

PV ↘

PV ≤ PVL_ALM

PV ↗

PV ≤ PVL_ALM + PV_HYS

FALSE

FALSE

TRUE

TRUE

Para que el bloque funcione de manera eficiente debe aplicarse lo siguiente:
alarma superior < advertencia superior < advertencia inferior < alarma inferior
39

39 W

39B+<6

39+B$/0
39+B:51




39/B:51
39/B$/0
W

439+B$/0
439+B:51
439/B:51
439/B$/0

①
②

1. banda de tolerancia
2. banda de tolerancia

Histéresis
Para impedir que los bits de aviso "centelleen" con cambios muy pequeños de la magnitud de
entrada o con errores de redondeo, se ajusta una histéresis (diferencia de desactivación)
PV_HYS. La magnitud regulada debe superar la histéresis antes de que los bits de aviso se
desactiven.

902

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Vigilar la velocidad de cambio del valor real (ROCALARM)
Si el cambio de la magnitud de proceso (p. ej. velocidad, presión, nivel de llenado, temperatura,
etc.) es demasiado elevada, en las regulaciones pueden producirse estados no permitidos de
proceso o instalación. En estos casos se aplica la vigilancia de la velocidad de cambio del valor
real (ROCALARM) para controlar si el valor real rebasa por exceso o por defecto una velocidad
de cambio admisible. Los rebases de límite se registran y notifican a fin de activar una
respuesta adecuada.
Nota
La vigilancia de la velocidad de cambio del valor real (ROCALARM) no puede desactivarse. El
rebase por exceso de los límites configurados se notifica siempre.
La función ROCALARM vigila la magnitud regulada PV(t) respecto a límites admisibles de
velocidad de cambio, los cuales pueden ajustarse de forma diferente según el signo
correspondiente.
Los valores numéricos de las pendientes límite se ajustan en los parámetros de entrada
"Rampa de subida máxima" y "Rampa de bajada máxima" en el rango positivo y negativo de
la magnitud regulada. Las pendientes se refieren a la subida o bajada en porcentaje por
segundo. Si la velocidad de cambio de la magnitud regulada supera estos límites, se activan
los bits de aviso de salida correspondientes QPVURLMP ... QPVDRLMN.
39

39 W
3985/0B3
39'5/0B3
39'5/0B1
3985/0B1

W

3985/0B1

43985/0B3
439'5/0B3
439'5/0B1
43985/0B1

La identificación de los parámetros de las rampas se realiza según el siguiente esquema:
Parámetro

Cambio de PV

Rampa de subida máxima en el
rango positivo (PVURLM_P)

PV > 0 y |PV| ascendente

Rampa de bajada máxima en el
rango positivo (PVDRLM_P)

PV > 0 y |PV| descendente

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

903

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Parámetro

Cambio de PV

Rampa de subida máxima en el
rango negativo (PVURLM_N)

PV < 0 y |PV| ascendente

Rampa de bajada máxima en el
rango negativo (PVDRLM_N)

PV < 0 y |PV| descendente

Consigna
Definir la consigna
Seleccione un origen para la consigna. Las posibilidades son las siguientes:
● Consigna interna
El parámetro de entrada SP_INT se utiliza como consigna
● Generador de consigna
El parámetro de entrada SP_INT se utiliza como consigna y puede aumentarse o
disminuirse mediante las variables estáticas SPUP y SPDN.
● Generador ramp soak
El parámetro de entrada SP_INT se utiliza como consigna y puede modificarse siguiendo
un perfil predefinido.
● Consigna externa
En los reguladores de mezcla, relación y cascada se utiliza el parámetro de entrada
SP_EXT como consigna. La consigna externa puede normalizarse.
En el parámetro de salida SP se muestra la consigna efectiva.

Consulte también
Generador ramp soak (RMP_SOAK) (Página 906)

Generador de consigna (SP_GEN)
La consigna interna SP_INT se aumenta o disminuye progresivamente utilizando los
interruptores SPUP y SPDN. El valor modificado puede observarse en MP1. Se tienen en
cuenta los límites configurados de la consigna.

Repercusión de los interruptores SPUP y SPDN
Para poder realizar un cambio graduado finamente, el regulador debe tener un tiempo de
muestreo de 100 ms como máximo.

904

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
La velocidad de cambio de la magnitud de salida depende de la duración de pulsación de los
interruptores SPUP y SPDN así como de los límites ajustados de acuerdo con la relación
siguiente:
● durante los primeros 3 segundos después de activar SPUP o SPDN rige:
doutv/dt = (SP_HLM - SP_LLM) / 100 s
● a continuación
doutv/dt = (SP_HLM - SP_LLM) / 10 s
RXWY
63B+/0

V
W
V

V

63B//0

6383

63'1

W
V
W

Con un tiempo de muestreo de 100 ms y un rango de consigna de -100,0 a 100,0, la consigna
cambia en 0,2 por ciclo en los tres primeros segundos, por ejemplo. Si SPUP permanece en
TRUE durante más de 3 segundos, la velocidad de cambio aumenta a diez veces el valor, en
este caso a 2 por ciclo.

Arranque y funcionamiento del generador de consigna
● Durante el rearranque la salida outv se pone a 0.0.
● Al activar el generador de consigna (SPGEN_ON = TRUE), en la salida outv se muestra
primero el valor de señal SPFC_IN. Por este motivo, la conmutación al generador de
consigna desde otro modo de operación se produce siempre suavemente. Mientras los
interruptores SPUP y SPDN (teclas arriba y abajo) no se activan, SPFC_IN permanece en
la salida.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

905

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Parámetros de la función SP_GEN
El parámetro de salida outv es un parámetro implícito. Este puede observarse en la
herramienta de configuración mediante el punto de medición MP1.
Parámetro

Significado

Rango admisible

SPFC_IN

Consigna de la entrada de FC

Rango técnico

SP_INT

Consigna interna

Rango técnico

63B*(1

63*(1B21 %22/

)$/6(

6383

%22/

)$/6(

63'1

%22/

)$/6(

63B+/0

5($/



63B//0

5($/




63)&B,1

5($/



RXWY




63B,17

Figura 3-5

5($/

03

5($/





Esquema funcional y parámetros del generador de consigna

Generador ramp soak (RMP_SOAK)
Si la consigna SP_INT debe cambiar por sí misma en función del tiempo, p. ej. en la regulación
de procesos conforme a un programa de temperatura controlado por tiempo, es posible
hacerlo configurando un perfil y activando el generador ramp soak. El cambio de la consigna
se calcula a partir de segmentos con un máximo de 256 nodos.
Nota
La función del bloque no comprueba si existe un DB global con el número "DB_NBR" ni
tampoco si el parámetro "Número de nodos" NBR_PTS coincide con la longitud del DB. Si la
parametrización es incorrecta, la CPU cambia al estado STOP con un error de sistema interno.

906

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Funcionamiento del generador ramp soak
El generador ramp soak proporciona una función de la magnitud de salida outv que se ejecuta
de acuerdo con una programación determinada. El desarrollo del perfil se define con una serie
de nodos en un bloque de datos global DB_RMPSK con los valores de tiempo PI[i].TMV y los
correspondientes valores de salida PI[i].OUTV.
● PID-CP
AUTOHOTSPOT no está incluido en la librería. Debe crear usted mismo este bloque de
datos global.
● PID-ES
AUTOHOTSPOT no está incluido en la librería. Debe crear usted mismo este bloque de
datos global.
La figura siguiente muestra un perfil con 6 nodos.
RXWY
3,>@2879
3,>@2879




RXWY W

3,>@2879
3,>@2879








3,>@709

W
3,>@709

3,>@2879 
3,>@2879
3,>@709

3,>@709
3,>@709

3,>@709

3,>@709

PV

Para el último nodo n, el valor de tiempo PI[n].TMV = 0 ms. El tiempo de procesamiento de un
perfil se calcula partiendo del valor inicial y descendiendo hasta cero.
PI[i].TMV indica los intervalos entre nodo y nodo. Entre los nodos se interpola de acuerdo con
la función siguiente:
RXWY W  3,>Q@2879

56B70
3,>Q@709

3,>Q@28793,>Q@2879 

0 ≤ n ≤ (NBR_PTS - 1)
1RGR

3,>@2879
3,>@709

RXWY

1RGR

3XQWRLQLFLDO

3,>@2879
3,>@709

3,>@2879
3,>@709

3,>@709

3,>@709

3,>@709
W

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

907

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Nota
Nota
Al interpolar la curva de evolución entre los nodos, es posible que el valor de salida se
mantenga temporalmente fijo si resulta que el tiempo de muestreo CYCLE es muy pequeño
con respecto al tiempo entre los nodos PI[n].TMV. El generador ramp soak no puede linealizar
curvas planas debido a la precisión de cálculo de la CPU. Si la curva es demasiado plana, el
valor de salida permanece por un tiempo en el nodo correspondiente y, pasado cierto tiempo,
se integra en el próximo nodo con la pendiente mínima.
Solución: reduzca el tiempo entre los nodos insertando más nodos. De este modo, la curva
emitida se acercará a la curva plana deseada en forma de trapecio.

Activar el generador ramp soak
Con el cambio RMPSK_ON de FALSE a TRUE se activa el generador ramp soak. Una vez
alcanzado al último nodo se termina el perfil. Cuando el operador reinicia la función, es
necesario poner primero RMPSK_ON a 'FALSE' y a continuación a 'TRUE'.
En el rearranque, la salida outv se pone a 0.0 y se determina el tiempo total o el tiempo residual
total. En la transición al modo normal, la curva de evolución se procesa inmediatamente desde
el punto inicial de acuerdo con el modo de operación ajustado. Si no se desea que esto suceda,
el parámetro RMPSK_ON debe ponerse a FALSE en el OB de rearranque.

Funciones del generador ramp soak
La instrucción dispone de las funciones siguientes:
● Activar generador ramp soak para ejecución única
● Preasignar salida con valor fijo
● Activar repetición cíclica
● Detener generador ramp soak
● Continuar generador ramp soak
● Actualizar tiempo total de procesamiento y tiempo residual total
Para ajustar el modo de operación deseado se aplica la valencia de las entradas de control
especificada en la siguiente tabla:
Modo de operación

RMPSK_
ON

DFOUT_ RMP_
ON
HOLD

CONT_
ON

CYC_
ON

TUPDT_
ON

Señal de salida OUTV

Activar generador ramp
soak

TRUE

FALSE

**)

FALSE

**)

OUTV(t)

Especificar salida

TRUE

FALSE

El valor final se mantiene
tras el final de procesamien‐
to.

Activar repetición cíclica TRUE

TRUE

**)

**)

**)

**)

DF_OUTV

FALSE

FALSE

**)

TRUE

**)

OUTV(t)
Tras final: arranque auto‐
mático

908

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Modo de operación

RMPSK_
ON

DFOUT_ RMP_
ON
HOLD

CONT_
ON

CYC_
ON

TUPDT_
ON

Señal de salida OUTV

Detener generador
ramp soak

TRUE

FALSE

TRUE

FALSE

**)

**)

se mantiene el valor actual
de OUTV(t) *)

Continuar generador
ramp soak

TRUE

FALSE

TRUE

TRUE

**)

**)

OUTV (antiguo) *)

Actualizar el tiempo to‐
tal y el tiempo residual
total

**)

FALSE
**)

Se sigue con los nuevos va‐
lores predeterminados.

**)

**)

**)

FALSE

No influye en OUTV

TRUE

No influye en OUTV

*) Hasta el próximo nodo la curva no tiene la forma parametrizada por el usuario.
**) El modo de operación ajustado en cada caso se ejecuta independientemente de la valencia de las señales de control en
los campos marcados con **)

Especificar la salida del generador ramp soak
Si se activa esta función (DFRMP_ON = TRUE), el valor de salida del generador ramp soak se
pone al valor de señal SP_INT o al valor de salida SP_GEN.
Nota
La asignación previa con la consigna interna solo tiene efecto si el generador ramp soak está
activado (RMPSK_ON = TRUE).
Tras la conmutación DFRMP_ON = FALSE, outv se lleva linealmente de la consigna ajustada
(p. ej. SP_INT) al valor de salida del número de nodo actual PI[NBR_ATMS].OUTV.
El procesamiento interno de tiempo también continúa con una consigna fija aplicada
directamente (RMPSK_ON = TRUE y DFRMP_ON = TRUE).
Al iniciar la curva RMPSK_ON = TRUE se emite la consigna fija SP_INT hasta que
DFRMP_ON cambia de TRUE a FALSE después del tiempo T*.
5036.B21
')503B21

RXWY

63B,17


&XUYDFRQILJXUDGD
FXUYDDFWXDO



RXWY W









3,>@709
7

3,>@709

3,>@709 3,>@709
3,>@709

3,>@709

W

3,>@709 PV

45B6B$&7

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

909

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
En este momento ha transcurrido el tiempo PI[0].TMV y parte del tiempo PI[1].TMV. OUTV se
lleva de SP_INT a PI[2].OUTV, es decir, a la consigna del nodo 2.
La curva configurada se emite solo a partir del nodo 2. La coincidencia entre la curva
configurada y la actual se indica con QR_S_ACT = TRUE. Con un flanco ascendente en
DFOUT_ON durante el procesamiento de la curva, el valor de la salida OUTV salta sin retardo
a DF_OUTV.

Activar repetición cíclica
Cuando el modo de operación 'Repetición cíclica' (CYC_ON = TRUE) está activado, el
generador ramp soak vuelve automáticamente al punto inicial tras emitir el último valor de nodo
y se ejecuta de nuevo.
Entre el último nodo y el punto inicial no se interpola. Para una transición sin discontinuidad se
debe aplicar lo siguiente: PI[NBR_PTS].OUTV = PI[0].OUTV.

Detener generador ramp soak
Con RMP_HOLD = TRUE se congela el valor de la magnitud de salida (incluido el
procesamiento de tiempo). Cuando RMP_HOLD = FALSE se desactiva, PI[x].TMV continúa en
el punto de interrupción.
503B+2/'
')503B21
7
RXWY

63B,17




&XUYDFRQILJXUDGD
FXUYDDFWXDO
YDORUHVDFWXDOHV

 RXWY W








7



3,>@709
3,>@709 3,>@709
3,>@709 3,>@709
3,>@709
3,>@709
7LHPSRFRQILJXUDGR
3,>@7097
3,>@709
7LHPSRDFWXDO

W

45B6B$&7

El tiempo de procesamiento de la curva se prolonga por el tiempo T*. La curva presenta el
desarrollo configurado desde el nodo hasta el flanco ascendente en RMP_HOLD y desde el
nodo 5* hasta el nodo 6*, es decir, la señal de salida QR_S_ACT tiene el valor TRUE.
Si el interruptor CONT_ON está activado, el generador ramp soak detenido continúa en el
punto predeterminado TM_CONT con el procesamiento de la curva de desplazamiento.

910

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Continuar generador ramp soak
Con CONT_ON se continúa una curva detenida en un punto definido. Si el generador ramp
soak no está detenido, CONT_ON no tiene efecto.
Si la entrada de control para continuar CONT_ON = TRUE está activada, el generador ramp
soak detenido continúa en el nodo TM_SNBR. TM_CONT determina el tiempo residual que
requiere el generador hasta que se alcanza el nodo TM_SNBR.
La figura siguiente muestra la influencia de RMP_HOLD y CONT_ON con la configuración
siguiente:
Continuar en el nodo 5 (TM_SNBR = 5) y continuar en T* s: TM_CONT = T*
1LQJXQDUHDFFLµQ

&217B21
503B+2/'

RXWY


7

&XUYDFRQILJXUDGD
FXUYDDFWXDOYDORUHV
DFWXDOHV



RXWY W





3,>@709 3,>@709
7LHPSRFRQILJXUDGR


3,>@709
3,>@709

7

3,>@709
3,>@709




3,>@709


W
3,>@709

7LHPSRDFWXDO
45B6B$&7

Los nodos 3 y 4 se suprimen para este ciclo de procesamiento del generador ramp soak.
Después del cambio de señal RMP_HOLD de TRUE a FALSE, el desarrollo configurado de la
curva solo se vuelve a alcanzar a partir del nodo 5.
La salida QR_S_ACT solo se activa cuando el generador ramp soak procesa la curva de
evolución parametrizada por el usuario.

Actualizar el tiempo total y el tiempo residual total
En cada ciclo se actualizan el número actual del nodo NBR_ATMS, el tiempo residual actual
hasta alcanzar el nodo RS_TM, el tiempo total T_TM y el tiempo residual total hasta alcanzar
el final de la curva RT_TM.
En caso de modificaciones online de PI[n].TMV, cambian el tiempo total y el tiempo residual
total de la curva. Ya que el cálculo de T_TM y RT_TM prolonga considerablemente el tiempo
de procesamiento del bloque de función en muchos nodos, este solo se realiza después del
rearranque o si TUPDT_ON = TRUE. Los intervalos PI[0 ... NBR_PTS].TMV entre los
diferentes nodos se suman y se muestran en la salida del tiempo total T_TM y del tiempo
residual total RT_TM.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

911

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Tenga en cuenta que el cálculo de los tiempos totales requiere mucho tiempo de ejecución de
la CPU.

Procedimiento
Para configurar el generador ramp soak, proceda del siguiente modo:
1. En la lista "Origen de la consigna" seleccione la entrada "Generador ramp soak".
2. Cree un AUTOHOTSPOT (PID-CP) o un AUTOHOTSPOT (PID-ES).
3. Defina los parámetros necesarios para el perfil.
4. Introduzca el número del bloque de datos DB_RMPSK en el campo de entrada "Número de
DB".
5. Active o desactive las demás funciones del generador ramp soak.
6. Si ha activado la función "Continuar generador ramp soak", introduzca el nodo y el tiempo
en que deba continuar el generador.

Normalización
Normalización de una consigna externa
Si la consigna externa no está presente en la unidad física del valor real (p. ej. en % en una
cascada de regulador), es necesario normalizar ese valor y su rango de ajuste a la unidad física
del valor real. Para ello se utiliza la función "Normalización en la rama de consigna".
La función SP_NORM normaliza una magnitud de entrada analógica. La consigna externa
analógica se convierte a la magnitud de salida outv con la recta de normalización. El valor de
salida OUTV está accesible en la herramienta de configuración a través del punto de medición
MP2.
El valor de salida de la función es efectivo cuando la entrada de control es SPEXT_ON = TRUE.
Para definir la recta de normalización de forma unívoca, defina los cuatro parámetros
siguientes:
● Entrada arriba: SP_EXT: NM_SPEHR
● Entrada abajo: SP_EXT: NM_SPELR

912

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
● Salida arriba: NM_PVHR (este valor se introduce en la función de normalización del valor
real.)
● Salida abajo: NM_PVLR (este valor se introduce en la función de normalización del valor
real.)
RXWY

10B39+5

10B39/5
63B(;7
10B63(/5

10B63(+5

El valor de salida outv se calcula con la fórmula siguiente a partir del correspondiente valor de
entrada SP_EXT:
outv = (SP_EXT – NM_SPELR) x (NM_PVHR – NM_PVLR) / (NM_SPEHR – NM_SPELR) +
NM_PVLR
Para el caso especial de una función de raíz aplicada en la rama de valor real rigen como límite
superior e inferior del valor de salida outv los valores de normalización de la función de raíz
(SQRT_HR y SQRT_LR).
En ese caso, el valor de salida outv de la función de normalización se calcula con la fórmula
siguiente a partir del correspondiente valor de entrada SP_EXT:
outv = (SP_EXT – NM_SPELR) x (SQRT_HR – SQRT_LR) / (NM_SPEHR – NM_SPELR) +
SQRT_LR
Dentro de la función no se limitan los valores ni se comprueban los parámetros. Si introduce
el mismo valor para NM_SPEHR y NM_SPELR, según las fórmulas anteriores se puede
producir una división entre cero. Esto no se considera en la instrucción.

Factor de mezcla/relación
En una regulación de relación, las consignas de los lazos de regulación se adaptan unas a
otras de forma que la relación ajustada se corresponde con la relación efectiva de los valores
reales.
En una regulación de mezcla se ajusta la proporción deseada de cada uno de los
componentes. La suma de los factores de mezcla FAC debe dar 1.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

913

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para configurar la normalización, proceda del siguiente modo:
1. Introduzca los valores de la normalización en los campos de entrada "Entrada arriba" y
"Entrada abajo".
2. Introduzca un factor de mezcla/relación (FAC).

Límites
Llamada de FC en la rama de consigna
La inserción de una función específica de usuario en la rama de consigna permite someter una
referencia predeterminada de forma externa a un procesamiento de señal (p. ej. un retardo de
señal o linealización) antes de aplicarla en el regulador.
Si se activa la llamada de FC en la rama de consigna, se llama una función específica de
usuario. El regulador ejecuta una llamada de la FC. En ella no se suministran valores a los
parámetros de entrada y salida de la función de usuario ya existentes. Por ello, la transmisión
de datos debe programarse manualmente con S7-AWL en la FC de usuario. La consigna
acondicionada se observa en MP3.
En ese caso, el valor de SPFC_ON determina si en el canal de la consigna se inserta en este
punto una función programada libremente en forma de FC estándar (p. ej. una curva
característica) o si la consigna continúa procesándose sin ninguna influencia de ese tipo.
Nota
La instrucción no comprueba si hay una función. Si la función no está disponible, la CPU pasa
a STOP con un error interno de sistema.

Procedimiento
Para llamar una función en la rama de la consigna, proceda del siguiente modo:
1. Active la casilla de verificación "Activar llamada de FC".
2. En el campo de entrada "FC", indique el número de la función que se va a llamar.

Limitación de la velocidad de cambio de la consigna
Las funciones de rampa en la rama de la consigna se utilizan en aquellos casos en que el
proceso no soporta cambios bruscos de la señal manipulada, ya que un cambio abrupto de la
consigna generalmente provoca también un escalón en la variable manipulada del regulador.
Estos cambios abruptos de la variable manipulada deben evitarse p. ej. en aquellos casos en
que entre el motor regulado y la carga que debe accionarse hay interpuesto un engranaje, y
una elevación muy rápida del número de revoluciones del motor derivaría en una sobrecarga
del engranaje.
La función SP_ROC limita la velocidad de cambio de las consignas procesadas en el
regulador, ya sea por separado para la rampa de subida y bajada, como por separado para los
rangos positivo y negativo de la referencia.

914

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
En las cuatro entradas SPURLM_P, SPDRLM_P, SPURLM_N y SPDRLM_N se introducen las
limitaciones correspondiente para los aumentos de la función de rampa en los rangos positivo
y negativo de la referencia. Las rampas de subida se refieren a la subida o bajada por segundo.
Los cambios de consigna más rápidos se retardan a estas velocidades límite.
Si p. ej. SPURLM_P se parametriza a 10.0 [rango de valores tec./s], en cada ciclo de muestreo
se suman los siguientes valores al "valor antiguo" de outv mientras inv sea > outv:
Tiempo de muestreo

1s

outvantiguo + 10

100 ms

outvantiguo + 1

10 ms

outvantiguo + 0.1

La siguiente figura muestra el funcionamiento del procesamiento de la señal a partir de un
ejemplo. Las funciones de escalón en la entrada inv(t) se traducen en funciones de rampa en
la salida outv(t).
LQY
RXWY

LQY W

RXWY W
63'5/0B3

6385/0B3


6385/0B3
6385/0B1

W
63'5/0B1

Figura 3-6

Limitación de la velocidad de cambio de la referencia SP(t)

No se notifica el alcance de los límites de la pendiente.

Procedimiento
Para limitar la velocidad de cambio, proceda del siguiente modo:
1. Active la casilla de verificación "Limitar la velocidad de cambio".
2. Defina los siguientes valores tanto para el rango positivo como para el negativo:
– Rampa de subida de consigna
– Rampa de bajada de consigna

Limitación del valor absoluto de la referencia
El rango de ajuste de la referencia determina el rango dentro del cual puede oscilar la
referencia, es decir, el margen en el que se mueve el proceso dentro de los valores de estado
admisibles.
Por ello, para evitar estados de proceso críticos o no permitidos, Standard PID Control limita
el rango de ajuste de la referencia en la rama de consigna por arriba y por abajo (SP_LIMIT).
La función SP_LIMIT limita la consigna SP al valor inferior y superior predeterminable SP_LLM
y SP_HLM mientras la magnitud de entrada INV esté fuera de dichas limitaciones. Dado que

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

915

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
la función no puede desactivarse, en la configuración siempre hay que tener en cuenta la
indicación de los límites inferior y superior.
Los valores numéricos de los límites se ajustan en los parámetros de entrada para la limitación
inferior y superior. Si la magnitud de entrada inv(t) rebasa los límites, se emiten las
indicaciones correspondientes a través de las salidas de aviso.
LQY
63

LQY W

63B+/0

)UDQMDGHWROHUDQFLD

W


63 W
63B//0

463B+/0
463B//0

Figura 3-7

Limitación de valor absoluto de la referencia SP(t)

Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
SP =PVH_ALM

QSP_HLM

QSP_LLM

si:

SP_HLM

TRUE

FALSE

inv ≥ SP_HLM

SP_LLM

FALSE

TRUE

inv ≤ SP_LLM

inv

FALSE

FALSE

SP_HLM < inv < SP_LLM

Procedimiento
Para limitar el valor absoluto de la referencia, proceda del siguiente modo:
1. En el campo de entrada "Límite superior", indique el límite superior absoluto de la consigna
(SP_HLM).
2. En el campo de entrada "Límite inferior", indique el límite inferior absoluto de la consigna
(SP_LLM).

Error de regulación
Zona muerta

916

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
En caso de superposición de la magnitud regulada o la referencia con una señal perturbadora
de mayor frecuencia, en un regulador con ajuste óptimo el ruido también es efectivo en la
salida del regulador. En una amplificación elevada del regulador y con derivación activada, por
ejemplo, esto puede provocar importantes oscilaciones en la magnitud manipulada. Debido al
aumento de la frecuencia de conmutación (regulador paso a paso), eso deriva en un desgaste
elevado del actuador.
En estado forzado del regulador, la función reduce el ruido en la señal del error de regulación,
disminuyendo así la oscilación no deseada de la salida de regulador.
La zona muerta puede desactivarse.

Filtrado de señal por función de zona muerta
La función DEADBAND suprime pequeñas oscilaciones de la magnitud de entrada dentro de
un rango parametrizable alrededor de un punto cero definido. Fuera de esta franja de
oscilaciones, el error de regulación ER aumenta o cae proporcionalmente a la magnitud de
entrada. El ancho de la zona no efectiva (zona muerta) puede definirse con el parámetro
DEADB_W. El ancho de zona muerta solo debe tener valores positivos.
Si la magnitud de entrada se encuentra dentro de la zona muerta, se deposita el valor 0 (error
de regulación = 0) en la salida. Solo una vez que la magnitud de entrada abandona este rango
de insensibilidad, la salida aumenta o cae la parte correspondiente a los mismos valores de la
magnitud de entrada inv. El resultado es una falsificación de la señal transmitida, también fuera
de la zona muerta. Sin embargo, esto se tolera para evitar escalones en los límites de la zona
muerta (véase la siguiente figura). La falsificación corresponde al valor DEADB_W, por lo que
es fácilmente controlable.
La función DEADBAND trabaja según las siguientes funciones:
(ER) = inv + DEADB_W para inv < - DEADB_W
(ER) = 0 para -DEADB_W ≤ inv ≤ + DEADB_W
(ER) = inv - DEADB_W para inv > + DEADB_W
(5

LQY

'($'%B:

Las repercusiones del filtrado de señales se observan en el parámetro de salida ER.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

917

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Alarma
Las desviaciones excesivas de la magnitud regulada respecto a la consigna ajustada pueden
provocar estados de proceso no deseados. En estos casos se utiliza la función ER_ALARM
para vigilar que el error de regulación no rebase el rango de servicio permitido por exceso ni
por defecto. ER_ALARM registra y notifica los rebases de límite ocurridos, para permitir una
respuesta adecuada.
Nota
La vigilancia de los límites del error de regulación no puede desactivarse. El rebase por exceso
de los límites configurados se notifica siempre.
La función ER_ALARM vigila el valor del error de regulación ER(t) en función de cuatro límites
predefinibles en dos zonas de tolerancia. Cuando los límites se alcanzan o rebasan, la función
notifica primero "Advertencia" y a continuación "Alarma" en el segundo límite.

Valores límite
Los valores numéricos de los límites se ajustan en los parámetros de entrada para
"Advertencia" y "Alarma". Si el error de regulación (ER) rebasa estos límites por exceso o
defecto, se activan los bits de aviso de salida correspondientes QERN_ALM ... QERP_ALM.
Durante el rearranque se desactivan los bits de aviso.
Los bits de aviso se activan del modo siguiente:
QERP_ALM

QERP_WRN

QERN_WRN

QERN_ALM

si:

y:

TRUE

TRUE

FALSE

FALSE

ER ↗

ER ≥ ERP_ALM

ER ↘

ER ≥ ERP_ALM - ER_HYS

FALSE

TRUE

FALSE

FALSE

ER ↗

ER ≥ ERP_WRN

ER ↘

ER ≥ ERP_WRN - ER_HYS

FALSE

FALSE

TRUE

FALSE

ER ↘

ER ≤ ERP_WRN

ER ↗

ER ≤ ERP_WRN + ER_HYS

FALSE

FALSE

TRUE

TRUE

ER ↘

ER ≤ ERP_ALM

ER ↗

ER ≤ ERP_ALM + ER_HYS

Para que el bloque funcione de manera eficiente debe aplicarse lo siguiente:
alarma superior < advertencia superior < advertencia inferior < alarma inferior

918

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
(5

(5 W

(5B+<6

(53B$/0

l]RQDGHWROHUDQFLD

(53B:51

l]RQDGHWROHUDQFLD

W

(51B:51
(51B$/0

4(53B$/0
4(53B:51
4(51B:51
4(51B$/0

Histéresis
Para evitar que los bits de aviso "centelleen" con cambios muy pequeños de la magnitud de
entrada o con errores de redondeo, se ajusta una histéresis (diferencia de desactivación)
ER_HYS. El error de regulación debe superar esta histéresis antes de que los bits de aviso se
desactiven.

Regulador
Algoritmo de regulación
En el ciclo del tiempo de muestreo configurado se calcula la magnitud manipulada del
regulador continuo a partir del error de regulación en el algoritmo de posición PID. El regulador
tiene una estructura puramente paralela. Las acciones proporcional, integral o diferencial se
pueden desconectar individualmente.
',69B6(/
',69

*$,1
(5

3

,

'

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

3B6(/

,B6(/

3,'B2879

'B6(/

919

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Control anticipativo
A la señal de salida del regulador PID_OUTV se le puede aplicar adicionalmente una magnitud
perturbadora DISV. La activación o desactivación se realiza en la ventana PID de la
herramienta de configuración a través del conmutador de estructura DISV_SEL o mediante
"Magnitud perturbadora ON".

Acción P y D en la rama de realimentación
En la estructura paralela, cada acción del algoritmo regulador recibe el error de regulación
como señal de entrada. La magnitud manipulada es modificada directamente por la acción P
y la acción D con escalones de la consigna. Sin embargo, otra estructura del regulador en la
que la formación de la acción P y la acción D se traslada a la realimentación, garantiza una
evolución suave de la magnitud manipulada en caso de variaciones del escalón de la
referencia. En esta estructura la acción I procesa el error de regulación como señal de entrada,
en la acción P y en la acción D solo se conecta la magnitud de regulación negativa (factor = -1).
*$,1
(5

,

3,'B2879

3

39

'

Normalización de las magnitudes de entrada ER y PV
Las magnitudes de entrada ER y PV del regulador PID se normalizan antes del procesamiento
del regulador en el rango de 0 a 100, conforme a las fórmulas siguientes:
● con función de raíz desactivada (SQRT_ON = FALSE):
– ERnormalizado = ER * 100.0 / (NM_PVHR – NM_PVLR)
– PVnormalizado = (PV - NM_PVLR) * 100.0 / (NM_PVHR – NM_PVLR)
● con función de raíz activada (SQRT_ON = TRUE):
– ERnormalizado = ER * 100.0 / (SQRT_HR – SQRT_LR)
– PVnormalizado = (PV - SQRT_LR) * 100.0 / (SQRT_HR – SQRT_LR)
La normalización se lleva a cabo para que la ganancia proporcional GAIN del regulador PID
pueda introducirse sin dimensiones. De este modo, si cambia el límite superior e inferior del
rango de medida físico (p. ej. de bar a mbar), no es necesario cambiar el factor de ganancia.
Las magnitudes de entrada normalizadas ERnormalizado y PVnormalizado no pueden observarse.

920

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Consulte también
Estructuras de regulador (Página 921)
Acción P (Página 924)
Acción D (Página 928)
Acción I (Página 925)

Estructuras de regulador
Uso y parametrización del regulador PID
La mayor parte de los procesos regulados que se dan en la industria del procesamiento y los
procesos puede regularse con la función de regulador PI/PID de Standard PID Control. Solo en
casos especiales se requieren métodos y medidas adicionales para dominar la regulación en
cuestión.
No obstante, un gran problema práctico suele ser la parametrización del regulador PI/PID, es
decir, encontrar los valores de ajuste "correctos" para los parámetros del regulador. La calidad
de esta parametrización es determinante para la efectividad de la regulación PID, y requiere
una gran experiencia práctica, conocimientos especializados o bien mucho tiempo.

Regulación P
En el regulador P están desconectadas las acciones I y D. (I_SEL y D_SEL = FALSE). Eso
significa que con un error de regulación ER = 0, la señal de salida también es OUTV = 0. Para
ajustar un punto de trabajo ≠ 0, es decir, un valor numérico para la señal de salida con un error
de regulación cero, hay que activar la rama I (véase la figura siguiente).
En la acción I se puede predeterminar un punto de trabajo ≠ 0 para el regulador P ajustando
el valor de inicialización I_ITLVAL en correspondencia. Para ello hay que activar los
conmutadores 'I_ITL_ON' y 'I_SEL' = TRUE.
3B6(/

3
*$,1
(5

,B,7/B21
 ,B6(/

,

3,'B2879


,B,7/9$/

La respuesta indicial del regulador P en el rango de tiempo es:
PID_OUTV (t) = I_ITLVAL + GAIN * ER normalizado (t)
(5 QRUPDOL]DGR

3,'B287 W

3,'B2879

(5QRUPDOL]DGR W
W

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

921

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

PID_OUTV(t)

es la magnitud manipulada en modo automático del regulador

I_ITLVAL

es el punto de trabajo del regulador P

GAIN

es la ganancia de regulador

ER normalizado (t)

es el error de regulación normalizado

Regulación PI
En el regulador PI está desconectada la acción D. (D_SEL = FALSE). Un regulador PI modifica
la magnitud de salida PID_OUTV con la acción I hasta que el error de regulación es ER = 0. Sin
embargo, esto solo es aplicable cuando la magnitud de salida no rebasa los límites del rango
manipulado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR    W
7,

(5 QRUPDOL]DGR
3,'B2879 W

3,'B2879
*$,1 (5 QRUPDOL]DGR


*$,1 (5 QRUPDOL]DGR W

*$,1 (5 QRUPDOL]DGR


(5QRUPDOL]DGR W
7,

PID_OUTV(t)

es la magnitud manipulada en modo automático del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escalón del error de regulación normalizado

TI

Constante de tiempo de integración

Regulación PD
En el regulador PD está desconectada la acción I (I–SEL = FALSE). Eso significa que con un
error de regulación ER = 0, la señal de salida también es OUTV = 0. Para ajustar un punto de
trabajo ≠ 0, es decir, un valor numérico para la señal de salida con un error de regulación cero,
hay que activar la rama I (véase también el diagrama de bloques de la regulación P).
En la acción I se puede predeterminar un punto de trabajo ≠ 0 para el regulador PD ajustando
el valor de inicialización I_ITLVAL en correspondencia. Para ello hay que activar los
conmutadores 'I_ITL_ON' e 'I_SEL' TRUE .
El regulador PD reproduce la magnitud de entrada ER(t) proporcionalmente sobre la señal de
salida y añade la acción D creada por la derivación de ER(t), que se calcula con el doble de
precisión según la regla del trapecio (aproximación de Padé). El comportamiento de tiempo se
determina mediante la constante derivativa (tiempo de derivación) TD.
Para el filtrado de señales y la supresión de señales perturbadoras se ha integrado un retardo
de 1er orden (tiempo ajustable: TM_LAG) en el algoritmo para formar la acción D.

922

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Generalmente es suficiente un valor reducido para TM_LAG para conseguir el resultado
deseado. Si se parametriza TM_LAG ≤ CYCLE/2 el retardo está desactivado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR 



7'
70B/$*

W
H 70B/$*

(5 QRUPDOL]DGR

3,'B2879

*$,1

7'
(5
70B/$*  QRUPDOL]DGR

3,'B2879 W

(5QRUPDOL]DGR W

*$,1 (5 QRUPDOL]DGR

70B/$*

PID_OUTV(t)

es la magnitud manipulada en modo automático del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escalón del error de regulación normalizado

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

Regulación PID
En el regulador PID están activadas las acciones P, I y D (P–SEL = TRUE, I–SEL = TRUE,
D_SEL = TRUE). Un regulador PID modifica la magnitud de salida PID_OUTV mediante la
acción I hasta que el error de regulación es ER = 0. Sin embargo, esto solo es aplicable cuando
la magnitud de salida no rebasa los límites del rango manipulado. Si se rebasan los límites de
la variable manipulada, la acción I mantiene el valor alcanzado en el límite en (Anti-ResetWindup).
El regulador PID reproduce la magnitud de entrada normalizada ERnormalizado(t)
proporcionalmente sobre la señal de salida y añade las acciones creadas por la derivación e
integración de ERnormalizado(t), que se calculan con el doble de precisión según la regla de
trapecio (aproximación Padé). La respuesta de tiempo se determina por el tiempo de
derivación (tiempo de acción derivativa) TD y el tiempo de integración (tiempo de acción
integral) TI.
Para el filtrado y la supresión de señales perturbadoras se ha integrado un retardo de 1er orden
(constante de tiempo ajustable: TM_LAG) en el algoritmo para formar la acción D.
Generalmente es suficiente un valor reducido para TM_LAG para conseguir el resultado
deseado. Si se parametriza TM_LAG ≤ CYCLE/2 el retardo está desactivado.
La respuesta indicial en el rango de tiempo es:
3,'B2879 W  *$,1 (5 QRUPDOL]DGR 

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019



 W
7'
7,
70B/$*

W
H 70B/$*

923

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
(5 QRUPDOL]DGR
3,'B2879

*$,1

3,'B2879 W

7'

(5 QRUPDOL]DGR
70B/$* 

3,B287 W
*$,1 (5 QRUPDOL]DGR 
*$,1 (5 QRUPDOL]DGR


*$,1 (5 QRUPDOL]DGR
W
W

70B/$*
7,

PID_OUTV(t)

es la magnitud manipulada en modo automático del regulador

GAIN

es la ganancia de regulador

ER normalizado (0)

es la altura del escalón del error de regulación normalizado

TI

Constante de tiempo de integración

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

Nota
Si TD cambia, conviene adaptar TM_LAG de la forma correspondiente.
Recomendación: 5 ≤ (TM / TM_LAG) ≤ 10

Consulte también
Algoritmo de regulación (Página 919)
Acción P (Página 924)
Acción D (Página 928)

Acción P
Ganancia proporcional
El signo de la ganancia proporcional determina el sentido de acción del regulador continuo.
● Ganancia proporcional positiva
error de regulación ascendente → variable manipulada ascendente
● Ganancia proporcional negativa
error de regulación ascendente → variable manipulada descendente

924

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Aplicar la acción P en rama de realimentación
Si la acción P está aplicada en la rama de realimentación, solo el valor real tendrá efecto sobre
la acción P. Por ello, la magnitud manipulada – igual que en el caso de escalón de la consigna
– en un cambio de automático a manual no realiza ningún escalón por la acción P: la
conmutación es suave.

Consulte también
Algoritmo de regulación (Página 919)

Acción I
Función de la acción I
La acción I hace que, reajustando el punto de operación, el error de regulación pueda
convertirse en 0 para cualquier valor de la magnitud manipulada.
La acción I genera una señal de salida cuya velocidad de cambio es proporcional al cambio del
valor absoluto de la magnitud de entrada. La respuesta temporal viene determinada por el
tiempo integrativo TI.
La función de transferencia en el rango de tiempo es:
2879 W 


7,

ȉ

LQY W GW

LQY
/01B,

/01B, W

/01B, W    LQY W
7,
LQY W

LQY

W
7,

LMN_I(t)

la magnitud de salida de la acción I

inv0

la altura del escalón en la entrada de la acción I

TI

Tiempo integrativo

La acción I se observa en la variable estática LMN_I.
Parámetro

Significado

Rango admisible

TI

Tiempo integrativo

≥ 5 * CYCLE

I_ITLVAL

Valor de inicialización para la acción
I

-100,0 a +100,0 [%]

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

925

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

,17
,B6(/

%22/

)$/6(

,B,7/B21

%22/

)$/6(

,17B+326

%22/

)$/6(

,17B+1(*

%22/

)$/6(




/01B,



LQY

5($/



7,

7,0(

7V



,B,7/9$/

5($/





5($/



*) Ajuste predeterminado al crear el objeto tecnológico
En estado desactivado (I_SEL = FALSE) la acción I, es decir, la memoria interna y la variable
estática LMN_I, se pone a cero.
La salida y la memoria de la acción I están limitados por los límites absolutos de la variable
manipulada LMN_HLM y LMN_LLM (Anti Reset Wind–up).
En caso de influir en la señal manipulada en modo manual, es decir, cuando MAN_ON,
LMNOP_ON o CAS_ON = TRUE, el valor de la memoria interna de la acción I se corrige según
el valor LMN.
3B6(/

3

*$,1
(5

/0123
0$1
/0123B21
0$1B21

,17B+326,17B+1(*
,B6(/

,







/01

,B,7/B21

,B,7/9$/




/01

Conmutación de modo manual a automático
La acción I se ajusta en modo manual de modo que durante la conmutación de manual a
automático y partiendo de la posición actual, la magnitud manipulada realiza un escalón cuya
altura queda determinada por la acción P. La altura del escalón de la acción P equivale al
cambio de la magnitud manipulada cuando hay un escalón de consiga del valor real actual a
la consigna actual.
Sin embargo, si la acción P está aplicada en la rama de realimentación, solo el valor real tendrá
efecto en la acción P. Por ello, en una conmutación de manual a automático, la magnitud
manipulada no realiza ningún escalón por la acción P; la conmutación es suave.

926

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Rangos admisibles para el tiempo integrativo TI y CYCLE
Debido a la precisión limitada de los números REAL calculados en la CPU, es posible que se
produzca el efecto siguiente durante la integración: si se ha elegido un tiempo de muestreo
CYCLE de la regulación demasiado pequeño en comparación con el tiempo integrativo TI y si
el valor de entrada inv de la acción I es pequeño en comparación con su valor de salida OUTV,
la acción I no se activa y permanece en su valor de salida momentáneo.
Este efecto puede evitarse si se considera la siguiente regla de dimensionado en la
configuración:
CYCLE > 10–4 × TI
De este modo, la acción I reacciona incluso a cambios de los valores de entrada situados en
el rango de una millonésima parte por mil de la magnitud de salida actual:
inv > 10 –10 × OUTV
Para que el comportamiento de transferencia del algoritmo del integrador equivalga al
comportamiento analógico, el tiempo de muestreo debería ser menor que el 20 % del tiempo
integrativo ajustado o bien TI debería tener como mínimo cinco veces el valor del tiempo de
muestreo seleccionado:
CYCLE < 0,2 × TI
El algoritmo admite para el tiempo de muestreo valores hasta CYCLE ≤ 0,5 * TI.

Inicializar la acción I
Cuando se activa la inicialización de la acción I, el valor de inicialización se aplica a la variable
estática LMN_I en caso de rearranque de la CPU o si COM_RST = TRUE. Al cambiar al modo
normal reseteando la inicialización, la acción I comienza la integración de su magnitud de
entrada a partir del valor de inicialización.

Detener la acción I
Mediante las variables estáticas INT_HPOS y INT_HNEG es posible bloquear la acción I en
sentido positivo y negativo, respectivamente. Esto puede ser útil en cascadas. Si, p. ej., la
magnitud manipulada del regulador secundario se aproxima al límite superior, existe la
posibilidad de impedir que siga aumentando la magnitud manipulada del regulador piloto
mediante su acción I. Este comportamiento se programa con las instrucciones siguientes, p.
ej., en AWL:
A
"regulador secundario".QLMN_HLM
=
"regulador piloto".INT_HPOS
A
"regulador secundario".QLMN_ LLM
=
"regulador piloto".INT_HNEG

Consulte también
Algoritmo de regulación (Página 919)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

927

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Acción D
Función de la acción D
La acción D genera una señal de salida cuya magnitud cambia proporcionalmente a la
velocidad de cambio de la magnitud de entrada. La respuesta temporal se determina mediante
el tiempo derivativo TD y el tiempo de retardo TM_LAG.
La respuesta a un escalón de entrada inv0 es:
/01B'

/01B' W  

W
7'
LQY H 70B/$*
70B/$*

7' LQY

70B/$*
LQY
W
70B/$*

LMN_D(t)

la magnitud de salida de la acción D

inv0

la altura del escalón en la entrada de la acción D

TD

Tiempo derivativo

TM_LAG

Tiempo de retardo

La acción D se observa en la variable estática LMN_D.
En estado desactivado (D_SEL = FALSE) la acción D, es decir, la memoria interna y la variable
estática LMN_D, se pone a cero.

Aplicar la acción D en la rama de realimentación
Si la acción D está aplicada en la rama de realimentación, solo el valor real tendrá efecto sobre
la acción D. Por ello, en una conmutación de manual a automático, la magnitud manipulada –
igual que en el caso de un escalón de la consigna – no realiza ningún escalón por la acción D;
la conmutación es suave.

Valores admisibles para el tiempo derivativo y el tiempo de retardo
Para que la acción D pueda calcularse correctamente, deben observarse las condiciones
siguientes para el tiempo derivativo y el tiempo de retardo:
● TD ≥ CYCLE y
● TM_LAG ≥ 0,5 × CYCLE
Si TD < CYCLE, la acción D trabaja como si TD tuviera el valor CYCLE.
Si TM_LAG < 0,5 × CYCLE, la acción D trabaja sin retardo. Un escalón de entrada se multiplica
por el factor TD/CYCLE y este valor se devuelve en la salida como "impulso de aguja". Esto
significa que en el próximo ciclo de procesamiento, LMN_D se pondrá de nuevo a cero.

928

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Coeficiente DT1
El coeficiente DT1 se calcula del modo siguiente:
Coeficiente DT1 = TD/TM_LAG

Tiempo de retardo
Para el filtrado de señales y la supresión de señales perturbadoras se ha integrado un retardo
de 1er orden (constante de tiempo ajustable: TM_LAG) en el algoritmo para formar la acción
D.
La mayoría de las veces es suficiente con un valor pequeño como tiempo de retardo para
alcanzar el resultado deseado. Si se parametriza un tiempo de retardo inferior a la mitad del
tiempo de muestreo del regulador, el retardo está desactivado.

Procedimiento
Para configurar la acción D, proceda del siguiente modo:
1. Para aplicar la acción D en la rama de realimentación, active la casilla de verificación
correspondiente.
2. Introduzca el tiempo derivativo en segundos.
3. Introduzca el tiempo de retardo en segundos.

Consulte también
Algoritmo de regulación (Página 919)

Variable manipulada
Regulador paso a paso con realimentación de posición
Esquema funcional del regulador paso a paso con realimentación de posición en el lazo de regulación
El funcionamiento del regulador paso a paso con realimentación de posición se basa en el
algoritmo de regulación PID y se completa con los elementos funcionales que generan las
señales de salida binarias a partir de la señal manipulada analógica del regulador.
El elemento de tres puntos transforma las diferencias entre la magnitud manipulada y la
realimentación de posición en impulsos positivos o negativos de la señal de salida (según sea
el signo), que se dan en un accionamiento de válvula motriz, por ejemplo. En la práctica, se
trata de una regulación en cascada con un lazo de regulación de posición subordinado.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

929

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
$OJRULWPR3,'
(5 QRUPDOL]DGR

&RQVLJQD

/01

HOHPHQWRGHWUHV
Y£OYXODGH
SXQWRV
FRQWURO
4/0183

SURFHVR

4/01'1

9DORUUHDO
5HDOLPHQWDFLµQGHSRVLFLµQ/015B,1R03

Seleccionar la realimentación de posición
Para aplicar la realimentación de posición en el comparador en la rama de la variable
manipulada del regulador paso a paso hay disponibles diferentes entradas con el
correspondiente procesamiento de señal, en función del formato del valor que debe
procesarse. Con LMNR_PER se pueden aplicar señales en el formato de la periferia SIMATIC
y con LMNR_IN señales en formato de coma flotante.
En el punto de medición MP10 se deposita el valor interno correspondiente en el rango
porcentual.
03

/0151250

/015B&53

/015B3(5



/0153B21



/015B,1

Si la realimentación de posición es suministrada por un módulo de entradas analógicas, el
valor numérico existente en LMNR_PER de la realimentación de posición debe convertirse a
un valor en coma flotante normalizado a porcentajes.
No se comprueba si se produce un desbordamiento positivo o negativo, si se alcanza el rango
de tolerancia por encima o debajo ni si hay rotura de hilo.
La tabla siguiente ofrece una visión de conjunto de los rangos y valores numéricos antes y
después del procesamiento.

930

Valor de periferia LMNR_PER

Valor de salida en %

32767

118,515

27648

100,000

1

0,003617

0

0,000

-1

- 0,003617

- 27648

- 100,000

- 32768

- 118,519

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Nota
La realimentación de posición no debe activarse ni desactivarse en modo online. Esto significa
que LMNR_ON no debe modificarse online.
Para activar la realimentación de posición, proceda del siguiente modo:
1. Active la casilla de verificación "Activar" en el área "Seleccionar realimentación de posición".
2. Elija la opción "Realimentación de posición en periferia" para aplicar señales en el formato
de periferia SIMATIC.
Elija la opción "Realimentación de posición" para aplicar señales en el formato de coma
flotante.

Normalizar la realimentación de posición
Si la realimentación de posición está disponible en forma de magnitud física (p. ej. de 240 a 800
mm o en un ángulo de 0° a 60°), la realimentación de posición en formato de coma flotante (%)
debe normalizarse a la magnitud física en el valor interno en coma flotante necesario para el
procesamiento posterior.
Para definir la recta de normalización de forma unívoca deben definirse los parámetros
siguientes:
● el factor (para la pendiente): LMNR_FAC
● el offset de la recta de normalización en el punto cero: LMNR_OFF
03

/015B)$&
/015B2))
LQY

La realimentación de posición normalizada se calcula de acuerdo con la fórmula siguiente de
inv (LMNR_PER) y se emite en MP10:
MP10 = inv * LMNR_FAC + LMNR_OFF
La normalización se hace efectiva cuando la realimentación de posición en periferia está
activada (LMNRP_ON = TRUE). Dentro de la función no se limitan los valores. No tiene lugar
una comprobación de los parámetros.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

931

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para normalizar la señal de la realimentación de posición, proceda del siguiente modo:
1. En el campo de entrada "Factor", introduzca la pendiente de la recta de normalización.
2. En el campo de entrada "Offset", introduzca el offset de la recta de normalización hacia el
punto cero.

Regulador paso a paso sin realimentación de posición
Estructura y función del regulador paso a paso
El regulador paso a paso sin realimentación de posición se compone de dos elementos: el
elemento de regulador PD que trabaja con señales continuas y un segundo elemento en el que
se generan las señales manipuladas binarias a partir de la diferencia entre la acción PD y la
realimentación.
La acción I del regulador paso a paso sin realimentación de posición se calcula en la
realimentación. La señal de realimentación comparada con la salida del regulador PD se forma
integrando los dos elementos siguientes de la señal:
● Componente de señal para la realimentación de posición simulada
± 100/MTR_TM
● Componente de señal para la acción I
ERnormalizado*GAIN/TI
Así pues, la señal de realimentación es la diferencia entre la realimentación de posición
simulada y la acción I.
El elemento de tres puntos transforma las diferencias entre la magnitud manipulada y la señal
de realimentación en impulsos positivos o negativos de la señal de salida (según sea el signo),
que se dan en un accionamiento de válvula motriz, por ejemplo.
En estado estabilizado, la salida de la acción I y la acción PD se convierten en cero. Puesto que
la entrada del elemento de tres puntos también se convierte en cero, las señales manipuladas
binarias QLMNUP y QLMNDN permanecen en FALSE.
Dado que la integración se realiza en la realimentación, la acción I no se incluye en el cálculo
del algoritmo PID. Sin embargo, la acción I del algoritmo PID puede ajustarse a un valor fijo con
I_ITL_ON y I_ITLVAL.
En un regulador paso a paso sin realimentación de posición no se soporta la congelación de
la acción I con INT_HPOS y INT_HNEG.
Aquí, el modo manual a través del parámetro MAN se suprime debido a la falta de información
sobre la posición del actuador.

932

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
4/0183
4/01'1



(5 QRUPDOL]DGR

/016B2125/0162321




075B70



,B6(/$1'127,B,7/B21








4/0183254/01'1





*$,1
7,

La activación de las señales de tope del actuador (LMNR_HS/LMNR_LS) provoca el bloqueo
de la variable manipulada LMNUP o LMNDN.
Si el actuador no suministra señales de tope, hay que activar los parámetros de entrada
LMNR_HS y LMNR_LS = FALSE.
Nota
Si no hay señales de tope, el regulador no puede detectar si se ha alcanzado un tope
mecánico. Existe la posibilidad de que el regulador emita señales para abrir la válvula, por
ejemplo, aunque ya se encuentre en el tope superior.

Modo manual
Debido a la falta de información sobre la posición del actuador, en el regulador paso a paso sin
realimentación de posición se suprime el modo manual a través del parámetro MAN o el
generador de la variable manipulada manual MAN_GEN. Solo es posible el modo manual
mediante conmutación directa de las señales manipuladas (LMNS_ON = TRUE).

Simulación de la realimentación de posición
Si no se dispone de una realimentación de posición como magnitud mensurable, también
puede simularse (LMNRS_ON = TRUE).
La simulación de la realimentación de posición se realiza mediante un integrador usando el
tiempo de posicionamiento del motor MTR_TM como constante de tiempo integrativo. En el
estado LMNRS_ON = FALSE se emite el valor inicial del parámetro LMNRSVAL en la salida
del integrador LMNR_ SIM. Después de conmutar a LMNRS_ON = TRUE, la simulación
arranca con este valor inicial.
Si LMNR_HS = TRUE, la integración se detiene hacia arriba, si LMNR_LS = TRUE, se detiene
hacia abajo. No se sincroniza la realimentación de posición simulada en las posiciones finales.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

933

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
4/0183
38/6(287

4/01'1


/015B+6
/015B/6 6LPXODFLµQGHODUHDOLPHQWDFL
µQGHSRVLFLµQ





,17
/015B6,0

,17
/0156B21
/01569$/
075B70

Nota
La realimentación de posición solamente se simula. No tiene que coincidir con la posición real
del actuador. Si existe una realimentación de posición real, se debería usar sin falta.

Modo manual
Modo manual
La estructura de la generación y aplicación del valor manual puede verse en la figura siguiente.
0$1*1B21
/01/,0,7

/016B21

0$1

/0183

0$1B21

/01'1

03
/01/,0,7

0$1B*(1

7+5((B67

38/6(287

/01

4/0183
4/01'1

03
3,'B2879
UHJXODGRU

03
/0183B23
/01'1B23
/0162321
/015B,1R03

934

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
En el regulador paso a paso existen tres modos de operación en los que es posible influir
manualmente en la variable manipulada:
● Valor manual a través del parámetro de entrada MAN
A través del parámetro MAN (-100,0 % a 100,0 %) se puede aplicar una influencia externa
de la magnitud manipulada como valor absoluto, o puede predeterminarse desde el
programa de usuario.
Solo es posible si la realimentación de posición está activada.
● Modo manual mediante interruptor de más/menos del generador del valor manual
(MANUP, MANDN),
Si se activa MAN_GEN desde otro modo de operación, se aplica la variable manipulada
MP9. Así, la conmutación al generador del valor manual siempre es suave. La variable
manipulada manual puede aumentarse o reducirse dentro de los límites LMN_HLM y
LMN_LLM.
Solo es posible si la realimentación de posición está activada.
● Modo manual por aplicación directa de las señales manipuladas
El modo manual por aplicación directa de las señales manipuladas LMNUP y LMNDN
siempre tiene preferencia.
Cuando se retrocede LMNS_ON = FALSE se aplica "con suavidad" un modo de operación
cualquiera activado.

Modo automático
Si se ha desactivado el modo manual (MAN_ON = FALSE), la variable manipulada del
algoritmo PID se aplica al elemento de tres puntos. La conmutación de modo manual a
automático provoca un escalón de la variable manipulada LMN. No obstante, esto no tiene
ningún efecto negativo, ya que el proceso se acciona en forma de rampa a través del actuador
de acción integrativa. La salida del algoritmo PID se encuentra en el punto de medición MP7.

Corrección del valor manual en el modo automático
Si la realimentación de posición en periferia está activada (LMNRP_ON = TRUE), el parámetro
de entrada MAN se corrige según la posición del actuador (MP10).
Si la realimentación de posición está activada (LMNRP_ON = FALSE), el parámetro de entrada
MAN se corrige según la posición del actuador (LMNR_IN).
Al conmutar al modo manual, la magnitud manipulada permanece en el valor correspondiente
a la posición del actuador. A continuación puede modificarse mediante intervención manual.

Activar el modo manual con valor manual
En este modo de operación (MANGN_ON = FALSE y MAN_ON = TRUE) se introduce la
variable manipulada manual como valor absoluto en la entrada MAN. La variable manipulada
manual se indica en el punto de medición MP8.
1. Active la casilla de verificación "Activar modo manual".
2. Seleccione la opción "Valor manual".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

935

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Activar el generador de valor manual
El valor manual MAN se aumenta o reduce progresivamente utilizando los interruptores
MANUP y MANDN. El valor modificado puede observarse en MP8. Se tienen en cuenta los
límites configurados de la variable manipulada.
1. Active la casilla de verificación "Activar modo manual".
2. Seleccione la opción "Generador del valor manual".

Repercusión de los interruptores MANUP y MANDN
Para poder realizar un cambio graduado finamente, el regulador debe tener un tiempo de
muestreo de 100 ms como máximo.
La velocidad de cambio de la variable manipulada depende de la duración de pulsación de los
interruptores MANUP y MANDN así como de los límites ajustados de acuerdo con la relación
siguiente:
● durante los primeros 3 segundos después de activar MANUP o MANDN rige:
doutv/dt = (LMN_HLM - LMN_LLM) / 100 s
● a continuación
doutv/dt = (LMN_HLM - LMN_LLM) / 10 s
RXWY
/01B+/0

V
W
V

V

/01B//0

0$183
W
0$1'1

V
W

Con un tiempo de muestreo de 100 ms y un rango de la variable manipulada de -100,0 a 100,0,
la variable manipulada cambia en 0,2 por ciclo en los tres primeros segundos, por ejemplo. Si
MANUP se mantiene en TRUE durante más de 3 segundos, la velocidad de cambio aumenta
a diez veces el valor, en este caso a 2 por ciclo.
El generador del valor manual se activa suavemente.

936

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Activación de los modos de operación
La tabla siguiente muestra los modos de operación posibles del regulador paso a paso con los
valores necesarios para los interruptores que determinan la estructura.
Tabla 3-1

Modos de operación del regulador paso a paso
MAN_ON

MNGN_ON

LMNS_ON

Modo automático

FALSE

cualquiera

FALSE

Modo manual sin control por interruptor

TRUE

FALSE

FALSE

Modo manual mediante generador de valor ma‐ TRUE
nual

TRUE

FALSE

Modo manual mediante señales manipuladas

cualquiera

TRUE

cualquiera

Límites
En el regulador paso a paso con realimentación de posición es posible limitar la variable
manipulada.

Limitar el valor absoluto de la magnitud manipulada
El rango de trabajo, es decir, el rango dentro del cual puede moverse el actuador sin
abandonar las variables manipuladas admisibles, está determinado por el rango de ajuste de
la variable manipulada. Dado que, dependiendo del tipo de actuador, los límites de las
variables manipuladas permitidas no suelen cubrirse con el límite 0 % o 100 % del rango de
ajuste, es posible configurar el límite superior e inferior de la variable manipulada.
Para evitar estados no permitidos en el proceso en cuestión, en la rama de la variable
manipulada de la regulación se limita el rango de ajuste de la magnitud manipulada por arriba
y abajo.
La función LMNLIMIT limita la magnitud manipulada LMN(t) a los valores inferior y superior
LMN_HLM y LMN_LLM. Estos valores pueden predeterminarse. Sin embargo, la magnitud de
entrada inv debe estar fuera de estos límites. Dado que la función no puede desactivarse, en
la configuración siempre hay que tener en cuenta la indicación del límite inferior y superior.
Los valores numéricos de los límites (en porcentaje) se ajustan en los parámetros de entrada
para la limitación inferior y superior. Si la magnitud de entrada inv(t) rebasa los límites, se
muestran las indicaciones correspondientes a través de las salidas de aviso.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

937

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
LQY
/01

LQY W

/01B+/0

)UDQMDGH
WROHUDQFLD



W
/01 W

/01B//0

4/01B+/0
4/01B//0

Arranque y funcionamiento
● En caso de rearranque, todas las salidas de aviso se ponen a cero.
● La limitación trabaja según las siguientes relaciones:
LMN =

QLMN_HLM

QLMN_LLM

si:

LMN_HLM

TRUE

FALSE

inv ≥ LMN_HLM

LMN_LLM

FALSE

TRUE

inv ≤ LMN_LLM

inv

FALSE

FALSE

LMN_HLM < inv < LMN_LLM

En la salida, es decir, en el parámetro LMN o en el punto de medición MP10, se muestra la
variable manipulada efectiva de la regulación.

Procedimiento
Para limitar el valor absoluto de la magnitud manipulada, proceda del siguiente modo:
1. Introduzca el valor más alto permitido en el campo de entrada "Límite superior".
2. Introduzca el valor más bajo permitido en el campo de entrada "Límite inferior".

Generador de impulsos
El generador de impulsos se encarga de que se mantenga el tiempo de conexión y
desconexión mínimo con el fin de proteger los actuadores. La activación de las señales de tope
del actuador (LMNR_HS/LMNR_LS) provoca el bloqueo de la variable manipulada LMNUP o
LMNDN. Esto sirve tanto para el modo automático como manual.

938

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Si están activados ambos interuptores de señal para el control de señal de la variable
manipulada (LMNUP = LMNDN = TRUE o LMNUP_OP = LMNDN_OP = TRUE), las salidas
QLMNUP y QLMNDN siempre son FALSE.
El cambio directo de "Señal de variable manipulada Abrir" (QLMNUP = TRUE, QLMNDN =
FALSE) a "Señal de variable manipulada Cerrar" (QLMNUP = FALSE, QLMNDN = TRUE) no
es posible. El generador de impulsos inserta un ciclo con QLMNUP = QLMNDN = FALSE.

Señal de entrada INV en el regulador paso a paso con realimentación de posición
La diferencia entre la variable manipulada LMN y la realimentación de posición LMNR se aplica
en el elemento de tres puntos con histéresis THREE_ST.
/015B+6
/015B/6

/016B21
/0183
/01'1
/01

7+5((B67
DGDSWLY

$1'

38/6(287

$1'

$1'

4/0183

$1'

4/01'1

/0183B23
/01'1B23
/0162321
/015B,1R03

Señal de entrada INV en el regulador paso a paso sin realimentación de posición
La diferencia entre la acción PD del regulador y la magnitud de realimentación (MP11) se
aplica al elemento de tres puntos con histéresis THREE_ST.

03

7+5((B67

3,'B2879

4/0183
4/01'1

38/6(287




25
03

/016B2125/0162321








075B70

,17



(5QRUPDOL]DGR *$,1
7,

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019



939

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Influencia del tiempo de posicionamiento del motor en el elemento de tres puntos
El elemento de tres puntos genera dos señales binarias que son TRUE o FALSE según sean
la magnitud y el signo del valor diferencial en la entrada.
El elemento de tres puntos THREE_ST reacciona a la señal de entrada INV de acuerdo con las
relaciones siguientes y adopta en cada caso una de las tres combinaciones posibles de sus
señales de salida UP/DOWN:
UP

DOWN

Combinación de entrada

TRUE

FALSE

|INV| ≥ ThrOn o INV > ThrOff y UPantiguo = TRUE

FALSE

TRUE

|INV| ≤ -ThrOn o INV < -ThrOff y DOWNantiguo = TRUE

FALSE

FALSE

|INV| ≤ ThrOff

ThrOn = umbral de conexión, ThrOff = umbral de desconexión

83

03

83


'2:1

03
7KU2II

'2:1

7KU2Q

El umbral de desconexión ThrOff debe ser mayor que el cambio de la realimentación de
posición o que el cambio de posición tras la duración de un impulso. Este valor depende del
tiempo de posicionamiento del motor MTR_TM y se calcula del siguiente modo:
7KU2II 


&<&/(
075B70

MTR_TM debe ser un múltiplo entero de CYCLE.
Nota
Un tiempo de posicionamiento del motor demasiado elevado (10% por encima del tiempo de
posicionamiento real) provoca una conexión y desconexión continuas de las señales de
variable manipulada QLMNUP y QLMNDN.

Adaptación del umbral de conexión ThrOn
Con el fin de reducir la frecuencia de conmutación al regular errores de regulación mayores, el
umbral de conexión ThrOn se adapta automáticamente durante el funcionamiento, mientras
que ThrOff permanece constante. ThrOn está limitado a:
0LQ7KU2Q 


0$; 38/6(B70&<&/(
075B70

0D[7KU2Q 

La adaptación del umbral de conexión está desactivada en reguladores P, D o PD puros. En
este caso es:

940

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
ThrOn = Min ThrOn

Tiempo de conexión y desconexión mínimo
El generador de impulsos procura que se mantenga el tiempo de conexión y desconexión
mínimo al conectar y desconectar los impulsos de salida, respectivamente.
Por este motivo, para proteger el actuador es posible parametrizar un tiempo de conexión
mínimo PULSE_TM y un tiempo de desconexión mínimo BREAK_TM. La duración de los
impulsos de salida QLMNUP y QLMNDN es siempre mayor que el tiempo de conexión mínimo
y la pausa entre dos impulsos es siempre mayor que el tiempo de desconexión mínimo. La
figura siguiente muestra el funcionamiento siguiendo el ejemplo de la señal UP.
83LQ

W
83RXW

38/6(B70


W
%5($.B70

Procedimiento
Para configurar el generador de impulsos, proceda del siguiente modo:
1. Introduzca el tiempo de posicionamiento del motor en el campo de entrada "Tiempo pos.
motor".
2. Introduzca un "Tiempo mín. conexión".
3. Introduzca un "Tiempo mín. desconexión".

Puesta en servicio de PID_ES
Realizar una optimización manual
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.
● MAN_ON = FALSE

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

941

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para determinar manualmente los parámetros PID óptimos, proceda del siguiente modo:
1. Haga clic en el símbolo
"Medición activada".
Si aún no existe ninguna conexión online, ésta se establece. Los valores actuales de
consigna, valor real y variable manipulada se graban.
2. Introduzca parámetros PID nuevos en los campos "P", "I", "D" y "Tiempo de retardo".
3. Haga clic en el grupo "Optimización" en el símbolo

"Enviar parámetros a la CPU".

4. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna" .
5. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
símbolo .
Si la velocidad de cambio de la consigna está limitada, se conmuta suavemente a la nueva
consigna.
6. En caso necesario, desactive la casilla de verificación "Modo manual".
El regulador trabaja con los nuevos parámetros PID y regula según la nueva consigna.
7. Compruebe la calidad de los parámetros PID basándose en la evolución de las curvas.
8. Repita los pasos del 3 hasta el 8, hasta que esté satisfecho con el resultado de la regulación.

Puesta en servicio con el PID Self Tuner
La instrucción PID_ES se pone en servicio con el PID Self-Tuner y se determinan los
parámetros PID óptimos.

Procedimiento
Para poner en servicio un regulador paso a paso, proceda del siguiente modo:
1. Llame la instrucción PID_ES en un OB de alarma cíclica e interconecte los parámetros de
entrada y salida.
2. Llame la instrucción TUN_ES en el mismo OB de alarma cíclica.

942

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Interconecte la instrucción TUN_ES con PID_ES del siguiente modo:
– TUN_ES.PV con PID_ES.PV
– Si se utiliza una realimentación de posición, TUN_ES.LMNR con PID_ES.LMNR_IN
– TUN_ES.C_LMNUP y TUN_ES.C_LMNDN con PID_ES.QLMN_UP y PID_ES.QLMNDN
– TUN_ES.LMNR_HS con PID_ES.LMNR_HS
– TUN_ES.LMNR_ON con PID_ES.LMNR_ON
– TUN_ES.LMNS_ON con PID_ES.LMNS_ON
– TUN_ES.SP_OUT con PID_ES.SP_IN o PID_ES.SP_EXT
– TUN_ES.GAIN con PID_ES.GAIN
– TUN_ES.TI con PID_ES.TI
– TUN_ES.TD con PID_ES.TD
– TUN_ES.TM_LAG con PID_ES.TM_LAG
– TUN_ES.MTR_TM con PID_ES.MTR_TM
– Si se utiliza una zona muerta, TUN_ES.DEADB_W con PID_ES.DEADB_W
– TUN_ES.QLMNUP y TUN_ES.QLMNDN con PID_ES.LMNUP y PID_ES.LMNDN
4. Haga clic en el símbolo
en la instrucción TUN_ES.
Se abre el editor de puesta en servicio para TUN_ES. El funcionamiento del editor de
puesta en servicio se describe en el PID Self-Tuner.

3.5.2

Utilizar Modular PID Control

3.5.2.1

Volumen de funciones del Modular PID Control
En muchas tareas de regulación no solo es importante el clásico regulador PID como elemento
que influye en el proceso, sino que también se ponen elevadas exigencias al procesamiento
de las señales.
Modular PID Control contiene instrucciones con funciones para acondicionar el valor real y la
consigna, así como para calcular y retocar la variable manipulada.
Son posibles los reguladores siguientes:
● Reguladores continuos
● Reguladores paso a paso para actuadores de acción integrativa
● Reguladores de impulsos
Interconectando las diferentes instrucciones se consiguen reguladores para diferentes
aplicaciones:
● Regulador de valor fijo
● Regulador en cascada
● Regulador de relación

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

943

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
● Regulador de mezcla
● Regulador de rango partido
● Regulador de corrección
● Regulador con procesamiento de magnitudes perturbadoras
● Regulador multivariable
Se pueden regular tanto sistemas regulados lentos (temperatura, nivel, etc.) como sistemas
regulados muy rápidos (caudal, presión, etc.).
La instrucción LP_SCHED_M permite llamar muchos lazos de regulación de forma
equidistante pero con diferentes tiempos de muestreo. El tiempo de muestreo del lazo de
regulación varía según sea la inercia del correspondiente sistema regulado.
De este modo se garantiza una carga homogénea de la CPU.
Para poner en servicio y optimizar los parámetros PID se utiliza el PID Self-Tuner.

3.5.2.2

Pasos básicos para crear un FB de regulación

Procedimiento básico para programar un regulador
Un regulador se programa, p. ej., con AWL como bloque de función (FB de regulación). El FB
de regulación debe tener como mínimo los parámetros siguientes:
● Parámetro de entrada COM_RST
● Parámetro de entrada CYCLE
● Parámetro de entrada para consigna
● Parámetro de entrada para valor real
● Parámetro de salida para la variable manipulada
● Parámetro de entrada/salida para la variable manipulada manual (regulador continuo)
Adicionalmente, es posible crear los parámetros siguientes según sean los requisitos de
regulación:
● Parámetro de entrada para realimentación de posición (regulador paso a paso)
● Parámetro de entrada para una magnitud perturbadora
● Parámetro de salida para el valor real acondicionado
● Parámetro de salida para la consigna acondicionada
● Parámetro de salida para el rebase por exceso de límites
El detalle con el que se configuren las entradas y salidas dependerá de las particularidades
específicas, por ejemplo, si el valor real tiene formato de periferia o en coma flotante, qué
realimentación de posición hay, etc.
En el FB de regulación se llaman las instrucciones de Modular PID Control y se interconectan
los parámetros de entrada y salida. El FB de regulación creado se llama, p. ej. en el OB 100 o
en un OB de alarma cíclica.

944

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Para programar un regulador con Modular PID Control deben seguirse los pasos siguientes:
Paso

Descripción

1.º

Acondicionar consigna (Página 945)

2.º

Acondicionamiento del valor real (Página 947)

3.º

Determinar y acondicionar el error de regulación (Página 948)

4.º

Control anticipativo (Página 951) (opcional)

5.

Calcular variable manipulada
● Crear un regulador continuo (Página 952)
● Crear un regulador de impulsos (Página 954)
● Crear un regulador paso a paso (Página 957)

6.

Acondicionamiento de la realimentación de posición (Página 958)

Consulte también
Acondicionar consigna (Página 945)
Acondicionamiento del valor real (Página 947)
Determinar y acondicionar el error de regulación (Página 948)
Control anticipativo (Página 951)
Crear un regulador continuo (Página 952)
Crear un regulador de impulsos (Página 954)
Crear un regulador paso a paso (Página 957)
Acondicionamiento de la realimentación de posición (Página 958)

3.5.2.3

Programar el FB de regulación

Acondicionar consigna
Instrucciones para acondicionar la consigna
Se pueden utilizar las siguientes instrucciones.
● SP_GEN: especificar consigna manualmente
● ROC_LIM: limitar velocidad de cambio
● LAG1ST: filtrar consigna
● NONLIN: linealizar consigna
● LIMITER: limitar consigna
● RMP_SOAK: especificar consigna según programación
● SCALE_M: escalar consigna
● NORM: normalizar consigna

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

945

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Ejemplo de acondicionamiento de la consigna
Una consigna especificada debe poder aumentarse o reducirse manualmente. Para evitar
cambios de la consigna en forma de escalón, se limita la velocidad de cambio.
Para acondicionar la consigna tal como se describe en el ejemplo, proceda del siguiente modo:
1. Declare en el FB de regulación, en este caso PIDCTR, un parámetro de entrada SP_IN del
tipo de datos "Real".
2. Interconecte SP_IN con una variable que contenga la consigna deseada.
3. En el FB de regulación llame la instrucción SP_GEN como multiinstancia e interconecte
SP_IN con SP_GEN.DF_OUTV.
4. Parametrice el límite superior e inferior de la consigna en la estructura SP_GEN_Instance
de la multiinstancia.
5. En el FB de regulación llame la instrucción ROC_LIM como multiinstancia e interconecte
SP_GEN.OUTV con ROC_LIM.INV mediante una variable temporal.
6. Parametrice las velocidades de cambio máximas en la estructura ROC_LIM_Instance de la
multiinstancia.
7. Para calcular el error de regulación, reste el valor real acondicionado de ROC_LIM.OUTV
o interconecte ROC_LIM.OUTV con ERR_MON.SP.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación PIDCTR.
3,'&75
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



'($'%$1'



,19

&<&/(
,19

2879

2879



2879



3,'
&20B567
&<&/(
(5
/01*B3,'

&53B,1



52&B/,0
&20B567

/01*(1B&
&20B567
&<&/(

3,'B/01*

/,0$/$50

3,'B/01*



/01

/01

/01*B3,'



&20B567
39B3(5

946

,19B3(5

2879

,19

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Consulte también
Acondicionamiento del valor real (Página 947)

Acondicionamiento del valor real
Instrucciones para el acondicionamiento del valor real
Se pueden utilizar las siguientes instrucciones.
● CRP_IN: escalar valor de periferia
● LAG1ST: filtrar valor real
● LIMITER: limitar valor real
● LIMALARM: vigilar valor real
● NONLIN: linealizar valor real
● SCALE_M: escalar valor real
● NORM: normalizar valor real

Ejemplo de acondicionamiento del valor real
El valor real tiene formato de periferia y debe vigilarse el mantenimiento de los límites de valor
real.
Para acondicionar el valor real tal como se describe en el ejemplo, proceda del siguiente modo:
1. Declare en el FB de regulación, en este caso PIDCTR, un parámetro de entrada PV_PER
del tipo de datos "Word".
2. Interconecte PV_PER con la entrada de periferia en la que se mide el valor real.
3. En el FB de regulación llame la instrucción CRP_IN como multiinstancia, p. ej. con el
nombre CRP_IN_Instance_PV.
4. Interconecte PV_PER con CRP_IN.INV_PER.
5. Parametrice el factor y offset para el escalado en la estructura CRP_IN_Instance_PV de la
multiinstancia.
6. En el FB de regulación llame la instrucción LIMALARM como multiinstancia e interconecte
CRP_IN.OUTV con LIMALARM.INV mediante una variable temporal.
7. Parametrice los límites del valor real en la estructura LIMALARM_Instance de la
multiinstancia.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación PIDCTR.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

947

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3,'&75
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



,19



&<&/(
,19

2879



'($'%$1'

2879

2879



3,'
&20B567
&<&/(
(5

/01*(1B&
&20B567
&<&/(

/01*B3,'

&53B,1



52&B/,0
&20B567

3,'B/01*



3,'B/01*

/,0$/$50



/01

/01

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Consulte también
Acondicionar consigna (Página 945)
Determinar y acondicionar el error de regulación (Página 948)

Determinar y acondicionar el error de regulación
Determinar y limitar el error de regulación
El error de regulación se determina de dos formas: programando la resta del valor real de la
consigna o utilizando la instrucción ERR_MON. En la instrucción ERR_MON ya se incluye una
vigilancia del error de regulación.

Instrucciones para el acondicionamiento del error de regulación
Se pueden utilizar las siguientes instrucciones.
● A_DEAD_B: conducir el error de regulación por la zona muerta adaptativa
● DEADBAND: conducir el error de regulación por la zona muerta

948

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Ejemplo de la resta
El error de regulación se calcula restando y se conduce por una zona muerta.
Para determinar el error de regulación tal como se describe en el ejemplo, proceda del
siguiente modo:
1. Llame la instrucción DEADBAND como multiinstancia e interconecte DEADBAND.INV con
la diferencia entre consigna y valor real, p. ej. ROC_LIM.OUTV - CRP_IN.OUTV.
2. Parametrice el ancho de la zona muerta y un offset de la zona muerta en la estructura
DEADBAND_Instance de la multiinstancia.
Un DEADBAND.OUTV mostrará el error de regulación acondicionado.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación PIDCTR.
3,'&75
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



'($'%$1'



,19

&<&/(
,19

2879

2879



2879



3,'
&20B567
&<&/(
(5
/01*B3,'

&53B,1



52&B/,0
&20B567

/01*(1B&
&20B567
&<&/(

3,'B/01*

/,0$/$50

3,'B/01*



/01

/01

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Ejemplo del uso de ERR_MON
El error de regulación se determina y vigila con la instrucción ERR_MON.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

949

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Para determinar el error de regulación tal como se describe en el ejemplo, proceda del
siguiente modo:
1. Llame la instrucción ERR_MON como multiinstancia.
2. Utilizando variables temporales, interconecte la consigna acondicionada con
ERR_MON.SP, p. ej. ROC_LIM.OUTV, y el valor real acondicionado con ERR_MON.PV, p.
ej. CRP_IN.OUTV.
En ERR_MON.ER se indica el error de regulación.
3. Parametrice la vigilancia del error de regulación en la estructura ERR_MON_Instance de la
multiinstancia.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación PIDCTR_ER.
3,'&75B(5
&20B567
&<&/(
63B,1



63B*(1
&20B567
&<&/(
')B2879



(55B021
63
39

&53B,1

&<&/(
,19

2879

(5



52&B/,0
&20B567
2879



3,'
&20B567
&<&/(
(5
/01*B3,'



/01*(1B&
&20B567
&<&/(

3,'B/01*

/,0$/$50

3,'B/01*



/01

/01

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Consulte también
Acondicionamiento del valor real (Página 947)
Control anticipativo (Página 951)

950

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Control anticipativo
Instrucciones para el acondicionamiento de la magnitud perturbadora
Se pueden utilizar las siguientes instrucciones.
● CRP_IN: Escalar valor de periferia
● DIF: Reaccionar a cambios rápidos
● LAG1ST: Filtrar perturbaciones
● NON_LIN: Linealizar magnitud perturbadora
● SCALE_M: Escalar magnitud perturbadora
● NORM: Normalizar magnitud perturbadora

Ejemplo de acondicionamiento de la magnitud perturbadora
La magnitud perturbadora tiene formato de periferia, la señal debe filtrarse y linealizarse por
medio de una curva característica.
Para acondicionar la magnitud perturbadora tal como se describe en el ejemplo, proceda del
siguiente modo:
1. Declare en el FB de regulación un parámetro de entrada DISV_PER del tipo de datos
"Word".
2. Interconecte DISV_PER con la entrada de periferia en la que se mide la magnitud
perturbadora.
3. En el FB de regulación llame la instrucción CRP_IN como multiinstancia, p. ej. con el
nombre CRP_IN_Instance_DISV.
4. Interconecte DISV_PER con CRP_IN.INV_PER.
5. Parametrice el factor y offset de la escala en la estructura CRP_IN_Instance_DISV de la
multiinstancia.
6. En el FB de regulación llame la instrucción LAG1ST como multiinstancia e interconecte
CRP_IN.OUTV con LAG1ST.INV mediante una variable temporal.
7. Parametrice el tiempo de retardo en la estructura LAG1ST_Instance de la multiinstancia.
8. En el FB de regulación llame la instrucción NONLIN como multiinstancia e interconecte
LAG1ST.OUTV con NONLIN.INV mediante una variable temporal.
9. Cree un AUTOHOTSPOT en el que se guardarán los nodos de la curva característica.
10.Parametrice el número del bloque de datos global con la curva característica en la
estructura NONLIN_Instance de la multiinstancia.
11.En NONLIN.OUTV se indica la magnitud perturbadora acondicionada.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación CTR_C_FF.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

951

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

&75B&B))
&20B567
&<&/(



63B*(1
&20B567
&<&/(
2879

')B2879

63B,1



&53B,1
,19B3(5

3,'B/01*

3,'B/01*



2879

&53B,1
,19B3(5



/01

',69
/01*B3,'

',69B3(5

/01*(1B&
&20B567
&<&/(

(5



39B3(5

2879

,19



3,'
&20B567
&<&/(



52&B/,0
&20B567
&<&/(



2879

&53B287 

,19

2879

/01B3(5

/01*B3,'



/,0$/$50
&20B567
,19

/$*67

,19



2879



121/,1

,19

2879

Consulte también
Determinar y acondicionar el error de regulación (Página 948)
Crear un regulador continuo (Página 952)
Crear un regulador de impulsos (Página 954)
Crear un regulador paso a paso (Página 957)

Crear un regulador continuo
Para un regulador continuo con variable manipulada analógica se necesitan las instrucciones
PID, LMNGEN_C y CRP_OUT.

952

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para programar un regulador continuo con variable manipulada analógica, proceda del
siguiente modo:
1. Declare en el FB de regulación un parámetro de entrada/salida MAN del tipo de datos
"Real".
MAN se necesita para poner en servicio el regulador con el PID Self-Tuner.
2. En el FB de regulación llame las instrucciones PID, LMNGEN_C y CRP_OUT como
multiinstancia.
3. Declare en el FB de regulación un parámetro de entrada/salida MAN del tipo de datos
"Real" e interconecte MAN con LMNGEN_C.MAN.
4. En el DB de regulación, parametrice el comportamiento del algoritmo regulador en la
estructura PID_Instance, p. ej. si se utilizará la acción D.
5. En la estructura LMNGEN_C_Instance de la multiinstancia parametrice p. ej. los límites de
la variable manipulada y de la velocidad de cambio de la variable manipulada.
6. En la estructura CRP_OUT_Instance de la multiinstancia parametrice el factor y el offset
para la conversión del valor en coma flotante al formato de periferia.
7. Utilizando una variable temporal, interconecte PID.ER con el error de regulación, p. ej.
ROC_LIM.OUTV - CRP_IN.OUTV o ERR_MON.ER.
8. En caso de control anticipativo, interconecte PID.DISV con la señal acondicionada de la
magnitud perturbadora, p. ej. NONLIN.OUTV, utilizando una variable temporal.
9. Utilizando la instrucción BLKMOV, interconecte el parámetro de salida PID.PID_LMNG con
el parámetro de entrada LMNGEN_C.PID_LMNG y el parámetro de salida
LMNGEN_C.LMNG_PID con el parámetro de entrada PID.LMNG_PID.
10.Interconecte LMNGEN_C.LMN con CRP_OUT.INV utilizando una variable temporal.
11.Declare en el FB de regulación un parámetro de salida LMN_PER del tipo de datos "Word"
e interconecte CRP_OUT.OUTV con LMN_PER.
12.Interconecte LMN_PER con la salida analógica de la CPU que controla el actuador.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación CTR_C_FF .

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

953

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

&75B&B))
&20B567
&<&/(



63B*(1
&20B567
&<&/(
2879

')B2879

63B,1





&53B,1
,19B3(5

3,'B/01*

3,'B/01*



2879

&53B,1
,19B3(5



/01

',69
/01*B3,'

',69B3(5

/01*(1B&
&20B567
&<&/(

(5



39B3(5

2879

,19

3,'
&20B567
&<&/(



52&B/,0
&20B567
&<&/(



2879

&53B287 

,19

2879

/01B3(5

/01*B3,'



/,0$/$50
&20B567
,19

/$*67

,19

2879





121/,1

,19

2879

Consulte también
Control anticipativo (Página 951)

Crear un regulador de impulsos
Para un regulador de impulsos, genere una variable manipulada continua en formato de coma
flotante con las instrucciones PID y LMNGEN_C. A partir de esta variable manipulada
continua, genere un tren de impulsos con la instrucción PULSEGEN_M mediante la
modulación de ancho de impulsos.

Generar una variable manipulada continua en formato de coma flotante
1. Declare en el FB de regulación, en este caso PIDCTR, un parámetro de salida LMN del tipo
de datos "Real".
2. En el FB de regulación llame las instrucciones PID y LMNGEN_C y como multiinstancia.

954

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Interconecte y parametrice PID y LMNGEN_C tal como se describe en el regulador
continuo.
4. Interconecte LMNGEN_C.LMN con el parámetro de salida LMN del FB de regulación.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación PIDCTR.
3,'&75
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



'($'%$1'



&<&/(
,19

2879

,19

2879



2879



3,'
&20B567
&<&/(
(5
/01*B3,'

&53B,1



52&B/,0
&20B567

/01*(1B&
&20B567
&<&/(

3,'B/01*

3,'B/01*

/,0$/$50



/01

/01

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Generar un tren de impulsos
Para generar un tren de impulsos a partir de una variable manipulada continua, proceda del
siguiente modo:
1. Cree una función, p. ej. FC50, con los parámetros de entrada COM_RST y CYCLE.
2. Cree un AUTOHOTSPOT en el que se parametrizarán los tiempos de ciclo para la llamada
del FB de regulación y del generador de impulsos PULSEGEN_M.
La relación entre el tiempo de ciclo para la llamada del FB de regulación y PULSEGEN_M
debería ser ≥ 20.
3. Llame la instrucción LP_SCHED_M en la función.
4. Interconecte LP_SCHED_M.DB_NBR con el bloque de datos global DB_LOOP.
5. Llame el FB de regulación, p. ej., PIDCTR, si DB_LOOP.LOOP_DAT[1].ENABLE = TRUE.
6. Interconecte DB_LOOP.LOOP_DAT[1].COM_RST y DB_LOOP.LOOP_DAT[1].CYCLE
con los parámetros de entrada COM_RST y CYCLE del FB de regulación.
7. Defina DB_LOOP.LOOP_DAT[1].ENABLE = FALSE.
Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

955

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
8. Llame la instrucción PULSEGEN_M si DB_LOOP.LOOP_DAT[2].ENABLE = TRUE.
9. Interconecte DB_LOOP.LOOP_DAT[2].COM_RST y DB_LOOP.LOOP_DAT[2].CYCLE
con PULSEGEN_M.COM_RST y PULSEGEN_M.CYCLE.
10.Interconecte PULSEGEN_M.INV con el parámetro de salida LMN del FB de regulación.
11.Interconecte PULSEGEN_M.PER_TM con el parámetro de entrada CYCLE del FB de
regulación.
12.Defina DB_LOOP.LOOP_DAT[2].ENABLE = FALSE.
13.Interconecte PULSEGEN_M.QPOS_P y, dado el caso, PULSEGEN_M.QNEG_P con las
salidas digitales de la CPU que controlan el actuador.
14.Llame la función en el OB 100 y en el OB de alarma cíclica.
2%
2% PV

2%758(
2%)$/6(
7PV

)&
&20B567
&<&/(

)&
/3B6&+('B0
&20B567
&<&/(

&20B567
70B%$6(
'%B/223'%

'%B1%5

'%B/223
*/3B1%5
$/3B1%5
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(



PV
)$/6(
)$/6(
)$/6(
)$/6(
)$/6(
PV
PV
)$/6(
)$/6(
)$/6(
)$/6(
)$/6(
PV

3,'&75
&20B567
&<&/(

/01

38/6(*(1
&20B567
&<&/(

4326B3

3(5B70

41(*B3

,19

956

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Consulte también
Control anticipativo (Página 951)

Crear un regulador paso a paso
Para un regulador paso a paso se necesitan las instrucciones PID y LMNGEN_S.

Procedimiento
Para programar un regulador paso a paso, proceda del siguiente modo:
1. En el FB de regulación llame las instrucciones PID y LMNGEN_S y como multiinstancia.
2. Parametrice el comportamiento del algoritmo regulador en la estructura PID_Instance de
la multiinstancia, p. ej. si se utilizará la acción D.
3. En la estructura LMNGEN_S_Instance de la multiinstancia, parametrice p. ej. que no deben
utilizarse realimentaciones de posición, LMNR_ON = FALSE.
4. Utilizando una variable temporal, interconecte PID.ER con el error de regulación, p. ej.
DEADBAND.OUTV o ERR_MON.ER.
5. En caso de control anticipativo, interconecte PID.DISV con la señal acondicionada de la
magnitud perturbadora, p. ej. CRP_IN.OUTV, utilizando una variable temporal.
6. Utilizando la instrucción BLKMOV, interconecte el parámetro de salida PID.PID_LMNG con
el parámetro de entrada LMNGEN_S.PID_LMNG y el parámetro de salida
LMNGEN_S.LMNG_PID con el parámetro de entrada PID.LMNG_PID.
7. Declare en el FB de regulación los parámetros de salida QLMNUP y QLMNDN del tipo de
datos "Bool".
8. Interconecte LNMGEN_S.QLMNUP y LMNGEN_S. QLMNDN con estos parámetros de
salida.
9. Interconecte los parámetros de salida del FB de regulación con las salidas digitales de la
CPU que controlan el actuador.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación PIDCTR_S.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

957

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3,'&75B6
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



,19



&20B567
&<&/(
,19

2879



'($'%$1'

2879



2879



3,'
&20B567
&<&/(
(5
/01*B3,'

&53B,1



52&B/,0

3,'B/01*

/,0$/$50

/01*(1B6
&20B567
&<&/(

3,'B/01*



4/0183
4/01'1

4/0183
4/01'1

/01*B3,'



&20B567
39B3(5

,19B3(5

2879

,19

Consulte también
Control anticipativo (Página 951)
Acondicionamiento de la realimentación de posición (Página 958)

Acondicionamiento de la realimentación de posición
La configuración de la realimentación de posición depende del actuador utilizado.
● Actuador con realimentación de posición analógica
● Actuador con señales de tope digitales

Requisitos
Debe haberse programado un regulador paso a paso.

Crear un regulador paso a paso con realimentación de posición analógica
Para acondicionar la realimentación de posición analógica se recomiendan las instrucciones
siguientes.
● CRP_IN: escalar valor de periferia
● NONLIN: linealizar realimentación de posición

958

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
● SCALE_M: escalar realimentación de posición
● NORM: normalizar realimentación de posición
Ejemplo de una realimentación de posición analógica
Un actuador proporciona una realimentación de posición en formato de periferia que debe
tenerse en cuenta al calcular la variable manipulada.
1. Declare en el FB de regulación un parámetro de entrada LMNR_PER del tipo de datos
"Word".
2. Interconecte LMNR_PER con la entrada de periferia.
3. En el FB de regulación llame la instrucción CRP_IN como multiinstancia, p. ej. con el
nombre CRP_IN_Instance_LMNR.
4. Interconecte LMNR_PER con CRP_IN.INV_PER.
5. Parametrice el factor y offset de la escala en la estructura CRP_IN_Instance_LMNR de la
multiinstancia.
6. Interconecte CRP_IN.OUTV con LMNGEN_S.LMNR_IN utilizando una variable temporal.
7. En la estructura LMNGEN_S_Instance de la multiinstancia active la realimentación de
posición con LMNR_ON = TRUE.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación PIDCTR_SAF.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

959

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3,'&75B6$)
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1




,19

&20B567
&<&/(
,19

2879



'($'%$1'

2879



3,'
&20B567
&<&/(
(5

2879

/01*B3,'



&53B,1



52&B/,0

3,'B/01*

/,0$/$50

/01*(1B6
&20B567
&<&/(

/015B,1
3,'B/01*



4/0183
4/01'1

4/0183
4/01'1

/01*B3,'



&20B567
39B3(5

,19B3(5

&53B,1

/015B3(5

,19

2879

,19B3(5



2879

Crear un regulador paso a paso con realimentación de posición digital
1. Declare en el FB de regulación los parámetros de entrada LMNR_HS y LMNR_LS del tipo
de datos "Bool".
2. Interconecte los parámetros de entrada LMNR_HS y LMNR_LS con
LMNGEN_S.LMNR_HS y LMNGEN_S.LMNR_LS.
3. En la estructura LMNGEN_S_Instance active la realimentación de posición con
LMNR_ON = TRUE.
La figura siguiente muestra cómo se llaman e interconectan las instrucciones del Modular PID
Control en el FB de regulación PIDCTR_SDF.

960

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3,'&75B6')
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



52&B/,0
&20B567
&<&/(
,19

2879

2879

/015B+6
/015B/6


'($'%$1'


,19



3,'
&20B567
&<&/(
(5

2879

/01*B3,'

&53B,1





/01*(1B6
&20B567
&<&/(
/015B+6
/015B/6

3,'B/01*

/,0$/$50

3,'B/01*



4/0183
4/01'1

4/0183
4/01'1

/01*B3,'



&20B567
39B3(5

,19

2879

,19B3(5

Consulte también
Crear un regulador paso a paso (Página 957)

3.5.2.4

Estructuras de regulador complejas

Regulador de relación monobucle
La figura siguiente muestra un lazo de regulación típico para un regulador de relación
monobucle.
63



5HJXODGRU

/01

6LVWHPD
UHJXODGR

39

39
39

La relación entre dos valores reales se regula en una consigna ajustada con un algoritmo PID.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

961

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para crear un regulador de relación monobucle, proceda del siguiente modo:
1. En el FB de regulación programe el acondicionamiento de los valores reales tal como se
representa abajo.
2. Para evitar una división entre cero, hay que limitar el rango de valores del valor real
PV_PER2 a valores > 0 con la instrucción LIMITER.
La figura siguiente muestra un FB de regulación, en este caso RATIOCTR, para un regulador
de relación monobucle con variable manipulada continua.
5$7,2&75
&20B567
&<&/(
63B5$7,2

(55B021
63

(5

39

,19B3(5

39B3(5

962

,19B3(5



2879

3,'B/01*

3,'B/01*

,19

/,0,7(5
,19



/01*(1B&
&20B567
&<&/(
/01

/01*B3,'

&53B287



2879

&53B,1



(5
/01*B3,'

&53B,1
39B3(5

3,'
&20B567
&<&/(





2879B3(5

/01B3(5



2879

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulador de relación multibucle
La figura siguiente muestra un lazo de regulación típico para un regulador de relación
multibucle.
63

/01

5HJXODGRUSLORWR



(VFDOD

5$7,2B)$&

(VFDOD
5$7,2B)$&
(VFDOD

5$7,2B)$&



5HJXODGRU
VHFXQGDULR



5HJXODGRU
VHFXQGDULR



5HJXODGRU
VHFXQGDULR

/01

/01

/01

6LVWHPD
UHJXODGR

6LVWHPD
UHJXODGR

39

39

39
6LVWHPD
UHJXODGR
39
6LVWHPD
UHJXODGR

Programar un lazo de regulación
Para programar este ejemplo con Modular PID Control, proceda del siguiente modo:
1. Programe un FB de regulación para el regulador piloto, p. ej. PIDCTR_PV.
2. Programe uno o varios FB de regulación para los reguladores secundarios, p. ej.
RB_CTR_S.
3. Programe una función con la que se llamen e interconecten los cuatro reguladores.

Programar el regulador piloto
Para programar el regulador piloto, proceda del siguiente modo:
1. Programe el regulador piloto de acuerdo con sus necesidades, tal como se describe en el
capítulo Programar el FB de regulación (Página 945).
2. Declare en el FB de regulación, en este caso PIDCTR_PV, un parámetro de salida PV del
tipo de datos "Real" en el que se muestre el valor real acondicionado del regulador piloto.
La figura siguiente muestra la interconexión para el regulador piloto siguiendo el ejemplo del
FB de regulación PIDCTR_PV.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

963

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3,'&75B39
&20B567
&<&/(



63B*(1
&20B567
&<&/(
')B2879

63B,1



'($'%$1'



,19

&<&/(
,19

2879

2879



52&B/,0
&20B567
2879



3,'
&20B567
&<&/(
(5
/01*B3,'

/01*(1B&
&20B567
&<&/(

3,'B/01*

3,'B/01*



/01

/01

/01*B3,'
39

&53B,1



/,0$/$50



&20B567
39B3(5

,19B3(5

2879

,19

Programar los reguladores secundarios
Para programar los reguladores secundarios, proceda del siguiente modo:
1. Programe los reguladores secundarios de acuerdo con sus necesidades, tal como se
describe en el capítulo Programar el FB de regulación (Página 945).
2. Declare en el FB de regulación, en este caso RB_CTR_S, un parámetro de entrada
RATIO_FAC del tipo de datos "Int". Con este valor se multiplica la consigna acondicionada,
p. ej. SCALE.OUTV, del regulador secundario.
La figura siguiente muestra la interconexión para el regulador secundario siguiendo el ejemplo
del FB de regulación RB_CTR_S.

964

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

5%B&75B6
&20B567



6&$/(

&<&/(
63B,1

,19

2879

5$7,2B)$&

/015B+6
/015B/6
'($'%$1' 



,19

2879

/01*B3,'

&53B,1
39B3(5

,19B3(5

/015B3(5

,19B3(5



2879

&53B,1



3,'
&20B567
&<&/(
(5

3,'B/01*

/,0$/$50
&20B567


/01*(1B6
&20B567
&<&/(
4/0183
/015B+6 4/01'1
/015B/6
/015B,1
3,'B/01* /01*B3,'

4/0183
4/01'1



,19



2879

Llamar e interconectar reguladores
Para llamar e interconectar los reguladores piloto y secundarios, proceda del siguiente modo:
1. Cree una función, p. ej. FC50, con los parámetros de entrada COM_RST y CYCLE.
2. Llame la instrucción LP_SCHED_M en la función.
3. Cree un AUTOHOTSPOT en el que se parametrizarán el número de reguladores y los
tiempos de ciclo para la llamada del regulador piloto y de los reguladores secundarios.
Los tiempos de ciclo de los reguladores secundarios deben ser iguales o inferiores al
tiempo de ciclo del regulador piloto.
4. Llame el FB de regulación para el regulador piloto, en este caso PIDCTR_PV, si
DB_LOOP.LOOP_DAT[1].ENABLE = TRUE.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

965

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
5. Interconecte DB_LOOP.LOOP_DAT[1].COM_RST y DB_LOOP.LOOP_DAT[1].CYCLE
con los parámetros de entrada COM_RST y CYCLE del regulador piloto.
6. Defina DB_LOOP.LOOP_DAT[1].ENABLE = FALSE.
7. Llame el FB de regulación para el primer regulador secundario, en este caso RB_CTR_S,
si DB_LOOP.LOOP_DAT[2].ENABLE = TRUE.
8. Interconecte DB_LOOP.LOOP_DAT[2].COM_RST y DB_LOOP.LOOP_DAT[2].CYCLE
con COM_RST y CYCLE del regulador secundario.
9. Interconecte el parámetro de salida PV del regulador piloto con el parámetro de entrada
SP_IN del regulador secundario.
10.Defina DB_LOOP.LOOP_DAT[2].ENABLE = FALSE.
11.Repita los cuatro últimos pasos para los dos reguladores secundarios restantes.
Incremente el contador de la matriz para cada regulador.
12.Interconecte las variables manipuladas con las salidas de la CPU.
13.Llame la función en el OB 100 y en el OB de alarma cíclica.
La figura siguiente muestra las llamadas y la interconexión de los reguladores siguiendo el
ejemplo de la función FC50.

966

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
2%
2% PV
2%758(
2%)$/6(
7PV

)&
&20B567
&<&/(

)&
/3B6&+('B0
&20B567
&<&/(

3,'&75B39
3,'&75B39B'%
&20B567
&<&/(

&20B567
&<&/(
'%B/223
'%

'%B1%5

'%B/223'%
*/3B1%5
$/3B1%5
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

39



PV
)$/6(
)$/6(
)$/6(
)$/6(

PV
PV
)$/6(
)$/6(
)$/6(
)$/6(

PV
PV
)$/6(
)$/6(
)$/6(
)$/6(

PV
PV
)$/6(
)$/6(
)$/6(
)$/6(

PV

5%B&75B6
5%B&75B6B'%
&20B567
&<&/(
63B,1

5%B&75B6
5%B&75B6B'%
&20B567
&<&/(
63B,1

5%B&75B6
5%B&75B6B'%
&20B567
&<&/(
63B,1

967

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulador en cascada
La figura siguiente muestra un lazo de regulación típico de un regulador en cascada.
',69

63



5HJXODGRU
SLORWR

/01


5HJXODGRU
VHFXQGDULR

/01

6LVWHPD
UHJXODGR

39

6LVWHPD
UHJXODGR

39

Programar un lazo de regulación
Para programar este ejemplo con Modular PID Control, proceda del siguiente modo:
1. Programe un FB de regulación para el regulador piloto, p. ej. PIDCTR.
2. Programe un FB de regulación para el regulador secundario, p. ej. PIDCTR_SAF.
3. Programe una función con la que se llamen e interconecten los dos reguladores.
4. Llame la instrucción LP_SCHED_M en la función.
5. Cree un AUTOHOTSPOT en el que se parametrizarán el número de reguladores y los
tiempos de ciclo para la llamada del regulador piloto y de los reguladores secundarios.
El tiempo de ciclo del regulador secundario debe ser igual o inferior al tiempo de ciclo del
regulador piloto.
6. Llame el FB de regulación para el regulador piloto si DB_LOOP.LOOP_DAT[1].ENABLE =
TRUE.
7. Interconecte DB_LOOP.LOOP_DAT[1].COM_RST y DB_LOOP.LOOP_DAT[1].CYCLE
con los parámetros de entrada COM_RST y CYCLE del regulador piloto.
8. Defina DB_LOOP.LOOP_DAT[1].ENABLE = FALSE.
9. Llame el FB de regulación para el regulador secundario si
DB_LOOP.LOOP_DAT[2].ENABLE = TRUE.
10.Interconecte DB_LOOP.LOOP_DAT[2].COM_RST y DB_LOOP.LOOP_DAT[2].CYCLE
con COM_RST y CYCLE del regulador secundario.
11.Interconecte el parámetro de salida LMN del regulador piloto con el parámetro de entrada
SP_IN del regulador secundario.
12.Defina DB_LOOP.LOOP_DAT[2].ENABLE = FALSE.
13.Interconecte la variable manipulada del regulador secundario con la salida analógica de la
CPU que controla el actuador.
14.Llame la función en el OB 100 y en el OB de alarma cíclica.
La figura siguiente muestra las llamadas y la interconexión de los reguladores siguiendo el
ejemplo de la función FC50.

968

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
2%
2% PV
2%758(
2%)$/6(
7PV

)&
&20B567
&<&/(

)&
/3B6&+('B0
&20B567
&<&/(

&20B567
&<&/(
'%B/223
'%

'%B1%5

'%B/223'%
*/3B1%5
$/3B1%5
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(
/223B'$7>@0$1B&<&
/223B'$7>@0$1B',6
/223B'$7>@0$1B&567
/223B'$7>@(1$%/(
/223B'$7>@&20B567
/223B'$7>@,/3B&28
/223B'$7>@&<&/(

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019



PV
)$/6(
)$/6(
)$/6(
)$/6(

PV
PV
)$/6(
)$/6(
)$/6(
)$/6(

PV

3,'&75
3,'&75B'%
&20B567
&<&/(
/01

3,'&75B6$)
3,'&75B6$)B'%
&20B567
&<&/(
63B,1

/01B3(5

969

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulador multivariable
La figura siguiente muestra un lazo de regulación típico para un regulador multivariable. Dos
reguladores PID con salida continua se aplican al sistema regulado.
',69
63

63



5HJXODGRU3,'



5HJXODGRU3,'

/01

/01

39
6LVWHPD
UHJXODGR

39

Programar un lazo de regulación
Para programar este ejemplo con Modular PID Control, proceda del siguiente modo:
1. Declare en el FB de regulación, en este caso MUL_CTR, los parámetros de entrada
siguientes:
– COM_RST del tipo de datos "Bool"
– CYCLE del tipo de datos "Time"
– SP_IN1 y SP_IN2del tipo de datos "Real"
– PV_PER1 y PV_PER2 del tipo de datos "Word"
2. Declare en el FB de regulación los parámetros de salida LMN_PER1 y LMN_PER2 del tipo
de datos "Word".
3. Programe para ambos reguladores PID el acondicionamiento de la consigna y el valor real
así como el cálculo de la magnitud manipulada.
4. Para calcular el error de regulación del primer regulador PID, reste el valor real
acondicionado PV_PER1 del producto de la consigna SP_IN1 y la variable manipulada del
segundo regulador PID.
5. Para calcular el error de regulación del segundo regulador PID, reste el valor real
acondicionado PV_PER2 del producto de la consigna SP_IN2 y la variable manipulada del
primer regulador PID.
6. Interconecte las variables manipuladas LMN_PER1 y LMN_PER2 con dos salidas
analógicas que controlen los actuadores.
7. Llame el FB de regulación en el OB 100 y en el OB de alarma cíclica.
La figura siguiente muestra la llamada siguiendo el ejemplo del FB de regulación MUL_CTR.

970

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
2%
2% PV

2%758(
2%)$/6(
7PV

08/B&75
08/B&75B'%
&20B567
&<&/(

La figura siguiente muestra la interconexión de los reguladores siguiendo el ejemplo del FB de
regulación MUL_CTR.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

971

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
08/B&75
&20B567
&<&/(


63B*(1
&20B567
&<&/(
')B2879
2879

63B,1

'($'%$1'



,19




52&B/,0
&20B567
&<&/(
,19
2879



3,'
&20B567
&<&/(
(5

2879



39B3(5

,19B3(5

/,0$/$50
&20B567

'($'%$1'



,19



972

,19B3(5

2879B3(5

/01B3(5

3,'B/01* /01*B3,'



/01*(1B&
&20B567
&<&/(




2879

/,0$/$50
&20B567



/01

/01*B3,' 3,'B/01*

39B3(5

,19




52&B/,0
&20B567
&<&/(
,19
2879

3,'
&20B567
&<&/(
(5

2879

&53B,1

&53B287

,19

2879


63B*(1
&20B567
&<&/(
')B2879
2879

63B,1



/01

/01*B3,' 3,'B/01*

&53B,1

/01*(1B&
&20B567
&<&/(

&53B287
,19



2879B3(5

/01B3(5

3,'B/01* /01*B3,'



,19

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3.5.2.5

Poner en servicio el FB de regulación

Poner en servicio el regulador continuo
El FB de regulación se pone en servicio con el PID Self-Tuner y se determinan los parámetros
PID óptimos.

Procedimiento
Para poner en marcha un regulador continuo o un regulador de impulsos, proceda del siguiente
modo:
1. Llame el FB de regulación en un OB de alarma cíclica e interconecte los parámetros de
entrada y salida.
2. Llame la instrucción TUN_EC en el mismo OB de alarma cíclica.
3. Interconecte la instrucción TUN_EC con el FB de regulación del siguiente modo:
– TUN_EC.PV con el valor real acondicionado, p. ej. la variable estática
CRP_IN_Instance_PV.OUTV o el parámetro de salida PV
– TUN_EC.LMN con la variable manipulada en formato Real, p. ej. la variable estática
LMNGEN_C_Instance.LMN
– TUN_EC.MAN con el parámetro de entrada/salida para el valor manual, p. ej. MAN.
– TUN_EC.SP_OUT con el parámetro de entrada para la consigna, p. ej. SP_IN
– TUN_EC.GAIN con la ganancia proporcional, p. ej. PID_Instance.GAIN
– TUN_EC.TI con el tiempo integrativo, p. ej. PID_Instance.TI
– TUN_EC.TD con el tiempo derivativo, p. ej. PID_Instance.TD
– TUN_EC.TM_LAG con el tiempo de retardo, p. ej. PID_Instance.TM_LAG
4. Haga clic en el símbolo
en la instrucción TUN_EC.
Se abre el editor de puesta en servicio para TUN_EC. El funcionamiento del editor de
puesta en servicio se describe en el PID Self-Tuner.

Poner en servicio el regulador paso a paso
El FB de regulación se pone en servicio con el PID Self-Tuner y se determinan los parámetros
PID óptimos.

Procedimiento
Para poner en servicio un regulador paso a paso, proceda del siguiente modo:
1. Llame el FB de regulación en un OB de alarma cíclica e interconecte los parámetros de
entrada y salida.
2. Llame la instrucción TUN_ES en el mismo OB de alarma cíclica.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

973

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Interconecte la instrucción TUN_ES con el FB de regulación del siguiente modo:
– TUN_ES.PV con el valor real acondicionado, p. ej. la variable estática CRP_IN_Instance
_PV.OUTV o el parámetro de salida PV
– TUN_ES.LMNR_IN con la realimentación de posición acondicionada, p. ej.
LMNGEN_S_instance.LMNR_IN
– TUN_ES.C_LMNUP y TUN_ES.C_LMNDN con las señales de la variable manipulada,
p. ej. los parámetros de salida QLMN_UP y QLMNDN
– TUN_ES.LMNR_HS con la señal del tope superior, p. ej.
LMNGEN_S_Instance.LMNR_HS
– TUN_ES.LMNR_ON con el conmutador de la realimentación de posición, p. ej.
LMNGEN_S_Instance.LMNR_ON
– TUN_ES.SP_OUT con el parámetro de entrada para la consigna, p. ej. SP_IN
– TUN_ES.GAIN con la ganancia proporcional, p. ej. PID_Instance.GAIN
– TUN_ES.TI con el tiempo integrativo, p. ej. PID_Instance.TI
– TUN_ES.TD con el tiempo derivativo, p. ej. PID_Instance.TD
– TUN_ES.TM_LAG con el tiempo de retardo, p. ej. PID_Instance.TM_LAG
– TUN_ES.MTR_TM con el tiempo de posicionamiento del motor, p. ej.
LMNGEN_S_Instance.MTR_TM
– Si se utiliza una zona muerta, TUN_ES.DEADB_W con el ancho de la zona muerta, p.
ej. DEADBAND_Instance.OUTV
– TUN_ES.QLMNUP y TUN_ES.QLMNDN con las señales de la variable manipulada
LMNGEN_S_Instance.LMNUP y LMNGEN_S_Instance.LMNDN
4. Haga clic en el símbolo
en la instrucción TUN_ES.
Se abre el editor de puesta en servicio para TUN_ES. El funcionamiento del editor de
puesta en servicio se describe en el PID Self-Tuner.

3.5.3

Utilizar PID Self Tuner

3.5.3.1

Optimizar el regulador continuo y el regulador de impulsos

Interconectar TUN_EC con el regulador
La instrucción TUN_EC permite crear un regulador continuo o un regulador de impulsos.
Según el regulador, TUN_EC se activa con una de las siguientes instrucciones:

974

Regulador

Instrucción

Reguladores de impulsos FM 355 C, FM 355 S

PID_FM

Reguladores de impulsos FM 455 C, FM 455 S

PID_FM

Funciones básicas PID

CONT_C Con o sin PULSEGEN

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Regulador

Instrucción

Standard PID Control (paquete opcional PID Pro‐
fessional)

PID_CP

Modular PID Control (paquete opcional PID Pro‐
fessional)

PID
LMNGEN_C

Interconecte los parámetros de entrada y salida de la instrucción TUN_EC con la instrucción
del regulador como se describe a continuación.
TUN_EC

PID_FM

CONT_C

PID_CP

PV

PV

PV

PV

LMN

LMN

LMN

LMN

NORM_FAC

--

--

(NM_PVHR-NM_PVLR)*0.01

WRITE_DIS

Operación lógica O con
LOAD_OP y LOAD_PAR

--

--

MAN_OUT

LMN_RE

MAN

MAN

SP_OUT

SP_RE

SP_INT

SP_INT

GAIN

GAIN

GAIN

GAIN

TI

TI

TI

TI

TD

TD

TD

TD

TM_LAG

TM_LAG

TM_LAG

TM_LAG

RATIOFAC

--

--

RATIOFAC

PHASE

--

--

PHASE

QMAN_ON

LMN_REON

MAN_ON

MAN_ON

QI_SEL

--

I_SEL

I_SEL

QD_SEL

--

D_SEL

D_SEL

QWRITE

LOAD_PAR y

--

--

LOAD_OP

Posibilidades de optimización
Optimización inicial
La optimización de los parámetros PID se realiza durante el calentamiento. Para ello se lleva
a cabo una identificación del proceso seguida de un diseño del regulador.
La optimización puede solicitarse con ADAPT1ST.
Si se ajusta ADAPT1ST = TRUE, se ajustará ADAPT_ON = TRUE y la optimización inicial se
llevará a cabo obligatoriamente. En la optimización inicial, el escalón de la variable manipulada
se indica en el parámetro LHLM_TUN.
El parámetro ADAPT1ST solo es necesario si, debido a errores graves durante la adaptación,
se han obtenido parámetros de proceso tan absurdos que el escalón de la variable manipulada
calculado automáticamente no sirve para una nueva adaptación.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

975

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Con ADAPT1ST = TRUE se ejecuta la rutina de inicialización de la instrucción TUN_EC. Se
llevan a cabo los siguientes ajustes predeterminados:
● Se conmuta al regulador PI. Para ello se transfieren al regulador los parámetros de
PI_CON. Si los parámetros PI_CON.GAIN y PI_CON.TI tienen ambos el valor 0.0, se les
asignarán los valores predeterminados PI_CON.GAIN = 1.5 y PI_CON.TI = 3600.0 s.
● PROCESS.GAIN = 999.0
● RATIOFAC = 1.0
● STATUS_H = 0; STATUS_D = 0; STATUS_C = 0
Nota
A menos que desee hacerlo expresamente, en caso de rearranque completo (en caliente)
de la CPU no llame TUN_EC como es habitual con otras instrucciones, pues de lo contrario
se perderán todos los parámetros de proceso.
La optimización se inicia con ADAPT1ST = TRUE, seguido de un escalón de la variable
manipulada ≥ MIN_STEP en sentido positivo.
El escalón de la variable manipulada en la optimización inicial suele saltar desde la consigna
del proceso en frío (temperatura ambiente) hasta la proximidad del punto de operación.
También puede usarse como estado inicial cualquier otra consigna, a condición de que el
proceso se encuentre en un estado estacionario. Durante la optimización no pueden
especificarse más escalones de la variable manipulada.
Evolución de curva en la optimización inicial
r&

3+$6( 
3+$6( 
67$786B+  67$786B+ 
67$786B'  67$786B' 

/+/0B781HQ
3ULPHUDMXVWH
DXWRP£WLFR
YDORU
DMXVWDGRHQ
2SWLPL]DFLµQILQD
HVWDGRHVWDFLRQDULR
HQHOSULPHUDMXVWH
HOHVWDGRGHO
SURFHVRHVSRUOR
JHQHUDOIU¯R
7HPSHUDWXUD
DPELHQWH

3+$6( 
67$786B+ 
67$786B' 

3+$6( 
67$786B+ 
67$786B' 

63

&DOLHQWH
(VWDGRGHOSURFHVR
3XQWRGHRSHUDFLµQ

39
3XQWRGH
LQYHUVLµQ

/01

W
$'$37B21
W

976

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Optimización fina
La optimización fina solo puede realizarse después de una optimización inicial concluida
correctamente. Con ADAPT_ON = TRUE, TUN_EC decide si se llevará a cabo una
optimización inicial o una optimización fina. Si ya se dispone de información acerca del
proceso, TUN_EC calcula automáticamente un escalón de la variable manipulada y lleva a
cabo una optimización fina. Si no existe información acerca del proceso, se realiza una
optimización inicial.

Iniciar optimización
La optimización puede iniciarse tanto desde el modo automático como desde el modo manual.
● Iniciar la optimización desde el modo automático
En el modo automático, active ADAPT_ON o ajuste ADAPT1ST = TRUE y especifique un
salto de consigna ≥ MIN_STEP.
● Iniciar la optimización desde el modo manual
En modo manual, active ADAPT_ON o ajuste ADAPT1ST = TRUE y especifique un escalón
de consigna ≥ MIN_STEP. Cuando, a continuación, se resetee MAN_ON = FALSE , el
escalón de consigna se hará efectivo y la optimización se iniciará.

Optimización de refrigeración
La optimización de refrigeración solo es posible si la optimización inicial ha concluido
correctamente. Se inicia en la PHASE 4. Al ajustar COOLID_ON = TRUE, el regulador pasa a
modo manual y se emite LLLM_TUN: MAN_OUT = LLLM_TUN. TUN_EC pasa a PHASE = 3,
y se vuelve a desactivar inmediatamente COOLID_ON. Tan pronto como se encuentra un
punto de inflexión en la curva del valor real, TUN_EC vuelve al modo de regulación (PHASE =
4). TUN_EC calcula un factor de relación RATIOFAC, cuyo valor se transmite al generador de
impulsos del regulador.
Evolución de curva en la optimización de refrigeración

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

977

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

r&
3+$6( 
67$786B&


3+$6( 
67$786B&


HVWDFLRQDULR
(VWDGR

3+$6( 
67$786B& 

63
39
3XQWRGHLQYHUVLµQ
/01

(VWDGRGHOSURFHVR
IU¯R

W

///0B781


&22/,'B21
W

Nota
● El bit de inicio COOLID_ON puede activarse al mismo tiempo con ADAPT1ST o
ADAPT_ON, así como durante una optimización de los parámetros del regulador. De este
modo, una vez finalizada la optimización de los parámetros del regulador para el
calentamiento, se inicia de inmediato la optimización de refrigeración.
● En una instalación con varias zonas de temperatura acopladas térmicamente (p. ej.
máquinas de transformación de plásticos), la optimización de refrigeración no debe
iniciarse hasta que todas (!) las zonas no hayan finalizado la optimización inicial, ya que de
lo contrario se falsearían los resultados de la optimización inicial.

Cancelar optimización
Para interrumpir la optimización antes del escalón de consigna, es necesario ajustar
ADAPT_ON = FALSE . Para interrumpir la optimización después del salto de consigna
(PHASE 2 o 3) o interrumpir la optimización de refrigeración, debe pasarse a modo manual
(MAN_ON = TRUE).
Al ajustar ADAPT_ON, ADAPT1ST o COOLID_ON durante una optimización en curso (PHASE
2 o 3) la optimización no se interrumpe, sino que se lleva a cabo hasta el final. Dado que no se
desactivan ADAPT_ON, ADAPT1ST ni COOLID_ON, en cuanto se cumplen las condiciones
de inicio se inicia una nueva optimización.

Fases de la optimización
La optimización del regulador se lleva a cabo en varias fases, que se indican en el parámetro
PHASE .

978

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

PHASE = 0
Al crear un DB de instancia para TUN_EC, el parámetro PHASE tiene preasignado el valor cero
y MAN_ON el valor TRUE. Por eso, después del primer ciclo se cambia al modo manual
(PHASE = 7). Desde el modo manual se puede iniciar directamente la optimización inicial
(ADAPT_ON = TRUE) o cambiar al modo automático. En el primer cambio al modo automático
MAN_ON = FALSE, se adoptan los parámetros de PI_CON. Los valores predeterminados para
GAIN y TI son: GAIN = 1.5, TI = 1h.

PHASE = 2
En cuanto se especifica un escalón de consigna ≥ MIN_STEP en sentido positivo hacia el
punto de operación del estado caliente del proceso, en la optimización inicial se preasigna a
MAN_OUT el valor LHLM_TUN, y en la optimización fina se preasigna a MAN_OUT un valor
calculado por TUN_EC. Además se activa QMAN_ON = TRUE. Ambos valores se transmiten
al regulador PID. El regulador PID se controla entonces en modo manual. MIN_STEP debería
ser superior al 10 % del rango de trabajo de consigna y real.

PHASE = 3
Si se detecta el punto de inversión de la respuesta al salto (STATUS_H = 2) o si el valor real
ha alcanzado el 70 % de la intensidad del salto de la consigna (STATUS_H = 3), se diseña un
regulador PI de ajuste cuidado. La ganancia del regulador GAIN se limita al rango entre 0.2 y
20.0. El regulador funciona a partir de ese momento como regulador PI e intenta regular el
proceso a un estado estacionario. TUN_EC guarda los nuevos parámetros de regulador PI en
GAIN, TI y PI_CON. Los valores anteriores del regulador PI se guardan en PI_CON_OLD. Si
el tiempo necesario para alcanzar el estado estacionario es muy prolongado (respuesta
transitoria muy lenta en lazos de regulación de temperatura), ya puede iniciarse el diseño del
regulador con los datos actuales al aproximarse al estado estacionario activando STEADY =
TRUE. El diseño del regulador también se puede iniciar de nuevo con los datos actuales en un
momento posterior, en PHASE = 3 o PHASE = 4, mediante la activación de STEADY = TRUE.
Con frecuencia, así se mejora un poco más el diseño del regulador.
En la optimización inicial, los rebases transitorios o la imposibilidad de encontrar el punto de
inflexión pueden deberse a que se ha seleccionado una altura demasiado grande del escalón
de la variable manipulada LHLM_TUN, y no deben atribuirse necesariamente a un mal ajuste
del regulador. En la siguiente optimización inicial, asigne a LHLM_TUN un valor aprox. un 20%
menor.
Si TUN_EC ha detectado el estado estacionario o ha transcurrido desde el escalón de la
variable manipulada el tiempo 30 × TI (TI: tiempo de integración del regulador PI ajustado en
PHASE = 3), se realiza un diseño mejorado del regulador, y se cambia a PHASE = 4. TUN_ES
guarda los nuevos parámetros de regulador PI/PID en GAIN, TI, TD y PI_CON o PID_CON. Los
valores anteriores del regulador PID se guardan en PID_CON_OLD. A ser posible se diseñan
un regulador PID y un regulador PI. Para PID_ON = TRUE, se activa el regulador PID, o en su
caso el regulador PI. GAIN se limita de manera que la ganancia del lazo abierto (producto de
GAIN por la ganancia del proceso) sea inferior a 80.0.

PHASE = 4
En esta fase el regulador regula con sus parámetros optimizados. Desde este estado se puede
iniciar una optimización de refrigeración, una optimización fina o una optimización inicial.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

979

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Es posible alternar en cualquier momento sin discontinuidad entre el regulador PI y el
regulador PID.

Realizar una optimización inicial
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.
● TUN_EC está interconectado con un regulador continuo o un regulador de impulsos.
● MAN_ON = FALSE
● El regulador está en modo automático.
● El proceso está en estado estacionario.

Procedimiento
Para determinar los parámetros PID óptimos en la primera puesta en servicio, haga lo
siguiente:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimización inicial".
TUN_EC está disponible para la optimización.
3. Seleccione una estructura del regulador.
4. Introduzca en el campo "Variable manipulada" una variable manipulada, que se utilizará
hasta que se pase a la PHASE = 3.
5. En el campo "Consigna", indique una consigna. El escalón de consigna debe ser ≥
MIN_STEP. La variable manipulada no será efectiva hasta que no exista una nueva
consigna.
6. Haga clic en el símbolo
"Iniciar optimización".
La consigna y la variable manipulada se transferirán al regulador. Se iniciará la optimización
inicial. Se mostrará el estado de la optimización.

Realizar optimización fina
Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.
● TUN_EC está interconectado con un regulador continuo o un regulador de impulsos.
● MAN_ON = FALSE
● El regulador está en modo automático.
● El proceso está en estado estacionario.

980

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para determinar los parámetros PID óptimos en el punto de operación, haga lo siguiente:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimización fina".
TUN_EC está disponible para la optimización.
3. Seleccione una estructura del regulador.
4. En el campo "Consigna", indique una consigna. El escalón de consigna debe ser ≥
MIN_STEP.
5. Haga clic en el símbolo
"Iniciar optimización".
Se enviará la nueva consigna al regulador. TUN-EC calculará un escalón de la variable
manipulada. Se iniciará la optimización fina. Se mostrará el estado de la optimización.

Efectuar una optimización de la refrigeración
Durante la optimización de refrigeración se calcula el factor de relación para reguladores con
dos actuadores de acción contrapuesta (p. ej. calentar/enfriar).

Requisitos
● La optimización inicial se ha llevado a cabo correctamente.
● La instrucción y el objeto tecnológico están cargados en la CPU.
● TUN_EC está interconectado con un regulador continuo o un regulador de impulsos.
● MAN_ON = FALSE
● El regulador está en modo automático.
● El proceso está en estado estacionario.

Procedimiento
Para obtener el factor de relación, haga lo siguiente:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimización de la refrigeración".
TUN_EC está disponible para la optimización.
3. Seleccione una estructura del regulador.
4. En el campo "Variable manipulada", introduzca una variable manipulada, que se utilizará
hasta que se encuentre el punto de inflexión.
5. Haga clic en el símbolo
"Iniciar optimización".
Se inicia la optimización de refrigeración. Se mostrará el estado de la optimización.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

981

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Realizar una optimización manual
Si, después de una optimización inicial, se producen oscilaciones en el lazo de regulación
cerrado, o existen rebases transitorios después de escalones de consigna, pueden
modificarse manualmente los parámetros PID. P. ej., puede restablecer la ganancia del
regulador GAIN al 80% del valor inicial, o aumentar el tiempo de integración TI hasta el 150%
del valor ajustado inicialmente. Si se usa un regulador de impulsos, pueden producirse
pequeñas oscilaciones permanentes que se eliminan aumentando la zona muerta DEADB_W.

Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.

Procedimiento
Para determinar manualmente los parámetros PID óptimos, proceda del siguiente modo:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo", seleccione la entrada "Manual".
3. Seleccione una estructura del regulador.
4. Introduzca parámetros PID nuevos en los campos "P", "I" y "D".
5. En el grupo "Optimización", haga clic en el símbolo

"Enviar parámetros al regulador".

6. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna".
7. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
símbolo .
8. En caso necesario, desactive la casilla de verificación "Modo manual".
El regulador trabajará con los nuevos parámetros PID y regulará de acuerdo con la nueva
consigna.
9. Compruebe la calidad de los parámetros PID mediante los recorridos de la curva.
10.Repita los pasos del 3 al 9 hasta obtener una regulación satisfactoria.

3.5.3.2

Optimizar el regulador paso a paso

Interconectar TUN_ES con el regulador
La instrucción TUN_ES permite optimizar un regulador paso a paso. Según el regulador,
TUN_ES se activa con una de las siguientes instrucciones:
Regulador

Instrucción

Regulador paso a paso FM 355 S

PID_FM

Regulador paso a paso FM 455 S

PID_FM

Funciones básicas PID

CONT_S
TCONT_S

982

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Regulador

Instrucción

Standard PID Control (paquete opcional)

PID_ES

Modular PID Control (paquete opcional)

PID
LMNGEN_S

Interconecte los parámetros de entrada y salida de la instrucción TUN_ES con la instrucción
del regulador del modo que se describe a continuación.
TUN_ES

PID_FM

CONT_S

TCONT_S

PID_ES

PV

PV

PV

PV

PV

LMNR

LMN_A

--

--

LMNR_IN

NORM_FAC

--

--

--

(NM_PVHRNM_PVLR)*0.01

C_LMNUP

QLMNUP

QLMNUP

QLMNUP

QLMNUP

C_LMNDN

QLMNDN

QLMNDN

QLMNDN

QLMNDN

LMNR_HS

QLMNR_HS

LMNR_HS

LMNR_HS

LMNR_HS

LMNR_ON

QLMNR_ON

--

--

LMNR_ON

WRITE_DIS

Operación lógica O
con LOAD_OP y
LOAD_PAR

--

--

--

MAN_OUT

LMN_RE

--

--

MAN

SP_OUT

SP_RE

SP_INT

SP_INT

SP_INT o
SP_EXT

GAIN

GAIN

GAIN

GAIN

GAIN

TI

TI

TI

TI

TI

TD

TD

--

--

TD

TM_LAG

TM_LAG

--

--

TM_LAG

MTR_TM

MTR_TM

MTR_TM

MTR_TM

MTR_TM

DEADB_W

DEADB_W

DEADB_W

DEADB_W

DEADB_W

PHASE

--

--

--

PHASE

QMAN_ON

LMN_REON

--

--

MAN_ON

QLMNS_ON

LMNSOPON

LMNS_ON

LMNS_ON

LMNS_ON

QLMNUP

LMNUP_OP

LMNUP

LMNUP

LMNUP

QLMNDN

LMNDN_OP

LMNDN

LMNDN

LMNDN

QI_SEL

--

--

--

I_SEL

QD_SEL

--

--

--

D_SEL

QWRITE

LOAD_PAR y

--

--

--

LOAD_OP

Posibilidades de la optimización
Optimización inicial
La optimización de los parámetros PID se realiza durante el calentamiento. Para ello se lleva
a cabo una identificación del proceso seguida de un diseño del regulador.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

983

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
La optimización inicial puede solicitarse con ADAPT1ST.
Si se ajusta ADAPT1ST = TRUE, entonces ADAPT_ON = TRUE y se cierra la válvula (PHASE
= 1).
Con ADAPT1ST = TRUE se ejecuta la rutina de inicialización de la instrucción TUN_ES. Se
llevan a cabo los siguientes ajustes predeterminados:
● Se conmuta al regulador PI. Para ello se transfieren al regulador los parámetros de
PI_CON. Si los parámetros PI_CON.GAIN y PI_CON.TI tienen ambos el valor 0.0, se les
asignarán los valores predeterminados PI_CON.GAIN = 1.5 y PI_CON.TI = 3600.0 s.
● PROCESS.GAIN = 999.0
● STATUS_H = 0; STATUS_D = 0
Nota
A menos que desee hacerlo expresamente, en caso de rearranque completo (en caliente)
de la CPU no llame TUN_ES como es habitual con otras instrucciones, pues de lo contrario
se perderán todos los parámetros de proceso.
Después de un escalón de consigna ≥ MIN_STEP se mide el tiempo de posicionamiento del
motor y a continuación se lleva a cabo una optimización inicial. En la optimización inicial,
TUN_ES utiliza para la excitación del proceso el parámetro LHLM_TUN, que determina el
escalón de la variable manipulada. En los reguladores paso a paso con realimentación de
posición, se avanza directamente hasta el valor LHLM_TUN. En los reguladores paso a paso
sin realimentación de posición, la servoválvula se abre por completo y se vuelve a cerrar de
nuevo hasta que transcurre la proporción especificada (100 - LHLM_TUN) del tiempo de
posicionamiento del motor.
Optimización inicial con medición del tiempo de posicionamiento del motor para reguladores
paso a paso sin realimentación de posición

984

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
r&

3+$6( 
67$786B+ 
67$786B' 

3+$6( 
67$786B+ 
67$786B' 

/+/0B781HQ
3ULPHUDMXVWH
DXWRP£WLFR
YDORU
DMXVWDGRHQ
2SWLPL]DFLµQILQD

3+$6( 
67$786B+ 
67$786B' 

63

39
3XQWRGH
LQYHUVLµQ

HVWDGRHVWDFLRQDULR
HQHOSULPHUDMXVWH
HOHVWDGRGHO
SURFHVRHVSRUOR
JHQHUDOIU¯R
7HPSHUDWXUD
DPELHQWH

3+$6( 
67$786B+ 
67$786B' 

&DOLHQWH
(VWDGRGHO
SURFHVR
3XQWRGH
RSHUDFLµQ

/01

W
075B70

$'$37B21
W

Optimización fina
La optimización solo se puede iniciar con ADAPT_ON en los reguladores paso a paso con
realimentación de posición. A partir de los valores de proceso anteriores, TUN_ES decide si se
realizará una optimización inicial sin medición del tiempo de posicionamiento del motor o una
optimización fina. Con ADAPT_ON = TRUE seguido de un escalón de consigna ≥ MIN_STEP
en sentido positivo, se inicia la optimización. En ese momento, TUN_ES pasa inmediatamente
a la PHASE = 2 y realiza un escalón de consigna a LHLM_TUN en el caso de la optimización
inicial, o a una variable manipulada calculada automáticamente, en el caso de la optimización
fina.
El escalón de la variable manipulada en la optimización inicial suele saltar desde la consigna
del proceso en frío (temperatura ambiente) hasta la proximidad del punto de operación.
También puede usarse como estado inicial cualquier otra consigna, a condición de que se trate
de un estado estacionario. Durante la optimización no pueden especificarse más escalones de
la variable manipulada.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

985

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Iniciar optimización
La optimización puede iniciarse tanto desde el modo automático como desde el modo manual.
● Iniciar la optimización desde el modo automático
En el modo automático, active ADAPT_ON o ajuste ADAPT1ST = TRUE y especifique un
salto de consigna ≥ MIN_STEP.
● Iniciar la optimización desde el modo manual
En modo manual, active ADAPT_ON o ajuste ADAPT1ST = TRUE y especifique un escalón
de consigna ≥ MIN_STEP. Cuando, a continuación, se resetee MAN_ON = FALSE , el
escalón de consigna se hará efectivo y la optimización se iniciará.

Cancelar optimización
Para interrumpir la optimización antes del escalón de consigna, es necesario ajustar
ADAPT_ON = FALSE . Para interrumpir la optimización después del escalón de consigna
(PHASE 2 o 3) o interrumpir la optimización de refrigeración, debe pasarse a modo manual
(MAN_ON = TRUE = LMNS_ON = TRUE).
Al ajustar ADAPT_ON o ADAPT1ST durante una optimización (PHASE 2 o 3) la optimización
no se interrumpe, sino que se lleva a cabo hasta el final. Dado que no se desactivan
ADAPT_ON ni ADAPT1ST, en cuanto se cumplen las condiciones de inicio se inicia una nueva
optimización.

Fases de la optimización
La optimización del regulador se lleva a cabo en varias fases, que se indican en el parámetro
PHASE .

PHASE = 0
Al crear un DB de instancia para TUN_ES, el parámetro PHASE tiene preasignado el valor cero
y LMNS_ON el valor TRUE. Por eso, después del primer ciclo se cambia al modo manual
(PHASE = 7). Desde el modo manual se puede iniciar directamente la optimización inicial
(ADAPT_ON = TRUE) o cambiar al modo automático. En el primer cambio al modo automático
MAN_ON = FALSE, se adoptan los parámetros de PI_CON. Los valores predeterminados para
GAIN y TI son: GAIN = 1.5, TI = 1h.

PHASE = 1
Una vez que la optimización ha comenzado con ADAPT1ST = TRUE, TUN_ES cierra la
servoválvula (variable manipulada = 0 o LMNS_ON = LMNDN = TRUE) y espera hasta un
escalón positivo de la consigna ≥ MIN_STEP.

PHASE = 2
En el momento en que se especifica un escalón de consigna ≥ MIN_STEP en sentido positivo
hacia el punto de operación del estado caliente del proceso, en la optimización inicial se asigna
a MAN_OUT el valor LHLM_TUN, y en la optimización fina se asigna a MAN_OUT un valor
calculado por TUN_ES. MIN_STEP debe ser mayor que el 10% del rango de trabajo entre
consigna y valor real.

986

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
En la regulación paso a paso con realimentación de posición (LMNR_ON=TRUE), se asigna
a QMAN_ON el valor TRUE. El regulador regula la válvula al valor de MAN_OUT y TUN_ES
calcula el tiempo de posicionamiento del motor MTR_TM.
En la regulación paso a paso sin realimentación de posición, QLMNS_ON y QLMNUP se
ajustan a TRUE y la válvula se mueve hasta el tope superior. Al alcanzar el tope superior
(LMNR_HS =TRUE), TUN_ES calcula el tiempo de posicionamiento del motor y lo transmite al
regulador. A continuación la válvula se cierra hasta el valor de MAN_OUT (QLMNDN = TRUE).

PHASE = 3
Si se detecta el punto de inversión de la respuesta al salto (STATUS_H = 2) o si el valor real
ha alcanzado el 70 % de la intensidad del salto de la consigna (STATUS_H = 3), se diseña un
regulador PI de ajuste cuidado. La ganancia del regulador GAIN se limita al rango entre 0.2 y
20.0. El regulador funciona a partir de ese momento como regulador PI e intenta regular el
proceso a un estado estacionario. TUN_ES guarda los nuevos parámetros de regulador PI en
GAIN, TI y PI_CON. Los valores anteriores del regulador PI se guardan en PI_CON_OLD. Si
el tiempo necesario para alcanzar el estado estacionario es muy prolongado (respuesta
transitoria muy lenta en lazos de regulación de temperatura), ya puede iniciarse el diseño del
regulador con los datos actuales al aproximarse al estado estacionario activando STEADY =
TRUE. El diseño del regulador también se puede iniciar de nuevo con los datos actuales en un
momento posterior, en PHASE = 3 o PHASE = 4, mediante la activación de STEADY = TRUE.
Con frecuencia, así se mejora un poco más el diseño del regulador.
En la optimización inicial, los rebases transitorios o la imposibilidad de encontrar el punto de
inflexión pueden deberse a que se ha seleccionado una altura demasiado grande del escalón
de la variable manipulada LHLM_TUN, y no deben atribuirse necesariamente a un mal ajuste
del regulador. En la siguiente optimización inicial, asigne a LHLM_TUN un valor aprox. un 20%
menor.
Si TUN_ES ha detectado el estado estacionario o ha transcurrido desde el escalón de la
variable manipulada el tiempo 30 × TI (TI: tiempo de integración del regulador PI ajustado en
PHASE = 3), se realiza un diseño mejorado del regulador, y se cambia a PHASE = 4. TUN_ES
guarda los nuevos parámetros de regulador PI/PID en GAIN, TI, TD y PI_CON o PID_CON. Los
valores anteriores del regulador PID se guardan en PID_CON_OLD. A ser posible se diseñan
un regulador PID y un regulador PI. Si PID_ON = TRUE, se activa el regulador PID, de lo
contrario el regulador PI. En procesos complejos, TUN_ES diseña siempre un regulador PI
independientemente de PID_ON. GAINse limita de tal manera que la ganancia del lazo abierto
(producto de GAIN por la ganancia del proceso) sea inferior a 40.0.

PHASE = 4
En esta fase el regulador regula con sus parámetros optimizados. Desde este estado se puede
iniciar una optimización fina o una optimización inicial.
Es posible alternar en cualquier momento sin discontinuidad entre el regulador PI y el
regulador PID.

Realizar una optimización inicial
La optimización inicial de los parámetros del regulador se realiza durante el calentamiento.
Para ello se lleva a cabo una identificación del proceso seguida de un diseño del regulador.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

987

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.
● TUN_ES está interconectado con un regulador paso a paso.
● MAN_ON = FALSE
● El regulador está en modo automático.
● El proceso está en estado estacionario.

Procedimiento
Para determinar los parámetros PID óptimos en la primera puesta en servicio, haga lo
siguiente:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimización inicial".
TUN_ES está disponible para la optimización.
3. Seleccione una estructura del regulador.
4. Introduzca en el campo "Variable manipulada" una variable manipulada, que se utilizará
hasta que se pase a la PHASE = 3.
5. Introduzca una nueva consigna. El escalón de consigna debe ser ≥ MIN_STEP.
6. Haga clic en el símbolo "Iniciar optimización".
Se iniciará la optimización inicial. Se mostrará el estado de la optimización.

Realizar optimización fina
En los reguladores paso a paso con realimentación de posición puede iniciarse una
optimización fina. Si cambia el punto de operación o el comportamiento del proceso, el
regulador puede reoptimizarse online durante un salto positivo de la consigna.

Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.
● TUN_ES está interconectado con un regulador paso a paso.
● MAN_ON = FALSE
● LMNR_ON = TRUE en la instrucción TUN_ES y en el regulador.
● El regulador está en modo automático.
● El proceso está en estado estacionario.

988

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para determinar los parámetros PID óptimos en la primera puesta en servicio, haga lo
siguiente:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo" seleccione la entrada "Optimización fina".
TUN_ES está disponible para la optimización.
3. Seleccione una estructura del regulador.
4. Introduzca una nueva consigna. El escalón de consigna debe ser ≥ MIN_STEP.
5. Haga clic en el símbolo "Iniciar optimización".
Se iniciará la optimización fina. TUN_ES determinará la variable manipulada. Se mostrará
el estado de la optimización.

Realizar una optimización manual
Si, después de una optimización inicial, se producen oscilaciones en el lazo de regulación
cerrado, o existen rebases transitorios después de escalones de consigna, pueden
modificarse manualmente los parámetros PID. P. ej., puede restablecer la ganancia del
regulador GAIN al 80% del valor inicial, o aumentar el tiempo de integración TI hasta el 150%
del valor ajustado inicialmente.

Requisitos
● La instrucción y el objeto tecnológico están cargados en la CPU.
● TUN_ES está interconectado con un regulador paso a paso.
● MAN_ON = FALSE
● El regulador está en modo automático.
● El proceso está en estado estacionario.

Procedimiento
Para determinar manualmente los parámetros PID óptimos, proceda del siguiente modo:
1. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
2. En la lista "Modo", seleccione la entrada "Manual".
3. Seleccione una estructura del regulador.
4. Introduzca parámetros PID nuevos en los campos "P", "I" y "D".
5. En el grupo "Optimización", haga clic en el símbolo "Enviar parámetros al regulador".
6. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

989

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
7. Introduzca una nueva consigna y haga clic en el grupo "Valores actuales", en el
símbolo .
8. En caso necesario, desactive la casilla de verificación "Modo manual".
El regulador trabajará con los nuevos parámetros PID y regulará de acuerdo con la nueva
consigna.
9. Compruebe la calidad de los parámetros PID mediante los recorridos de la curva.
10.Repita los pasos del 3 al 9 hasta obtener una regulación satisfactoria.

3.5.4

Fundamentos de los módulos de regulación

3.5.4.1

Entradas

Introducción
En las entradas analógicas se pueden conectar diferentes tipos de sensores. Las señales de
entrada de los sensores se procesan a continuación según las necesidades.
Las entradas digitales permiten poner el módulo en diferentes modos de operación.
Los reguladores K y S tienen la misma estructura en cuanto a entradas analógicas y digitales.

Número de entradas

990

Entrada

FM 355

FM 355-2

FM 455

Entradas analógicas con acondiciona‐
miento de los valores analógicos

4

4

16

Entrada de unión fría para la compensa‐
ción de termopares

1

1

1

Entradas digitales

8

8

16

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Entradas analógicas
Bloques de función de una entrada analógica
La figura siguiente muestra el esquema para el acondicionamiento de los valores analógicos:
7LSRGHVHQVRU
$

'
)LOWUR

5D¯]
FXDGUDGD

3ROLO¯QHD

9DORU
1RUPDOL]DU DQDOµJLFR
SUHSDUDGR

(QWUDGDGH
UHIHUHQFLD
3DUDPHWUL]DGR

Adaptación a sensores
Las entradas analógicas se pueden adaptar a diferentes sensores mediante su
parametrización. Son posibles los siguientes ajustes:
● La entrada analógica no se procesa (p. ej. entrada no utilizada)
Con este ajuste, todos los parámetros PID se ajustan a cero, el canal de regulación no se
procesa y no se calcula ninguna variable manipulada.
● Sensor de intensidad 0 a 20 mA
● Sensor de intensidad 4 a 20 mA
● Sensor de tensión 0 a 10 V
● Pt 100, –200 ... 850 °C
● Pt 100, –200 ... 556 °C (resolución doble)
● Pt 100, –200 ... 130 °C (resolución cuádruple)
● Termopares tipo B, J, K, R y S (entrada analógica ajustada a ±80 mV)
● Termopar libre (entrada analógica ajustada a ±80 mV)
Las entradas analógicas se parametrizan en la pantalla "Entrada analógica".

Cambio Celsius/Fahrenheit
Las temperaturas se pueden medir tanto en °C como en °F.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

991

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Adaptación a la frecuencia de red
Para suprimir interferencias durante la medición de señales analógicas se puede ajustar el
procesamiento de la señal de entrada a la frecuencia de red. Son posibles los siguientes
ajustes:
● Funcionamiento a 50 Hz
● Funcionamiento a 60 Hz

Unión fría
Si se ha ajustado un termopar como sensor en una entrada analógica, se puede conectar en
la entrada de unión fría del módulo un Pt 100 para compensar la temperatura de referencia en
termopares. De forma alternativa, se puede parametrizar una temperatura de unión frío fija.
En el FM 355 se puede parametrizar opcionalmente una compensación interna para los
termopares J, K y E. Un sensor de temperatura interno mide la temperatura de la unión fría
directamente en el módulo.
Si se utiliza la entrada de unión fría, el tiempo de muestreo de cada regulador se prolonga en
el tiempo de conversión de la entrada de unión fría.

Acondicionamiento de valores analógicos
El acondicionamiento de los valores analógicos ofrece diferentes posibilidades
parametrizables para acondicionar las señales de entrada. La siguiente tabla ofrece una visión
de conjunto de estos parámetros y los valores ajustables.
Parámetro
Resolución

Valores ajustables
● 12 bits

Observaciones
Tiempo de conversión 20 ms (50 Hz)
Tiempo de conversión 162/3 ms (60 Hz)

Filtro

● 14 bits

Tiempo de conversión 100 ms

● On/Off

Filtro de 1er orden cuya respuesta tem‐
poral está determinada por la constante
de tiempo

● Constante de tiempo en s
Raíz cuadrada

● On/Off

Para linealizar señales de encóder en las
que el valor real existe como magnitud
física en relación cuadrática con la mag‐
nitud medida del proceso

Polilínea

● On/Off

Para linealizar curvas características de
encóder

● 13 puntos de apoyo seleccionables
en

Normalización

–

mA con entrada de intensidad

–

mV con entrada de tensión

● Valor superior
● Valor inferior

992

Para la conversión de la señal de entrada
en otra unidad física mediante interpola‐
ción lineal entre el valor inicial (abajo) y el
valor final (arriba)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Nota
Normalización/polilínea: La conversión de la unidad mA o mV en una unidad física se realiza
mediante polilínea o (si esta no está activada) mediante normalización. La polilínea se utiliza
para linealizar un termopar libre o para cualquier linealización.

Copiar parámetros
Los FMs ofrecen en la entrada analógica la posibilidad de transferir parámetros de una entrada
a otra o varias entradas. Todos los parámetros ajustados del canal de salida se transfieren a
los canales de destino.

Entradas digitales
Modos de operación
Las entradas digitales sirven para cambiar los modos de operación de canales de regulación
individuales.
El sentido de acción de las entradas digitales es parametrizable. Para cada entrada digital
individual son posibles los siguientes ajustes:
● High activo
● Low activo o abierto
Se pueden seleccionar los siguientes modos de operación:
● Conmutación a la variable manipulada especificada con el FB PID_FM
● Cambio a modo de seguimiento (variable manipulada especificada mediante una entrada
analógica)
● Conmutación a variable manipulada de seguridad
Con el regulador paso a paso se pueden definir además las siguientes señales a través de
entradas digitales:
● Respuesta: Actuador en tope superior
● Respuesta: Actuador en tope inferior

Optimización paralela
La función "Optimización paralela" sólo está disponible para el FM 355-2.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

993

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Zonas vecinas (fuete acoplamiento térmico)
Si dos o más reguladores de un módulo regulan la temperatura p. ej. de una placa (p. ej. dos
calefacciones y dos valores reales medidos con fuerte acoplamiento de calor), existe la
posibilidad de realizar una optimización paralela para estos reguladores. Proceda del siguiente
modo:
1. Defina los canales conexos en la zona A o la zona B.
2. Inicie la optimización en uno de los canales. La optimización de los canales conexos se
inicia entonces automáticamente.
Nota
Sin embargo, en caso de excitación por escalón de consigna el usuario debe garantizar la
activación simultánea de los escalones de consigna. Con el asistente, los parámetros
PID_ON y TUN_DLMN/TUN_CLMN sólo se pueden especificar para un canal. Los
parámetros para el resto de canales tienen que predefinirse con los correspondientes DBs
de instancia del FB FMT_PID antes de iniciar la optimización.

Cancelación de la optimización
Si aparece un error en uno de los canales (fase 0 o final de la fase 1), se cancela la optimización
de todos los canales.
El usuario puede restablecer la optimización poniendo TUN_ON=FALSE en alguno de los
canales implicados.
Si un canal pasa al modo de seguridad, también se desactiva la optimización de los canales
implicados.
En el asistente sólo se muestra la información de estado del canal seleccionado. Encontrará
las causas de error de los canales restantes en los correspondientes DBs de instancia.

Ventaja
Los reguladores implicados emiten su correspondiente magnitud manipulada de optimización
hasta que todos los reguladores hayan abandonado la fase 2. De esta forma se evita que el
regulador que primero finalice la optimización falsifique el resultado de optimización del resto
de reguladores al modificar su magnitud manipulada.
ATENCIÓN
El hecho de alcanzar el 75% del escalón de consigna en uno de los canales implicados no
finaliza la optimización (peligro de sobreoscilación). El modo automático se inicia cuando
todos los reguladores implicados han finalizado su optimización.

994

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Zonas vecinas (débil acoplamiento térmico)
En general se aplica la norma de que habría que optimizar tal y como se vaya a regular
después. Si en el modo de producción las zonas se recorren juntas en paralelo, de forma que
las diferencias de temperatura entre las zonas se mantienen iguales, durante la optimización
también debería aumentarse correspondientemente el nivel de temperatura de las zonas
vecinas.
Las diferencias de temperatura al inicio del intento no son relevantes ya que se compensan con
una calefacción inicial correspondiente (rampa inicial = 0).

3.5.4.2

Error de regulación

Copiar canales
En un regulador los FMs ofrecen la posibilidad de transferir un canal de regulación a uno o
varios canales. Todos los ajustes del canal de salida se transfieren a los canales de destino.

Tipos de reguladores
En todos los módulos de regulación el error de regulación tiene la misma estructura.
1. La señal del valor real se acondiciona para obtener el valor real efectivo.
2. La señal de la consigna se acondiciona para obtener la consigna efectiva.
3. La consigna efectiva se resta del valor real efectivo.
4. El error de regulación restante se agrega al algoritmo de regulación.
Para la consigna y el valor real se pueden seleccionar los orígenes de regulación, para utilizar
entonces el módulo de regulación como:
● Regulador de valor fijo y en cascada
● Regulador de tres componentes
● Regulador de relación y de mezcla

Regulador de valor fijo y en cascada
En el regulador de seguimiento de una regulación en cascada se selecciona como consigna la
variable manipulada de un regulador piloto.

Regulador de tres componentes
El regulador de tres componentes dispone de tres entradas para el valor real. Los valores
reales A, B y C se suman y dan como resultado el flujo total PV en una regulación de mezcla.
● Regulador de mezcla
Un regulador de mezcla siempre es un regulador de seguimiento. El correspondiente
regulador piloto es un regulador de tres componentes.
La magnitud manipulada del regulador piloto se conecta a través de la entrada Valor real D.
El factor de mezcla se define a través de la entrada de consigna del regulador.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

995

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulador de relación
Un regulador de relación siempre es un regulador de seguimiento. El correspondiente
regulador piloto es un regulador de consigna fija.
Como valor real D se selecciona el valor real del regulador piloto. El factor de proporción se
define a través de la entrada de consigna. Si se ha seleccionado una salida de regulador como
factor de relación, la consigna se convierte (normaliza) al rango de valores "barrera inferior ...
barrera superior" con ayuda de la barrera inferior y superior de "0... 100%".

Regulador de mezcla
Un regulador de mezcla siempre es un regulador de seguimiento. El correspondiente
regulador piloto es un regulador de tres componentes.
Como valor real D se selecciona la magnitud manipulada del regulador piloto. El factor de
mezcla se define a través de la entrada de consigna del regulador.
La magnitud manipulada del regulador del flujo total se indica en el rango de valores 0% a
100%. El regulador de seguimiento convierte esta magnitud del valor real D al rango de valores
del valor real A. El rango de valores del valor real A son los valores de normalización "arriba"
y "abajo" de la entrada analógica seleccionada.
Si la magnitud manipulada de un regulador de seguimiento llega al límite o si el aumento de la
consigna de un regulador de seguimiento está limitado por la función rampa de la rama de
consigna, la acción I del regulador piloto se bloquea en función del sentido (Anti-ResetWindup) hasta que se haya solucionado la causa de la limitación en el regulador de
seguimiento.

Selección de señal para consigna, valor real, entrada D y magnitud perturbadora
Selección de señal
Para la consigna, valor real, valor de la entrada D (entrada de acción D) y magnitud
perturbadora de cada canal de regulación se puede seleccionar entre diferentes orígenes de
regulación. La siguiente tabla muestra una visión de conjunto sobre las posibilidades de
selección de señal.
Tabla 3-2

Selección de señal para consigna, valor real, entrada D y magnitud perturbadora

Valores afectados
Consigna

Origen de señal seleccionable
● Un valor predefinido por el programa de usuario a través del bloque de
función
● El valor analógico acondicionado de una entrada analógica
● La variable manipulada (LMN, LMN_A o LMN_B) de otro canal de
regulación (en conexión en cascada de reguladores)

Valores reales A, B y C

● Cero
● El valor analógico acondicionado de una entrada analógica
(los valores reales B y C se pueden valorar adicionalmente por factores)

996

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Valores afectados
Valor real D

Origen de señal seleccionable
● Cero
● El valor analógico acondicionado de una entrada analógica
● Variable manipulada de otro canal de regulación

Valor para la entrada D
(sólo relevante en regu‐
ladores PD o PID)

● El error de regulación tras la zona muerta del propio canal de regulación

Magnitud perturbadora

● Cero

● El valor analógico acondicionado de una entrada analógica
● El valor real efectivo negado del propio canal de regulación
● El valor analógico acondicionado de una entrada analógica

Acondicionamiento de la consigna
El acondicionamiento de la consigna para obtener una consigna efectiva se puede variar con
las siguientes funciones:

Origen de la consigna
La consigna puede venir dada por:
● Una instrucción
● Una entrada analógica
● Una variable manipulada acondicionada de otro canal de regulación del módulo
Este origen de la consigna se selecciona en un regulador de mezcla o regulador de
seguimiento en una regulación en cascada.
● Una variable manipulada A acondicionada de otro canal de regulación del módulo (sólo FM
355-2)
● Una variable manipulada B acondicionada de otro canal de regulación del módulo (sólo FM
355-2)

Consigna de seguridad
En caso de fallo de la CPU, el módulo puede regular en una consigna de seguridad.
Para ello debe introducirse una consigna de seguridad y ajustarse como reacción en caso de
parada de la CPU "Consigna = Consigna de seguridad".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

997

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Respuesta a fallo de la CPU
En caso de fallo o parada de la CPU el módulo de regulación puede regular en las consignas
siguientes:
● Consigna = última consigna válida
Si como selección de consigna se ha ajustado "por instrucción", la consigna permanece
constante en el último valor indicado tras el fallo de la CPU.
Si la consigna viene determinada por la variable manipulada de un regulador del FM o por
una entrada analógica, se modifica en función del valor seleccionado.
● Consigna = consigna de seguridad
Si se ha indicado una consigna de seguridad, el módulo regula a esta consigna.

Respuesta a arranque del módulo (sólo FM 355 y FM 455)
El módulo de regulación puede regular también a las siguientes consignas en caso de
arranque del módulo:
● Consigna = última consigna válida
● Consigna = consigna de seguridad

Rampa
Seleccionando un tiempo de arranque del valor inicial físico al valor final se puede limitar la
velocidad de modificación de la consigna.

Límites de la consigna
Si la consigna viene dada por el bloque de función o es un valor analógico acondicionado de
una entrada analógica, se limita a un límite inferior y superior especificables.
Si en el regulador de relación se ha seleccionado como consigna la variable manipulada
acondicionada de otro canal de regulación, este valor actúa como factor para la multiplicación
del valor real D. La consigna aplicada a la entrada en % se normaliza en este caso con los
límites inferior y superior.
Si en el regulador de valor fijo o en cascada se utiliza como consigna la variable manipulada
de otro canal de regulación, la consigna se normaliza a un valor físico con las constantes de
normalización del canal de valor real seleccionado.

Multiplicar
Con el tipo de regulador de relación, el valor real A se utiliza como magnitud de regulación y
el valor real D, como magnitud de relación. La entrada de consigna sirve como factor de
relación. Multiplicándolo por el valor real D y sumando un offset ajustable, se obtiene una
consigna efectiva. Si el valor real D se desconecta, entonces sólo se suma el offset a la
consigna.

998

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Acondicionamiento del valor real
El acondicionamiento del valor real para obtener el valor real efectivo depende de la estructura
del regulador.

Valor real efectivo con regulador de valor fijo o en cascada
El valor real efectivo es igual que el valor real A. El origen del valor real A puede ser una entrada
analógica. Los valores reales B, C y D no se tienen en cuenta.

Valor real efectivo en regulador de tres componentes
El valor real efectivo se calcula sumando los valores reales A, B y C, así como un offset
ajustable. Los valores reales B y C se pueden valorar adicionalmente por factores. El valor real
D no se tiene en cuenta.

Valor real efectivo en un regulador de relación
Para un regulador de relación seleccione los siguientes valores reales
● Valor real A: La señal acondicionada de una entrada analógica.
● Valor real D: El valor real del regulador piloto.
El factor de proporción se predetermina como consigna.
Si se ha seleccionado una salida de regulador como factor de proporción FAC, con ayuda de
la barrera inferior y superior de "0... 100%" la consigna se convierte (normaliza) al rango de
valores "barrera inferior ... barrera superior".

Valor real efectivo en reguladores de mezcla
Para un regulador de mezcla seleccione los siguientes valores reales
● Valores reales A, B y C: Señales acondicionadas de las respectivas entradas analógicas.
● Valor real D: El valor real del regulador piloto.
Los factores de proporción de cada uno de los sistemas regulados se definen como consigna.
La magnitud manipulada LMN del regulador del flujo total se indica en el rango de valores "0 ...
100%". El regulador de seguimiento convierte (normaliza) esta magnitud de la entrada Valor
real D al rango de valores "barrera inferior ... barrera superior" del valor real A.
La magnitud manipulada del regulador piloto se aplica a través de la entrada "valor real D" del
regulador de seguimiento. El factor de proporción FAC se define a través de la entrada de
consigna del regulador.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

999

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Alarma
Vigilancia de límites
En el módulo de regulación se lleva a cabo una vigilancia de límites. Esta permite vigilar
● el error de regulación
● o el valor real efectivo
dentro de un límite de advertencia superior e inferior y un límite de alarma superior e inferior.
Además, se puede ajustar una histéresis para estos límites.
La figura siguiente muestra la histéresis del límite de advertencia y de alarma:

/¯PLWHLQIHULRUGH
DGYHUWHQFLDRDODUPD

3.5.4.3

$ODUPDHQWUDQWH
$ODUPDVDOLHQWH
+LVW«UHVLV

/¯PLWHVXSHULRUGH
DGYHUWHQFLDRDODUPD

Algoritmo de regulación

Algoritmo de regulación FM 355-2
Componentes del algoritmo de regulación
El regulador continuo (FM 355-2 C) y el regulador de impulsos (FM 355-2 S) tienen la misma
estructura de algoritmo de regulación. En el regulador paso a paso (FM 355-2 S) no se pueden
seleccionar los botones Enfriar ni Zona de regulación.
La figura siguiente muestra el diagrama de bloques del algoritmo de regulación para
reguladores continuos y reguladores de impulsos:

1000

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
9DORUPDQLSXODGRHIHFWLYR

3,'
(UURUGHUHJXODFLµQ
=RQDPXHUWD

(QIULDU

=RQDGHUHJXODFLµQ

(QWUDGD'

3HUWXUEDFLµQ

Algoritmo de regulación: PID en estructura paralela
En el ciclo del tiempo de muestreo configurado se calcula la magnitud manipulada del
regulador a partir del error de regulación del algoritmo de posición PID. El regulador tiene una
estructura puramente paralela. La acción proporcional, integral o diferencial se puede
desconectar individualmente. En el caso de la acción integral y diferencial esto se realiza
poniendo a cero los correspondientes parámetros TI o TD.
La figura siguiente muestra el algoritmo de regulación del FM 355-2 (estructura en paralelo):
&HUR
3HUWXUEDFLµQ
63
*$,1
(5

3

',69
3B6(/

3)$&B63

;

,



/01

7,
'
7'

Algoritmo de regulación FM 355 y FM 455
Componentes del algoritmo de regulación
En el algoritmo de regulación se pueden seleccionar los siguientes modos de operación:
● Regulador de temperatura (regulador fuzzy con autoajuste)
● Regulador PID
El regulador K y el regulador S tienen la misma estructura del algoritmo de regulación (véase
la figura que sigue a continuación). La figura siguiente muestra el diagrama de bloques del
algoritmo de regulación:

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1001

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

&RQVLJQDHIHFWLYD
9DORUUHDOHIHFWLYR

5HJXODGRUGH
WHPSHUDWXUD

9DORUPDQLSXODGR
HIHFWLYR

3,'
(UURUGHUHJXODFLµQ
=RQDPXHUWD
(QWUDGD'

6HJXLPLHQWRGHYDORUPDQLSXODGR

0DJQLWXGSHUWXUEDGRUD

Algoritmo de regulación y estructura del regulador
En el ciclo del tiempo de muestreo configurado se calcula la magnitud manipulada del
regulador continuo a partir del error de regulación del algoritmo de posición PID. El regulador
tiene una estructura puramente paralela (véase figura inferior). La acción proporcional, integral
o diferencial se puede desconectar individualmente. En el caso de las acciones integral y
diferencial, esto se realiza poniendo a cero los correspondientes parámetros TI o TD.
La figura siguiente muestra el algoritmo de regulación del FM 355 (estructura en paralelo):
',69

*$,1
(5

;

3

',69B6(/

3B6(/

,

'



/01
FRPELQDFLµQOLQHDO

Seleccionar el modo de operación
Selección del modo de operación
Si como tipo de regulador se ha seleccionado la entrada "regulador PID", se puede elegir entre
los diferentes modos de operación:
● P, para materializar un regulador P
● PI, para materializar un regulador PI
● PD, para materializar un regulador PD
● PID, para materializar un regulador PID

1002

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
● I, para materializar un regulador I
● ID, para materializar un regulador ID
● D, para materializar un regulador D

Conmutación suave de manual a automático
Si ha seleccionado la conmutación suave de manual a automático (no con reguladores paso
a paso), el integrador en modo manual se va corrigiendo de tal forma que la magnitud
manipulada no da ningún salto por la acción P y D en la conmutación de manual a automático.
Cualquier error de regulación se corrige siempre lentamente con la acción I. Si no se ha
seleccionado la conmutación suave de manual a automático, en la conmutación de manual a
automático la magnitud manipulada da un salto partiendo del valor manual actual, y el salto se
corresponde con el error de regulación actual. Cualquier error de regulación se corrige
rápidamente.
Nota
En el caso del regulador paso a paso, la conmutación al modo automático siempre se efectúa
de forma brusca. El error de regulación existente produce a través de GAIN un cambio de la
magnitud manipulada interna en forma de escalón. Como la acción del elemento final de
control es integral se obtiene tan solo un control del proceso en forma de rampa.

Control anticipativo
A la señal de salida del regulador se le puede aplicar adicionalmente una magnitud
perturbadora DISV. La activación o desactivación se realiza en la ventana "Error de
regulación" de la herramienta de configuración a través del interruptor "Selección de señal
magnitud manipulada regulador".

Zona muerta
Finalidad de la zona muerta
Existe una zona muerta antepuesta al regulador PID. Con el regulador estabilizado, la zona
muerta suprime el nivel de ruido en la señal del error de regulación que puede producirse por
superposición de la magnitud de regulación o consigna con una señal interferente de alta
frecuencia. De esta forma se evita la oscilación no deseada de la salida del regulador.

Ancho de la zona muerta
El ancho de la zona muerta es ajustable. Si el error de regulación se encuentra dentro del
ancho de zona muerta ajustado, se emite el valor 0 (error de regulación = 0) en la salida de la
zona muerta. Sólo cuando la magnitud de entrada abandona el rango de sensibilidad, la salida
cambia con los mismos valores que la magnitud de entrada.
De esto resulta una falsificación de la señal transmitida incluso fuera de la zona muerta. Sin
embargo, esto se tolera para evitar escalones en los límites de la zona muerta. La falsificación
se corresponde con el valor del ancho de la zona muerta y es, por ello, fácil de controlar.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1003

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
(UURUGHUHJXODFLµQ
HQODVDOLGDGHOD
]RQDPXHUWD

(UURUGHUHJXODFLµQ
HQODHQWUDGDGHOD
]RQDPXHUWD
(5

$QFKRGH]RQDPXHUWD

Figura 3-8

1004

Zona muerta

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulación P
Regulador P
La figura siguiente muestra la respuesta indicial de un regulador P:
39
)XQFLµQGHVDOWRHQOD
HQWUDGDGHOUHJXODGRU

0DJQLWXGGHHQWUDGD

W

/01
5HVSXHVWDLQGLFLDOGHO
UHJXODGRUFRQWLQXR

0DJQLWXGGHVDOLGD

W

/01




5HVSXHVWDLQGLFLDOGHO
UHJXODGRUGHLPSXOVRV

0DJQLWXGGHVDOLGD

W

Fórmula para reguladores P
Las magnitudes de salida y de entrada son directamente proporcionales, es decir:
Modificación de la magnitud de salida = ganancia proporcional x modificación de la magnitud
de entrada
LMN = GAIN x ER

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1005

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulación P
En el regulador P están desconectadas las acciones I y D. Esto quiere decir que en caso de
error de regulación ER = 0, la magnitud manipulada también es = 0. Si se desea ajustar un
punto de operación ≠0, es decir, un valor numérico para la magnitud manipulada en caso de
error de regulación 0, esto se puede realizar a través del punto de operación:
● Punto de operación automático: El regulador pone el punto de operación a la magnitud
manipulada (manual) actual automáticamente durante la conmutación de manual a
automático.
● Punto de operación no automático: Se puede parametrizar el punto de operación.
● Ejemplo: Punto de operación AP = 5% da una magnitud manipulada del 5% en caso de
error de regulación ER = 0.
La figura siguiente muestra un regulador P con ajuste del punto de operación a través del
componente I:
3B6(/

3
*$,1
(5

;

,

$XWRP£WLFR
1RDXWRP£WLFR



/01

3XQWRGHRSHUDFLµQ

La figura siguiente muestra la respuesta indicial del regulador P:
(5
0DJQLWXG
PDQLSXODGD

0DJQLWXGPDQLSXODGD
W

(5 W 
W

1006

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulación PI
Regulador PI
La figura siguiente muestra la respuesta indicial de un regulador PI:
(5

)XQFLµQGHVDOWRHQOD
HQWUDGDGHOUHJXODGRU

0DJQLWXGGHHQWUDGD

W

/01

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUFRQWLQXR

0DJQLWXGGHVDOLGD

W

/01


5HVSXHVWDLQGLFLDOGHO
UHJXODGRUGHLPSXOVRV


0DJQLWXGGHVDOLGD

W

Los reguladores I tienen como magnitud de salida la integral de la magnitud de entrada, es
decir, el regulador suma la diferencia de la consigna en el tiempo. Esto quiere decir que el
regulador va corrigiendo hasta que se elimine la diferencia con la consigna. En la práctica,
según las exigencias en cuanto a la respuesta del regulador, lo ideal es una combinación de
los diferentes temporizadores. La respuesta de tiempo de cada uno de los componentes se
Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1007

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
puede describir con los parámetros de regulación de ganancia proporcional GAIN, tiempo de
acción integral TI (acción I) y tiempo de la acción derivada TD (acción D).

Fórmula para reguladores PI
Para la respuesta indicial del regulador PI en el rango temporal rige lo siguiente:

t = tiempo desde el escalón de la magnitud de entrada

Regulación PI
En el regulador PI está desconectada la acción D (TD=0.0). Un regulador PI modifica la
magnitud de salida con la acción I hasta que el error de regulación sea ER = 0. Sin embargo,
esto sólo es aplicable cuando la magnitud de salida no rebasa los límites de la zona regulada.
Si se rebasan los límites de la variable manipulada, la acción I mantiene el valor alcanzado en
el límite en (Anti-Reset-Windup).
(5
0DJQLWXG
PDQLSXODGD

0DJQLWXG W
PDQLSXODGD

*$,1 (5 
*$,1 (5 W 
(5 W 

*$,1 (5 

W
7,

1008

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulación PD
Regulador PD
La figura siguiente muestra la respuesta indicial de un regulador PD:
(5
)XQFLµQGHVDOWRHQOD
HQWUDGDGHOUHJXODGRU

/01

0DJQLWXGGH
HQWUDGD

70B/$*

0DJQLWXGGHVDOLGD

W

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUFRQWLQXR

W

/01

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUGHLPSXOVRV



0DJQLWXGGHVDOLGD

W

Los reguladores D no son adecuados para la regulación si funcionan solos, ya que dejan de dar
órdenes para el elemento final de control cuando la magnitud de entrada regresa a un valor
estático.
En combinación con reguladores P, la acción D se utiliza para generar un impulso de control
adecuado según la velocidad de modificación de la magnitud de regulación. Si en el sistema
regulado actúa una perturbación z, el regulador PD cambia a otro error de regulación debido
al cambio del grado de regulación. Las perturbaciones no se eliminan por completo. El
comportamiento beneficioso es el bueno y dinámico. Durante la aproximación y la modificación
de las consignas se alcanza una transición bien amortiguada y sin vibraciones. Sin embargo,

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1009

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
un regulador con acción D no es apropiado si el sistema regulado tiene magnitudes de
medición pulsantes, p. ej. en la regulación de presión o de caudal.

Fórmula para reguladores PD
Para la respuesta indicial del regulador PD en el dominio temporal rige lo siguiente:

/01

*$,1(5 



7'
70B/$*

 H

ದW
70B/$*

t = tiempo desde el escalón de la magnitud de entrada

Regulación PD
En el regulador PD está desconectada la acción I (TI=0.0). Esto quiere decir que en caso de
error de regulación ER = 0, la señal de salida también es = 0. Si se desea ajustar un punto de
operación ≠0, es decir, un valor numérico para la magnitud manipulada en caso de error de
regulación 0, esto se puede realizar a través del punto de operación:
● Punto de operación automático: El regulador pone el punto de operación a la magnitud
manipulada (manual) actual automáticamente durante la conmutación de manual a
automático.
● Punto de operación no automático: Se puede parametrizar el punto de operación.
El regulador PD reproduce la magnitud de entrada ER(t) proporcionalmente sobre la señal de
salida y añade la acción D creada por la diferenciación de ER(t), que se calcula con el doble
de precisión según la regla del trapecio (aproximación de Padé). La respuesta de tiempo
(fuerza de la acción D o superficie de regulación) se determina por el tiempo de la acción
derivada TD (tiempo de acción derivada).
Para el filtrado de la señal y la supresión de señales perturbadoras, la acción D se realiza
mediante un retardo de primer orden (constante de tiempo ajustable: TM_LAG). La mayoría de
las veces es suficiente con un valor pequeño para TM_LAG, para alcanzar el resultado
deseado.
Cuanto mayor seleccione el factor derivativo D_F,
● menor será la constante de tiempo efectiva TD/D_F del retardo y
● mayor será la variable manipulada máxima al inicio y
● mejor la respuesta del regulador y
● mayor también la sensibilidad a ruidos.
D_F se limita al rango de valores entre 5,0 y 10,0.

1010

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
(5
0DJQLWXG
PDQLSXODGD

*$,1 

0DJQLWXG W 
PDQLSXODGD

7'
(5
70B/$*

(5 W 

*$,1 (5 
70B/$*

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

W

1011

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulación PID
Regulador PID
La figura siguiente muestra la respuesta indicial de un regulador PID:
(5

)XQFLµQGHVDOWRHQOD
HQWUDGDGHOUHJXODGRU

W

0DJQLWXGGHHQWUDGD

/01

70B/$*

0DJQLWXGGHVDOLGD

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUFRQWLQXR

W

7Q
/01

5HVSXHVWDLQGLFLDOGHO
UHJXODGRUGHLPSXOVRV

0DJQLWXGGHVDOLGD

W

La mayoría de regulaciones que se aplican en la técnica de procesos se puede controlar con
un regulador con comportamiento PI. En sistemas regulados lentos con grandes tiempos de

1012

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
retardo, p. ej. regulaciones de temperatura, el resultado de la regulación se puede mejorar con
un regulador con comportamiento PID.
La figura siguiente muestra la respuesta indicial con distintos comportamientos del regulador:
39


5HVSXHVWDWUDQVLWRULD
VLQUHJXODGRU

3,'

63

3'


W

Los reguladores con comportamiento PI y PID tienen la ventaja de que tras la fase de
estabilización la magnitud de regulación no presenta ninguna diferencia respecto a la
consigna. La magnitud regulada oscila sobre la consigna durante la aproximación.

Fórmula para reguladores PID
Para la respuesta indicial del regulador PI en el dominio temporal rige lo siguiente:

/01

*$,1(5 



W
7,



7'
70B/$*

 H

ದW
70B/$*

t = tiempo desde el escalón de la magnitud de entrada

Regulación PID
En el regulador PID están conectadas la acción P, I y D. Un regulador PID modifica la magnitud
de salida con la acción I hasta que el error de regulación sea ER = 0. Sin embargo, esto sólo
es aplicable cuando la magnitud de salida no rebasa los límites de la zona regulada. Si se
rebasan los límites de la variable manipulada, la acción I mantiene el valor alcanzado en el
límite en (Anti-Reset-Windup).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1013

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
El regulador PID reproduce la magnitud de entrada ER(t) proporcionalmente sobre la señal de
salida y añade los componentes creados por la diferenciación e integración de ER(t). La
respuesta de tiempo se determina por el tiempo de la acción derivada TD (tiempo de la acción
derivada) y el tiempo de integración TI (tiempo de acción integral).
Para el filtrado de la señal y la supresión de señales interferentes, la acción D se realiza a
través de un retardo de primer orden.
Cuanto mayor seleccione el factor derivativo D_F,
● menor será la constante de tiempo efectiva TD/D_F del retardo y
● mayor será la variable manipulada máxima al inicio y
● mejor la respuesta del regulador y
● mayor también la sensibilidad a ruidos.
D_F se limita al rango de valores entre 5,0 y 10,0.
(5
0DJQLWXGPDQLSXODGD

*$,1

0DJQLWXGPDQLSXODGD
W

7'
(5 
70B/$*

*$,1 (5 
*$,1 (5 
70B/$*
7,

*$,1 (5 W
W

3,BRXW W

Regulación I
Regulador I
Para realizar una regulación I se puede desconectar la acción P. Esto también es posible con
el parámetro P_SEL del módulo de función PID_FM.

1014

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Acción P
Atenuación de la acción P en caso de modificaciones de la consigna
Para evitar sobreoscilaciones del valor real o desviaciones importantes de la variable
manipulada, la acción P se puede atenuar con el parámetro Factor proporcional en caso de
modificaciones de la consigna (PFAC_SP). Con PFAC_SP se puede seleccionar de forma
continua entre 0.0 y 1.0 cómo debe actuar la acción P en caso de modificaciones de la
consigna:
● PFAC_SP=1.0: La acción P es totalmente efectiva cuando se cambia la consigna
● PFAC_SP=0,0: La acción P no es efectiva cuando se cambia la consigna.
En el FM355-2 existen dos posibilidades de limitar la velocidad de una modificación de la
consigna:
● Activar rampa (> 0,0 s)
● Factor de modificación de la consigna < 1,0
Utilice sólo una de las dos limitaciones. Si se activan simultáneamente ambas limitaciones, en
caso de un escalón de la consigna aparece una modificación de la variable manipulada inversa
a la modificación de la consigna (respuesta indicial).

Particularidades en el regulador paso a paso
Un valor de PFAC_SP < 1,0 puede reducir las sobreoscilaciones si el tiempo de
posicionamiento del motor MTR_TM es corto frente al tiempo de estabilización TA y la relación
TU/TA es <0,2. Si MTR_TM alcanza el 20% de TA, ya sólo se podrá alcanzar una ligera mejora.

Inversión del efecto del regulador
La inversión, es decir, el cambio del regulador de la asignación
● error de regulación ascendente = magnitud manipulada ascendente
a
● error de regulación ascendente = magnitud manipulada descendente
se consigue ajustando una ganancia proporcional negativa (GAIN). El signo de este valor de
parámetro determina el sentido de acción del regulador.

Acción D
Acción D en la rama de realimentación
Para evitar desviaciones en forma de impulso en la acción D de la magnitud manipulada en
caso de modificaciones de la consigna, se puede colocar la acción D en la rama de
realimentación.
En esta estructura sólo se conecta a la acción D la magnitud de regulación negativa (factor =
-1). En la acción D, la conmutación a la realimentación se lleva a cabo en la ventana "Error de

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1015

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
regulación" con el interruptor "Entrada D regulador" seleccionando como señal de entrada el
valor real efectivo negado.
Nota
Si se coloca la acción D en realimentación, también debe reducirse PFAC_SP, de lo contrario,
aumenta la sobreoscilación del valor real.

La figura siguiente muestra el algoritmo de regulación con acción D en la rama de
realimentación:
*$,1
(5

;

ಥ
39

;

;

3
,



/01

'

Acción P/D
Acción P/D en la rama de realimentación
En la estructura paralela, cada acción del algoritmo de regulación recibe el error de regulación
como señal de entrada. En esta estructura los escalones de consigna actúan directamente en
el regulador. La magnitud manipulada se modifica inmediatamente a través de la acción P y D
por escalones de la consigna.
Sin embargo, otra estructura del regulador en la que la formación de la acción P y D se traslada
a la realimentación, garantiza un transcurso suave de la magnitud manipulada en caso de
variaciones del escalón de la consigna (véase la siguiente figura).
En esta estructura la acción I procesa el error de regulación como señal de entrada, en la
acción P y D sólo se conecta la magnitud de regulación negativa (factor = -1). En la acción D,
la conmutación a la realimentación se lleva a cabo en la ventana "Error de regulación" con el
interruptor "Entrada D regulador" seleccionando como señal de entrada el valor real efectivo
negado.
La figura siguiente muestra el algoritmo de regulación con acción D en la rama de
realimentación:
*$,1
(5

;


39

;

,
3



/01

;
'

1016

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Módulo de regulación de temperatura por lógica difusa
Regulador de temperatura
El regulador de temperatura es un regulador fuzzy con autoajuste que, tras identificar el
sistema regulado, trabaja con parámetros de regulación determinados por él mismo.
En los reguladores de temperatura son posibles los siguientes ajustes:
● Regulador de enfriamiento
● Regulador de calefacción
● Agresividad
Con el parámetro Agresividad se puede modificar la velocidad del comportamiento
transitorio.
Valores posibles para la agresividad

3.5.4.4

-1 ≤ agresividad < 0

Comportamiento transitorio más lento que determinado me‐
diante identificación

Agresividad = 0

Comportamiento de estabilización como determinado median‐
te identificación

0 < agresividad ≤ 1

Comportamiento transitorio más rápido que determinado me‐
diante identificación

Salida del regulador

Diferencias de los reguladores
Básicamente los reguladores FM 355, FM 355-2 y FM 455 pueden dividirse en dos tipos: en
reguladores paso a paso y reguladores continuos. Los reguladores paso a paso van
acompañados de una S complementaria, a saber, FM 355 S, FM 355-2 S y FM 455 S, mientras
que los reguladores continuos van acompañados de una C, a saber, FM 355 C, FM 355-2 C y
FM 455 C. El restante funcionamiento de los módulos de regulación no se diferencia, un
FM 355 S y un FM 355 C poseen algoritmos idénticos. Las diferencias se encuentran en la
salida del regulador.

Regulador paso a paso
El regulador continuo paso a paso posee salidas digitales. De este modo, una válvula de
control sólo puede activarse a través de las señales "abierta" o "cerrada". Por ejemplo, si una
válvula de control se regula al 50% de la capacidad, esto sólo puede conseguirse si se efectúa
un ajuste igual de largo de "abierta" y "cerrada".
Encontrará más información acerca de los reguladores paso a paso en los puntos siguientes:
● Salidas digitales del regulador (Página 1019)
● Regulador paso a paso con realimentación de posición (Página 1020)
● Regulador paso a paso con realimentación de posición (Página 1020)
● Regulador de impulsos (Página 1020)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1017

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Regulador continuo
El regulador continuo paso a paso posee salidas analógicas. Así pues, una válvula de control
no sólo puede estar "abierta" o "cerrada", sino que también puede abrirse en determinadas
proporciones. Por ejemplo, si una válvula de control se regula al 50% de la capacidad, el
módulo de regulación emite el valor "50%" y la válvula se abre a la mitad.
Encontrará más información acerca de los reguladores continuos en los puntos siguientes:
● Salidas analógicas del regulador (Página 1018)
● Regulador continuo (Página 1019)

Salidas analógicas del regulador
Salidas analógicas
Para cada salida analógica se pueden parametrizar las siguientes funciones:
● Origen de la señal
● Tipo de señal

Selección del origen para la señal en las salidas analógicas
Con la selección del origen de la señal se puede determinar qué valor de señal se emite en la
correspondiente salida analógica.
Se pueden parametrizar los siguientes orígenes de la señal:
● El valor cero
● El valor analógico âcondicionado de una de las entradas analógicas
● La variable manipulada A de uno de los canales de regulación
● La variable manipulada B de uno de los canales de regulación
El FM 355 y el FM 355-2 tienen cuatro entradas analógicas y cuatro canales de regulación cada
uno.
El FM 455 tiene 16 entradas analógicas y 16 canales de regulación.

Tipo de señal en las salidas analógicas
Para cada salida analógica se puede determinar el tipo de señal.
Se pueden parametrizar los siguientes tipos de señal:
● Salida de intensidad 0 ... 20 mA
● Salida de intensidad 4 ... 20 mA
● Salida de tensión 0 ... 10 V
● Salida de tensión -10 ... 10 V

1018

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Salidas digitales del regulador
Salidas digitales del regulador
Las salidas digitales del regulador sirven para controlar elementos finales de control
integradores o no integradores.
Para cada salida digital se pueden parametrizar las siguientes funciones:
● Tipo de salida
● Selección de señal
● Procesamiento de señal

Tipo de salida de la señal en la salida digital
Para cada salida digital se puede determinar el tipo de señal.
Los siguientes tipos de señales están disponibles:
● Regulador paso a paso sin entrada de realimentación de posición
● Regulador paso a paso con entrada de realimentación de posición
● Regulador de impulsos

Selección de señal
Según el tipo de señal en la salida, se pueden parametrizar diferentes valores para la selección
de la señal:
● Variable manipulada externa (Página 1021)
● Modo de seguimiento (Página 1021)
● Entrada de realimentación de posición (Página 1022)
● Variable manipulada de seguridad (Página 1024)

Procesamiento de señal
Según el tipo de señal en la salida, se pueden parametrizar diferentes valores para el
procesamiento de la señal:
● Límite señal de salida (Página 1024)
● Rango partido (Página 1025)
● Formador de impulsos (Página 1027)

Regulador continuo
Tipo de señal en las salidas digitales
Los siguientes parámetros sólo se pueden ajustar en un módulo analógico.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Parámetros ajustables
● Activar variable manipulada externa (Página 1021)
● Activar modo de seguimiento (Página 1021)
● Ajustar variable manipulada de seguridad (Página 1024)
● Limitar la variable manipulada (Página 1024)
● Controlar dos actuadores (Página 1025)
● Seleccionar señal de salida y tipo de señal (Página 1028)

Regulador paso a paso con realimentación de posición
Tipo de señal en las salidas digitales
Los siguientes parámetros sólo se pueden ajustar en un módulo digital.

Parámetros ajustables
● Activar variable manipulada externa (Página 1021)
● Ajustar variable manipulada de seguridad (Página 1024)
● Formador de impulsos (Página 1027)

Regulador paso a paso con realimentación de posición
Tipo de señal en las salidas digitales
Los siguientes parámetros sólo se pueden ajustar en un módulo digital.

Parámetros ajustables
● Activar variable manipulada externa (Página 1021)
● Activar modo de seguimiento (Página 1021)
● Ajustar variable manipulada de seguridad (Página 1024)
● Limitar la variable manipulada (Página 1024)
● Ajustar realimentación de posición (Página 1022)
● Formador de impulsos (Página 1027)

Regulador de impulsos
Tipo de señal en las salidas digitales
Los siguientes parámetros sólo se pueden ajustar en un módulo digital.

1020

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Parámetros ajustables
● Activar variable manipulada externa (Página 1021)
● Activar modo de seguimiento (Página 1021)
● Ajustar variable manipulada de seguridad (Página 1024)
● Limitar la variable manipulada (Página 1024)
● Preparar señal analógica para la conversión a una señal digital (Página 1025)
● Convertir señal analógica en señal digital (Página 991)

Funciones de la salida del regulador
Variable manipulada externa
Resumen
En la salida del regulador se han implantado varias posibilidades de interconexión para la
variable manipulada, la entrada de corrección y la variable manipulada de seguridad
(conmutación de variable manipulada).
Para evitar que la variable manipulada pueda aceptar valores no admisibles para el proceso,
se ha previsto una limitación.

Activar variable manipulada externa
La conmutación entre la variable manipulada externa y la variable manipulada efectiva del
regulador se realiza de manera alternativa por
● un valor binario del bloque de función
● una señal que se produce por combinación lógica con O de un valor binario del bloque de
función y una entrada digital

Modo de seguimiento
Resumen
La corrección de la variable manipulada evita un salto de la variable manipulada durante la
conmutación de manual a automático.
En la conmutación de manual a automático la variable manipulada permanece inalterada. La
corrección de la variable manipulada no está activa si se realiza un regulador P puro con punto
de operación fijo (en la máscara Regulador PID no está seleccionada la opción "automático").

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1021

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Entrada de corrección
Existen los siguientes ajustes alternativos:
● La entrada de corrección tiene el valor cero
● La entrada de corrección es el valor analógico acondicionado de una entrada analógica

Activar seguimiento
La conmutación entre variable ipulada y entrada de corrección se realiza alternativamente por
● un valor binario del bloque de función
● una señal que se produce por combinación lógica con O de un valor binario del bloque de
función y una entrada digital

Realimentación de posición
Resumen
La entrada de realimentación de posición sólo está disponible en reguladores S.

Entrada de realimentación de posición
Existen los siguientes ajustes alternativos:
● La entrada de realimentación de posición tiene el valor cero
● La entrada de realimentación de posición es el valor analógico acondicionado de una
entrada analógica

1022

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

salida del regulador paso a paso
La figura siguiente muestra el esquema de la salida del regulador S (modo de operación
Regulador paso a paso con realimentación de posición)
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDU
YDORU
PDQLSXODGR
H[WHUQR

9DORU
PDQLSXODGR
$FWLYDU
VHJXLPLHQWR

$FWLYDUYDORU /LPLWDU
PDQLSXODGR
GHVHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

(QWUDGDGHFRUUHFFLµQ

6HJXLPLHQWRGHYDORUPDQLSXODGR

(QWUDGDGHUHVSXHVWDGHSRVLFLµQ

La figura siguiente muestra el esquema de la salida del regulador S (modo de operación
Regulador paso a paso sin realimentación de posición)
9DORUPDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDUYDORU
PDQLSXODGR
H[WHUQR

$FWLYDUYDORU
PDQLSXODGR
GHVHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

En el regulador paso a paso sin realimentación de posición analógica, la variable manipulada
externa y la variable manipulada de seguridad actúan de la siguiente manera:
Si se asigna un valor entre 40,0% y 60,0%, entonces no se activa ninguna salida binaria y el
elemento final de control permanece sin cambios.
Si se establece un valor > 60,0%, se devuelve "Señal de posicionamiento alta" hasta que se
active la realimentación "Actuador en tope superior".
Si se establece un valor < 40,0%, se emite "Señal de posicionamiento baja" hasta que la
realimentación accede a "Actuador en tope inferior".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1023

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Variable manipulada de seguridad
Resumen
En la salida del regulador se han implantado varias posibilidades de interconexión para la
variable manipulada, la entrada de corrección y la variable manipulada de seguridad
(conmutación de variable manipulada).

Conmutar a variable manipulada de seguridad
● Determinación de la variable manipulada de seguridad
● Reacción alternativa del módulo de función al arrancar:
– El módulo de función pasa a lazo cerrado.
– Como variable manipulada se devuelve la variable manipulada de seguridad
● La conmutación a la variable manipulada de seguridad se realiza de forma alternativa por
– un valor binario del bloque de función
– una señal que se produce por combinación lógica con O de un valor binario del bloque
de función y una entrada digital
● Respuesta a fallo del transductor de medida del valor real A:
– Con el ajuste "Lazo cerrado", el modo de operación del regulador permanece sin
cambios
– Con el ajuste "Variable manipulada = variable manipulada de seguridad" se conmuta a
la variable manipulada de seguridad
● Reacción en caso de fallo del transductor de medida de una entrada analógica:
– Con el ajuste "Lazo cerrado", el modo de operación del regulador permanece sin
cambios
– Con el ajuste "Variable manipulada = variable manipulada de seguridad" se conmuta a
la variable manipulada de seguridad

Limitación de la variable manipulada
Resumen
Para evitar que la variable manipulada pueda aceptar valores no admisibles para el proceso,
se ha previsto una limitación.

Limitación de la variable manipulada
● Limitación superior e inferior (no puede desactivarse)

1024

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Rango partido
Resumen
La función de rango partido genera a partir de la variable manipulada como señal de entrada
dos señales de salida normalizables: variable manipulada A y variable manipulada B. De esta
forma se pueden controlar p. ej. dos válvulas con una variable manipulada.

Formación de los valores de rango partido
● On/Off (sólo reguladores K)
● Valor inicial y valor final señal de entrada
● Valor inicial y valor final señal de salida

Rango partido
Con la función de rango partido se pueden controlar dos válvulas de control con una magnitud
manipulada. La función de rango partido genera a partir de la variable manipulada LMN como
señal de entrada las dos señales de salida variable manipulada A y variable manipulada B.
La figura siguiente muestra el efecto de los parámetros para la salida de la variable manipulada
A:
6H³DOGHVDOLGD
YDORUPDQLSXODGR$

)LQDOGHO£UHDGHOD
VH³DOGHVDOLGD

,QLFLRGHO£UHDGHOD
VH³DOGHVDOLGD

,QLFLRGHO£UHDGHOD
VH³DOGHHQWUDGD

6H³DOGHHQWUDGD
YDORUPDQLSXODGR
/01
)LQDOGHO£UHDGHOD
VH³DOGHHQWUDGD

La figura siguiente muestra el efecto de los parámetros para la salida de la variable manipulada
B:

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1025

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
6H³DOGHVDOLGD
YDORUPDQLSXODGR%
,QLFLRGHO£UHDGHOD
VH³DOGHVDOLGD

)LQDOGHO£UHDGHOD
VH³DOGHVDOLGD

,QLFLRGHO£UHDGHOD
VH³DOGHHQWUDGD

)LQDOGHO£UHDGHOD
VH³DOGHHQWUDGD

6H³DOGHHQWUDGD
YDORUPDQLSXODGR
/01

El inicio del área de la señal de entrada tiene que ser inferior que el final del área de la señal
de entrada.

Rango partido/formador de impulsos
La función de rango partido es la preparación de la señal analógica para la conversión en una
señal binaria.
En un regulador de dos puntos (p. ej. un regulador de calefacción) sólo es relevante la variable
manipulada A. La conversión de la variable manipulada en la variable manipulada A se
representa en la siguiente figura. La conversión en una señal de salida binaria se realiza de
manera que, en la salida digital correspondiente, la relación entre el ancho de impulso y la
duración del periodo se corresponda con la variable manipulada A.
Por ejemplo, una variable manipulada A del 40% con una duración del periodo de 60 segundos
da un ancho de impulso de 24 segundos y una longitud de pausa de 36 segundos.
La figura siguiente muestra la función de rango partido en un regulador de dos puntos:
6H³DOGHVDOLGD
YDORUPDQLSXODGR$
)LQDOGHO£UHDGHOD
VH³DOGHVDOLGD

,QLFLRGHO£UHDGHOD
VH³DOGHVDOLGD

1026

6H³DOGHHQWUDGD
YDORUPDQLSXODGR
,QLFLRGHO£UHDGHOD )LQDOGHO£UHDGHOD /01
VH³DOGHHQWUDGD
VH³DOGHHQWUDGD

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

En un regulador de tres puntos (p. ej. un regulador de calefacción y enfriamiento) se aplican las
afirmaciones anteriores para la variable manipulada A. La segunda señal para el control del
enfriamiento se genera a través de la variable manipulada B. La conversión de la variable
manipulada en las variables manipuladas A y B se representa en la figura inferior. La
conversión en una señal de salida binaria se realiza de manera que, en las salidas digitales
correspondientes, la relación entre el ancho de impulso y la duración del periodo se
corresponda con las variables manipuladas A o B.
La figura siguiente muestra la función de rango partido en un regulador de tres puntos:

,QLFLRGHUDQJR
VH³DOGHVDOLGD
YDORUPDQLSXODGR%

,QLFLRGHUDQJR
VH³DOGHHQWUDGD
YDORUPDQLSXODGR%

6H³DOHVGHVDOLGDYDORU
PDQLSXODGR$\%

)LQDOGHUDQJRGH
VH³DOGHHQWUDGD
YDORUPDQLSXODGR%

)LQDOGHUDQJR
VH³DOGHVDOLGD
YDORUPDQLSXODGR%

9DORUPDQLSXODGR$
9DORUPDQLSXODGR%

6H³DOGHHQWUDGD
YDORUPDQLSXODGR
/01

Formador de impulsos del regulador paso a paso
Resumen
El formador de impulsos sólo está disponible para reguladores paso a paso (FM 355 S, FM
355-2 S y FM 455). Existen las siguientes posibilidades de ajuste.

Formador de impulsos (sólo regulador S)
● Tiempo de posicionamiento del motor
● Duración mínima del impulso
● Duración mínima de la pausa

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1027

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Seleccionar la señal de salida y el tipo de señal
Salida analógica
En la salida analógica se puede seleccionar para cada canal qué señal debe emitirse. La
mayoría de las veces es la variable manipulada A de un regulador. Sin embargo, también se
puede seleccionar la variable manipulada B de un regulador o un valor de entrada analógica.
Este último se puede utilizar para linealizar un valor analógico. De esta forma se puede
linealizar p. ej. la señal proporcionada por un termopar y convertirla en 0 a 10 V.

Salida del regulador de impulso
La figura siguiente muestra la salida del regulador S (modo de operación Regulador de
impulsos)
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDU
YDORU
PDQLSXODGR
H[WHUQR

9DORUPDQLSXODGR
$FWLYDU
VHJXLPLHQWR

$FWLYDUYDORU /LPLWDU
PDQLSXODGR
GHVHJXULGDG

5DQJR
SDUWLGRIRUPDGRU
GHLPSXOVRV

(QWUDGDGHFRUUHFFLµQ

6HJXLPLHQWRGHOYDORUPDQLSXODGR

1028

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Salida del regulador paso a paso
La figura siguiente muestra la salida del regulador S (modo de operación Regulador paso a
paso con realimentación de posición):
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDUYDORU
PDQLSXODGR
H[WHUQR

9DORU
PDQLSXODGR
$FWLYDU
VHJXLPLHQWR

$FWLYDUYDORU /LPLWDU
PDQLSXODGR
GHVHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

(QWUDGDGHFRUUHFFLµQ

6HJXLPLHQWRGHYDORUPDQLSXODGR

(QWUDGDGHUHVSXHVWDGHSRVLFLµQ

La figura siguiente muestra la salida del regulador S (modo de operación Regulador paso a
paso sin realimentación de posición):
9DORUPDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

$FWLYDUYDORU
PDQLSXODGR
H[WHUQR

$FWLYDUYDORU
PDQLSXODGR
GHVHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

En el regulador paso a paso sin realimentación de posición analógica, la variable manipulada
externa y la variable manipulada de seguridad actúan de la siguiente manera:
Si se asigna un valor entre el 40,0% y el 60,0%, no se activa ninguna salida binaria y el
actuador permanece sin cambios.
Si se establece un valor > 60,0%, se devuelve "Señal de posicionamiento alta" hasta que se
activa la realimentación "Actuador en tope superior".
Si se establece un valor < 40,0%, se emite "Señal de posicionamiento baja" hasta que la
realimentación accede a "Actuador en tope inferior".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1029

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3.5.4.5

Soporte de Shared Device
Los módulos de regulación FM 355 y FM 355-2 soportan la funcionalidad Shared Device al
utilizar un módulo de interfaz ET 200M.
Encontrará información general sobre Shared Device en Configurar un Shared Device.

Uso de Shared Device con los módulos de regulación
Para utilizar Shared Device con los módulos de regulación, su programa debe contener
adicionalmente los siguientes bloques de organización:
● OB de cambio de módulo (OB 83):
En la configuración como Shared Device se debe integrar OB 83 en la lista de bloques para
que en la transición de STOP a RUN se generen las llamadas alarmas "return of
submodule". Estas alarmas son capturadas por el OB 83; de lo contrario, la CPU entraría
en STOP con el evento "STOP por cambio de módulo".
● OB de error de acceso a la periferia (OB 122):
Mientras la CPU A se encuentre en STOP y la CPU B en RUN, en la CPU B se producirán
"errores de acceso de escritura a la periferia" si se llaman instrucciones de las librerías "FM
355 PID Control" o "FM 355-2 Temp Control" en el programa o si se ejecutan otros accesos
de escritura a las direcciones de módulo. Estos errores son capturados por el OB 122; de
lo contrario, la CPU B entraría en STOP con el evento "STOP por error de acceso a la
periferia".
● OB de error de ejecución del programa (OB 85):
El OB 85 solo tiene que estar incluido si no se ha configurado la opción "Sin llamada OB85"
en las propiedades de la CPU bajo "Ciclo" para el ajuste "Llamar al OB85 en caso de error
de acceso a la periferia". Para las demás opciones se requiere también una llamada de OB
85 para los errores de acceso a la periferia descritos anteriormente para el OB 122. Si el OB
85 no está presente en este caso, la CPU pasa a STOP con el evento "STOP por error de
ejecución del programa".
Ambas CPU deben encontrarse en "RUN" para que se puedan ejecutar correctamente los
accesos de escritura a direcciones de módulo y las instrucciones de las librerías "FM 355 PID
Control" y "FM 355-2 Temp Control".
Mientras una CPU se encuentra en STOP y la otra en RUN, todos los módulos de regulación
de este módulo de interfaz funcionan en el modo de respaldo. Esto es independiente del
"Acceso" que se ha efectuado en los ajustes de "Shared Device" del módulo de interfaz. Solo
si todas las CPU se encuentran en RUN, los módulos de regulación funcionan en el modo
normal.

1030

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3.5.5

Uso del FM 355

3.5.5.1

Configuración del FM 355

Configuración hardware
Procedimiento
Para poder configurar el hardware debe haber creado previamente un proyecto donde pueda
guardar la parametrización. A continuación se explican únicamente los pasos más importantes.
1. Inicie el TIA Portal y abra la configuración de dispositivos.
2. Seleccione un rack.
3. Seleccione un módulo de regulación del catálogo de módulos.
4. Arrastre el módulo de regulación hasta la posición correspondiente del rack.
5. Anote la dirección de entrada del módulo a partir de la tabla de configuración, p. ej. 272.
El valor leído se muestra en formato decimal.

3.5.5.2

Parametrización del FM 355

Parámetros del módulo
Procedimiento
Al parametrizar se configuran los parámetros del módulo.
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros". En la
ventana de inspección, seleccione la ficha "Propiedades".
Resultado: Las propiedades se muestran en la ventana de inspección.
2. Parametrice los parámetros básicos del módulo y los parámetros restantes.
3. Parametrice los otros parámetros de bloque en la vista de configuración.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".
5. Compile el proyecto con "Edición > Compilar".
6. Cargue los datos de parametrización a la CPU en estado STOP mediante "Online > Cargar
en dispositivo..."
Resultado: Los datos se encuentran en la memoria de la CPU y se transfieren directamente
desde allí hasta el módulo.
7. Efectúe un rearranque de la CPU.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1031

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Parámetros de la entrada analógica
Evaluación de la entrada analógica
Procedimiento
Para seleccionar el tipo de sensor, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue por la vista de edición hasta "Entrada analógica > Entrada [nº] > Evaluación de la
entrada analógica".
3. Defina los siguientes parámetros:
– Resolución entrada analógica
– Tipo de sensor entrada analógica
La opción "Vigilancia de rotura de hilo" se habilita para diversos tipos de sensor. La
opción se puede activar según se requiera.
– Temperatura de referencia
4. Guarde los parámetros introducidos con "Proyecto > Guardar".

Funciones de filtro
Procedimiento
Para establecer las funciones de filtro, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. En la vista de configuración seleccione "Entrada analógica > Entrada [n°] > Funciones de
filtro".
3. Establezca los siguientes parámetros:
– Para filtrar en función de una constante de tiempo, active la opción "Filtro de señal".
Si la opción "Filtro de señal" está seleccionada, se puede establecer la constante de
tiempo del filtro.
– Constante de tiempo del filtro
Se puede activar solamente si la opción "Filtro de señal" se encuentra activada.
– Para linealizar de la señal del encóder active la opción "Filtro de raíz cuadrada".
– Para linealizar la curva característica de la señal del encóder, active la opción "Filtro de
polígono"
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Filtro de señal
Filtro 1. Orden cuya rapidez de respuesta se establece mediante la constante de tiempo.

1032

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Filtro de raíz cuadrada
Sirve para linealizar señales de encóder, en las que el valor real existe como magnitud físca,
que se encuentra en relación cuadrática con la magnitud de proceso medida.

Filtro de polígono
Sirve para linealizar de características de encóders.
Los 13 nodos disponibles pueden seleccionarse en:
● mA en la entrada de corriente
● mV en la entrada de tensión

Normalización
Procedimiento
Para convertir la señal de entrada en una unidad física, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Entrada [nº] > Normalizar".
3. Establezca los siguientes parámetros:
– Valor superior
– Valor inferior
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Normalización
Para convertir la señal de entrada en otra unidad física mediante interpolación lineal entre el
valor inicial (valor inferior) y el valor final (valor superior).

Error de regulación
Realizar un regulador de valor fijo o en cascada
Regulador de valor fijo o en cascada
En las estructuras de regulación del regulador de valor fijo o en cascada, el valor real efectivo
es idéntico al valor real A.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1033

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Seleccionar tipo de regulador
Para realizar un regulador de valor fijo o en cascada, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de configuración hasta "Entrada analógica > Canal [nº]".
3. Seleccione en el área "Tipo de regulador" la opción "Regulador de valor fijo o en cascada".
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para acondicionar la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº] > Error de regulación".
3. Establezca, en las distintas áreas, los parámetros correspondientes:
– Origen de consigna
Seleccione el origen de la consigna.
– Consigna de seguridad
Ajuste aquí la consigna de seguridad. Asimismo, establezca la reacción en caso de un
fallo de la CPU y el comportamiento en el arranque.
– Rampa de consigna
Establezca el tiempo de subida de rampa.
– Límite de consigna
Seleccione aquí el límite superior y el límite inferior de consigna.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Seleccionar el origen de la señal para el valor real A
Para seleccionar el origen de la señal para el valor real A, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº] > Error de regulación".
3. Seleccione el origen correspondiente en el área "Variable manipulada". Están disponibles
las siguientes opciones:
– Cero
– Entrada analógica acondicionada
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

1034

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Realizar un regulador de tres componetes
Regulador de tres componentes
En la estructura del regulador de tres componentes, el valor real efectivo se forma a partir de
la suma de los tres valores reales A, B y C y mediante la adición de un offset ajustable. Los
valores reales B y C se pueden evaluar adicionalmente mediante factores.

Seleccionar el tipo de regulador
Para realizar un regulador de tres componentes, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº]".
3. Seleccione en el área "Tipo de regulador" la opción "Regulador de tres componentes".
4. Guarde los parámetros introducidos con "Proyecto > Guardar".

Acondicionamiento de la consigna
Para ajustar cómo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº] > Error de regulación".
3. Seleccione, en el área "Origen de consigna", de dónde debe proceder la consigna.
4. Introduzca, en el área "Consigna de seguridad", un valor que debe servir como valor de
seguridad, en caso de un fallo de la CPU y para el arranque.
5. Seleccione el comportamiento del módulo de regulación, que debe ser válido como
"Reacción a fallo de la CPU" y para el "Comportamiento en arranque". Para ello, se dispone
de las siguientes opciones:
– Consigna = última consigna válida: al producirse el evento, se asigna la última consigna
válida a la consigna. La última consigna válida se mantiene.
– Consigna = consigna de seguridad: al producirse el evento, se asigna la consigna de
seguridad a la consigna. Así se puede realizar un funcionamiento de emergencia
protegido.
6. Establezca, en el área "Rampa de consigna", el tiempo de subida que debe respetarse, en
caso de una modificación de la consigna, con el fin de reducir una sobreoscilación.
7. Establezca en el área "Límite de consigna" tanto un límite superior como también uno
inferior para la consigna.
8. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1035

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Seleccionar el origen de la señal para el valor real A, B y C
Para establecer los orígenes de la señal para los valores reales A, B y C, proceda del siguiente
modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº] > Error de regulación".
3. Seleccione, en el área "Variable manipulada", el origen de la señal correspondiente para
cada valor real. Puede seleccionar si no utiliza ninguna señal ("cero") como origen o si
utiliza una de las entradas analógicas acondicionadas.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Introducir factores para los valores reales B y C así como offset
Para establecer los orígenes de la señal para los valores reales A, B y C, proceda del siguiente
modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº] > Error de regulación".
3. En el área "Sumar los valores reales", establezca el factor de ponderación necesario para
los valores reales B y C.
4. Establezca el "Offset" necesario que debe sumarse a los valores reales.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Realizar una regulación de relación o de mezcla
Seleccionar el tipo de regulador
Para realizar un regulador de relación o de mezcla, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº]".
3. Seleccione en el área "Tipo de regulador" la opción "Regulador de relación o regulador de
mezcla".
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para ajustar cómo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº] > Error de regulación".
3. Seleccione en el área "Origen de consigna", de dónde debe proceder la consigna.
4. Introduzca, en el área "Consigna de seguridad", un valor que debe servir como valor de
seguridad, en caso de un fallo de la CPU y para el arranque.

1036

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
5. Seleccione el comportamiento del módulo de regulación, que debe ser válido como
"Reacción a fallo de la CPU" y para el "Comportamiento en arranque". Para ello, dispone de
la selección siguiente:
– Consigna = última consigna válida: al producirse el evento, se asigna la última consigna
válida a la consigna. Por consiguiente, a última consigna válida se mantiene.
– Consigna = consigna de seguridad: al aparecer el evento se asigna la consigna de
seguridad a la consigna. Así se puede realizar un funcionamiento de emergencia
seguro.
6. Establezca, en el área "Rampa de consigna", el tiempo de subida que debe respetarse, en
caso de una modificación de la consigna, con el fin de reducir una sobreoscilación.
7. Establezca en el área "Límite de consigna" tanto un límite superior como también uno
inferior para la consigna.
8. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Seleccionar el origen de la señal para los valores reales A y D
Para establecer los orígenes de la señal para los valores reales A y D, proceda del siguiente
modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº] > Error de regulación".
3. Seleccione, en el área "Variable manipulada", el origen de la señal correspondiente para
cada valor real. Puede especificar no utilizar ninguna señal ("cero") como origen o utilizar
una de las entradas analógicas acondicionadas, para el valor real D puede seleccionar
también el valor manipulado de uno de los reguladores.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Introducir multiplicador
Para establecer los orígenes de la señal para los valores reales A y D, proceda del siguiente
modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº] > Error de regulación".
3. Seleccione el offset deseado en el área "Multiplicar".
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".
Para el regulador de relación, se utiliza el valor real A como magnitud regulada y el valor real
D como magnitud de relación. La entrada de consigna funciona como factor de relación. Ésta
se acondiciona para obtener una consigna efectiva mediante multiplicación por el valor real D
y adición de un offset ajustable. Si el valor real D se desactiva, entonces sólo se suma el offset
a la consigna.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1037

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Ajustar la generación de alarma
Procedimiento
Para ajustar la generación de alarma, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Entrada analógica > Canal [nº] > Error de regulación".
3. Seleccione las opciones necesarias en el área "Generar alarma":
– Seleccione, en "Avisador de valor límite de", para qué señal se debe fijar la alarma.
– Bajo "Alarma límite superior", establezca a partir de qué valor se activa la alarma al
alcanzarse el límite superior.
– Bajo "Advertencia límite superior", establezca a partir de que valor se activa una
advertencia, cuando se produce una aproximación al límite superior.
– Bajo "Advertencia límite inferior", establezca a partir de qué valor activa una
advertencia, cuando se produce una aproximación al límite inferior.
– Bajo "Alarma límite inferior", establezca a partir de qué valor se activa la alarma al
alcanzarse el límite inferior.
– Para evitar que centelleen los indicadores de vigilancia, se puede parametrizar una
histéresis bajo "Histéresis".
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Algoritmo de regulación
Realizar una regulación P
Procedimiento
Para realizar una regulación P, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Seleccione, en el área "Tipo", la opción "Regulador PID".
4. Seleccione en el área "General", bajo "Modo de operación", la opción "P".
Todas las opciones que son parametrizables para una regulación P se activan; todas las
opciones restantes se desactivan.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

1038

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Realizar una regulación PI
Procedimiento
Para realizar una regulación PI, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Seleccione, en el área "Tipo", la opción "Regulador PID".
4. Seleccione en el área "General", bajo "Modo de operación", la opción "PI".
Todas las opciones que son parametrizables para una regulación PI se activan; todas las
opciones restantes se desactivan.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Crear regulación I
Procedimiento
Para realizar una regulación I, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Seleccione, en el área "Tipo", la opción "Regulador PID".
4. Seleccione en el área "General", bajo "Modo de operación", la opción "I".
Todas las opciones que son parametrizables para una regulación I se activan; todas las
opciones restantes se desactivan.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Crear una regulación PID
Procedimiento
Para realizar una regulación PID, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Seleccione, en el área "Tipo", la opción "Regulador PID".
4. Seleccione en el área "General", bajo "Modo de operación", la opción "PID".
Todas las opciones que son parametrizables para una regulación PID se activan; todas las
opciones restantes se desactivan.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1039

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Crear una regulación PD
Procedimiento
Para realizar una regulación PD, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Seleccione, en el área "Tipo", la opción "Regulador PID".
4. Seleccione en el área "General", bajo "Modo de operación", la opción "PD".
Todas las opciones que son parametrizables para una regulación PD se activan; todas las
opciones restantes se desactivan.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Realizar una regulación de temperatura por lógica difusa
Procedimiento
Para llevar a cabo una regulación de temperatura por lógica difusa, proceda del modo
siguiente:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Seleccione, en el área "Tipo", la opción "Módulo de regulación de temperatura por lógica
difusa".
Todas las opciones que son parametrizables para una regulación de temperatura por lógica
difusa se activan; todas las opciones restantes se desactivan.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Suprimir nivel de ruido del error de regulación
Procedimiento
Para suprimir el nivel de ruido del error de regulación, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Establezca, en el área "General", el ajuste de "Ancho de zona muerta".
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

1040

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Control anticipativo
Procedimiento
Para aplicar adicionalmente una perturbación, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. En el área "General", en la lista "Fuente de perturbación", seleccione la fuente de la
perturbación.
Seleccione la entrada "Cero" para no aplicar ninguna perturbación adicionalmente.
4. Introduzca, bajo "Factor de perturbación", un valor, con el que desea ponderar la
perturbación.
Un valor < 0 debilita la perturbación, un valor > 0 aumenta la perturbación. Con un valor de
1, la perturbación no cambia.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Poner la acción P por rama de realimentación
Procedimiento
Para realizar un regulador de valor fijo o en cascada, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en la "Puesta en servicio".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Seleccione en el área "Acción P" la opción "Por rama de realimentación".
Si la opción está desactivada, la acción P está puesta en rama de realimentación.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Debilitar la acción D en caso de cambios de consigna
Seleccionar el tipo de regulador
Para realizar un regulador de valor fijo o en cascada, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Seleccione, en el área "Acción D", con la opción "Acción D", el origen para la acción D.
4. Establezca el factor para la acción D en el área "Factor derivativo".
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1041

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Invertir el efecto del regulador
Principio
La inversión del regulador de la asignación "error de regulación creciente = magnitud
manipulada creciente" a "error de regulación creciente = magnitud manipulada decreciente",
se logra mediante el ajuste de una ganancia proporcional negativa (GAIN).

Procedimiento
Para invertir el efecto del regulador, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Algoritmo de regulación".
3. Establezca, en el área "General", una ganancia proporcional con signo invertido.
Si se indica una ganancia proporcional positiva y el efecto del regulador debe invertirse,
establezca una ganancia proporcional negativa.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Salida del regulador
Crear un regulador continuo
Un regulador continuo sólo puede realizarse con un módulo analógico.

Procedimiento
1. Conectar una variable manipulada externo (Página 1044)
2. Ajustar la variable manipulada de seguridad (Página 1045)
3. Conectar el modo de seguimiento (Página 1044)
4. Limitar la variable manipulada (Página 1045)
5. Controlar dos actuadores - Rango partido (Página 1046)
6. Seleccionar la señal de salida y el tipo de señal (Página 1047)

Regulador paso a paso sin realimentación de posición
Un regulador paso a paso sin realimentación de posición sólo puede realizarse con un módulo
digital.

Procedimiento
1. Seleccionar regulador paso a paso sin realimentación de posición
2. Conectar una variable manipulada externo (Página 1044)

1042

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Ajustar la variable manipulada de seguridad (Página 1045)
4. Formador de impulsos del regulador paso a paso (Página 1046)

Crear un regulador paso a paso con realimentación de posición
Un regulador paso a paso con realimentación de posición sólo puede realizarsese con un
módulo digital.

Procedimiento
1. Seleccionar regulador paso a paso con realimentación de posición
2. Conectar una variable manipulada externo (Página 1044)
3. Conectar el modo de seguimiento (Página 1044)
4. Ajustar la variable manipulada de seguridad (Página 1045)
5. Limitar la variable manipulada (Página 1045)
6. Ajustar la realimentación de posición (Página 1044)
7. Formador de impulsos del regulador paso a paso (Página 1046)

Crear regulador de impulsos
Un regulador de impulsos sólo puede realizarse con un módulo digital.

Procedimiento
1. Seleccionar salida del regulador de impulsos
2. Conectar una variable manipulada externo (Página 1044)
3. Conectar el modo de seguimiento (Página 1044)
4. Ajustar la variable manipulada de seguridad (Página 1045)
5. Limitar la variable manipulada (Página 1045)
6. Preparar señal analógica para la conversión en señal digital
7. Convertir la señal analógica en señal digital (Página 1047)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1043

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Parametrizar las funciones de la salida del regulaldor
Conectar una variable manipulada externo
Procedimiento
Para conectar la variable manipulada externa, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Salida del regulador".
3. En el área "Variable manipulada externa", seleccione la opción con la cual debe activarse
la variable manipulada externa. Para ello, dispone de las siguientes opciones:
– Activación del bloque de función.
– Activación del bloque de función o de una de las entradas digitales.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Conectar el modo de seguimiento
Procedimiento
Para realizar un regulador de valor fijo o en cascada, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Salida del regulador".
3. En el área "Modo de seguimiento", seleccione la opción mediante la cual se debe activar la
variable manipulada externa. Para ello, dispone de las siguientes opciones:
– Activación del bloque de función.
– Activación del bloque de función o de una de las entradas digitales.
4. En el área "Modo de seguimiento", seleccione el origen de la señal para el modo de
seguimiento. Para ello, dispone de las siguientes opciones:
– Cero, en este caso, no se utilizar ningún origen.
– Una de las entradas analógicas.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Ajustar la realimentación de posición
Procedimiento
Para ajustar la realimentación de posición, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Salida digital > Salida [nº]".

1044

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. En el área "Entrada de realimentación de posición", seleccione la opción "Origen", para
seleccionar la señal para la realimentación de posición.
– Cero: ninguna realimentación de posición.
– Una de las entradas analógicas acondicionadas.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Ajustar la variable manipulada de seguridad
Procedimiento
Para ajustar la variable manipulada de seguridad, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Salida del regulador".
3. En el área "Variable manipulada de seguridad", establezca el valor que debe utilizarse
como variable manipulada de seguridad.
4. Bajo "Activación", seleccione la opción mediante la cual se debe activar la variable
manipulada externa. Para ello, dispone de las siguientes opciones:
– Activación del bloque de función.
– Activación del bloque de función o de una de las entradas digitales.
5. Bajo "Reacción al arrancar el módulo", seleccione la opción que debe llevarse a cabo en el
arranque del módulo. Dispone de las siguientes opciones para su elección:
– Lazo cerrado: en el arranque, el módulo pasa inmediatamente al modo de regulación.
– Variable manipulada de seguridad: primero se regula a la variable manipulada de
seguridad.
6. Bajo "Reacción si falla el transductor valor real A", seleccione la opción que debe llevarse
a cabo, en caso de fallo del transductor de medida del valor real A.
7. Bajo "Reacción a fallo transductor entrada", seleccione la opción que debe llevarse a cabo,
en caso de fallo del transductor de medida de una entrada.
8. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Limitar la variable manipulada
Procedimiento
Para limitar la variable manipulada, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Salida del regulador".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1045

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. En el área "Límite de señal de salida", establezca los siguientes valores:
– Valor superior: representa el valor límite superior para la señal de salida.
– Valor inferior: representa el valor límite inferior para la señal de salida.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Controlar dos actuadores - Rango partido
Procedimiento
Para activar dos actuadores, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Regulador > Canal [nº] > Salida del regulador".
3. En el área "Rango partido", seleccione la opción "Activar", para activar dos elementos
finales de control.
4. Establezca los siguientes valores tanto para las señales de entrada y salida A como
también para las señales de entrada y salida B:
– Señal de entrada inferior.
– Señal de entrada superior.
– Señal de salida inferior.
– Señal de salida superior.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Formador de impulsos del regulador paso a paso
Procedimiento
Para parametrizar el formador de impulsos, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Salida digital > Salida [nº]".
3. En el área "formador de impulsos", establezca los siguientes parámetros:
– Tiempo de posicionamiento del motor.
– Duración mínima de impulso.
– Duración mínima de pausa.
4. Seleccione la opción adecuada de la que se debe tomar el valor para el valor superior y el
inferior:
– Del bloque de función.
– Del bloque de función o de una de las entradas digitales.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

1046

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Convertir la señal analógica en señal digital
Procedimiento
Para convertir una señal analógica en una señal digital, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Salida digital > Canal [nº]".
3. En el área "formador de impulsos", establezca los siguientes parámetros:
– Duración mínima de impulso.
– Duración mínima de pausa.
4. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Seleccionar la señal de salida y el tipo de señal
Procedimiento
Para seleccionar la señal de salida y el tipo de señal, proceda del siguiente modo:
1. Haga doble clic en la vista de dispositivos, bajo el módulo del "Ajuste de parámetros".
2. Navegue en la vista de edición hasta "Salida analógica > Salida [nº]".
3. Bajo la opción "Origen", seleccione qué señal se debe utilizar como señal de salida.
Dispone de las siguientes opciones:
– Cero: ningún origen para la señal de salida.
– Una de las entradas analógicas.
– Uno de los valores manipulados para el regulador A o B.
4. Bajo la opción "Tipo de señal", seleccione el tipo en el que debe emitirse la señal de salida.
5. Guarde los parámetros introducidos mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1047

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3.5.5.3

Programación del FM 355

3.5.5.4

Puesta en servicio del FM 355

Crear y configurar DBs de instancia
Procedimiento
Para satisfacer los requisitos para la puesta en marcha, proceda de la manera siguiente:
1. Cree un programa de usuario que efectúe cíclicamente una llamada a la instrucción
PID_FM en un OB de alarma cíclica.
2. En el programa del usuario, ponga READ_VAR cíclicamente a TRUE.
3. Genere para cada canal del regulador un DB de instancia individual de la
instrucciónPID_FM.
4. Para cada DB de instancia, introduzca la dirección de módulo en el parámetro
PID_FM.MOD_ADDR.
Utilice como dirección de módulo del FM 355 la dirección inicial especificada al configurar
el hardware.
5. Introduzca en el parámetro PID_FM.CHANNEL el número del canal de regulación (1 ... 4).
6. Si utiliza la instrucción PID_PAR, introduzca en el parámetro PID_PAR.CHANNEL el
número del canal del regulador.
7. Compruebe que esté activado el "Tipo de sensor Entrada analógica" del canal en cuestión.
Si no se procesa la entrada analógica, todos los parámetros PID se ajustan a cero, y no se
calcula ninguna variable manipulada.
Nota
DBs multiinstancia
Si utiliza DBs multiinstancia en su proyecto, los FM se deben poner en servicio a través de
una tabla de observación.

Puesta en servicio del regulador
Introducción
Los parámetros PID se pueden optimizar del modo siguiente:
● Regulador PID/PI (regulador paso a paso, regulador continuo, regulador de impulsos):
Manual
● Regulador de temperatura por lógica difusa: Ciclo continuo
● Regulador paso a paso: Automáticamente con la instrucción TUN_ES
● Regulador continuo: Automáticamente con la instrucción TUN_EC
● Regulador de impulsos: Automáticamente con la instrucción TUN_EC

1048

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para optimizar un regulador, proceda del siguiente modo:
1. Coloque la CPU en el estado RUN.
2. Si utiliza un regulador paso a paso, mida el tiempo de posicionamiento del motor.
3. Optimice los parámetros PID con alguna de las posibilidades citadas anteriormente.
4. Observe el lazo de regulación con el registrador de curvas.

Consulte también
Medir el tiempo de posicionamiento del motor (Página 1056)

Optimizar los parámetros PID manualmente
Requisitos
En la parametrización del algoritmo de regulación ha elegido el "Regulador PID".

Procedimiento
Para ajustar manualmente un regulador PI/PID, proceda del modo siguiente:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. Introduzca los valores correspondientes para la acción P, la acción I, la acción D y el retardo.
4. En el grupo "Optimización", haga clic en el símbolo

"Enviar parámetros PID al FM".

5. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna".
6. Introduzca una nueva consigna.
7. Desactive en caso necesario la casilla de verificación "Modo manual" y, en el grupo
"Valores actuales", haga clic en el símbolo .
El regulador trabaja con los nuevos parámetros y regula según la nueva consigna.
8. Compruebe la calidad de los parámetros PID mediante los recorridos de la curva.
9. Repita los pasos del 3 hasta el 8, hasta que esté satisfecho/a con el resultado de la
regulación.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1049

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Identificación del sistema por lógica difusa
Requisitos del proceso para un regulador de temperatura por lógica difusa
Requisitos
Para conseguir una regulación óptima con la ayuda del regulador de temperatura por lógica
difusa, el proceso debe satisfacer los requisitos siguientes:
● En caso de calefacciones de baños, el líquido calefactor debe estar bien mezclado.
● En caso de regulaciones tipo baño en baño, ambos líquidos deben estar bien agitados.
Simultáneamente, se debe proporcionar una buena transferencia de calor entre todos los
medios caloportadores. Si se emplean materiales que son malos caloportadores, para
conseguir un buen transporte del calor se deben utilizar superficies de transferencia de gran
tamaño.
● En caso de regulación de la temperatura del aire ambiental, se debe proporcionar una
buena mezcla (p. ej., mediante ventiladores).
● La ganancia del sistema regulado no debe superar un factor 3.
● El tiempo de retardo debe equivaler como máximo al 3% del tiempo de compensación.
● Durante el periodo de muestreo del regulador, y con la salida de la variable manipulada en
el valor máximo, la temperatura que se desea regular debe variar como máximo un 1‰ de
la temperatura máxima preajustada.

Clasificación de los sistemas regulados
Un sistema regulado, o bien un proceso que se desea regular, se caracteriza por parámetros
como, p. ej., la potencia de calefacción, la masa que se debe calentar o la capacidad térmica
del medio que se desea calentar. En lo que se refiere al regulador por lógica difusa, se efectúa
una distinción entre sistemas de temperatura regulada "críticos" y "no críticos" del modo
siguiente: La regulación es tanto más crítica
● cuanto mayor es la potencia de calefacción,
● cuanto mayor es la capacidad térmica de la calefacción,
● cuanto menor es la capacidad térmica del medio que se desea calentar,
● cuanto mayor es la resistencia a la transmisión de calor,
● cuanto menor es la superficie de transferencia de calor.
Tras el seguimiento automático de un salto en la variable manipulada por parte del sistema
regulado, éste reacciona con una respuesta a un escalón. La clasificación de los sistemas
regulados también se puede llevar a cabo en función de esta respuesta a un escalón: La
regulación es tanto más crítica cuanto mayor es el cociente tu / tg y cuanto mayor es la ganancia
del sistema regulado. Si tu / tg < 1/10, el sistema regulado no es crítico.

Consulte también
Valores característicos del sistema regulado (Página 645)

1050

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Desarrollo de la identificación del sistema por lógica difusa
Desarrollo de la optimización de parámetros con un regulador de temperatura por lógica difusa
La optimización de parámetros se basa en un regulador por lógica difusa autooptimizante.
La identificación del sistema regulado comienza con una fase de observación, durante la cual
la potencia de calefacción emitida es nula. Esta fase de observación dura lo siguiente:
● Fase de observación de un regulador continuo: aprox. 1 minuto
● Fase de observación de un regulador paso a paso: aprox. 1 minuto + 1/2 x tiempo de
desplazamiento del actuador
Este tiempo se emplea para poder detectar tendencias de temperatura en el medio calefactor.
A continuación se emite el 100% de la potencia máxima de calefacción; esto se aprecia en el
parámetro de salida LMN del DB de instancia de la instrucción PID_FM.
El área del primer 4% de incremento de la temperatura del rango de consigna se utiliza para
la identificación, ya que tanto en el 1% como en el 4% del incremento de temperatura se
obtiene información sobre el comportamiento del proceso a partir del tiempo transcurrido.
La identificación concluye cuando la potencia de calefacción pasa a ser inferior al 100%. Este
comportamiento se puede utilizar, p. ej., para desconectar la identificación a través del
programa de usuario. Tras la fase de identificación, el regulador sigue funcionando con los
parámetros obtenidos.
Si la divergencia provocada por el salto de consigna no se compensa y la potencia de
calefacción permanece a cero de manera continua, significa que la identificación ha resultado
fallida, es decir, el regulador no puede regular el sistema regulado al que está conectado.

Comportamiento del regulador para distintos sistemas regulados
Si el sistema regulado es "no crítico", no hay problemas en la identificación ni en la regulación.
La identificación de un sistema regulado "demasiado crítico" queda cancelada. Si un sistema
regulado se identifica como "crítico", su regulación se efectúa con mucha "precaución", es
decir, despacio.

Efectuar la identificación de sistema por lógica difusa.
Requisitos
En la parametrización del algoritmo de regulación ha elegido el "Regulador por lógica difusa".
Si es posible, asegúrese de que antes de la identificación el sistema regulado se haya
estabilizado (ningún proceso activo de calefacción o refrigeración) o varíe con lentitud y de
forma monótona. Se puede utilizar como criterio al respecto que el comportamiento de la
variación de temperatura durante un minuto se pueda aproximar por una recta. En procesos
rápidos, este requisito resulta especialmente actual.
Dado que el valor emitido para la variable manipulada es nulo durante aprox. un minuto al
principio de la identificación del regulador, la temperatura que se desea regular debe ser
cercana a la temperatura ambiente.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1051

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Iniciar la identificación del sistema por lógica difusa
Para optimizar un regulador por lógica difusa, proceda del modo siguiente:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el símbolo "Start".
Si aún no existe ninguna conexión online, esta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. En el grupo "Optimización" introduzca una nueva consigna (SP_OP).
La nueva consigna debe cumplir las condiciones siguientes:
– Salto de consigna > 5%
– Nueva consigna > valor real + límite superior de la consigna x 0,12
4. En el grupo "Optimización", haga clic en el símbolo
difusa".

"Identificación del sistema por lógica

Resultado
La nueva consigna (SP_OP), SP_OP_ON = TRUE y FUZID_ON = TRUE se envían al FM. La
identificación del sistema por lógica difusa comienza. El parámetro IDSTATUS de la
instrucción CH_DIAG proporciona información sobre el estado de la identificación. En el
cuadro de visualización de estado puede ver si hay una identificación del sistema por lógica
difusa en estado activo o en ejecución.

Desactivar la identificación del sistema por lógica difusa
Mientras el bit FUZID_ON = TRUE, cada vez que se produzca un salto de consigna
suficientemente grande se iniciará la identificación siguiente.
Para desconectar el modo de optimización, proceda del modo siguiente:
1. Inserte FUZID_ON en una tabla de observación.
2. Defina FUZID_ON = FALSE.
Nota
La desconexión del modo de optimización FUZID_ON = FALSE antes de terminar la
identificación no provoca que esta se detenga. Una vez iniciada la identificación, esta sigue
adelante pase lo que pase, excepto si se produce un salto de consigna negativo.

Repetir la identificación del sistema por lógica difusa
Cada vez que se produce un salto de consigna ≥12% se efectúa una nueva identificación, a no
ser que esta se desconecte de nuevo con FUZID_ON = FALSE.
También existe la posibilidad de iniciar de nuevo la identificación disminuyendo y, a
continuación, aumentando de nuevo la consigna en un valor >12%.

1052

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Cancelar la identificación del sistema por lógica difusa
La identificación se puede cancelar en los casos siguientes:
● Por parte del regulador, si se identifica un sistema regulado "crítico". Tras la cancelación,
el regulador se encuentra en estado de error. Este estado se manifiesta en que el regulador
desactiva la variable manipulada de forma permanente. Este estado no varía aunque se
desconecte la optimización. El inicio de una nueva identificación anula el estado de error.
Se puede obtener información sobre el estado de la identificación a través del parámetro
IDSTATUS del FB CH_DIAG. Más detalles al respecto al final de este capítulo, en la
sección "Información sobre el estado del regulador".
● Por parte del operador, generando un salto de consigna negativo, siempre y cuando la
consigna rebase por defecto la condición 2 (véase más arriba, "¿Cómo iniciar la
identificación?").
Para cancelar la optimización, proceda del modo siguiente:
1. Introduzca una nueva consigna que sea inferior al valor real actual y que cumpla las mismas
condiciones que al principio de la identificación del sistema por lógica difusa.
2. En el grupo "Optimización", haga clic en el símbolo
difusa".

"Identificación del sistema por lógica

Cargar los parámetros optimizados en el dispositivo
Introducción
Para impedir que los parámetros del FM se sobrescriban con los datos del sistema en el
siguiente arranque de la CPU, se puede proceder del modo siguiente:
● Tras cada arranque del FM , cargue en este con LOAD_PAR=TRUE los parámetros PID
optimizados del DB de instancia del PID_FM.
● Cargue los parámetros PID optimizados en el SDB.
Nota
Los juegos de parámetros PI, PID y SAVE no se pueden guardar en el SDB.

Procedimiento
Para cargar los parámetros en el SDB, proceda del siguiente modo:
1. Haga clic en el símbolo
"Transfiera datos online al proyecto offline".
Los parámetros PID se guardan en el ajuste de parámetros del FM.
2. Pare la CPU.
3. Haga clic en el símbolo

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

"Cargar en dispositivo".

1053

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Trabajar con el registrador de curvas
Observar
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Puesta en servicio".
2. Navegue en la vista de configuración hasta "Registrador de curvas".
3. Seleccione el DB de instancia que desee observar. Tras la selección se muestra el canal al
que está asignado el DB de instancia.
4. Defina el tiempo de actualización con el que debe registrarse el registrador de curvas.
5. Haga clic en "Medición activada" para iniciar la medición.
6. Haga clic en "Medición desactivada" para finalizar la medición.

Procedimiento
Para adaptar la escala, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Puesta en servicio".
2. Navegue en la vista de configuración hasta "Registrador de curvas".
3. Para modificar el eje de tiempo:
– Haga clic en el botón de flecha junto a la fecha, para abrir un calendario. Seleccione una
fecha en el calendario. Para bloquear la selección, haga clic en el candado azul. Esta
posibilidad existe tanto para la fecha inicial como para la fecha final.
– Haga clic con el puntero del ratón en la escala de tiempo. El puntero del ratón se
representa como flecha a la izquierda/derecha. Mantenga el puntero del ratón
presionado y arrástrelo hacia la izquierda o derecha.
Si el tiempo inicial o final está bloqueado, se modifica la escala del tiempo.
Si no está bloqueado el tiempo inicial ni el final, se modifica el período indicado; la escala
se mantiene igual.
4. Para modificar el eje de tiempo:
– Haga clic en el campo de entrada para el valor superior o el valor inferior mostrado.
Introduzca ahí el valor deseado. Para bloquear la selección, haga clic en el candado
azul. Esta posibilidad existe tanto para el valor superior como también para el inferior.
– Haga clic con el puntero del ratón en la escala de valores. El puntero del ratón se
representa como flecha arriba/abajo. Mantenga el puntero del ratón presionado y
arrástrelo hacia arriba o abajo.
Si el valor superior o inferior está bloqueado, se modifica la escala del eje de valores.
Si no está bloqueado el valor superior ni el valor inferior, se modifica el rango indicado;
la escala se mantiene igual.

1054

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Modificar los parámetros a través de la HMI
Procedimiento
Si desea modificar los parámetros del regulador de la instrucción PID_FM mediante el manejo
a través de la HMI, proceda del modo siguiente:
1. Desde la HMI, escriba en la CPU (véase ①) en un DB auxiliar los parámetros que se deben
modificar.
2. Ponga PID_FM.COM_RST a TRUE.
La instrucción ejecuta una inicialización. Los parámetros se sincronizan entre el FM y la
CPU (véase ②).
3. Transfiera los parámetros que se deben modificar desde el DB auxiliar hasta el DB de
instancia de la instrucción PID_FM (véase ③).
4. Ponga PID_FM.LOAD_PAR a TRUE.
Los parámetros modificados se transfieren al FM (véase ④).
Resulta necesario depositar los parámetros en un DB auxiliar porque, tras el arranque de la
CPU, PID_FM lee con COM_RST = TRUE aquellos parámetros del módulo que la CPU ha
transferido previamente desde los datos del sistema al FM.
&38

23



'%GHD\XGD


WUDVODLQLFLDOL]DFLµQFRQ
&20B567 758(
'%GH
LQVWDQFLDGHO
)%
3,'B)0

)%
3,'B)0

)0


/2$'B3$5 758(
&20B567 758(


'DWRVGHO
VLVWHPD

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

&DUJDGHORVGDWRVGHO
VLVWHPDDUUDQTXH
6723 ൺ 581 OD&38

1055

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Medir el tiempo de posicionamiento del motor
Introducción
Para conseguir un buen resultado de la regulación, el tiempo de posicionamiento del motor
debe ser lo más preciso posible. Los datos de la documentación del elemento final de control
son valores medios para este tipo de elemento final de control. El valor puede variar para el
elemento final de control que se use en cada momento.
Si utiliza actuadores con realimentación de posición o con señales de tope, es posible medir
el tiempo de posicionamiento del motor durante la puesta en servicio. Si no se dispone de una
realimentación de posición ni de señales de tope, no es posible medir el tiempo de
posicionamiento del motor.

Requisitos
● El valor parametrizado del tiempo de posicionamiento del motor debe equivaler como
mínimo a la mitad del tiempo de posicionamiento real. El actuador se desplaza en un
sentido durante el doble del tiempo de posicionamiento como máximo.
● En los actuadores con realimentación de posición analógica, la realimentación de posición
debe estar interconectada.
● En los actuadores con señales de tope, las señales de tope deben estar interconectadas.

Actuadores con realimentación de posición analógica
Para medir el tiempo de posicionamiento del motor con realimentación de posición, proceda
del siguiente modo:
1. Elija el DB instancia para el que se debe medir el tiempo de posicionamiento del motor.
2. Active la casilla de verificación "Utilizar realimentación de posición".
3. En el campo de entrada "Posición de destino" indique hacia dónde desea mover el
elemento final de control.
La realimentación de posición actual (posición de inicio) se muestra. Haga clic en el
botón
"Iniciar medición tiempo de posicionamiento".

Resultado
El elemento final de control se desplaza hasta la posición de destino desde la posición de
inicio. La medición del tiempo se inicia de inmediato y finaliza en cuanto el elemento final de
control ha alcanzado la posición de destino. El tiempo de posicionamiento del motor se calcula
según la fórmula:
Tiempo de posicionamiento del motor = (Límite superior del valor de salida - Límite inferior del
valor de salida) x Tiempo de medición /VALOR ABSOLUTO(Posición de destino - Posición de
inicio).
Se muestran el progreso y el estado de la medición del tiempo de posicionamiento. El tiempo
de posicionamiento medido se muestra en el campo "Tiempo de actuación medido". Una vez
finalizada la medición del tiempo de posicionamiento se conecta el modo manual de las

1056

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
señales de posicionamiento (LMNSOPON = TRUE). El elemento final de control deja de
moverse.

Actuadores con señales de tope
Para medir el tiempo de posicionamiento del motor con señales de tope, proceda del siguiente
modo:
1. Elija el DB instancia para el que se debe medir el tiempo de posicionamiento del motor.
2. Active la casilla de verificación "Utilizar señales de tope del actuador".
3. Haga clic en el botón

"Iniciar medición tiempo de posicionamiento".

Resultado
El elemento final de control se mueve primero hasta el tope inferior, después, hasta el tope
superior y, de nuevo, hasta el tope inferior. La medición del tiempo se inicia cuando el actuador
ha alcanzado el tope inferior y finaliza cuando el actuador alcanza por segunda vez el tope
inferior. El tiempo medido dividido entre dos da lugar al tiempo de posicionamiento del motor.
Se muestran el progreso y el estado de la medición del tiempo de posicionamiento. El tiempo
de posicionamiento medido se muestra en el campo "Tiempo de actuación medido". Una vez
finalizada la medición del tiempo de posicionamiento se conecta el modo manual de las
señales de posicionamiento (LMNSOPON = TRUE). El elemento final de control deja de
moverse.

Cargar el tiempo de ajuste medido
1. Para guardar en el proyecto el tiempo de posicionamiento del motor medido, haga clic en
el símbolo
"Transfiere datos online al proyecto offline".
El tiempo de ajuste medido se guarda en el ajuste de parámetros del FM.
2. Para que los cambios surtan efecto en el arranque siguiente de la CPU, haga clic en el
icono
"Cargar en dispositivo".

Cancelar medición del tiempo de posicionamiento
Si cancela la medición del tiempo de posicionamiento, el modo manual de las señales de
posicionamiento se conecta (LMNSOPON = TRUE) y el modo manual con especificación de
la variable manipulada se desconecta (LMNOP_ON = FALSE). El elemento final de control
deja de moverse.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1057

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3.5.5.5

FM 355: Diagnóstico a través de indicadores LED

Indicación de errores mediante el LED de error de grupo
Introducción
Si el LED rojo de error de grupo se enciende, significa que se ha producido un error en el
módulo (error interno) o en las conexiones (error externo).
Si el LED amarillo parpadea, el firmware se borra. Este estado sólo puede aparecer si existe
un defecto en el hardware o si el proceso de carga del firmware se cancela.

¿Qué errores se muestran?
Cuando se ilumina el LED de error de grupo se señalan los errores siguientes:
Tipo de
error

Aviso de diagnóstico

Errores in‐ Módulo defectuoso
ternos
Vigilancia de tiempo
(watch dog) activado

Errores
externos

Causa posible

Solución

Error de hardware

Cambie el módulo

Error de hardware

Cambie el módulo

Contenido EEPROM no
válido

Fallo de la tensión de alimenta‐
ción al parametrizar

Vuelva a parametrizar el
módulo

Parámetro erróneo en el
módulo

Se han transferido parámetros in‐ Vuelva a parametrizar el
correctos al módulo
módulo

Error en las entradas o las
salidas analógicas

Error de hardware en la entrada
analógica

Cambie el módulo

Rotura de hilo en la entrada ana‐ Solucione la rotura de hilo
lógica
Rebase por defecto del rango de Revise la señal de medi‐
medición en la entrada analógica ción
Rebase por exceso del rango de Revise la señal de medi‐
medición en la entrada analógica ción
Rotura de hilo en la salida analó‐ Solucione la rotura de hilo
gica
Cortocircuito en la salida analógi‐ Solucione el cortocircuito
ca
Falta tensión auxiliar ex‐
terna

Fallo en la alimentación 24 V

Restablezca la alimenta‐
ción de 24 V

Alarma de diagnóstico en caso de error
Todos los errores pueden disparar una alarma de diagnóstico si ésta se ha habilitado en la
pantalla de parametrización correspondiente. En los registros de diagnóstico DS0 y DS1
puede ver qué error ha provocado que se encienda el LED. La asignación de los registros de
diagnóstico DS0 y DS1 está descrita en el siguiente apartado.

1058

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Disparo de alarmas de diagnóstico
¿Qué es una alarma de diagnóstico?
Si se quiere que un programa de usuario responda a un error interno o externo, se puede
parametrizar una alarma de diagnóstico que interrumpa el programa cíclico de la CPU y llame
al OB de alarma de diagnóstico (OB 82).

¿Qué eventos pueden disparar una alarma de diagnóstico?
La siguiente lista muestra qué eventos pueden disparar una alarma de diagnóstico:
● Módulo no parametrizado o errores en la parametrización
● Módulo defectuoso
● Rotura de hilo en entradas analógicas (sólo 4 a 20 mA)
● Rebase por exceso y por defectos en entradas analógicas
● Rotura de carga y cortocircuito en salidas analógicas

Ajuste por defecto
La alarma de diagnóstico está bloqueada de forma predeterminada.

Habilitación de la alarma de diagnóstico
La pantalla "Parámetros básicos" permite bloquear o habilitar la alarma de diagnóstico para el
módulo.

Respuestas a un evento que dispara una alarma
Cuando se produce un evento que puede disparar una alarma de diagnóstico ocurre lo
siguiente:
● La información de diagnóstico se registra en los registros de diagnóstico DS0 y DS1 del
módulo.
● El LED de error de grupo se enciende.
● Se llama al OB de alarma de diagnóstico (OB 82).
● El registro de diagnóstico DS0 se graba en la información de arranque del OB de alarma de
diagnóstico.
● Si no hay ningún defecto de hardware, el módulo sigue regulando.
La CPU pasa a modo STOP si no se ha programado el OB 82.

Registro de diagnóstico DS0 y DS1
La información que indica qué evento ha provocado una alarma de diagnóstico se guarda en
los registros de diagnóstico DS0 y DS1. El registro de diagnóstico DS0 consta de cuatro bytes;
DS1 consta de 16 bytes, siendo los cuatro primeros idénticos a DS0.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1059

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Registros de diagnóstico DS0 y DS1
Leer el registro desde el módulo
El registro de diagnóstico DS0 se transfiere automáticamente a la información de arranque en
la llamada del OB de diagnóstico. Allí, estos cuatro bytes se guardan en los datos locales
(bytes 8-11) del OB 82.
El registro de diagnóstico DS1 se puede leer (y en consecuencia también el contenido de DS0)
desde el módulo con la instrucción "CH_DIAG". Esta lectura sólo tiene sentido si en el DS0 se
notifica un error en un canal.
La instrucción "CH_DIAG" debe llamarse en el mismo OB que el FB "PID_FM". Esto se
consigue con la medida siguiente: Ajuste un bit mientras el OB 82 se procesa. Consulte este
bit en el OB, en el que también se llama el FB "PID_FM" y llame la instrucción "CH_DIAG" en
el bit definido.

¿Cómo aparecen los textos de diagnóstico en el búfer de diagnóstico?
Si se desea registrar el aviso de diagnóstico en el búfer de diagnóstico, se debe llamar la
instrucción "WR_REC" "Introducir avisos específicos de usuario en el búfer de diagnóstico"
dentro del programa de usuario. En cada caso, el número de evento del aviso de diagnóstico
se especifica en el parámetro de entrada EVENTN. La alarma se introduce en el búfer de
diagnóstico con x=1 como entrante y con x=0 como saliente. El búfer de diagnóstico contiene
los textos de diagnóstico correspondientes en la columna de "Significado", así como el
momento en que se produjo la entrada.

1060

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Asignación del registro de diagnóstico DS0 en la información de arranque
La tabla siguiente muestra la asignación del registro de diagnóstico DS0 en la información de
arranque. Todos los bits que no se incluyen en la tabla son irrelevantes y tienen el valor cero.
Tabla 3-3
Byte
0

Asignación del registro de diagnóstico DS0
Bit

Significado

Nota

Nº de evento

0

Avería en módulo

Se activa en todos los eventos de diagnóstico

8:x:00

1

Error interno

Se activa en todos los errores internos:

8:x:01

● Vigilancia de tiempo activada
● Contenido de la EEPROM no válido; el
módulo arranca sin regular y espera a que
la CPU realice una nueva parametrización
● Error EPROM
● Error ADC/DAC
● Error de hardware en la entrada analógica
2

Error externo

Se activa en todos los errores externos:

8:x:02

● Falta tensión auxiliar externa
● Error de parametrización
● Rotura de hilo en la entrada analógica (sólo
en el margen 4 a 20 mA)
● Rebase por defecto del rango de medición
en la entrada analógica
● Rebase del rango de medición en la
entrada analógica
● Rotura de hilo en la salida analógica
● Cortocircuito en la salida analógica
3

Fallo en un canal

Consultar el DS1, a partir del byte 7, para más
detalles

8:x:03

4

Falta tensión auxiliar
externa

Fallo en la alimentación 24 V del FM 355

8:x:04

6

Contenido EEPROM
no válido

Fallo de la tensión de alimentación durante un
proceso de escritura en la EEPROM. El módulo
arranca con los parámetros predeterminados.

8:x:03

7

Error de parametriza‐ El módulo no puede utilizar un parámetro. Mo‐
ción
tivo: Parámetro desconocido o combinación de
parámetros no permitida.

8:x:07

Consulte el menú Sistema de destino > Mostrar
errores de parametrización
1

0 ... 3

Clase de módulo

4

Diagnóstico específi‐ Se activa cuando el módulo puede proporcio‐
co de canal
nar información del canal adicional y hay un
error de canal (consulte DS1 bytes 7 a 12)

2

3

Vigilancia de tiempo Error de hardware
(watch dog) activado

8:x:33

3

2

Error EPROM

Módulo defectuoso

8:x:42

4

Error ADC/DAC

Módulo defectuoso

8:x:44

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Siempre tiene asignado un 8

–
–

1061

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Asignación del registro de diagnóstico DS1
El registro de diagnóstico DS1 se compone de 16 bytes. Los 4 primeros bytes son idénticos a
los del registro de diagnóstico DS0. La siguiente tabla muestra la asignación de los bytes
restantes. Todos los bits que no se incluyen en la tabla son irrelevantes y tienen el valor cero.
Tabla 3-4

Asignación de los bytes del 4 a 12 del registro de diagnóstico DS1

Byte

Bit

Significado

Nota

Nº de evento

4

0 ... 7

Tipo de canal

Siempre tiene asignado 75H

–

5

0 ... 7

Longitud de la información de
diagnóstico

Siempre tiene asignado un 8

–

6

0 ... 7

Cantidad de canales

Siempre tiene asignado un 5 (4 regu‐
ladores + 1 canal de referencia)

–

7

0 ... 7

Vector de error de canal

Cada bit tiene asignado un canal

–

8

0

Error de hardware en la entra‐ Diagnóstico espe‐
da analógica
cífico del canal 1

8:x:B0

1

sin usar

8:x:B1

2

Rotura de hilo en la entrada
analógica (sólo en el margen
4 a 20 mA)

8:x:B2

3

sin usar

8:x:B3

4

Rebase por defecto del rango
de medición en la entrada
analógica

8:x:B4

5

Rebase del rango de medi‐
ción en la entrada analógica

8:x:B5

6

Rotura de hilo en la salida ana‐
lógica

Sólo en la salida
de intensidad
del regulador K

8:x:B6

7

Cortocircuito en la salida ana‐
lógica

Sólo en la salida
de tensión del
regulador K

8:x:B7

9

0 ... 7

Véase byte 8

Diagnóstico específico del canal 2

véase arriba

10

0 ... 7

véase byte 8

Diagnóstico específico del canal 3

véase arriba

11

0 ... 7

véase byte 8

Diagnóstico específico del canal 4

véase arriba

12

0 ... 5

véase byte 8

Diagnóstico para el canal de referen‐
cia

véase arriba

Información adicional
Para obtener más información sobre el parámetro "RET_REALU", consulte Lista de los avisos
RET_REALU (Página 1064) y el área de instrucciones avanzadas del sistema de ayuda.

1062

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Fallo del transductor de medida
Averías en los transductores de medida
El módulo de regulación puede detectar los siguientes fallos en el transductor de medida:
● Rebase por defecto del rango de medición
● Rebase del margen de medición
● Rotura de hilo (no se muestra en todos los márgenes de medición)
Si se produce una de estas averías en el registro de diagnóstico DS0 se define el bit de error
de grupo "Error externo" y, en el registro de diagnóstico DS1, bits de error específicos del canal
(consulte las tablas en la sección anterior). Cuando desaparecen estas averías los bits
correspondientes se desactivan.
La siguiente tabla muestra los límites de los diferentes márgenes de medición en los que los
bits de error se activan o desactivan:
Rango de medida

Bit de error Rebase por defec‐
to del rango de medición en ...

Bit de error Rebase del rango
de medición en ...

Bit de error Mostrar rotura de hi‐
lo

DS1: Byte 10 a 26, Bit 4

DS1: Byte 10 a 26, Bit 5

DS1: Byte 10 a 26, Bit 2

0 a 20 mA

< –3,5 mA

> 23,5 mA

–

4 a 20 mA

Bit de error = 1 a < 3,6 mA

> 22,8 mA

Bit de error = 1 a < 3,6 mA

Bit de error = 0 a > 3,8 mA

Bit de error = 0 a > 3,8 mA

0 a 10 V

< –1,175 V

> 11,75 V

–

Pt 100

< 30,82 mV

> 650,46 mV

–

< 30,82 mV

> 499,06 mV

–

< 30,82 mV

> 254,12 mV

–

Termoelemento tipo B

< 0 mV

> 13,81 mV

–

Termoelemento tipo J

< –8,1 mV

> 69,54 mV

–

Termoelemento tipo K

< –6,45 mV

> 54,88 mV

–

Termoelemento tipo R

< –0,23 mV

> 21,11 mV

–

Termoelemento tipo S

< –0,24 mV

> 18,7 mV

–

Termopar libre

< Valor de entrada inferior de
la línea poligonal

> Valor de entrada superior de
la línea poligonal

–

(–200 a 850 °C)
(–328 a 1562 °F)
Pt 100
(–200 a 556 °C)
(–328 a 1032 °F)
Pt 100
(–200 a 130 °C)
(–328 a 264 °F)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1063

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Lista de los avisos RET_REALU
Avisos RET_REALU

1064

JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

7000

28672

-32624

Primera llamada con REQ=0: No hay ninguna transferencia de
datos activa; BUSY tiene el valor 0.

7001

28673

-32624

Primera llamada con REQ=1: Transferencia de datos lanzada;
BUSY tiene el valor 1.

7002

28674

-32624

Llamada intermedia (REQ irrelevante). Transferencia de datos
ya activa; BUSY tiene el valor 1.

8090

32912

-32624

La dirección base lógica indicada no es válida: No existe nin‐
guna asignación en el SDB1/SDB2x, o no se trata de una di‐
rección base.

80A0

32928

-32608

Acuse negativo al leer el módulo. Módulo extraído durante la
lectura o módulo defectuoso.

80A1

32929

-32607

Acuse negativo al escribir en el módulo. Módulo extraído du‐
rante la escritura o módulo defectuoso.

80A2

32930

-32606

Error de protocolo para capa 2

80A3

32931

-32605

Error de protocolo en User-Interface / User

80A4

32932

-32604

Fallo de comunicación en el bus K

80B1

32945

-32591

Indicación de longitud errónea. Parámetro FM_TYPE del DB de
canal para el módulo utilizado no activado correctamente.

80B2

32946

-32590

El slot configurado no está ocupado.

80B3

32947

-32589

El tipo de módulo real no es igual al tipo de módulo teórico.

80C0

32960

-32576

El módulo aún no tiene preparados los datos que hay que leer.

80C1

32961

-32575

Los datos de una petición de escritura semejante todavía no se
han procesado en el módulo.

80C2

32962

-32574

El módulo procesa de instante el número máximo posible de
peticiones.

80C3

32963

-32573

Los recursos necesarios (memoria, etc.) están ocupados en
estos momentos.

80C4

32964

-32572

Error de comunicación

80C5

32965

-32571

La periferia descentralizada no está disponible.

80C6

32966

-32570

Cancelación de las clases de prioridad (rearranque normal o en
segundo plano)

8522

34082

-31454

DB del canal o DB de parámetros demasiado corto. No se pue‐
den leer los datos del DB. (petición de escritura).

8532

34098

-31438

El número de DB del DB de parámetros es demasiado grande.
(petición de escritura).

853A

34106

-31430

DB de parámetros no presente. (petición de escritura).

8544

34116

-31420

Error en el enésimo (n > 1) acceso de lectura a un DB tras
aparecer un error. (petición de escritura).

8723

34595

-30941

DB del canal o DB de parámetros demasiado corto. No se pue‐
den escribir los datos en el DB. (petición de lectura).

8730

34608

-30928

DB de parámetros protegido contra escritura en la CPU. No se
pueden escribir los datos en el DB (petición de lectura)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

8732

34610

-30926

El número de DB del DB de parámetros es demasiado grande.
(petición de lectura).

873A

34618

-30918

DB de parámetros no presente. (petición de lectura).

8745

34629

-30907

Error en el enésimo (n > 1) acceso de escritura a un DB tras
aparecer un error. (petición de lectura).

80ff

33023

-32513

Indicación de índice incorrecta en el bloque FMT_PAR

Los errores 80A2..80A4 así como 80Cx son temporales, es decir, se pueden eliminar tras un tiempo de
espera sin la intervención del usuario. Los avisos con la estructura 7xxx indican situaciones temporales
de la comunicación.

3.5.5.6

Proyectos de ejemplo de FM 355

3.5.6

Utilización del FM 355-2

3.5.6.1

Configuración del FM 355-2

Configurar el hardware
Procedimiento
Para poder configurar el hardware debe haber creado previamente un proyecto donde pueda
guardar la parametrización. A continuación se explican únicamente los pasos más importantes.
1. Inicie el TIA portal y abra la configuración de dispositivos.
2. Seleccione un rack.
3. Seleccione un módulo de regulación del catálogo de módulos.
4. Arrastre el módulo de regulación hasta la posición correspondiente del rack.
5. Anote la dirección de entrada del módulo a partir de la tabla de configuración, p. ej. 272.
El valor leído se muestra en formato decimal.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1065

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3.5.6.2

Parametrización del FM 355-2

Parámetros del módulo
Procedimiento
A través de la parametrización se configuran los parámetros del módulo.
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
Seleccione en la ventana de inspección la pestaña "Propiedades".
Resultado: Las propiedades se muestran en la ventana de inspección.
2. Configure los parámetros básicos del módulo y el resto de parámetros.
3. Configure los demás parámetros del bloque en la vista de configuración.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".
5. Compile el proyecto con "Editar > Compilar".
6. Cargue los datos de parametrización en el estado de STOP de la CPU con "Online > Cargar
en dispositivo..."
Resultado: Los datos se encuentran en la memoria de la CPU y se transfieren desde ésta
directamente al módulo.
7. Arranque la CPU.

Parámetros de la entrada analógica
Evaluación de la entrada analógica
Procedimiento
Para seleccionar un tipo de sensor proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Entrada analógica > Entrada [n°] > Evaluación de
la entrada analógica".
3. Defina los siguientes parámetros:
– Tipo de sensor entrada analógica
La opción "Vigilancia de rotura de hilo" se habilita para diversos tipos de sensor. Se
puede activar la opción según requerimiento.
– Temperatura de referencia
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

1066

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Funciones de filtro
Procedimiento
Para definir las funciones de filtro proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Entrada analógica > Entrada [n°] > Funciones de
filtro".
3. Defina los siguientes parámetros:
– Active la opción "Filtro de señal" para filtrar por una constante de tiempo.
Si la opción "Filtro de señal" se encuentra seleccionada se puede activar la constante de
tiempo del filtro.
– Constante de tiempo del filtro
Se puede activar solamente si la opción "Filtro de señal" se encuentra activada.
– Active la opción "Filtro de raíz cuadrada" para linealizar la señal del sensor.
– Active la opción "Filtro de polígono" para linealizar la característica de la señal del
sensor.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Filtro de señal
Filtro de primer orden cuya respuesta temporal viene determinada por la constante de tiempo.

Filtro de raíz cuadrada
Su finalidad es linealizar señales de sensores que están en relación cuadrada con la magnitud
de proceso medida, en las cuales el valor real obedece a una magnitud física.

Filtro de polígono
Su finalidad es linealizar características de sensores.
Los 13 nodos seleccionables se pueden seleccionar en:
● mA en entrada de corriente
● mV en entrada de tensión

Normalización
Procedimiento
Para convertir la señal de entrada en una unidad física proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Entrada analógica > Entrada [n°] > Normalización".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1067

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Defina los siguientes parámetros:
– Valor superior
– Valor inferior
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Normalización
Para convertir la señal de entrada en otra unidad física mediante interpolación lineal entre el
valor inicial (valor inferior) y el valor final (valor superior).

Error de regulación
Realizar un regulador de valor fijo o en cascada
Regulador de valor fijo o en cascada
En las estructuras de regulación 'Regulador de valor fijo o en cascada' el valor real efectivo es
idéntico al valor real A.

Seleccionar el tipo de regulador
Para realizar un regulador de valor fijo o en cascada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°]".
3. En el área "Tipo de regulador" seleccione la opción "Regulador de valor fijo o en cascada".
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para acondicionar la consigna proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".

1068

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Active los parámetros correspondientes en las diferentes áreas:
– Origen de la consigna
Seleccione el origen de la consigna.
– Consigna de seguridad
Ajuste aquí la consigna de seguridad. Defina asimismo la reacción a un fallo de la CPU
y el comportamiento en arranque.
– Rampa de consigna
Defina el tiempo de subida de rampa.
– Límite de consigna
Seleccione aquí los límites superior e inferior de consigna.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Seleccionar origen de la señal para el valor real A
Para seleccionar el origen de la señal para el valor real A proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. Seleccione el origen correspondiente en el área "Variable manipulada". Se dispone de las
siguientes opciones:
– Cero
– Entrada analógica acondicionada
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Realizar un regulador de 3 componentes
Regulador de 3 componentes
En la estructura de regulación 'Regulador de 3 componentes', el valor real efectivo se define
a través de la suma de los tres valores reales A, B y C, y mediante adición de un Offset
ajustable. Los valores reales B y C se pueden evaluar adicionalmente mediante factores.

Seleccionar el tipo de regulador
Para materializar un regulador de tres componentes, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°]".
3. En el área "Tipo de regulador" seleccione la opción "Regulador de 3 componentes".
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1069

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Acondicionamiento de la consigna
Para ajustar cómo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. Seleccione en el área "Origen de la consigna" el origen de referencia de la consigna.
4. Especifique un valor en el área "Consigna de seguridad", el cual será tomado como
consigna de seguridad en caso de fallo de la CPU y durante el arranque.
5. Especifique el comportamiento del módulo de regulación válido como "Reacción a fallo de
la CPU" y para el "Comportamiento en arranque". Las opciones posibles son:
– Consigna = última consigna válida: al producirse el evento se asigna a la consigna la
última consigna válida. Es decir, se mantiene la última consigna válida.
– Consigna = consigna de seguridad: al producirse el evento se asigna a la consigna la
consigna de seguridad. De esta forma se puede realizar un funcionamiento de
emergencia seguro.
6. Especifique en el área "Rampa de consigna" el tiempo de rampa que se debe mantener al
modificarse la consigna, para evitar una sobreoscilación.
7. Especifique en el área "Límite de consigna" un límite superior e inferior para la consigna.
8. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Seleccionar el origen de la señal para los valores reales A, B y C
Para especificar los orígenes de la señal para los valores reales A, B y C proceda del siguiente
modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. Seleccione en el área "Variable maniuplada" el origen de la señal correspondiente para
cada valor real. Puede seleccionar si no utiliza ninguna señal ("cero") como origen o si
utiliza una de las entradas analógicas acondicionadas.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Registrar factores para los valores reales B y C, así como para el Offset
Para especificar los orígenes de la señal para los valores reales A, B y C proceda del siguiente
modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. Especifique en el área "Sumar" el factor de ponderación requerido para los valores actuales
B y C.
4. Especifique el "Offset" necesario que se debe adicionar a los valores reales.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

1070

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Realizar un regulador de relación o mezcla
Seleccionar el tipo de regulador
Para materializar un regulador de relación o de mezcla, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°]".
3. En el área "Tipo de regulador" seleccione la opción "Regulador de relación o mezcla".
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para ajustar cómo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. Seleccione en el área "Origen de la consigna" el origen de referencia de la consigna.
4. Especifique un valor en el área "Consigna de seguridad", el cual será tomado como
consigna de seguridad en caso de fallo de la CPU y durante el arranque.
5. Especifique el comportamiento del módulo de regulación válido como "Reacción a fallo de
la CPU" y para el "Comportamiento en arranque". Las opciones posibles son:
– Consigna = última consigna válida: al producirse el evento se asigna a la consigna la
última consigna válida. Es decir, se mantiene la última consigna válida.
– Consigna = consigna de seguridad: al producirse el evento se asigna a la consigna la
consigna de seguridad. De esta forma se puede realizar un funcionamiento de
emergencia seguro.
6. Especifique en el área "Rampa de consigna" el tiempo de rampa que se debe mantener al
modificarse la consigna, para evitar una sobreoscilación.
7. Especifique en el área "Límite de consigna" un límite superior e inferior para la consigna.
8. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Seleccionar origen de la señal para los valores reales A y D
Para especificar los orígenes de la señal para los valores reales A y D proceda del siguiente
modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. Seleccione en el área "Variable manipulada" el origen de la señal correspondiente para
cada valor real. Puede especificar no utilizar ninguna señal ("cero") como origen o utilizar
una de las entradas analógicas acondicionadas, para el valor real D puede seleccionar
también el valor manipulado de uno de los reguladores.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1071

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Registrar multiplicador
Para especificar los orígenes de la señal para los valores reales A y D proceda del siguiente
modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. Seleccione en el área "Multiplicar" el Offset deseado.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".
En el regulador de relación, el valor real A se utiliza como magnitud de regulación y el valor real
D como magnitud de relación. La entrada de consigna sirve de factor de relación. Ésta se
acondiciona para obtener una consigna efectiva mediante multiplicación por el valor real D y
adición de un offset ajustable. Si se desactiva el valor real D, solamente se suma el Offset a la
consigna.

Ajustar la generación de alarmas
Procedimiento
Para ajustar la generación de alarma, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. En el área "Generar alarma" seleccione las opciones necesarias:
– En el área "Avisador de valor límite de" seleccione la señal a la que se debe aplicar la
alarma.
– En "Alarma límite superior" especifique el valor a partir del cual se disparará la alarma
al alcanzarse el límite superior.
– En "Advertencia límite superior" especifique el valor a partir del cual se disparará una
advertencia cuando se produzca una aproximación al límite superior.
– En "Advertencia límite inferior" especifique el valor a partir del cual se disparará una
advertencia cuando se produzca una aproximación al límite inferior.
– En "Alarma límite inferior" especifique el valor a partir del cual se disparará la alarma al
alcanzarse el límite inferior.
– Para evitar que centelleen los indicadores de vigilancia se puede configurar una
histéresis en "Histéresis".
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

1072

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Algoritmo de regulación
Realizar una regulación P
Procedimiento
Para realizar una regulación P proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. En el área "Tipo" seleccione la opción "Regulador PID".
4. En el área "General" seleccione la opción "P", en "Modo de operación".
Todas las opciones parametrizables para una regulación P se activan, el resto de opciones
se desactivan.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Realizar una regulación PI
Procedimiento
Para realizar una regulación PI proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. En el área "Tipo" seleccione la opción "Regulador PID".
4. En el área "General" seleccione la opción "PI", en "Modo de operación".
Todas las opciones parametrizables para una regulación PI se activan, el resto de opciones
se desactivan.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Realizar una regulación I
Procedimiento
Para realizar una regulación I proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. En el área "Tipo" seleccione la opción "Regulador PID".
4. En el área "General" seleccione la opción "I", en "Modo de operación".
Todas las opciones parametrizables para una regulación I se activan, el resto de opciones
se desactivan.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1073

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Realizar una regulación PID
Procedimiento
Para realizar una regulación PID proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. En el área "Tipo" seleccione la opción "Regulador PID".
4. En el área "General" seleccione la opción "PID", en "Modo de operación".
Todas las opciones parametrizables para una regulación PID se activan, el resto de
opciones se desactivan.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Realizar una regulación PD
Procedimiento
Para realizar una regulación PD proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. En el área "Tipo" seleccione la opción "Regulador PID".
4. En el área "General" seleccione la opción "PD", en "Modo de operación".
Todas las opciones parametrizables para una regulación PD se activan, el resto de
opciones se desactivan.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Realizar un regulador de temperatura con lógica difusa
Procedimiento
Para realizar una regulación P proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. En el área "Tipo" seleccione la opción "Módulo de regulación de temperatura por lógica
difusa".
Todas las opciones parametrizables para módulo de regulación de temperatura por lógica
difusa se activan, el resto de opciones se desactivan.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

1074

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Suprimir el nivel de ruido del error de regulación
Procedimiento
Para suprimir el nivel de ruido del error de regulación proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. Especifique en el área "General" el ajuste "Ancho de zona muerta".
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Control anticipativo
Procedimiento
Para conectar una variable perturbadora para control anticipativo proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. En el área "General" seleccione de la lista "Origen de la perturbación" el origen de la
variable perturbadora.
Seleccione la entrada "Cero" para no conectar ninguna variable perturbadora para control
anticipativo.
4. En "Factor de perturbación" especifique un valor de ponderación para la variable
perturbadora.
Un valor < 0 debilita la perturbación, un valor > 0 amplifica la perturbación. La perturbación
permanece invariable si se especifica el valor 1.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Poner la acción P en rama de realimentación
Procedimiento
Para realizar un regulador de valor fijo o en cascada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. En el área "Acción P" seleccione la opción "Por rama de realimentación".
Si la opción está activada, la acción P queda configurada por rama de realimentación.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1075

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Debilitar la acción D cuando se producen modificaciones en la consigna
Seleccionar el tipo de regulador
Para realizar un regulador de valor fijo o en cascada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. En el área "Acción D" seleccione con opción "Acción D" el origen de la acción D.
4. En el área "Factor derivativo" especifique el factor para la acción D.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Invertir el efecto del regulador
Principio
La inversión del regulador, cambiando la asignación de "error de regulación ascendente =
magnitud manipulada ascendente" a "error de regulación ascendente = magnitud manipulada
descendente", se realiza ajustando una ganancia proporcional (GAIN).

Procedimiento
Para invertir el efecto del regulador proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Algoritmo de regulación".
3. Especifique en el área "General" una ganancia proporcional con signo inverso.
Si se encuentra especificada una ganancia proporcional positiva y se desea invertir el
efecto del regulador, especifique una ganancia proporcional negativa.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Salida del regulador
Realizar un regulador continuo
Para realizar un regulador continuo se requiere un módulo analógico.

Procedimiento
1. Aplicar una variable manipulada externa (Página 1078)
2. Ajustar la variable manipulada de seguridad (Página 1079)
3. Activar el modo de seguimiento (Página 1078)
4. Limitar la variable manipulada (Página 1080)

1076

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
5. Controlar dos actuadores - rango partido (Página 1080)
6. Seleccionar la señal de salida y el tipo de señal (Página 1081)

Regulador paso a paso sin realimentación de posición
Para realizar un regulador paso a paso sin realimentación de posición se requiere un módulo
digital.

Procedimiento
1. Seleccionar la salida del regulador Regulador paso a paso sin realimentación de posición
2. Aplicar una variable manipulada externa (Página 1078)
3. Ajustar la variable manipulada de seguridad (Página 1079)
4. Formador de impulsos de la regulación paso a paso (Página 1080)

Realizar un regulador paso a paso con realimentación de posición
Para realizar un regulador paso a paso con realimentación de posición se requiere un módulo
digital.

Procedimiento
1. Seleccionar la salida del regulador Regulador paso a paso con realimentación de posición
2. Aplicar una variable manipulada externa (Página 1078)
3. Activar el modo de seguimiento (Página 1078)
4. Ajustar la variable manipulada de seguridad (Página 1079)
5. Limitar la variable manipulada (Página 1080)
6. Ajustar la realimentación de posición (Página 1079)
7. Formador de impulsos de la regulación paso a paso (Página 1080)

Realizar un regulador de impulsos
Para realizar un regulador de impulsos se requiere un módulo digital.

Procedimiento
1. Seleccionar la salida del regulador Regulador de impulsos
2. Aplicar una variable manipulada externa (Página 1078)
3. Activar el modo de seguimiento (Página 1078)
4. Ajustar la variable manipulada de seguridad (Página 1079)
5. Limitar la variable manipulada (Página 1080)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1077

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
6. Acondicionar la señal analógica para la conversión en señal digital
7. Convertir una señal analógica en una señal digital (Página 1081)

Parametrizar las funciones de la salida del regulador
Aplicar una variable manipulada externa
Procedimiento
Para aplicar la magnitud manipulada externa proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Salida del regulador".
3. Seleccione en el área "Magnitud manipulada externa" la opción que debe activar la
magnitud manipulada externa. Para ello puede seleccionar las siguientes opciones:
– Activación del bloque de función.
– Activación del bloque de función o de una de las entradas digitales.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Activar el modo de seguimiento
Procedimiento
Para activar el modo de seguimiento proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Salida del regulador".
3. Seleccione en el área "Modo de seguimiento" la opción que debe activar la magnitud
manipulada externa. Para ello puede seleccionar las siguientes opciones:
– Activación del bloque de función.
– Activación del bloque de función o de una de las entradas digitales.
4. Seleccione en el área "Modo de seguimiento" el origen de la señal a aplicar para el
seguimiento. Para ello puede seleccionar las siguientes opciones:
– Cero, con lo cual no se emplea ningún origen.
– Una de las entradas analógicas.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

1078

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Ajustar la realimentación de posición
Procedimiento
Para ajustar la realimentación de posición proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Salida digital > Salida [n°]".
3. Seleccione en el área "Entrada de realimentación de posición" la opción "Origen" para
especificar la señal de realimentación de posición.
– Cero: no se produce ninguna realimentación de posición.
– Una de las entradas analógicas acondicionadas.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Ajustar la variable manipulada de seguridad
Procedimiento
Para ajustar la variable manipulada de seguridad proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Salida del regulador".
3. Especifique en el área "Variable manipulada de seguridad" el valor a utilizar como variable
manipulada de seguridad.
4. Seleccione en el área "Activación" la opción que debe activar la magnitud manipulada
externa. Para ello puede seleccionar las siguientes opciones:
– Activación del bloque de función.
– Activación del bloque de función o de una de las entradas digitales.
5. Seleccione en "Reacción al arrancar el módulo" la opción a ejecutar al arrancar el módulo.
Para ello puede seleccionar las siguientes opciones:
– Lazo cerrado: el módulo entra inmediatamente en este modo al arrancar.
– Variable manipulada de seguridad: primero se regula a la variable manipulada de
seguridad.
6. Seleccione en el área "Reacción si falla el transductor de medida del valor real A" la opción
a ejecutar si falla el transductor de medida del valor real A.
7. Seleccione en el área "Reacción si falla el transductor de medida de una entrada" la opción
a ejecutar si falla el transductor de medida de una entrada.
8. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1079

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Limitar la variable manipulada
Procedimiento
Para limitar la variable manipulada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Salida del regulador".
3. Especifique en el área "Límite de señal de salida" los siguientes valores:
– Valor superior: representa el límite superior para la señal de salida.
– Valor inferior: representa el límite interior para la señal de salida.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Controlar dos actuadores - rango partido
Procedimiento
Para controlar dos actuadores proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Salida del regulador".
3. Seleccione en el área "Rango partido" la opción "Activar" para controlar dos actuadores.
4. Especifique los siguientes valores, para las señales de entrada y salida A y también para
las entradas de entrada y salida B.
– Señal de entrada inferior.
– Señal de entrada superior.
– Señal de salida inferior.
– Señal de salida superior.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Formador de impulsos de la regulación paso a paso
Procedimiento
Para parametrizar el formador de impulsos proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Salida digital > Salida [n°]".

1080

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Especifique en el área "Formador de impulsos" los siguientes parámetros:
– Tiempo de posicionamiento del motor.
– Duración mínima de impulso.
– Duración mínima de pausa.
4. Seleccione la opción adecuada para los valores superior e inferior, a partir de la cual se
aplicará el valor:
– del bloque de función.
– Del bloque de función o de una de las entradas digitales.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Convertir una señal analógica en una señal digital
Procedimiento
Para convertir una señal analógica en una señal digital proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Salida digital > Canal [n°]".
3. Especifique en el área "Formador de impulsos" los siguientes parámetros:
– Duración mínima de impulso.
– Duración mínima de pausa.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Seleccionar la señal de salida y el tipo de señal
Procedimiento
Para seleccionar la señal de salida y el tipo de señal proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Salida analógica > Salida [n°]".
3. Seleccione en la opción "Origen" la señal a utilizar como señal de salida. Se dispone de las
siguientes opciones:
– Cero: ningún origen para la señal de salida.
– Una de las entradas analógicas.
– Uno de los valores manipulados para el regulador A o B.
4. Seleccione en la opción "Tipo de señal" el tipo de señal en que se emitirá la señal de salida.
5. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1081

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3.5.6.3

Puesta en servicio del FM 355-2

Crear y configurar un DB de instancia
Crear y configurar un DB de instancia
1. Cree un programa de usuario que efectúe cíclicamente una llamada a la instrucción
FMT_PID.
2. En el programa del usuario, ponga READ_OUT cíclicamente a TRUE.
3. Genere para cada canal del regulador un DB de instancia de la instrucción FMT_PID.
4. Para cada DB de instancia, introduzca la dirección de módulo en el parámetro MOD_ADDR.
Utilice como dirección de módulo del FM 355-2 la dirección inicial que ha especificado al
configurar el hardware.
5. Introduzca en el parámetro FMT_PID.CHANNEL el número del canal del regulador (0, 1, 2
o 3).
1. Si utiliza las instrucciones FMT_PAR y FMT_TUN, introduzca en los parámetros
FMT_PAR.CHANNEL y FMT_TUN.CHANNEL el número del canal del regulador.
2. Compruebe que esté activado el "Tipo de sensor Entrada analógica" del canal en cuestión.
Si no se procesa la entrada analógica, todos los parámetros PID se ajustan a cero, y no se
calcula ninguna variable manipulada.
Nota
DBs multiinstancia
Si utiliza DBs multiinstancia en su proyecto, los FM se deben poner en servicio a través de
una tabla de observación.

Puesta en servicio del regulador
Introducción
Los parámetros PID se pueden optimizar del modo siguiente:
● Optimización inicial
● Optimización fina de la calefacción
● Optimización fina de la refrigeración
● Optimización fina manual

Procedimiento
Para optimizar un regulador, proceda del siguiente modo:
1. Coloque la CPU en el estado RUN.
2. Al utilizar un regulador S se mide el tiempo de posicionamiento del motor.

1082

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Realice una optimización del regulador.
4. Observe el lazo de regulación con el registrador de curvas.

Posibilidades de optimización del regulador
Optimización inicial
Durante esta optimización, el punto de operación del estado frío se pone en marcha a través
de un escalón de consigna.
Con TUN_ON = TRUE, cree la disposición de optimización. El regulador cambia de PHASE = 0
a PHASE = 1.
3+$6( 

3+$6( 

3+$6(


3+$6( 

3+$6( 

63

r&
/01

(VWDGRGH
SURFHVR
HQFDOLHQWH
SXQWRGH
WUDEDMR

39
781B'/01
3XQWRGH
LQYHUVLµQ

/01

(VWDGRGH
SURFHVRHQ
IU¯R
W
781B21
W

La variable manipulada de la optimización (LMN0 + TUN_DLMN) se aplica mediante
modificación de la consigna (transición PHASE 1 -> 2). La consigna no es efectiva hasta que
se alcanza el punto de inversión (sólo entonces se conmutará al modo Automático).
El delta de la excitación manipulada (TUN_DLMN) se define de acuerdo con la modificación
admisible del valor real bajo responsabilidad propia. El signo de TUN_DLMN debe estar en
concordancia con la modificación prevista del valor real (observar el sentido de regulación).
El escalón de consigna y TUN_DLMN deben estar coordinados. Un TUN_DLMN demasiado
grande conlleva el peligro de que el punto de inversión no esté dentro del 75% del escalón de
consigna.
Sin embargo, TUN_DLMN debe ser lo suficientemente grande como para que el valor real
alcance como mínimo el 22% del escalón de consigna. En caso contrario, el procedimiento
permanece en modo Optimización (fase 2).

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1083

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Solución: reduzca la consigna durante la búsqueda del punto de inversión.
Nota
En procesos con un fuerte retardo, es aconsejable definir para la optimización una consigna de
destino un poco más baja que el punto de operación deseado y observar con detenimiento los
bits de estado y el PV (peligro de sobreoscilaciones).
Optimización únicamente en el rango lineal:
Determinados sistemas regulados (p. ej., calderas de fusión de zinc o magnesio) pasan por un
rango no lineal poco antes del punto de operación (modificación del estado de agregación).
Si se selecciona con habilidad el escalón de consigna es posible limitar la optimización al rango
lineal. Si el valor real ha pasado del 75% del escalón de consigna (SP_INT-PV0), la
optimización concluye.
Paralelamente, TUN_DLMN debería reducirse hasta que el punto de inversión se encuentre
con seguridad antes de alcanzar el 75% del escalón de consigna.

Optimización fina de la calefacción
Durante esta optimización, el proceso se excita, en caso de una consigna constante, mediante
un salto de la variable manipulada.

r&
/01

3+$6( 

3+$6( 

7LSRGHVLVWHPD, 3+$6( 
3+$6(
 7LSRGHVLVWHPD,,R,,, 3+$6( 

3+$6( 

39
9DORUUHDOGHOSXQWRGH
RSHUDFLµQ

3XQWRGH
LQYHUVLµQ
63

781B'/01

781B21

/01

VHGHVDFWLYD
DXWRP£WLFDPHQWH

9DORUPDQLSXODGRGHOSXQWRGH
RSHUDFLµQ

W

W
781B67
W

1084

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
La variable manipulada de la optimización (LMN0 + TUN_DLMN) se aplica mediante activación
del bit de inicio TUN_ST (transición fase 1 -> 2). Si se modifica la consigna, la nueva consigna
no es efectiva hasta que no se alcanza el punto de inversión (sólo entonces se conmuta al
modo Automático).
El delta de la excitación manipulada (TUN_DLMN) se define de acuerdo con la modificación
admisible del valor real bajo responsabilidad propia. El signo de TUN_DLMN debe estar en
concordancia con la modificación prevista del valor real (observar el sentido de regulación).
ATENCIÓN
Si la excitación se realiza mediante TUN_ST no se produce ninguna desconexión de
seguridad al 75%. La optimización finaliza cuando se alcanza el punto de inversión. Sin
embargo, en procesos con ruidos es posible que se sobrepase claramente el punto de
inversión.

Optimización fina de la refrigeración
Durante esta optimización, el proceso se excita, en caso de una consigna constante, mediante
un salto de la variable manipulada.
r&
/01

3+$6( 

3+$6( 

39

7LSRGHVLVWHPD, 3+$6( 
3+$6(
 7LSRGHVLVWHPD,,R,,, 3+$6( 

63

9DORUUHDOGHOSXQWRGH
RSHUDFLµQ

3XQWRGH
LQYHUVLµQ

/01
9DORUPDQLSXODGRGHOSXQWRGH
RSHUDFLµQ

781B&/01

VHGHVDFWLYD
DXWRP£WLFDPHQWH

781B21

3+$6( 

W

W
781B&67
W

La variable manipulada de la optimización (LMN0 + TUN_CLMN) se aplica mediante la
activación del bit de inicio TUN_CST (transición fase 1 -> 2). Entretanto, la variable manipulada
determinada anteriormente LMN0 se mantiene constante y TUN_CLMN se aplica
directamente en la función de rango dividido, por lo que sólo se modifica la potencia de
refrigeración. TUN_CST se vuelve a desactivar de inmediato.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1085

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Si modifica la consigna durante la fase 2, la nueva consigna no es efectiva hasta que se
alcance el punto de inversión (sólo entonces se pasa al modo automático).
El delta de la excitación manipulada (TUN_CLMN) se define de acuerdo con la modificación
admisible del valor real bajo responsabilidad propia. El signo de TUN_CLMN debe estar en
concordancia con la modificación prevista del valor real (observar el sentido de regulación).
Tenga en cuenta que un TUN_CLMN negativo provoca un aumento de la potencia de
refrigeración. No obstante, con TUN_CLMN > 0.0 también se puede aplicar un escalón de la
variable manipulada reduciendo la potencia de refrigeración.
ATENCIÓN
Si la excitación se realiza mediante TUN_CST no se produce ninguna desconexión de
seguridad al 75%. La optimización finaliza cuando se alcanza el punto de inversión. Sin
embargo, en procesos con ruidos es posible que se sobrepase claramente el punto de
inversión.
Función de rango dividido
En la optimización, la pendiente de la función de rango dividido se atribuye al proceso. Si
modifica la pendiente de la función de rango dividido después de la optimización, también debe
adaptar en consecuencia el parámetro del regulador GAIN o RATIOFAC.

Optimización fina manual en modo de regulación
Para conseguir un comportamiento de consigna sin sobreoscilaciones, pueden tomarse las
medidas siguientes:
● Adaptar la zona de regulación
● Optimizar el comportamiento de referencia
● Amortiguar los parámetros de regulación
● Modificar los parámetros de regulación

Optimización automática
Requisitos del proceso
Régimen transitorio
El proceso debe presentar un régimen transitorio estable, con retardo y asintótico.
Después de un salto de la magnitud manipulada, el valor real debe pasar a un estado
estacionario. Con ello se excluyen procesos que presentan un comportamiento oscilante
incluso sin regulación, así como procesos regulados sin compensación (integrador en el
proceso regulado).

1086

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Consolidación de un estado inicial cuasi-estacionario (fase 0)
Si el valor real presenta oscilaciones de baja frecuencia, p. ej., debido a unos parámetros del
regulador incorrectos, antes de iniciar la optimización se debe situar el regulador en modo
manual y esperar a que desaparezcan las oscilaciones. Alternativamente, también puede
conmutar a un regulador PI con ganancia proporcional pequeña y periodo de integración
grande.
Ahora deberá esperar hasta que se alcance el estado estacionario, es decir, hasta que el valor
real y la variable manipulada sean estacionarios. También está permitido un régimen
transitorio asintótico o un desplazamiento lento del valor real (estado cuasi-estacionario,
consulte la figura siguiente). La magnitud manipulada debe ser constante u oscilar alrededor
de un valor medio constante.
Nota
Evite modificar la magnitud manipulada justo antes del inicio de la optimización. La variable
manipulada también se puede modificar de manera involuntaria al alterar las condiciones de
ensayo (p. ej., cerrar una puerta abierta). Si este fuera el caso, deberá esperar como mínimo
a que el valor real experimente de nuevo un régimen transitorio de forma asintótica a un estado
estacionario No obstante, conseguirá mejores parámetros de regulación, si espera hasta que
el proceso de régimen transitorio haya finalizado completamente.
En la siguiente figura, se muestra el régimen transitorio al estado estacionario:
39

9DORUUHDO

(VWDGRQRHVWDFLRQDULR
QRSHUPLWLGR

3+$6( 

3+$6( 

(VWDGRFXDVLHVWDFLRQDULR
D¼QSHUPLWLGR

(VPHMRUXQHVWDGR
HVWDFLRQDULRHVWDELOL]DGR

39

W

/01

9DORUPDQLSXODGR
,PSXOVRGHOYDORUPDQLSXODGR
/01

W

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1087

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Linealidad y zona de trabajo
El proceso debe presentar un comportamiento lineal en la zona de trabajo. Un comportamiento
no lineal se produce, p. ej., con un cambio de un estado de agregación. La optimización debe
tener lugar en una parte lineal de la zona de trabajo.
Esto significa que, tanto para la optimización como para el modo de regulación normal, los
efectos no lineales dentro de dicha zona de trabajo deben ser despreciablemente pequeños.
Sin embargo, en caso de cambio del punto de operación, el proceso se puede optimizar de
nuevo ejecutando la optimización en un margen reducido en torno al nuevo punto de operación
y si no se atraviesa ninguna zona de no linealidad.
Si la presencia de ciertas zonas estáticas de no linealidad (p. ej., características de válvulas)
es conocida, resulta siempre aconsejable compensarlas previamente con una línea poligonal
para linealizar el comportamiento del proceso.

Perturbaciones en procesos de temperatura
Las perturbaciones, como la transferencia de calor a zonas colindantes, no deben influir
excesivamente en el proceso global de temperatura. Así, p. ej., al optimizar las zonas de una
extrusionadora, todas las zonas deben calentarse simultáneamente.

Desarrollo de la optimización del regulador
Parámetros de regulador PI/PID
En el FM 355-2, con la optimización del regulador se ajustan automáticamente los parámetros
del regulador PI/PID. Se pueden optimizar tanto procesos de sólo calefacción o sólo
refrigeración, como procesos con dos actuadores de efectos opuestos (p. ej., actuador
calefactor y actuador refrigerador).

Fases de la optimización del regulador
Durante la optimización del regulador se ejecutan fases individuales, que se indican en el
parámetro PHASE .

PHASE = 0
No se efectúa ninguna optimización. El FM 355-2 funciona en modo automático o en modo
manual.
Mientras PHASE = 0, el sistema regulado debe cumplir con los requisitos para una
optimización.
Al final de la optimización, FM 355-2 vuelve a cambiar a PHASE = 0.

PHASE = 1
FM 355-2 se encuentra en disposición de optimización. La PHASE = 1 sólo puede iniciarse si
se cumplen las condiciones para una optimización.

1088

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Mientras PHASE = 1 se calculan los siguientes valores:
● Ruido del valor real NOISE_PV
● Subida inicial PVDT0
● Valor medio de la variable manipulada

PHASE = 2
En la fase 2 se busca el punto de inversión del valor real con una variable manipulada
constante. El procedimiento impide que el punto de inversión se detecte demasiado pronto
debido al ruido de PV:
Al principio, este cálculo del valor medio permanece inactivo, es decir, sólo se calcula el valor
medio a lo largo de un ciclo. En cuanto el ruido excede una medida determinada, se duplica el
número de ciclos.
Se determinan el período y la amplitud del ruido. La búsqueda del punto de inversión no se
cancela y se sale de la fase 2 hasta que el gradiente es siempre menor que el ascenso máximo
durante el período estimado. Sin embargo, TU y T_P_INF se calculan en el punto de inversión
real.
De todas formas, la optimización no finaliza hasta que se cumplen las dos condiciones
siguientes:
1. El valor real está más alejado del punto de inversión que 2*NOISE_PV.
2. El valor real ha superado el punto de inversión en un 20%.
Nota
En caso de excitación mediante escalón de consigna, la optimización finaliza a más tardar
cuando el valor real ha superado el 75% del escalón de consigna (SP_INT-PV0) (véase
abajo).

PHASE = 3, 4, 5, 6
Cada una de las fases 3, 4, 5 y 6 dura 1 ciclo.
En la fase 3, se guardan los parámetros PI/PID válidos antes de la optimización y se calculan
los parámetros del proceso.
En la fase 4, se calculan los nuevos parámetros PI/PID.
En las fases 5 y 6 se calcula la nueva variable manipulada y se envía al sistema regulado.
Si se ha identificado un sistema regulado del tipo I, el modo de optimización finaliza y la
optimización se encuentra de nuevo en la fase 0. A continuación, el regulador arranca siempre
con LMN = LMN0 + 0.75*TUN_DLMN en el modo automático (aunque lo hubiera regulado en
el modo manual antes del inicio de la optimización).
Si se ha identificado un sistema regulado del tipo II o III, la optimización pasa a la fase 7.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1089

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

PHASE = 7
En los sistemas típicos de temperatura (tipo de sistema l) se corre el riesgo de detectar el punto
de inversión demasiado pronto a causa del ruido. En tal caso, el escaso tiempo necesario para
alcanzar el punto de inversión T_P_INF puede provocar que se detecte el tipo de sistema II o
III.
Por ello, en la fase 7 se comprueba si el tipo de sistema es correcto. Esta comprobación se
efectúa en el modo automático con los parámetros del regulador recién calculados y finaliza,
a más tardar, al cabo de 6*TA (tiempo de compensación) tras el punto de inversión. Si se
detecta el tipo de sistema I, los parámetros del regulador se calculan de nuevo
(STATUS_D = 122); de lo contrario, los parámetros del regulador se mantienen sin cambios.
La comprobación del tipo de sistema se cancela si el valor real durante la optimización del
punto de trabajo alcanza de nuevo el valor real previo a la optimización PV0.
Si la fase 7 se cancela con TUN_ON = FALSE, se conservan los parámetros del regulador ya
calculados.
Nota
En principio, la optimización de la calefacción puede comenzar durante la refrigeración. En tal
caso, la comprobación de orden en la fase 7 no se efectúa.
El caso contrario (inicio de la optimización de la refrigeración durante la calefacción) no resulta
crítico ya que, en principio, la fase 7 de la optimización de refrigeración no se efectúa.

Cancelación anticipada de la optimización
En las fases 1, 2 ó 3, la optimización se puede cancelar sin calcular parámetros nuevos
mediante el restablecimiento de TUN_ON = FALSE. El regulador empieza en modo automático
con LMN = LMN0. Si el regulador se encontraba en modo manual antes de la optimización, se
emitirá la variable manipulada manual antigua.
Si la optimización se cancela en la fase 4, 5, 6 o 7 con TUN_ON = FALSE, los parámetros del
regulador calculados hasta ese momento se conservan.

Resultado de la optimización
Estado de optimización
La cifra izquierda de STATUS_H y STATUS_C muestra el estado de optimización.
STATUS_H
STATUS_C

1090

Resultado

0

Se han encontrado parámetros del regulador predeterminados, ninguno o nin‐
guno nuevo.

10000

Encontrados parámetros de regulador apropiados

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
STATUS_H
STATUS_C

Resultado

2xxxx

Se han encontrado parámetros del regulador superiores a los valores estima‐
dos; compruebe el comportamiento de regulación, lea el aviso de diagnóstico
STATUS_H/C y repita la optimización del regulador.

3xxxx

Se han producido errores de operador; lea el aviso de diagnóstico STATUS_H/
C y repita la optimización del regulador.

Los siguientes parámetros del regulador se actualizan tras detectar el punto de inversión en la
fase 6 en el FM 355-2 y en el DB de instancia online de la instrucción FMT_PID:
● Factor de atenuación del componente proporcional PFAC_SP = 0,8
● Ganancia del regulador GAIN
● Periodo de integración TI (limitado a ≥0,5 s)
● Periodo de derivación TD (limitado a ≥1,0 s)
● Factor diferencial D_F = 5,0
● Zona de regulación on/off CONZ_ON=TRUE/FALSE
● Ancho de zona de regulación CON_ZONE=250/GAIN
● P_SEL = TRUE (aunque previamente el regulador integral puro)
Si RATIOFAC<>0,0, CON_ZONE se multiplica por 1,5.
Si el TD calculado por la optimización es <1,0 s, sólo se detecta un regulador PI y tanto PID_ON
como los parámetros PID se ponen a 0.
La zona de regulación sólo se activa si el tipo de sistema es adecuado (tipo de sistema I y II)
y si el regulador PID está activado (CONZ_ON = TRUE).
En función de PID_ON se regula con el regulador PI o PID. Los parámetros antiguos del
regulador se guardan y pueden volver a activarse mediante UNDO_PAR. Además, también se
guarda un juego de parámetros PI y un juego de parámetros PID. Mediante LOAD_PID y la
activación correspondiente de PID_ON, también es posible cambiar más adelante entre los
parámetros optimizados PI o PID.
Si previamente existía una descomposición de la estructura (componente diferencial en la
realimentación), ésta se mantiene.
Nota
Nada más terminar la optimización del regulador, compruebe el funcionamiento correcto de los
parámetros del regulador.
Función de rango dividido
En la optimización, la pendiente de la función de rango dividido se atribuye al proceso. Si
modifica la pendiente de la función de rango dividido después de la optimización, también debe
adaptar en consecuencia el parámetro del regulador GAIN.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1091

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Síntomas de error y soluciones posibles
Interceptar errores de operador
Todos los errores recogidos en esta tabla provocan que la optimización quede cancelada.
Error
Activación simultánea de TUN_ON y
TUN_ST o TUN_CST

STATUS y medidas
STATUS_H/C = 30001
● Transición a la fase 0
● TUN_ON = FALSE

El signo de la modificación de la consigna
no concuerda con el cambio del valor real.

Comentario
No puede aparecer con los asistentes,
ya que en la primera pantalla TUN_ST y
TUN_CST se ponen a FALSE.

Finalización de la optimización en el
punto de inversión
Desconexión de seguridad al 75%
sin efecto

|TUN_DLMN| o |TUN_DLMN efectivo| < 5%
(fin de la fase 1)

STATUS_H/C = 30002/30004

● Transición a fase 99 (fase 0 en
Caso especial STATUS_H=30004:
optimización paralela)
Diferencia efectiva de la variable manipula‐
● Se emite LMN = LMN0
da limitada por los límites de rango dividido
y no por los límites de la variable manipulada

Puede que haya parametrizado un valor
demasiado bajo para TUN_DLMN o que
la variable manipulada estuviera próxi‐
ma a un límite de posicionamiento antes
del inicio de la optimización.
Si STATUS_H=30004: Recuerde ade‐
más que, p. ej., con LMN_A < 5% no es
posible una optimización de calenta‐
miento con TUN_DLMN negativo (ra‐
zón: La potencia de refrigeración no
puede modificarse).
En ese caso hay que impedir que el re‐
gulador se ajuste a la nueva consigna y
abandone innecesariamente el punto
de operación estacionario (no es posi‐
ble en la optimización paralela).
Proceda del siguiente modo:
● Reducir consigna
● TUN_ON=FALSE
● Corregir TUN_DLMN
● Iniciar de nuevo la optimización

Sólo en el regulador paso a paso sin reali‐
mentación de posición analógica:

STATUS_H = 30002

Si TUN_CST:

STATUS_C = 30002/30004

|TUN_CLMN| o |TUN_CLMN efectivo| < 5%
(fin de la fase 1)

● Transición a la fase 0

● Transición a la fase 0
|TUN_DLMN efectivo| < 5% (inicio de la fase ● TUN_ON = FALSE
2)

Caso especial STATUS_H=30004:
Diferencia efectiva de la variable manipula‐
da limitada por los límites de rango dividido
y no por los límites de la variable manipula‐
da.

1092

● TUN_ON = FALSE

El error aparece si |TUN_DLMN| >= 5%
pero la variable manipulada estaba pró‐
xima a un límite de posicionamiento an‐
tes del inicio de la optimización.
Puede que haya parametrizado un valor
demasiado bajo para TUN_CLMN o que
la variable manipulada estuviera próxi‐
ma a un límite de posicionamiento antes
del inicio de la optimización.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Error

STATUS y medidas

Si TUN_CST:

STATUS_C = 30003

Caso especial de "|TUN_CLMN efectivo| <
5% (fin de la fase 1)":

● Transición a la fase 0

TUN_CLMN <= -5%, pero LMN_LLM > -5%.

● TUN_ON = FALSE

Comentario
El límite inferior LMN_LLM es demasia‐
do alto (p. ej., 0%) e impide por ello la
indicación de una potencia de refrigera‐
ción.

TUN_CST pero ninguna optimización ante‐ STATUS_C = 30008
rior de calentamiento
● Transición a la fase 0
● TUN_ON = FALSE
Modo de seguridad

STATUS_C = 30009
● Transición a la fase 0
● TUN_ON = FALSE

Si el FM 355-2 pasa en PHASE > 2 al
modo de seguridad, esta circunstancia
se muestra con STATUS_C=30009.

Punto de inversión no alcanzado (sólo en caso de excitación mediante escalón de consigna)
La optimización finaliza como muy tarde cuando el valor real ha pasado el 75 % del escalón de
consigna (SP_INT-PV0). Esta circunstancia se notifica mediante "Punto de inversión no
alcanzado" en STATUS_H/STATUS_C (2xx2x).
Siempre rige la consigna que está ajustada en cada momento. Así pues, si se reduce la
consigna, es posible que la optimización finalice anticipadamente.
En casos de procesos de temperatura típicos, suele bastar con cancelar la optimización al 75
% del escalón de consigna para impedir sobreoscilaciones. Sin embargo, hay que tomar
precauciones, especialmente en procesos con un retardo considerable (TU/TA > 0.1, tipo III).
Si la excitación manipulada es demasiado fuerte en comparación con el escalón de consigna,
el valor real tendrá muchas sobreoscilaciones (hasta el factor 3).
Si, en procesos de orden superior, el punto de inversión sigue muy alejado una vez alcanzado
el 75 % del escalón de consigna, hay una sobreoscilación clara. Además, los parámetros del
regulados son demasiado rigurosos. En este caso, atenúe los parámetros del regulador o
repita el ensayo.
La figura siguiente representa la sobreoscilación del valor real en caso de excitación
demasiado fuerte (tipo de sistema III):

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1093

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3+$6( 

3+$6( 

r&
/01

3+$6( 

3+$6( 

3+$6( 

/01
/01781B'/01
781B'/01

39TXHUHVXOWDU¯DVL
HO/01QRKD
FDPELDGR

3XQWRGHLQYHUVLµQ
39

(VWDGRGHSURFHVR
HQFDOLHQWH SXQWRGH
WUDEDMR

63
63

(VWDGRGH
SURFHVRHQIU¯R

W
781B21
W

En procesos de temperatura típicos, una cancelación justo ante de alcanzar el punto de
inversión no es crítica respecto de los parámetros del regulador.
Si repite el ensayo, reduzca TUN_DLMN o TUN_CLMN o bien aumente el escalón de consigna.
Principio: la variable manipulada de optimización debe concordar con el escalón de consigna.

Error de estimación con tiempo de retardo u orden
El tiempo de retardo (STATUS_H/STATUS_C = 2x1xx, 2x2xx o 2x3xx) o el orden (STATUS_H/
STATUS_C = 21xxx o 22xxx) no se han podido registrar correctamente. Se sigue trabajando
con un valor estimado que puede provocar parámetros no óptimos del regulador.
Repita la optimización y asegúrese de que no se produzcan perturbaciones en el valor real.
Nota
El caso especial de un proceso PT1 puro también se notifica con STATUS_H/STATUS_C =
2x2xx (TU < CYCLE). En este caso no es necesario repetir el ensayo. Atenúe los parámetros
del regulador si la regulación oscila.

1094

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Calidad de las señales medidas (ruido medido, perturbaciones de baja frecuencia)
El resultado de la optimización puede verse entorpecido por ruidos medidos o perturbaciones
de baja frecuencia. En tal caso, considere lo siguiente:
● Dentro de un período de ruido, el valor real debe muestrearse como mínimo dos veces. La
medida de ruido no debe superar un 5% del cambio de señal útil.
● Las perturbaciones radioeléctricas ya no se pueden filtrar con un módulo software. Dichas
perturbaciones ya deberían haberse filtrado en el sensor de medición para impedir el efecto
aliasing.
La figura siguiente representa el efecto aliasing con un tiempo de muestreo demasiado
grande:
;

W

● Si las perturbaciones son de baja frecuencia, se puede asumir que el período de muestreo
del FM 355-2 es suficientemente pequeño. Por otro lado, en tal caso el FM 355-2 debe
generar una señal medida homogénea debido al amplio intervalo de filtrado por valor
medio. Una filtración de valores medios debe abarcar como mínimo dos períodos de ruido.
De esta forma, dentro del bloque se generan rápidamente tiempos de muestreo más
grandes, de modo que se merma la precisión de la optimización. Una precisión suficiente
se garantiza con un mínimo de 40 períodos de ruido hasta el punto de inversión. Medidas
posibles al repetir el ensayo: aumentar TUN_DLMN/TUN_CLMN.

Sobreoscilación
En las situaciones siguientes pueden producirse sobreoscilaciones:
Situación

Causa

Fin de la optimi‐ ● Excitación mediante un cambio
zación
demasiado brusco de la variable
manipulada en comparación con el
escalón de consigna (véase arriba).
● Regulador PI activado mediante
PID_ON = FALSE.
Optimización
en fase 7

Solución
● Aumentar el escalón de consigna o
reducir el escalón de la variable
manipulada
● Si el proceso admite un regulador
PID, inicie la optimización con
PID_ON = TRUE.

Primero se han determinado parámetros más suaves para el regulador (tipo de sis‐
tema III) que pueden provocar sobreosci‐
laciones en la fase 7.

Modo de regula‐ Regulador PI y con PFAC_SP = 1.0 para el Si el proceso admite un regulador PID,
ción
tipo de sistema I.
inicie la optimización con PID_ON =
TRUE.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1095

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Optimización con regulador paso a paso
Introducción
En general son válidas las explicaciones de la optimización del regulador.

Particularidades para el regulador paso a paso
● Los reguladores paso a paso del FM 355-2 funcionan sin zona de regulación.
● La fase 7 no se lleva a cabo.
● Sin optimización de refrigeración.
Nota
El tiempo de posicionamiento del motor no es determinado por la optimización, por lo que
se debe medir o especificar antes del inicio de la optimización.

Diseño del regulador
El tiempo de posicionamiento del motor MTR_TM debe ser lo más pequeño posible en
comparación con el tiempo necesario para alcanzar el punto de inversión T_P_INF y el tiempo
de retardo TU.
Para valores más grandes del tiempo de posicionamiento del motor, automáticamente los
reguladores diseñados resultan más suaves.
Cuanto mayor sea la excitación manipulada TUN_DLMN, tanto más afecta el tiempo de
posicionamiento del motor en el diseño del regulador.

Parámetros PI o PID
En comparación con el diseño para reguladores continuos y reguladores de impulsos, los
parámetros PI se reducen aprox. un 25%. Los parámetros PID también se calculan (pero sin
el 25% de seguridad). Los parámetros PID únicamente se deben utilizar si el tiempo de
posicionamiento del motor no es demasiado grande en comparación con los parámetros del
proceso y si la solicitación del actuador por el componente diferencial no resulta excesiva.

Regulador paso a paso sin realimentación analógica de posición
La emisión de órdenes Abrir/Cerrar se detiene ya al principio de la fase 1 (cuasi-manual).
En la fase 1 no se calcula el valor medio de la variable manipulada (LMN0).
Al principio de la fase 2, durante el tiempo MTR_TM * TUN_DLMN / 100, se emite una orden
Abrir (o bien, si TUN_DLMN es negativo, una orden Cerrar).
Si una señal de tope se activa durante la pulsación en la fase 2, TUN_DLMN efectivo se calcula
como: 100 * tiempo / MTR_TM.
Si el valor de TUN_DLMN efectivo es < 5%, se emite el mensaje de error STATUS_H=30002
y la optimización se cancela. Este error sólo puede ocurrir si, contra toda previsión, el actuador
se encontraba cerca de un límite.

1096

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Fin o cancelación de la optimización
El regulador se inicia con LMN = LMN0 + TUN_DLMN.

Realizar una optimización inicial
Requisitos
● Las exigencias planteadas al proceso se cumplen.
● Se ha creado y configurado un DB de instancia para el canal.
● Como origen del valor real está parametrizado "Instrucción".
● El FM 355-2 no se encuentra en el modo de seguridad (SAFE_ON = FALSE). Si el modo de
seguridad se activa, la optimización en ejecución queda cancelada.

Procedimiento
ADVERTENCIA
Pueden producirse daños materiales considerables, lesiones físicas graves o incluso la
muerte.
Durante una optimización, el parámetro LMN_REON no tiene efecto alguno. Tampoco
intervienen los circuitos de seguimiento, p. ej., derivados de los límites de alarma. Por ello, la
variable manipulada o el valor real pueden tomar valores no deseados, e incluso extremos.
La variable manipulada se especifica mediante optimización. Para cancelar la optimización
se debe activar TUN_ON = FALSE. De este modo, LMN_REON vuelve a ser efectivo.
Para determinar los parámetros PID óptimos en la primera puesta en servicio, proceda del
siguiente modo:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el símbolo
"Medición activada".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. En la lista "Modo" seleccione la entrada "Optimización inicial".
El FM 355-2 se encuentra en disposición de optimización (PHASE = 1).
4. Espere hasta que alcance el estado estacionario.
5. En el campo "Escalón de la variable manipulada" indique el valor en el que debe
aumentarse la variable manipulada.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1097

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
6. En el campo "Consigna", indique una consigna. El escalón de la variable manipulada se
hace efectivo sólo con una nueva consigna.
7. Haga clic en el símbolo
"Iniciar optimización".
Se inicia la optimización inicial. Se muestra el estado de la optimización.
Nota
En la fase 1, una modificación de consigna muy pequeña (p. ej., ruido de medición de una
entrada analógica) puede activar una optimización. En ese caso, la optimización concluye
muy rápidamente (parámetros de regulador erróneos; peligro de inestabilidad).

Realizar optimización fina de calefacción
Requisitos
● Las exigencias planteadas al proceso se cumplen.
● Se ha creado y configurado un DB de instancia para el canal.
● Como origen del valor real está parametrizado "Instrucción".
● El FM 355-2 no se encuentra en el modo de seguridad (SAFE_ON = FALSE). Si el modo de
seguridad se activa, la optimización en ejecución queda cancelada.

Procedimiento
Para determinar los parámetros PID óptimos en el punto de operación, proceda del siguiente
modo:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el símbolo
"Medición activada".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. En la lista "Modo" seleccione la entrada "Optimización fina de calefacción".
El FM 355-2 se encuentra en disposición de optimización (PHASE = 1).
4. En el campo "Escalón de la variable manipulada" indique el valor en el que debe
aumentarse la variable manipulada.
5. Haga clic en el símbolo
"Iniciar optimización".
Se inicia la optimización fina. Se muestra el estado de la optimización.

1098

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Realizar optimización fina de refrigeración
Introducción
En las regulaciones que funcionan con dos actuadores de efectos opuestos (actuador
calefactor y actuador refrigerador), el FM355-2 determina con un escalón de la variable
manipulada del actuador refrigerador la relación entre las ganancias de proceso RATIOFAC
(ganancia de calefacción/ganancia de refrigeración). El ancho de la zona de regulación
CON_ZONE también se calcula de nuevo. Los demás parámetros del regulador se mantienen
sin cambios.

Requisitos
● Como origen del valor real está parametrizado "Instrucción".
● El FM 355-2 no se encuentra en el modo de seguridad (SAFE_ON = FALSE). Si el modo de
seguridad se activa, la optimización en ejecución queda cancelada.
● La optimización fina de calefacción para el canal ha concluido correctamente. Tras una falta
de corriente del FM 355-2, la optimización de calefacción se debe repetir.
● En una instalación con varias zonas de temperatura acopladas (p. ej., máquinas de
plástico), la optimización fina ha concluido correctamente para todas las zonas y se ha
alcanzado el estado estabilizado.
● La variable manipulada A se debe usar para la calefacción y la variable manipulada B para
la refrigeración.
● RATIOFAC es efectivo si LMN<0,0, por lo que la función de rango dividido debe estar
definida en consecuencia: A para LMN>=0,0 y B para LMN<0,0.
● Para que la optimización fina de la refrigeración pueda comenzar durante la calefacción, las
señales de calefacción y refrigeración deben poder ser efectivas en el proceso
simultáneamente.

Procedimiento
Para determinar los parámetros PID óptimos en el punto de operación, proceda del siguiente
modo:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el símbolo
"Medición activada".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. En la lista "Modo" seleccione la entrada "Optimización fina de la refrigeración".
El FM 355-2 se encuentra en disposición de optimización (PHASE = 1).
4. En el campo "Escalón de la variable manipulada" indique el valor en el que debe
aumentarse o disminuirse la variable manipulada.
5. Haga clic en el símbolo
"Iniciar optimización".
Se inicia la optimización fina. Se muestra el estado de la optimización.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1099

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Resultado
En cuanto se encuentra un punto de inversión en la evolución del valor real, el FM 355-2
retorna de nuevo al modo de regulación (FASE 0).
A diferencia de lo que ocurre en la optimización de la calefacción, los parámetros antiguos del
regulador no se guardan (el RATIOFAC antiguo ya se había guardado durante la optimización
de la calefacción) y la fase 4 no se lleva a cabo.
STATUS_D permanece inalterado y sigue siempre refiriéndose a la optimización de la
calefacción. También se conservan los juegos de parámetros PI y PID de la última
optimización de la calefacción, de tal modo que se pueden cargar con LOAD_PID después de
una optimización de la refrigeración.

Optimización paralela de los canales del regulador
Zonas vecinas con fuerte acoplamiento térmico
Si dos o más reguladores de un módulo regulan la temperatura p. ej. de una placa (p. ej. dos
calefacciones y dos valores reales medidos con fuerte acoplamiento de calor), existe la
posibilidad de realizar una optimización paralela para estos reguladores.

Procedimiento
Para optimizar simultáneamente varios canales, proceda del modo siguiente:
1. Parametrice los canales correspondientes en la zona A o en la zona B.
2. Inicie la optimización en uno de los canales. La optimización de los canales conexos se
inicia entonces automáticamente.
Nota
En caso de excitación por escalón de consigna, el usuario debe garantizar la activación
simultánea de los escalones de consigna. Los parámetros PID_ON y TUN_DLMN/
TUN_CLMN sólo se pueden especificar para un canal. Los parámetros para los demás
canales se deben predefinir a través de los correspondientes DBs de instancia de la
instrucción FMT_PID antes de iniciar la optimización.
Cancelación de la optimización
Si aparece un error en uno de los canales (fase 0 o final de la fase 1), se cancela la optimización
de todos los canales.
El usuario puede restablecer la optimización poniendo TUN_ON=FALSE en alguno de los
canales implicados.
Si un canal pasa al modo de seguridad, también se desactiva la optimización de los canales
implicados.
Sólo se muestra la información de estado del canal seleccionado. Encontrará las causas de
error de los canales restantes en los correspondientes DBs de instancia.

1100

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Ventaja
Los reguladores implicados emiten su correspondiente magnitud manipulada de optimización
hasta que todos los reguladores hayan abandonado la fase 2. De esta forma se evita que el
regulador que primero finalice la optimización falsifique el resultado de optimización del resto
de reguladores al modificar su magnitud manipulada.
PRECAUCIÓN
El hecho de alcanzar el 75% del escalón de consigna en uno de los canales implicados no
finaliza la optimización (peligro de sobreoscilación). El modo automático se inicia cuando
todos los reguladores implicados han finalizado su optimización.

Zonas vecinas con escaso acoplamiento térmico
En general se aplica la norma de que habría que optimizar tal y como se vaya a regular
después. Si en el modo de producción las zonas se recorren juntas en paralelo, de forma que
las diferencias de temperatura entre las zonas se mantienen iguales, durante la optimización
también debería aumentarse correspondientemente el nivel de temperatura de las zonas
vecinas.
Las diferencias de temperatura al principio del ensayo no son relevantes, porque se
compensan mediante una calefacción inicial adecuada (→pendiente inicial = 0).

Optimización fina manual en modo de regulación
Introducción
Para conseguir una respuesta de regulación sin sobreoscilaciones se pueden tomar las
medidas que se describen a continuación:

Adaptar la zona de regulación
En la optimización, el FM 355-2 determina un ancho de zona de regulación CON_ZONE y, si
el tipo de sistema es correcto (tipos de sistema I y II), el regulador PID se activa: CONZ_ON =
TRUE. En el modo de regulación es posible modificar la zona de regulación o desactivarla
completamente (con CONZ_ON = FALSE).
Ninguna zona de regulación para el tipo de sistema III ni para los reguladores PI y paso a paso.
Activar la zona de regulación en procesos de orden superior (tipo de sistema III) no suele
suponer ninguna ventaja, porque en ese caso la zona de regulación es mayor que el rango de
regulación asequible con el 100% de la variable manipulada. Tampoco es ventajoso activar la
zona de regulación para regulador PI.
Nota
Antes de activar a mano la zona de regulación, asegúrese de no ajustar un ancho de zona de
regulación demasiado pequeño. Si el ancho ajustado para la zona de regulación fuera
insuficiente, se producirán oscilaciones en las curvas de la variable manipulada y del valor real.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1101

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Atenuar continuamente la respuesta de regulación con PFAC_SP
La zona de regulación es la mejor posibilidad dinámica para conseguir una respuesta de
regulación sin sobreoscilaciones. Utilícela siempre que resulte posible, es decir, con los
reguladores PID para los tipos de sistema I y II.
Con los reguladores PI, tipo de sistema III, o en caso de escalón de consigna en la zona de
regulación, la respuesta de regulación se puede atenuar con el parámetro PFAC_SP. Dicho
parámetro determina qué proporción de la acción P será efectiva en casos de escalones de
consigna.
PFAC_SP es preajustado por la optimización a 0,8, independientemente del tipo de sistema;
el valor se puede modificar a continuación. Para limitar las sobreoscilaciones provocadas por
escalones de consigna a aprox. un 2% (si los demás parámetros del regulador son correctos),
resultan suficientes los valores siguientes para PFAC_SP:
Tipo de sistema I

Tipo de sistema II

Tipo de sistema III

Proceso de temperatura típico

Rango de transición

Proceso de temperatura de or‐
den superior

PI

0.8

0.82

0.8

PID

0.6

0.75

0.96

Ajuste el factor predeterminado (0.8), especialmente en los casos siguientes:
● Tipo de sistema I con PID (0,8 → 0,6): Con PFAC_SP = 0,8, los escalones de consigna
dentro de la zona de regulación siguen provocando una sobreoscilación del 18%.
● Tipo de sistema III con PID (0,8 → 0,96): Con PFAC_SP = 0,8 los escalones de consigna
se amortiguan demasiado. Se regala un tiempo de ajuste claro.

Amortiguar los parámetros de regulación
Si en el lazo cerrado de regulación se producen oscilaciones, o si hay sobreoscilaciones
después de escalones de consigna, se puede reducir la ganancia del regulador GAIN (p. ej.,
al 80% del valor original) y aumentar el periodo de integración TI (p. ej., al 150% del valor
original). Si la variable manipulada analógica del regulador continuo se convierte en señales
manipuladas binarias con un generador de impulsos, es posible que aparezcan pequeñas
oscilaciones continuas debido a los efectos de cuantificación. Éstas se pueden eliminar
ampliando la zona muerta DEADB_W.

Optimizar los parámetros PID manualmente
Requisitos
● Las exigencias planteadas al proceso se cumplen.
● Se ha creado y configurado un DB de instancia para el canal.
● Como origen del valor real está parametrizado "Instrucción".

1102

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para ajustar manualmente el regulador, proceda del modo siguiente:
1. Seleccione el DB de instancia del canal que desee optimizar.
2. Haga clic en el símbolo
"Medición activada".
Si aún no existe ninguna conexión online, ésta se crea. Se graban los valores actuales de
consigna, valor real y variable manipulada.
3. Introduzca los valores correspondientes para los parámetros siguientes:
– Acción P
– Ponderación del componente proporcional para escalones de consigna
– Acción I
– Acción D
– Coeficiente DT1
– Coeficiente calefacción/refrigeración
4. En el grupo "Optimización", haga clic en el símbolo

"Enviar parámetros PID al FM".

5. En el grupo "Valores actuales", active la casilla de verificación "Especificar consigna" .
6. Introduzca una nueva consigna.
7. Desactive en caso necesario la casilla de verificación "Modo manual" y, en el grupo
"Valores actuales", haga clic en el símbolo .
El regulador trabaja con los nuevos parámetros y regula según la nueva consigna.
8. Compruebe la calidad de los parámetros PID mediante los recorridos de la curva.
9. Repita los pasos del 3 hasta el 8, hasta que esté satisfecho/a con el resultado de la
regulación.
Nota
FMT_PID.OP.UNDO_PAR = TRUE permite ajustar de nuevo los parámetros antiguos del
regulador.

Cargar los parámetros optimizados en el dispositivo
Introducción
Para impedir que los parámetros del FM se sobrescriban con los datos del sistema en el
siguiente arranque de la CPU, se puede proceder del modo siguiente:
● Tras cada arranque del FM 355-2, cargue en este con LOAD_PAR = TRUE los parámetros
PID optimizados del DB de instancia del FMT_PID.
● Cargue los parámetros PID optimizados en el SDB.
Nota
Los juegos de parámetros PI, PID y SAVE no se pueden guardar en el SDB.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1103

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Procedimiento
Para cargar los parámetros en el SDB, proceda del siguiente modo:
1. Haga clic en el símbolo
"Transfiera datos online al proyecto offline".
Los parámetros PID se guardan en el ajuste de parámetros del FM.
2. Pare la CPU.
3. Haga clic en el símbolo

"Cargar en dispositivo".

Guardar y volver a cargar los parámetros del regulador
Juego de parámetros guardado
En el FM 355-2 se dispone de un juego de parámetros guardado además del juego de
parámetros efectivo. Para guardarlo y volverlo a cargar se emplea SAVE_PAR y UNDO_PAR
en la estructura OP de la instrucción FMT_PID.
Así se puede, p. ej., guardar los parámetros actuales con SAVE_PAR = TRUE antes de
introducir un cambio manual. Por medio de UNDO_PAR = TRUE se pueden volver a activar
para el regulador los parámetros de éste guardados en último lugar. Una vez finalizada la
acción, FMT_PID desactiva SAVE_PAR o UNDO_PAR.
Si desea saber qué valores se encuentran en el juego de parámetros actual y cuáles hay en el
juego de parámetros guardado, puede leerlos por medio de FMT_PID.READ_PAR = TRUE o
FMT_TUN.READ_OUT = TRUE:
Parámetros actuales en la estructura del PAR del
FMT_PID:

Parámetros guardados en los parámetros de sali‐
da del FMT_TUN:

PFAC_SP

SAV_PFAC

GAIN

SAV_GAIN

TI

SAV_TI

TD

SAV_TD

D_F

SAV_D_F

CON_ZONE

SAV_CONZ

RATIOFAC

SAV_RATI

CONZ_ON

SAV_CZON

P_SEL

SAV_PSEL

Nota
Al final de una optimización del regulador, los parámetros guardados se sobrescriben con los
valores válidos antes de la optimización (excepción: en la optimización de la refrigeración se
suprime este almacenamiento intermedio).

1104

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Cambio entre parámetros PI y PID
Después de una optimización, tanto los parámetros PI como los PID se guardan en el
FM355-2. La carga de estos juegos de parámetros se lleva a cabo activando
FMT_PID.OP.LOAD_PID. Si PID_ON es en la estructura PAR = TRUE, el juego de parámetros
PID se copia en los parámetros efectivos del regulador; de lo contrario, se copia el juego de
parámetros PI. Una vez finalizada la acción, FMT_PID desactiva LOAD_PID. El valor de
PID_ON se mantiene, lo que resulta lógico pues no se trata de un parámetro de operación.
Si desea saber qué valores hay en el juego de parámetros PI o PID, puede averiguarlo a través
de FMT_TUN. Leer READ_OUT = TRUE:
Juego de parámetros PI
Ganancia del regulador

Juego de parámetros PID

PI_GAIN

PID_GAIN

Período de integración

PI_TI

PID_TI

Tiempo de acción derivativa

0.0

PID_TD

Nota
Tenga en cuenta lo siguiente:
● Los parámetros del regulador sólo se rescriben con UNDO_PAR o LOAD_PID si la
ganancia del regulador (SAV_GAIN, PID_GAIN o PI_GAIN) es distinta de cero:
● Con ello se tiene en cuenta el caso de que aún no se haya llevado a cabo ninguna
optimización o de que falte algún parámetro PID. Si eran, p. ej., PID_ON = TRUE y
PID_GAIN = 0.0, PID_ON se pone a FALSE y los parámetros PI se copian.
● D_F, PFAC_SP se preajustan con la optimización. Seguidamente pueden ser modificados
por el usuario. LOAD_PID no modifica este parámetro.
● La zona de regulación siempre se calcula de nuevo con LOAD_PID (CON_ZONE = 250/
GAIN o 375/GAIN si RATIOFAC <> 0.0), incluso si CONZ_ON = FALSE.

Conmutación sin discontinuidad con LOAD_PID y UNDO_PAR
La conmutación se efectúa de manera que la suma del componente proporcional y el
componente integral permanece constante. Al conmutar de PID a PI se produce un salto en la
magnitud de ajuste, ya que el componente diferencial desaparece. El paso de PI a PID no
provoca discontinuidad alguna en un principio. No obstante, al cabo de algunos ciclos, el
componente diferencial provoca un cambio rápido.

Realizar medición del tiempo de posicionamiento del motor
Introducción
Para conseguir un buen resultado de la regulación, el tiempo de posicionamiento del motor
debe ser lo más preciso posible. Los datos de la documentación del elemento final de control
son valores medios para este tipo de elemento final de control. El valor puede variar para el
elemento final de control que se use en cada momento.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1105

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Si utiliza actuadores con realimentación de posición o con señales de tope, es posible medir
el tiempo de posicionamiento del motor durante la puesta en servicio. Si no se dispone de una
realimentación de posición ni de señales de tope, no es posible medir el tiempo de
posicionamiento del motor.

Requisitos
● El valor parametrizado del tiempo de posicionamiento del motor debe equivaler como
mínimo a la mitad del tiempo de posicionamiento real. El actuador se desplaza en un
sentido durante el doble del tiempo de posicionamiento como máximo.
● En los actuadores con realimentación de posición analógica, la realimentación de posición
debe estar interconectada.
● En los actuadores con señales de tope, las señales de tope deben estar interconectadas.

Actuadores con realimentación de posición analógica
Para medir el tiempo de posicionamiento del motor con realimentación de posición, proceda
del siguiente modo:
1. Elija el DB instancia para el que se debe medir el tiempo de posicionamiento del motor.
2. Active la casilla de verificación "Utilizar realimentación de posición".
3. En el campo de entrada "Posición de destino" indique hacia dónde desea mover el
elemento final de control.
La realimentación de posición actual (posición de inicio) se muestra. Haga clic en el
botón
"Iniciar medición tiempo de posicionamiento".

Resultado
El elemento final de control se desplaza hasta la posición de destino desde la posición de
inicio. La medición del tiempo se inicia de inmediato y finaliza en cuanto el elemento final de
control ha alcanzado la posición de destino. El tiempo de posicionamiento del motor se calcula
según la fórmula:
Tiempo de posicionamiento del motor = (Límite superior del valor de salida - Límite inferior del
valor de salida) x Tiempo de medición /VALOR ABSOLUTO(Posición de destino - Posición de
inicio).
Se muestran el progreso y el estado de la medición del tiempo de posicionamiento. El tiempo
de posicionamiento medido se muestra en el campo "Tiempo de actuación medido". Una vez
finalizada la medición del tiempo de posicionamiento se conecta el modo manual de las
señales de posicionamiento (OP.LMNS_ON = TRUE). El elemento final de control deja de
moverse.

1106

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Actuadores con señales de tope
Para medir el tiempo de posicionamiento del motor con señales de tope, proceda del siguiente
modo:
1. Elija el DB instancia para el que se debe medir el tiempo de posicionamiento del motor.
2. Active la casilla de verificación "Utilizar señales de tope del actuador".
3. Haga clic en el botón

"Iniciar medición tiempo de posicionamiento".

Resultado
El elemento final de control se mueve primero hasta el tope inferior, después, hasta el tope
superior y, de nuevo, hasta el tope inferior. La medición del tiempo se inicia cuando el actuador
ha alcanzado el tope inferior y finaliza cuando el actuador alcanza por segunda vez el tope
inferior. El tiempo medido dividido entre dos da lugar al tiempo de posicionamiento del motor.
Se muestran el progreso y el estado de la medición del tiempo de posicionamiento. El tiempo
de posicionamiento medido se muestra en el campo "Tiempo de actuación medido". Una vez
finalizada la medición del tiempo de posicionamiento se conecta el modo manual de las
señales de posicionamiento (OP.LMNS_ON = TRUE). El elemento final de control deja de
moverse.

Cargar el tiempo de ajuste medido
1. Para guardar en el proyecto el tiempo de posicionamiento del motor medido, haga clic en
el símbolo
"Transfiere datos online al proyecto offline".
El tiempo de ajuste medido se guarda en el ajuste de parámetros del FM.
2. Para que los cambios surtan efecto en el arranque siguiente de la CPU, haga clic en el
icono
"Cargar en dispositivo".

Cancelar medición del tiempo de posicionamiento
Si cancela la medición del tiempo de posicionamiento, el modo manual de las señales de
posicionamiento se conecta (OP.LMNS_ON = TRUE) y el modo manual con especificación de
la variable manipulada se desconecta (OP.LMN_REON = FALSE). El elemento final de control
deja de moverse.

Trabajar con el registrador de curvas
Observar
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Puesta en servicio".
2. Navegue en la vista de configuración hasta "Registrador de curvas".
3. Seleccione el DB de instancia que desee observar. Tras seleccionarlo se muestra el canal
al que está asignado el DB de instancia.
4. Defina el tiempo de actualización con el que debe registrar el registrador de curvas.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1107

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
5. Haga clic en "Medición activada" para iniciar la medición.
6. Haga clic en "Medición desactivada" para finalizar la medición.

Procedimiento
Para adaptar la escala, proceda del siguiente modo:
1. En la vista de dispositivos, bajo el módulo, haga doble clic en "Puesta en servicio".
2. Navegue en la vista de configuración hasta "Registrador de curvas".
3. Para modificar el eje de tiempo:
– Haga clic en el botón de flecha junto a la fecha, para abrir un calendario. Seleccione una
fecha en el calendario. Para bloquear la selección, haga clic en el candado azul. Esta
posibilidad existe tanto para la fecha de inicio como para la fecha de fin.
– Haga clic con el puntero del ratón en la escala de tiempo. El puntero del ratón se
representa como flecha a la izquierda/derecha. Mantenga el puntero del ratón
presionado y arrástrelo hacia la izquierda o derecha.
Si el tiempo de inicio o fin está bloqueado, se modifica el escalado del tiempo.
Si no está bloqueado ni el tiempo de inicio ni el de fin, se modifica el período indicado;
el escalado se mantiene igual.
4. Para modificar el eje de tiempo:
– Haga clic en el campo de entrada para el valor superior o el valor inferior mostrado.
Introduzca ahí el valor deseado. Para bloquear la selección, haga clic en el candado
azul. Esta posibilidad existe tanto para el valor superior como también para el inferior.
– Haga clic con el puntero del ratón en la escala de valores. El puntero del ratón se
representa como flecha arriba/abajo. Mantenga el puntero del ratón presionado y
arrástrelo hacia arriba o abajo.
Si el valor superior o inferior está bloqueado, se modifica la escala del eje de valores.
Si no está bloqueado el valor superior ni el valor inferior, se modifica el rango indicado;
la escala se mantiene igual.

3.5.6.4

FM 355-2: Diagnóstico a través de indicadores LED

Indicación de errores mediante el LED de error de grupo
Introducción
Si el LED rojo de error de grupo se enciende, significa que se ha producido un error en el
módulo (error interno) o en las conexiones (error externo).
Si el LED amarillo parpadea, el firmware se borra. Este estado sólo puede aparecer si existe
un defecto en el hardware o si el proceso de carga del firmware se cancela.

1108

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

¿Qué errores se muestran?
Cuando se ilumina el LED de error de grupo se señalan los errores siguientes:
Tipo de
error

Aviso de diagnóstico

Errores in‐ Módulo defectuoso
ternos
Vigilancia de tiempo
(watch dog) activado

Errores
externos

Causa posible

Solución

Error de hardware

Cambie el módulo

Error de hardware

Cambie el módulo

Contenido EEPROM no
válido

Fallo de la tensión de alimenta‐
ción al parametrizar

Vuelva a parametrizar el
módulo

Parámetro erróneo en el
módulo

Se han transferido parámetros in‐ Vuelva a parametrizar el
correctos al módulo
módulo

Error en las entradas o las
salidas analógicas

Error de hardware en la entrada
analógica

Cambie el módulo

Rotura de hilo en la entrada ana‐ Solucione la rotura de hilo
lógica
Rebase por defecto del rango de Revise la señal de medi‐
medición en la entrada analógica ción
Rebase por exceso del rango de Revise la señal de medi‐
medición en la entrada analógica ción
Rotura de hilo en la salida analó‐ Solucione la rotura de hilo
gica
Cortocircuito en la salida analógi‐ Solucione el cortocircuito
ca
Falta tensión auxiliar ex‐
terna

Fallo en la alimentación 24 V

Restablezca la alimenta‐
ción de 24 V

Alarma de diagnóstico en caso de error
Todos los errores pueden disparar una alarma de diagnóstico si ésta se ha habilitado en la
pantalla de parametrización correspondiente. En los registros de diagnóstico DS0 y DS1
puede ver qué error ha provocado que se encienda el LED. La asignación de los registros de
diagnóstico DS0 y DS1 está descrita en el siguiente apartado.

Disparo de alarmas de diagnóstico
¿Qué es una alarma de diagnóstico?
Si el programa de usuario reacciona a un error interno o externo, es posible parametrizar una
alarma de diagnóstico. El programa cíclico de la CPU se interrumpe y se llama la alarma de
diagnóstico OB, OB 82.

¿Qué eventos pueden disparar una alarma de diagnóstico?
La siguiente lista muestra qué eventos pueden disparar una alarma de diagnóstico:
● Módulo no parametrizado o errores en la parametrización
● Módulo defectuoso

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1109

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
● Rotura de hilo en entradas analógicas (sólo 4 a 20 mA)
● Rebase por exceso y por defectos en entradas analógicas
● Rotura de carga y cortocircuito en salidas analógicas

Habilitación de la alarma de diagnóstico
La ficha Parámetros básicos permite bloquear o habilitar la alarma de diagnóstico para el
módulo.
La alarma de diagnóstico está bloqueada de forma predeterminada.

Respuestas a un evento que dispara una alarma
Cuando se produce un evento que puede disparar una alarma de diagnóstico ocurre lo
siguiente:
● La información de diagnóstico se registra en los registros de diagnóstico DS0 y DS1 del
módulo.
● El LED de error de grupo se enciende.
● Se llama al OB de alarma de diagnóstico (OB 82).
● El registro de diagnóstico DS0 se graba en la información de arranque del OB de alarma de
diagnóstico.
● Si no hay ningún defecto de hardware, el módulo sigue regulando.
La CPU pasa a modo STOP si no se ha programado el OB 82.

Registro de diagnóstico DS0 y DS1
La información que indica qué evento ha provocado una alarma de diagnóstico se guarda en
los registros de diagnóstico DS0 y DS1. El registro de diagnóstico DS0 consta de cuatro bytes;
DS1 consta de 16 bytes, siendo los cuatro primeros idénticos a DS0.

Registros de diagnóstico DS0 y DS1
Leer el registro desde el módulo
El registro de diagnóstico DS0 se transfiere automáticamente a la información de arranque en
la llamada del OB de diagnóstico. Allí, estos cuatro bytes se guardan en los datos locales
(bytes 8-11) del OB 82.
El registro de datos DS1 (y, con ello, también el contenido del DS0) puede leerse con el FB 55
"FMT_DS1" del módulo. Esta lectura sólo tiene sentido si en el DS0 se notifica un error en un
canal.
El FB 55 "FMT_DS1" debe llamarse en el mismo OB que un posible FB FMT_PID existente (por
ejemplo, OB 35). Esto se consigue con la medida siguiente: Ajuste el bit READ_DS1 mientras
se procesa el OB 82. El FMT_DS1 del OB 35 lee a continuación el registro de diagnóstico DS1.

1110

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

¿Cómo aparecen los textos de diagnóstico en el búfer de diagnóstico?
Si se desea registrar el aviso de diagnóstico en el búfer de diagnóstico, se debe llamar la
instrucción "WR_REC" "Introducir avisos específicos de usuario en el búfer de diagnóstico"
dentro del programa de usuario. En cada caso, el número de evento del aviso de diagnóstico
se especifica en el parámetro de entrada EVENTN. La alarma se introduce en el búfer de
diagnóstico con x=1 como entrante y con x=0 como saliente. El búfer de diagnóstico contiene
los textos de diagnóstico correspondientes en la columna de "Significado", así como el
momento en que se produjo la entrada.

Asignación del registro de diagnóstico DS0 y de la información de arranque
La tabla siguiente muestra la asignación del registro de diagnóstico DS0 en la información de
arranque. Todos los bits que no se incluyen en la tabla son irrelevantes y tienen el valor cero.
Tabla 3-5
Byte
0

Asignación del registro de diagnóstico DS0
Bit

Significado

0

Avería en módulo

1

Error interno

Nota

Nº de evento

Se activa en todos los eventos de diagnóstico

8:x:00

Se activa en todos los errores internos:

8:x:01

● Vigilancia de tiempo activada
● Error EPROM
● Error ADC/DAC
● Error de hardware en la entrada analógica
2

Error externo

Se activa en todos los errores externos:

8:x:02

● Falta tensión auxiliar externa
● Error de parametrización
● Rotura de hilo en la entrada analógica (sólo
en el margen 4 a 20 mA)
● Rebase por defecto del rango de medición
en la entrada analógica
● Rebase del rango de medición en la
entrada analógica
● Rotura de carga de la salida analógica
● Cortocircuito en la salida analógica
3

Fallo en un canal

Consultar el DS1, a partir del byte 7, para más
detalles

8:x:03

4

Falta tensión auxiliar
externa

Fallo en la alimentación 24 V del FM 355-2

8:x:04

6

sin usar

-

7

Error de parametriza‐ El módulo no puede utilizar un parámetro. Mo‐
ción
tivo: Parámetro desconocido o combinación de
parámetros no permitida.

8:x:07

Consulte el menú Sistema de destino > Mostrar
error de parametrización.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1111

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Byte
1

Bit

Significado

Nota

Nº de evento

0 ... 3

Clase de módulo

Siempre tiene asignado un 8.

-

4

Diagnóstico específi‐ Se activa cuando el módulo puede proporcio‐
co de canal
nar información del canal adicional y hay un
error de canal (consulte DS1 bytes 7 a 12)

2

3

Vigilancia de tiempo Error de hardware
(watch dog) activado

8:x:33

3

2

Error EPROM

Módulo defectuoso

8:x:42

4

Error ADC/DAC

Módulo defectuoso

8:x:44

-

Registro de diagnóstico DS1
El registro de diagnóstico DS1 se compone de 16 bytes. Los 4 primeros bytes son idénticos a
los del registro de diagnóstico DS0. La siguiente tabla muestra la asignación de los bytes
restantes. Todos los bits que no se incluyen en la tabla son irrelevantes y tienen el valor cero.

Registro de diagnóstico DS1 del FM 355-2
Tabla 3-6
Byte

Asignación de los bytes del 4 a 12 del registro de diagnóstico DS1 del FM 355-2
Bit

Nota

Nº de evento

4

0 ... 7

Tipo de canal

Siempre tiene asignado 75H

-

5

0 ... 7

Longitud de la información de
diagnóstico

Siempre tiene asignado un 8.

-

6

0 ... 7

Cantidad de canales

Siempre tiene asignado un 5 (4 regu‐
ladores + 1 canal de referencia)

-

7

0 ... 4

Vector de error de canal

Cada bit tiene asignado un canal (0 a
3, 4 para el canal de referencia).

-

8

0

Error de hardware en la entra‐
da analógica

8:x:B0

1

sin usar

8:x:B1

2

Rotura de hilo en la entrada
analógica (sólo en el margen
4 a 20 mA)

8:x:B2

3

sin usar

8:x:B3

4

Rebase por defecto del rango
de medición en la entrada ana‐
Diagnóstico espe‐
lógica
cífico del canal 0
Rebase del rango de medi‐

8:x:B4

5

1112

Significado

8:x:B5

ción en la entrada analógica

6

Rotura de hilo en la salida ana‐
lógica

Sólo en la salida
de intensidad
del regulador K

8:x:B6

7

Cortocircuito en la salida ana‐
lógica

Sólo en la salida
de tensión del
regulador K

8:x:B7

9

0 ... 7

véase byte 8

Diagnóstico específico del canal 1

véase arriba

10

0 ... 7

véase byte 8

Diagnóstico específico del canal 2

véase arriba

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Byte

Bit

Significado

Nota

Nº de evento

11

0 ... 7

véase byte 8

Diagnóstico específico del canal 3

véase arriba

12

0 ... 5

véase byte 8

Diagnóstico para el canal de referen‐
cia

véase arriba

Información adicional
Para obtener más información sobre el parámetro "RET_REALU", consulte Lista de los avisos
RET_REALU (Página 1114) y el área de instrucciones avanzadas del sistema de ayuda.

Fallo del transductor de medida
Averías en los transductores de medida
El FM 355-2 puede detectar los siguientes fallos en el transductor de medida:
● Rebase por defecto del rango de medición
● Rebase del margen de medición
● Rotura de hilo (no se muestra en todos los márgenes de medición)
Si se produce una de estas averías en el registro de diagnóstico DS0 se define el bit de error
de grupo "Error externo" y, en el registro de diagnóstico DS1, bits de error específicos del canal
(consulte las tablas anteriores). Cuando desaparecen estas averías los bits correspondientes
se desactivan.
La siguiente tabla muestra los límites de los diferentes márgenes de medición en los que los
bits de error se activan o desactivan:
Rango de medida

Bit de error Rebase por defecto
del rango de medición en ...

Bit de error Rebase del rango
de medición en ...

Bit de error Mostrar rotura de
hilo

DS1: Byte 10 a 26, Bit 4

DS1: Byte 10 a 26, Bit 5

DS1: Byte 10 a 26, Bit 2

0 a 20 mA

< - 3,5 mA

> 23,5 mA

-

4 a 20 mA

Bit de error = 1 a < 3,6 mA

> 22,8 mA

Bit de error = 1 a < 3,6 mA

Bit de error = 0 a > 3,8 mA

Bit de error = 0 a > 3,8 mA

0 a 10 V

< - 1,175 V

> 11,75 V

-

Pt 100

< 30,82 mV

> 650,46 mV

-

< 30,82 mV

> 499,06 mV

-

< 30,82 mV

> 254,12 mV

-

Termoelemento tipo B

< 0 mV

> 13,81 mV

-

Termoelemento tipo E

< -9,84 mV

> 76,36 mV

-

(-200 a 850 °C)
(-328 a 1562 °F)
Pt 100
(-200 a 556 °C)
(-328 a 1032 °F)
Pt 100
(-200 a 130 °C)
(-328 a 264 °F)

(-270,0 a 1000,03 °C)

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1113

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
Rango de medida

Bit de error Rebase por defecto
del rango de medición en ...

Bit de error Rebase del rango
de medición en ...

Bit de error Mostrar rotura de
hilo

DS1: Byte 10 a 26, Bit 4

DS1: Byte 10 a 26, Bit 5

DS1: Byte 10 a 26, Bit 2

Termoelemento tipo J

< - 8,1 mV

> 69,54 mV

-

Termoelemento tipo K

< - 6,45 mV

> 54,88 mV

-

Termoelemento tipo R

< - 0,23 mV

> 21,11 mV

-

Termoelemento tipo S

< - 0,24 mV

> 18,7 mV

-

Termopar libre

< Valor de entrada inferior de la
línea poligonal

> Valor de entrada superior de
la línea poligonal

-

Lista de los avisos RET_REALU
Avisos RET_REALU

1114

JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

7000

28672

-32624

Primera llamada con REQ=0: No hay ninguna transferencia de
datos activa; BUSY tiene el valor 0.

7001

28673

-32624

Primera llamada con REQ=1: Transferencia de datos lanzada;
BUSY tiene el valor 1.

7002

28674

-32624

Llamada intermedia (REQ irrelevante). Transferencia de datos
ya activa; BUSY tiene el valor 1.

8090

32912

-32624

La dirección base lógica indicada no es válida: No existe nin‐
guna asignación en el SDB1/SDB2x, o no se trata de una di‐
rección base.

80A0

32928

-32608

Acuse negativo al leer el módulo. Módulo extraído durante la
lectura o módulo defectuoso.

80A1

32929

-32607

Acuse negativo al escribir en el módulo. Módulo extraído du‐
rante la escritura o módulo defectuoso.

80A2

32930

-32606

Error de protocolo DP en capa 2

80A3

32931

-32605

Error de protocolo de DP con User-Interface/User

80A4

32932

-32604

Fallo de comunicación en el bus K

80B1

32945

-32591

Indicación de longitud errónea. Parámetro FM_TYPE del DB de
canal para el módulo utilizado no activado correctamente.

80B2

32946

-32590

El slot configurado no está ocupado.

80B3

32947

-32589

El tipo de módulo real no es igual al tipo de módulo teórico.

80C0

32960

-32576

El módulo aún no tiene preparados los datos que hay que leer.

80C1

32961

-32575

Los datos de una petición de escritura semejante todavía no se
han procesado en el módulo.

80C2

32962

-32574

El módulo procesa de instante el número máximo posible de
peticiones.

80C3

32963

-32573

Los recursos necesarios (memoria, etc.) están ocupados en
estos momentos.

80C4

32964

-32572

Error de comunicación

80C5

32965

-32571

La periferia descentralizada no está disponible.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
JOB_ERR
(Hex)

JOB_ERR
(Dec)

JOB_ERR
(Int)

Significado

80C6

32966

-32570

Cancelación de las clases de prioridad (rearranque normal o en
segundo plano)

8522

34082

-31454

DB del canal o DB de parámetros demasiado corto. No se pue‐
den leer los datos del DB. (petición de escritura).

8532

34098

-31438

El número de DB del DB de parámetros es demasiado grande.
(petición de escritura).

853A

34106

-31430

DB de parámetros no presente. (petición de escritura).

8544

34116

-31420

Error en el enésimo (n > 1) acceso de lectura a un DB tras
aparecer un error (petición de escritura).

8723

34595

-30941

DB del canal o DB de parámetros demasiado corto. No se pue‐
den escribir los datos en el DB. (petición de lectura).

8730

34608

-30928

DB de parámetros protegido contra escritura en la CPU. No se
pueden escribir los datos en el DB (petición de lectura)

8732

34610

-30926

El número de DB del DB de parámetros es demasiado grande.
(petición de lectura).

873A

34618

-30918

DB de parámetros no presente. (petición de lectura).

8745

34629

-30907

Error en el enésimo (n > 1) acceso de escritura a un DB tras
aparecer un error. (petición de lectura).

80ff

33023

-32513

Indicación de índice incorrecta en el bloque FMT_PAR

Los errores 80A2..80A4 así como 80Cx son temporales, es decir, se pueden eliminar tras un tiempo de
espera sin la intervención del usuario. Los avisos con la estructura 7xxx indican situaciones temporales
de la comunicación.

3.5.7

Utilizar el FM 455

3.5.7.1

Configuración del FM 455

Configuración hardware
Procedimiento
Para poder configurar el hardware debe haber creado previamente un proyecto donde pueda
guardar la parametrización. A continuación se explican únicamente los pasos más importantes.
1. Inicie el TIA portal y abra la configuración de dispositivos.
2. Seleccione un rack.
3. Seleccione un módulo de regulación del catálogo de módulos.
4. Arrastre el módulo de regulación hasta la posición correspondiente del rack.
5. Anote la dirección de entrada del módulo a partir de la tabla de configuración, p. ej. 512.
El valor leído se muestra en formato decimal.

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1115

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

3.5.7.2

Parametrizar el FM 455

Parámetros del módulo
Procedimiento
A través de la parametrización se configuran los parámetros del módulo.
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
Seleccione en la ventana de inspección la pestaña "Propiedades".
Resultado: Las propiedades se muestran en la ventana de inspección.
2. Configure los parámetros básicos del módulo y el resto de parámetros.
3. Configure los demás parámetros del bloque en la vista de configuración.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".
5. Compile el proyecto con "Editar > Compilar".
6. Cargue los datos de parametrización en el estado de STOP de la CPU con "Online > Cargar
en dispositivo..."
Resultado: Los datos se encuentran en la memoria de la CPU y se transfieren desde ésta
directamente al módulo.
7. Arranque la CPU.

Parámetros de la entrada analógica
Evaluación de la entrada analógica
Procedimiento
Para seleccionar un tipo de sensor proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Entrada analógica > Entrada [n°] > Evaluación de
la entrada analógica".
3. Defina los siguientes parámetros:
– Resolución entrada analógica
– Tipo de sensor entrada analógica
La opción "Vigilancia de rotura de hilo" se habilita para diversos tipos de sensor. Se
puede activar la opción según requerimiento.
– Temperatura de referencia
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

1116

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Funciones de filtro
Procedimiento
Para definir las funciones de filtro proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Entrada analógica > Entrada [n°] > Funciones de
filtro".
3. Defina los siguientes parámetros:
– Active la opción "Filtro de señal" para filtrar por una constante de tiempo.
Si la opción "Filtro de señal" se encuentra seleccionada se puede activar la constante de
tiempo del filtro.
– Constante de tiempo del filtro
Se puede activar solamente si la opción "Filtro de señal" se encuentra activada.
– Active la opción "Filtro de raíz cuadrada" para linealizar la señal del sensor.
– Active la opción "Filtro de polígono" para linealizar la característica de la señal del
sensor.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Filtro de señal
Filtro de primer orden cuya respuesta temporal viene determinada por la constante de tiempo.

Filtro de raíz cuadrada
Su finalidad es linealizar señales de sensores que están en relación cuadrada con la magnitud
de proceso medida, en las cuales el valor real obedece a una magnitud física.

Filtro de polígono
Su finalidad es linealizar características de sensores.
Los 13 nodos seleccionables se pueden seleccionar en:
● mA en entrada de corriente
● mV en entrada de tensión

Normalización
Procedimiento
Para convertir la señal de entrada en una unidad física proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Entrada analógica > Entrada [n°] > Normalización".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1117

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Defina los siguientes parámetros:
– Valor superior
– Valor inferior
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Normalización
Para convertir la señal de entrada en otra unidad física mediante interpolación lineal entre el
valor inicial (valor inferior) y el valor final (valor superior).

Error de regulación
Realizar un regulador de valor fijo o en cascada
Regulador de valor fijo o en cascada
En las estructuras de regulación 'Regulador de valor fijo o en cascada' el valor real efectivo es
idéntico al valor real A.

Seleccionar el tipo de regulador
Para realizar un regulador de valor fijo o en cascada proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°]".
3. En el área "Tipo de regulador" seleccione la opción "Regulador de valor fijo o en cascada".
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Acondicionamiento de la consigna
Para acondicionar la consigna proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".

1118

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

Regulación PID
3.5 Regulación PID (S7-300, S7-400)
3. Active los parámetros correspondientes en las diferentes áreas:
– Origen de la consigna
Seleccione el origen de la consigna.
– Consigna de seguridad
Ajuste aquí la consigna de seguridad. Defina asimismo la reacción a un fallo de la CPU
y el comportamiento en arranque.
– Rampa de consigna
Defina el tiempo de subida de rampa.
– Límite de consigna
Seleccione aquí los límites superior e inferior de consigna.
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Seleccionar origen de la señal para el valor real A
Para seleccionar el origen de la señal para el valor real A proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. Seleccione el origen correspondiente en el área "Variable manipulada". Se proporcionan
las siguientes posibilidades de selección:
– Cero
– Entrada analógica acondicionada
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Realizar un regulador de 3 componentes
Regulador de 3 componentes
En la estructura de regulación 'Regulador de 3 componentes', el valor real efectivo se define
a través de la suma de los tres valores reales A, B y C, y mediante adición de un Offset
ajustable. Los valores reales B y C se pueden evaluar adicionalmente mediante factores.

Seleccionar el tipo de regulador
Para materializar un regulador de tres componentes, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°]".
3. En el área "Tipo de regulador" seleccione la opción "Regulador de 3 componentes".
4. Guarde los parámetros configurados mediante "Proyecto > Guardar".

Utilizar funciones tecnológicas
Manual de programación y manejo, 11/2019

1119

Regulación PID
3.5 Regulación PID (S7-300, S7-400)

Acondicionamiento de la consigna
Para ajustar cómo debe acondicionarse la consigna, proceda del siguiente modo:
1. En la vista de dispositivos, haga doble clic en la "Configuración de parámetros" del módulo.
2. En la vista de configuración seleccione "Regulador > Canal [n°] > Error de regulación".
3. Seleccione en el área "Origen de la consigna" el origen de referencia de la consigna.
4. Especifique un valor en el área "Consigna de seguridad", el cual será tomado como
consigna de seguridad en caso de fallo de la CPU y durante el arranque.
5. Especifique el comportamiento del módulo de regulación válido como "Reacción a fallo de
la CPU" y para el "Comportamiento en arranque". Las posibilidades de selección son:
– Consigna = última consigna válida: al producirse el evento 