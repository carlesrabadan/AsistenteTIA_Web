9)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6257

Instrucciones
4.2 Instrucciones

Par√°metros de salida de PULSEGEN
Tabla 4-272
Par√°metro

Tipo de datos

Ajuste predetermi‚Äê
nado

Descripci√≥n

QPOS_P

BOOL

FALSE

El par√°metro de salida "Se√±al de salida del impulso positivo"
est√° activado cuando debe emitirse un impulso. En la regulaci√≥n
de tres puntos es el impulso positivo. En la regulaci√≥n de dos
puntos, QNEG_P se ajusta siempre invertido respecto a
QPOS_P.

QNEG_P

BOOL

FALSE

El par√°metro de salida "Se√±al de salida de impulso negativo"
est√° activado cuando debe emitirse un impulso. En la regulaci√≥n
de tres puntos es el impulso negativo. Durante la regulaci√≥n de
dos puntos, QNEG_P se ajusta siempre invertido respecto a
QPOS_P.

Consulte tambi√©n
Diferencias respecto a PULSEGEN S7-300/400 (P√°gina 3829)

TCONT_CP
Descripci√≥n de TCONT_CP
La instrucci√≥n TCONT_CP sirve para regular procesos de temperatura con control continuo o
por impulsos. El funcionamiento se basa en el algoritmo de regulaci√≥n PID, que est√° dotado de
funciones adicionales para procesos de temperatura. Para mejorar el comportamiento de
regulaci√≥n en procesos de temperatura, el bloque dispone de una zona de regulaci√≥n y de una
reducci√≥n de la acci√≥n P en caso de que haya escalones en la consigna.
La instrucci√≥n puede ajustar por s√≠ misma los par√°metros PI/PID mediante la optimizaci√≥n del
regulador.

Aplicaci√≥n
A cada regulador le corresponde un solo actuador, es decir, con un solo regulador se podr√° o
bien calentar o bien enfriar. Si se va a utilizar para un proceso de refrigeraci√≥n, hay que
parametrizar GAIN con un valor negativo. La inversi√≥n que es parametrizada de esta manera
provoca que p. ej. en caso de aumento de la temperatura, aumente la variable manipulada
LMN, y con ello la potencia de refrigeraci√≥n.

Llamada
La instrucci√≥n TCONT_CP debe llamarse de forma equidistante. Utilice para ello un nivel de
alarmas c√≠clicas (p. ej. OB35 en S7-300).
La instrucci√≥n TCONT_CP tiene una rutina de inicializaci√≥n, que se ejecuta cuando el
par√°metro de entrada COM_RST = TRUE est√° activado. El integrador se ajusta al valor de
inicializaci√≥n I_ITVALdurante la inicializaci√≥n. Todas las salidas de se√±al restantes se ponen

6258

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
a cero. El bloque vuelve a ajustarse a FALSE despu√©s de ejecutar la rutina de inicializaci√≥n
COM_RST. Si desea realizar una inicializaci√≥n con un rearranque completo de la CPU, llame
el bloque en el OB 100 con COM_RST = TRUE.
Si se efect√∫a una llamada a la instrucci√≥n TCONT_CP como DB multiinstancia, no se crea
ning√∫n objeto tecnol√≥gico. No se dispone de interfaz de parametrizaci√≥n y puesta en servicio.
Los TCONT_CP se deben parametrizar directamente en el DB multiinstancia y ponerse en
servicio a trav√©s de una tabla de observaci√≥n.

Consulte tambi√©n
Funcionamiento del generador de impulsos (P√°gina 6268)
Diagrama de bloques TCONT_CP (P√°gina 6271)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

Funcionamiento de TCONT_CP
Rama de consigna
La consigna se introduce en la entrada SP_INT en formato de coma flotante, ya sea f√≠sico o
porcentual. La consigna y el valor real deben indicarse con la misma unidad en la formaci√≥n del
error de regulaci√≥n.

Selecci√≥n del valor real (PVPER_ON)
El valor real se puede leer en formato de coma flotante o en formato de periferia en funci√≥n de
PVPER_ON.
PVPER_ON

Entrada del valor real

TRUE

El valor real se lee a trav√©s de la periferia anal√≥‚Äê
gica (PEW xxx) en la entrada PV_PER.

FALSE

El valor real se lee en formato de coma flotante en
la entrada PV_IN.

Conversi√≥n del formato del valor real CRP_IN (PER_MODE)
La funci√≥n CRP_IN convierte el valor de periferia PV_PER dependiendo del conmutador
PER_MODE en un valor en coma flotante seg√∫n la siguiente regla:
PER_MODE

Salida de CRP_IN

Tipo de entrada anal√≥‚Äê
gica

Unidad

0

PV_PER * 0.1

Termopares; PT100/
NI100; Est√°ndar

¬∞C;¬∞F

1

PV_PER * 0.01

PT100/NI100; Climati‚Äê
zaci√≥n;

¬∞C;¬∞F

2

PV_PER * 100/27648

Tensi√≥n/intensidad

%

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6259

Instrucciones
4.2 Instrucciones

Normalizaci√≥n del valor real PV_NORM (PF_FAC, PV_OFFS)
La funci√≥n PV_NORM calcula la salida de CRP_IN seg√∫n la siguiente norma:
"Salida de PV_NORM" = "salida de CRP_IN" * PV_FAC + PV_OFFS
Se puede utilizar para los siguientes prop√≥sitos:
‚óè Adaptaci√≥n del valor real con PV_FAC como factor del valor real y PV_OFFS como offset
del valor real
‚óè Normalizaci√≥n de la temperatura en porcentajes
Desea indicar la consigna en porcentajes y ahora debe convertir el valor de temperatura
medido en un valor porcentual.
‚óè Normalizaci√≥n de los valores porcentuales a temperaturas
Desea indicar la consigna en la magnitud f√≠sica Temperatura y ahora debe convertir el valor
de tensi√≥n/intensidad medido en una temperatura.
C√°lculo de los par√°metros:
‚óè PV_FAC = rango de PV_NORM/ rango de CRP_IN;
‚óè PV_OFFS = UG(PV_NORM) - PV_FAC * UG(CRP_IN);
con UG: l√≠mite inferior
Con los valores predeterminados (PV_FAC = 1.0 y PV_OFFS = 0.0) la normalizaci√≥n est√°
desactivada. El valor real con efectos reales se emite en la salida PV.
Nota
Durante la regulaci√≥n de impulsos, el valor real se debe transferir al bloque en una llamada de
impulso r√°pida (motivo: filtraci√≥n de valores medios). De lo contrario puede disminuir la calidad
de la regulaci√≥n.

Ejemplo de normalizaci√≥n del valor real
Para preseleccionar la consigna en porcentajes con un rango de temperatura de -20 a 85 ¬∞C
en CRP_IN, normalice el rango de temperatura a valores porcentuales.
En la siguiente figura encontrar√° un ejemplo para la adaptaci√≥n de un rango de temperatura de
entre -20 y 85 ¬∞C a valores de 0 a 100 %:

6260

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
39B1250 >@


39B)$&   





39B2))6  









 

&53B,1>r&@

C√°lculo de error de regulaci√≥n
La diferencia entre la consigna y el valor real constituye el error de regulaci√≥n antes de la zona
muerta.
La consigna y el valor real deben indicarse con la misma unidad.

Zona muerta (DEADB_W)
Para suprimir una peque√±a oscilaci√≥n permanente debida a la cuantificaci√≥n de la magnitud
manipulada (p. ej. en una modulaci√≥n de ancho de impulsos con PULSEGEN), el error de
regulaci√≥n se conduce por una zona muerta (DEADBAND). Con DEADB_W = 0.0 la zona
muerta est√° desactivada. El error de regulaci√≥n efectivo se muestra en el par√°metro ER.
(5

(5  63B,1739 '($'B:

(5  63B,1739 '($'B:

63B,1739
'($'%B:

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6261

Instrucciones
4.2 Instrucciones

Algoritmo PID
En la siguiente figura se representa el diagrama de bloques del algoritmo PID.
63B,17

/01B3

I
3)$&B63

',69

*$,1
;
(5

,17


,17B+326



/01B6XP

/01B,

,17B+1(*

7,,B,7/B21
,B,7/9$/
',)
/01B'
7''B)

Interfaz de parametrizaci√≥n
Interfaz de llamada de instrucci√≥n

Algoritmo PID (GAIN, TI, TD, D_F)
El algoritmo PID trabaja en el algoritmo de posici√≥n. Las acciones proporcional, integral (INT)
y derivativa (DIF) est√°n conectadas en paralelo y pueden activarse y desactivarse por
separado. De este modo se pueden parametrizar reguladores P, PI, PD y PID.
La optimizaci√≥n del regulador es compatible con los reguladores PI y PID. La inversi√≥n del
regulador se efect√∫a mediante un par√°metro GAIN negativo (regulador de refrigeraci√≥n).
Si pone TI y TD a 0.0, obtendr√° un regulador P puro en el punto de operaci√≥n.
La respuesta indicial en el rango de tiempo es:

/01B6XP W  *$,1y(5  y




7,

yW'B) yH

W
7''B)

Donde:
LMN_Sum(t) es la magnitud manipulada en modo autom√°tico del regulador
ER (0) es la amplitud del escal√≥n del error de regulaci√≥n normalizado
GAIN es la ganancia del regulador
TI es el tiempo de acci√≥n integral
TD es el tiempo de la acci√≥n derivada
D_F es el factor de acci√≥n derivativa

6262

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
(5
/01B6XP

*$,1 'B)(5

/01B6XP W

*$,1 (5 
*$,1 (5 

(5 W
W

7''B)
7,

Integrador (TI, I_ITL_ON, I_ITLVAL)
En modo Manual, se corrige seg√∫n: LMN_I = LMN - LMN_P - DISV.
Si se limita la variable manipulada, la acci√≥n I se detiene. En caso de un error de regulaci√≥n que
mueva la acci√≥n I en el sentido del margen de correcci√≥n interno, la acci√≥n I se habilitar√° de
nuevo.
Con las siguientes medidas se producen m√°s modificaciones de la acci√≥n I:
‚óè Desconexi√≥n de la acci√≥n I del regulador con TI = 0.0
‚óè Atenuaci√≥n de la acci√≥n P en caso de modificaciones de la consigna
‚óè Zona de regulaci√≥n
‚óè Los l√≠mites de la variable manipulada se pueden modificar online

Atenuaci√≥n de la acci√≥n P en caso de modificaciones de la consigna (PFAC_SP)
Para evitar sobreoscilaciones, es posible atenuar la acci√≥n P a trav√©s del par√°metro "Ganancia
proporcional al cambiar la consigna" (PFAC_SP). Mediante PFAC_SP se puede elegir
continuamente la intensidad - entre 0.0 y 1.0 - con la que debe actuar la acci√≥n P en caso de
modificaciones de la consigna:
‚óè PFAC_SP = 1.0: la acci√≥n P act√∫a plenamente al cambiar la consigna
‚óè PFAC_SP = 0.0: la acci√≥n P no act√∫a en caso de modificaciones de la consigna
La atenuaci√≥n de la acci√≥n P se logra mediante una compensaci√≥n en la acci√≥n I.

Diferenciador (TD, D_F)
‚óè Desconexi√≥n de la acci√≥n D del regulador con TD = 0.0.
‚óè Cuando la acci√≥n D est√° conectada, debe cumplirse la siguiente ecuaci√≥n:
TD = 0.5 * CYCLE * D_F

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6263

Instrucciones
4.2 Instrucciones

Parametrizaci√≥n de un regulador P o PD con punto de operaci√≥n
En la interfaz de parametrizaci√≥n, desconecte la acci√≥n I (TI = 0.0) y, si es necesario, la acci√≥n
D (TD = 0.0). Adem√°s, efect√∫e la siguiente parametrizaci√≥n:
‚óè I_ITL_ON = TRUE
‚óè I_ITLVAL = punto de operaci√≥n;

Control anticipativo (DISV)
En la entrada DISV se puede aplicar una magnitud perturbadora de forma aditiva.

C√°lculo de la variable manipulada
En la siguiente figura se representa el diagrama de bloques del c√°lculo de la variable
manipulada:

0$1

/01B6XP

&21=21(

0$1B21



&21=B21
&21B=21(

/01

/01/,0,7



(5

4/01B+/0
4/01B//0

/01B1250

&53B287


/PQ1

/01B3(5

/01B)$&
/01B2))6

/01B+/0
/01B//0

38/6(*(1

Interfaz de parametrizaci√≥n
Interfaz de llamada de instrucci√≥n
Interfaz de parametrizaci√≥n, interfaz de llamada de instrucci√≥n

6264

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Zona de regulaci√≥n (CONZ_ON, CON_ZONE)
Si CONZ_ON = TRUE, el regulador trabaja con una zona de regulaci√≥n. Esto significa que el
regulador se controla seg√∫n el siguiente algoritmo:
‚óè Si el valor real PV rebasa la consigna SP_INT en m√°s de CON_ZONE, se emite el valor
LMN_LLM como magnitud manipulada.
‚óè Si el valor real PV se encuentra por debajo de la consigna SP_INT en m√°s de CON_ZONE,
se emite el valor LMN_HLM.
‚óè Si el valor real PV se mueve dentro de la zona de regulaci√≥n (CON_ZONE), la variable
manipulada adopta el valor del algoritmo PID LMN_Sum.
Nota
El cambio de la magnitud manipulada de LMN_LLM o LMN_HLM a LMN_Sum se realiza
manteniendo una hist√©resis del 20 % de la zona de regulaci√≥n.
7HPSHUDWXUD
QRFDOHQWDUFRQ/01 /01B//0
63B,17&21B=21(
=RQDGHUHJXODFL¬µQVXSHULRU
63B,17
=RQDGHUHJXODFL¬µQLQIHULRU
63B,17&21B=21(
QRFDOHQWDUFRQ/01 /01B+/0
7HPSRUL]DGRU

Nota
Antes de activar a mano la zona de regulaci√≥n, deber√° asegurarse de no ajustar un ancho
de zona de regulaci√≥n demasiado peque√±o. Si el ancho de la zona de regulaci√≥n ajustado
fuera insuficiente, se producir√°n oscilaciones en las curvas de la magnitud manipulada y del
valor real.

Ventaja de la zona de regulaci√≥n
Al entrar en la zona de regulaci√≥n, la acci√≥n D activada provocar√° una reducci√≥n muy r√°pida
de la magnitud manipulada. Por lo tanto, se recomienda utilizar la zona de regulaci√≥n s√≥lo
cuando la acci√≥n D est√© conectada. Sin zona de regulaci√≥n, b√°sicamente s√≥lo reducir√≠a la
magnitud manipulada la acci√≥n P en reducci√≥n. La zona de regulaci√≥n provoca un r√©gimen
transitorio r√°pido sin sobreoscilaciones ni posteriores infraoscilaciones en caso de que la
magnitud manipulada m√≠nima o m√°xima emitida est√© a mucha distancia de la magnitud
manipulada necesaria para el nuevo punto de operaci√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6265

Instrucciones
4.2 Instrucciones

Procesamiento de valores en manual (MAN_ON, MAN)
Es posible conmutar entre modo Manual y modo Autom√°tico. En el modo Manual, la magnitud
manipulada se corrige seg√∫n el valor que se ajuste manualmente.
El integrador (INT) se pone internamente a LMN - LMN_P - DISV y el diferenciador (DIF) a 0
y se compensa internamente. La conmutaci√≥n al modo Autom√°tico se efect√∫a as√≠ sin
discontinuidad.
Nota
Durante una optimizaci√≥n, el par√°metro MAN_ON no tiene efecto alguno.

Limitaci√≥n de la variable manipulada LMNLIMIT (LMN_HLM, LMN_LLM)
La variable manipulada se limita con la funci√≥n LMNLIMIT a los l√≠mites de la variable
manipulada LMN_HLM y LMN_LLM. Los bits de aviso QLMN_HLM y QLMN_LLM indican que
se han alcanzado los l√≠mites.
Si se limita la variable manipulada, la acci√≥n I se detiene. En caso de un error de regulaci√≥n que
mueva la acci√≥n I hacia el margen de correcci√≥n interno, se volver√° a habilitar la acci√≥n.

Modificaci√≥n online de los l√≠mites de la variable manipulada
Si se reduce el rango de la variable manipulada y la nueva variable manipulada se encuentra
fuera de los l√≠mites, se desplaza la acci√≥n I, y por tanto, la variable manipulada.
La variable manipulada se reduce en la diferencia entre el l√≠mite anterior y el nuevo l√≠mite de
la variable manipulada. Si la variable manipulada no estaba limitada antes de la modificaci√≥n,
se ajustar√° exactamente al nuevo l√≠mite (en el ejemplo aqu√≠ descrito utiliza el l√≠mite superior).

Normalizaci√≥n de la variable manipulada LMN_NORM (LMN_FAC, LMN_OFFS)
La funci√≥n LMN_NORM normaliza la variable manipulada seg√∫n la siguiente regla:
LMN = LmnN * LMN_FAC + LMN_OFFS
Se puede utilizar para los siguientes prop√≥sitos:
‚óè Adaptaci√≥n de la variable manipulada con LMN_FAC como factor de la variable manipulada
y LMN_OFFS como offset de la variable manipulada
La variable manipulada tambi√©n est√° disponible en formato de periferia. La funci√≥n CRP_OUT
convierte el valor en coma flotante LMN en un valor de periferia seg√∫n la siguiente regla:
LMN_PER = LMN * 27648/100
Con los valores predeterminados (LMN_FAC = 1.0 y LMN_OFFS = 0.0) la normalizaci√≥n est√°
desactivada. La variable manipulada que act√∫a verdaderamente se obtiene en la salida LMN.

6266

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Guardar par√°metros del regulador SAVE_PAR
Si los par√°metros actuales del regulador se consideran v√°lidos, pueden guardarse antes de
modificarse manualmente en par√°metros de estructura propios previstos para tal fin en el DB
de instancia de la instrucci√≥n TCONT_CP. En caso de optimizaci√≥n del regulador, los
par√°metros guardados se sobrescriben con los valores v√°lidos antes de la optimizaci√≥n.
PFAC_SP, GAIN, TI, TD, D_F, CONZ_ON y CONZONE se escriben en la estructura
PAR_SAVE.

Cargar de nuevo par√°metros de regulador guardados UNDO_PAR
Esta funci√≥n permite volver a activar los √∫ltimos par√°metros guardados del regulador (s√≥lo en
modo Manual).

Cambio entre par√°metros PI y PID LOAD_PID (PID_ON)
Tras una optimizaci√≥n, los par√°metros PI y PID se depositan en las estructuras PI_CON y
PID_CON. Con LOAD_PID en funci√≥n de PID_ON se pueden escribir los par√°metros PI o PID
en modo manual en los par√°metros activos del regulador.
Par√°metros PID PID_ON = TRUE

Par√°metros PI PID_ON = FALSE

‚óè GAIN = PID_CON.GAIN

‚óè GAIN = PI_CON.GAIN

‚óè TI = PID_CON.TI

‚óè TI = PI_CON.TI

‚óè TD = PID_CON.TD

Nota
Los par√°metros del regulador s√≥lo se rescriben con UNDO_PAR o LOAD_PID si la ganancia
del regulador no es igual a cero:
Con LOAD_PID se copian los par√°metros s√≥lo si GAIN <> 0 (ya sea del registro de par√°metros
PI o PID). Con ello se tiene en cuenta el caso de que no se haya realizado ninguna optimizaci√≥n
o de que falte alg√∫n par√°metro PID. Si PID_ON = TRUE y PID.GAIN = FALSE, PID_ON se
pone en FALSE y los par√°metros PI se copian.
‚óè D_F, PFAC_SP se preajustan con la optimizaci√≥n. Posteriormente pueden ser modificados
por el usuario. LOAD_PID no modifica estos par√°metros.
‚óè La zona de regulaci√≥n se vuelve a calcular siempre con LOAD_PID
(CON_ZONE = 250/GAIN), incluso si CONZ_ON = FALSE.

Consulte tambi√©n
Funcionamiento del generador de impulsos (P√°gina 6268)
Diagrama de bloques TCONT_CP (P√°gina 6271)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6267

Instrucciones
4.2 Instrucciones

Funcionamiento del generador de impulsos
La funci√≥n PULSEGEN cambia la variable manipulada anal√≥gica LmnN mediante una
modulaci√≥n de ancho de impulsos en una secuencia de impulsos con la duraci√≥n de per√≠odo
PER_TM. PULSEGEN se activa con PULSE_ON = TRUE y se procesa en el ciclo CYCLE_P.
/PQ1








W


438/6(




W
&<&/(B3
3(5B70

Una variable manipulada LmnN = 30 % y 10 llamadas de PULSEGEN por PER_TM suponen:
‚óè TRUE en la salida QPULSE para las tres primeras llamadas de PULSEGEN
(30 % de 10 llamadas)
‚óè FALSE en la salida QPULSE para las otras siete llamadas de PULSEGEN
(70 % de 10 llamadas)
La duraci√≥n de un impulso por per√≠odo es proporcional a la magnitud manipulada y se calcula
del modo siguiente:
Duraci√≥n de impulso = PER_TM * LmnN /100
Debido a la supresi√≥n de la duraci√≥n m√≠nima de impulso o pausa, se forman niveles
escalonados en el √°rea inicial o final de la caracter√≠stica de conversi√≥n.
La figura siguiente representa la regulaci√≥n a dos puntos con rango unipolar de la variable
manipulada
(de 0 % a 100 %):

6268

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
'XUDFL¬µQGHOLPSXOVRSRVLWLYR
3(5B70
3(5B703B%B70

3B%B70




Duraci√≥n m√≠nima del impulso o duraci√≥n m√≠nima de pausa (P_B_TM)
Los tiempos de conexi√≥n o desconexi√≥n breves merman la vida √∫til de los elementos finales de
control y los dispositivos de control. Esto puede evitarse parametrizando una duraci√≥n m√≠nima
de impulso y pausa P_B_TM.
Se suprimen valores absolutos peque√±os de la magnitud de entrada LmnN que pudieran
generar una duraci√≥n de impulso menor que P_B_TM.
Los valores de entrada grandes, que generar√≠an una duraci√≥n de impulso mayor que
PER_TM - P_B_TM, se ajustan a 100 %. De este modo se reduce la din√°mica de la formaci√≥n
de impulsos.
Para la duraci√≥n m√≠nima de impulso o pausa se recomiendan valores de ajuste
P_B_TM ‚â§ 0,1 * PER_TM.
Los niveles escalonados en las caracter√≠sticas que aparecen en la figura anterior son
originados por la duraci√≥n m√≠nima de impulso o por la duraci√≥n m√≠nima de pausa.
En la siguiente figura se representa el comportamiento de conmutaci√≥n de la salida de impulso:



3B%B70
3(5B70

3B%B70
3(5B70

3(5B70

Precisi√≥n de la formaci√≥n de impulsos
Cuanto menor sea el ancho de la base de impulso CYCLE_P en comparaci√≥n con el tiempo de
per√≠odo PER_TM, m√°s exacta ser√° la modulaci√≥n de ancho de impulsos. Para una regulaci√≥n
con una precisi√≥n suficiente sirve la relaci√≥n siguiente:
CYCLE_P ‚â§ PER_TM/50

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6269

Instrucciones
4.2 Instrucciones
Entonces se cambia la variable manipulada con una resoluci√≥n de ‚â§ 2 % en impulsos.
Nota
Si se llama el regulador en el ciclo del generador de impulsos hay que tener en cuenta lo
siguiente:
Al llamar el regulador en el ciclo del generador de impulsos se toma el promedio del valor real.
Como consecuencia, es posible que en la salida PV haya valores distintos a la entrada PV_IN
o PV_PER. Si debe corregirse la consigna, hay que guardar el valor real del par√°metro de
entrada PV_IN en los tiempos de llamada del procesamiento global del regulador
((QC_ACT = TRUE)). En las llamadas intermedias del generador de impulsos, los par√°metros
de entrada PV_IN y SP_INT se suministran con el valor real guardado.

Consulte tambi√©n
Descripci√≥n de TCONT_CP (P√°gina 6258)
Funcionamiento de TCONT_CP (P√°gina 6259)
Diagrama de bloques TCONT_CP (P√°gina 6271)
Par√°metros de entrada de TCONT_CP (P√°gina 6272)
Par√°metros de salida de TCONT_CP (P√°gina 6273)
Par√°metros de entrada/salida de TCONT_CP (P√°gina 6274)
Variables est√°ticas de TCONT_CP (P√°gina 6274)
Par√°metro STATUS_H (P√°gina 6279)
Par√°metro STATUS_D (P√°gina 6280)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

6270

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Diagrama de bloques TCONT_CP
63B,17

393(5B21

39B,1


&53B,1
r&


39B3(5

39B1250




;
'($'%B:



(5

39

3(5B02'

*$,1

'($'%$1'

39B)$&
39B2))6

/01B3

63B,17

I
3)$&B63

',69
,17




,17B+326
,17B+1(*

/01B6XP

/01B,
7,,B,7/9$/

39

3,'

/PQ1

',)

781B21
781B67E]Z
3,'B21
781B'/0

/01B'
7''B)

0$1

0$1B21



&21=21(

4/01B+/0
4/01B//0
/01/,0,7

/01
/01B1250

&53B287


/PQ1



(5

3)$&B63
*$,17,
7''B)
&21=B21
&21=21(

3,'B781(

/01B)$&
/01B2))

/01B+/0
/01B//0

&21=B21
&21B=21

/01B3(5

38/6(*(1
438/6(
38/6(B21
3(5B70
%5($.B70

0$1B21
3,'B&21
3,B&21




3,'B21

/2$'B3,'



*$,1
7,
7'
&21=21(

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

3)$&B63
*$,1
7,
7'
'B)
&21=B21
&21=21(

0$1B21
81'2B3$5

6$9(B3$5




3$5B6$9

3$5B6$9



3)$&B63
*$,1
7,
7'
'B)
&21=B21
&21=21(

6271

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Descripci√≥n de TCONT_CP (P√°gina 6258)
Funcionamiento de TCONT_CP (P√°gina 6259)
Funcionamiento del generador de impulsos (P√°gina 6268)
Par√°metros de entrada de TCONT_CP (P√°gina 6272)
Par√°metros de salida de TCONT_CP (P√°gina 6273)
Par√°metros de entrada/salida de TCONT_CP (P√°gina 6274)
Variables est√°ticas de TCONT_CP (P√°gina 6274)
Par√°metro STATUS_H (P√°gina 6279)
Par√°metro STATUS_D (P√°gina 6280)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

Par√°metros de entrada de TCONT_CP
Tabla 4-273
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

PV_IN

0.0

REAL

0.0

En la entrada "Valor real de la entrada" se puede parametrizar un valor de puesta
en marcha, o se puede conectar un valor real externo en coma flotante. Los valores
v√°lidos dependen de los sensores utilizados.

PV_PER

4.0

INT

0

El valor real en formato de periferia se conecta al regulador a trav√©s de la entrada
"Valor real de la periferia".

DISV

6.0

REAL

0.0

Para realizar un control anticipativo, la magnitud perturbadora se conecta a la
entrada "Variable perturbadora".

INT_HPOS

10.0

BOOL

FAL‚Äê
SE

La salida del integrador se puede bloquear en sentido positivo. Para ello, la entrada
INT_HPOS debe estar ajustada a TRUE. En caso de regulaci√≥n en cascada, se
conecta INT_HPOS del regulador piloto a QLMN_HLM del regulador secuencial.

INT_HNEG

10.1

BOOL

FAL‚Äê
SE

La salida del integrador se puede bloquear en sentido negativo. Para ello, la en‚Äê
trada INT_HNEG debe estar ajustada a TRUE. En caso de regulaci√≥n en cascada,
se conecta INT_HNEG del regulador piloto a QLMN_LLM del regulador secuencial.

SELECT

12.0

INT

0

Si el formador de impulsos est√° conectado, existen varias posibilidades de llamar
el algoritmo PID y el formador de impulsos:
‚óè SELECT = 0: el regulador se llama en un nivel de alarmas c√≠clicas r√°pido y se
procesan el algoritmo PID y el formador de impulsos.
‚óè SELECT = 1: el regulador se llama en el OB1 y s√≥lo se procesa el algoritmo PID.
‚óè SELECT = 2: el regulador se llama en un nivel de alarmas c√≠clicas r√°pido y s√≥lo
se procesa el formador de impulsos.
‚óè SELECT = 3: el regulador se llama en un nivel de alarmas c√≠clicas lento y s√≥lo
se procesa el algoritmo PID.

6272

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Funcionamiento del generador de impulsos (P√°gina 6268)
Diagrama de bloques TCONT_CP (P√°gina 6271)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

Par√°metros de salida de TCONT_CP
Tabla 4-274
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

PV

14.0

REAL

0.0

En la salida "Valor real" se indica el valor real que act√∫a efectivamente.
Los valores v√°lidos dependen de los sensores utilizados.

LMN

18.0

REAL

0.0

En la salida "Variable manipulada" se indica la variable manipulada realmente
efectiva en formato de coma flotante.

LMN_PER

22.0

INT

0

La variable manipulada en formato de periferia se conecta al regulador en la
salida "Variable manipulada de la periferia".

QPULSE

24.0

BOOL

FALSE La variable manipulada se emite con modulaci√≥n de ancho de impulsos por la
salida QPULSE.

QLMN_HLM

24.1

BOOL

FALSE La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La salida QLMN_HLM notifica que se ha alcanzado el l√≠mite superior.

QLMN_LLM

24.2

BOOL

FALSE La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La salida QLMN_LLM notifica que se ha alcanzado el l√≠mite inferior.

QC_ACT

24.3

BOOL

TRUE

El par√°metro indica si se va a procesar la acci√≥n del regulador continuo en la
siguiente llamada de bloque (s√≥lo relevante si SELECT tiene el valor 0 √≥ 1).

Consulte tambi√©n
Funcionamiento del generador de impulsos (P√°gina 6268)
Diagrama de bloques TCONT_CP (P√°gina 6271)
Par√°metro STATUS_H (P√°gina 6279)
Par√°metro STATUS_D (P√°gina 6280)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6273

Instrucciones
4.2 Instrucciones

Par√°metros de entrada/salida de TCONT_CP
Tabla 4-275
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

CYCLE

26.0

REAL

0.1 s

Valor predeterminado del tiempo de muestreo para el algoritmo PID. El optimi‚Äê
zador calcula el tiempo
de muestreo en la fase 1 y lo deposita en CYCLE.
CYCLE > 0.001 s

CYCLE_P

30.0

REAL

0.02 s

En esta entrada se indica el tiempo de muestreo para la acci√≥n del formador de
impulsos. La instrucci√≥n TCONT_CP calcula el tiempo de muestreo en la fase 1
y lo deposita en CYCLE_P.
CYCLE_P > 0.001 s

SP_INT

34.0

REAL

0.0

La entrada "Consigna interna" sirve para preseleccionar una consigna.
Los valores v√°lidos dependen de los sensores utilizados.

MAN

38.0

REAL

0.0

La entrada "Valor manual" sirve para predeterminar un valor manual. En modo
autom√°tico, se corrige seg√∫n la variable manipulada.

COM_RST

42.0

BOOL

FALSE El bloque tiene una rutina de inicializaci√≥n, que se ejecuta cuando se activa la
entrada COM_RST.

MAN_ON

42.1

BOOL

TRUE

Si est√° activada la entrada "Conectar modo manual", el lazo de regulaci√≥n est√°
interrumpido. Como variable manipulada se especifica el valor manual MAN.

Consulte tambi√©n
Funcionamiento del generador de impulsos (P√°gina 6268)
Diagrama de bloques TCONT_CP (P√°gina 6271)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

Variables est√°ticas de TCONT_CP
Tabla 4-276
Par√°metro

Direc‚Äê
ci√≥n

Tipo
Ajuste Descripci√≥n
de da‚Äê prede‚Äê
tos
termi‚Äê
nado

DEADB_W

44.0

REAL

0.0

El error de regulaci√≥n se conduce por una zona muerta. La entrada "Ancho de
zona muerta" determina el tama√±o de la zona muerta.
Los valores v√°lidos dependen de los sensores utilizados.

I_ITLVAL

48.0

REAL

0.0

La salida del integrador se puede aplicar en la entrada I_ITL_ON. En la entrada
"Valor de inicializaci√≥n para la acci√≥n I" est√° el valor de inicializaci√≥n. Durante el
rearranque completo COM_RST = TRUE, la acci√≥n I se ajusta al valor de inicia‚Äê
lizaci√≥n.
Se admiten valores entre -100 y 100 %.

6274

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
Ajuste Descripci√≥n
de da‚Äê prede‚Äê
tos
termi‚Äê
nado

LMN_HLM

52.0

REAL

100.0

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite superior de la variable manipulada" indica el l√≠mite superior.
LMN_HLM > LMN_LLM

LMN_LLM

56.0

REAL

0.0

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite inferior de la variable manipulada" indica el l√≠mite inferior.

PV_FAC

60.0

REAL

1.0

La entrada "Factor de valor real" se multiplica por "Valor real de la periferia". La
entrada sirve para adaptar el rango del valor real.

PV_OFFS

64.0

REAL

0.0

La entrada "Offset de valor real" se suma a "Valor real de periferia". La entrada
sirve para adaptar el rango del valor real.

LMN_FAC

68.0

REAL

1.0

La entrada "Factor de la variable manipulada" se multiplica por la variable mani‚Äê
pulada. La entrada sirve para adaptar el rango de la variable manipulada.

LMN_OFFS

72.0

REAL

0.0

La entrada "Offset de la variable manipulada" se suma a la variable manipulada.
La entrada sirve para adaptar el rango de la variable manipulada.

PER_TM

76.0

REAL

1.0 s

En el par√°metro PER_TM se introduce la duraci√≥n del periodo de la modulaci√≥n
de ancho de impulsos. La relaci√≥n entre duraci√≥n de periodo y tiempo de mues‚Äê
treo del formador de impulsos determina la precisi√≥n de la modulaci√≥n de ancho
de impulsos.

LMN_LLM < LMN_HLM

PER_TM ‚â• CYCLE
P_B_TM

80.0

REAL

0.02 s

En el par√°metro "Duraci√≥n m√≠nima de impulso" o "Duraci√≥n m√≠nima de pausa" se
puede parametrizar una duraci√≥n de pausa o de impulso m√≠nima. P_B_TM se
limita internamente a > CYCLE_P.

TUN_DLMN 84.0

REAL

20.0

La excitaci√≥n del proceso para la optimizaci√≥n del regulador se realiza mediante
un salto de la variable manipulada de TUN_DLMN.
Se admiten valores entre -100 y 100 %.

PER_MO‚Äê
DE

88.0

INT

0

En este conmutador se puede indicar el tipo del m√≥dulo E/S. El valor real de la
entrada PV_PER se normaliza as√≠ en la salida PV de la siguiente manera.
‚óè PER_MODE = 0: termopares; PT100/NI100; Est√°ndar
PV_PER * 0.1
Unidad: ¬∞C, ¬∞F
‚óè PER_MODE = 1: PT100/NI100; Climatizaci√≥n
PV_PER * 0.01
Unidad: ¬∞C, ¬∞F
‚óè PER_MODE = 2: Intensidad/tensi√≥n
PV_PER * 100/27648
Unidad: %

PVPER_ON 90.0

BOOL

FAL‚Äê
SE

Si se debe leer el valor real de la periferia, la entrada PV_PER debe estar inter‚Äê
conectada con la periferia, y la entrada "Activar valor real de periferia" debe estar
activada.

I_ITL_ON

90.1

BOOL

FAL‚Äê
SE

La salida del integrador se puede aplicar a la entrada I_ITLVAL. Para ello debe
estar activada la entrada "Inicializar acci√≥n I".

PULSE_ON

90.2

BOOL

FAL‚Äê
SE

Con PULSE_ON = TRUE se activa el formador de impulsos.

TUN_KEEP

90.3

BOOL

FAL‚Äê
SE

No se pasa al modo autom√°tico hasta que TUN_KEEP sea FALSE.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6275

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
Ajuste Descripci√≥n
de da‚Äê prede‚Äê
tos
termi‚Äê
nado

ER

92.0

REAL

0.0

En la salida "Error de regulaci√≥n" se indica el error de regulaci√≥n que act√∫a real‚Äê
mente.
Los valores v√°lidos dependen de los sensores utilizados.

LMN_P

96.0

REAL

0.0

La salida "Acci√≥n P" contiene la acci√≥n proporcional de la magnitud manipulada.

LMN_I

100.0

REAL

0.0

La salida "Acci√≥n I" contiene la acci√≥n integral de la magnitud manipulada.

LMN_D

104.0

REAL

0.0

La salida "Acci√≥n D" contiene la acci√≥n derivativa de la magnitud manipulada.

PHASE

108.0

INT

0

En la salida PHASE se indica la fase de ejecuci√≥n actual de la optimizaci√≥n del
regulador.
‚óè PHASE = 0: no hay modo de optimizaci√≥n; modo autom√°tico o manual
‚óè PHASE = 1: disponibilidad para la optimizaci√≥n; comprobar par√°metros,
esperar excitaci√≥n, medir los tiempos de muestreo
‚óè PHASE = 2: optimizaci√≥n propiamente dicha: B√∫squeda de punto de inversi√≥n
con variable manipulada constante. Entrada del tiempo de muestreo en el DB
de instancia.
‚óè PHASE = 3: c√°lculo de los par√°metros del proceso. Guardar los par√°metros
del regulador v√°lidos antes de la optimizaci√≥n.
‚óè PHASE = 4: dise√±o del regulador
‚óè PHASE = 5: correcci√≥n del regulador a la nueva variable manipulada
‚óè PHASE = 7: verificaci√≥n del tipo de sistema

STATUS_H

110.0

INT

0

STATUS_H indica un valor de diagn√≥stico a trav√©s de la b√∫squeda del punto de
inversi√≥n en el proceso de calentamiento.

STATUS_D

112.0

INT

0

STATUS_D indica un valor de diagn√≥stico a trav√©s del dise√±o del regulador en el
proceso de calentamiento.

QTUN_RUN 114.0

BOOL

0

La optimizaci√≥n se ha iniciado mediante la aplicaci√≥n de la magnitud manipulada
de optimizaci√≥n y en estos momentos se encuentra en la fase 2 (b√∫squeda del
punto de inversi√≥n).

PI_CON

STRU
CT

GAIN

116.0
+0.0

REAL

Par√°metros PI del regulador
0.0

Ganancia PI del regulador
%/unidad f√≠sica

TI
PID_CON

+4.0
124.0

REAL

0.0 s

STRU
CT

Tiempo de integraci√≥n PI [s]
Par√°metros PID del regulador

GAIN

+0.0

REAL

0.0

Ganancia PID del regulador

TI

+4.0

REAL

0.0s

Tiempo de integraci√≥n PID [s]

TD

+8.0

REAL

0.0s

Tiempo de acci√≥n derivada PID [s]

PAR_SAVE

136.0

STRU
CT

En esta estructura se guardan los par√°metros PID.

PFAC_SP

+0.0

REAL

1.0

GAIN

+4.0

REAL

0.0

TI

+8.0

REAL

40.0 s

Ganancia proporcional al cambiar la consigna
Se admiten valores comprendidos entre 0.0 y 1.0.
Ganancia del regulador
%/unidad f√≠sica

6276

Tiempo de integraci√≥n [s]

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
Ajuste Descripci√≥n
de da‚Äê prede‚Äê
tos
termi‚Äê
nado

TD

+12.0

REAL

10.0 s

Tiempo de acci√≥n derivada [s]

D_F

+16.0

REAL

5.0

Factor de acci√≥n derivada

CON_ZONE

+20.0

REAL

100.0

Se admiten valores comprendidos entre 5.0 y 10.0.
Ancho de zona de regulaci√≥n
Si el error de regulaci√≥n es mayor que el ancho de la zona de regulaci√≥n, se emite
el l√≠mite superior de la variable manipulada como variable manipulada. Si el error
de regulaci√≥n es menor que el ancho de la zona de regulaci√≥n negativa, se emite
el l√≠mite inferior de la variable manipulada como variable manipulada.
CON_ZONE ‚â• 0.0
CONZ_ON
PFAC_SP

+24.0
162.0

BOOL

FAL‚Äê
SE

Activar zona de regulaci√≥n

REAL

1.0

PFAC_SP indica la acci√≥n P efectiva en caso de modificaci√≥n de la consigna. Se
ajusta entre 0 y 1.
‚óè 1: La acci√≥n P tambi√©n est√° completamente operativa en caso de
modificaciones de la consigna.
‚óè 0: La acci√≥n P no est√° operativa en caso de modificaciones de la consigna.
Se admiten valores comprendidos entre 0.0 y 1.0.

GAIN

166.0

REAL

2.0

La entrada "Ganancia proporcional" indica la ganancia del regulador. El sentido
de actuaci√≥n del regulador se invierte mediante el signo negativo de GAIN.
%/unidad f√≠sica

TI

170.0

REAL

40.0 s

La entrada "Tiempo de integraci√≥n" (tiempo de acci√≥n integral) determina el com‚Äê
portamiento temporal del integrador.

TD

174.0

REAL

10.0 s

La entrada "Tiempo de acci√≥n derivada" (tiempo de anticipaci√≥n) determina el
comportamiento temporal del diferenciador.

D_F

178.0

REAL

5.0

El factor de acci√≥n derivada determina el retardo de la acci√≥n D.
D_F = tiempo de acci√≥n derivada/"Retardo de la acci√≥n D"
Se admiten valores comprendidos entre 5.0 y 10.0.

CON_ZONE 182.0

REAL

100.0

Si el error de regulaci√≥n es mayor que el ancho de la zona de regulaci√≥n, se emite
el l√≠mite superior de la variable manipulada como variable manipulada.
Si el error de regulaci√≥n es menor que el ancho de la zona de regulaci√≥n negativa,
se emite el l√≠mite inferior de la variable manipulada como variable manipulada.
Los valores v√°lidos dependen de los sensores utilizados.

CONZ_ON

186.0

BOOL

FAL‚Äê
SE

Con CONZ_ON =TRUE se puede activar la zona de regulaci√≥n.

TUN_ON

186.1

BOOL

FAL‚Äê
SE

Si TUN_ON=TRUE se toma el promedio de la variable manipulada hasta que se
aplica la excitaci√≥n de la variable manipulada TUN_DLMNmediante un salto de
consigna o TUN_ST=TRUE.

TUN_ST

186.2

BOOL

FAL‚Äê
SE

Si la consigna debe permanecer constante durante la optimizaci√≥n del regulador
en el punto de operaci√≥n, se aplica un salto de la variable manipulada de
TUN_DLMN mediante TUN_ST=1.

UNDO_PAR 186.3

BOOL

FAL‚Äê
SE

Carga los par√°metros del regulador PFAC_SP, GAIN, TI, TD, D_F CONZ_ON y
CON_ZONE desde la estructura de datos PAR_SAVE (s√≥lo en modo manual).

SAVE_PAR

BOOL

FAL‚Äê
SE

Guarda los par√°metros del regulador PFAC_SP, GAIN, TI, TD, D_F, CONZ_ON y
CON_ZONE en la estructura de datos PAR_SAVE.

186.4

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6277

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
Ajuste Descripci√≥n
de da‚Äê prede‚Äê
tos
termi‚Äê
nado

LOAD_PID

186.5

BOOL

FAL‚Äê
SE

Carga los par√°metros del regulador GAIN, TI, TD en funci√≥n de PID_ON desde la
estructura de datos PI_CON o bien PID_CON (s√≥lo en modo manual)

PID_ON

186.6

BOOL

TRUE

En la entrada PID_ON se puede determinar si el regulador optimizado debe tra‚Äê
bajar como regulador PI o PID.
‚óè Regulador PID: PID_ON = TRUE
‚óè Regulador PI: PID_ON = FALSE
Puede ocurrir que en algunos tipos de proceso s√≥lo se dise√±e un regulador PI a
pesar de PID_ON = TRUE.

GAIN_P

188.0

REAL

0.0

Ganancia del proceso identificada. En el tipo de sistema I, se tiende a estimar un
valor demasiado bajo para GAIN_P.

TU

192.0

REAL

0.0

Tiempo de retardo identificado del proceso.
TU ‚â• 3*CYCLE

TA

196.0

REAL

0.0

Tiempo de compensaci√≥n identificado del proceso. En el tipo de sistema I, se
tiende a estimar un valor demasiado bajo para TA.

KIG

200.0

REAL

0.0

Subida m√°xima del valor real con una excitaci√≥n de la variable manipulable de 0
a 100 % [1/s]
GAIN_P = 0.01 * KIG * TA

N_PTN

204.0

REAL

0.0

El par√°metro indica el orden del proceso. Tambi√©n se pueden utilizar "valores no
enteros".
Se admiten valores comprendidos entre 1.01 y 10.0.

TM_LAG_P

208.0

REAL

0.0

Constante temporal de un modelo PTN (valores significativos s√≥lo para
N_PTN >= 2).

T_P_INF

212.0

REAL

0.0

Tiempo desde la excitaci√≥n del proceso hasta el punto de inversi√≥n.

P_INF

216.0

REAL

0.0

Modificaci√≥n del valor real desde la excitaci√≥n del proceso hasta el punto de
inversi√≥n.

LMN0

220.0

REAL

0.0

Variable manipulada al principio de la optimizaci√≥n

Los valores v√°lidos dependen de los sensores utilizados.
Se calcula en la fase 1 (valor medio).
Se admiten valores entre 0 y 100 %.
PV0

224.0

REAL

0.0

Valor real al principio de la optimizaci√≥n

PVDT0

228.0

REAL

0.0

Subida del valor real al iniciar la optimizaci√≥n [1/s]
Con adaptaci√≥n de signo.

PVDT

232.0

REAL

0.0

Subida moment√°nea del valor real [1/s]
Con adaptaci√≥n de signo.

PVDT_MAX

236.0

REAL

0.0

Modificaci√≥n m√°x. del valor real por segundo [1/s]
Derivaci√≥n m√°xima del valor real en el punto de inversi√≥n (con adaptaci√≥n de
signo, siempre > 0); se utiliza para calcular TU y KIG.

NOI_PVDT

240.0

REAL

0.0

Nivel de ruido en PVDT_MAX en %
Cuanto mayor sea el nivel de ruido, menos precisos (de efecto m√°s suave) ser√°n
los par√°metros del regulador.

NOISE_PV

244.0

REAL

0.0

Ruido absoluto en el valor real
Diferencia entre el valor real m√°ximo y m√≠nimo en la fase 1.

6278

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
Ajuste Descripci√≥n
de da‚Äê prede‚Äê
tos
termi‚Äê
nado

FIL_CYC

248.0

INT

1

N√∫mero de ciclos del filtro de valores medios
Se calcula un valor medio del valor real a partir de FIL_CYC ciclos. En caso
necesario, FIL_CYC se aumenta autom√°ticamente entre 1 y m√°x. 1024.

POI_CMAX

250.0

INT

2

N√∫mero m√°x. de ciclos tras el punto de inversi√≥n
Este tiempo se utiliza para encontrar otro punto de inversi√≥n (es decir, uno mejor)
en caso de ruidos de medici√≥n. S√≥lo entonces concluye la optimizaci√≥n.

POI_CYCL

252.0

INT

0

N√∫mero de ciclos tras el punto de inversi√≥n

Consulte tambi√©n
Funcionamiento del generador de impulsos (P√°gina 6268)
Diagrama de bloques TCONT_CP (P√°gina 6271)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

Par√°metro STATUS_H
STATUS_H

Descripci√≥n

0

Par√°metros del regulador predeter‚Äê
minados, ning√∫n par√°metro o ningu‚Äê
no nuevo

10000

Optimizaci√≥n finalizada + par√°me‚Äê
tros adecuados encontrados para el
regulador

2xxxx

Optimizaci√≥n finalizada + par√°me‚Äê
tros del regulador inseguros

2xx2x

Punto de inversi√≥n no alcanzado (s√≥‚Äê Si el regulador oscila, atenuar los par√°metros
lo en caso de excitaci√≥n mediante
del regulador o repetir el ensayo con una dife‚Äê
salto de consigna)
rencia menor de la variable manipulada
TUN_DLMN.

2x1xx

Error de estimaci√≥n (TU < 3*CYCLE) Reducir CYCLE y repetir el ensayo.
Caso excepcional proceso PT1 puro: No repetir
el ensayo, atenuar los par√°metros del regulador
si procede.

2x3xx

Error de estimaci√≥n TU demasiado
grande

Repetir el ensayo con mejores condiciones.

21xxx

Error de estimaci√≥n N_PTN < 1

Repetir el ensayo con mejores condiciones.

22xxx

Error de estimaci√≥n N_PTN > 10

Repetir el ensayo con mejores condiciones.

3xxxx

Optimizaci√≥n cancelada en fase 1 de‚Äê
bido a parametrizaci√≥n err√≥nea:

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Soluci√≥n

6279

Instrucciones
4.2 Instrucciones
STATUS_H

Descripci√≥n

30002

Diferencia efectiva de la variable ma‚Äê Corregir la diferencia de la variable manipulada
nipulada < 5 %
TUN_DLMN.

Soluci√≥n

30005

Los tiempos de muestreo CYCLE y
CYCLE_P difieren en m√°s del 5% de
los valores medidos.

Compare CYCLE y CYCLE_P con el tiempo de
ciclo del nivel de alarmas c√≠clicas y considere
los posibles distribuidores de llamada.
Compruebe el grado de utilizaci√≥n de la CPU.
Una CPU con una carga excesiva conlleva tiem‚Äê
pos de muestreo excesivos, que no concuerdan
con CYCLE ni CYCLE_P.

Nota
Si se cancela la optimizaci√≥n en la fase 1 √≥ 2, entonces STATUS_H = 0. Sin embargo,
STATUS_D sigue indicando el estado del √∫ltimo c√°lculo del regulador.
Cuanto mayor sea el valor de STATUS_D, mayor ser√° el orden del proceso regulado, mayor
la relaci√≥n TU/TA y m√°s suaves los par√°metros del regulador.

Consulte tambi√©n
Funcionamiento del generador de impulsos (P√°gina 6268)
Diagrama de bloques TCONT_CP (P√°gina 6271)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

Par√°metro STATUS_D

STATUS_D

Descripci√≥n

0

No se han calculado par√°metros del regulador

110

N_PTN <= 1.5 Tipo de sistema I r√°pido

121

N_PTN > 1.5 Tipo de sistema I

200

N_PTN > 1.9 Tipo de sistema II (rango de transici√≥n)

310

N_PTN >= 2.1 Tipo de sistema III r√°pido

320

N_PTN > 2.6 Tipo de sistema III

111, 122, 201, 311, 321

Los par√°metros se han corregido en la fase 7.

Nota
Cuanto mayor sea el valor de STATUS_D, mayor ser√° el orden del proceso regulado, mayor
la relaci√≥n TU/TA y m√°s suaves los par√°metros del regulador.

6280

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Funcionamiento del generador de impulsos (P√°gina 6268)
Diagrama de bloques TCONT_CP (P√°gina 6271)
Diferencias respecto a TCONT_CP S7-300/400 (P√°gina 3829)

TCONT_S
Descripci√≥n de TCONT_S
La instrucci√≥n TCONT_S permite regular lazos de temperatura t√©cnicos con se√±ales de salida
binarias de la variable manipulada para actuadores integrantes en los sistemas de
automatizaci√≥n SIMATIC S7. El funcionamiento se basa en el algoritmo de regulaci√≥n PI del
regulador de muestreo. El regulador opera sin realimentaci√≥n de posici√≥n.

Aplicaci√≥n
El regulador tambi√©n se puede utilizar en una cascada de reguladores como posicionador
subordinado. La entrada de la consigna SP_INT predetermina la posici√≥n del actuador. En este
caso, tanto la entrada de valor real como el par√°metro TI tienen que estar a 0 (tiempo integral).
Un ejemplo de aplicaci√≥n ser√≠a una regulaci√≥n de la temperatura con regulaci√≥n de la potencia
calor√≠fica a trav√©s de un control pulso/pausa y con regulaci√≥n de la potencia frigor√≠fica a trav√©s
de una v√°lvula de mariposa. Para cerrar completamente la v√°lvula, la magnitud manipulada
debe pasar a ser negativa (ER*GAIN).

Llamada
La instrucci√≥n TCONT_S debe llamarse de forma equidistante. Utilice para ello un nivel de
alarmas c√≠clicas (p. ej. OB35 en S7-300). El tiempo de muestreo se predetermina en el
par√°metro CYCLE.
Si se efect√∫a una llamada a la instrucci√≥n TCONT_S como DB multiinstancia, no se crea
ning√∫n objeto tecnol√≥gico. No se dispone de interfaz de parametrizaci√≥n y puesta en servicio.
Los TCONT_S se deben parametrizar directamente en el DB multiinstancia y ponerse en
servicio a trav√©s de una tabla de observaci√≥n.

Tiempo de muestreo CYCLE
El tiempo de muestreo CYCLE debe coincidir con la diferencia de tiempo entre dos llamadas
(tiempo de ciclo del OB de alarma c√≠clica observando los factores de ciclo).
El tiempo de muestreo del regulador no deber√≠a exceder m√°s del 10 % del tiempo integral
determinado para el regulador (TI). Sin embargo, normalmente se debe ajustar un tiempo de
muestreo mucho menor para garantizar la precisi√≥n exigida del regulador paso a paso.
Precisi√≥n exigida G MTR_TM

CYCLE = MTR_TM*G

Comentario

0,5 %

0,05 s

El tiempo de muestreo viene deter‚Äê
minado por la precisi√≥n exigida del
regulador paso a paso.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

10 s

6281

Instrucciones
4.2 Instrucciones

Arranque
La instrucci√≥n TCONT_S incluye una rutina de inicializaci√≥n, que se ejecuta cuando el
par√°metro de entrada COM_RST = TRUE est√° activado. El bloque vuelve a ajustarse a FALSE
despu√©s de ejecutar la rutina de inicializaci√≥n COM_RST. Todas las salidas se ajustan a sus
respectivos valores iniciales. Si desea realizar una inicializaci√≥n con un rearranque completo
de la CPU, llame la instrucci√≥n en el OB 100 con COM_RST = TRUE.

Consulte tambi√©n
Diagrama de bloques de TCONT_S (P√°gina 6286)
Diferencias respecto a TCONT_S S7-300/400 (P√°gina 3830)

Funcionamiento de TCONT_S
Rama de consigna
La consigna se introduce en la entrada SP_INT en formato de coma flotante, ya sea f√≠sico o
porcentual. La consigna y el valor real deben tener la misma unidad en la formaci√≥n del error
de regulaci√≥n.

Selecci√≥n del valor real (PVPER_ON)
El valor real se puede leer en formato de coma flotante o en formato de periferia en funci√≥n de
PVPER_ON.
PVPER_ON

Introducci√≥n del valor real

TRUE

El valor real se lee a trav√©s de la periferia anal√≥gica (PEW xxx) en la entrada
PV_PER.

FALSE

El valor real se lee en formato de coma flotante en la entrada PV_IN.

Conversi√≥n del formato del valor real CRP_IN (PER_MODE)
La funci√≥n CRP_IN convierte el valor de periferia PV_PER dependiendo del conmutador
PER_MODE en un valor en coma flotante seg√∫n la siguiente regla:
PER_MODE

Salida de CRP_IN

Tipo de entrada anal√≥‚Äê
gica

Unidad

0

PV_PER * 0.1

Termopares; PT100/
NI100; Est√°ndar

¬∞C;¬∞F

1

PV_PER * 0.01

PT100/NI100; Climati‚Äê
zaci√≥n;

¬∞C;¬∞F

2

PV_PER * 100/27648

Tensi√≥n/intensidad

%

Normalizaci√≥n del valor real PV_NORM (PF_FAC, PV_OFFS)
La funci√≥n PV_NORM calcula la salida de CRP_IN seg√∫n la siguiente norma:

6282

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
"Salida de PV_NORM" = "salida de CRP_IN" * PV_FAC + PV_OFFS
Se puede utilizar para los siguientes prop√≥sitos:
‚óè Adaptaci√≥n del valor real con PV_FAC como factor del valor real y PV_OFFS como offset
del valor real
‚óè Normalizaci√≥n de la temperatura en porcentajes
Desea indicar la consigna en porcentajes y ahora debe convertir el valor de temperatura
medido en un valor porcentual.
‚óè Normalizaci√≥n de los valores porcentuales a temperaturas
Desea indicar la consigna en la magnitud f√≠sica Temperatura y ahora hay que convertir el
valor de tensi√≥n/intensidad medido en una temperatura.
C√°lculo de los par√°metros:
‚óè PV_FAC = rango de PV_NORM/ rango de CRP_IN;
‚óè PV_OFFS = LI(PV_NORM) - PV_FAC * LI(CRP_IN);
siendo LI: l√≠mite inferior
Con los valores predeterminados (PV_FAC = 1.0 y PV_OFFS = 0.0) la normalizaci√≥n est√°
desactivada. El valor real con efectos reales se emite en la salida PV.

Ejemplo de normalizaci√≥n del valor real
Para preseleccionar la consigna en porcentajes con un rango de temperatura de -20 a 85 ¬∞C
en CRP_IN, normalice el rango de temperatura a valores porcentuales.
En la siguiente figura encontrar√° un ejemplo para la adaptaci√≥n de un rango de temperatura de
entre -20 y 85 ¬∞C a valores de 0 a 100 %:
39B1250 >@


39B)$&   





39B2))6  









 

&53B,1>r&@

C√°lculo de error de regulaci√≥n
La diferencia entre la consigna y el valor real constituye el error de regulaci√≥n antes de la zona
muerta.
La consigna y el valor real deben estar indicados con la misma unidad.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6283

Instrucciones
4.2 Instrucciones

Zona muerta (DEADB_W)
Para suprimir una peque√±a oscilaci√≥n permanente debida a la cuantificaci√≥n de la magnitud
manipulada (p. ej. en una modulaci√≥n de ancho de impulsos con PULSEGEN), el error de
regulaci√≥n se conduce por una zona muerta (DEADBAND). Con DEADB_W = 0.0 la zona
muerta est√° desactivada.
(5

(5  63B,1739 '($'B:

(5  63B,1739 '($'B:

63B,1739
'($'%B:

Algoritmo del regulador paso a paso PI
La instrucci√≥n TCONT_S opera sin realimentaci√≥n de posici√≥n. La acci√≥n I del algoritmo PI y
la realimentaci√≥n de posici√≥n estimada se calculan en un integrador (INT) y se comparan como
valor de realimentaci√≥n con la acci√≥n P restante. La diferencia pasa a un elemento de tres
puntos (THREE_ST) y a un generador de impulsos (PULSEOUT), que genera los impulsos
para la servov√°lvula. Mediante una adaptaci√≥n del umbral de respuesta del elemento de tres
niveles se reduce la frecuencia de conmutaci√≥n del regulador.

Atenuaci√≥n de la acci√≥n P en caso de modificaciones de la consigna
Para evitar sobreoscilaciones, es posible atenuar la acci√≥n P a trav√©s del par√°metro "Ganancia
proporcional al cambiar la consigna" (PFAC_SP). Mediante PFAC_SP se puede elegir
entonces continuamente la intensidad - entre 0.0 y 1.0 - con la que debe actuar la acci√≥n P en
caso de modificaciones de la consigna:
‚óè PFAC_SP = 1.0: la acci√≥n P act√∫a plenamente al cambiar la consigna
‚óè PFAC_SP = 0.0: sin acci√≥n P en caso de modificaci√≥n de la consigna
Un valor de PFAC_SP < 1.0 puede reducir las sobreoscilaciones como en el caso de un
regulador continuo si el tiempo de funcionamiento del motor MTR_TM es corto con respecto al
tiempo de compensaci√≥n TA, y la relaci√≥n es TU/TA < 0.2. Si MTR_TM alcanza el 20 % de TA,
s√≥lo se puede lograr una peque√±a mejora.

Control anticipativo
En la entrada DISV se puede aplicar una magnitud perturbadora de manera aditiva.

6284

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Procesamiento de valores en manual (LMNS_ON, LMNUP, LMNDN)
LMNS_ON permite conmutar entre los modos manual y autom√°tico. En el modo manual, el
elemento final de control se detiene y el integrador (INT) se pone a 0 de forma interna.
Mediante LMNUP y LMNDN se puede mover el elemento final de control ARRIBA y ABAJO. La
conmutaci√≥n al modo Autom√°tico se efect√∫a con discontinuidad. El error de regulaci√≥n
existente conduce, a trav√©s de GAIN, a una modificaci√≥n en forma de salto de la magnitud
manipulada interna. Mediante el elemento final de control de acci√≥n integral s√≥lo se obtiene un
control del proceso en forma de rampa.

Consulte tambi√©n
Diagrama de bloques de TCONT_S (P√°gina 6286)
Diferencias respecto a TCONT_S S7-300/400 (P√°gina 3830)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6285

Instrucciones
4.2 Instrucciones

Diagrama de bloques de TCONT_S
63B,17

393(5B21

39B,1



&53B,1

39B1250

r&


39B3(5

*$,1

'($'%$1'



;

'($'%B:



39

3(5B02'( 39B)$&
39B2))6
I

(5

63B,17

3)$&B63

/015B+6
/015B/6
/0183
/01'1
/016B21



38/6(287



7+5((B6
DGDSWLY

',69



$1'

$1'

$1'

$1'

4/0183






4/01'1

38/6(B70
%5($.B70

075B70








/016B21

7,



25

,17




;










075B70

;







Interfaz de parametrizaci√≥n
Interfaz de llamada de instrucci√≥n
Interfaz de parametrizaci√≥n, interfaz de llamada de instrucci√≥n

Consulte tambi√©n
Diferencias respecto a TCONT_S S7-300/400 (P√°gina 3830)
Descripci√≥n de TCONT_S (P√°gina 6281)
Funcionamiento de TCONT_S (P√°gina 6282)
Par√°metros de entrada de TCONT_S (P√°gina 6287)

6286

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metros de salida de TCONT_S (P√°gina 6288)
Par√°metros de entrada/salida de TCONT_S (P√°gina 6288)
Variables est√°ticas de TCONT_S (P√°gina 6289)

Par√°metros de entrada de TCONT_S
Tabla 4-277
Par√°me‚Äê
tro

Di‚Äê
rec‚Äê
ci√≥n

Tipo
de
datos

Ajus‚Äê Descripci√≥n
te
pre‚Äê
de‚Äê
ter‚Äê
mi‚Äê
nado

CYCLE

0.0

REAL 0.1 s

En esta entrada se indica el tiempo de muestreo para el regulador.
CYCLE ‚â• 0.001

SP_INT

4.0

REAL 0.0

La entrada "Consigna interna" sirve para preseleccionar una con‚Äê
signa.
Los valores v√°lidos dependen de los sensores utilizados.

PV_IN

8.0

REAL 0.0

En la entrada "Valor real de la entrada" se puede parametrizar un
valor de puesta en marcha, o se puede conectar un valor real ex‚Äê
terno en coma flotante.

PV_PER

12.0

INT

El valor real en formato de periferia se conecta al regulador a trav√©s
de la entrada "Valor real de la periferia".

DISV

14.0

REAL 0.0

Para realizar un control anticipativo, la magnitud perturbadora se
conecta a la entrada "Variable perturbadora".

LMNR_H
S

18.0

BOO
L

La se√±al "Servov√°lvula en el tope superior" se aplica en la entrada
"Se√±al de tope superior de la realimentaci√≥n de posici√≥n".

Los valores v√°lidos dependen de los sensores utilizados.
0

FAL‚Äê
SE

‚óè LMNR_HS=TRUE: la servov√°lvula se encuentra en el tope
superior.
LMNR_L
S

18.1

BOO
L

FAL‚Äê
SE

La se√±al "Servov√°lvula en el tope inferior" se aplica en la entrada
"Se√±al de tope inferior de la realimentaci√≥n de posici√≥n".
‚óè LMNR_LS=TRUE:
la servov√°lvula se encuentra en el tope inferior.

LMNS_O
N

18.2

BOO
L

TRU
E

En la entrada "Activar el modo manual de las se√±ales de la variable
manipulada" el procesamiento de las se√±ales manipuladas pasa a
manual.

LMNUP

18.3

BOO
L

FAL‚Äê
SE

En el modo manual de las se√±ales de la variable manipulada se
controla la se√±al de salida QLMNUP en la entrada "Se√±al alta de
variable manipulada".

LMNDN

18.4

BOO
L

FAL‚Äê
SE

En el modo manual de las se√±ales de la variable manipulada se
controla la se√±al de salida QLMNDN en la entrada "Se√±al baja de
variable manipulada".

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6287

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Diagrama de bloques de TCONT_S (P√°gina 6286)
Diferencias respecto a TCONT_S S7-300/400 (P√°gina 3830)

Par√°metros de salida de TCONT_S
Tabla 4-278
Par√°me‚Äê
tro

Di‚Äê
rec‚Äê
ci√≥n

Tipo
de
datos

Ajus‚Äê Descripci√≥n
te
pre‚Äê
de‚Äê
ter‚Äê
mi‚Äê
nado

QLMNUP

20.0

BOO
L

FAL‚Äê
SE

Si la salida "Se√±al alta de variable manipulada" est√° activada, la
v√°lvula de control debe abrirse.

QLMNDN 20.1

BOO
L

FAL‚Äê
SE

Si est√° activada la salida "Se√±al baja de la variable manipulada", la
v√°lvula de control debe cerrarse.

PV

22.0

REAL 0.0

En la salida "Valor real" se indica el valor real que act√∫a efectiva‚Äê
mente.

ER

26.0

REAL 0.0

En la salida "Error de regulaci√≥n" se indica el error de regulaci√≥n que
act√∫a realmente.

Consulte tambi√©n
Diagrama de bloques de TCONT_S (P√°gina 6286)
Diferencias respecto a TCONT_S S7-300/400 (P√°gina 3830)

Par√°metros de entrada/salida de TCONT_S
Tabla 4-279
Par√°me‚Äê
tro

Di‚Äê
rec‚Äê
ci√≥n

Tipo
de
datos

Ajus‚Äê Descripci√≥n
te
pre‚Äê
de‚Äê
ter‚Äê
mi‚Äê
nado

COM_RS
T

30.0

BOO
L

FAL‚Äê
SE

El bloque tiene una rutina de inicializaci√≥n, que se ejecuta cuando
est√° activada la entrada COM_RST.

Consulte tambi√©n
Diagrama de bloques de TCONT_S (P√°gina 6286)
Diferencias respecto a TCONT_S S7-300/400 (P√°gina 3830)

6288

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Variables est√°ticas de TCONT_S
Tabla 4-280
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

PV_FAC

32.0

REAL

1.0

La entrada "Factor de valor real" se multiplica por el valor real. La entrada sirve
para adaptar el rango del valor real.

PV_OFFS

36.0

REAL

0.0

La entrada "Offset de valor real" se suma al valor real. La entrada sirve para adap‚Äê
tar el rango del valor real.
Los valores v√°lidos dependen de los sensores utilizados.

DEADB_W

40.0

REAL

0.0

El error de regulaci√≥n se conduce por una zona muerta. La entrada "Ancho de zona
muerta" determina el tama√±o de la zona muerta.

PFAC_SP

44.4

REAL

1.0

PFAC_SP indica la acci√≥n P efectiva en caso de modificaci√≥n de la consigna.

DEADB_W ‚â• 0.0
‚óè 1: La acci√≥n P est√° completamente operativa en caso de modificaciones de la
consigna.
‚óè 0: La acci√≥n P no est√° operativa en caso de modificaciones de la consigna.
Se admiten valores comprendidos entre 0.0 y 1.0.
GAIN

48.0

REAL

2.0

La entrada "Ganancia proporcional" indica la ganancia del regulador. El sentido de
actuaci√≥n del regulador se invierte mediante el signo negativo de GAIN.
%/unidad f√≠sica

TI

52.0

REAL

40.0 s

La entrada "Tiempo de integraci√≥n" (tiempo de acci√≥n integral) determina el com‚Äê
portamiento temporal del integrador.

MTR_TM

56.0

REAL

30 s

En el par√°metro "Tiempo de posicionamiento del motor" se introduce el tiempo de
operaci√≥n de la servov√°lvula de un tope al otro.
MTR_TM ‚â• CYCLE

PULSE_TM

60.0

REAL

0.0 s

En el par√°metro "Duraci√≥n m√≠nima de impulso" se puede parametrizar una dura‚Äê
ci√≥n de impulso m√≠nima.

BREAK_TM

64.0

REAL

0.0 s

En el par√°metro "Duraci√≥n m√≠nima de pausa" se puede parametrizar una longitud
de pausa m√≠nima.

INT

0

En este conmutador se puede indicar el tipo del m√≥dulo E/S. El valor real de la
entrada PV_PER se normaliza as√≠ en la salida PV de la siguiente manera.

PER_MODE 68.0

‚óè PER_MODE = 0: termopares; PT100/NI100; Est√°ndar
PV_PER * 0.1
Unidad: ¬∞C, ¬∞F
‚óè PER_MODE = 1: PT100/NI100; Climatizaci√≥n
PV_PER * 0.01
Unidad: ¬∞C, ¬∞F
‚óè PER_MODE = 2: Intensidad/tensi√≥n
PV_PER * 100/27648
Unidad: %
PVPER_ON

70.0

BOOL

FAL‚Äê
SE

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Si se debe leer el valor real de la periferia, la entrada PV_PER debe estar interco‚Äê
nectada con la periferia, y la entrada "Activar valor real de periferia" debe estar
activada.

6289

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Diagrama de bloques de TCONT_S (P√°gina 6286)
Diferencias respecto a TCONT_S S7-300/400 (P√°gina 3830)

Funciones de sistema integradas
CONT_C_SF
CONT_C_SF
La instrucci√≥n CONT_C_SF est√° integrada en las CPU S7-300 Compact. No es necesario
transmitir la instrucci√≥n al cargar en la CPU S7-300. Las funciones corresponden a la
instrucci√≥n CONT_C.

Consulte tambi√©n
Descripci√≥n de CONT_C (P√°gina 6236)
Funcionamiento de CONT_C (P√°gina 6237)
Diagrama de bloques de CONT_C (P√°gina 6239)
Par√°metros de entrada de CONT_C (P√°gina 6240)
Par√°metros de salida de CONT_C (P√°gina 6241)

CONT_S_SF
CONT_S_SF
La instrucci√≥n CONT_S_SF est√° integrada en las CPU S7-300 Compact. No es necesario
transmitir la instrucci√≥n al cargar en la CPU S7-300. Las funciones corresponden a la
instrucci√≥n CONT_S.

Consulte tambi√©n
Descripci√≥n de CONT_S (P√°gina 6242)
Funcionamiento de CONT_S (P√°gina 6243)
Diagrama de bloques de CONT_S (P√°gina 6245)
Par√°metros de entrada de CONT_S (P√°gina 6246)
Par√°metros de salida de CONT_S (P√°gina 6247)

6290

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

PULSEGEN_SF
PULSEGEN_SF
La instrucci√≥n PULSEGEN_SF est√° integrada en las CPU S7-300 Compact. No es necesario
transmitir la instrucci√≥n al cargar en la CPU S7-300. Las funciones corresponden a la
instrucci√≥n PULSEGEN.

Consulte tambi√©n
Descripci√≥n de PULSEGEN (P√°gina 6248)
Funcionamiento de PULSEGEN (P√°gina 6249)
Modos de operaci√≥n de PULSEGEN (P√°gina 6252)
Regulaci√≥n de tres puntos (P√°gina 6253)
Regulaci√≥n de dos puntos (P√°gina 6255)
Par√°metros de entrada de PULSEGEN (P√°gina 6256)
Par√°metros de salida de PULSEGEN (P√°gina 6258)

PID Self-Tuner
TUN_EC
Descripci√≥n de TUN_EC
La instrucci√≥n TUN_EC permite ajustar un regulador PID continuo. Seg√∫n el regulador,
TUN_EC se activa con una de las siguientes instrucciones:
‚óè Reguladores de impulsos FM 355 C, FM 355 S y reguladores de impulsos FM 455 C o FM
455 S
‚Äì PID_FM
‚óè Funciones b√°sicas PID
‚Äì CONT_C Con o sin PULSEGEN
‚óè Standard PID Control (paquete opcional PID Professional)
‚Äì PID_CP
‚óè Modular PID Control (paquete opcional PID Professional)
‚Äì PID
‚Äì LMNGEN_C

Llamada
TUN_EC se llama en una base de tiempo constante del tiempo de ciclo del OB invocante
(preferentemente en un OB de alarma c√≠clica).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6291

Instrucciones
4.2 Instrucciones
Con ADAPT1ST = TRUE se ejecuta la rutina de inicializaci√≥n de la instrucci√≥n TUN_EC. Se
llevan a cabo los siguientes ajustes predeterminados:
‚óè Se conmuta al regulador PI. Para ello se transfieren al regulador los par√°metros de
PI_CON. Si los par√°metros PI_CON.GAIN y PI_CON.TI tienen ambos el valor 0.0, se les
asignar√°n los valores predeterminados PI_CON.GAIN = 1.5 y PI_CON.TI = 3600.0 s.
‚óè PROCESS.GAIN = 999.0
‚óè RATIOFAC = 1.0
‚óè STATUS_H = 0; STATUS_D = 0; STATUS_C = 0
Nota
A menos que desee hacerlo expresamente, en caso de rearranque completo (en caliente)
de la CPU no llame TUN_ES como es habitual con otras instrucciones, pues de lo contrario
se perder√°n todos los par√°metros de proceso.
Si se efect√∫a una llamada de la instrucci√≥n TUN_EC como DB multiinstancia, no se crea
ning√∫n objeto tecnol√≥gico. No existe interfaz de puesta en servicio. TUN_EC debe ponerse en
servicio mediante una tabla de observaci√≥n.

Tiempo de muestreo CYCLE
El tiempo de muestreo se indica en el par√°metro CYCLE. El tiempo de muestreo no debe ser
superior al 10% del tiempo de integraci√≥n calculado del regulador. Debe coincidir con la
diferencia de tiempo entre dos llamadas (tiempo de ciclo del OB de alarma c√≠clica
considerando los factores de ciclo).
Para identificar de modo fiable los par√°metros de proceso, debe muestrearse por lo menos 10
√≥ 20 veces la constante de tiempo m√°s peque√±a del proceso (el tiempo de retardo).
Si se usan los m√≥dulos de regulaci√≥n FM355/455, el tiempo de muestreo de TUN_EC debe ser
aproximadamente igual al tiempo de ciclo resultante de los reguladores en el FM (Ajuste de
par√°metros > Par√°metros del m√≥dulo).

Comportamiento en caso de error
El bloque no eval√∫a la palabra de notificaci√≥n de error RET_VAL.

Consulte tambi√©n
Funcionamiento de TUN_EC (P√°gina 6295)
Par√°metros de entrada de TUN_EC (P√°gina 6300)
Par√°metros de salida de TUN_EC (P√°gina 6302)
Par√°metros de entrada/salida de TUN_EC (P√°gina 6304)
Par√°metro TUN_EC.PHASE (P√°gina 6306)
Par√°metro TUN_EC.STATUS_H (P√°gina 6308)
Par√°metro TUN_EC.STATUS_C (P√°gina 6309)
Par√°metro TUN_EC.STATUS_D (P√°gina 6310)

6292

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Campo de aplicaci√≥n de TUN_EC
El Self-Tuner resulta especialmente conveniente para
‚óè Regulaciones de temperatura, pero tambi√©n para
‚óè Regulaciones de nivel de llenado y
‚óè Regulaciones de caudal
Dentro de las regulaciones de caudal se distingue si debe regularse la servov√°lvula o si tras
√©sta se inicia un proceso sujeto a retardo. Si se trata de una regulaci√≥n puramente de la
servov√°lvula, es Self-Tuner no puede utilizarse.

Requisitos del proceso
El proceso debe cumplir las siguientes condiciones:
‚óè Comportamiento transitorio asint√≥tico, estable y sujeto a retardo
Despu√©s de un escal√≥n de la magnitud manipulada, el valor real debe pasar a un estado
estacionario. Con ello se excluyen procesos que presentan un comportamiento oscilante
incluso sin regulaci√≥n, as√≠ como procesos regulados sin compensaci√≥n (integrador en el
proceso regulado).
‚óè Tiempos de retardo no demasiado amplios
El campo de utilizaci√≥n puede especificarse a partir de la relaci√≥n entre el tiempo de retardo
tu y el tiempo de compensaci√≥n ta. El tiempo de retardo puede incluir adem√°s un tiempo
muerto.
El primer ajuste o adaptaci√≥n est√° orientado preferentemente para el rango tu < 1/10 ta, que
abarca la mayor√≠a de lazos de regulaci√≥n de temperatura.
Para el rango de tiempos de retardo especialmente elevados 1/10 ta < tu < 1/3 ta suele ser
posible dise√±ar un regulador PI adecuado.
‚óè Comportamiento suficientemente lineal durante un rango de trabajo suficientemente grande
Esto significa que, tanto para la identificaci√≥n como para el modo de regulaci√≥n normal, los
efectos no lineales dentro del rango de trabajo especificado pueden ignorarse. Sin
embargo, es posible volver a identificar el proceso cambiando el punto de operaci√≥n si el
proceso de adaptaci√≥n vuelve a ejecutarse en un entorno reducido del nuevo punto de
operaci√≥n, y si durante la adaptaci√≥n no se pasa por la no linealidad.
Si se conocen determinadas no linealidades est√°ticas (p. ej. caracter√≠sticas de v√°lvulas), es
aconsejable compensarlas previamente con una l√≠nea poligonal para linealizar el
comportamiento del proceso.
‚óè Perturbaciones reducidas en procesos de temperatura
Las perturbaciones como la transmisi√≥n t√©rmica a las zonas adyacentes, o el aumento o
descenso t√©rmico por el cambio de estado de grupos constructivos no pueden afectar en
exceso a todo el lazo de regulaci√≥n de temperatura. Puede ser necesaria una adaptaci√≥n
en el punto de operaci√≥n. Por ejemplo, en la optimizaci√≥n de zonas de un extrusor puede
ser necesario calentar simult√°neamente todas las zonas.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6293

Instrucciones
4.2 Instrucciones
‚óè Calidad de las se√±ales de medici√≥n
Las se√±ales de medici√≥n deben tener una calidad suficiente, es decir, que la relaci√≥n entre
la se√±al par√°sita y la se√±al √∫til sea lo suficientemente reducida.
‚óè Ganancias del proceso no demasiado grandes
Las ganancias del proceso no pueden ser demasiado elevadas. No es necesaria una
normalizaci√≥n de los valores reales. Por lo tanto, la ganancia del proceso K se ve afectada
por unidades f√≠sicas, p. ej.:
K =‚àÜPV/‚àÜLMN, [K]= ¬∞C/ %
El dise√±o definitivo del regulador se basa en un c√°lculo de la ganancia del proceso K, y en
principio puede compensar cualquier valor de K. Pero en la fase de aprendizaje K todav√≠a
no se conoce, y en combinaciones extremas de ganancia e intensidades de escal√≥n no es
posible evitar sobreoscilaciones transitorias. Reduciendo el par√°metro LHLM_TUN en el
proceso de calentamiento o aumentando LLLM_TUN en el de refrigeraci√≥n tambi√©n se
reduce el rebase transitorio.

Requisitos de procesos con servov√°lvulas de acci√≥n integral
En procesos con servov√°lvulas de acci√≥n integral existen otros requisitos adicionales a los
anteriores:
El tiempo de funcionamiento del motor de la servov√°lvula debe ser menor al necesario para
encontrar un punto de inversi√≥n tras un escal√≥n de la variable manipulada (v√©ase la figura
Comportamiento del proceso). Cuando no es as√≠, normalmente se trata de una regulaci√≥n de
caudal en la que s√≥lo act√∫a la servov√°lvula como acci√≥n dominante del proceso. En ese caso
no se recomienda el uso del Self-Tuner. El regulador PI paso a paso se puede regular
manualmente siguiendo la siguiente regla general:
GAIN = 1, TI = tiempo de posicionamiento del motor

Consulte tambi√©n
Funcionamiento de TUN_EC (P√°gina 6295)
Par√°metros de entrada de TUN_EC (P√°gina 6300)
Par√°metros de salida de TUN_EC (P√°gina 6302)
Par√°metros de entrada/salida de TUN_EC (P√°gina 6304)
Par√°metro TUN_EC.PHASE (P√°gina 6306)
Par√°metro TUN_EC.STATUS_H (P√°gina 6308)
Par√°metro TUN_EC.STATUS_C (P√°gina 6309)
Par√°metro TUN_EC.STATUS_D (P√°gina 6310)

6294

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Funcionamiento de TUN_EC
Para controlar u optimizar el regulador, TUN_EC dispone de las siguientes funciones:
‚óè Modo manual
El Self-Tuner fuerza el regulador al modo manual y le transfiere sus par√°metros en manual.
‚óè Conmutaci√≥n manual/autom√°tico con especificaci√≥n predictiva de la variable manipulada
Tras una optimizaci√≥n de regulador correcta, al desactivar el modo manual el Self-Tuner
puede conmutar el regulador al modo autom√°tico aplicando una variable manipulada, de
modo que se produzca una regulaci√≥n r√°pida a la consigna. Este tipo de conmutaci√≥n es
discontinua. Tambi√©n es posible ajustar una conmutaci√≥n sin discontinuidad en el SelfTuner.
‚óè Optimizaci√≥n del regulador
Para optimizar los par√°metros del regulador, primero es necesario identificar el proceso. A
partir de las caracter√≠sticas del proceso se dise√±a un regulador, y a partir de dicho dise√±o
se calculan los nuevos par√°metros de regulador, que se activan entonces para el regulador:
‚Äì Primer ajuste
El primer ajuste s√≥lo puede producirse con un salto de consigna positivo. Generalmente
se aplica en la primera puesta en marcha o en caso de un cambio severo del
comportamiento del proceso.
‚Äì Optimizaci√≥n fina
Si cambia el punto de operaci√≥n o el comportamiento del proceso, el regulador puede
optimizarse finamente online durante un salto positivo de la consigna.
‚Äì Optimizaci√≥n de refrigeraci√≥n
Para regulaciones que operan con dos actuadores de acci√≥n contrapuesta (p. ej.
regulaci√≥n de temperatura: actuador de calentamiento y de refrigeraci√≥n), en un salto
negativo de la variable manipulada el Self-Tuner determina la relaci√≥n de las ganancias
del proceso bajo la influencia del segundo actuador (para seguir en el ejemplo de la
regulaci√≥n de temperatura: bajo la influencia del actuador de refrigeraci√≥n).
Optimizaci√≥n de la respuesta de regulaci√≥n
El regulador est√° dise√±ado b√°sicamente para una respuesta √≥ptima ante perturbaciones.
Los "rigurosos" par√°metros resultantes provocar√≠an rebases transitorios de entre el 10 % y
el 20 % en la intensidad de los saltos de la consigna.
Una primera soluci√≥n se basa en la zona de regulaci√≥n. Para optimizar el comportamiento
de excitaci√≥n con saltos elevados de la consigna, en la optimizaci√≥n el Self-Tuner calcula
un ancho de zona de regulaci√≥n. El regulador est√° activo dentro de la zona. Fuera de la
zona, el Self-Tuner controla el regulador con la magnitud manipulada m√°xima o m√≠nima del
regulador.
Otra soluci√≥n se basa en la descomposici√≥n estructural. Las acciones P o D se incluyen en
el lazo de realimentaci√≥n. De ese modo, el cambio de la consigna s√≥lo afecta a la acci√≥n I
del regulador.
Si no fuese posible una descomposici√≥n estructural para el regulador, o si la zona de
regulaci√≥n falla, para optimizar el comportamiento de regulaci√≥n puede activarse la
siguiente funci√≥n:
‚óè Conmutaci√≥n entre estructuras:
Desconexi√≥n transitoria de la acci√≥n I o especificaci√≥n predictiva de la variable manipulada
con grandes saltos positivos de la consigna. Esta funci√≥n no es efectiva con zona de
regulaci√≥n activada.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6295

Instrucciones
4.2 Instrucciones
‚óè Guardar los par√°metros de regulador
Si los par√°metros actuales del regulador se consideran apropiados, pueden guardarse
antes de modificarse manualmente en par√°metros propios previstos para tal fin en el DB de
instancia del Self-Tuner. En una optimizaci√≥n del regulador, los par√°metros guardados se
sobrescriben con los valores v√°lidos antes de la optimizaci√≥n.
‚óè Recargar los par√°metros guardados del regulador
Esta funci√≥n permite volver a activar los √∫ltimos par√°metros guardados del regulador.
‚óè Modificar los par√°metros del regulador
Para ajustar manualmente los par√°metros del regulador, √©stos se pueden especificar en el
DB de instancia del Self-Tuner mediante par√°metros especiales y transferirse al regulador
con esta funci√≥n.

Activaci√≥n de las funciones
Funci√≥n

Bit de inicio

Modo manual

‚Äî

Conmutaci√≥n manual/ ‚Äî
autom√°tico con especi‚Äê
ficaci√≥n predictiva de
la variable manipulada

Bit de habilitaci√≥n

Condici√≥n de inicio:

Condici√≥n de inicio:

PHASE

Salto de consigna en
SP

MAN_ON

0a7

‚Äî

PRED_ON

Transici√≥n 7 -> 4

‚Äî

Primer ajuste

ADAPT1ST

‚Äî

0, 4

pos.: > MIN_STEP

Primer ajuste u optimi‚Äê
zaci√≥n fina

ADAPT_ON

‚Äî

4

pos.: > MIN_STEP

Optimizaci√≥n de refri‚Äê
geraci√≥n

COOLID_ON

‚Äî

4

‚Äî

Zona de regulaci√≥n

‚Äî

CONZ_ON

4

Conmutaci√≥n entre es‚Äê ‚Äî
tructuras

STRUC_ON

4

Guardar par√°metros
del regulador

SAVE_PAR

‚Äî

2a7

‚Äî

Recargar los par√°me‚Äê
tros del regulador

UNDO_PAR

‚Äî

4

‚Äî

Cambiar los par√°me‚Äê
tros del regulador

LOAD_PAR

‚Äî

4

‚Äî

pos.: > MIN_STEP,
neg.: > MIN_STEP √ó
RATIO_FAC

Nota
Los bits de inicio se desactivan una vez que la funci√≥n se ha iniciado correctamente y los de
habilitaci√≥n permanecen activados.

Consulte tambi√©n
Descripci√≥n de TUN_EC (P√°gina 6291)
Par√°metros de entrada de TUN_EC (P√°gina 6300)

6296

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metros de salida de TUN_EC (P√°gina 6302)
Par√°metros de entrada/salida de TUN_EC (P√°gina 6304)
Par√°metro TUN_EC.PHASE (P√°gina 6306)
Par√°metro TUN_EC.STATUS_H (P√°gina 6308)
Par√°metro TUN_EC.STATUS_C (P√°gina 6309)
Par√°metro TUN_EC.STATUS_D (P√°gina 6310)

Zona de regulaci√≥n y conmutaci√≥n entre estructuras
Zona de regulaci√≥n
El Self-Tuner trabaja con una zona de regulaci√≥n. Esto significa que el regulador se controla
seg√∫n el siguiente algoritmo:
‚óè Si el error de regulaci√≥n es mayor que CON_ZONE, se efect√∫a el calentamiento a m√°xima
potencia.
‚óè Si el error de regulaci√≥n es menor que (-CON_ZONE) √ó RATIOFAC, se efect√∫a la
refrigeraci√≥n a m√°xima potencia.
En la optimizaci√≥n inicial o fina, el Self-Tuner calcula una zona de regulaci√≥n CON_ZONE que
se activar√° coincidiendo con el tipo de proceso adecuado: CONZ_ON = TRUE. En el modo de
regulaci√≥n es posible modificar la zona de regulaci√≥n o desactivarla completamente (con
CONZ_ON = FALSE).
7HPSHUDWXUD
=RQDGHFDOHQWDPLHQWR\UHIULJHUDFL¬µQ5HIULJHUDFL¬µQFRQ/01 
VROR]RQDGHFDOHQWDPLHQWRQRFDOHQWDUFRQ/01 
63&21B=21(
=RQDGHUHJXODFL¬µQVXSHULRU
63&RQVLJQD
=RQDGHUHJXODFL¬µQLQIHULRU
63&21B=21( 5$7,2)$&
&DOHQWDUFRQ/01 
7LHPSR

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6297

Instrucciones
4.2 Instrucciones
Con la zona de regulaci√≥n activada (CONZ_ON = TRUE), la conmutaci√≥n entre estructuras
STRUC_ON carece de efecto.
Nota
Cuando se dise√±a el regulador especialmente para procesos con grandes tiempos de retardo,
no se determina ninguna zona de regulaci√≥n cuando despu√©s de la adaptaci√≥n se cumple
STATUS_D = 3.
Antes de activar a mano la zona de regulaci√≥n, aseg√∫rese de no ajustar un ancho de zona de
regulaci√≥n demasiado peque√±o. Si el ancho de la zona de regulaci√≥n ajustado fuera
insuficiente, se producir√°n oscilaciones en las curvas de la variable manipulada y el recorrido
del valor real.

Descomposici√≥n estructural
La descomposici√≥n estructural es una funci√≥n del regulador. En el modo de regulaci√≥n con
descomposici√≥n estructural, las acciones P y D se ubican en el lazo de realimentaci√≥n,
es decir, cualquier modificaci√≥n de la consigna afectar√° √∫nicamente a la acci√≥n I del regulador.
En caso de escalones de la consigna, la variable manipulada no registra un escal√≥n, sino que
discurre en forma de rampa. Esto no altera la respuesta a perturbaciones.
*$,1

$FFL¬µQ,
3URFHVR

$FFL¬µQ3
9DORUUHDO

$FFL¬µQ'

 *$,1

Figura 4-37

Modo de regulaci√≥n con descomposici√≥n estructural

En el modo de regulaci√≥n sin descomposici√≥n estructural, las acciones P y D se ubican, al igual
que la acci√≥n I, en el error de regulaci√≥n. En este modo de operaci√≥n puede seleccionarse una
conmutaci√≥n entre estructuras (STRUC_ON = TRUE).
El modo de regulaci√≥n con descomposici√≥n estructural es posible en los siguientes paquetes
de regulaci√≥n:
‚óè FM 355/455
‚óè Standard PID Control
‚óè Modular PID Control
Nota
En el regulador simple PID Control de STEP 7-base y en la CPU 314 IFM solo es posible
el modo de regulaci√≥n sin descomposici√≥n estructural. La conmutaci√≥n entre estructuras
solo debe activarse si no existen otras alternativas.

6298

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Conmutaci√≥n entre estructuras con acciones P y D en el error de regulaci√≥n
En la configuraci√≥n predeterminada, la conmutaci√≥n entre estructuras est√° desactivada. Solo
debe activarse si no existen otras alternativas, como p. ej. la zona de regulaci√≥n o la
descomposici√≥n estructural.
Con la zona de regulaci√≥n activada (CONZ_ON = TRUE), la conmutaci√≥n entre estructuras
STRUC_ON carece de efecto.
Para activar la conmutaci√≥n entre estructuras, ajuste STRUC_ON = TRUE. En funci√≥n de la
ganancia total del regulador (producto de la ganancia del proceso por la ganancia del
regulador), el bloque elige autom√°ticamente entre dos acciones de control:
‚óè Acci√≥n I desactivada temporalmente, regulaci√≥n P(D):
Con un escal√≥n de consigna positivo ‚â• MIN_STEP la acci√≥n I del regulador se desactiva
temporalmente y la ganancia se aumenta ligeramente, de modo que se utiliza un regulador
P(D) puro. Cerca de la consigna se vuelve a activar la acci√≥n I y se vuelve a reducir la
ganancia (PHASE = 5).
‚óè Especificaci√≥n predictiva temporal de la variable manipulada:
Los procesos con un tiempo de retardo elevado no son adecuados para una regulaci√≥n
P(D). Por ello, tras un escal√≥n positivo de consigna ‚â• MIN_STEP se emite de forma
constante la variable manipulada que se requiere estacionaria para la nueva consigna.
Cerca de la consigna se vuelve a cambiar sin discontinuidad al modo de regulador PI o PID.
Con ello se obtiene un comportamiento lento pero sin sobreoscilaciones transitorias
(PHASE = 6).
Nota
Si, con escalones de consigna positivos (p. ej. en fases de calentamiento), la conmutaci√≥n
entre estructuras no da buenos resultados (comportamiento transitorio muy lenta), puede
desactivarla con STRUC_ON = FALSE, teniendo en cuenta que pueden producirse
peque√±os rebases transitorios.
Modos de operaci√≥n de la estruc‚Äê
tura del regulador

CONZ_ON

PFDB_SEL,
DFDB_SEL 1)

STRUC_ON

Activar zona de regulaci√≥n

TRUE

cualquiera

cualquiera

Activar la descomposici√≥n estruc‚Äê
tural

cualquiera

TRUE

FALSE

Activar la conmutaci√≥n entre es‚Äê
tructuras

FALSE

FALSE

TRUE

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6299

Instrucciones
4.2 Instrucciones
Par√°metros de regulador PFDB_SEL, DFDB_SEL: Con CONT_C, estos par√°metros no est√°n
disponibles. Esto corresponde al ajuste PFDB_SEL = DFDB_SEL = FALSE (sin
descomposici√≥n estructural).

1)

Nota
Indicaciones para la selecci√≥n de los modos de operaci√≥n:
‚óè El Self-Tuner calcula una zona de regulaci√≥n y la activa autom√°ticamente en caso de que
la relaci√≥n de las dos constantes de tiempo del proceso sea f = TM_LAG1 / TM_LAG2 > 10.
‚óè En caso de escalones dentro de la zona de regulaci√≥n, se aplica la descomposici√≥n
estructural que se encuentra activada por defecto (a condici√≥n de que el regulador lo
permita).
‚óè Si desea corregir lo m√°s r√°pidamente posible los peque√±os escalones de consigna dentro
de la zona de regulaci√≥n y no tiene inconveniente en que se produzcan peque√±as
sobreoscilaciones transitorias, desactive la descomposici√≥n estructural.
Ejemplo de n√∫meros: Zona de regulaci√≥n 20 ¬∞C; se producen sobreoscilaciones transitorias
de aprox. 10% a 20% de la altura del escal√≥n (< 20 ¬∞C), es decir, por debajo de entre 2 y 4 ¬∞C.
‚óè Aunque el proceso no admita zonas de regulaci√≥n o estas se hayan desactivado, la
descomposici√≥n estructural impide que se produzcan sobreoscilaciones transitorias para
cualquier escal√≥n de consigna. Sin embargo, los tiempos de subida son algo m√°s largos
que en caso de existir zona de regulaci√≥n.
‚óè Si el proceso no admite zonas de regulaci√≥n y el regulador no permite la descomposici√≥n
estructural, active la conmutaci√≥n entre estructuras. La conmutaci√≥n entre estructuras no
debe estar activada al mismo tiempo que la descomposici√≥n estructural.

Par√°metros de entrada de TUN_EC
Tabla 4-281
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

SP

0.0

REAL

0.0

En la entrada SP se introduce la consigna. √âsta se interconecta con el regulador
a trav√©s de SP_OUT. Recuerde que la consigna debe estar comprendida dentro
de los l√≠mites de consigna del regulador.

PV

4.0

REAL

0.0

PV se interconecta con el valor real del regulador.

LMN

8.0

REAL

0.0

LMN se conecta con la variable manipulada del regulador.
Se admiten valores entre -100 y 100 %.

MAN

12.0

REAL

0.0

En la entrada MAN se introduce el valor manual. Si MAN_ON = TRUE, el valor
manual MAN se transmite a la variable manipulada del regulador. Con MAN_ON
= TRUE y MAN = 0.0 la calefacci√≥n/refrigeraci√≥n est√°n desconectadas. Si
MAN_ON = FALSE el regulador especifica la variable manipulada.
Se admiten valores entre -100 y 100 %.

6300

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

MIN_STEP

16.0

REAL

10.0

En la entrada MIN_STEP se puede definir la altura m√≠nima del escal√≥n para la
consigna a partir de la cual se puede realizar una primera optimizaci√≥n o adapta‚Äê
ci√≥n.
Con la conmutaci√≥n entre estructuras activada (STRUC_ON = TRUE), para que
se active es necesario que el escal√≥n de la consigna sea mayor que MIN_STEP.
Recomendaci√≥n: MIN_STEP ‚â• 10 % del rango de consigna/valor real requerido

LHLM_TUN

20.0

REAL

80.0

En la entrada LHLM_TUN se introduce el salto de la variable manipulada para el
primer ajuste. En posteriores optimizaciones finas se calcula autom√°ticamente el
escal√≥n de la variable manipulada.

LLLM_TUN

24.0

REAL

-20.0

En la entrada LLM_TUN se introduce el salto de la variable manipulada para la
optimizaci√≥n de refrigeraci√≥n.

Se admiten valores entre 0 y 100 %.

Se admiten valores entre -100 y 0 %.
NORM_FAC

28.0

REAL

1.0

En reguladores con ganancia normalizada (Standard PID Control) se aplica un
factor de normalizaci√≥n. √âste se calcula a partir de los l√≠mites de rango del valor
real del regulador y se aplica en la entrada NORM_FAC.

MAN_ON

32.0

BOOL

TRUE

Si MAN_ON = TRUE, la variable manipulada del regulador se especifica a trav√©s
de la entrada MAN. Si MAN_ON = FALSE el regulador especifica la variable ma‚Äê
nipulada.

PID_ON

32.1

BOOL

TRUE

En la entrada PID_ON se puede determinar si el regulador optimizado debe tra‚Äê
bajar como regulador PI o PID.
Regulador PID: PID_ON = TRUE
Regulador PI: PID_ON = FALSE
Puede ocurrir que en algunos tipos de proceso se dise√±e un regulador PI a pesar
de PID_ON = TRUE.

STRUC_ON

32.2

BOOL

FAL‚Äê
SE

Si STRUC_ON = TRUE, en caso de escalones de la consigna, una conmutaci√≥n
de la estructura (de regulaci√≥n PI(D) a P(D)) garantiza que se eviten ampliamente
sobreoscilaciones transitorias. La entrada STRUC_ON no debe ajustarse = TRUE
si en el regulador las acciones P y D est√°n incluidas en el lazo de realimentaci√≥n.

WRITE_DIS

32.3

BOOL

FAL‚Äê
SE

En combinaci√≥n con el FM Regulaci√≥n, el Self-Tuner debe saber si el bloque driver
est√° dispuesto a enviar datos al FM. √âse es el caso si LOAD_OP = LOAD_PAR
= FALSE. El resultado de la operaci√≥n l√≥gica O entre LOAD_OP y LOAD_PAR se
aplica en WRITE_DIS.

PRED_ON

32.4

BOOL

TRUE

Al cambiar al modo autom√°tico se puede elegir si se desea conmutar sin discon‚Äê
tinuidad desde el √∫ltimo valor manual o con discontinuidad con una variable ma‚Äê
nipulada calculada por el Self-Tuner. Si PRED_ON = TRUE (ajuste predetermi‚Äê
nado), se conmuta con discontinuidad. La conmutaci√≥n con discontinuidad no es
efectiva hasta despu√©s de la optimizaci√≥n, y hace posible, especialmente en el
caso de la regulaci√≥n PI, un transitorio m√°s r√°pido hasta la consigna deseada.

CYCLE

34.0

TIME

100 m
s

En la entrada CYCLE hay que parametrizar el tiempo de muestreo. CYCLE debe
coincidir con el tiempo de muestreo del regulador ajustado y con la diferencia de
tiempo entre dos llamadas (tiempo de ciclo del OB de alarma c√≠clica considerando
los factores de ciclo).
CYCLE > 1 ms

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6301

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Descripci√≥n de TUN_EC (P√°gina 6291)
Funcionamiento de TUN_EC (P√°gina 6295)
Par√°metros de salida de TUN_EC (P√°gina 6302)
Par√°metros de entrada/salida de TUN_EC (P√°gina 6304)
Par√°metro TUN_EC.PHASE (P√°gina 6306)
Par√°metro TUN_EC.STATUS_H (P√°gina 6308)
Par√°metro TUN_EC.STATUS_C (P√°gina 6309)
Par√°metro TUN_EC.STATUS_D (P√°gina 6310)

Par√°metros de salida de TUN_EC
Tabla 4-282
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajus‚Äê Descripci√≥n
te pre‚Äê
deter‚Äê
mina‚Äê
do

MAN_OUT

38.0

REAL

0.0

MAN_OUT se interconecta con el valor de entrada manual del regulador. Si
MAN_ON = TRUE, el Self-Tuner emite en la salida MAN_OUT el valor predeter‚Äê
minado en la entrada MAN.

SP_OUT

42.0

REAL

0.0

SP_OUT se conecta con la entrada de la consigna del regulador. El Self-Tuner
escribe la consigna especificada en la entrada SP en la salida SP_OUT. En el modo
manual MAN_ON = TRUE la consigna se corrige seg√∫n el valor real: SP_OUT = PV.

GAIN

46.0

REAL

1.5

GAIN se conecta con la ganancia proporcional del regulador (ganancia del regu‚Äê
lador).

TI

50.0

TIME

1h

TI se conecta con el tiempo integral (tiempo de acci√≥n integral) del regulador.

TD

54.0

TIME

0 ms

TD se conecta con el tiempo de acci√≥n derivada (tiempo de anticipaci√≥n) del re‚Äê
gulador.

TM_LAG

58.0

TIME

1s

TM_LAG se conecta con el tiempo de retardo del diferenciador del regulador.

RATIOFAC

62.0

REAL

1.0

RATIOFAC se conecta con el factor de proporci√≥n calentar/refrigerar del regulador
o con la instrucci√≥n PULSEGEN. El par√°metro s√≥lo se utiliza para refrigeraci√≥n.

PHASE

66.0

INT

0

Par√°metro TUN_EC.PHASE (P√°gina 6306) muestra el progreso actual de la opti‚Äê
mizaci√≥n del regulador. En la optimizaci√≥n de Standard PID Control, la salida
PHASE se conecta con la entrada PHASE de la instrucci√≥n PID_CP.

STATUS_H

68.0

INT

0

Par√°metro TUN_EC.STATUS_H (P√°gina 6308) muestra resultados de la optimi‚Äê
zaci√≥n a trav√©s de la b√∫squeda del punto de inversi√≥n en el proceso de calenta‚Äê
miento.

STATUS_D

70.0

INT

0

Par√°metro TUN_EC.STATUS_D (P√°gina 6310) muestra resultados de la optimi‚Äê
zaci√≥n a trav√©s del dise√±o del regulador en el proceso de calentamiento.

STATUS_C

72.0

INT

0

Par√°metro TUN_EC.STATUS_C (P√°gina 6309) muestra resultados de la optimi‚Äê
zaci√≥n a trav√©s de la b√∫squeda del punto de inversi√≥n en el proceso de refrigera‚Äê
ci√≥n.

QMAN_ON

74.0

BOOL

FAL‚Äê
SE

QMAN_ON se conecta con la conmutaci√≥n manual/autom√°tico del regulador.

6302

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajus‚Äê Descripci√≥n
te pre‚Äê
deter‚Äê
mina‚Äê
do

QI_SEL

74.1

BOOL

TRUE

QI_SEL se conecta con el activador/desactivador de la acci√≥n I del regulador I_SEL.
En el FM355/455 debe conmutarse en funci√≥n de QI_SEL TI a cero: Si QI_SEL
= FALSE, entonces TI = 0.

QD_SEL

74.2

BOOL

FAL‚Äê
SE

QD_SEL se conecta con el activador/desactivador de la acci√≥n D del regulador
D_SEL.
En el FM355/455 debe conmutarse en funci√≥n de QD_SEL TD a cero: Si QD_SEL
= FALSE, entonces TD = 0.

QWRITE

74.3

BOOL

FAL‚Äê
SE

QWRITE se conecta con las entradas LOAD_PAR y LOAD_OP de la instrucci√≥n
PID_FM del FM355/455.
Con ello se cargan los registros del canal regulador en el FM.

PROCESS

76.0

STRU
CT

La estructura PROCESS contiene los par√°metros del proceso.

GAIN

+0.0

REAL

999.0

En la salida PROCESS.GAIN se muestra la ganancia del proceso.

TM_LAG1

+4.0

REAL

0.0

En la salida PROCESS.TM_LAG1 se muestra la constante de tiempo del proceso
lenta.

TM_LAG2

+8.0

REAL

0.0

En la salida PROCESS.TM_LAG2 se muestra la constante de tiempo del proceso
r√°pida.

PV00

+12.
0

REAL

0.0

En la salida PROCESS.PV00 se muestra el valor de equilibrio del proceso.

KIG

+16.
0

REAL

0.0

En la salida PROCESS.KIG se muestra la relaci√≥n de rampa m√°xima del valor real
en el calentamiento.

KIG_C

+20.
0

REAL

0.0

En la salida PROCESS.KIG_C se muestra la relaci√≥n de reducci√≥n m√°xima del
valor real en la refrigeraci√≥n.

PI_CON

100.0

El valor de equilibrio es el valor real estacionario con la variable manipulada = cero.
Equivale a la temperatura ambiente con la instalaci√≥n fr√≠a.

STRU
CT

La estructura PI_CON contiene los par√°metros del regulador PI.

GAIN

+0.0

REAL

1.5

PI_CON.GAIN muestra la ganancia proporcional del regulador PI. El valor puede
optimizarse manualmente o hacerse efectivo activando LOAD_PAR.

TI

+4.0

REAL

3600.
0

PI_CON.TI muestra el tiempo integral del regulador PI. El valor puede optimizarse
manualmente o hacerse efectivo activando LOAD_PAR.

PID_CON

108.0

STRU
CT

La estructura PID_CON contiene los par√°metros del regulador PID.

GAIN

+0.0

REAL

1.5

PID_CON.GAIN muestra la ganancia proporcional del regulador PID. El valor pue‚Äê
de optimizarse manualmente o hacerse efectivo activando LOAD_PAR.

TI

+4.0

REAL

3600.
0

PID_CON.TI muestra el tiempo integral del regulador PID. El valor puede optimi‚Äê
zarse manualmente o hacerse efectivo activando LOAD_PAR.

TD

+8.0

REAL

0.0

PID_CON.TD muestra el tiempo de acci√≥n derivada del regulador PID. El valor
puede optimizarse manualmente o hacerse efectivo activando LOAD_PAR.

PI_CON_O
LD

120.0

STRU
CT

La estructura PI_CON_OLD contiene los par√°metros antiguos del regulador PI.

GAIN

+0.0

REAL

1.5

En la salida PI_CON_OLD.GAIN se muestra la ganancia proporcional antigua del
regulador PI.

TI

+4.0

REAL

3600.
0

En la salida PI_CON_OLD.TI se muestra el tiempo integral antiguo del regulador PI.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6303

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

PID_CON_
OLD

128.0

STRU
CT

Ajus‚Äê Descripci√≥n
te pre‚Äê
deter‚Äê
mina‚Äê
do
La estructura PID_CON_OLD contiene los par√°metros antiguos del regulador PID.

GAIN

+0.0

REAL

0.0

En la salida PID_CON_OLD.GAIN se muestra la ganancia proporcional antigua del
regulador PID.

TI

+4.0

REAL

0.0

En la salida PID_CON_OLD.TI se muestra el tiempo integral antiguo del regulador
PID.

TD

+8.0

REAL

0.0

En la salida PID_CON_OLD.TD se muestra el tiempo de acci√≥n derivada antiguo
del regulador PID.

TU

140.0

REAL

0.0

En la salida TU se muestra el tiempo de retardo determinado.

TA

144.0

REAL

0.0

En la salida TA se muestra el tiempo de compensaci√≥n determinado.

Consulte tambi√©n
Descripci√≥n de TUN_EC (P√°gina 6291)
Funcionamiento de TUN_EC (P√°gina 6295)
Par√°metros de entrada de TUN_EC (P√°gina 6300)
Par√°metros de entrada/salida de TUN_EC (P√°gina 6304)

Par√°metros de entrada/salida de TUN_EC
Tabla 4-283
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

ADAPT1ST

148.0

BOOL

FAL‚Äê
SE

En la primera optimizaci√≥n del proceso o si no se desea utilizar las conclusiones de
las optimizaciones anteriores, como la intensidad del salto de variable manipulada
o las constantes del tiempo del filtro, hay que realizar un primer ajuste. Para ello
hay que activar ADAPT1ST = TRUE, entonces el Self-Tuner realiza una marcha de
inicializaci√≥n y ajusta los par√°metros predeterminados descritos en la marcha de
inicializaci√≥n. El Self-Tuner vuelve a desactivar ADAPT1ST a FALSE.
No es conveniente poner ADAPT1ST en TRUE en un rearranque completo (en
caliente) de la CPU en el OB 100.

ADAPT_ON

148.1

BOOL

FAL‚Äê
SE

Para lanzar una reoptimizaci√≥n, active ADAPT_ON = TRUE. Con un salto de con‚Äê
signa posterior superior a MIN_STEP, se pone en marcha la identificaci√≥n (PHASE
= 2). El Self-Tuner vuelve a poner ADAPT_ON en FALSE.

STEADY

148.2

BOOL

FAL‚Äê
SE

Una vez que el valor real ha alcanzado un estado estacionario, la optimizaci√≥n se
puede finalizar anticipadamente con STEADY, aunque el Self-Tuner todav√≠a se
encuentre en PHASE 3.
Tambi√©n es posible volver a realizar el dise√±o del regulador en estado estacionario
con STEADY, una vez que el Self-Tuner haya pasado a PHASE 4.

6304

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

COO‚Äê
LID_ON

148.3

BOOL

FAL‚Äê
SE

Para lanzar una optimizaci√≥n de refrigeraci√≥n, ajuste COOLID_ON = TRUE. La
variable manipulada se pone a LLLM_TUN y COOLID_ON se resetea a FALSE.
Si hay varias zonas de calentamiento, primero deben haberse completado todos
los primeros ajustes o adaptaciones antes de iniciar la optimizaci√≥n de refrigera‚Äê
ci√≥n.

UNDO_PAR 148.4

BOOL

FAL‚Äê
SE

Los par√°metros de regulador antiguos se transfieren sobre los actuales y se acti‚Äê
van de inmediato en funci√≥n de PID_ON.
PI_CON = PI_CON_OLD
PID_CON = PID_CON_OLD
La funci√≥n para deshacer cambios s√≥lo es posible en el modo autom√°tico (PHASE
4).

SAVE_PAR

148.5

BOOL

FAL‚Äê
SE

Los par√°metros de regulador actuales se transfieren sobre los antiguos.
PI_CON_OLD = PI_CON
PID_CON_OLD = PID_CON

LOAD_PAR

148.6

BOOL

FAL‚Äê
SE

Los par√°metros modificados PI_CON y PID_CON se transmiten al regulador y se
activan.

CONZ_ON

148.7

BOOL

FAL‚Äê
SE

Si CONZ_ON = TRUE, el regulador trabaja con zona de regulaci√≥n.

CON_ZONE 150.0

REAL

0.0

En una optimizaci√≥n de regulador, el Self-Tuner decide si debe regularse con o sin
zona de regulaci√≥n y determina una zona de regulaci√≥n √≥ptima. Tras la optimiza‚Äê
ci√≥n en PHASE 4 la zona de regulaci√≥n se puede desactivar con CONZ_ON
= FALSE o reparametrizarse.
CON_ZONE indica la amplitud de la zona de regulaci√≥n.
En una optimizaci√≥n de regulador, el Self-Tuner decide si debe regularse con o sin
zona de regulaci√≥n y determina una zona de regulaci√≥n √≥ptima. Tras la optimiza‚Äê
ci√≥n en PHASE 4 la zona de regulaci√≥n se puede desactivar con CONZ_ON
= FALSE o reparametrizarse.

Consulte tambi√©n
Descripci√≥n de TUN_EC (P√°gina 6291)
Funcionamiento de TUN_EC (P√°gina 6295)
Par√°metros de entrada de TUN_EC (P√°gina 6300)
Par√°metros de salida de TUN_EC (P√°gina 6302)
Par√°metro TUN_EC.PHASE (P√°gina 6306)
Par√°metro TUN_EC.STATUS_H (P√°gina 6308)
Par√°metro TUN_EC.STATUS_C (P√°gina 6309)
Par√°metro TUN_EC.STATUS_D (P√°gina 6310)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6305

Instrucciones
4.2 Instrucciones

Par√°metro TUN_EC.PHASE
PHASE

Modo de operaci√≥n

Descripci√≥n

0

Modo autom√°tico:
Modo de regulaci√≥n
con par√°metros pre‚Äê
determinados

Al crear un DB de instancia para el Self-Tuner, el par√°metro PHASE tiene preasignado el
valor cero. Dado que MAN_ON tiene preasignado el estado TRUE, el Self-Tuner cambiar√°
a PHASE 7 (modo manual) tras la primera ejecuci√≥n. Desde el modo manual se puede
iniciar directamente el primer ajuste (ADAPT_ON = TRUE) o cambiar al modo autom√°tico.
En la primera conmutaci√≥n al modo autom√°tico MAN_ON = FALSE, PI_CON adopta los
par√°metros. Los valores predeterminados para GAIN y TI son: GAIN = 1.5, TI = 1h.

2

Optimizaci√≥n del re‚Äê
gulador: B√∫squeda
del punto de inver‚Äê
si√≥n con variable
manipulada cons‚Äê
tante

En cuanto se especifica un salto de consigna ‚â• MIN_STEP en sentido positivo hacia el
punto de operaci√≥n del estado caliente del proceso, en el ajuste inicial a MAN_OUT se le
preasigna LHLM_TUN y en la optimizaci√≥n fina a MAN_OUT se le preasigna el valor
calculado por el Self-Tuner. Adem√°s se activa QMAN_ON = TRUE. Ambos valores se
transmiten al regulador PID. El regulador PID se controla entonces en modo manual.
MIN_STEP deber√≠a ser superior al 10 % del rango de trabajo de consigna y real.

3

Optimizaci√≥n del re‚Äê
gulador: Regulaci√≥n
con un regulador PI
aproximativo

Si se detecta el punto de inversi√≥n de la respuesta al salto (STATUS_H = 2) o si el valor real
ha alcanzado el 70 % de la intensidad del salto de la consigna (STATUS_H = 3), se dise√±a
un regulador PI de ajuste cuidado. La ganancia del regulador GAIN se limita al rango entre
0.2 y 20.0. El regulador trabaja a partir de ese momento como regulador PI e intenta regular
el proceso a un estado estacionario. El Self-Tuner guarda los nuevos par√°metros de re‚Äê
gulador PI en GAIN, TI y PI_CON. Los valores anteriores del regulador PI se guardan en
PI_CON_OLD. Si el tiempo necesario para alcanzar el estado estacionario es muy pro‚Äê
longado (respuesta transitoria muy lenta en lazos de regulaci√≥n de temperatura), ya puede
iniciarse el dise√±o del regulador con los datos actuales al aproximarse al estado estacio‚Äê
nario activando STEADY = TRUE. Tambi√©n es posible volver a iniciar el dise√±o del regu‚Äê
lador con los datos actuales posteriormente en la fase 3 √≥ 4 activando STEADY = TRUE.
Con frecuencia, as√≠ se mejora un poco m√°s el dise√±o del regulador.
El hecho de que se produzca un rebase transitorio o de que no se encuentre un punto de
inversi√≥n, en un primer ajuste puede deberse a que se ha seleccionado una intensidad de
salto de la variable manipulada excesiva LHLM_TUN, y no tiene que derivar necesaria‚Äê
mente en un mal ajuste del regulador. En el siguiente primer ajuste LHLM_TUN debe
seleccionarse aprox. un 20 % m√°s peque√±o.
Si el bloque ha detectado el estado estacionario o si el tiempo 30 √ó TI (TI: tiempo de acci√≥n
integral del regulador PI ajustado en PHASE = 3) ha transcurrido desde el salto de la
variable manipulada, se realiza un dise√±o mejorado del regulador, y se cambia a PHASE
= 4. El Self-Tuner guarda los nuevos par√°metros de regulador PI/PID determinados en
GAIN, TI, TD y PI_CON o PID_CON. Los valores anteriores del regulador PID se guardan
en PID_CON_OLD. A ser posible se dise√±an un regulador PID y un regulador PI. Si
PID_ON = TRUE, se activa el regulador PID, de lo contrario el regulador PI. En PHASE 4
se puede cambiar en todo momento entre los dos reguladores sin discontinuidad. La
ganancia del regulador GAIN se limita de tal manera que la ganancia del lazo abierto
(producto resultante de la ganancia del regulador por la del proceso) sea inferior a 80.0.

4

Modo autom√°tico:
En esta fase el regulador regula con sus par√°metros optimizados. Desde este estado se
Funcionamiento nor‚Äê puede iniciar la optimizaci√≥n de refrigeraci√≥n, una optimizaci√≥n fina o un primer ajuste.
mal del regulador
con/sin zona de re‚Äê
gulaci√≥n

5

Modo autom√°tico:
Conmutaci√≥n entre
estructuras con sal‚Äê
to de consigna: Ac‚Äê
ci√≥n I desactivada,
regulaci√≥n P(D)

6306

Con un salto de consigna positivo ‚â• MIN_STEP la acci√≥n I del regulador se desactiva
temporalmente y la ganancia se aumenta ligeramente, de modo que se utiliza un regulador
P(D) puro. Cerca de la consigna se vuelve a activar la acci√≥n I y se vuelve a reducir la
ganancia

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
PHASE

Modo de operaci√≥n

Descripci√≥n

6

Modo autom√°tico:
Conmutaci√≥n entre
estructuras con sal‚Äê
to de consigna: Es‚Äê
pecificaci√≥n predicti‚Äê
va de la variable ma‚Äê
nipulada

Los procesos con un tiempo de retardo elevado no son adecuados para una regulaci√≥n
P(D). Por ello, tras un salto positivo de la consigna ‚â• MIN_STEP, la magnitud manipulada
necesaria estacionaria para la nueva consigna se emite de forma constante. Cerca de la
consigna se vuelve a cambiar sin discontinuidad al modo de regulador PI o PID. Con ello
se obtiene un comportamiento lento pero sin rebases transitorios.

7

Modo manual

Si la entrada MAN_ON se pone a TRUE, la salida QMAN_ON se pone a TRUE y la salida
MAN_OUT a MAN. El regulador PID cambia as√≠ al modo manual.
El modo manual tiene prioridad frente a todos los modos restantes.
Cualquier primer ajuste, optimizaci√≥n fina u optimizaci√≥n de refrigeraci√≥n se interrumpen.
Con la desactivaci√≥n del modo manual (MAN_ON = FALSE), el regulador pasa al modo
autom√°tico (PHASE = 4 en el proceso del Self-Tuner) y contin√∫a regulando con los par√°‚Äê
metros disponibles.

Fases de la optimizaci√≥n de calefacci√≥n en el primer ajuste
r&

3+$6( 
3+$6( 
67$786B+  67$786B+ 
67$786B'  67$786B' 

/+/0B781HQ
3ULPHUDMXVWH
DXWRP¬£WLFR
YDORU
DMXVWDGRHQ
2SWLPL]DFL¬µQILQD
HVWDGRHVWDFLRQDULR
HQHOSULPHUDMXVWH
HOHVWDGRGHO
SURFHVRHVSRUOR
JHQHUDOIU¬ØR
7HPSHUDWXUD
DPELHQWH

3+$6( 
67$786B+ 
67$786B' 

3+$6( 
67$786B+ 
67$786B' 

63

&DOLHQWH
(VWDGRGHOSURFHVR
3XQWRGHRSHUDFL¬µQ

39
3XQWRGH
LQYHUVL¬µQ

/01

W
$'$37B21
W

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6307

Instrucciones
4.2 Instrucciones

Fases de una optimizaci√≥n de refrigeraci√≥n
r&
3+$6( 
67$786B&


3+$6( 
67$786B&


3+$6( 
67$786B& 

HVWDFLRQDULR
(VWDGR

63
39
3XQWRGHLQYHUVL¬µQ
/01

(VWDGRGHOSURFHVR
IU¬ØR

W

///0B781


&22/,'B21
W

Consulte tambi√©n
Descripci√≥n de TUN_EC (P√°gina 6291)
Funcionamiento de TUN_EC (P√°gina 6295)
Par√°metros de entrada de TUN_EC (P√°gina 6300)
Par√°metros de entrada/salida de TUN_EC (P√°gina 6304)
Par√°metro TUN_EC.STATUS_H (P√°gina 6308)
Par√°metro TUN_EC.STATUS_C (P√°gina 6309)
Par√°metro TUN_EC.STATUS_D (P√°gina 6310)

Par√°metro TUN_EC.STATUS_H
STATUS_H

Descripci√≥n

Soluci√≥n

0

Inicializaci√≥n

1

Para acercarse m√°s a√∫n al caso ideal, aumente
En la mayor√≠a de los casos, la optimizaci√≥n suele con‚Äê LHLM_TUN o reduzca la intensidad del salto de la
consigna.
ducir a par√°metros buenos de regulador

2

Caso ideal:

Punto de inversi√≥n demasiado bajo

Punto de inversi√≥n encontrado

6308

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
STATUS_H

Descripci√≥n

3

Punto de inversi√≥n demasiado alto

11, 12

El tiempo de retardo no se ha podido registrar correc‚Äê
tamente. Se sigue trabajando con un valor estimado,
que puede provocar par√°metros no √≥ptimos del regu‚Äê
lador.

Para acercarse m√°s a√∫n al caso ideal, reduzca
Se incluye un factor de seguridad en el c√°lculo; la op‚Äê LHLM_TUN o aumente la intensidad del salto de la
timizaci√≥n suele arrojar en la mayor√≠a de los casos pa‚Äê consigna.
r√°metros v√°lidos, pero cautos.

Si el proceso presenta un comportamiento VZ1 puro
(sin tiempo de retardo), con frecuencia el Self-Tuner
consigue par√°metros de regulador buenos. Dado que
para el c√°lculo posterior se estima un tiempo de retar‚Äê
do generoso, es posible que STATUS_D no lleve a 1
(regulador para comportamiento cercano a VZ1) y que
la zona de regulaci√≥n se desactive, a pesar de que una
zona de regulaci√≥n puede ser conveniente en proce‚Äê
sos VZ1.
13

Soluci√≥n

Repita la optimizaci√≥n y aseg√∫rese de que no se
produzcan perturbaciones en el valor real.
Si no est√° satisfecho con los par√°metros del regu‚Äê
lador, como m√≠nimo puede utilizar los valores de
PROCESS.GAIN y PROCESS.TM_LAG1 para un
modelo VZ1 y un dise√±o de regulador propio seg√∫n
el libro gu√≠a.

El tiempo de retardo no se ha podido registrar correc‚Äê Repita la optimizaci√≥n y aseg√∫rese de que no se
tamente. Se sigue trabajando con un valor estimado, produzcan perturbaciones en el valor real.
que puede provocar par√°metros no √≥ptimos del regu‚Äê
lador.

Consulte tambi√©n
Descripci√≥n de TUN_EC (P√°gina 6291)
Funcionamiento de TUN_EC (P√°gina 6295)
Par√°metros de entrada de TUN_EC (P√°gina 6300)
Par√°metros de entrada/salida de TUN_EC (P√°gina 6304)
Par√°metro TUN_EC.PHASE (P√°gina 6306)
Par√°metro TUN_EC.STATUS_C (P√°gina 6309)
Par√°metro TUN_EC.STATUS_D (P√°gina 6310)

Par√°metro TUN_EC.STATUS_C
STATUS_C

Descripci√≥n

0

Inicializaci√≥n

1

Punto de inversi√≥n no encontrado
En la mayor√≠a de los casos, la optimizaci√≥n suele
conducir a par√°metros buenos de regulador.

2

Soluci√≥n
Para aproximarse m√°s a√∫n al caso ideal, aumente
LLLM_TUN
(p. ej. de -20.0 a -10.0)

Caso ideal:
Punto de inversi√≥n de refrigeraci√≥n encontrado

11, 12, 13

Repita la optimizaci√≥n y aseg√∫rese de que no se
Mala estimaci√≥n
Al factor de proporci√≥n se le asigna el valor de prea‚Äê produzcan perturbaciones en el valor real.
signaci√≥n: RATIOFAC = 1.0

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6309

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Descripci√≥n de TUN_EC (P√°gina 6291)
Funcionamiento de TUN_EC (P√°gina 6295)
Par√°metros de entrada de TUN_EC (P√°gina 6300)
Par√°metros de entrada/salida de TUN_EC (P√°gina 6304)
Par√°metro TUN_EC.PHASE (P√°gina 6306)
Par√°metro TUN_EC.STATUS_H (P√°gina 6308)
Par√°metro TUN_EC.STATUS_D (P√°gina 6310)

Par√°metro TUN_EC.STATUS_D
STATUS_D

Descripci√≥n

0

Inicializaci√≥n

1

El proceso tiene un comportamiento muy pr√≥ximo a PT1;

2

Reguladores PI y PID posibles, comportamiento VZ2

3

Dise√±o de regulador PID separado para tiempos de re‚Äê
tardo muy elevados, tiempos muertos u orden de proce‚Äê
so elevada

Soluci√≥n
Quiz√°s se pueda renunciar a la acci√≥n D del
regulador.

En este caso, la zona de regulaci√≥n se desactiva.
4

Mala estimaci√≥n
Sin dise√±o de regulador en reoptimizaci√≥n.

Repita la optimizaci√≥n y aseg√∫rese de que no
se produzcan perturbaciones en el valor real.

En el primer ajuste se contin√∫a trabajando con el regula‚Äê
dor PI aproximado de PHASE 3

Consulte tambi√©n
Descripci√≥n de TUN_EC (P√°gina 6291)
Funcionamiento de TUN_EC (P√°gina 6295)
Par√°metros de entrada de TUN_EC (P√°gina 6300)
Par√°metros de entrada/salida de TUN_EC (P√°gina 6304)
Par√°metro TUN_EC.PHASE (P√°gina 6306)
Par√°metro TUN_EC.STATUS_H (P√°gina 6308)
Par√°metro TUN_EC.STATUS_C (P√°gina 6309)

6310

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

TUN_ES
Descripci√≥n de TUN_ES
La instrucci√≥n TUN_ES permite ajustar un regulador PID paso a paso. Seg√∫n el regulador,
TUN_ES se activa con una de las siguientes instrucciones:
‚óè FM 355 S o FM 455 S
‚Äì PID_FM
‚óè Funciones b√°sicas PID
‚Äì CONT_S
‚Äì TCONT_S
‚óè Standard PID Control (paquete opcional PID Professional)
‚Äì PID_ES
‚óè Modular PID Control (paquete opcional PID Professional)
‚Äì PID
‚Äì LMNGEN_S

Llamada
TUN_ES se llama en una base de tiempo constante del tiempo de ciclo del OB invocante
(preferentemente en un OB de alarma c√≠clica).
Con ADAPT1ST = TRUE se ejecuta la rutina de inicializaci√≥n de la instrucci√≥n TUN_ES. Se
llevan a cabo los siguientes ajustes predeterminados:
‚óè Se conmuta al regulador PI. Para ello se transfieren al regulador los par√°metros de
PI_CON. Si los par√°metros PI_CON.GAIN y PI_CON.TI tienen ambos el valor 0.0, se les
asignar√°n los valores predeterminados PI_CON.GAIN = 1.5 y PI_CON.TI = 3600.0 s.
‚óè PROCESS.GAIN = 999.0
‚óè STATUS_H = 0; STATUS_D = 0
Nota
A menos que desee hacerlo expresamente, en caso de rearranque completo (en caliente)
de la CPU no llame TUN_ES como es habitual con otras instrucciones, pues de lo contrario
se perder√°n todos los par√°metros de proceso.
Si se efect√∫a una llamada de la instrucci√≥n TUN_ES como DB multiinstancia, no se crea ning√∫n
objeto tecnol√≥gico. No existe interfaz de puesta en servicio. TUN_EC debe ponerse en servicio
mediante una tabla de observaci√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6311

Instrucciones
4.2 Instrucciones

Tiempo de muestreo CYCLE
El tiempo de muestreo se indica en el par√°metro CYCLE. El tiempo de muestreo no debe ser
superior al 10% del tiempo de integraci√≥n calculado del regulador. Adem√°s, para obtener una
resoluci√≥n de la realimentaci√≥n de posici√≥n de al menos 1%, el tiempo de muestreo no debe
ser superior al 1% del tiempo de posicionamiento del motor. El tiempo de muestreo puede
ajustarse en el par√°metro CYCLE de la instrucci√≥n TUN_ES y del regulador. Debe coincidir con
la diferencia de tiempo entre dos llamadas (tiempo de ciclo del OB de alarma c√≠clica
considerando los factores de ciclo).
Si se usan los m√≥dulos de regulaci√≥n FM355/455, el tiempo de muestreo de TUN_ES debe ser
aproximadamente igual al tiempo de ciclo resultante de los reguladores en el FM (Ajuste de
par√°metros > Par√°metros del m√≥dulo).

Comportamiento en caso de error
El bloque no eval√∫a la palabra de notificaci√≥n de error RET_VAL

Consulte tambi√©n
Funcionamiento TUN_ES (P√°gina 6314)
Par√°metros de entrada de TUN_ES (P√°gina 6319)
Par√°metros de salida de TUN_ES (P√°gina 6321)
Par√°metros de entrada/salida de TUN_ES (P√°gina 6323)
Par√°metro TUN_ES.PHASE (P√°gina 6324)
Par√°metro TUN_ES.STATUS_H (P√°gina 6327)
Par√°metro TUN_ES.STATUS_D (P√°gina 6328)

Campo de aplicaci√≥n de TUN_ES
El Self-Tuner resulta especialmente conveniente para
‚óè Regulaciones de temperatura, pero tambi√©n para
‚óè Regulaciones de nivel de llenado y
‚óè Regulaciones de caudal
Dentro de las regulaciones de caudal se distingue si debe regularse la servov√°lvula o si tras
√©sta se inicia un proceso sujeto a retardo. Si se trata de una regulaci√≥n puramente de la
servov√°lvula, es Self-Tuner no puede utilizarse.

6312

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Requisitos del proceso
El proceso debe cumplir las siguientes condiciones:
‚óè Comportamiento transitorio asint√≥tico, estable y sujeto a retardo
Despu√©s de un escal√≥n de la magnitud manipulada, el valor real debe pasar a un estado
estacionario. Con ello se excluyen procesos que presentan un comportamiento oscilante
incluso sin regulaci√≥n, as√≠ como procesos regulados sin compensaci√≥n (integrador en el
proceso regulado).
‚óè Tiempos de retardo no demasiado amplios
El campo de utilizaci√≥n puede especificarse a partir de la relaci√≥n entre el tiempo de retardo
tu y el tiempo de compensaci√≥n ta. El tiempo de retardo puede incluir adem√°s un tiempo
muerto.
El primer ajuste o adaptaci√≥n est√° orientado preferentemente para el rango tu < 1/10 ta, que
abarca la mayor√≠a de lazos de regulaci√≥n de temperatura.
Para el rango de tiempos de retardo especialmente elevados 1/10 ta < tu < 1/3 ta suele ser
posible dise√±ar un regulador PI adecuado.
‚óè Comportamiento suficientemente lineal durante un rango de trabajo suficientemente grande
Esto significa que, tanto para la identificaci√≥n como para el modo de regulaci√≥n normal, los
efectos no lineales dentro del rango de trabajo especificado pueden ignorarse. Sin
embargo, es posible volver a identificar el proceso cambiando el punto de operaci√≥n si el
proceso de adaptaci√≥n vuelve a ejecutarse en un entorno reducido del nuevo punto de
operaci√≥n, y si durante la adaptaci√≥n no se pasa por la no linealidad.
Si se conocen determinadas no linealidades est√°ticas (p. ej. caracter√≠sticas de v√°lvulas), es
aconsejable compensarlas previamente con una l√≠nea poligonal para linealizar el
comportamiento del proceso.
‚óè Perturbaciones reducidas en procesos de temperatura
Las perturbaciones como la transmisi√≥n t√©rmica a las zonas adyacentes, o el aumento o
descenso t√©rmico por el cambio de estado de grupos constructivos no pueden afectar en
exceso a todo el lazo de regulaci√≥n de temperatura. Puede ser necesaria una adaptaci√≥n
en el punto de operaci√≥n. Por ejemplo, en la optimizaci√≥n de zonas de un extrusor puede
ser necesario calentar simult√°neamente todas las zonas.
‚óè Calidad de las se√±ales de medici√≥n
Las se√±ales de medici√≥n deben tener una calidad suficiente, es decir, que la relaci√≥n entre
la se√±al par√°sita y la se√±al √∫til sea lo suficientemente reducida.
‚óè Ganancias del proceso no demasiado grandes
Las ganancias del proceso no pueden ser demasiado elevadas. No es necesaria una
normalizaci√≥n de los valores reales. Por lo tanto, la ganancia del proceso K se ve afectada
por unidades f√≠sicas, p. ej.:
K =‚àÜPV/‚àÜLMN, [K]= ¬∞C/ %
El dise√±o definitivo del regulador se basa en un c√°lculo de la ganancia del proceso K, y en
principio puede compensar cualquier valor de K. Pero en la fase de aprendizaje K todav√≠a
no se conoce, y en combinaciones extremas de ganancia e intensidades de escal√≥n no es
posible evitar sobreoscilaciones transitorias. Reduciendo el par√°metro LHLM_TUN en el
proceso de calentamiento o aumentando LLLM_TUN en el de refrigeraci√≥n tambi√©n se
reduce el rebase transitorio.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6313

Instrucciones
4.2 Instrucciones

Requisitos de procesos con servov√°lvulas de acci√≥n integral
En procesos con servov√°lvulas de acci√≥n integral existen otros requisitos adicionales a los
anteriores:
El tiempo de funcionamiento del motor de la servov√°lvula debe ser menor al necesario para
encontrar un punto de inversi√≥n tras un escal√≥n de la variable manipulada (v√©ase la figura
Comportamiento del proceso). Cuando no es as√≠, normalmente se trata de una regulaci√≥n de
caudal en la que s√≥lo act√∫a la servov√°lvula como acci√≥n dominante del proceso. En ese caso
no se recomienda el uso del Self-Tuner. El regulador PI paso a paso se puede regular
manualmente siguiendo la siguiente regla general:
GAIN = 1, TI = tiempo de posicionamiento del motor

Consulte tambi√©n
Funcionamiento TUN_ES (P√°gina 6314)
Par√°metros de entrada de TUN_ES (P√°gina 6319)
Par√°metros de salida de TUN_ES (P√°gina 6321)
Par√°metros de entrada/salida de TUN_ES (P√°gina 6323)
Par√°metro TUN_ES.PHASE (P√°gina 6324)
Par√°metro TUN_ES.STATUS_H (P√°gina 6327)
Par√°metro TUN_ES.STATUS_D (P√°gina 6328)

Funcionamiento TUN_ES
Para controlar u optimizar el regulador, TUN_ES dispone de las siguientes funciones:
‚óè Modo manual
El Self-Tuner fuerza el regulador al modo manual y le transfiere sus par√°metros en manual.
En los reguladores paso a paso con realimentaci√≥n de posici√≥n se puede predeterminar el
valor manual en formato de coma flotante, as√≠ como se√±ales de valor en manual como abrir/
cerrar. En los reguladores paso a paso sin realimentaci√≥n de posici√≥n s√≥lo se pueden
predeterminar las se√±ales de valor en manual.
‚óè Optimizaci√≥n del regulador
Para optimizar los par√°metros del regulador, primero es necesario medir el tiempo de
actuaci√≥n del actuador, y a continuaci√≥n identificar el proceso. Partiendo de las
caracter√≠sticas del proceso se dise√±a un regulador, y a partir de dicho dise√±o se calculan los
nuevos par√°metros de regulador, que se activan entonces para el regulador:
‚Äì Primer ajuste
El primer ajuste s√≥lo puede producirse con un salto de consigna positivo. Generalmente
se aplica en la primera puesta en marcha o en caso de un cambio severo del
comportamiento del proceso.
‚Äì Optimizaci√≥n fina
Si cambia el punto de operaci√≥n o el comportamiento del proceso, el regulador puede
reoptimizarse online durante un salto positivo de la consigna. La optimizaci√≥n s√≥lo es
posible en reguladores paso a paso con realimentaci√≥n de posici√≥n.

6314

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
‚óè Optimizaci√≥n del comportamiento de regulaci√≥n
El regulador est√° dise√±ado b√°sicamente para una respuesta √≥ptima ante perturbaciones.
Los "rigurosos" par√°metros resultantes provocar√≠an rebases transitorios de entre el 10 y el
20 % en la intensidad de los saltos de la consigna.
La primera soluci√≥n se basa en la descomposici√≥n estructural. Las acciones P o D se
incluyen en el lazo de realimentaci√≥n. De ese modo, el cambio de la consigna s√≥lo afecta
a la acci√≥n I del regulador. La descomposici√≥n estructural s√≥lo puede usarse en
reguladores paso a paso con realimentaci√≥n de posici√≥n.
Si no fuese posible una descomposici√≥n estructural para el regulador, para optimizar el
comportamiento de regulador piloto puede activarse la siguiente funci√≥n:
‚óè Conmutaci√≥n entre estructuras
Conmutaci√≥n cercana a modo de regulaci√≥n P(D) o especificaci√≥n predictiva de la variable
manipulada con grandes saltos positivos de la consigna. En reguladores paso a paso sin
realimentaci√≥n de posici√≥n, s√≥lo es posible la conmutaci√≥n cercana al modo de regulaci√≥n
P(D).
‚óè Guardar los par√°metros de regulador
Si los par√°metros actuales del regulador se consideran v√°lidos, pueden guardarse antes de
modificarse manualmente en par√°metros propios previstos para tal fin en el DB de instancia
del Self-Tuner. En una optimizaci√≥n del regulador, los par√°metros guardados se
sobrescriben con los valores v√°lidos antes de la optimizaci√≥n.
‚óè Cargar de nuevo par√°metros de regulador guardados
Esta funci√≥n permite volver a activar los √∫ltimos par√°metros guardados del regulador.
‚óè Modificar los par√°metros del regulador
Para ajustar manualmente par√°metros del regulador, se pueden especificar en el DB de
instancia del Self-Tuner a trav√©s de par√°metros especiales, y transferirlos al regulador con
esta funci√≥n.
Con TUN_ES no se puede realizar una optimizaci√≥n de refrigeraci√≥n ni un funcionamiento con
zona de regulaci√≥n.

Activaci√≥n de las funciones
Funci√≥n

Modo manual

Bit de inicio

‚Äî

Bit de habilitaci√≥n

MAN_ON

Condici√≥n de inicio:

Condici√≥n de inicio:

PHASE

Salto de consigna en
SP

0a7

‚Äî

LMNS_ON
Primer ajuste con me‚Äê ADAPT1ST
dici√≥n del tiempo de po‚Äê
sicionamiento del mo‚Äê
tor

‚Äî

0, 4

pos.: > MIN_STEP

Primer ajuste sin medi‚Äê ADAPT_ON
ci√≥n del tiempo de ac‚Äê
tuaci√≥n del actuador u
optimizaci√≥n fina (s√≥lo
es posible en un regu‚Äê
lador paso a paso sin
realimentaci√≥n de posi‚Äê
ci√≥n)

‚Äî

4

pos.: > MIN_STEP

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6315

Instrucciones
4.2 Instrucciones
Funci√≥n

Bit de inicio

Bit de habilitaci√≥n

Condici√≥n de inicio:

Condici√≥n de inicio:

PHASE

Salto de consigna en
SP

4

pos.: > MIN_STEP

Conmutaci√≥n entre es‚Äê ‚Äî
tructuras

STRUC_ON

Guardar par√°metros
del regulador

SAVE_PAR

‚Äî

2a7

‚Äî

Cargar de nuevo par√°‚Äê UNDO_PAR
metros del regulador

‚Äî

4

‚Äî

Cambiar par√°metros
de regulador

‚Äî

4

‚Äî

LOAD_PAR

neg.: > MIN_STEP

Nota
Los bits de inicio se desactivan una vez que la funci√≥n se ha iniciado correctamente y los de
habilitaci√≥n permanecen activados.

Consulte tambi√©n
Descripci√≥n de TUN_ES (P√°gina 6311)
Par√°metros de entrada de TUN_ES (P√°gina 6319)
Par√°metros de salida de TUN_ES (P√°gina 6321)
Par√°metros de entrada/salida de TUN_ES (P√°gina 6323)
Par√°metro TUN_ES.PHASE (P√°gina 6324)
Par√°metro TUN_ES.STATUS_H (P√°gina 6327)
Par√°metro TUN_ES.STATUS_D (P√°gina 6328)

Conmutaci√≥n entre estructuras
Descomposici√≥n estructural
La descomposici√≥n estructural es una funci√≥n del regulador. En el modo de regulaci√≥n con
descomposici√≥n estructural, las acciones P y D se ubican en el lazo de realimentaci√≥n,
es decir, cualquier modificaci√≥n de la consigna afectar√° √∫nicamente a la acci√≥n I del regulador.
En caso de escalones de la consigna, la variable manipulada no registra un escal√≥n, sino que
discurre en forma de rampa.
Esto no altera la respuesta a perturbaciones.

6316

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
*$,1

$FFL¬µQ,
$FFL¬µQ3

9DORUUHDO

3URFHVR

$FFL¬µQ'

 *$,1

Figura 4-38

Modo de regulaci√≥n con descomposici√≥n estructural

En el modo de regulaci√≥n sin descomposici√≥n estructural, las acciones P y D se ubican, al igual
que la acci√≥n I, en el error de regulaci√≥n. En este modo de operaci√≥n puede seleccionarse una
conmutaci√≥n entre estructuras (STRUC_ON = TRUE).
El modo de regulaci√≥n con descomposici√≥n estructural es posible en los siguientes paquetes
de regulaci√≥n:
‚óè FM355/455
‚óè Standard PID Control
‚óè Modular PID Control
Nota
‚óè Si no se dispone de realimentaci√≥n de posici√≥n de la servov√°lvula, no debe aplicarse la
descomposici√≥n estructural. Por lo tanto, deben dejarse la acci√≥n P y la acci√≥n D en el
error de regulaci√≥n.
‚óè En la regulaci√≥n con descomposici√≥n estructural, la zona muerta no tiene apenas efecto
en el error de regulaci√≥n.
‚óè Con CONT_S y TCONT_S solo es posible la regulaci√≥n sin descomposici√≥n estructural.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6317

Instrucciones
4.2 Instrucciones

Conmutaci√≥n entre estructuras con acciones P y D en el error de regulaci√≥n
En la configuraci√≥n predeterminada, la conmutaci√≥n entre estructuras est√° desactivada. De
hecho, solo debe activarse si la descomposici√≥n estructural no est√° disponible. Para activar la
conmutaci√≥n entre estructuras, ajuste STRUC_ON = TRUE. En funci√≥n de la ganancia total del
regulador (producto de la ganancia del proceso por la ganancia del regulador), el bloque elige
autom√°ticamente entre dos acciones de control:
‚óè Aumentar la acci√≥n I temporalmente, regulaci√≥n cercana a P(D):
Con un salto de consigna positivo ‚â• MIN_STEP la acci√≥n I del regulador se aumenta
significativamente de forma temporal y la ganancia se reduce ligeramente, de modo que se
utiliza un regulador muy pr√≥ximo a P(D). Cerca de la consigna se cambia de nuevo a los
valores originales de la acci√≥n I y de la ganancia (PHASE = 5).
‚óè Especificaci√≥n predictiva temporal de la variable manipulada:
Los procesos con tiempos de retardo elevados no son adecuados para una regulaci√≥n
P(D). Por ello, tras un escal√≥n positivo de consigna ‚â• MIN_STEP se emite de forma
constante la variable manipulada que se requiere estacionaria para la nueva consigna.
Cerca de la consigna se vuelve a cambiar sin discontinuidad al modo de regulador PI o PID.
Con ello se obtiene un comportamiento lento pero sin sobreoscilaciones transitorias
(PHASE = 6).
Nota
En la regulaci√≥n sin realimentaci√≥n de posici√≥n solo es posible la primera acci√≥n de control
(PHASE = 5).
Si, con escalones de consigna positivos (p. ej. en fases de calentamiento), la conmutaci√≥n
entre estructuras no da buenos resultados (comportamiento transitorio muy lenta), puede
desactivarla con STRUC_ON = FALSE, teniendo en cuenta que pueden producirse
peque√±os rebases transitorios.
Modos de operaci√≥n de la estructura del regu‚Äê PFDB_SEL,
lador
DFDB_SEL 1)

STRUC_ON

Activar la descomposici√≥n estructural

TRUE

FALSE

Activar la conmutaci√≥n entre estructuras

FALSE

TRUE

1)
Par√°metros de regulador PFDB_SEL, DFDB_SEL: Con CONT_S, estos par√°metros no est√°n
disponibles. Esto corresponde al ajuste PFDB_SEL = DFDB_SEL = FALSE (sin
descomposici√≥n estructural).

Nota
‚óè En caso de escalones de consigna, la descomposici√≥n estructural impide las
sobreoscilaciones transitorias de la variable regulada. Si es posible, active la
descomposici√≥n estructural.
‚óè Si el regulador no permite la descomposici√≥n estructural, active la conmutaci√≥n entre
estructuras. La conmutaci√≥n entre estructuras no debe estar activada al mismo tiempo que
la descomposici√≥n estructural. Si desea corregir m√°s r√°pidamente los escalones de
consigna positivos y no tiene inconveniente en que se produzcan peque√±as
sobreoscilaciones transitorias, puede desactivar la conmutaci√≥n entre estructuras.

6318

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de TUN_ES
Tabla 4-284
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
predeter‚Äê
minado

Descripci√≥n

SP

0.0

REAL

0.0

En la entrada SP se introduce la consigna. √âsta se interconecta con el regu‚Äê
lador a trav√©s de SP_OUT. Recuerde que la consigna debe estar compren‚Äê
dida dentro de los l√≠mites de consigna del regulador.

PV

4.0

REAL

0.0

PV se interconecta con el valor real del regulador.

MAN

8.0

REAL

0.0

En la entrada MAN se introduce el valor manual. Si MAN_ON = TRUE, el valor
manual MAN se transmite a la variable manipulada del regulador. Con
MAN_ON = TRUE y MAN = 0.0, la calefacci√≥n est√° desconectada. Si
MAN_ON = FALSE el regulador especifica la variable manipulada.
Se admiten valores entre -100 y 100 %.

LMNR

12.0

REAL

0.0

LMNR se conecta con la realimentaci√≥n de posici√≥n del regulador (si existe).
Se admiten valores entre 0.0 y 100 %.

MIN_STEP

16.0

REAL

10.0

En la entrada MIN_STEP se puede definir la altura m√≠nima del escal√≥n para la
consigna a partir de la cual se puede realizar una primera optimizaci√≥n o
adaptaci√≥n.
Con la conmutaci√≥n entre estructuras activada (STRUC_ON=TRUE), para
que se active es necesario que el salto de la consigna sea mayor que
MIN_STEP.
Recomendaci√≥n: MIN_STEP ‚â• 10 % del rango de consigna/valor real reque‚Äê
rido

LHLM_TUN

20.0

REAL

80.0

En la entrada LHLM_TUN se introduce el salto de la variable manipulada para
el primer ajuste. En posteriores optimizaciones finas se calcula autom√°tica‚Äê
mente el escal√≥n de la variable manipulada.
Se admiten valores entre 0.0 y 100 %.

NORM_FAC

24.0

REAL

1.0

PULSE_TM

28.0

TIME

0 ms

En reguladores con ganancia normalizada (Standard PID Control) se aplica
un factor de normalizaci√≥n. √âste se calcula a partir de los l√≠mites de rango del
valor real del regulador y se aplica en la entrada NORM_FAC.
PULSE_TM se conecta con la duraci√≥n de impulso m√≠nima del regulador.
PULSE_TM ‚â• 1 ms

C_LMNUP

32.0

BOOL

FALSE

C_LMNUP se conecta con la se√±al de la variable manipulada QLMNUP del
regulador.

C_LMNDN

32.1

BOOL

FALSE

C_LMNDN se conecta con la se√±al de variable manipulada QLMNDN del
regulador.

MAN_ON

32.2

BOOL

FALSE

Si MAN_ON = TRUE, la variable manipulada del regulador se especifica a
trav√©s de la entrada MAN. Si MAN_ON = FALSE el regulador especifica la
variable manipulada.

LMNR_HS

32.3

BOOL

FALSE

LMNR_HS se conecta con la se√±al de tope LMNR_HR del regulador.

LMNR_ON

32.4

BOOL

FALSE

Si LMNR_ON = TRUE, se puede conmutar un regulador paso a paso con
realimentaci√≥n de posici√≥n con LMNS_ON = TRUE o con MAN_ON = TRUE
al modo manual.
Si LMNR_ON = FALSE, se puede conmutar un regulador paso a paso sin
realimentaci√≥n de posici√≥n con LMNS_ON = TRUE al modo manual.

LMNS_ON

32.5

BOOL

TRUE

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Si LMNS_ON est√° activado, se pueden variar las se√±ales de salida en los
par√°metros LMNUP y LMNDN.

6319

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
predeter‚Äê
minado

Descripci√≥n

LMNUP

32.6

BOOL

FALSE

Con LMNUP se puede variar la se√±al de salida ABRIR del regulador.

LMNDN

32.7

BOOL

FALSE

Con LMNDN se puede variar la se√±al de salida CERRAR del regulador.

PID_ON

33.0

BOOL

FALSE

En la entrada PID_ON se puede determinar si el regulador optimizado debe
trabajar como regulador PI o PID:
Regulador PID: PID_ON = TRUE
Regulador PI: PID_ON = FALSE
Puede ocurrir que en algunos tipos de proceso se dise√±e un regulador PI a
pesar de PID_ON = TRUE.

STRUC_ON

33.1

BOOL

FALSE

Si STRUC_ON = TRUE, en caso de escalones de la consigna, una conmuta‚Äê
ci√≥n de la estructura (de regulaci√≥n PI(D) a P(D)) garantiza que se eviten
ampliamente sobreoscilaciones transitorias. La entrada STRUC_ON no pue‚Äê
de ponerse = TRUE si en el regulador las acciones P y D est√°n incluidas en el
lazo de realimentaci√≥n.

WRITE_DIS

33.2

BOOL

FALSE

En combinaci√≥n con el FM Regulaci√≥n, el Self-Tuner debe saber si el bloque
driver est√° dispuesto a enviar datos al FM. √âse es el caso si LOAD_OP =
LOAD_PAR = FALSE. El resultado de la operaci√≥n l√≥gica O entre LOAD_OP
y LOAD_PAR se interconecta con WRITE_DIS.

CYCLE

34.0

TIME

100 ms

En la entrada CYCLE hay que parametrizar el tiempo de muestreo. CYCLE
debe coincidir con el tiempo de muestreo del regulador ajustado y con la
diferencia de tiempo entre dos llamadas (tiempo de ciclo del OB de alarma
c√≠clica considerando los factores de ciclo).
‚â• 1 ms

Consulte tambi√©n
Descripci√≥n de TUN_ES (P√°gina 6311)
Funcionamiento TUN_ES (P√°gina 6314)
Par√°metros de salida de TUN_ES (P√°gina 6321)
Par√°metros de entrada/salida de TUN_ES (P√°gina 6323)
Par√°metro TUN_ES.PHASE (P√°gina 6324)
Par√°metro TUN_ES.STATUS_H (P√°gina 6327)
Par√°metro TUN_ES.STATUS_D (P√°gina 6328)

6320

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de salida de TUN_ES
Tabla 4-285
Par√°metro

Di‚Äê
rec‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
Descripci√≥n
prede‚Äê
termina‚Äê
do

MAN_OUT

38.0

REAL

0.0

MAN_OUT se interconecta con el valor de entrada manual del regulador. Si
MAN_ON = TRUE, el Self-Tuner emite en la salida MAN_OUT el valor predetermi‚Äê
nado en la entrada MAN.

SP_OUT

42.0

REAL

0.0

SP_OUT se conecta con la entrada de consigna del regulador. El Self-Tuner es‚Äê
cribe la consigna especificada en la entrada SP en la salida SP_OUT. En modo
manual MAN_ON = TRUE la consigna se corrige seg√∫n el valor real: SP_OUT = PV.

GAIN

46.0

REAL

1.5

GAIN se conecta con la ganancia proporcional del regulador (ganancia del regula‚Äê
dor).

TI

50.0

TIME

1h

TI se conecta con el tiempo integral (tiempo de acci√≥n integral) del regulador.

TD

54.0

TIME

0 ms

TD se conecta con el tiempo de acci√≥n derivada (tiempo de anticipaci√≥n) del regu‚Äê
lador.

TM_LAG

58.0

TIME

1s

TM_LAG se conecta con el tiempo de retardo del diferenciador del regulador.

MTR_TM

62.0

TIME

30 s

MTR_TM se conecta con el tiempo de posicionamiento del motor del regulador.

DEADB_W

66.0

REAL

0.0

DEADB_W se conecta con la amplitud de zona muerta del regulador.

PHASE

70.0

INT

0

Par√°metro TUN_ES.PHASE (P√°gina 6324) muestra el progreso actual de la opti‚Äê
mizaci√≥n del regulador. En la optimizaci√≥n de Standard PID Control, la salida PHA‚Äê
SE se conecta con la entrada PHASE de la instrucci√≥n PID_ES.

STATUS_H

72.0

INT

0

Par√°metro TUN_ES.STATUS_H (P√°gina 6327) muestra resultados de la optimiza‚Äê
ci√≥n a trav√©s de la b√∫squeda del punto de inversi√≥n en el proceso de calentamiento.

STATUS_D

74.0

INT

0

Par√°metro TUN_ES.STATUS_D (P√°gina 6328) muestra resultados de la optimiza‚Äê
ci√≥n a trav√©s del dise√±o del regulador en el proceso de calentamiento.

QMAN_ON

76.0

BOOL

FALSE

QMAN_ON se conecta con la conmutaci√≥n manual/autom√°tico del regulador.

QLMNS_ON 76.1

BOOL

QLMNS_ON se conecta con el par√°metro "Activar se√±ales en manual" del regula‚Äê
dor.

QLMNUP

76.2

BOOL

QLMNUP se conecta con el par√°metro "Se√±al manipulada en manual abrir" del
regulador.

QLMNDN

76.3

BOOL

QLMNDN se conecta con el par√°metro "Se√±al manipulada en manual cerrar" del
regulador.

QI_SEL

76.4

BOOL

TRUE

QI_SEL se conecta con el activador/desactivador de la acci√≥n I del regulador I_SEL.
En el FM355/455 es necesario conmutar TI a cero en funci√≥n de QI_SEL: Si QI_SEL
= FALSE, entonces TI = 0.

QD_SEL

76.5

BOOL

FALSE

QD_SEL se conecta con el activador/desactivador de la acci√≥n D del regulador
D_SEL.
En el FM355/455 es necesario conmutar TD a cero en funci√≥n de QD_SEL: Si
QD_SEL = FALSE, entonces TD = 0.

QWRITE

76.6

BOOL

PROCESS

78.0

STRU
CT

FALSE

QWRITE se conecta con las entradas LOAD_PAR y LOAD_OP de la instrucci√≥n
PID_FM del FM355/455.
Con ello se cargan los registros del canal regulador en el FM.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

La estructura PROCESS contiene los par√°metros del proceso.

6321

Instrucciones
4.2 Instrucciones
Par√°metro

Di‚Äê
rec‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
Descripci√≥n
prede‚Äê
termina‚Äê
do

GAIN

+0. REAL
0

999.0

En la salida PROCESS.GAIN se muestra la ganancia del proceso.

TM_LAG1

+4. REAL
0

0.0

En la salida PROCESS.TM_LAG1 se muestra la constante de tiempo del proceso
lenta.

TM_LAG2

+8. REAL
0

0.0

En la salida PROCESS.TM_LAG2 se muestra la constante de tiempo del proceso
r√°pida.

PV00

+1 REAL
2.0

0.0

KIG

+1 REAL
6.0

0.0

En la salida PROCESS.KIG se muestra la relaci√≥n de rampa m√°xima del valor real
en el calentamiento.

MTR_TM

+2 REAL
0.0

0.0

En la salida MTR_TM se muestra el tiempo de posicionamiento del motor.

PI_CON

102.
0

En la salida PROCESS. PV00 se muestra el valor de equilibrio del proceso.
El valor de equilibrio es el valor real estacionario con la variable manipulada = cero.
Equivale a la temperatura ambiente con la instalaci√≥n fr√≠a.

STRU
CT

La estructura PI_CON contiene los par√°metros del regulador PI.

GAIN

+0. REAL
0

1.5

PI_CON.GAIN muestra la ganancia proporcional del regulador PI. El valor puede
optimizarse manualmente o hacerse efectivo activando LOAD_PAR.

TI

+4. REAL
0

3600.0

PI_CON.TI muestra el tiempo integral del regulador PI. El valor puede optimizarse
manualmente o hacerse efectivo activando LOAD_PAR.

PID_CON

110.
0

STRU
CT

La estructura PID_CON contiene los par√°metros del regulador PID.

GAIN

+0. REAL
0

0.0

PID_CON.GAIN muestra la ganancia proporcional del regulador PID. El valor pue‚Äê
de optimizarse manualmente o hacerse efectivo activando LOAD_PAR.

TI

+4. REAL
0

0.0

PID_CON.TI muestra el tiempo integral del regulador PID. El valor puede optimi‚Äê
zarse manualmente o hacerse efectivo activando LOAD_PAR.

TD

+8. REAL
0

0.0

PID_CON.TD muestra el tiempo de acci√≥n derivada del regulador PID. El valor
puede optimizarse manualmente o hacerse efectivo activando LOAD_PAR.

PI_CON_OL 122.
D
0

STRU
CT

La estructura PI_CON_OLD contiene los par√°metros antiguos del regulador PI.

GAIN

+0. REAL
0

1.5

En la salida PI_CON_OLD.GAIN se muestra la ganancia proporcional antigua del
regulador PI.

TI

+4. REAL
0

3600.0

En la salida PI_CON_OLD.TI se muestra el tiempo integral antiguo del regulador PI.

PID_CON_
OLD

130.
0

STRU
CT

La estructura PID_CON_OLD contiene los par√°metros antiguos del regulador PID.

GAIN

+0. REAL
0

1.5

En la salida PID_CON_OLD.GAIN se muestra la ganancia proporcional antigua del
regulador PID.

TI

+4. REAL
0

3600.0

En la salida PID_CON_OLD.TI se muestra el tiempo integral antiguo del regulador
PID.

TD

+8. REAL
0

0.0

En la salida PID_CON_OLD.TD se muestra el tiempo de acci√≥n derivada antiguo
del regulador PID.

TU

142.
0

REAL

0.0

En la salida TU se muestra el tiempo de retardo determinado.

TA

146.
0

REAL

0.0

En la salida TA se muestra el tiempo de compensaci√≥n determinado.

6322

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Descripci√≥n de TUN_ES (P√°gina 6311)
Funcionamiento TUN_ES (P√°gina 6314)
Par√°metros de entrada de TUN_ES (P√°gina 6319)
Par√°metros de entrada/salida de TUN_ES (P√°gina 6323)

Par√°metros de entrada/salida de TUN_ES
Tabla 4-286
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

ADAPT1ST

150.0

BOOL

FAL‚Äê
SE

En la optimizaci√≥n inicial del proceso o si no se desea utilizar las conclusiones de
las optimizaciones anteriores, como la intensidad del salto la variable manipulada
o las constantes del tiempo del filtro, hay que realizar un primer ajuste. Para ello hay
que activar ADAPT1ST = TRUE; entonces el Self-Tuner realiza una marcha de
inicializaci√≥n y ajusta los par√°metros predeterminados descritos en la marcha de
inicializaci√≥n. El Self-Tuner vuelve a desactivar ADAPT1ST a FALSE.
No es conveniente poner ADAPT1ST en TRUE en un rearranque completo (en
caliente) de la CPU en el OB 100.

ADAPT_ON

150.1

BOOL

FAL‚Äê
SE

Para lanzar una reoptimizaci√≥n, active ADAPT_ON = TRUE. Con un salto de con‚Äê
signa posterior superior a MIN_STEP, se pone en marcha la identificaci√≥n (PHASE
= 2). El Self-Tuner vuelve a poner ADAPT_ON en FALSE.

STEADY

150.2

BOOL

FAL‚Äê
SE

Una vez que el valor real ha alcanzado un estado estacionario, la optimizaci√≥n se
puede finalizar anticipadamente con STEADY, aunque el Self-Tuner todav√≠a se
encuentre en PHASE 3.
Tambi√©n es posible volver a realizar el dise√±o del regulador en estado estacionario
con STEADY, una vez que el Self-Tuner haya pasado a PHASE 4.

UNDO_PAR 150.3

BOOL

FAL‚Äê
SE

Los par√°metros de regulador antiguos se transfieren sobre los actuales y se activan
de inmediato en funci√≥n de PID_ON.
PI_CON = PI_CON_OLD
PID_CON = PID_CON_OLD
La funci√≥n para deshacer cambios s√≥lo es posible en el modo autom√°tico (PHA‚Äê
SE 4).

SAVE_PAR

150.4

BOOL

FAL‚Äê
SE

Los par√°metros de regulador actuales se transfieren sobre los antiguos.
PI_CON_OLD = PI_CON
PID_CON_OLD = PID_CON

LOAD_PAR

150.5

BOOL

FAL‚Äê
SE

Los par√°metros modificados PI_CON y PID_CON se transmiten al regulador y se
activan.

Consulte tambi√©n
Descripci√≥n de TUN_ES (P√°gina 6311)
Funcionamiento TUN_ES (P√°gina 6314)
Par√°metros de entrada de TUN_ES (P√°gina 6319)
Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6323

Instrucciones
4.2 Instrucciones
Par√°metros de salida de TUN_ES (P√°gina 6321)
Par√°metro TUN_ES.PHASE (P√°gina 6324)
Par√°metro TUN_ES.STATUS_H (P√°gina 6327)
Par√°metro TUN_ES.STATUS_D (P√°gina 6328)

Par√°metro TUN_ES.PHASE

PHASE

Modo de operaci√≥n

Descripci√≥n

0

Modo autom√°tico:
Modo de regulaci√≥n
con par√°metros pre‚Äê
determinados

Al crear un DB de instancia para el Self-Tuner, el par√°metro PHASE tiene preasignado el
valor cero. Dado que LMNS_ON tiene preasignado el estado TRUE, el Self-Tuner cambia
a PHASE 7 (modo manual) tras la primera ejecuci√≥n. Desde el modo manual se puede
iniciar directamente el primer ajuste (ADAPT_ON = TRUE) o cambiar al modo autom√°ti‚Äê
co. En el primer cambio al modo autom√°tico MAN_ON = FALSE, se adoptan los par√°‚Äê
metros de PI_CON. Los valores predeterminados para GAIN y TI son: GAIN = 1.5, TI =
1h.
Salir de la fase con MAN_ON, LMNS_ON o ADAPT1ST

1

Optimizaci√≥n del re‚Äê
gulador: Desconec‚Äê
tar calefacci√≥n y es‚Äê
perar a un salto de
consigna

Una vez que la optimizaci√≥n ha comenzado con ADAPT1ST = TRUE, el Self-Tuner cierra
la servov√°lvula (variable manipulada = 0 o LMNS_ON = LMNDN = TRUE) y espera a un
salto positivo de la consigna ‚â• MIN_STEP.

2

Optimizaci√≥n del re‚Äê
gulador: Medici√≥n del
tiempo de posiciona‚Äê
miento del motor,
avance hasta una po‚Äê
sici√≥n constante de la
servov√°lvula y b√∫s‚Äê
queda de punto de in‚Äê
versi√≥n

En cuanto se predetermina un salto de consigna ‚â• MIN_STEP en sentido positivo hacia
el punto de operaci√≥n del estado del proceso caliente, en el primer ajuste a MAN_OUT se
le preasigna LHLM_TUN y en la reoptimizaci√≥n a MAN_OUT se le preasigna el valor
calculado por el Self-Tuner. MIN_STEP deber√≠a ser mayor que el 10 % del rango de
trabajo entre consigna y valor real.

6324

En la regulaci√≥n paso a paso con realimentaci√≥n de posici√≥n (LMNR_ON = TRUE)
QMAN_ON obtiene el valor TRUE. El regulador regula la v√°lvula al valor de MAN_OUT
y TUN_ES calcula el tiempo de posicionamiento del motor MTR_TM.
En la regulaci√≥n paso a paso sin realimentaci√≥n de posici√≥n, QLMNS_ON y QLMNUP se
ajustan a TRUE y la v√°lvula se mueve hasta el tope superior. Al alcanzar el tope superior
(LMNR_HS =TRUE), TUN_ES calcula el tiempo de posicionamiento del motor y lo trans‚Äê
mite al regulador. A continuaci√≥n la v√°lvula se cierra hasta el valor de MAN_OUT
(QLMNDN = TRUE).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
PHASE

Modo de operaci√≥n

Descripci√≥n

3

Optimizaci√≥n del re‚Äê
gulador: Regulaci√≥n
con un regulador PI
aproximativo

Si se detecta el punto de inversi√≥n de la respuesta al salto (STATUS_H = 2) o si el valor
real ha alcanzado el 70 % de la intensidad del salto de la consigna (STATUS_H = 3), se
dise√±a un regulador PI de ajuste cuidado. La ganancia del regulador GAIN se limita al
rango entre 0.2 y 20.0. El regulador trabaja a partir de ese momento como regulador PI
e intenta regular el proceso a un estado estacionario. El Self-Tuner guarda los nuevos
par√°metros de regulador PI en GAIN, TI y PI_CON. Los valores anteriores del regulador
PI se guardan en PI_CON_OLD. Si el tiempo necesario para alcanzar el estado estacio‚Äê
nario es muy prolongado (respuesta transitoria muy lenta en lazos de regulaci√≥n de
temperatura), ya puede iniciarse el dise√±o del regulador con los datos actuales al apro‚Äê
ximarse al estado estacionario activando STEADY = TRUE. Tambi√©n es posible volver a
iniciar el dise√±o del regulador con los datos actuales posteriormente en la fase 3 √≥ 4
activando STEADY = TRUE. Con frecuencia, as√≠ se mejora un poco m√°s el dise√±o del
regulador.
El hecho de que se produzca un rebase transitorio o de que no se encuentre un punto de
inversi√≥n, en un primer ajuste puede deberse a que se ha seleccionado una intensidad
de salto de la variable manipulada excesiva LHLM_TUN, y no tiene que derivar necesa‚Äê
riamente en un mal ajuste del regulador. En el siguiente primer ajuste LHLM_TUN debe
seleccionarse aprox. un 20 % m√°s peque√±o.
Si el bloque ha detectado el estado estacionario o si el tiempo 30 √ó TI (TI: tiempo de
acci√≥n integral del regulador PI ajustado en PHASE = 3) ha transcurrido desde el salto de
la variable manipulada, se realiza un dise√±o mejorado del regulador, y se cambia a
PHASE = 4. El Self-Tuner guarda los nuevos par√°metros de regulador PI/PID determi‚Äê
nados en GAIN, TI, TD y PI_CON o PID_CON. Los valores anteriores del regulador PID
se guardan en PID_CON_OLD. A ser posible se dise√±an un regulador PID y un regulador
PI. Si PID_ON = TRUE, se activa el regulador PID, de lo contrario el regulador PI. En
PHASE 4 se puede cambiar en todo momento entre los dos reguladores sin discontinui‚Äê
dad. En procesos complejos, la instrucci√≥n dise√±a siempre un regulador PI independien‚Äê
temente de PID_ON. La ganancia del regulador GAIN se limita de tal manera que la
ganancia del lazo abierto (producto resultante de la ganancia del regulador por la del
proceso) sea inferior a 40.0.

4

En esta fase el regulador regula con sus par√°metros optimizados. Desde este estado se
Modo autom√°tico:
Funcionamiento nor‚Äê puede iniciar una reoptimizaci√≥n o un primer ajuste.
mal del regulador
con/sin zona de regu‚Äê
laci√≥n

5

Modo autom√°tico,
conmutaci√≥n entre
estructuras con salto
de consigna: Acci√≥n I
desactivada, regula‚Äê
ci√≥n P(D)

Con un salto de consigna positivo ‚â• MIN_STEP la acci√≥n I del regulador se aumenta
significativamente de forma temporal y la ganancia se reduce ligeramente, de modo que
se utiliza un regulador muy pr√≥ximo a P(D). Cerca de la consigna se cambia de nuevo a
los valores originales de la acci√≥n I y de la ganancia (PHASE = 5 en el proceso del SelfTuner).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6325

Instrucciones
4.2 Instrucciones
PHASE

Modo de operaci√≥n

Descripci√≥n

6

Modo autom√°tico,
conmutaci√≥n entre
estructuras con salto
de consigna: Especi‚Äê
ficaci√≥n predictiva de
la variable manipula‚Äê
da

S√≥lo en un regulador paso a paso con realimentaci√≥n de posici√≥n
Los procesos con tiempos de retardo elevados no son adecuados para una regulaci√≥n
P(D). Por ello, tras un salto positivo de consigna ‚â• MIN_STEP, la magnitud manipulada
necesaria estacionaria para la nueva consigna se emite de forma constante. Cerca de la
consigna se vuelve a cambiar sin discontinuidad al modo de regulador PI o PID. Con ello
se obtiene un comportamiento lento pero sin rebases transitorios.

Modo manual

El modo manual tiene prioridad frente a todos los modos restantes.

7

Cualquier primer ajuste o reoptimizaci√≥n se interrumpe. Al desactivar el modo manual
(MAN_ON = FALSE y LMNS_ON = FALSE), el regulador pasa al modo autom√°tico
(PHASE = 4 en el proceso del Self-Tuner) y contin√∫a regulando con los par√°metros
disponibles.
Si se utiliza un regulador paso a paso con realimentaci√≥n de posici√≥n (LMNR_ON =
TRUE), se puede cambiar al modo manual con LMNS_ON = TRUE o con MAN_ON =
TRUE. Con un regulador paso a paso sin realimentaci√≥n de posici√≥n (LMNR_ON = FAL‚Äê
SE) s√≥lo se puede cambiar al modo manual con LMNS_ON = TRUE. Si la entrada
MAN_ON se pone a TRUE, la salida QMAN_ON se pone a TRUE y la salida MAN_OUT
a MAN. Si la entrada LMNS_ON se pone a TRUE, la salida QLMNUP se pone a LMNUP
y la salida QLMNDN a LMNDN.

Optimizaci√≥n de calefacci√≥n con un regulador paso a paso sin realimentaci√≥n de posici√≥n
La figura muestra las fases del primer ajuste con medici√≥n del tiempo de posicionamiento del
motor.
r&

3+$6( 
67$786B+ 
67$786B' 

3+$6( 
67$786B+ 
67$786B' 

/+/0B781HQ
3ULPHUDMXVWH
DXWRP¬£WLFR
YDORU
DMXVWDGRHQ
2SWLPL]DFL¬µQILQD

HVWDGRHVWDFLRQDULR
HQHOSULPHUDMXVWH
HOHVWDGRGHO
SURFHVRHVSRUOR
JHQHUDOIU¬ØR
7HPSHUDWXUD
DPELHQWH

3+$6( 
67$786B+ 
67$786B' 

63

39
3XQWRGH
LQYHUVL¬µQ

3+$6( 
67$786B+ 
67$786B' 

&DOLHQWH
(VWDGRGHO
SURFHVR
3XQWRGH
RSHUDFL¬µQ

/01

W
075B70

$'$37B21
W

6326

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Descripci√≥n de TUN_ES (P√°gina 6311)
Funcionamiento TUN_ES (P√°gina 6314)
Par√°metros de entrada de TUN_ES (P√°gina 6319)
Par√°metros de entrada/salida de TUN_ES (P√°gina 6323)
Par√°metro TUN_ES.STATUS_H (P√°gina 6327)
Par√°metro TUN_ES.STATUS_D (P√°gina 6328)

Par√°metro TUN_ES.STATUS_H
STATUS_H

Descripci√≥n

0

Inicializaci√≥n

1

Punto de inversi√≥n demasiado bajo

2

Caso ideal:

Soluci√≥n

Para acercarse m√°s a√∫n al caso ideal, aumente
En la mayor√≠a de los casos, la optimizaci√≥n suele con‚Äê LHLM_TUN o reduzca la intensidad del salto de la
consigna.
ducir a par√°metros buenos de regulador.
Punto de inversi√≥n encontrado

3

Para acercarse m√°s a√∫n al caso ideal, reduzca
Se incluye un factor de seguridad en el c√°lculo; la op‚Äê LHLM_TUN o aumente la intensidad del salto de la
timizaci√≥n suele arrojar en la mayor√≠a de los casos pa‚Äê consigna.
r√°metros v√°lidos, pero cautos.

11, 12

El tiempo de retardo no se ha podido registrar correc‚Äê
tamente. Se sigue trabajando con un valor estimado,
que puede provocar par√°metros no √≥ptimos del regu‚Äê
lador.

Punto de inversi√≥n demasiado alto

Si el proceso presenta un comportamiento VZ1 puro
(sin tiempo de retardo), con frecuencia el Self-Tuner
consigue buenos par√°metros de regulador. Dado que
para el c√°lculo posterior se estima un tiempo de retar‚Äê
do generoso, es posible que STATUS_D no lleve a 1
(regulador para comportamiento cercano a VZ1) y que
la zona de regulaci√≥n se desactive, a pesar de que una
zona de regulaci√≥n puede ser conveniente en proce‚Äê
sos VZ1.
13

Repita la optimizaci√≥n y aseg√∫rese de que no se pro‚Äê
duzcan perturbaciones en el valor real.
Si no est√° satisfecho con los par√°metros del regula‚Äê
dor, como m√≠nimo puede utilizar los valores de PRO‚Äê
CESS.GAIN y PROCESS.TM_LAG1 para un modelo
VZ1 y un dise√±o de regulador propio seg√∫n el libro
gu√≠a.

El tiempo de retardo no se ha podido registrar correc‚Äê Repita la optimizaci√≥n y aseg√∫rese de que no se pro‚Äê
tamente. Se sigue trabajando con un valor estimado, duzcan perturbaciones en el valor real.
que puede provocar par√°metros no √≥ptimos del regu‚Äê
lador.

Consulte tambi√©n
Descripci√≥n de TUN_ES (P√°gina 6311)
Funcionamiento TUN_ES (P√°gina 6314)
Par√°metros de entrada de TUN_ES (P√°gina 6319)
Par√°metros de entrada/salida de TUN_ES (P√°gina 6323)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6327

Instrucciones
4.2 Instrucciones
Par√°metro TUN_ES.PHASE (P√°gina 6324)
Par√°metro TUN_ES.STATUS_D (P√°gina 6328)

Par√°metro TUN_ES.STATUS_D
STATUS_D

Descripci√≥n

0

Inicializaci√≥n

1

S√≥lo dise√±o de regulador PI, ya que el proceso tiene un comportamiento cercano a PT1

2

Caso ideal:
Reguladores PI y PID posibles, comportamiento VZ2

3

S√≥lo dise√±o de regulador PI, ya que el tiempo de retardo, el tiempo muerto o la orden de proceso
son elevados

4

Mala estimaci√≥n
Sin dise√±o de regulador en reoptimizaci√≥n
En el primer ajuste se trabaja con el regulador PI aproximado de PHASE = 3.
Repita la optimizaci√≥n y aseg√∫rese de que no se produzcan perturbaciones en el valor real.

Consulte tambi√©n
Descripci√≥n de TUN_ES (P√°gina 6311)
Funcionamiento TUN_ES (P√°gina 6314)
Par√°metros de entrada de TUN_ES (P√°gina 6319)
Par√°metros de entrada/salida de TUN_ES (P√°gina 6323)
Par√°metro TUN_ES.PHASE (P√°gina 6324)
Par√°metro TUN_ES.STATUS_H (P√°gina 6327)

Standard PID Control
Datos t√©cnicos de las instrucciones
Carga de la CPU
El rendimiento de regulaci√≥n y, por tanto, la rapidez del procesamiento de lazos de regulaci√≥n
concretos dependen exclusivamente del rendimiento de la CPU utilizada. Para poder estimar
la carga de una CPU concreta debida a la instalaci√≥n de Standard PID Control, existen los
puntos de referencia siguientes:
‚óè Para un n√∫mero cualquiera de reguladores, la instrucci√≥n debe existir una sola vez en la
memoria de usuario de la CPU.
‚óè Por cada regulador se requiere un DB con unos 0,5 kB
‚óè No se requiere memoria para una pila L.

6328

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
‚óè Las alarmas no son retardadas por PID_CP o PID_ES.
‚óè Datos de referencia para tiempos de ejecuci√≥n t√≠picos (tiempos de procesamiento) de los
bloques en caso de parametrizaci√≥n conforme al ajuste predeterminado en el modo de
regulaci√≥n:
Instrucci√≥n

Condiciones

Tiempo de procesamiento
(en ms) CPU 315‚Äì2AG10

Tiempo de procesamiento
(en ms) CPU 416‚Äì2XK02

PID_CP

Condiciones t√≠picas

1,3

0,14

PID_ES

sin realimentaci√≥n de posici√≥n,
condiciones t√≠picas

1,5

0,16

Ocupaci√≥n de la memoria de trabajo
El tama√±o del √°rea necesaria en la memoria de usuario y, por tanto, el n√∫mero de lazos de
regulaci√≥n que pueden instalarse en base a la capacidad de memoria disponible pueden
consultarse en las tablas siguientes:
Instrucci√≥n

Memoria de carga re‚Äê
querida

Memoria de trabajo re‚Äê
querida

Datos locales

PID_CP

8956 bytes

7796 bytes

122 bytes

PID_ES

9104 bytes

7982 bytes

152 bytes

LP_SCHED

1064 bytes

976 bytes

20 bytes

DB de instancia o DB global

Memoria de carga requerida

Memoria de trabajo requerida

DB de PID_CP

1168 bytes

510 bytes

DB de PID_ES

1124 bytes

484 bytes

DB_LOOP
(con 5 lazos de regulaci√≥n)

184 bytes

100 bytes

DB_RMPSK
(con punto inicial y 4 nodos)

142 bytes

78 bytes

Tiempo de muestreo
El tiempo de muestreo m√≠nimo que puede ajustarse depende de la clase de rendimiento de la
CPU utilizada.
Nota
La precisi√≥n de c√°lculo limitada restringe el tiempo de muestreo realizable hacia abajo. Si el
tiempo de muestreo se va reduciendo, las constantes de los algoritmos adoptan cada vez
valores num√©ricos m√°s peque√±os. Esto puede provocar un c√°lculo err√≥neo de la magnitud
manipulada.
Recomendaci√≥n:
‚óè S7-300: tiempo de muestreo ‚â• 20 ms
‚óè S7-400: tiempo de muestreo ‚â• 5 ms

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6329

Instrucciones
4.2 Instrucciones

PID_CP
Descripci√≥n de PID_CP
Adem√°s de las funciones de las ramas de valor real y de consigna, la instrucci√≥n realiza un
regulador PID terminado con salida continua de magnitud manipulada y posibilidad de
controlar manualmente la variable manipulada. Las funciones parciales pueden activarse o
desactivarse.
La instrucci√≥n permite regular instalaciones y procesos t√©cnicos con magnitudes continuas de
entrada y salida en los sistemas de automatizaci√≥n SIMATIC S7. Se pueden regular tanto
sistemas lentos (temperaturas, niveles, etc.) como sistemas muy r√°pidos (caudales,
revoluciones, etc.).
El regulador se puede utilizar como regulador de valor fijo de manera individual o tambi√©n en
regulaciones de varios lazos como regulador en cascada, de mezcla o de relaci√≥n.

Arranque
PID_CP dispone de una rutina de inicializaci√≥n que se ejecuta cuando el par√°metro de entrada
COM_RST = TRUE est√° activado.
En el arranque, la acci√≥n I se pone al valor de inicializaci√≥n I_ITLVAL y se emite en la salida
LMN_I. Si se llama en un nivel de alarma c√≠clica, contin√∫a trabajando a partir de este valor.
Si el generador ramp soak est√° activado, los intervalos DB_NBR PI[0 ... NBR_PTS].TMV entre
los nodos se suman y se indican en la salida del tiempo total T_TM y del tiempo residual total
RT_TM. En caso de modificaciones online de PI[n].TMV o en caso de especificaci√≥n de
TM_CONT y TM_SNBR, cambian el tiempo total y el tiempo residual total de la curva de
evoluci√≥n. Ya que el c√°lculo de T_TM y RS_TM prolonga mucho el tiempo de procesamiento
de la funci√≥n RMP_SOAK si hay muchos nodos, dicho c√°lculo solo se realiza despu√©s del
rearranque o si TUPDT_ON = TRUE.
Todas las dem√°s salidas se ponen a sus valores predeterminados.

Rearranque
En caso de rearranque se parte del estado operativo que estaba activo en el momento de la
interrupci√≥n. La regulaci√≥n sigue trabajando con los valores que se calculaban en el instante
de la interrupci√≥n.

Llamada
La instrucci√≥n PID_CP debe llamarse de forma equidistante. Utilice para ello un nivel de alarma
c√≠clica (p. ej. OB35).
Si se efect√∫a una llamada de la instrucci√≥n PID_CP como DB multiinstancia, no se crea ning√∫n
objeto tecnol√≥gico. No se dispone de interfaz de parametrizaci√≥n y puesta en servicio. Los
PID_CP se deben parametrizar directamente en el DB multiinstancia y ponerse en servicio a
trav√©s de una tabla de observaci√≥n.

6330

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

C√°lculo del error de regulaci√≥n PID_CP
Las funciones siguientes son siempre efectivas y no es posible desactivarlas.
‚óè Limitaci√≥n de consigna SP_LIMIT,
‚óè Vigilancia de valores absolutos del valor real PV_ALARM,
‚óè Vigilancia de la magnitud de la velocidad de cambio del valor real ROCALARM,
‚óè Vigilancia de valores absolutos del error de regulaci√≥n ER_ALARM,
‚óè Limitaci√≥n de la se√±al de salida LMNLIMIT.
Los valores predeterminados se han seleccionado de modo que el funcionamiento sea
correcto sin adaptaci√≥n individual. Para conseguir buenos resultados de regulaci√≥n es
necesario adaptar siempre los par√°metros de estas funciones al proceso.

Acondicionamiento del valor real
El valor real se normaliza a la magnitud f√≠sica.
AUTOHOTSPOT
&53B,139B1250
393(5B21 %22/

)$/6(

39B,1

5($/

39B3(5

:25' :

10B3+,5

5($/



10B3,/5

5($/





10B39+5 5($/



10B39/5 5($/





03

5($/



*) Ajuste predeterminado al crear el objeto tecnol√≥gico.
El valor real puede filtrarse con un elemento de retardo de primer orden.
AUTOHOTSPOT

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6331

Instrucciones
4.2 Instrucciones

/$*67

/$*6721 %22/

)$/6(


03

5($/

39B70/$*

7,0(

03

RXWY



5($/



7V

El valor real puede linealizarse con la ra√≠z cuadrada. Para ello se requieren los par√°metros
siguientes:
AUTOHOTSPOT
6457
6457B21

%22/

)$/6(


03

5($/



6457B+5

5($/



6457B/5

5($/



RXWY



39)&B,1

5($/



El valor real puede acondicionarse con una funci√≥n espec√≠fica del usuario. Para ello se
requieren los par√°metros siguientes. La interconexi√≥n debe programarse en la FC de usuario.
AUTOHOTSPOT

6332

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

39)&

39)&B21

)$/6(

%22/

39)&B1%5 %/2&.B)&
39)&B,1

5($/



)&‡≤±39)&B1%5‡≤Ø

39)&B287 5($/


03

5($/



Los l√≠mites de advertencia y alarma del valor real se vigilan siempre con los par√°metros
siguientes.
AUTOHOTSPOT
39B$/$50

39

39+B$/0

5($/



5($/



39+B:51 5($/



5($/



39/B:51 5($/



39B+<6
39/B$/0

5($/

439+B$/0

%22/

)$/6(

439+B:51

%22/

)$/6(

439/B:51

%22/

)$/6(

439/B$/0

%22/

)$/6(



La velocidad de cambio del valor real se limita siempre con los par√°metros siguientes.
AUTOHOTSPOT

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6333

Instrucciones
4.2 Instrucciones

52&$/$50

39

5($/

39GW



3985/0B3

5($/



39'5/0B3

5($/



39'5/0B1

5($/



3985/0B1

5($/



43985/03 %22/

)$/6(

439'5/03 %22/

)$/6(

439'5/01 %22/

)$/6(

43985/01 %22/

)$/6(

Acondicionamiento de la consigna
La consigna interna SP_IN se aumenta o reduce con los par√°metros siguientes.
AUTOHOTSPOT

63B*(1

63*(1B21 %22/

)$/6(

6383

%22/

)$/6(

63'1

%22/

)$/6(

63B+/0

5($/



63B//0

5($/




63)&B,1

5($/



RXWY




63B,17

5($/

03

5($/





La consigna se especifica mediante un generador ramp soak con los par√°metros siguientes.
AUTOHOTSPOT

6334

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

5$03B62$.
5036.B21 %22/

)$/6(

')503B21 %22/

)$/6(

&<&B21

)$/6(

%22/


70B61%5

,17

70B&217

5($/

'%B1%5

%/2&.B'%

7V


503B+2/' %22/

)$/6(

%22/

)$/6(

783'7B21 %22/

)$/6(

&217B21
63B,17

5($/

45B6B$&7 %22/
1%5B$706 ,17



RXWY




)$/6(


56B70

7,0(



7B70

7,0(

7V

57B70

7,0(

7V

03

5($/





Para reguladores de mezcla y relaci√≥n, la consigna externa SP_EXT puede normalizarse con
los par√°metros siguientes.
AUTOHOTSPOT
63B1250
)$&

5($/



63B(;7

5($/



10B63(+5 5($/



10B63(/5

5($/



10B39+5

5($/



10B39/5

5($/



6457B+5

5($/



6457B/5

5($/



6457B21

%22/

)$/6(

RXWY

03

5($/

La consigna puede acondicionarse con una funci√≥n espec√≠fica del usuario. Para ello se
requieren los par√°metros siguientes. La interconexi√≥n debe programarse en la FC de usuario.
El valor de entrada SPFC_IN es un par√°metro impl√≠cito. Se observa en la herramienta de
configuraci√≥n a trav√©s del punto de medici√≥n MP1 (SPEXT_ON = FALSE) o MP2 (SPEXT_ON
= TRUE). El valor de salida es accesible en el punto de medici√≥n MP3. La entrada SPFC_IN
est√° aplicada a la rama de consigna cuando SPFC_ON =FALSE.
AUTOHOTSPOT

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6335

Instrucciones
4.2 Instrucciones

63)&

63)&B21

%22/

)$/6(

63)&B1%5 %/2&.B)&
63)&B,1

5($/



)&‡≤Ø63)&B1%5‡≤Ø



63)&B287

5($/

03

5($/



La velocidad de cambio de la consigna se limita con los par√°metros siguientes.
63B52&

6352&B21 %22/

)$/6(




LQY

5($/

6385/0B3

5($/



63'5/0B3

5($/



6385/0B1 5($/



63'5/0B1 5($/



RXWY

5($/

Con los par√°metros siguientes se vigila siempre un l√≠mite superior e inferior absoluto de la
consigna.

6336

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

63B/,0,7

LQY

5($/

63B+/0

5($/



63B//0

5($/



463B+/0

%22/

)$/6(

63

5($/



463B//0

%22/

)$/6(

Calcular el error de regulaci√≥n
El error de regulaci√≥n se conduce a trav√©s de una zona muerta con los par√°metros siguientes.
AUTOHOTSPOT
'($'%$1'

'($'%B21 %22/

)$/6(


LQY

5($/

'($'%B:

5($/

2879

(5

5($/







Los l√≠mites de advertencia y alarma del error de regulaci√≥n se vigilan siempre con los
par√°metros siguientes.
AUTOHOTSPOT

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6337

Instrucciones
4.2 Instrucciones
(5B$/$50

4(53B$/0
(5

5($/



(53B$/0

5($/



(53B:51

5($/



(53B+<6

5($/



(51B:51

5($/



(51B$/0

5($/



%22/

)$/6(

4(53B:51 %22/

)$/6(

4(51B:51 %22/

)$/6(

4(51B$/0 %22/

)$/6(

Algoritmo de regulaci√≥n PID_CP
Algoritmo de regulaci√≥n
AUTOHOTSPOT
Hay un total de cinco interruptores disponibles para definir una estructura de regulador
efectiva.
AUTOHOTSPOT
Estructura de regulador

Interruptor
P_SEL

I_SEL

D_SEL

PFDB_SEL

DFDB_SEL

Regulaci√≥n P

TRUE

FALSE

FALSE

FALSE

FALSE

Regulaci√≥n P (P en la rama de reali‚Äê
mentaci√≥n)

TRUE

FALSE

FALSE

TRUE

FALSE

Regulaci√≥n PI

TRUE

TRUE

FALSE

FALSE

FALSE

Regulaci√≥n PI (P en la rama de reali‚Äê
mentaci√≥n)

TRUE

TRUE

FALSE

TRUE

FALSE

Regulaci√≥n PD

TRUE

FALSE

TRUE

FALSE

FALSE

Regulaci√≥n PD (P en la rama de reali‚Äê
mentaci√≥n)

TRUE

FALSE

TRUE

FALSE

TRUE

Regulaci√≥n PID

TRUE

TRUE

TRUE

FALSE

FALSE

Regulaci√≥n PID (P/D en la rama de rea‚Äê TRUE
limentaci√≥n)

TRUE

TRUE

FALSE

TRUE

La acci√≥n P queda determinada por la ganancia proporcional GAIN y puede observarse en
LMN_P.
AUTOHOTSPOT
La acci√≥n I se calcula con los par√°metros siguientes.
AUTOHOTSPOT

6338

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

,17
,B6(/

%22/

)$/6(

,B,7/B21

%22/

)$/6(

,17B+326

%22/

)$/6(

,17B+1(*

%22/

)$/6(





LQY

5($/



7,

7,0(

7V



,B,7/9$/

5($/





/01B,

5($/



5($/



*) Ajuste predeterminado al crear el objeto tecnol√≥gico
La acci√≥n D se calcula con los par√°metros siguientes.
AUTOHOTSPOT
',)
'B6(/

%22/

)$/6(


LQY

5($/



7'

7,0(

7V

70B/$*

7,0(

7V

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019



/01B'

6339

Instrucciones
4.2 Instrucciones

Variable manipulada PID_CP
Variable manipulada continua
El algoritmo de regulaci√≥n PID genera una variable manipulada anal√≥gica que, en su caso,
complementa un generador de impulsos para generar se√±ales de salida con modulaci√≥n de
ancho de impulsos para la regulaci√≥n de dos o tres puntos con actuadores proporcionales.
63
(5

/01

39
4326B3
41(*B3

Sobre la variable manipulada puede influirse manualmente con los par√°metros siguientes.
AUTOHOTSPOT
0$1B*(1

0$1*1B21 %22/

)$/6(

/01B+/0

5($/



/01B//0

5($/



0$183

%22/

)$/6(

0$1'1

%22/

)$/6(


/01)&B,1

5($/





RXWY


0$1

5($/




03

5($/





La variable manipulada puede acondicionarse con una funci√≥n espec√≠fica del usuario. Para
ello se requieren los par√°metros siguientes. La interconexi√≥n debe programarse en la FC de
usuario.
AUTOHOTSPOT

6340

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

/01)&

/01)&B21 %22/

)$/6(

/01)&1%5 %/2&.B)&
/01)&B,1 5($/



)&‡≤Ø/01)&1%5‡≤Ø

/01)&287 5($/



RXWY



5($/

La velocidad de cambio de la variable manipulada se limita con los par√°metros siguientes.
/01B52&

/015&B21

%22/

)$/6(


LQY



5($/

/01B85/0

5($/



/01B'5/0

5($/



RXWY

5($/

Con los par√°metros siguientes se vigila siempre un l√≠mite superior e inferior absoluto de la
variable manipulada.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6341

Instrucciones
4.2 Instrucciones

/01/,0,7

LQY

5($/



/01B+/0

5($/



/01B//0

5($/



4/01B+/0

%22/

)$/6(

03

5($/



4/01B//0

%22/

)$/6(

La variable manipulada se normaliza a una magnitud f√≠sica con los par√°metros siguientes.
AUTOHOTSPOT
/01B1250

03

5($/



/01B)$&

5($/



/01B2))

5($/



/01



5($/

La variable manipulada en formato de coma flotante se convierte al formato de periferia. No se
comprueba si se produce un desbordamiento positivo o negativo ni si se alcanza el rango de
tolerancia por encima o debajo. Los tipos de m√≥dulos no se tienen en cuenta.
La tabla siguiente ofrece una visi√≥n de conjunto de los rangos y valores num√©ricos antes y
despu√©s del procesamiento.

6342

Variable manipulada LMN en %

Valor de periferia LMN_PER

118.515

32767

100.000

27648

0.003617

1

0.000

0

-0.003617

-1

-100.000

-27648

-118.519

-32768

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

&53B287

/01

5($/





/01B3(5 :25' :

La variable manipulada continua puede emitirse como tren de impulsos mediante una
modulaci√≥n de ancho de impulsos. Para ello se requieren los par√°metros siguientes:
AUTOHOTSPOT
38/6(*(1
&20B567

%22/

)$/6(

&<&/(

7,0(

7PV

6(/(&7

%<7(



38/6(B21 %22/

)$/6(

67(3B21 %22/

758(

%22/

)$/6(

67%,B21


03

5($/



7,0(

7PV

3(5B70B3 7,0(

7V

3(5B70B1 7,0(

7V

&<&/(B3

3B%B70B3

7,0(

7PV

3B%B70B1

7,0(

7PV

5$7,2)$&

5($/



4&B$&7

%22/

758(

4326B3

%22/

)$/6(

41(*B3

%22/

)$/6(

PID_CP en circuitos en cascada
Separaci√≥n de la cascada del regulador
En una cascada hay varios reguladores directamente relacionados entre s√≠. Por ello, hay que
tomar medidas para que, despu√©s de separar la estructura de la cascada, el funcionamiento
en cascada pueda retomarse sin problemas en un punto cualquiera.
Por este motivo, en las regulaciones en cascada se forma una se√±al QCAS en los reguladores
secundarios por medio de una l√≥gica O a partir de las se√±ales de estado de los interruptores
en la rama de consigna y variable manipulada. Dicha se√±al acciona en los reguladores

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6343

Instrucciones
4.2 Instrucciones
primarios un conmutador que pasa los reguladores al modo de seguimiento. La magnitud de
seguimiento es siempre la consigna del lazo secundario.
La conmutaci√≥n del modo de seguimiento al modo autom√°tico se realiza con suavidad, igual
que la conmutaci√≥n de manual a autom√°tico.
PID_CP puede emplearse como regulador piloto en los lazos de regulaci√≥n de nivel superior
y como regulador secundario en los lazos de regulaci√≥n secundarios.

5HJXODGRU

5HJXODGRU
63(;7B21
63B23B21
&$6B21
0$1*1B21
/0123B21

63
39

39

&$6B21

25

4&$6

63
39

39

Nota
La interconexi√≥n de la variable manipulada del regulador piloto LMN debe seguir siempre la
consigna externa SP_EXT del regulador secundario.

6344

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Interconexi√≥n de bloques
La figura siguiente muestra el principio de interconexi√≥n de reguladores en cascadas multilazo.
5HJXODGRU

5HJXODGRU

63(;7B21
63B23B21
&$6B21
0$1*1B21
/0123B21

&$6B21

63

5HJXODGRU

25

&$6B21

63

39

4&$6

63(;7B21
63B23B21
&$6B21
0$1*1B21
/0123B21

39

63

3,'B&3

&$6B21
&$6

4&$6

39

3,'B&3
/01

25

3,'B&3

63B(;7

/01

&$6B21
&$6

4&$6
63

63B(;7

/01
4&$6
63

Par√°metros de entrada de PID_CP
Tabla 4-287
Par√°metro

Offset

Tipo de
datos

COM_RST

0.0

BOOL

Rango

Asignaci√≥n
previa

Descripci√≥n

FALSE

Rearranque
(Se procesa la rutina de inicializaci√≥n de la instruc‚Äê
ci√≥n)

I_SEL

0.1

BOOL

TRUE

Activar la acci√≥n I

D_SEL

0.2

BOOL

FALSE

Activar la acci√≥n D

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6345

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de
datos

MAN_ON

0.3

BOOL

Rango

Asignaci√≥n
previa

Descripci√≥n

TRUE

Activar el modo manual
(Lazo de regulaci√≥n deshecho, LMN ajustado ma‚Äê
nualmente)

CAS_ON

0.4

BOOL

FALSE

Activar modo de cascada
(interconectado con QCAS del regulador subordina‚Äê
do)

SELECT

1.0

BYTE

0, 1, 2, 3

0

Si PULS_ON = TRUE:
0: PID y generador de impulsos
1: PID (llamada del bloque en OB 1)
2: Generador de impulsos (llamada del bloque en un
OB de alarma c√≠clica)
3: PID (llamada de bloque en un OB de alarma c√≠clica)

CYCLE

2.0

TIME

> 20 ms (S7‚Äì
300)

T#1s

Tiempo de muestreo
(tiempo entre dos llamadas del bloque = constante)
Es esencial asegurarse de que el par√°metro se para‚Äê
metriza con el tiempo de alarma c√≠clica del OB en el
que est√° activa la instrucci√≥n PID_CP. En caso con‚Äê
trario las funciones dependientes del tiempo no fun‚Äê
cionan correctamente. (Excepci√≥n: se utiliza un re‚Äê
ductor de tiempo, por ejemplo a trav√©s del distribuidor
de llamadas del regulador.)

CYCLE_P

6.0

TIME

T#10 ms

Tiempo de muestreo del generador de impulsos
Es esencial asegurarse de que el par√°metro se para‚Äê
metriza con el tiempo de alarma c√≠clica del OB en el
que est√° activa la instrucci√≥n PID_CP. En caso con‚Äê
trario las funciones dependientes del tiempo no fun‚Äê
cionan correctamente. (Excepci√≥n: se utiliza un re‚Äê
ductor de tiempo, por ejemplo a trav√©s del distribuidor
de llamadas del regulador.)

SP_INT

SP_EXT

PV_IN

PV_PER

10.0

14.0

18.0

22.0

REAL

REAL

REAL

Rango t√©cni‚Äê
co (magnitud
f√≠sica)

0.0

Rango t√©cni‚Äê
co (magnitud
f√≠sica)

0.0

Rango t√©cni‚Äê
co (magnitud
f√≠sica)

0.0

INT

Consigna interna
SP_INT puede modificarse con SPUP y SPDN me‚Äê
diante un HMI.
consigna externa
SP_EXT se utiliza para reguladores de mezcla, rela‚Äê
ci√≥n y cascada y puede normalizarse.
Entrada de valor real
(PV en formato de coma flotante)

W#16#0000

Valor real de periferia
(PV en formato de periferia)

GAIN

24.0

REAL

Rango com‚Äê
pleto (sin di‚Äê
mensi√≥n)

2.0

Ganancia proporcional
(= ganancia del regulador)

TI

28.0

TIME

TI ‚â• CYCLE

T#20s

Tiempo integrativo

TD

32.0

TIME

TD ‚â• CYCLE

T#10s

Tiempo derivativo

TM_LAG

36.0

TIME

TM_LAG ‚â•
CYCLE/2

T#2s

Tiempo de retardo de la acci√≥n D

6346

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de
datos

DISV

40.0

REAL

CAS

44.0

REAL

Rango

Asignaci√≥n
previa

Descripci√≥n

0.0

Perturbaci√≥n
Rango de valores admisible: -100.0 ... 100.0

Rango t√©cni‚Äê
co (magnitud
f√≠sica)

0.0

Entrada para el modo de cascada
(interconexi√≥n con SP del regulador subordinado)

SP_HLM

48.0

REAL

Rango t√©cni‚Äê
co (magnitud
f√≠sica)

100.0

Consigna del l√≠mite superior

SP_LLM

52.0

REAL

Rango t√©cni‚Äê
co (magnitud
f√≠sica)

0.0

Consigna del l√≠mite inferior

LMN_HLM

56.0

REAL

LMN_LLM ...
100.0

100.0

Variable manipulada: l√≠mite superior

LMN_LLM

60.0

REAL

-100.0 ...
LMN_HLM

0.0

Variable manipulada: l√≠mite inferior

DB_NBR

64.0

BLOCK_
DB

DB 1

N√∫mero del bloque de datos

SPFC_NB
R

66.0

BLOCK_
FC

FC 0

PVFC_NB
R

68.0

BLOCK_
FC

FC 0

LMNFCNB
R

70.0

BLOCK_
FC

FC 0

(DB con nodos de la curva)
Consigna n√∫mero de FC
(FC autodefinida en la rama de consigna)
Valor real n√∫mero de FC
(FC autodefinida en la rama del valor real)
Variable manipulada n√∫mero de FC
(FC definido por el usuario en la rama de la variable
manipulada)

Par√°metros de salida de PID_CP
Tabla 4-288
Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

LMN

72.0

REAL

0.0

Variable manipulada
(variable manipulada en formato de coma flotante)

LMN_PER

76.0

INT

W#16#0000

Variable manipulada para periferia
(LMN en el formato de la periferia)

SP

78.0

REAL

0.0

Consigna
(consigna con efectos reales)

PV

82.0

REAL

0.0

Valor real
(emisi√≥n del valor real efectivo en el modo de cascada)

QCAS

86.0

BOOL

FALSE

Se√±al para modo de cascada
(Se interconecta con CAS_ON del regulador de nivel superior)

QC_ACT

86.1

BOOL

TRUE

Indicaci√≥n de si se procesa la parte de regulaci√≥n en la siguiente
llamada del bloque (s√≥lo relevante si SELECT tiene el valor 0 √≥ 1)

QPOS_P

86.2

BOOL

FALSE

Generador de impulsos: activar impulso positivo

QNEG_P

86.3

BOOL

FALSE

Generador de impulsos: activar impulso negativo

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6347

Instrucciones
4.2 Instrucciones

Par√°metros de entrada/salida de PID_CP
Tabla 4-289
Par√°metro

Offset

Tipo de da‚Äê Asignaci√≥n pre‚Äê Descripci√≥n
tos
via

MAN

88.0

REAL

0.0

variable manipulada manual
(para especificar la variable manipulada mediante funciones de
manejo y visualizaci√≥n)

Variables est√°ticas de PID_CP
Par√°metro

Offset

Tipo de
datos

Rango

Asignaci√≥n
previa

Descripci√≥n

PVH_ALM

92.0

REAL

PVH_WRN...100.0

100.0

Valor real: l√≠mite superior de 'Alarma'

PVH_WRN

96.0

REAL

PVL_WRN...
PVH_ALM

90.0

Valor real: l√≠mite superior de 'Advertencia'

PVL_WRN

100.0

REAL

PVL_ALM...
PVH_WRN

-90.0

Valor real: l√≠mite inferior de 'Advertencia'

PVL_ALM

104.0

REAL

-100.0...PVL_WRN

-100.0

Valor real: l√≠mite inferior de 'Alarma'

SPGEN_ON

108.0

BOOL

FALSE

Activar control manual de la consigna
(Ajustar la consigna a trav√©s de interruptores
Arriba/Abajo)

SPUP

108.1

BOOL

FALSE

Consigna alta

SPDN

108.2

BOOL

FALSE

Consigna baja

RMPSK_ON 108.3

BOOL

FALSE

Activar el generador ramp soak
(La consigna se predetermina como curva)

SPEXT_ON

108.4

BOOL

FALSE

Activar consigna externa
(Para la interconexi√≥n con otros bloques de
regulador)

MANGN_O
N

108.5

BOOL

FALSE

Activar el modo manual

MANUP

108.6

BOOL

FALSE

Variable manipulada manual alta

MANDN

((LMN ajustado con interruptor)
108.7

BOOL

FALSE

Variable manipulada manual baja

DFRMP_ON 109.0

BOOL

FALSE

Preasignar la salida del generador ramp soak

CYC_ON

109.1

BOOL

FALSE

Activar repetici√≥n c√≠clica

RMP_HOLD

109.2

BOOL

FALSE

Detener generador ramp soak

CONT_ON

109.3

BOOL

FALSE

(Generador ramp soak) continuar

TUPDT_ON

109.4

BOOL

FALSE

Recalcular tiempo total

(A la salida se le preasigna SP_INT)
(La curva se repite autom√°ticamente)
(Se congela la salida del generador ramp soak)
(Se contin√∫a la curva en el siguiente nodo)
(Se recalcula el tiempo total de la curva)
SPFC_ON

6348

109.5

BOOL

FALSE

Llamar FC de consigna

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de
datos

Rango

Asignaci√≥n
previa

Descripci√≥n

SPROC_ON 109.6

BOOL

FALSE

Activar funci√≥n de rampa

PVPER_ON

109.7

BOOL

FALSE

Activar el valor real de periferia

LAG1STON

110.0

BOOL

FALSE

Activar elemento de retardo de primer orden

SQRT_ON

110.1

BOOL

FALSE

Activar funci√≥n de ra√≠z cuadrada

PVFC_ON

110.2

BOOL

FALSE

Llamar FC de valor real

DEADB_ON

110.3

BOOL

FALSE

Activar zona muerta

P_SEL

110.4

BOOL

TRUE

Activar la acci√≥n P

PFDB_SEL

110.5

BOOL

FALSE

Conectar la acci√≥n P en la rama de realimen‚Äê
taci√≥n

INT_HPOS

110.6

BOOL

FALSE

Congelar la acci√≥n I en direcci√≥n positiva

INT_HNEG

110.7

BOOL

FALSE

Congelar la acci√≥n I en direcci√≥n negativa

I_ITL_ON

111.0

BOOL

FALSE

Preasignar la acci√≥n I

DFDB_SEL

111.1

BOOL

FALSE

Aplicar la acci√≥n D en la rama de realimenta‚Äê
ci√≥n

DISV_SEL

111.2

BOOL

FALSE

Control anticipativo

LMNFC_ON

(Limitaci√≥n de la velocidad de cambio de SP)
(Interconexi√≥n con los m√≥dulos de periferia)

(Se filtran peque√±as perturbaciones y ruidos)

111.3

BOOL

FALSE

Llamar FC de variable manipulada

LMNRC_ON 111.4

BOOL

FALSE

Activar la funci√≥n de rampa de la variable ma‚Äê
nipulada

SMOO_CH
G

111.5

BOOL

TRUE

Conmutaci√≥n suave de manual a autom√°tico

PULSE_ON

111.6

BOOL

FALSE

Activar el generador de impulsos

STEP3_ON

111.7

BOOL

TRUE

Generador de impulsos: activar la regulaci√≥n
de tres puntos

ST2BI_ON

112.0

BOOL

FALSE

Generador de impulsos: Activar la regulaci√≥n
de dos puntos para el margen de correcci√≥n
bipolar

(Limitaci√≥n de la velocidad de cambio de LMN)

(Para el rango unipolar es necesario que
STEP3_ON = FALSE)
TM_SNBR

114.0

INT

‚â• 0 (sin dimensi√≥n)

0

N√∫mero del pr√≥ximo nodo para continuar

TM_CONT

116.0

TIME

Rango completo (sin
dimensi√≥n)

T#0s

Momento de continuaci√≥n

Rango completo (sin
dimensi√≥n)

1.0

FAC

120.0

REAL

(Tiempo despu√©s del nodo TM_SNBR en el
que el generador ramp soak sigue procesando
la curva)
Factor
(factor de relaci√≥n o mezcla)

NM_SPEHR

124.0

REAL

100.0

Normalizaci√≥n de la consigna: entrada del ran‚Äê
go de trabajo arriba

NM_SPELR

128.0

REAL

-100.0

Normalizaci√≥n de la consigna: entrada del ran‚Äê
go de trabajo abajo

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6349

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de
datos

Rango

Asignaci√≥n
previa

Descripci√≥n

SPFC_OUT

132.0

REAL

-100.0 ... 100.0

0.0

Consigna de la salida de FC
(Se interconecta con la salida de la FC en la
rama de consigna)

SPURLM_P

136.0

REAL

‚â• 0 [magnitud f√≠sica/s] 10.0

L√≠mite de rampa de subida de la consigna en el
rango positivo

SPDRLM_P

140.0

REAL

‚â• 0 [magnitud f√≠sica/s] 10.0

L√≠mite de rampa de bajada de la consigna en el
rango positivo

SPURLM_N

144.0

REAL

‚â• 0 [magnitud f√≠sica/s] 10.0

L√≠mite de la rampa de subida de la consigna en
el rango negativo

SPDRLM_N

148.0

REAL

‚â• 0 [magnitud f√≠sica/s] 10.0

L√≠mite de la rampa de bajada de la consigna en
el rango negativo

NM_PIHR

152.0

REAL

100.0

Normalizaci√≥n del valor real: entrada del rango
de medici√≥n arriba

NM_PILR

156.0

REAL

-100.0

Normalizaci√≥n del valor real: entrada del rango
de medici√≥n abajo

NM_PVHR

160.0

REAL

100.0

Normalizaci√≥n del valor real: salida del rango
de medici√≥n arriba

NM_PVLR

164.0

REAL

-100.0

Normalizaci√≥n del valor real: salida del rango
de medici√≥n abajo

PV_TMLAG

168.0

TIME

Rango completo

T#5s

Tiempo de retardo del valor real
(Retardo del elemento PT1 en la rama PV)

SQRT_HR

172.0

REAL

100.0

Ra√≠z cuadrada: salida del rango de trabajo arri‚Äê
ba

SQRT_LR

176.0

REAL

0.0

Ra√≠z cuadrada: salida del rango de trabajo
abajo

PVFC_OUT

180.0

REAL

0.0

Valor real de la salida de FC

-100.0 ... 100.0

(Se interconecta con la salida de la FC en la
rama del valor real)
PVURLM_P

184.0

REAL

‚â• 0 [magnitud f√≠sica/s] 10.0

L√≠mite de la rampa de subida del valor real en
el rango positivo

PVDRLM_P

188.0

REAL

‚â• 0 [magnitud f√≠sica/s] 10.0

L√≠mite de la rampa de bajada del valor real en
el rango positivo

PVURLM_N

192.0

REAL

‚â• 0 [magnitud f√≠sica/s] 10.0

L√≠mite de la rampa de subida del valor real en
el rango negativo

PVDRLM_N

196.0

REAL

‚â• 0 [magnitud f√≠sica/s] 10.0

L√≠mite de la rampa de bajada del valor real en
el rango negativo

PV_HYS

200.0

REAL

‚â•0

Hist√©resis del valor real

1.0

(Evita el "centelleo" de la vista de monitoriza‚Äê
ci√≥n)
DEADB_W

204.0

REAL

0.0 ... 100.0

1.0

Ancho de zona muerta
(= rango cero hasta el l√≠mite superior de la zo‚Äê
na muerta)
(determina el rango de la zona muerta)

ERP_ALM

208.0

REAL

0 ... 200.0

100.0

Error de regulaci√≥n: l√≠mite positivo de 'Alarma'

ERP_WRN

212.0

REAL

0 ... 200.0

90.0

Error de regulaci√≥n: l√≠mite positivo de 'Adver‚Äê
tencia'

6350

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de
datos

Rango

Asignaci√≥n
previa

Descripci√≥n

ERN_WRN

216.0

REAL

-200.0 ... 0

-90.0

Error de regulaci√≥n: l√≠mite negativo de 'Adver‚Äê
tencia'

ERN_ALM

220.0

REAL

-200.0 ... 0

-100.0

Error de regulaci√≥n: l√≠mite negativo de 'Alarma'

ER_HYS

224.0

REAL

‚â• 0 [%]

1.0

Error de regulaci√≥n de hist√©resis
(Evita el "centelleo" de la vista de monitoriza‚Äê
ci√≥n)

I_ITLVAL

228.0

REAL

-100.0 ... 100.0 [%]

0.0

Valor de inicializaci√≥n para la acci√≥n I

LMNFCOUT 232.0

REAL

-100.0 ... 100.0 [%]

0.0

Variable manipulada salida del FC
(se conecta con la salida del FC en la rama de
la variable manipulada)

LMN_URLM

236.0

REAL

‚â• 0 [%/s]

10.0

L√≠mite de subida de la variable manipulada

LMN_DRLM

240.0

REAL

‚â• 0 [%/s]

10.0

L√≠mite de bajada de la variable manipulada

LMN_FAC

244.0

REAL

Rango completo (sin
dimensi√≥n)

1.0

Factor de la variable manipulada

Rango completo (sin
dimensi√≥n)

0.0

LMN_OFF

248.0

REAL

(Factor para la adaptaci√≥n del rango de la va‚Äê
riable manipulada)
Offset de la variable manipulada
(Punto cero de la normalizaci√≥n de la variable
manipulada)

PER_TM_P

252.0

TIME

T#1s

Generador de impulsos: duraci√≥n de per√≠odo
del impulso positivo

PER_TM_N

256.0

TIME

T#1s

Generador de impulsos: duraci√≥n de per√≠odo
del impulso negativo

P_B_TM_P

260.0

TIME

T#50ms

Generador de impulsos: duraci√≥n m√≠nima del
impulso o duraci√≥n m√≠nima de pausa del im‚Äê
pulso positivo

P_B_TM_N

264.0

TIME

T#50ms

Generador de impulsos: duraci√≥n m√≠nima del
impulso o duraci√≥n m√≠nima de pausa del im‚Äê
pulso negativo

RATIOFAC

268.0

REAL

1.0

Generador de impulsos: factor de proporci√≥n
(proporci√≥n de la duraci√≥n del impulso positivo
y la duraci√≥n del impulso negativo)

PHASE

272.0

INT

0

Fase del PID Self-Tuner

QPVH_ALM

274.0

BOOL

FALSE

Valor real: el l√≠mite superior de 'Alarma' ha
reaccionado

QPVH_WR
N

274.1

BOOL

FALSE

Valor real: el l√≠mite superior de 'Advertencia' ha
reaccionado

QPVL_WRN 274.2

BOOL

FALSE

Valor real: el l√≠mite inferior de 'Advertencia' ha
reaccionado

QPVL_ALM

274.3

BOOL

FALSE

Valor real: el l√≠mite inferior de 'Alarma' ha reac‚Äê
cionado

QR_S_ACT

274.4

BOOL

FALSE

Procesando tabla de tiempo para curva

QSP_HLM

274.5

BOOL

FALSE

Consigna: el l√≠mite superior ha reaccionado

QSP_LLM

274.6

BOOL

FALSE

Consigna: el l√≠mite inferior ha reaccionado

QPVURLMP 274.7

BOOL

FALSE

Valor real: el l√≠mite de la rampa de subida en el
rango positivo ha reaccionado

0.1 ... 10.0 (sin di‚Äê
mensi√≥n)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6351

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de
datos

Rango

Asignaci√≥n
previa

Descripci√≥n

QPVDRLMP 275.0

BOOL

FALSE

Valor real: el l√≠mite de la rampa de bajada en el
rango positivo ha reaccionado

QPVURLMN 275.1

BOOL

FALSE

Valor real: el l√≠mite de la rampa de subida en el
rango negativo ha reaccionado

QPVDRLMN 275.2

BOOL

FALSE

Valor real: el l√≠mite de la rampa de bajada en el
rango negativo ha reaccionado

QERP_ALM

275.3

BOOL

FALSE

Error de regulaci√≥n: el l√≠mite positivo de 'Alar‚Äê
ma' ha reaccionado

QERP_WR
N

275.4

BOOL

FALSE

Error de regulaci√≥n: el l√≠mite positivo de 'Ad‚Äê
vertencia' ha reaccionado

QERN_WR
N

275.5

BOOL

FALSE

Error de regulaci√≥n; el l√≠mite negativo de 'Ad‚Äê
vertencia' ha reaccionado

QERN_ALM

275.6

BOOL

FALSE

Error de regulaci√≥n: el l√≠mite negativo de 'Alar‚Äê
ma' ha reaccionado

QLMN_HLM

275.7

BOOL

FALSE

Variable manipulada: el l√≠mite superior ha reac‚Äê
cionado

QLMN_LLM

276.0

BOOL

FALSE

Variable manipulada: el l√≠mite inferior ha reac‚Äê
cionado

NBR_ATMS

278.0

INT

0

N√∫mero del nodo actual del generador ramp
soak

RS_TM

280.0

TIME

T#0s

"Tiempo residual actual" de la curva hasta el
siguiente nodo

T_TM

284.0

TIME

T#0s

"Tiempo total" de la curva

RT_TM

288.0

TIME

T#0s

"Tiempo residual total" = tiempo hasta el final
de la curva

ER

292.0

REAL

0.0

Error de regulaci√≥n

LMN_P

296.0

REAL

0.0

Acci√≥n P

LMN_I

300.0

REAL

0.0

Acci√≥n I

LMN_D

304.0

REAL

0.0

Acci√≥n D

SPFC_IN

308.0

REAL

0.0

Consigna entrada de FC
(Se interconecta con la entrada de la FC auto‚Äê
definida)

PVFC_IN

312.0

REAL

0.0

Valor real entrada de FC
(Se interconecta con la entrada de la FC auto‚Äê
definida)

LMNFC_IN

316.0

REAL

0.0

Variable manipulada de la entrada de FC
(se interconecta con la entrada del FC autode‚Äê
finido)

SP_OP_ON

320.0

BOOL

FALSE

Activar control de la consigna
(El valor de SP_OP se aplica como consigna)

PV_OP_ON

320.1

BOOL

FALSE

Activar control manual del valor real
(El valor de PV_OP se aplica como consigna)

LMNOP_ON 320.2

BOOL

FALSE

Activar control manual de la variable manipu‚Äê
lada
(El valor de LMN_OP se aplica como consigna)

SP_OP

6352

322.0

REAL

0.0

Control de consigna en la puesta en marcha

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de
datos

PV_OP

326.0

LMN_OP

Rango

Asignaci√≥n
previa

Descripci√≥n

REAL

0.0

Control manual del valor real en la puesta en
marcha

330.0

REAL

0.0

Control de variable manipulada en la puesta
en marcha

MP1

334.0

REAL

0.0

Punto de medici√≥n 1: consigna interna

MP2

338.0

REAL

0.0

Punto de medici√≥n 2: consigna externa

MP3

342.0

REAL

0.0

Punto de medici√≥n 3: consigna ilimitada

MP4

346.0

REAL

0.0

Punto de medici√≥n 4: valor real del m√≥dulo de
periferia

MP5

350.0

REAL

0.0

Punto de medici√≥n 5: valor real despu√©s del
elemento de retardo de primer orden

MP6

354.0

REAL

0.0

Punto de medici√≥n 6: valor real efectivo (PV)

MP7

358.0

REAL

0.0

Punto de medici√≥n 7: variable manipulada del
algoritmo PID

MP8

362.0

REAL

0.0

Punto de medici√≥n 8: variable manipulada ma‚Äê
nual

MP9

366.0

REAL

0.0

Punto de medici√≥n 9: variable manipulada ili‚Äê
mitada

MP10

370.0

REAL

0.0

Punto de medici√≥n 10: variable manipulada li‚Äê
mitado

Diagramas de bloques de PID_CP
Diagramas del flujo de se√±ales
De forma an√°loga a la representaci√≥n de los interruptores en la herramienta de configuraci√≥n,
el punto negro en los s√≠mbolos de los interruptores significa que la se√±al de conmutaci√≥n tiene
el valor booleano adyacente (0 = FALSE o 1 = TRUE) y que el recorrido de la se√±al est√°
aplicado a este punto en cada caso. Las se√±ales de conmutaci√≥n (se√±ales binarias) est√°n
marcadas con l√≠neas discontinuas.
Esto significa que la consigna se especifica de modo absoluto mediante SP_INT; lo mismo es
v√°lido para la entrada del valor real mediante PV_IN. Como funci√≥n de regulaci√≥n se ha
ajustado un regulador PI normal con funci√≥n P en la rama de avance. El lazo de regulaci√≥n es
abierto y se influye sobre la magnitud manipulada mediante la entrada MAN en el √°rea
porcentual. Todas las dem√°s funciones son pasivas o, si no pueden desactivarse, no son
efectivas debido al ajuste predeterminado de par√°metros "marginales" en la evoluci√≥n de las
se√±ales dentro del rango de medida o del √°rea de trabajo.

S√≠mbolos e identificaciones en los diagramas de flujo de se√±ales
Las denominaciones de las magnitudes del proceso que pueden conectarse se representan
con el fondo marcado. Gracias a ellas se reconoce d√≥nde puede conectarse la estructura del
regulador con la periferia S7 o directamente con √≥rganos de medici√≥n y los actuadores del
proceso.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6353

Instrucciones
4.2 Instrucciones
Las denominaciones de par√°metros con la combinaci√≥n de letras "OP" (p. ej. SP_OP/
SP_OP_ON) hacen referencia a la posible intervenci√≥n en este punto mediante la herramienta
de configuraci√≥n de Standard PID Control. La herramienta de configuraci√≥n tiene una interfaz
propia con el FB de regulaci√≥n.
Las magnitudes intermedias en la evoluci√≥n de las se√±ales pueden observarse mediante los
puntos de medici√≥n MP1 ... MP12 marcados con c√≠rculos. Dichas magnitudes intermedias son
necesarias para sincronizar valores antes de lanzar operaciones de conmutaci√≥n "suaves" o
para inspeccionar los estados actuales de la regulaci√≥n en cuesti√≥n. Las magnitudes del punto
de medici√≥n en el registrador de curvas de la herramienta de configuraci√≥n pueden
representarse tanto est√°tica como din√°micamente.
Por motivos de claridad, los par√°metros para ajustar y dimensionar las operaciones de
procesamiento (algoritmos) est√°n indicados en los distintos bloques de funci√≥n. Remitimos al
respecto a las descripciones de la parte de referencia y a la representaci√≥n de las diferentes
funciones parciales en los apartados siguientes.

Acondicionamiento de la consigna

63)&B,1

5036.B21

63*(1B21

63B,17
63B*(1




638363'1
63B+/063B//0

503B62$.

63(;7B21



45B6B$&7
1%5B$706
56B70
7B70
57B70





03

03

63B(;7

63B1250

'%B1%5&217B21
70B61%570B&217
&<&B21503B+2/'
')503B21783'7B21

)$&

10B63(+510B63(/5
10B39+510B39/56457B21
6457B+56457B/5
63)&B21

63B23B21
6352&B21

63B23
63)&B,1






03

63)&
63)&B287



63B/,0,7

463B//0
63

63B52&
63B+/0
63B//0

&$//
)&
63)&B1%5

6354



463B+/0

6385/0B363'5/0B3
6385/0B163'5/0B1

(5
39

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Acondicionamiento del valor real
393(5B21
39B,1



39B3(5

03

03

/$*6721

6457B21

39B1250






/$*67

10B3,+5
10B3,/5
10B39+5
10B39/5

39B70/$*

6457

‡∑≠




6457B+5
6457B/5

39)&B21 39B23B21
39B23

39)&B,1
39)&B287







39)&
&$//
)&

03

39B$/$50

439+B$/0
439+B:51
439/B:51

439/B$/0
39+B$/039+B:51
39/B:5139/B$/0
39B+<6

39)&B1%5

52&$/$50
GGW

43985/03
439'5/03
43985/01

439'5/01
3985/0B339'5/0B3
3985/0B139'5/0B1

'($'%B21

39
-



63

'($'%$1'

'($'%B:

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

(5
(5B$/$50

4(53B$/0
4(53B:51
4(51B:51

4(51B$/0
(53B$/0(53B:51
(51B:51(51B$/0
(5B+<6

6355

Instrucciones
4.2 Instrucciones

Algoritmo de regulaci√≥n
',69B6(/





',69

3)'%B6(/

3B6(/
/01B3






‡∑¶



*$,1


,B6(/

,17
(5
39

7,,17B+2/'
,B,7/B21
,B,7/9$/





')'%B6(/



3,'B2879
/01B,

'B6(/
',)

7'
70B/$*

6356






/01B'

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Procesamiento de la variable manipulada anal√≥gica
0$1
03
/01B+/0
/01B//0

0$1*1B21

0$1B21

/0123B21

/01)&B21

/01B23


/01)&B,1

0$183
0$1'1

/01B+/0
/01B//0

&$6B21

&$6




03

03

/01)&287



/015&B21

/01/,0,7

&$//
)&

/01B1250

/01
&53B287

/01B+/0
/01B//0
/01B85/0
/01B'5/0

/01)&

4/01B+/0
4/01B//0




/01B52&




/01)&B,1

63)&B1%5



3,'B2879

63(;7B21
63B23B21
&$6B21
0$1*1B21
/0123B21







03

/01B)$&
/01B2))



/01B3(5

&RQYHUVL¬µQGH
IRUPDWR
38/6(*(1

25

4&$6

4326B3
41(*B3
&<&/(B36(/(&738/6(B21
67(3B2167%,B213(5B70B3
3(5B70B13B%B70B33B%B70B1
5$7,2)$&

La puerta OR genera una se√±al de habilitaci√≥n para el acoplamiento en cascada seg√∫n sea la
combinaci√≥n de los estados de conmutaci√≥n.

Bloque de datos global DB_RMPSK
Nota
Crear uno mismo un bloque de datos global
Los nodos para el generador ramp soak (RMP_SOAK) se preasignan en un bloque de datos
global. Este bloque de datos global no est√° incluido en la librer√≠a. Debe crear usted mismo este
bloque de datos global seg√∫n el esquema siguiente y adaptarlo a su aplicaci√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6357

Instrucciones
4.2 Instrucciones

Par√°metro

Tipo de da‚Äê
tos

Ajuste predeter‚Äê
minado

Descripci√≥n

NBR_PTS

INT

4

N√∫mero de nodos -1
1 - 255
Estructura de los datos de los nodos. La matriz debe ser declarada por
0...NBR_PTS.

PI

Array
[0...NBR_P
TS] of Struct

PI[0].OUTV

REAL

0.0

PI[0].TMV

TIME

T#1s

Valor temporal [0], punto inicial

PI[1].OUTV

REAL

0.0

Valor de salida [1], nodo 1

Valor de salida [0], punto inicial
Rango t√©cnico

Rango t√©cnico
PI[1].TMV

TIME

T#1s

Valor temporal [1] nodo 1

PI[2].OUTV

REAL

0.0

Valor de salida [2], nodo 2
Rango t√©cnico

PI[2].TMV

TIME

T#1s

Valor temporal [2] nodo 2

PI[3].OUTV

REAL

0.0

Valor de salida [3], nodo 3

PI[3].TMV

TIME

T#1s

Valor temporal [3], nodo 3

PI[4].OUTV

REAL

0.0

Valor de salida [4] nodo 4

Rango t√©cnico

Rango t√©cnico
PI[4].TMV

TIME

T#0s

Valor temporal [4] nodo 4
0 ms

Generar bloque de datos mediante archivo fuente externo
Alternativamente, puede generar el bloque de datos global mediante un archivo fuente
externo.
Para ello siga los siguientes pasos:
1. Copie el texto que figura m√°s abajo en el portapapeles.
2. Abra un editor de texto externo.
3. Pegue el texto copiado desde el portapapeles en el editor de texto.
4. Guarde el archivo con la extensi√≥n "DB":
5. Abra la carpeta "Fuentes externas" en el √°rbol del proyecto del TIA Portal.
6. Haga doble clic en el comando "Agregar nuevo archivo externo".
Se abrir√° el cuadro de di√°logo "Abrir".
7. Navegue hasta el archivo fuente externo que ha creado previamente y selecci√≥nelo.
8. Confirme la selecci√≥n con "Abrir".
9. Seleccione el archivo fuente externo.
10.En el men√∫ contextual, seleccione el comando "Generar bloques a partir de fuente".

6358

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
11.Una consulta de seguridad le informar√° de que se sobrescribir√°n los bloques que
estuvieran eventualmente presentes.
12.Confirme la consulta de seguridad con "Aceptar".
13.Adapte el bloque de datos generado a su aplicaci√≥n.
DATA_BLOCK "DB_RMPSK"
TITLE = data block ramp soak
{ S7_Optimized_Access := 'FALSE' }
NAME : DB_RMPSK
STRUCT
NBR_PTS : Int;
// number of points (excluding
starting point)
PI : Array[0..4] of Struct
OUTV : Real;
// output variable
TMV : Time;
// output time value
END_STRUCT;
END_STRUCT;

BEGIN
NBR_PTS := 4;
PI[0].TMV := T#1s;
PI[1].TMV := T#1s;
PI[2].TMV := T#1s;
PI[3].TMV := T#1s;
PI[4].TMV := T#0s;
END_DATA_BLOCK

PID_ES
Descripci√≥n de PID_ES
Adem√°s de las funciones de las ramas de valor real y de consigna, la instrucci√≥n implementa
un regulador PID terminado con salida binaria de variable manipulada. La variable manipulada
puede modificarse manualmente. Las funciones parciales pueden activarse o desactivarse.
La instrucci√≥n permite regular instalaciones y procesos t√©cnicos con actuadores de acci√≥n
integrativa en los sistemas de automatizaci√≥n SIMATIC S7. Se pueden regular tanto sistemas
lentos (temperaturas, niveles, etc.) como sistemas muy r√°pidos (caudales, revoluciones, etc.).
El regulador puede utilizarse como regulador de valor fijo, ya sea individualmente o en lazos
de regulaci√≥n secundarios en regulaciones en cascada, de mezcla o de relaci√≥n, pero no como
regulador piloto.
El procesamiento de se√±ales en la rama de consigna o valor real, as√≠ como el tratamiento y
vigilancia del error de regulaci√≥n son id√©nticos a los del regulador continuo.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6359

Instrucciones
4.2 Instrucciones

Arranque
PID_ES dispone de una rutina de inicializaci√≥n que se ejecuta cuando el par√°metro de entrada
COM_RST = TRUE est√° activado.
En el arranque, la acci√≥n I se pone al valor de inicializaci√≥n I_ITLVAL y se emite en la salida
LMN_I. Si se llama en un nivel de alarma c√≠clica, contin√∫a trabajando a partir de este valor.
Si el generador ramp soak est√° activado, los intervalos DB_NBR PI[0 ... NBR_PTS].TMV entre
los nodos se suman y se indican en la salida del tiempo total T_TM y del tiempo residual total
RT_TM. En caso de modificaciones online de PI[n].TMV o en caso de especificaci√≥n de
TM_CONT y TM_SNBR, cambian el tiempo total y el tiempo residual total de la curva de
evoluci√≥n. Ya que el c√°lculo de T_TM y RS_TM prolonga mucho el tiempo de procesamiento
de la funci√≥n RMP_SOAK si hay muchos nodos, dicho c√°lculo solo se realiza despu√©s del
rearranque o si TUPDT_ON = TRUE.
Todas las dem√°s salidas se ponen a sus valores predeterminados.

Rearranque
En caso de rearranque se parte del estado operativo que estaba activo en el momento de la
interrupci√≥n. La regulaci√≥n sigue trabajando con los valores que se calculaban en el instante
de la interrupci√≥n.

Llamada
La instrucci√≥n PID_ES debe llamarse de forma equidistante. Utilice para ello un nivel de alarma
c√≠clica (p. ej. OB35).
Si se efect√∫a una llamada de la instrucci√≥n PID_ES como DB multiinstancia, no se crea ning√∫n
objeto tecnol√≥gico. No se dispone de interfaz de parametrizaci√≥n y puesta en servicio. Los
PID_ES se deben parametrizar directamente en el DB multiinstancia y ponerse en servicio a
trav√©s de una tabla de observaci√≥n.

C√°lculo del error de regulaci√≥n PID_ES
Las funciones siguientes son siempre efectivas y no es posible desactivarlas.
‚óè Limitaci√≥n de consigna SP_LIMIT,
‚óè Vigilancia de valores absolutos del valor real PV_ALARM,
‚óè Vigilancia de la magnitud de la velocidad de cambio del valor real ROCALARM,
‚óè Vigilancia de valores absolutos del error de regulaci√≥n ER_ALARM,
‚óè Limitaci√≥n de la se√±al de salida LMNLIMIT.
Los valores predeterminados se han seleccionado de modo que el funcionamiento sea
correcto sin adaptaci√≥n individual. Para conseguir buenos resultados de regulaci√≥n es
necesario adaptar siempre los par√°metros de estas funciones al proceso.

Acondicionamiento del valor real
El valor real se normaliza a la magnitud f√≠sica.

6360

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
AUTOHOTSPOT
&53B,139B1250
393(5B21 %22/

)$/6(

39B,1

5($/

39B3(5

:25' :

10B3+,5

5($/



10B3,/5



5($/



10B39+5 5($/



10B39/5 5($/





03

5($/



*) Ajuste predeterminado al crear el objeto tecnol√≥gico.
El valor real puede filtrarse con un elemento de retardo de primer orden.
AUTOHOTSPOT
/$*67

/$*6721 %22/

)$/6(


03

5($/

39B70/$*

7,0(



RXWY

03

5($/



7V

El valor real puede linealizarse con la ra√≠z cuadrada. Para ello se requieren los par√°metros
siguientes:
AUTOHOTSPOT

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6361

Instrucciones
4.2 Instrucciones
6457
6457B21

%22/

)$/6(


03

5($/



6457B+5

5($/



6457B/5

5($/



RXWY



39)&B,1

5($/



El valor real puede acondicionarse con una funci√≥n espec√≠fica del usuario. Para ello se
requieren los par√°metros siguientes. La interconexi√≥n debe programarse en la FC de usuario.
AUTOHOTSPOT
39)&

39)&B21

)$/6(

%22/

39)&B1%5 %/2&.B)&
39)&B,1

5($/



)&‡≤±39)&B1%5‡≤Ø

39)&B287 5($/


03

5($/



Los l√≠mites de advertencia y alarma del valor real se vigilan siempre con los par√°metros
siguientes.
AUTOHOTSPOT

6362

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

39B$/$50

39

39+B$/0

5($/



5($/



39+B:51 5($/



5($/



39/B:51 5($/



39B+<6
39/B$/0

5($/

439+B$/0

%22/

)$/6(

439+B:51

%22/

)$/6(

439/B:51

%22/

)$/6(

439/B$/0

%22/

)$/6(



La velocidad de cambio del valor real se limita siempre con los par√°metros siguientes.
AUTOHOTSPOT
52&$/$50

39

5($/



3985/0B3

5($/



39'5/0B3

5($/



39'5/0B1

5($/



3985/0B1

5($/



39GW

43985/03 %22/

)$/6(

439'5/03 %22/

)$/6(

439'5/01 %22/

)$/6(

43985/01 %22/

)$/6(

Acondicionamiento de la consigna
La consigna interna SP_IN se aumenta o reduce con los par√°metros siguientes.
AUTOHOTSPOT

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6363

Instrucciones
4.2 Instrucciones

63B*(1

63*(1B21 %22/

)$/6(

6383

%22/

)$/6(

63'1

%22/

)$/6(

63B+/0

5($/



63B//0

5($/




63)&B,1

5($/

RXWY






63B,17

5($/

03

5($/





La consigna se especifica mediante un generador ramp soak con los par√°metros siguientes.
AUTOHOTSPOT
5$03B62$.
5036.B21 %22/

)$/6(

')503B21 %22/

)$/6(

&<&B21

)$/6(

%22/


70B61%5

,17

45B6B$&7 %22/
1%5B$706 ,17


7V

70B&217

5($/
%/2&.B'%


503B+2/' %22/

)$/6(

%22/

)$/6(

783'7B21 %22/

)$/6(

&217B21
63B,17

5($/

RXWY






7,0(



7B70

7,0(

7V

57B70

7,0(

7V

03

5($/



56B70
'%B1%5

)$/6(



Para reguladores de mezcla y relaci√≥n, la consigna externa SP_EXT puede normalizarse con
los par√°metros siguientes.
AUTOHOTSPOT

6364

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

63B1250
)$&

5($/



63B(;7

5($/



10B63(+5 5($/



10B63(/5

5($/



10B39+5

5($/



10B39/5

5($/



6457B+5

5($/



6457B/5

5($/



6457B21

%22/

)$/6(

RXWY

03

5($/

La consigna puede acondicionarse con una funci√≥n espec√≠fica del usuario. Para ello se
requieren los par√°metros siguientes. La interconexi√≥n debe programarse en la FC de usuario.
El valor de entrada SPFC_IN es un par√°metro impl√≠cito. Se observa en la herramienta de
configuraci√≥n a trav√©s del punto de medici√≥n MP1 (SPEXT_ON = FALSE) o MP2 (SPEXT_ON
= TRUE). El valor de salida es accesible en el punto de medici√≥n MP3. La entrada SPFC_IN
est√° aplicada a la rama de consigna cuando SPFC_ON =FALSE.
AUTOHOTSPOT
63)&

63)&B21

%22/

)$/6(

63)&B1%5 %/2&.B)&
63)&B,1

5($/



)&‡≤Ø63)&B1%5‡≤Ø



63)&B287

5($/

03

5($/



La velocidad de cambio de la consigna se limita con los par√°metros siguientes.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6365

Instrucciones
4.2 Instrucciones

63B52&

6352&B21 %22/

)$/6(


5($/

6385/0B3

5($/



63'5/0B3

5($/



6385/0B1 5($/



63'5/0B1 5($/



5($/

RXWY



LQY

Con los par√°metros siguientes se vigila siempre un l√≠mite superior e inferior absoluto de la
consigna.
63B/,0,7

LQY

5($/

63B+/0

5($/



63B//0

5($/



463B+/0

%22/

)$/6(

63

5($/



463B//0

%22/

)$/6(

Calcular el error de regulaci√≥n
El error de regulaci√≥n se conduce a trav√©s de una zona muerta con los par√°metros siguientes.
AUTOHOTSPOT

6366

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

'($'%$1'

'($'%B21 %22/

)$/6(


LQY

5($/

'($'%B:

5($/

2879

(5

5($/







Los l√≠mites de advertencia y alarma del error de regulaci√≥n se vigilan siempre con los
par√°metros siguientes.
AUTOHOTSPOT
(5B$/$50

4(53B$/0
(5

5($/



(53B$/0

5($/



(53B:51

5($/



(53B+<6

5($/



(51B:51

5($/



(51B$/0

5($/



%22/

)$/6(

4(53B:51 %22/

)$/6(

4(51B:51 %22/

)$/6(

4(51B$/0 %22/

)$/6(

Algoritmo de regulaci√≥n PID_ES
Algoritmo de regulaci√≥n
AUTOHOTSPOT
Hay un total de cinco interruptores disponibles para definir una estructura de regulador efectiva.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6367

Instrucciones
4.2 Instrucciones
AUTOHOTSPOT
Estructura de regulador

Interruptor
P_SEL

I_SEL

D_SEL

PFDB_SEL

DFDB_SEL

Regulaci√≥n P

TRUE

FALSE

FALSE

FALSE

FALSE

Regulaci√≥n P (P en la rama de reali‚Äê
mentaci√≥n)

TRUE

FALSE

FALSE

TRUE

FALSE

Regulaci√≥n PI

TRUE

TRUE

FALSE

FALSE

FALSE

Regulaci√≥n PI (P en la rama de reali‚Äê
mentaci√≥n)

TRUE

TRUE

FALSE

TRUE

FALSE

Regulaci√≥n PD

TRUE

FALSE

TRUE

FALSE

FALSE

Regulaci√≥n PD (P en la rama de reali‚Äê
mentaci√≥n)

TRUE

FALSE

TRUE

FALSE

TRUE

Regulaci√≥n PID

TRUE

TRUE

TRUE

FALSE

FALSE

Regulaci√≥n PID (P/D en la rama de rea‚Äê TRUE
limentaci√≥n)

TRUE

TRUE

FALSE

TRUE

La acci√≥n P queda determinada por la ganancia proporcional GAIN y puede observarse en
LMN_P.
AUTOHOTSPOT
La acci√≥n I se calcula con los par√°metros siguientes.
AUTOHOTSPOT

,17
,B6(/

%22/

)$/6(

,B,7/B21

%22/

)$/6(

,17B+326

%22/

)$/6(

,17B+1(*

%22/

)$/6(





LQY

5($/



7,

7,0(

7V



,B,7/9$/

5($/





/01B,

5($/



*) Ajuste predeterminado al crear el objeto tecnol√≥gico
La acci√≥n D se calcula con los par√°metros siguientes.
AUTOHOTSPOT

6368

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

',)
'B6(/

%22/

)$/6(


LQY

5($/



7'

7,0(

7V

70B/$*

7,0(

7V

/01B'



5($/



Variable manipulada PID_ES
Normalizaci√≥n de la realimentaci√≥n de posici√≥n
La realimentaci√≥n de posici√≥n en formato de periferia se convierte al formato de coma flotante.
La realimentaci√≥n de posici√≥n en formato de periferia puede observarse en MP10.
La tabla siguiente ofrece una visi√≥n de conjunto de los rangos y valores num√©ricos antes y
despu√©s del procesamiento.
Valor de periferia LMNR_PER

LMNR en %

32767

118.515

27648

100.000

1

0.003617

0

0.000

-1

-0.003617

-27648

-100.000

-32768

-118.519

/015B&53/0151250
/0153B21 %22/
/015B,1

5($/

)$/6(



/015B3(5 :25' :

/015B)$& 5($/



/015B2)) 5($/



Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

 LQY

03

03


/015

5($/

6369

Instrucciones
4.2 Instrucciones
*) Ajuste predeterminado al crear el objeto tecnol√≥gico.

Limitaci√≥n de la variable manipulada
Con los par√°metros siguientes se vigila siempre un l√≠mite superior e inferior absoluto de la
variable manipulada. El par√°metro impl√≠cito puede observarse en MP9.
AUTOHOTSPOT

/01/,0,7

4/01B+/0 %22/
LQY

5($/

/01B+/0

5($/



/01B//0

5($/



)$/6(

/01

5($/



4/01B//0

%22/

)$/6(

Regulador paso a paso con realimentaci√≥n de posici√≥n
Las se√±ales manipuladas se forman con los par√°metros siguientes en el regulador paso a paso
con realimentaci√≥n de posici√≥n.
AUTOHOTSPOT
7+5((B67
38/6(287
/0162321 %22/

)$/6(

/0183B23 %22/

)$/6(

/01'1B23 %22/

)$/6(

/016B21

%22/

758(

/0183

%22/

)$/6(

/01'1

%22/

)$/6(

/015B+6

%22/

)$/6(

/015B/6

%22/

)$/6(

03

5($/



075B70

7,0(

7V

38/6(B70

7,0(

7V

%5($.B70 7,0(

7V

6370

/015B+6B/6


4/0183

%22/

)$/6(

4/01'1

%22/

)$/6(

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Regulador paso a paso sin realimentaci√≥n de posici√≥n
La realimentaci√≥n de posici√≥n puede simularse. La simulaci√≥n de la realimentaci√≥n de posici√≥n
se realiza mediante un integrador usando el tiempo de posicionamiento del motor MTR_TM
como constante de tiempo integrativo. En el estado LMNRS_ON = FALSE se emite el valor
inicial del par√°metro LMNRSVAL en la salida del integrador LMNR_ SIM. Despu√©s de
conmutar a LMNRS_ON = TRUE, la simulaci√≥n arranca con este valor inicial.
Si LMNR_HS = TRUE, la integraci√≥n se detiene hacia arriba, si LMNR_LS = TRUE, se detiene
hacia abajo. No se sincroniza la realimentaci√≥n de posici√≥n simulada en las posiciones de tope.
AUTOHOTSPOT
4/0183
38/6(287

4/01'1


/015B+6
/015B/6





,17
/015B6,0

,17
/0156B21
/01569$/
075B70

Nota
La realimentaci√≥n de posici√≥n solamente se simula. No tiene que coincidir con la posici√≥n real
del actuador. Si existe una realimentaci√≥n de posici√≥n real, se deber√≠a usar sin falta.

7+5((B67
38/6(287
/0162321 %22/

)$/6(

/0183B23 %22/

)$/6(

/01'1B23 %22/

)$/6(

/016B21

%22/

758(

/0183

%22/

)$/6(

/01'1

%22/

)$/6(

/015B+6

%22/

)$/6(

/015B/6

%22/

)$/6(

03

5($/

/015B+6B/6


4/0183

%22/

)$/6(

4/01'1

%22/

)$/6(



075B70

7,0(

7V

38/6(B70

7,0(

7V

%5($.B70 7,0(

7V

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6371

Instrucciones
4.2 Instrucciones

PID_ES en circuitos en cascada
Separaci√≥n de la cascada del regulador
En una cascada hay varios reguladores directamente relacionados entre s√≠. Por ello, hay que
tomar medidas para que, despu√©s de separar la estructura de la cascada, el funcionamiento
en cascada pueda retomarse sin problemas en un punto cualquiera.
Por este motivo, en las regulaciones en cascada se forma una se√±al QCAS en los reguladores
secundarios por medio de una l√≥gica O a partir de las se√±ales de estado de los interruptores
en la rama de consigna y variable manipulada. Dicha se√±al acciona en los reguladores
primarios un conmutador que pasa los reguladores al modo de seguimiento. La magnitud de
seguimiento es siempre la consigna SP del lazo secundario.
La conmutaci√≥n del modo de seguimiento al modo autom√°tico se realiza con suavidad, igual
que la conmutaci√≥n de manual a autom√°tico.
Nota
PID_ES puede utilizarse en conmutaciones en cascada √∫nicamente como regulador
secundario en lazos de regulaci√≥n subordinados.

5HJXODGRU

5HJXODGRU

&$6B21
63

25

4&$6

63

39

39

6372

63(;7B21
63B23B21
/016B21
/0162321
0$1B21
/0123B21

39

39

0$1B21
/0123B21

IDOWDHQUHJXODGRUSDVRDSDVRVLQ
UHDOLPGHSRVLFL¬µQRVL/015B21
)$/6(

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Interconexi√≥n de bloques
La figura siguiente muestra el principio de la interconexi√≥n de reguladores en cascadas
multilazo.
5HJXODGRU

5HJXODGRU

63(;7B21
63B23B21
&$6B21
0$1*1B21
/0123B21

25

&$6B21
63

5HJXODGRU

4&$6

63(;7B21
63B23B21
/016B21
/0162321
0$1B21
/0123B21

25

4&$6

&$6B21
63

39

63

39

3,'B&3

39

3,'B&3
/01

&$6B21
&$6

3,'B(6

63B(;7

/01

&$6B21

4&$6
63

&$6

63B(;7

/01
4&$6
63

Par√°metros de entrada de PID_ES
Tabla 4-290
Par√°metro

Offset

Tipo de da‚Äê
tos

COM_RST

0.0

BOOL

Rango

Ajuste pre‚Äê
determina‚Äê
do

Descripci√≥n

FALSE

Rearranque
(Se procesa la rutina de inicializaci√≥n de la ins‚Äê
trucci√≥n)

I_SEL

0.1

BOOL

TRUE

Activar la acci√≥n I

D_SEL

0.2

BOOL

FALSE

Activar la acci√≥n D

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6373

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de da‚Äê
tos

MAN_ON

0.3

BOOL

Rango

Ajuste pre‚Äê
determina‚Äê
do
TRUE

Descripci√≥n

Activar el modo manual
(Lazo de regulaci√≥n deshecho, LMN ajustado
manualmente)

LMNR_HS

0.4

BOOL

FALSE

Se√±al de tope superior de la realimentaci√≥n de
posici√≥n

LMNR_LS

0.5

BOOL

FALSE

Se√±al de tope inferior de la realimentaci√≥n de
posici√≥n

CYCLE

2.0

TIME

T#1s

Tiempo de muestreo

> 20 ms (S7‚Äì300)

(Tiempo entre llamadas del bloque = constante)
Es esencial asegurarse de que el par√°metro se
parametriza con el tiempo de alarma c√≠clica del
OB en el que est√° activa la instrucci√≥n PID_CP.
En caso contrario las funciones dependientes
del tiempo no funcionan correctamente. (Ex‚Äê
cepci√≥n: se utiliza un reductor de tiempo, por
ejemplo a trav√©s del distribuidor de llamadas
del regulador.)
SP_INT

SP_EXT

PV_IN

6.0

10.0

14.0

REAL

REAL

REAL

PV_PER

18.0

INT

GAIN

20.0

REAL

Rango t√©cnico
(magnitud f√≠sica)

0.0

Rango t√©cnico
(magnitud f√≠sica)

0.0

Rango t√©cnico
(magnitud f√≠sica)

0.0

Consigna interna
SP_INT puede modificarse con SPUP y SPDN
mediante un HMI.
Consigna externa
SP_EXT se utiliza para reguladores de mezcla,
relaci√≥n y cascada y puede normalizarse.
Entrada de valor real
(PV en formato de coma flotante)

W#16#0000 Valor real de periferia
Rango completo
(sin dimensi√≥n)

2.0

Ganancia proporcional
(= ganancia del regulador)

TI

24.0

TIME

TI ‚â• CYCLE

T#20s

Tiempo integrativo

TD

28.0

TIME

TD ‚â• CYCLE

T#10s

Tiempo derivativo

TM_LAG

32.0

TIME

TM_LAG ‚â•
CYCLE/2

T#2s

Tiempo de retardo de la acci√≥n D

DISV

36.0

REAL

-100.0 ... 100.0 [%]

0.0

Magnitud perturbadora

LMNR_IN

40.0

REAL

0.0 ... 100.0 [%]

0.0

Realimentaci√≥n de posici√≥n
(LMNR en formato de coma flotante)

LMNR_PER 44.0

INT

W#16#0000 Realimentaci√≥n de posici√≥n de periferia

SP_HLM

46.0

REAL

Rango t√©cnico
(magnitud f√≠sica)

100.0

Consigna del l√≠mite superior

SP_LLM

50.0

REAL

Rango t√©cnico
(magnitud f√≠sica)

0.0

Consigna del l√≠mite inferior

LMN_HLM

54.0

REAL

LMN_LLM ... 100.0
[%]

100.0

Variable manipulada: l√≠mite superior

(LMNRen el formato de la periferia)

6374

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de da‚Äê
tos

Rango

Ajuste pre‚Äê
determina‚Äê
do

LMN_LLM

58.0

REAL

0.0 ... LMN_HLM [%] 0.0

DB_NBR

62.0

BLOCK_DB

DB 1

SPFC_NBR

64.0

BLOCK_FC

FC 0

PVFC_NBR

66.0

BLOCK_FC

FC 0

Descripci√≥n

Variable manipulada: l√≠mite inferior
N√∫mero del bloque de datos
(DB con nodos de la curva)
Consigna n√∫mero de FC
(FC autodefinida en la rama de consigna)
Valor real n√∫mero de FC
(FC autodefinida en la rama del valor real)

Par√°metros de salida de PID_ES
Tabla 4-291
Par√°metro

Offset

Tipo de
datos

Asignaci√≥n
previa

Descripci√≥n

QLMNUP

68.0

BOOL

FALSE

Se√±al alta de la variable manipulada

QLMNDN

68.1

BOOL

FALSE

Se√±al baja de la variable manipulada

QCAS

68.2

BOOL

FALSE

Se√±al para modo de cascada
(Se interconecta con CAS_ON del regulador de nivel superior)

LMN

70.0

REAL

0.0

Se√±al de la variable manipulada (seg√∫n algoritmo de regulaci√≥n)

SP

74.0

REAL

0.0

Consigna
(Consigna efectiva)

PV

78.0

REAL

0.0

Valor real
(Emisi√≥n del valor real efectivo en el modo de cascada)

Par√°metros de entrada/salida de PID_ES
Tabla 4-292
Par√°metro Offset

Tipo de
datos

Asignaci√≥n
previa

Descripci√≥n

MAN

REAL

0.0

Variable manipulada manual

82.0

(Para la asignaci√≥n predeterminada de la variable manipulada mediante
funciones de manejo y visualizaci√≥n)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6375

Instrucciones
4.2 Instrucciones

Variables est√°ticas de PID_ES
Par√°metro

Offset

Tipo de da‚Äê Rango
tos

Asignaci√≥n
previa

PVH_ALM

86.0

REAL

100.0

PVH_WRN...100.0

Descripci√≥n
Valor real: l√≠mite superior de 'Alarma'
Rango admisible:

PVH_WRN 90.0

REAL

PVL_WRN...
PVH_ALM

90.0

Valor real: l√≠mite superior de 'Advertencia'

PVL_WRN

94.0

REAL

PVL_ALM...
PVH_WRN

-90.0

Valor real: l√≠mite inferior de 'Advertencia'

PVL_ALM

98.0

REAL

-100.0...PVL_WRN

-100.0

Valor real: l√≠mite inferior de 'Alarma'

SPGEN_O
N

102.0

BOOL

FALSE

Activar control de la consigna

SPUP

102.1

Rango admisible:
Rango admisible:
Rango admisible:
(Ajustar la consigna a trav√©s de interruptores
Arriba/Abajo)

BOOL

FALSE

Consigna alta

SPDN

102.2

BOOL

FALSE

Consigna baja

RMPSK_O
N

102.3

BOOL

FALSE

Activar el generador ramp soak

SPEXT_O
N

102.4

BOOL

FALSE

Activar consigna externa

(La consigna se predetermina como curva)
(Para la interconexi√≥n con otros bloques de
regulador)

MANGN_O 102.5
N

BOOL

FALSE

Activar el modo manual

MANUP

102.6

BOOL

FALSE

Variable manipulada manual alta

MANDN

102.7

BOOL

FALSE

Variable manipulada manual baja

LMNS_ON

103.0

BOOL

FALSE

Activar el modo manual de las se√±ales mani‚Äê
puladas

LMNUP

103.1

BOOL

FALSE

Se√±al alta de la variable manipulada

((LMN ajustado con interruptor)

(Se controla la se√±al de salida QLMNUP )
LMNDN

103.2

BOOL

FALSE

Se√±al baja de la variable manipulada
(Se controla la se√±al de salida QLMNDN )

DFRMP_O
N

103.3

BOOL

FALSE

Preasignar la salida del generador ramp soak

CYC_ON

103.4

BOOL

FALSE

Activar repetici√≥n c√≠clica

RMP_HOL
D

103.5

BOOL

FALSE

Detener generador ramp soak

CONT_ON

103.6

BOOL

FALSE

(Generador ramp soak) continuar

TUPDT_O
N

103.7

BOOL

FALSE

Recalcular tiempo total

SPFC_ON

104.0

BOOL

FALSE

Llamar FC de consigna

SPROC_O
N

104.1

BOOL

FALSE

Activar funci√≥n de rampa

(A la salida se le preasigna SP_INT)
(La curva se repite autom√°ticamente)
(Se congela la salida del generador ramp soak)
(Se contin√∫a la curva en el siguiente nodo)

6376

(Se recalcula el tiempo total de la curva)

(Limitaci√≥n de la velocidad de cambio de SP)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de da‚Äê Rango
tos

Asignaci√≥n
previa

Descripci√≥n

PVPER_O
N

104.2

BOOL

FALSE

Activar el valor real de periferia

LAG1STO
N

104.3

BOOL

FALSE

Activar elemento de retardo de primer orden

SQRT_ON

104.4

BOOL

FALSE

Activar funci√≥n de ra√≠z cuadrada

PVFC_ON

104.5

BOOL

FALSE

Llamar FC de valor real

DEADB_O
N

104.6

BOOL

FALSE

Activar zona muerta

P_SEL

(Interconexi√≥n con los m√≥dulos de periferia)

(Se filtran peque√±as perturbaciones y ruidos)
104.7

BOOL

TRUE

Activar la acci√≥n P

PFDB_SEL 105.0

BOOL

FALSE

Conectar la acci√≥n P en la rama de realimen‚Äê
taci√≥n

INT_HPOS 105.1

BOOL

FALSE

Congelar la acci√≥n I en direcci√≥n positiva

INT_HNEG 105.2

BOOL

FALSE

Congelar la acci√≥n I en direcci√≥n negativa

I_ITL_ON

105.3

BOOL

FALSE

Preasignar la acci√≥n I

DFDB_SE
L

105.4

BOOL

FALSE

Aplicar la acci√≥n D en la rama de realimenta‚Äê
ci√≥n

DISV_SEL

105.5

BOOL

FALSE

Control anticipativo

LMNR_ON

105.6

BOOL

FALSE

Activar la realimentaci√≥n de posici√≥n
(Modos de operaci√≥n: Regulador paso a paso
con/sin realimentaci√≥n de posici√≥n) No conmu‚Äê
tar en el lazo cerrado.

LMNRP_O
N

105.7

BOOL

TM_SNBR

106.0

INT

TM_CONT

108.0

TIME

FALSE

Activar la realimentaci√≥n de posici√≥n de peri‚Äê
feria

‚â• 0 (sin dimensi√≥n)

0

N√∫mero del siguiente nodo para continuar la
curva

Rango completo (sin
dimensi√≥n)

T#0s

Per√≠odo hasta la continuaci√≥n de la curva

Rango completo (sin
dimensi√≥n)

1.0

Factor

(Per√≠odo que transcurre antes de que el gene‚Äê
rador ramp soak siga procesando la curva en
el nodo TM_SNBR tras una interrupci√≥n)

FAC

112.0

REAL

NM_SPEH
R

116.0

REAL

100.0

Normalizaci√≥n de la consigna: entrada arriba

NM_SPEL
R

120.0

REAL

-100.0

Normalizaci√≥n de la consigna: entrada abajo

SPFC_OU
T

124.0

REAL

0.0

Consigna de la salida de FC

SPURLM_
P

128.0

SPDRLM_
P

132.0

SPURLM_
N

136.0

-100.0 ... 100.0

(Factor de relaci√≥n o mezcla)

(Se interconecta con la salida de la FC en la
rama de consigna)
REAL

‚â•0

10.0

L√≠mite de rampa de subida de la consigna en el
rango positivo

10.0

L√≠mite de rampa de bajada de la consigna en el
rango positivo

10.0

L√≠mite de la rampa de subida de la consigna en
el rango negativo

[magnitud f√≠sica/s]
REAL

‚â•0
[magnitud f√≠sica/s]

REAL

‚â•0
[magnitud f√≠sica/s]

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6377

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de da‚Äê Rango
tos

Asignaci√≥n
previa

Descripci√≥n

SPDRLM_
N

140.0

REAL

10.0

L√≠mite de la rampa de bajada de la consigna en
el rango negativo

NM_PIHR

144.0

REAL

100.0

Normalizaci√≥n del valor real: entrada arriba

NM_PILR

148.0

REAL

-100.0

Normalizaci√≥n del valor real: entrada abajo

NM_PVHR

152.0

REAL

100.0

Normalizaci√≥n del valor real: salida arriba

NM_PVLR

156.0

REAL

-100.0

Normalizaci√≥n del valor real: salida abajo

PV_TMLA
G

160.0

TIME

T#5s

Tiempo de retardo del valor real

SQRT_HR

164.0

REAL

100.0

Ra√≠z cuadrada: salida del rango de medici√≥n
arriba

SQRT_LR

168.0

REAL

0.0

Ra√≠z cuadrada: salida del rango de medici√≥n
abajo

PVFC_OU
T

172.0

REAL

0.0

Valor real de la salida de FC

PVURLM_
P

176.0

REAL

PVDRLM_
P

180.0

REAL

‚â•0

PVURLM_
N

184.0

REAL

‚â•0

PVDRLM_
N

188.0

REAL

PV_HYS

192.0

‚â•0
[magnitud f√≠sica/s]

Rango completo

(Retardo del elemento PT1 en la rama PV)

-100.0 ... 100.0

(Se interconecta con la salida de la FC en la
rama del valor real)
‚â•0

10.0

L√≠mite de la rampa de subida del valor real en
el rango positivo

10.0

L√≠mite de la rampa de bajada del valor real en
el rango positivo

10.0

L√≠mite de la rampa de subida del valor real en
el rango negativo

10.0

L√≠mite de la rampa de bajada del valor real en
el rango negativo

1.0

Hist√©resis del valor real

[magnitud f√≠sica/s]
[magnitud f√≠sica/s]
[magnitud f√≠sica/s]
‚â•0
[magnitud f√≠sica/s]
REAL

‚â•0

(Evita el "centelleo" de la vista de monitoriza‚Äê
ci√≥n)
DEADB_W

196.0

REAL

0.0 ... 100.0

1.0

Ancho de zona muerta
(Determina el tama√±o del rango de insensibili‚Äê
dad)

ERP_ALM

200.0

REAL

0 ... 200.0

100.0

Error de regulaci√≥n: l√≠mite positivo de 'Alarma'

ERP_WRN 204.0

REAL

0 ... 200.0

90.0

Error de regulaci√≥n: l√≠mite positivo de 'Adver‚Äê
tencia'

ERN_WRN 208.0

REAL

-200.0 ... 0

-90.0

Error de regulaci√≥n: l√≠mite negativo de 'Adver‚Äê
tencia'

ERN_ALM

212.0

REAL

-200.0 ... 0

-100.0

Error de regulaci√≥n: l√≠mite negativo de 'Alarma'

ER_HYS

216.0

REAL

‚â•0

1.0

Error de regulaci√≥n de hist√©resis
(Evita el "centelleo" de la vista de monitoriza‚Äê
ci√≥n)

I_ITLVAL

220.0

REAL

-100.0 ... 100.0 [%]

0.0

Valor de inicializaci√≥n para la acci√≥n I

LMNR_FA
C

224.0

REAL

Rango completo (sin
dimensi√≥n)

1.0

Factor de realimentaci√≥n de posici√≥n

6378

(Factor para la adaptaci√≥n del rango de reali‚Äê
mentaci√≥n)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de da‚Äê Rango
tos

Asignaci√≥n
previa

Descripci√≥n

LMNR_OF
F

228.0

REAL

0.0

Offset de realimentaci√≥n de posici√≥n

PUL‚Äê
SE_TM

232.0

TIME

= n * CYCLE /
n=0,1,2...

T#3s

Duraci√≥n m√≠nima de impulso

BREAK_T
M

236.0

TIME

= n * CYCLE /
n=0,1,2...

T#3s

Duraci√≥n m√≠nima de pausa

MTR_TM

240.0

TIME

‚â• CYCLE

T#30s

Tiempo de posicionamiento del motor

PHASE

244.0

INT

0

Fase del PID Self-Tuner

QPVH_AL
M

246.0

BOOL

FALSE

Valor real: el l√≠mite superior de 'Alarma' ha
reaccionado

QPVH_WR 246.1
N

BOOL

FALSE

Valor real: el l√≠mite superior de 'Advertencia' ha
reaccionado

QPVL_WR
N

246.2

BOOL

FALSE

Valor real: el l√≠mite inferior de 'Advertencia' ha
reaccionado

QPVL_AL
M

246.3

BOOL

FALSE

Valor real: el l√≠mite inferior de 'Alarma' ha reac‚Äê
cionado

QR_S_AC
T

246.4

BOOL

FALSE

Procesando tabla de tiempo para curva

QSP_HLM

246.5

BOOL

FALSE

Consigna: el l√≠mite superior ha reaccionado

QSP_LLM

246.6

BOOL

FALSE

Consigna: el l√≠mite inferior ha reaccionado

QPVURLM 246.7
P

BOOL

FALSE

Valor real: el l√≠mite de la rampa de subida en el
rango positivo ha reaccionado

QPVDRLM 247.0
P

BOOL

FALSE

Valor real: el l√≠mite de la rampa de bajada en el
rango positivo ha reaccionado

QPVURLM 247.1
N

BOOL

FALSE

Valor real: el l√≠mite de la rampa de subida en el
rango negativo ha reaccionado

QPVDRLM 247.2
N

BOOL

FALSE

Valor real: el l√≠mite de la rampa de bajada en el
rango negativo ha reaccionado

QERP_AL
M

247.3

BOOL

FALSE

Error de regulaci√≥n: el l√≠mite positivo de 'Alar‚Äê
ma' ha reaccionado

QERP_WR 247.4
N

BOOL

FALSE

Error de regulaci√≥n: el l√≠mite positivo de 'Ad‚Äê
vertencia' ha reaccionado

QERN_WR 247.5
N

BOOL

FALSE

Error de regulaci√≥n; el l√≠mite negativo de 'Ad‚Äê
vertencia' ha reaccionado

QERN_AL
M

247.6

BOOL

FALSE

Error de regulaci√≥n: el l√≠mite negativo de 'Alar‚Äê
ma' ha reaccionado

QLMN_HL
M

247.7

BOOL

FALSE

Variable manipulada: el l√≠mite superior ha reac‚Äê
cionado

QLMN_LL
M

248.0

BOOL

FALSE

Variable manipulada: el l√≠mite inferior ha reac‚Äê
cionado

NBR_ATM
S

250.0

INT

0

N√∫mero del nodo actual del generador ramp
soak

RS_TM

252.0

TIME

T#0s

"Tiempo residual actual" de la curva hasta el
siguiente nodo

T_TM

256.0

TIME

T#0s

"Tiempo total" = tiempo pasado de la curva

-100.0 ... 100.0 [%]

(Punto cero de la normalizaci√≥n de realimen‚Äê
taci√≥n)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6379

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de da‚Äê Rango
tos

Asignaci√≥n
previa

Descripci√≥n

RT_TM

260.0

TIME

T#0s

"Tiempo residual total" = tiempo hasta el final
de la curva

ER

264.0

REAL

0.0

Error de regulaci√≥n

LMN_P

268.0

REAL

0.0

Acci√≥n P

LMN_I

272.0

REAL

0.0

Acci√≥n I

LMN_D

276.0

REAL

0.0

Acci√≥n D

SPFC_IN

280.0

REAL

0.0

Consigna entrada de FC
(Se interconecta con la entrada de la FC auto‚Äê
definida)

PVFC_IN

284.0

REAL

0.0

Valor real entrada de FC
(Se interconecta con la entrada de la FC auto‚Äê
definida)

SP_OP_O
N

288.0

PV_OP_O
N

288.1

LMNOP_O
N

288.2

BOOL

FALSE

Activar control de la consigna
(El valor de SP_OP se aplica como consigna)

BOOL

FALSE

Activar control manual del valor real
(El valor de PV_OP se aplica como consigna)

BOOL

FALSE

Activar control manual de la variable manipu‚Äê
lada
(El valor de LMN_OP se aplica como consigna)

LMNSO‚Äê
PON

288.3

BOOL

FALSE

Activar control manual de la se√±al de la varia‚Äê
ble manipulada
(LMNUP_OP y LMNDN_OP se aplican como
se√±ales manipuladas)

LMNUP_O
P

288.4

BOOL

FALSE

Se√±al alta de la variable manipulada

LMNDN_O
P

288.5

BOOL

FALSE

Se√±al baja de la variable manipulada

LMNRS_O
N

288.6

BOOL

FALSE

Activar simulaci√≥n de la realimentaci√≥n de po‚Äê
sici√≥n

SP_OP

290.0

REAL

0.0

Control manual de la consigna en la herra‚Äê
mienta de configuraci√≥n

PV_OP

294.0

REAL

0.0

Control manual del valor real en la herramienta
de configuraci√≥n

LMN_OP

298.0

REAL

0.0

Control manual de la variable manipulada en la
herramienta de configuraci√≥n

LMNRSVA
L

302.0

REAL

0.0

Valor inicial de la realimentaci√≥n de posici√≥n
simulada

LMNR_SI
M

306.0

REAL

0.0

Valor actual de la realimentaci√≥n de posici√≥n
simulada

MP1

310.0

REAL

0.0

Punto de medici√≥n 1: consigna interna

MP2

314.0

REAL

0.0

Punto de medici√≥n 2: consigna externa

MP3

318.0

REAL

0.0

Punto de medici√≥n 3: consigna ilimitada

MP4

322.0

REAL

0.0

Punto de medici√≥n 4: valor real del m√≥dulo de
periferia

MP5

326.0

REAL

0.0

Punto de medici√≥n 5: valor real despu√©s del
elemento de retardo de primer orden

6380

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de da‚Äê Rango
tos

Asignaci√≥n
previa

Descripci√≥n

MP6

330.0

REAL

0.0

Punto de medici√≥n 6: valor real efectivo (PV)

MP7

334.0

REAL

0.0

Punto de medici√≥n 7: variable manipulada del
algoritmo PID

MP8

338.0

REAL

0.0

Punto de medici√≥n 8: variable manipulada ma‚Äê
nual

MP9

342.0

REAL

0.0

Punto de medici√≥n 9: variable manipulada ili‚Äê
mitada

MP10

346.0

REAL

0.0

Punto de medici√≥n 10: realimentaci√≥n de posi‚Äê
ci√≥n periferia

MP11

350.0

REAL

0.0

Punto de medici√≥n 11: valor de realimentaci√≥n
(LMNR_ON = FALSE)
Realimentaci√≥n de posici√≥n (LMNR_ON =
TRUE)

MP12

354.0

REAL

0.0

Punto de medici√≥n 12: entrada de elemento de
tres puntos

Diagramas de bloques de PID_ES
Diagramas del flujo de se√±ales
De forma an√°loga a la representaci√≥n de los interruptores en la herramienta de configuraci√≥n,
el punto negro en los s√≠mbolos de los interruptores significa que la se√±al de conmutaci√≥n tiene
el valor booleano adyacente (0 = FALSE o 1 = TRUE) y que el recorrido de la se√±al est√°
aplicado a este punto en cada caso. Las se√±ales de conmutaci√≥n (se√±ales binarias) est√°n
marcadas con l√≠neas discontinuas.
Esto significa que la consigna se especifica de modo absoluto mediante SP_INT; lo mismo es
v√°lido para la entrada del valor real mediante PV_IN. Como funci√≥n de regulaci√≥n se ha
ajustado un regulador PI normal con funci√≥n P en la rama de avance. El lazo de regulaci√≥n es
abierto y se influye sobre la magnitud manipulada mediante la entrada MAN en el √°rea
porcentual. Todas las dem√°s funciones son pasivas o, si no pueden desactivarse, no son
efectivas debido al ajuste predeterminado de par√°metros "marginales" en la evoluci√≥n de las
se√±ales dentro del rango de medida o del √°rea de trabajo.

S√≠mbolos e identificaciones en los diagramas de flujo de se√±ales
Las denominaciones de las magnitudes del proceso que pueden conectarse se representan
con el fondo marcado. Gracias a ellas se reconoce d√≥nde puede conectarse la estructura del
regulador con la periferia S7 o directamente con √≥rganos de medici√≥n y los actuadores del
proceso.
Las denominaciones de par√°metros con la combinaci√≥n de letras "OP" (p. ej. SP_OP/
SP_OP_ON) hacen referencia a la posible intervenci√≥n en este punto mediante la herramienta
de configuraci√≥n de Standard PID Control. La herramienta de configuraci√≥n tiene una interfaz
propia con el FB de regulaci√≥n.
Las magnitudes intermedias en la evoluci√≥n de las se√±ales pueden observarse mediante los
puntos de medici√≥n MP1 ... MP12 marcados con c√≠rculos. Dichas magnitudes intermedias son
necesarias para sincronizar valores antes de lanzar operaciones de conmutaci√≥n "suaves" o
Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6381

Instrucciones
4.2 Instrucciones
para inspeccionar los estados actuales de la regulaci√≥n en cuesti√≥n. Las magnitudes del punto
de medici√≥n en el registrador de curvas de la herramienta de configuraci√≥n pueden
representarse tanto est√°tica como din√°micamente.
Por motivos de claridad, los par√°metros para ajustar y dimensionar las operaciones de
procesamiento (algoritmos) est√°n indicados en los distintos bloques de funci√≥n. Remitimos al
respecto a las descripciones de la parte de referencia y a la representaci√≥n de las diferentes
funciones parciales en los apartados siguientes.

Acondicionamiento de la consigna

63)&B,1

5036.B21

63*(1B21

63B,17
63B*(1




638363'1
63B+/063B//0

503B62$.

63(;7B21



45B6B$&7
1%5B$706
56B70
7B70
57B70





03

03

63B(;7

63B1250

'%B1%5&217B21
70B61%570B&217
&<&B21503B+2/'
')503B21783'7B21

)$&

10B63(+510B63(/5
10B39+510B39/56457B21
6457B+56457B/5
63)&B21

63B23B21
6352&B21

63B23
63)&B,1






03

63)&
63)&B287



63B/,0,7

463B//0
63

63B52&
63B+/0
63B//0

&$//
)&
63)&B1%5

6382



463B+/0

6385/0B363'5/0B3
6385/0B163'5/0B1

(5
39

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Acondicionamiento del valor real
393(5B21
39B,1



39B3(5

03

03

/$*6721

6457B21

39B1250






/$*67

10B3,+5
10B3,/5
10B39+5
10B39/5

39B70/$*

6457

‡∑≠




6457B+5
6457B/5

39)&B21 39B23B21
39B23

39)&B,1
39)&B287







39)&
&$//
)&

03

39B$/$50

439+B$/0
439+B:51
439/B:51

439/B$/0
39+B$/039+B:51
39/B:5139/B$/0
39B+<6

39)&B1%5

52&$/$50
GGW

43985/03
439'5/03
43985/01

439'5/01
3985/0B339'5/0B3
3985/0B139'5/0B1

'($'%B21

39
-



63

'($'%$1'

'($'%B:

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

(5
(5B$/$50

4(53B$/0
4(53B:51
4(51B:51

4(51B$/0
(53B$/0(53B:51
(51B:51(51B$/0
(5B+<6

6383

Instrucciones
4.2 Instrucciones

Algoritmo de regulaci√≥n
',69B6(/


',69



3)'%B6(/

3B6(/
/01B3






‡∑¶



*$,1

,B6(/DQG/015B21
,17

(5
39

7,,17B+2/'
,B,7/B21
,B,7/9$/








7,

')'%B6(/




3,'B2879
/01B,
,17B,1

'B6(/

',)

7'
70B/$*

6384





/01B'

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Regulador paso a paso sin realimentaci√≥n de posici√≥n (LMNR_ON = FALSE)
/01/,0,7

,17

/015B6,0
6LPXODFL¬µQGHODUHDOLPHQWDFL¬µQGH
SRVLFL¬µQ
/015B+6

/016B21

3,'B2879

7+5((B67

-

03

/015B/6

/0183
/01'1

03






38/6(287

$1'

4/01'1

$1'

$1'
38/6(B70
%5($.B70

075B70
/0183B23

03

4/0183

$1'




/01'1B23
/062321




25
/016B2125/0162321



,17B,1

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019








075B70
,17






6385

Instrucciones
4.2 Instrucciones

Regulador paso a paso con realimentaci√≥n de posici√≥n (LMNR_ON = TRUE)
0$1
4/01B+/0
4/01B//0
03

/01B+/0
/01B//0

0$1*1B21

/0123B21
0$1B21

/01

/01/,0,7

/01B23

/01)&B,1

0$183
0$1'1

/01B+/0
/01B//0

03

/01B+/0
/01B//0

3,'B2879
03

03

/015B/6

/01'1

7+5((B67

/01

/015B+6

/016B21
/0183

$1'

38/6(287

$1'
/015

03

075B70

$1'
$1'

4/0183
4/01'1

38/6(B70
%5($.B70
/01183B23
/01'1B23
/0162321

/0153B21

03
/01B1250

/015B&53


/015B)$&
/015B2))

/015B3(5

/015B,1

Bloque de datos global DB_RMPSK
Nota
Crear uno mismo un bloque de datos global
Los nodos para el generador ramp soak (RMP_SOAK) se preasignan en un bloque de datos
global. Este bloque de datos global no est√° incluido en la librer√≠a. Debe crear usted mismo este
bloque de datos global seg√∫n el esquema siguiente y adaptarlo a su aplicaci√≥n.

6386

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metro

Tipo de da‚Äê
tos

Ajuste predeter‚Äê
minado

Descripci√≥n

NBR_PTS

INT

4

N√∫mero de nodos -1
1 - 255
Estructura de los datos de los nodos. La matriz debe ser declarada por
0...NBR_PTS.

PI

Array
[0...NBR_P
TS] of Struct

PI[0].OUTV

REAL

0.0

PI[0].TMV

TIME

T#1s

Valor temporal [0], punto inicial

PI[1].OUTV

REAL

0.0

Valor de salida [1], nodo 1

Valor de salida [0], punto inicial
Rango t√©cnico

Rango t√©cnico
PI[1].TMV

TIME

T#1s

Valor temporal [1] nodo 1

PI[2].OUTV

REAL

0.0

Valor de salida [2], nodo 2
Rango t√©cnico

PI[2].TMV

TIME

T#1s

Valor temporal [2] nodo 2

PI[3].OUTV

REAL

0.0

Valor de salida [3], nodo 3

PI[3].TMV

TIME

T#1s

Valor temporal [3], nodo 3

PI[4].OUTV

REAL

0.0

Valor de salida [4] nodo 4

Rango t√©cnico

Rango t√©cnico
PI[4].TMV

TIME

T#0s

Valor temporal [4] nodo 4
0 ms

Generar bloque de datos mediante archivo fuente externo
Alternativamente, puede generar el bloque de datos global mediante un archivo fuente
externo.
Para ello siga los siguientes pasos:
1. Copie el texto que figura m√°s abajo en el portapapeles.
2. Abra un editor de texto externo.
3. Pegue el texto copiado desde el portapapeles en el editor de texto.
4. Guarde el archivo con la extensi√≥n "DB":
5. Abra la carpeta "Fuentes externas" en el √°rbol del proyecto del TIA Portal.
6. Haga doble clic en el comando "Agregar nuevo archivo externo".
Se abrir√° el cuadro de di√°logo "Abrir".
7. Navegue hasta el archivo fuente externo que ha creado previamente y selecci√≥nelo.
8. Confirme la selecci√≥n con "Abrir".
9. Seleccione el archivo fuente externo.
10.En el men√∫ contextual, seleccione el comando "Generar bloques a partir de fuente".

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6387

Instrucciones
4.2 Instrucciones
11.Una consulta de seguridad le informar√° de que se sobrescribir√°n los bloques que
estuvieran eventualmente presentes.
12.Confirme la consulta de seguridad con "Aceptar".
13.Adapte el bloque de datos generado a su aplicaci√≥n.
DATA_BLOCK "DB_RMPSK"
TITLE = data block ramp soak
{ S7_Optimized_Access := 'FALSE' }
NAME : DB_RMPSK
STRUCT
NBR_PTS : Int;
// number of points (excluding
starting point)
PI : Array[0..4] of Struct
OUTV : Real;
// output variable
TMV : Time;
// output time value
END_STRUCT;
END_STRUCT;

BEGIN
NBR_PTS := 4;
PI[0].TMV := T#1s;
PI[1].TMV := T#1s;
PI[2].TMV := T#1s;
PI[3].TMV := T#1s;
PI[4].TMV := T#0s;
END_DATA_BLOCK

LP_SCHED
Descripci√≥n de LP_SCHED
LP_SCHED se utiliza cuando el n√∫mero de alarmas c√≠clicas de una CPU no es suficiente para
conseguir los (distintos) tiempos de muestreo deseados. Permite llamar un m√°ximo de 256
lazos de regulaci√≥n con tiempos de muestreo que suponen un m√∫ltiplo entero del ciclo de la
alarma c√≠clica.
A partir del bloque de datos global DB_LOOP, LP_SCHED lee los par√°metros especificados,
calcula a partir de ellos las variables necesarias para la distribuci√≥n de llamadas y las guarda
en el bloque de datos DB_LOOP.

6388

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Bloque de datos global DB_LOOP (P√°gina 6395) no est√° incluido en la librer√≠a. Debe crear
usted mismo este bloque de datos global.
Nota
El bloque ni comprueba si un bloque de datos global con el n√∫mero DB_NBR realmente existe,
ni si el par√°metro GLP_NBR (n√∫mero m√°s alto de lazos de regulaci√≥n) coincide con la longitud
del bloque de datos. Al no parametrizar correctamente, la CPU cambia al estado STOP y
muestra "Error interno del sistema".

Llamada
LP_SCHED debe llamarse en un OB de alarma c√≠clica antes de todos los reguladores.
Al asignar valores a los par√°metros de entrada, tenga en cuenta lo siguiente:
‚óè TM_BASE: En esta entrada se indica el ciclo del OB de alarma c√≠clica en el que se llama la
instrucci√≥n LP_SCHED.
‚óè COM_RST: En un arranque de la CPU debe llamarse LP_SCHED una vez con
COM_RST = TRUE. En el funcionamiento c√≠clico (alarma c√≠clica) hay que llamar
LP_SCHED con COM_RST = FALSE.
‚óè DB_NBR: En esta entrada se indica el n√∫mero del bloque de datos "DB_LOOP" al que debe
acceder LP_SCHED.
Tras llamar la instrucci√≥n LP_SCHED deben llamarse todos los respectivos reguladores de
forma condicionada. La llamada de los reguladores PID_CP o PID_ES no puede realizarse
mediante LP_SCHED, puesto que al llamar las instrucciones tienen que asignarse sus
par√°metros de entrada y salida.
A continuaci√≥n se muestra un ejemplo de la llamada de la instrucci√≥n LP_SCHED y de la
llamada condicionada de un regulador.
AWL
CALL "LP_SCHED"
TM_BASE:=

Aqu√≠ se parametriza el ciclo de la alarma c√≠clica. Ej.: T#100ms o #CYCLE con CYCLE = par√°metro de entrada del bloque en el que se llama
la instrucci√≥n LP_SCHED.

COM_RST:=

Aqu√≠ se notifica a la instrucci√≥n LP_SCHED si
debe llevarse a cabo una inicializaci√≥n de
los lazos de regulaci√≥n llamados. Ej.: FALSE
o #COM_RST con COM_RST = par√°metro de entrada
del bloque en el que se llama la instrucci√≥n
LP_SCHED.

DB_NBR:=

Aqu√≠ se parametriza el n√∫mero del DB
"DB_LOOP" que debe procesar la instrucci√≥n
LP_SCHED. Ej.: "DB_LOOP" con DB_LOOP = nombre
del DB asignado en la tabla de s√≠mbolos.

A "DB_LOOP".LOOP_DAT[1].ENABLE
SPBN M002

Llamada del lazo de regulaci√≥n si ENABLE =
TRUE

//CALL FBx,DBy

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6389

Instrucciones
4.2 Instrucciones
AWL
//COM_RST:= "DB_LOOP".LOOP_DAT[1].COM_RST
//CYCLE:= "DB_LOOP".LOOP_DAT[1].CYCLE
CLR
= "DB_LOOP".LOOP_DAT[1].ENABLE

Desactivar bit ENABLE

M002:

continuar con el programa, p. ej. llamada condicionada del siguiente FB del lazo de regulaci√≥n

Arranque
Si COM_RST = TRUE, se realizan los siguientes ajustes predeterminados:
N√∫mero de lazo de regulaci√≥n actual:

ALP_NBR = 0

Los datos de llamada de todos los lazos de regulaci√≥n hasta GLB_NBR se preasignan del
siguiente modo:
Habilitaci√≥n:

ENABLE =

NOT MAN_DIS

Tiempo de muestreo:

CYCLE =

GV(MAN_CYC)

Rearranque:

COM_RST =

TRUE

N√∫mero de llamada local:

ILP_COU =

0

GV(MAN_CYC) = MAN_CYC se redondea a un m√∫ltiplo entero de TM_BASE*GLP_NBR

En un arranque de la CPU hay que llamar LP_SCHED desde el OB de arranque
correspondiente y asignar el valor TRUE a la entrada COM_RST. Seguidamente, llame
PID_CP o PID_ES de forma condicionada para que se inicialicen los reguladores.
En el OB de alarma c√≠clica hay que volver a asignar el valor FALSE a COM_RST.

Funcionamiento de LP_SCHED
El procesamiento de la llamada
Un regulador debe procesarse cuando el bit ENABLE correspondiente en el bloque de datos
DB_LOOP tenga el valor TRUE. Dicho bit ha sido escrito previamente por LP_SCHED. Si ya
se ha procesado el regulador, hay que asignar el valor FALSE al bit ENABLE tras el
procesamiento.
Al llamar el regulador deben interconectarse sus par√°metros de entrada COM_RST y CYCLE
con las variables COM_RST[x] y CYCLE[x] del bloque de datos DB_LOOP. CYCLE[x] contiene
el tiempo de muestreo real del regulador x y es escrito por LP_SCHED en cada ciclo.
Durante el funcionamiento existe la posibilidad de bloquear manualmente la llamada de
diferentes reguladores y tambi√©n resetear los reguladores que se desee.

6390

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
/ODPDGDGHODLQVWUXFFL¬µQ
/3B6&+('HQXQ2%GH
DODUPDF¬ØFOLFD

SHM
2%

%ORTXHGHGDWRV
JOREDO'%B/223

/3B6&+('
70B%$6(

5HJXODGRU




>@
>@

>Q@

&20B567
'%B1%5

'%GHLQVWDQFLD

/ODPDGD
FRQGLFLRQDGD

5HJXODGRU

>@

3,'B&33,'B(6
&20B567
&<&/(

'%GHLQVWDQFLD
5HJXODGRU

>@

3,'B&33,'B(6
&20B567
&<&/(

Parametrizaci√≥n del bloque de datos DB_LOOP
La parametrizaci√≥n del distribuidor de llamadas de regulador debe realizarse en el editor de
DB.
Hay que parametrizar las variables siguientes en el bloque de datos DB_LOOP:
‚óè GLP_NBR: n√∫mero de los reguladores cuya llamada es gestionada por LP_SCHED (m√°x.
256)
‚óè MAN_CYC[x], x = 1 ... GLP_NBR: el tiempo de muestreo deseado para los distintos
reguladores. Tenga en cuenta para cada regulador la condici√≥n indicada m√°s abajo para
MAN_CYC[x]. En caso contrario no se garantiza el tiempo de muestreo parametrizado.
Las variables siguientes pueden modificarse durante el funcionamiento:
‚óè MAN_DIS[x] sirve para bloquear la llamada del lazo de regulaci√≥n x durante el
funcionamiento.
‚óè MAN_CRST[x] sirve para lanzar un proceso de inicializaci√≥n para el lazo de regulaci√≥n x
durante el funcionamiento.
La modificaci√≥n se hace efectiva la pr√≥xima vez que se llame la instrucci√≥n LP_SCHED.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6391

Instrucciones
4.2 Instrucciones
Las variables siguientes son escritas por LP_SCHED:
‚óè LP_SCHED introduce la condici√≥n de llamada para el regulador x en la variable ENABLE[x].
‚óè Las variables ALP_NBR y ILP_COU[x] son variables internas de la instrucci√≥n LP_SCHED.
Pueden ser √∫tiles para la observaci√≥n.
Las variables COM_RST[x] y CYCLE[x] se interconectan con los par√°metros de entrada
COM_RST y CYCLE de las instrucciones PID_CP y PID_ES.

Tiempo de muestreo MAN_CYC[x]
LP_SCHED puede procesar un regulador como m√°ximo por llamada. Por consiguiente, el
tiempo
TM_BASE * GLP_NBR transcurre hasta que se han procesado todos los reguladores una vez.
En la parametrizaci√≥n de los tiempos de muestreo deseados MAN_CYC[x] hay que observar
la condici√≥n siguiente para cada regulador:
El tiempo de muestreo del regulador x debe ser un m√∫ltiplo entero del producto de la base de
tiempo y el n√∫mero de los reguladores que deben procesarse:

0$1B&<&>[@ *9 70B%$6( */3B1%5 [ */3B1%5

El tiempo de muestreo real CYCLE[x] del lazo de regulaci√≥n x est√° determinado por
LP_SCHED en cada ciclo a partir de MAN_CYC[x], del siguiente modo:
‚óè Si se ha observado la condici√≥n anterior, el tiempo de muestreo real CYCLE[x] es id√©ntico
al tiempo de muestreo especificado MAN_CYC[x].
‚óè Si no se ha observado la condici√≥n anterior, en CYCLE[x] aparece el valor que resulta de
redondear MAN_CYC[x] al pr√≥ximo m√∫ltiplo entero de TM_BASE * GLP_NBR.

Agregar m√°s lazos de regulaci√≥n
Si desea insertar uno o varios lazos de regulaci√≥n en el bloque de datos DB_LOOP, aumente
el valor inicial de GLP_NBR y ampl√≠e la matriz LOOP_DAT[1...GLP_NBR].
Compruebe el tiempo de muestreo deseado MAN_CYC[x] para cada regulador. Tenga en
cuenta la condici√≥n para MAN_CYC.

Generador de impulsos en combinaci√≥n con LP_SCHED
Si en el regulador continuo PID_CP se ha activado el generador de impulsos, en lugar del
par√°metro CYCLE debe interconectarse el ancho de impulso CYCLE_P con el par√°metro
LOOP_DAT[x].CYCLE.

6392

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Ejemplo de una distribuci√≥n de llamadas
El siguiente ejemplo muestra el orden de las llamadas de cuatro reguladores en un OB de
alarma c√≠clica. Se procesa como m√°ximo un regulador por unidad de la base de tiempo
TM_BASE. El orden de las llamadas resulta del orden de los reguladores en el bloque de datos
DB_LOOP.
5HJXODGRU&<&/(>@   70B%$6(  70B%$6( */3B1%5
5HJXODGRU&<&/(>@   70B%$6(  70B%$6( */3B1%5
5HJXODGRU&<&/(>@   70B%$6(  70B%$6( */3B1%5
5HJXODGRU&<&/(>@   70B%$6(  70B%$6( */3B1%5

W
70B%$6(

70B%$6(FLFORGHO2%GHDODUPDF¬ØFOLFD
*/3B1%5Q¬ºPHURP¬£[LPRGHUHJXODGRUHV DTX¬Ø 
&<&/(>@>@WLHPSRGHPXHVWUHRGHORVUHJXODGRUHV>@>@

Llamada de varios reguladores por ciclo
Si en un ciclo deben procesarse varios reguladores, es posible llamar LP_SCHED varias
veces. Todas las llamadas de la instrucci√≥n LP_SCHED deben realizarse antes de llamar los
reguladores. En el par√°metro de entrada TM_BASE hay que introducir el ciclo del OB de
alarma c√≠clica dividido entre el n√∫mero de llamadas de LP_SCHED.
Ejemplo: LP_SCHED se llama dos veces en el OB 35 y el OB 35 se procesa cada 100 ms. En
este caso, el par√°metro de entrada TM_BASE debe parametrizarse con 50 ms.

Tiempo de ejecuci√≥n
La suma de los tiempos de ejecuci√≥n de la instrucci√≥n LP_SCHED y de los reguladores que se
procesan en un ciclo no puede ser superior al ciclo del OB de alarma c√≠clica.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6393

Instrucciones
4.2 Instrucciones

Operaciones durante el funcionamiento
Durante el funcionamiento est√°n permitidas las modificaciones siguientes en el bloque de
datos "DB_LOOP", siempre y cuando se modifique solo el par√°metro correspondiente y no se
cargue todo el bloque de datos en la CPU:
‚óè Bloquear reguladores individuales
Al escribir la variable MAN_DIS[x] con el valor TRUE se bloquea el procesamiento del
regulador x durante el funcionamiento. LP_SCHED no vuelve a poner a TRUE el bit
ENABLE de este regulador hasta que no se vuelve a escribir MAN_DIS[x] con el valor
FALSE.
‚óè Inicializar un lazo de regulaci√≥n
Al escribir la variable MAN_CRST[x] con el valor TRUE es posible reiniciar diferentes
reguladores: En este caso, LP_SCHED escribe la variable COM_RST[x] con TRUE en el
pr√≥ximo procesamiento del regulador x. En el segundo procesamiento de este lazo de
regulaci√≥n, LP_SCHED escribe las variables MAN_CRST[x] y COM_RST[x] con FALSE.
‚óè Modificaci√≥n del tiempo de muestreo de un lazo de regulaci√≥n
El par√°metro MAN_CYC[x] puede modificarse durante el funcionamiento.
Nota
Si se carga de nuevo todo el bloque de datos DB_LOOP en la CPU sin que la CPU deba
realizar un arranque, hay que inicializar con cero los contadores internos de los lazos de
regulaci√≥n ILP_COU[x], x = 1, ... GLP_NBR y el n√∫mero del lazo de regulaci√≥n actual
ALP_NBR.

Observaci√≥n de la instrucci√≥n LP_SCHED
LP_SCHED introduce el n√∫mero del siguiente regulador por procesar en la variable ALP_NBR
del bloque de datos DB_LOOP. El n√∫mero del regulador correspondiente resulta del
posicionamiento de sus datos de llamada en el orden de las entradas en el bloque de datos.
La variable ILP_COU[x] es el contador interno. Contiene la duraci√≥n hasta la pr√≥xima llamada
del regulador en cuesti√≥n. La unidad de tiempo de ILP_COU es el producto de la base de
tiempo TM_BASE por el n√∫mero de reguladores GLP_NBR. Si ILP_COU = 0, LP_SCHED
activa el bit ENABLE del regulador correspondiente.

Cuando no se llaman lazos de regulaci√≥n en contra de lo previsto
Cuando se llama LP_SCHED pero no se procesan distintos lazos de regulaci√≥n, esto puede
deberse a las causas siguientes:
‚óè Al escribir la variable MAN_DIS[x] con el valor TRUE se ha bloqueado el procesamiento del
lazo de regulaci√≥n durante el funcionamiento.
‚óè En el par√°metro GLP_NBR se ha indicado un n√∫mero insuficiente de reguladores que
deben ser procesados por LP_SCHED.
‚óè Los tiempos de muestreo especificados MAN_CYC[x] para los diferentes lazos de
regulaci√≥n no pueden ser menores que el producto de la base de tiempo TM_BASE por el
n√∫mero de reguladores GLP_NBR. Los reguladores que no cumplen esta condici√≥n no se
procesan.

6394

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de LP_SCHED
Tabla 4-293
Par√°metro

Tipo de da‚Äê
tos

Rango

Ajuste prede‚Äê
terminado

Explicaci√≥n

TM_BASE

TIME

‚â• 20 ms (S7-300)

100 ms

Base de tiempo

‚â• 5 ms (S7-400)

(Ciclo del nivel de alarma c√≠clica en el que se llama
LP_SCHED)
Son v√°lidos valores

COM_RST

BOOL

FALSE

rearranque

DB_NBR

BLOCK_DB

DB 1

N√∫mero del bloque de datos

(Se procesa la rutina de rearranque del LP_SCHED)
(DB con los datos de llamada de los lazos de regulaci√≥n)

Bloque de datos global DB_LOOP
Los datos para la distribuci√≥n de llamadas con LP_SCHED se preasignan en un bloque de
datos global. Este bloque de datos global no est√° incluido en la librer√≠a. Debe crear usted
mismo este bloque de datos global seg√∫n el esquema siguiente y adaptarlo a su aplicaci√≥n.
Par√°metro

Tipo de da‚Äê
tos

Ajuste prede‚Äê
terminado

Descripci√≥n

GLP_NBR

INT

2

N√∫mero m√°ximo de reguladores 1 - 256

ALP_NBR

INT

0

N√∫mero del regulador actual
0 - 256

LOOP_DAT

Array
[1...GLP_N
BR] of
Struct

LOOP_DAT[1].MAN_CYC

TIME

Estructura para los datos de los distintos reguladores. La
matriz debe ser declarada por 1...GLP_NBR.

T#1s

Datos del regulador 1: tiempo de muestreo manual
>= 20 ms (S7-300)
>= 5 ms (S7-400)

LOOP_DAT[1].MAN_DIS

BOOL

FALSE

Datos del regulador 1: bloquear manualmente la llamada del
regulador

LOOP_DAT[1].MAN_CRST

BOOL

FALSE

Datos del regulador 1: iniciar manualmente el rearranque

LOOP_DAT[1].ENABLE

BOOL

FALSE

Datos del regulador 1: habilitaci√≥n del regulador

LOOP_DAT[1].COM_RST

BOOL

FALSE

Datos del regulador 1: rearranque

LOOP_DAT[1].ILP_COU

INT

0

Datos del regulador 1: contador interno

LOOP_DAT[1].CYCLE

TIME

T#1s

Datos del regulador 1: tiempo de muestreo
>= 20 ms (S7-300)
>= 5 ms (S7-400)

LOOP_DAT[2].MAN_CYC

Datos del regulador 2: tiempo de muestreo manual

...

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6395

Instrucciones
4.2 Instrucciones
Alternativamente, puede generar el bloque de datos global mediante un archivo fuente
externo. Para ello siga los siguientes pasos:
1. Copie el texto que figura m√°s abajo en el portapapeles.
2. Abra un editor de texto externo.
3. Pegue el texto del portapapeles en el editor de texto.
4. Guarde el archivo con la extensi√≥n "DB":
5. Abra la carpeta "Fuentes externas" en el √°rbol del proyecto del TIA Portal.
6. Haga doble clic en el comando "Agregar nuevo archivo externo".
Se abrir√° el cuadro de di√°logo "Abrir".
7. Navegue hasta el archivo fuente externo que ha creado previamente y selecci√≥nelo.
8. Confirme la selecci√≥n con "Abrir".
9. Seleccione el archivo fuente externo.
10.En el men√∫ contextual, seleccione el comando "Generar bloques a partir de fuente".
11.Una consulta de seguridad le informar√° de que se sobrescribir√°n los bloques que puedan
estar presentes.
12.Confirme la consulta de seguridad con "Aceptar".
13.Adapte el bloque de datos generado a su aplicaci√≥n.
DATA_BLOCK "DB_LOOP"
TITLE = data block loop scheduler
{ S7_Optimized_Access := 'FALSE' }
NAME : DB_LOOP
STRUCT
GLP_NBR : Int;
ALP_NBR : Int;
LOOP_DAT : Array[1..2] of Struct
MAN_CYC : Time;
MAN_DIS : Bool;
MAN_CRST : Bool;
ENABLE : Bool;
COM_RST : Bool;
ILP_COU : Int;
CYCLE : Time;
END_STRUCT;
END_STRUCT;

// greatest loop number
// actual loop number
// loop data: manual sample time
// loop data: manual loop disable
// loop data: manual complete restart
// loop data: enable loop
// loop data: complete restart
// loop data: internal loop counter
// loop data: sample time

BEGIN
GLP_NBR := 2;
LOOP_DAT[1].MAN_CYC := T#1S;

6396

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
LOOP_DAT[1].CYCLE := T#1S;
LOOP_DAT[2].MAN_CYC := T#200MS;
LOOP_DAT[2].CYCLE := T#200MS;
END_DATA_BLOCK

Modular PID Control
General
Convenciones para los nombres de par√°metros y bloques en el diagrama de bloques
Para las denominaciones de los par√°metros no se han seleccionado m√°s de 8 caracteres.
Se aplican las siguientes convenciones para la denominaci√≥n de los par√°metros:
Primera letra:
Q

Salida general del tipo BOOL (magnitud booleana)

SP

Referencia

PV

Valor medido o magnitud regulada

LMN

Magnitud manipulada o se√±al anal√≥gica de salida que debe emitirse

DISV

Magnitud perturbadora

Letras sucesivas:
MAN

Valor manual

INT

Interno

EXT

Externo

_ON

Magnitud BOOL para activar una funci√≥n

Datos de llamada
La mayor√≠a de las instrucciones de Modular PID Control requiere datos de llamada espec√≠ficos
del lazo de regulaci√≥n como bit de rearranque y tiempo de muestreo. Estos valores se
transmiten a las entradas COM_RST y CYCLE.
Observaciones sobre las barras de par√°metros de bloques (par√°metros de entrada, salida y
entrada/salida)
‚óè Asignaci√≥n previa: aqu√≠ se encuentran los valores de ajuste predeterminados al crear una
nueva instancia.
‚óè Rango de valores: los valores del par√°metro de entrada no deben superar el rango
admisible. No se realiza ninguna comprobaci√≥n del rango dentro del procesamiento de
bloques. El rango t√©cnico se refiere a una magnitud f√≠sica cuyo valor deber√≠a estar entre
¬±10 6.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6397

Instrucciones
4.2 Instrucciones

A_DEAD_B
Descripci√≥n de A_DEAD_B
Si el valor real es ruidoso y el regulador est√° ajustado de forma √≥ptima, el nivel de ruido tambi√©n
afectar√° la salida del regulador. Esto causa un deterioro m√°s r√°pido del actuador debido a la
frecuencia de conmutaci√≥n elevada (regulador paso a paso). Al suprimir el nivel de ruido se
evita la oscilaci√≥n de la salida del regulador.

Modo de funcionamiento
La instrucci√≥n filtra las se√±ales perturbadoras de alta frecuencia del error de regulaci√≥n y
establece un rango insensible alrededor del punto cero. Cuando la magnitud de entrada est√°
dentro de este rango, en la salida se emite cero. El ancho del rango se adapta
autom√°ticamente a la amplitud de la se√±al de perturbaci√≥n.
La instrucci√≥n funciona seg√∫n la siguiente funci√≥n:
OUTV = INV + DB_WIDTH

para

INV < -DB_WIDTH

OUTV = 0.0

para

-DB_WIDTH ‚â§ INV ‚â§ +DB_WIDTH

OUTV = INV - DB_WIDTH

para

INV > +DB_WIDTH

2879

'%B:,'7+

'%B:,'7+

,19

Adaptaci√≥n de la zona muerta
La adaptaci√≥n de la zona muerta puede activarse y desactivarse.
‚óè Adaptaci√≥n desactivada
Si la adaptaci√≥n est√° desactivada (ADAPT_ON = FALSE), como ancho de zona muerta
efectivo DB_WIDTH se congela el √∫ltimo valor DB_WIDTH.
‚óè Adaptaci√≥n activada
A trav√©s de ADAPT_ON = TRUE se puede aplicar un algoritmo de adaptaci√≥n, que calcula
el ancho efectivo de la zona muerta. As√≠ se adapta el ancho de la zona muerta a la amplitud
de la se√±al de ruido que est√° sobrepuesta en la magnitud de entrada y, por tanto, se
suprime el nivel de ruido tambi√©n en caso de una amplitud de ruido inconstante.
Para llamadas del bloque no c√≠clicas, es necesario desactivar la adaptaci√≥n (ADAP_ON =
FALSE).

6398

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Si durante la puesta en marcha se activa la adaptaci√≥n y si despu√©s de cierto tiempo se
establece un ancho de la zona muerta estable, la adaptaci√≥n se puede desactivar. El ancho de
la zona muerta ajustada mediante la adaptaci√≥n se mantiene hasta el pr√≥ximo rearranque.

Adaptaci√≥n activada
Por razones de estabilidad se limita el ancho efectivo de la zona muerta DB_WIDTH hacia
abajo con el valor DB_WL_LM predeterminable en la barra de entrada. Cuando la se√±al de
entrada INV que est√° superpuesta por el ruido medido supera el ancho de la zona muerta
actualmente ajustada en direcci√≥n negativa (1), en direcci√≥n positiva (2) y luego otra vez en
direcci√≥n negativa (3) dentro de la duraci√≥n de per√≠odo 1/CRIT_FRQ, el ancho efectivo de la
zona muerta aumenta en 0.1.
2879




W





,19
'%B:+B/0





'%B:,'7+

'%B:/B/0
W

'%B:/B/0

'%B:+B/0





'%B:,'7+

El proceso se inicia en caso de una superaci√≥n positiva o negativa. Cada vez que se supera
(3 -> 4) el ancho opuesto de la zona muerta dentro de la mitad de la duraci√≥n de per√≠odo, el
ancho de la zona muerta vuelve a aumentar en 0,1. Este proceso se repite tantas veces hasta
que el ancho de la zona muerta coincida con la amplitud del ruido de medici√≥n. Para no
suprimir cualquier se√±al de entrada alta, se limita por arriba el ancho efectivo de la zona muerta
mediante la entrada DB_WH_LM. Si, por el contrario, dentro del tiempo RET_FAC * 1/
CRIT_FRQ no se supera el ancho de la zona muerta, √©ste se reduce en 0.1.
En ese caso CRIT_FRQ indica la frecuencia l√≠mite a partir de la que se interpreta un
componente de la se√±al como perturbaci√≥n. Se limita por arriba y abajo del siguiente modo:
0.01 ‚â§ CRIT_FRQ ‚â§ 1/(3*CYCLE) con CYCLE: Tiempo de muestreo en segundos
El par√°metro RET_FAC determina el m√∫ltiplo de 1/CRIT_FRQ despu√©s de que el ancho de la
zona muerta se haya reducido.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6399

Instrucciones
4.2 Instrucciones
La l√≥gica de adaptaci√≥n solo funciona cuando la magnitud de entrada sin componente de
perturbaci√≥n es similar a cero.
2879
'%B:/B/0





'%B:+B/0

'%B:,'7+

'%B:,'7+

'%B:+B/0

,19

'%B:/B/0

Rearranque
En el rearranque se activan OUTV=0.0 y el ancho efectivo de la zona muerta DB_WIDTH =
DB_WL_LM.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de A_DEAD_B

Par√°metro

Tipo de datos

Ajuste predeter‚Äê
minado

Descripci√≥n

INV

REAL

0.0

Magnitud de entrada

DB_WH_LM

REAL

5.0

Rango t√©cnico
L√≠mite superior del ancho de la zona muerta
Rango t√©cnico
DB_WH_LM > DB_WL_LM
DB_WL_LM

REAL

1.0

L√≠mite inferior del ancho de la zona muerta
Rango t√©cnico
DB_WL_LM < DB_WH_LM

CRIT_FRQ

REAL

0.1

Frecuencia l√≠mite
CRIT_FRQ ‚â• 0.01 y
CRIT_FRQ ‚â§ 1/(3 * CYCLE)

RET_FAC

INT

1

ADAPT_ON

BOOL

FALSE

Factor de vuelta
RET_FAC ‚â• 1

6400

Activar el algoritmo de adaptaci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Tipo de datos

Ajuste predeter‚Äê
minado

Descripci√≥n

COM_RST

BOOL

FALSE

Rearranque

CYCLE

TIME

T#1s

Tiempo de muestreo
CYCLE ‚â• 1ms

Par√°metros de salida de A_DEAD_B

Par√°metro

Tipo de datos

Asignaci√≥n previa

Descripci√≥n

OUTV

REAL

0.0

Magnitud de salida

DB_WIDTH

REAL

0.0

Ancho efectivo de la zona muerta

CRP_IN
Descripci√≥n de CRP_IN
La instrucci√≥n adapta el rango de la periferia anal√≥gica al formato interno de la regulaci√≥n
modular. La instrucci√≥n puede llamarse, por ejemplo, en la rama del valor real.

Modo de funcionamiento
CRP_IN convierte un valor de entrada del formato de periferia en un valor en coma flotante
normalizado de la regulaci√≥n modular.
Valor de periferia

Valor de salida en %

32767

118,515

27648

100,000

1

0,003617

0

0,000

-1

-0,003617

-27648

-100,000

-32768

-118,519

Se puede adaptar el valor en coma flotante mediante un factor de escala y un offset. La salida
se calcula del siguiente modo:
OUTV = INV_PER * 100/27648 * FACTOR + OFFSET
Nota
No se realiza ninguna comprobaci√≥n de rebase positivo/negativo.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6401

Instrucciones
4.2 Instrucciones

Utilizar el valor de puesta en marcha
Para la puesta en marcha, con fines de comprobaci√≥n o en caso de perturbaciones de la
periferia es posible cambiar a un valor de puesta en marcha. Si START_ON = TRUE, en la
salida OUTV de deposita el valor en STARTVAL.

Rearranque
La instrucci√≥n no dispone de rutina de rearranque.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada CRP_IN

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

INV_PER

0.0

WORD

0

Magnitud de entrada para periferia
Rango t√©cnico

FACTOR

2.0

REAL

1.0

Factor de escala

OFFSET

6.0

REAL

0.0

Offset
Rango t√©cnico

START_ON

10.0

BOOL

TRUE

Activar el valor de puesta en marcha

STARTVAL

12.0

REAL

0.0

Valor de puesta en marcha
Rango t√©cnico

Par√°metros de salida de CRP_IN

Par√°metro

Offset

Tipo de da‚Äê Asignaci√≥n
tos
previa

Descripci√≥n

OUTV

16.0

REAL

Magnitud de salida

0.0

CRP_OUT
Descripci√≥n de CRP_OUT
La instrucci√≥n adapta un valor en coma flotante de la regulaci√≥n modular al formato de
periferia.

6402

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Modo de funcionamiento
CRP_OUT convierte un valor de entrada (valor en coma flotante normalizado de la regulaci√≥n
modular) en el formato de la periferia anal√≥gica.
Valor de entrada en %

Valor de periferia

118,515

32767

100,000

27648

0,003617

1

0,000

0

-0,003617

-1

-100,000

-27648

-118,519

-32768

Se puede adaptar el valor en coma flotante mediante un factor de escala y un offset. La salida
se calcula del siguiente modo:
OUTV_PER = (INV * FACTOR + OFFSET) * 27648/100
Nota
No se realiza ninguna comprobaci√≥n de rebase positivo/negativo.

Rearranque
La instrucci√≥n no dispone de rutina de rearranque.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de CRP_OUT

Par√°metro

Offset

Tipo de da‚Äê Asignaci√≥n pre‚Äê
tos
via

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada

FACTOR

4.0

REAL

1.0

Factor de escala

OFFSET

8.0

REAL

0.0

Offset

Rango t√©cnico

Rango t√©cnico

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6403

Instrucciones
4.2 Instrucciones

Par√°metros de salida CRP_OUT

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

OUTV_PER

12.0

WORD

0

Magnitud de salida para periferia

DEAD_T
Descripci√≥n de DEAD_T
La instrucci√≥n se utiliza para las regulaciones de relaci√≥n en las que se unen los componentes
individuales en v√≠as de transporte de diferentes longitudes.

Modo de funcionamiento
La instrucci√≥n retarda la emisi√≥n de un valor de entrada en un tiempo ajustable (tiempo
muerto). Cuando se modifica el tiempo muerto online pueden producirse escalones en el valor
de salida.
Los valores de entrada se guardan temporalmente en un bloque de datos global.
Bloque de datos global DB_DEADT (P√°gina 6406) no est√° incluido en la librer√≠a. Debe crear
usted mismo este bloque de datos global.
El bloque de datos global debe contener un Array [0..nmax] of real.
nmax resulta del tiempo muerto DEAD_TM y el tiempo de muestreo CYCLE de la instrucci√≥n
DEAD_T. Debe darse la siguiente condici√≥n:
‚óè DEAD_TM debe ser un m√∫ltiplo entero de CYCLE.
‚óè nmax=DEAD_TM/CYCLE
En el ciclo n se lee el valor de entrada guardado INV[n] del bloque de datos global y se deposita
en OUTV. INV[n] se sobrescribe con el valor de entrada actual. El contador n aumenta en 1.
Con n = nmax el contador se vuelve a poner a 0. El n√∫mero del bloque global se introduce en el
par√°metro de entrada DB_NBR.

Ejemplo
Con un tiempo de muestreo de CYCLE=1s y un tiempo muerto de DEAD_TM=5s es necesario
almacenar intermediamente 5 valores de entrada. El rango de datos debe ser de 20 bytes.
Los datos contenidos en el bloque de datos global se procesan como en un b√∫fer circular.

6404

N.¬∫ de ci‚Äê
clo

Contador
n

INV en la
instrucci√≥n

Variable
Valor de IN‚Äê
en el blo‚Äê VI[n] en el ini‚Äê
que de
cio del ciclo
datos glo‚Äê
bal

OUTV en la ins‚Äê
trucci√≥n

Valor de
INVI [n] en el fi‚Äê
nal del ciclo

0

0

80.0 INVI[0]

0.0

0.0

80.0

1

1

100.0 INVI[1]

0.0

0.0

100.0

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
N.¬∫ de ci‚Äê
clo

Contador
n

INV en la
instrucci√≥n

Variable
Valor de IN‚Äê
en el blo‚Äê VI[n] en el ini‚Äê
que de
cio del ciclo
datos glo‚Äê
bal

OUTV en la ins‚Äê
trucci√≥n

Valor de
INVI [n] en el fi‚Äê
nal del ciclo

2

2

100.0 INVI[2]

0.0

0.0

100.0

3

3

80.0 INVI[3]

0.0

0.0

80.0

4

4

0.0 INVI[4]

0.0

0.0

0.0

5

0

0.0 INVI[0]

80.0

80.0

0.0

6

1

0.0 INVI[1]

100.0

100.0

0.0

7

2

0.0 INVI[2]

100.0

100.0

0.0

8

3

10.0 INVI[3]

80.0

80.0

10.0

9

4

100.0 INVI[4]

0.0

0.0

100.0

El valor de INV en el ciclo 0 no se emite hasta el ciclo 5 en OUTV. Con un tiempo de muestreo
de 1 s, es decir, retardado el tiempo correspondiente al tiempo muerto de 5 s.

Correcci√≥n
Con TRACK=TRUE el valor de entrada se emite sin retardo en OUTV. El almacenamiento
temporal de los valores de entrada no se interrumpe con el fin de que despu√©s de desactivar
la correcci√≥n se puedan emitir los valores de entrada despu√©s del tiempo muerto ajustado. Con
un flanco descendente en TRACK, OUTV salta a INV[DEAD_TM].

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.
Nota
La instrucci√≥n no comprueba si existe realmente un DB global con el n√∫mero DB_NBR ni si los
par√°metros DEAD_TM (tiempo muerto) y CYCLE (tiempo de muestreo) coinciden con la
longitud del bloque de datos. Si no se ha realizado la parametrizaci√≥n correctamente, la CPU
cambia al estado de funcionamiento STOP mostrando el mensaje "Error interno del sistema".

Rearranque
Durante el rearranque se borran todos los valores de entrada guardados y se emite OUTV=0.0.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6405

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de DEAD_T

Par√°metro

Offset

Tipo de datos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

DB_NBR

4.0

BLOCK_DB

DB 1

N√∫mero del bloque de datos

DEAD_TM

6.0

TIME

10s

Tiempo muerto

TRACK

10.0

BOOL

FALSE

Correcci√≥n OUTV = INV

COM_RST

10.1

BOOL

FALSE

Rearranque

CYCLE

12.0

TIME

1s

Tiempo de muestreo

DEAD_TM ‚â• CYCLE

CYCLE ‚â• 1ms

Par√°metros de salida de DEAD_T

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n previa Descripci√≥n

OUTV

16.0

REAL

0.0

Magnitud de salida

Bloque de datos global DB_DEADT
Los valores de entrada para el elemento de tiempo muerto DEAD_T se guardan
temporalmente en un bloque de datos global. Este bloque de datos global no est√° incluido en
la librer√≠a. Debe crear usted mismo este bloque de datos global seg√∫n el esquema siguiente y
adaptarlo a su aplicaci√≥n.

Par√°metro

Tipo de datos

Ajuste prede‚Äê
terminado

INVI

Array[0..nmax] of real 0.0

Descripci√≥n
Valor de entrada [n]
Rango t√©cnico

Alternativamente, puede generar el bloque de datos global mediante un archivo fuente
externo. Para ello siga los siguientes pasos:
1. Copie el texto que figura m√°s abajo en el portapapeles.
2. Abra un editor de texto externo.
3. Pegue el texto del portapapeles en el editor de texto.
4. Guarde el archivo con la extensi√≥n "DB":
5. Abra la carpeta "Fuentes externas" en el √°rbol del proyecto del TIA Portal.
6. Haga doble clic en el comando "Agregar nuevo archivo externo". Se abrir√° el cuadro de
di√°logo "Abrir".

6406

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
7. Navegue hasta el archivo fuente externo que ha creado previamente y selecci√≥nelo.
8. Confirme la selecci√≥n con "Abrir".
9. Seleccione el archivo fuente externo.
10.En el men√∫ contextual, seleccione el comando "Generar bloques a partir de fuente".
11.Una consulta de seguridad le informar√° de que se sobrescribir√°n los bloques que puedan
estar presentes.
12.Confirme la consulta de seguridad con "Aceptar".
13.Adapte el bloque de datos generado a su aplicaci√≥n.
DATA_BLOCK "DB_DEADT"
TITLE = data block dead time
{ S7_Optimized_Access := 'FALSE' }
NAME : DB_DEADT
STRUCT
INVI : Array[0..4] of Real;
END_STRUCT;
BEGIN
END_DATA_BLOCK

DEADBAND
Descripci√≥n de DEADBAND
Si el valor real es ruidoso y el regulador est√° ajustado de forma √≥ptima, el nivel de ruido tambi√©n
afectar√° la salida del regulador. Esto causa un deterioro m√°s r√°pido del actuador debido a la
frecuencia de conmutaci√≥n elevada (regulador paso a paso). Al suprimir el nivel de ruido se
evita la oscilaci√≥n de la salida del regulador.

Modo de funcionamiento
La instrucci√≥n DEADBAND (zona muerta) suprime peque√±as oscilaciones alrededor de un
punto cero definido en la magnitud de entrada INV; fuera de dichas oscilaciones, la magnitud
de salida OUTV aumenta proporcionalmente a la magnitud de entrada. Funciona seg√∫n la
siguiente funci√≥n:
OUTV = INV + DEADB_W - DEADB_O

para

OUTV = 0.0

para

DEADB_O - DEADB_W ‚â§ INV

y

INV ‚â§ DEADB_O + DEADB_W

para

INV > DEADB_O + DEADB_W

OUTV = INV - DEADB_W - DEADB_O

INV < DEADB_O - DEADB_W

La falsificaci√≥n de se√±al se corresponde con el valor DEADB_W. El punto central de la zona
muerta se define con DEADB_O.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6407

Instrucciones
4.2 Instrucciones
2879

'($'%B2
,19
'($'%B:

El ancho de la zona muerta DEADB_W y el desplazamiento de la zona muerta DEADB_O son
parametrizables. En caso de utilizaci√≥n para la formaci√≥n del error de regulaci√≥n debe
ajustarse el offset DEADB_O=0.0.
La siguiente figura muestra la supresi√≥n de un ruido con offset.
,19
2879
'($'%B:
,19 W

'($'%B2

W

2879 W

Rearranque
La instrucci√≥n no dispone de rutina de rearranque.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros. El ancho de zona muerta s√≥lo debe tener valores positivos.

6408

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de DEADBAND

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

DEADB_W

4.0

REAL

1.0

Ancho de zona muerta
Rango t√©cnico y ‚â• 0.0

DEADB_O

8.0

REAL

0.0

Desplazamiento de la zona muerta
Rango t√©cnico

Par√°metros de salida de DEADBAND

Par√°metro

Offset

Tipo de datos

Asignaci√≥n
previa

Descripci√≥n

OUTV

12.0

REAL

0.0

Magnitud de salida

DIF
Descripci√≥n de DIF
Las magnitudes de proceso se diferencian din√°micamente. De este modo se puede por
ejemplo calcular la velocidad a partir del trayecto recorrido. El diferenciador se puede utilizar
para el control anticipativo, la regulaci√≥n previa y el dise√±o de un regulador.

Modo de funcionamiento
La instrucci√≥n distingue la magnitud de entrada por el tiempo, filtra la se√±al con un elemento
de retardo de primer orden y trabaja en el rango de Laplace seg√∫n la siguiente funci√≥n de
transmisi√≥n.
‚óè OUTV(s) / INV(s) = TD / (1+TM_LAG*s)
El comportamiento de tiempo se determina a trav√©s del tiempo de acci√≥n derivativa TD y el
tiempo de retardo TM_LAG. Las siguientes figuras muestran la respuesta indicial de DIF.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6409

Instrucciones
4.2 Instrucciones
,192879
7'

2879 W 

7'
70B/$*

70B/$*

,19 H W70B/$*

,19

,19 W
2879 W

W

70B/$*

TD

Tiempo de acci√≥n derivativa

TM_LAG

Tiempo de retardo

INV0

Amplitud del escal√≥n de entrada

INV

Magnitud de entrada

OUTV

Magnitud de salida

Si est√° parametrizado TM_LAG ‚â§CYCLE/2, DIF trabaja sin retardo. En la salida se aplica un
escal√≥n de entrada con el factor TD/CYCLE. Despu√©s de un ciclo la salida vuelve a 0.0.
,192879

7'
&<&/(

,19

,19 W
2879 W

W

&<&/(

L√≠mites internos del bloque
El tiempo de acci√≥n derivativa se limita al tiempo de muestreo por abajo. El tiempo de retardo
se limita a la mitad del tiempo de muestreo por abajo.
TDintern = CYCLE

para

TD < CYCLE

TM_LAGintern = CYCLE/2

para

TM_LAG < CYCLE/2

Los valores restantes de los par√°metros de entrada no se limitan en la instrucci√≥n; no se
comprueban los par√°metros.

6410

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Rearranque
Durante el rearranque todas las salidas de se√±al se ponen a cero. Al diferenciador se le asigna
de forma predeterminada e interna el valor de entrada actual de INV. De este modo, se pasa
de forma suave al modo normal con una magnitud de entrada constante.

Par√°metros de entrada de DIF

Par√°metro

Offset

Tipo de datos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

TD

4.0

TIME

T#25s

Tiempo de acci√≥n derivativa

TM_LAG

8.0

TIME

T#5s

Tiempo de retardo

COM_RST

12.0

BOOL

FALSE

Rearranque

CYCLE

14.0

TIME

T#1s

Tiempo de muestreo

‚â• CYCLE

‚â• 1ms

Par√°metros de salida de DIF

Par√°metro

Offset

Tipo de datos

Asignaci√≥n
previa

Descripci√≥n

OUTV

18.0

REAL

0.0

Magnitud de salida

ERR_MON
Descripci√≥n de ERR_MON
La instrucci√≥n se utiliza para crear y vigilar el error de regulaci√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6411

Instrucciones
4.2 Instrucciones

Modo de funcionamiento
La instrucci√≥n calcula el error de regulaci√≥n ER = SP - PV y vigila si √©ste alcanza los l√≠mites
parametrizables. Con un cambio de consigna |ŒîSP| > SP_DIFF se suprime la activaci√≥n de la
se√±al de valor l√≠mite ER_LM por un tiempo de retardo ajustable (TM_DELAY+TM_RAMP).
Durante ese tiempo, ER se vigila con el valor de l√≠mite superior ER_LMTD. Si se rebasa
ER_LMTD, se emite QER_LMTD=TRUE. Una vez transcurrido el tiempo de retardo,
ER_LMTD se convierte en ER_LM con una rampa. La pendiente de la rampa se puede ajustar
mediante el par√°metro TM_RAMP.
63
39

63
39

W


(5



(5B/07'
(5B/0
W
(5B/0

(5B/07'
70B'(/$<

70B5$03

4(5B/07'
4(5B/0

6412

PV:

Valor real

TM_DELAY:

Retardo de conexi√≥n de la se√±al
de monitorizaci√≥n

SP:

Consigna

ER:

Error de regulaci√≥n

TM_RAMP:

Constante de tiempo de rampa

ER_LM:

Valor l√≠mite del error de regulaci√≥n

QER_LM:

El valor l√≠mite del error de regula‚Äê
ci√≥n ha reaccionado

ER_LMTD:

Valor l√≠mite del error de regulaci√≥n
durante el retardo de conexi√≥n

QER_LMTD:

‚ë†

Supresi√≥n de la se√±al de valor l√≠mite

‚ë°

El valor l√≠mite del error de regula‚Äê
ci√≥n ha reaccionado durante el
retardo de conexi√≥n y rampa
Funci√≥n de rampa

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Rearranque
Durante el rearranque se desactivan las se√±ales de aviso QER_LM y QER_LMTD y la salida
de error de regulaci√≥n ER.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de ERR_MON

Par√°metro

Offset

Tipo de datos Asignaci√≥n pre‚Äê
via

Descripci√≥n

ER_LM

0.0

REAL

Valor l√≠mite del error de regulaci√≥n

10.0

Rango t√©cnico y > 0.0 y < ER_LMTD
ER_LMTD

4.0

REAL

100.0

SP

8.0

REAL

0.0

PV

12.0

REAL

0.0

Valor l√≠mite del error de regulaci√≥n durante el retardo de
conexi√≥n
Rango t√©cnico y > ER_LM
Consigna
Rango t√©cnico
Magnitud de regulaci√≥n
Rango t√©cnico

SP_DIFF

16.0

REAL

10.0

Cambio de consigna
Rango t√©cnico y > 0.0

TM_DELAY

20.0

TIME

T#60s

Retardo de conexi√≥n de la se√±al de monitorizaci√≥n

TM_RAMP

24.0

TIME

T#60s

Constante de tiempo de rampa

COM_RST

28.0

BOOL

FALSE

Rearranque

CYCLE

30.0

TIME

T#1s

Tiempo de muestreo
‚â• 1ms

Par√°metros de salida de ERR_MON

Par√°metro

Offset

Tipo de datos Asignaci√≥n pre‚Äê
via

Descripci√≥n

QER_LM

34.0

BOOL

FALSE

El valor l√≠mite del error de regulaci√≥n ha reaccionado

QER_LMTD

34.1

BOOL

FALSE

El valor l√≠mite del error de regulaci√≥n ha reaccionado du‚Äê
rante el retardo de conexi√≥n y rampa

ER

36.0

REAL

0.0

Error de regulaci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6413

Instrucciones
4.2 Instrucciones

INTEG
Descripci√≥n de INTEG
Las magnitudes de proceso se integran din√°micamente. As√≠ se calcula por ejemplo el trayecto
recorrido a partir de la velocidad. La instrucci√≥n se puede utilizar para dise√±ar un regulador con
acci√≥n I.

Modo de funcionamiento
La instrucci√≥n integra la magnitud de entrada por el tiempo y limita la integral a un valor
superior y otro inferior predeterminables. El l√≠mite de la magnitud de salida se indica a trav√©s
de bits de aviso.
La instrucci√≥n contiene las siguientes funciones:
Funciones

DFOUT_ON

HOLD

Integrar

FALSE

FALSE

Congelar la acci√≥n I

FALSE

TRUE

Preasignar salida

TRUE

cualquiera

‚óè Integrar
Al integrar, la instrucci√≥n funciona con la siguiente funci√≥n de transmisi√≥n:
En el rango de Laplace:
OUTV(s) / INV(s) = 1 / (TI*s)
El comportamiento temporal de la acci√≥n I se determina mediante el tiempo de integraci√≥n
TI. La respuesta indicial correspondiente se muestra en la siguiente figura.
,192879

2879 W 


7,

,19 W

2879 W
,19

,19 W
W
7,

6414

T1:

Tiempo de integraci√≥n

INV0:

Amplitud del escal√≥n de entrada

t:

Tiempo

INV:

Magnitud de entrada

OUTV:

Magnitud de salida

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
La salida y la memoria de la acci√≥n I se limitan en los par√°metros H_LM y L_LM. Si la salida se
encuentra fuera del rango L_LM...H_LM , los bits de aviso QH_LM o QL_LM pasan a TRUE.
‚óè Congelar el integrador
Con HOLD = TRUE la acci√≥n I permanece en su valor de salida actual OUTV. Al desactivar
HOLD = FALSE se sigue integrando a partir del valor de salida actual OUTV.
‚óè Preasignar salida
Si est√° activado DFOUT_ON = TRUE, en la salida se deposita DF_OUTV. El l√≠mite es
efectivo. Si DF_OUTV_ON = FALSE se desactiva, INTEG comienza a integrar a partir del
valor DF_OUTV.
La siguiente figura muestra un ejemplo con DFOUT_ON, HOLD y limitaci√≥n
')287B21+2/'
758(
)$/6(

')287B21

758(
)$/6(

W
+2/'

W

,192879
+B/0

2879 W

')B2879 W
,19 W
W
7,

Rearranque
En el rearranque la salida OUTV se pone a 0.0. Si est√° activado DFOUT_ON = TRUE, se emite
DF_OUTV. La limitaci√≥n de la salida y su indicaci√≥n tambi√©n est√°n activados en el rearranque.
Al cambiar al modo normal, la instrucci√≥n contin√∫a integrando desde OUTV.
Si se desea iniciar la acci√≥n I desde un punto de trabajo determinado en el rearranque, es
necesario introducir el punto de trabajo DF_OUTV en la entada. Al llamar la instrucci√≥n en la
rutina de rearranque es necesario activar DFOUT_ON= TRUE y volver a poner DFOUT_ON=
FALSE en el nivel de alarma c√≠clica.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6415

Instrucciones
4.2 Instrucciones

L√≠mites internos del bloque
El tiempo de integraci√≥n se limita al tiempo de muestreo por abajo:
TIintern = CYCLE

para

TI < CYCLE

Los valores restantes de los par√°metros de entrada no se limitan en la instrucci√≥n; no se
comprueban los par√°metros.

Par√°metros de entrada de INTEG

Par√°metro

Offset

Tipo de datos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

H_LM

4.0

REAL

100.0

L√≠mite superior
Rango t√©cnico
H_LM > L_LM

L_LM

8.0

REAL

0.0

L√≠mite inferior
Rango t√©cnico
L_HM < H_LM

TI

12.0

TIME

T#25s

Tiempo de integraci√≥n

DF_OUTV

16.0

REAL

0.0

Preasignaci√≥n de la magnitud de salida

HOLD

20.0

BOOL

FALSE

Congelar la acci√≥n I

DFOUT_ON

20.1

BOOL

FALSE

Activar la preasignaci√≥n de la magnitud de salida

COM_RST

20.2

BOOL

FALSE

Rearranque

CYCLE

22.0

TIME

T#1s

Tiempo de muestreo

TI ‚â• CYCLE
Rango t√©cnico

CYCLE ‚â• 1ms

Par√°metros de salida de INTEG

Par√°metro

Offset

Tipo de datos Asignaci√≥n pre‚Äê Descripci√≥n
via

OUTV

26.0

REAL

0.0

Magnitud de salida

QH_LM

30.0

BOOL

FALSE

El l√≠mite superior ha reaccionado

QL_LM

30.1

BOOL

FALSE

El l√≠mite inferior ha reaccionado

6416

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

LAG1ST
Descripci√≥n de LAG1ST
La instrucci√≥n se utiliza como elemento de retardo y filtrado de 1er orden. El tiempo de retardo
se puede parametrizar.

Modo de funcionamiento
La instrucci√≥n filtra la magnitud de entrada despu√©s del retardo de primer orden y contiene las
siguientes funciones:
Funciones

DFOUT_ON

TRACK

Filtrar

FALSE

FALSE

Correcci√≥n

FALSE

TRUE

Preasignar salida

TRUE

Cualquiera

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6417

Instrucciones
4.2 Instrucciones

‚óè Filtrar
Al filtrar, la instrucci√≥n funciona en el rango de Laplace seg√∫n la siguiente funci√≥n de
transmisi√≥n:
OUTV(s) / INV(s) = 1 / (1+TM_LAG*s)
El comportamiento de tiempo del elemento de retardo se determina a trav√©s del tiempo de
retardo TM_LAG. La respuesta indicial correspondiente se muestra en la siguiente figura.
,192879
2879 W  ,19 H

W
70B/$*

,19 W
,19
2879 W

W
70B/$*

INV

Magnitud de entrada

OUTV

Magnitud de salida

INV0

Amplitud del escal√≥n de entrada

TM_LAG

Tiempo de retardo

‚óè Correcci√≥n
Con TRACK = TRUE el valor de entrada INV se aplica en la salida OUTV.
‚óè Preasignar salida
Si est√° activado DFOUT_ON = TRUE, en la salida se deposita DF_OUTV. Si se desactiva
DF_OUTV_ON = FALSE, el elemento de retardo filtra a partir del valor DF_OUTV.
La siguiente figura muestra el efecto de DFOUT_ON y TRACK:

6418

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
')287B2175$&.
758(
)$/6(

')287B21

W

758(

75$&.

)$/6(

W

,192879

,19 W
2879 W
')B2879 W
W

Rearranque
En el rearranque la salida OUTV se pone a 0.0. Si est√° activado DFOUT_ON = TRUE, se emite
DF_OUTV. Al pasar a filtrado, la instrucci√≥n contin√∫a a partir de OUTV.

L√≠mites internos del bloque
El tiempo de retardo se limita en la mitad del tiempo de muestreo por abajo.
TM_LAGintern = CYCLE/2

para

TM_LAG < CYCLE/2

Los valores restantes de los par√°metros de entrada no se limitan en la instrucci√≥n; no se
comprueban los par√°metros.

Par√°metros de entrada de LAG1ST

Par√°metro

Offset

Tipo de datos

Ajuste predeter‚Äê
minado

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

TM_LAG

4.0

TIME

T#25s

Tiempo de retardo

DF_OUTV

8.0

REAL

0.0

Preasignaci√≥n de la magnitud de salida

TRACK

12.0

BOOL

FALSE

Correcci√≥n OUTV=INV

DFOUT_ON

12.1

BOOL

FALSE

Activar la preasignaci√≥n de la magnitud de salida

Rango t√©cnico

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6419

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de datos

Ajuste predeter‚Äê
minado

Descripci√≥n

COM_RST

12.2

BOOL

FALSE

Rearranque

CYCLE

14.0

TIME

T#1s

Tiempo de muestreo
‚â•1ms

Par√°metros de salida de LAG1ST

Par√°metro

Offset

Tipo de datos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

OUTV

18.0

REAL

0.0

Magnitud de salida

LAG2ND
Descripci√≥n de LAG2ND
La instrucci√≥n sirve para simular partes del sistema para la regulaci√≥n previa y la regulaci√≥n de
dos lazos.

Modo de funcionamiento
La instrucci√≥n implementa un elemento de retardo de 2¬∫ orden con capacidad de oscilaci√≥n y
contiene las siguientes funciones:

6420

Funciones

DFOUT_ON

TRACK

Transferir

FALSE

FALSE

Correcci√≥n

FALSE

TRUE

Preasignar salida

TRUE

cualquiera

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
‚óè Transferir
La funci√≥n de transmisi√≥n en el rango de Laplace es la siguiente:
OUTV(s) / INV(s) = TRANCOEF / (1 + 2*DAM_COEF*TM_CONST*s + TM_CONST2*s2)
Si DAM_COEF >= 1 (caso aperi√≥dico), se puede representar el elemento de transmisi√≥n en
una conexi√≥n en serie de dos elementos PT1.
OUTV(s) / INV(s) = TRANCOEF / (1 + T1*s) * 1 / (1 + T2 * s)
Las constantes temporales se convierte del siguiente modo:
7 70B&2167 '$0B&2()‡∑≠'$0B&2()
7 70B&2167 '$0B&2()‡∑≠'$0B&2()

La siguiente figura muestra el diagrama de bloques.

70B&2167

75$1&2()
70B&2167

,19

2879


75$1&2()

 '$0B&2()
75$1&2()

La figura siguiente muestra la respuesta indicial del elemento LAG2ND con capacidad de
oscilaci√≥n:

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6421

Instrucciones
4.2 Instrucciones

2879 W  75$1&2()

'$0B&2()

75$1&2()

‡∑≠'$0B&2()



H

70B&2167

W

VLQ

‡∑≠'$0B&2()
70B&2167



WSKL

2879
,19
WDQSKL

‡∑≠'$0B&2()



'$0B&2()

2879 W
75$1&2()
,19 W

W

INV

Magnitud de entrada

OUTV

Magnitud de salida

TRANCOEF

Constante de transmisi√≥n

DAM_COEF

Constante de atenuaci√≥n

phi

√Ångulo

‚óè Correcci√≥n
Si TRACK =TRUE, entonces OUTV = INV; los valores internos pasados se ajustan a INV.
‚óè Preasignar salida
Si DFOUT_ON =TRUE, la salida es DF_OUTV, los valores pasados internos se ajustan a
DF_OUTV. DFOUT_ON tiene mayor prioridad que TRACK.

Rearranque
En el rearranque la salida OUTV se pone a 0.0. Si DFOUT_ON = TRUE, la salida es DF_OUTV.

L√≠mites internos del bloque
La constante de tiempo TM_CONST se limita por abajo a la mitad del tiempo de muestreo.
TM_CONSTintern= CYCLE/2

para

TM_CONST < CYCLE/2

Los valores restantes de los par√°metros de entrada no se limitan en la instrucci√≥n; no se
comprueban los par√°metros.

6422

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada LAG2ND

Par√°metro

Offset

Tipo de datos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

TM_CONST

4.0

TIME

T#10s

Constante temporal

DAM_COEF

8.0

REAL

1.0

Constante de atenuaci√≥n

TRANCOEF

12.0

REAL

1.0

Constante de transmisi√≥n

DF_OUTV

16.0

REAL

0.0

Preasignaci√≥n de la magnitud de salida

DFOUT_ON

20.0

BOOL

FALSE

Activar la preasignaci√≥n de la magnitud de salida

TRACK

20.1

BOOL

FALSE

Correcci√≥n OUTV=INV

COM_RST

20.2

BOOL

FALSE

Rearranque

CYCLE

22.0

TIME

T#1s

Tiempo de muestreo

Rango t√©cnico

‚â• 1ms

Par√°metros de salida de LAG2ND

Par√°metro

Offset

Tipo de datos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

OUTV

26.0

REAL

0.0

Magnitud de salida

LIMALARM
Descripci√≥n de LIMALARM
Durante la regulaci√≥n pueden producirse estados de funcionamiento no permitidos o
peligrosos si se sobrepasan o no se alcanzan las magnitudes de proceso (p. ej., revoluciones,
presi√≥n, temperatura, ...) En caso de sobrepasar o no alcanzar los l√≠mites admisibles, se debe
recopilar lo mismo y comunicarlo para que pueda suceder una reacci√≥n eficiente.
La instrucci√≥n comprueba la magnitud de entrada INV en 4 l√≠mites parametrizables. Al alcanzar
y sobrepasar estos l√≠mites se emite una se√±al de l√≠mite correspondiente. El umbral de
desconexi√≥n de las se√±ales de l√≠mite se puede ajustar a traves de una hist√©resis.

Modo de funcionamiento
Los l√≠mites se ajustan en las entradas H_LM_ALM, H_LM_WRN, L_LM_WRN y L_LM_ALM. Si
la magnitud de entrada INV rebasa los l√≠mites, se activan los bits de aviso QH_LMALM,
QH_LMWRN, QL_LMWRN y QL_LMALM. Para evitar una activaci√≥n y desactivaci√≥n r√°pida de
los bits de aviso, el valor de entrada tiene que superar adem√°s una hist√©resis HYS antes de
que se desactiven las salidas.
La figura siguiente muestra el funcionamiento de la instrucci√≥n LIMALARM:
Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6423

Instrucciones
4.2 Instrucciones
,19
+<6
+B/0B$/0
+B/0B:51

,19 W
/B/0B:51
/B/0B$/0
W
4+B/0$/0
4+B/0:51
4/B/0:51
4/B/0$/0

QH_LMALM = TRUE

QH_LMWRN = TRUE

QL_LMWRN = TRUE

QL_LMALM = TRUE

si

INV aumen‚Äê
ta

y

o

INV disminu‚Äê y
ye

INV >= H_LM_ALM - HYS

si

INV aumen‚Äê
ta

INV >= H_LM_WRN

o bien

INV disminu‚Äê y
ye

INV >= H_LM_WRN - HYS

si

INV disminu‚Äê y
ye

INV <= L_LM_WRN

o bien

INV aumen‚Äê
ta

INV <= L_LM_WRN + HYS

si

INV disminu‚Äê y
ye

INV <= L_LM_ALM

o bien

INV aumen‚Äê
ta

INV <= L_LM_ALM + HYS

y

y

y

INV >= H_LM_ALM

Para que la instrucci√≥n funcione correctamente debe cumplirse lo siguiente:
L_LM_ALM < L_LM_WRN < H_LM_WRN < H_LM_ALM

Rearranque
Durante el rearranque todas las salidas de se√±al se ponen en FALSE.

6424

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de LIMALARM

Par√°metro

Offset

Tipo de datos

Asignaci√≥n previa

Descripci√≥n

H_LM_ALM

0.0

REAL

100.0

L√≠mite superior de Alarma
Rango t√©cnico
> H_LM_WRN

H_LM_WRN

4.0

REAL

90.0

L√≠mite superior de Advertencia
Rango t√©cnico
> L_LM_WRN

L_LM_WRN

8.0

REAL

10.0

L√≠mite inferior de Advertencia
Rango t√©cnico
> L_LM_ALM

L_LM_ALM

12.0

REAL

0.0

L√≠mite inferior de Alarma
Rango t√©cnico
< L_LM_WRN

INV

16.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

HYS

20.0

REAL

1.0

Hist√©resis
Rango t√©cnico

COM_RST

24.0

BOOL

FALSE

Rearranque

Par√°metros de salida de LIMALARM

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

QH_LMALM

26.0

BOOL

FALSE

L√≠mite superior de Alarma ha reaccionado

QH_LMWR
N

26.1

BOOL

FALSE

L√≠mite superior de Advertencia ha reaccionado

QL_LMWRN 26.2

BOOL

FALSE

L√≠mite inferior de Advertencia ha reaccionado

QL_LMALM

BOOL

FALSE

L√≠mite inferior de Alarma ha reaccionado

26.3

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6425

Instrucciones
4.2 Instrucciones

LIMITER
Descripci√≥n de LIMITER
En caso de una predeterminaci√≥n din√°mica de los par√°metros (p. ej., el c√°lculo de consignas
a partir de magnitudes de proceso), √©stos pueden tener valores no admisibles para el proceso.
Con la instrucci√≥n LIMITER se pueden mantener en el rango admisible.

Modo de funcionamiento
La instrucci√≥n limita la magnitud de salida OUTV a un l√≠mite superior e inferior configurables
H_LM y L_LM, si la magnitud de entrada INV est√° fuera de dichos l√≠mites. La limitaci√≥n de
OUTV se notifica a trav√©s de las salidas QH_LM y QL_LM.
La figura siguiente muestra el funcionamiento de la instrucci√≥n LIMITER:
,19
2879

,19 W

+B/0
2879 W


W

/B/0

4/B/0
4+B/0

INV

OUTV

QH_LM

QL_LM

‚â• H_LM

H_LM,

TRUE

FALSE

‚â§ L_LM

L_LM,

FALSE

TRUE

‚â§ L_LM

INV

FALSE

FALSE

y
‚â§H_LM

Para que la instrucci√≥n funcione correctamente debe cumplirse lo siguiente:
L_LM < H_LM

Rearranque
Durante el rearranque todas las salidas de se√±al se ponen en FALSE; en la salida OUTV se
ajusta 0.0.

6426

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entada LIMITER

Par√°metro

Offset

Tipo de datos

Asignaci√≥n
previa

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

H_LM

4.0

REAL

100.0

l√≠mite superior
Rango t√©cnico
> L_LM

L_LM

8.0

REAL

0.0

l√≠mite inferior
Rango t√©cnico
< H_LM

COM_RST

12.0

BOOL

FALSE

Rearranque

Par√°metros de salida de LIMITER

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

OUTV

14.0

REAL

0.0

Magnitud de salida

QH_LM

18.0

BOOL

FALSE

l√≠mite superior ha reaccionado

QL_LM

18.1

BOOL

FALSE

l√≠mite inferior ha reaccionado

LMNGEN_C
Descripci√≥n de LMNGEN_C
La instrucci√≥n permite configurar un regulador PID continuo y determina la variable
manipulada del regulador. La variable manipulada puede determinarse en el modo autom√°tico
o preasignarse en el modo manual. El valor manual se puede predeterminar de forma absoluta,
o puede ampliarse y reducirse a trav√©s del modo de conmutador. La variable manipulada y el
aumento de la variable manipulada se pueden limitar a valores especificables.

Rearranque
Durante el rearranque el valor del ajuste predeterminado DF_OUTV se conecta directamente
con la salida LMN, independientemente del bit del ajuste predeterminado DFOUT_ON. El
l√≠mite de la salida y su indicaci√≥n tambi√©n est√°n activados tras un rearranque. Al cambiar al
modo normal, la instrucci√≥n sigue funcionado desde DF_OUTV.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6427

Instrucciones
4.2 Instrucciones
Los par√°metros de salida QLMN_HLM y QLMN_LLM se ponen a FALSE.

Llamada
Mientras la instrucci√≥n PID se llama en un nivel de alarma c√≠clica, cuyo tiempo de ciclo est√°
adaptado a la constante de tiempo dominante en el proceso, la instrucci√≥n LMNGEN_C puede
llamarse para intervenciones manuales en un nivel de alarma c√≠clica m√°s r√°pido. La
interconexi√≥n se realiza con los par√°metros de entrada y salida estructurados PID_LMNG y
LMNG_PID.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Modo de funcionamiento
La instrucci√≥n LMNGEN_C siempre se utiliza en combinaci√≥n con la instrucci√≥n PID.
La siguiente figura muestra la interconexi√≥n del regulador PID continuo.
3,'

/01*(1B&

(5

/01

&
3,'B/01*
/01*B3,'

/01*B3,'
3,'B/01*

Funcionamiento de LMNGEN_C
Limitar variable manipulada
La variable manipulada se limita en todos los modos de operaci√≥n. Los l√≠mites superiores de
la variable manipulada se parametrizan en la entrada LMN_HLM, y el l√≠mite inferior en la
entrada LMN_LLM. Si la variable manipulada calculada rebasa esos valores por exceso o
defecto, en LMN se deposita el l√≠mite superior o inferior. La limitaci√≥n de la variable manipulada
al l√≠mite superior se indica en la salida QLMN_HLM, mientras que la limitaci√≥n al l√≠mite inferior
se indica en la salida QLMN_LLM.

Rampa de la variable manipulada
Con la rampa de la variable manipulada se limita la velocidad de cambio de la variable
manipulada. La rampa de la variable manipulada se activa con LMNRC_ON=TRUE. En el
par√°metro de entrada LMN_URLM se introduce la velocidad de cambio m√°xima para la rampa
de subida de la variable manipulada y en el par√°metro de entrada LMN_DRLM la velocidad de
cambio m√°xima para la rampa de bajada de la variable manipulada.

6428

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Modos de operaci√≥n
Los modos de operaci√≥n se activan y desactivan con los par√°metros DFOUT_ON, MAN_ON
y MANGN_ON.
Modos de operaci√≥n

DFOUT_ON

MAN_ON

MANGN_ON

Modo autom√°tico

FALSE

FALSE

FALSE

Modo manual

FALSE

TRUE

FALSE

Generador de valor manual

FALSE

TRUE

TRUE

Especificar variable manipulada

TRUE

no aplicable

no aplicable

0$1*1B21

0$1
0$1B*(1



0$1B21

0$183
0$1'1




3,'B/01*
3,'B2879

')B2879
')287B21

03





 /0123B21
/01B23

/015&B21
/01B52&



4/01B+/0
4/01B//0

/01/,0,7
/01


/01B85/0
/01B'5/0

/01B+/0
/01B//0

‚óè Modo autom√°tico
El valor determinado con el algoritmo PID se utiliza para determinar la variable manipulada
LMN. La conmutaci√≥n al modo autom√°tico es suave si la rampa de la variable manipulada
(LMNRC_ON = TRUE) est√° activada.
‚óè Modo manual
Con MAN_ON = TRUE se pasa al modo manual, interrumpiendo as√≠ el lazo de regulaci√≥n.
El valor manual MAN se emite directamente como variable manipulada LMN. MAN debe
estar dentro de los l√≠mites LMN_HLM y LMN_LLM.
‚óè Generador de valor manual
Si adem√°s MANGN_ON = TRUE, la variable manipulada puede aumentarse o reducirse
mediante los conmutadores MANUP y MANDN. La velocidad de cambio de la variable
manipulada depende de los l√≠mites:
‚Äì Durante los primeros 3 segundos despu√©s de activar MANUP o MANDN
dLMN/dt = (LMN_HLM - LMN_LLM) / 100 s
‚Äì a continuaci√≥n
dLMN/dt = (LMN_HLM - LMN_LLM) / 10 s
‚óè Especificar variable manipulada
Con DFOUT_ON = TRUE el valor preasignado DF_OUTV se aplica en la salida LMN. La
conmutaci√≥n de o a "Especificar variable manipulada" s√≥lo es suave si est√° activada la
rampa de la variable manipulada. (LMNRC_ON= TRUE).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6429

Instrucciones
4.2 Instrucciones

Control a trav√©s de HMI
Con el uso de variables est√°ticas se puede influir en una variable manipulada a trav√©s de un
HMI (v√©ase la figura siguiente). Las variables est√°ticas LMN_OP, LMNOP_ON y MP1 pueden,
por ejemplo, manejarse y observarse a trav√©s de HMI.
/0123B21
/01B23
 758(
/01
 )$/6(
03

Si LMNOP_ON se pone a TRUE, LMN_OP se pasa a la variable manipulada LMN. MP1
contiene la variable manipulada que se procesa en la instrucci√≥n LMNGEN_C.
Si la rampa de la variable manipulada est√° activada, se puede conmutar suavemente entre los
valores MP1 y LMN_OP. LMN se devuelve, en funci√≥n del ajuste de la rampa, al valor MP1.
Las variables est√°ticas modificadas no tienen efecto en el proceso hasta que han sido
transferidas a la CPU.

Par√°metros de entrada LMNGEN_C

Par√°metro

Offset

Tipo de datos

Asignaci√≥n previa

Descripci√≥n

LMN_HLM

0.0

REAL

100.0

L√≠mite superior de la variable manipulada
Rango t√©cnico
> LMN_LLM

LMN_LLM

4.0

REAL

0.0

L√≠mite inferior de la variable manipulada
Rango t√©cnico
< LMN_HLM

LMN_URLM

8.0

REAL

10.0

L√≠mite de subida de la variable manipulada
[1/s]
> 0.0

LMN_DRLM

12.0

REAL

10.0

L√≠mite de bajada de la variable manipulada
[1/s]
> 0.0

DF_OUTV

16.0

REAL

0.0

Preasignaci√≥n de la magnitud de salida
Rango t√©cnico

MAN_ON

20.0

BOOL

TRUE

Activar el modo manual

MANGN_ON

20.1

BOOL

FALSE

Activar modo de valor manual

MANUP

20.2

BOOL

FALSE

Valor manual alto

MANDN

20.3

BOOL

FALSE

Valor manual bajo

LMNRC_ON

20.4

BOOL

FALSE

Activar rampa de la variable manipulada

DFOUT_ON

20.5

BOOL

FALSE

Activar la preasignaci√≥n de la magnitud de
salida

6430

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de datos

Asignaci√≥n previa

Descripci√≥n

COM_RST

20.6

BOOL

FALSE

Rearranque

CYCLE

22.0

TIME

T#1s

Tiempo de muestreo

PID_LMNG

26.0

STRUC

‚â• 1ms
PID-LMNGEN interfaz

Par√°metros de salida de LMNGEN_C

Par√°metro

Offset

Tipo de da‚Äê Asignaci√≥n
tos
previa

LMN

44.0

REAL

0.0

Variable manipulada

QLMN_HLM

48.0

BOOL

FALSE

L√≠mite superior de la variable manipulada ha reaccionado

FALSE

L√≠mite inferior de la variable manipulada ha reaccionado

QLMN_LLM

48.1

BOOL

LMNG_PID

50.0

STRUC

Descripci√≥n

PID-LMNGEN interfaz

Par√°metros de entrada/salida de LMNGEN_C
Tabla 4-294
Par√°metro

Offset

Tipo de da‚Äê Asignaci√≥n pre‚Äê
tos
via

Descripci√≥n

MAN

68.0

REAL

Valor manual

0.0

Rango t√©cnico

Variables est√°ticas LMNGEN_C

Par√°metro

Offset

Tipo de da‚Äê Ajuste prede‚Äê Descripci√≥n
tos
terminado

MP1

72.0

REAL

0.0

Variable manipulada procesada por LMNGEN_C.

LMM_OP

76.0

REAL

0.0

Control a trav√©s de HMI
Valor manual

LMNOP_ON

80.0

BOOL

FALSE

Control a trav√©s de HMI
Activar el modo manual

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6431

Instrucciones
4.2 Instrucciones

LMNGEN_S
Descripci√≥n de LMNGEN_S
La instrucci√≥n permite configurar un regulador paso a paso PID para actuadores con
comportamiento integral (p. ej., v√°lvulas accionadas por motor) y determinar la variable
manipulada del regulador. La variable manipulada puede determinarse en el modo autom√°tico
o preasignarse en el modo manual. El valor manual se puede predeterminar de forma absoluta,
o puede ampliarse y reducirse a trav√©s del modo de conmutador. La variable manipulada
tambi√©n puede limitarse a valores parametrizables. El regulador paso a paso puede funcionar
con o sin realimentaci√≥n de posici√≥n.

Rearranque
Durante el rearranque todas las salidas de se√±al se ponen en cero.

Llamada
Mientras la instrucci√≥n PID se llama en un nivel de alarma c√≠clica, cuyo tiempo de ciclo est√°
adaptado a la constante de tiempo dominante en el proceso, la instrucci√≥n LMNGEN_S puede
llamarse para intervenciones manuales en un nivel de alarma c√≠clica m√°s r√°pido. La
interconexi√≥n se realiza con los par√°metros de entrada y salida estructurados PID_LMNG y
LMNG_PID.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Modo de funcionamiento
La instrucci√≥n LMNGEN_S siempre se utiliza en combinaci√≥n con la instrucci√≥n PID.
La siguiente figura muestra la interconexi√≥n de un regulador paso a paso.
3,'

/01*(1B6

(5
3,'B/01*
/01*B3,'

6432

4/0183
4/01'1

6
/01*B3,'
3,'B/01*

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Funcionamiento de LMNGEN_S
Limitar variable manipulada
La variable manipulada se limita en todos los modos de operaci√≥n. Los l√≠mites superiores de
la variable manipulada se parametrizan en la entrada LMN_HLM, y el l√≠mite inferior en la
entrada LMN_LLM. Si la variable manipulada calculada rebasa esos valores por exceso o
defecto, en LMN se deposita el l√≠mite superior o inferior. La limitaci√≥n de la variable manipulada
al l√≠mite superior se indica en la salida QLMN_HLM, mientras que la limitaci√≥n al l√≠mite inferior
se indica en la salida QLMN_LLM.

Se√±ales de tope
En los par√°metros de entrada LMNR_HS y LMNR_LS se aplican las se√±ales para el tope
superior e inferior del actuador. Si LMNR_HS= TRUE, el actuador no contin√∫a abri√©ndose. Si
LMNR_LS= TRUE, el actuador no contin√∫a cerr√°ndose. Las se√±ales de salida QLMNUP y
QLMNDN est√°n bloqueadas. Los topes finales se tienen en cuenta en todos los modos de
operaci√≥n.
ADVERTENCIA
Si no hay se√±ales de tope, el regulador no puede reconocer un tope de la v√°lvula y es posible
que, por ejemplo, el regulador emita se√±ales para abrir la v√°lvula, aunque la v√°lvula haya
llegado hasta el tope superior. Si no hay se√±ales de tope, las entradas LMNR_HS y LMNR_LS
deben ser FALSE.

Regulador paso a paso con realimentaci√≥n de posici√≥n
Si hay disponible una realimentaci√≥n de posici√≥n, la instrucci√≥n forma los impulsos para
accionar la v√°lvula de control a partir de la diferencia entre la variable manipulada y la
realimentaci√≥n de posici√≥n mediante un elemento de tres puntos y un generador de impulsos.
Mediante una adaptaci√≥n del umbral de respuesta del elemento de tres niveles se reduce la
frecuencia de conmutaci√≥n del regulador.
La realimentaci√≥n de posici√≥n se activa con LMNR_ON = TRUE.
La

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6433

Instrucciones
4.2 Instrucciones
0$1*1B21

0$1

0$1B*(1

/015B+6
/015B/6



/01'1


0$183
0$1'1

0$1B21
03





3,'B/01*
3,'B2879

/0183
/016B21

4/01B+/0
4/01B+/0
/01





38/6(287








075B70

/01B+/0
/01B//0

/01B23





7+5((B67

/01/,0,7

$1'
38/6(B70
%5($.B70

/0183B23

/0123B21

/01'1B23

4/0183

$1'

4/01'1

/0162321

/015B,1

Regulador paso a paso sin realimentaci√≥n de posici√≥n
Si no hay ninguna realimentaci√≥n de posici√≥n disponible, la instrucci√≥n suma la diferencia
entre la acci√≥n I del algoritmo PID y una realimentaci√≥n de posici√≥n simulada en un integrador
y la compara con la acci√≥n PD residual como valor de realimentaci√≥n. La diferencia pasa al
elemento de tres puntos y al generador de impulsos, que genera los impulsos para la v√°lvula
de control. Mediante una adaptaci√≥n del umbral de respuesta del elemento de tres puntos se
reduce la frecuencia de conmutaci√≥n del regulador.
La realimentaci√≥n de posici√≥n se desactiva con LMNR_ON = FALSE.
/015B+6
/015B/6

4/0183
4/01'1

/01'1
/0183
/016B21
3,'B/01*
3,'B2879

7+5((B67









075B70

38/6(287






/01/,0,7






$1'
$1'

/0156B21


38/6(B70
%5($.B70

/0183B23
/01'1B23



25

/0162321




,17




/0156B21
/01569$/

075B70

,17

/01/,0,7









/015B6,0


3,'B/01*
3,'B6&75

6434









Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Modos de operaci√≥n
Los modos de operaci√≥n se activan y desactivan con los par√°metros LMN_ON, MAN_ON y
MANGN_ON.
Modos de operaci√≥n

LMN_ON

MAN_ON

MANGN_ON

Modo autom√°tico

FALSE

FALSE

FALSE

Preasignar valor manual

FALSE

TRUE

FALSE

Generador de valor manual

FALSE

TRUE

TRUE

Modo manual de las se√±ales de salida de la
variable manipulada

TRUE

no aplicable

no aplicable

Los modos de operaci√≥n Preasignar valor manual y Generador de valor manual solo son
posibles en reguladores paso a paso con realimentaci√≥n de posici√≥n. Dado que en un
regulador paso a paso sin realimentaci√≥n de posici√≥n no hay informaci√≥n sobre la posici√≥n de
la v√°lvula, el actuador no puede llevarse a un valor manual fijo.
‚óè Preasignar valor manual
Con MAN_ON = TRUE se pasa al modo manual, interrumpiendo as√≠ el lazo de regulaci√≥n.
El valor manual MAN se transmite directamente como variable manipulada. MAN debe
estar dentro de los l√≠mites LMN_HLM y LMN_LLM.
‚óè Generador de valor manual
Si adem√°s MANGN_ON = TRUE, la variable manipulada puede aumentarse o reducirse
mediante los conmutadores MANUP y MANDN. La velocidad de cambio de la variable
manipulada depende de los l√≠mites:
‚Äì Durante los primeros 3 segundos despu√©s de activar MANUP o MANDN
dLMN/dt = (LMN_HLM - LMN_LLM) / 100 s
‚Äì a continuaci√≥n
dLMN/dt = (LMN_HLM - LMN_LLM) / 10 s
‚óè Modo manual de las se√±ales de salida de la variable manipulada
Si LMNS_ON = TRUE, se puede influir directamente en las se√±ales binarias de salida. Con
los conmutadores LMNUP y LMNDN se activan las salidas de se√±al manipulada QLMNUP
y QLMNDN. El tiempo m√≠nimo de impulso PULSE_TM y la duraci√≥n m√≠nima de pausa
BREAK_TM tambi√©n se tienen en cuenta.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6435

Instrucciones
4.2 Instrucciones
‚óè Modo autom√°tico con realimentaci√≥n de posici√≥n
El valor enviado por el algoritmo PID PID_LMNG.PID_OUTV se limita a valores
parametrizables (LMN_HLM y LMN_LLM). La diferencia entre la variable manipulada y la
realimentaci√≥n de posici√≥n se conecta a un elemento de tres puntos con hist√©resis. El
umbral de desconexi√≥n se calcula a partir del tiempo de posicionamiento del motor. Para
reducir la frecuencia de conmutaci√≥n se adapta el umbral de respuesta. El generador de
impulsos PULSEOUT garantiza que se cumplan la duraci√≥n m√≠nima de impulso y la
duraci√≥n m√≠nima de pausa.
‚óè Modo autom√°tico sin realimentaci√≥n de posici√≥n
La diferencia entre la acci√≥n I del algoritmo PID y una realimentaci√≥n de posici√≥n simulada
se suma al integrador INT. La entrada del integrador es la diferencia de 100.0/0.0/ -100.0
(dependiendo del estado de las se√±ales de salida QLMNUP y QLMNDN), referido al tiempo
de actuaci√≥n del motor MTR_TM y al error de regulaci√≥n multiplicado por la ganancia del
regulador, referido al tiempo de integraci√≥n TI del algoritmo PID (PID_LMNG.PID_SCTR).
La salida del integrador crea el valor de realimentaci√≥n, que se compara con la acci√≥n PD
residual del algoritmo PID (PID_LMNG.PID_OUTV). La diferencia se conecta a un
elemento de tres puntos con hist√©resis. El umbral de desconexi√≥n se calcula a partir del
tiempo de posicionamiento del motor.
Para reducir la frecuencia de conmutaci√≥n se adapta el umbral de respuesta. El generador
de impulsos PULSEOUT garantiza que se cumpla la duraci√≥n m√≠nima de impulso y de
pausa.

Simulaci√≥n de la realimentaci√≥n de posici√≥n
ADVERTENCIA
La respuesta de posicionamiento solamente se simula. No tiene que coincidir con la
realimentaci√≥n de posici√≥n real de la v√°lvula de control.
Si existe una realimentaci√≥n de posici√≥n real, se deber√≠a usar.
La simulaci√≥n de la realimentaci√≥n de posici√≥n se realiza a trav√©s de un integrador usando el
tiempo de actuaci√≥n del motor MTR_TM como constante de tiempo de integraci√≥n. Con un
flanco positivo en LMNRS_ON se inicia la simulaci√≥n con el valor inicial LMNRSVAL. Si
LMNRS_ON es FALSE, en el par√°metro LMNR_SIM se deposita el valor inicial LMNRSVAL.
Las se√±ales de tope LMNR_HS = TRUE y LMNR_LS = TRUE bloquean la integraci√≥n hacia
arriba y abajo.

6436

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Control a trav√©s de HMI
Con el uso de variables est√°ticas se puede interrumpir la rama de la variable manipulada y
preasignar variables manipuladas propias a trav√©s de un HMI (v√©ase la figura siguiente).
/016B21
/0183

/0123B21

/01'1

/01B23
/01/,0,7

/01

7+5((B67

38/6(287
4/0183
4/01'1

03

/0183B23
/01'1B23
/0162321
/015

Si LMNOP_ON se pone a TRUE, LMN_OP se pasa a la variable manipulada LMN. MP1
contiene la variable manipulada que se procesa en la instrucci√≥n LMNGEN_S.
Si la rampa de la variable manipulada est√° activada, se puede conmutar suavemente entre los
valores MP1 y LMN_OP. LMN se devuelve, en funci√≥n del ajuste de la rampa, al valor MP1.
Si LMNSOPON es TRUE, la variable manipulada se puede aumentar con LMNUP_OP o
reducir con LMNDN_OP. Esto es aplicable para reguladores paso a paso con y sin
realimentaci√≥n de posici√≥n.
Las variables est√°ticas LMNOP_ON, LMN_OP, MP1, LMNSOPON, LMNUP_OP y
LMNDN_OP no pueden interconectarse y solo pueden manejarse y visualizarse con HMI.
Las variables est√°ticas modificadas no tienen efecto en el proceso hasta que han sido
transferidas a la CPU.

Par√°metros de entrada de LMNGEN_S

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

LMN_HLM

0.0

REAL

100.0

L√≠mite superior de la variable manipulada
Rango t√©cnico
> LMN_LLM

LMN_LLM

4.0

REAL

0.0

L√≠mite inferior de la variable manipulada
Rango t√©cnico
< LMN_HLM

LMNR_IN

8.0

REAL

0.0

Realimentaci√≥n de posici√≥n
Rango t√©cnico

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6437

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

MTR_TM

12.0

TIME

T#30s

Tiempo de posicionamiento del motor

PULSE_TM

16.0

TIME

T#3s

BREAK_TM 20.0

TIME

T#3s

Duraci√≥n m√≠nima de pausa

MAN_ON

24.0

BOOL

TRUE

Activar el modo manual

MANGN_O
N

24.1

BOOL

FALSE

Activar modo de valor manual

MANUP

24.2

BOOL

FALSE

Valor manual alto

MANDN

24.3

BOOL

FALSE

Valor manual bajo

LMNR_ON

24.4

BOOL

FALSE

Activar la realimentaci√≥n de posici√≥n

LMNR_HS

24.5

BOOL

FALSE

Se√±al de tope superior de la realimentaci√≥n de posici√≥n

LMNR_LS

24.6

BOOL

FALSE

Se√±al de tope inferior de la realimentaci√≥n de posici√≥n

LMNS_ON

24.7

BOOL

FALSE

Activar el modo manual de las se√±ales de la variable manipulada

LMNUP

25.0

BOOL

FALSE

Se√±al alta de la variable manipulada

LMNDN

25.1

BOOL

FALSE

Se√±al baja de la variable manipulada

COM_RST

25.2

BOOL

FALSE

Rearranque

CYCLE

26.0

TIME

T#1s

Tiempo de muestreo

‚â• CYCLE
Duraci√≥n m√≠nima de impulso
‚â• CYCLE
‚â• CYCLE

‚â• 1ms
PID_LMNG

30.0

STRUC

PID-LMNGEN interfaz

Par√°metros de salida de LMNGEN_S

Par√°metro

Offset

Tipo de datos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

LMN

48.0

REAL

0.0

Variable manipulada

QLMNUP

52.0

BOOL

FALSE

Se√±al alta de la variable manipulada

QLMNDN

52.1

BOOL

FALSE

Se√±al baja de la variable manipulada

QLMN_HLM

52.2

BOOL

FALSE

El l√≠mite superior de la variable manipulada ha reaccio‚Äê
nado

QLMN_LLM

52.3

BOOL

FALSE

El l√≠mite inferior de la variable manipulada ha reaccio‚Äê
nado

LMNG_PID

54.0

STRUC

6438

PID-LMNGEN interfaz

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada/salida de LMNGEN_S
Tabla 4-295
Par√°metro

Offset

Tipo de da‚Äê Asignaci√≥n pre‚Äê
tos
via

Descripci√≥n

MAN

72.0

REAL

Valor manual

0.0

Rango t√©cnico

Variables est√°ticas LMNGEN_S
No se deben modificar las variables que no aparecen listadas. Estas solo se utilizan
internamente.
Par√°metro

Offset

Tipo de da‚Äê Ajuste prede‚Äê Descripci√≥n
tos
terminado

LMNSOPON

76.0

BOOL

FALSE

Control a trav√©s de HMI
Activar el modo manual de las se√±ales de salida de la variable
manipulada

LMNUP_OP

76.1

BOOL

FALSE

Control a trav√©s de HMI
Variable manipulada mayor

LMNDN_OP

76.2

BOOL

FALSE

Control a trav√©s de HMI
Variable manipulada menor

LMNOP_ON

76.3

BOOL

FALSE

Control a trav√©s de HMI
Activar el modo manual

LMNRS_ON

76.4

BOOL

FALSE

Activar la realimentaci√≥n de posici√≥n simulada

MP1

78.0

REAL

0.0

Control a trav√©s de HMI
Variable manipulada procesada por LMNGEN_C.

LMM_OP

82.0

REAL

0.0

Control a trav√©s de HMI
Valor manual

LMNRSVAL

86.0

REAL

0.0

Valor inicial de la realimentaci√≥n de posici√≥n simulada

LMNR_SIM

9.0

REAL

0.0

Realimentaci√≥n de posici√≥n simulada

NONLIN
Descripci√≥n de NONLIN
La instrucci√≥n NONLIN permite adaptar un valor de entrada, p. ej. el valor medido de un
termopar, mediante una curva caracter√≠stica (l√≠nea poligonal) predeterminable.

Modo de funcionamiento
NONLIN interpola a la magnitud de entrada actual INV la magnitud de salida correspondiente
OUTV a partir de nodos en una l√≠nea poligonal (polil√≠nea). Los nodos de la l√≠nea poligonal se
guardan en un bloque de datos global.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6439

Instrucciones
4.2 Instrucciones
Bloque de datos global DB_NONLIN (P√°gina 6441) no est√° incluido en la librer√≠a. Debe crear
usted mismo este bloque de datos global.
Nota
La instrucci√≥n no comprueba si existe realmente un bloque de datos global con el n√∫mero
DB_NBR ni si el par√°metro DB_NBR. NBR_PTS (n√∫mero de nodos) concuerda con la longitud
del bloque de datos. Si no se ha realizado la parametrizaci√≥n correctamente, la CPU cambia
al estado de funcionamiento STOP mostrando el mensaje "Error interno del sistema".
NONLIN dispone de las siguientes funciones:
Funciones

DFOUT_ON

TRACK

OUTV

Interpolaci√≥n

FALSE

FALSE

OUTV = f(INV)

Preasignar salida

TRUE

cualquiera

DF_OUTV

Correcci√≥n

FALSE

TRUE

OUTV = INV

‚óè Interpolaci√≥n
La figura siguiente muestra c√≥mo se determina la magnitud de salida OUTV a partir de la
magnitud de entrada INV.
OUTV = f(INV)
2879
3,>@2879
3,>@2879
3,>@2879

3,>@2879
3,>@2879

3,>@,19

3,>@,19
3,>@,19

3,>@,19

,19

3,>@,19

Si el valor de entrada est√° por debajo del nodo 0, se extrapola con el aumento del par de
nodos 0/1. Si el valor est√° por encima del √∫ltimo nodo, se extrapola con el aumento del
√∫ltimo par de nodos. Para que la instrucci√≥n d√© un resultado eficiente, los valores de los
nodos deben ser estrictamente crecientes en orden ascendente.
‚óè Preasignar salida
Si est√° ajustado DFOUT_ON = TRUE, en la salida se deposita DF_OUTV, el cambio de
OUTV es brusco. Al conmutar a DFOUT_ON = FALSE, el cambio de OUTV tambi√©n es
brusco.
‚óè Correcci√≥n
Con TRACK=TRUE el valor de entrada se emite directamente (OUTV=INV). Igual que con
DFOUT_ON, el cambio es brusco. TRACK tiene menor prioridad que DFOUT_ON.

6440

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Rearranque
En caso de rearranque, la salida es OUTV = 0.0. Si DFOUT_ON=TRUE, la salida es DF_OUTV.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de NONLIN

Par√°metro

Offset

Tipo de datos

Asignaci√≥n previa

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

DF_OUTV

4.0

REAL

0.0

Preasignaci√≥n de la magnitud de salida
Rango t√©cnico

DB_NBR

8.0

BLOCK_DB

DB 1

N√∫mero del bloque de datos

DFOUT_ON

10.0

BOOL

FALSE

Activar la preasignaci√≥n de la magnitud de salida

TRACK

10.1

BOOL

FALSE

Correcci√≥n OUTV=INV

COM_RST

10.2

BOOL

FALSE

Rearranque

Par√°metros de salida de NONLIN

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

OUTV

12.0

REAL

0.0

Magnitud de salida

Bloque de datos global DB_NONLIN
Los nodos de la l√≠nea poligonal para la instrucci√≥n NONLIN se preasignan en un bloque de
datos global. Este bloque de datos global no est√° incluido en la librer√≠a. Debe crear usted
mismo este bloque de datos global seg√∫n el esquema siguiente y adaptarlo a su aplicaci√≥n.
Par√°metro

Tipo de datos

Ajuste predeter‚Äê Descripci√≥n
minado

DB_NBR.NBR_PTS

INT

4

N√∫mero de nodo m√°s alto
Rango 1 - 255

DB_NBR.PI[0].OUTV

REAL

0.0

Valor de salida [0], punto inicial 0
Rango t√©cnico

DB_NBR.PI[0].INV

REAL

0.0

Valor de entrada [0], punto inicial 0
Rango t√©cnico

DB_NBR.PI[1].OUTV

REAL

0.0

Valor de salida [1], nodo 1
Rango t√©cnico

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6441

Instrucciones
4.2 Instrucciones
Par√°metro

Tipo de datos

Ajuste predeter‚Äê Descripci√≥n
minado

DB_NBR.PI[1].INV

REAL

0.0

DB_NBR.PI[2].OUTV

REAL

0.0

DB_NBR.PI[2].INV

REAL

0.0

DB_NBR.PI[3].OUTV

REAL

0.0

Valor de entrada [1] nodo 1
Rango t√©cnico
Valor de salida [2], nodo 2
Rango t√©cnico
Valor de entrada [2] nodo 2
Rango t√©cnico
Valor de salida [3], nodo 3
Rango t√©cnico

DB_NBR.PI[3].INV

REAL

0.0

Valor de entrada [3], nodo 3
Rango t√©cnico

DB_NBR.PI[4].OUTV

REAL

0.0

Valor de salida [4] nodo 4
Rango t√©cnico

DB_NBR.PI[4].INV

REAL

0.0

Valor de entrada [4] nodo 4
Rango t√©cnico

Alternativamente, puede generar el bloque de datos global mediante un archivo fuente
externo. Para ello siga los siguientes pasos:
1. Copie el texto que figura m√°s abajo en el portapapeles.
2. Abra un editor de texto externo.
3. Pegue el texto del portapapeles en el editor de texto.
4. Guarde el archivo con la extensi√≥n "DB":
5. Abra la carpeta "Fuentes externas" en el √°rbol del proyecto del TIA Portal.
6. Haga doble clic en el comando "Agregar nuevo archivo externo".
Se abrir√° el cuadro de di√°logo "Abrir".
7. Navegue hasta el archivo fuente externo que ha creado previamente y selecci√≥nelo.
8. Confirme la selecci√≥n con "Abrir".
9. Seleccione el archivo fuente externo.
10.En el men√∫ contextual, seleccione el comando "Generar bloques a partir de fuente".
11.Una consulta de seguridad le informar√° de que se sobrescribir√°n los bloques que puedan
estar presentes.
12.Confirme la consulta de seguridad con "Aceptar".
13.Adapte el bloque de datos generado a su aplicaci√≥n.
DATA_BLOCK "DB_NONLIN"
TITLE = data block nonlinear static function
{ S7_Optimized_Access := 'FALSE' }
NAME : DB_NONLI
STRUCT
NBR_PTS : Int;

6442

// number of points (excluding starting point)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
PI : Array[0..4] of Struct
OUTV : Real;
INV : Real;
END_STRUCT;
END_STRUCT;

// output variable
// input variable

BEGIN
NBR_PTS := 4;
PI[0].OUTV := 1.0;
PI[0].INV := 2.0;
PI[1].OUTV := 2.0;
PI[1].INV := 3.0;
PI[2].OUTV := 4.0;
PI[2].INV := 4.0;
PI[3].OUTV := 5.0;
PI[3].INV := 5.0;
PI[4].OUTV := 6.0;
PI[4].INV := 7.0;
END_DATA_BLOCK

NORM
Descripci√≥n NORM
En los valores reales el valor del generador muchas veces est√° en un rango que no resulta
adecuado para el usuario (p. ej., 0 a 10 V corresponden a 0 a 1.200 ¬∫C o 0 a 10 V corresponden
a 0 a 3.000 U/min). Debido a la normalizaci√≥n de la consigna o del valor real, ambas
magnitudes de proceso est√°n en el mismo rango.

Modo de funcionamiento
La instrucci√≥n normaliza la magnitud de entrada en una magnitud de salida con otro rango. La
magnitud de entrada INV se transfiere a la magnitud de salida OUTV con la recta de
normalizaci√≥n. La recta de normalizaci√≥n se define mediante los dos pares de valores
IN_LVAL, OUT_LVAL y IN_HVAL, OUT_HVAL.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6443

Instrucciones
4.2 Instrucciones
2879
287B+9$/

287B/9$/

,1B/9$/

,1B+9$/

,19

Rearranque
La instrucci√≥n no dispone de rutina de rearranque.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada NORM

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n previa

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada

IN_HVAL

4.0

REAL

100.0

Rango t√©cnico
Valor f√≠sico de entrada bajo
Rango t√©cnico
> IN_LVAL
OUT_HVAL

8.0

REAL

100.0

Valor f√≠sico de salida bajo
Rango t√©cnico
> OUT_LVAL

IN_LVAL

12.0

REAL

0.0

Valor f√≠sico de entrada alto
Rango t√©cnico
< IN_HVAL

OUT_LVAL

16.0

REAL

0.0

Valor f√≠sico de salida alto
Rango t√©cnico
< OUT_HVAL

6444

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de salida de NORM

Par√°metro

Offset

Tipo de datos Descripci√≥n

OUTV

20.0

REAL

Magnitud de salida

OVERRIDE
Descripci√≥n de OVERRIDE
La instrucci√≥n se utiliza para implementar una regulaci√≥n de invalidaci√≥n (regulaci√≥n
override).

Modo de funcionamiento
Dos reguladores PID se conectan en un actuador. Para ello se interconectan 2 instrucciones
PID a trav√©s de la instrucci√≥n OVERRIDE con la instrucci√≥n LMNGEN_C o LMNGEN_S. Si
utiliza LMNGEN_S, la realimentaci√≥n de posici√≥n debe estar activada (LMNR_ON=TRUE).
3,'

/01*(1B&6

29(55,'(
3,'B/01*

/01*B3,'

3,'B295
3,'B295

3,'

/01*B3,'

295B/01*

3,'B/01*

/01*B3,'

3,'B/01*

La instrucci√≥n compara los valores PID1_OVR y PID2_OVR y aplica el mayor o el menor.
La instrucci√≥n transmite el valor de PID1_OVR o PID2_OVR a LMN_GEN_C o LMN_GEN_S.
Si los conmutadores PID1_ON, PID2_ON no son iguales, siempre se transmite un valor. Si los
conmutadores PID1_ON, PID2_ON son iguales, se transmite el valor mayor
(OVR_MODE=FALSE) o menor (OVR_MODE=TRUE) de ambos.
PID1_ON

PID2_ON

OVR_MOD

TRUE

FALSE

no aplicable

FALSE

TRUE

FALSE

FALSE

FALSE

TRUE

TRUE

FALSE

FALSE

FALSE

TRUE

TRUE

TRUE

TRUE

Funci√≥n
PID1_OVR se transmite.
PID2_OVR se transmite.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

El valor mayor de PID1_OVR y PID2_OVR se transmite.
El valor menor de PID1_OVR y PID2_OVR se transmite.

6445

Instrucciones
4.2 Instrucciones
Si se transmite PID1_OVR, entonces QPID1=TRUE, si se transmite PID2_OVR, entonces
QPID2=TRUE.

Rearranque
La instrucci√≥n no dispone de rutina de rearranque.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de OVERRIDE

Par√°metro

Offset

Tipo de da‚Äê
tos

Ajuste pre‚Äê
determinado

Descripci√≥n

PID1_ON

0.0

BOOL

FALSE

Activar regulador 1 PID

PID2_ON

0.1

BOOL

FALSE

Activar regulador 2 PID

OVR_MODE

0.2

BOOL

FALSE

Modo de invalidaci√≥n FALSE=m√°ximo, TRUE=m√≠nimo

PID1_OVR

2.0

STRUC

PID-LMNGEN interfaz

PID2_OVR

20.0

STRUC

PID-LMNGEN interfaz

Par√°metros de salida de OVERRIDE

Par√°metro

Offset

Tipo de datos

Descripci√≥n

QPID1

38.0

BOOL

Regulador 1 PID activado

QPID2

38.1

BOOL

Regulador 2 PID activado

OVR_LMNG

40.0

STRUC

PID-LMNGEN interfaz

PARA_CTL
Descripci√≥n de PARA_CTL
La instrucci√≥n se utiliza en estructuras de regulador con conmutaciones de par√°metros cuando
se requieren par√°metros de regulaci√≥n √≥ptimos para diferentes rangos de trabajo.

Modo de funcionamiento
Se pueden transmitir varios juegos de par√°metros de regulador (GAIN, TI, TD y TM_LAG) a un
regulador PID.

6446

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
A trav√©s de los conmutadores PSET1_ON...PSET4_ON se puede transferir uno de los 4
juegos de par√°metros a las salidas GAIN, TI, TD y TM_LAG.
Si

Se aplica

PSET1_ON = TRUE

GAIN = PARASET1.GAIN
TI = PARASET1.TR
TD = PARASET1.TD
TM_LAG = PARASET1.TM_LAG

PSET2_ON = TRUE

GAIN = PARASET2.GAIN
TI = PARASET2.TR
TD = PARASET2.TD
TM_LAG = PARASET2.TM_LAG

PSET3_ON = TRUE

GAIN = PARASET3.GAIN
TI = PARASET3.TR
TD = PARASET3.TD
TM_LAG = PARASET3.TM_LAG

PSET4_ON = TRUE

GAIN = PARASET4.GAIN
TI = PARASET4.TR
TD = PARASET4.TD
TM_LAG = PARASET4.TM_LAG

Si existen dos o m√°s conmutadores en TRUE, el conmutador con el n√∫mero m√°s bajo siempre
tiene la prioridad m√°s alta. Si ning√∫n conmutador es TRUE, se transmite el primer juego de
par√°metros.
Para conseguir una conmutaci√≥n suave entre los juegos de par√°metros, en el par√°metro GAIN
hay que aplicar un generador de rampa (ROC_LIM) entre las instrucciones PID y PARA_CTL.

52&B/,0

*$,1
3$5$B&7/
7,

3,'

/01*(1B&

Rearranque
La instrucci√≥n no dispone de rutina de rearranque.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6447

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de PARA_CTL

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

PSET1_ON

0.0

BOOL

FALSE

Transferir n√∫mero 1 del registro de par√°metros

PSET2_ON

0.1

BOOL

FALSE

Transferir n√∫mero 2 del registro de par√°metros

PSET3_ON

0.2

BOOL

FALSE

Transferir n√∫mero 3 del registro de par√°metros

PSET4_ON

0.3

BOOL

FALSE

Transferir n√∫mero 4 del registro de par√°metros

PARASET1.GAIN

2.0

REAL

PARASET1.TI

6.0

TIME

5s

Tiempo de integraci√≥n 1

PARASET1.TD

10.0

TIME

10 s

Tiempo de acci√≥n derivativa 1

PARASET1.TM_LAG

14.0

TIME

2s

Tiempo de retardo 1

PARASET2.GAIN

18.0

REAL

PARASET2.TI

22.0

TIME

5s

Tiempo de integraci√≥n 2

PARASET2.TD

26.0

TIME

10 s

Tiempo de acci√≥n derivativa 2

PARASET2.TM_LAG

30.0

TIME

2s

Tiempo de retardo 2

PARASET3.GAIN

34.0

REAL

PARASET3.TI

38.0

TIME

Ganancia proporcional 1

Ganancia proporcional 2

Ganancia proporcional 3
5s

Tiempo de integraci√≥n 3

PARASET3.TD

42.0

TIME

10 s

Tiempo de acci√≥n derivativa 3

PARASET3.TM_LAG

46.0

TIME

2s

Tiempo de retardo 3

PARASET4.GAIN

500

REAL

PARASET4.TI

54.0

TIME

5s

Tiempo de integraci√≥n 4

PARASET4.TD

58.0

TIME

10 s

Tiempo de acci√≥n derivativa 4

PARASET4.TM_LAG

62.0

TIME

2s

Tiempo de retardo 4

Ganancia proporcional 4

Par√°metros de salida de PARA_CTL

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

GAIN

66.0

REAL

1.0

Ganancia proporcional

TI

70.0

TIME

10s

Tiempo de integraci√≥n

TD

74.0

TIME

5s

Tiempo de acci√≥n derivativa

TM_LAG

78.0

TIME

2s

Tiempo de retardo

6448

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

PID
Descripci√≥n de PID
La instrucci√≥n contiene el algoritmo PID para configurar los siguientes tipos de regulador:
Reguladores PID continuos:

PID + LMNGEN_C

Regulador de impulsos PID para elementos finales de
control proporcionales:

PID + LMNGEN_C + PULSEGEN

Regulador paso a paso PID para elementos finales de
control integrados:

PID + LMNGEN_S

La instrucci√≥n implementa el algoritmo PID. Tiene una estructura puramente paralela y act√∫a
exclusivamente como algoritmo de posici√≥n. Las acciones proporcional, integral y diferencial
se pueden conectar o desconectar individualmente. De este modo se pueden parametrizar
reguladores P, PI, PD y PID.
Los c√°lculos de las acciones P y D se pueden poner en la rama de realimentaci√≥n. Mediante
el desplazamiento de la acci√≥n P y D a la rama de realimentaci√≥n, el comportamiento de control
es "suave" y al mismo tiempo tiene la misma velocidad de la regulaci√≥n de las perturbaciones.
En la mayor√≠a de los casos no es necesaria la utilizaci√≥n de un integrador de consigna para
evitar saltos de consigna.
Mientras la instrucci√≥n PID se sit√∫a en un nivel de alarma c√≠clica, cuyo tiempo de ciclo est√°
adaptado a la constante de tiempo dominante en el proceso, las instrucciones que procesan
el elemento final de control (LMNGEN_C o LMNGEN_S) pueden situarse en un nivel de alarma
c√≠clica m√°s r√°pido.

Rearranque
Durante el rearranque todos los par√°metros de salida y de paso se preasignan con cero.

L√≠mites internos del bloque
El tiempo de integraci√≥n se limita en la mitad del tiempo de muestreo hacia abajo.
El tiempo de acci√≥n derivativa se limita en el tiempo de muestreo por abajo.
El tiempo de retardo se limita en la mitad del tiempo de muestreo por abajo.
TIintern = CYCLE/2

para

TI < CYCLE/2

TDintern = CYCLE

para

TD < CYCLE

TM_LAGintern = CYCLE/2

para

TM_LAG < CYCLE/2

Los valores restantes de los par√°metros de entrada no se limitan en la instrucci√≥n; no se
comprueban los par√°metros.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6449

Instrucciones
4.2 Instrucciones

Funcionamiento de PID
Estructura de regulador
Los conmutadores P_SEL, I_SEL y D_SEL hacen posibles las siguientes estructuras de
regulador:
Estructura de regulador

P_SEL

I_SEL

D_SEL

Regulaci√≥n P

TRUE

TRUE bzw. FALSE

FALSE

Regulaci√≥n PI

TRUE

TRUE

FALSE

Regulaci√≥n PD

TRUE

FALSE

TRUE

Regulaci√≥n PID

TRUE

TRUE

TRUE

Diagrama de bloques del algoritmo PID
/01*B3,'/01
/01*B3,'/015B21

3)'%B6(/


/01*B3,'$5:+/B21
/01*B3,'$5://B21

3B6(/




/01*B3,'0$1B21


,17

*$,1
(5

/,0,7(5



')'%B6(/


',)

/01*B3,'/01B+/0
',69

,B6(/


7,



/01*B3,'0$1B21
/01*B3,'/01B//0





7,,17+2/' /01*B3,'/01B+/0
,,7/B21
/01*B3,'/01B//0
,B,7/9$/

39



',69B6(/



7'70B/$*

/01B3




/01B,



3,'B/01*
3,'B2879
3,'B/01*
3,'B6&75

/01*B3,'/015B21
/01B'

'B6(/



Acci√≥n P
La acci√≥n P se puede activar o desactivar mediante el conmutador P_SEL. La acci√≥n P
representa el producto del error de regulaci√≥n ER y la ganancia proporcional GAIN. El
conmutador PFDB_SEL permite ponerla en la rama de realimentaci√≥n. Si la acci√≥n P est√°
puesta en la rama de realimentaci√≥n, es el producto entre el valor real PV y la ganancia
proporcional.

6450

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Acci√≥n I
La acci√≥n I se puede activar o desactivar mediante el conmutador I_SEL. La respuesta
temporal se determina mediante el tiempo integrativo TI. En estado desactivado la acci√≥n I y
la memoria interna de la acci√≥n I se ponen en cero. Con INT_HOLD se puede congelar la
acci√≥n I. El conmutador I_ITL_ON permite asignar el valor de la entrada I_ITLVAL a la acci√≥n
I. En el caso de l√≠mites de la variable manipulada, la acci√≥n I se mantiene en el valor antiguo
(anti reset wind-up).
En el regulador paso a paso sin realimentaci√≥n de posici√≥n rige lo siguiente: LMN_I = 0.0

Acci√≥n D
La acci√≥n D se puede activar o desactivar mediante el conmutador D_SEL. El conmutador
DFDB_SEL permite ponerla en la rama de realimentaci√≥n. La magnitud de entrada de la acci√≥n
D es ahora la magnitud de regulaci√≥n PV. La respuesta temporal se determina mediante el
tiempo derivativo TD.
Especialmente en los procesos r√°pidos y con la acci√≥n D activada puede ocurrir una oscilaci√≥n
en la se√±al de la variable manipulada. En este caso se puede mejorar el comportamiento de
regulaci√≥n con el retardo de primer orden integrado en la acci√≥n D. Normalmente suele bastar
un tiempo de retardo peque√±o TM_LAG para obtener el resultado deseado.

Control anticipativo
Se puede aplicar una magnitud perturbadora DISV adem√°s de la variable manipulada. Con el
conmutador DISV_SEL se puede activar o desactivar esta magnitud.

Par√°metros de entrada de PID

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

ER

0.0

REAL

0.0

Error de regulaci√≥n
Rango t√©cnico

PV

4.0

REAL

0.0

Magnitud de regulaci√≥n (acci√≥n P o D en la rama de realimen‚Äê
taci√≥n)
Rango t√©cnico

GAIN

8.0

REAL

1.0

Ganancia proporcional

TI

12.0

TIME

T#20s

Tiempo de integraci√≥n

I_ITLVAL

16.0

REAL

0.0

Valor de inicializaci√≥n para la acci√≥n I

TD

20.0

TIME

T#10s

Tiempo de acci√≥n derivativa

TM_LAG

24.0

TIME

T#2s

Tiempo de retardo de la acci√≥n D

DISV

28.0

REAL

0.0

Perturbaci√≥n

P_SEL

32.0

BOOL

TRUE

Activar la acci√≥n P

PFDB_SEL

32.1

BOOL

FALSE

Conectar la acci√≥n P en rama de realimentaci√≥n

Rango t√©cnico

Rango t√©cnico

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6451

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

DFDB_SEL

32.2

BOOL

FALSE

Conectar la acci√≥n D en rama de realimentaci√≥n

I_SEL

32.3

BOOL

TRUE

Activar la acci√≥n I

INT_HPOS

32.4

BOOL

FALSE

Congelar la acci√≥n I en direcci√≥n positiva

INT_HNEG

32.5

BOOL

FALSE

Congelar la acci√≥n I en direcci√≥n negativa

I_ITL_ON

32.6

BOOL

FALSE

Poner la acci√≥n I

D_SEL

32.7

BOOL

FALSE

Activar la acci√≥n D

DISV_SEL

33.0

BOOL

TRUE

Control anticipativo

SMOO_CH
G

33.1

BOOL

TRUE

Pasar de forma suave del modo manual al modo autom√°tico

COM_RST

33.2

BOOL

FALSE

Rearranque

CYCLE

34.0

TIME

T#1s

Tiempo de muestreo

LMNG_PID

38.0

STRUC

‚â• 1ms
Interfaz PID-LMNGEN

Par√°metros de salida PID

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

LMN_P

56.0

REAL

0.0

Acci√≥n P

LMN_I

60.0

REAL

0.0

Acci√≥n I

LMN_D

64.0

REAL

0.0

Acci√≥n D

PID_LMNG

68.0

STRUC

Interfaz PID-LMNGEN

PULSEGEN_M
Descripci√≥n de PULSEGEN_M
La instrucci√≥n PULSEGEN_M se utiliza para crear un regulador PID con salida de impulsos
para actuadores de acci√≥n proporcional. La instrucci√≥n PULSEGEN_M permite generar
reguladores PID de dos o tres puntos con modulaci√≥n de ancho de impulsos. La instrucci√≥n se
aplica casi siempre en combinaci√≥n con el regulador continuo PID + LMNGEN_C.
La siguiente figura muestra la interconexi√≥n de las instrucciones.
/01*(1B&

3,'

&

/01

38/6(*(1
,19

4326B3
41(*B3

/01*B3,'
/01*B3,'

6452

3,'B/01*

3,'B/01*

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Rearranque
Durante el rearranque todas las salidas de se√±al se ponen en cero.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Funcionamiento de PULSEGEN_M
Modulaci√≥n de ancho de impulsos
PULSEGEN_M transforma la magnitud de entrada INV (= LMN del regulador PID) mediante
modulaci√≥n del ancho de impulsos en un tren de impulsos con una duraci√≥n de per√≠odo
constante PER_TM. La duraci√≥n del per√≠odo equivale al tiempo de ciclo con el que se actualiza
la magnitud de entrada. La duraci√≥n de un impulso por duraci√≥n de per√≠odo es proporcional a
la magnitud de entrada. El ciclo parametrizado con PER_TM no es id√©ntico al ciclo de
ejecuci√≥n de la instrucci√≥n PULSEGEN_M. Es m√°s, un ciclo PER_TM est√° compuesto por
varios ciclos de ejecuci√≥n de la instrucci√≥n PULSEGEN_M, y la cantidad de llamadas de
PULSEGEN_M por ciclo PER_TM representa una medida para la precisi√≥n del ancho de
impulso.
,19

/01






W


4326B3


W


&<&/(
3(5B70

As√≠, una magnitud de entrada del 30 % y 10 llamadas de PULSEGEN por PER_TM significan:
‚óè "uno" en la salida QPOS_P para las tres primeras llamadas de PULSEGEN_M (30% de 10
llamadas)
‚óè "cero" en la salida QPOS_P para otras siete llamadas de PULSEGEN_M (70% de 10
llamadas)
Duraci√≥n m√≠nima de impulso o de pausa
La correcta parametrizaci√≥n de la duraci√≥n m√≠nima de impulso o pausa P_B_TM puede impedir
tiempos de conexi√≥n o desconexi√≥n cortos, que merman la vida √∫til de los actuadores. Se
suprimen valores absolutos peque√±os de la magnitud de entrada LMN que generar√≠an una

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6453

Instrucciones
4.2 Instrucciones
duraci√≥n de impulso inferior a P_B_TM. Los valores de entrada grandes que generar√≠an una
duraci√≥n de impulso superior a PER_TM - P_B_TM se ajustan a 100 % o a -100 %.
Deben regir la f√≥rmula siguiente: P_B_TM ‚â§ 0,1 √ó PER_TM



7LHPSRP¬ØQGHFRQH[L¬µQ

7LHPSRP¬ØQGHGHVFRQH[L¬µQ

3B%B70
3(5B70

3B%B70
3(5B70

3(5B70

La duraci√≥n de los impulsos positivos o negativos se calcula multiplicando la magnitud de
entrada (en %) por la duraci√≥n del per√≠odo:
Duraci√≥n de impulso = INV / 100 * PER_TM

Precisi√≥n de la modulaci√≥n de ancho de impulsos
Mientras que el regulador continuo PID+LMGEN_C se posiciona en un nivel de alarma c√≠clica
lento cuyo tiempo de ciclo se adapta a la constante dominante de tiempo del proceso,
PULSEGEN_M debe posicionarse en un nivel de alarma c√≠clica m√°s r√°pido.
Con una "relaci√≥n de muestreo" de 1:10 (llamadas del regulador respecto a llamadas de
PULSEGEN_M) la precisi√≥n de la variable manipulada se limita al 10%, es decir, los valores de
entrada especificados INV solo se pueden mapear con una precisi√≥n del 10% en una duraci√≥n
de impulso en la salida QPOS_P.
La precisi√≥n aumenta con el n√∫mero de llamadas de PULSEGEN_M por cada llamada del
regulador.
Cuanto m√°s r√°pido es el nivel de alarma c√≠clica, tanto mayor puede ser la precisi√≥n de la
variable manipulada emitida. En caso de un nivel de alarma c√≠clica 100 veces m√°s r√°pido, se
obtendr√° una resoluci√≥n de 1 % del rango de la variable manipulada.

Sincronizaci√≥n autom√°tica
La salida de impulsos se puede sincronizar autom√°ticamente con la instrucci√≥n del regulador.
As√≠ se garantiza que un valor modificado de la magnitud manipulada LMN(t) se emita lo m√°s
r√°pido posible como duraci√≥n de impulso modificada proporcionalmente de la se√±al binaria.
El formador de impulsos eval√∫a la magnitud de entrada INV en intervalos de la duraci√≥n de
per√≠odo PER_TM. Pero como INV se calcula en un nivel de alarma c√≠clica m√°s lento, el
formador de impulsos deber√≠a iniciar la transformaci√≥n del valor discreto en una se√±al de
impulso con la mayor rapidez posible tras la actualizaci√≥n de INV. Para ello, la instrucci√≥n
puede sincronizar por s√≠ misma el inicio del per√≠odo seg√∫n el siguiente procedimiento. Si INV
ha cambiado y la llamada de bloque no se encuentra en el primer ciclo de llamada o en los dos
√∫ltimos ciclos de un per√≠odo, se realiza una sincronizaci√≥n. La duraci√≥n de impulso se calcula
de nuevo, y en el siguiente ciclo se inicia la emisi√≥n con un nuevo per√≠odo.
La duraci√≥n de per√≠odo PER_TM debe corresponder al tiempo de muestreo CYCLE del
regulador.

6454

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
/01 ,19 

/01 ,19 

/01 ,19 

3URFHVDPLHQWRGH3,'B&


W

&<&/(GH3,'B&
,QLFLRGHOSHU¬ØRGR













































W

3(5B70

&<&/(GH
38/6(*(1

3(5B70

6LQFURQL]DFL¬µQGHOLQLFLRGH
SHU¬ØRGR
38/6(*(1UHFRQRFH,19KD
FDPELDGR\ODOODPDGDQRHVW¬£HQ
HOSULPHURRHQORVGRV¬ºOWLPRV
FLFORVGHOSHULRGR

3URFHVDPLHQWRGH38/6(*(1

1RHVQHFHVDULDQLQJXQD
VLQFURQL]DFL¬µQ
38/6(*(1UHFRQRFH,19KD
FDPELDGRD¬µ\OD
OODPDGDHVW¬£HQHOSULPHURRHQ
ORVGRV¬ºOWLPRVFLFORVGHOSHULRGR

3URFHVDPLHQWRGH38/6(*(1HQHOSULPHURORVGRV
¬ºOWLPRVFLFORVGHOSHULRGR

La sincronizaci√≥n autom√°tica se desactiva con SYN_ON = FALSE.
Nota
Con el inicio del periodo nuevo, el valor antiguo de INV (es decir, de LMN) se representa en la
se√±al de impulso de manera m√°s o menos precisa una vez concluida la sincronizaci√≥n.

Modos de operaci√≥n PULSEGEN_M
Modos de operaci√≥n
Dependiendo de la parametrizaci√≥n del formador de impulsos, los reguladores PID se pueden
configurar con comportamiento de tres puntos o con salida de dos puntos bipolar o unipolar. La
siguiente tabla contiene los ajustes de las combinaciones de conmutadores para los modos de
operaci√≥n posibles.
Modo de operaci√≥n

MAN_ON

STEP3_ON

ST2BI_ON

Regulaci√≥n de tres puntos

FALSE

TRUE

cualquiera

Regulaci√≥n de dos puntos con rango de valores

FALSE

FALSE

TRUE

FALSE

FALSE

FALSE

TRUE

cualquiera

cualquiera

Rango de ajuste (-100 % ... 100 %)
Regulaci√≥n de dos puntos con rango de valores
Rango de ajuste (0 % ... 100 %)
Modo manual

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6455

Instrucciones
4.2 Instrucciones

Modo manual en la regulaci√≥n de dos o de tres puntos
En el modo manual (MAN_ON = TRUE) las salidas binarias del regulador de tres puntos o del
regulador de dos puntos pueden activarse independientemente de INV a trav√©s de las se√±ales
POS_P_ONy NEG_P_ON.
326B3B21

6<1B21
67(3B21
67%,B21

1(*B3B21
0$1B21




4326B3
,19

41(*B3


3(5B70
3B%B70
5$7,2)$&

Regulaci√≥n

POS_P_ON

NEG_P_ON

QPOS_P

QNEG_P

Regulaci√≥n de tres
puntos

FALSE

FALSE

FALSE

FALSE

TRUE

FALSE

TRUE

FALSE

FALSE

TRUE

FALSE

TRUE

TRUE

TRUE

FALSE

FALSE

FALSE

cualquiera

FALSE

TRUE

TRUE

cualquiera

TRUE

FALSE

Regulaci√≥n de dos
puntos

Regulaci√≥n de tres puntos PULSEGEN_M
Regulaci√≥n de tres puntos
En el modo de operaci√≥n "Regulaci√≥n de tres puntos" es posible generar tres estados de la
se√±al manipulada, p. ej. m√°s - apagado - menos, adelante - parado - atr√°s, calentar - apagado
- enfriar. Para ello se asignan los valores de estado de las se√±ales binarias de salida QPOS_P
y QNEG_P a los correspondientes estados operativos del actuador. La tabla muestra el
ejemplo de una regulaci√≥n de temperatura:
Se√±ales de salida

Calentar

OFF

Enfriar

QPOS_P

TRUE

FALSE

FALSE

QNEG_P

FALSE

FALSE

TRUE

A partir de la magnitud de entrada se calcula la duraci√≥n del impulso mediante una
caracter√≠stica. La forma de esta caracter√≠stica est√° definida por la duraci√≥n m√≠nima de impulso

6456

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
o de pausa y por el factor de relaci√≥n. El valor normal del factor de relaci√≥n es 1. Los puntos
escalonados de las caracter√≠sticas son originados por la duraci√≥n m√≠nima de impulso o de
pausa P_B_TM.
La siguiente figura muestra una caracter√≠stica sim√©trica del regulador de tres puntos (factor de
relaci√≥n = 1)
'XUDFL¬µQGHOLPSXOVR
SRVLWLYR
FRQWLQXDPHQWHFRQHFWDGR
3(5B70
3(5B703B%B70



3B%B70

FRQWLQXDPHQWHGHVFRQHFWDGR



'XUDFL¬µQGHOLPSXOVRQHJDWLYR

Regulaci√≥n de tres puntos asim√©trica
A trav√©s del factor de relaci√≥n RATIOFAC puede modificarse la relaci√≥n de la duraci√≥n de
impulsos positivos respecto a los negativos. Durante un lazo de regulaci√≥n de temperatura,
ello permite tener en cuenta p. ej. constantes temporales de proceso distintas para calentar y
enfriar.
Factor de relaci√≥n < 1
A la duraci√≥n de impulso obtenida de la multiplicaci√≥n de la magnitud de entrada por la
duraci√≥n del per√≠odo en la salida de impulsos negativa se le resta el factor de relaci√≥n.
Duraci√≥n de impulso positiva = INV /100 * PER_TM
Duraci√≥n de impulso negativa = INV / 100 * PER_TM * RATIOFAC
La duraci√≥n de impulso negativa se multiplica por el factor de relaci√≥n.
La siguiente figura muestra una caracter√≠stica asim√©trica del regulador de tres puntos (factor
de relaci√≥n = 0.5)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6457

Instrucciones
4.2 Instrucciones
'XUDFL¬µQGHOLPSXOVR
SRVLWLYR
3(5B70
3(5B703B%B70



3B%B70
 3B%B70



  3(5B703B%B70
 3(5B70

'XUDFL¬µQGHOLPSXOVR
QHJDWLYR

El factor de relaci√≥n RATIOFAC influye sobre la duraci√≥n m√≠nima de impulso o de pausa. El
valor de reacci√≥n para impulsos negativos se multiplica por el factor de relaci√≥n.
Factor de relaci√≥n > 1
A la duraci√≥n de impulso obtenida de la multiplicaci√≥n de la magnitud de entrada por la
duraci√≥n del per√≠odo en la salida de impulsos positiva se le resta el factor de relaci√≥n.
Duraci√≥n de impulso positiva = INV / 100 * PER_TM / RATIOFAC
Duraci√≥n de impulso negativa = INV / 100 * PER_TM
El factor de relaci√≥n RATIOFAC influye sobre la duraci√≥n m√≠nima de impulso o de pausa. El
valor de reacci√≥n para impulsos positivos se divide por el factor de relaci√≥n.

Regulaci√≥n de dos puntos PULSEGEN_M
En la regulaci√≥n de dos puntos solo se conecta la salida de impulsos positiva QPOS_P de
PULSEGEN_M al actuador de conexi√≥n/desconexi√≥n en cuesti√≥n. Seg√∫n cu√°l sea el rango
utilizado de la variable manipulada, el regulador de dos puntos tiene un rango bipolar o
unipolar.
Regulaci√≥n de dos puntos con rango de variable manipulada bipolar (-100% ... 100%)

6458

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
'XUDFL¬µQGHOLPSXOVRSRVLWLYR

FRQWLQXDPHQWH
FRQHFWDGR

3(5B70
3(5B703B%B70

FRQWLQXDPHQWH
GHVFRQHFWDGR
3B%B70






Regulaci√≥n de dos puntos con rango de variable manipulada unipolar (0%...100%)
'XUDFL¬µQGHOLPSXOVRSRVLWLYR
3(5B70
3(5B703B%B70

3B%B70




En QNEG_P est√° disponible la se√±al de salida negada, si la interconexi√≥n del regulador de dos
puntos en el lazo de regulaci√≥n exige una se√±al binaria invertida l√≥gicamente para los impulsos
de la se√±al manipulada.
Impulso

Actuador ON

Actuador OFF

QPOS_P

TRUE

FALSE

QNEG_P

FALSE

TRUE

Par√°metros de entrada de PULSEGEN_M

Par√°metro

Offset

Tipo de datos

Asignaci√≥n previa

Descripci√≥n

INV

0.0

REAL

0.0

Variable de entrada
-100.0..100.0 (%)

PER_TM

4.0

TIME

T#1s

Duraci√≥n de per√≠odo
PER_TM >= 20*CYCLE

P_B_TM

8.0

TIME

T#50ms

Duraci√≥n m√≠nima del impulso o duraci√≥n m√≠nima de
pausa
P_B_TM >= CYCLE

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6459

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de datos

Asignaci√≥n previa

Descripci√≥n

RATIOFAC

12.0

REAL

1.0

Factor de relaci√≥n
0.1..10.0
(sin dimensi√≥n)

STEP3_ON

16.0

BOOL

TRUE

Activar la regulaci√≥n de tres puntos

ST2BI_ON

16.1

BOOL

FALSE

Activar la regulaci√≥n de dos puntos para el rango de
la variable manipulada bipolar

MAN_ON

16.2

BOOL

FALSE

Activar el modo manual

POS_P_ON

16.3

BOOL

FALSE

Activar impulso positivo

NEG_P_ON

16.4

BOOL

FALSE

Activar impulso negativo

SYN_ON

16.5

BOOL

TRUE

Activar sincronizaci√≥n

COM_RST

16.6

BOOL

FALSE

Rearranque

CYCLE

18.0

TIME

T#10ms

Tiempo de muestreo
CYCLE >= 1ms

Par√°metros de salida de PULSEGEN_M

Par√°metro

Offset

Tipo de datos Asignaci√≥n pre‚Äê Descripci√≥n
via

QPOS_P

22.0

BOOL

FALSE

Se√±al de salida del impulso positivo

QNEG_P

22.1

BOOL

FALSE

Se√±al de salida del impulso negativo

RMP_SOAK
Descripci√≥n de RMP_SOAK
Con la instrucci√≥n RMP_SOAK se preasignan diferentes consignas fundamentalmente en
funci√≥n del desarrollo temporal del proceso.

Modo de funcionamiento
En un bloque de datos global se depositan los nodos de la curva de desplazamiento. En cada
llamada de la instrucci√≥n se emite la consigna v√°lida en ese momento.
Bloque de datos global DB_RMPSK (P√°gina 6467) no est√° incluido en la librer√≠a. Debe crear
usted mismo este bloque de datos global.
El n√∫mero de nodos se introduce en el bloque de datos global, en la variable NBR_PTS. El
n√∫mero del bloque global se introduce en el par√°metro de entrada DB_NBR.
Para cada nodo se especifica la consigna en PI[i].OUTV y el tiempo en PI[i].TMV.
Ejemplo de curva de desplazamiento con punto de inicio y nodos.

6460

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
2879
3,>@2879
3,>@2879
3,>@2879
3,>@2879




2879 W









3,>@709

3,>@709

3,>@2879 
3,>@2879
3,>@709
3,>@709

3,>@709
3,>@709

3,>@709

W

PV

Con n nodos el valor de tiempo para el nodo es n=0 ms.
El modo de contar los valores y tiempos de los nodos se muestra en la siguiente imagen:
2879

3,>@2879
1RGR 3,>@709
1RGR

3,>@2879

3,>@2879

3,>@709

3,>@709

3XQWRLQLFLDO
3,>@709

3,>@709

3,>@709
W

Entre los nodos el generador ramp soak interpola con 0 ‚â§ n < (NBR_PTS - 1) seg√∫n la siguiente
funci√≥n:
2879 W  3,>Q@2879

56B70
3,>Q@709

3,>Q@28793,>Q@2879

Nota
La instrucci√≥n no comprueba si existe realmente un bloque de datos global con el n√∫mero
DB_NBR, ni si el par√°metro DB_NBR.NBR_PTS (n√∫mero de nodos) concuerda con la longitud
del bloque de datos. Si no se ha realizado la parametrizaci√≥n correctamente, la CPU cambia
al estado de funcionamiento STOP mostrando el mensaje "Error interno del sistema".

Funciones del generador ramp soak
La instrucci√≥n dispone de las funciones siguientes:
‚óè Activar generador ramp soak para ejecuci√≥n √∫nica
‚óè Preasignar salida del generador ramp soak con valor fijo
‚óè Activar modo c√≠clico del generador ramp soak
‚óè Detener procesamiento del generador ramp soak

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6461

Instrucciones
4.2 Instrucciones
‚óè Predeterminar paso y tiempo de procesamiento (el tiempo residual RS_TM y el n√∫mero de
nodo TM_SNBR se determinan de nuevo)
‚óè Actualizar tiempo total de procesamiento y tiempo residual total
Para ajustar el modo de operaci√≥n deseado se aplica la valencia de las entradas de control
especificada en la siguiente tabla:
Modo de operaci√≥n

RMPSK_
ON

DFOUT_ RMP_
ON
HOLD

CONT_
ON

CYC_
ON

TUPDT_
ON

Se√±al de salida OUTV

Activar generador ramp
soak

TRUE

FALSE

**)

FALSE

**)

OUTV(t)

Preasignar salida

TRUE

TRUE

**)

**)

**)

**)

DF_OUTV

Activar modo c√≠clico

TRUE

FALSE

FALSE

**)

TRUE

**)

OUTV(t)

FALSE

El valor final se mantiene
tras el final de procesamien‚Äê
to.

Tras final: arranque auto‚Äê
m√°tico
Detener generador
ramp soak

TRUE

FALSE

TRUE

FALSE

**)

**)

se mantiene el valor actual
de OUTV(t) *)

Predeterminar el paso y TRUE
tiempo de procesamien‚Äê
to

FALSE

TRUE

TRUE

**)

**)

OUTV (antiguo) *)

Actualizar tiempo total

**)

**)

FALSE
**)

Se sigue con los nuevos va‚Äê
lores predeterminados.
**)

**)

FALSE

No influye en OUTV

TRUE

No influye en OUTV

*) Hasta el pr√≥ximo nodo la curva no tiene la forma parametrizada por el usuario.
**) El modo de operaci√≥n ajustado en cada caso se ejecuta independientemente de la valencia de las se√±ales de control en
los campos marcados con **)

Rearranque
En el rearranque la salida OUTV se pone a 0.0. Con DFOUT_ON=TRUE, la salida es
DF_OUTV. Los intervalos (0 bis NBRPTS-1) entre los nodos 0 hasta NBRPTS se suman y se
ponen disponibles en T_TM. La salida QR_S_ACT se resetea; las salidas NBR_ATMS y
RS_TM se preasignan con 0.

Activar el generador ramp soak
Un flanco ascendente en RMPSK_ON activa la funci√≥n de generador ramp soak. Despu√©s de
haber llegado al √∫ltimo nodo se termina la curva. Para volver a iniciar el generador ramp soak,
primero ajuste RMPSK_ON = FALSE y a continuaci√≥n RMPSK_ON = TRUE.

6462

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Preasignar salida, iniciar curva
Para que la curva de desplazamiento comience con un valor de salida determinado, es
necesario que DFOUT_ON = TRUE. En ese caso en la salida del generador ramp soak se
deposita el valor de se√±al DF_OUTV.
Nota
La se√±al para la emisi√≥n de la consigna constante DFOUT_ON tiene mayor prioridad que la
se√±al de inicio para el generador ramp soak RMPSK_ON.
Tras la conmutaci√≥n DFOUT_ON = FALSE, OUTV se lleva linealmente de la consigna ajustada
(DF_OUTV) al valor de salida del n√∫mero de nodo actual PI[NBR_ATMS].OUTV.
El procesamiento interno de tiempo tambi√©n contin√∫a con una consigna fija aplicada
directamente (RMPSK_ON = TRUE y DFOUT_ON = TRUE).
Al iniciar la curva RMPSK_ON = TRUE se emite la consigna fija DF_OUTV hasta que
DFOUT_ON cambia de TRUE a FALSE despu√©s del tiempo T*.
5036.B21
')287B21
2879

&XUYDFRQILJXUDGD


')B2879





2879 W




3,>@709
7
45B6B$&7

&XUYDDFWXDO



3,>@709
3,>@709
3,>@709
3,>@709


3,>@709

W
PV
3,>@709

3,>@709

En este momento ha transcurrido el tiempo PI[0].TMV y parte del tiempo PI[1].TMV. OUTV se
lleva de DF_OUTV a PI[2].OUTV, es decir, a la consigna del nodo 2.
La curva configurada se emite solo a partir del nodo 2. La coincidencia entre la curva
configurada y la actual se indica con QR_S_ACT = TRUE. Con un flanco ascendente en
DFOUT_ON durante el procesamiento de la curva, el valor de la salida OUTV salta sin retardo
a DF_OUTV.

Modo c√≠clico activado
Cuando el modo de operaci√≥n 'Repetici√≥n c√≠clica' (CYC_ON = TRUE) est√° activado, el
generador ramp soak vuelve autom√°ticamente al punto inicial tras emitir el √∫ltimo valor de nodo
y se ejecuta de nuevo.
Entre el √∫ltimo nodo y el punto inicial no se interpola. Para una transici√≥n sin discontinuidad se
debe aplicar lo siguiente: PI[NBR_PTS].OUTV = PI[0].OUTV.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6463

Instrucciones
4.2 Instrucciones

Detener generador ramp soak
Con RMP_HOLD = TRUE se congela el valor de la magnitud de salida (incluido el
procesamiento de tiempo). Cuando RMP_HOLD = FALSE se desactiva, PI[x].TMV contin√∫a en
el punto de interrupci√≥n.
El tiempo de procesamiento de la curva se prolonga por el tiempo T*. La curva presenta el
desarrollo configurado desde el nodo hasta el flanco ascendente en RMP_HOLD y desde el
nodo 5* hasta el nodo 6*, es decir, la se√±al de salida QR_S_ACT tiene el valor TRUE.
503B+2/'
')287B21
7

2879


&XUYDFRQILJXUDGD
&XUYDDFWXDO



9DORUHVDFWXDOHV

2879 W
')B2879













7
W

3,>@709

3,>@709
3,>@709
3,>@709
3,>@709

7LHPSRFRQILJXUDGR

7LHPSRDFWXDO

3,>@709

3,>@709

3,>@7097 3,>@709

45B6B$&7

Predeterminar el paso y tiempo de procesamiento
Con CONT_ON se contin√∫a una curva detenida en un punto definido. Si el generador ramp
soak no est√° detenido, CONT_ON no tiene efecto.
Si la entrada de control para continuar CONT_ON = TRUE est√° activada, el generador ramp
soak detenido contin√∫a en el nodo TM_SNBR. TM_CONT determina el tiempo residual que
requiere el generador hasta que se alcanza el nodo TM_SNBR.
La siguiente figura muestra la influencia de RMP_HOLD y CONT_ON en:
TM_SNBR = 5 y TM_CONT = T*

6464

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
c6LQUHVSXHVWD
&217B21
503B+2/'
2879

&XUYDFRQILJXUDGD

7


&XUYDDFWXDO



9DORUHVDFWXDOHV
2879 W












W

3,>@709
7LHPSRFRQILJXUDGR

45B6B$&7

3,>@709
3,>@709
3,>@709
7

3,>@709

3,>@709

3,>@709

3,>@709

7LHPSRDFWXDO

En este ciclo del generador ramp soak se prescinde de los nodos 3 y 4.
Despu√©s del cambio de se√±al RMP_HOLD de TRUE a FALSE, el desarrollo de la curva
configurado s√≥lo se vuelve a alcanzar a partir del nodo 5.

Actualizar el tiempo total y el tiempo residual total
En cada ciclo se actualizan el n√∫mero actual del nodo NBR_ATMS, el tiempo residual actual
hasta alcanzar el nodo RS_TM, el tiempo total T_TM y el tiempo residual total hasta alcanzar
el final de la curva RT_TM.
En caso de modificaciones online de PI[n].TMV, cambian el tiempo total y el tiempo residual
total de la curva. Ya que el c√°lculo de T_TM y RT_TM prolonga considerablemente el tiempo
de procesamiento del bloque de funci√≥n en muchos nodos, este solo se realiza despu√©s del
rearranque o si TUPDT_ON = TRUE. Los intervalos PI[0 ... NBR_PTS].TMV entre los
diferentes nodos se suman y se muestran en la salida del tiempo total T_TM y del tiempo
residual total RT_TM.
Tenga en cuenta que el c√°lculo de los tiempos totales requiere mucho tiempo de ejecuci√≥n de
la CPU.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6465

Instrucciones
4.2 Instrucciones

Par√°metros de entrada RMP_SOAK

Par√°metro

Offset

Tipo de datos

Asignaci√≥n
previa

Descripci√≥n

DF_OUTV

0.0

REAL

0.0

Preasignaci√≥n de la magnitud de salida
Rango t√©cnico

DB_NBR

4.0

BLOCK_DB

DB 1

N√∫mero de bloque de datos, global (valores de nodos)
Seg√∫n la CPU

TM_SNBR

6.0

INT

0

N√∫mero del pr√≥ximo nodo para continuar
0 - 255

TM_CONT

8.0

TIME

T#0s

Tiempo sobrante para continuar hasta el nodo TM_SNBR
Rango t√©cnico

DFOUT_ON

12.0

BOOL

FALSE

Activar la preasignaci√≥n de la magnitud de salida

RMPSK_ON

12.1

BOOL

FALSE

Activar el generador ramp soak

HOLD

12.2

BOOL

FALSE

Congelar la magnitud de salida

CONT_ON

12.3

BOOL

FALSE

Continuar

CYC_ON

12.4

BOOL

FALSE

Activar repetici√≥n c√≠clica

TUPDT_ON

12.5

BOOL

FALSE

Calcular de nuevo el tiempo total tras modificar los valores
temporales (tiempo de funcionamiento del bloque prolongado).

COM_RST

12.6

BOOL

FALSE

Rearranque

CYCLE

14.0

TIME

T#1s

Tiempo de muestreo
Rango t√©cnico ‚â• 1ms

Par√°metros de salida RMP_SOAK

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

OUTV

18.0

REAL

0.0

Magnitud de salida

QR_S_ACT

22.0

BOOL

FALSE

Procesando tabla de tiempo

NBR_ATMS

24.0

INT

0

N√∫mero del nodo actual (nodo que se arranca)

RS_TM

26.0

TIME

T#0s

Tiempo sobrante actual

T_TM

30.0

TIME

T#0s

Datos globales: tiempo total Œ£TMVI

RT_TM

34.0

TIME

T#0s

Datos globales: tiempo sobrante total Œ£TMVI

Los nodos y el n√∫mero de los nodos NBRPTS se guardan en un bloque de datos global
DB_NBR. La emisi√≥n empieza con el nodo 0 y termina con el nodo NBR_PTS.

6466

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Bloque de datos global DB_RMPSK
Los nodos para el generador ramp soak (RMP_SOAK) se preasignan en un bloque de datos
global. Este bloque de datos global no est√° incluido en la librer√≠a. Debe crear usted mismo este
bloque de datos global seg√∫n el esquema siguiente y adaptarlo a su aplicaci√≥n.
Par√°metro

Tipo de da‚Äê
tos

Ajuste predeter‚Äê
minado

Descripci√≥n

NBR_PTS

INT

4

N√∫mero de nodos -1
1 - 255

PI

Array
[0...NBR_P
TS] of Struct

PI[0].OUTV

REAL

Estructura de los datos de los nodos. La matriz debe ser declarada por
0...NBR_PTS.
0.0

Valor de salida [0] punto inicial
Rango t√©cnico

PI[0].TMV

TIME

T#1s

Valor temporal [0] punto inicial

PI[1].OUTV

REAL

0.0

Valor de salida [1] nodo 1

PI[1].TMV

TIME

T#1s

Valor temporal [1] nodo 1

PI[2].OUTV

REAL

0.0

Valor de salida [2] nodo 2

Rango t√©cnico

Rango t√©cnico
PI[2].TMV

TIME

T#1s

Valor temporal [2] nodo 2

PI[3].OUTV

REAL

0.0

Valor de salida [3] nodo 3
Rango t√©cnico

PI[3].TMV

TIME

T#1s

Valor temporal [3] nodo 3

PI[4].OUTV

REAL

0.0

Valor de salida [4] nodo 4

PI[4].TMV

TIME

T#0s

Rango t√©cnico
Valor temporal [4] nodo 4
0 ms

Alternativamente, puede generar el bloque de datos global mediante un archivo fuente
externo. Para ello siga los siguientes pasos:
1. Copie el texto que figura m√°s abajo en el portapapeles.
2. Abra un editor de texto externo.
3. Pegue el texto del portapapeles en el editor de texto.
4. Guarde el archivo con la extensi√≥n ".DB".
5. Abra la carpeta "Fuentes externas" en el √°rbol del proyecto del TIA Portal.
6. Haga doble clic en el comando "Agregar nuevo archivo externo".
Se abrir√° el cuadro de di√°logo "Abrir".
7. Navegue hasta el archivo fuente externo que ha creado previamente y selecci√≥nelo.
8. Confirme la selecci√≥n con "Abrir".
9. Seleccione el archivo fuente externo.
10.En el men√∫ contextual, seleccione el comando "Generar bloques a partir de fuente".

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6467

Instrucciones
4.2 Instrucciones
11.Una consulta de seguridad le informar√° de que se sobrescribir√°n los bloques que puedan
estar presentes.
12.Confirme la consulta de seguridad con "Aceptar".
13.Adapte el bloque de datos generado a su aplicaci√≥n.
DATA_BLOCK "DB_RMPSK"
TITLE = data block ramp soak
{ S7_Optimized_Access := 'FALSE' }
NAME : DB_RMPSK
STRUCT
NBR_PTS : Int; // number of points (excluding starting point)
PI : Array[0..4] of Struct
OUTV : Real; // output variable
TMV : Time; // output time value
END_STRUCT;
END_STRUCT;

BEGIN
NBR_PTS := 4;
PI[0].TMV := T#1s;
PI[1].TMV := T#1s;
PI[2].TMV := T#1s;
PI[3].TMV := T#1s;
PI[4].TMV := T#0s;
END_DATA_BLOCK

ROC_LIM
Descripci√≥n de ROC_LIM
Las funciones de rampa se utilizan cuando el proceso no tolera un escal√≥n de entrada. Esto
caso se aplica por ejemplo cuando entre el motor y la carga que se desea mover se
interconecta una transmisi√≥n y un aumento demasiado r√°pido de revoluciones causar√≠a una
sobrecarga de la transmisi√≥n. La instrucci√≥n limita la velocidad de cambio de un valor de salida.
Las funciones de escal√≥n se convierten en funciones de rampa.

6468

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Modo de funcionamiento
Para el rango de valores positivo y negativo de la magnitud de entrada INV pueden
parametrizarse hasta cuatro rampas que se utilizan para determinar la magnitud de salida:
‚óè UPRLM_P: valores ascendentes en el rango positivo
OUTV > 0 y |OUTV| ascendentes
‚óè DNRLM_P: valores descendentes en el rango positivo
OUTV > 0 y |OUTV| descendentes
‚óè UPRLM_N: valores ascendentes en el rango negativo
OUTV < 0 y |OUTV| ascendentes
‚óè DNRLM_N: valores descendentes en el rango negativo
OUTV < 0 y |OUTV| descendentes
,19
2879
+B/0
835/0B3

'15/0B3

,19 W

2879 W

835/0B3


835/0B1

W

'15/0B1

'15/0B1

/B/0

Los valores de las rampas parametrizados se refieren a una rampa de subida/bajada de la
magnitud de salida por segundo.
Si UPRLM_P = 10.0 e |INV| es creciente, OUTV puede aumentar como m√°ximo 10.0 en 1 s.
Si la magnitud de entrada es superior, OUTV aumenta del siguiente modo en cada llamada en
funci√≥n del tiempo de muestreo CYCLE:
CYCLE [s]
1

Aumento de OUTV
10.0

0.1

1.0

0.01

0.1

La limitaci√≥n de la velocidad de cambio se muestra en QUPRLM_P, QDNRLM_P, QUPRLM_N
y QDNRLM_N.
La magnitud de salida puede limitarse con H_LM y L_LM. Eso se indica en QH_LM y QL_LM.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6469

Instrucciones
4.2 Instrucciones

Funciones de la instrucci√≥n
A trav√©s de los par√°metros DFOUT_ON, TRACK y MAN_ON se puede influir en el
funcionamiento.
‚óè DFOUT_ON = TRUE
Si DFOUT_ON = TRUE est√° activado, DF_OUTV se deposita en la salida OUTV; con flanco
negativo OUTV se lleva de DF_OUTV a INV y con flanco positivo OUTV se lleva de INV a
DF_OUTV.
‚óè TRACK = TRUE
Para la correcci√≥n de OUTV = INV se activa el bit TRACK = TRUE; ya que la magnitud de
entrada se conecta directamente con la magnitud de salida, tambi√©n se emiten los
escalones de la magnitud de entrada.
‚óè MAN_ON = TRUE
MAN_ON = TRUE posibilita la conmutaci√≥n suave del modo manual al autom√°tico. Para
ello la instrucci√≥n ROC_LIM debe integrarse en la rama de la consigna directamente antes
del error de regulaci√≥n. En la entrada PV se interconecta el valor real y en la entrada
MAN_ON el bit manual-autom√°tico, es decir LMNGEN_C.MAN_ON.
52&B/,0
63

,19

3,'
2879



(5

39
/01*(1B&0$1B21

0$1B21

39

Al cambiar al modo de operaci√≥n manual MAN_ON = TRUE, el valor presente en la entrada
PV se traslada directamente a la salida OUTV. Dado que la consigna y el valor real son
iguales, el error de regulaci√≥n se pone en cero y el regulador est√° en un estado de reposo
estacionario. Al regresar al modo autom√°tico MAN_ON = FALSE, la salida OUTV va desde
el valor presente en ese momento PV en rampa hasta el valor de entrada INV. Eso provoca
un cambio suave de la estructura del regulador del modo manual al autom√°tico.
En caso de MAN_ON = TRUE las limitaciones H_LM y L_LM no son efectivas, DFOUT_ON
no se tiene en cuenta.

6470

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Ejemplo 1
Con MAN_ON, TRACK, DFOUT_ON igual a FALSE , resultan los siguientes desarrollos de las
salidas de se√±al:
,19
2879
+B/0
,19 W


2879 W

W

/B/0

4+B/0
4/B/0
4835/0B3
4'15/0B3
4'15/0B1
4835/0B1

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6471

Instrucciones
4.2 Instrucciones

Ejemplo 2
Conmutaci√≥n suave de manual a autom√°tico
0$1B21
75$&.
')287B21
,19
2879
+B/0
,19 W

2879 W

')B2879


W

39 W

/B/0

4+B/0
4/B/0
4835/0B3
4'15/0B3
4'15/0B1
4835/0B1

6472

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Ejemplo 3
Rampa que s√≥lo se utiliza en el rango positivo.
,19
2879

+B/0
,19 W

2879 W



/B/0



W

4+B/0
4/B/0
4835/0B3
4'15/0B3
4835/0B1
4'15/0B1

Rearranque
En el rearranque la salida OUTV se pone a 0.0. Si est√° activado DFOUT_ON = TRUE, se emite
DF_OUTV. Todas las salidas de se√±al se ponen a FALSE.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de ROC_LIM

Par√°metro

Offset

Tipo de datos Asignaci√≥n pre‚Äê Descripci√≥n
via

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

UPRLM_P

4.0

REAL

10.0

L√≠mite de subida en el rango positivo
Incremento por segundo [1/s]
> 0.0

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6473

Instrucciones
4.2 Instrucciones
Par√°metro

Offset

Tipo de datos Asignaci√≥n pre‚Äê Descripci√≥n
via

DNRLM_P

8.0

REAL

10.0

L√≠mite de bajada en el rango positivo
Incremento por segundo [1/s]
> 0.0

UPRLM_N

12.0

REAL

10.0

L√≠mite de subida en el rango negativo
Incremento por segundo [1/s]
> 0.0

DNRLM_N

16.0

REAL

10.0

L√≠mite de bajada en el rango negativo
Incremento por segundo [1/s]
> 0.0

H_LM

20.0

REAL

100.0

L√≠mite superior
Rango t√©cnico
> L_LM

L_LM

24.0

REAL

0.0

L√≠mite inferior
Rango t√©cnico
< H_LM

PV

28.0

REAL

0.0

Magnitud de regulaci√≥n

DF_OUTV

32.0

REAL

0.0

DFOUT_ON

36.0

BOOL

FALSE

Activar la preasignaci√≥n de la magnitud de salida

TRACK

36.1

BOOL

FALSE

Correcci√≥n OUTV=INV

MAN_ON

36.2

BOOL

FALSE

Activar el modo manual

COM_RST

36.3

BOOL

FALSE

Rearranque

CYCLE

38.0

TIME

T#1s

Tiempo de muestreo

Rango t√©cnico
Preasignaci√≥n de la magnitud de salida
Rango t√©cnico

Par√°metros de salida ROC_LIM

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

OUTV

42.0

REAL

0.0

Magnitud de salida

QUPRLM_P

46.0

BOOL

FALSE

L√≠mite de la rampa de subida en el rango positivo ha reaccio‚Äê
nado

QDNRLM_P

46.1

BOOL

FALSE

L√≠mite de la rampa de bajada en el rango positivo ha reaccio‚Äê
nado

QUPRLM_N

46.2

BOOL

FALSE

L√≠mite de subida en el rango negativo ha reaccionado

QDNRLM_N

46.3

BOOL

FALSE

L√≠mite de bajada en el rango negativo ha reaccionado

QH_LM

46.4

BOOL

FALSE

L√≠mite superior ha reaccionado

QL_LM

46.5

BOOL

FALSE

L√≠mite inferior ha reaccionado

6474

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

SCALE_M
Descripci√≥n de SCALE_M
En los valores reales el valor del generador muchas veces est√° en un rango que no resulta
adecuado para el usuario, por ejemplo 0 a 10 V corresponden a 0 a 1200 ¬∫C √≥ 0 a 10 V
corresponden a 0 a 3000 rpm. Mediante la adaptaci√≥n de la consigna o del valor real, las dos
magnitudes de proceso est√°n en el mismo rango.

Modo de funcionamiento
La instrucci√≥n normaliza una magnitud de entrada anal√≥gica. La magnitud de entrada
anal√≥gica INV se transfiere a la magnitud de salida OUTV con la recta de normalizaci√≥n. La
recta de normalizaci√≥n se define mediante la subida (FACTOR) y la distancia (OFFSET) entre
OUTV con INV=0 y el eje de coordenadas OUTV=0.
F√≥rmula:
OUTV = INV * FACTOR + OFFSET
2879

)$&725
2))6(7
,19

Rearranque
La instrucci√≥n no dispone de rutina de rearranque.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6475

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de SCALE_M

Par√°metro

Offset

Tipo de datos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

INV

0.0

REAL

0.0

Magnitud de entrada
Rango t√©cnico

FACTOR

4.0

REAL

1.0

Factor de escala

OFFSET

8.0

REAL

0.0

Offset
Rango t√©cnico

Par√°metros de salida de SCALE_M

Par√°metro

Offset

Tipo de datos Asignaci√≥n previa

Descripci√≥n

OUTV

12.0

REAL

Magnitud de salida

0.0

SP_GEN
Descripci√≥n de SP_GEN
Para la consigna predeterminada manualmente es posible cambiar un valor de salida con la
instrucci√≥n SP_GEN mediante dos entradas. Para poder realizar un cambio graduado
finamente la instrucci√≥n debe tener un tiempo de muestreo ‚â§100 ms.

Modo de funcionamiento
DFOUT_ON, OUTVUP y OUTVDN tienen la siguiente influencia en OUTV:
DFOUT_ON

OUTVDN

OUTVUP

OUTV

TRUE

Cualquiera

cualquiera

DF_OUTV

FALSE

TRUE

TRUE

OUTV sin modificar

FALSE

OUTV decreciente

FALSE
TRUE

OUTV creciente

FALSE

OUTV sin modificar

Si est√° activado DFOUT_ON = TRUE, en la salida se deposita DF_OUTV. El cambio de OUTV
es escalonado. La conmutaci√≥n a DFOUT_ON = FALSE es suave.
A trav√©s de la entrada OUTVUP, la magnitud de salida OUTV se puede aumentar de forma
continua dentro de las limitaciones H_LM y L_LM y reducirse mediante OUTVDN. La velocidad
de cambio de OUTV depende de los l√≠mites.
‚óè Durante los primeros 3 segundos despu√©s de activar OUTVUP o OUTVDN rige:
dLMN/dt = (LMN_HLM - LMN_LLM) / 100 s
‚óè a continuaci√≥n
dLMN/dt = (LMN_HLM - LMN_LLM) / 10 s

6476

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
La figura muestra el cambio del valor de salida activando OUTVUP.
2879
+B/0
2879 W

VHF

/B/0

W
287983

OUTVUP y OUTVDN solo se ejecutan si DFOUT_ON = FALSE.
La magnitud de salida OUTV est√° limitada por H_LM y L_LM. Eso se indica en QH_LM y
QL_LM.
La figura muestra la influencia de OUTV mediante OUTVUP, OUTVDN y DFOUTV_ON.
287983
2879'1
')2879B21
2879
+B/0
2879 W

')B2879
/B/0


VHF

VHF

W

4+B/0
4/B/0

Rearranque
En el rearranque la salida OUTV se pone a 0.0. Si est√° activado DFOUT_ON = TRUE la salida
es DF_OUTV. Los l√≠mites tambi√©n est√°n activados durante el rearranque.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6477

Instrucciones
4.2 Instrucciones

L√≠mites internos del bloque
No se limitan los valores dentro de los bloques; no se comprueban los par√°metros.

Par√°metros de entrada de SP_GEN

Par√°metro

Offset

Tipo de datos

Asignaci√≥n previa

Descripci√≥n

DF_OUTV

0.0

REAL

0.0

Preasignaci√≥n de la magnitud de salida

H_LM

4.0

REAL

100.0

Rango t√©cnico
L√≠mite superior
Rango t√©cnico
> L_LM
L_LM

8.0

REAL

0.0

L√≠mite inferior
Rango t√©cnico
< H_LM

OUTVUP

12.0

BOOL

FALSE

OUTV Alta

OUTVDN

12.1

BOOL

FALSE

OUTV Baja

DFOUT_ON

12.2

BOOL

FALSE

Activar la preasignaci√≥n de la magnitud de salida

COM_RST

12.3

BOOL

FALSE

Rearranque

CYCLE

14.0

TIME

T#100ms

Tiempo de muestreo

Par√°metros de salida de SP_GEN

Par√°metro

Offset

Tipo de datos

Asignaci√≥n previa

Descripci√≥n

(tras rearranque)
OUTV

18.0

REAL

0.0

Magnitud de salida

QH_LM

22.0

BOOL

FALSE

El l√≠mite superior ha reaccionado

QL_LM

22.1

BOOL

FALSE

El l√≠mite inferior ha reaccionado

SPLT_RAN
Descripci√≥n de SPLT_RAN
La instrucci√≥n es necesaria p. ej. para dividir una regulaci√≥n de temperatura en un actuador
para refrigeraci√≥n y otro para calefacci√≥n.

6478

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Modo de funcionamiento
La variable manipulada de un regulador PID se divide en varios rangos. Por cada rango la
instrucci√≥n debe llamarse una vez e interconectarse con uno de los bloques de procesamiento
de variable manipulada LMNGEN_C o LMNGEN_S. Si interconecta LMNGEN_S, la
realimentaci√≥n de posici√≥n debe estar activada (LMNR_ON = TRUE).
/01*(1B&

3,'

/01*B3,'

3,'B/01*

3,'B/01*

/01

/01*B3,'

/01*(1B&

63/7B5$1

,19

63/B/01*

3,'B/01*

63/7B5$1

,19

63/B/01*

/01*B3,'

/01*(1B6

3,'B/01*

/01*B3,'

Si el valor de entrada INV est√° dentro del rango de STR_INV y EDR_INV, el valor de salida
SPL_LMNG.PID_OUTV se emite en el rango STR_OUTV y EDR_OUTV. Si INV < STR_INV,,
la salida es STR_OUTV. Si INV > STR_INV,, la salida es EDR_OUTV.
63/B/01*3,'B2879

('5B2879

675B2879

675B,19

('5B,19

,19

Rearranque
La instrucci√≥n no dispone de rutina de rearranque.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6479

Instrucciones
4.2 Instrucciones

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de SPLT_RAN

Par√°metro

Offset

Tipo de da‚Äê
tos

Asignaci√≥n
previa

Descripci√≥n

INV

0.0

REAL

0.0

Variable de entrada
Rango t√©cnico

STR_INV

4.0

REAL

0.0

EDR_INV

8.0

REAL

50.0

STR_OUTV

12.0

REAL

0.0

EDR_OUTV

16.0

REAL

100.0

Inicio de rango INV
Rango t√©cnico
Fin de rango INV
Rango t√©cnico
Inicio de rango OUTV
Rango t√©cnico
Fin de rango OUTV
Rango t√©cnico

Par√°metros de salida de SPLT_RAN

Par√°metro

Offset

Tipo de da‚Äê
tos

Descripci√≥n

SPL_LMNG

20.0

STRUC

Interfaz PID-LMNGEN

SWITCH
Descripci√≥n de SWITCH
La instrucci√≥n se utiliza como multiplexor de entrada y/o salida de 2 magnitudes de entrada/
salida.

Modo de funcionamiento
La instrucci√≥n aplica uno de los 2 valores de entrada anal√≥gicos en uno de 2 valores de salida.
Los conmutadores INV1_ON y OUTV1_ON determinan el modo de funcionamiento de la
instrucci√≥n.

6480

INV1_ON

OUTV1_ON

OUTV1

OUTV2

FALSE

FALSE

Sin cambios

INV2

TRUE

FALSE

Sin cambios

INV1

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
FALSE

TRUE

INV2

Sin cambios

TRUE

TRUE

INV1

Sin cambios

Sin cambios significa que en el par√°metro de salida se conserva el valor del √∫ltimo ciclo.

Rearranque
En el rearranque se activan OUTV1 = 0.0 y OUTV2 = 0.0.

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de SWITCH

Par√°metro

Offset

Tipo de datos

Asignaci√≥n pre‚Äê
via

Descripci√≥n

INV1

0.0

REAL

0.0

Magnitud de entrada 1

INV2

4.0

REAL

0.0

INV1_ON

8.0

BOOL

FALSE

La magnitud de entrada INV1 se conecta directamen‚Äê
te

OUTV1_ON

8.1

BOOL

FALSE

La magnitud de salida OUTV1 se conecta directa‚Äê
mente

COM_RST

8.2

BOOL

FALSE

Rearranque

Rango t√©cnico
Magnitud de entrada 2
Rango t√©cnico

Par√°metros de salida de SWITCH

Par√°metro

Offset

Tipo de datos Asignaci√≥n previa Descripci√≥n

OUTV1

10.0

REAL

0.0

Magnitud de salida 1

OUTV2

14.0

REAL

0.0

Magnitud de salida 2

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6481

Instrucciones
4.2 Instrucciones

LP_SCHED_M
Descripci√≥n de LP_SCHED_M
Cuando se tienen que llamar muchos reguladores con diferentes tiempos de muestreo,
especialmente regulaciones lentas con grandes tiempos de muestreo, el modelo de clases de
prioridad no es suficiente respecto a los niveles de alarma c√≠clica √∫tiles. El distribuidor de
llamadas del regulador (LP_SCHED) permite el posicionamiento de varios reguladores con
diferentes tiempos de muestreo en un nivel de alarma c√≠clica. Los reguladores individuales se
llaman c√≠clicamente durante sus tiempos de muestreo.
La utilizaci√≥n del distribuidor de llamadas no es obligatoria. Las instrucciones de regulador
tambi√©n se pueden llamar directamente desde el OB sin la funci√≥n de distribuci√≥n.
La distribuci√≥n de llamadas de varios reguladores en un nivel de alarma c√≠clica se realiza con
la instrucci√≥n LP_SCHED. La instrucci√≥n se debe llamar antes de todos los lazos de
regulaci√≥n. Los datos para las llamadas del regulador se guardan en un bloque de datos global
(DB_LOOP).
'%JOREDO
'%B/223
)&
/3B6&+('

Bloque de datos global DB_LOOP (P√°gina 6487) no est√° incluido en la librer√≠a. Debe crear
usted mismo este bloque de datos global.
El distribuidor de llamadas procesa el bloque de datos global y pone los bits ENABLE,
dependiendo del orden y de los tiempos de muestreo parametrizados de los reguladores. Por
este motivo la se√±al de temporizaci√≥n del nivel de alarma c√≠clica se reduce. Los lazos de
regulaci√≥n individuales de este nivel de alarma c√≠clica se llaman y procesan en funci√≥n del
tiempo de muestreo ajustado. Tras la llamada del bloque el bit ENABLE se debe resetear. Las
llamadas del bloque y el reseteado de los bits ENABLE se deben programar.
La llamada de algunos lazos de regulaci√≥n se puede bloquear manualmente. Tambi√©n es
posible resetear s√≥lo lazos de regulaci√≥n individuales (rearranque).

Nota
La instrucci√≥n no comprueba si existe realmente un bloque de datos global con el n√∫mero
DB_NBR ni si el par√°metro GLP_NBR (n√∫mero m√°s alto de lazos de regulaci√≥n) concuerda
con la longitud del bloque de datos. Al no parametrizar correctamente, la CPU cambia al estado
STOP y muestra "Error interno del sistema".

6482

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Funcionamiento de LP_SCHED_M
Rearranque
Con COM_RST = TRUE se ajustan las siguientes asignaciones previas:
N√∫mero de lazo de regulaci√≥n actual:

ALP_NBR = 0

Los datos de llamada de todos los lazos de regulaci√≥n hasta GLB_NBR se preasignan del
siguiente modo:
Liberaci√≥n:

ENABLE =

NOT MAN_DIS

Tiempo de muestreo:

CYCLE =

GV(MAN_CYC)

Rearranque:

COM_RST =

TRUE

N√∫mero de llamada local:

ILP_COU =

0

GV(MAN_CYC) = MAN_CYC se redondea a un m√∫ltiple entero de TM_BASE*GLP_NBR

La llamada del lazo de regulaci√≥n mediante LP_SCHED_M
La instrucci√≥n LP_SCHED se integra en el esquema de llamada de la CPU mediante tres
par√°metros de entrada. En la entrada TM_BASE se indica la se√±al de temporizaci√≥n del nivel
de alarma c√≠clica. La llamada del procesamiento de los lazos de regulaci√≥n asignados se
realiza a trav√©s de una llamada del bloque condicionada desde un nivel de alarma c√≠clica (p.
ej., B. OB 35). Para ello se sondean los bits ENABLE en el bloque de datos global.
Si la llamada se realiza desde el nivel de rearranque, se activa la entrada COM_RST = TRUE.
En el nivel de alarma c√≠clica esta llamada debe resetearse en FALSE. El bloque de datos global
(v√©ase la tabla anterior) con los datos relevantes de tiempo de los lazos de regulaci√≥n en el
nivel de alarma c√≠clica correspondiente se asigna mediante el par√°metro de entrada DB_NBR.

Parametrizaci√≥n de la llamada del lazo de regulaci√≥n (DB global)
La parametrizaci√≥n del distribuidor de llamadas del regulador debe realizarse sin ayuda del
software de configuraci√≥n.
El bloque de datos (DB_LOOP) contiene bien un par√°metro que determina el n√∫mero de los
lazos de regulaci√≥n que hay que procesar en el nivel de alarma c√≠clica (256 como m√°ximo) o
bien un par√°metro que muestra los lazos de regulaci√≥n que se procesan actualmente:
GLP_NBR

N√∫mero de lazo de regulaci√≥n m√°s alto

ALP_NBR

N√∫mero del lazo de regulaci√≥n procesado en el ciclo

El n√∫mero del lazo de regulaci√≥n correspondiente resulta del posicionamiento de sus datos de
llamada en el orden de las entradas en el DB.
Los datos de llamada de los lazos de regulaci√≥n individuales est√°n situados de forma
estructurada en el campo LOOP_DAT. Si desea a√±adir lazos de regulaci√≥n, es necesario
adaptar la longitud del campo de LOOP_DAT. Para ello hay que adaptar el tipo de datos
ARRAY en la vista de declaraci√≥n. Por ejemplo para 10 lazos de regulaci√≥n hay que introducir

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6483

Instrucciones
4.2 Instrucciones
ARRAY[1..10]. Adem√°s hay que adaptar el par√°metro GLP_NBR en la vista de datos. Nunca
debe superar la longitud del campo.
Los par√°metros COM_RST y CYCLE en los datos de llamada se deben interconectar con los
par√°metros correspondientes en el FB del lazo de regulaci√≥n llamado. Esta interconexi√≥n la
debe programar el usuario. Si el par√°metro ENABLE est√° puesto, se debe llamar el lazo de
regulaci√≥n correspondiente. Tras la llamada del regulador el bit ENABLE se debe resetear. La
llamada del regulador condicionada y el reseteado del bit ENABLE se deben programar por el
usuario.
Con ayuda del par√°metro manualmente ajustable MAN_CYC/MAN_DIS/MAN_CRST se
puede controlar si un lazo de regulaci√≥n se puede llamar o no. Estos datos de llamada se
pueden cambiar online, es decir, durante el funcionamiento, si s√≥lo se sobrescriben los
par√°metros y no se genera de nuevo todo el DB. Esto significa:
MAN_CYC

Tiempo de muestreo del regulador correspondiente (se redondea en CYCLE a
un m√∫ltiplo entero de TM_BASE * GLP_NBR)

MAN_DIS

Bloqueo de la llamada del regulador

MAN_CRST

Rearranque para este regulador

El procesamiento de la llamada
El lazo de regulaci√≥n correspondiente se procesa seg√∫n la parametrizaci√≥n anterior del DB
dependiendo del valor de la se√±al ENABLE de los datos de la llamada del regulador.
El bloque de datos se procesa desde arriba hacia abajo. El distribuidor de llamadas sigue en
cada ciclo un n√∫mero de lazos de regulaci√≥n (ALP_NBR) en el orden del DB. El contador
interno ILP_COU disminuye en 1. Si ILP_COU = 0, el distribuidor de llamadas activa el bit
ENABLE del lazo de regulaci√≥n correspondiente. El reseteado del bit ENABLE debe
programarlo el usuario despu√©s de la llamada del regulador.
El par√°metro MAN_CYC se transfiere a CYCLE durante el procesamiento:
CYCLE = GV (MAN_CYC), GV = m√∫ltiplo entero

6484

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
/ODPDGD/3B6&+('
HQXQQLYHOGHDODUPDF¬ØFOLFD

/3B6&+('

3HM
2%

'%B1%5

'%JOREDO
5HJXODGRU




>@
>@

>Q@

70B%$6(
&20B567

'%GHLQVWDQFLD
5HJXODGRU

>@

)%GHUHJXODGRU
/ODPDGDGH
EORTXHFRQGLFLR
QDGD

Figura 4-39

&20B567
&<&/(

Principio de la llamada del regulador a trav√©s del distribuidor de llamadas LP_SCHED

‚óè Bloquear lazos de regulaci√≥n individuales:
Si se pone el bit "MAN_DIS" mediante una parametrizaci√≥n en el DB, el bit ENABLE se
resetea en FALSE y se elimina el lazo de regulaci√≥n correspondiente del procesamiento en
el distribuidor de llamadas.
‚óè Resetear lazos de regulaci√≥n individuales (rearranque):
Cuando se activa el bit "MAN_CRST" mediante la parametrizaci√≥n en el DB, entonces
COM_RST = TRUE y a continuaci√≥n se desactiva MAN_CRST. El lazo de regulaci√≥n
correspondiente se procesa con su rutina de rearranque. En el siguiente ciclo de llamada
tambi√©n se desactiva autom√°ticamente COM_RST = FALSE.
Nota
Cuando se a√±ade o borra un lazo de regulaci√≥n, es decir, cuando se regenera el DB
completo, pero no se desea que el distribuidor de llamadas se procese en el rearranque,
entonces se debe preasignar con cero los contadores internos de los lazos de regulaci√≥n
(ILP_COU[n]) y el par√°metro para el n√∫mero actual de lazos de regulaci√≥n ALP_NBR.

Condiciones para la llamada del lazo de regulaci√≥n mediante LP_SCHED
Para garantizar que los periodos entre las llamadas de cierto regulador se mantengan
constantes y para utilizar la CPU de forma constante, s√≥lo se debe procesar un lazo de
regulaci√≥n por se√±al de temporizaci√≥n del nivel de alarma c√≠clica. Por ello, durante la
parametrizaci√≥n de los tiempos de muestreo MAN_CYC se deben cumplir las siguientes
condiciones en relaci√≥n con la se√±al de temporizaci√≥n (TM_BASE):
‚óè Los tiempos de procesamiento de los lazos de regulaci√≥n individuales deben ser menores
que la se√±al de temporizaci√≥n (TM_BASE) del nivel de alarma c√≠clica.
‚óè El tiempo de muestreo de un lazo de regulaci√≥n (MAN_CYC) debe ser un m√∫ltiplo entero
(GV) del producto de la base de tiempo y el n√∫mero de los reguladores por procesar
(GLP_NBR):
MAN_CYC = GV (TM_BASE * GLP_NBR)
Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6485

Instrucciones
4.2 Instrucciones

Ejemplo para la distribuci√≥n de llamadas
El siguiente ejemplo muestra el orden de las llamadas de cuatro lazos de regulaci√≥n en un nivel
de alarma c√≠clica (v√©ase la siguiente figura). S√≥lo se procesa un lazo de regulaci√≥n por unidad
de la base de tiempo. El orden de las llamadas y por ello los tiempos de desplazamiento (VZ1 ...
VZ5) resultan del orden de los datos de llamada dentro del DB global.
/D]RGHUHJXODFL¬µQ&<&/(>@  70B%$6( */3B1%5 9=  70B%$6
/D]RGHUHJXODFL¬µQ&<&/(>@  70B%$6( */3B1%5 9=  70B%$6
/D]RGHUHJXODFL¬µQ&<&/(>@  70B%$6( */3B1%5 9=  70B%$6
/D]RGHUHJXODFL¬µQ&<&/(>@  70B%$6( */3B1%5 9=  70B%$6

W
70B%$6(

70B%$6(&LFORGHOQLYHOGHDODUPDF¬ØFOLFD
*/3B1%51¬ºPHURP¬£VDOWRGHOD]RGHUHJXODFL¬µQ DTX¬Ø 
&<&/(>@>@7LHPSRGHPXHVWUHRGHORVUHJXODGRUHV>@>@
9=9=7LHPSRGHGHVSOD]DPLHQWR

Figura 4-40

Orden de llamada de cuatro lazos de regulaci√≥n procesados con diferentes frecuencias

L√≠mites internos del bloque
Los valores de los par√°metros de entrada no se limitan en la instrucci√≥n; no se comprueban los
par√°metros.

Par√°metros de entrada de LP_SCHED_M

Par√°metro

Tipo de datos

Descripci√≥n

TM_BASE

TIME

Base de tiempo
>= 1ms

COM_RST

BOOL

Rearranque

DB_NBR

BLOCK_DB

N√∫mero del bloque de datos

6486

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Bloque de datos global DB_LOOP
Los datos para la distribuci√≥n de llamadas con LP_SCHED_M se preasignan en un bloque de
datos global. Este bloque de datos global no est√° incluido en la librer√≠a. Debe crear usted
mismo este bloque de datos global seg√∫n el esquema siguiente y adaptarlo a su aplicaci√≥n.
Par√°metro

Tipo de da‚Äê
tos

Ajuste prede‚Äê
terminado

Descripci√≥n

GLP_NBR

INT

2

N√∫mero m√°ximo de reguladores
1 - 256

ALP_NBR

INT

0

N√∫mero del regulador actual
0 - 256

LOOP_DAT

Array
[1...GLP_N
BR] of
Struct

LOOP_DAT[1].MAN_CYC

TIME

Estructura de los datos de los diferentes reguladores. La
matriz debe ser declarada por 1...GLP_NBR.

T#1s

Datos del regulador 1: tiempo de muestreo manual
>= 1ms

LOOP_DAT[1].MAN_DIS

BOOL

FALSE

Datos del regulador 1: bloquear manualmente la llamada del
regulador

LOOP_DAT[1].MAN_CRST

BOOL

FALSE

Datos del regulador 1: iniciar manualmente el rearranque

LOOP_DAT[1].ENABLE

BOOL

FALSE

Datos del regulador 1: liberaci√≥n del regulador

LOOP_DAT[1].COM_RST

BOOL

FALSE

Datos del regulador 1: rearranque

LOOP_DAT[1].ILP_COU

INT

0

Datos del regulador 1: contador interno

LOOP_DAT[1].CYCLE

TIME

T#1s

Datos del regulador 1: tiempo de muestreo
>= 1ms

LOOP_DAT[2].MAN_CYC

Datos del regulador 2: tiempo de muestreo manual

...

Alternativamente, puede generar el bloque de datos global mediante un archivo fuente
externo. Para ello siga los siguientes pasos:
1. Copie el texto que figura m√°s abajo en el portapapeles.
2. Abra un editor de texto externo.
3. Pegue el texto del portapapeles en el editor de texto.
4. Guarde el archivo con la extensi√≥n ".DB".
5. Abra la carpeta "Fuentes externas" en el √°rbol del proyecto del TIA Portal.
6. Haga doble clic en el comando "Agregar nuevo archivo externo".
Se abrir√° el cuadro de di√°logo "Abrir".
7. Navegue hasta el archivo fuente externo que ha creado previamente y selecci√≥nelo.
8. Confirme la selecci√≥n con "Abrir".
9. Seleccione el archivo fuente externo.
10.En el men√∫ contextual, seleccione el comando "Generar bloques a partir de fuente".

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6487

Instrucciones
4.2 Instrucciones
11.Una consulta de seguridad le informar√° de que se sobrescribir√°n los bloques que puedan
estar presentes.
12.Confirme la consulta de seguridad con "Aceptar".
13.Adapte el bloque de datos generado a su aplicaci√≥n.
DATA_BLOCK "DB_LOOP"
TITLE = data block loop scheduler
{ S7_Optimized_Access := 'FALSE' }
NAME : DB_LOOP
STRUCT
GLP_NBR : Int; // greatest loop number
ALP_NBR : Int; // actual loop number
LOOP_DAT : Array[1..2] of Struct
MAN_CYC : Time; // loop data: manual sample time
MAN_DIS : Bool; // loop data: manual loop disable
MAN_CRST : Bool; // loop data: manual complete restart
ENABLE : Bool; // loop data: enable loop
COM_RST : Bool; // loop data: complete restart
ILP_COU : Int; // loop data: internal loop counter
CYCLE : Time; // loop data: sample time
END_STRUCT;
END_STRUCT;

BEGIN
GLP_NBR := 2;
LOOP_DAT[1].MAN_CYC := T#1S;
LOOP_DAT[1].CYCLE := T#1S;
LOOP_DAT[2].MAN_CYC := T#200MS;
LOOP_DAT[2].CYCLE := T#200MS;
END_DATA_BLOCK

6488

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

4.2.4.2

Motion Control

Easy Motion Control
MC_Init
Descripci√≥n
La instrucci√≥n MC_Init prepara la inicializaci√≥n de todos los bloques de un eje, activando todos
los bits del campo de bits "Init.Ix" del DB de eje (v√©ase "Inicializaci√≥n y cambios de
par√°metros").

Funcionamiento
La instrucci√≥n MC_Init impide un arranque inintencionado del eje activando en el DB de eje las
se√±alizaciones de error "Error" = TRUE y "Err.StoppedMotion" = TRUE. Si desea desplazar el
eje tras la llamada a la instrucci√≥n MC_Init, debe confirmar primero las se√±alizaciones de error
(v√©ase "Se√±alizaciones de error y acuse de errores en el DB de eje").
La instrucci√≥n MC_Init comprueba los par√°metros del DB de eje. Si se encuentra un error de
parametrizaci√≥n, en el DB de eje para la se√±alizaci√≥n (agrupada) de errores se activan los bits
"Error" y "Err.ConfigErr", as√≠ como uno de los bits de la estructura "ConfigErr" para una
se√±alizaci√≥n m√°s precisa del error.
Los errores de parametrizaci√≥n no se pueden acusar. Es preciso volver a llamar a la instrucci√≥n
MC_Init tras corregir el error.
Para m√°s informaci√≥n sobre el concepto de error, v√©ase "Se√±alizaciones de error y acuse de
errores en el DB de eje" y "Errores de parametrizaci√≥n".

Llamada
Nota
No se permite la llamada de la instrucci√≥n MC_Init cuando el eje se encuentra parado.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6489

Instrucciones
4.2 Instrucciones
Efect√∫e una llamada condicionada de la instrucci√≥n MC_Init en el mismo bloque de programa
en el que tambi√©n se llama el resto de instrucciones de este eje. En los siguientes casos debe
llamarse la instrucci√≥n MC_Init:
‚óè Tras cada arranque de la CPU (OB 100 y OB 101)
‚óè Si se modifica un par√°metro sin el software de configuraci√≥n se√±alado con el siguiente
s√≠mbolo en "Configuraci√≥n del objeto tecnol√≥gico Eje":

Nota
Resetee la condici√≥n utilizada para la llamada de la instrucci√≥n MC_Init una vez que se
haya ejecutado la llamada. De lo contrario, los bloques Easy Motion Control repetir√°n
siempre √∫nicamente su inicializaci√≥n, pues los bits de inicializaci√≥n del DB de eje se
vuelven a setear.

MC_MoveAbsolute
Descripci√≥n
La instrucci√≥n MC_MoveAbsolute permite mover un eje sincronizado al destino absoluto
especificado en "Position".

Funcionamiento
Al detectarse un flanco ascendente en la entrada "Execute", la instrucci√≥n MC_MoveAbsolute
determina el sentido de desplazamiento y acelera el eje en este sentido. Al alcanzarse el punto
de frenado, el eje se frena. La velocidad especificada no tiene que alcanzarse durante el
desplazamiento.
Particularidad en un eje lineal:
‚óè El sentido del desplazamiento viene determinado por la posici√≥n consignada durante el
arranque y el destino.

6490

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Particularidades en un eje rotativo:
‚óè La instrucci√≥n MC_MoveAbsolute s√≥lo permite efectuar un desplazamiento a partir de la
posici√≥n de velocidad cero del eje que sea inferior a una vuelta del eje rotativo. Para
posicionamientos de varias vueltas del eje rotativo, utilice la instrucci√≥n MC_MoveRelative
(P√°gina 6493).
‚óè Selecci√≥n de sentido para arranque desde la posici√≥n de velocidad cero del eje:
‚Äì Sentido positivo: el desplazamiento al destino se efect√∫a en sentido positivo,
‚Äì Sentido negativo: el desplazamiento al destino se efect√∫a en sentido negativo,
‚Äì Recorrido m√°s corto: el desplazamiento al destino se efect√∫a en el sentido para el que
el recorrido entre el punto inicial y el destino sea ‚â§ ¬Ω vuelta del eje rotativo.
‚óè Selecci√≥n de sentido al retomar un desplazamiento:
‚Äì Sentido positivo: el desplazamiento al destino se efect√∫a en sentido positivo. Si hasta
ese momento el desplazamiento era en sentido negativo, el eje se frena y se efect√∫a el
desplazamiento al destino en sentido positivo. Si el destino se alcanza exactamente al
frenar con sentido de desplazamiento negativo, el eje se desplazar√° a continuaci√≥n una
vuelta en sentido positivo.
‚Äì Sentido negativo: el desplazamiento al destino se efect√∫a en sentido negativo. Si hasta
ese momento el desplazamiento era en sentido positivo, el eje se frena y se efect√∫a el
desplazamiento al destino en sentido negativo. Si el destino se alcanza exactamente al
frenar con sentido de desplazamiento positivo, el eje se desplaza a continuaci√≥n una
vuelta en sentido negativo.
‚Äì Recorrido m√°s corto: el desplazamiento al destino se efect√∫a en el sentido para el que
el recorrido entre el punto inicial y el destino sea ‚â§ ¬Ω vuelta del eje rotativo. Si el recorrido
de frenado es superior, el eje se desplaza hasta el destino en el sentido original.
‚Äì Si ha seleccionado los par√°metros de desplazamiento de manera que el recorrido de
frenado del desplazamiento anterior era mayor que una vuelta del eje rotativo, se
efectuar√° el desplazamiento directamente al destino tras la inversi√≥n de sentido.
‚Äì El recorrido total entre el punto inicial y el destino puede ser mayor que una vuelta del
eje rotativo.
Diagrama de evoluci√≥n de la se√±al de MC_MoveAbsolute

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6491

Instrucciones

&RQVLJQDYHO
9HOUHDO

9HORFLGDG

4.2 Instrucciones

7LHPSR

([HFXWH

%XV\

'RQH












,QLFLRGHODLQVWUXFFL¬µQGHGHVSOD]DPLHQWR



3XQWRGHIUHQDGR



/DFRQVLJQDKDDOFDQ]DGRODSRVLFL¬µQGHGHVWLQR



(OHMHKDDOFDQ]DGROD]RQDGHGHVWLQR



$OUHVHWHDU([HFXWHVHUHVHWHD'RQH(OSURFHVRKDILQDOL]DGR&XDQGRVHUHVHWHD
([HFXWHDQWHVGHDOFDQ]DUVHODSRVLFL¬µQGHGHVWLQRVHDFWLYD'RQHGXUDQWHXQ
FLFORDODOFDQ]DUVHODSRVLFL¬µQGHGHVWLQR\GHVSX¬´VVHYXHOYHDUHVHWHDU

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

Execute

INPUT

BOOL

Inicio del posicionamiento con un flanco ascendente.

Position

INPUT

REAL

Posici√≥n de destino absoluta en [unidad de longitud]
Con eje rotativo: Posici√≥n del eje rotativo ‚â§ Posici√≥n < Fin del eje rotativo

Velocity

INPUT

REAL

Velocidad del eje en [unidad de longitud/s]

Acceleration

INPUT

REAL

Aceleraci√≥n del eje en [unidad de longitud/s2]

Deceleration

INPUT

REAL

Deceleraci√≥n del eje en [unidad de longitud/s2]

Direction

INPUT

INT

Selecci√≥n de sentido para desplazamiento con eje rotativo.
-1 = sentido negativo
0 = recorrido m√°s corto
1 = sentido positivo

6492

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

Busy

OUTPUT

BOOL

1 = petici√≥n en curso.

Done

OUTPUT

BOOL

1 = petici√≥n finalizada sin errores.
El bit permanece activado hasta que se resetea "Execute", pero como
m√≠nimo durante una llamada de la instrucci√≥n.

CommandAborted

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por otra petici√≥n.
El bit permanece activado hasta que se resetea "Execute", pero como
m√≠nimo durante una llamada de la instrucci√≥n.

Error

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por haberse detectado un error de eje.
El bit permanece activado hasta que se resetea "Execute", pero como
m√≠nimo durante una llamada de la instrucci√≥n.

UDT2
En las propiedades del bloque de MC_MoveAbsolute se encuentra consignado y reservado un
tipo de datos UDT2. Por tanto, no debe utilizarse en el mismo proyecto ning√∫n tipo de datos
UDT2 propio. De lo contrario pueden producirse mensajes de error e incoherencias dentro del
proyecto. Si es necesario utilizar un tipo de datos UDT2, este UDT deber√° renombrarse. Por
ejemplo, como UDT3.

MC_MoveRelative
Descripci√≥n
La instrucci√≥n MC_MoveRelative permite mover un eje un recorrido especificado en "Distance"
relativo a la consigna al inicio del desplazamiento. El signo de "Distance" determina el sentido.

Funcionamiento
Al detectarse un flanco ascendente en la entrada "Execute", la instrucci√≥n MC_MoveRelative
acelera el eje en el sentido indicado en "Distance". Al alcanzarse el punto de frenado, el eje se
frena. La velocidad especificada no tiene que alcanzarse durante el desplazamiento. El
destino viene determinado por la posici√≥n consignada al inicio del desplazamiento y del
recorrido que se debe realizar.
Particularidad en ejes rotativos:
‚óè Al especificarse valores superiores a una vuelta del eje rotativo en "Distance", se pueden
efectuar desplazamientos de varias vueltas del eje rotativo.
Diagrama de evoluci√≥n de la se√±al de MC_MoveRelative

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6493

Instrucciones

&RQVLJQDYHO
9HOUHDO

9HORFLGDG

4.2 Instrucciones

7LHPSR

([HFXWH

%XV\

'RQH












,QLFLRGHODLQVWUXFFL¬µQGHGHVSOD]DPLHQWR



3XQWRGHIUHQDGR



/DFRQVLJQDKDDOFDQ]DGRODSRVLFL¬µQGHGHVWLQR



(OHMHKDDOFDQ]DGROD]RQDGHGHVWLQR



$OUHVHWHDU([HFXWHVHUHVHWHD'RQH(OSURFHVRKDILQDOL]DGR&XDQGRVHUHVHWHD
([HFXWHDQWHVGHDOFDQ]DUVHODSRVLFL¬µQGHGHVWLQRVHDFWLYD'RQHGXUDQWHXQ
FLFORDODOFDQ]DUVHODSRVLFL¬µQGHGHVWLQR\GHVSX¬´VVHYXHOYHDUHVHWHDU

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

Execute

INPUT

BOOL

Inicio del posicionamiento con un flanco ascendente.

Distance

INPUT

REAL

Recorrido que debe efectuarse en [unidad de longitud], referido a la √∫ltima
consigna de posici√≥n.
El signo define el sentido de desplazamiento.

Velocity

INPUT

REAL

Velocidad del eje en [unidad de longitud/s]

Acceleration

INPUT

REAL

Aceleraci√≥n del eje en [unidad de longitud/s2]

Deceleration

INPUT

REAL

Deceleraci√≥n del eje en [unidad de longitud/s2]

Busy

OUTPUT

BOOL

1 = petici√≥n en curso.

6494

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

Done

OUTPUT

BOOL

1 = petici√≥n finalizada sin errores.
El bit permanece activado hasta que se resetea "Execute", pero como m√≠‚Äê
nimo durante una llamada de la instrucci√≥n.

CommandAborted

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por otra petici√≥n.
El bit permanece activado hasta que se resetea "Execute", pero como m√≠‚Äê
nimo durante una llamada de la instrucci√≥n.

Error

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por haberse detectado un error de eje.
El bit permanece activado hasta que se resetea "Execute", pero como m√≠‚Äê
nimo durante una llamada de la instrucci√≥n.

UDT2
En las propiedades del bloque de MC_MoveRelative se encuentra consignado y reservado un
tipo de datos UDT2. Por tanto, no debe utilizarse en el mismo proyecto ning√∫n tipo de datos
UDT2 propio. De lo contrario pueden producirse mensajes de error e incoherencias dentro del
proyecto. Si es necesario utilizar un tipo de datos UDT2, este UDT deber√° renombrarse. Por
ejemplo, como UDT3.

MC_MoveJog
Descripci√≥n
La instrucci√≥n MC_MoveJog permite desplazar un eje mediante dos entradas de sentido
controladas por nivel "JogPos" y "JogNeg".

Funcionamiento
Al activar una entrada de sentido, MC_MoveJog acelera el eje primeramente hasta la
velocidad indicada. Mientras est√© activada la entrada de sentido, el eje se desplazar√° en este
sentido. Si se vuelve a resetear la entrada de sentido, el eje se frena.
Las dos entradas de sentido se eval√∫an con las siguientes dependencias:
‚óè Mientras haya un sentido seleccionado, ajustar el sentido opuesto carece de efecto. No se
genera ning√∫n error.
‚óè Para cambiar el sentido durante el desplazamiento, es necesario ajustar la otra entrada de
sentido a TRUE y al mismo tiempo la entrada seleccionada originalmente a FALSE.
‚óè Si al inicio de un desplazamiento se han activado las dos entradas, se generar√° un error de
inicio ("Err.StartErr", v√©ase Error con parada suave).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6495

Instrucciones
4.2 Instrucciones
Particularidades en un eje lineal:
‚óè Si se rebasa el m√°ximo recorrido de desplazamiento con un eje lineal, la instrucci√≥n
MC_MoveJog frena el eje hasta parada con el mensaje de error acusable "Err.DistanceErr"
(v√©ase AUTOHOTSPOT). Tras el acuse del error, el eje puede volver a desplazarse.
‚óè Un eje lineal no sincronizado no se vigila y por tanto puede desplazarse hasta su fin f√≠sico
sin frenar. Por tanto, es preciso terminar el desplazamiento a tiempo.
ADVERTENCIA
Eje lineal no sincronizado
Se pueden producir da√±os personales y materiales.
La instrucci√≥n MC_MoveJog permite el desplazamiento hasta el fin f√≠sico del eje con un eje
lineal no sincronizado.
Para evitar da√±os personales y materiales es necesario tomar las medidas siguientes:
‚óè Instale un interruptor de PARADA DE EMERGENCIA en las inmediaciones del equipo.
S√≥lo as√≠ puede garantizarse que en caso de un fallo del software o del equipo sea
posible desconectar la instalaci√≥n de modo seguro.
‚óè Instale finales de carrera de seguridad que act√∫en directamente en las etapas de
potencia de todos los accionamientos.
‚óè Aseg√∫rese de que ninguna persona tenga acceso al √°rea de la instalaci√≥n donde hay
piezas en movimiento.
‚óè Un eje lineal sincronizado se frena al final de la zona de trabajo y se detiene en el final de
carrera por software. Se emite el mensaje de error acusable "Err.DistanceErr", as√≠ como el
mensaje de error "Err.SWLimitMinExceeded" o "Err.SWLimitMaxExceeded". Tras el acuse
del error s√≥lo se permite un desplazamiento en sentido contrario.
Particularidad en un eje rotativo:
‚óè El recorrido de desplazamiento de la instrucci√≥n MC_MoveJog no est√° limitado para un eje
rotativo (giro continuo).
Diagrama de evoluci√≥n de la se√±al de MC_MoveJog

6496

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones

9HORFLGDG

4.2 Instrucciones

7LHPSR

-RJ3RV

%XV\

'RQH








(OPRYLPLHQWRVHLQLFLDPHGLDQWHDFWLYDFL¬µQGH-RJ3RV



(OPRYLPLHQWRVHGHWLHQHPHGLDQWHUHVHWGH-RJ3RV



&RQODSDUDGDGHOHMHVHUHVHWHD%XV\\VHDFWLYD'RQHGXUDQWHXQFLFOR

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

JogPos

INPUT

BOOL

1 = movimiento en sentido positivo, mientras est√© activado "JogPos".

JogNeg

INPUT

BOOL

1 = movimiento en sentido negativo, mientras est√© activado "JogNeg".

Velocity

INPUT

REAL

Velocidad del eje en [unidad de longitud/s]

Acceleration

INPUT

REAL

Aceleraci√≥n del eje en [unidad de longitud/s2]

Deceleration

INPUT

REAL

Deceleraci√≥n del eje en [unidad de longitud/s2]

Busy

OUTPUT

BOOL

1 = petici√≥n en curso.

Done

OUTPUT

BOOL

1 = petici√≥n finalizada sin errores.
El bit se activa tras alcanzarse la parada del eje durante exactamente una
llamada de la instrucci√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6497

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

CommandAborted

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por otra petici√≥n.

Error

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por haberse detectado un error de eje.

El bit permanece activado hasta que se resetea "JogPos" o "JogNeg".
El bit permanece activado hasta que se resetea "JogPos" o "JogNeg".

UDT2
En las propiedades del bloque de MC_MoveJog se encuentra consignado y reservado un tipo
de datos UDT2. Por tanto, no debe utilizarse en el mismo proyecto ning√∫n tipo de datos UDT2
propio. De lo contrario pueden producirse mensajes de error e incoherencias dentro del
proyecto. Si es necesario utilizar un tipo de datos UDT2, este UDT deber√° renombrarse. Por
ejemplo, como UDT3.

MC_Home
Descripci√≥n
La instrucci√≥n MC_Home se utiliza:
‚óè para la b√∫squeda del punto de referencia en enc√≥ders incrementales ("Velocity" > 0)
‚óè para posicionar el punto de referencia en enc√≥ders incrementales y absolutos ("Velocity" =
0)
Para un enc√≥der absoluto, el posicionamiento del punto de referencia tambi√©n se denomina
reajuste del enc√≥der absoluto.

Funcionamiento
B√∫squeda del punto de referencia ("Velocity" > 0)
Tras activar "Execute", el eje se desplaza con la velocidad y sentido elegidos hasta que el
m√≥dulo de lectura de recorrido y el driver de entrada detecten que se ha alcanzado el punto de
referecia. Al alcanzarse el punto de referencia, el valor real de posici√≥n se ajusta al valor de
"Position" y el eje se frena. El eje est√° ahora sincronizado ("Sync" = TRUE), pero no est√° en el
punto de referencia.
Si se rebasa el m√°ximo recorrido durante la b√∫squeda del punto de referencia, la instrucci√≥n
MC_Home frena el eje hasta pararse (v√©ase Desarrollo de movimientos de desplazamiento) y
se activan los mensajes de error "Error" y "Err.DistanceErr" (v√©ase Error con parada suave).
Si la b√∫squeda del punto de referencia se detiene antes de alcanzarse √©ste, el eje no est√°
sincronizado ("Sync" = FALSE).

6498

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
La instrucci√≥n MC_Home no se detiene en el fin del eje y tampoco ejecuta un cambio de
sentido autom√°tico.
PELIGRO
Si no se encuentra ning√∫n punto de referencia, el cliente deber√° tomar las medidas
necesarias para que el eje se detenga antes del fin f√≠sico (p. ej., interruptor de parada de
emergencia, final de carrera de seguridad).

Posicionamiento del punto de referencia ("Velocity" = 0)
Ajuste la velocidad "Velocity" a 0. Tras ajustar "Execute", el valor real de posici√≥n se ajusta al
valor de "Position", y al mismo tiempo se activa en el DB de eje el bit de estado "Sync" = TRUE.
Tras sustituirse el enc√≥der absoluto o si se realizan cambios mec√°nicos, es preciso volver a
realizar el posicionamiento del punto de referencia, incluso aunque el eje todav√≠a est√©
sincronizado.
Nota
Para un enc√≥der absoluto rige lo siguiente:
El valor del enc√≥der en el punto de referencia se guarda en el DB de eje. Por tanto, tras
posicionarse el punto de referencia debe incluirse el DB de eje online en la gesti√≥n de datos
offline. De lo contrario, tras cargarse el DB en la CPU, el eje dejar√° de estar sincronizado.
Tenga en cuenta las indicaciones sobre la Carga del DB de eje.

Diagrama de evoluci√≥n de la se√±al para la b√∫squeda del punto de referencia

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6499

Instrucciones

9HORFLGDG

4.2 Instrucciones

7LHPSR

([HFXWH

%XV\

'RQH

6\QF











,QLFLRGHODE¬ºVTXHGDGHOSXQWRGHUHIHUHQFLDFRQ([HFXWH
3XQWRGHUHIHUHQFLDHQFRQWUDGRHOHMHIUHQD
(OHMHVHKDGHWHQLGRVHHOLPLQD%XV\\VHDFWLYD'RQH
(OHMHHVW¬£VLQFURQL]DGR



$OUHVHWHDU([HFXWHVHUHVHWHD'RQH

Diagrama de evoluci√≥n de la se√±al para el posicionamiento del punto de referencia

6500

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones

9HORFLGDG

4.2 Instrucciones

(MHSDUDGR
7LHPSR

([HFXWH

%XV\

'RQH

6\QF








,QLFLRGHOSRVLFLRQDPLHQWRGHOSXQWRGHUHIHUHQFLDRUHDMXVWHGHOHQF¬µGHU
DEVROXWRFRQ([HFXWH
(OHMHQRWLILFDVLQFURQL]DGR



$OUHVHWHDU([HFXWHVHUHVHWHD'RQH(OSURFHVRILQDOL]D



Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.
El inicio de la b√∫squeda del punto de referencia o del posicionamiento del punto de referencia
s√≥lo se permite con el eje parado.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6501

Instrucciones
4.2 Instrucciones

Par√°metro
Par√°metro

Declaraci√≥n Tipo de
datos

Descripci√≥n

Execute

INPUT

BOOL

Inicio de la b√∫squeda del punto de referencia o del posicionamiento del
punto de referencia con un flanco ascendente.

Position

INPUT

REAL

Enc√≥der incremental:
Coordenada del punto de referencia o del punto cero de la m√°quina.
Enc√≥der absoluto:
Coordenada del punto cero de la m√°quina.
El valor debe estar dentro de la zona de trabajo:
‚óè Eje lineal:
Dentro del final de carrera por software
‚óè Eje rotativo:
Inicio del eje ‚â§ Posici√≥n < Fin del eje

Velocity

INPUT

REAL

Velocidad del eje en [unidad de longitud/s]
Velocity > 0: b√∫squeda del punto de referencia
Velocity= 0: posicionamiento del punto de referencia

Acceleration

INPUT

REAL

Aceleraci√≥n del eje en [unidad de longitud/s2]

Deceleration

INPUT

REAL

Deceleraci√≥n del eje en [unidad de longitud/s2]

Direction

INPUT

INT

Sentido inicial para la b√∫squeda del punto de referencia.
1 = b√∫squeda del punto de referencia en sentido positivo
-1 = b√∫squeda del punto de referencia en sentido negativo

Busy

OUTPUT

BOOL

Done

OUTPUT

BOOL

1 = petici√≥n en curso.
1 = petici√≥n finalizada sin errores.
El bit permanece activado hasta que se resetea "Execute", pero como m√≠‚Äê
nimo durante una llamada de la instrucci√≥n.

CommandAborted

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por otra petici√≥n.
El bit permanece activado hasta que se resetea "Execute", pero como m√≠‚Äê
nimo durante una llamada de la instrucci√≥n.

Error

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por haberse detectado un error de eje.
El bit permanece activado hasta que se resetea "Execute", pero como m√≠‚Äê
nimo durante una llamada de la instrucci√≥n.

MC_StopMotion
Descripci√≥n
La instrucci√≥n MC_StopMotion permite cancelar cualquier instrucci√≥n de desplazamiento de
forma que el eje se detenga con la deceleraci√≥n ajustada.
Caso de aplicaci√≥n t√≠pico: cancelaci√≥n de un posicionamiento en un momento cualquiera
debido a un evento externo (p. ej., apertura de una puerta de protecci√≥n).

6502

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Funcionamiento
Con la detecci√≥n del flanco ascendente en la entrada "Execute", la instrucci√≥n MC_StopMotion
asume el control del eje y lo frena hasta detenerse. La instrucci√≥n MC_StopMotion s√≥lo puede
cancelarse debido a errores graves, pero no debido a una instrucci√≥n de desplazamiento. Tras
alcanzarse la velocidad cero se puede volver a iniciar un nuevo desplazamiento.
La deceleraci√≥n en la instrucci√≥n MC_StopMotion se puede seleccionar a discreci√≥n. Si es
inferior a la de la instrucci√≥n cancelada, el eje se frena con la deceleraci√≥n de la instrucci√≥n
cancelada. De esta forma se garantiza que el eje no se mueva m√°s all√° del destino de la
instrucci√≥n cancelada.
Si se cancela un desplazamiento con destino (MC_MoveAbsolute, MC_MoveRelative)
mediante la instrucci√≥n MC_StopMotion, √©ste sigue calculando la distancia residual. Tras
finalizar la instrucci√≥n MC_StopMotion, la distancia residual es la que existe entre la consigna
de posici√≥n actual y el destino de la instrucci√≥n cancelada. Con este valor se puede dar una
instrucci√≥n MC_MoveRelative para mover el eje al destino original despu√©s de la
cancelaci√≥n.

9HORFLGDG

Diagrama de evoluci√≥n de la se√±al de MC_StopMotion

7LHPSR

([HFXWH

%XV\

'RQH
 





'XUDQWHODHMHFXFL¬µQGHXQPRYLPLHQWRVHLQLFLDODLQVWUXFFL¬µQGHSDUDGD



$ODOFDQ]DUVHODYHORFLGDG0&B6WRS0RWLRQDFWLYDODVDOLGD'RQH



$OUHVHWHDUVH([HFXWHILQDOL]DODLQVWUXFFL¬µQGHSDUDGD

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6503

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

Execute

INPUT

BOOL

Inicio del proceso de frenado para un flanco ascendente.

Deceleration

INPUT

REAL

Deceleraci√≥n del eje para la rampa de frenado en [unidad de longitud/s2]
Si se introducen valores ‚â§ 0.0, se utilizar√° el valor de la deceleraci√≥n m√°xi‚Äê
ma del DB de eje.

Busy

OUTPUT

BOOL

1 = petici√≥n en curso.

Done

OUTPUT

BOOL

1 = petici√≥n finalizada sin errores.
El bit permanece activado hasta que se resetea "Execute", pero como m√≠‚Äê
nimo durante una llamada de la instrucci√≥n.

CommandAborted

OUTPUT

BOOL

1 = petici√≥n cancelada por modo manual en el regulador.

Error

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por haberse detectado un error de eje.
El bit permanece activado hasta que se resetea "Execute", pero como m√≠‚Äê
nimo durante una llamada de la instrucci√≥n.

MC_Control
Descripci√≥n
La instrucci√≥n MC_Control permite realizar la regulaci√≥n de posici√≥n con los drivers de entrada
y salida.
La instrucci√≥n MC_Control puede adoptar los siguientes estados del regulador:
‚óè Modo de regulaci√≥n
‚óè Modo de seguimiento
‚óè Modo manual

6504

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Modo de regulaci√≥n
La instrucci√≥n MC_Control
‚óè calcula la consigna de velocidad para el driver de salida a partir de la consigna de posici√≥n
de una instrucci√≥n de desplazamiento y el valor real de posici√≥n del driver de entrada.
‚óè vigila
‚Äì parada,
‚Äì aproximaci√≥n a destino,
‚Äì error de seguimiento.
‚óè procesa el acuse de errores (v√©ase Se√±alizaciones de error y acuse de errores).

Modo de seguimiento
En este estado se corrige la consigna de posici√≥n conforme al valor real de posici√≥n. El modo
de seguimiento se activa cuando la entrada "EnableDrive" = FALSE o tras un error de eje con
parada brusca (v√©ase Se√±alizaciones de error y confirmaci√≥n de errores). En el modo de
seguimiento, la salida "DriveEnabled" = FALSE.

Modo manual
En este estado se emite la consigna manual "ManVelocity" como consigna de velocidad. √âsta
se limita a "MaxVelocity". La consigna de posici√≥n se corrige conforme al valor de posici√≥n real.
Este estado se activa o desactiva mediante "ManEnable".
ADVERTENCIA
El modo manual es posible en todo momento, incluso aunque el eje se encuentre en estado
de error.

Funcionamiento
El algoritmo de regulaci√≥n de la instrucci√≥n MC_Control es un regulador P que se parametriza
mediante el par√°metro "Ganancia del regulador" ("FactorP").

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.
Llame la instrucci√≥n MC_Control una vez por eje sin condici√≥n en el OB seleccionado.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6505

Instrucciones
4.2 Instrucciones

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de
datos

Significado

EnableDrive

INPUT

BOOL

0 = bloquear accionamiento, el modo de seguimiento est√° activo.
1 = habilitar accionamiento, la regulaci√≥n de posici√≥n est√° activa.
Si no hay errores pendientes, se ajusta en consecuencia "DriveEnabled".

DriveEnabled

OUTPUT

BOOL

Habilitaci√≥n de accionamiento, la regulaci√≥n de posici√≥n est√° activa.
Si se ha activado "EnableDrive" y no hay errores pendientes, se activa "DriveE‚Äê
nabled". Si no se ha activado "DriveEnabled", el eje se encuentra en el modo de
seguimiento y no se vigila la parada del eje.
Esta se√±al debe utilizarse para controlar la entrada de habilitaci√≥n en la etapa de
potencia.

MC_Simulation
Descripci√≥n
La instrucci√≥n MC_Simulation permite probar el programa de desplazamiento, incluidos los
bloques driver. No se necesita periferia y el eje no se desplaza.

Funcionamiento
La instrucci√≥n MC_Simulation reacopla el valor de salida del regulador al driver de entrada,
simulando un valor de enc√≥der conforme al tipo de enc√≥der seleccionado en el DB de eje.
El modo de simulaci√≥n se activa activando en el DB de eje el bit "Sim" = TRUE.
Con la simulaci√≥n activada no es posible la b√∫squeda del punto de referencia. Parametrice
durante la simulaci√≥n la entrada "Velocity" de la instrucci√≥n MC_Home con 0.0. De esta forma
se ejecuta un posicionamiento del punto de referencia en lugar de una b√∫squeda del punto de
referencia.
Si durante el modo de simulaci√≥n se ejecuta un posicionamiento del punto de referencia,
tambi√©n se modificar√° el punto de referencia del eje real. Por tanto, tras desactivar el modo de
simulaci√≥n es preciso volver a sincronizar el eje.
Al activar y desactivar la simulaci√≥n, el eje se lleva al estado de parada de acuse obligatorio
(v√©ase Error con parada brusca) y adem√°s se activan todos los bits del campo de bits "Init.Ix"
en el DB de eje.
Si el modo de simulaci√≥n est√° activado, ocurre lo siguiente:
‚óè El driver de salida no emite ning√∫n valor a la periferia.
‚óè El driver de entrada no lee ning√∫n valor de enc√≥der de la periferia.
PELIGRO
Al activar el modo de simulaci√≥n, el eje debe encontrarse parado.

6506

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

MC_GearIn
Descripci√≥n
Con la instrucci√≥n MC_GearIn se puede acoplar la consigna de velocidad de un eje esclavo a
la consigna de velocidad de un eje maestro (acoplamiento de consigna) mediante un factor de
reducci√≥n.

Funcionamiento
Al detectarse un flanco ascendente en la entrada "Execute", la instrucci√≥n MC_GearIn acopla
un eje esclavo (par√°metro "Slave") a la consigna de velocidad y posici√≥n de un eje maestro
(par√°metro "Master") mediante el factor de reducci√≥n ajustado. Por tanto, se trata de una
instrucci√≥n de desplazamiento del eje esclavo.
Durante un desplazamiento acoplado en cada ciclo:
‚óè el trayecto recorrido por el eje esclavo desde la posici√≥n de acoplamiento =
el trayecto recorrido por el eje maestro desde la posici√≥n de acoplamiento √ó factor de
reducci√≥n
‚óè la velocidad del eje esclavo = velocidad de salida del reductor =
velocidad del eje maestro √ó factor de reducci√≥n
‚óè la aceleraci√≥n del eje esclavo =
la aceleraci√≥n del eje maestro √ó factor de reducci√≥n
‚óè la deceleraci√≥n del eje esclavo =
la deceleraci√≥n del eje maestro √ó factor de reducci√≥n
Para que el eje esclavo pueda seguir al eje maestro sin limitaciones, ajuste los siguientes
valores con un factor de reserva de 1,1 para el eje esclavo. Estos valores deben estar
permitidos y ser factibles:
‚óè Velocity(eje esclavo) =
Velocity (eje esclavo) √ó ABS (factor de reducci√≥n) √ó 1,1
‚óè Acceleration(eje esclavo) =
Acceleration (eje esclavo) √ó ABS (factor de reducci√≥n) √ó 1,1
‚óè Deceleration(eje esclavo) =
Deceleration (eje esclavo) √ó ABS (factor de reducci√≥n) √ó 1,1
Para realizar el desacoplamiento, active la instrucci√≥n de parada o bien cualquier instrucci√≥n
de desplazamiento para el eje esclavo.
Al igual que las dem√°s instrucciones de desplazamiento, la instrucci√≥n MC_GearIn puede
cancelar un desplazamiento y puede cancelarse autom√°ticamente.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6507

Instrucciones
4.2 Instrucciones
El eje esclavo puede acoplarse a un eje maestro que ya se est√© desplazando, y el eje esclavo
acelera o frena autom√°ticamente con las rampas parametrizadas en la instrucci√≥n de
reducci√≥n hasta que se haya alcanzado la velocidad de salida del reductor.
Cuando se alcanza por primera vez la velocidad de salida del reductor tras el inicio, se activa
la salida "InGear". Si en este momento no est√° activado "Execute", "InGear" estar√° activado
durante una llamada a la instrucci√≥n. "InGear" se resetea cuando Execute se desactiva, en
caso de error y cuando se cancela el desplazamiento.
Mientras la velocidad de salida del reductor sea alcanzable, el eje esclavo se desplaza tanto
en sincronismo de velocidad como de posici√≥n. La salida "Coupled" de la instrucci√≥n est√°
activada.
Si el eje esclavo no puede alcanzar la velocidad de salida del reductor, se desplazar√° con los
par√°metros de desplazamiento indicados en la instrucci√≥n de reducci√≥n. En tal caso, la salida
"Coupled" de la instrucci√≥n estar√° reseteada. En cuanto la velocidad de salida del reductor
vuelve a ser alcanzable, el eje esclavo se desplazar√° a dicha velocidad. La salida "Coupled"
de la instrucci√≥n se activa.
Mientras est√© activa la instrucci√≥n MC_GearIn para el eje esclavo, es posible activar
cualesquiera instrucciones de desplazamiento para el eje maestro, incluso con cancelaci√≥n de
un desplazamiento.
Excepci√≥n: Al referenciar el eje maestro se produce un desacoplamiento con un error
("Err.MasterErr").
El par√°metro de eje "Override" no tiene sentido para el eje esclavo y por tanto no se eval√∫a.
Particularidades en un eje esclavo como eje lineal:
‚óè Si se rebasa el m√°ximo recorrido durante un desplazamiento de reducci√≥n, la instrucci√≥n
MC_GearIn frena al eje esclavo con el mensaje de error "Err.DistanceErr" hasta parada
(v√©ase Desarrollo de movimientos de desplazamiento). El acoplamiento se deshace.
‚óè Un eje lineal no sincronizado no se vigila y por tanto puede desplazarse hasta su fin f√≠sico
sin frenar. Por tanto, es preciso terminar el desplazamiento a tiempo.
‚óè Un eje lineal sincronizado se frena al final de la zona de trabajo y se detiene en el final de
carrera por software. Se emite el mensaje de error "DistanceErr", as√≠ como
"Err.SWLimitMinExceeded" o "Err.SWLimitMaxExceeded". El acoplamiento se deshace.
ADVERTENCIA
Se pueden producir da√±os personales y materiales.
La instrucci√≥n MC_GearIn permite el desplazamiento hasta el fin f√≠sico del eje con un eje
lineal no sincronizado.
Para evitar da√±os personales y materiales es necesario tomar las medidas siguientes:
‚óè Instale un interruptor de PARADA DE EMERGENCIA en las inmediaciones del equipo.
S√≥lo as√≠ puede garantizarse que en caso de un fallo del software o del equipo sea posible
desconectar la instalaci√≥n de modo seguro.
‚óè Instale finales de carrera de seguridad que act√∫en directamente en las etapas de potencia
de todos los accionamientos.
‚óè Aseg√∫rese de que ninguna persona tenga acceso al √°rea de la instalaci√≥n donde hay
piezas en movimiento.

6508

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Particularidades en un eje esclavo como eje rotativo:
‚óè El recorrido de desplazamiento de la instrucci√≥n MC_GearIn no est√° limitado (giro
continuo).

Tratamiento de errores
Error en el eje maestro
‚óè Si el eje maestro detecta errores que dan lugar a una parada suave, se frena. El eje esclavo
realiza este movimiento acoplado, y no se desacopla. Si se confirma el error del eje maestro
y √©ste sigue movi√©ndose, el eje esclavo tambi√©n vuelve a arrancar.
‚óè Si el eje maestro detecta errores que dan lugar a una parada brusca, o si el eje maestro se
encuentra en el modo manual, la instrucci√≥n de reducci√≥n frena al eje esclavo y lo
desacopla. Emite el mensaje de error "Err.MasterErr".
Error en el eje esclavo
‚óè Si el eje esclavo detecta errores que dan lugar a una parada suave, la instrucci√≥n de
reducci√≥n frena el eje esclavo y lo desacopla.
‚óè Si el eje esclavo detecta errores que dan lugar a una parada brusca, el eje esclavo se
detiene y se desacopla.
‚óè El recorrido m√°ximo de un desplazamiento de acoplamiento en un eje lineal se limita a
224 incrementos o a 224 [unidad de longitud]. Si se rebasa este l√≠mite, la instrucci√≥n
MC_GearIn frena al eje esclavo, emite el mensaje de error acusable "DistanceErr" y lo
desacopla.
Error en el acoplamiento
‚óè Si el eje esclavo no puede alcanzar la velocidad de salida del reductor en el ciclo actual, se
desplazar√° con los par√°metros de desplazamiento indicados en la instrucci√≥n. Esto es
v√°lido en particular para el acoplamiento a un eje maestro en movimiento, as√≠ como al
frenar en caso de error.
El par√°metro "Coupled" se resetea, pero el acoplamiento no se deshace. En cuanto vuelven
a ser alcanzables los valores solicitados, el eje esclavo se desplaza seg√∫n dichos valores,
y se activa "Coupled".

Interacci√≥n de las instrucciones en el reductor
Al utilizar la instrucci√≥n de reducci√≥n tambi√©n debe tenerse en cuenta lo siguiente (v√©ase
tambi√©n "Estructura de un programa de usuario"):
‚óè El eje maestro y el eje esclavo deben llamarse en el mismo nivel de ejecuci√≥n.
‚óè El eje esclavo vuelve a orientarse en cada ciclo de mecanizado a las especificaciones del
eje maestro. Por tanto, las instrucciones del eje esclavo deben llamarse seg√∫n las
instrucciones del eje maestro. En particular, la instrucci√≥n de reducci√≥n del eje esclavo
debe llamarse despu√©s del regulador del eje maestro.
Otras secuencias de llamada, en particular la llamada anidada de las instrucciones del eje
maestro y el eje esclavo, pueden generar grandes errores de seguimiento entre los ejes.
‚óè En una aplicaci√≥n is√≥crona, los datos de periferia del eje maestro y del eje esclavo deben
encontrarse en la misma memoria imagen parcial de proceso.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6509

Instrucciones
4.2 Instrucciones
Dependiendo de la estructura seleccionada resulta por tanto una de las siguientes im√°genes:
2%GHDODUPD

2%GHDODUPD
(MHPDHVWUR
'ULYHUGHHQWUDGD

(MHPDHVWUR
'ULYHUGHHQWUDGD

(MHPDHVWUR
5HJXODGRU

(MHPDHVWUR
5HJXODGRU

(MHPDHVWUR
'ULYHUGHVDOLGD
(MH V HVFODYR V 
'ULYHUGHHQWUDGD

(MH V HVFODYR V 
5HGXFWRU

(MH V HVFODYR V 
,QVWUXFFL¬µQ HV GH
GHVSOD]DPLHQWR

(MH V HVFODYR V 
5HJXODGRU

(MH V HVFODYR V 
5HGXFWRU

(MHPDHVWUR
'ULYHUGHVDOLGD
(MH V HVFODYR V 
'ULYHUGHVDOLGD

'DWRVGHOHMHPDHVWUR

(MH V HVFODYR V 
,QVWUXFFL¬µQ HV GH
GHVSOD]DPLHQWR

'DWRVGHOHMHHVFODYR

'DWRVGHOHMHPDHVWUR

(MHPDHVWUR
,QVWUXFFL¬µQGH
GHVSOD]DPLHQWR

(MH V HVFODYR V 
5HJXODGRU
(MH V HVFODYR V 
'ULYHUGHVDOLGD

'DWRVGHOHMHHVFODYR

(MH V HVFODYR V 
,QVWUXFFL¬µQ HV GH
GHVSOD]DPLHQWR

(MH V HVFODYR V 
'ULYHUGHHQWUDGD

Diagrama de evoluci√≥n de la se√±al
La siguiente imagen muestra c√≥mo la instrucci√≥n de reducci√≥n asume el desplazamiento de un
eje, y c√≥mo se acopla a un eje maestro en movimiento. En este ejemplo, el factor de reducci√≥n
es 0,8. El eje esclavo no puede alcanzar la velocidad necesaria para mantener este factor.
El eje maestro se encuentra parado entre t = 0,5 y t = 0,72. El acoplamiento se mantiene.

6510

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
(MHPDHVWUR
'HVWLQR V Y D E 
WD UHVRO N3 
/,1($/,1&5



5HGXFWRU
'HVWLQR V Y Y D E 
WD UHVRO N3 
/,1($/,1&5

YW



Y>XV@

























W>V@
(MHPDHVWUR

(MHHVFODYR

&RXSOHG

,Q*HDU

([HFXWH

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de da‚Äê
tos

Descripci√≥n

Execute

INPUT

BOOL

Inicio del desplazamiento de reducci√≥n con un flanco positivo.

Rationumerator

INPUT

REAL

Numerador del factor de reducci√≥n
Factor de reducci√≥n = "RatioNumerator"/"RatioDenominator"
Si "RatioNumerator" < 0, el sentido de movimiento del eje maestro y del eje
esclavo son opuestos.
"RatioNumerator" = 0 se rechaza con "DataErr" = 1.
Es posible modificar el factor de reducci√≥n efectivo para un eje esclavo
cancelando la instrucci√≥n de reducci√≥n con otra instancia que tenga factor
de reducci√≥n modificado.

RatioDenominator

INPUT

INT

Denominador del factor de reducci√≥n; debe ser un entero ‚â• 1
Es posible modificar el factor de reducci√≥n efectivo para un eje esclavo
cancelando la instrucci√≥n de reducci√≥n con otra instancia que tenga factor
de reducci√≥n modificado.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6511

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de da‚Äê
tos

Descripci√≥n

Velocity

INPUT

REAL

Velocidad del eje en [unidad de longitud/s]
La velocidad que puede alcanzar el eje esclavo en un desplazamiento de
reducci√≥n queda limitada a este valor.

Acceleration

INPUT

REAL

Aceleraci√≥n del eje en [unidad de longitud/s2]
La aceleraci√≥n que puede alcanzar el eje esclavo en un desplazamiento
de reducci√≥n queda limitada a este valor.
Este par√°metro se utiliza cuando
‚óè el eje esclavo se acopla a un eje maestro que se mueve m√°s r√°pido,
‚óè el eje maestro se acelera m√°s de lo que permite el eje esclavo.

Deceleration

INPUT

REAL

Deceleraci√≥n del eje en [unidad de longitud/s2]
La deceleraci√≥n que puede alcanzar el eje esclavo en un desplazamiento
de reducci√≥n queda limitada a este valor.
Este par√°metro se utiliza cuando
‚óè un eje esclavo que ya est√° en movimiento se acopla a un eje maestro
m√°s lento,
‚óè el eje esclavo frena debido a un error,
‚óè el eje maestro se frena m√°s de lo que permite el eje esclavo.

Master

IN‚ÄëOUT

AXIS_REF

Remisi√≥n a los datos del eje maestro

Slave

IN‚ÄëOUT

AXIS_REF

Remisi√≥n a los datos del eje esclavo

Init

IN‚ÄëOUT

BOOL

La instrucci√≥n ejecuta su inicializaci√≥n con Init = TRUE y a continuaci√≥n
resetea el bit.

Busy

OUTPUT

BOOL

1 = petici√≥n en curso.

InGear

OUTPUT

BOOL

1 = velocidad de salida del reductor alcanzada
Se activa cuando la velocidad de salida del reductor se alcanza por pri‚Äê
mera vez. Si en este momento ya se ha reseteado Execute, InGear estar√°
pendiente de todas formas durante una llamada de la instrucci√≥n.
Se resetea cuando Execute se desactiva, en caso de error y al cancelarse
el desplazamiento.

Coupled

OUTPUT

BOOL

1 = el eje est√° acoplado al eje maestro en este momento
Indica en cada ciclo de mecanizado si se ha alcanzado la velocidad de
salida del reductor.

CommandAborted

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por otra petici√≥n.

Error

OUTPUT

BOOL

1 = la petici√≥n ha sido cancelada por haberse detectado un error de eje.
El bit permanece activado hasta que se resetea "Execute", pero como
m√≠nimo durante una llamada de la instrucci√≥n.

6512

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Driver de entrada
Funci√≥n de los drivers de entrada
Tarea
El driver de entrada sirve para detectar las posiciones reales de un eje. Lee la posici√≥n no
normalizada del eje y la convierte a la unidad de longitud elegida.
Para una serie de m√≥dulos de lectura de recorrido se dispone de drivers de entrada
adecuados, los cuales se describen a continuaci√≥n. Mediante la instrucci√≥n EncoderUniversal
(P√°gina 6535) es posible la adaptaci√≥n a configuraciones no soportadas directamente.

Inicializaci√≥n
‚óè En el caso de un enc√≥der incremental se resetea la sincronizaci√≥n con el eje (par√°metro
"Sync" = FALSE en los datos de eje). A continuaci√≥n es necesario volver a buscar el punto
de referencia o a posicionar el punto cero de la m√°quina.
‚óè En el caso de un enc√≥der absoluto se mantiene la sincronizaci√≥n con el eje.

Llamada
El driver de entrada de un eje debe llamarse sin condici√≥n.

Modo is√≥crono
Los drivers de entrada soportan el modo is√≥crono de los m√≥dulos de periferia adecuados. El
driver detecta el modo is√≥crono autom√°ticamente porque es llamado en un OB is√≥crono.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6513

Instrucciones
4.2 Instrucciones

Tratamiento de errores
Existen los siguientes mecanismos de detecci√≥n de errores:
‚óè Un error detectado por el programa de usuario (p. ej., m√≥dulo retirado o fallo de estaci√≥n)
puede notificarse al driver de entrada en la entrada "EncErr". Mientras la entrada "EncErr"
sea igual a TRUE, el driver de entrada no acceder√° al m√≥dulo de lectura de recorrido.
‚óè Algunos m√≥dulos de lectura de recorrido proporcionan informaci√≥n de errores que el driver
de entrada puede evaluar por s√≠ mismo.
‚óè Otros m√≥dulos de lectura de recorrido proporcionan informaci√≥n de errores solamente
mediante alarma de diagn√≥stico y registro 1 (DS1). Por tanto, es necesario:
‚Äì habilitar la alarma de diagn√≥stico para el m√≥dulo en la configuraci√≥n hardware, y
‚Äì comparar en el OB 82 la direcci√≥n proporcionada en el dato local "OB82_MDL_ADDR"
con la direcci√≥n del m√≥dulo. Si coinciden, ajuste el par√°metro "ReadDiagErr" del driver
de entrada a TRUE (tanto al aparecer como al desaparecer la alarma).
Mediante "ReadDiagErr" = TRUE se permite que el driver de entrada lea el registro 1 del
m√≥dulo con la instrucci√≥n RD_REC y lo guarde en el par√°metro est√°tico "DiagStatus".
A continuaci√≥n, ajusta "ReadDiagErr" = FALSE. El valor de retorno de la instrucci√≥n
RD_REC se guarda en el par√°metro est√°tico "JobErr"

Reacci√≥n a errores
‚óè En caso de error se activan las indicaciones "Error" y "Err.EncoderErr" en el DB de eje.
‚óè En un enc√≥der incremental, siempre se resetea el bit de estado "Sync" en el DB de eje.
‚óè En un enc√≥der absoluto, nunca se resetea el bit de estado "Sync" en el DB de eje.
Preste atenci√≥n tambi√©n al tratamiento espec√≠fico de errores en los siguientes cap√≠tulos sobre
los diferentes drivers.
Encontrar√° informaci√≥n detallada sobre la reacci√≥n a errores, la se√±alizaci√≥n de errores y su
acuse en "Se√±alizaciones de error y acuse de errores en el DB de eje".

Modo de simulaci√≥n
Mientras est√© activado el bit Sim en el DB de eje, el driver de entrada no acceder√° al m√≥dulo
de lectura de recorrido. Los valores del enc√≥der se simulan mediante la
instrucci√≥n MC_Simulation (P√°gina 6506).

EncoderIM178
Descripci√≥n
La instrucci√≥n EncoderIM178 est√° contenida en STEP7 V5.x por razones de compatibilidad.
El m√≥dulo IM 178‚Äë4 ya no se comercializa activamente. Como alternativa, se puede utilizar el
IM 174 .
El IM 178‚Äë4 debe utilizarse con el mismo n√∫mero de canal y el mismo eje en el driver de entrada
y en el driver de salida, pues hay determinados ajustes de direcciones que se refieren a ambos
drivers. No es posible mezclar con otros drivers.

6514

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Parametrizaci√≥n del IM 178‚Äë4 (configuraci√≥n hardware)
Seleccione el IM 178‚Äë4 en el cat√°logo de hardware, en "Periferia descentralizada". Configure
el slot 4 del IM 178‚Äë4 como ""4Word AA/12Word AE/Cons. 1Word".
Par√°metro

Ajuste

Sincronizaci√≥n

Software

Evaluaci√≥n de
flancos

Ascendente, descendente o ambos flancos.

Los dem√°s ajustes se parametrizan seg√∫n el enc√≥der conectado.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de datos

Descripci√≥n

EncErr

INPUT

BOOL

1 = error de enc√≥der
Aqu√≠ se comunica al driver de entrada un error detectado por el progra‚Äê
ma de usuario (p. ej., m√≥dulo retirado o fallo de estaci√≥n).

RefMode

INPUT

BOOL

Tipo de referenciaci√≥n:
0 = con entrada digital I0
1 = con entrada digital I1 y marca cero

DI_0

OUTPUT

BOOL

Entrada digital 0 del correspondiente canal del IM 178‚Äë4

DI_1

OUTPUT

BOOL

Entrada digital 1 del correspondiente canal del IM 178‚Äë4

DI_2

OUTPUT

BOOL

Entrada digital 2 del correspondiente canal del IM 178‚Äë4

Los siguientes par√°metros est√°ticos de la instrucci√≥n sirven solamente para fines de diagn√≥stico en caso de fallo.
Status.PARA

STAT

BOOL

PARA = TRUE: IM 178‚Äë4 se ha parametrizado correctamente en la
configuraci√≥n hardware.
PARA = FALSE: v√©ase Manual SIMATIC IM 178-4 Drive Interface
(http://support.automation.siemens.com/WW/view/en/1117389)

Status.EXTF0

STAT

BOOL

1 = fallo del cable de se√±al del enc√≥der

Status.EXTF1

STAT

BOOL

1 = error de enc√≥der

Status.EXTF2

STAT

BOOL

1 = error de marca cero

Sincronizaci√≥n
La sincronizaci√≥n se realiza alternativamente:
‚óè Mediante la b√∫squeda del punto de referencia (s√≥lo con enc√≥der incremental)
‚óè Mediante el posicionamiento del punto de referencia (con enc√≥der incremental y absoluto)
El sensor del punto de referencia se conecta a la entrada digital I0 o I1 dependiendo del ajuste.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6515

Instrucciones
4.2 Instrucciones
Para una b√∫squeda del punto de referencia, IM 178‚Äë4 puede detectar el punto de referencia a
elecci√≥n en los siguientes casos:
‚óè Con flanco descendente o ascendente o con ambos flancos en la entrada digital I0
(RefMode = 0).
‚óè Con el flanco ascendente de la primera marca cero tras detectarse el flanco descendente
en la entrada digital I1 (RefMode = 1).
Si el eje ya se encuentra en el sensor del punto de referencia al inicio de la b√∫squeda del punto
de referencia, se efectuar√° una referenciaci√≥n en la posici√≥n actual, al igual que en el
posicionamiento del punto de referencia.

Entradas digitales
Las entradas digitales I0 a I2 del canal seleccionado del IM 178‚Äë4 se indican en los par√°metros
de salida "DI_0" a "DI_2" del driver de entrada.

Tratamiento de errores
Como reacci√≥n a un error, el driver de entrada ajusta al detectar el error los identificadores de
error "Error" y "Err.EncoderErr" en el DB de eje. El driver de entrada desactiva el bit de estado
"Sync" en el DB de eje, si es que se utiliza un enc√≥der incremental. Para m√°s informaci√≥n,
consulte el Manual SIMATIC IM 178-4 Drive Interface (http://support.automation.siemens.com/
WW/view/en/1117389).
Encontrar√° informaci√≥n detallada sobre la reacci√≥n a errores, la se√±alizaci√≥n de errores y su
acuse en "Se√±alizaciones de error y acuse de errores en el DB de eje".

Acuse de errores
Si activa el acuse de errores en el DB de eje de Easy Motion Control, se acusar√°n tambi√©n los
errores pendientes en el m√≥dulo.

EncoderFM450
Descripci√≥n
La instrucci√≥n EncoderFM450 sirve para utilizar un canal del m√≥dulo FM 450‚Äë1 como m√≥dulo
de lectura de recorrido para enc√≥ders incrementales. El n√∫mero de canal se parametriza
mediante el DB de eje.

6516

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Parametrizaci√≥n del m√≥dulo (configuraci√≥n hardware)
El m√≥dulo FM 450‚Äë1 debe parametrizarse con los ajustes de acuerdo a la siguiente tabla.
Di√°logo

Ajuste

Selecci√≥n de alarmas

Habilitar alarma de diagn√≥stico

Modos de operaci√≥n

‚óè Rango de contaje: -31 a +31 bits
‚óè Modo de operaci√≥n: contaje sin fin
‚óè Control de puerta: ninguno

Entradas

Si desea realizar una b√∫squeda del punto de referencia, debe elegir el ajuste siguiente:
‚óè Sincronizaci√≥n: una vez
‚óè El ajuste "Evaluar marca cero para el posicionamiento" se puede activar o desactivar
como criterio para el punto de referencia.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n Tipo de datos

EncErr

INPUT

BOOL

Descripci√≥n
1 = error de enc√≥der
Aqu√≠ se comunica al driver de entrada un error detectado
por el programa de usuario (p. ej., m√≥dulo retirado o fallo
de estaci√≥n).

ReadDiagErr

IN‚ÄëOUT

BOOL

Active este bit en el OB 82 cuando el m√≥dulo haya dispa‚Äê
rado una alarma de diagn√≥stico (v√©ase m√°s abajo, en Tra‚Äê
tamiento de errores).

DI_0

OUTPUT

BOOL

Entrada digital 0 del canal seleccionado

DI_1

OUTPUT

BOOL

Entrada digital 1 del canal seleccionado

DI_2

OUTPUT

BOOL

Entrada digital 2 del canal seleccionado

Los siguientes par√°metros est√°ticos de la instrucci√≥n sirven solamente para fines de diagn√≥stico en caso de fallo.
JobErr

STAT

INT

Valor de retorno de la instrucci√≥n RD_REC si se ha acti‚Äê
vado "ReadDiagErr" = TRUE.

DiagStatus.EXT_VOLTAGE

STAT

STRUCT

Fallo en la tensi√≥n auxiliar externa

DiagStatus.CONFIG_ERR

STAT

STRUCT

Error de parametrizaci√≥n

DiagStatus.WTCH_DOG_FLT

STAT

STRUCT

La vigilancia de tiempo (watchdog) ha saltado

DiagStatus.RAM_FLT

STAT

STRUCT

Defecto en RAM

DiagStatus.CH1_SIGA

STAT

STRUCT

Canal 1 Se√±al A err√≥nea

DiagStatus.CH1_SIGB

STAT

STRUCT

Canal 1 Se√±al B err√≥nea

DiagStatus.CH1_SIGZ

STAT

STRUCT

Canal 1 Se√±al N err√≥nea

DiagStatus.CH1_BETW

STAT

STRUCT

Canal 1 Error entre canales

DiagStatus.CH1_5V2

STAT

STRUCT

Canal 1 Alimentaci√≥n del enc√≥der 5,2 V err√≥nea

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6517

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n Tipo de datos

Descripci√≥n

DiagStatus.CH2_SIGA

STAT

STRUCT

Canal 2 Se√±al A err√≥nea

DiagStatus.CH2_SIGB

STAT

STRUCT

Canal 2 Se√±al B err√≥nea

DiagStatus.CH2_SIGZ

STAT

STRUCT

Canal 2 Se√±al N err√≥nea

DiagStatus.CH2_BETW

STAT

STRUCT

Canal 2 Error entre canales

DiagStatus.CH2_5V2

STAT

STRUCT

Canal 2 Alimentaci√≥n del enc√≥der 5,2 V err√≥nea

Sincronizaci√≥n
La sincronizaci√≥n se puede realizar
‚óè mediante b√∫squeda del punto de referencia
‚óè mediante posicionamiento del punto cero de la m√°quina.
Conecte el sensor del punto de referencia a la entrada digital I2.
En una b√∫squeda del punto de referencia, el m√≥dulo puede detectar el punto de referencia a
elecci√≥n en los siguientes casos:
‚óè con un flanco ascendente en la entrada digital I2, o bien
‚óè con el flanco ascendente de la marca cero, si la entrada digital I2 est√° activada.
Si el eje ya se encuentra en el sensor del punto de referencia al inicio de la b√∫squeda del punto
de referencia, se efectuar√° una referenciaci√≥n en la posici√≥n actual, al igual que en el
posicionamiento del punto de referencia.

Entradas digitales
Las entradas digitales I0 a I2 del canal seleccionado se indican en los par√°metros de salida
"DI_0" a "DI_2" del driver de entrada.

Tratamiento de errores
El m√≥dulo proporciona informaci√≥n de errores a trav√©s del registro 1 (DS1). En los siguientes
casos, el driver de entrada lee el registro 1 del m√≥dulo mediante la instrucci√≥n RD_REC y lo
almacena en el par√°metro est√°tico "DiagStatus":
‚óè El driver de entrada se inicializa.
‚óè El m√≥dulo notifica que ha detectado un error.
‚óè El par√°metro de entrada "ReadDiagErr" del driver es TRUE.
A continuaci√≥n, ajusta "ReadDiagErr" = FALSE. El valor de retorno de la instrucci√≥n RD_REC
se guarda en el par√°metro est√°tico "JobErr" (v√©ase Avisos JOB_Err).
Si se ha registrado una se√±alizaci√≥n de errores en el registro 1, el driver de entrada ajusta en
el DB de eje los identificadores de error "Error" y "Err.EncoderErr" a TRUE. El bit de estado
"Sync" se ajusta a FALSE.

6518

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Encontrar√° informaci√≥n detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse
de errores en Se√±alizaci√≥n y acuse de errores en el DB de eje.
Nota
Si utiliza un FM 450‚Äë1 con un solo canal, debe parametrizar el segundo canal con el tipo de
enc√≥der "24 V pista A+B con desplazamiento de fase", pues de lo contrario √©ste enviar√°
c√≠clicamente alarmas de diagn√≥stico (p. ej., debido a una conexi√≥n err√≥nea).

EncoderET200S1SSI
Descripci√≥n
La instrucci√≥n EncoderET200S1SSI sirve para utilizar el m√≥dulo ET 200S 1SSI Fast Mode
como m√≥dulo de lectura de recorrido para enc√≥ders absolutos.
El driver tambi√©n se puede utilizar para la variante is√≥crona de este m√≥dulo.

Parametrizaci√≥n del m√≥dulo ET 200S 1SSI Fast Mode (configuraci√≥n hardware)
El driver de entrada solamente es adecuado para el m√≥dulo 1SSI con el ajuste de par√°metro
"Fast Mode" como modo de funcionamiento. En el TIA Portal, el "Fast Mode" ya no se
selecciona a trav√©s del m√≥dulo, sino que se ajusta como modo de funcionamiento.
Seleccione el m√≥dulo en el cat√°logo hardware bajo "Periferia descentralizada > ET 200S > FM
> Lectura de recorrido".
Par√°metro

Ajuste

Diagn√≥stico colectivo

Se puede activar si desea realizar una evaluaci√≥n en su programa.

Detecci√≥n

Libre

Inversi√≥n del sentido
de giro

Desactivada

Modo de funciona‚Äê
miento

Fast Mode

El sentido de giro puede invertirse mediante las instrucciones de Easy Motion Control (par√°metro
"Correcci√≥n de sentido del enc√≥der").

Los dem√°s ajustes se parametrizan seg√∫n el enc√≥der conectado.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6519

Instrucciones
4.2 Instrucciones

Par√°metro
Par√°metro

Declaraci√≥n Tipo de da‚Äê
tos

EncErr

INPUT

BOOL

Descripci√≥n
1 = error de enc√≥der
Aqu√≠ se comunica al driver de entrada un error detectado por el programa
de usuario (p. ej., m√≥dulo retirado o fallo de estaci√≥n).

Los siguientes par√°metros est√°ticos de la instrucci√≥n sirven solamente para fines de diagn√≥stico en caso de fallo.
Status.STS_UP

STAT

BOOL

Sentido hacia delante: los valores del enc√≥der aumentan

Status.STS_DN

STAT

BOOL

Sentido hacia atr√°s: los valores del enc√≥der disminuyen

Status.STS_DI

STAT

BOOL

Estado de la entrada digital

Status.EXTF

STAT

BOOL

Error agrupado o cortocircuito de la alimentaci√≥n del enc√≥der

Status.ERR_PARA

STAT

BOOL

Error de parametrizaci√≥n

Status.RDY

STAT

BOOL

El m√≥dulo est√° listo para el funcionamiento

Sincronizaci√≥n
El m√≥dulo ET 200S 1SSI Fast Mode permite la sincronizaci√≥n solamente mediante
posicionamiento del punto cero de la m√°quina.

Tratamiento de errores
Si el driver de entrada detecta una se√±alizaci√≥n de error del m√≥dulo, activa los identificadores
de error "Error" y "Err.EncoderErr" en el DB de eje.
Encontrar√° informaci√≥n detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse
de errores en Se√±alizaci√≥n y acuse de errores en el DB de eje.

EncoderAbsSensorDP
Descripci√≥n
La instrucci√≥n EncoderAbsSensorDP sirve para utilizar el enc√≥der absoluto SIMODRIVE
sensor con PROFIBUS DP para la lectura de posici√≥n.

6520

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Parametrizaci√≥n del enc√≥der absoluto SIMODRIVE sensor (configuraci√≥n hardware)
Seleccione en el cat√°logo de hardware el enc√≥der "PROFIBUS DP > ENC√ìDER >
SIMODRIVE sensor > Versi√≥n 2.2 Singleturn o Versi√≥n 2.2 Multiturn". Si el SIMODRIVE sensor
a√∫n no est√° disponible, int√©grelo sirvi√©ndose del archivo GSD correspondiente. A continuaci√≥n
encontrar√° el enc√≥der en la carpeta "Otros dispositivos de campo > PROFIBUS DP > Enc√≥der
> Siemens AG > SIMODRIVE sensor".
Par√°metro

Ajuste

Sentido de contaje

Ascendente en sentido horario
El sentido de giro puede invertirse mediante las instrucciones de Easy Motion
Control (par√°metro "Correcci√≥n de sentido del enc√≥der").
Multiturn

Singleturn

Funci√≥n de escalado

activada

activada

Incrementos de medida deseados
(high)

0

-

Incrementos de medida deseados (low) 4096

4096

Incrementos de medida f√≠sicos (high)

0

-

Incrementos de medida f√≠sicos (low)

4096

4096

Resoluci√≥n deseada por

Vuelta

Vuelta

Resoluci√≥n total (high)

256

-

Resoluci√≥n total (low)

0

4096

Modo de puesta en marcha

Desactivado

Desactivado

Diagn√≥stico m√°s corto

No

No

Final de carrera inferior

Desactivado

Desactivado

Final de carrera inferior (high)

0

-

Final de carrera inferior (low)

0

0

Final de carrera superior

Desactivado

Desactivado

Final de carrera superior (high)

0

-

Final de carrera superior (low)

32767

4096

Salida de velocidad

Incrementos/1000 ms

Incrementos/1000 ms

La adaptaci√≥n a la unidad de longitud elegida se realiza con las instrucciones de Easy Motion
Control. Por tanto, el enc√≥der se puede parametrizar de forma fija (como se indica m√°s arriba).
Un "Teach-In" del enc√≥der no es necesario (v√©ase Instrucciones de uso del enc√≥der absoluto
SIMODRIVE sensor con PROFIBUS DP (http://support.automation.siemens.com/WW/
view/en/28813901)).
En el par√°metro "Incrementos por vuelta del enc√≥der" de Easy Motion Control, introduzca 4096
("StepsPerRev).

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6521

Instrucciones
4.2 Instrucciones

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de
datos

EncErr

INPUT

BOOL

Descripci√≥n
1 = error de enc√≥der
Aqu√≠ se comunica al driver de entrada un error detectado por el
programa de usuario (p. ej., m√≥dulo retirado o fallo de estaci√≥n).

Los siguientes par√°metros est√°ticos de la instrucci√≥n sirven solamente para fines de diagn√≥stico en caso de fallo.
Status.Ready

STAT

BOOL

1 = el enc√≥der est√° listo para el funcionamiento

Status.Mode

STAT

BOOL

Modo de operaci√≥n: 0 = modo de puesta en marcha, 1 = modo
normal

Status.SWLimitExceeded

STAT

BOOL

1 = final de carrera por software MIN o MAX ha reaccionado

Status.Dir

STAT

BOOL

Sentido de giro: 0 = sentido horario, 1 = sentido antihorario

Sincronizaci√≥n
Con el enc√≥der absoluto SIMODRIVE sensor es posible una sincronizaci√≥n solamente
mediante posicionamiento del punto de referencia.

Tratamiento de errores
Si el driver de entrada detecta que hay pendiente un mensaje de error del enc√≥der, activa los
identificadores de error "Error" y "Err.EncoderErr" en el DB de eje. Encontrar√° informaci√≥n
detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse de errores en
Se√±alizaci√≥n y acuse de errores en el DB de eje.

EncoderSM338
Descripci√≥n
La instrucci√≥n EncoderSM338 sirve para utilizar el SM 338 POS_INPUT como m√≥dulo de
lectura de recorrido para enc√≥ders absolutos.
El driver tambi√©n se puede utilizar para la variante is√≥crona de este m√≥dulo.

Parametrizaci√≥n del SM 338 (configuraci√≥n hardware)
La funci√≥n FREEZE debe estar desactivada.
Si el driver de entrada detecta el estado FREEZE de la entrada del enc√≥der, activa los
identificadores de error "Error" y "Err.EncoderErr" en el DB de eje.
Los dem√°s ajustes se parametrizan seg√∫n el enc√≥der conectado.

6522

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n Tipo de
datos

Descripci√≥n

EncErr

INPUT

1 = error de enc√≥der

BOOL

Aqu√≠ se comunica al driver de entrada un error detectado por el
programa de usuario (p. ej., m√≥dulo retirado o fallo de estaci√≥n).
ReadDiagErr

IN‚ÄëOUT

BOOL

Active este bit en el OB 82 cuando el m√≥dulo haya disparado una
alarma de diagn√≥stico (v√©ase Tratamiento de errores).

Los siguientes par√°metros est√°ticos de la instrucci√≥n sirven solamente para fines de diagn√≥stico en caso de fallo.
Freeze

STAT

BOOL

Estado FREEZE de la entrada de enc√≥der

JobErr

STAT

INT

Valor de retorno de la instrucci√≥n RD_REC si se ha activado
"ReadDiagErr" = TRUE.

DiagStatus.EXT_VOLTAGE

STAT

STRUCT

Fallo en la tensi√≥n auxiliar externa

DiagStatus.CONFIG_ERR

STAT

STRUCT

Error de parametrizaci√≥n

DiagStatus.WTCH_DOG_FLT

STAT

STRUCT

La vigilancia de tiempo (watchdog) ha saltado

DiagStatus.RAM_FLT

STAT

STRUCT

Defecto en RAM

DiagStatus.CH0_INTF

STAT

STRUCT

Error de configuraci√≥n o de parametrizaci√≥n (error de canal in‚Äê
terno)

DiagStatus.CH0_EXTF

STAT

STRUCT

Error de enc√≥der (error de canal externo)

Sincronizaci√≥n
Con el SM 338 la sincronizaci√≥n solamente es posible mediante posicionamiento del punto de
referencia.

Tratamiento de errores
El m√≥dulo proporciona informaci√≥n de errores solamente mediante la alarma de diagn√≥stico y
el registro 1 (DS1). Por tanto, es necesario:
‚óè habilitar la alarma de diagn√≥stico para el m√≥dulo en la configuraci√≥n hardware, y
‚óè comparar en el OB 82 la direcci√≥n proporcionada en el dato local "OB82_MDL_ADDR" con
la direcci√≥n del m√≥dulo. Si coinciden, ajuste el par√°metro ReadDiagErr del driver de entrada
a TRUE (tanto al aparecer como al desaparecer la alarma).
Con "ReadDiagErr" = TRUE el driver de entrada lee el registro 1 del m√≥dulo mediante la
instrucci√≥n RD_REC y lo guarda en el par√°metro est√°tico "DiagStatus".
A continuaci√≥n, ajusta "ReadDiagErr" = FALSE. El valor de retorno de la instrucci√≥n
RD_REC se guarda en el par√°metro est√°tico "JobErr" (v√©ase Avisos JOB_Err).
Si se ha registrado una se√±alizaci√≥n de errores en el registro 1, el driver de entrada ajusta en
el DB de eje los identificadores de error "Error" y "Err.EncoderErr" a TRUE.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6523

Instrucciones
4.2 Instrucciones
Encontrar√° informaci√≥n detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse
de errores en Se√±alizaci√≥n y acuse de errores en el DB de eje.

EncoderET200S1Count
Descripci√≥n
La instrucci√≥n EncoderET200S1Count sirve para utilizar el m√≥dulo ET 200S 1Count5V o
1Count24V como m√≥dulo de lectura de recorrido para enc√≥ders incrementales.
El driver tambi√©n se puede utilizar para la variante is√≥crona de este m√≥dulo.

Parametrizaci√≥n del m√≥dulo ET 200S 1Count (configuraci√≥n hardware)
El driver de entrada solamente es adecuado para los m√≥dulos "1 Count 5V" o "1 Count 24V"
del cat√°logo de hardware. El modo de contaje ya no se selecciona mediante el m√≥dulo, sino
como modo de funcionamiento.
Seleccione el m√≥dulo desde el cat√°logo de hardware bajo "Periferia descentralizada >
ET 200S > FM > Contaje".
Par√°metro

Ajuste

Diagn√≥stico colectivo

Se puede activar si desea realizar una evaluaci√≥n en su programa.

Modo de contaje

Contaje sin fin

Funci√≥n DI,

‚óè Si desea realizar una b√∫squeda del punto de referencia, seleccione

Sincronizaci√≥n

‚Äì

Funci√≥n DI = sincronizaci√≥n con flanco ascendente y

‚Äì

Sincronizaci√≥n = una vez.

‚óè De lo contrario, seleccione:
‚Äì

Funci√≥n DI = entrada

Funci√≥n de puerta

Cualquiera

Modo de funciona‚Äê
miento

Contaje

Los dem√°s ajustes se parametrizan seg√∫n el enc√≥der conectado.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

6524

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metro
Par√°metro

Declaraci√≥n Tipo de da‚Äê Descripci√≥n
tos

EncErr

INPUT

BOOL

1 = error de enc√≥der
Aqu√≠ se comunica al driver de entrada un error detectado por el pro‚Äê
grama de usuario (p. ej., m√≥dulo retirado o fallo de estaci√≥n).

DOut_1

INPUT

BOOL

Salida digital 1

DOut_2

INPUT

BOOL

Salida digital 2 (s√≥lo existe en 1Count5V)

DIn

OUTPUT

BOOL

Entrada digital del m√≥dulo

Los siguientes par√°metros est√°ticos de la instrucci√≥n sirven solamente para fines de diagn√≥stico en caso de fallo.
Status.ERR_ENCODER

BOOL

Cortocircuito/rotura de hilo se√±al de enc√≥der (s√≥lo en 1Count5V)

Status.ERR_DO2

STAT

BOOL

Cortocircuito/rotura de hilo/sobretemperatura DO2

Status.ERR_PARA

BOOL

Error de parametrizaci√≥n

Status.ERR_DO1

BOOL

Cortocircuito/rotura de hilo/sobretemperatura DO1

Status.ERR_24V

BOOL

Cortocircuito en la alimentaci√≥n del enc√≥der

(s√≥lo en 1Count5V)

Sincronizaci√≥n
La sincronizaci√≥n se realiza alternativamente:
‚óè Mediante b√∫squeda del punto de referencia
‚óè mediante posicionamiento del punto de referencia
Conecte el sensor del punto de referencia a la entrada digital DI.
En una b√∫squeda del punto de referencia, el m√≥dulo ET 200S 1Count puede detectar el punto
de referencia con un flanco ascendente en la entrada digital DI.
Si el eje ya se encuentra en el sensor del punto de referencia al inicio de la b√∫squeda del punto
de referencia, se efectuar√° una referenciaci√≥n en la posici√≥n actual, al igual que en el
posicionamiento del punto de referencia.

Entrada digital
La entrada digital del m√≥dulo se indica en el par√°metro de salida "DIn" del driver de entrada.

Salidas digitales
Las salidas digitales se pueden controlar mediante los par√°metros de entrada "DOut_1" y
"DOut_2" del driver de entrada.

Tratamiento de errores
Si el driver de entrada detecta una se√±alizaci√≥n de error del m√≥dulo, activa los identificadores
de error "Error" y "Err.EncoderErr" en el DB de eje y desactiva el bit de estado "Sync" en el DB
de eje.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6525

Instrucciones
4.2 Instrucciones
Encontrar√° informaci√≥n detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse
de errores en Se√±alizaci√≥n y acuse de errores en el DB de eje.

EncoderFM350
Descripci√≥n
La instrucci√≥n EncoderFM350 sirve para utilizar el m√≥dulo FM 350‚Äë1 como m√≥dulo de lectura
de recorrido para enc√≥ders incrementales.
El driver tambi√©n se puede utilizar para la variante is√≥crona de este m√≥dulo.

Parametrizaci√≥n del m√≥dulo (configuraci√≥n hardware)
Di√°logo

Ajuste

Selecci√≥n de alarmas

Habilitar alarmas de diagn√≥stico

Modos de operaci√≥n

‚óè Rango de contaje: -31 a +31 bits
‚óè Modo de operaci√≥n: contaje sin fin
‚óè Control de puerta: ninguno

Entradas

Si desea realizar una b√∫squeda del punto de referencia, debe elegir el ajuste siguiente:
‚óè Activar contador (DI-Set): una vez
‚óè El ajuste "Evaluar marca cero para el posicionamiento" se puede activar o desactivar como
criterio para el punto de referencia.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n Tipo de
datos

Descripci√≥n

EncErr

INPUT

1 = error de enc√≥der

BOOL

Aqu√≠ se comunica al driver de entrada un error detectado por el
programa de usuario (p. ej., m√≥dulo retirado o fallo de estaci√≥n).
ReadDiagErr

IN‚ÄëOUT

BOOL

Active este bit en el OB 82 cuando el m√≥dulo haya disparado
una alarma de diagn√≥stico (v√©ase Tratamiento de errores).

DI_0

OUTPUT

BOOL

Entrada digital 0

DI_1

OUTPUT

BOOL

Entrada digital 1

DI_2

OUTPUT

BOOL

Entrada digital 2

Los siguientes par√°metros est√°ticos de la instrucci√≥n sirven solamente para fines de diagn√≥stico en caso de fallo.

6526

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n Tipo de
datos

Descripci√≥n

JobErr

STAT

INT

Valor de retorno de la instrucci√≥n RD_REC si se ha activado
"ReadDiagErr" = TRUE.

DiagStatus.EXT_VOLTAGE

STAT

STRUCT

Fallo en la tensi√≥n auxiliar externa

DiagStatus.NO_CONFIG

STAT

STRUCT

Falta parametrizaci√≥n

DiagStatus.CONFIG_ERR

STAT

STRUCT

Error de parametrizaci√≥n

DiagStatus.WTCH_DOG_FLT

STAT

STRUCT

La vigilancia de tiempo (watchdog) ha saltado

DiagStatus.RAM_FLT

STAT

STRUCT

Defecto en RAM

DiagStatus.CH1_SIGA

STAT

STRUCT

Se√±al A err√≥nea

DiagStatus.CH1_SIGB

STAT

STRUCT

Se√±al B err√≥nea

DiagStatus.CH1_SIGZ

STAT

STRUCT

Se√±al N err√≥nea

DiagStatus.CH1_BETW

STAT

STRUCT

Error entre canales

DiagStatus.CH1_5V2

STAT

STRUCT

Fallo en alimentaci√≥n de 5,2 V del enc√≥der

Sincronizaci√≥n
La sincronizaci√≥n se puede realizar
‚óè mediante b√∫squeda del punto de referencia
‚óè mediante posicionamiento del punto cero de la m√°quina.
Conecte el sensor del punto de referencia a la entrada digital I2.
En una b√∫squeda del punto de referencia, el m√≥dulo puede detectar el punto de referencia a
elecci√≥n en los siguientes casos:
‚óè Flanco ascendente en la entrada digital I2
‚óè Flanco ascendente de la marca cero, si la entrada digital I2 est√° activada.
Si el eje ya se encuentra en el sensor del punto de referencia al inicio de la b√∫squeda del punto
de referencia, se efectuar√° una referenciaci√≥n en la posici√≥n actual, al igual que en el
posicionamiento del punto de referencia.

Entradas digitales
Las entradas digitales I0 a I2 se indican en los par√°metros de salida "DI_0" a "DI_2" del driver
de entrada.

Tratamiento de errores
El m√≥dulo proporciona informaci√≥n de errores a trav√©s del registro 1 (DS1). En los siguientes
casos, el driver de entrada lee el registro 1 del m√≥dulo mediante la instrucci√≥n RD_REC y lo
almacena en el par√°metro est√°tico "DiagStatus":
‚óè El driver de entrada se inicializa.
‚óè El m√≥dulo notifica que ha detectado un error.
‚óè El par√°metro de entrada "ReadDiagErr" del driver es TRUE.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6527

Instrucciones
4.2 Instrucciones
A continuaci√≥n, ajusta "ReadDiagErr" = FALSE. El valor de retorno de la instrucci√≥n RD_REC
se guarda en el par√°metro est√°tico "JobErr" (v√©ase Avisos JOB_Err).
Si se ha registrado una se√±alizaci√≥n de errores en el registro 1, el driver de entrada ajusta en
el DB de eje los identificadores de error "Error" y "Err.EncoderErr" a TRUE. El bit de estado
"Sync" se ajusta a FALSE.
Encontrar√° informaci√≥n detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse
de errores en Se√±alizaci√≥n y acuse de errores en el DB de eje.

EncoderCPU314C
Descripci√≥n
La instrucci√≥n EncoderCPU314C sirve para conectar un canal de contaje de la CPU 314C para
la lectura de recorrido para enc√≥ders incrementales de 24 V.
Pueden utilizarse hasta 4 canales de contaje.

Parametrizaci√≥n de la funci√≥n de contaje de la CPU 314C (configuraci√≥n hardware)
El driver de entrada solamente es apto para una CPU 314C a partir de la versi√≥n de firmware
V2.0.
Ajuste para cada canal de contaje que desee utilizar los siguientes par√°metros en el di√°logo de
propiedades del m√≥dulo en el slot 2.7 (contaje):
Par√°metro

Ajuste

Modo de opera‚Äê
ci√≥n

Contaje sin fin

Puerta HW

Sin puerta HW (casilla de verificaci√≥n desactivada)

Los dem√°s ajustes se parametrizan en funci√≥n del enc√≥der conectado y de los requisitos de su
aplicaci√≥n.
En los datos de eje del par√°metro "Direcci√≥n inicial de las entradas del m√≥dulo de lectura de
recorrido" ("InputModuleInAddress"), introduzca la direcci√≥n que ha asignado en la
configuraci√≥n hardware para las entradas en el slot 2.7 (contaje). El par√°metro "Direcci√≥n
inicial de las salidas del m√≥dulo de lectura de recorrido" ("InputModuleOutAddress") se ajusta
con la direcci√≥n de las salidas de contaje.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

6528

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de da‚Äê
tos

Descripci√≥n

EncErr

INPUT

BOOL

1 = error de enc√≥der
Aqu√≠ se notifica al driver de entrada un error detectado
por el programa de usuario.

Sincronizaci√≥n
La sincronizaci√≥n se puede realizar
‚óè mediante b√∫squeda del punto de referencia
‚óè mediante posicionamiento del punto cero de la m√°quina.
El sensor del punto de referencia se conecta en la entrada digital Latch del canal
correspondiente (DI1.4 para canal 0 hasta DI1.7 para canal 3).
En una b√∫squeda del punto de referencia, la CPU 314C puede detectar el punto de referencia
con un flanco ascendente en la entrada digital DI.
Si el eje ya se encuentra en el sensor del punto de referencia al inicio de la b√∫squeda del punto
de referencia, se efectuar√° una referenciaci√≥n en la posici√≥n actual, al igual que en el
posicionamiento del punto de referencia.
En una b√∫squeda del punto de referencia, el driver lee c√≠clicamente, entre otros, el estado del
sensor del punto de referencia. Los accesos necesarios para ello requieren un tiempo de
ejecuci√≥n claramente superior de la instrucci√≥n.

M√°xima frecuencia de contaje
Nota
Si se rebasa la m√°xima frecuencia de contaje del contador CPU 314C, no se emiten valores de
contaje (v√©ase Instrucciones de servicio SIMATIC S7-300 CPU 31xC Funciones tecnol√≥gicas
(http://support.automation.siemens.com/WW/view/es/12429336)). El eje se detiene con el
error "Error de seguimiento rebasado".

Por tanto, defina la velocidad m√°xima ("MaxVelocity") en los datos de eje teniendo en cuenta
la frecuencia l√≠mite del contador.

Tratamiento de errores
La CPU 314C no proporciona informaci√≥n de errores a trav√©s del enc√≥der.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6529

Instrucciones
4.2 Instrucciones

EncoderIM174
Descripci√≥n
La instrucci√≥n EncoderIM174 sirve para utilizar el IM 174 como m√≥dulo de lectura de recorrido
para enc√≥ders incrementales y absolutos.
El IM 174 ofrece hasta 4 ejes. Para cada eje se necesita una instrucci√≥n de driver
EncoderIM174.

Parametrizaci√≥n del IM 174 (configuraci√≥n hardware)
A√±ada un IM 174 a un PROFIBUS DP is√≥crono del proyecto. Tenga en cuenta que las
direcciones de entrada y salida se encuentran en la memoria imagen de proceso de la CPU.
En caso necesario, corrija las direcciones adapt√°ndolas manualmente. Asigne las direcciones
de entrada/salida a una memoria imagen parcial de proceso. En la configuraci√≥n de la CPU S7
debe asignarse un OB is√≥crono a la memoria imagen parcial de proceso.
Par√°metro

Ajuste

Direcci√≥n de E/S

Para el eje que se va a utilizar en Easy Motion Control, debe indicarse la
primera direcci√≥n de entrada en el DB de eje. (p. ej., slot 4: direcci√≥n I 256
a 273, entonces debe indicarse la direcci√≥n de entrada 256)

Selecci√≥n de telegramas

En la configuraci√≥n hardware se puede seleccionar para cada eje el tele‚Äê
grama 3 o el telegrama 81 de PROFIBUS. Esta informaci√≥n debe indicarse
tambi√©n en la entrada TelNumber de la instrucci√≥n EncoderIM174.

Modo conforme 611U

Para utilizar una marca de referencia externa es preciso activar el modo
conforme 611U.

Nota
Si se utiliza el telegrama 81, solamente se transmitir√° la informaci√≥n del enc√≥der desde el
IM 174 a la CPU. El telegrama 81 se utiliza si s√≥lo se desea leer un enc√≥der con el IM 174.
En este caso tampoco se necesita driver de salida para el IM 174 (OutputIM174).

Nota
De forma est√°ndar, la configuraci√≥n hardware integra el m√≥dulo IM 174 como m√≥dulo is√≥crono.
Debido al procesamiento is√≥crono, las direcciones de entrada y salida del IM 174 se
encuentran en la memoria imagen de proceso de la CPU.
Para informaci√≥n m√°s detallada sobre el modo is√≥crono en SIMATIC S7, consulte el Manual
de funciones Modo is√≥crono (http://support.automation.siemens.com/WW/view/en/
15218045).
La instrucci√≥n de driver EncoderIM174 presupone el procesamiento is√≥crono. Si no se tiene en
cuenta esta condici√≥n, la instrucci√≥n no puede acceder a las direcciones de hardware.

6530

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Parametrizaci√≥n del IM 174 en el DB de eje
La direcci√≥n de entrada ajustada para este eje en la configuraci√≥n hardware debe indicarse en
el campo "Direcci√≥n del m√≥dulo Entradas".
El n√∫mero de eje para el IM 174 es calculado por el driver de entrada EncoderIM174 durante
el funcionamiento. Se puede leer en los datos locales del correspondiente DB.
El driver de entrada EncoderIM174 calcula durante el funcionamiento el tiempo de ciclo
ajustado en PROFIBUS DP is√≥crono y lo introduce en el DB de eje. Por tanto, se recomienda
encarecidamente volver a leer el DB de eje modificado del controlador, a fin de adoptar los
posibles cambios.

Llamada
La instrucci√≥n se llama en un OB de alarma is√≥crona (p. ej. OB 61). Todas las instrucciones
EMC de un eje deben llamarse en un mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n Tipo de
datos

Descripci√≥n

RefMode

INPUT

Tipo de referenciaci√≥n:

INT

‚óè 0 = marca cero del enc√≥der
‚óè 1 = flanco ascendente en marca cero externa (presupone modo conforme
611U).
‚óè 4 = palpador 1 flanco ascendente
‚óè 5 = palpador 1 flanco descendente
‚óè 6 = palpador 2 flanco ascendente
‚óè 7 = palpador 2 flanco descendente
TelNumber

INPUT

INT

N√∫mero del telegrama PROFIBUS utilizado:
‚óè 3 = telegrama PROFIBUS 3
‚óè 81 = telegrama PROFIBUS 81

Err_ID

OUTPUT

WORD

C√≥digo de error de la instrucci√≥n:
‚óè W#16#0001 = OB err√≥neo, la instrucci√≥n s√≥lo puede instalarse en el OB 6x
‚óè W#16#0002 = n√∫mero de telegrama err√≥neo, el IM 174 s√≥lo soporta los
telegramas 3 y 81 de PROFIBUS
‚óè W#16#0004 = n√∫mero de eje err√≥neo, el IM 174 soporta un m√°ximo de 4 ejes.
La direcci√≥n de hardware que ha indicado en el DB de eje no ha podido
asignarse a ning√∫n eje de un IM 174.
‚óè W#16#0008 = se ha indicado un modo de referenciaci√≥n err√≥neo. Compruebe
el par√°metro en la entrada RefMode.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6531

Instrucciones
4.2 Instrucciones

Sincronizaci√≥n
La sincronizaci√≥n se realiza alternativamente:
‚óè Mediante la b√∫squeda del punto de referencia (s√≥lo con enc√≥der incremental)
‚óè Mediante el posicionamiento del punto de referencia (con enc√≥der incremental y absoluto)
Para la b√∫squeda del punto de referencia pueden utilizarse dos tipos de sensores:
‚óè Si utiliza un enc√≥der con marca cero y desea referenciar a √©ste, parametrice la entrada
"RefMode" = 0. El modo conforme 611U no debe estar seleccionado.
‚óè Si desea referenciar en una marca cero externa (BERO), parametrice la entrada "RefMode"
= 1. El sensor del punto de referencia externo se conecta a la entrada digital B1 a B4,
dependiendo del eje utilizado en la aplicaci√≥n. Es imprescindible que en este caso el modo
conforme 611U se seleccione en la configuraci√≥n hardware.
Como entradas para los dos palpadores ajustables deben utilizarse las entradas digitales M1
o M2.
Para m√°s informaci√≥n, consulte el Manual de producto Periferia descentralizada m√≥dulo
PROFIBUS IM 174 (http://support.automation.siemens.com/WW/view/en/35014863).
Si el eje ya se encuentra en el sensor del punto de referencia al inicio de la b√∫squeda del punto
de referencia, se efectuar√° una referenciaci√≥n en la posici√≥n actual, al igual que en el
posicionamiento del punto de referencia.

Tratamiento de errores
Como reacci√≥n a un error, el driver de entrada ajusta al detectar el error los identificadores de
error "Error" y "Err.EncoderErr" en el DB de eje. El driver de entrada desactiva el bit de estado
"Sync" en el DB de eje, si es que se utiliza un enc√≥der incremental.
Encontrar√° informaci√≥n detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse
de errores en Se√±alizaci√≥n y acuse de errores en el DB de eje.

Acuse de errores
Si activa el acuse de errores en el DB de eje de Easy Motion Control, se acusar√°n tambi√©n los
errores pendientes en el m√≥dulo.

EncoderSINAMICS
Descripci√≥n
La instrucci√≥n EncoderSINAMICS sirve para integrar un accionamiento SINAMICS en Easy
Motion Control. La integraci√≥n puede realizarse mediante PROFIBUS DP o PROFINET IO.
Para cada eje SINAMICS se necesita una instrucci√≥n de driver EncoderSINAMICS.

6532

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Herramientas necesarias
Para utilizar un SINAMICS en Easy Motion Control y para parametrizar un SINAMICS se
necesitan las siguientes herramientas:
‚óè La herramienta de parametrizaci√≥n de accionamientos STARTER o S7-Technology,
incluido el actual SINAMICS Support Package (SSP).

Parametrizaci√≥n del SINAMICS (configuraci√≥n hardware)
A√±ada un accionamiento SINAMICS a una l√≠nea PROFIBUS DP o PROFINET IO de su
proyecto. La instrucci√≥n de driver EncoderSINAMICS soporta para PROFIBUS DP los
telegramas est√°ndar 3, 5, 102 y 105, as√≠ como los telegramas est√°ndar 3 y 102 para
PROFINET IO.
Si desea utilizar para su aplicaci√≥n el m√©todo de regulaci√≥n Dynamic Servo Control (DSC),
necesitar√° un telegrama adecuado (5, 105) y una conexi√≥n is√≥crona. Con PROFINET IO
actualmente no es posible esta funcionalidad DSC.
Para el procesamiento is√≥crono, las direcciones de entrada y salida deben encontrarse en la
memoria imagen de proceso de la CPU. En caso necesario, corrija las direcciones
adapt√°ndolas manualmente. Asigne las direcciones de entrada/salida a una memoria imagen
parcial de proceso. En la configuraci√≥n de la CPU S7 debe asignarse un OB is√≥crono a la
memoria imagen parcial de proceso. Para informaci√≥n m√°s detallada sobre el modo is√≥crono
en SIMATIC S7, consulte el Manual de funciones Modo is√≥crono (http://
support.automation.siemens.com/WW/view/en/15218045).
Par√°metro

Ajuste

Direcci√≥n de E/S

Para el eje que se va a utilizar en Easy Motion Control, debe indicarse la
primera direcci√≥n de entrada en el DB de eje. (p. ej., slot 4: direcci√≥n I 256 a
273, entonces debe indicarse la direcci√≥n de entrada 256)

Selecci√≥n de telegra‚Äê
mas

Para la comunicaci√≥n se selecciona en el asistente de configuraci√≥n de SI‚Äê
NAMICS un n√∫mero de telegrama y se transfiere a la configuraci√≥n hardware.
Esta informaci√≥n debe indicarse tambi√©n en la entrada TelNumber de la ins‚Äê
trucci√≥n EncoderSINAMICS.

Nota
La instalaci√≥n est√°ndar del TIA Portal no soporta la conexi√≥n de SINAMICS a una CPU
SIMATIC S7. Compruebe la disponibilidad. En caso necesario, instale el archivo GSD
correspondiente para SINAMICS. Los datos necesarios se integran solamente una vez que se
haya realizado la instalaci√≥n adicional.

Parametrizaci√≥n del SINAMICS en el DB de eje
La direcci√≥n de entrada ajustada para este eje en la configuraci√≥n hardware debe indicarse en
el campo "Direcci√≥n del m√≥dulo Entradas".
El driver de entrada EncoderSINAMICS calcula durante el funcionamiento el tiempo de ciclo
ajustado cuando se encuentra un modo equidistante o is√≥crono, y lo introduce en el DB de eje.
Por tanto, se recomienda encarecidamente volver a leer el DB de eje modificado del
controlador, a fin de adoptar los posibles cambios.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6533

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

RefMode

INPUT

INT

Tipo de referenciaci√≥n:

TelNumber

INPUT

INT

0 = funci√≥n 1 marca de referencia
1

Referenciaci√≥n en marca cero del enc√≥der o
marca cero sustitutiva (p495[0] en SINA‚Äê
MICS)

1 = funci√≥n 2 marca de referencia
2

Segunda marca cero

2 = funci√≥n 3 marca de referencia
3

Tercera marca cero

3 = funci√≥n 4 marca de referencia
4

Cuarta marca cero

N√∫mero de telegrama:
Se soportan los siguientes telegra‚Äê Para PROFINET IO solamente se han habili‚Äê
mas est√°ndar:
tado los telegramas 3 y 102.
3, 5, 102 y 105

EncoderValid

OUTPUT

BOOL

Err_ID

OUTPUT

WORD

1 = valores reales de posici√≥n v√°‚Äê SINAMICS notifica que el enc√≥der de posi‚Äê
lidos
ci√≥n del eje en cuesti√≥n proporciona valores
v√°lidos. Esta entrada se puede utilizar como
condici√≥n de conexi√≥n en MC_Control.
C√≥digo de error de la instrucci√≥n:
W#16#0001 = OB err√≥neo

La instrucci√≥n s√≥lo puede llamarse en el
OB 6x, OB 3x o bien en el OB 1.

W#16#0002 = n√∫mero de telegra‚Äê El n√∫mero indicado no es soportado por el
ma err√≥neo
driver.
W#16#0004 = se ha indicado un
modo de referenciaci√≥n err√≥neo

Compruebe el par√°metro en la entrada Ref‚Äê
Mode. Los valores v√°lidos son 0, 1, 2 o 3.

Nota
El n√∫mero de telegrama en el driver de entrada debe ser id√©ntico al n√∫mero de telegrama
configurado para SINAMICS. De lo contrario no se garantiza la perfecta funcionalidad. En caso
de introducci√≥n err√≥nea, no se emite c√≥digo de error.

Sincronizaci√≥n
La sincronizaci√≥n se realiza alternativamente:
‚óè Mediante la b√∫squeda del punto de referencia (s√≥lo con enc√≥der incremental)
‚óè Mediante el posicionamiento del punto de referencia (para enc√≥der incremental y absoluto)

6534

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
El modo de referenciaci√≥n puede determinarse mediante el par√°metro de entrada "RefMode"
en el driver de entrada. La siguiente tabla muestra las posibilidades existentes para Easy
Motion Control.
RefMode

"Velocity" en
MC_Home

Se√±al de marca cero del
enc√≥der

Marca cero susti‚Äê
tutiva p495[0]

Descripci√≥n

0

>0

primera marca cero

0

B√∫squeda del punto de referencia en primera
marca cero

1

>0

Segunda marca cero

0

B√∫squeda del punto de referencia en segunda
marca cero

2

>0

Tercera marca cero

0

B√∫squeda del punto de referencia en tercera
marca cero

3

>0

Cuarta marca cero

0

B√∫squeda del punto de referencia en cuarta
marca cero

Mediante la introducci√≥n en RefMode se controla la correspondiente palabra de control del
enc√≥der para el accionamiento, de forma que se realiza la funcionalidad deseada en
SINAMICS. El driver de entrada EncoderSINAMICS permite solamente la b√∫squeda del punto
de referencia en una o varias marcas cero del enc√≥der, as√≠ como en marcas cero externas
(marca cero sustitutiva). No es posible referenciar al vuelo. Para referenciar en la marca cero
sustitutiva, es preciso ajustar en SINAMICS el valor del par√°metro p495[0] del eje en cuesti√≥n
a un valor entre 1 y 6. Para activar una b√∫squeda del punto de referencia, es preciso indicar una
velocidad de desplazamiento mayor que cero en la instrucci√≥n MC_HOME.
Si se introduce aqu√≠ una velocidad de desplazamiento cero, no se tienen en cuenta los
contenidos de la entrada "RefMode" y del par√°metro p495[0].

Tratamiento de errores
Como reacci√≥n a un error, el driver de entrada ajusta al detectar el error los identificadores de
error "Error" y "Err.EncoderErr" en el DB de eje. El driver de entrada desactiva el bit de estado
"Sync" en el DB de eje, si es que se utiliza un enc√≥der incremental.
Encontrar√° informaci√≥n detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse
de errores en Se√±alizaci√≥n y acuse de errores en el DB de eje.

Acuse de errores
Si activa el acuse de errores en el DB de eje de Easy Motion Control, se acusar√°n tambi√©n los
errores pendientes en el m√≥dulo.

EncoderUniversal
Descripci√≥n
La instrucci√≥n EncoderUniversal sirve para integrar los m√≥dulos de lectura de recorrido para
los que Easy Motion Control no ofrece un driver de entrada espec√≠fico.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6535

Instrucciones
4.2 Instrucciones

Funcionamiento
La instrucci√≥n EncoderUniversal espera en la entrada "EncoderValue" un valor que
corresponde a la posici√≥n real del eje. No accede por s√≠ misma a la periferia. Es posible
interconectar el valor proporcionado por el m√≥dulo de lectura de recorrido directamente con el
enc√≥der o bien, si es necesario, calcularlo antes.
Si el m√≥dulo de lectura de recorrido ofrece funciones especiales que desee utilizar, deber√°
integrarlas en el programa de usuario.

Parametrizaci√≥n del m√≥dulo (configuraci√≥n hardware)
Seleccione los par√°metros en consonancia con el hardware y con el enc√≥der utilizado.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de da‚Äê
tos

EncErr

INPUT

BOOL

Descripci√≥n
1 = error de enc√≥der
Aqu√≠ se notifica al driver de entrada un error detectado por el m√≥dulo de
lectura de recorrido o por el programa de usuario (p. ej., m√≥dulo retirado
o fallo de estaci√≥n).

EncoderValue

INPUT

DINT

Valor del enc√≥der

Sincronizaci√≥n
Con la instrucci√≥n EncoderUniversal la sincronizaci√≥n solamente es posible mediante
posicionamiento del punto cero de la m√°quina.

Tratamiento de errores
Los errores detectados por el m√≥dulo de lectura de recorrido deben registrarse en el programa
de usuario y seguir proces√°ndose.
Si un error de este tipo afecta a las funciones que se realizan con instrucciones de Easy Motion
Control, es preciso integrar este error a trav√©s de la entrada "EncErr" en el tratamiento de
errores de Easy Motion Control.
Encontrar√° informaci√≥n detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse
de errores en Se√±alizaci√≥n y acuse de errores en el DB de eje.

6536

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Driver de salida
Funci√≥n de los drivers de salida
Tarea
El driver de salida sirve para emitir la consigna de velocidad calculada por el regulador de un
eje al m√≥dulo de salida conectado. La instrucci√≥n convierte la velocidad de [unidad de longitud/
s] al rango de valores adecuado del m√≥dulo de salida y emite este valor.
Si la entrada "EnableDrive" = FALSE, el driver de salida da el valor cero al m√≥dulo de salida.

Inicializaci√≥n
El valor de salida se ajusta a cero.

Llamada
El driver de salida de un eje debe llamarse sin condici√≥n.

Modo is√≥crono
Los drivers de salida soportan el modo is√≥crono de los m√≥dulos de periferia adecuados. El
driver detecta el modo is√≥crono autom√°ticamente porque es llamado en un OB is√≥crono.

Tratamiento de errores
Un error detectado por el programa de usuario (p. ej., m√≥dulo retirado o fallo de estaci√≥n) se
puede notificar al driver de salida en la entrada "OutErr". Mientras la entrada "OutErr" sea igual
a TRUE, el driver de salida no acceder√° al m√≥dulo de salida.
Si la entrada "OutErr" est√° ajustada a TRUE, el driver de salida activa los identificadores de
error "Error" y "Err.OutputErr" en el DB de eje.
Encontrar√° informaci√≥n detallada sobre reacciones a errores, se√±alizaci√≥n de errores y acuse
de errores en Se√±alizaci√≥n y acuse de errores en el DB de eje.

Modo de simulaci√≥n
Mientras el bit "Sim" est√© activado en el DB de eje, el driver de salida no acceder√° al m√≥dulo
de salida (v√©ase la instrucci√≥n MC_Simulation (P√°gina 6506)).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6537

Instrucciones
4.2 Instrucciones

OutputIM178
Descripci√≥n
La instrucci√≥n OutputIM178 sirve para utilizar un canal del m√≥dulo IM 178‚Äë4 como m√≥dulo de
salida. La instrucci√≥n OutputIM178 est√° contenida en STEP7 V5.x por razones de
compatibilidad. El m√≥dulo IM 178‚Äë4 ya no se comercializa activamente. Como alternativa, se
puede utilizar el IM 174.
El IM 178‚Äë4 debe utilizarse con el mismo n√∫mero de canal y el mismo eje en el driver de entrada
y en el driver de salida, pues hay determinados ajustes de direcciones que se refieren a ambos
drivers. No es posible mezclar con otros drivers.

Llamada
La instrucci√≥n se llama en un OB de alarma is√≥crona (p. ej. OB 61). Todas las instrucciones
EMC de un eje deben llamarse en un mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de da‚Äê
tos

Descripci√≥n

EnableDrive

INPUT

BOOL

1 = habilitaci√≥n de la salida anal√≥gica
Si "EnableDrive" = FALSE, se transferir√° el valor cero al m√≥dulo de salida.
Esta entrada puede interconectarse con la salida "DriveEnabled" de la ins‚Äê
trucci√≥n MC_Control.

Q0

INPUT

BOOL

Salida digital 0 del canal seleccionado

Q1

INPUT

BOOL

Salida digital 1 del canal seleccionado

Q2

INPUT

BOOL

Salida digital 2 del canal seleccionado

OutErr

INPUT

BOOL

1 = error en el m√≥dulo de salida
Un error detectado por el programa de usuario (p. ej., m√≥dulo retirado o fallo
de estaci√≥n) se puede notificar aqu√≠ al driver de salida.

Salidas digitales
Las salidas digitales "Q0" a "Q2" del canal seleccionado del IM 178‚Äë4 pueden controlarse
mediante los par√°metros de entrada "Q0" a "Q2" del driver de salida.

OutputSM432
Descripci√≥n
La instrucci√≥n OutputSM432 sirve para utilizar un canal del SM 432 como m√≥dulo de salidas.

Parametrizaci√≥n del SM 432 (configuraci√≥n hardware)
Parametrice el canal correspondiente del m√≥dulo SM 432 con una tensi√≥n de salida de ¬±10 V.

6538

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de da‚Äê
tos

Descripci√≥n

EnableDrive

INPUT

BOOL

1 = habilitaci√≥n de la salida anal√≥gica
Si "EnableDrive" = FALSE, se transferir√° el valor cero al m√≥dulo de salida.
Esta entrada puede interconectarse con la salida "DriveEnabled" de la ins‚Äê
trucci√≥n MC_Control.

OutErr

INPUT

BOOL

1 = error en el m√≥dulo de salida
Un error detectado por el programa de usuario (p. ej., m√≥dulo retirado o fallo
de estaci√≥n) se puede notificar aqu√≠ al driver de salida.

OutputET200S2AO
Descripci√≥n
La instrucci√≥n OutputET200S2AO sirve para utilizar un canal del m√≥dulo de salidas anal√≥gicas
ET 200S 2AO U como m√≥dulo de salidas.
El driver tambi√©n se puede utilizar para la variante is√≥crona de este m√≥dulo.

Parametrizaci√≥n del m√≥dulo de salidas anal√≥gicas ET 200S 2AO U (configuraci√≥n hardware)
Parametrice el canal correspondiente del m√≥dulo con una tensi√≥n de salida de ¬±10 V.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6539

Instrucciones
4.2 Instrucciones

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de
datos

EnableDrive

INPUT

BOOL

Descripci√≥n
1 = habilitaci√≥n de la salida anal√≥gica
Si "EnableDrive" = FALSE, se transferir√° el valor cero al m√≥dulo de salida.
Esta entrada puede interconectarse con la salida "DriveEnabled" de la instruc‚Äê
ci√≥n MC_Control.

OutErr

INPUT

BOOL

1 = error en el m√≥dulo de salida
Un error detectado por el programa de usuario (p. ej., m√≥dulo retirado o fallo de
estaci√≥n) se puede notificar aqu√≠ al driver de salida.

OutputCPU314C
Descripci√≥n
La instrucci√≥n OutputCPU314C sirve para utilizar un canal de salida anal√≥gica de CPU 314C
para una tensi√≥n de salida de ¬±10 V.

Parametrizaci√≥n de las salidas anal√≥gicas de la CPU 314C (configuraci√≥n hardware)
Parametrice el canal correspondiente (salida anal√≥gica) de la CPU 314C con una tensi√≥n de
salida de ¬±10 V.
En los datos de eje del par√°metro "Direcci√≥n inicial de las salidas del m√≥dulo de salidas"
("OutputModuleOutAddress"), introduzca la direcci√≥n que ha asignado en la configuraci√≥n
hardware para las salidas en el slot 2.6 (AI5/AO2). El par√°metro "Direcci√≥n inicial de las
entradas del m√≥dulo de salidas" ("OutputModuleInAddress") no necesita ser introducido.
Hay un m√°ximo de 2 canales de salida anal√≥gica disponibles, de manera que pueden utilizarse
2 ejes completamente a trav√©s de CPU 314C.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

6540

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de da‚Äê
tos

EnableDrive

INPUT

BOOL

Descripci√≥n
1 = habilitaci√≥n de la salida anal√≥gica
Si "EnableDrive" = FALSE, se transferir√° el valor cero a la salida anal√≥gica.
Esta entrada puede interconectarse con la salida "DriveEnabled" de la ins‚Äê
trucci√≥n MC_Control.

OutErr

INPUT

BOOL

1 = error en la salida anal√≥gica
Aqu√≠ se puede notificar al driver de salida un error detectado por el programa
de usuario.

OutputSM332
Descripci√≥n
La instrucci√≥n OutputSM332 sirve para utilizar un canal del SM 332 como m√≥dulo de salidas.
El driver tambi√©n se puede utilizar para la variante is√≥crona de este m√≥dulo.

Parametrizaci√≥n del SM 332 (configuraci√≥n hardware)
Parametrice el canal correspondiente del m√≥dulo SM 332 con una tensi√≥n de salida de ¬±10 V.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de da‚Äê
tos

Descripci√≥n

EnableDrive

INPUT

BOOL

1 = habilitaci√≥n de la salida anal√≥gica
Si "EnableDrive" = FALSE, se transferir√° el valor cero al m√≥dulo de salida.
Esta entrada puede interconectarse con la salida "DriveEnabled" de la instruc‚Äê
ci√≥n MC_Control.

OutErr

INPUT

BOOL

1 = error en el m√≥dulo de salida
Un error detectado por el programa de usuario (p. ej., m√≥dulo retirado o fallo de
estaci√≥n) se puede notificar aqu√≠ al driver de salida.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6541

Instrucciones
4.2 Instrucciones

OutputUniversal
Descripci√≥n
Con la instrucci√≥n OutputUniversal puede utilizarse un m√≥dulo de salidas anal√≥gicas
cualquiera junto con instrucciones de Easy Motion Control.

Funcionamiento
La instrucci√≥n OutputUniversal, calcula una consigna de velocidad a partir de la velocidad
emitida por el regulador y con ayuda del factor de proporcionalidad "IntAtMaxVelocity" y la
pone a disposici√≥n en sus salidas.
El driver no accede por s√≠ mismo a la periferia.
"IntAtMaxVelocity" es el valor con el que debe controlarse el m√≥dulo de salidas anal√≥gicas
para que emita una tensi√≥n que desplace el eje a la "MaxVelocity" (el valor de esta tensi√≥n ya
se ha definido en el par√°metro "DriveInputAtMaxVel").
La curva caracter√≠stica del driver pasa siempre por el cero y es lineal.
La consigna de velocidad se emite como valor entero con signo y tambi√©n como valor absoluto
con signo aparte.
Si estos valores de salida ya son adecuados para la aplicaci√≥n, puede emitirlos directamente
a la periferia mediante el programa de usuario. Si todav√≠a no son adecuados, es posible
realizar una adaptaci√≥n adicional mediante el programa de usuario y luego emitir el valor as√≠
generado.

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de da‚Äê Descripci√≥n
tos

EnableDrive

INPUT

BOOL

1 = habilitaci√≥n de la salida anal√≥gica
En cuanto "EnableDrive" = FALSE, se emite el valor cero a las salidas.
Esta entrada puede interconectarse con la salida "DriveEnabled" de la ins‚Äê
trucci√≥n MC_Control.

IntAtMaxVelocity

INPUT

INT

OutErr

INPUT

BOOL

Valor entero para la conversi√≥n de la consigna de velocidad (ver arriba).
1 = error en el m√≥dulo de salidas
Aqu√≠ se puede notificar al driver de salida un error detectado por el programa
de usuario (p. ej., m√≥dulo retirado o fallo de estaci√≥n) en el m√≥dulo de
salidas.

OutputValue

OUTPUT

INT

Consigna de velocidad calculada

OutValAbs

OUTPUT

INT

Valor absoluto de la consigna de velocidad

OutValSign

OUTPUT

BOOL

Signo de la consigna de velocidad (TRUE = valor negativo)

6542

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

OutputMM4_DP
Descripci√≥n
La instrucci√≥n OutputMM4_DP sirve para utilizar un MICROMASTER 4 con m√≥dulo opcional
DP enchufado.

Parametrizaci√≥n del MM4 (configuraci√≥n hardware)
El MICROMASTER 4 se encuentra en el cat√°logo de hardware en:
"Otros dispositivos de campo > PROFIBUS DP > Accionamientos > Siemens AG > SIMOVERT
> MICROMASTER 4".
Puede que primero sea necesario instalar el archivo GSD correspondiente.
Coloque el MICROMASTER en el sistema maestro DP y as√≠gnele la direcci√≥n DP que desee.
En los slots 0 y 1, inserte un m√≥dulo "0 PKW, 2 PZD (PPO3)". Acepte las direcciones de
periferia propuestas o seleccione otros valores.
Las direcciones aqu√≠ introducidas se aplican a la "Direcci√≥n inicial de las salidas del m√≥dulo de
salidas" o a la "Direcci√≥n inicial de las entradas del m√≥dulo de salidas" en el DB del eje.

Parametrizaci√≥n del MM4
Parametrice el MICROMASTER seg√∫n sus necesidades (datos del motor, direcci√≥n DP,
funcionamiento como esclavo DP...) sirvi√©ndose de la documentaci√≥n MICROMASTER.
La "frecuencia de referencia" introducida en el par√°metro P2000 debe aplicarse al DB del eje
como "Valor de referencia para una velocidad del 100%" ("DriveInputAt100").

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

EnableDrive

INPUT

BOOL

1 = habilitaci√≥n de la salida anal√≥gica
En cuanto "EnableDrive" = FALSE, se emite el valor de velocidad cero al MI‚Äê
CROMASTER.
Esta entrada puede interconectarse con la salida "DriveEnabled" de la instruc‚Äê
ci√≥n MC_Control.

OutErr

INPUT

BOOL

1 = error en la salida
Aqu√≠ se puede notificar al driver de salida un error detectado por el programa de
usuario (p. ej. fallo de estaci√≥n).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6543

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

ON

INPUT

BOOL

1 = accionamiento conectado

DriveReady

OUTPUT

BOOL

"ON" se introduce en la palabra de mando, en el bit 0 .
1 = accionamiento listo para el funcionamiento
Si "DriveReady" = FALSE, el inicio de una marcha generar√° un "DriveError".

OutputIM174
Descripci√≥n
La instrucci√≥n OutputIM174 sirve para utilizar un canal del m√≥dulo IM 174 como m√≥dulo de
salida. El IM 174 ofrece hasta 4 ejes. Para cada eje con telegrama 3 de PROFIBUS ajustado
se necesita una instrucci√≥n de driver OutputIM174.

Parametrizaci√≥n del IM 174 (configuraci√≥n hardware)
El driver de salida OutputIM174 solo es necesario cuando se parametriza un eje con
telegrama 3 de PROFIBUS. Para un eje con telegrama 81 de PROFIBUS no se necesita driver
de salida.
A√±ada un IM 174 a un PROFIBUS DP is√≥crono del proyecto. Tenga en cuenta que las
direcciones de entrada y salida se encuentran en la memoria imagen de proceso de la CPU.
En caso necesario, corrija las direcciones adapt√°ndolas manualmente. Asigne las direcciones
de entrada/salida a una memoria imagen parcial de proceso. En la configuraci√≥n de la CPU S7
debe asignarse un OB is√≥crono a la memoria imagen parcial de proceso.
Par√°metro

Ajuste

Direcci√≥n de E/S

Para el eje que se va a utilizar en Easy Motion Control, debe indicarse la primera
direcci√≥n de salida en el DB de eje. (p. ej., slot 5: direcci√≥n Q 256 a 265, entonces
debe indicarse la direcci√≥n de salida 256)

Nota
De forma est√°ndar, la configuraci√≥n hardware integra el m√≥dulo IM 174 como m√≥dulo is√≥crono.
Debido al procesamiento is√≥crono, las direcciones de entrada y salida del IM 174 se
encuentran en la memoria imagen de proceso de la CPU.
Para informaci√≥n m√°s detallada sobre el modo is√≥crono en SIMATIC S7, consulte el Manual
de funciones Modo is√≥crono (http://support.automation.siemens.com/WW/view/en/
15218045).
La instrucci√≥n de driver OutputIM174 presupone el procesamiento is√≥crono. Si no se tiene en
cuenta esta condici√≥n, la instrucci√≥n no puede acceder a las direcciones de hardware.

Parametrizaci√≥n del IM 174 en el DB de eje
La direcci√≥n de salida ajustada para este eje en la configuraci√≥n hardware debe indicarse en
el campo "Direcci√≥n del m√≥dulo Salidas".

6544

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n se llama en un OB de alarma is√≥crona (p. ej. OB 61). Todas las instrucciones
EMC de un eje deben llamarse en un mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n

Tipo de da‚Äê Descripci√≥n
tos

EnableDrive

INPUT

BOOL

1 = habilitaci√≥n de la salida anal√≥gica
En cuanto "EnableDrive" = FALSE, se emite el valor de velocidad cero al accio‚Äê
namiento. La habilitaci√≥n del accionamiento se bloquea.
Esta entrada puede interconectarse con la salida "DriveEnabled" de la instruc‚Äê
ci√≥n MC_Control.

OutErr

INPUT

BOOL

1 = error en el m√≥dulo de salida
Un error detectado por el programa de usuario (p. ej., m√≥dulo retirado o fallo de
estaci√≥n) se puede notificar aqu√≠ al driver de salida.

Err_ID

OUTPUT

WORD

C√≥digo de error de la instrucci√≥n
W#16#0001 = OB err√≥neo, la instrucci√≥n s√≥lo puede instalarse en el OB 6x

OutputSINAMICS
Descripci√≥n
La instrucci√≥n OutputSINAMICS sirve para integrar un accionamiento SINAMICS en Easy
Motion Control. La integraci√≥n puede realizarse mediante PROFIBUS DP o PROFINET IO.
Para cada eje SINAMICS se necesita una instrucci√≥n de driver OutputSINAMICS.

Parametrizaci√≥n del SINAMICS (configuraci√≥n hardware)
A√±ada un accionamiento SINAMICS a una l√≠nea PROFIBUS DP o PROFINET IO de su
proyecto. La instrucci√≥n de driver OutputSINAMICS soporta para PROFIBUS DP los
telegramas est√°ndar 3, 5, 102 y 105, as√≠ como los telegramas est√°ndar 3 y 102 para
PROFINET IO.
Si desea utilizar para su aplicaci√≥n el m√©todo de regulaci√≥n Dynamic Servo Control (DSC),
necesitar√° un telegrama adecuado (5, 105) y una conexi√≥n is√≥crona. Con PROFINET IO
actualmente no es posible esta funcionalidad DSC.
Para el procesamiento is√≥crono, las direcciones de entrada y salida deben encontrarse en la
memoria imagen de proceso de la CPU. En caso necesario, corrija las direcciones
adapt√°ndolas manualmente. Asigne las direcciones de entrada/salida a una memoria imagen
parcial de proceso. En la configuraci√≥n de la CPU S7 debe asignarse un OB is√≥crono a la
memoria imagen parcial de proceso. Para informaci√≥n m√°s detallada sobre el modo is√≥crono

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6545

Instrucciones
4.2 Instrucciones
en SIMATIC S7, consulte el Manual de funciones Modo is√≥crono (http://
support.automation.siemens.com/WW/view/en/15218045).
Par√°metro

Ajuste

Direcci√≥n de
E/S

Para el eje que se va a utilizar en Easy Motion Control, debe indicarse la primera
direcci√≥n de salida en el DB de eje. (p. ej., slot 5: direcci√≥n Q 256 a 265, entonces debe
indicarse la direcci√≥n de salida 256)

Nota
La instalaci√≥n est√°ndar del TIA Portal no soporta la conexi√≥n de SINAMICS a una CPU
SIMATIC S7. Compruebe la disponibilidad. En caso necesario, instale el archivo GSD
correspondiente para SINAMICS. Los datos necesarios se integran solamente una vez que se
haya realizado la instalaci√≥n adicional.

Parametrizaci√≥n del SINAMICS en el DB de eje
La direcci√≥n de salida ajustada para este eje en la configuraci√≥n hardware debe indicarse en
el campo "Direcci√≥n del m√≥dulo Salidas". El n√∫mero de telegrama debe indicarse de nuevo
porque el driver de salida tambi√©n podr√≠a funcionar solo. Se comprueba si el n√∫mero de
telegrama coincide con el correspondiente driver de entrada EncoderSINAMICS (en su caso).

Conexi√≥n del eje
Cada m√≥dulo de motor SINAMICS tiene asignada obligatoriamente una alimentaci√≥n central
de energ√≠a para el circuito intermedio (un Line Module). Antes de conectar el eje en la entrada
"EnableDrive" de la instrucci√≥n MC_Control es preciso asegurarse de que la alimentaci√≥n
central de energ√≠a ha sido conectada. Para ello, el Line Module env√≠a las respuestas
correspondientes a trav√©s de su estado operativo actual. Eval√∫e las respuestas necesarias del
Line Module y vinc√∫lelas como condici√≥n de conexi√≥n.
Para m√°s informaci√≥n, consulte la documentaci√≥n sobre accionamientos SINAMICS (http://
www.automation.siemens.com/doconweb).
Para conectar un Active Line Module, encontrar√° un ejemplo de aplicaci√≥n en Internet (http://
support.automation.siemens.com/WW/view/en/21971603).

Desconexi√≥n del eje: parametrizaci√≥n del StopMode
Parada natural (Coast Stop) (AUS2) ‚Äì StopMode = 3:
Aqu√≠ se anula de inmediato la habilitaci√≥n de potencia y el accionamiento gira por inercia hasta
detenerse. Paralelamente se activa de inmediato el control del freno mec√°nico. El freno act√∫a
y detiene el accionamiento. Seg√∫n la carga aplicada, el freno se ve sometido a un gran
esfuerzo mec√°nico.

6546

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

$XV

t
'UHK]DKOVROOZHUW

t
'UHK]DKOLVWZHUW
Q +DOWHEUHPVH

t
+DOWHEUHPVH¬∏IIQHQ

t
(LQVFKDOWVSHUUH

t
Parada en rampa (AUS1) ‚Äì StopMode = 5:
Aqu√≠ se frena en la rampa del generador de rampas del accionamiento. Tras alcanzarse el
umbral de velocidad el freno act√∫a, y transcurrido el tiempo de cierre del freno se desactiva la
habilitaci√≥n de impulsos.

$86

t
'UHK]DKOVROOZHUW

t
'UHK]DKOLVWZHUW
Q +DOWHEUHPVH

t
+DOWHEUHPVH
¬∏IIQHQ

%UHPVVFKOLH¬°]HLW

t
(LQVFKDOWVSHUUH

t
Parada r√°pida (AUS3) ‚Äì StopMode = 6:
Aqu√≠ se frena en la rampa de parada r√°pida (parada de emergencia) del accionamiento. Tras
alcanzarse el umbral de velocidad el freno act√∫a, y transcurrido el tiempo de cierre del freno se
desactiva la habilitaci√≥n de impulsos.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6547

Instrucciones
4.2 Instrucciones

$86

t

'UHK]DKOVROOZHUW

t
'UHK]DKOLVWZHUW
Q +DOWHEUHPVH

t
Haltebremse
√∂ffnen

%UHPVVFKOLH¬°]HLW

t
(LQVFKDOWVSHUUH

t
Para m√°s informaci√≥n, consulte la Informaci√≥n de producto SINAMICS S120 (http://
support.automation.siemens.com/WW/view/en/30119684).

Llamada
La instrucci√≥n se llama en un OB de alarma c√≠clica (p. ej. OB 35) o en un OB de alarma de
sincronismo (p. ej., OB 61). Todas las instrucciones EMC de un eje deben llamarse en un
mismo bloque de programa.

Par√°metro
Par√°metro

Declaraci√≥n Tipo de da‚Äê
tos

TelNumber

INPUT

INT

Descripci√≥n
N√∫mero de telegrama:
Se soportan los siguientes
telegramas est√°ndar:
3, 5, 102,105

EnableDrive

INPUT

BOOL

Para PROFINET IO solamente se han habili‚Äê
tado los telegramas 3 y 102.
Si como driver de entrada se utiliza el Enco‚Äê
derSINAMICS, es imprescindible que el n√∫me‚Äê
ro del telegrama empleado sea el mismo.

1 = habilitaci√≥n del acciona‚Äê En cuanto "EnableDrive" = FALSE, se emite el
miento
valor de velocidad cero al accionamiento. La
habilitaci√≥n del accionamiento se bloquea.
Esta entrada puede interconectarse con la sa‚Äê
lida "DriveEnabled" de la instrucci√≥n MC_Con‚Äê
trol.

6548

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n Tipo de da‚Äê
tos

Descripci√≥n

StopMode

INPUT

Tipo de desconexi√≥n:

INT

3 = parada natural (AUS2)

El accionamiento gira por inercia hasta dete‚Äê
nerse

5 = parada en rampa (AUS1) Parada del eje a trav√©s del generador de ram‚Äê
pas
6 = parada r√°pida (AUS3)

Parada del eje a trav√©s de la rampa de parada
r√°pida

OutErr

INPUT

BOOL

1 = error en el m√≥dulo de sa‚Äê Un error detectado por el programa de usuario
lida
(p. ej., m√≥dulo retirado o fallo de estaci√≥n) se
puede notificar aqu√≠ al driver de salida.

Operation_Ena‚Äê
bled

OUTPUT

BOOL

1 = SINAMICS notifica "Ser‚Äê El accionamiento cuenta con todas las habili‚Äê
vicio habilitado"
taciones para el eje y el eje se√±aliza la dispo‚Äê
nibilidad para desplazarse. El eje est√° magne‚Äê
tizado.

Err_ID

OUTPUT

WORD

C√≥digo de error de la instruc‚Äê
ci√≥n:
W#16#0001 = OB err√≥neo

La instrucci√≥n solo puede instalarse en el
OB 6x, OB 3x o bien en el OB 1

W#16#0002 = n√∫mero de te‚Äê El n√∫mero indicado no es soportado por el dri‚Äê
legrama err√≥neo
ver o bien difiere del n√∫mero de telegrama
configurado en SINAMICS.

OutErr: con un flanco ascendente de estas variables el accionamiento (SINAMICS) se
desconecta. Para volver a conectar el eje es necesario que OutErr = FALSE y se haya acusado
el mensaje de error.
Operation_Enabled: esta variable notifica el estado actual del eje en SINAMICS. Mientras
Operation_Enabled = FALSE no se debe activar ninguna petici√≥n de desplazamiento.
Encontrar√° m√°s informaci√≥n sobre la conexi√≥n del SINAMICS en Internet (http://
support.automation.siemens.com/WW/view/en/30119684).

Otras referencias para Easy Motion Control
Bloque de datos de eje (DB de eje)
Tarea
El DB de eje es el elemento central de la gesti√≥n de datos de Easy Motion Control. Contiene:
‚óè Par√°metros que describen el eje sustancialmente (p. ej. direcciones de periferia)
‚óè Par√°metros de la regulaci√≥n de posici√≥n que se calculan a partir de estos par√°metros
b√°sicos al inicializarse las instrucciones EMC
‚óè Valores actuales de la regulaci√≥n de posici√≥n (p. ej. posici√≥n, estados de fallo...)
‚óè Bits de inicializaci√≥n para coordinar el arranque de las instrucciones

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6549

Instrucciones
4.2 Instrucciones

Contenido
La siguiente tabla muestra el contenido del DB de eje.
Nota
Los datos que no se indican en esta tabla no se pueden modificar.

Direc‚Äê
ci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

0.0

Sample_T

REAL

0.01

Tiempo de muestreo de las instrucciones de eje [s]

4.0

AxisType

BOOL

FALSE

Tipo de eje
‚óè FALSE = eje lineal
‚óè TRUE = eje rotativo

4.1

EncoderType

BOOL

FALSE

Tipo de enc√≥der
‚óè FALSE = enc√≥der incremental
‚óè TRUE = enc√≥der absoluto

4.2

Sim

BOOL

FALSE

TRUE = el m√≥dulo de simulaci√≥n est√° activo

6.0

AxisLimitMax

REAL

1.0e+6

Fin del final de carrera por software [unidad de longitud]

10.0

AxisLimitMin

REAL

-1.0e+6

Inicio del final de carrera por software [unidad de longi‚Äê
tud]

14.0

MaxVelocity

REAL

0.1

Velocidad m√°xima del eje [unidad de longitud/s]

18.0

MaxAcceleration

REAL

0.1

Aceleraci√≥n m√°xima del eje [unidad de longitud/s2]

22.0

MaxDeceleration

REAL

0.1

Deceleraci√≥n m√°xima del eje [unidad de longitud/s2]

26.0

MonTimeTargetAppr

REAL

1.0

Tiempo de vigilancia para la aproximaci√≥n a destino [s]

30.0

TargetRange

REAL

1.0

Zona de destino para el posicionamiento [unidad de
longitud]

34.0

StandstillRange

REAL

1.5

Zona de parada sin petici√≥n de desplazamiento [unidad
de longitud]

38.0

MaxFollowingDist

REAL

5.0

Error de seguimiento m√°ximo permitido [unidad de lon‚Äê
gitud]

42.0

MonitorTargetAppr

BOOL

TRUE

TRUE = activar vigilancia de la zona de destino

42.1

SWLimitEnable

BOOL

TRUE

TRUE = activar vigilancia del final de carrera

44.0

FactorP

REAL

1.0

Factor de proporcionalidad [1/s]

48.0

ManVelocity

REAL

0.0

Velocidad de consigna en el modo manual [unidad de
longitud/s]

52.0

ManEnable

BOOL

FALSE

TRUE = activar el modo manual

54.0

EmergencyDec

REAL

1000.0

Deceleraci√≥n del eje para parada de emergencia [uni‚Äê
dad de longitud/s2]

58.0

InputModuleInAddr

INT

0

Direcci√≥n inicial de las entradas del m√≥dulo de lectura
de recorrido

60.0

InputModuleOutAddr

INT

0

Direcci√≥n inicial de las salidas del m√≥dulo de lectura de
recorrido

62.0

InputChannelNo

INT

0

N√∫mero de canal del m√≥dulo de lectura de recorrido

64.0

StepsPerRev

DINT

L#1

Incrementos por vuelta del enc√≥der [incrementos/vuelta
del enc√≥der]

6550

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direc‚Äê
ci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

68.0

DisplacementPerRev

REAL

1.0

Recorrido por vuelta del enc√≥der [unidad de longitud/
vuelta del enc√≥der]

72.0

NumberRevs

INT

1

N√∫mero de vueltas de un enc√≥der absoluto

74.0

PolarityEncoder

INT

1

Correcci√≥n de sentido del enc√≥der

76.0

PositionOffset

DINT

L#0

Offset de posici√≥n / ajuste del enc√≥der absoluto [incre‚Äê
mento]

80.0

OutputModuleOutAddr

INT

0

Direcci√≥n inicial de las salidas del m√≥dulo de salidas

82.0

OutputModuleInAddr

INT

0

Direcci√≥n inicial de las entradas del m√≥dulo de salidas

84.0

OutputChannelNo

INT

0

N√∫mero de canal del m√≥dulo de salidas

86.0

PolarityDrive

INT

1

Correcci√≥n de sentido del accionamiento

88.0

DriveInputAtMaxVel

REAL

9.0

Valor de referencia para velocidad m√°xima del eje [V]

92.0

OffsetCompensation

REAL

0.0

Compensaci√≥n del punto cero [V]

96.0

DriveInputAt100

REAL

10.0

Valor de referencia para una velocidad del 100% [V]

100.0

Override

REAL

100.0

Correcci√≥n de velocidad [%]

104.0

ActPosition

REAL

0.0

Valor real de posici√≥n actual [unidad de longitud]

108.0

FollowingDistance

REAL

0.0

Error de seguimiento actual [unidad de longitud]

112.0

RemainingDistance

REAL

0.0

Distancia residual actual hasta el punto de destino [uni‚Äê
dad de longitud]

116.0

NomVelocity

REAL

0.0

Velocidad de consigna del eje [unidad de longitud/s]

120.0

ActVelocity

REAL

0.0

Velocidad real del eje [unidad de longitud/s]

124.0

Sync

BOOL

FALSE

‚óè FALSE = eje no sincronizado
‚óè TRUE = eje sincronizado

124.1

Error

BOOL

TRUE

‚óè FALSE = no hay error
‚óè TRUE = error agrupado

124.2

ErrorAck

BOOL

FALSE

‚óè FALSE = no hay acuse
‚óè TRUE = acusar errores

128.0

Err.SWLimitMinExceeded

BOOL

FALSE

TRUE = rebase del inicio del final de carrera por soft‚Äê
ware

128.1

Err.SWLimitMaxExceeded

BOOL

FALSE

TRUE = rebase del fin del final de carrera por software

128.2

Err.TargetErr

BOOL

FALSE

TRUE = destino fuera de la zona de desplazamiento

128.3

Err.NoSync

BOOL

FALSE

TRUE = eje no sincronizado

128.4

Err.DirectionErr

BOOL

FALSE

TRUE = desplazamiento no permitido en el sentido es‚Äê
pecificado

128.5

Err.DataErr

BOOL

FALSE

TRUE = par√°metro inadmisible de una instrucci√≥n de
desplazamiento

128.6

Err.StartErr

BOOL

FALSE

TRUE = imposible iniciar en el estado actual del eje

128.7

Err.DistanceErr

BOOL

FALSE

TRUE = recorrido demasiado largo

129.0

Err.MasterErr

BOOL

FALSE

TRUE = eje maestro en estado inadmisible

130.0

Err.StoppedMotion

BOOL

TRUE

TRUE = eje en estado de parada de acuse obligatorio

130.1

Err.EnableDriveErr

BOOL

FALSE

TRUE = falta habilitaci√≥n del accionamiento

130.2

Err.FollowingDistErr

BOOL

FALSE

TRUE = error de seguimiento m√°ximo rebasado

130.3

Err.StandstillErr

BOOL

FALSE

TRUE = zona de parada abandonada

130.4

Err.TargetApproachErr

BOOL

FALSE

TRUE = error en la aproximaci√≥n al destino

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6551

Instrucciones
4.2 Instrucciones
Direc‚Äê
ci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

130.5

Err.EncoderErr

BOOL

FALSE

TRUE = error de enc√≥der

130.6

Err.OutputErr

BOOL

FALSE

TRUE = error en driver de salida

130.7

Err.ConfigErr

BOOL

FALSE

TRUE = datos del eje mal parametrizados

131.0

Err.DriveErr

BOOL

FALSE

TRUE = error en accionamiento

132.0

Config.Err_AxisLimit

BOOL

FALSE

TRUE = l√≠mites de eje err√≥neos

132.1

Config.Err_MaxVelocity

BOOL

FALSE

TRUE = velocidad m√°xima err√≥nea

132.2

Config.Err_MaxAcceleration

BOOL

FALSE

TRUE = aceleraci√≥n m√°xima err√≥nea

132.3

Config.Err_MaxDeceleration

BOOL

FALSE

TRUE = deceleraci√≥n m√°xima err√≥nea

132.4

Config.Err_MonTimeTarge‚Äê
tAppr

BOOL

FALSE

TRUE = error en tiempo de vigilancia para la aproxima‚Äê
ci√≥n a destino

132.5

Config.Err_TargetRange

BOOL

FALSE

TRUE = error en zona de destino

132.6

Config.Err_StandstillRange

BOOL

FALSE

TRUE = error en zona de parada

132.7

Config.Err_MaxFollowingDist

BOOL

FALSE

TRUE = error de seguimiento m√°ximo incorrecto

133.0

Config.Err_EmergencyDec

BOOL

FALSE

TRUE = error en deceleraci√≥n para parada brusca

133.1

Config.Err_StepsPerRev

BOOL

FALSE

TRUE = error en incrementos por vuelta del enc√≥der

133.2

Config.Err_DisplacementPe‚Äê
rRev

BOOL

FALSE

TRUE = error en recorrido del eje por vuelta del enc√≥der

133.3

Config.Err_NumberRevs

BOOL

FALSE

TRUE = error en n√∫mero de vueltas del enc√≥der

133.4

Config.Err_PolarityEncoder

BOOL

FALSE

TRUE = error en correcci√≥n de sentido del enc√≥der

133.5

Config.Err_PolarityDrive

BOOL

FALSE

TRUE = error en correcci√≥n de sentido del acciona‚Äê
miento

133.6

Config.Err_DriveInputAtMax‚Äê
Vel

BOOL

FALSE

TRUE = error en valor de referencia para velocidad m√°‚Äê
xima

133.7

Config.Err_AxisLength

BOOL

FALSE

TRUE = longitud del eje err√≥nea

134.0

Config.Err_EncoderRange

BOOL

FALSE

TRUE = el rango del enc√≥der no concuerda con la lon‚Äê
gitud del eje

134.1

Config.Err_MaxVelRotaryAxis

BOOL

FALSE

TRUE = la velocidad m√°xima y el tiempo de muestreo
no concuerdan con la longitud del eje rotativo

134.2

Config.Err_DriveInputAt100

BOOL

FALSE

TRUE = valor de referencia para una velocidad del
100% ‚â§ 0

136.0

EncoderValue

DINT

L#0

278.0

Init

STRUCT TRUE

4.2.4.3

Valor actual del enc√≥der
Campo de bits para inicializaci√≥n de 32 instrucciones

M√≥dulos de funci√≥n

Contador FM x50-1
CNT_CTRL
Descripci√≥n
La instrucci√≥n CNT_CTRL permite controlar los modos de contaje y medici√≥n.

6552

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Para aprovechar la posibilidad de modificar par√°metros durante el funcionamiento o activar y
desactivar las salidas del m√≥dulo de contaje, hay que emplear la instrucci√≥n CNT_CTL1
(P√°gina 6555).

Funcionamiento
La instrucci√≥n CNT_CTRL s√≥lo funciona en un OB no is√≥crono.
En un OB is√≥crono se deber√° emplear la instrucci√≥n CNT_CTL1 (P√°gina 6555) o CNT_CTL2
(P√°gina 6557).
Los datos necesarios para la instrucci√≥n CNT_CTRL se guardan en el DB de contaje
(P√°gina 6558) en la CPU. La instrucci√≥n CNT_CTRL transfiere c√≠clicamente datos de este DB
al m√≥dulo de contaje y recoge datos del m√≥dulo de contaje.

Llamada
La instrucci√≥n CNT_CTRL puede llamarse una vez por contador en el ciclo o alternativamente
en un programa controlado por tiempo. No se permite realizar la llamada en un programa de
interrupci√≥n controlado por eventos.

Par√°metros
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

El usuario lo ...

La instrucci√≥n lo
‚Ä¶

DB_NO

INPUT

INT

N√∫mero del bloque de datos de contaje registra

SW_GATE

INPUT

BOOL

Bit de control del contador Puerta SW
(iniciar/parar)

GATE_STP

INPUT

BOOL

Bit de control del contador Parar puerta activa y desactiva consulta

OT_ERR_A

INPUT

BOOL

Acusar error de operador

activa y desactiva consulta

OT_ERR

OUTPUT

BOOL

Hay un error de operador

consulta

activa y desactiva

L_DIRECT

IN-OUT

BOOL

Bit de inicio para carga directa de un
contador

activa

consulta y desac‚Äê
tiva

L_PREPAR

IN-OUT

BOOL

Bit de inicio para carga preparatoria de
un contador

activa

consulta y desac‚Äê
tiva

T_CMP_V1

IN-OUT

BOOL

Bit de inicio para transferir el valor de
comparaci√≥n 1

activa

consulta y desac‚Äê
tiva

T_CMP_V2

IN-OUT

BOOL

Bit de inicio para transferir el valor de
comparaci√≥n 2

activa

consulta y desac‚Äê
tiva

RES_SYNC

IN-OUT

BOOL

Borrar el bit de estado de sincronizaci√≥n activa

consulta y desac‚Äê
tiva

RES_ZERO

IN-OUT

BOOL

Borrar el bit de estado de paso por cero activa

consulta y desac‚Äê
tiva

consulta

activa y desactiva consulta

Procesar peticiones
Las peticiones para el m√≥dulo de contaje se lanzan a trav√©s de los par√°metros de instrucci√≥n
L_DIRECT, L_PREPAR, T_CMP_V1, T_CMP_V2, RES_SYNC, RES_ZERO, OT_ERR_A y
GATE_STP.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6553

Instrucciones
4.2 Instrucciones
Dependiendo de la petici√≥n, hay que registrar el valor de carga o un valor de comparaci√≥n en
el DB de contaje antes de llamar la instrucci√≥n.
Un par√°metro de entrada/salida asignado (L_DIRECT, L_PREPAR, T_CMP_V1, T_CMP_V2,
RES_SYNC y RES_ZERO) es borrado por la instrucci√≥n CNT_CTRL tras finalizar la petici√≥n.

Comportamiento en arranque
En cuanto la instrucci√≥n CNT_CTRL detecta un arranque (de la CPU o del FM), se posterga
cualquier petici√≥n pendiente y se acusa primero el arranque. Si ya se ha iniciado una petici√≥n,
√©sta se ejecutar√° cuando finalice el arranque, pero no se perder√°.

Comportamiento en caso de error
Si se produce un error de operador al llamar la instrucci√≥n, √©ste se notifica en el par√°metro
OT_ERR. La informaci√≥n del error se puede leer en el DB de contaje (variable OT_ERR_B). A
continuaci√≥n se puede acusar el error de operador mediante el par√°metro OT_ERR_A. No se
notifica ning√∫n otro error de operador hasta que no se haya acusado el error anterior.

DIAG_INF
Descripci√≥n
La instrucci√≥n DIAG_INF lee el registro DS 1 del m√≥dulo de contaje si el par√°metro de inicio
est√° activado (IN_DIAG = TRUE) y lo pone a disposici√≥n del usuario en el DB de contaje
(P√°gina 6558) (a partir de DW 54).

Funcionamiento
El registro se transfiere con la instrucci√≥n RDSYSST. El c√≥digo de respuesta de dicha
instrucci√≥n (RET_VAL) se copia en el par√°metro RET_VAL de la instrucci√≥n DIAG_INF. En
cuanto se ha ejecutado la instrucci√≥n DIAG_INF, se desactiva el par√°metro de disparo
IN_DIAG y se informa de que ha concluido la transferencia.

Llamada
Es posible llamar la instrucci√≥n DIAG_INF en el ciclo y en el programa de interrupci√≥n. De todas
formas, no es aconsejable llamarla en el programa controlado por tiempo.

Par√°metros
Par√°metro

Declaraci√≥n Tipo de da‚Äê Descripci√≥n
tos

El usuario lo ...

La instrucci√≥n
lo ‚Ä¶

DB_NO

INPUT

INT

N√∫mero del bloque de datos de contaje

registra

consulta

RET_VAL

OUTPUT

INT

C√≥digo de respuesta de la instrucci√≥n
RDSYSST

consulta

registra

IN_DIAG

IN-OUT

BOOL

Bit de inicio para leer el registro de diagn√≥stico
DS 1

activa y consul‚Äê desactiva
ta

6554

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

CNT_CTL1
Descripci√≥n
La instrucci√≥n CNT_CTL1 permite controlar los modos de contaje y medici√≥n.
Adem√°s de las funciones de la instrucci√≥n CNT_CTRL, la instrucci√≥n CNT_CTL1 incluye
tambi√©n la posibilidad de modificar los par√°metros durante el funcionamiento, adem√°s de
activar y desactivar las salidas del m√≥dulo de contaje.

Funcionamiento
Los datos necesarios para la instrucci√≥n CNT_CTL1 se guardan en el DB de contaje
(P√°gina 6558) en la CPU. La instrucci√≥n CNT_CTL1 transfiere c√≠clicamente datos de este DB
al m√≥dulo de contaje y recoge datos del m√≥dulo de contaje.

Llamada
La llamada de la instrucci√≥n CNT_CTL1 se puede efectuar c√≠clicamente o bien desde un OB
de alarma controlado por tiempo o is√≥crono. No se permite realizar la llamada en un programa
de interrupci√≥n controlado por eventos.

Par√°metros
Par√°metro

Declaraci√≥n

Tipo de da‚Äê Descripci√≥n
tos

El usuario lo ... La instrucci√≥n
lo ‚Ä¶

DB_NO

INPUT

INT

N√∫mero del bloque de datos de contaje

registra

SW_GATE

INPUT

BOOL

Bit de control del contador Puerta SW (iniciar/ activa y desac‚Äê consulta
parar)
tiva

GATE_STP

INPUT

BOOL

Bit de control del contador Parar puerta

activa y desac‚Äê consulta
tiva

OT_ERR_A

INPUT

BOOL

Acusar error de operador

activa y desac‚Äê consulta
tiva

SET_DO0

INPUT

BOOL

Activar/desactivar la salida DO0

activa y desac‚Äê consulta
tiva

SET_DO1

INPUT

BOOL

Activar/desactivar la salida DO1

activa y desac‚Äê consulta
tiva

OT_ERR

OUTPUT

BOOL

Hay un error de operador

consulta

activa y desac‚Äê
tiva

L_DIRECT

IN-OUT

BOOL

Contaje:
bit de inicio para carga directa y preparatoria
de un contador

activa

consulta y de‚Äê
sactiva

Medici√≥n:
no est√° permitido activarlo

-

consulta y de‚Äê
sactiva

Contaje:
bit de inicio para carga preparatoria de un
contador

activa

consulta y de‚Äê
sactiva

Medici√≥n:
transferir el l√≠mite inferior

activa

consulta y de‚Äê
sactiva

2)
3)

L_PREPAR

IN-OUT

BOOL

2)
3)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

consulta

6555

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de da‚Äê Descripci√≥n
tos

T_CMP_V1

IN-OUT

BOOL

2)

T_CMP_V2

IN-OUT

BOOL

2)

C_DOPARA

El usuario lo ... La instrucci√≥n
lo ‚Ä¶

Contaje:
activa
bit de inicio para transferir el valor de compa‚Äê
raci√≥n 1

consulta y de‚Äê
sactiva

Medici√≥n:
transferir el l√≠mite superior

activa

consulta y de‚Äê
sactiva

Contaje:
activa
bit de inicio para transferir el valor de compa‚Äê
raci√≥n 2

consulta y de‚Äê
sactiva

Medici√≥n:
tiempo de actualizaci√≥n

activa

consulta y de‚Äê
sactiva

IN-OUT

BOOL

Bit de inicio para modificar par√°metros

activa

consulta y de‚Äê
sactiva

RES_SYNC

IN-OUT

BOOL

Borrar el bit de estado de sincronizaci√≥n

activa

consulta y de‚Äê
sactiva

RES_ZERO

IN-OUT

BOOL

Desactivar bits de estado de paso por cero,
activa
rebase por exceso, rebase por defecto, com‚Äê
parador o fin de la medici√≥n

consulta y de‚Äê
sactiva

1)

1)

Este par√°metro no se puede activar simult√°neamente con uno de los par√°metros L_DIRECT, L_PREPAR, T_CMP_V1 o
T_CMP_V2.

2)

Este par√°metro no se puede activar simult√°neamente con el par√°metro C_DOPARA.

3)

Estos par√°metros no se pueden activar simult√°neamente.

Procesar peticiones
Las peticiones para el FM x50‚Äë1 se lanzan mediante los par√°metros de instrucci√≥n L_DIRECT,
L_PREPAR, T_CMP_V1, T_CMP_V2, C_DOPARA, RES_SYNC, RES_ZERO y OT_ERR_A.
Dependiendo de la petici√≥n, los valores correspondientes (valor de carga, valores de
comparaci√≥n, l√≠mite inferior, l√≠mite superior, tiempo de actualizaci√≥n) se deben introducir en el
DB de contaje antes de llamar la instrucci√≥n.
Consulte tambi√©n:
‚óè Transferencia de valores con CNT_CTL1 (P√°gina 6564)
‚óè Par√°metros del DB para transferir valores (modos de contaje) (P√°gina 6565)
‚óè Par√°metros del DB para transferir valores (modos de medici√≥n) (P√°gina 6567)
Un par√°metro de entrada/salida activado (L_DIRECT, L_PREPAR, T_CMP_V1, T_CMP_V2,
C_DOPARA, RES_SYNC y RES_ZERO) vuelve a borrarse empleando la instrucci√≥n
CNT_CTL1 tras completarse la petici√≥n. Ello permite reconocer que el FM x50‚Äë1 ha terminado
de procesar la petici√≥n. En caso necesario, dicha informaci√≥n se puede integrar en el programa
de usuario.

Comportamiento en arranque
En cuanto la instrucci√≥n CNT_CTL1 detecta un arranque (de la CPU o del FM), se posterga
cualquier petici√≥n pendiente y se acusa primero el arranque. Si ya se ha iniciado una petici√≥n,
√©sta se ejecutar√° cuando finalice el arranque, pero no se perder√°.

6556

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Comportamiento en caso de error
Si se produce un error de operador al llamar la instrucci√≥n, √©ste se notifica en el par√°metro
OT_ERR. La informaci√≥n del error se puede leer en el DB de contaje (variable OT_ERR_B). A
continuaci√≥n se puede acusar el error de operador mediante el par√°metro OT_ERR_A. No se
notifica ning√∫n otro error de operador hasta que no se haya acusado el error anterior.

CNT_CTL2
Descripci√≥n
La instrucci√≥n CNT_CTL2 tiene b√°sicamente la misma funcionalidad que la
instrucci√≥n CNT_CTL1 (P√°gina 6555).
A continuaci√≥n se explican las diferencias respecto de la instrucci√≥n CNT_CTL1.

Funcionamiento
La instrucci√≥n CNT_CTL2 es especialmente apropiada para aplicaciones en las que se desea
lanzar r√°pidamente la misma petici√≥n (p. ej. cargar valor de comparaci√≥n) al FM x50‚Äë1 una y
otra vez. Mientras que con la instrucci√≥n CNT_CTL1, en el mejor de los casos, puede lanzar
una nueva petici√≥n cada cinco ciclos PROFIBUS DP, con la instrucci√≥n CNT_CTL2 puede
hacerse cada dos ciclos PROFIBUS DP.
La instrucci√≥n est√° lista para una petici√≥n cuando el bit de inicio correspondiente est√° a 0. La
finalizaci√≥n de una petici√≥n no se muestra por separado.
Si se produce alg√∫n problema de comunicaci√≥n o bien alg√∫n error de datos o de operador, no
es posible atribuirlo a una petici√≥n concreta. Por esta raz√≥n, en este caso, la instrucci√≥n
detiene el procesamiento de la petici√≥n y genera un error de operador acusable con la
identificaci√≥n 90. Despu√©s de acusar el error activando el par√°metro OT_ERR_A, se procesan
las peticiones que hayan podido quedar pendientes.
El acuse de un error de operador se acepta correctamente cuando se desactiva el par√°metro
OT_ERR. Para un acuse seguro, deje activado el par√°metro OT_ERR_A mientras dure la
operaci√≥n. S√≥lo deber√≠an lanzarse m√°s peticiones cuando el acuse sea correcto.
Nota
No est√° permitido iniciar simult√°neamente varias transferencias de valores con la instrucci√≥n
CNT_CTL2.

Llamada
La instrucci√≥n CNT_CTL2 s√≥lo funciona en un OB is√≥crono.
Si se llama la instrucci√≥n CNT_CTL2 en un OB no is√≥crono, se produce un error de operador
con la identificaci√≥n 91. No se produce un intercambio de datos con el FM x50‚Äë1.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6557

Instrucciones
4.2 Instrucciones

Otras referencias para el FM x50-1 Counter V3
Bloque de datos de contaje
Tarea
El DB de contaje es la interfaz de datos entre el programa de usuario y el FM x50‚Äë1. Contiene
y aplica todos los datos necesarios para el control y el funcionamiento del m√≥dulo.
Antes de parametrizar el m√≥dulo deben asignarse los siguientes datos v√°lidos al DB de contaje:
‚óè Direcci√≥n del m√≥dulo (direcci√≥n 6.0)
‚óè Direcci√≥n inicial del canal (direcci√≥n 8.0)
‚óè Longitud de la interfaz de datos de usuario (direcci√≥n 12.0)
En el manual de producto del m√≥dulo de contador encontrar√° un ejemplo que muestra c√≥mo
puede transmitir la direcci√≥n del m√≥dulo, la direcci√≥n inicial del canal y la longitud de la interfaz
de datos de usuario al DB de contaje en el OB 100.
Como alternativa, la direcci√≥n del m√≥dulo se puede introducir autom√°ticamente mediante la
funci√≥n "Introducir direcci√≥n del m√≥dulo en el DB" en la configuraci√≥n de dispositivos del FM
x50-1.

Configuraci√≥n
El DB de contaje se divide en diferentes √°reas:
DB de canal
Par√°metros de instrucci√≥n, direcciones
√Årea de transferencia para los valores que deben escribirse
Interfaz de control
√Årea de transferencia para valores que deben leerse
N√∫meros de error
Interfaz de realimentaci√≥n
Par√°metros del FM 450‚Äë1
Datos de diagn√≥stico

Contenido
La tabla siguiente muestra el contenido del DB de contaje.
Nota
Los datos que no se indican en esta tabla no se pueden modificar.

6558

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Direc‚Äê
ci√≥n

Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario
Contaje
FM 350‚Äë1 / FM 450‚Äë1

Medici√≥n
FM 350‚Äë1

Par√°metros de instrucci√≥n, direcciones
0.0

AR1_BUFFER

DWORD

DW#16#0

B√∫fer AR1

B√∫fer AR1

4.0

FP

BYTE

B#16#0

Flag Byte

Flag Byte

5.0

RESERVED

BYTE

B#16#0

Reservado

Reservado

6.0

MOD_ADR

WORD

W#16#0

Direcci√≥n del m√≥dulo

Direcci√≥n del m√≥dulo

8.0

CH_ADR

DWORD

DW#16#0

Direcci√≥n del canal

Direcci√≥n del canal

12.0

U_D_LGTH

BYTE

B#16#0

Long. datos de usuario

Long. datos de usuario

13.0

A_BYTE_0

BYTE

B#16#0

Reservado

Reservado

√Årea de transferencia para los valores que deben escribirse
14.0

LOAD_VAL 1)

DINT

L#0

Nuevo valor de carga
(write user)

L√≠mite inferior
(write user)

18.0

CMP_V1 1)

DINT

L#0

Nuevo valor de comparaci√≥n
1
(write user)

L√≠mite superior
(write user)

22.0

CMP_V2 1)

DINT

L#0

Nuevo valor de comparaci√≥n
2
(write user)

Tiempo de actualizaci√≥n
(write user)

Interfaz de control
26.0

A_BIT0_0

BOOL

FALSE

Reservado

Reservado

26.1

TFB

BOOL

FALSE

Reservado / Test libre

Reservado

26.2

A_BIT0_2

BOOL

FALSE

Reservado

Reservado

26.3

A_BIT0_3

BOOL

FALSE

Reservado

Reservado

26.4

A_BIT0_4

BOOL

FALSE

Reservado

Reservado

26.5

A_BIT0_5

BOOL

FALSE

Reservado

Reservado

26.6

A_BIT0_6

BOOL

FALSE

Reservado

Reservado

26.7

A_BIT0_7

BOOL

FALSE

Reservado

Reservado

27.0

ENSET_UP 1)

BOOL

FALSE

Habilitaci√≥n para inicializar
en sentido ascendente
(write user)

-

27.1

ENSET_DN 1)

BOOL

FALSE

Habilitaci√≥n para inicializar
en sentido descendente
(write user)

-

27.2

A_BIT1_2

BOOL

FALSE

Reservado

Reservado

27.3

A_BIT1_3

BOOL

FALSE

Reservado

Reservado

27.4

A_BIT1_4

BOOL

FALSE

Reservado

Reservado

27.5

A_BIT1_5

BOOL

FALSE

Reservado

Reservado

27.6

A_BIT1_6

BOOL

FALSE

Reservado

Reservado

27.7

A_BIT1_7

BOOL

FALSE

Reservado

Reservado

28.0

CTRL_DO0

BOOL

FALSE

Habilitaci√≥n salida digital
DO0
(write user)

Habilitaci√≥n salida digital
DO0
(write user)

1)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6559

Instrucciones
4.2 Instrucciones
Direc‚Äê
ci√≥n

Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario
Contaje
FM 350‚Äë1 / FM 450‚Äë1

Medici√≥n
FM 350‚Äë1

28.1

CTRL_DO1 1)

BOOL

FALSE

Habilitaci√≥n salida digital
DO1
(write user)

Habilitaci√≥n salida digital
DO1
(write user)

28.2

A_BIT2_2

BOOL

FALSE

Reservado

Reservado

28.3

A_BIT2_3

BOOL

FALSE

Reservado

Reservado

28.4

A_BIT2_4

BOOL

FALSE

Reservado

Reservado

28.5

A_BIT2_5

BOOL

FALSE

Reservado

Reservado

28.6

A_BIT2_6

BOOL

FALSE

Reservado

Reservado

28.7

A_BIT2_7

BOOL

FALSE

Reservado

Reservado

29.0

A_BIT3_0

BOOL

FALSE

Reservado

Reservado

29.1

A_BIT3_1

BOOL

FALSE

Reservado

Reservado

29.2

A_BIT3_2

BOOL

FALSE

Reservado

Reservado

29.3

A_BIT3_3

BOOL

FALSE

Reservado

Reservado

29.4

A_BIT3_4

BOOL

FALSE

Reservado

Reservado

29.5

A_BIT3_5

BOOL

FALSE

Reservado

Reservado

29.6

A_BIT3_6

BOOL

FALSE

Reservado

Reservado

29.7

A_BIT3_7

BOOL

FALSE

Reservado

Reservado

√Årea de transferencia para valores que deben leerse
30.0

LATCH_LOAD 1)

DINT

L#0

Valor de carga o congelaci√≥n
actual (read user)

Valor medido actual
(read user)

34.0

ACT_CNTV 1)

DINT

L#0

Valor de contaje actual
(read user)

Valor de contaje actual
(read user)

N√∫meros de error
38.0

DA_ERR_W 1)

WORD

W#16#0

Palabra de error de datos
(read user)

Palabra de error de da‚Äê
tos
(read user)

40.0

OT_ERR_B 1)

BYTE

B#16#0

Byte de error de operador
(read user)

Byte de error de opera‚Äê
dor
(read user)
Reservado

Interfaz de realimentaci√≥n
41.0

E_BIT0_0

BOOL

FALSE

Reservado

41.1

STS_TFB

BOOL

FALSE

Reservado / Estado test libre Reservado

41.2

DIAG

BOOL

FALSE

FM 350-1: Evento de diag‚Äê
n√≥stico (read user)

41.3

E_BIT0_3

BOOL

FALSE

Reservado

Reservado

41.4

DATA_ERR

BOOL

FALSE

Bit de error de datos
(read user)

Bit de error de datos
(read user)

41.5

E_BIT0_5

BOOL

FALSE

Reservado

Reservado

41.6

E_BIT0_6

BOOL

FALSE

Reservado

Reservado

41.7

PARA 1)

BOOL

FALSE

M√≥dulo parametrizado
(read user)

M√≥dulo parametrizado
(read user)

42.0

E_BYTE_0

BYTE

B#16#0

Reservado

Reservado

Evento de diagn√≥stico
(read user)

FM 450-1: Reservado

6560

1)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direc‚Äê
ci√≥n

Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario
Contaje
FM 350‚Äë1 / FM 450‚Äë1

43.0

STS_RUN 1)

BOOL

FALSE

Medici√≥n
FM 350‚Äë1

Estado contador en funciona‚Äê Estado contador en fun‚Äê
miento
cionamiento
(read user)
(read user)
Este bit se corresponde con
el bit 20 del contador.
0 = el LED CR est√° apagado
1 = el LED CR se enciende

Este bit se corresponde
con el bit 20 del contador.
0 = el LED CR est√° apa‚Äê
gado
1 = el LED CR se encien‚Äê
de

43.1

STS_DIR 1)

BOOL

FALSE

Estado sentido de contaje
(read user)

Estado sentido de conta‚Äê
je
(read user)

43.2

STS_ZERO 1)

BOOL

FALSE

Estado paso por cero
(read user)

Fin de la medici√≥n
(read user)

43.3

STS_OFLW 1)

BOOL

FALSE

Estado rebase por exceso
(read user)

Estado rebase por exce‚Äê
so
(read user)

43.4

STS_UFLW 1)

BOOL

FALSE

Estado rebase por defecto
(read user)

Estado rebase por defec‚Äê
to
(read user)

43.5

STS_SYNC 1)

BOOL

FALSE

Estado contador sincroniza‚Äê
do (read user)

-

43.6

STS_GATE 1)

BOOL

FALSE

Estado puerta interna
(read user)

Estado puerta interna
(read user)

43.7

STS_SW_G 1)

BOOL

FALSE

Estado puerta SW
(read user)

Estado puerta SW
(read user)

44.0

STS_SET 1)

BOOL

FALSE

Estado entrada digital SET
(read user)

Estado entrada digital
DI‚ÄëSet
(read user)

44.1

STS_LATCH 1)

BOOL

FALSE

Nuevo valor de congelaci√≥n (s√≥lo en modo is√≥crono) / Re‚Äê
servado

44.2

STS_STA 1)

BOOL

FALSE

Estado entrada digital
START (read user)

Estado entrada digital
DI‚ÄëStart (read user)

44.3

STS_STP 1)

BOOL

FALSE

Estado entrada digital STOP
(read user)

Estado entrada digital
DI‚ÄëStop (read user)

44.4

STS_CMP1 1)

BOOL

FALSE

Estado salida valor de com‚Äê
paraci√≥n 1 (read user)

Estado salida valor de
comparaci√≥n 1 (read
user)

44.5

STS_CMP2 1)

BOOL

FALSE

Estado salida valor de com‚Äê
paraci√≥n 2 (read user)

Estado salida valor de
comparaci√≥n 2 (read
user)

44.6

STS_COMP1 1)

BOOL

FALSE

Estado almacenado del com‚Äê parador 1 / Reservado

44.7

STS_COMP2 1)

BOOL

FALSE

Estado almacenado del com‚Äê parador 2 / Reservado

45.0

E_BIT3_0

BOOL

FALSE

Reservado

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Reservado

6561

Instrucciones
4.2 Instrucciones
Direc‚Äê
ci√≥n

Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario
Contaje
FM 350‚Äë1 / FM 450‚Äë1

Medici√≥n
FM 350‚Äë1

45.1

E_BIT3_1

BOOL

FALSE

Reservado

Reservado

45.2

E_BIT3_2

BOOL

FALSE

Reservado

Reservado

45.3

E_BIT3_3

BOOL

FALSE

Reservado

Reservado

45.4

E_BIT3_4

BOOL

FALSE

Reservado

Reservado

45.5

E_BIT3_5

BOOL

FALSE

Reservado

Reservado

45.6

E_BIT3_6

BOOL

FALSE

Reservado

Reservado

45.7

E_BIT3_7

BOOL

FALSE

Reservado

Reservado

Par√°metros para FM 450‚Äë1
46.0

ACT_CMP1 1)

DINT

L#0

Reservado / Valor de compa‚Äê Reservado
raci√≥n actual 1 (read user)

50.0

ACT_CMP2 1)

DINT

L#0

Reservado / Valor de compa‚Äê Reservado
raci√≥n actual 2 (read user)

Los siguientes datos de diagn√≥stico son introducidos por la instrucci√≥n DIAG_INF
54.0

MDL_DEFECT

BOOL

FALSE

Fallo de m√≥dulo

Fallo de m√≥dulo

54.1

INT_FAULT

BOOL

FALSE

Error interno

Error interno

54.2

EXT_FAULT

BOOL

FALSE

Error externo

Error externo

54.3

PNT_INFO

BOOL

FALSE

Error de canal (desglose a
partir de DW 58)

Error de canal (desglose
a partir de DW 58)

54.4

EXT_VOLTAGE

BOOL

FALSE

Fallo tensi√≥n auxiliar

Fallo tensi√≥n auxiliar

54.5

FLD_CNNCTR

BOOL

FALSE

Conector frontal

Conector frontal

54.6

NO_CONFIG

BOOL

FALSE

Falta parametrizaci√≥n

Falta parametrizaci√≥n

54.7

CONFIG_ERR

BOOL

FALSE

Error de parametrizaci√≥n

Error de parametrizaci√≥n

55.0

MDL_TYPE

BYTE

B#16#0

Tipo de m√≥dulo

Tipo de m√≥dulo

56.0

SUB_MDL_ERR

BOOL

FALSE

M√≥dulo de interfaz err√≥neo/
faltante

M√≥dulo de interfaz err√≥‚Äê
neo/faltante

56.1

COMM_FAULT

BOOL

FALSE

Error de comunicaci√≥n

Error de comunicaci√≥n

56.2

MDL_STOP

BOOL

FALSE

Indicador de estado operati‚Äê
vo RUN/STOP

Indicador de estado ope‚Äê
rativo RUN/STOP

56.3

WTCH_DOG_FAULT

BOOL

FALSE

Watchdog (FM)

Watchdog (FM)

56.4

INT_PS_FLT

BOOL

FALSE

Fallo alimentaci√≥n interna

Fallo alimentaci√≥n inter‚Äê
na

56.5

PRIM_BATT_FLT

BOOL

FALSE

Vigilancia de la bater√≠a

Vigilancia de la bater√≠a

56.6

BCKUP_BATT_FLT

BOOL

FALSE

Respaldo por bater√≠a err√≥neo Respaldo por bater√≠a
err√≥neo

56.7

RESERVED_2

BOOL

FALSE

Reservado

Reservado

57.0

RACK_FLT

BOOL

FALSE

Fallo rack

Fallo rack

57.1

PROC_FLT

BOOL

FALSE

Fallo de CPU

Fallo de CPU

57.2

EPROM_FLT

BOOL

FALSE

Fallo de EPROM

Fallo de EPROM

57.3

RAM_FLT

BOOL

FALSE

Fallo de RAM

Fallo de RAM

57.4

ADU_FLT

BOOL

FALSE

Error de CAD

Error de CAD

57.5

FUSE_FLT

BOOL

FALSE

Fusible

Fusible

6562

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direc‚Äê
ci√≥n

Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario
Contaje
FM 350‚Äë1 / FM 450‚Äë1

Medici√≥n
FM 350‚Äë1

57.6

HW_INTR_FLT

BOOL

FALSE

Alarma de proceso perdida

Alarma de proceso perdi‚Äê
da

57.7

RESERVED_3

BOOL

FALSE

Reservado

Reservado

58.0

CH_TYPE

BYTE

B#16#0

Tipo de canal

Tipo de canal

59.0

LGTH_DIA

BYTE

B#16#0

Longitud de datos de diag‚Äê
n√≥stico por canal

Longitud de datos de
diagn√≥stico por canal

60.0

CH_NO

BYTE

B#16#0

Cantidad de canales

Cantidad de canales

61.0

GRP_ERR1

BOOL

FALSE

Error agrupado canal 1

Error agrupado canal 1

61.1

GRP_ERR2

BOOL

FALSE

Reservado /Error agrupado
canal 2

No asignado en el
FM 350

61.2

D_BIT7_2

BOOL

FALSE

DS1 byte 7 bit 2

DS1 byte 7 bit 2

61.3

D_BIT7_3

BOOL

FALSE

DS1 byte 7 bit 3

DS1 byte 7 bit 3

61.4

D_BIT7_4

BOOL

FALSE

DS1 byte 7 bit 4

DS1 byte 7 bit 4

61.5

D_BIT7_5

BOOL

FALSE

DS1 byte 7 bit 5

DS1 byte 7 bit 5

61.6

D_BIT7_6

BOOL

FALSE

DS1 byte 7 bit 6

DS1 byte 7 bit 6

61.7

D_BIT7_7

BOOL

FALSE

DS1 byte 7 bit 7

DS1 byte 7 bit 7

62.0

CH1_SIGA

BOOL

FALSE

Canal 1, error se√±al A

Canal 1, error se√±al A

62.1

CH1_SIGB

BOOL

FALSE

Canal 1, error se√±al B

Canal 1, error se√±al B

62.2

CH1_SIGZ

BOOL

FALSE

Canal 1, error se√±al cero

Canal 1, error se√±al cero

62.3

CH1_BETW

BOOL

FALSE

Canal 1, error entre canales

Canal 1, error entre ca‚Äê
nales

62.4

CH1_5V2

BOOL

FALSE

Canal 1, error alimentaci√≥n
de enc√≥der 5,2 V

Canal 1, error alimenta‚Äê
ci√≥n de enc√≥der 5,2 V

62.5

D_BIT8_5

BOOL

FALSE

DS1 byte 8 bit 5

DS1 byte 8 bit 5

62.6

D_BIT8_6

BOOL

FALSE

DS1 byte 8 bit 6

DS1 byte 8 bit 6

62.7

D_BIT8_7

BOOL

FALSE

DS1 byte 8 bit 7

DS1 byte 8 bit 7

63.0

D_BYTE9

BYTE

B#16#0

DS1 byte 9

DS1 byte 9

64.0

CH2_SIGA

BOOL

FALSE

Reservado / Canal 2, error
se√±al A

Reservado

64.1

CH2_SIGB

BOOL

FALSE

Reservado / Canal 2, error
se√±al B

Reservado

64.2

CH2_SIGZ

BOOL

FALSE

Reservado / Canal 2, error
se√±al cero

Reservado

64.3

CH2_BETW

BOOL

FALSE

Reservado / Canal 2, error
entre canales

Reservado

64.4

CH2_5V2

BOOL

FALSE

Reservado / Canal 2, error
alimentaci√≥n de enc√≥der 5,2
V

Reservado

64.5

D_BIT10_5

BOOL

FALSE

DS1 byte 10 bit 5

DS1 byte 10 bit 5

64.6

D_BIT10_6

BOOL

FALSE

DS1 byte 10 bit 6

DS1 byte 10 bit 6

64.7

D_BIT10_7

BOOL

FALSE

DS1 byte 10 bit 7

DS1 byte 10 bit 7

65.0

D_BYTE11

BYTE

B#16#0

DS1 byte 11

DS1 byte 11

66.0

D_BYTE12

BYTE

B#16#0

DS1 byte 12

DS1 byte 12

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6563

Instrucciones
4.2 Instrucciones
Direc‚Äê
ci√≥n

Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario
Contaje
FM 350‚Äë1 / FM 450‚Äë1

Medici√≥n
FM 350‚Äë1

67.0

D_BYTE13

BYTE

B#16#0

DS1 byte 13

DS1 byte 13

68.0

D_BYTE14

BYTE

B#16#0

DS1 byte 14

DS1 byte 14

69.0

D_BYTE15

BYTE

B#16#0

DS1 byte 15

DS1 byte 15

1)

Variables en el DB que se pueden/tienen que introducir o leer al trabajar con el FM x50-1

Transferencia de valores con CNT_CTL1
Transferencia de valores
Dependiendo del modo de operaci√≥n, los valores se transfieren activando estos par√°metros de
instrucci√≥n:
Modo de opera‚Äê
ci√≥n

Par√°metro de instrucci√≥n

Contaje

L_DIRECT, L_PREPAR, T_CMP_V1, T_CMP_V2, C_DOPARA

Medici√≥n

L_PREPAR, T_CMP_V1, T_CMP_V2, C_DOPARA

Antes de transferirse, los valores deben guardarse en el DB.
Consulte tambi√©n:
‚óè Par√°metros del DB para transferir valores (modos de contaje) (P√°gina 6565)
‚óè Par√°metros del DB para transferir valores (modos de medici√≥n) (P√°gina 6567)
Es posible transferir simult√°neamente varios valores:
En el modo de operaci√≥n ...

... pueden transferirse simult√°neamente

Contaje

Valor de carga

(Par√°metro del DB LOAD_VAL)

Valor de comparaci√≥n 1

(Par√°metro del DB CMP_V1)

Medici√≥n

6564

Valor de comparaci√≥n 2

(Par√°metro del DB CMP_V2)

L√≠mite inferior

(Par√°metro del DB LOAD_VAL)

L√≠mite superior

(Par√°metro del DB CMP_V1)

Tiempo de actualizaci√≥n

(Par√°metro del DB CMP_V2)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Si un valor es err√≥neo, hay que acusar primero este error de operador con OT_ERR_A para
que el FM 350‚Äë1 pueda aplicar los dem√°s valores. Corrija luego el valor rechazado y
transfi√©ralo de nuevo.
Nota
Si con los par√°metros de instrucci√≥n L_DIRECT, L_PREPAR, T_CMP_V1 o T_CMP_V2 se
cargan los valores LOAD_VAL, CMP_V1 o CMP_V2, no est√° permitido modificar
simult√°neamente la parametrizaci√≥n con el par√°metro de instrucci√≥n C_DOPARA.
Ello ocasionar√≠a un error de operador OT_ERR que se debe acusar con OT_ERR_A.

Tiempo necesario para transferir valores
Consulte el tiempo necesario para transferir valores en la tabla siguiente:
Aplicaci√≥n del FM 350‚Äë1

Tiempo necesario

Centralizada

Como m√≠nimo 4 ciclos del OB 1

Descentralizada (modo no is√≥crono)

Como m√≠nimo 5 ciclos PROFIBUS DP

Descentralizada (modo is√≥crono)
‚óè Al transferir s√≥lo un valor

‚óè 5 ciclos PROFIBUS DP

‚óè Al lanzar simult√°neamente la transferencia de varios
valores
‚óè Para el 1er. valor:

‚óè 5 ciclos PROFIBUS DP despu√©s del disparo

‚óè Para el 2¬∫ valor:

‚óè 6 ciclos PROFIBUS DP despu√©s del disparo

‚óè Para el 3er. valor:

‚óè 7 ciclos PROFIBUS DP despu√©s del disparo

Par√°metros del DB para transferir valores (modos de contaje)
Preparaci√≥n
Antes de llamar las instrucciones CNT_CTRL (P√°gina 6552), CNT_CTL1 (P√°gina 6555)
o CNT_CTL2 (P√°gina 6557) hay que asignar los siguientes datos v√°lidos al bloque de datos:
‚óè Direcci√≥n del m√≥dulo (direcci√≥n DB 6.0)
‚óè Direcci√≥n inicial del canal (direcci√≥n DB 8.0)
‚óè Longitud de la interfaz de datos de usuario (direcci√≥n DB 12.0)
Estos datos deber√≠an registrarse en el DB con cada arranque del OB 100.

Par√°metros del DB para transferir valores (modos de contaje)
La siguiente tabla muestra la secci√≥n del DB a la que se transfieren los par√°metros
LOAD_VAL, CMP_V1 y CMP_V2.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6565

Instrucciones
4.2 Instrucciones
El par√°metro LOAD_VAL (bytes de 14 a 17) tiene dos significados:
‚óè Si se activa el par√°metro de instrucci√≥n L_DIRECT o L_PREPAR, LOAD_VAL se interpreta
como valor de carga.
‚óè Si activa el par√°metro de instrucci√≥n C_DOPARA, es posible determinar en el byte 14 el
comportamiento de las salidas DO0 y DO1. Los bytes 15 y 16 se interpretan como hist√©resis
y duraci√≥n de impulso.
S√≥lo es posible activar uno de los par√°metros de instrucci√≥n L_DIRECT, L_PREPAR y
C_DOPARA a la vez.
Direc‚Äê
ci√≥n
del DB

Par√°metro

Tipo de
datos

Significado

14.0

LOAD_VA
L

DINT

Valor de carga; carga directa y preparatoria con el par√°metro de instrucci√≥n L_DIRECT
Valor de carga; carga preparatoria con el par√°metro de instrucci√≥n L_PREPAR
Comportamiento de las salidas DO0 y DO1, de la hist√©resis y de la duraci√≥n de impulso;
definir con el par√°metro de instrucci√≥n C_DOPARA:
Bit 3

Bit 2

Bit 1

Bit 0

Comportamiento de la salida DO0

x

0

0

0

Inactiva

x

0

0

1

Activo desde el valor de comparaci√≥n hasta el l√≠mite supe‚Äê
rior

x

0

1

0

Activo desde valor de comparaci√≥n hasta el l√≠mite inferior

x

0

1

1

Activa al alcanzarse el valor de comparaci√≥n por la dura‚Äê
ci√≥n del impulso hacia delante/atr√°s

x

1

0

0

Activa al alcanzarse el valor de comparaci√≥n por la dura‚Äê
ci√≥n del impulso hacia delante

x

1

0

1

Activa al alcanzarse el valor de comparaci√≥n por la dura‚Äê
ci√≥n del impulso hacia atr√°s

Bit 7

Bit 6

Bit 5

Bit 4

Comportamiento de la salida DO1

x

0

0

0

Inactivo

x

0

0

1

Activo desde el valor de comparaci√≥n hasta el l√≠mite supe‚Äê
rior

x

0

1

0

Activo desde valor de comparaci√≥n hasta el l√≠mite inferior

x

0

1

1

Activo al alcanzar el valor de comparaci√≥n durante la du‚Äê
raci√≥n del impulso hacia delante/atr√°s

x

1

0

0

Activo al alcanzar el valor de comparaci√≥n en sentido as‚Äê
cendente durante la duraci√≥n del impulso

x

1

0

1

Activo al alcanzarse el valor de comparaci√≥n en sentido
descendente durante la duraci√≥n del impulso

x

1

1

0

Conmutaci√≥n en los valores de comparaci√≥n

15.0

Hist√©resis (rango de valores 0...255)

16.0

Duraci√≥n del impulso (rango de valores 0...250)

17.0

Reservado = 0

18.0

CMP_V1

DINT

Valor de comparaci√≥n 1; cargar con el par√°metro de instrucci√≥n T_CMP_V1

22.0

CMP_V2

DINT

Valor de comparaci√≥n 2; cargar con el par√°metro de instrucci√≥n T_CMP_V2

x = irrelevante

6566

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros del DB para transferir valores (modos de medici√≥n)
Preparaci√≥n
Antes de llamar las instrucciones CNT_CTRL (P√°gina 6552), CNT_CTL1 (P√°gina 6555)
o CNT_CTL2 (P√°gina 6557) hay que asignar los siguientes datos v√°lidos al bloque de datos:
‚óè Direcci√≥n del m√≥dulo (direcci√≥n DB 6.0)
‚óè Direcci√≥n inicial del canal (direcci√≥n DB 8.0)
‚óè Longitud de la interfaz de datos de usuario (direcci√≥n DB 12.0)
Estos datos deber√≠an registrarse en el DB con cada arranque del OB 100.

Par√°metros del DB para transferir valores (modos de medici√≥n)
La siguiente tabla muestra la secci√≥n del DB a la que se transfieren los par√°metros
LOAD_VAL, CMP_V1 y CMP_V2.
El par√°metro LOAD_VAL (bytes de 14 a 17) tiene dos significados:
‚óè Si se activa el par√°metro de instrucci√≥n L_PREPAR, LOAD_VAL se interpreta como valor
l√≠mite inferior.
‚óè Si activa el par√°metro de la instrucci√≥n C_DOPARA, es posible determinar en el byte 14 el
comportamiento de la salida DO0.
S√≥lo es posible activar uno de los par√°metros de instrucci√≥n L_PREPAR y C_DOPARA a la
vez.
Direc‚Äê
ci√≥n
del DB

Par√°metros

Tipo de
datos

14.0

LOAD_VAL

DINT

Significado

Valor l√≠mite inferior; cargar con el par√°metro de instrucci√≥n L_PREPAR
Comportamiento de DO0; determinar con el par√°metro de instrucci√≥n C_DOPARA
Bits 2 a 7

Bit 1

Bit 0

Comportamiento de la salida DO0

Irrelevante

0

0

Sin comparaci√≥n

irrelevante

0

1

Activo fuera de los valores l√≠mite

irrelevante

1

0

Activo cuando se rebasa por defecto el valor l√≠mite in‚Äê
ferior

irrelevante

1

1

Activo cuando se rebasa el valor l√≠mite superior

15.0

reserva = 0

16.0

reserva = 0

17.0

reserva = 0

18.0

CMP_V1

DINT

Valor l√≠mite superior; cargar con el par√°metro de instrucci√≥n T_CMP_V1

22.0

CMP_V2

DINT

Tiempo de actualizaci√≥n; cargar con el par√°metro de instrucci√≥n T_CMP_V2

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6567

Instrucciones
4.2 Instrucciones

Contador FM 350-2
CNT2WRPN
Descripci√≥n
La instrucci√≥n CNT2WRPN carga los contadores y comparadores del m√≥dulo de contaje
mediante peticiones de escritura. Para ello, en caso necesario debe llamarse la instrucci√≥n
CNT2WRPN individualmente para cada m√≥dulo.
La instrucci√≥n CNT2WRPN debe integrarse en el programa de usuario √∫nicamente si hay que
volver a cargar los contadores y comparadores del m√≥dulo de contaje durante el
funcionamiento.

Funcionamiento
La instrucci√≥n CNT2WRPN ejecuta la petici√≥n de escritura (P√°gina 6579) (JOB_WR) desde
el DB de contaje (P√°gina 6571), transmite los datos correspondientes desde el DB de contaje
e indica el estado de la petici√≥n de escritura (P√°gina 6580). Para la petici√≥n de escritura se
emplea de manera interna la instrucci√≥n WRREC y se transmite el c√≥digo de respuesta de la
instrucci√≥n WRREC.

Llamada
La instrucci√≥n CNT2WRPN puede llamarse de forma c√≠clica o bien dentro de un programa
controlado por tiempo. No se permite realizar la llamada en un programa de interrupci√≥n
controlado por eventos.
Antes de procesar peticiones de escritura debe proporcionar los valores necesarios al √°rea de
datos correspondiente a la petici√≥n en cuesti√≥n. La √∫ltima petici√≥n de escritura tiene que haber
finalizado, es decir, el JOB_WR.NO (byte de datos DBB0) del DB de contaje (P√°gina 6571)
est√° borrado.

Par√°metros
Par√°metro

Declaraci√≥n Tipo de datos

Descripci√≥n

El usuario lo ...

La instrucci√≥n lo
‚Ä¶

DB_NO

INPUT

WORD

N√∫mero del bloque de datos de contaje

registra

consulta

RET_VAL

OUTPUT

INT

C√≥digo de respuesta de la instrucci√≥n
WRREC

consulta

registra

CNT2RDPN
Descripci√≥n
La instrucci√≥n CNT2RDPN lee los valores de contaje y valores medidos del m√≥dulo de contaje
con peticiones de lectura. Para ello se debe llamar la instrucci√≥n CNT2RDPN de forma c√≠clica
una vez por cada m√≥dulo.

6568

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
La instrucci√≥n CNT2RDPN no debe incorporarse al programa de usuario cuando no se
procesan peticiones de lectura.

Funcionamiento
La instrucci√≥n ejecuta la petici√≥n de lectura (P√°gina 6581) (JOB_RD) desde el DB de contaje
(P√°gina 6571), transmite los datos correspondientes al DB de contaje e indica el estado de la
petici√≥n de lectura (P√°gina 6582). Para la petici√≥n de lectura se emplea de manera interna la
instrucci√≥n RDREC y se transmite el c√≥digo de respuesta de la instrucci√≥n RDREC.

Llamada
La instrucci√≥n CNT2RDPN puede llamarse de forma c√≠clica o bien dentro de un programa
controlado por tiempo. No se permite realizar la llamada en un programa de interrupci√≥n
controlado por eventos.
La √∫ltima petici√≥n de lectura tiene que haber finalizado, es decir, el JOB_RD.NO (byte de datos
DBB2) del DB de contaje (P√°gina 6571) est√° borrado.

Par√°metros
Par√°metro

Declaraci√≥n Tipo de datos

Descripci√≥n

El usuario lo ... La instrucci√≥n lo
‚Ä¶

DB_NO

INPUT

WORD

N√∫mero del bloque de datos de contaje

registra

consulta

RET_VAL

OUTPUT

INT

C√≥digo de respuesta de la instrucci√≥n
RDREC

consulta

registra

CNT2_CTR
Descripci√≥n
La instrucci√≥n CNT2_CTR controla las salidas digitales (habilitar y bloquear) y las puertas
software del m√≥dulo de contaje. Adem√°s, recibe las respuestas del m√≥dulo.

Funcionamiento
La instrucci√≥n CNT2_CTR
‚óè inicializa el DB de contaje (P√°gina 6571).
‚óè transmite las se√±ales de control del DB de contaje (estructura CONTROL_SIGNALS
(P√°gina 6578)) al m√≥dulo.
‚óè lee las se√±ales de respuesta. La instrucci√≥n guarda los valores le√≠dos en la
estructura CHECKBACK_SIGNALS (P√°gina 6578) del DB de contaje.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6569

Instrucciones
4.2 Instrucciones

Llamada
Debe llamar la instrucci√≥n CNT2_CTR c√≠clicamente (en el OB 1 √≥ en las alarmas c√≠clicas) para
cada m√≥dulo. No se permite realizar la llamada en un programa de interrupci√≥n.
Antes de la llamada de la instrucci√≥n CNT2_CTR, introduzca las se√±ales de control actuales
en la estructura CONTROL_SIGNALS en el DB de contaje (P√°gina 6571). Despu√©s de la
llamada de la instrucci√≥n CNT2_CTR, las se√±ales de respuesta de la estructura
CHECKBACK_SIGNALS est√°n actualizadas en el DB de contaje, desde donde puede
procesarlas.

Par√°metros
Par√°metro

Declaraci√≥n

Tipo de
datos

Descripci√≥n

El usuario lo ...

La instrucci√≥n lo ‚Ä¶

DB_NO

INPUT

WORD

N√∫mero del bloque de datos de contaje

registra

consulta

DIAG_RD
Descripci√≥n
La instrucci√≥n DIAG_RD carga los datos de la alarma de diagn√≥stico en el DB de contaje
cuando aparece una alarma de diagn√≥stico.

Funcionamiento
La instrucci√≥n DIAG_RD lee 16 bytes de datos de diagn√≥stico del m√≥dulo de contaje y los
transfiere al DB de contaje (P√°gina 6571) al √°rea de datos DIAGNOSTIC_IN_INFO. Estos
datos contienen el estado de diagn√≥stico de todo el m√≥dulo (para todos los contadores). Los
datos de diagn√≥stico se leen internamente con la instrucci√≥n RDSYSST. El c√≥digo de
respuesta de esta instrucci√≥n se transmite como RET_VAL.

Llamada
La instrucci√≥n DIAG_RD s√≥lo se puede llamar en el programa de interrupci√≥n.

Par√°metros
Par√°metro

Declaraci√≥n Tipo de da‚Äê
tos

Descripci√≥n

El usuario lo ...

La instrucci√≥n lo
‚Ä¶

DB_NO

INPUT

WORD

N√∫mero del bloque de datos de contaje

registra

consulta

RET_VAL

OUTPUT

INT

C√≥digo de respuesta de la instrucci√≥n
RDSYSST

consulta

registra

6570

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Otras referencias para el FM 350-2 Counter V2
Bloque de datos de contaje
Tarea
El DB de contaje es la interfaz de datos entre el programa de usuario y el FM 350‚Äë2. Contiene
y aplica todos los datos necesarios para el control y el funcionamiento del m√≥dulo.
Antes de parametrizar el m√≥dulo deben asignarse los siguientes datos v√°lidos al DB de contaje:
‚óè Direcci√≥n del m√≥dulo (direcci√≥n 12.0)
‚óè Direcci√≥n inicial del canal (direcci√≥n 14.0)
‚óè DS-OFFSET (direcci√≥n 18.0), est√° fijada en 0

Contenido
La tabla siguiente muestra el contenido del DB de contaje.
Nota
Los datos que no se indican en esta tabla no se pueden modificar.

Direcci√≥n Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario

0.0

NO

BYTE

B#16#0

N√∫mero

1.0

BUSY

BOOL

FALSE

TRUE: petici√≥n de escritura en curso
FALSE: petici√≥n de escritura no en curso

1.1

DONE

BOOL

FALSE

1.2

IMPOSS

BOOL

FALSE

1.3

UNKNOWN

BOOL

FALSE

2.0

NO

BYTE

B#16#0

3.0

BUSY

BOOL

FALSE

TRUE: petici√≥n de escritura finalizada
FALSE: petici√≥n de escritura no finalizada
TRUE: petici√≥n de escritura no posible
FALSE: petici√≥n de escritura posible
TRUE: petici√≥n de escritura desconocida
FALSE: petici√≥n de escritura conocida
N√∫mero
TRUE: petici√≥n de lectura en curso
FALSE: petici√≥n de lectura no en curso

3.1

DONE

BOOL

FALSE

TRUE: petici√≥n de lectura finalizada
FALSE: petici√≥n de lectura no finalizada

3.2

IMPOSS

BOOL

FALSE

3.3

UNKNOWN

BOOL

FALSE

TRUE: petici√≥n de escritura no posible
FALSE: petici√≥n de lectura posible
TRUE: petici√≥n de lectura desconocida
FALSE: petici√≥n de lectura conocida

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6571

Instrucciones
4.2 Instrucciones
Direcci√≥n Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario

4.0

RESERV_0

ARRAY
[1..3] OF
WORD

W#16#0

Reservado

10.0

RESERV_1

WORD

W#16#0

Reservado

12.0

MOD_ADR

WORD

W#16#0

Direcci√≥n del m√≥dulo

14.0

CH_ADR

DWORD

DW#16#0

Direcci√≥n del canal

18.0

DS_OFFS

BYTE

B#16#0

Offset bloque de datos

19.0

RESERV_2

BYTE

B#16#0

Reservado

20.0

BIT0_0

BOOL

FALSE

Reservado

20.1

BIT0_1

BOOL

FALSE

Reservado

20.2

BIT0_2

BOOL

FALSE

Reservado

20.3

BIT0_3

BOOL

FALSE

Reservado

20.4

BIT0_4

BOOL

FALSE

Reservado

20.5

BIT0_5

BOOL

FALSE

Reservado

20.6

BIT0_6

BOOL

FALSE

Reservado

20.7

BIT0_7

BOOL

FALSE

Reservado

21.0

CTRL_DQ0

BOOL

FALSE

TRUE: Salida 0 habilitada
FALSE: Salida 0 no habilitada

21.1

CTRL_DQ1

BOOL

FALSE

TRUE: Salida 1 habilitada
FALSE: Salida 1 no habilitada

21.2

CTRL_DQ2

BOOL

FALSE

21.3

CTRL_DQ3

BOOL

FALSE

21.4

CTRL_DQ4

BOOL

FALSE

21.5

CTRL_DQ5

BOOL

FALSE

21.6

CTRL_DQ6

BOOL

FALSE

21.7

CTRL_DQ7

BOOL

FALSE

TRUE: Salida 2 habilitada
FALSE: Salida 2 no habilitada
TRUE: Salida 3 habilitada
FALSE: Salida 3 no habilitada
TRUE: Salida 4 habilitada
FALSE: Salida 4 no habilitada
TRUE: Salida 5 habilitada
FALSE: Salida 5 no habilitada
TRUE: Salida 6 habilitada
FALSE: Salida 6 no habilitada
TRUE: Salida 7 habilitada
FALSE: Salida 7 no habilitada

22.0

SET_DQ0

BOOL

FALSE

TRUE: Salida 0 activada
FALSE: Salida 0 no activada

22.1

SET_DQ1

BOOL

FALSE

TRUE: Salida 1 activada
FALSE: Salida 1 no activada

22.2

SET_DQ2

BOOL

FALSE

TRUE: Salida 2 activada
FALSE: Salida 2 no activada

22.3

SET_DQ3

BOOL

FALSE

TRUE: Salida 3 activada
FALSE: Salida 3 no activada

22.4

SET_DQ4

BOOL

FALSE

TRUE: Salida 4 activada
FALSE: Salida 4 no activada

6572

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario

22.5

SET_DQ5

BOOL

FALSE

TRUE: Salida 5 activada

22.6

SET_DQ6

BOOL

FALSE

22.7

SET_DQ7

BOOL

FALSE

23.0

SW_GATE0

BOOL

FALSE

FALSE: Salida 5 no activada
TRUE: Salida 6 activada
FALSE: Salida 6 no activada
TRUE: Salida 7 activada
FALSE: Salida 7 no activada
TRUE: Puerta SW contador 0 abierta
FALSE: Puerta SW contador 0 cerrada
23.1

SW_GATE1

BOOL

FALSE

TRUE: Puerta SW contador 1 abierta
FALSE: Puerta SW contador 1 cerrada

23.2

SW_GATE2

BOOL

FALSE

TRUE: Puerta SW contador 2 abierta
FALSE: Puerta SW contador 2 cerrada

23.3

SW_GATE3

BOOL

FALSE

TRUE: Puerta SW contador 3 abierta
FALSE: Puerta SW contador 3 cerrada

23.4

SW_GATE4

BOOL

FALSE

TRUE: Puerta SW contador 4 abierta
FALSE: Puerta SW contador 4 cerrada

23.5

SW_GATE5

BOOL

FALSE

TRUE: Puerta SW contador 5 abierta
FALSE: Puerta SW contador 5 cerrada

23.6

SW_GATE6

BOOL

FALSE

TRUE: Puerta SW contador 6 abierta
FALSE: Puerta SW contador 6 cerrada

23.7

SW_GATE7

BOOL

FALSE

TRUE: Puerta SW contador 7 abierta

24.0

CTRL_DWORD1

DWORD

DW#16#0

Reservado

28.0

CTRL_DWORD2

DWORD

DW#16#0

Reservado

32.0

CTRL_DWORD3

DWORD

DW#16#0

Reservado

36.0

BIT0_0

BOOL

FALSE

Reservado

36.1

STS_TFB

BOOL

FALSE

TRUE: Modo PG activo

FALSE: Puerta SW contador 7 cerrado

FALSE: Ning√∫n modo PG
36.2

BIT0_2

BOOL

FALSE

Reservado

36.3

BIT0_3

BOOL

FALSE

Reservado

36.4

DATA_ERR

BOOL

FALSE

Error de datos

36.5

BIT0_5

BOOL

FALSE

Reservado

36.6

BIT0_6

BOOL

FALSE

Reservado

36.7

PARA

BOOL

FALSE

TRUE: M√≥dulo parametrizado
FALSE: M√≥dulo no parametrizado

37.0

STS_CMP0

BOOL

FALSE

TRUE: Comparador 0 activado
FALSE: Comparador 0 no activado

37.1

STS_CMP1

BOOL

FALSE

TRUE: Comparador 1 activado
FALSE: Comparador 1 no activado

37.2

STS_CMP2

BOOL

FALSE

TRUE: Comparador 2 activado
FALSE: Comparador 2 no activado

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6573

Instrucciones
4.2 Instrucciones
Direcci√≥n Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario

37.3

STS_CMP3

BOOL

FALSE

TRUE: Comparador 3 activado

37.4

STS_CMP4

BOOL

FALSE

37.5

STS_CMP5

BOOL

FALSE

37.6

STS_CMP6

BOOL

FALSE

FALSE: Comparador 3 no activado
TRUE: Comparador 4 activado
FALSE: Comparador 4 no activado
TRUE: Comparador 5 activado
FALSE: Comparador 5 no activado
TRUE: Comparador 6 activado
FALSE: Comparador 6 no activado
37.7

STS_CMP7

BOOL

FALSE

TRUE: Comparador 7 activado
FALSE: Comparador 7 no activado

38.0

STS_UFLW0

BOOL

FALSE

TRUE: Rebase por defecto contador 0
FALSE: No hay rebase por defecto contador 0

38.1

STS_UFLW1

BOOL

FALSE

TRUE: Rebase por defecto contador 1
FALSE: No hay rebase por defecto contador 1

38.2

STS_UFLW2

BOOL

FALSE

TRUE: Rebase por defecto contador 2
FALSE: No hay rebase por defecto contador 2

38.3

STS_UFLW3

BOOL

FALSE

TRUE: Rebase por defecto contador 3
FALSE: No hay rebase por defecto contador 3

38.4

STS_UFLW4

BOOL

FALSE

TRUE: Rebase por defecto contador 4
FALSE: No hay rebase por defecto contador 4

38.5

STS_UFLW5

BOOL

FALSE

38.6

STS_UFLW6

BOOL

FALSE

38.7

STS_UFLW7

BOOL

FALSE

39.0

STS_OFLW0

BOOL

FALSE

39.1

STS_OFLW1

BOOL

FALSE

39.2

STS_OFLW2

BOOL

FALSE

TRUE: Rebase por defecto contador 5
FALSE: No hay rebase por defecto contador 5
TRUE: Rebase por defecto contador 6
FALSE: No hay rebase por defecto contador 6
TRUE: Rebase por defecto contador 7
FALSE: No hay rebase por defecto contador 7
TRUE: Rebase por exceso contador 0
FALSE: No hay rebase por exceso contador 0
TRUE: Rebase por exceso contador 1
FALSE: No hay rebase por exceso contador 1
TRUE: Rebase por exceso contador 2
FALSE: No hay rebase por exceso contador 2

39.3

STS_OFLW3

BOOL

FALSE

TRUE: Rebase por exceso contador 3
FALSE: No hay rebase por exceso contador 3

39.4

STS_OFLW4

BOOL

FALSE

TRUE: Rebase por exceso contador 4
FALSE: No hay rebase por exceso contador 4

39.5

STS_OFLW5

BOOL

FALSE

TRUE: Rebase por exceso contador 5
FALSE: No hay rebase por exceso contador 5

39.6

STS_OFLW6

BOOL

FALSE

TRUE: Rebase por exceso contador 6
FALSE: No hay rebase por exceso contador 6

39.7

STS_OFLW7

BOOL

FALSE

TRUE: Rebase por exceso contador 7
FALSE: No hay rebase por exceso contador 7

6574

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario

40.0

STS_DIR0

BOOL

FALSE

TRUE: Sentido de contaje contador 0 atr√°s

40.1

STS_DIR1

BOOL

FALSE

40.2

STS_DIR2

BOOL

FALSE

40.3

STS_DIR3

BOOL

FALSE

FALSE: Sentido de contaje contador 0 adelante
TRUE: Sentido de contaje contador 1 atr√°s
FALSE: Sentido de contaje contador 1 adelante
TRUE: Sentido de contaje contador 2 atr√°s
FALSE: Sentido de contaje contador 2 adelante
TRUE: Sentido de contaje contador 3 atr√°s
FALSE: Sentido de contaje contador 3 adelante
40.4

STS_DIR4

BOOL

FALSE

TRUE: Sentido de contaje contador 4 atr√°s
FALSE: Sentido de contaje contador 4 adelante

40.5

STS_DIR5

BOOL

FALSE

TRUE: Sentido de contaje contador 5 atr√°s
FALSE: Sentido de contaje contador 5 adelante

40.6

STS_DIR6

BOOL

FALSE

TRUE: Sentido de contaje contador 6 atr√°s
FALSE: Sentido de contaje contador 6 adelante

40.7

STS_DIR7

BOOL

FALSE

TRUE: Sentido de contaje contador 7 atr√°s
FALSE: Sentido de contaje contador 7 adelante

41.0

STS_DI0

BOOL

FALSE

TRUE: Entrada digital 0 activada
FALSE: Entrada digital 0 no activada

41.1

STS_DI1

BOOL

FALSE

TRUE: Entrada digital 1 activada
FALSE: Entrada digital 1 no activada

41.2

STS_DI2

BOOL

FALSE

41.3

STS_DI3

BOOL

FALSE

41.4

STS_DI4

BOOL

FALSE

41.5

STS_DI5

BOOL

FALSE

41.6

STS_DI6

BOOL

FALSE

41.7

STS_DI7

BOOL

FALSE

TRUE: Entrada digital 2 activada
FALSE: Entrada digital 2 no activada
TRUE: Entrada digital 3 activada
FALSE: Entrada digital 3 no activada
TRUE: Entrada digital 4 activada
FALSE: Entrada digital 4 no activada
TRUE: Entrada digital 5 activada
FALSE: Entrada digital 5 no activada
TRUE: Entrada digital 6 activada
FALSE: Entrada digital 6 no activada
TRUE: Entrada digital 7 activada
FALSE: Entrada digital 7 no activada

42.0

STS_DQ0

BOOL

FALSE

TRUE: Salida digital 0 activada
FALSE: Salida digital 0 no activada

42.1

STS_DQ1

BOOL

FALSE

TRUE: Salida digital 1 activada
FALSE: Salida digital 1 no activada

42.2

STS_DQ2

BOOL

FALSE

TRUE: Salida digital 2 activada
FALSE: Salida digital 2 no activada

42.3

STS_DQ3

BOOL

FALSE

TRUE: Salida digital 3 activada
FALSE: Salida digital 3 no activada

42.4

STS_DQ4

BOOL

FALSE

TRUE: Salida digital 4 activada
FALSE: Salida digital 4 no activada

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6575

Instrucciones
4.2 Instrucciones
Direcci√≥n Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario

42.5

STS_DQ5

BOOL

FALSE

TRUE: Salida digital 5 activada

42.6

STS_DQ6

BOOL

FALSE

42.7

STS_DQ7

BOOL

FALSE

43.0

STS_GATE0

BOOL

FALSE

FALSE: Salida digital 5 no activada
TRUE: Salida digital 6 activada
FALSE: Salida digital 6 no activada
TRUE: Salida digital 7 activada
FALSE: Salida digital 7 no activada
TRUE: Puerta interna contador 0 abierta
FALSE: Puerta interna contador 0 cerrada
43.1

STS_GATE1

BOOL

FALSE

TRUE: Puerta interna contador 1 abierta
FALSE: Puerta interna contador 1 cerrada

43.2

STS_GATE2

BOOL

FALSE

TRUE: Puerta interna contador 2 abierta
FALSE: Puerta interna contador 2 cerrada

43.3

STS_GATE3

BOOL

FALSE

TRUE: Puerta interna contador 3 abierta
FALSE: Puerta interna contador 3 cerrada

43.4

STS_GATE4

BOOL

FALSE

TRUE: Puerta interna contador 4 abierta
FALSE: Puerta interna contador 4 cerrada

43.5

STS_GATE5

BOOL

FALSE

TRUE: Puerta interna contador 5 abierta
FALSE: Puerta interna contador 5 cerrada

43.6

STS_GATE6

BOOL

FALSE

TRUE: Puerta interna contador 6 abierta
FALSE: Puerta interna contador 6 cerrada

43.7

STS_GATE7

BOOL

FALSE

TRUE: Puerta interna contador 7 abierta

44

USER_STAT_WORD0

WORD

W#16#0

Seg√∫n parametrizaci√≥n valores de contaje / medi‚Äê
ci√≥n

46

USER_STAT_WORD1

WORD

W#16#0

Seg√∫n parametrizaci√≥n valores de contaje / medi‚Äê
ci√≥n

48

USER_STAT_WORD2

WORD

W#16#0

Seg√∫n parametrizaci√≥n valores de contaje / medi‚Äê
ci√≥n

50

USER_STAT_WORD3

WORD

W#16#0

Seg√∫n parametrizaci√≥n valores de contaje / medi‚Äê
ci√≥n

52

LOAD-VAL0

DINT

L#0

Cargar directamente contador 0

56

LOAD-VAL1

DINT

L#0

Cargar directamente contador 1

60

LOAD-VAL2

DINT

L#0

Cargar directamente contador 2

64

LOAD-VAL3

DINT

L#0

Cargar directamente contador 3

68

LOAD-VAL4

DINT

L#0

Cargar directamente contador 4

72

LOAD-VAL5

DINT

L#0

Cargar directamente contador 5

76

LOAD-VAL6

DINT

L#0

Cargar directamente contador 6

80

LOAD-VAL7

DINT

L#0

Cargar directamente contador 7

84

LOAD-PREPARE-VAL0

DINT

L#0

Carga preliminar del contador 0

88

LOAD-PREPARE-VAL1

DINT

L#0

Carga preliminar del contador 1

92

LOAD-PREPARE-VAL2

DINT

L#0

Carga preliminar del contador 2

96

LOAD-PREPARE-VAL3

DINT

L#0

Carga preliminar del contador 3

100

LOAD-PREPARE-VAL4

DINT

L#0

Carga preliminar del contador 4

FALSE: Puerta interna contador 7 cerrada

6576

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario

104

LOAD-PREPARE-VAL5

DINT

L#0

Carga preliminar del contador 5

108

LOAD-PREPARE-VAL6

DINT

L#0

Carga preliminar del contador 6

112

LOAD-PREPARE-VAL7

DINT

L#0

Carga preliminar del contador 7

116

CMP-VAL0

DINT

L#0

Cargar comparador 0

120

CMP-VAL1

DINT

L#0

Cargar comparador 1

124

CMP-VAL2

DINT

L#0

Cargar comparador 2

128

CMP-VAL3

DINT

L#0

Cargar comparador 3

132

CMP-VAL4

DINT

L#0

Cargar comparador 4

136

CMP-VAL5

DINT

L#0

Cargar comparador 5

140

CMP-VAL6

DINT

L#0

Cargar comparador 6

144

CMP-VAL7

DINT

L#0

Cargar comparador 7

148

ACT_CNTV0

DINT

L#0

Estado actual contador 0

152

ACT_MSRV0

DINT

L#0

Resultado de medici√≥n 0

156

ACT_CNTV1

DINT

L#0

Estado actual contador 1

160

ACT_MSRV1

DINT

L#0

Resultado de medici√≥n 1

164

ACT_CNTV2

DINT

L#0

Estado actual contador 2

168

ACT_MSRV2

DINT

L#0

Resultado de medici√≥n 2

172

ACT_CNTV3

DINT

L#0

Estado actual contador 3

176

ACT_MSRV3

DINT

L#0

Resultado de medici√≥n 3

180

ACT_CNTV4

DINT

L#0

Estado actual contador 4

184

ACT_MSRV4

DINT

L#0

Resultado de medici√≥n 4

188

ACT_CNTV5

DINT

L#0

Estado actual contador 5

192

ACT_MSRV5

DINT

L#0

Resultado de medici√≥n 5

196

ACT_CNTV6

DINT

L#0

Estado actual contador 6

200

ACT_MSRV6

DINT

L#0

Resultado de medici√≥n 6

204

ACT_CNTV7

DINT

L#0

Estado actual contador 7

208

ACT_MSRV7

DINT

L#0

Resultado de medici√≥n 7

212.0

BYTE0

BYTE

B#16#0

Reservado

213.0

BYTE1

BYTE

B#16#0

Reservado

214.0

BYTE2

BYTE

B#16#0

Reservado

215.0

BYTE3

BYTE

B#16#0

Reservado

216.0

BYTE4

BYTE

B#16#0

Tipo de canal

217.0

BYTE5

BYTE

B#16#0

Longitud informaci√≥n de canal

218.0

BYTE6

BYTE

B#16#0

N√∫mero de canales

219.0

BYTE7

BYTE

B#16#0

Vector de error de canal

220.0

BYTE8

BYTE

B#16#0

Error contador 0

221.0

BYTE9

BYTE

B#16#0

Error contador 1

222.0

BYTE10

BYTE

B#16#0

Error contador 2

223.0

BYTE11

BYTE

B#16#0

Error contador 3

224.0

BYTE12

BYTE

B#16#0

Error contador 4

225.0

BYTE13

BYTE

B#16#0

Error contador 5

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6577

Instrucciones
4.2 Instrucciones
Direcci√≥n Variable

Tipo de da‚Äê
tos

Valor inicial

Comentario

226.0

BYTE14

BYTE

B#16#0

Error contador 6

227.0

BYTE15

BYTE

B#16#0

Error contador 7

CONTROL_SIGNALS
CONTROL_SIGNALS
Direcci√≥n

Par√°metro

Tipo de da‚Äê
tos

Valor inicial

Descripci√≥n

21.0 ‚Ä¶ 7

CTRL_DQ0 ‚Ä¶ 7

BOOL

FALSE

Habilitar las salidas digitales 0 ‚Ä¶ 7

22.0 ‚Ä¶ 7

SET_DQ0 ‚Ä¶ 7

BOOL

FALSE

Controlar las salidas digitales 0 ‚Ä¶ 7

23.0 ‚Ä¶ 7

SW_GATE0 ‚Ä¶ 7

BOOL

FALSE

Puerta software del contador 0 ‚Ä¶ 7

CHECKBACK_SIGNALS
CHECKBACK_SIGNALS
Direcci√≥n

Par√°metro

Tipo de
datos

Valor ini‚Äê
cial

Descripci√≥n

36.1

STS_TFB

BOOL

FALSE

TRUE: El modo de programadora est√° activo, imposible
controlar desde la CPU
FALSE: Modo de programadora deseleccionado

36.4

DATA_ERR

BOOL

FALSE

TRUE: Error de datos
FALSE: Sin errores de datos

36.7

PARA

BOOL

FALSE

TRUE: El m√≥dulo de contaje est√° parametrizado, todas
las CHECKBACK_SIGNALS restantes son v√°lidas
FALSE: M√≥dulo de contaje no parametrizado

37.0 ‚Ä¶ 7

STS_CMP0 ‚Ä¶ 7

BOOL

FALSE

Estado del comparador 0 ‚Ä¶ 7
Debe evaluar el estado despu√©s de la llamada de la ins‚Äê
trucci√≥n CNT2_CTR, ya que despu√©s se desactiva

38.0 ‚Ä¶ 7

STS_UFLW0 ‚Ä¶ 7

BOOL

FALSE

Estado de rebase por defecto del contador 0 ‚Ä¶ 7
Debe evaluar el estado despu√©s de la llamada de la ins‚Äê
trucci√≥n CNT2_CTR, ya que despu√©s se desactiva

39.0 ‚Ä¶ 7

STS_OFLW0 ‚Ä¶ 7

BOOL

FALSE

Estado de rebase por exceso del contador 0 ‚Ä¶ 7
Debe evaluar el estado despu√©s de la llamada de la ins‚Äê
trucci√≥n CNT2_CTR, ya que despu√©s se desactiva

40.0 ‚Ä¶ 7

STS_DIR0 ‚Ä¶ 7

BOOL

FALSE

Estado del sentido de contaje del contador 0 ‚Ä¶ 7
Debe evaluar el estado despu√©s de la llamada de la ins‚Äê
trucci√≥n CNT2_CTR, ya que despu√©s se desactiva

41.0 ‚Ä¶ 7

STS_DI0 ‚Ä¶ 7

BOOL

FALSE

Estado de la entrada digital 0 ‚Ä¶ 7

42.0 ‚Ä¶ 7

STS_DQ0 ‚Ä¶ 7

BOOL

FALSE

Estado de la salida digital 0 ‚Ä¶ 7

43.0 ‚Ä¶ 7

STS_GATE0 ‚Ä¶ 7

BOOL

FALSE

Estado de la puerta interna del contador 0 ‚Ä¶ 7

6578

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metro

Tipo de
datos

Valor ini‚Äê
cial

Descripci√≥n

44

USER_STAT_DWORD0

WORD

W#16#0

Seg√∫n parametrizaci√≥n del valor de contaje / valor me‚Äê
dido

46

USER_STAT_DWORD1

WORD

W#16#0

Seg√∫n parametrizaci√≥n del valor de contaje / valor me‚Äê
dido

48

USER_STAT_DWORD2

WORD

W#16#0

Seg√∫n parametrizaci√≥n del valor de contaje / valor me‚Äê
dido

50

USER_STAT_DWORD3

WORD

W#16#0

Seg√∫n parametrizaci√≥n del valor de contaje / valor me‚Äê
dido

Petici√≥n de escritura
Petici√≥n de escritura
Para lanzar una nueva petici√≥n de escritura se registra una petici√≥n de escritura en
JOB_WR.NO. Se admiten las siguientes peticiones de escritura:
JOB_WR.NO

Entrada en CNT2_CHANTYPE

Direcci√≥n en Significado del modo de contaje
el DB de con‚Äê
taje

0

Ninguna

Ninguna

Ninguna petici√≥n de escritura / √∫ltima petici√≥n de escritura
finalizada

10

LOAD_VAL0

52

Cargar directamente contador 0

Cargar l√≠mite inferior 0

11

LOAD_VAL1

56

Cargar directamente contador 1

Cargar l√≠mite inferior 1

12

LOAD_VAL2

60

Cargar directamente contador 2

Cargar l√≠mite inferior 2

13

LOAD_VAL3

64

Cargar directamente contador 3

Cargar l√≠mite inferior 3

14

LOAD_VAL4

68

Cargar directamente contador 4

Cargar l√≠mite inferior 4

15

LOAD_VAL5

72

Cargar directamente contador 5

Cargar l√≠mite inferior 5

16

LOAD_VAL6

76

Cargar directamente contador 6

Cargar l√≠mite inferior 6

17

LOAD_VAL7

80

Cargar directamente contador 7

Cargar l√≠mite inferior 7

20

LOAD_PREPARE_VAL0

84

Carga preliminar del contador 0

Cargar l√≠mite superior 0

(DBB0)

Significado del modo
de medici√≥n

21

LOAD_PREPARE_VAL1

88

Carga preliminar del contador 1

Cargar l√≠mite superior 1

22

LOAD_PREPARE_VAL2

92

Carga preliminar del contador 2

Cargar l√≠mite superior 2

23

LOAD_PREPARE_VAL3

96

Carga preliminar del contador 3

Cargar l√≠mite superior 3

24

LOAD_PREPARE_VAL4

100

Carga preliminar del contador 4

Cargar l√≠mite superior 4

25

LOAD_PREPARE_VAL5

104

Carga preliminar del contador 5

Cargar l√≠mite superior 5

26

LOAD_PREPARE_VAL6

108

Carga preliminar del contador 6

Cargar l√≠mite superior 6

27

LOAD_PREPARE_VAL7

112

Carga preliminar del contador 7

Cargar l√≠mite superior 7

30

CMP_VAL0

116

Cargar comparador 0

31

CMP_VAL1

120

Cargar comparador 1

32

CMP_VAL2

124

Cargar comparador 2

33

CMP_VAL3

128

Cargar comparador 3

34

CMP_VAL4

132

Cargar comparador 4

35

CMP_VAL5

136

Cargar comparador 5

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6579

Instrucciones
4.2 Instrucciones
JOB_WR.NO

Entrada en CNT2_CHANTYPE

Direcci√≥n en Significado del modo de contaje
el DB de con‚Äê
taje

36

CMP_VAL6

140

37

CMP_VAL7

144

Cargar comparador 7

40

LOAD_VAL0 a LOAD_VAL3

52 a 67

Cargar directamente contadores
0a3

Cargar l√≠mite inferior 0
a3

41

LOAD_VAL4 a LOAD_VAL7

68 a 83

Cargar directamente contadores
4a7

Cargar l√≠mite inferior 4
a7

42

LOAD_VAL0 a LOAD_VAL7

52 a 83

Cargar directamente contadores
0a7

Cargar l√≠mite inferior 0
a7

50

LOAD_PREPARE_VAL0 a
LOAD_PREPARE_VAL3

84 a 99

Carga preliminar de contadores
0a3

Cargar l√≠mite superior
0a3

51

LOAD_PREPARE_VAL4 a
LOAD_PREPARE_VAL7

100 a 111

Carga preliminar de contadores
4a7

Cargar l√≠mite superior
4a7

52

LOAD_PREPARE_VAL0 a
LOAD_PREPARE_VAL7

84 a 111

Carga preliminar de contadores
0a7

Cargar l√≠mite superior
0a7

60

CMP_VAL0 a CMP_VAL3

116 a 131

Cargar comparadores 0 a 3

61

CMP_VAL4 a CMP_VAL7

132 a 147

Cargar comparadores 4 a 7

62

CMP_VAL0 a CMP_VAL7

116 a 147

Cargar comparadores 0 a 7

(DBB0)

Significado del modo
de medici√≥n

Cargar comparador 6

Estado de la petici√≥n de escritura
Estado de una petici√≥n de escritura
El estado de una petici√≥n de escritura se indica en el DB de contaje (byte de datos DBB1).
Bit en JOB_WR

Significado

(DBX1.)
.BUSY, 0

= 1: Petici√≥n de escritura en curso. La instrucci√≥n CNT2WRPN activa este bit tan pronto como procesa
una petici√≥n de escritura (JOB_WR.NO > 0 y JOB_WR.IMPOSS = 0). La instrucci√≥n CNT2WRPN borra
el bit en cuanto finaliza la petici√≥n de escritura (JOB_WR.NO = 0).

.DONE, 1

= 1: Petici√≥n de escritura finalizada. La instrucci√≥n CNT2WRPN activa este bit en cuanto finaliza una
petici√≥n de escritura (tambi√©n err√≥nea). La instrucci√≥n CNT2WRPN borra el bit en cuanto comienza una
nueva petici√≥n de escritura. Tambi√©n se puede borrar este bit desde el programa de usuario.

.IMPOSS, 2

= 1: La petici√≥n de escritura no puede procesarse (el m√≥dulo de contaje no est√° parametrizado, el
arranque o el modo de programadora est√°n activos). La petici√≥n de escritura (JOB_WR) puede dejarse
pendiente o borrarse. La instrucci√≥n CNT2WRPN borra el bit cuando se cumplen las condiciones an‚Äê
teriores.

.UNKOWN, 3

= 1: Petici√≥n de escritura desconocida. La petici√≥n de escritura (JOB_WR) indicada no se encuentra
dentro del rango permitido (v√©ase mensaje de error). La instrucci√≥n CNT2WRPN borra este bit en
cuanto se introduce un n√∫mero v√°lido en JOB_WR. El n√∫mero desconocido se mantiene mientras tanto.

6580

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Los errores ocurridos se indican en el resultado binario (BIE = 0). Los errores posibles son:
‚óè Petici√≥n de escritura desconocida (v√©ase JOB_WR.UNKOWN).
‚óè Error al transferir los datos con la instrucci√≥n WRREC. El error queda disponible en el
par√°metro de salida RET_VAL.
‚óè El m√≥dulo comprueba e interpreta los datos transferidos en busca de errores de datos. Si
se produce un error de datos, en el DB de contaje se activa el bit
CHECKBACK_SIGNALS.DATA_ERR = 1.

Petici√≥n de lectura
Petici√≥n de lectura
Para lanzar una nueva petici√≥n de lectura se introduce una petici√≥n de lectura en JOB_RD.NO.
Se admiten las siguientes peticiones de lectura:
JOB_RD.NO

Direcci√≥n en el DB
de contaje

Significado

(DBB2)

Entrada en
CNT2_CHANTYPE

0

Ninguna

Ninguna

Ninguna petici√≥n de lectura / √∫ltima petici√≥n de
lectura finalizada

100

ACT_CNTV0

148

Estado actual del contador 0 a 3 y resultado de la
medici√≥n 0 a 3

180

Estado actual del contador 4 a 7 y resultado de la
medici√≥n 4 a 7

ACT_MSRV0
ACT_CNTV1
ACT_MSRV1
ACT_CNTV2
ACT_MSRV2
ACT_CNTV3
ACT_MSRV3
101

ACT_CNTV4
ACT_MSRV4
ACT_CNTV5
ACT_MSRV5
ACT_CNTV6
ACT_MSRV6
ACT_CNTV7
ACT_MSRV7

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6581

Instrucciones
4.2 Instrucciones

Estado de la petici√≥n de lectura
Estado de una petici√≥n de lectura
El estado de una petici√≥n de lectura se indica en el DB de contaje (byte de datos DBB3).
Bit en JOB_RD

Descripci√≥n

(DBX3.)
.BUSY, 0

= 1: Petici√≥n de lectura en curso. La instrucci√≥n CNT2RDPN activa este bit en cuanto se procesa una
petici√≥n de lectura (JOB_RD.NO > 0 y JOB_RD.IMPOSS = 0). La instrucci√≥n CNT2RDPN desactiva el
bit en cuanto finaliza la petici√≥n de lectura (JOB_RD.NO = 0).

.DONE, 1

= 1: Petici√≥n de lectura finalizada. La instrucci√≥n CNT2RDPN activa este bit en cuanto finaliza una
petici√≥n de lectura (tambi√©n err√≥nea). La instrucci√≥n CNT2RDPN borra el bit en cuanto comienza una
nueva petici√≥n de lectura. Tambi√©n es posible borrar este bit desde el programa de usuario.

.IMPOSS, 2

= 1: La petici√≥n de lectura no puede procesarse (el m√≥dulo de contaje no est√° parametrizado, el arran‚Äê
que o el modo de programadora est√°n activos). La petici√≥n de lectura (JOB_RD.NO) puede dejarse
pendiente o borrarse. La instrucci√≥n CNT2RDPN borra el bit cuando se cumplen las condiciones an‚Äê
teriores.

.UNKOWN, 3

= 1: Petici√≥n de lectura desconocida. La petici√≥n de lectura (JOB_RD) indicada no se encuentra dentro
del rango permitido (v√©ase evaluaci√≥n de errores). La instrucci√≥n CNT2RDPN borra este bit en cuanto
se introduce un n√∫mero v√°lido en JOB_RD.NO. El n√∫mero desconocido se mantiene hasta que esto
ocurre.

Los errores que se producen se muestran en el resultado binario (RB = 0). Los posibles errores
son:
‚óè Petici√≥n de lectura desconocida (v√©ase JOB_RD.UNKOWN).
‚óè Error al transferir los datos con la instrucci√≥n RDREC. El error queda disponible en el
par√°metro de salida RET_VAL.

Posicionamiento FM x51
ABS_INIT
Descripci√≥n
La instrucci√≥n ABS_INIT inicializa los datos siguientes en el DB de canal:
‚óè las se√±ales de control
‚óè las se√±ales de respuesta
‚óè los bits de disparo, bits de finalizaci√≥n y bits de error de las peticiones
‚óè los selectores de funci√≥n y sus bits de finalizaci√≥n y error
‚óè la gesti√≥n de peticiones para la instrucci√≥n ABS_CTRL (P√°gina 6583) o
bien ABS_CTRL_451 (P√°gina 6587)

6582

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n tiene que ejecutarse tras un arranque, es decir, despu√©s de conectar la fuente
de alimentaci√≥n del m√≥dulo o de la CPU para cada canal. Por ello hay que llamarla, por ej. en
el OB de rearranque OB 100 y en el OB de presencia de m√≥dulo OB 83 o en la fase de
inicializaci√≥n del programa de usuario. De este modo queda asegurado que tras un rearranque
completo de la CPU o un arranque del m√≥dulo su programa de usuario no acceda a datos
antiguos.

Bloque de datos utilizado
DB de canal (P√°gina 6591):
En el DB de canal es preciso que est√© registrada la direcci√≥n del m√≥dulo. La entrada debe
realizarse en el OB de arranque (OB 100).

Par√°metros
Par√°metro

Declaraci√≥n

Tipo de datos Descripci√≥n

DB_NO

INPUT

INT

N√∫mero del DB de canal

Valores de retorno
La instrucci√≥n no devuelve ning√∫n valor de retorno.

ABS_CTRL
Descripci√≥n
La instrucci√≥n ABS_CTRL permite leer los datos operativos de cada canal del m√≥dulo,
parametrizar los canales y controlar su funcionamiento. Para ello se utilizan se√±ales de control,
se√±ales de respuesta, selectores de funci√≥n y peticiones de escritura y lectura.

Funcionamiento
Con cada llamada la instrucci√≥n ejecuta las actividades siguientes:
‚óè Leer se√±ales de respuesta:
La instrucci√≥n ABS_CTRL lee todas las se√±ales de respuesta de un canal y las transfiere
al DB de canal. Como las se√±ales de control y las peticiones solo se procesan al final, las
se√±ales de respuesta reflejan el estado del canal antes de llamar la instrucci√≥n.
‚óè Gesti√≥n de peticiones (P√°gina 6601):
La instrucci√≥n ABS_CTRL procesa las peticiones de escritura y lectura y transfiere los datos
entre el DB de canal, DB de par√°metros y el m√≥dulo.
‚óè Escribir se√±ales de control:
Las se√±ales de control que se encuentran en el DB de canal se transfieren al m√≥dulo.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6583

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n ABS_CTRL tiene que llamarse c√≠clicamente para cada canal, por ej. en el OB 1.
Antes de llamar la instrucci√≥n ABS_CTRL, registre en el DB de canal todos los datos
necesarios para la ejecuci√≥n de las funciones deseadas.

Bloques de datos empleados
‚óè DB de canal (P√°gina 6591):
El DB de canal es el DB instancia de la instrucci√≥n ABS_CTRL. En el DB de canal es preciso
que est√©n registradas la direcci√≥n del m√≥dulo y el n√∫mero de canal. Si se introducen datos
err√≥neos, es posible que se produzcan errores de acceso a periferia o que se acceda a otro
m√≥dulo, lo que provocar√≠a falsificaciones de datos.
‚óè DB de par√°metros (P√°gina 6598):
Para leer o escribir datos m√°quina mediante peticiones, se requiere un DB de par√°metros
cuyo n√∫mero tiene que estar registrado en el DB de canal.

Valores de retorno
La instrucci√≥n devuelve los siguientes valores de retorno:
RETVAL

RB

Descripci√≥n

1

1

Por lo menos 1 petici√≥n activa

0

1

Ninguna petici√≥n activa, ning√∫n error

-1

0

Errores: se ha producido un error de datos (DATA_ERR) o
un error de comunicaci√≥n (JOB_ERR)

Se√±ales de control
Si hay una se√±al de PARADA o un error de operador o falta la habilitaci√≥n de accionamiento,
la instrucci√≥n desactiva las se√±ales de control START, DIR_M y DIR_P.
Existe la posibilidad de volver a iniciar un desplazamiento despu√©s de acusar el error de
operador con OT_ERR_A=1. Con este acuse no es posible iniciar m√°s peticiones ni se√±ales de
control.
Cuando hay pendiente un error de operador, la instrucci√≥n pone a 0 el acuse del error de
operador OT_ERR_A.
Cuando el canal notifica el inicio del desplazamiento, la instrucci√≥n desactiva las se√±ales de
inicio START, DIR_P y DIR_M, excepto con el modo de operaci√≥n "Jog".
Si no se ha parametrizado el eje, la instrucci√≥n retiene todas las se√±ales de control a excepci√≥n
del acuse de error de operador OT_ERR_A.

6584

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Peticiones y se√±ales de control
Es posible iniciar varias peticiones de forma simult√°nea, incluso con las se√±ales de control
necesarias para el posicionamiento. En el caso de que se hayan iniciado simult√°neamente por
lo menos una petici√≥n de escritura con las se√±ales de control START, DIR_M o DIR_P, la
instrucci√≥n retendr√° dichas se√±ales de control hasta que se hayan procesado las peticiones de
escritura.

Arranque
Llame la instrucci√≥n ABS_INIT (P√°gina 6582) al arrancar el m√≥dulo o la CPU. Para ello se
resetean, entre otros, los selectores de funci√≥n. La instrucci√≥n ABS_CTRL acusa el arranque
del m√≥dulo. Durante este per√≠odo, RETVAL y JOBBUSY = 1.

Comportamiento en caso de error
Si se han escrito datos err√≥neos en una petici√≥n de escritura, el canal env√≠a la respuesta
DATA_ERR = 1 en el DB de canal. Cuando se produce un error en la comunicaci√≥n con el
m√≥dulo con la petici√≥n de escritura o lectura, se guarda la causa del error en el par√°metro
JOB_ERR del DB de canal.
‚óè Error en una petici√≥n de escritura:
En el caso de una petici√≥n con errores, se desactiva el bit de inicio y se activan el bit de error
_ERR y el de finalizaci√≥n _D. En todas las peticiones de escritura pendientes, el bit de inicio
tambi√©n vuelve a su posici√≥n anterior pero solo se activa el bit de error _ERR. Se desactivan
las peticiones de escritura pendientes porque aqu√≠ es posible apilar las peticiones.
Las peticiones de lectura pendientes se siguen procesando. Para ello se vuelve a activar
JOB_ERR para cada petici√≥n.
‚óè Error en una petici√≥n de lectura:
En el caso de una petici√≥n con errores, se desactiva el bit de inicio y se activan el bit de error
_ERR y el de finalizaci√≥n _D.
Las peticiones de lectura todav√≠a pendientes se siguen procesando. Para ello se vuelve a
activar JOB_ERR para cada petici√≥n.

ABS_DIAG
Descripci√≥n
La instrucci√≥n ABS_DIAG lee el b√∫fer de diagn√≥stico del m√≥dulo y lo pone a disposici√≥n de un
indicador en el sistema de manejo y visualizaci√≥n (M+V) o de una evaluaci√≥n programada.

Funcionamiento
La instrucci√≥n lee el b√∫fer de diagn√≥stico cuando se indica una nueva entrada mediante la
se√±al de realimentaci√≥n DIAG = 1 en el DB de canal. Tras leer el b√∫fer de diagn√≥stico, el
m√≥dulo pone a 0 el bit DIAG en el DB de canal.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6585

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n tiene que llamarse c√≠clicamente, por ej. en el OB 1. No se permite realizar una
llamada adicional en un OB de alarma. Para una ejecuci√≥n completa de la instrucci√≥n hacen
falta por lo menos 2 llamadas (ciclos).

Bloque de datos empleado
DB de diagn√≥stico (P√°gina 6600):
El DB de diagn√≥stico es el DB instancia de la instrucci√≥n ABS_DIAG. Es necesario que en el
DB de diagn√≥stico est√© registrada la direcci√≥n del m√≥dulo. La entrada m√°s reciente del b√∫fer
de diagn√≥stico se registra en la estructura DIAG[1] y la m√°s antigua en la estructura DIAG[9].

Valores de retorno
La instrucci√≥n proporciona los siguientes valores de retorno en el par√°metro RETVAL del DB
de diagn√≥stico:
RETVAL

RB

Descripci√≥n

1

1

Petici√≥n activa

0

1

Ninguna petici√≥n activa, ning√∫n error

-1

0

Error

Peticiones
El b√∫fer de diagn√≥stico se puede leer aunque no haya ninguna entrada nueva activando el bit
de inicio DIAGRD_EN en el DB de diagn√≥stico. Tras leer el b√∫fer de diagn√≥stico el bit de inicio
se pone a 0.
Ejecute esta petici√≥n despu√©s de realizar un arranque de la CPU y del m√≥dulo. Con ello se
asegura que el contenido del DB de diagn√≥stico coincide con el contenido del b√∫fer de
diagn√≥stico del m√≥dulo, incluso cuando el m√≥dulo no haya realizado ninguna entrada nueva en
el b√∫fer de diagn√≥stico.

Arranque
La instrucci√≥n no ejecuta ning√∫n procesamiento del arranque.

Comportamiento en caso de error
Si la ejecuci√≥n fuera err√≥nea, encontrar√° la causa del error en el DB de diagn√≥stico, en el
par√°metro JOB_ERR.

Datos de diagn√≥stico

6586

Error

Evaluar mediante OB 82

Fallo del m√≥dulo

OB82_MDL_DEFECT

Error interno

OB82_INT_FAULT

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Error

Evaluar mediante OB 82

Fallo externo

OB82_EXT_FAULT

Hay un error de canal

OB82_PNT_INFO

Falta tensi√≥n auxiliar externa

OB82_EXT_VOLTAGE

Activaci√≥n de la vigilancia de tiempo

OB82_WTCH_DOG_FLT

Fallo de la fuente de alimentaci√≥n interna del m√≥dulo OB82_INT_PS_FLT
Se ha perdido una alarma de proceso

OB82_HW_INTR_FLT

Clases de error
Los errores que se producen est√°n agrupados en las siguientes clases de error:
‚óè Clase de error 1: fallo operativo (P√°gina 6607)
‚óè Clase de error 2: error de operador (P√°gina 6608)
‚óè Clase de error 4: error de datos (P√°gina 6609)
‚óè Clase de error 5: error de datos m√°quina (P√°gina 6610)
‚óè Clase de error 6: error de la tabla de incrementos (P√°gina 6613)
‚óè Clase de error 15: avisos (P√°gina 6613)
‚óè Clase de error 128: error de diagn√≥stico (P√°gina 6614)

ABS_CTRL_451
Descripci√≥n
La instrucci√≥n ABS_CTRL_451 permite leer los datos operativos de cada canal del m√≥dulo,
parametrizar los canales y controlar su funcionamiento. Para ello se utilizan se√±ales de control,
se√±ales de respuesta, selectores de funci√≥n y peticiones de escritura y lectura.

Funcionamiento
Con cada llamada la instrucci√≥n ejecuta las actividades siguientes:
‚óè Leer se√±ales de respuesta:
La instrucci√≥n ABS_CTRL_451 lee todas las se√±ales de respuesta de un canal y las
transfiere al DB de canal. Como las se√±ales de control y las peticiones s√≥lo se procesan al
final, las se√±ales de respuesta reflejan el estado del canal antes de llamar la instrucci√≥n.
‚óè Gesti√≥n de peticiones (P√°gina 6604):
La instrucci√≥n ABS_CTRL_451 procesa las peticiones de escritura y lectura y transfiere los
datos entre el DB de canal, DB de par√°metros y el m√≥dulo.
‚óè Escribir se√±ales de control:
Las se√±ales de control que se encuentran en el DB de canal se transfieren al m√≥dulo.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6587

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n ABS_CTRL_451 tiene que llamarse c√≠clicamente para cada canal, por ej. en el
OB 1.
Antes de llamar la instrucci√≥n ABS_CTRL_451, registre en el DB de canal todos los datos
necesarios para la ejecuci√≥n de las funciones deseadas.

Bloques de datos empleados
‚óè DB de canal (P√°gina 6591):
En el DB de canal es preciso que est√©n registradas la direcci√≥n del m√≥dulo y el n√∫mero de
canal. Si se introducen datos err√≥neos, es posible que se produzcan errores de acceso a
periferia o que se acceda a otro m√≥dulo, lo que provocar√≠a falsificaciones de datos.
‚óè DB de par√°metros (P√°gina 6598):
Para leer o escribir datos m√°quina mediante peticiones, se requiere un DB de par√°metros
cuyo n√∫mero tiene que estar registrado en el DB de canal.

Par√°metros
Par√°metros

Declaraci√≥n

Tipo de datos Descripci√≥n

DB_NO

INPUT

INT

N√∫mero del DB de canal

RET_VAL

OUTPUT

INT

Valor de retorno

Valores de retorno
La instrucci√≥n devuelve los siguientes valores de retorno:
RET_VAL

RB

Descripci√≥n

1

1

Por lo menos 1 petici√≥n activa

0

1

Ninguna petici√≥n activa, ning√∫n error

-1

0

Errores: se ha producido un error de datos (DATA_ERR) o
un error de comunicaci√≥n (JOB_ERR)

Se√±ales de control
Si hay una se√±al de PARADA o un error de operador o falta la habilitaci√≥n de accionamiento,
la instrucci√≥n desactiva las se√±ales de control START, DIR_M y DIR_P.
Existe la posibilidad de volver a iniciar un desplazamiento despu√©s de acusar el error de
operador con OT_ERR_A=1. Con este acuse no es posible iniciar m√°s peticiones ni se√±ales de
control.
Cuando hay pendiente un error de operador, la instrucci√≥n pone a 0 el acuse del error de
operador OT_ERR_A.
Cuando el canal notifica el inicio del desplazamiento, la instrucci√≥n desactiva las se√±ales de
inicio START, DIR_P y DIR_M, excepto con el modo de operaci√≥n "Jog".
Si no se ha parametrizado el eje, la instrucci√≥n retiene todas las se√±ales de control a excepci√≥n
del acuse de error de operador OT_ERR_A.

6588

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Peticiones y se√±ales de control
Es posible iniciar varias peticiones de forma simult√°nea, incluso con las se√±ales de control
necesarias para el posicionamiento. En el caso de que se haya emitido al menos una petici√≥n
de escritura con las se√±ales de control START, DIR_M o DIR_P, la instrucci√≥n retiene estas
se√±ales de control hasta que las peticiones de escritura se hayan procesado.

Arranque
Llame la instrucci√≥n ABS_INIT (P√°gina 6582) al arrancar el m√≥dulo o la CPU. Para ello se
resetan, entre otros, los selectores de funci√≥n. La instrucci√≥n ABS_CTRL_451 acusa el
arranque del m√≥dulo. Durante este per√≠odo, RETVAL y JOBBUSY = 1.

Comportamiento en caso de error
Si se han escrito datos err√≥neos en una petici√≥n de escritura, el canal env√≠a la respuesta
DATA_ERR = 1 en el DB de canal. Cuando se produce un error en la comunicaci√≥n con el
m√≥dulo con la petici√≥n de escritura o lectura, se guarda la causa del error en el par√°metro
JOB_ERR del DB de canal.
‚óè Error en una petici√≥n de escritura:
En el caso de una petici√≥n con errores, se desactiva el bit de inicio y se activan el bit de error
_ERR y el de finalizaci√≥n _D. En todas las peticiones de escritura pendientes, el bit de inicio
tambi√©n vuelve a su posici√≥n anterior pero s√≥lo se activa el bit de error _ERR. Se desactivan
las peticiones de escritura pendientes porque aqu√≠ es posible apilar las peticiones.
Las peticiones de lectura en cola contin√∫an siendo procesadas. Para ello se vuelve a
activar JOB_ERR para cada petici√≥n.
‚óè Error en una petici√≥n de lectura:
En el caso de una petici√≥n con errores, se desactiva el bit de inicio y se activan el bit de error
_ERR y el de finalizaci√≥n _D.
Las peticiones de lectura todav√≠a pendientes se siguen procesando. Para ello se vuelve a
activar JOB_ERR para cada petici√≥n.

ABS_DIAG_451
Descripci√≥n
La instrucci√≥n ABS_DIAG_451 lee el b√∫fer de diagn√≥stico del m√≥dulo y lo pone a disposici√≥n
de un indicador en el sistema de manejo y visualizaci√≥n (M+V) o de una evaluaci√≥n
programada.

Funcionamiento
La instrucci√≥n lee el b√∫fer de diagn√≥stico cuando en √©l se muestra una nueva entrada por
medio de la se√±al de respuesta DIAG = 1 del DB de canal. Tras leer el b√∫fer de diagn√≥stico, el
m√≥dulo pone a 0 el bit DIAG en el DB de canal.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6589

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n tiene que llamarse c√≠clicamente, por ej. en el OB 1. No se permite realizar una
llamada adicional en un OB de alarma. Para una ejecuci√≥n completa de la instrucci√≥n hacen
falta por lo menos 2 llamadas (ciclos).

Bloque de datos utilizado
DB de diagn√≥stico (P√°gina 6600):
Es necesario que en el DB de diagn√≥stico est√© registrada la direcci√≥n del m√≥dulo. La entrada
m√°s reciente del b√∫fer de diagn√≥stico se registra en la estructura DIAG[1] y la m√°s antigua en
la estructura DIAG[9].

Par√°metros
Par√°metros

Declaraci√≥n

Tipo de datos Descripci√≥n

DB_NO

INPUT

INT

N√∫mero del DB de diagn√≥stico

RET_VAL

OUTPUT

INT

Valor de retorno

Valores de retorno
La instrucci√≥n devuelve los siguientes valores de retorno en el par√°metro RET_VAL del DB de
diagn√≥stico:
RET_VAL

RB

Descripci√≥n

1

1

Petici√≥n activa

0

1

Ninguna petici√≥n activa, ning√∫n error

-1

0

Error

Peticiones
El b√∫fer de diagn√≥stico se puede leer aunque no haya ninguna nueva entrada mediante
activaci√≥n del bit de inicio DIAGRD_EN en el DB de diagn√≥stico. Tras leer el b√∫fer de
diagn√≥stico el bit de inicio se pone a 0.
Ejecute esta petici√≥n despu√©s de realizar un arranque de la CPU y del m√≥dulo. Con ello se
asegura que el contenido del DB de diagn√≥stico coincide con el contenido del b√∫fer de
diagn√≥stico del m√≥dulo, incluso cuando el m√≥dulo no haya realizado ninguna entrada nueva en
el b√∫fer de diagn√≥stico.

Arranque
La instrucci√≥n no ejecuta ning√∫n procesamiento del arranque.

Comportamiento en caso de error
Si la ejecuci√≥n fuera err√≥nea, encontrar√° la causa del error en el DB de diagn√≥stico, en el
par√°metro JOB_ERR.

6590

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Datos de diagn√≥stico
Error

Evaluar mediante OB 82

Fallo del m√≥dulo

OB82_MDL_DEFECT

Error interno

OB82_INT_FAULT

Fallo externo

OB82_EXT_FAULT

Hay un error de canal

OB82_PNT_INFO

Falta tensi√≥n auxiliar externa

OB82_EXT_VOLTAGE

Falta conector frontal

OB82_FLD_CONNCTR

Activaci√≥n de la vigilancia de tiempo

OB82_WTCH_DOG_FLT

Fallo de la fuente de alimentaci√≥n interna del m√≥dulo OB82_INT_PS_FLT
Se ha perdido una alarma de proceso

OB82_HW_INTR_FLT

Clases de error
Los errores que se producen est√°n agrupados en las siguientes clases de error:
‚óè Clase de error 1: error de operador (P√°gina 6607)
‚óè Clase de error 2: error de operador (P√°gina 6608)
‚óè Clase de error 4: error de datos (P√°gina 6609)
‚óè Clase de error 5: error de datos m√°quina (P√°gina 6610)
‚óè Clase de error 6: error de la tabla de incrementos (P√°gina 6613)
‚óè Clase de error 15: avisos (P√°gina 6613)
‚óè Clase de error 128: error de diagn√≥stico (P√°gina 6614)

M√°s referencias para FM x51 ABS V1
Bloque de datos de canal
Tarea
El DB de canal es la interfaz de datos entre el programa de usuario y el FM x51. Contiene y
aplica todos los datos necesarios para el control y el funcionamiento de un canal.

Estructura
El DB de canal se divide en diferentes √°reas:
DB de canal
Direcciones *)
Se√±ales de control
Se√±ales de respuesta
Selectores de funci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6591

Instrucciones
4.2 Instrucciones
DB de canal
Bits de disparo de peticiones de escritura
Bits de disparo de peticiones de lectura
Bits de finalizaci√≥n
Bits de error
Gesti√≥n de peticiones para instrucciones
Datos de las peticiones
*) La direcci√≥n del m√≥dulo se puede registrar en la interfaz de parametrizaci√≥n.

Contenido
La siguiente tabla muestra el contenido del DB de canal.
Nota
Los datos que no se indican en esta tabla no deben ser modificados.

Direcci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

0.0

MOD_ADDR

INT

0

Direcci√≥n del m√≥dulo

2.0

CH_NO

INT

1

N√∫mero de canal

10.0

PARADBNO

INT

-1

N√∫mero del DB de par√°metros

Direcciones

Se√±ales de control
14.3

OT_ERR_A

BOOL

FALSE

1 = Acusar error de operador

15.0

START

BOOL

FALSE

1 = Iniciar posicionamiento

15.1

STOP

BOOL

FALSE

1 = Detener desplazamiento en marcha

15.2

DIR_M

BOOL

FALSE

1 = Sentido negativo

15.3

DIR_P

BOOL

FALSE

1 = Sentido positivo

15.6

SPEED252

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451: velocidad inicial de modo incremental con
n√∫mero de incremento 252:
‚Äì

0 = Marcha lenta

‚Äì

1 = Marcha r√°pida

15.7

DRV_EN

BOOL

FALSE

1 = Conectar habilitaci√≥n del accionamiento

16.0

MODE_IN

BYTE

B#16#0

Modo de operaci√≥n solicitado
‚óè 0 = Ning√∫n modo de operaci√≥n
‚óè 1 = Jog
‚óè 3 = B√∫squeda del punto de referencia
‚óè 4 = Modo incremental relativo
‚óè 5 = Modo incremental absoluto

6592

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

17.0

MODE_TYPE

BYTE

B#16#0

‚óè Velocidad inicial para el modo Jog
‚Äì

0 = Marcha lenta

‚Äì

1 = Marcha r√°pida

‚óè N√∫mero de incremento para el modo incremental
Se√±ales de realimentaci√≥n
22.2

DIAG

BOOL

FALSE

1 = B√∫fer de diagn√≥stico modificado

22.3

OT_ERR

BOOL

FALSE

1 = Hay un error de operador

22.4

DATA_ERR

BOOL

FALSE

1 = Error de datos

22.7

PARA

BOOL

FALSE

1 = El eje est√° parametrizado

23.0

ST_ENBLD

BOOL

FALSE

1 = Inicio habilitado

23.1

WORKING

BOOL

FALSE

1 = Posicionamiento en curso

23.2

WAIT_EI

BOOL

FALSE

1 = El eje espera habilitaci√≥n externa

23.4

SPEED_OUT

BOOL

FALSE

‚óè 0 = Marcha lenta
‚óè 1 = Marcha r√°pida

23.5

ZSPEED

BOOL

FALSE

1 = El eje est√° en la zona de parada

23.6

CUTOFF

BOOL

FALSE

1 = El eje est√° en la zona de desconexi√≥n

23.7

CHGOVER

BOOL

FALSE

1 = El eje est√° en la zona de cambio de velocidad

24.0

MODE_OUT

BYTE

B#16#0

Modo de operaci√≥n activo

25.0

SYNC

BOOL

FALSE

1 = Eje sincronizado

25.1

MSR_DONE

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Medici√≥n de longitud / captura de bordes
terminada

25.2

GO_M

BOOL

FALSE

1 = El eje se desplaza en sentido negativo

25.3

GO_P

BOOL

FALSE

1 = El eje se desplaza en sentido positivo

25.5

FVAL_DONE

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Ha finalizado el ajuste del valor real al vuelo

25.7

POS_RCD

BOOL

FALSE

1 = Posici√≥n alcanzada

26.0

ACT_POS

DINT

L#0

Valor real actual (posici√≥n actual del eje)

Selectores de funci√≥n
34.0

PLOOP_ON

BOOL

FALSE

1 = Aproximaci√≥n en bucle en sentido positivo

34.1

MLOOP_ON

BOOL

FALSE

1 = Aproximaci√≥n en bucle en sentido negativo

34.2

EI_OFF

BOOL

FALSE

1 = No evaluar entrada de habilitaci√≥n

34.3

EDGE_ON

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Captura de bordes activada

34.4

MSR_ON

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Medici√≥n de longitud activada

Bits de disparo de peticiones de escritura
35.0

MDWR_EN

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

BOOL

FALSE

1 = Escribir datos m√°quina

6593

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

35.1

MD_EN

BOOL

FALSE

1 = Activar datos m√°quina

35.2

DELDIST_EN

BOOL

FALSE

1 = Borrar distancia residual

35.3

AVALREM_EN

BOOL

FALSE

1 = Cancelar preselecci√≥n del valor real

35.4

TRGL1WR_EN

BOOL

FALSE

1 = Escribir tabla de incrementos 1
(n√∫mero de incremento 1 ‚Ä¶ 50)

35.5

TRGL2WR_EN

BOOL

FALSE

1 = Escribir tabla de incrementos 2
(n√∫mero de incremento 51 ‚Ä¶ 100)

35.6

REFPT_EN

BOOL

FALSE

1 = Definir punto de referencia

35.7

AVAL_EN

BOOL

FALSE

1 = Ajustar valor real

36.0

FVAL_EN

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Ajustar valor real al vuelo

36.1

ZOFF_EN

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Activar decalaje de se√±al cero

36.2

TRG252_254_EN

BOOL

FALSE

1 = Escribir incremento del n√∫mero de incremento 252
√≥ 254

36.3

TRG255_EN

BOOL

FALSE

1 = Escribir incremento del n√∫mero de incremento 255

36.4

DELDIAG_EN

BOOL

FALSE

1 = Borrar b√∫fer de diagn√≥stico

Bits de disparo de peticiones de lectura
36.5

MDRD_EN

BOOL

FALSE

1 = Leer datos m√°quina

36.6

TRGL1RD_EN

BOOL

FALSE

1 = Leer tabla de incrementos 1
(n√∫mero de incremento 1 ‚Ä¶ 50)

36.7

TRGL2RD_EN

BOOL

FALSE

1 = Leer tabla de incrementos 2
(n√∫mero de incremento 51 ‚Ä¶ 100)

37.0

MSRRD_EN

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Leer valores medidos

37.1

ACTSPD_EN

BOOL

FALSE

1 = Leer velocidad real, distancia residual e incremento
actual

37.2

ENCVAL_EN

BOOL

FALSE

1 = Leer valores del enc√≥der

Bits de finalizaci√≥n de selectores de funci√≥n
38.0

PLOOP_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Aproximaci√≥n en bucle en
sentido positivo"

38.1

MLOOP_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Aproximaci√≥n en bucle en
sentido negativo"

38.2

EI_D

BOOL

FALSE

1 = Petici√≥n finalizada de "No evaluar entrada de ha‚Äê
bilitaci√≥n"

38.3

EDGE_D

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Petici√≥n finalizada de "Captura de bordes
activada"

6594

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

38.4

MSR_D

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Petici√≥n finalizada de "Medici√≥n de longitud
activada"

Bits de finalizaci√≥n de peticiones de escritura
39.0

MDWR_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Escribir datos m√°quina"

39.1

MD_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Activar datos m√°quina"

39.2

DELDIST_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Borrar distancia residual"

39.3

AVALREM_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Cancelar preselecci√≥n del
valor real"

39.4

TRGL1WR_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Escribir tabla de incremen‚Äê
tos 1"

39.5

TRGL2WR_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Escribir tabla de incremen‚Äê
tos 2"

39.6

REFPT_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Definir punto de referencia"

39.7

AVAL_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Ajustar valor real"

40.0

FVAL_D

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Petici√≥n finalizada de "Ajustar valor real al
vuelo"

40.1

ZOFF_D

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Petici√≥n finalizada de "Activar decalaje de se√±al
cero"

40.2

TRG252_254_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Escribir incremento del n√∫‚Äê
mero de incremento 252 √≥ 254"

40.3

TRG255_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Escribir incremento del n√∫‚Äê
mero de incremento 255"

40.4

DELDIAG_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Borrar b√∫fer de diagn√≥stico"

Bits de finalizaci√≥n de peticiones de lectura
40.5

MDRD_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Leer datos m√°quina"

40.6

TRGL1RD_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Leer tabla de incrementos 1"

40.7

TRGL2RD_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Leer tabla incrementos 2"

41.0

MSRRD_D

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Petici√≥n finalizada de "Leer valores medidos"

41.1

ACTSPD_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Leer velocidad real, trayecto
residual e incremento actual"

41.2

ENCVAL_D

BOOL

FALSE

1 = Petici√≥n finalizada de "Leer valores del enc√≥der"

Bits de error de selectores de funci√≥n
42.0

PLOOP_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Aproximaci√≥n en bucle en sen‚Äê
tido positivo"

42.1

MLOOP_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Aproximaci√≥n en bucle en sen‚Äê
tido negativo"

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6595

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

42.2

EI_ERR

BOOL

FALSE

1 = Error en la petici√≥n "No evaluar entrada de habili‚Äê
taci√≥n"

42.3

EDGE_ERR

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Error en la petici√≥n "Captura de bordes
activada"

42.4

MSR_ERR

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Error en la petici√≥n "Medici√≥n de longitud
activada"

Bits de error de peticiones de escritura
43.0

MDWR_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Escribir datos m√°quina"

43.1

MD_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Activar datos m√°quina"

43.2

DELDIST_ERR

BOOL

FALSE

1 = Error en la petici√≥n de "Borrar distancia residual"

43.3

AVALREM_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Deshacer ajuste de valor real"

43.4

TRGL1WR_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Escribir tabla de incrementos 1"

43.5

TRGL2WR_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Escribir tabla de incrementos 2"

43.6

REFPT_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Definir punto de referencia"

43.7

AVAL_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Ajustar valor real"

44.0

FVAL_ERR

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Error en la petici√≥n "Ajustar valor real al vuelo"

44.1

ZOFF_ERR

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Error en la petici√≥n "Activar decalaje de se√±al
cero"

44.2

TRG252_254_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Escribir incremento del n√∫mero
de incremento 252 √≥ 254"

44.3

TRG255_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Escribir incremento del n√∫mero
de incremento 255"

44.4

DELDIAG_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Borrar b√∫fer de diagn√≥stico"

Bits de error de peticiones de lectura
44.5

MDRD_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Leer datos m√°quina"

44.6

TRGL1RD_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Leer tabla de incrementos 1"

44.7

TRGL2RD_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Leer tabla de incrementos 2"

45.0

MSRRD_ERR

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451:
1 = Error en la petici√≥n "Leer valores medidos"

45.1

ACTSPD_ERR

BOOL

FALSE

1 = Error en la petici√≥n de "Leer velocidad real, distan‚Äê
cia residual e incremento actual"

45.2

ENCVAL_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Leer valores actuales del en‚Äê
c√≥der"

Gesti√≥n de peticiones para la instrucci√≥n ABS_CTRL o bien ABS_CTRL_451
48.0

6596

JOB_ERR

INT

0

N√∫mero del error de comunicaci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

50.0

JOBBUSY

BOOL

FALSE

1 = Por lo menos hay una petici√≥n en curso

50.1

JOBRESET

BOOL

FALSE

1 = Resetear todos los bits de error y finalizaci√≥n

Datos de la petici√≥n "Decalaje de se√±al cero" (FM 451)
80.0

ZOFF

DINT

L#0

‚óè FM 351: 0 (no utilizado)
‚óè FM 451: Decalaje de se√±al cero

Datos de la petici√≥n "Ajustar valor real"
84.0

AVAL

DINT

L#0

Coordenada de "Ajustar valor real"

Datos de la petici√≥n "Ajustar valor real al vuelo" (FM 451)
88.0

FVAL

DINT

L#0

‚óè FM 351: 0 (no utilizado)
‚óè FM 451: Coordenada de "Ajustar valor real al vuelo"

Datos de la petici√≥n "Definir punto de referencia"
92.0

REFPT

DINT

L#0

Coordenada de "Definir punto de referencia"

Datos de la petici√≥n "Escribir incremento del n√∫mero de incremento 252 √≥ 254"
96.0

TRG252_254

DINT

L#0

Incremento del n√∫mero de incremento 252 √≥ 254

Datos de la petici√≥n "Escribir incremento del n√∫mero de incremento 255"
100.0

TRG255

DINT

L#0

Incremento del n√∫mero de incremento 255

104.0

CHGDIF255

DINT

L#0

Distancia de cambio de velocidad del n√∫mero de in‚Äê
cremento 255

108.0

CUTDIF255

DINT

L#0

Distancia de desconexi√≥n del n√∫mero de incremento
255

Datos de la petici√≥n "Leer datos de posici√≥n"
112.0

ACTSPD

DINT

L#0

Velocidad actual

116.0

DIST_TO_GO

DINT

L#0

Distancia residual

120.0

ACT_TRG

DINT

L#0

Incremento actual

Datos de la petici√≥n "Leer datos de enc√≥der"
124.0

ENCVAL

DINT

L#0

Valor real del enc√≥der (representaci√≥n interna)

128.0

ZEROVAL

DINT

L#0

√öltimo valor de se√±al cero (representaci√≥n interna)

132.0

ENC_ADJ

DINT

L#0

Reajuste del enc√≥der absoluto

Datos de la petici√≥n "Medici√≥n de longitud/Captura de bordes" (FM 451)
136.0

BEG_VAL

DINT

L#0

‚óè FM 351: 0 (no utilizado)
‚óè FM 451: Valor inicial de medici√≥n de longitud /
captura de bordes

140.0

END_VAL

DINT

L#0

‚óè FM 351: 0 (no utilizado)
‚óè FM 451: Valor final de medici√≥n de longitud /
captura de bordes

144.0

LEN_VAL

DINT

L#0

‚óè FM 351: 0 (no utilizado)
‚óè FM 451: Longitud

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6597

Instrucciones
4.2 Instrucciones

Bloque de datos de par√°metros
Tarea
Si se desean modificar los datos m√°quina y las tablas de incrementos durante el
funcionamiento, se necesita el DB de par√°metros en el que est√°n guardados dichos datos. Los
par√°metros pueden ser modificados por el programa de usuario o por un sistema de manejo
y visualizaci√≥n.
Los datos que se muestran en la interfaz de parametrizaci√≥n se pueden exportar a un DB de
par√°metros. Tambi√©n es posible importar un DB de par√°metros en la interfaz de
parametrizaci√≥n y visualizarlo.
En todos los canales del m√≥dulo puede haber varios juegos de datos de parametrizaci√≥n, p. ej.
para distintas recetas, a los que se puede conmutar por medio del programa.

Estructura
DB de par√°metros
Datos m√°quina
Tablas de incrementos

Contenido
La siguiente tabla muestra el contenido del DB de par√°metros.
Nota
Los datos que no se indican en esta tabla no deben ser modificados.

Direcci√≥n

Par√°metro

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

Datos m√°quina
4.0

EDGEDIST

DINT

L#0

‚óè FM 351: 0 (no utilizado)

8.0

UNITS

DINT

L#1

Sistema de medici√≥n

12.0

AXIS_TYPE

DINT

L#0

0 = Eje lineal, 1 = Eje rotativo

16.0

ENDROTAX

DINT

L#100 000

Final del eje rotativo

20.0

ENC_TYPE

DINT

L#1

Tipo de enc√≥der, longitud de telegrama

‚óè FM 451: Distancia m√≠nima entre bordes

24.0

DISP_REV

DINT

L#80 000

Recorrido por vuelta

32.0

INC_REV

DINT

L#500

Incrementos por vuelta

36.0

NO_REV

DINT

L#1

N√∫mero de vueltas

40.0

BAUDRATE

DINT

L#0

Velocidad de transferencia

44.0

REFPT

DINT

L#0

Coordenada del punto de referencia

48.0

ENC_ADJ

DINT

L#0

Reajuste del enc√≥der absoluto

52.0

REFPT_TYPE

DINT

L#0

Tipo de b√∫squeda del punto de referencia

6598

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metro

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

59.0

CNT_DIR

BOOL

Sentido de contaje:

FALSE

‚óè 0 = normal
‚óè 1 = invertido
63.0

MON_WIRE

BOOL

TRUE

1 = Vigilancia de rotura de hilo

63.1
63.2

MON_FRAME

BOOL

TRUE

1 = Vigilancia de error de telegrama

MON_PULSE

BOOL

TRUE

1 = Vigilancia de error en se√±al

64.0

SSW_STRT

DINT

L#-100 000 000

Final de carrera de software Inicio

68.0

SSW_END

DINT

L#100 000 000

Final de carrera de software Fin

76.0

TRG_RANGE

DINT

L#1000

Zona de destino

80.0

MON_TIME

DINT

L#2000

Tiempo de vigilancia [ms]

84.0

ZSPEED_R

DINT

L#1000

Zona de parada

88.0

ZSPEED_L

DINT

L#30 000

L√≠mite superior de velocidad de parada

92.0

CTRL_TYPE

DINT

L#1

Modo de control (1 - 4)

99.0

REFPT_SPD

BOOL

TRUE

Velocidad inicial de b√∫squeda del punto de referen‚Äê
cia:
‚óè 0 = Marcha r√°pida
‚óè 1 = Marcha lenta

99.1

EI_TYPE

BOOL

FALSE

‚óè FM 351: 0 (no utilizado)
‚óè FM 451: Entrada de habilitaci√≥n:

100.0

CHGDIF_P

DINT

L#5000

‚Äì

0 = Controlada por nivel

‚Äì

1 = Controlada por flanco

Distancia de cambio de velocidad +

104.0

CHGDIF_M

DINT

L#5000

Distancia de cambio de velocidad -

108.0

CUTDIF_P

DINT

L#2000

Distancia de desconexi√≥n +

112.0

CUTDIF_M

DINT

L#2000

Distancia de desconexi√≥n -

Tabla de incrementos 1
120.0

TRGL1.TRG[1]

DINT

L#0

N√∫mero de incremento 1

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

316.0

TRGL1.TRG[50]

DINT

L#0

N√∫mero de incremento 50

Tabla de incrementos 2
320.0

TRGL2.TRG[51]

DINT

L#0

N√∫mero de incremento 51

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

516.0

TRGL2.TRG[100]

DINT

L#0

N√∫mero de incremento 100

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6599

Instrucciones
4.2 Instrucciones

Bloque de datos de diagn√≥stico
Tarea
El DB de diagn√≥stico es el archivo de datos para la instrucci√≥n ABS_DIAG (P√°gina 6585)
o ABS_DIAG_451 (P√°gina 6589). Contiene el b√∫fer de diagn√≥stico del m√≥dulo acondicionado
por esta instrucci√≥n.

Estructura
DB de diagn√≥stico
Direcci√≥n del m√≥dulo
Datos internos
Estado de la petici√≥n
Bit de inicio
B√∫fer de diagn√≥stico acondicionado

Contenido
La siguiente tabla muestra el contenido del DB de diagn√≥stico.
Nota
Los datos que no se indican en esta tabla no deben ser modificados.

Direcci√≥n

Par√°metro

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

0.0

MOD_ADDR

INT

0

Direcci√≥n del m√≥dulo

256.0

JOB_ERR

INT

0

N√∫mero del error de comunicaci√≥n

258.0

JOBBUSY

BOOL

FALSE

1 = Petici√≥n activa

258.1

DIAGRD_EN

BOOL

FALSE

1 = Leer el b√∫fer de diagn√≥stico necesariamente

260.0

DIAG_CNT

INT

0

N√∫mero de entradas v√°lidas de la lista

262.0

DIAG[1]

STRUCT

Entrada m√°s reciente de datos de diagn√≥stico

272.0

DIAG[2]

STRUCT

Segunda entrada de datos de diagn√≥stico

282.0

DIAG[3]

STRUCT

Tercera entrada de datos de diagn√≥stico

292.0

DIAG[4]

STRUCT

Cuarta entrada de datos de diagn√≥stico

302.0

DIAG[5]

STRUCT

Quinta entrada de datos de diagn√≥stico

312.0

DIAG[6]

STRUCT

Sexta entrada de datos de diagn√≥stico

322.0

DIAG[7]

STRUCT

S√©ptima entrada de datos de diagn√≥stico

332.0

DIAG[8]

STRUCT

Octava entrada de datos de diagn√≥stico

342.0

DIAG[9]

STRUCT

Novena entrada de datos de diagn√≥stico

6600

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Estructura de la entrada de diagn√≥stico
La siguiente tabla muestra la estructura de una entrada de diagn√≥stico DIAG[n].
Direcci√≥n

Par√°metro

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

+0.0

STATE

BOOL

0 = Evento saliente

FALSE

1 = Evento entrante
+0.1

INTF

BOOL

FALSE

1 = Error interno

+0.2

EXTF

BOOL

FALSE

1 = Error externo

+2.0

FCL

INT

0

Clase de error:
1: fallo operativo
2: error de operador
4: error de datos
5: error de datos m√°quina
6: error de la tabla de incrementos
15: avisos
128: error de diagn√≥stico

+4.0

FNO

INT

0

N√∫mero de error

+6.0

CH_NO

INT

0

N√∫mero de canal

+8.0

TRG_NO

INT

0

N√∫mero de incremento

Gesti√≥n de peticiones (ABS_CTRL)
Peticiones
El intercambio de datos con el m√≥dulo a partir de las se√±ales de control y de respuesta se
realiza mediante peticiones.
Para iniciar una petici√≥n active el bit de inicio correspondiente del DB de canal y, en el caso de
las peticiones de escritura, proporcione adem√°s los datos correspondientes. Llame entonces
la instrucci√≥n ABS_CTRL (P√°gina 6583) para ejecutar la petici√≥n.
Si se utiliza el FM 351 de forma centralizada, una petici√≥n de lectura precisa exactamente un
ciclo. Si se utiliza el FM 351 de forma descentralizada, una petici√≥n de lectura puede precisar
varios ciclos.
A causa de los acuses necesarios del m√≥dulo, una petici√≥n de escritura precisa por lo menos
3 llamadas o ciclos OB.
En cuanto se ha procesado por completo una petici√≥n, se desactiva el bit de inicio. Con la
siguiente llamada de la instrucci√≥n se determina y ejecuta la petici√≥n siguiente.
Adem√°s del bit de inicio con la terminaci√≥n _EN de "enable", para cada petici√≥n hay un bit de
finalizaci√≥n y otro de error. √âstos tienen en el nombre la terminaci√≥n _D de "done" o _ERR de
"error". La instrucci√≥n ABS_CTRL actualiza los bits de finalizaci√≥n y error al terminar de
procesar una petici√≥n. Dichos bits deben ponerse a 0 tras la evaluaci√≥n o antes del inicio de
una petici√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6601

Instrucciones
4.2 Instrucciones
Cuando se activa el bit JOBRESET antes del procesamiento de las peticiones pendientes, se
desactivan todos los bits de finalizaci√≥n y error. Seguidamente, el bit JOBRESET se vuelve a
poner a 0.

Selectores de funci√≥n
Los selectores de funci√≥n activan y desactivan estados del canal. Una petici√≥n de escritura de
los selectores de funci√≥n s√≥lo se ejecuta si cambia una posici√≥n del selector. La posici√≥n del
selector de funci√≥n se mantiene tras ejecutar la petici√≥n.
Los selectores de funci√≥n y las peticiones se pueden utilizar simult√°neamente en una llamada
de la instrucci√≥n ABS_CTRL.
Al igual que ocurre con las tareas, para los selectores de funci√≥n existen bits de inicio con la
terminaci√≥n _ON/_OFF, bits de finalizaci√≥n con la terminaci√≥n _D y bits de error con la
terminaci√≥n _ERR.
Para poder evaluar los bits de finalizaci√≥n y error de los selectores de funci√≥n, dichos bits
deben ponerse a 0 antes de iniciar una petici√≥n para modificar un selector de funci√≥n.

Orden de procesamiento de peticiones
Es posible lanzar simult√°neamente varias peticiones. Si no hay peticiones activas, la gesti√≥n
de peticiones de la instrucci√≥n ABS_CTRL busca a partir de la petici√≥n MDWR_EN para
comprobar si se han activado los bits de disparo o si se han realizado modificaciones en los
selectores de funci√≥n. Si se encuentra una petici√≥n, se procesa. Si la petici√≥n est√° concluida,
la gesti√≥n de peticiones busca la siguiente petici√≥n para ser procesada. Cuando se llega a la
√∫ltima petici√≥n ENCVAL_EN, se vuelve a revisar en la petici√≥n MDWR_EN. Esta b√∫squeda se
repite hasta que se procesen todas las peticiones.
Las peticiones se procesan siguiendo el siguiente orden l√≥gico seg√∫n consideraciones
tecnol√≥gicas:
Orden

Direcci√≥n en el
DB de canal

Par√°metro

Descripci√≥n

Desactivado
por

Peticiones de escritura
1

35.0

MDWR_EN

Escribir datos m√°quina

Instrucci√≥n

2

35.1

MD_EN

Activar datos m√°quina

Instrucci√≥n

35.2

DELDIST_EN

Borrar distancia residual

35.3

AVALREM_EN

Cancelar preselecci√≥n del valor real

36.4

DELDIAG_EN

Borrar b√∫fer de diagn√≥stico

3

35.4

TRGL1WR_EN

Escribir tabla de incrementos 1

Instrucci√≥n

4

35.5

TRGL2WR_EN

Escribir tabla de incrementos 2

Instrucci√≥n

5

35.6

REFPT_EN

Definir punto de referencia

Instrucci√≥n

Selectores de funci√≥n:

Programa de
Aproximaci√≥n en bucle en sentido positivo usuario

6

7

6602

34.0

PLOOP_ON

34.1

MLOOP_ON

Aproximaci√≥n en bucle en sentido negativo

34.2

EI_OFF

No evaluar entrada de habilitaci√≥n

35.7

AVAL_EN

Ajustar valor real

Instrucci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Orden

Direcci√≥n en el
DB de canal

Par√°metro

Descripci√≥n

Desactivado
por

10

36.2

TRG252_254_EN

Escribir incremento del n√∫mero de incre‚Äê
mento 254

Instrucci√≥n

11

36.3

TRG255_EN

Escribir incremento del n√∫mero de incre‚Äê
mento 255

Instrucci√≥n

Peticiones de lectura
12

36.5

MDRD_EN

Leer datos m√°quina

Instrucci√≥n

13

36.6

TRGL1RD_EN

Leer tabla de incrementos 1

Instrucci√≥n

14

36.7

TRGL2RD_EN

Leer tabla de incrementos 2

Instrucci√≥n

16

37.1

ACTSPD_EN

Leer velocidad real, distancia residual e in‚Äê Instrucci√≥n
cremento actual

17

37.2

ENCVAL_EN

Leer datos de enc√≥der

Instrucci√≥n

Esta secuencia permite lanzar por completo un posicionamiento con un juego de peticiones y
se√±ales de control. Las peticiones se extienden desde la escritura y activaci√≥n de los datos
m√°quina hasta la escritura de incrementos para los modos incrementales, pasando por el
ajuste de la entrada externa de habilitaci√≥n.

Peticiones durante un posicionamiento en curso
Las peticiones de escritura que aparecen en la tabla siguiente se retienen hasta finalizar el
posicionamiento cuando se inician durante un posicionamiento y no se ejecutan hasta la
siguiente llamada de la instrucci√≥n.
Direcci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

34.0

PLOOP_ON

BOOL

FALSE

1 = Aproximaci√≥n en bucle en sentido po‚Äê
sitivo

34.1

MLOOP_ON

BOOL

FALSE

1 = Aproximaci√≥n en bucle en sentido ne‚Äê
gativo

34.2

EI_OFF

BOOL

FALSE

1 = No evaluar entrada de habilitaci√≥n

35.1

MD_EN

BOOL

FALSE

1 = Activar datos m√°quina

35.2

DELDIST_EN

BOOL

FALSE

1 = Borrar distancia residual

35.3

AVALREM_EN

BOOL

FALSE

1 = Cancelar preselecci√≥n del valor real

35.6

REFPT_EN

BOOL

FALSE

1 = Definir coordenada del punto de refe‚Äê
rencia

35.7

AVAL_EN

BOOL

FALSE

1 = Ajustar valor real

36.4

DELDIAG_EN

BOOL

FALSE

1 = Borrar b√∫fer de diagn√≥stico

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6603

Instrucciones
4.2 Instrucciones

Estado de la petici√≥n
El estado de procesamiento de la petici√≥n se lee en el valor de retorno RETVAL y en el bit de
actividad JOBBUSY del DB de canal. El estado de una petici√≥n concreta se puede evaluar por
medio del bit de inicio, finalizaci√≥n y error de dicha petici√≥n.
RETVAL

JOBBUSY

Bit de inicio _EN

Bit de finaliza‚Äê Bit de error _ERR
ci√≥n _D

1

1

1

0

0

La petici√≥n ha fina‚Äê 0
lizado sin errores

0

0

1

0

La petici√≥n ha fina‚Äê -1
lizado con errores

0

0

1

1

Petici√≥n de escri‚Äê
tura cancelada

0

0

0

1

Petici√≥n activa

-1

Gesti√≥n de peticiones (ABS_CTRL_451)
Peticiones
El intercambio de datos con el m√≥dulo a partir de las se√±ales de control y de respuesta se
realiza mediante peticiones.
Para iniciar una petici√≥n active el bit de inicio correspondiente del DB de canal y, en el caso de
las peticiones de escritura, proporcione adem√°s los datos correspondientes. Llame entonces
la instrucci√≥n ABS_CTRL_451 (P√°gina 6587) para ejecutar la petici√≥n.
A causa de los acuses necesarios del m√≥dulo, una petici√≥n de escritura precisa por lo menos
3 llamadas o ciclos OB. Una petici√≥n de lectura se ejecuta de inmediato.
En cuanto se ha procesado por completo una petici√≥n, se desactiva el bit de inicio. Con la
siguiente llamada de la instrucci√≥n se determina y ejecuta la petici√≥n siguiente.
Adem√°s del bit de inicio con la terminaci√≥n _EN de "enable", para cada petici√≥n hay un bit de
finalizaci√≥n y otro de error. √âstos tienen en el nombre la terminaci√≥n _D de "done" o _ERR de
"error". La instrucci√≥n ABS_CTRL_451 actualiza los bits de finalizaci√≥n y error al terminar de
procesar una petici√≥n. Dichos bits deben ponerse a 0 tras la evaluaci√≥n o antes del inicio de
una petici√≥n.
Cuando se activa el bit JOBRESET antes del procesamiento de las peticiones pendientes, se
desactivan todos los bits de finalizaci√≥n y error. Seguidamente, el bit JOBRESET se vuelve a
poner a 0.

Selectores de funci√≥n
Los selectores de funci√≥n activan y desactivan estados del canal. Una petici√≥n de escritura de
los selectores de funci√≥n s√≥lo se ejecuta si hay un cambio en la posici√≥n del selector. La
posici√≥n del selector de funci√≥n se mantiene tras ejecutar la petici√≥n.
Los selectores de funci√≥n y las peticiones se pueden emplear de forma simult√°nea en una
llamada de la instrucci√≥n ABS_CTRL_451.

6604

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Al igual que ocurre con las tareas, para los selectores de funci√≥n hay bits de inicio con la
terminaci√≥n _ON/_OFF, bits de finalizaci√≥n con la terminaci√≥n _D y bits de error con la
terminaci√≥n _ERR.
Para poder evaluar los bits de finalizaci√≥n y error de los selectores de funci√≥n, dichos bits
deben ponerse a 0 antes de iniciar una petici√≥n para modificar un selector de funci√≥n.

Orden de procesamiento de peticiones
Es posible iniciar simult√°neamente varias peticiones. Cuando no hay peticiones activas, la
gesti√≥n de peticiones de la instrucci√≥n ABS_CTRL_451 busca a partir de la petici√≥n
MDWR_EN para comprobar si se han activado los bits de inicio o si se han realizado
modificaciones en los selectores de funci√≥n. Si se encuentra una petici√≥n, se procesa. Si la
petici√≥n est√° concluida, la gesti√≥n de peticiones busca la siguiente petici√≥n para ser
procesada. Cuando se llega a la √∫ltima petici√≥n ENCVAL_EN, se vuelve a revisar en la petici√≥n
MDWR_EN. Esta b√∫squeda se repite hasta que se procesen todas las peticiones.
Las peticiones se procesan siguiendo el siguiente orden l√≥gico seg√∫n consideraciones
tecnol√≥gicas:
Orden

Direcci√≥n en
Par√°metro
el DB de canal

Descripci√≥n

Desactivado
por

Peticiones de escritura
1

35.0

MDWR_EN

Escribir datos m√°quina

Instrucci√≥n

2

35.1

MD_EN

Activar datos m√°quina

Instrucci√≥n

35.2

DELDIST_EN

Borrar distancia residual

35.3

AVALREM_EN

Cancelar preselecci√≥n de valor real

36.4

DELDIAG_EN

Borrar b√∫fer de diagn√≥stico

3

35.4

TRGL1WR_EN

Escribir tabla de incrementos 1

Instrucci√≥n

4

35.5

TRGL2WR_EN

Escribir tabla de incrementos 2

Instrucci√≥n

5

35.6

REFPT_EN

Definir punto de referencia

Instrucci√≥n
Programa de
usuario

6

Selectores de funci√≥n:
34.0

PLOOP_ON

Aproximaci√≥n en bucle en sentido positivo

34.1

MLOOP_ON

Aproximaci√≥n en bucle en sentido negativo

34.2

EI_OFF

No evaluar entrada de habilitaci√≥n

34.3

EDGE_ON

Captura de bordes activada

34.4

MSR_ON

Medici√≥n de longitud activada

7

35.7

AVAL_EN

Ajustar valor real

Instrucci√≥n

8

36.0

FVAL_EN

Ajustar valor real al vuelo

Instrucci√≥n

9

36.1

ZOFF_EN

Definir decalaje de se√±al cero

Instrucci√≥n

10

36.2

TRG252_254_EN

Escribir incremento del n√∫mero de incremen‚Äê Instrucci√≥n
to 252/254

11

36.3

TRG255_EN

Escribir incremento del n√∫mero de incremen‚Äê Instrucci√≥n
to 255

Peticiones de lectura
12

36.5

MDRD_EN

Leer datos m√°quina

Instrucci√≥n

13

36.6

TRGL1RD_EN

Leer tabla de incrementos 1

Instrucci√≥n

14

36.7

TRGL2RD_EN

Leer tabla de incrementos 2

Instrucci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6605

Instrucciones
4.2 Instrucciones
Orden

Direcci√≥n en
Par√°metro
el DB de canal

Descripci√≥n

Desactivado
por

15

37.0

MSRRD_EN

Leer valores medidos

Instrucci√≥n

16

37.1

ACTSPD_EN

Leer velocidad real, distancia residual e in‚Äê
cremento actual

Instrucci√≥n

17

37.2

ENCVAL_EN

Leer datos de enc√≥der

Instrucci√≥n

Esta secuencia permite lanzar por completo un posicionamiento con un juego de peticiones y
se√±ales de control. Las peticiones se extienden desde la escritura y activaci√≥n de los datos
m√°quina hasta la escritura de incrementos para los modos incrementales, pasando por el
ajuste de la entrada externa de habilitaci√≥n.

Peticiones durante un posicionamiento en curso
Las peticiones de escritura que aparecen en la tabla siguiente se retienen hasta finalizar el
posicionamiento cuando se inician durante un posicionamiento y no se ejecutan hasta la
siguiente llamada de la instrucci√≥n.
Direcci√≥n

Par√°metro

Tipo de
datos

Valor inicial

Descripci√≥n

34.0

PLOOP_ON

BOOL

FALSE

1 = Aproximaci√≥n en bucle en sentido po‚Äê
sitivo

34.1

MLOOP_ON

BOOL

FALSE

1 = Aproximaci√≥n en bucle en sentido ne‚Äê
gativo

34.2

EI_OFF

BOOL

FALSE

1 = No evaluar entrada de habilitaci√≥n

34.3

EDGE_ON

BOOL

FALSE

1 = Captura de bordes activada

34.4

MSR_ON

BOOL

FALSE

1 = Medici√≥n de longitud activada

35.1

MD_EN

BOOL

FALSE

1 = Activar datos m√°quina

35.2

DELDIST_EN

BOOL

FALSE

1 = Borrar distancia residual

35.3

AVALREM_EN

BOOL

FALSE

1 = Cancelar preselecci√≥n de valor real

35.6

REFPT_EN

BOOL

FALSE

1 = Definir coordenada del punto de refe‚Äê
rencia

35.7

AVAL_EN

BOOL

FALSE

1 = Ajustar valor real

36.1

ZOFF_EN

BOOL

FALSE

1 = Activar decalaje de se√±al cero

36.4

DELDIAG_EN

BOOL

FALSE

1 = Borrar b√∫fer de diagn√≥stico

Estado de la petici√≥n
El estado de procesamiento de la petici√≥n se lee en el valor de retorno RET_VAL y en el bit de
actividad JOBBUSY del DB de canal. El estado de una petici√≥n concreta se puede evaluar por
medio del bit de inicio, finalizaci√≥n y error de dicha petici√≥n.
RET_VAL

JOBBUSY

Bit de inicio _EN

Bit de finaliza‚Äê Bit de error _ERR
ci√≥n _D

1

1

1

0

0

La petici√≥n ha fina‚Äê 0
lizado sin errores

0

0

1

0

Petici√≥n activa

6606

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
RET_VAL

JOBBUSY

Bit de inicio _EN

Bit de finaliza‚Äê Bit de error _ERR
ci√≥n _D

La petici√≥n ha fina‚Äê -1
lizado con errores

0

0

1

1

Petici√≥n de escri‚Äê
tura cancelada

0

0

0

1

-1

Clases de error
Clase de error 1: fallo operativo
Descripci√≥n
Los fallos operativos se detectan de forma as√≠ncrona respecto a un control. Los fallos
operativos hacen que se cancele el posicionamiento a excepci√≥n del n√∫mero de error 9. El
n√∫mero de error 9 hace que se desactive el posicionamiento.
N.¬∫

Significado

1

Rebase del final de carrera de software Inicio
Causa

2

4

5

6
7
8

9

s√≠

Se ha rebasado el destino al "Ajustar valor real al vuelo".

Rebase de la zona de destino
Causa

s√≠

No hay ninguna modificaci√≥n del valor real o hay una modificaci√≥n
en sentido contrario al te√≥rico dentro del tiempo de vigilancia.

Rebase del destino (FM 451)
Causa

10

s√≠
Cambio del valor real > ¬Ω zona de parada en sentido equivocado.

Cambio de valor inexistente o insuficiente
Causa

s√≠

El valor real se encuentra fuera de la zona de parada.

Regeneraci√≥n
Causa

s√≠

No se ha alcanzado el rango de destino dentro del tiempo de vi‚Äê
gilancia.

Salir de la zona de parada
Causa

s√≠

Se ha rebasado el l√≠mite de la zona de desplazamiento (las coor‚Äê
denadas de los l√≠mites de la zona de desplazamiento son parte de
la zona de desplazamiento).

Error en la aproximaci√≥n a destino
Causa

s√≠

Se ha rebasado el l√≠mite de la zona de desplazamiento (las coor‚Äê
denadas de los l√≠mites de la zona de desplazamiento son parte de
la zona de desplazamiento).

Rebase del fin de la zona de desplazamiento
Causa

s√≠

El valor real se encuentra fuera de la zona de trabajo.

Rebase del inicio de la zona de desplazamiento
Causa

s√≠

El valor real se encuentra fuera de la zona de trabajo.

Rebase del final de carrera de software Fin
Causa

3

Alarma de diagn√≥stico

s√≠

Se ha rebasado la zona de destino despu√©s de la aproximaci√≥n a
destino.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6607

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

11

Se ha conmutado err√≥neamente el punto de cambio de velocidad
Causa

12

El eje oscila en el punto de cambio de velocidad.
s√≠

El eje oscila en el punto de desconexi√≥n/punto de inversi√≥n.

Se ha conmutado err√≥neamente el inicio de la zona de destino
Causa

14

s√≠

Se ha conmutado err√≥neamente el punto de desconexi√≥n
Causa

13

Alarma de diagn√≥stico

s√≠

El eje oscila en la zona de destino.

Modificaci√≥n superior a la mitad del rango del eje rotativo
Causa

s√≠

Excesiva velocidad/frecuencia o hay saltos err√≥neos del valor real.

15

Modificaci√≥n superior al rango del eje rotativo

16

No se ha transmitido el incremento del n√∫mero de incremento 252 (FM 451)

Causa
Causa
17

Excesiva velocidad/frecuencia o hay saltos err√≥neos del valor real.

s√≠

La distancia entre la posici√≥n real actual y el incremento especifi‚Äê
cado es inferior a la distancia de cambio de velocidad o de des‚Äê
conexi√≥n.

Incremento err√≥neo del n√∫mero de incremento 252 (FM 451)
Causa

s√≠

No se ha transmitido el incremento.

No se puede llegar al incremento del n√∫mero de incremento 252 (FM 451)
Causa

18

s√≠

s√≠

El incremento se encuentra fuera de la zona de trabajo.

Clase de error 2: error de operador
Descripci√≥n
Los errores de operador se detectan al modificar las se√±ales de control en el √°rea de datos de
usuario. Los errores de operador provocan la desactivaci√≥n del posicionamiento.
N.¬∫

Significado

1

Modo de operaci√≥n no admisible
Causa

3

no

El modo de operaci√≥n seleccionado no es admisible.

Petici√≥n de interfaz no admisible
Causa

4

Alarma de diagn√≥stico

no

La se√±al seleccionada no es admisible con este modo de opera‚Äê
ci√≥n.

Par√°metro err√≥neo de modo de operaci√≥n
Causa

no

‚óè Con el modo de operaci√≥n "Jog", la especificaci√≥n de
velocidad difiere de la velocidad r√°pida o velocidad lenta.
‚óè Con el modo de operaci√≥n "Modo incremental", el incremento
difiere de 1 a 100 o difiere de 252, 254 y 255.

5

No hay habilitaci√≥n de inicio
Causa

7

El destino / la zona de destino est√° fuera de la zona de trabajo
Causa

6608

no

No hay habilitaci√≥n al iniciar.
no

El destino especificado o calculado est√° fuera de los finales de
carrera de software.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

8

Eje no parametrizado
Causa

9

no
Se han parametrizado datos m√°quina err√≥neos o no se han pa‚Äê
rametrizado datos para el eje.

El eje no est√° sincronizado.
Causa

10

Alarma de diagn√≥stico

El modo de operaci√≥n "Modo incremental" s√≥lo es posible con un
eje ya sincronizado.

No es posible posicionar el destino / recorrido
Causa

No es posible buscar el punto de referencia

18

No es posible el modo incremental relativo o absoluto
Causa

19

20

no

El incremento no es v√°lido.
no

La distancia de desconexi√≥n del incremento 255 es menor que la
mitad de la zona de destino.

El desplazamiento en el sentido especificado no es admisible
Causa

no

Se ha conectado un enc√≥der SSI.

La distancia de desconexi√≥n no debe ser superior a la ¬Ω de la zona de destino con el
n√∫mero de incremento 255
Causa

no

La distancia entre la posici√≥n real actual y el destino especificado
es inferior a la distancia de desconexi√≥n.

17

Causa

no

no

La distancia del final de carrera por software es insuficiente.

Clase de error 4: error de datos
Descripci√≥n
Los errores de datos se detectan de forma s√≠ncrona respecto a un control. Los errores de datos
no producen ninguna reacci√≥n de error.
N.¬∫

Significado

6

Incremento especificado excesivo
Causa

Alarma de diagn√≥stico
no

El valor est√° fuera de ¬±100 m √≥ ¬±1000 m. El recorrido / destino no debe
ser superior a la zona de desplazamiento.
Con ejes rotativos, la coordenada debe ser ‚â• 0 y menor que el fin del eje
rotativo.

10

Decalaje de se√±al cero err√≥neo
Causa

no

El decalaje de se√±al cero es mayor que ¬± 100 m o ¬± 1.000 m.
Los finales de carrera de software, tras ajustar el decalaje de se√±al cero,
se encuentran fuera de la zona de desplazamiento (-100 m...+100 m √≥
-1000 m...+1000 m).
Eje rotativo: el valor del decalaje de se√±al cero es mayor que el final del
eje rotativo.

11

Preajuste err√≥neo del valor real
Causa

no

Eje lineal: la coordenada se encuentra fuera del final de carrera de soft‚Äê
ware actual (que puede estar desplazado).
Eje rotativo: la coordenada es < 0 √≥ mayor que el final del eje rotativo.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6609

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

12

Punto de referencia err√≥neo
Causa

Alarma de diagn√≥stico
no

Eje lineal: la coordenada se encuentra fuera del final de carrera de soft‚Äê
ware actual (que puede estar desplazado).
Eje rotativo: la coordenada es < 0 √≥ mayor que el final del eje rotativo.

20

Activar datos m√°quina no admisible
Causa

27

Ajuste codificado en bits no permitido
Causa

29

Los bits no utilizados y no descritos aqu√≠ son distintos a 0.
no

Los bits no utilizados y no descritos aqu√≠ son distintos a 0.

No es posible deshacer la activaci√≥n del valor real
Causa

36

no

Codificaci√≥n en bits no v√°lida
Causa

34

no

En el m√≥dulo no hay datos m√°quina nuevos (sin errores).

no

Con un enc√≥der SSI y un eje lineal, tras la ejecuci√≥n del ajuste el valor
real de posici√≥n se encontrar√≠a fuera de la zona de trabajo.

Distancia err√≥nea de cambio de velocidad en el n√∫mero de incremento 255
Causa

no

El valor se encuentra fuera del rango num√©rico admisible de ¬± 100 m √≥
¬± 1.000 m.
Con ejes rotativos, la coordenada debe ser ‚â• 0 y menor que el fin del eje
rotativo.

37

Distancia err√≥nea de desconexi√≥n en el n√∫mero de incremento 255
Causa

no

El valor se encuentra fuera del rango num√©rico admisible de ¬± 100 m √≥
¬± 1.000 m.
La distancia de desconexi√≥n debe ser menor que la distancia de cambio
de velocidad.

107

Eje no parametrizado
Causa

108

no

No hay datos m√°quina en el eje o no se han activado.

El eje no est√° sincronizado.
Causa

no

Se ha lanzado una de las peticiones "Ajustar valor real" o "Ajustar valor
real al vuelo" a pesar de que el eje no est√° sincronizado.

Clase de error 5: error de datos m√°quina
Descripci√≥n
La alarma de diagn√≥stico s√≥lo se dispara con un bloque de datos de sistema (SDB) con
errores. Los errores de datos m√°quina no producen ninguna reacci√≥n de error.
N.¬∫

Significado

5

Error en el ajuste de la alarma de proceso
Causa

6

s√≠

Ha introducido como distancia m√≠nima entre bordes un valor < 0 √≥ > 109 Œºm.

Sistema de medida err√≥neo
Causa

6610

s√≠

Ha intentado seleccionar una alarma de proceso que el m√≥dulo no soporta.

Distancia m√≠nima entre bordes err√≥nea (FM 451)
Causa

7

Alarma de diagn√≥s‚Äê
tico

s√≠

El valor del sistema de medici√≥n se encuentra fuera del rango admisible de
1 a 4 y 6.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

8

Tipo de eje err√≥neo
Causa

9

No se ha indicado ni 0 ni 1 como tipo de eje.
s√≠

El valor del final del eje rotativo se encuentra fuera del rango admisible de 1
a 109 ¬µm o de 1 a 108 ¬µm (seg√∫n sea la resoluci√≥n).

Tipo de enc√≥der err√≥neo
Causa

11

s√≠

Final err√≥neo del eje rotativo
Causa

10

Alarma de diagn√≥s‚Äê
tico

s√≠

El valor del tipo de enc√≥der se encuentra fuera del rango admisible de 1 a 4.

Recorrido por vuelta err√≥neo
Causa

s√≠

El valor del recorrido/vuelta se encuentra fuera del rango admisible de 1 a 10
¬µm (independientemente de la resoluci√≥n).

9

13

Incrementos por vuelta err√≥neos

s√≠

14

N√∫mero de vueltas err√≥neo

s√≠

15

Velocidad de transferencia err√≥nea

s√≠

Causa
16

Para la velocidad de transferencia se ha indicado un valor fuera del rango
admisible de 0 a 3.

Coordenada del punto de referencia err√≥nea
Causa

s√≠

La coordenada se encuentra fuera del rango de -100 m a +100 m o de -1.000
m a +1.000 m, respectivamente (seg√∫n la resoluci√≥n).
Eje lineal: la coordenada se encuentra fuera de la zona de trabajo.
Eje rotativo: la coordenada es mayor que el final del eje rotativo √≥ < 0.

17

Reajuste err√≥neo del enc√≥der absoluto
Causa

18

s√≠

Ha indicado un valor fuera de los valores admisibles 0 y 1.

No es posible vigilar el hardware
Causa

s√≠

Ha indicado un valor fuera de los valores admisibles 0, 1, 2 y 3.

Sentido de contaje err√≥neo
Causa

20

Enc√≥der SSI: el valor de reajuste del enc√≥der absoluto no se encuentra den‚Äê
tro del rango del enc√≥der (incrementos por vuelta x n√∫mero de vueltas - 1).

Modo err√≥neo de b√∫squeda del punto de referencia
Causa

19

s√≠

s√≠

Ha puesto en "FALSE" la monitorizaci√≥n de errores de telegrama en el DB de
par√°metros.
No es posible vigilar los impulsos err√≥neos con el enc√≥der empleado. De‚Äê
sactive el par√°metro MON_PULSE.

21

Final err√≥neo de carrera de software Inicio
Causa

s√≠

Eje lineal: el final de carrera de software Inicio se encuentra fuera de la zona
de desplazamiento (-100 m...+100 m √≥ -1000 m...+1000 m, dependiendo de
la resoluci√≥n).
Eje lineal: El inicio del final de carrera por software (dado el caso, incluido un
decalaje de se√±al cero presente) es menor que -100 m √≥ -1000 m (seg√∫n la
resoluci√≥n).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6611

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

22

Final err√≥neo de carrera de software Fin
Causa

Alarma de diagn√≥s‚Äê
tico
s√≠

Eje lineal: el final de carrera de software Fin se encuentra fuera de la zona de
desplazamiento (-100 m...+100 m √≥ -1000 m...+1000 m, dependiendo de la
resoluci√≥n) o es menor que el final de carrera de software Inicio.
Eje lineal: el final de carrera de software Fin (dado el caso, incluido un deca‚Äê
laje de se√±al cero presente) es mayor que +100 m √≥ +1000 m (seg√∫n la
resoluci√≥n).

23

Velocidad m√°xima err√≥nea
Causa

24

s√≠

Los datos que no aparecen en la lista en el DB de par√°metros tienen que ser
0.

Zona de destino err√≥nea
Causa

s√≠

Eje lineal: rango de 0 a 100 m √≥ 1000 m, seg√∫n la resoluci√≥n.
Eje rotativo: rango superior al final del eje rotativo.

25

Tiempo de vigilancia err√≥neo
Causa

26

s√≠

El valor del tiempo de vigilancia se encuentra fuera del rango admisible de 0
a 100 000 ms.

Zona de parada err√≥nea
Causa

s√≠

Eje lineal: rango de 0 a 100 m √≥ 1000 m, seg√∫n la resoluci√≥n.
Eje rotativo: rango superior al final del eje rotativo.

127

Velocidad de parada err√≥nea
Causa

128

s√≠

Para el modo de control se ha indicado un valor fuera del rango admisible de
1 a 4.

Velocidad inicial err√≥nea para la b√∫squeda del punto de referencia
Causa

130

El valor de la velocidad de parada se encuentra fuera del rango admisible de
0 a 100 000 Œºm/min.

Modo de control err√≥neo
Causa

129

s√≠

s√≠

No se ha indicado no 0 ni 1 como velocidad inicial.

Distancia err√≥nea de cambio de velocidad en sentido +
Causa

s√≠

Eje lineal: rango de 0 a 100 m √≥ 1000 m (seg√∫n la resoluci√≥n).
Eje rotativo: rango superior al final del eje rotativo y menor que ¬Ω zona de
destino.

131

Distancia err√≥nea de cambio de velocidad en sentido ‚Äì
Causa

s√≠

Eje lineal: rango de 0 a 100 m √≥ 1000 m (seg√∫n la resoluci√≥n).
Eje rotativo: rango superior al final del eje rotativo y menor que ¬Ω zona de
destino.

132

Distancia err√≥nea de desconexi√≥n en sentido +
Causa

133

Distancia err√≥nea de desconexi√≥n en sentido ‚Äì
Causa

6612

s√≠

La distancia de desconexi√≥n es superior a la distancia de cambio de veloci‚Äê
dad +, inferior a la mitad de la zona de destino o est√° fuera del rango permitido
de 0 a 100 m √≥ 1.000 m (seg√∫n la resoluci√≥n).
s√≠

La distancia de desconexi√≥n es superior a la distancia de cambio de veloci‚Äê
dad ‚Äì, inferior a la mitad de la zona de destino o est√° fuera del rango permitido
de 0 a 100 m √≥ 1.000 m (seg√∫n la resoluci√≥n).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

Alarma de diagn√≥s‚Äê
tico

200

Resoluci√≥n err√≥nea
Causa

s√≠

Ha indicado una resoluci√≥n < 0,1 ¬µm/impulso o >1000 ¬µm/impulso.
Ha indicado un recorrido/vuelta y un n√∫mero de impulsos/vuelta que dan una
resoluci√≥n < 0,1 o > 1000.

201

El enc√≥der no se adapta a la zona de trabajo / rango del eje rotativo
Causa

s√≠

Enc√≥der SSI y eje rotativo: el enc√≥der no cubre exactamente el rango del eje
rotativo.
Eje lineal: el enc√≥der no cubre por lo menos la zona de trabajo (finales de
carrera de software incluidos).

Clase de error 6: error de la tabla de incrementos
Descripci√≥n
Los errores de la tabla de incrementos no producen ninguna reacci√≥n de error.
N.¬∫

Significado

6

Excesivo incremento especificado en la tabla de incrementos
Causa

Alarma de diagn√≥s‚Äê
tico
no

El valor se encuentra fuera de ¬± 100 m √≥ ¬± 1.000 m.
El recorrido / destino no debe ser superior a la zona de desplazamiento.
Con ejes rotativos, la coordenada debe ser ‚â• 0 y menor que el fin del eje
rotativo.

Clase de error 15: avisos
Descripci√≥n
Los avisos no producen ninguna reacci√≥n de error.
N.¬∫
1

Significado
Inicio de parametrizaci√≥n
Causa

2

12

no

No se pueden mantener los tiempos de reacci√≥n del hardware porque la
distancia entre los puntos de conmutaci√≥n es insuficiente.

Distancia del punto de inversi√≥n insuficiente
Causa

no

El m√≥dulo ha procesado sin problemas la parametrizaci√≥n mediante un
bloque de datos de sistema.

Distancia insuficiente del punto de cambio de velocidad
Causa

no

El m√≥dulo ha detectado una parametrizaci√≥n por medio de un bloque de
datos de sistema.

Final de la parametrizaci√≥n
Causa

11

Alarma de diagn√≥stico

no

No se pueden mantener los tiempos de reacci√≥n del hardware porque la
distancia entre los puntos de conmutaci√≥n es insuficiente.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6613

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

14

Distancia insuficiente del punto de desconexi√≥n
Causa

15

Alarma de diagn√≥stico
no

No se pueden mantener los tiempos de reacci√≥n del hardware porque la
distancia entre los puntos de conmutaci√≥n es insuficiente.

Distancia insuficiente del inicio de la zona de destino
Causa

no

No se pueden mantener los tiempos de reacci√≥n del hardware porque la
distancia entre los puntos de conmutaci√≥n es insuficiente.

Clase de error 128: error de diagn√≥stico
N.¬∫

Significado

4

Falta tensi√≥n auxiliar externa
Causa

Alarma de diag‚Äê
n√≥stico
s√≠

‚óè La tensi√≥n auxiliar externa de 24 V no se ha conectado o ha fallado
‚óè El fusible del m√≥dulo est√° defectuoso
‚óè Subtensi√≥n
‚óè Rotura de hilo en masa
‚óè Cortocircuito (p. ej. en el enc√≥der conectado)

Efectos

‚óè Se cancela el posicionamiento en todos los canales
‚óè Desactivaci√≥n de las salidas
‚óè Borrado de la sincronizaci√≥n en los enc√≥ders incrementales cuando falle la
tensi√≥n auxiliar de alimentaci√≥n del enc√≥der
‚óè Los par√°metros no han sido asignados al m√≥dulo.
‚óè Borrado de la habilitaci√≥n de inicio

Soluci√≥n
5

Comprobar que la conexi√≥n de 24 V sea correcta (si la conexi√≥n de 24 V es
correcta, significa que el m√≥dulo est√° averiado)

Falta conector frontal (FM 451)

s√≠

Causa

No se ha insertado el conector frontal del m√≥dulo de posicionamiento.

Efectos

‚óè Falta tensi√≥n auxiliar externa de 24 V
‚óè El m√≥dulo no est√° operativo

Soluci√≥n
51

Enchufar el conector frontal en el m√≥dulo de posicionamiento

Ha saltado la vigilancia de tiempo (watchdog)
Causa

s√≠

‚óè Interferencias fuertes en el m√≥dulo
‚óè Error en el m√≥dulo

Efectos

‚óè El m√≥dulo se resetea
‚óè Desconexi√≥n de todas las salidas
‚óè Siempre que tras el reseteado del m√≥dulo no se detecte ning√∫n defecto en el
m√≥dulo, √©ste vuelve a estar operativo
‚óè El m√≥dulo notifica que ha transcurrido la vigilancia del tiempo con "entrante"
y "saliente"

Soluci√≥n

‚óè Eliminar las interferencias
‚óè Consulte al departamento comercial correspondiente cuando las
circunstancias exactas que han dado lugar al error sean de mayor entidad.
‚óè Sustituir el m√≥dulo

6614

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

144

Rotura de hilo en el enc√≥der
Causa

Alarma de diag‚Äê
n√≥stico
s√≠

‚óè El cable del enc√≥der no est√° enchufado o est√° cortado
‚óè Enc√≥der sin se√±ales de cuadratura
‚óè Asignaci√≥n de pines incorrecta
‚óè Longitud de cable excesiva
‚óè Cortocircuito de las se√±ales del enc√≥der
‚óè Error de flanco de las se√±ales del enc√≥der
‚óè Se ha sobrepasado la frecuencia m√°xima de la entrada del enc√≥der
‚óè Corte de la alimentaci√≥n del enc√≥der

Efectos

‚óè Se interrumpe el posicionamiento
‚óè Desconexi√≥n de todas las salidas
‚óè Borrado de la sincronizaci√≥n, con enc√≥ders incrementales
‚óè Borrado de la habilitaci√≥n de inicio

Soluci√≥n

‚óè Comprobar el cable del enc√≥der
‚óè Guardar la especificaci√≥n del enc√≥der
‚óè La vigilancia puede desactivarse de forma provisional con la interfaz de
parametrizaci√≥n bajo la responsabilidad del operador.
‚óè Guardar los datos t√©cnicos del m√≥dulo

145

Error de telegrama del enc√≥der absoluto
Causa

s√≠

El tr√°fico de telegramas entre el m√≥dulo y el enc√≥der absoluto (SSI) tiene errores
o est√° interrumpido:
‚óè El cable del enc√≥der no est√° enchufado o est√° cortado
‚óè Tipo de enc√≥der err√≥neo
‚óè Enc√≥der mal configurado (enc√≥ders programables)
‚óè Longitud de telegrama mal indicada
‚óè El enc√≥der proporciona valores err√≥neos (enc√≥der defectuoso)
‚óè Interferencia en el cable del sistema de medici√≥n
‚óè Velocidad de transferencia escogida demasiado alta
‚óè Tiempo monoestable del enc√≥der superior a 64 Œºs

Efectos

‚óè Se interrumpe el posicionamiento
‚óè Desactivaci√≥n de las salidas
‚óè Borrado de la habilitaci√≥n de inicio

Soluci√≥n

‚óè Comprobar el cable del enc√≥der
‚óè Comprobar el enc√≥der
‚óè Comprobar el tr√°fico de telegramas entre el enc√≥der y el m√≥dulo

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6615

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

146

Impulsos err√≥neos del enc√≥der incremental
Causa

Alarma de diag‚Äê
n√≥stico
s√≠

‚óè La vigilancia del enc√≥der ha detectado impulsos err√≥neos
‚óè El n√∫mero de incrementos por vuelta est√° mal introducido
‚óè Enc√≥der averiado: no proporciona el n√∫mero de impulsos indicado
‚óè se√±al cero err√≥nea o inexistente
‚óè Interferencias en el cable del enc√≥der

Efectos

‚óè Se interrumpe el posicionamiento
‚óè Desactivaci√≥n de las salidas
‚óè Borrado de la habilitaci√≥n de inicio

Soluci√≥n

‚óè Introducir correctamente el n√∫mero de incrementos/vuelta (cuadro de di√°logo
de parametrizaci√≥n)
‚óè Comprobar el enc√≥der y su cable
‚óè Cumplir las normas de apantallamiento y de conexi√≥n a tierra
‚óè La vigilancia puede desactivarse de forma provisional con la interfaz de
parametrizaci√≥n bajo la responsabilidad del operador.

Control por levas FM x52
CAM_INIT
Descripci√≥n
La instrucci√≥n CAM_INIT inicializa los datos siguientes en el DB de canal:
‚óè Las se√±ales de control
‚óè Las se√±ales de respuesta
‚óè Los bits de inicio, los bits de finalizaci√≥n y los bits de error de las tareas
‚óè Los selectores de funci√≥n y sus bits de finalizaci√≥n y de error
‚óè La gesti√≥n de peticiones y el b√∫fer interno de la instrucci√≥n CAM_CTRL (P√°gina 6617)
o CAM_CTRL_452 (P√°gina 6620)
‚óè La gesti√≥n de peticiones y el b√∫fer interno de la instrucci√≥n CAM_MSRM_452
(P√°gina 6624) (s√≥lo FM 452)

Llamada
La instrucci√≥n tiene que ejecutarse tras un arranque, es decir, despu√©s de conectar la fuente
de alimentaci√≥n del m√≥dulo o de la CPU. Por ello ins√©rtela, por ejemplo, en el OB de
rearranque OB 100 y en el OB de extracci√≥n/inserci√≥n OB 83, o bien ll√°mela en la fase de
inicializaci√≥n del programa de usuario. Antes es preciso escribir en el OB 100 la direcci√≥n del
m√≥dulo en el DB. De este modo queda asegurado que tras un rearranque completo de la CPU
o un arranque del m√≥dulo su programa de usuario no acceder√° a datos antiguos.

6616

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros
Par√°metro

Declaraci√≥n

Tipo de datos Descripci√≥n

DB_NO

INPUT

INT

N√∫mero del DB de canal

Valores de retorno
La instrucci√≥n no proporciona ning√∫n valor de retorno.

CAM_CTRL
Descripci√≥n
La instrucci√≥n CAM_CTRL permite leer datos operativos procedentes del m√≥dulo, inicializar el
m√≥dulo y controlar su funcionamiento. Para ello se utilizan se√±ales de control, se√±ales de
respuesta, selectores de funci√≥n y peticiones de escritura y lectura.

Funcionamiento
Con cada llamada la instrucci√≥n ejecuta las actividades siguientes:
‚óè Leer se√±ales de respuesta:
La instrucci√≥n CAM_CTRL lee todas las se√±ales de respuesta del m√≥dulo y las transfiere
al DB de canal. Como las se√±ales de control y las peticiones solo se procesan al final, las
se√±ales de respuesta reflejan el estado del m√≥dulo antes de llamar la instrucci√≥n.
‚óè Escribir se√±ales de control:
Las se√±ales de control que se encuentran en el DB de canal se transfieren al m√≥dulo. La
habilitaci√≥n del procesamiento de levas, sin embargo, se retiene hasta que se ha activado
el inicio de una petici√≥n "Definir punto de referencia" o "Escribir datos de leva". La
(re-)activaci√≥n del procesamiento de levas se mantiene retenida durante este intervalo de
tiempo.
‚óè Gesti√≥n de peticiones (P√°gina 6636):
La petici√≥n siguiente en cada caso se ejecuta a partir de los bits de disparo de petici√≥n
registrados en el DB de canal.

Llamada
La instrucci√≥n tiene que llamarse c√≠clicamente.
Antes de llamar la instrucci√≥n, registre en el DB de canal todos los datos necesarios para la
ejecuci√≥n de las funciones deseadas.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6617

Instrucciones
4.2 Instrucciones

Bloques de datos empleados
‚óè DB de canal (P√°gina 6625):
El DB de canal es el DB instancia de la instrucci√≥n CAM_CTRL. En el DB de canal es
preciso que est√© registrada la direcci√≥n del m√≥dulo. .
‚óè DB de par√°metros (P√°gina 6632):
Para leer o escribir datos m√°quina o datos de leva mediante peticiones se requiere un DB
de par√°metros cuyo n√∫mero tiene que estar registrado en el DB de canal. El tama√±o del DB
de par√°metros tiene que ser suficiente para el n√∫mero de levas existente.

Valores de retorno
La instrucci√≥n proporciona los siguientes valores de retorno en el par√°metro RETVAL del DB
de canal:
RETVAL

RB

Descripci√≥n

1

1

Por lo menos 1 petici√≥n activa

0

1

Ninguna petici√≥n activa, ning√∫n error

-1

0

Errores:
Error de datos (DAT_ERR) o
Error de comunicaci√≥n (JOB_ERR)

Arranque
Llame la instrucci√≥n CAM_INIT (P√°gina 6616) al arrancar el m√≥dulo o la CPU. Para ello se
resetean, entre otros, los selectores de funci√≥n.
La instrucci√≥n CAM_CTRL acusa el arranque del m√≥dulo. Durante este per√≠odo, RETVAL y
JOBBUSY = 1.

Comportamiento en caso de error
Si en una petici√≥n de escritura se han escrito datos err√≥neos, el m√≥dulo devuelve la respuesta
DATA_ERR = 1. Cuando en una petici√≥n de escritura o de lectura se produce un error en la
comunicaci√≥n con el m√≥dulo, la causa del error se deposita en el par√°metro JOB_ERR del DB
de canal.
‚óè Error en una petici√≥n de escritura:
En el caso de una petici√≥n con errores, se desactiva el bit de inicio y se activan el bit de error
_ERR y el de finalizaci√≥n _D. En todas las peticiones de escritura en cola, el bit de inicio
vuelve tambi√©n a su posici√≥n anterior y se activa el bit de error _ERR.
Las peticiones de lectura pendientes se siguen procesando. Para ello se vuelve a activar
JOB_ERR para cada petici√≥n.
‚óè Error en una petici√≥n de lectura:
En el caso de una petici√≥n con errores, se desactiva el bit de inicio y se activan el bit de error
_ERR y el de finalizaci√≥n _D.
Las peticiones de lectura todav√≠a pendientes se siguen procesando. Para ello se vuelve a
activar JOB_ERR para cada petici√≥n.

6618

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

CAM_DIAG
Descripci√≥n
La instrucci√≥n CAM_DIAG lee el b√∫fer de diagn√≥stico del m√≥dulo y lo pone a disposici√≥n de un
indicador en el sistema de manejo y visualizaci√≥n (M+V) o de una evaluaci√≥n programada.

Funcionamiento
La instrucci√≥n lee el b√∫fer de diagn√≥stico cuando en √©l se muestra una nueva entrada por
medio de la se√±al de respuesta DIAG = 1. Tras leer el b√∫fer de diagn√≥stico el m√≥dulo pone
DIAG a 0.

Llamada
La instrucci√≥n tiene que llamarse c√≠clicamente. No se permite realizar una llamada adicional en
un programa de interrupci√≥n controlado por eventos. Para una ejecuci√≥n completa de la
instrucci√≥n hacen falta por lo menos 2 llamadas (ciclos).

Bloque de datos empleado
DB de diagn√≥stico (P√°gina 6635):
El DB de diagn√≥stico es el DB instancia de la instrucci√≥n CAM_DIAG. Es necesario que en el
DB de diagn√≥stico est√© registrada la direcci√≥n del m√≥dulo. Deber√≠a efectuarse la entrada en el
OB de arranque (OB 100) o bien antes de emplearse por primera vez. La entrada m√°s reciente
del b√∫fer de diagn√≥stico se registra en la estructura DIAG[1] y la m√°s antigua en la estructura
DIAG[4].

Valores de retorno
La instrucci√≥n proporciona los siguientes valores de retorno en el par√°metro RETVAL del DB
de diagn√≥stico:
RETVAL
1

RB
1

Descripci√≥n
Petici√≥n activa

0

1

Ninguna petici√≥n activa, ning√∫n error

-1

0

Error

Peticiones
El b√∫fer de diagn√≥stico se puede leer aunque no haya ninguna entrada nueva activando el bit
de inicio DIAGRD_EN. Tras leer el b√∫fer de diagn√≥stico el bit de inicio se pone a 0.

Arranque
La instrucci√≥n no ejecuta ning√∫n procesamiento del arranque.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6619

Instrucciones
4.2 Instrucciones

Comportamiento en caso de error
En caso de una petici√≥n err√≥nea, encontrar√° la causa del error en el DB de diagn√≥stico, en el
par√°metro JOB_ERR.

Clases de error
Los errores que se producen est√°n agrupados en las siguientes clases de error:
‚óè Clase de error 1: fallo operativo (P√°gina 6639)
‚óè Clase de error 4: error de datos (P√°gina 6640)
‚óè Clase de error 5: error de datos m√°quina (P√°gina 6641)
‚óè Clase de error 7: error de datos de leva (P√°gina 6643)
‚óè Clase de error 15: avisos (P√°gina 6644)
‚óè Clase de error 128: error de diagn√≥stico (P√°gina 6645)

CAM_CTRL_452
Descripci√≥n
La instrucci√≥n CAM_CTRL_452 permite leer datos operativos procedentes del m√≥dulo,
inicializar el m√≥dulo y controlar su funcionamiento. Para ello se utilizan se√±ales de control,
se√±ales de respuesta, selectores de funci√≥n y peticiones de escritura y lectura.

Funcionamiento
Con cada llamada la instrucci√≥n ejecuta las actividades siguientes:
‚óè Leer se√±ales de respuesta:
La instrucci√≥n CAM_CTRL_452 lee todas las se√±ales de respuesta del m√≥dulo y las
transfiere al DB de canal. Como las se√±ales de control y las peticiones s√≥lo se procesan al
final, las se√±ales de respuesta reflejan el estado del m√≥dulo antes de llamar la instrucci√≥n.
‚óè Escribir se√±ales de control:
Las se√±ales de control que se encuentran en el DB de canal se transfieren al m√≥dulo. La
habilitaci√≥n del procesamiento de levas, sin embargo, se retiene hasta que se ha activado
el inicio de una petici√≥n "Definir punto de referencia" o "Escribir datos de leva". La
(re-)activaci√≥n del procesamiento de levas se mantiene retenida durante este intervalo de
tiempo.
‚óè Gesti√≥n de peticiones (P√°gina 6638):
La petici√≥n siguiente en cada caso se ejecuta a partir de los bits de disparo de petici√≥n
registrados en el DB de canal.

Llamada
La instrucci√≥n tiene que llamarse c√≠clicamente.
Antes de llamar la instrucci√≥n, registre en el DB de canal todos los datos necesarios para la
ejecuci√≥n de las funciones deseadas.

6620

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Bloques de datos empleados
‚óè DB de canal (P√°gina 6625):
En el DB de canal es preciso que est√© registrada la direcci√≥n del m√≥dulo.
‚óè DB de par√°metros (P√°gina 6632):
Para leer o escribir datos m√°quina o datos de leva mediante peticiones se requiere un DB
de par√°metros cuyo n√∫mero tiene que estar registrado en el DB de canal. El tama√±o del DB
de par√°metros tiene que ser suficiente para el n√∫mero de levas existente.

Par√°metros
Par√°metros

Declaraci√≥n

Tipo de datos Descripci√≥n

DB_NO

INPUT

INT

N√∫mero del DB de canal

RET_VAL

OUTPUT

INT

Valor de retorno

Valores de retorno
La instrucci√≥n proporciona los siguientes valores de retorno en el par√°metro RET_VAL del DB
de canal:
RET_VAL

RB

Descripci√≥n

1

1

Por lo menos 1 petici√≥n activa

0

1

Ninguna petici√≥n activa, ning√∫n error

-1

0

Errores:
Error de datos (DAT_ERR) o
Error de comunicaci√≥n (JOB_ERR)

Arranque
Llame la instrucci√≥n CAM_INIT (P√°gina 6616) al arrancar el m√≥dulo o la CPU. Para ello se
inicializan, entre otros, los selectores de funci√≥n.
La instrucci√≥n CAM_CTRL_452 acusa el arranque del m√≥dulo. Durante este per√≠odo,
RET_VAL y JOBBUSY = 1.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6621

Instrucciones
4.2 Instrucciones

Comportamiento en caso de error
Si en una petici√≥n de escritura se han escrito datos err√≥neos, el m√≥dulo devuelve la respuesta
DATA_ERR = 1. Cuando en una petici√≥n de escritura o de lectura se produce un error en la
comunicaci√≥n con el m√≥dulo, la causa del error se deposita en el par√°metro JOB_ERR del DB
de canal.
‚óè Error en una petici√≥n de escritura:
En el caso de una petici√≥n con errores, se desactiva el bit de inicio y se activan el bit de error
_ERR y el de finalizaci√≥n _D. En todas las peticiones de escritura en cola, el bit de inicio
vuelve tambi√©n a su posici√≥n anterior y se activa el bit de error _ERR.
Las peticiones de lectura en cola contin√∫an siendo procesadas. Para ello se vuelve a
activar JOB_ERR para cada petici√≥n.
‚óè Error en una petici√≥n de lectura:
En el caso de una petici√≥n con errores, se desactiva el bit de inicio y se activan el bit de error
_ERR y el de finalizaci√≥n _D.
Las peticiones de lectura todav√≠a pendientes se siguen procesando. Para ello se vuelve a
activar JOB_ERR para cada petici√≥n.

CAM_DIAG_452
Descripci√≥n
La instrucci√≥n CAM_DIAG_452 lee el b√∫fer de diagn√≥stico del m√≥dulo y lo pone a disposici√≥n
de un indicador en el sistema de manejo y visualizaci√≥n (M+V) o de una evaluaci√≥n
programada.

Funcionamiento
La instrucci√≥n lee el b√∫fer de diagn√≥stico cuando en √©l se muestra una nueva entrada por
medio de la se√±al de respuesta DIAG = 1. Tras leer el b√∫fer de diagn√≥stico el m√≥dulo pone
DIAG a 0.

Llamada
La instrucci√≥n tiene que llamarse c√≠clicamente. No se admite una llamada adicional en un OB
de alarma. Para una ejecuci√≥n completa de la instrucci√≥n hacen falta por lo menos 2 llamadas
(ciclos).

Bloque de datos empleado
DB de diagn√≥stico (P√°gina 6635):
Es necesario que en el DB de diagn√≥stico est√© registrada la direcci√≥n del m√≥dulo. La entrada
m√°s reciente del b√∫fer de diagn√≥stico se registra en la estructura DIAG[1] y la m√°s antigua en
la estructura DIAG[4].

6622

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros
Par√°metros

Declaraci√≥n

Tipo de datos Descripci√≥n

DB_NO

INPUT

INT

N√∫mero del DB de diagn√≥stico

RET_VAL

OUTPUT

INT

Valor de retorno

Valores de retorno
La instrucci√≥n proporciona los siguientes valores de retorno en el par√°metro RET_VAL del DB
de diagn√≥stico:
RET_VAL

RB

Descripci√≥n

1

1

Petici√≥n activa

0

1

Ninguna petici√≥n activa, ning√∫n error

-1

0

Error

Peticiones
El b√∫fer de diagn√≥stico se puede leer aunque no haya ninguna entrada nueva activando el bit
de inicio DIAGRD_EN. Tras leer el b√∫fer de diagn√≥stico el bit de inicio se pone a 0.

Arranque
La instrucci√≥n no ejecuta ning√∫n procesamiento del arranque.

Comportamiento en caso de error
En caso de una petici√≥n err√≥nea, encontrar√° la causa del error en el DB de diagn√≥stico, en el
par√°metro JOB_ERR.

Clases de error
Los errores que se producen est√°n agrupados en las siguientes clases de error:
‚óè Clase de error 1: error de operador (P√°gina 6639)
‚óè Clase de error 4: error de datos (P√°gina 6640)
‚óè Clase de error 5: error de datos m√°quina (P√°gina 6641)
‚óè Clase de error 7: error de datos de leva (P√°gina 6643)
‚óè Clase de error 15: avisos (P√°gina 6644)
‚óè Clase de error 128: error de diagn√≥stico (P√°gina 6645)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6623

Instrucciones
4.2 Instrucciones

CAM_MSRM_452
Descripci√≥n
La instrucci√≥n CAM_MSRM_452 se utiliza para evaluar inmediatamente datos de una
medici√≥n de longitud o de una captura de bordes de un FM 452 en el OB de alarma de proceso.

Llamada
La instrucci√≥n se llama en un OB de alarma de proceso (p. ej. OB 40).

Bloque de datos empleado
DB de canal (P√°gina 6625):
En el DB de canal es preciso que est√© registrada la direcci√≥n del m√≥dulo. La entrada debe
realizarse en el OB de arranque (OB 100).

Par√°metros
Par√°metro

Declaraci√≥n

Tipo de datos Descripci√≥n

DB_NO

INPUT

INT

N√∫mero del DB de canal

RET_VAL

OUTPUT

INT

Valor de retorno

Valores de retorno
La instrucci√≥n proporciona los siguientes valores de retorno en el par√°metro RET_VAL del DB
de canal:
RET_VAL

RB

Descripci√≥n

1

1

Petici√≥n activa

0

1

Ninguna petici√≥n activa, ning√∫n error

-1

0

Error

Resultados de medici√≥n e informaci√≥n de estado
Los resultados de medici√≥n y la informaci√≥n de estado se encuentran en el DB de canal:
Direc‚Äê
ci√≥n

6624

Nombre

Tipo

Valor ini‚Äê
cial

Comentario

112.0

BEG_VAL

DINT

L#0

Valor inicial

116.0

END_VAL

DINT

L#0

Valor final

120.0

LEN_VAL

DINT

L#0

Longitud

56.0

JOB_ERR_M

INT

0

Error de comunicaci√≥n

58.0

JOBBUSY_M

BOOL

FALSE

Petici√≥n activa

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Arranque
La instrucci√≥n no ejecuta ning√∫n procesamiento del arranque.

Comportamiento en caso de error
En caso de una petici√≥n err√≥nea, encontrar√° la causa del error en el DB de canal, en el
par√°metro JOB_ERR_M.

M√°s referencias para FM x52 CAM V2
Bloque de datos de canal
Tarea
El DB de canal es la interfaz de datos entre el programa de usuario y el secuenciador
electr√≥nico de levas FM x52. Contiene y aplica todos los datos necesarios para el control y el
funcionamiento del m√≥dulo.

Estructura
El DB de canal se divide en diferentes √°reas:
DB de canal
Direcciones* /Conmutador de versi√≥n
Se√±ales de control
Se√±ales de respuesta
Selectores de funci√≥n
Bits de inicio para peticiones de escritura
Bits de inicio para peticiones de lectura
Bits de finalizaci√≥n
Bits de error
Gesti√≥n de peticiones para instrucciones
Datos de las peticiones
* La direcci√≥n del m√≥dulo se puede registrar en la interfaz de parametrizaci√≥n.

Contenido
La siguiente tabla muestra el contenido del DB de canal.
Nota
Los datos que no se indican en esta tabla no deben ser modificados.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6625

Instrucciones
4.2 Instrucciones

Direcci√≥n

Par√°metros

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

MOD_ADDR
(¬°Registrar!)

INT

0

Direcci√≥n del m√≥dulo

2.0

CH_NO

INT

1

N√∫mero de canal (siempre 1)

10.0

PARADBNO

INT

-1

N√∫mero del DB de par√°metros
-1 = DB no existente

12.0

FM_TYPE

BOOL

FALSE

0 = FM 352 hasta V4.0
1 = FM 452 o FM 352 a partir de V5.0

Direcciones / Conmutador de versi√≥n
0.0

Se√±ales de control
15.2

DIR_M

BOOL

FALSE

1 = Simulaci√≥n en el sentido negativo

15.3

DIR_P

BOOL

FALSE

1 = Simulaci√≥n en el sentido positivo

15.4

CAM_EN

BOOL

FALSE

1 = Habilitar el procesamiento de levas

15.5

CNTC0_EN

BOOL

FALSE

1 = Habilitar la funci√≥n de contaje de la pista de
leva de contaje 0

15.6

CNTC1_EN

BOOL

FLASE

1 = Habilitar la funci√≥n de contaje de la pista de
leva de contaje 1

16.0

TRACK_EN

WORD

W#16#0

Habilitar pistas de leva de 0 a 15
Bit 0 = Pista 0

Se√±ales de respuesta
22.2

DIAG

BOOL

FALSE

1 = B√∫fer de diagn√≥stico modificado

22.4

DATA_ERR

BOOL

FALSE

1 = Error de datos

22.7

PARA

BOOL

FALSE

1 = M√≥dulo parametrizado

23.4

CAM_ACT

BOOL

FALSE

1 = Procesamiento de levas activo

25.0

SYNC

BOOL

FALSE

1 = Eje sincronizado

25.1

MSR_DONE

BOOL

FALSE

1 = Medici√≥n de longitud o captura de bordes
finalizada

25.2

GO_M

BOOL

FALSE

1 = Eje en sentido negativo

25.3

GO_P

BOOL

FALSE

1 = Eje en sentido positivo

25.4

HYS

BOOL

FALSE

1 = El eje se encuentra dentro del rango de
hist√©resis

25.5

FVAL_DONE

BOOL

FALSE

1 = Ejecutado Ajustar valor real al vuelo

26.0

ACT_POS

DINT

L#0

Posici√≥n actual del eje

30.0

TRACK_OUT

DWORD

DW#16#0

Se√±ales de pista actuales de las pistas 0 a 31
Bit 0 = Pista 0

Selectores de funci√≥n
34.0

EDGE_ON

BOOL

FALSE

1 = Captura de bordes activada

34.1

SIM_ON

BOOL

FALSE

1 = Simulaci√≥n activa

34.2

MSR_ON

BOOL

FALSE

1 = Medici√≥n de longitud activada

34.3

REFTR_ON

BOOL

FALSE

1 = Redisparar el punto de referencia

34.4

SSW_OFF

BOOL

FALSE

1 = Final de carrera de software desconectado

Bits de disparo de peticiones de escritura
35.0

MDWR_EN

BOOL

FALSE

1 = Escribir datos m√°quina

35.1

MD_EN

BOOL

FALSE

1 = Activar datos m√°quina

6626

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metros

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

35.2

AVALREM_EN

BOOL

FALSE

1 = Ajustar valor real, Ajustar valor real al vuelo,
Cancelar preselecci√≥n del valor real

35.3

CAM1WR_EN

BOOL

FALSE

1 = Escribir datos de leva 1
(levas de 0 a 15)

35.4

CAM2WR_EN

BOOL

FALSE

1 = Escribir datos de leva 2
(levas de 16 a 31)

35.5

CAM3WR_EN

BOOL

FALSE

1 = Escribir datos de leva 3
(levas de 32 a 47)

35.6

CAM4WR_EN

BOOL

FALSE

1 = Escribir datos de leva 4
(levas de 48 a 63)

35.7

CAM5WR_EN

BOOL

FALSE

1 = Escribir datos de leva 5
(levas de 64 a 79)

36.0

CAM6WR_EN

BOOL

FALSE

1 = Escribir datos de leva 6
(levas de 80 a 95)

36.1

CAM7WR_EN

BOOL

FALSE

1 = Escribir datos de leva 7

36.2

CAM8WR_EN

BOOL

FALSE

1 = Escribir datos de leva 8

36.3

REFPT_EN

BOOL

FALSE

1 = Definir coordenadas del punto de referencia

36.4

AVAL_EN

BOOL

FALSE

1 = Ajustar valor real

36.5

FVAL_EN

BOOL

FALSE

1 = Ajustar valor real al vuelo

36.6

ZOFF_EN

BOOL

FALSE

1 = Activar decalaje de se√±al cero

36.7

CH01CAM_EN

BOOL

FALSE

1 = Escribir ajuste para flanco de leva (1 leva)

37.0

CH16CAM_EN

BOOL

FALSE

1 = Escribir ajuste para un cambio r√°pido de
levas (16 levas)

(levas de 96 a 111)
(levas de 112 a 127)

Bits de disparo de peticiones de lectura
37.1

MDRD_EN

BOOL

FALSE

1 = Leer datos m√°quina

37.2

CAM1RD_EN

BOOL

FALSE

1 = Leer datos de leva 1
(Levas de 0 a 15)

37.3

CAM2RD_EN

BOOL

FALSE

1 = Leer datos de leva 2
(Levas de 16 a 31)

37.4

CAM3RD_EN

BOOL

FALSE

1 = Leer datos de leva 3
(Levas de 32 a 47)

37.5

CAM4RD_EN

BOOL

FALSE

1 = Leer datos de leva 4
(Levas de 48 a 63)

37.6

CAM5RD_EN

BOOL

FALSE

1 = Leer datos de leva 5
(Levas de 64 a 79)

37.7

CAM6RD_EN

BOOL

FALSE

1 = Leer datos de leva 6

38.0

CAM7RD_EN

BOOL

FALSE

1 = Leer datos de leva 7

38.1

CAM8RD_EN

BOOL

FALSE

1 = Leer datos de leva 8

(Levas de 80 a 95)
(Levas de 96 a 111)
(Levas de 112 a 127)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6627

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metros

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

38.2

MSRRD_EN

BOOL

FALSE

1 = Leer valores medidos

38.3

CNTTRC_EN

BOOL

FALSE

1 = Leer valores de contaje de la pista de leva
de contaje

38.4

ACTPOS_EN

BOOL

FALSE

1 = Leer Datos de posici√≥n y pista

38.5

ENCVAL_EN

BOOL

FALSE

1 = Leer valores del enc√≥der

38.6

CAMOUT_EN

BOOL

FALSE

1 = Leer datos de leva y pista

Bits de finalizaci√≥n de selectores de funci√≥n
40.0

EDGE_D

BOOL

FALSE

1 = "Activar captura de bordes" o "Desactivar
captura de bordes" finalizado

40.1

SIM_D

BOOL

FALSE

1 = "Activar simulaci√≥n" o "Desactivar simula‚Äê
ci√≥n" finalizado

40.2

MSR_D

BOOL

FALSE

1 = "Activar medici√≥n de longitud" o "Desactivar
medici√≥n de longitud" finalizado

40.3

REFTR_D

BOOL

FALSE

1 = "Activar redisparar punto de referencia" o
"Desactivar redisparar punto de referencia" fi‚Äê
nalizado

40.4

SSW_D

BOOL

FALSE

1 = "Activar final de carrera por software" o
"Desactivar final de carrera por software" fina‚Äê
lizado

Bits de finalizaci√≥n de peticiones de escritura
41.0

MDWR_D

BOOL

FALSE

1 = Petici√≥n "Escribir datos m√°quina" finalizada

41.1

MD_D

BOOL

FALSE

1 = Petici√≥n "Habilitar datos m√°quina" finaliza‚Äê
da

41.2

AVALREM_D

BOOL

FALSE

1 = "Deshacer Ajustar valor real" o "Deshacer
Ajustar valor real al vuelo" cancelado

41.3

CAM1WR_D

BOOL

FALSE

1 = Petici√≥n "Escribir datos de leva 1" finalizada

41.4

CAM2WR_D

BOOL

FALSE

1 = Petici√≥n "Escribir datos de leva 2" finalizada

41.5

CAM3WR_D

BOOL

FALSE

1 = Petici√≥n "Escribir datos de leva 3" finalizada

41.6

CAM4WR_D

BOOL

FALSE

1 = Petici√≥n "Escribir datos de leva 4" finalizada

41.7

CAM5WR_D

BOOL

FALSE

1 = Petici√≥n "Escribir datos de leva 5" finalizada

42.0

CAM6WR_D

BOOL

FALSE

1 = Petici√≥n "Escribir datos de leva 6" finalizada

42.1

CAM7WR_D

BOOL

FALSE

1 = Petici√≥n "Escribir datos de leva 7" finalizada

42.2

CAM8WR_D

BOOL

FALSE

1 = Petici√≥n "Escribir datos de leva 8" finalizada

42.3

REFPT_D

BOOL

FALSE

1 = Petici√≥n "Definir punto de referencia" finali‚Äê
zada

42.4

AVAL_D

BOOL

FALSE

1 = Petici√≥n "Ajustar valor real" finalizada

42.5

FVAL_D

BOOL

FALSE

1 = Petici√≥n "Ajustar valor real al vuelo" termi‚Äê
nada

42.6

ZOFF_D

BOOL

FALSE

1 = Petici√≥n "Activar decalaje de se√±al cero"
finalizada

42.7

CH01CAM_D

BOOL

FALSE

1 = Petici√≥n "Modificar leva 1" finalizada

43.0

CH16CAM_D

BOOL

FALSE

1 = Petici√≥n "Modificar 16 levas" finalizada
(cambio r√°pido de levas)

BOOL

FALSE

1 = Petici√≥n "Leer datos m√°quina" finalizada

Bits de finalizaci√≥n de peticiones de lectura
43.1

6628

MDRD_D

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metros

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

43.2

CAM1RD_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de leva 1" finalizada

43.3

CAM2RD_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de leva 2" finalizada

43.4

CAM3RD_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de leva 3" finalizada

43.5

CAM4RD_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de leva 4" finalizada

43.6

CAM5RD_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de leva 5" finalizada

43.7

CAM6RD_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de leva 6" finalizada

44.0

CAM7RD_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de leva 7" finalizada

44.1

CAM8RD_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de leva 8" finalizada

44.2

MSRRD_D

BOOL

FALSE

1 = Petici√≥n "Leer valores medidos" terminada

44.3

CNTTRC_D

BOOL

FALSE

1 = Petici√≥n "Leer valores de contaje de la pista
de leva de contaje" finalizada

44.4

ACTPOS_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de posici√≥n y pista"
finalizada

44.5

ENCVAL_D

BOOL

FALSE

1 = Petici√≥n "Leer valor actual del enc√≥der" fi‚Äê
nalizada

44.6

CAMOUT_D

BOOL

FALSE

1 = Petici√≥n "Leer datos de leva y pista" finali‚Äê
zada

Bits de error de selectores de funci√≥n
46.0

EDGE_ERR

BOOL

FALSE

1 = Error en "Activar captura de bordes" o "De‚Äê
sactivar captura de bordes"

46.1

SIM_ERR

BOOL

FALSE

1 = Error al "Activar simulaci√≥n" o "Desactivar
simulaci√≥n"

46.2

MSR_ERR

BOOL

FALSE

1 = Error al "Activar medici√≥n de longitud" o
"Desactivar medici√≥n de longitud"

46.3

REFTR_ERR

BOOL

FALSE

1 = Error al "Activar redisparar punto de refe‚Äê
rencia" o "Desactivar redisparar punto de refe‚Äê
rencia"

46.4

SSW_ERR

BOOL

FALSE

1 = Error al "Activar final de carrera por softwa‚Äê
re" o "Desactivar final de carrera por software"

Bits de error de peticiones de escritura
47.0

MDWR_ERR

BOOL

FALSE

1 = Error en la tarea "Escribir datos m√°quina"

47.1

MD_ERR

BOOL

FALSE

1 = Error en la tarea "Activar datos m√°quina"

47.2

AVALREM_ERR

BOOL

FALSE

1 = Error en la tarea "Deshacer Ajustar valor
real" o "Deshacer Ajustar valor real al vuelo"

47.3

CAM1WR_ERR

BOOL

FALSE

1 = Error en la tarea "Escribir datos de leva 1"

47.4

CAM2WR_ERR

BOOL

FALSE

1 = Error en la tarea "Escribir datos de leva 2"

47.5

CAM3WR_ERR

BOOL

FALSE

1 = Error en la tarea "Escribir datos de leva 3"

47.6

CAM4WR_ERR

BOOL

FALSE

1 = Error en la tarea "Escribir datos de leva 4"

47.7

CAM5WR_ERR

BOOL

FALSE

1 = Error en la tarea "Escribir datos de leva 5"

48.0

CAM6WR_ERR

BOOL

FALSE

1 = Error en la tarea "Escribir datos de leva 6"

48.1

CAM7WR_ERR

BOOL

FALSE

1 = Error en la tarea "Escribir datos de leva 7"

48.2

CAM8WR_ERR

BOOL

FALSE

1 = Error en la tarea "Escribir datos de leva 8"

48.3

REFPT_ERR

BOOL

FALSE

1 = Error en la tarea "Definir punto de referen‚Äê
cia"

48.4

AVAL_ERR

BOOL

FALSE

1 = Error en la tarea "Ajustar valor real"

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6629

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metros

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

48.5

FVAL_ERR

BOOL

FALSE

1 = Error en la tarea "Ajustar valor real al vuelo"

48.6

ZOFF_ERR

BOOL

FALSE

1 = Error en la tarea "Activar decalaje de se√±al
cero"

48.7

CH01CAM_ERR

BOOL

FALSE

1 = Error en la tarea "Cambiar leva 1"

49.0

CH16CAM_ERR

BOOL

FALSE

1 = Error en la tarea "Cambiar 16 levas" (cam‚Äê
bio r√°pido de levas)

Bits de error de las peticiones de lectura
49.1

MDRD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos m√°quina"

49.2

CAM1RD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos de leva 1"

49.3

CAM2RD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos de leva 2"

49.4

CAM3RD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos de leva 3"

49.5

CAM4RD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos de leva 4"

49.6

CAM5RD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos de leva 5"

49.7

CAM6RD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos de leva 6"

50.0

CAM7RD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos de leva 7"

50.1

CAM8RD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos de leva 8"

50.2

MSRRD_ERR

BOOL

FALSE

1 = Error en la tarea "Leer valores medidos"

50.3

CNTTRC_ERR

BOOL

FALSE

1 = Error en la tarea "Leer valores de contaje de
la pista de leva de contaje"

50.4

ACTPOS_ERR

BOOL

FALSE

1 = Error en la tarea "Leer datos de posici√≥n y
pista"

50.5

ENCVAL_ERR

BOOL

FALSE

1 = Error en la tarea "Leer valor actual del en‚Äê
c√≥der"

50.6

CAMOUT_ERR

BOOL

FALSE

1 = Error en la petici√≥n "Leer datos de leva y
pista"

Gesti√≥n de peticiones para la instrucci√≥n CAM_CTRL o bien CAM_CTRL_452
52.0

JOB_ERR

INT

0

Error de comunicaci√≥n

54.0

JOBBUSY

BOOL

FALSE

1 = Por lo menos hay una tarea en curso

54.1

JOBRESET

BOOL

FALSE

1 = Resetear todos los bits de error y finaliza‚Äê
ci√≥n

Gesti√≥n de peticiones para la instrucci√≥n CAM_MSRM_452
56.0

JOB_ERR_M

INT

0

Error de comunicaci√≥n

58.0

JOBBUSY_M

BOOL

FALSE

1 = Petici√≥n en curso

DINT

L#0

Decalaje de se√±al cero

DINT

L#0

Coordenada de "Ajustar valor real"

L#0

Coordenada de "Ajustar valor real al vuelo"

DINT

L#0

Coordenada de "Definir punto de referencia"

INT

0

N√∫mero de leva

Datos de la petici√≥n "Decalaje de se√±al cero"
86.0

ZOFF

Datos de la petici√≥n "Ajustar valor real"
90.0

AVAL

Datos de la petici√≥n "Ajustar valor real al vuelo"
94.0

FVAL

DINT

Datos de la petici√≥n "Definir punto de referencia"
98.0

REFPT

Datos de la tarea "Modificar flancos de leva"
102.0

6630

CAM_NO

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metros

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

104.0

CAM_START

DINT

L#0

Inicio de leva

108.0

CAM_END

DINT

L#0

Fin de leva

Datos de la petici√≥n "Medici√≥n de longitud/Captura de bordes"
112.0

BEG_VAL

DINT

L#0

Valor inicial

116.0

END_VAL

DINT

L#0

Valor final

120.0

LEN_VAL

DINT

L#0

Longitud

Datos de la tarea "Leer valores de contaje"
124.0

CNT_TRC0

INT

0

Valor de contaje actual para la pista de leva de
contaje 0

126.0

CNT_TRC1

INT

0

Valor de contaje actual para la pista de leva de
contaje 1

Datos de la tarea "Leer datos de posici√≥n y pista"
128.0

ACTPOS

DINT

L#0

Posici√≥n actual

132.0

ACTSPD

DINT

L#0

Velocidad actual

136.0

TRACK_ID

DWORD

DW#16#0

Bits identificadores de pista de las pistas 0 a 31

Datos de la tarea "Leer datos de enc√≥der"
140.0

ENCVAL

DINT

L#0

Valor del enc√≥der

144.0

ZEROVAL

DINT

L#0

Lectura del contador con la √∫ltima marca cero

148.0

ENC_ADJ

DINT

L#0

Reajuste del enc√≥der absoluto

Datos de la tarea "Leer datos de leva y pista"
152.0

CAM_00_31

DWORD

DW#16#0

Bits identificadores de leva para las levas de 0
a 31

156.0

CAM_32_63

DWORD

DW#16#0

Bits identificadores de leva para las levas de 32
a 63

160.0

CAM_64_95

DWORD

DW#16#0

Bits identificadores de leva para las levas de 64
a 95

164.0

CAM_96_127

DWORD

DW#16#0

Bits identificadores de leva para las levas de 96
a 127

168.0

TRACK_ID1

DWORD

DW#16#0

Bits identificadores de pista para las pistas de 0
a 31

172.0

ACTPOS1

DINT

L#0

Posici√≥n actual

Datos de la tarea "Cambio r√°pido de levas"
176.0

C_QTY

BYTE

B#16#0

N√∫mero de levas a modificar

177.0

DIS_CHECK

BOOL

FALSE

1 = Desactivar la comprobaci√≥n de datos

180.0

CAM

ARRAY
[0...15]

Nota:
La estructura que sigue a continuaci√≥n tiene
que rellenarse en todas las levas que vayan a
modificarse.

STRUCT
Direcci√≥n relativa
+0.0

CAM_NO

BYTE

B#16#0

N√∫mero de la leva a modificar

+1.0

C_EFFDIR

BOOL

FALSE

1 = Cambio del sentido de actuaci√≥n

+1.1

C_CBEGIN

BOOL

FALSE

1 = Cambio del inicio de la leva al valor CBE‚Äê
GIN (nuevo inicio de leva)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6631

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metros

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

+1.2

C_CEND

BOOL

FALSE

1 = Cambio del fin de leva / del tiempo de acti‚Äê
vaci√≥n al valor CEND (nuevo fin de leva)

+1.3

C_LTIME

BOOL

FALSE

1 = Cambio del tiempo de anticipaci√≥n al valor
LTIME (nuevo tiempo de anticipaci√≥n)

+1.4

CAM_OFF

BOOL

FALSE

1 = Desactivaci√≥n de la leva durante el cambio
de datos de leva

+1.5

EFFDIR_P

BOOL

FALSE

1 = Nuevo sentido de actuaci√≥n positivo (+)

+1.6

EFFDIR_M

BOOL

FALSE

1 = Nuevo sentido de actuaci√≥n negativo (-)

+2.0

CBEGIN

DINT

L#0

Nuevo inicio de leva

+6.0

CEND

DINT

L#0

Nuevo fin de leva / Nuevo tiempo de activaci√≥n

+10.0

LTIME

INT

0

Nuevo tiempo de anticipaci√≥n

Bloque de datos de par√°metros
Tarea
Los datos m√°quina y los datos de leva se encuentran depositados en el DB de par√°metros. Los
par√°metros pueden ser modificados por el programa de usuario o por un sistema de manejo
y visualizaci√≥n. Existe la posibilidad de importar los datos modificados a la interfaz de
parametrizaci√≥n y visualizarlos desde ah√≠. Los datos que se muestran en la interfaz de
parametrizaci√≥n se pueden exportar a un DB de par√°metros.
En un m√≥dulo puede haber varios juegos de datos de parametrizaci√≥n (p. ej. para distintas
recetas) a los que se puede conmutar por medio del programa.

Estructura
DB de par√°metros
CAM_P016TYPE (UDT3)
Datos m√°quina
Datos de las levas de 0 a 15
CAM_P032TYPE (UDT4)
Datos m√°quina
Datos de las levas de 0 a 31
CAM_P064TYPE (UDT5)
Datos m√°quina
Datos de las levas de 0 a 63
CAM_P0128TYPE (UDT6)
Datos m√°quina
Datos de las levas de 0 a 127

6632

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Contenido
La siguiente tabla muestra el contenido del DB de par√°metros.
Nota
Los datos que no se indican en esta tabla no deben ser modificados.

Direcci√≥n

Par√°metro

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

BOOL

‚óè FM 352: 0

Datos m√°quina
3.1

PI_MEND

FALSE

‚óè FM 452:
1: Habilitar alarma de proceso: Fin de la medici√≥n
3.2

PI_CAM

BOOL

FALSE

1: Habilitar alarma de proceso: Leva activa / inactiva

3.5

PI_MSTRT

BOOL

FALSE

‚óè FM 352: 0
‚óè FM 452:
1: Habilitar alarma de proceso: Comienzo de la
medici√≥n

4.0

EDGEDIST

DINT

L#0

Distancia m√≠nima entre bordes en la captura de bordes

8.0

UNITS

DINT

L#1

Sistema de medida

12.0

AXIS_TYPE

DINT

L#0

0: Eje lineal, 1: Eje rotativo

16.0

ENDROTAX

DINT

L#100 000

Final del eje rotativo

20.0

ENC_TYPE

DINT

L#1

Tipo de enc√≥der, longitud de telegrama

24.0

DISP_REV

DINT

L#80 000

Recorrido por vuelta

32.0

INC_REV

DINT

L#500

Incrementos por vuelta

36.0

NO_REV

DINT

L#1024

N√∫mero de revoluciones

40.0

BAUDRATE

DINT

L#0

Velocidad de transferencia

44.0

REFPT

DINT

L#0

Coordenada del punto de referencia

48.0

ENC_ADJ

DINT

L#0

Reajuste del enc√≥der absoluto

52.0

RETR_TYPE

DINT

L#0

Tipo de "Redisparar el punto de referencia"

59.0

CNT_DIR

DINT

L#0

Sentido de contaje:

63.0

MON_WIRE

BOOL

TRUE

1: Supervisi√≥n rotura de hilo

63.1

MON_FRAME

BOOL

TRUE

1: Supervisi√≥n error de telegrama

63.2

MON_PULSE

BOOL

TRUE

1: Supervisi√≥n pulsos de error

64.0

SSW_STRT

DINT

L#-100 000 000

Final de carrera de software Inicio

68.0

SSW_END

DINT

L#100 000 000

Final de carrera de software Fin

76.0

C_QTY

DINT

L#0

Alcance: 0, 1, 2, 3 = m√°x. 16, 32, 64, 128 levas

80.0

HYS

DINT

L#0

Hist√©resis

84.0

SIM_SPD

DINT

L#0

Velocidad de simulaci√≥n

90.0

TRACK_OUT

WORD

W#16#0

Control de las salidas de pista:

0: normal, 1: Invertida

0 = Leva electr√≥nica, 1 = CPU;
N√∫mero de bit = N√∫mero de pista

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6633

Instrucciones
4.2 Instrucciones
Direcci√≥n

Par√°metro

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

95.0

EN_IN_I3

BOOL

FALSE

Habilitaci√≥n Entrada I3

95.1

EN_IN_I4

BOOL

FALSE

‚óè FM 352: 0
‚óè FM 452:
Habilitaci√≥n entrada I4

95.2

EN_IN_I5

BOOL

FALSE

‚óè FM 352: 0
‚óè FM 452:
Habilitaci√≥n entrada I5

95.3

EN_IN_I6

BOOL

FALSE

‚óè FM 352: 0
‚óè FM 452:
Habilitaci√≥n entrada I6

95.4

EN_IN_I7

BOOL

FALSE

‚óè FM 352: 0
‚óè FM 452:
Habilitaci√≥n entrada I7

95.5

EN_IN_I8

BOOL

FALSE

‚óè FM 352: 0
‚óè FM 452:
Habilitaci√≥n entrada I8

95.6

EN_IN_I9

BOOL

FALSE

‚óè FM 352: 0
‚óè FM 452:
Habilitaci√≥n entrada I9

95.7

EN_IN_I10

BOOL

FALSE

‚óè FM 352: 0
‚óè FM 452:
Habilitaci√≥n entrada I10

99.0

SPEC_TRC0

BOOL

FALSE

1 = Pista 0 es pista de leva de contaje

99.1

SPEC_TRC1

BOOL

FALSE

1 = Pista 1 es pista de leva de contaje

99.2

SPEC_TRC2

BOOL

FALSE

1 = Pista 2 es pista de leva de freno

100.0

CNT_LIM0

DINT

L#2

Valor de contaje superior para la pista de leva de con‚Äê
taje 0

104.0

CNT_LIM1

DINT

L#2

Valor de contaje superior para la pista de leva de con‚Äê
taje 1

Datos de leva respectivamente para levas de 0 a 15 / 0 a 31 / 0 a 63 / 0 a 127
108.0

STRUCT

(cada elemento 12 bytes de longitud)

Direcci√≥n relativa
+0.0

CAMVALID

+0.1

EFFDIR_P

+0.2

EFFDIR_M

+0.3

CAM_TYPE

+0.4

PI_SW_ON

+0.5

PI_SW_OFF

+1.0

TRACK_NO

+2.0

CBEGIN

+6.0

CEND

DINT

L#100 000 000

Final de leva/Tiempo de activaci√≥n

+10.0

LTIME

INT

0

Tiempo de anticipaci√≥n

6634

BOOL

FALSE

1: Leva v√°lida

BOOL

TRUE

1: Sentido de actuaci√≥n positivo (+)

BOOL

TRUE

1: Sentido de actuaci√≥n negativo (-)

BOOL

FALSE

0: Leva de recorrido, 1: Leva de tiempo

BOOL

FALSE

1: Alarma de proceso al activar

BOOL

FALSE

1: Alarma de proceso al desactivar

BYTE

B#16#0

N√∫mero de pista

DINT

L#-100 000 000

Inicio de leva

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Bloque de datos de diagn√≥stico
Tarea
El DB de diagn√≥stico es el archivo de datos para la instrucci√≥n CAM_DIAG (P√°gina 6619)
o CAM_DIAG_452 (P√°gina 6622). Contiene el b√∫fer de diagn√≥stico del m√≥dulo acondicionado
por esta instrucci√≥n.

Estructura
DB de diagn√≥stico
Direcci√≥n del m√≥dulo
Datos internos
Estado de la tarea
Bit de inicio
B√∫fer de diagn√≥stico acondicionado

Contenido
La siguiente tabla muestra el contenido del DB de diagn√≥stico.
Nota
Los datos que no se indican en esta tabla no deben ser modificados.

Direcci√≥n

Par√°metro

Tipo de datos

Valor inicial

Descripci√≥n

0.0

MOD_ADDR
(¬°Registrar!)

INT

0

Direcci√≥n del m√≥dulo

256.0

JOB_ERR

INT

0

Error de comunicaci√≥n

258.0

JOBBUSY

BOOL

FALSE

1 = Petici√≥n activa

258.1

DIAGRD_EN

BOOL

FALSE

1 = Leer el b√∫fer de diagn√≥stico necesaria‚Äê
mente

260.0

DIAG_CNT

INT

0

N√∫mero de entradas v√°lidas de la lista

262.0

DIAG[1]

STRUCT

Entrada m√°s reciente de datos de diagn√≥s‚Äê
tico

272.0

DIAG[2]

STRUCT

Segunda entrada de datos de diagn√≥stico

282.0

DIAG[3]

STRUCT

Tercera entrada de datos de diagn√≥stico

292.0

DIAG[4]

STRUCT

√öltima entrada de datos de diagn√≥stico

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6635

Instrucciones
4.2 Instrucciones

Estructura de la entrada de diagn√≥stico
La siguiente tabla muestra la estructura de una entrada de diagn√≥stico DIAG[n].
Direcci√≥n

Par√°metro

Tipo de da‚Äê Valor inicial
tos

Descripci√≥n

+0.0

STATE

BOOL

FALSE

0 = Evento saliente
1 = Evento entrante

+0.1

INTF

BOOL

FALSE

1 = Error interno

+0.2

EXTF

BOOL

FALSE

1 = Error externo

+2.0

FCL

INT

0

Clase de error
1: Fallo operativo
4: Fallo de datos
5: Fallo de datos m√°quina
7: Fallo de datos de leva
15: Avisos
128: Error de diagn√≥stico

+4.0

FNO

INT

0

N√∫mero de error 0 ‚Ä¶ 255

+6.0

CH_NO

INT

0

N√∫mero de canal (siempre 1)

+8.0

CAMNO

INT

0

N√∫mero de leva de 0 a 127 con clase de error = error de datos de
leva

Gesti√≥n de peticiones (CAM_CTRL)
Tareas
El intercambio de datos a partir de las se√±ales de control y de respuesta con el m√≥dulo se
realiza a trav√©s de las peticiones.
Para lanzar una petici√≥n active el bit de inicio correspondiente del bloque de datos del canal y,
en el caso de las peticiones de escritura, proporcione adem√°s los datos correspondientes.
Llame la instrucci√≥n CAM_CTRL (P√°gina 6617) para ejecutar la petici√≥n.
Si se utiliza el m√≥dulo de forma centralizada, se ejecutar√° de inmediato una petici√≥n de lectura.
Si se utiliza el FM 352 de forma descentralizada, una petici√≥n de lectura puede precisar varios
ciclos.
A causa de los acuses necesarios del m√≥dulo una petici√≥n de escritura precisa por lo menos
3 llamadas (o ciclos OB). Si se utiliza el FM 352 de forma descentralizada, una petici√≥n de
escritura puede requerir m√°s de 3 llamadas.
Es posible activar varias peticiones de forma simult√°nea, incluso con se√±ales de control.
Excepto la petici√≥n de escribir el selector de funci√≥n, las peticiones se procesan en la
secuencia de los bits de inicio que est√° definida en el DB de canal. En cuanto se ha procesado
por completo una petici√≥n, se desactiva el bit de inicio. Con la siguiente llamada de la
instrucci√≥n se determina y ejecuta la petici√≥n siguiente.

6636

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Adem√°s del bit de inicio, para cada petici√≥n hay un bit de finalizaci√≥n y otro de error. Se
diferencian en la terminaci√≥n del nombre:
Bit

Terminaci√≥n

Bit de inicio

_EN ("enable")

Bit de finalizaci√≥n

_D ("done")

Bit de error

_ERR ("error")

Los bits de finalizaci√≥n y de error de la petici√≥n se tienen que poner a 0 tras la evaluaci√≥n o
antes del inicio de esta petici√≥n.
Cuando se activa el bit JOBRESET antes del procesamiento de las peticiones pendientes, se
desactivan todos los bits de finalizaci√≥n y error. Seguidamente, el bit JOBRESET se vuelve a
poner a 0.

Selectores de funci√≥n
Los selectores de funci√≥n activan y desactivan estados del m√≥dulo. Una petici√≥n de escritura
del selector de funci√≥n s√≥lo se ejecuta si cambia una posici√≥n del selector. La posici√≥n del
selector de funci√≥n se mantiene tras ejecutarse la petici√≥n.
La medici√≥n de la longitud y la captura de bordes no deben estar activados de forma
simult√°nea. Por ello la instrucci√≥n CAM_CTRL se encarga de que cuando se active un selector
de funci√≥n se desactive el otro. Si a pesar de ello activa los dos selectores de funci√≥n de forma
simult√°nea (0 ‚Üí 1), se activar√° la medici√≥n de longitud.
Los selectores de funci√≥n y las peticiones se pueden emplear de forma simult√°nea en una
llamada de la instrucci√≥n CAM_CTRL.
Al igual que ocurre con las peticiones, para los selectores de funci√≥n hay bits de finalizaci√≥n
con la terminaci√≥n _D y bits de error con la terminaci√≥n _ERR.
Para poder evaluar los bits de finalizaci√≥n y de error del selector de funci√≥n se deben poner a
0 en caso de modificar un selector de funci√≥n.

Estado de la petici√≥n
El estado de procesamiento de la petici√≥n se lee en el valor de retorno RETVAL y en el bit de
actividad JOBBUSY del DB de canal. El estado de una petici√≥n concreta se puede evaluar por
medio del bit de inicio, el bit de finalizaci√≥n y el bit de error de esa petici√≥n.
RETVAL

JOBBUSY

Bit de inicio _EN

Bit de finaliza‚Äê Bit de error _ERR
ci√≥n _D

1

1

1

0

0

La petici√≥n ha fina‚Äê 0
lizado sin errores

0

0

1

0

La petici√≥n ha fina‚Äê -1
lizado con errores

0

0

1

1

Petici√≥n de escri‚Äê
tura finalizada

0

0

0

1

Petici√≥n activa

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

-1

6637

Instrucciones
4.2 Instrucciones

Gesti√≥n de peticiones (CAM_CTRL_452))
Peticiones
El intercambio de datos con el m√≥dulo a partir de las se√±ales de control y respuesta se realiza
mediante peticiones.
Para iniciar una petici√≥n active el bit de inicio correspondiente del DB de canal y, en el caso de
las peticiones de escritura, proporcione adem√°s los datos correspondientes. Llame la
instrucci√≥n CAM_CTRL_452 (P√°gina 6620) para ejecutar la petici√≥n.
Una petici√≥n de lectura se ejecuta de inmediato. A causa de los acuses necesarios del m√≥dulo
una petici√≥n de escritura precisa por lo menos 3 llamadas (o ciclos OB).
Es posible activar varias peticiones de forma simult√°nea, incluso con se√±ales de control.
Excepto la petici√≥n de escribir los selectores de funci√≥n, las peticiones se procesan en el orden
de los bits de disparo que est√° definido en el DB de canal. En cuanto se ha procesado por
completo una petici√≥n, se desactiva el bit de inicio. Con la siguiente llamada de la instrucci√≥n
se determina y ejecuta la petici√≥n siguiente.
Adem√°s del bit de inicio, para cada petici√≥n hay un bit de finalizaci√≥n y otro de error. Se
diferencian en la terminaci√≥n del nombre:
Bit

Terminaci√≥n

Bit de inicio

_EN ("enable")

Bit de finalizaci√≥n

_D ("done")

Bit de error

_ERR ("error")

Los bits de finalizaci√≥n y error de la petici√≥n deben ponerse a 0 tras la evaluaci√≥n o antes del
inicio de dicha petici√≥n.
Cuando se activa el bit JOBRESET antes del procesamiento de las peticiones pendientes, se
desactivan todos los bits de finalizaci√≥n y error. Seguidamente, el bit JOBRESET se vuelve a
poner a 0.

Selectores de funci√≥n
Los selectores de funci√≥n activan y desactivan estados del m√≥dulo. Una petici√≥n de escritura
de los selectores de funci√≥n s√≥lo se ejecuta si cambia una posici√≥n del selector. La posici√≥n del
selector de funci√≥n se mantiene tras ejecutar la petici√≥n.
La medici√≥n de la longitud y la captura de bordes no deben estar activados de forma
simult√°nea. Por ello la instrucci√≥n CAM_CTRL_452 se encarga de que cuando se active un
selector de funci√≥n se desactive el otro. Si se activan los dos selector de funci√≥n a la vez (0
‚Üí 1), se activa la medici√≥n de longitud.
Los selectores de funci√≥n y las peticiones se pueden utilizar simult√°neamente en una llamada
de la instrucci√≥n CAM_CTRL_452.
Al igual que ocurre con las peticiones, para los selectores de funci√≥n hay bits de finalizaci√≥n
con la terminaci√≥n _D y bits de error con la terminaci√≥n _ERR.
Para poder evaluar los bits de finalizaci√≥n y error de los selectores de funci√≥n se deben poner
a 0 en caso de modificar un selector de funci√≥n.

6638

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Estado de la petici√≥n
El estado de procesamiento de la petici√≥n se lee en el valor de retorno RET_VAL y en el bit de
actividad JOBBUSY del DB de canal. El estado de una petici√≥n concreta se puede evaluar por
medio del bit de inicio, el bit de finalizaci√≥n y el bit de error de dicha petici√≥n.
RET_VAL

JOBBUSY

Bit de inicio _EN

Bit de finaliza‚Äê Bit de error _ERR
ci√≥n _D

1

1

1

0

0

La petici√≥n ha fina‚Äê 0
lizado sin errores

0

0

1

0

La petici√≥n ha fina‚Äê -1
lizado con errores

0

0

1

1

Petici√≥n de escri‚Äê
tura cancelada

0

0

0

1

Petici√≥n activa

-1

Clases de error
Clase de error 1: Fallo operativo
Descripci√≥n
Los fallos operativos se detectan de forma as√≠ncrona respecto a un control.
N¬∫

Significado

Alarma de diag‚Äê
n√≥stico

1

Rebase del final de carrera por software Inicio

S√≠

2

Rebase del final de carrera por software Fin

s√≠

3

Rebase del inicio de la zona de desplazamiento

s√≠

4

Rebase del fin de la zona de desplazamiento

s√≠

13

Ajustar valor real al vuelo no ejecutable

s√≠

Causa

Los finales de carrera de software, tras ajustar valor real al vuelo, se en‚Äê
cuentran fuera del rango de desplazamiento
(-100 m...+100 m √≥ -1.000 m...+1.000 m).
El decalaje resultante de Ajustar valor real / Ajustar valor real al vuelo es
mayor que ¬±100 m o ¬±1.000 m.

Efecto

Eje no sincronizado.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6639

Instrucciones
4.2 Instrucciones

Clase de error 4: Error de datos
Descripci√≥n
Los errores de datos se detectan de forma s√≠ncrona respecto a un control/mando.
N.¬∫

Significado

10

Decalaje de se√±al cero err√≥neo
Causa

Alarma de diag‚Äê
n√≥stico
No

El decalaje de se√±al cero es mayor que ¬± 100 m o ¬± 1.000 m.
Los finales de carrera de software, tras ajustar el decalaje de se√±al cero, se
encuentran fuera del rango de desplazamiento
(-100 m...+100 m √≥ -1000 m...+1000 m).
Eje rotativo: el valor del decalaje de se√±al cero es mayor que el final del eje
rotativo.

11

Indicaci√≥n del valor real err√≥nea
Causa

no

Eje lineal: la coordenada se encuentra fuera del final de carrera de software
actual (que puede estar desplazado).
Eje rotativo: la coordenada es < 0 √≥ mayor que el final del eje rotativo.

12

Punto de referencia err√≥neo
Causa

no

Eje lineal: la coordenada se encuentra fuera del final de carrera de software
actual (que puede estar desplazado).
Eje rotativo: la coordenada es < 0 √≥ mayor que el final del eje rotativo.

20

Activar datos m√°quina no admisible
Causa

21

Ajustar valor real al vuelo no admisible
Causa

27

no

En el m√≥dulo no hay datos m√°quina nuevos (sin errores)
no

Se ha intentado ejecutar "Ajustar valor real al vuelo" teniendo "Redisparar
punto de referencia" activado.

Ajuste codificado en bits no permitido
Causa

no

Los bits no utilizados y no descritos aqu√≠ son distintos a 0.
Se ha intentado seleccionar simult√°neamente" Medici√≥n de longitud" y
"Captura de bordes".

28

Redisparar el punto de referencia no admisible
Causa

no

Se ha intentado ejecutar "Redisparar el punto de referencia" estando "Ajus‚Äê
tar valor real al vuelo" pendiente.
Se ha intentado ejecutar "Redisparar el punto de referenciao" con un en‚Äê
c√≥der SSI.

29

Comando codificado en bits no permitido
Causa

no

Los bits no utilizados y no descritos aqu√≠ son distintos a 0.

30

Tiempo de anticipaci√≥n err√≥neo

no

31

N√∫mero de leva err√≥neo

no

Causa

La leva no es v√°lida
El n√∫mero de leva no se encuentra en el rango 0...127.

32

Inicio de leva err√≥neo
Causa

no

El inicio de leva se encuentra fuera del rango de desplazamiento
(-100 m...+100 m √≥ -1.000 m...+1.000 m).
Eje rotativo: el inicio de leva es < 0 o mayor que el final del eje rotativo.

6640

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

33

Fin de leva err√≥neo / Tiempo de activaci√≥n err√≥neo
Causa

Alarma de diag‚Äê
n√≥stico
no

El fin de leva se encuentra fuera del rango de desplazamiento
(-100 m...+100 m √≥ -1.000 m...+1.000 m).
Eje rotativo: el final de leva es < 0 o mayor que el final del eje rotativo.
La leva no est√° activada por lo menos en la duraci√≥n de un pulso.
En una leva invertida no hay una distancia m√≠nima de 4 pulsos entre inicio
de leva y fin de leva.

34

No es posible cancelar la activaci√≥n del valor real
Causa

35

no

Con un enc√≥der SSI y un eje l√≠neal, tras la ejecuci√≥n del ajuste el valor real
de posici√≥n se encontrar√≠a fuera de la zona de trabajo.

Indicaci√≥n del valor real err√≥nea al Ajustar valor real / Ajustar valor real al vuelo
Causa

no

El preajuste del valor real se encuentra fuera del rango num√©rico admisible
de ¬± 100 m √≥ ¬± 1.000 m.
Los finales de carrera de software, tras ejecutar el ajuste, se encontrar√≠an
fuera del rango de desplazamiento
(-100 m...+100 m √≥ -1000 m...+1000 m).
El decalaje resultante de Ajustar valor real / Ajustar valor al vuelo ser√≠a
mayor que ¬±100 m o ¬±1.000 m.

107

Eje no parametrizado
Causa

no

En el eje no hay ning√∫n dato m√°quina disponible.
En el eje no hay ning√∫n dato m√°quina activado.

108

Eje no sincronizado
Causa

no

Uno de los ajustes "Ajustar valor real" o "Ajustar valor real al vuelo" se ha
activado a pesar de que el eje no est√° sincronizado.

109

Procesamiento de levas en curso.

no

110

N√∫mero err√≥neo de levas a modificar

no

Clase de error 5: Error de datos m√°quina
Descripci√≥n
La alarma de diagn√≥stico s√≥lo se disparar√° con un m√≥dulo de datos del sistema (SDB) con
errores.
N.¬∫

Significado

5

Error en el ajuste de la alarma de proceso
Causa

6

s√≠

Ha intentado seleccionar una alarma de proceso que el m√≥dulo no admite.

Distancia m√≠nima entre bordes err√≥nea
Causa

8

Alarma de diag‚Äê
n√≥stico

Ha indicado como distancia m√≠nima entre bordes un valor < 0 √≥ > 10 ¬µm

Tipo de eje err√≥neo
Causa

s√≠
9

s√≠

Como tipo de eje no ha indicado ni 0 ni 1

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6641

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

9

Final err√≥neo del eje rotativo
Causa

10

s√≠

El valor del final del eje rotativo se encuentra fuera del rango admisible de
1 a 109 ¬µm o de 1 a 108 ¬µm (seg√∫n sea la resoluci√≥n).

Tipo de enc√≥der err√≥neo
Causa

11

Alarma de diag‚Äê
n√≥stico

s√≠

El valor del tipo de enc√≥der se encuentra fuera del margen admisible de 1
a 10

Recorrido/Vuelta err√≥neos
Causa

s√≠

El valor del recorrido/vuelta se encuentra fuera del margen admisible de 1
a 109 ¬µm (independientemente de la resoluci√≥n).

13

N√∫mero de incrementos/vuelta err√≥neo

s√≠

14

N√∫mero de vueltas err√≥neo

s√≠

15

Velocidad de transferencia err√≥nea

s√≠

Causa
16

Para la velocidad de transferencia ha indicado un valor fuera del rango
admisible de 0 a 3.

Coordinada del punto de referencia err√≥nea
Causa

s√≠

La coordenada se encuentra fuera del margen de -100 m a +100 m o,
respectivamente, de -1000 m a +1000 m, seg√∫n la resoluci√≥n.
Eje lineal: La coordenada se encuentra fuera de la zona de trabajo.
Eje rotativo: la coordenada es mayor que el final del eje rotativo √≥ < 0.

17

Reajuste err√≥neo del enc√≥der absoluto
Causa

18

s√≠

Ha indicado un valor fuera de los valores admisibles 0, 1, 6 y 7.

Ajuste err√≥neo del sentido
Causa

20

Enc√≥der SSI: el valor de reajuste del enc√≥der absoluto no se encuentra
dentro del rango del enc√≥der (incrementos por vuelta x n√∫mero de vueltas
- 1).

Tipo err√≥neo de "Redisparar el punto de referencia"
Causa

19

s√≠

s√≠

Ha indicado un valor fuera de los valores admisibles 0 y 1.

Supervisi√≥n de hardware no posible
Causa

s√≠

Ha puesto en "FALSE" la vigilancia de errores de telegrama en el DB de
par√°metros.
El enc√≥der no permite que se vigilen los impulsos err√≥neos (desactivar
MON_PULSE)

21

Final err√≥neo de carrera de software Inicio
Causa

s√≠

Eje lineal: el final de carrera de software Inicio se encuentra fuera del rango
de desplazamiento (-100 m...+100 m √≥ -1000 m...+1000 m, dependiendo de
la resoluci√≥n).
Eje lineal: el final de carrera de software Inicio (dado el caso, incluido un
decalaje de se√±al cero presente) es menor que -100 m √≥ -1000 m (seg√∫n la
resoluci√≥n).

22

Final err√≥neo de carrera de software Fin
Causa

s√≠

Eje lineal: el final de carrera de software Fin se encuentra fuera del rango de
desplazamiento (-100 m...+100 m √≥ 1000 m...+1000 m, dependiendo de la
resoluci√≥n) o es menor que el final de carrera de software Inicio.
Eje lineal: el final de carrera de software Fin (dado el caso, incluido un
decalaje de se√±al cero presente) es mayor que +100 m √≥ +1000 m (seg√∫n
la resoluci√≥n).

6642

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

144

Alcance err√≥neo
Causa

145

Alarma de diag‚Äê
n√≥stico
s√≠
Para el alcance ha indicado un valor distinto de 0 a 3.

Hist√©resis err√≥nea
Causa

s√≠
La hist√©resis se encuentra fuera del rango 0...65535 √ó resoluci√≥n.
La hist√©resis es superior a ¬º √ó √°rea de trabajo √≥ ¬º √ó rango de eje rotativo.

146

Velocidad de simulaci√≥n err√≥nea
Causa

s√≠

La velocidad de simulaci√≥n se encuentra fuera del rango 1000 √ó RES hasta
3 √ó 107 √ó RES o es mayor que 5 √ó 108 ¬µm/min.
La velocidad de simulaci√≥n no puede ajustarse internamente.

147

Pista err√≥nea
Causa

148

Se ha seleccionado el control de una pista fuera de 0...15 (bit 0...15).

Selecci√≥n err√≥nea de entradas de habilitaci√≥n
Causa

149

Selecci√≥n err√≥nea de una pista especial

Valor de contaje superior err√≥neo pista 0

s√≠

Ha indicado un valor de contaje < 2 √≥ > 65535 como valor de contaje su‚Äê
perior.

Valor de contaje superior err√≥neo pista 1
Causa

200

s√≠

Ha querido definir una pista fuera de 0, 1 y 2 (bits 0, 1 y 2) a modo de pista
especial

Causa
151

s√≠

Ha querido habilitar una pista fuera de 3...10 (bit 0...7) por medio de una
se√±al externa.

Causa
150

s√≠

s√≠

Ha indicado un valor de contaje < 2 √≥ > 65535 como valor de contaje su‚Äê
perior.

Resoluci√≥n err√≥nea
Causa

s√≠

Ha indicado una resoluci√≥n < 0,1 ¬µm/impulso o >1000 ¬µm/impulso.
Ha indicado un recorrido/vuelta y un n√∫mero de impulsos/vuelta que dan
una resoluci√≥n < 0,1 o > 1000.

201

El enc√≥der no se adapta al √°rea de trabajo / rango del eje rotativo
Causa

s√≠

Enc√≥der SSI y eje rotativo: el enc√≥der no cubre exactamente el rango del
eje rotativo.
Eje lineal: el enc√≥der no cubre por lo menos el √°rea de trabajo (finales de
carrera de software incluidos).

Clase de error 7: Error de datos de leva
Descripci√≥n
La alarma de diagn√≥stico s√≥lo se disparar√° con un m√≥dulo de datos del sistema (SDB) con
errores.
N¬∫
1

Significado

Alarma de diag‚Äê
n√≥stico

Alarma de proceso no admisible
Causa

S√≠

Ha querido indicar una alarma de proceso con una leva con un n√∫mero > 7.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6643

Instrucciones
4.2 Instrucciones
N¬∫

Significado

2

N√∫mero de pista err√≥neo
Causa

3

Alarma de diag‚Äê
n√≥stico
s√≠

El n√∫mero de pista se encuentra fuera del margen de 0 a 31

Inicio de leva err√≥neo
Causa

s√≠

El inicio de leva se encuentra fuera del rango de desplazamiento
(-100 m...+100 m √≥ -1.000 m...+1.000 m).
Eje rotativo: el inicio de leva es < 0 y/o mayor que el final del eje rotativo.

4

Fin de leva err√≥neo
Causa

s√≠

El fin de leva se encuentra fuera del rango de desplazamiento
(-100 m...+100 m √≥ -1.000 m...+1.000 m).
La leva no tiene una longitud de por lo menos 1 pulso.
Eje rotativo: el final de leva es < 0 y/o mayor que el final del eje rotativo.
En una leva invertida no hay una distancia m√≠nima de 4 pulsos entre inicio
de leva y fin de leva.

5

Tiempo de activaci√≥n err√≥neo
Causa

6

El tiempo de activaci√≥n es < 0 ¬µs. El valor m√°ximo depende del alcance.

Tiempo de anticipaci√≥n err√≥neo1)
Causa

50

s√≠

El tiempo de anticipaci√≥n es < 0 ¬µs. El valor m√°ximo depende del alcance.

Demasiados juegos de levas
Causa

51

s√≠

Ha querido indicar m√°s juegos de levas de los posibles con este alcance.

Eje en funcionamiento
Causa

52

s√≠

Ha querido indicar juegos de levas con la leva activada.

Eje no parametrizado
Causa

1)

s√≠

s√≠

Ha querido indicar datos de leva a pesar de que todav√≠a no hay datos m√°‚Äê
quina activos.

El mensaje de error tambi√©n puede aparecer si ha parametrizado el sentido de contaje "invertido" en combinaci√≥n con un
enc√≥der absoluto (SSI).

Clase de error 15: Avisos
N.¬∫
1

Significado
Inicio de parametrizaci√≥n
Causa

2

No

El m√≥dulo ha detectado una parametrizaci√≥n por medio de un bloque de
datos de sistema.

Final de la parametrizaci√≥n
Causa

6644

Alarma de diag‚Äê
n√≥stico

no

El m√≥dulo ha procesado sin problemas la parametrizaci√≥n por medio de un
bloque de datos del sistema.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Clase de error 128: Error de diagn√≥stico
N.¬∫

Significado

4

Falta tensi√≥n auxiliar externa
Causa

Alarma de diag‚Äê
n√≥stico
s√≠

‚óè La tensi√≥n auxiliar externa de 24 V no se ha conectado o ha fallado
‚óè Falta conector frontal
‚óè Cortacircuito, p. ej. en el enc√≥der conectado

Efecto

‚óè El procesamiento de levas se desactivar√°
‚óè Desactivaci√≥n de las salidas de pista
‚óè Borrado de la sincronizaci√≥n, con enc√≥ders incrementales
‚óè Los par√°metros no han sido asignados al m√≥dulo (se√±al de respuesta
PARA = 0).

Soluci√≥n
5

Comprobar que la conexi√≥n de 24 V sea correcta (si la conexi√≥n de 24 V es
correcta, significa que el m√≥dulo est√° averiado)

Falta conector frontal (FM 452)
Causa

El conector frontal no est√° insertado

Efectos

‚óè Falta tensi√≥n auxiliar externa de 24 V

s√≠

‚óè El m√≥dulo no est√° operativo
Soluci√≥n
51

Enchufar el conector frontal

Ha saltado la vigilancia de tiempo (watchdog)
Causa

s√≠

‚óè Interferencias fuertes en el m√≥dulo
‚óè Error en el m√≥dulo

Efectos

‚óè El m√≥dulo se restaura
‚óè Siempre que tras el reset del m√≥dulo no se detecte ning√∫n defecto en el
m√≥dulo, √©ste vuelve a estar listo para funcionar
‚óè El m√≥dulo notifica que ha transcurrido la vigilancia del tiempo con
"entrante" y "saliente"

Soluci√≥n

‚óè Eliminaci√≥n de interferencias
‚óè Consulte al departamento comercial correspondiente cuando las
circunstancias exactas que han dado lugar al error son de mayor
entidad.
‚óè Sustituir el m√≥dulo

52

Ca√≠da de la alimentaci√≥n interna del m√≥dulo
Causa

Error en el m√≥dulo

Efectos

‚óè El m√≥dulo se resetea

s√≠

‚óè Siempre que tras el reseteado del m√≥dulo no se detecte ning√∫n defecto
en el m√≥dulo, √©ste vuelve a estar operativo.
Soluci√≥n

Sustituir el m√≥dulo

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6645

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

Alarma de diag‚Äê
n√≥stico

70

Alarma de proceso perdida

s√≠

Causa

El m√≥dulo ha detectado un evento de alarma de proceso que no puede ser
notificado porque el mismo evento todav√≠a no ha sido procesado por el
programa de usuario o la CPU.

Efectos

‚óè El procesamiento de levas se desactiva
‚óè Desactivaci√≥n de las salidas de pista
‚óè Borrado de la sincronizaci√≥n, con enc√≥ders incrementales

Soluci√≥n

‚óè Incorporar un OB de alarma de proceso al programa de usuario
‚óè Comprobar la conexi√≥n de bus del m√≥dulo
‚óè Desactivar la alarma de proceso
‚óè Adapte el hardware y software a sus necesidades de proceso (p. ej.
CPU m√°s r√°pida, optimizar el programa de usuario)

144

Rotura de hilo Enc√≥der
Causa

s√≠

‚óè El cable del enc√≥der no est√° enchufado o est√° cortado
‚óè Enc√≥der sin se√±ales de cuadratura
‚óè Asignaci√≥n de pines incorrecta
‚óè Longitud de cable excesiva
‚óè Cortocircuito de las se√±ales del sensor

Efectos

‚óè El procesamiento de levas se desactiva
‚óè Desactivaci√≥n de las salidas de pista
‚óè Borrado de la sincronizaci√≥n, con enc√≥ders incrementales

Soluci√≥n

‚óè Comprobar el cable del enc√≥der
‚óè Guardar los datos t√©cnicos del enc√≥der
‚óè La vigilancia puede desactivarse de forma provisional con la interfaz de
parametrizaci√≥n bajo la responsabilidad del operador.
‚óè Guardar los datos t√©cnicos del m√≥dulo

6646

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
N.¬∫

Significado

145

Error de telegrama del enc√≥der absoluto
Causa

Alarma de diag‚Äê
n√≥stico
s√≠

El tr√°fico de telegramas entre el m√≥dulo y el enc√≥der absoluto (SSI) tiene
errores o est√° interrumpido:
‚óè El cable del enc√≥der no est√° enchufado o est√° cortado
‚óè Tipo de enc√≥der err√≥neo
‚óè Enc√≥der mal configurado (enc√≥ders programables)
‚óè Longitud de telegrama mal indicada
‚óè El enc√≥der proporciona valores err√≥neos (enc√≥der defectuoso)
‚óè Interferencia en el cable del sistema de medici√≥n
‚óè Velocidad de transferencia escogida demasiado alta

Efectos

‚óè El procesamiento de levas se desactiva
‚óè Desactivaci√≥n de las salidas de pista
‚óè el √∫ltimo valor real correcto se mantiene sin cambios hasta el final de la
siguiente transferencia SSI correcta

Soluci√≥n

‚óè Comprobar el cable del enc√≥der
‚óè Comprobar el enc√≥der
‚óè Comprobar el tr√°fico de telegramas entre el enc√≥der y el m√≥dulo

146

Impulsos err√≥neos del enc√≥der incremental
Causa

s√≠

‚óè Vigilancia del enc√≥der ha detectado pulsos err√≥neos
‚óè La cantidad de incrementos por vuelta est√° mal introducida
‚óè Enc√≥der averiado: no proporciona la cantidad de pulsos indicada
‚óè Marca cero err√≥nea o no presente
‚óè Interferencias en el cable del enc√≥der

Efectos

‚óè El procesamiento de levas se desactiva
‚óè Desactivaci√≥n de las salidas de pista
‚óè Borrado de la sincronizaci√≥n

Soluci√≥n

‚óè Indicar correctamente el n√∫mero de incrementos/vuelta.
‚óè Comprobar el enc√≥der y su cable
‚óè Cumplir las normas de apantallamiento y de conexi√≥n a tierra
‚óè La vigilancia puede desactivarse de forma provisional con la interfaz de
parametrizaci√≥n bajo la responsabilidad del operador.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6647

Instrucciones
4.2 Instrucciones

FM 355 PID Control
PID_FM
Descripci√≥n de PID_FM
La instrucci√≥n PID_FM permite realizar las siguientes acciones durante el funcionamiento:
‚óè Transmitir par√°metros de operaci√≥n al FM 355
‚óè Transmitir par√°metros de regulaci√≥n al FM 355
‚óè Leer valores del proceso del FM 355
Los par√°metros de operaci√≥n son todos los par√°metros de entrada/salida que se encuentran
en el DB de instancia de la instrucci√≥n entre los par√°metros op_par y cont_par.
Los par√°metros de regulaci√≥n son todos los par√°metros de entrada/salida que se encuentran
en el DB de instancia de la instrucci√≥n despu√©s del par√°metro cont_par.
Los valores del proceso son todos los par√°metros de salida de la instrucci√≥n situados despu√©s
del par√°metro out_par.
Los datos necesarios se depositan en un DB de instancia en la CPU. Para cada canal de
regulaci√≥n utilizado se requiere un DB de instancia. Tras generar un DB de instancia, todos los
par√°metros de entrada/salida tienen asignado el valor FALSE.

Llamada
PID_FM se llama generalmente en el OB 35 de alarma c√≠clica y requiere una marcha de
inicializaci√≥n, que se inicia activando el par√°metro COM_RST = TRUE en el arranque de la
CPU. Es posible realizar una llamada de la instrucci√≥n en el OB de arranque, pero no es
necesario. Tras la marcha de inicializaci√≥n, PID_FM pone el par√°metro COM_RST en FALSE.
Si se utiliza el FM 355 en periferia descentralizada, esto puede requerir varios ciclos de
llamada.
PID_FM debe llamarse en el mismo OB as√≠ como todas las instrucciones restantes que
acceden al mismo FM 355.
Si se efect√∫a una llamada a la instrucci√≥n PID_FM como DB multiinstancia, no se dispone de
interfaz de puesta en servicio. En este caso, los FM 355 se deben poner en servicio a trav√©s
de una tabla de observaci√≥n.

Arranque
En el arranque y en la transici√≥n de STOP a RUN de la CPU, los par√°metros del FM 355 se
sobrescriben con los par√°metros del SDB de la CPU.

Respuesta en caso de error
El par√°metro de salida RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las
instrucciones RDREC y WRREC. RET_VALU puede evaluarse si los par√°metros READ_VAR
y LOAD_PAR no se desactivan.

6648

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
En la llamada de la instrucci√≥n PID_FM puede producirse un error de acceso a la periferia, si
el FM 355 no est√° insertado o si no recibe suministro de tensi√≥n. En ese caso, la CPU pasa a
STOP si no hay ning√∫n OB 122 cargado en la CPU.

Consulte tambi√©n
Funcionamiento de PID_FM (P√°gina 6649)

Funcionamiento de PID_FM
Influencia de los par√°metros LOAD_OP, READ_VAR y LOAD_PAR
En la marcha de inicializaci√≥n, PID_FM lee los par√°metros de los datos del sistema y los
deposita en el DB de instancia. El DB de instancia y los datos del sistema est√°n sincronizados.
La tabla siguiente muestra c√≥mo afectan los par√°metros LOAD_OP, READ_VAR y
LOAD_PAR al funcionamiento de la instrucci√≥n.
Par√°metro

TRUE

FALSE

LOAD_OP

Transferir los par√°metros de operaci√≥n con las ins‚Äê
trucciones WRREC y RDREC.

Transferir los par√°metros de operaci√≥n con accesos
a la periferia directos en el proceso m√∫ltiplex

READ_VAR adopta el estado TRUE

READ_VAR no cambia

Tiempo de operaci√≥n largo

Tiempo de operaci√≥n reducido

Los valores son efectivos tras un ciclo de la CPU o el
FM. Rige el ciclo m√°s largo.

Como m√°ximo se requieren 3 ciclos de la CPU o del
FM para que los valores sean efectivos. Rige el ciclo
m√°s largo

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6649

Instrucciones
4.2 Instrucciones
Par√°metro

TRUE

FALSE

READ_VAR

Transferir valores del proceso con las instrucciones
WRREC y RDREC

Los valores del proceso se transmiten con accesos a
la periferia directos en el proceso m√∫ltiplex

Tiempo de ejecuci√≥n prolongado

Tiempo de ejecuci√≥n reducido

Todos los par√°metros se leen del FM 355

Los siguientes par√°metros no se leen del FM 355
‚óè SP (consigna del FM)
‚óè ER (error de regulaci√≥n)
‚óè DISV (magnitud perturbadora)
‚óè LMN_A
‚óè LMN_B

Los siguientes par√°metros se actualizan en cada lla‚Äê Los siguientes par√°metros se actualizan cada cuatro
llamadas de la instrucci√≥n.
mada de la instrucci√≥n.
‚óè PV (valor real)

‚óè PV (valor real)

‚óè LMN (variable manipulada)

‚óè LMN (variable manipulada)

‚óè Las indicaciones binarias

‚óè Las indicaciones binarias

En el arranque de la CPU PID_FM adopta los siguien‚Äê En el arranque de la CPU, los siguientes valores se
leen de la instrucci√≥n y no del FM:
tes valores del FM 355:
‚óè SP_OP

‚óè SP_OP

‚óè LMN_OP

‚óè LMN_OP

‚óè SP_OP_ON

‚óè SP_OP_ON

‚óè LMNOP_ON

‚óè LMNOP_ON

Si estos valores se han cambiado en la CPU, en el
primer arranque de la CPU se sobrescriben con los
valores del FM 355
LOAD_PAR

Todos los par√°metros de regulaci√≥n se cargan de la
CPU al FM 355. Esta acci√≥n es conveniente si los
par√°metros de regulaci√≥n deben cambiarse con de‚Äê
pendencia de los estados del proceso.

Sin transmisi√≥n de los par√°metros del regulador

Una vez completada de transmisi√≥n de datos, los par√°metros LOAD_OP, READ_VAR y
LOAD_PAR se vuelven a poner a FALSE.

Uso en periferia descentralizada
Si se utiliza el FM 355 en la periferia descentralizada, la transmisi√≥n de datos y la desactivaci√≥n
de los par√°metros puede requerir varios ciclos de llamada.

Particularidades de la transmisi√≥n en el proceso m√∫ltiplex
La multiplexaci√≥n de los datos que se van a transmitir en el acceso al FM 355 con accesos
directos a la periferia se controla con PID_FM. El control de multiplexaci√≥n con PID_FM no
funciona si dos instancias de la instrucci√≥n PID_FM acceden al mismo n√∫mero de canal de un
m√≥dulo. El resultado son par√°metros incorrectos en el FM 355 (p. ej. consigna y variable
manipulada en manual) e indicaciones err√≥neas en los par√°metros de salida de la instrucci√≥n
PID_FM.

6650

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Almacenamiento de los par√°metros en la EEPROM
En la reparametrizaci√≥n controlada por programa (LOAD_PAR, LOAD_OP) del m√≥dulo
regulador con la instrucci√≥n PID_FM, aumenta su tiempo de operaci√≥n. Los nuevos
par√°metros siempre entran en vigor inmediatamente. Los par√°metros del regulador y el
par√°metro de operaci√≥n SP_ER se guardan adem√°s en una memoria no vol√°til (EEPROM).
Tras cada almacenamiento de los par√°metros en la EEPROM, el siguiente se retrasa 30
minutos, ya que la vida √∫til de la EEPROM est√° limitada por el n√∫mero de procesos de
escritura. Tras una recuperaci√≥n de la tensi√≥n de alimentaci√≥n se pueden guardar nuevos
par√°metros de inmediato en la EEPROM. La selecci√≥n de los par√°metros determina si la
reparametrizaci√≥n del m√≥dulo regulador con la instrucci√≥n PID_FM ser√° con o sin
discontinuidad.

Tiempos de ejecuci√≥n de PID_FM
Condiciones marco

Tiempo de ejecuci√≥n en

READ_VAR

LOAD_OP

LOAD_PAR

CPU 314

CPU 414-2DP

FALSE

FALSE

FALSE

0,65 ms

0,077 ms

TRUE

FALSE

FALSE

2,85 ms

2,36 ms

TRUE

TRUE

FALSE

4,56 ms

4,48 ms

FALSE

FALSE

TRUE

3,75 ms

2,59 ms

TRUE

FALSE

TRUE

5,95 ms

5,15 ms

TRUE

TRUE

TRUE

7,66 ms

7,1 ms

Consulte tambi√©n
Descripci√≥n de PID_FM (P√°gina 6648)

Par√°metros de entrada de PID_FM
Tabla 4-296
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

MOD_ADD
R

0.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configura‚Äê
ci√≥n con STEP 7.

CHANNEL

2.0

INT

1

En la entrada "N√∫mero de canal" se parametriza el n√∫mero del canal de regulador
al que se refiere el DB de instancia.

PHASE

4.0

INT

0

Se admiten los valores de 1 a 4.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

El par√°metro PHASE puede interconectarse con el par√°metro de salida PHASE
de las instrucciones TUN_EC o TUN_ES (PID Self-Tuner). En el cuadro de di√°‚Äê
logo "Puesta en servicio" se puede visualizar el estado de fase del PID Self-Tuner
en texto compresible. Este par√°metro es irrelevante para el OP.

6651

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Descripci√≥n de PID_FM (P√°gina 6648)

Par√°metros de salida de PID_FM
Tabla 4-297
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

RET_VALU

6.0

WORD 0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC. RET_VALU puede evaluarse si se notifica un error a trav√©s de
QMOD_F.

out_par

8.0

WORD W#16# El par√°metro out_par no puede ser modificado por el usuario. Identifica el inicio de
3130
los par√°metros de salida que lee el m√≥dulo cuando se activa READ_VAR = TRUE.

SP

10.0

REAL

0.0

En la salida "Consigna" se indica la consigna que act√∫a efectivamente.

PV

14.0

REAL

0.0

En la salida "Valor real" se indica el valor real que act√∫a efectivamente.

ER

18.0

REAL

0.0

En la salida "Error de regulaci√≥n" se indica el error de regulaci√≥n que act√∫a real‚Äê
mente.

DISV

22.0

REAL

0.0

En la salida "Variable perturbadora" se indica la magnitud perturbadora que act√∫a
efectivamente.
Se admiten valores entre -100 y 100 %.

LMN

26.0

REAL

0.0

LMN_A

30.0

REAL

0.0

En la salida "Variable manipulada" se indica la variable manipulada que act√∫a
efectivamente. En el regulador paso a paso sin realimentaci√≥n de posici√≥n ana‚Äê
l√≥gica, en el par√°metro LMN se indica la acci√≥n P + D ilimitada.
Se admiten valores entre -100 y 100 %.
En la salida "Variable manipulada A de la funci√≥n de rango partido / realimenta‚Äê
ci√≥n de posici√≥n" se indica la variable manipulada A de la funci√≥n de rango partido
en el regulador continuo, y la realimentaci√≥n de posici√≥n en el regulador paso a
paso con realimentaci√≥n de posici√≥n anal√≥gica.
La salida LMN_A s√≥lo puede utilizarse para la indicaci√≥n aproximada de una
magnitud manipulada simulada correspondiente. La variable manipulada
LMNRSVAL de la realimentaci√≥n de posici√≥n simulada debe parametrizarse de la
forma correspondiente, y es efectiva al activar LMNRS_ON.
Se admiten valores entre -100 y 100 %.

LMN_B

34.0

REAL

0.0

Para el regulador continuo, en la salida "Variable manipulada B de la funci√≥n de
rango partido" se indica la variable manipulada B de la funci√≥n de rango partido.

QH_ALM

38.0

BOOL

FALSE El valor real o la magnitud regulada se somete a un control de cuatro valores
l√≠mite. En la salida "Alarma de l√≠mite superior disparada" se notifica el rebase del
l√≠mite H_ALM.

QH_WRN

38.1

BOOL

FALSE El valor real o la magnitud regulada se somete a un control de cuatro valores
l√≠mite. En la salida "Advertencia de l√≠mite superior disparada" se notifica el rebase
del l√≠mite H_WRN.

QL_WRN

38.2

BOOL

FALSE El valor real o la magnitud regulada se somete a un control de cuatro valores
l√≠mite. En la salida "Advertencia de l√≠mite inferior disparada" se notifica el rebase
por defecto del l√≠mite L_WRN.

Se admiten valores entre -100 y 100 %.

6652

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

38.3

BOOL

FALSE El valor real o la magnitud regulada se somete a un control de cuatro valores
l√≠mite. En la salida "Alarma de l√≠mite inferior disparada" se notifica el rebase por
defecto del l√≠mite L_ALM.

QLMN_HLM 38.4

BOOL

FALSE La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
En la salida "L√≠mite superior de variable manipulada alcanzado" se notifica el
rebase del l√≠mite superior.

QLMN_LLM

BOOL

FALSE La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La salida "L√≠mite inferior de la variable manipulada alcanzado" indica el rebase por
defecto del l√≠mite inferior.

QL_ALM

Direc‚Äê
ci√≥n

Descripci√≥n

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
38.5

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
QPARA_F

38.6

BOOL

FALSE El m√≥dulo comprueba la validez de los par√°metros. Un error de parametrizaci√≥n
se indica en la salida "Error de parametrizaci√≥n". Este error de parametrizaci√≥n
tambi√©n se puede ver en el cuadro de di√°logo "Online y diagn√≥stico" del m√≥dulo.

QCH_F

38.7

BOOL

FALSE La salida "Error de canal" se activa cuando el canal de regulaci√≥n no puede arrojar
resultados v√°lidos. El error de canal (p. ej. rotura de hilo) tambi√©n se activa con
QPARA_F = 1 o QMOD_F = 1. Si QCH_F = TRUE, la informaci√≥n precisa del error
puede verse en el registro de diagn√≥stico DS1 del m√≥dulo.

QUPRLM

39.0

BOOL

FALSE La consigna se limita en las rampas de subida y bajada. Si la salida "Limitaci√≥n
positiva de rampa de subida de la consigna" est√° activada, se limita la rampa de
subida de la consigna.

QDNRLM

39.1

BOOL

FALSE La consigna se limita en las rampas de subida y bajada. Si la salida "Limitaci√≥n
negativa de rampa de subida de la consigna" est√° activada, se limita la rampa de
bajada de la consigna.

QSP_HLM

39.2

BOOL

FALSE La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. En la salida
"L√≠mite superior de consigna alcanzado" se notifica el rebase del l√≠mite superior.

QSP_LLM

39.3

BOOL

FALSE La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La salida
"L√≠mite inferior de la consigna alcanzado" indica el rebase del l√≠mite inferior.

QLMNUP

39.4

BOOL

FALSE Se trata de la salida "Se√±al alta de variable manipulada".
(S√≥lo en regulador paso a paso o de impulsos)

QLMNDN

39.5

BOOL

FALSE Se trata de la salida "Se√±al baja de variable manipulada".
(S√≥lo en regulador paso a paso o de impulsos)

QID

39.6

BOOL

FALSE QID = TRUE indica que hay una identificaci√≥n en curso (no que est√© activada).
Una vez completada la identificaci√≥n, el resultado puede verse a trav√©s del par√°‚Äê
metro IDSTATUS de la instrucci√≥n CH_DIAG.

QSPOPON

40.0

BOOL

FALSE En la salida "Control manual de consigna activado" se indica si la consigna se
controla con las instrucciones TUN_EC o TUN_ES. Si el bit est√° activado, el valor
SP_OP se aplica como consigna.

QLMNSAFE 40.1

BOOL

FALSE Si la salida "Modo de seguridad" est√° activada, se emite la variable manipulada de
seguridad como variable manipulada.

QLMNO‚Äê
PON

40.2

BOOL

FALSE En la salida "Control manual de variable manipulada activado" se indica si la
variable manipulada se var√≠a con las instrucciones TUN_EC o TUN_ES. Si el bit
est√° activado, el valor LMN_OP se aplica como variable manipulada.

QLMNTRK

40.3

BOOL

FALSE La salida "Modo de seguimiento" indica si la variable manipulada se corrige me‚Äê
diante una entrada anal√≥gica.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6653

Instrucciones
4.2 Instrucciones
Par√°metro

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

40.4

BOOL

FALSE La salida "Manual = 1; Autom√°tico = 0" indica si la variable manipulada adopta la
variable manipulada externa LMN_RE (Manual = 1) o no.

QLMNR_HS 40.5

BOOL

FALSE La salida "Se√±al de tope superior de la realimentaci√≥n de posici√≥n" indica si la
servov√°lvula se encuentra en el tope superior. QLMNR_HS = TRUE significa: La
servov√°lvula se encuentra en el tope superior.

QLMN_RE

Direc‚Äê
ci√≥n

Descripci√≥n

(S√≥lo en regulador paso a paso)
QLMNR_LS

40.6

BOOL

FALSE La salida "Se√±al de tope inferior de la realimentaci√≥n de posici√≥n" indica si la
servov√°lvula se encuentra en el tope inferior. QLMNR_LS = TRUE significa: La
servov√°lvula se encuentra en el tope inferior.

QLMNR_O
N

40.7

BOOL

FALSE La salida "Realimentaci√≥n de posici√≥n activada" indica que est√° activado el modo
de operaci√≥n "Regulador paso a paso con realimentaci√≥n de posici√≥n" o "Regu‚Äê
lador paso a paso sin realimentaci√≥n de posici√≥n".

QFUZZY

41.0

BOOL

FALSE Si el par√°metro de salida QFUZZY =1, el regulador funciona con el algoritmo
difuso.

QSPLEPV

41.1

BOOL

FALSE La salida "Indicaci√≥n del regulador difuso: consigna < valor real" se activa con el
regulador difuso si la consigna es menor que el valor real efectivo.

QSPR

41.2

BOOL

FALSE Si la salida "Modo de rango partido" est√° activada, el regulador continuo trabaja
en modo de rango partido.

QMAN_FC

41.4

BOOL

FALSE La salida "QMAN_FC" se activa en los siguientes casos:

(S√≥lo en regulador paso a paso)

El regulador secundario est√° en modo manual y el regulador piloto se rige por el
valor real del secundario.
La acci√≥n I del regulador piloto se detiene porque la consigna o la magnitud
manipulada del regulador secundario est√°n en el l√≠mite o porque el regulador
secundario se encuentra en modo manual.
QPARA‚Äê
BUB

41.7

BOOL

FALSE El FM activa este par√°metro cuando se han cambiado par√°metros de operaci√≥n
desde un OP. Si READ_VAR = TRUE y el FM activa esta indicaci√≥n, la instrucci√≥n
PID_FM lee los par√°metros SP_OP_ON, LMNOP_ON, SP_OP y LMN_OP del FM
y los deposita en el DB de instancia. La instrucci√≥n adopta as√≠ el estado de ope‚Äê
raci√≥n del FM. Tras el proceso de lectura, el par√°metro adopta el estado FALSE.

QMOD_F

42.0

BOOL

FALSE La instrucci√≥n comprueba si los procesos de escritura y lectura de un registro han
finalizado correctamente. Si se detectan errores, se activa la salida "Error de
m√≥dulo". La causa puede ser: Una direcci√≥n de m√≥dulo incorrecta en el par√°metro
MOD_ADDR, un n√∫mero de canal incorrecto en el par√°metro CHANNEL o un
m√≥dulo defectuoso.

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

6654

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada/salida de PID_FM
Tabla 4-298
Par√°metro

1)

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

Valores predeterminados del m√≥dulo tras la primera llamada del PID_FM con COM_RST = TRUE

COM_RST

44.0

BOOL

FALSE Si el par√°metro es COM_RST = TRUE, la instrucci√≥n PID_FM realiza una marcha
de inicializaci√≥n. En ella se leen del FM los par√°metros del regulador (que son
todos los par√°metros posteriores a cont_par) y se depositan en el DB de instancia.
Adem√°s se comprueba la validez de los par√°metros MOD_ADDR y CHANNEL.
Tras la marcha de inicializaci√≥n, el par√°metro adopta el estado FALSE.

LOAD_OP

44.1

BOOL

FALSE Si el par√°metro de entrada/salida "Cargar par√°metros operativos en el FM 355"
est√° activado, los par√°metros operativos se cargan en el m√≥dulo y el par√°metro de
entrada/salida se desactiva.

READ_VAR

44.2

BOOL

FALSE Si el par√°metro de entrada/salida "Leer variables del FM 355" est√° activado, los
par√°metros de salida se leen del m√≥dulo y el par√°metro de entrada/salida se
desactiva.

LOAD_PAR

44.3

BOOL

FALSE Si el par√°metro de entrada/salida "Cargar par√°metros de regulaci√≥n en el FM 355"
est√° activado, los par√°metros de regulaci√≥n se cargan en el m√≥dulo y el par√°metro
de entrada/salida se desactiva.

op_par

46.0

WORD W#16# El par√°metro op_par no puede ser modificado por el usuario. Identifica el inicio de
31301) los par√°metros de operaci√≥n, que se transfieren al m√≥dulo si se activa LOAD_OP
= TRUE. El final de los par√°metros de operaci√≥n se identifica con cont_par.

SP_RE

48.0

REAL

0.0

En la entrada "Consigna externa" se conecta una consigna externa con el regu‚Äê
lador.

LMN_RE

52.0

REAL

0.0

En la entrada "Variable manipulada externa" se conecta una variable manipulada
externa con el regulador.

SP_OP_ON

56.0

BOOL

FALSE Las instrucciones del PID Self-Tuner tienen acceso al par√°metro de entrada/salida
"Activar control manual de consigna". Si el bit est√° activado, el valor SP_OP se
aplica como consigna.

SAFE_ON

56.1

BOOL

FALSE Si la entrada "Adoptar posici√≥n de seguridad" est√° activada, se aplica un valor de
seguridad como variable manipulada.

Se admiten valores comprendidos entre -100.0 y 100.0 (%).

Nota: El procesamiento de la se√±al de salida con LMNDN_OP, LMNUP_OP y
LMNSOPON en el regulador paso a paso tiene mayor prioridad que la variable
manipulada de seguridad.
LMNOP_ON 56.2

BOOL

FALSE Las instrucciones del PID Self-Tuner tienen acceso al par√°metro de entrada/salida
"Activar control manual de variable manipulada". Si el bit est√° activado, el valor
LMN_OP se aplica como variable manipulada.

LMNTRKO
N

56.3

BOOL

FALSE Si la entrada "Corregir (LMN a trav√©s de EA)" est√° activada, la variable manipulada
se rige por una entrada anal√≥gica (EA).

LMN_REON 56.4

BOOL

FALSE Si la entrada "Aplicar variable manipulada externa" est√° activada, se aplica la
variable manipulada externa LMN_RE como variable manipulada.

LMNRHSR
E

BOOL

FALSE La se√±al "Servov√°lvula en el tope superior" se interconecta a la entrada "Se√±al de
tope superior de la realimentaci√≥n de posici√≥n". LMNRHSRE = TRUE significa: La
servov√°lvula se encuentra en el tope superior.

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

56.5

(S√≥lo en regulador paso a paso)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6655

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

LMNRLSRE 56.6

BOOL

FALSE La se√±al "Servov√°lvula en el tope inferior" se aplica en la entrada "Se√±al de tope
inferior de la realimentaci√≥n de posici√≥n". LMNRLSRE = TRUE significa: La ser‚Äê
vov√°lvula se encuentra en el tope inferior.

LMNSO‚Äê
PON

BOOL

FALSE Las instrucciones del PID Self-Tuner tienen acceso a la entrada "Activar control
manual de se√±al de variable manipulada". Si el bit est√° activado, las se√±ales
LMNUP_OP y LMNDN_OP se aplican como se√±ales de variable manipulada.

(S√≥lo en regulador paso a paso)
56.7

(S√≥lo en regulador paso a paso)
LMNUP_OP 57.0

BOOL

FALSE Las instrucciones del PID Self-Tuner tienen acceso a la entrada "Subir se√±al de
variable manipulada". Si LMNSOPON est√° activado, el valor se adopta como se‚Äê
√±al de variable manipulada en la entrada "Subir se√±al de variable manipulada".

LMNDN_OP 57.1

BOOL

FALSE Las instrucciones del PID Self-Tuner tienen acceso a la entrada "Bajar se√±al de
variable manipulada". Si LMNSOPON est√° activado, el valor se adopta como se‚Äê
√±al de variable manipulada en la entrada "Bajar se√±al de variable manipulada".

(S√≥lo en regulador paso a paso)

(S√≥lo en regulador paso a paso)
LMNRS_ON 57.3

BOOL

FALSE Si no se dispone de una realimentaci√≥n de posici√≥n, puede simularse. La funci√≥n
"Activar simulaci√≥n de la realimentaci√≥n de posici√≥n" se activa en la entrada.
Tambi√©n las instrucciones del PID Self-Tuner tienen acceso a este par√°metro, ya
que para la optimizaci√≥n se requiere como m√≠nimo una variable manipulada si‚Äê
mulada si se ha parametrizado un regulador paso a paso sin realimentaci√≥n de
posici√≥n. El valor simulado se muestra en el par√°metro LMN_A. Al activar la si‚Äê
mulaci√≥n, el valor del par√°metro LMNRSVAL se activa como valor inicial.
ATENCI√ìN: Con el paso del tiempo, la simulaci√≥n difiere cada vez m√°s de la
realimentaci√≥n de posici√≥n real.
(S√≥lo en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

FUZID_ON

57.4

BOOL

FALSE En la entrada "Activar identificaci√≥n de difuso" se activa la identificaci√≥n del algo‚Äê
ritmo difuso.

SP_OP

58.0

REAL

0.0

Las instrucciones del PID Self-Tuner tienen acceso al par√°metro de entrada/salida
"Control manual de consigna". Si el bit SP_OP_ON est√° activado, se aplica el valor
"Control manual de consigna" como consigna.

LMN_OP

62.0

REAL

0.0

Las instrucciones del PID Self-Tuner tienen acceso al par√°metro de entrada/salida
"Control manual de variable manipulada". Si el bit LMNOP_ON est√° activado, el
valor "Control manual de variable manipulada" se aplica como variable manipula‚Äê
da.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

LMNRSVAL

66.0

REAL

0.0

Las instrucciones del PID Self-Tuner tienen acceso a la entrada "Valor inicial de la
realimentaci√≥n de posici√≥n simulada". En ese par√°metro se indica el valor inicial
de la simulaci√≥n.
(S√≥lo en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

cont_par

6656

70.0

WORD W#16# El par√°metro cont_par no puede ser modificado por el usuario. Identifica el inicio
3130 1) de los par√°metros de regulador, que se leen del FM y se depositan en el DB de
instancia si COM_RST = TRUE, y que se transmiten al FM si LOAD_PAR = TRUE
se activa. El final de los par√°metros de regulador es el final del DB de instancia.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

P_SEL

72.0

BOOL

PFDB_SEL

72.1

BOOL

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

TRUE

En el algoritmo PID las acciones PID se pueden conectar y desconectar indivi‚Äê
dualmente. La acci√≥n proporcional est√° conectada si la entrada "Activar acci√≥n P"
est√° activada.

1)

FALSE En el algoritmo PID las acciones P y D se pueden incluir en el lazo de realimen‚Äê
taci√≥n. La acci√≥n proporcional se encuentra en el lazo de realimentaci√≥n si la
entrada "Incluir acci√≥n P en lazo de realimentaci√≥n" est√° activada.

1)

MONER‚Äê
SEL

72.2

D_EL_SEL

74.0

BOOL

FALSE El regulador dispone de un avisador de valor l√≠mite, que puede utilizarse para el
valor real o para el error de regulaci√≥n. Si la entrada "Vigilancia: Valor real = 0,
Error de regulaci√≥n = 1" est√° activada, se vigila el error de regulaci√≥n.

1)

INT

0 1)

El componente D del algoritmo PID puede depositarse en una entrada separada.
√âsta se selecciona en la entrada "Entrada para componente D".
0: Error de regulaci√≥n
1 a 4: Entrada anal√≥gica 1 a 4
17: Valor real negativo, acci√≥n D en el lazo de realimentaci√≥n

SP_HLM

76.0

REAL

100.0
1)

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La entrada
"L√≠mite superior consigna" indica el l√≠mite superior.
SP_HLM > SP_LLM

SP_LLM

80.0

REAL

0.0
1)

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La entrada
"L√≠mite inferior consigna" indica el l√≠mite inferior.
SP_LLM < SP_HLM

H_ALM

84.0

REAL

100.0
1)

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Alarma de l√≠mite superior" indica el l√≠mite m√°s alto.
H_ALM > H_WRN

H_WRN

88.0

REAL

90.0
1)

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Advertencia de l√≠mite superior" indica el segundo l√≠mite
m√°s alto.
Se admiten valores entre H_ALM y L_WRN

L_WRN

92.0

REAL

10.0
1)

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Advertencia de l√≠mite inferior" indica el segundo l√≠mite
m√°s bajo.
Se admiten valores entre H_WRN y L_ALM

L_ALM

96.0

REAL

0.0
1)

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Alarma de l√≠mite superior" indica el l√≠mite m√°s bajo.
L_ALM < L_WRN

HYS

100.0

REAL

1.0
1)

Para evitar oscilaciones de las indicaciones de vigilancia, puede parametrizarse
una hist√©resis en la entrada "Hist√©resis".
HYS ‚â• 0.0

DEADB_W

104.0

REAL

0.0
1)

El error de regulaci√≥n se conduce por una zona muerta. La entrada "Ancho de
zona muerta" determina el tama√±o de la zona muerta.
DEADB_W ‚â• 0.0

GAIN

108.0

REAL

1.0

La entrada "Ganancia proporcional" indica la ganancia del regulador.

1)

TI

112.0

REAL

3000.0
1)

La entrada "Tiempo de integraci√≥n" determina el comportamiento temporal del
integrador. Con TI = 0 el integrador est√° desactivado
TI = 0.0 o bien TI ‚â• 0.5

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6657

Instrucciones
4.2 Instrucciones
Par√°metro

TD

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

116.0

REAL

Ajuste
prede‚Äê
termi‚Äê
nado
0.0
1)

Descripci√≥n

La entrada "Tiempo de acci√≥n derivada" determina el comportamiento temporal
del diferenciador. Con TD = 0 el diferenciador est√° desactivado
TD = 0.0 o bien TD ‚â• 1.0

TM_LAG

120.0

REAL

5.0
1)

El algoritmo de la acci√≥n D contiene un retardo que se puede parametrizar en la
entrada "Tiempo de retardo de la acci√≥n D".
TM_LAG ‚â• 0.5

LMN_SAFE

124.0

REAL

0.0
1)

Para la variable manipulada puede parametrizarse un valor de seguridad en la
entrada "Variable manipulada de seguridad".
Se admiten valores comprendidos entre -100.0 y 100.0 (%)

LMN_HLM

128.0

REAL

100.0
1)

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite superior de la variable manipulada" indica el l√≠mite superior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores comprendidos entre LMN_LLM y 100.0 (%)

LMN_LLM

132.0

REAL

0.0
1)

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite inferior de la variable manipulada" indica el l√≠mite inferior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores entre -100.0 y LMN_HLM (%)

MTR_TM

136.0

REAL

60.0
1)

En el par√°metro "Tiempo de posicionamiento del motor" se introduce el tiempo de
operaci√≥n de la servov√°lvula de un tope al otro.
(S√≥lo en regulador paso a paso)
Se admiten valores de MTR_TM ‚â• 0.001

PULSE_TM

140.0

REAL

0.2
1)

En el par√°metro "Duraci√≥n m√≠nima de impulso" se puede parametrizar una dura‚Äê
ci√≥n de impulso m√≠nima.
(S√≥lo en regulador paso a paso o de impulsos)
Se admiten valores PULSE_TM ‚â• 0.0

BREAK_TM

144.0

REAL

0.2
1)

En el par√°metro "Duraci√≥n m√≠nima de pausa" se puede parametrizar una duraci√≥n
de pausa m√≠nima.
(S√≥lo en regulador paso a paso o de impulsos)
Se admiten valores BREAK_TM ‚â• 0.0

Nota
Con LOAD_PAR = TRUE todos los par√°metros del regulador se cargan de forma permanente
en la EEPROM del FM 355.
Con LOAD_OP = TRUE, de los par√°metros operativos s√≥lo la consigna SP_RE se carga
permanentemente en la EEPROM del FM 355. A todos los par√°metros operativos restantes se
les asignan los valores 0 o FALSE en el arranque del FM 355.
La EEPROM del m√≥dulo podr√≠a quedar destruida por un n√∫mero excesivo de procesos de
escritura. Para evitarlo, tras la escritura de la EEPROM el m√≥dulo retrasa una nueva escritura
30 minutos.

6658

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Descripci√≥n de PID_FM (P√°gina 6648)

Diagramas de bloques de PID_FM
Sinopsis
En las siguientes figuras se representan los puntos en los que son efectivos los par√°metros de
la instrucci√≥n PID_FM.
Los par√°metros son efectivos en los mismos puntos en los reguladores de tres componentes,
de relaci√≥n, mixtos, de valor fijo o cascada. Esto tambi√©n rige para los par√°metros que est√°n
presentes por igual en el regulador continuo, en el regulador con salida de impulsos y en el
regulador paso a paso. Por ello no se representan todos los diagramas de bloques, y no todos
los par√°metros est√°n incluidos en todos los diagramas.
Sin embargo, todos los par√°metros de la instrucci√≥n PID_FM est√°n contenidos en los
diagramas, excepto los par√°metros MOD_ADDR, CHANNEL, QMOD_F, QPARA_F, QCH_F,
QLMNR_ON, RET_VALU, COM_RST, LOAD_PAR, READ_VAR, LOAD_OP.

Efecto de los par√°metros de entrada
C√°lculo del error de regulaci√≥n en el regulador de valor fijo o cascada
63B+/0
63B//0

63B23

63B5(
&RQVLJQD

&RQPXWDU
FRQVLJDGH
VHJXULGDG

5DPSD

&RQVLJQD
HIHFWLYD

/LPLWDU

(UURUGH
UHJXODFL¬µQ

63B23B21
021(56(/

9DORUUHDO$

+B$/0
+B:51
/B:51
/B$/0
$ODUPD
+<6

9DORUUHDO
HIHFWLYR
(QWUDGD'
'B(/B6(/

0DJQLWXGSHUWXUEDGRUD

Diagrama de bloques del algoritmo de regulaci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6659

Instrucciones
4.2 Instrucciones
)8=,'B21

&RQVLJQDHIHFWLYD
9DORUUHDOHIHFWLYR

5HJXODGRUGH
WHPSHUDWXUD
*$,1 70B/$*
3B6(/
7,
3)'%B6(/
7'

'($'%B:
(UURUGH
UHJXODFL¬µQ

9DORUPDQLSXODGRHIHFWLYR

=RQDPXHUWD

(QWUDGD'

6HJXLPLHQWRGHYDORUPDQLSXODGR

0DJQLWXGSHUWXUEDGRUD

Salida de regulador del regulador K
/01B5(
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

/01B5(21

/0123B21
/01B23

&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

6$)(B21
/01B6$)(

/01B+/0
/01B//0

/0175.21

&RQPXWDU
VHJXLPLHQWR

&RQPXWDU
/LPLWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

9DORU
PDQLSXODGR

9DORUPDQLSXODGR$

5DQJRSDUWLGR

9DORUPDQLSXODGR%

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORU
PDQLSXODGR

Salida de regulador del regulador S (modo de operaci√≥n Regulador de impulsos)

6660

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
9DORU
PDQLSXODGR
H[WHUQR
&RQPXWDU
9DORU
PDQLSXODGR YDORU
PDQLSXODGR
HIHFWLYR
H[WHUQR

9DORU
PDQLSXODGR
&RQPXWDU
VHJXLPLHQWR

/LPLWDU
&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

38/6(B70
%5($.B70

5DQJRSDUWLGR
IRUPDGRUGH
LPSXOVRV

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORUPDQLSXODGR

Salida de regulador del regulador S (modo de operaci√≥n Regulador paso a paso con
realimentaci√≥n de posici√≥n)
9DORU
PDQLSXODGR
H[WHUQR
&RQPXWDU
9DORU
PDQLSXODGR YDORU
PDQLSXODGR
HIHFWLYR
H[WHUQR

9DORU
PDQLSXODGR
&RQPXWDU
VHJXLPLHQWR

/LPLWDU
&RQPXWDU
YDORUPDQLSX
ODGRGH
VHJXULGDG

(QWUDGDGHVHJXLPLHQWR

075B70
38/6(B70
%5($.B70

)RUPD
GRUGH
LPSXO
VRV

6HJXLPLHQWRGHYDORUPDQLSXODGR

(QWUDGDGHUHVSXHVWDGHSRVLFL¬µQ

Salida de regulador del regulador S (modo de operaci√≥n Regulador paso a paso sin
realimentaci√≥n de posici√≥n)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6661

Instrucciones
4.2 Instrucciones
/01'1B23
/0183B23
/0162321
/0156B21
075B70
38/6(B70
%5($.B70
/01569$/

9DORUPDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

6H¬≥DOGHVDOLGD
$OWR

%DMD
&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

)RUPDGRUGH
LPSXOVRV

&RQPXWDUYDORU
PDQLSXODGRGH
VHJXULGDG

/015+65(
/015/65(

Generaci√≥n de los par√°metros de salida
En las siguientes figuras se representan los puntos del m√≥dulo en los que se generan los
par√°metros de salida de la instrucci√≥n PID_FM.
C√°lculo del error de regulaci√≥n en el regulador de valor fijo o cascada
4835/0
4'15/0

63B23

63B5(
&RQVLJQD

&RQPXWDU
FRQVLJDGH
VHJXULGDG

5DPSD

463+/0
463//0

/LPLWDU

&RQVLJQD
HIHFWLYD

63
(5

(UURUGH
UHJXODFL¬µQ

39
4632321
$ODUPD

4+B$/0
4+B:51
4/B:51
4/B$/0

9DORUUHDO
HIHFWLYR

9DORUUHDO$

(QWUDGD'

',69
0DJQLWXGSHUWXUEDGRUD

Diagrama de bloques del algoritmo de regulaci√≥n

6662

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
463/(39

&RQVLJQDHIHFWLYD
9DORUUHDOHIHFWLYR

4)8==<

5HJXODGRUGH
WHPSHUDWXUD

9DORUPDQLSXODGRHIHFWLYR

3,'

(UURUGH
UHJXODFL¬µQ

=RQDPXHUWD

(QWUDGD'

6HJXLPLHQWRGHYDORU
PDQLSXODGR

0DJQLWXGSHUWXUEDGRUD

Salida de regulador del regulador K
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

4/012321

4/015(

/01B23
&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

4/01B+/0
4/016$)( 4/01B//0 /01
4635
9DORU
PDQLSXODGR

4/0175.

&RQPXWDU
VHJXLPLHQWR

&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

/LPLWDU

5DQJRSDUWLGR

/01B$
9DORUPDQLSXODGR$
/01B%
9DORUPDQLSXODGR%

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORUPDQLSXODGR

Salida de regulador del regulador S (modo de operaci√≥n Regulador de impulsos)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6663

Instrucciones
4.2 Instrucciones
/01B5(
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

/01B5(21

/0123B21
/01B23

&RQPXWDU
YDORU
PDQLSXODGR /0175.21
H[WHUQR
&RQPXWDU
VHJXLPLHQWR

6$)(B21
/01B6$)(

/01B+/0
/01B//0

9DORU
PDQLSXODGR

/LPLWDU
&RQPXWDU
YDORU
PDQLSXODGRGH
VHJXULGDG

38/6(B70
%5($.B70
5DQJRSDUWLGR
IRUPDGRUGH
LPSXOVRV

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORUPDQLSXODGR

Salida de regulador del regulador S (modo de operaci√≥n Regulador paso a paso con
realimentaci√≥n de posici√≥n)
/01B5(

/01B5(21

9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

/0123B21
/01B23

&RQPXWDU
YDORU
PDQLSX
ODGR
H[WHUQR

6$)(B21
/01B6$)(

/01B+/0
/01B//0

9DORU
PDQLSXODGR

075B70
38/6(B70
%5($.B70

/0175.21

&RQPXWDU
VHJXLPLHQWR

/LPLWDU
&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

)RUPDGRU
GH
LPSXOVRV

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORUPDQLSXODGR

(QWUDGDGHUHVSXHVWDGHSRVLFL¬µQ

Salida de regulador del regulador S (modo de operaci√≥n Regulador paso a paso sin
realimentaci√≥n de posici√≥n)

6664

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
4/015+6
4/015/6
9DORUPDQLSXODGR
H[WHUQR

4/0183
4/01'1

9DORU
PDQLSXODGR
HIHFWLYR

&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

)RUPDGRU
GH
LPSXOVRV

Consulte tambi√©n
Descripci√≥n de PID_FM (P√°gina 6648)

FUZ_355
Descripci√≥n de FUZ_355
La instrucci√≥n FUZ_355 permite leer y escribir par√°metros de regulador del regulador de
temperatura difuso del FM 355.
Esta funci√≥n es id√≥nea para las siguientes aplicaciones:
‚óè Transmisi√≥n al FM 355 de los par√°metros de regulador determinados por identificaci√≥n tras
un cambio de m√≥dulo
‚óè Adaptaci√≥n del FM 355 a diferentes procesos de regulaci√≥n
Nota
Los par√°metros determinados por el FM 355 mediante una identificaci√≥n no se pueden
cambiar, ya que est√°n optimizados para el proceso de regulaci√≥n.

Funcionamiento
Con los par√°metros READ_PAR y LOAD_PAR se controla el funcionamiento de la instrucci√≥n
FUZ_355.
Si READ_PAR = TRUE, FUZ_355 lee los par√°metros de todos los reguladores de temperatura
del FM 355 y los deposita en el DB de instancia. Una vez que la lectura de los par√°metros del
regulador de temperatura se ha completado correctamente, FUZ_355 pone el par√°metro
READ_PAR en FALSE.
Si LOAD_PAR = TRUE, FUZ_355 escribe los par√°metros de todos los reguladores de
temperatura del FM 355 del DB de instancia en el FM 355. Una vez que la transferencia de los
par√°metros se ha completado correctamente, FUZ_355 pone el par√°metro LOAD_PAR en
FALSE.

Llamada
FUZ_355 no requiere una marcha de inicializaci√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6665

Instrucciones
4.2 Instrucciones
Si se utiliza el FM 355 en la periferia descentralizada, pueden ser necesarios varios ciclos de
llamada hasta que los par√°metros READ_PAR y LOAD_PAR vuelvan a adoptar el estado
FALSE. Por ello, llame la instrucci√≥n FUZ_355 de forma limitada mientras READ_PAR = TRUE
o LOAD_PAR = TRUE.
FUZ_355 debe llamarse en el mismo OB que todas las instrucciones restantes que acceden al
mismo FM 355.

Arranque
En el arranque de la CPU se debe activar el par√°metro LOAD_PAR de la instrucci√≥n FUZ_355,
y a continuaci√≥n llamar el bloque en el programa c√≠clico mientras LOAD_PAR = TRUE.

Par√°metros de entrada de FUZ_355
Tabla 4-299
Par√°metro

MOD_ADD
R

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

0.0

INT

256

Descripci√≥n

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

Par√°metros de salida de FUZ_355
Tabla 4-300
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

RET_VALU

2.0

WORD

0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC. RET_VALU puede evaluarse si se notifica un error a trav√©s de
QMOD_F.

PARAFFUZ

4.0

WORD

0

En el par√°metro PARAFFUZ, un error de parametrizaci√≥n generado por la instruc‚Äê
ci√≥n FUZ_355 se indica de la siguiente manera:
High Byte de PARAFFUZ = 01: Se ha producido un error de parametrizaci√≥n.
High Byte de PARAFFUZ = 00: No se ha producido ning√∫n error de parametriza‚Äê
ci√≥n.
En el Low Byte se indica el offset del par√°metro que ha causado el error de para‚Äê
metrizaci√≥n, contado a partir de la variable est√°tica FUZ_PAR[1].
PARAFFUZ = W#16#0104 significa p. ej. que el segundo par√°metro es err√≥neo

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

6666

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada/salida de FUZ_355
Tabla 4-301
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

READ_PAR

6.0

BOOL

FAL‚Äê
SE

Si el par√°metro READ_PAR se activa, se leen los par√°metros difusos del m√≥dulo
y se depositan en variables est√°ticas del DB de instancia.

LOAD_PAR

6.1

BOOL

FAL‚Äê
SE

Si el par√°metro LOAD_PAR se activa, se leen los par√°metros difusos de las va‚Äê
riables est√°ticas del DB de instancia y se transfieren al m√≥dulo.

FORCE355
Descripci√≥n de FORCE355
La instrucci√≥n FORCE355 permite simular (forzar) los valores de entrada anal√≥gicos y
digitales para facilitar la puesta en marcha.

Simulaci√≥n de los valores digitales
La simulaci√≥n de los valores para las entradas digitales uno a ocho se activa a trav√©s de los
conmutadores S_DION[ i ], donde 1 ‚â§ i ‚â§ 8. Los valores de simulaci√≥n se predeterminan a
trav√©s de los par√°metros DI_SIM[ i ]. Si S_DION[i] = TRUE, en lugar del valor de la entrada
digital i del m√≥dulo se utiliza el valor DI_SIM[i]. Los LEDs I1 a I8 muestran siempre el estado
de la entrada digital correspondiente, incluso durante la simulaci√≥n.

Simulaci√≥n de los valores anal√≥gicos
La simulaci√≥n de los valores anal√≥gicos para los canales uno a cuatro se activa a trav√©s de los
conmutadores S_AION[ i ] o S_PVON[ i ], donde 1 ‚â§ i ‚â§ 4.
Los valores de simulaci√≥n para los canales uno a cuatro se predeterminan a trav√©s de los
par√°metros PV_SIM[ i ].
Los valores de simulaci√≥n pueden hacerse efectivos en dos puntos:
‚óè S_AION[ i ] = TRUE (1 ‚â§ i ‚â§ 4)
En lugar del valor de la entrada anal√≥gica i del m√≥dulo se utiliza el valor PV_SIM[ i ].
‚óè S_PVON[ i ] = TRUE (1 ‚â§ i ‚â§ 4)
En lugar del valor acondicionado de la entrada anal√≥gica i del m√≥dulo se utiliza el valor
PV_SIM[ i ].
La siguiente figura muestra en qu√© punto es efectivo el valor anal√≥gico simulado.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6667

Instrucciones
4.2 Instrucciones
9DORUGHVLPXODFL¬µQ
39B6,0>L@

‡∏∑L‡∏∑

$FWLYDU
VLPXODFL¬µQ
6B$,21>L@

$FWLYDU
VLPXODFL¬µQ
6B3921>L@

7LSRGH
VHQVRU
$

'
)LOWUR

5D¬Ø]
FXDGUDGD

(QWUDGDGH
UHIHUHQFLD

/¬ØQHD
SROLJRQDO

1RUPDOL]DU

9DORU
DQDO¬µJLFR
SUHSDUDGR

$FWLYDUVLPXODFL¬µQ
6B',21>L@
9DORUGHVLPXODFL¬µQ
',B6,0>L@

SDUDPHWUL
]DGR





(QWUDGDGLJLWDO

9DORUGLJLWDO

La conexi√≥n y la preasignaci√≥n de los valores de simulaci√≥n (forzado) no se realizan a trav√©s
de la interfaz de parametrizaci√≥n. Por ello, los conmutadores y las l√≠neas de conexi√≥n
correspondientes se representan rayados.

Llamada
FORCE355 no requiere una marcha de inicializaci√≥n y normalmente se llama c√≠clicamente.
FORCE355 debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 355.

Comportamiento en arranque
En caso de rearranque del FM 355 tras Power OFF, los conmutadores de simulaci√≥n del FM
355 vuelven a estar en FALSE.

Par√°metros de entrada del FORCE355
Tabla 4-302
Par√°metro

Direc‚Äê
ci√≥n

Tipo de datos

Ajuste
prede‚Äê
termi‚Äê
nado

S_AION

0.0

ARRAY [1..4]
of BOOL

FAL‚Äê
SE

Si p. ej. el conmutador S_AION[1] adopta el estado TRUE, en lugar del valor
de entrada anal√≥gica 1 del m√≥dulo se utiliza el valor PV_SIM[1].

S_PVON

2.0

ARRAY [1..4]
of BOOL

FAL‚Äê
SE

Si p. ej. el selector S_PVON[1] adopta el estado TRUE, en lugar del valor
acondicionado de entrada anal√≥gica 1 del m√≥dulo se utiliza el valor
PV_SIM[1].

6668

Descripci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

PV_SIM

Direc‚Äê
ci√≥n

Tipo de datos

Ajuste
prede‚Äê
termi‚Äê
nado

4.0

ARRAY [1..4]
of REAL

0.0

Descripci√≥n

En la entrada PV_SIM[1] se predetermina p. ej., el valor de simulaci√≥n para
la entrada anal√≥gica 1. Si S_PVON = TRUE, entonces se especifica aqu√≠ el
valor acondicionado de entrada anal√≥gica. Si S_PVON = FALSE y S_AION
= TRUE, entonces se especifica aqu√≠ el valor de entrada anal√≥gica en mA
o mV, que se convierte en un valor acondicionado mediante funciones de
acondicionamiento.
Se admiten valores entre 0.0 y 20.0 [mA], -1500 a +10000 [mV] o un rango
de valores t√©cnico

S_DION

20.0

ARRAY [1..8]
of BOOL

FAL‚Äê
SE

Si p. ej. S_DION[1] se pone en TRUE, en lugar de la entrada digital 1 del
m√≥dulo se utiliza el valor DI_SIM[1] como valor digital.

DI_SIM

22.0

ARRAY [1..8]
of BOOL

FAL‚Äê
SE

Valor de simulaci√≥n para entrada digital

MOD_ADD
R

24.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la con‚Äê
figuraci√≥n con STEP 7.

Par√°metros de salida de FORCE355
Tabla 4-303
Par√°metro

RET_VALU

Direc‚Äê
ci√≥n

26.0

Tipo
Ajuste
de da‚Äê prede‚Äê
tos
termi‚Äê
nado
WOR
D

Descripci√≥n

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC. RET_VALU puede evaluarse si se notifica un error a trav√©s de
QMOD_F.

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

READ_355
Descripci√≥n de READ_355
La instrucci√≥n READ_355 permite leer los valores de entrada digital y anal√≥gicos para ayudar
en la puesta en marcha.
Se visualizan los valores siguientes.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6669

Instrucciones
4.2 Instrucciones
',$*>L@39B3+<

‡∏∑L‡∏∑

',$*>L@39B3(5

7LSRGH
VHQVRU
$

'
)LOWUR

(QWUDGDGH
UHIHUHQFLD

5D¬Ø]
FXDGUDGD

/¬ØQHD
SROLJRQDO

1RUPDOL]DU

9DORU
DQDO¬µJLFR
SUHSDUDGR

&-B7(03

7HPSHUDWXUDGH
XQL¬µQIU¬ØD

SDUDPHWUL
]DGR

Llamada
READ_355 no requiere una marcha de inicializaci√≥n y normalmente se llama c√≠clicamente.
READ_355 debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 355.

Par√°metros de entrada de READ_355
Tabla 4-304
Par√°metro

MOD_ADD
R

6670

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

0.0

INT

256

Descripci√≥n

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de salida de READ_355
Tabla 4-305
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

CJ_TEMP

2.0

REAL

0.0

En el par√°metro CJ_TEMP est√° depositada la temperatura medida en la uni√≥n fr√≠a
en grados ¬∞C o ¬∞F (dependiendo de la unidad de temperatura parametrizada). Si no
se ha parametrizado ning√∫n tipo de sensor "Termopar" o si en todas las entradas
anal√≥gicas se ha seleccionado la temperatura parametrizada para la uni√≥n fr√≠a, en
el par√°metro CJ_TEMP se muestra 0.0.

STAT_DI

6.0

ARRA
Y [1..8]
of
BOOL

FAL‚Äê
SE

En los par√°metros STAT_DI[1] a STAT_DI[8] se muestran los estados reales de las
entradas digitales 1 a 8, aunque sean simuladas.

DIAG[x].PV
_PER

(N√∫‚Äê
mero
de ca‚Äê
nal)
x8

ARRA
Y [1..4]
of
STRU
CT

0.0

En los par√°metros DIAG[1].PV_PER a DIAG[4].PV_PER se muestra el valor de las
entradas anal√≥gicas uno a cuatro en la unidad mA o mV. Si se ha activado la
simulaci√≥n del valor de entrada anal√≥gico a trav√©s de la instrucci√≥n FORCE355, se
muestra el valor simulado.

DIAG[x].PV
_PHY

(N√∫‚Äê
mero
de ca‚Äê
nal)
x8+4

ARRA
Y [1..4]
of
STRU
CT

0.0

En los par√°metros DIAG[1].PV_PHY a DIAG[4].PV_PHY se muestra el valor acon‚Äê
dicionado de entrada anal√≥gica uno a cuatro en unidad f√≠sica. Si se ha activado la
simulaci√≥n del valor anal√≥gico f√≠sico acondicionado mediante la instrucci√≥n FOR‚Äê
CE355, se muestra el valor simulado.

RET_VALU

40.0

WORD

0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC. RET_VALU puede evaluarse si se notifica un error a trav√©s de
QMOD_F.

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

CH_DIAG
Descripci√≥n de CH_DIAG
La instrucci√≥n CH_DIAG permite leer del m√≥dulo variables de diagn√≥stico adicionales
espec√≠ficas de canal.

Llamada
CH_DIAG no requiere una marcha de inicializaci√≥n y normalmente se llama c√≠clicamente.
CH_DIAG debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 355.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6671

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de CH_DIAG
Tabla 4-306
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

MOD_ADD
R

0.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

CHANNEL

2.0

INT

1

En la entrada "N√∫mero de canal" se parametriza el n√∫mero del canal de regulador
al que se refiere el DB de instancia.
Se admiten los valores 1 a 4.

Consulte tambi√©n
Descripci√≥n de CH_DIAG (P√°gina 6671)
Par√°metros de salida de CH_DIAG (P√°gina 6672)
Par√°metro IDSTATUS (P√°gina 6673)
Diagrama de bloques de CH_DIAG (P√°gina 6674)

Par√°metros de salida de CH_DIAG
Tabla 4-307
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

SP_R

4.0

REAL

0.0

Con el regulador de relaci√≥n ajustado, el par√°metro tiene asignado el valor de
entrada de la consigna.

PV_R

8.0

REAL

0.0

El par√°metro s√≥lo tiene asignado el siguiente valor con el regulador de relaci√≥n
ajustado: (Valor real A - Consigna Offset) / Valor real D

DIF_I

12.0

REAL

0.0

En el par√°metro DIF_I se muestra la magnitud de entrada de la acci√≥n D. Esto
resulta conveniente p. ej. si como magnitud de entrada de la acci√≥n D se ha pa‚Äê
rametrizado una entrada anal√≥gica.

TRACKPER 16.0

REAL

0.0

En el par√°metro TRACKPER se muestra la magnitud de entrada con la que se
corrige la magnitud manipulada si el regulador est√° ajustado para seguimiento de
magnitud manipulada.

IDSTATUS

20.0

WORD

0.0

En AUTOHOTSPOT se muestra el estado de la identificaci√≥n.

LMN_P

22.0

REAL

0.0

En el par√°metro LMN_P se muestra la acci√≥n P de la magnitud manipulada.

LMN_I

26.0

REAL

0.0

En el par√°metro LMN_I se muestra la acci√≥n I de la magnitud manipulada.

LMN_D

30.0

REAL

0.0

En el par√°metro LMN_D se muestra la acci√≥n D de la magnitud manipulada.

RET_VALU

34.0

WORD

0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC. RET_VALU puede evaluarse si se notifica un error a trav√©s de
QMOD_F.

6672

Descripci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

Par√°metro IDSTATUS
El par√°metro IDSTATUS proporciona informaci√≥n sobre el estado de la identificaci√≥n y
contiene los cuatro valores hexadecimales X, A, I y F.

;

$

,

)

 
Valor

Descripci√≥n

X

Irrelevante (siempre 0)

A

N√∫mero de acci√≥n

 

‚óè 0 = modo manual (o bien sin modo de regulaci√≥n);
‚óè 2 = regulaci√≥n;
‚óè 4 = optimizaci√≥n activada (FUZID_ON = true);
‚óè 6 = estado de transici√≥n de modo manual a 2 √≥ 4;
I

Indicaci√≥n "Identificaci√≥n en curso" y "Los par√°metros se han determinado pero a√∫n no se han guardado
en la EEPROM"
‚óè 0 = la identificaci√≥n no se ejecuta, no se han determinado nuevos par√°metros
‚óè 1 = la identificaci√≥n est√° en curso, no se han determinado nuevos par√°metros
‚óè 2 = la identificaci√≥n no se ejecuta, se han determinado nuevos par√°metros, pero a√∫n no se han
guardado en la EEPROM
‚óè 3 = la identificaci√≥n est√° en marcha, se han determinado nuevos par√°metros, pero a√∫n no se han
guardado en la EEPROM

F

N√∫mero de error.
‚óè 0 = no hay error
‚óè 4 = salto excesivo del valor real durante la identificaci√≥n
‚óè 5 = relaci√≥n entre tiempo de retardo y constante de tiempo de proceso excesiva o comportamiento del
proceso regulado muy distante del lineal.
‚óè 6 = ca√≠da o subida de temperatura excesiva en el inicio de la identificaci√≥n. El proceso no tiene la calma
necesaria

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6673

Instrucciones
4.2 Instrucciones

Diagrama de bloques de CH_DIAG
Se muestran los siguientes valores de diagn√≥stico del error de regulaci√≥n.
63B5

63

0XOWLSOLFDU

&RQVLJQD

&RQPXWDU
YDORUGH
VHJXULGDG

5DPSD

&RQVLJQD
HIHFWLYD

/LPLWDU
QRUPDOL]DU

9DORUUHDO'

(UURUGH
UHJXODFL¬µQ

39B'

$ODUPD
9DORUUHDO$

9DORUUHDO
HIHFWLYR

',)B,
39

(QWUDGD'

0DJQLWXGSHUWXUEDGRUD

Se muestran los siguientes valores del algoritmo de regulaci√≥n.

6674

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
,'67$786

&RQVLJQDHIHFWLYD
9DORUUHDOHIHFWLYR

5HJXODGRUGH
WHPSHUDWXUD

9DORUPDQLSX
ODGRHIHFWLYR

/01B3
/01B,
/01B'
3,'
(UURUGH
UHJXODFL¬µQ

=RQDPXHUWD

(QWUDGD'

6HJXLPLHQWRGHYDORUPDQLSXODGR

0DJQLWXGSHUWXUEDGRUD

Se muestran los siguientes valores del regulador K o S.
9DORU
PDQLSXODGR
H[WHUQR
9DORU
&RQPXWDU
PDQLSXODGR YDORUPDQLSX
HIHFWLYR
ODGRH[WHUQR

9DORU
PDQLSXODGR
&RQPXWDU
&RQPXWDUYDORU /LPLWDU
VHJXLPLHQWR PDQLSXODGRGH
VHJXULGDG
75$&.3(5

(QWUDGDGHVHJXLPLHQWR

5DQJRSDUWLGR

9DORU
PDQLSXODGR$

9DORUPDQLSX
ODGR%

6HJXLPLHQWRGHYDORUPDQLSXODGR

PID_PAR
Descripci√≥n de PID_PAR
La instrucci√≥n PID_PAR permite modificar par√°metros online que no pueden predeterminarse
con la instrucci√≥n PID_FM. Los par√°metros modificables pueden verse en la tabla Par√°metros
modificables (P√°gina 6678).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6675

Instrucciones
4.2 Instrucciones

Llamada
PID_PAR requiere una marcha de inicializaci√≥n. Se inicia autom√°ticamente si la instrucci√≥n
PID_PAR a√∫n no ha le√≠do ninguna vez los datos del sistema (datos preasignados del SDB del
FM355). Tambi√©n es posible iniciar la inicializaci√≥n manualmente con COM_RST=TRUE, cosa
que se suele hacer en el OB 100, ya que despu√©s de STOP-RUN de la CPU los datos de
sistema se transmiten al FM355. El proceso de inicializaci√≥n dura varios ciclos. Durante la
inicializaci√≥n no se transmiten datos a trav√©s de WRREC al FM 355. Tras la inicializaci√≥n, el
bloque desactiva autom√°ticamente el par√°metro COM_RST.
Para reducir el tiempo de funcionamiento, PID_PAR no deber√≠a llamarse c√≠clicamente, sino
s√≥lo cuando fuera necesario cambiar par√°metros. En ese caso, COM_RST debe ser FALSE.
PID_PAR debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 355.
Si se utiliza el FM 355 en periferia descentralizada, pueden ser necesarios varios ciclos hasta
que los par√°metros se hayan transmitido al FM 355. Hasta que la transmisi√≥n no haya
finalizado, el par√°metro BUSY tiene el valor TRUE. PID_PAR deber√≠a llamarse de forma
repetida hasta que BUSY = FALSE y RET_VALU = 0.

Funcionamiento
En el curso de la inicializaci√≥n, PID_PAR lee los par√°metros de los datos de sistema y los
deposita en variables est√°ticas. PID_PAR cambia en cada llamada una de estas variables
REAL y una de las variables INT. En el par√°metro de entrada INDEX_R o INDEX_I indique el
n√∫mero de √≠ndice del par√°metro que desea modificar. Indique los nuevos valores en el
par√°metro de entrada VALUE_R o VALUE_I. PID_PAR transfiere el registro completo con las
variables modificadas al FM 355.
Para cambiar otros par√°metros, llame el mismo DB de instancia varias veces seguidas con
COM_RST = FALSE y con diferentes n√∫meros de √≠ndice.
El par√°metro COM_RST es un par√°metro de entrada que no se desactiva con PID_PAR.
Nota
Recuerde que los par√°metros que ha cambiado con PID_PAR se sobrescriben en el arranque
con los par√°metros de los datos del sistema.

Arranque
En el arranque de la CPU y en la transici√≥n de STOP a RUN de la CPU, los par√°metros del FM
355 se sobrescriben con los par√°metros del SDB de la CPU.

6676

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Ejemplo
Desea cambiar el tiempo de subida de la rampa para la magnitud de referencia durante el
funcionamiento, y adem√°s utilizar diferentes valores de entrada anal√≥gica como valor real
independientemente del estado del proceso.
‚óè En el arranque de la CPU llame PID_PAR con COM_RST = TRUE.
‚óè Para parametrizar el tiempo de subida de la rampa para la referencia a 10.0 llame PID_PAR
durante el funcionamiento con INDEX_R = 30, VALUE_R = 10.0 y INDEX_I = 0.
‚óè Para parametrizar el valor de entrada anal√≥gica 4 del m√≥dulo como valor real, llame
PID_PAR durante el funcionamiento con INDEX_R = 0, INDEX_I = 50 y VALUE_I = 4.

Consulte tambi√©n
Par√°metros modificables (P√°gina 6678)
Par√°metros de entrada de PID_PAR (P√°gina 6677)
Par√°metros de salida de PID_PAR (P√°gina 6678)

Par√°metros de entrada de PID_PAR
Tabla 4-308
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

COM_RST

0.0

BOOL

TRUE

Si el par√°metro es COM_RST = TRUE, la instrucci√≥n PID_PAR realiza una marcha
de inicializaci√≥n. En ella se leen los par√°metros de los datos del sistema de la CPU
y se depositan en el DB de instancia.

MOD_ADD
R

2.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

CHANNEL

4.0

INT

1

En la entrada "N√∫mero de canal" se parametriza el n√∫mero del canal de regulador
al que se refiere el DB de instancia.

INDEX_R

6.0

INT

0.0

Se admiten valores comprendidos entre 1 y 4.
‚óè 0: No se modifica ning√∫n par√°metro REAL
‚óè 1 a 48: Cada valor corresponde a un par√°metro REAL modificable.
VALUE_R

8.0

REAL

0.0

En funci√≥n del par√°metro en cuesti√≥n

INDEX_I

12.0

INT

0.0

‚óè 0: No se modifica ning√∫n par√°metro INT
‚óè 49 a 61: Cada valor corresponde a un par√°metro INT modificable.

VALUE_I

14.0

INT

0.0

En funci√≥n del par√°metro en cuesti√≥n

Consulte tambi√©n
Descripci√≥n de PID_PAR (P√°gina 6675)
Par√°metros de salida de PID_PAR (P√°gina 6678)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6677

Instrucciones
4.2 Instrucciones

Par√°metros de salida de PID_PAR
Tabla 4-309
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

RET_VALU

16.0

WORD

0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC. RET_VALU puede evaluarse si se notifica un error a trav√©s de
QMOD_F.

BUSY

18.0

BOOL

FAL‚Äê
SE

Si BUSY = TRUE, el m√≥dulo a√∫n no ha adoptado los par√°metros (con periferia
descentralizada). En ese caso, la llamada de la instrucci√≥n PID_PAR deber√≠a re‚Äê
petirse en el siguiente ciclo.

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

Par√°metros modificables
Tabla 4-310 Lista de los par√°metros REAL e INT que se pueden modificar con PID_PAR en un FM 355
Tipo de da‚Äê
tos

Descripci√≥n

N√∫mero de √≠ndice

‚Äì

Ning√∫n par√°metro seleccionado

0

REAL

Constante de tiempo de filtro para entrada anal√≥gica

1

REAL

Fin de medici√≥n (100%)

2

REAL

Inicio de medici√≥n (0%)

3

REAL

L√≠nea poligonal, valor de interpolaci√≥n 1 lado de entrada

4

REAL

L√≠nea poligonal, valor de interpolaci√≥n 2 lado de entrada

5

REAL

L√≠nea poligonal, valor de interpolaci√≥n 3 lado de entrada

6

REAL

L√≠nea poligonal, valor de interpolaci√≥n 4 lado de entrada

7

REAL

L√≠nea poligonal, valor de interpolaci√≥n 5 lado de entrada

8

REAL

L√≠nea poligonal, valor de interpolaci√≥n 6 lado de entrada

9

REAL

L√≠nea poligonal, valor de interpolaci√≥n 7 lado de entrada

10

REAL

L√≠nea poligonal, valor de interpolaci√≥n 8 lado de entrada

11

REAL

L√≠nea poligonal, valor de interpolaci√≥n 9 lado de entrada

12

REAL

L√≠nea poligonal, valor de interpolaci√≥n 10 lado de entrada

13

REAL

L√≠nea poligonal, valor de interpolaci√≥n 11 lado de entrada

14

REAL

L√≠nea poligonal, valor de interpolaci√≥n 12 lado de entrada

15

REAL

L√≠nea poligonal, valor de interpolaci√≥n 13 lado de entrada

16

REAL

L√≠nea poligonal, valor de interpolaci√≥n 1 lado de salida

17

REAL

L√≠nea poligonal, valor de interpolaci√≥n 2 lado de salida

18

REAL

L√≠nea poligonal, valor de interpolaci√≥n 3 lado de salida

19

6678

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Tipo de da‚Äê
tos

Descripci√≥n

N√∫mero de √≠ndice

REAL

L√≠nea poligonal, valor de interpolaci√≥n 4 lado de salida

20

REAL

L√≠nea poligonal, valor de interpolaci√≥n 5 lado de salida

21

REAL

L√≠nea poligonal, valor de interpolaci√≥n 6 lado de salida

22

REAL

L√≠nea poligonal, valor de interpolaci√≥n 7 lado de salida

23

REAL

L√≠nea poligonal, valor de interpolaci√≥n 8 lado de salida

24

REAL

L√≠nea poligonal, valor de interpolaci√≥n 9 lado de salida

25

REAL

L√≠nea poligonal, valor de interpolaci√≥n 10 lado de salida

26

REAL

L√≠nea poligonal, valor de interpolaci√≥n 11 lado de salida

27

REAL

L√≠nea poligonal, valor de interpolaci√≥n 12 lado de salida

28

REAL

L√≠nea poligonal, valor de interpolaci√≥n 13 lado de salida

29

REAL

Tiempo de subida de la rampa para referencia

30

REAL

Consigana de seguridad o consigna de seguridad.

31

REAL

Offset de combinaci√≥n de consigna (regulador de relaci√≥n/mixto)

32

REAL

Factor para valor real B (regulador de tres componentes)

33

REAL

Factor para valor real C (regulador de tres componentes)

34

REAL

Offset para combinaci√≥n de valor real (regulador de tres componentes)

35

REAL

Factor para combinaci√≥n de referencia

36

REAL

Punto de operaci√≥n

37

REAL

Agresividad en el regulador difuso

38

REAL

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de entrada A

39

REAL

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de entrada A

40

REAL

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de salida A

41

REAL

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de salida A

42

REAL

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de entrada B

43

REAL

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de entrada B

44

REAL

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de salida B

45

REAL

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de salida B

46

REAL

Duraci√≥n m√≠nima del impulso

47

REAL

Duraci√≥n m√≠nima de pausa

48

INT

Selecci√≥n de la referencia SP o SP_RE para el regulador

49

0: Consigna SP_RE de la instrucci√≥n
1 a 4: Valor de entrada anal√≥gica 1 a 4
17 a 20: Magnitud manipulada (LMN) de regulador 1 a 4
INT

Selecci√≥n de la magnitud reguladora principal valor real A para el regulador

50

0: Valor real A = 0.0
1 a 4: Valor de entrada anal√≥gica 1 a 4
INT

Selecci√≥n de la magnitud reguladora auxiliar valor real B para el regulador

51

0: Valor real B = 0.0
1 a 4: Valor de entrada anal√≥gica 1 a 4
INT

Selecci√≥n de la magnitud reguladora auxiliar valor real C para el regulador

52

0: Valor real C = 0.0
1 a 4: Valor de entrada anal√≥gica 1 a 4

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6679

Instrucciones
4.2 Instrucciones
Tipo de da‚Äê
tos
INT

Descripci√≥n

N√∫mero de √≠ndice

Selecci√≥n de la magnitud reguladora auxiliar valor real D para el regulador

53

0: Valor real D = 0.0
1 a 4: Valor de entrada anal√≥gica 1 a 4
17 a 20: Magnitud manipulada (LMN) de regulador 1 a 4
INT

Selecci√≥n de la magnitud perturbadora DISV para el regulador

54

0: Magnitud perturbadora = 0.0
1 a 4: Valor de entrada anal√≥gica 1 a 4
INT

Selecci√≥n del seguimiento de posici√≥n TRACK_PER para el regulador

55

0: Seguimiento de posici√≥n = 0.0
1 a 4: Valor de entrada anal√≥gica 1 a 4
INT

Selecci√≥n del seguimiento de posici√≥n LMNR_PER para el regulador

56

0: Seguimiento de posici√≥n = 0.0
1 a 4: Valor de entrada anal√≥gica 1 a 4
INT

Selecci√≥n de la se√±al para la conmutaci√≥n al valor de seguridad para la variable mani‚Äê
pulada del regulador

57

0: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro SAFE_ON de la instrucci√≥n
PID_FM
1 a 8: Asignaci√≥n predeterminada con el par√°metro SAFE_ON de la instrucci√≥n PID_FM
predeterminado por la entrada digital 1 a 8
INT

Selecci√≥n de la se√±al para la conmutaci√≥n a la funci√≥n de seguimiento de la variable
manipulada del regulador

58

0: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro LMNTRKON de la instrucci√≥n
PID_FM
1 a 8: Asignaci√≥n predeterminada con el par√°metro LMNTRKON de la instrucci√≥n
PID_FM predeterminado por la entrada digital 1 a 8
INT

Selecci√≥n de la se√±al para la conmutaci√≥n de la variable manipulada del regulador a
LMN_RE

59

0: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro LMN_REON de la instrucci√≥n
PID_FM
1 a 8: Asignaci√≥n predeterminada con el par√°metro LMN_REON de la instrucci√≥n
PID_FM predeterminado por la entrada digital 1 a 8
INT

Selecci√≥n de la se√±al de tope superior de la realimentaci√≥n de posici√≥n

60

0: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro LMNRHSRE de la instrucci√≥n
PID_FM
1 a 8: Asignaci√≥n predeterminada con el par√°metro LMNRHSRE de la instrucci√≥n
PID_FM predeterminado por la entrada digital 1 a 8
INT

Selecci√≥n de la se√±al de tope inferior de la realimentaci√≥n de posici√≥n

61

0: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro LMNRLSRE de la instrucci√≥n
PID_FM
1 a 8: Asignaci√≥n predeterminada con el par√°metro LMNRLSRE de la instrucci√≥n
PID_FM predeterminado por la entrada digital 1 a 8

6680

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Par√°metros de entrada de PID_PAR (P√°gina 6677)
Par√°metros de salida de PID_PAR (P√°gina 6678)

CJ_T_PAR
Descripci√≥n de CJ_T_PAR
La instrucci√≥n CJ_T_PAR permite cambiar online la temperatura de uni√≥n fr√≠a parametrizada.
Esto es necesario si una regulaci√≥n de temperatura debe funcionar con varios FM 355 con
entradas de termopar sin necesidad de conectar un Pt 100 en cada FM 355.

Llamada
CJ_T_PAR requiere una marcha de inicializaci√≥n. Para ello debe llamarse una sola vez en el
arranque de la CPU con el par√°metro COM_RST = TRUE.
Normalmente, CJ_T_PAR se llama c√≠clicamente. Por motivos relacionados con el tiempo de
operaci√≥n, COM_RST deber√≠a tener el valor FALSE. El par√°metro COM_RST es un par√°metro
de entrada que no se desactiva.
CJ_T_PAR debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 355.
Si se utiliza el FM 355 en periferia descentralizada, pueden ser necesarios varios ciclos hasta
que el par√°metro se haya transmitido al FM 355. Hasta que la transmisi√≥n no haya finalizado,
el par√°metro BUSY tiene el valor TRUE. Por ello, al modificar par√°metros debe llamarse la
instrucci√≥n CJ_T_PAR de forma repetida hasta que BUSY = FALSE.

Ejemplo
Si en un regulador de extrusionador con m√°s de cuatro zonas de calentamiento la temperatura
de las uniones fr√≠as se mide con un FM 355, puede leerse con READ_355 en el par√°metro
CJ_TEMP y parametrizarse en los FM 355 restantes con CJ_T_PAR.

Consulte tambi√©n
Par√°metros de entrada de CJ_T_PAR (P√°gina 6682)
Par√°metros de salida de CJ_T_PAR (P√°gina 6682)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6681

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de CJ_T_PAR
Tabla 4-311
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

COM_RST

0.0

BOOL

FAL‚Äê
SE

Si el par√°metro es COM_RST = TRUE, la instrucci√≥n CJ_T_PAR realiza una mar‚Äê
cha de inicializaci√≥n. En ella se leen los par√°metros de los datos del sistema de la
CPU y se depositan en el DB de instancia.

MOD_ADD
R

2.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

CJ_T

4.0

REAL

0.0

En el par√°metro CJ_T se puede predeterminar la temperatura de las uniones fr√≠as.
El rango de valores permitido var√≠a en funci√≥n del tipo de sensor.

Consulte tambi√©n
Descripci√≥n de CJ_T_PAR (P√°gina 6681)
Par√°metros de salida de CJ_T_PAR (P√°gina 6682)

Par√°metros de salida de CJ_T_PAR
Tabla 4-312
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

RET_VALU

8.0

WORD

0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC. RET_VALU puede evaluarse si se notifica un error a trav√©s de
QMOD_F.

BUSY

10.0

BOOL

FAL‚Äê
SE

Si BUSY = TRUE, el m√≥dulo a√∫n no ha adoptado los par√°metros (con periferia
descentralizada). En ese caso, la llamada de la instrucci√≥n PID_PAR deber√≠a re‚Äê
petirse en el siguiente ciclo.

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

6682

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

DB para HMI
Descripci√≥n de DB 101 a 104
Para poder manejar el FM 355 con el OP en caso de fallo de la CPU se requieren los bloques
de datos 101 a 104. Con MPI se pueden establecer hasta tres conexiones desde el FM 355 a
los OPs.
El manejo del FM 355 con el OP s√≥lo es posible en el estado STOP de la CPU en caso de fallo
de la CPU.
El FM 355 siempre se puede observar con el OP.
La interfaz de variables del FM 355 contiene cuatro bloques de datos con los n√∫meros de
bloque 101 a 104 para los canales de regulador 1 a 4 (v√©ase la siguiente figura).
Nota
El contenido de los bloques de datos 101 a 104 no refleja autom√°ticamente el valor de
par√°metro efectivo en el FM 355. Los par√°metros cambiados con ayuda del OP s√≥lo se aplican
en el FM 355 tras haberse activado los bits de operaci√≥n LOAD_PAR o LOAD_OP.
Si se cambia un par√°metro manejando el OP sin activar el bit de operaci√≥n correspondiente,
el valor de par√°metro modificado est√° en el bloque de datos, pero el FM 355 trabaja
internamente con el valor anterior no modificado del par√°metro.
Tras activar los bits de operaci√≥n y aplicar los par√°metros en el FM 355, los bits de operaci√≥n
LOAD_PAR o LOAD_OP son desactivados por el FM 355.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6683

Instrucciones
4.2 Instrucciones

23

0DQHMR\YLVXDOL]DFL¬µQHQ
HVWDGR581GHOD&38

0DQHMRV¬µORHQHVWDGR6723GH
OD&38RHQFDVRGHIDOORGHOD
&38YLVXDOL]DFL¬µQ

&38

)0

'%
KDVWD


)%
3,'B)0

0¬£['%V
GHLQVWDQFLD
GHO)%
3,'B)0




3DU¬£PHWUR

* Controlado por el par√°metro READ_VAR del DB de instancia
** Controlado por los par√°metros LOAD_OP y LOAD_PAR

Consulte tambi√©n
Descripci√≥n de PID_FM (P√°gina 6648)

Par√°metros de entrada de los DB 101 a 104
Tabla 4-313
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

SP_HLM

0.0

REAL

100.0

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La entrada
"L√≠mite superior consigna" indica el l√≠mite superior.

SP_LLM

4.0

REAL

0.0

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La entrada
"L√≠mite inferior consigna" indica el l√≠mite inferior.

SP_HLM > SP_LLM

SP_LLM < SP_HLM

6684

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

H_ALM

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

8.0

REAL

100.0

Descripci√≥n

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Alarma de l√≠mite superior" indica el l√≠mite m√°s alto.
H_ALM > H_WRN

H_WRN

12.0

REAL

90.0

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Advertencia de l√≠mite superior" indica el segundo l√≠mite
m√°s alto.

L_WRN

16.0

REAL

10.0

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Advertencia de l√≠mite inferior" indica el segundo l√≠mite
m√°s bajo.

Se admiten valores entre H_ALM y L_WRN

Se admiten valores entre H_WRN y L_ALM
L_ALM

20.0

REAL

0.0

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Alarma de l√≠mite superior" indica el l√≠mite m√°s bajo.
L_ALM < L_WRN

HYS

24.0

REAL

1.0

Para evitar oscilaciones de las indicaciones de vigilancia, puede parametrizarse
una hist√©resis en la entrada "Hist√©resis".

DEADB_W

28.0

REAL

0.0

El error de regulaci√≥n se conduce por una zona muerta. La entrada "Ancho de zona
muerta" determina el tama√±o de la zona muerta.

GAIN

32.0

REAL

1.0

La entrada "Ganancia proporcional" indica la ganancia del regulador.

TI

36.0

REAL

3000.
0

La entrada "Tiempo de integraci√≥n" determina el comportamiento temporal del
integrador. Con TI = 0 el integrador est√° desactivado.

HYS ‚â• 0.0

DEADB_W ‚â• 0.0

TI = 0.0 o bien TI ‚â• 0.5
TD

40.0

REAL

0.0

La entrada "Tiempo de acci√≥n derivada" determina el comportamiento temporal del
diferenciador. Con TD = 0 el diferenciador est√° desactivado.

TM_LAG

44.0

REAL

5.0

El algoritmo de la acci√≥n D contiene un retardo que se puede parametrizar en la
entrada "Tiempo de retardo de la acci√≥n D".

LMN_SAFE

48.0

REAL

0.0

Para la variable manipulada puede parametrizarse un valor de seguridad en la
entrada "Variable manipulada de seguridad".

LMN_HLM

52.0

REAL

100.0

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite superior de la variable manipulada" indica el l√≠mite superior.

TD = 0.0 o bien TD ‚â• 1.0

TM_LAG ‚â• 0.5

Se admiten valores comprendidos entre -100.0 y 100.0 (%).

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores entre LMN_LLM y 100.0 (%).
LMN_LLM

56.0

REAL

0.0

La variable manipulada est√° limitado siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite inferior de la variable manipulada" indica el l√≠mite inferior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores entre -100.0 y LMN_HLM (%).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6685

Instrucciones
4.2 Instrucciones
Par√°metro

MTR_TM

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

60.0

REAL

60.0

Descripci√≥n

En el par√°metro "Tiempo de posicionamiento del motor" se introduce el tiempo de
operaci√≥n de la servov√°lvula de un tope al otro.
(S√≥lo en regulador paso a paso)
MTR_TM ‚â• 0.001

PULSE_TM

64.0

REAL

0.2

En el par√°metro "Duraci√≥n m√≠nima de impulso" se puede parametrizar una dura‚Äê
ci√≥n de impulso m√≠nima.
(S√≥lo en regulador paso a paso o de impulsos)
PULSE_TM ‚â• 0.0

BREAK_TM

68.0

REAL

0.2

En el par√°metro "Duraci√≥n m√≠nima de pausa" se puede parametrizar una duraci√≥n
de pausa m√≠nima.
(S√≥lo en regulador paso a paso o de impulsos)
BREAK_TM ‚â• 0.0

SP_RE

72.0

REAL

0.0

En la entrada "Consigna externa" se conecta una consigna externa con el regula‚Äê
dor.

LMN_RE

76.0

REAL

0.0

En la entrada "Variable manipulada externo" se conecta una variable manipulada
externa con el regulador.

LMNRSVAL 80.0

REAL

0.0

Desde el cuadro de di√°logo Puesta en marcha se puede acceder a la entrada "Valor
inicial de la realimentaci√≥n de posici√≥n simulada". En ese par√°metro se indica el
valor inicial de la simulaci√≥n.
(S√≥lo en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

SAFE_ON

84.0

BOOL

FAL‚Äê
SE

Si la entrada "Adoptar posici√≥n de seguridad" est√° activada, se aplica un valor de
seguridad como variable manipulada.
Nota: El procesamiento de la se√±al de salida con LMNDN_OP, LMNUP_OP y
LMNSOPON en el regulador paso a paso tiene mayor prioridad que la variable
manipulada de seguridad.

LMNTRKO
N

84.1

BOOL

FAL‚Äê
SE

Si la entrada "Corregir (LMN a trav√©s de EA)" est√° activada, la variable manipulada
se rige por una entrada anal√≥gica (EA).
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

LMN_REON 84.2

BOOL

FAL‚Äê
SE

Si la entrada "Aplicar variable manipulada externa" est√° activada, se aplica la va‚Äê
riable manipulada externo LMN_RE como variable manipulada.

LMNRHSR
E

BOOL

FAL‚Äê
SE

La se√±al "Servov√°lvula en el tope superior" se interconecta a la entrada "Se√±al de
tope superior de la realimentaci√≥n de posici√≥n". LMNRHSRE = TRUE significa: La
servov√°lvula se encuentra en el tope superior.

84.3

(S√≥lo en regulador paso a paso)
LMNRLSRE 84.4

BOOL

FAL‚Äê
SE

LMNSO‚Äê
PON

BOOL

FAL‚Äê
SE

La se√±al "Servov√°lvula en el tope inferior" se interconecta a la entrada "Se√±al de
tope inferior de la realimentaci√≥n de posici√≥n". LMNRLSRE = TRUE significa: La
servov√°lvula se encuentra en el tope inferior.
(S√≥lo en regulador paso a paso)

84.5

Si el bit de la entrada "Activar control manual de se√±al de valor manipulada" est√°
activado, las se√±ales LMNUP_OP y LMNDN_OP se aplican como se√±ales de va‚Äê
riable manipulada.
(S√≥lo en regulador paso a paso)

6686

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

LMNUP_OP 84.6

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

BOOL

FAL‚Äê
SE

Descripci√≥n

Si LMNSOPON est√° activado, el valor se adopta como se√±al de la variable mani‚Äê
pulada en la entrada "Control manual se√±al de variable manipulada alta".
(S√≥lo en el regulador paso a paso)

LMNDN_OP 84.7

BOOL

FAL‚Äê
SE

Si LMNSOPON est√° activado, el valor se adopta como se√±al de variable manipu‚Äê
lada en la entrada "Bajar se√±al de variable manipulada".

MONER‚Äê
SEL

85.0

BOOL

FAL‚Äê
SE

El regulador dispone de un avisador de valor l√≠mite, que puede utilizarse para el
valor real o para el error de regulaci√≥n. Si la entrada "Vigilancia: Valor real = 0, Error
de regulaci√≥n = 1" est√° activada, se vigila el error de regulaci√≥n.

LMNRS_ON 85.1

BOOL

FAL‚Äê
SE

Si no se dispone de una realimentaci√≥n de posici√≥n, puede simularse. La funci√≥n
se activa en la entrada "Activar simulaci√≥n de la realimentaci√≥n de posici√≥n".
ATENCI√ìN: Con el paso del tiempo, la simulaci√≥n difiere cada vez m√°s de la
realimentaci√≥n de posici√≥n real.

(S√≥lo en regulador paso a paso)

(S√≥lo en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
FUZID_ON

85.2

BOOL

FAL‚Äê
SE

En la entrada "Activar identificaci√≥n de difuso" se activa la identificaci√≥n del algo‚Äê
ritmo difuso.

SPINT_EN

85.3

BOOL

FAL‚Äê
SE

La entrada "Entrada de control manual: externo = 0, interno = 1" determina la
entrada que se transfiere como consigna al m√≥dulo.
SPINT_EN = TRUE: se transfiere SP_INT.
SPINT_EN = FALSE: se transfiere SP_RE.

P_SEL

85.4

BOOL

TRUE

En el algoritmo PID las acciones PID se pueden conectar y desconectar individual‚Äê
mente. La acci√≥n proporcional est√° conectada si la entrada "Activar acci√≥n P" est√°
activada.

PFDB_SEL

85.5

BOOL

FAL‚Äê
SE

En el algoritmo PID las acciones P y D se pueden incluir en el lazo de realimenta‚Äê
ci√≥n. La acci√≥n proporcional se encuentra en el lazo de realimentaci√≥n si la entrada
"Incluir acci√≥n P en lazo de realimentaci√≥n" est√° activada.

D_EL_SEL

86.0

INT

0

El componente D del algoritmo PID puede aplicarse en una entrada separada. √âsta
se selecciona en la entrada "Entrada para componente D".
0: Error de regulaci√≥n
1 a 4: Entrada anal√≥gica 1 a 4
17: Valor real negativo

Consulte tambi√©n
Descripci√≥n de PID_FM (P√°gina 6648)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6687

Instrucciones
4.2 Instrucciones

Par√°metros de salida de los DB 101 a 104
Tabla 4-314
Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

SP

94.0

REAL

0.0

En la salida "Consigna" se indica la consigna que act√∫a efectivamente.

PV

98.0

REAL

0.0

En la salida "Valor real" se indica el valor real que act√∫a efectivamente.

ER

102.0

REAL

0.0

En la salida "Error de regulaci√≥n" se indica el error de regulaci√≥n que act√∫a real‚Äê
mente.

DISV

106.0

REAL

0.0

En la salida "Variable perturbadora" se indica la magnitud perturbadora que act√∫a
efectivamente.

Par√°metro

Descripci√≥n

Se admiten valores comprendidos entre -100.0 y 100.0 (%).
LMN

110.0

REAL

0.0

En la salida "Variable manipulada" se indica la variable manipulada que act√∫a
efectivamente. En el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥‚Äê
gica, en el par√°metro LMN se indica la acci√≥n P + D ilimitada.

LMN_A

114.0

REAL

0.0

En la salida "Variable manipulada A de la funci√≥n de rango partido / realimentaci√≥n
de posici√≥n" se indica la variable manipulada A de la funci√≥n de rango partido en el
regulador continuo, y la realimentaci√≥n de posici√≥n en el regulador paso a paso con
realimentaci√≥n de posici√≥n anal√≥gica.

Se admiten valores comprendidos entre -100.0 y 100.0 (%).

En el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica se muestra
la realimentaci√≥n de posici√≥n simulada.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).
LMN_B

118.0

REAL

0.0

Para el regulador continuo, en la salida "Variable manipulada B de la funci√≥n de
rango partido" se indica la variable manipulada B de la funci√≥n de rango partido.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

QH_ALM

122.0

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Alarma de l√≠mite superior disparada" se notifica el rebase del l√≠mite
H_ALM.

QH_WRN

122.1

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Advertencia de l√≠mite superior disparada" se notifica el rebase del
l√≠mite H_WRN.

QL_WRN

122.2

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Advertencia de l√≠mite inferior disparada" se notifica el rebase del l√≠mite
L_WRN.

QL_ALM

122.3

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Alarma de l√≠mite inferior disparada" se notifica el rebase del l√≠mite
L_ALM.

QLMN_HLM 122.4

BOOL

FAL‚Äê
SE

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
En la salida "L√≠mite superior de variable manipulada alcanzado" se notifica el re‚Äê
base del l√≠mite superior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

QLMN_LLM

122.5

BOOL

FAL‚Äê
SE

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La salida "L√≠mite inferior de la variable manipulada alcanzado" indica el rebase por
defecto del l√≠mite inferior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

6688

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

QSPINTON

122.6

BOOL

FAL‚Äê
SE

La salida "Consigna interna activada" indica que SP_INT se ha transferido al m√≥‚Äê
dulo.

QPARA_F

123.0

BOOL

FAL‚Äê
SE

El m√≥dulo comprueba la validez de los par√°metros. Un error de parametrizaci√≥n se
indica en la salida "Error de parametrizaci√≥n". Este error de parametrizaci√≥n tam‚Äê
bi√©n se puede ver en el cuadro de di√°logo "Online y diagn√≥stico" del m√≥dulo.

QCH_F

123.1

BOOL

FAL‚Äê
SE

La salida "Error de canal" se activa cuando el canal de regulaci√≥n no puede arrojar
resultados v√°lidos. El error de canal (p. ej. rotura de hilo) tambi√©n se activa con
QPARA_F = 1 o QMOD_F = 1. Si QCH_F = TRUE, la informaci√≥n precisa del error
puede verse en el registro de diagn√≥stico DS1 del m√≥dulo.

QUPRLM

123.2

BOOL

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada. Si la salida "Limitaci√≥n
positiva de rampa de subida de la consigna" est√° activada, se limita la rampa de
subida de la consigna.

QDNRLM

123.3

BOOL

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada. Si la salida "Limitaci√≥n
negativa de rampa de subida de la consigna" est√° activada, se limita la rampa de
bajada de la consigna.

QSP_HLM

123.4

BOOL

FAL‚Äê
SE

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. En la salida
"L√≠mite superior de consigna alcanzado" se notifica el rebase del l√≠mite superior.

QSP_LLM

123.5

BOOL

FAL‚Äê
SE

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La salida
"L√≠mite inferior de la consigna alcanzado" indica el rebase del l√≠mite inferior.

QSPOPON

123.6

BOOL

FAL‚Äê
SE

En la salida "Control manual de consigna activado" se indica si la consigna se var√≠a
a trav√©s del cuadro de di√°logo "Puesta en marcha". Si el bit est√° activado, el valor
SP_OP se aplica como consigna.

QLMNSAFE 123.7

BOOL

FAL‚Äê
SE

Si la salida "Modo de seguridad" est√° activada, como variable manipulada se emite
la variable manipulada de seguridad.

QLMNO‚Äê
PON

124.0

BOOL

FAL‚Äê
SE

En la salida "Control manual de variable manipulada activado" se indica si la va‚Äê
riable manipulada se controla desde el cuadro de di√°logo "Puesta en servicio". Si
el bit est√° activado, el valor LMN_OP se aplica como variable manipulada.

QLMNTRK

124.1

BOOL

FAL‚Äê
SE

La salida "Modo de seguimiento" indica si la variable manipulada se corrige con una
entrada anal√≥gica.

QLMN_RE

124.2

BOOL

FAL‚Äê
SE

La salida "Manual = 1; Autom√°tico = 0" indica si la variable manipulada adopta la
variable manipulada externo LMN_RE (Manual = 1) o no.

QLMNR_HS 124.3

BOOL

FAL‚Äê
SE

La salida "Se√±al de tope superior de la realimentaci√≥n de posici√≥n" indica si la
servov√°lvula se encuentra en el tope superior. QLMNR_HS = TRUE significa: La
servov√°lvula se encuentra en el tope superior.
(S√≥lo en regulador paso a paso)

QLMNR_LS

124.4

BOOL

FAL‚Äê
SE

La salida "Se√±al de tope inferior de la realimentaci√≥n de posici√≥n" indica si la ser‚Äê
vov√°lvula se encuentra en el tope inferior. QLMNR_LS = TRUE significa: La ser‚Äê
vov√°lvula se encuentra en el tope inferior.

QLMNR_O
N

124.5

BOOL

FAL‚Äê
SE

La salida "Realimentaci√≥n de posici√≥n activada" indica que est√° activado el modo
de operaci√≥n "Regulador paso a paso con realimentaci√≥n de posici√≥n" o "Regula‚Äê
dor paso a paso sin realimentaci√≥n de posici√≥n".

QFUZZY

124.6

BOOL

FAL‚Äê
SE

Si la salida "Algoritmo PID = 0; Difuso = 1" est√° activada, el regulador trabaja con
el algoritmo difuso.

QSPLEPV

124.7

BOOL

FAL‚Äê
SE

La salida "Indicaci√≥n del regulador difuso: consigna < valor real" se activa con el
regulador difuso si la consigna es menor que el valor real efectivo.

(S√≥lo en regulador paso a paso)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6689

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

QSPR

125.0

BOOL

FAL‚Äê
SE

Si la salida "Modo de rango partido" est√° activada, el regulador continuo trabaja en
modo de rango partido.

QLMNUP

125.1

BOOL

FAL‚Äê
SE

Se trata de la salida "Se√±al alta de variable manipulada".

QLMNDN

125.2

BOOL

FAL‚Äê
SE

Se trata de la salida "Se√±al baja de variable manipulada".

QBACKUP

125.4

BOOL

FAL‚Äê
SE

0= no hay estado de copia de seguridad (CPU en RUN)

QID

125.5

BOOL

FAL‚Äê
SE

QID = TRUE indica que hay una identificaci√≥n en curso (no que est√© activada). Una
vez completada la identificaci√≥n, el resultado puede verse a trav√©s del par√°metro
IDSTATUS de la instrucci√≥n CH_DIAG.

QMAN_FC

125.6

BOOL

FAL‚Äê
SE

El regulador es un regulador piloto que, mediante la operaci√≥n manual de un re‚Äê
gulador secundario, se corrige seg√∫n el valor real de este √∫ltimo, o cuya acci√≥n I se
detiene porque la consigna o la magnitud manipulada del regulador secundario
est√°n en el l√≠mite.

RET_VALU

126.0

WORD

0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC. RET_VALU puede evaluarse si se notifica un error a trav√©s de
QMOD_F.

(S√≥lo en regulador paso a paso o de impulsos)
(S√≥lo en regulador paso a paso o de impulsos)
1= estado de copia de seguridad (CPU e STOP o falla)

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)
Descripci√≥n de PID_FM (P√°gina 6648)

Par√°metros de entrada/salida de DB 101 a 104
Tabla 4-315
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

SP_INT

128.0

REAL

0.0

El par√°metro de entrada/salida "Consigna interna" sirve para preseleccionar una
consigna mediante funciones de manejo y visualizaci√≥n.

SP_OP

132.0

REAL

0.0

El cuadro de di√°logo "Puesta en marcha" tiene acceso al par√°metro de entrada/
salida "Control manual de consigna" Si el bit SP_OP_ON est√° activado, se aplica el
valor "Control manual de consigna" como consigna.

LMN_OP

136.0

REAL

0.0

El cuadro de di√°logo "Puesta en servicio" tiene acceso al par√°metro de entrada/
salida "Control manual de variable manipulada" Si el bit LMNOP_ON est√° activado,
el valor "Control manual de variable manipulada" se aplica como variable manipu‚Äê
lada.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

6690

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

SP_OP_ON

140.0

BOOL

FAL‚Äê
SE

El cuadro de di√°logo "Puesta en marcha" tiene acceso al par√°metro de entrada/
salida "Activar control manual de consigna". Si el bit est√° activado, el valor SP_OP
se aplica como consigna.

LMNOP_O
N

140.1

BOOL

FAL‚Äê
SE

El cuadro de di√°logo "Puesta en marcha" tiene acceso al par√°metro de entrada/
salida "Activar control manual de variable manipulada" Si el bit est√° activado, el
valor LMN_OP se aplica como variable manipulada.

LOAD_PAR

140.2

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida "Cargar par√°metros de regulaci√≥n en el FM 355"
est√° activado, los par√°metros de regulaci√≥n se cargan en el m√≥dulo y el par√°metro
de entrada/salida se desactiva.

LOAD_OP

140.3

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida "Cargar par√°metros operativos en el FM 355"
est√° activado, los par√°metros operativos se cargan en el m√≥dulo y el par√°metro de
entrada/salida se desactiva.

Consulte tambi√©n
Descripci√≥n de DB 101 a 104 (P√°gina 6683)
Descripci√≥n de PID_FM (P√°gina 6648)

FM 355-2 Temperature Control
FMT_PID
Descripci√≥n de FMT_PID
La instrucci√≥n FMT_PID permite realizar las siguientes acciones durante el funcionamiento:
‚óè Transmitir par√°metros de operaci√≥n al FM 355-2
‚óè Transmitir par√°metros de regulaci√≥n al FM 355-2
‚óè Leer valores del proceso del FM 355-2
Los par√°metros de operaci√≥n son todas las variables est√°ticas del DB de instancia en la
estructura OP.
Los par√°metros del regulador son todas las variables est√°ticas del DB de instancia en la
estructura PAR.
Los par√°metros del proceso son todas las variables est√°ticas del DB de instancia en la
estructura OUT.
Los datos necesarios para el FMT_PID se depositan en un DB de instancia en la CPU. El
FMT_PID lee datos del FM 355-2 controlado por el programa y los escribe, controlado por el
programa, en el FM 355-2.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6691

Instrucciones
4.2 Instrucciones

Llamada
La instrucci√≥n FMT_PID debe llamarse en el mismo OB as√≠ como todas las instrucciones
restantes que acceden al mismo FM 355-2.
FMT_PID se llama en el OB de alarma c√≠clica. Requiere una marcha de inicializaci√≥n, que se
inicia activando el par√°metro COM_RST = TRUE en el arranque de la CPU. Tras la marcha de
inicializaci√≥n, FMT_PID pone el par√°metro COM_RST en FALSE.
Si se efect√∫a una llamada a la instrucci√≥n FMT_PID como DB multiinstancia, no se dispone de
interfaz de puesta en servicio. En este caso, los FM 355-2 se deben poner en servicio a trav√©s
de una tabla de observaci√≥n, o bien con la instrucci√≥n FMT_TUN.

Llamada en periferia descentralizada
En una configuraci√≥n descentralizada y en caso de llamada simult√°nea de FMT_PID y
FMT_TUN, deben considerarse los siguientes aspectos:
‚óè LOAD_OP no puede activarse simult√°neamente en FMT_PID y FMT_TUN.
‚óè READ_OUT no puede activarse simult√°neamente en FMT_PID y FMT_TUN.
Motivo: Ambos FBs acceden al FM 355-2 a trav√©s de los mismos registros.
Por ello hay que garantizar que en el mismo momento s√≥lo uno de los dos FBs lea o escriba
un registro.

Arranque
En el arranque y en la transici√≥n de STOP a RUN de la CPU, los par√°metros del FM 355-2 se
sobrescriben con los par√°metros del SDB de la CPU.

Respuesta en caso de error
El par√°metro de salida RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las
instrucciones RDREC y WRREC. RET_VALU puede evaluarse si los par√°metros READ_PAR
y LOAD_PAR no se desactivan.
En la llamada de la instrucci√≥n FMT_PID puede producirse un error de acceso a la periferia si
el FM 355-2 no est√° insertado o si no recibe suministro de tensi√≥n. En ese caso, la CPU pasa
a STOP si no hay ning√∫n OB 122 cargado en la CPU.
Si se produce un error en la lectura/escritura del registro, QMOD_F y QCH_F se activan. En
caso de error de parametrizaci√≥n, se activan QPAR_F y QCH_F.

Consulte tambi√©n
Diagramas de bloques (P√°gina 6704)

6692

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Funcionamiento de FMT_PID
Influencia de los par√°metros LOAD_OP, READ_OUT, LOAD_PAR y READ_PAR
En la marcha de inicializaci√≥n, FMT_PID lee los par√°metros de los datos del sistema y los
deposita en el DB de instancia. El DB de instancia y los datos del sistema est√°n sincronizados.
La figura siguiente muestra c√≥mo afectan los par√°metros LOAD_OP, READ_OUT,
LOAD_PAR y READ_PAR al funcionamiento de la instrucci√≥n.

'DWRVGHO
VLVWHPD

'%
LQVWDQFLD
P¬£[ GHO
)%
)07B3,'

&38

)%
)07B3,'

&DUJDUORVGDWRVGHO
VLVWHPDDUUDQTXH
6723!581GHOD&38

)0

/2$'B23
5($'B287
/2$'B3$5
5($'B3$5

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6693

Instrucciones
4.2 Instrucciones
La tabla siguiente contiene la informaci√≥n detallada en relaci√≥n con los valores de los
par√°metros.
Par√°metro

TRUE

LOAD_OP

Las variables est√°ticas de la estructura OP se trans‚Äê Las variables est√°ticas de la estructura OP se trans‚Äê
miten c√≠clicamente con las instrucciones WRREC y miten a trav√©s de √°reas de entradas y salidas del
RDREC al FM 355-2.
m√≥dulo. No es posible si dos instancias de la instruc‚Äê
ci√≥n FMT_PID acceden al mismo n√∫mero de canal de
Los par√°metros de salida se leen del FM 355-2.
un m√≥dulo.
READ_VAR adopta el estado TRUE

FALSE

READ_VAR no cambia

En las siguientes situaciones, LOAD_OP adopta au‚Äê
tom√°ticamente el estado TRUE:
‚óè Si ha activado uno de los siguientes par√°metros:
TUN_ST, TUN_CST, SAVE_PAR,UNDO_PAR y
LOAD_PID
‚óè Si modifica TUN_ON
‚óè Si modifica la consigna SP_RE.
Tiempo de operaci√≥n largo

Tiempo de operaci√≥n reducido

Los valores son efectivos tras un ciclo de la CPU o el
FM. Rige el ciclo m√°s largo.

En la configuraci√≥n centralizada ya se requieren de 3
a 4 ciclos de la CPU o del FM para que los valores
sean efectivos. Rige el ciclo m√°s largo

Se transmiten todos los par√°metros de operaci√≥n

S√≥lo se transmiten los par√°metros de operaci√≥n has‚Äê
ta LMN_DN incluido.
En modo autom√°tico s√≥lo se transmite la consigna
SP_RE.
En modo manual s√≥lo se transmite la variable mani‚Äê
pulada en manual LMN_RE.

READ_OUT

Las variables est√°ticas de la estructura OUT se trans‚Äê Las variables est√°ticas de la estructura OUT se trans‚Äê
miten c√≠clicamente con las instrucciones WRREC y miten a trav√©s de √°reas de entradas y salidas del
RDREC al FM 355-2.
m√≥dulo y en la estructura OUT.
En las siguientes situaciones, READ_OUT adopta
autom√°ticamente el estado TRUE:
‚óè Durante una optimizaci√≥n QTUN_ON = TRUE

No es posible si dos instancias de la instrucci√≥n
FMT_PID acceden al mismo n√∫mero de canal de un
m√≥dulo.

‚óè Si modifica la consigna SP_RE
Tiempo de ejecuci√≥n prolongado

Tiempo de ejecuci√≥n reducido

Todos los par√°metros se leen del FM 355

Los siguientes par√°metros no se leen del FM 355
‚óè SP (consigna del FM)
‚óè ER (error de regulaci√≥n)
‚óè DISV (magnitud perturbadora)
‚óè LMN_A
‚óè LMN_B
‚óè PHASE
‚óè STATUS_H
‚óè STATUS_C
‚óè STATUS_D
‚óè ZONE_TUN

6694

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

TRUE

FALSE

READ_PAR

Todas las variables est√°ticas de la estructura PAR
son le√≠das por el FM 355-2 y se guardan en el DB de
instancia en la CPU.

Sin transmisi√≥n de los par√°metros del regulador a la
CPU

Todas las variables est√°ticas de la estructura PAR se
cargan desde la CPU al FM 355-2. Esto es necesario
si se han cambiado los par√°metros de regulador en la
CPU en funci√≥n de los estados del proceso.

Sin transmisi√≥n de los par√°metros del regulador al
FM 355-2

LOAD_PAR

En el programa de usuario se pueden modificar pa‚Äê
r√°metros individuales en la CPU.

Una vez completada la transmisi√≥n de datos, los par√°metros LOAD_OP, READ_OUT,
LOAD_PAR y READ_PAR se vuelven a poner a FALSE.

Uso en periferia descentralizada
Si se utiliza el FM 355-2 en la periferia descentralizada, la transmisi√≥n de datos y la
desactivaci√≥n de los par√°metros puede requerir varios ciclos de llamada.

Tiempos de ejecuci√≥n de FMT_PID
En la reparametrizaci√≥n controlada por programa (LOAD_PAR, LOAD_OP) del FM 355-2 con
FMT_PID aumenta el tiempo de ejecuci√≥n. Los nuevos par√°metros siempre entran en vigor
inmediatamente.
Condiciones marco

Tiempo de ejecuci√≥n en

READ_OUT

LOAD_OP

LOAD_PAR
READ_PAR

CPU 315-2-DP

CPU 416-2 DP

FALSE

FALSE

FALSE

0,65 ms

0.04 ms

TRUE

FALSE

FALSE

2.85 ms

0.30 ms

TRUE

TRUE

FALSE

4.56 ms

0.55 ms

FALSE

FALSE

TRUE

3.58 ms*)

0.30 ms

TRUE

FALSE

TRUE

5.8 ms*)

0.56 ms

TRUE

TRUE

TRUE

7.41 ms*)

0.82 ms

*) Si se activa READ_PAR en lugar de LOAD_PAR, aumenta el tiempo de ejecuci√≥n en la CPU 315-2 DP en 0.35 ms.

Consulte tambi√©n
Diagramas de bloques (P√°gina 6704)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6695

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de FMT_PID
Tabla 4-316
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

MOD_ADDR 0.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configura‚Äê
ci√≥n con STEP 7.

CHANNEL

INT

0

N√∫mero de canal de regulador al que se refiere el DB de instancia.

2.0

Descripci√≥n

Son v√°lidos los valores entre 0 y 3

Consulte tambi√©n
Diagramas de bloques (P√°gina 6704)

Par√°metros de salida de FMT_PID
Tabla 4-317
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

QMOD_F

4.0

BOOL

FAL‚Äê
SE

La instrucci√≥n comprueba si los procesos de escritura y lectura de un registro han
finalizado correctamente. Si se detectan errores, se activa la salida QMOD_F. La
causa puede ser: Una direcci√≥n de m√≥dulo incorrecta en el par√°metro
MOD_ADDR, un n√∫mero de canal incorrecto en el par√°metro CHANNEL o un
m√≥dulo defectuoso.

RET_VALU

6.0

WORD

W#16
#0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC.

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

6696

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada/salida de FMT_PID
Tabla 4-318
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

COM_RST

8.0

BOOL

FAL‚Äê
SE

Con COM_RST = TRUE la instrucci√≥n FMT_PID ejecuta una marcha de iniciali‚Äê
zaci√≥n y desactiva COM_RST. Esta marcha de inicializaci√≥n es imprescindible en
cada arranque de la CPU.

LOAD_OP

8.1

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida LOAD_OP est√° activado, los par√°metros de
operaci√≥n se cargan en el m√≥dulo, los par√°metros de salida se leen y el par√°metro
de entrada/salida se desactiva.

READ_OUT

8.2

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida READ_OUT est√° activado, se leen los par√°me‚Äê
tros de salida del m√≥dulo, se depositan en la estructura OUT del DB de instancia
y el par√°metro de entrada/salida se desactiva.

LOAD_PAR

8.3

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida LOAD_PAR est√° activado, los par√°metros del
regulador se cargan en el m√≥dulo y el par√°metro de entrada/salida se desactiva.

READ_PAR

8.4

BOOL

FAL‚Äê
SE

Si el par√°metro es READ_PAR = TRUE, los par√°metros del regulador se leen del
FM 355-2 y se depositan en la estructura PAR del DB de instancia. A continuaci√≥n
se desactiva el par√°metro de entrada/salida.

Consulte tambi√©n
Diagramas de bloques (P√°gina 6704)

Variables est√°ticas de FMT_PID.OP
Tabla 4-319
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

vers_nr

10.0

WORD

W#16#
3230

El par√°metro vers_nr no puede ser modificado por el usuario. Identifica el inicio
de los par√°metros de operaci√≥n, que se transfieren al m√≥dulo si se activa
LOAD_OP = TRUE.

SP_RE

12.0

REAL

0.0

En la entrada SP_RE se conecta una consigna externa con el regulador.

LMN_RE

16.0

REAL

0.0

En la entrada LMN_RE se conecta una variable manipulada externa con el re‚Äê
gulador.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

SAFE_ON

20.0

BOOL

FALSE

Si SAFE_ON est√° activada, se aplica un valor de seguridad como variable ma‚Äê
nipulada.

LMNTRKON 20.1

BOOL

FALSE

Si LMNTRKON est√° activada, la variable manipulada se corrige mediante una
entrada anal√≥gica (EA).

LMN_REON

BOOL

FALSE

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
20.2

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Si LMN_REON est√° activada, se aplica una variable manipulada externa
LMN_RE como variable manipulada (modo manual).

6697

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

LMNRHSRE 20.3

BOOL

FALSE

La se√±al "Servov√°lvula en tope superior" puede aplicarse en una entrada digital
de FM 355-2 o en la entrada LMNRHSRE. LMNRHSRE = TRUE significa: La
servov√°lvula se encuentra en el tope superior.

LMNRLSRE

BOOL

FALSE

(S√≥lo en el regulador paso a paso).
20.4

La se√±al "Servov√°lvula en tope inferior" puede aplicarse en una entrada digital del
FM 355-2 o en la entrada LMNRLSRE. LMNRLSRE = TRUE significa: La servo‚Äê
v√°lvula se encuentra en el tope inferior.
(S√≥lo en el regulador paso a paso).

LMNS_ON

20.5

BOOL

FALSE

Activar control manual de variable manipulada
(S√≥lo en el regulador paso a paso; modo manual).

LMN_UP

20.6

BOOL

FALSE

Subir se√±al de variable manipulada
(S√≥lo en el regulador paso a paso).

LMN_DN

20.7

BOOL

FALSE

SAVE_PAR

22.0

BOOL

FALSE

Bajar se√±al de variable manipulada
(S√≥lo en el regulador paso a paso).
Guarda los par√°metros de regulador actuales en los par√°metros de salida de la
instrucci√≥n FMT_TUN.
‚óè FMT_TUN.SAV_PFAC=PFAC_SP
‚óè FMT_TUN.SAV_GAIN =GAIN
‚óè FMT_TUN.SAV_TI =TI
‚óè FMT_TUN.SAV_TD = TD
‚óè FMT_TUN.SAV_D_F =D_F
‚óè FMT_TUN.SAV_CONZ = CON_ZONE
‚óè FMT_TUN.SAV_RATI =RATIOFAC
‚óè FMT_TUN.SAV_CZON=CONZ_ON
‚óè FMT_TUN.SAV_PSEL=P_SEL

UNDO_PAR

22.1

BOOL

FALSE

Los par√°metros de regulador guardados se recuperan, tambi√©n en el modo au‚Äê
tom√°tico.
‚óè PFAC_SP= FMT_TUN.SAV_PFAC
‚óè GAIN = FMT_TUN.SAV_GAIN
‚óè TI = FMT_TUN.SAV_TI
‚óè TD = FMT_TUN.SAV_TD
‚óè D_F = FMT_TUN.SAV_D_F
‚óè CON_ZONE = FMT_TUN.SAV_CONZ
‚óè RATIOFAC = FMT_TUN.SAV_RATI
‚óè CONZ_ON= FMT_TUN.SAV_CZON
‚óè P_SEL= FMT_TUN.SAV_PSEL

LOAD_PID

22.2

BOOL

FALSE

Carga con PID_ON=TRUE los par√°metros PID (PID_GAIN, PID_TI, PID_TD).
Con PID_ON=FALSE se cargan los par√°metros PI (PI_GAIN, PI_TI). (Tambi√©n
en modo autom√°tico)

TUN_ON

6698

22.3

BOOL

FALSE

TUN_ON=TRUE cambia el FM 355-2 a la disponibilidad para optimizaci√≥n (PHA‚Äê
SE=1): Se calcula el valor medio de la variable manipulada hasta que se aplica la
excitaci√≥n de la variable manipulada.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

TUN_ST

22.4

BOOL

FALSE

Si la consigna debe permanecer constante durante la optimizaci√≥n del regulador
en el punto de operaci√≥n, se aplica un escal√≥n de variable manipulada de
TUN_DLMN con TUN_ST=TRUE (PHASE = 1 o PHASE = 2).

TUN_CST

22.5

BOOL

FALSE

Inicia la optimizaci√≥n de refrigeraci√≥n aplicando un salto de la variable manipu‚Äê
lada de TUN_CLMN (PHASE = 1 o PHASE = 2)

Consulte tambi√©n
Descripci√≥n de FMT_PID (P√°gina 6691)
Diagramas de bloques (P√°gina 6704)

Variables est√°ticas FMT_PID.PAR
Tabla 4-320
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

vers_nr

24.0

WORD

W#16
#3230

El par√°metro vers_nr no puede ser modificado por el usuario. Identifica el inicio de
los par√°metros de regulador que se leen del FM con READ_PAR = TRUE y que
se depositan en el DB de instancia o bien se transmiten al FM con LOAD_PAR =
TRUE.

P_SEL

26.0

BOOL

TRUE

En el algoritmo PID las acciones PID se pueden conectar y desconectar indivi‚Äê
dualmente. La acci√≥n proporcional est√° conectada si la entrada P_SEL est√° acti‚Äê
vada.

MONERSEL 26.1

BOOL

FAL‚Äê
SE

El regulador dispone de un avisador de valor l√≠mite, que puede utilizarse para el
valor real o para el error de regulaci√≥n. Si MONERSEL est√° activado, se vigila el
error de regulaci√≥n.

PID_ON

BOOL

TRUE

Tras la optimizaci√≥n o con LOAD_PID =TRUE se activan los par√°metros PID. Con
PID_ON =FALSE se cargan los par√°metros PI.

26.2

Puede ocurrir que en algunos tipos de proceso s√≥lo se dise√±e un regulador PI a
pesar de PID_ON = TRUE.
CONZ_ON
D_EL_SEL

26.3
28.0

BOOL
INT

FAL‚Äê
SE

TRUE = zona de regulaci√≥n activada

16

El componente D del algoritmo PID puede depositarse en una entrada separada.
Se selecciona en el par√°metro D_EL_SEL.

FALSE = zona de regulaci√≥n desactivada

‚óè D_EL_SEL = 0 hasta D_EL_SEL = 3: Entrada anal√≥gica 0 a 3
‚óè D_EL_SEL = 16: error de regulaci√≥n
‚óè D_EL_SEL = 17: valor real negativo
SP_HLM

30.0

REAL

100.0

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. El par√°‚Äê
metro SP_HLM indica el l√≠mite superior.
SP_HLM > SP_LLM

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6699

Instrucciones
4.2 Instrucciones
Par√°metro

SP_LLM

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

34.0

REAL

0.0

Descripci√≥n

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. El par√°‚Äê
metro SP_LLM indica el l√≠mite inferior.
SP_LLM < SP_HLM

H_ALM

38.0

REAL

100.0

L√≠mite m√°s alto para la vigilancia del valor real o del error de regulaci√≥n.
H_ALM > H_WRN

H_WRN

42.0

REAL

90.0

Segundo l√≠mite m√°s alto para la vigilancia del valor real o del error de regulaci√≥n.
H_WRN > H_ALM

L_WRN

46.0

REAL

10.0

Segundo l√≠mite m√°s bajo para la vigilancia del valor real o del error de regulaci√≥n.
Se admiten valores entre H_WRN y L_ALM

L_ALM

50.0

REAL

0.0

L√≠mite m√°s bajo para la vigilancia del valor real o del error de regulaci√≥n.
Se admiten valores entre L_ALM y L_WRN.

HYS

54.0

REAL

1.0

Para evitar oscilaciones de los indicadores de vigilancia, puede parametrizarse
una hist√©resis.
HYS >= 0.0

DEADB_W

58.0

REAL

0.0

El error de regulaci√≥n se conduce por una zona muerta. El par√°metro DEADB_W
determina el tama√±o de la zona muerta.
DEADB_W >= 0.0

PFAC_SP

62.0

REAL

1.0

PFAC_SP indica la acci√≥n P efectiva en caso de modificaci√≥n de la consigna.
Se admiten valores comprendidos entre 0.0 y 1.0.

GAIN

66.0

REAL

1.0

El par√°metro GAIN indica la ganancia del regulador.
El sentido de actuaci√≥n del regulador se invierte mediante el signo negativo de
GAIN.

TI

70.0

REAL

3000.0 El par√°metro TI (tiempo de acci√≥n integral) determina el comportamiento temporal
del integrador. Con TI = 0.0 el integrador est√° desactivado.

TD

74.0

REAL

0.0

El par√°metro TD (tiempo de anticipaci√≥n) determina el comportamiento temporal
del diferenciador (componente D). Con TD = 0.0 el diferenciador est√° desactivado.

D_F

78.0

REAL

5.0

La constante de tiempo TD/D_F efectiva para el componente D se limita interna‚Äê
mente a ‚â• tiempo de muestreo/2.

TI = 0.0 o bien TI >= 0.5

TD = 0.0 o bien TD >= 1.0

Se admiten valores comprendidos entre 5.0 y 10.0.
LMN_SAFE

82.0

REAL

0.0

Para la variable manipulada puede parametrizarse un valor de seguridad.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

LMN_HLM

86.0

REAL

100.0

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
El par√°metro LMN_HLM indica el l√≠mite superior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica).
Se admiten valores entre LMN_LLM y 100.0 (%).

LMN_LLM

90.0

REAL

0.0

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
El par√°metro LMN_LLM indica el l√≠mite inferior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica).
Se admiten valores entre -100.0 y LMN_HLM (%).

6700

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

MTR_TM

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

94.0

REAL

60.0

Descripci√≥n

Tiempo de operaci√≥n de la servov√°lvula de tope a tope
(S√≥lo en el regulador paso a paso).
MTR_TM >= 0.001

PULSE_TM

98.0

REAL

0.0

Duraci√≥n de impulso m√≠nima

BREAK_TM

102.0

REAL

0.0

Duraci√≥n m√≠nima de pausa de impulso

RATIOFAC

106.0

REAL

0.0

Relaci√≥n entre ganancia de calentamiento/ganancia de refrigeraci√≥n del proceso.

(S√≥lo en el regulador paso a paso o de impulsos)
(S√≥lo en el regulador paso a paso o de impulsos).
RATIOFAC <> 0.0 provoca lo siguiente:
‚óè LMN = LMN * RATIOFAC para LMN<0.0;
‚óè CON_ZONE 50% mayor
Se admiten los valores de 0.01 a 100.0 √≥ 0.0.
CON_ZONE

110.0

REAL

100.0

Ancho de zona de regulaci√≥n
Si ER >= CON_ZONE, entonces LMN = LMN_HLM.
Si ER <= -CON_ZONE, entonces LMN = LMN_LLM.
Si RATIOFAC <> 0.0 y ER <= -CON_ZONE/RATIOFAC, entonces LMN =
LMN_LLM.
CON_ZONE > 0.0

TUN_DLMN

114.0

REAL

20.0

La excitaci√≥n del proceso para la optimizaci√≥n del regulador se realiza mediante
un salto de la variable manipulada de TUN_DLMN.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

TUN_CLMN

118.0

REAL

-20.0

Salto de la variable manipulada tras el inicio de la optimizaci√≥n de la refrigeraci√≥n
con TUN_CST.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

Consulte tambi√©n
Diagramas de bloques (P√°gina 6704)

Variables est√°ticas de FMT_PID.OUT
Tabla 4-321
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

vers_nr

122.0

WORD

W#16
#3230

El par√°metro vers_nr no puede ser modificado por el usuario. Identifica el inicio de
los par√°metros de salida que lee el m√≥dulo cuando se activa READ_OUT = TRUE.

PV

124.0

REAL

0.0

Valor real efectivo.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6701

Instrucciones
4.2 Instrucciones
Par√°metro

LMN

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

128.0

REAL

0.0

Descripci√≥n

En la salida LMN se indica la variable manipulada que act√∫a efectivamente.
En el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica, se indica la
acci√≥n P + D ilimitada en la salida LMN.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

QLMNSAFE

132.1

BOOL

FAL‚Äê
SE

Si la salida QLMNSAFE est√° activada, como variable manipulada se indica la
variable manipulada de seguridad.

QLMNTRK

132.3

BOOL

FAL‚Äê
SE

La salida QLMNTRK indica si la variable manipulada se corrige mediante una
entrada anal√≥gica.

QLMN_RE

132.4

BOOL

FAL‚Äê
SE

La salida QLMN_RE indica si LMN_REON est√° activada y si la variable manipu‚Äê
lada externa LMN_RE se aplica como variable manipulada.

QLMNR_HS

132.5

BOOL

FAL‚Äê
SE

QLMNR_HS = TRUE significa: La servov√°lvula se encuentra en el tope superior.
(S√≥lo en regulador paso a paso)

QLMNR_LS

132.6

BOOL

FAL‚Äê
SE

QLMNR_LS = TRUE significa: La servov√°lvula se encuentra en el tope inferior.

QLMNR_ON 132.7

BOOL

FAL‚Äê
SE

QLMNR_ON = TRUE significa:

FAL‚Äê
SE

Regulador paso a paso/regulador de impulsos

QSTEPCON 133.0

BOOL

(S√≥lo en el regulador paso a paso).
Regulador paso a paso con realimentaci√≥n de posici√≥n.
‚óè QSTEPCON = 0: regulador de impulsos o regulador continuo
‚óè QSTEPCON = 1: regulador paso a paso

QSPR

133.1

BOOL

FAL‚Äê
SE

Si la salida QSPR est√° activada, el regulador continuo trabaja en modo de rango
partido.

QMAN_FC

133.3

BOOL

FAL‚Äê
SE

El regulador es un regulador piloto que, mediante la operaci√≥n manual de un
regulador secundario, se corrige seg√∫n el valor real de este √∫ltimo, o cuya acci√≥n
I se detiene porque la consigna o la magnitud manipulada del regulador secun‚Äê
dario est√°n en el l√≠mite.

QH_ALM

134.0

BOOL

FAL‚Äê
SE

L√≠mite m√°s alto H_ALM rebasado por valor real o error de regulaci√≥n.

QH_WRN

134.1

BOOL

FAL‚Äê
SE

Segundo l√≠mite m√°s alto H_WRN rebasado por valor real o error de regulaci√≥n.

QL_WRN

134.2

BOOL

FAL‚Äê
SE

Segundo l√≠mite m√°s bajo L_WRN rebasado por valor real o error de regulaci√≥n.

QL_ALM

134.3

BOOL

FAL‚Äê
SE

L√≠mite m√°s bajo L_ALM rebasado por valor real o error de regulaci√≥n.

QLMN_HLM

134.4

BOOL

FAL‚Äê
SE

La salida QLMN_HLM notifica que se ha alcanzado el l√≠mite superior de la variable
manipulada LMN_HLM.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica).

QLMN_LLM

134.5

BOOL

FAL‚Äê
SE

La salida QLMN_LLM notifica que se ha alcanzado el l√≠mite inferior de la variable
manipulada LMN_LLM.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

QPAR_F

134.6

BOOL

FAL‚Äê
SE

El m√≥dulo comprueba la validez de los par√°metros. Un error de parametrizaci√≥n
se indica en la salida QPAR_F.

QCH_F

134.7

BOOL

FAL‚Äê
SE

La salida QCH_F se activa cuando el canal de regulaci√≥n no puede arrojar resul‚Äê
tados v√°lidos. El error de canal (p. ej. rotura de hilo) tambi√©n se activa con
QPAR_F = TRUE o QMOD_F = TRUE. Si QCH_F = TRUE, la informaci√≥n precisa
del error puede verse en el registro de diagn√≥stico DS1 del m√≥dulo.

6702

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

QUPRLM
QDNRLM

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

135.0

BOOL

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada.

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada.

135.1

BOOL

Descripci√≥n

Si la salida QUPRLM est√° activada, se limita la rampa de subida de la consigna.
Si la salida QDNRLM est√° activada, se limita la rampa de bajada de la consigna.

QSP_HLM

135.2

BOOL

FAL‚Äê
SE

La salida QSP_HLM notifica que se ha alcanzado el l√≠mite superior de la consigna
SP_HLM.

QSP_LLM

135.3

BOOL

FAL‚Äê
SE

La salida QSP_LLM notifica que se ha alcanzado el l√≠mite inferior de la consigna
SP_LLM.

QLMNUP

135.4

BOOL

FAL‚Äê
SE

Salida "Se√±al alta de variable manipulada".

FAL‚Äê
SE

Salida "Se√±al baja de variable manipulada".

QLMNDN

135.5

BOOL

(S√≥lo en regulador paso a paso o de impulsos)
(S√≥lo en regulador paso a paso o de impulsos)

QTUN_ON

135.6

BOOL

FAL‚Äê
SE

QTUN_ON = TRUE indica que se est√° produciendo una optimizaci√≥n.

PAR_ACT

135.7

BOOL

FAL‚Äê
SE

Actualizar par√°metros de regulador

SP

136.0

REAL

0.0

Consigna efectiva.

ER

140.0

REAL

0.0

Error de regulaci√≥n efectivo (SP- PV)

DISV

144.0

REAL

0.0

Magnitud perturbadora efectiva.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

LMN_A

148.0

REAL

0.0

Con el regulador continuo o de impulsos, en la salida LMN_A se muestra la va‚Äê
riable manipulada A de la funci√≥n de rango partido, y con el regulador paso a paso
con realimentaci√≥n de posici√≥n anal√≥gica se muestra la realimentaci√≥n de posi‚Äê
ci√≥n.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

LMN_B

152.0

REAL

0.0

Con el regulador continuo o de impulsos, en la salida LMN_B se muestra la va‚Äê
riable manipulada B de la funci√≥n de rango partido.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6703

Instrucciones
4.2 Instrucciones
Par√°metro

PHASE

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

156.0

INT

0

Descripci√≥n

Muestra el progreso de la optimizaci√≥n del regulador.
‚óè PHASE = -1: interrupci√≥n de la optimizaci√≥n del regulador p. ej. con
optimizaci√≥n paralela de varios canales. El valor est√° presente durante unos
pocos ciclos y ejerce de aviso de interrupci√≥n entre la instrucci√≥n FMT_PID y
el m√≥dulo.
‚óè PHASE = 0: no hay modo de optimizaci√≥n; modo autom√°tico o manual
‚óè PHASE = 1: disponibilidad para la optimizaci√≥n; comprobar par√°metros,
esperar excitaci√≥n, medir los tiempos de muestreo
‚óè PHASE = 2: optimizaci√≥n propiamente dicha: B√∫squeda del punto de inversi√≥n
con variable manipulada constante.
‚óè PHASE = 3: c√°lculo de los par√°metros del proceso. Guardar los par√°metros
del regulador v√°lidos antes de la optimizaci√≥n.
‚óè PHASE = 4: dise√±o del regulador
‚óè PHASE = 5: correcci√≥n del regulador a la nueva variable manipulada
‚óè PHASE = 6: correcci√≥n del regulador a la nueva variable manipulada
‚óè PHASE = 7: comprobaci√≥n del tipo de sistema si se ha determinado el tipo II
o III (con con optimizaci√≥n de calentamiento).

STATUS_H

158.0

INT

0

AUTOHOTSPOT indica un valor de diagn√≥stico a trav√©s de la b√∫squeda del punto
de inversi√≥n en el proceso de calentamiento.

STATUS_C

160.0

INT

0

AUTOHOTSPOT indica un valor de diagn√≥stico a trav√©s de la b√∫squeda del punto
de inversi√≥n en el proceso de refrigeraci√≥n.

STATUS_D

162.0

INT

0

AUTOHOTSPOT indica un valor de diagn√≥stico a trav√©s del dise√±o del regulador
en el proceso de calentamiento.

ZONE_TUN

164.0

WORD

W#16
#0

En la representaci√≥n HEX cada una de las cuatro posiciones corresponde a un
canal, en el siguiente orden de izquierda a derecha: Canal 0, 1, 2, 3. ZONE_TUN
= 0 significa que el canal utilizado no puede optimizarse conjuntamente con el
resto de canales. Un valor <> 0000 muestra - con un 1 en cada caso - los canales
que se optimizan conjuntamente.

Consulte tambi√©n
Diagramas de bloques (P√°gina 6704)

Diagramas de bloques
Sinopsis
En las siguientes figuras se representan los puntos en los que son efectivos los par√°metros de
la instrucci√≥n FMT_PID.
En reguladores de tres componentes, de relaci√≥n y mixtos, los par√°metros act√∫an en los
mismos puntos que en los reguladores de valor fijo o en cascada. Esto tambi√©n rige para los
par√°metros que est√°n presentes por igual en reguladores continuos, con salida de impulsos y
paso a paso. Como norma general puede decirse que los mismos botones contienen los

6704

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
mismos par√°metros. Por ello, para una mejor comprensi√≥n no se representan todos los
diagramas de estructuras, y no todos los par√°metros est√°n incluidos en todos los diagramas.
Sin embargo, todos los par√°metros de la instrucci√≥n FMT_PID est√°n contenidos en los
diagramas, excepto MOD_ADDR, CHANNEL, QMOD_F, QPAR_F, QCH_F, QLMNR_ON,
RET_VALU, COM_RST, LOAD_PAR, READ_PAR, READ_OUT y LOAD_OP.
En los siguientes diagramas se representan los puntos en los que son efectivos los par√°metros
del FMT_PID.

Efecto de los par√°metros de entrada
La figura siguiente muestra el c√°lculo del error de regulaci√≥n en el regulador de valor fijo o en
cascada
3$563B+/0
3$563B//0

2363B5(
&RQVLJQD

&RQPXWDU
FRQVLJDGH
VHJXULGDG

5DPSD

&RQVLJQD
HIHFWLYD

/LPLWDU

(UURUGH
UHJXODFL¬µQ
3$5+B$/0
3$5+B:51
3$5021(56(/
3$5/B:51
3$5/B$/0
$ODUPD
+<6

9DORUUHDO$

9DORUUHDO
HIHFWLYR
(QWUDGD'
3$5'B(/B6(/

0DJQLWXG
SHUWXUEDGRUD

La figura siguiente muestra el diagrama de bloques del algoritmo de regulaci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6705

Instrucciones
4.2 Instrucciones

=RQDPXHUWD
(UURUGH
UHJXODFL¬µQ

3$53)$&B63
3$5*$,13$5'B)
3$57,3$53B6(/
3$57'
5HIULJHUDU

3$5'($'%B:

=RQDGH
UHJXODFL¬µQ

9DORUPDQLSX
ODGRHIHFWLYR

3$55$7,2)$& 3$5&21=B21
3$5&21B=21(

(QWUDGD'

0DJQLWXGSHUWXUEDGRUD

La figura siguiente muestra la salida del regulador continuo (FM 355-2 C)
23/01B5( 23/01B5(21
9DORU
PDQLSXODGR
H[WHUQR
&RQPXWDU
9DORU
PDQLSXODGR YDORUPDQLSX
23/0175.21
ODGRH[WHUQR
HIHFWLYR

&RQPXWDU
VHJXLPLHQWR

3$5/01B+/0
236$)(B21
3$5/01B6$)( 3$5/01B//0
9DORU
PDQLSXODGR
&RQPXWDU
/LPLWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

9DORUPDQLSXODGR$

5DQJRSDUWLGR

9DORUPDQLSXODGR%

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORU
PDQLSXODGR

La figura siguiente muestra la salida del regulador de impulsos (FM 355-2 S)
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

9DORU
PDQLSXODGR
&RQPXWDU
VHJXLPLHQWR

&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

/LPLWDU

3$538/6(B70
3$5%5($.B70

5DQJRSDUWLGR
IRUPDGRUGH
LPSXOVRV

(QWUDGDGHVHJXLPLHQWR

6706

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

La figura siguiente muestra la salida del regulador paso a paso con realimentaci√≥n de posici√≥n
(FM 355-2 S)
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

&RQPXWDU
YDORU
PDQLSX
ODGR
H[WHUQR

9DORUPDQLSX
ODGR
&RQPXWDU
VHJXLPLHQWR

3$5075B70
3$538/6(B70
3$5%5($.B70

&RQPXWDU
/LPLWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

(QWUDGDGHVHJXLPLHQWR

(QWUDGDGHUHVSXHVWDGHSRVLFL¬µQ

La figura siguiente muestra la salida del regulador paso a paso sin realimentaci√≥n de posici√≥n
(FM 355-2 S)
23/01B'1
23/01B83
23/016B21

3$5075B70
3$538/6(B70
3$5%5($.B70
9DORUPDQLSXODGR
H[WHUQR
9DORUPDQLSX
ODGRHIHFWLYR

6H¬≥DOGHVDOLGD
$OWR

%DMD
&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

)RUPDGRUGH
LPSXOVRV
23/015+65(
23/015/65(

Generaci√≥n de los par√°metros de salida
En las siguientes figuras se representan los puntos del m√≥dulo en los que se generan los
par√°metros de salida de la instrucci√≥n FMT_PID.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6707

Instrucciones
4.2 Instrucciones
La figura siguiente muestra el c√°lculo del error de regulaci√≥n en el regulador de valor fijo o en
cascada
2874835/0 287463B+/0
2874'15/0 287463B//0

2363B5(
&RQVLJQD

&RQPXWDU
FRQVLJDGH
VHJXULGDG

5DPSD

/LPLWDU

63
(5

&RQVLJQD
HIHFWLYD
(UURUGH
UHJXODFL¬µQ

39

$ODUPD

2874+B$/0
2874+B:51
2874/B:51
2874/B$/0

9DORUUHDO
HIHFWLYR

9DORUUHDO$

(QWUDGD'

287',69
0DJQLWXGSHUWXUEDGRUD

La figura siguiente muestra la salida del regulador continuo (FM 355-2 C)
9DORUPDQLSX
ODGRH[WHUQR

2874/01B5(
2874/016$)(

&RQPXWDU
9DORU
PDQLSXODGR YDORU
2874/0175.
PDQLSXODGR
HIHFWLYR
H[WHUQR

&RQPXWDU
VHJXLPLHQWR

2874/01B+/0
2874/01B//0 2874635
9DORU
9DORUPDQLSXODGR$
PDQLSXODGR
287/01

&RQPXWDU
/LPLWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

5DQJRSDUWLGR

9DORUPDQLSXODGR%

(QWUDGDGHVHJXLPLHQWR

La figura siguiente muestra la salida del regulador de impulsos (FM 355-2 S)

6708

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

9DORU
PDQLSXODGR
&RQPXWDU
VHJXLPLHQWR

&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

/LPLWDU

2874/0183
2874/01'1
5DQJRSDUWLGR
IRUPDGRUGH
LPSXOVRV

(QWUDGDGHVHJXLPLHQWR

La figura siguiente muestra la salida del regulador paso a paso con realimentaci√≥n de posici√≥n
(FM 355-2 S)
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

9DORUPDQLSX
ODGR
&RQPXWDU
VHJXLPLHQWR

&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

2874/015B+6
2874/015B/6

/LPLWDU
)RUPDGRU
GHLPSXOVRV
2874/01'1

(QWUDGDGHVHJXLPLHQWR

2874/0183

287/01B$
(QWUDGDGHUHVSXHVWDGHSRVLFL¬µQ

La figura siguiente muestra la salida del regulador paso a paso sin realimentaci√≥n de posici√≥n
(FM 355-2 S)
2874/015B+6
2874/015B/6
9DORUPDQLSXODGR
H[WHUQR
9DORUPDQLSXODGR
HIHFWLYR

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

2874/0183
2874/01'1
&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

)RUPDGRU
GH
LPSXOVRV

6709

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Descripci√≥n de FMT_PID (P√°gina 6691)

Par√°metro STATUS_H
STATUS_H indica un valor de diagn√≥stico a trav√©s de la b√∫squeda del punto de inversi√≥n en
el proceso de calentamiento.
Si se muestra un valor de diagn√≥stico 2xxxx, la optimizaci√≥n finaliza, pero los par√°metros del
regulador son inseguros.
Si se muestra un valor de diagn√≥stico 3xxxx, la optimizaci√≥n se interrumpe (PHASE = 0 y
TUN_ON = FALSE) y el regulador cambia al modo de operaci√≥n anterior.
STATUS_ H

Descripci√≥n

Soluci√≥n

0

Par√°metros del regulador predeterminados, ninguno
o ninguno nuevo

10000

Optimizaci√≥n finalizada + par√°metros adecuados en‚Äê
contrados para el regulador

2xxxx

Optimizaci√≥n finalizada + par√°metros del regulador
inseguros

2xxx1

Tiempo de posicionamiento del motor efectivo >=
65% del tiempo del punto de inversi√≥n T_P_INF

La compensaci√≥n de TU y T_P_INF ya no se realiza.
De ese modo se dise√±a un regulador suave.

Punto de inversi√≥n no alcanzado
(s√≥lo en caso de excitaci√≥n con salto de consigna)

Si el regulador oscila, atenuar los par√°metros del re‚Äê
gulador o repetir el ensayo con TUN_DLMN menor.

Error de estimaci√≥n

Repetir el ensayo.

2xx2x
2x1xx

TU <= 3*Tiempo de muestreo
2x2xx

Error de estimaci√≥n grave (TU < tiempo de muestreo) Repetir el ensayo.
Caso especial, proceso puramente PT1: No repetir el
ensayo, atenuar los par√°metros del regulador si pro‚Äê
cede.

2x3xx

Error de estimaci√≥n TU demasiado grande

Repetir el ensayo con mejores condiciones.

21xxx

Error de estimaci√≥n N_PTN < 1

Repetir el ensayo con mejores condiciones.

22xxx

Error de estimaci√≥n N_PTN > 10

Repetir el ensayo con mejores condiciones.

3xxxx

Optimizaci√≥n cancelada en fase 1 debido a parame‚Äê
trizaci√≥n err√≥nea

30001

Activaci√≥n simult√°nea de TUN_ON y TUN_ST

6710

Volver a iniciar la optimizaci√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
STATUS_ H
30002

Descripci√≥n

Soluci√≥n

|TUN_DLMN| < 5 % o cifra de la modificaci√≥n efectiva Puede que haya parametrizado un valor demasiado
bajo para TUN_DLMN o que la magnitud manipulada
de LMN < 5 %
estuviera
pr√≥xima a un l√≠mite antes del inicio de la
‚óè Transici√≥n a fase 99 (fase 0 en optimizaci√≥n
optimizaci√≥n.
paralela)
En ese caso hay que impedir que el regulador se
‚óè Salida LMN = LMN0
ajuste a la nueva consigna y abandone innecesaria‚Äê
mente el punto de operaci√≥n estacionario (no es po‚Äê
sible en la optimizaci√≥n paralela).
Proceda del siguiente modo:
‚óè Dado el caso, retire la consigna y ponga TUN_ON
en FALSE
‚óè Corrija TUN_DLMN
‚óè Compruebe los l√≠mites de la variable manipulada
si TUN_DLMN >= 5%.
‚óè Volver a iniciar la optimizaci√≥n.

30004

|TUN_DLMN| < 5 % o modificaci√≥n efectiva de LMN
<5%
Diferencia efectiva de variable manipulada limitada
por los l√≠mites de rango partido y no por los l√≠mites de
la variable manipulada.

V√©ase STATUS_H=30002:
Recuerde adem√°s que p. ej. con LMN_A < 5 % no es
posible una optimizaci√≥n de calentamiento con
TUN_DLMN negativo (raz√≥n: La potencia de refrige‚Äê
raci√≥n no puede modificarse).

‚óè Transici√≥n a fase 99 (fase 0 en optimizaci√≥n
paralela)
‚óè Salida LMN = LMN0
30009

Modo de seguridad

Finalice el modo de seguridad y vuelva a iniciar la
optimizaci√≥n.

Nota
Al final de la fase 1 STATUS_H se pone a 0.
Si se cancela la optimizaci√≥n en la fase 2, STATUS_H = 0. Sin embargo, STATUS_D sigue
mostrando el estado del √∫ltimo c√°lculo del regulador.

Consulte tambi√©n
Diagramas de bloques (P√°gina 6704)

Par√°metro STATUS_C
STATUS_C indica un valor de diagn√≥stico a trav√©s de la b√∫squeda del punto de inversi√≥n en
la refrigeraci√≥n.
Si se muestra un valor de diagn√≥stico 2xxxx, la optimizaci√≥n finaliza, pero los par√°metros del
regulador son inseguros.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6711

Instrucciones
4.2 Instrucciones
Si se muestra un valor de diagn√≥stico 3xxxx, la optimizaci√≥n se interrumpe (PHASE = 0 y
TUN_ON = FALSE) y el regulador cambia al modo de operaci√≥n anterior.
STATUS_ C

Descripci√≥n

Soluci√≥n

0

Par√°metros del regulador predeterminados, ninguno
o ninguno nuevo

10000

Optimizaci√≥n finalizada + par√°metros adecuados en‚Äê
contrados para el regulador

2xxxx

Optimizaci√≥n finalizada + par√°metros del regulador
inseguros

2x3xx

Error de estimaci√≥n TU demasiado grande

Repetir el ensayo con mejores condiciones.

21xxx

Error de estimaci√≥n N_PTN < 1

Repetir el ensayo con mejores condiciones.

22xxx

Error de estimaci√≥n N_PTN > 10

Repetir el ensayo con mejores condiciones.

3xxxx

Optimizaci√≥n cancelada en fase 1 debido a parame‚Äê
trizaci√≥n err√≥nea

30001

Activaci√≥n simult√°nea de TUN_ON y TUN_CST

30002

S√≥lo en el regulador paso a paso sin realimentaci√≥n
de posici√≥n anal√≥gica:

Volver a iniciar la optimizaci√≥n.

Puede que haya parametrizado un valor demasiado
bajo para TUN_CLMN o que la magnitud manipulada
|TUN_CLMN| < 5 % o cifra de la modificaci√≥n efectiva estuviera pr√≥xima a un l√≠mite antes del inicio de la
optimizaci√≥n.
de LMN < 5 %
‚óè Transici√≥n a la fase 0
‚óè TUN_ON = FALSE

En ese caso hay que impedir que el regulador se
ajuste a la nueva consigna y abandone innecesaria‚Äê
mente el punto de operaci√≥n estacionario (no es po‚Äê
sible en la optimizaci√≥n paralela).
Proceda del siguiente modo:

‚óè Dado el caso, retire la consigna y ponga TUN_ON
en FALSE.
‚óè Corrija TUN_CLMN
‚óè Compruebe los l√≠mites de la variable manipulada
si |TUN_CLMN| >= 5% y el signo era correcto.
‚óè Volver a iniciar la optimizaci√≥n.
30003

TUN_CLMN <= -5%, pero LMN_LLM > -5%.
‚óè Transici√≥n a la fase 0
‚óè TUN_ON = FALSE

El l√≠mite inferior LMN_LLM es demasiado alto (p. ej.
0%) e impide por ello la indicaci√≥n de una potencia de
refrigeraci√≥n.
‚óè Corrija el l√≠mite inferior LMN_LLM.
‚óè Reiniciar la optimizaci√≥n.

30004

TUN_CLMN > -5 % o modificaci√≥n efectiva de LMN >
-5 %
Diferencia efectiva de la variable manipulada limita‚Äê
da por los l√≠mites de rango partido y no por los l√≠mites
de la variable manipulada.

V√©ase STATUS_C=30002:
Recuerde adem√°s que p. ej. con LMN_A < 5 % no es
posible una optimizaci√≥n de calentamiento con
TUN_DLMN negativo (raz√≥n: La potencia de refrige‚Äê
raci√≥n no puede modificarse).

‚óè Transici√≥n a la fase 0
‚óè TUN_ON = FALSE

6712

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
STATUS_ C
30008

Descripci√≥n
TUN_CST pero ninguna optimizaci√≥n de calenta‚Äê
miento anterior

Soluci√≥n
Realizar primero una optimizaci√≥n de calentamiento

‚óè Transici√≥n a la fase 0
‚óè TUN_ON = FALSE
30009

Modo de seguridad

Finalice el modo de seguridad y vuelva a iniciar la
optimizaci√≥n.

Consulte tambi√©n
Diagramas de bloques (P√°gina 6704)

Par√°metro STATUS_D
STATUS_D

Descripci√≥n

0

No se han calculado par√°metros del regulador.

110

N_PTN <= 1.5 Tipo de sistema I r√°pido

121

N_PTN > 1.5 Tipo de sistema I

122

N_PTN = 1.9 Tipo de sistema I tras fase 7 (antes N_PTN > 1.9)

200

N_PTN > 1.9 Tipo de sistema II (rango de transici√≥n)

310

N_PTN >= 2.1 Tipo de sistema III r√°pido

320

N_PTN > 2.6 Tipo de sistema III

Nota
Si la optimizaci√≥n se cancela en la fase 2, entonces STATUS_H = 0. Sin embargo, STATUS_D
sigue mostrando el estado del √∫ltimo c√°lculo del regulador.
Cuanto mayor sea el valor de STATUS_D, mayor ser√° el orden del proceso regulado, mayor
la relaci√≥n TU/TA y m√°s suaves los par√°metros del regulador.

Consulte tambi√©n
Diagramas de bloques (P√°gina 6704)

FMT_PAR
Descripci√≥n de FMT_PAR
La instrucci√≥n FMT_PAR permite modificar online otros par√°metros, que no pueden
predeterminarse con la instrucci√≥n FMT_PID.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6713

Instrucciones
4.2 Instrucciones

Llamada
FMT_PAR debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 355-2.
Para ahorrar tiempo de ejecuci√≥n, FMT_PAR s√≥lo debe llamarse con LOAD=TRUE cuando
deben modificarse par√°metros.

Funcionamiento
Con FMT_PAR se pueden modificar un par√°metro REAL y un par√°metro INT en cada llamada.
En AUTOHOTSPOT indique el n√∫mero de √≠ndice del par√°metro que desea modificar. En el
par√°metro de entrada VALUE_R o VALUE_I indique los nuevos valores.
Para modificar varios par√°metros, llame el mismo DB de instancia varias veces consecutivas
con LOAD_PAR = TRUE y con n√∫meros de √≠ndice diferentes.
Si se utiliza el FM 355-2 en periferia descentralizada, pueden ser necesarios varios ciclos
hasta que los par√°metros se hayan transmitido al FM 355-2. Hasta que la transmisi√≥n no haya
finalizado, el par√°metro LOAD_PAR mantiene el valor TRUE. Por ello, para modificar
par√°metros llame la instrucci√≥n FMT_PAR de forma repetida hasta que LOAD_PAR = FALSE.
Nota
Recuerde que los par√°metros que ha cambiado con FMT_PAR se sobrescriben en el arranque
de la CPU con los par√°metros de los datos del sistema.

Ejemplo
Desea cambiar el tiempo de subida de la rampa para la magnitud de referencia durante el
funcionamiento, y adem√°s utilizar diferentes valores de entrada anal√≥gica como valor real
independientemente del estado del proceso.
‚óè Para parametrizar el tiempo de subida de la rampa para la referencia a 10.0 llame
FMT_PAR con INDEX = 30 y VALUE_R = 10.0 durante el funcionamiento.
‚óè Para parametrizar el valor de entrada anal√≥gica 4 como valor real del m√≥dulo, llame
FMT_PAR durante el funcionamiento con INDEX = 50 y VALUE_I = 4.

Par√°metros de entrada de FMT_PAR
Tabla 4-322
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

MOD_ADDR 0.0

INT

256

CHANNEL

INT

0

2.0

Descripci√≥n

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configura‚Äê
ci√≥n con STEP 7.
N√∫mero de canal de regulador al que se refiere el DB de instancia.
Son v√°lidos los valores entre 0 y 3.

6714

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

INDEX

4.0

INT

0

0 a 100

VALUE_R

6.0

REAL

0.0

En funci√≥n del par√°metro en cuesti√≥n

VALUE_I

10.0

INT

0

En funci√≥n del par√°metro en cuesti√≥n

Par√°metros de salida de FMT_PAR
Tabla 4-323
Par√°metro

RET_VALU

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

12.0

WORD

W#16
#0

Descripci√≥n

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de la instrucci√≥n
WRREC.

Consulte tambi√©n
WRREC: Escribir registro (P√°gina 5890)

Par√°metros de entrada/salida de FMT_PAR
Tabla 4-324
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

LOAD_PAR

+14.0

BOOL

FAL‚Äê
SE

Descripci√≥n

Si el par√°metro de entrada/salida LOAD_PAR est√° activado, VALUE_R o VA‚Äê
LUE_I se escriben en el m√≥dulo. INDEX indica qu√© par√°metro se sobrescribe. A
continuaci√≥n LOAD_PAR se desactiva.

Par√°metro INDEX
INDEX

Descripci√≥n

Tipo de datos

0

Ning√∫n par√°metro seleccionado

1

Constante de tiempo de filtro para entrada anal√≥gica

REAL

2

Normalizaci√≥n entrada anal√≥gica fin de rango de medici√≥n equivale al
100%

REAL

3

Normalizaci√≥n entrada anal√≥gica inicio de rango de medici√≥n equivale al
0%

REAL

4

L√≠nea poligonal, valor de interpolaci√≥n 1 lado de entrada

REAL

5

L√≠nea poligonal, valor de interpolaci√≥n 2 lado de entrada

REAL

6

L√≠nea poligonal, valor de interpolaci√≥n 3 lado de entrada

REAL

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

-

6715

Instrucciones
4.2 Instrucciones
INDEX

6716

Descripci√≥n

Tipo de datos

7

L√≠nea poligonal, valor de interpolaci√≥n 4 lado de entrada

REAL

8

L√≠nea poligonal, valor de interpolaci√≥n 5 lado de entrada

REAL

9

L√≠nea poligonal, valor de interpolaci√≥n 6 lado de entrada

REAL

10

L√≠nea poligonal, valor de interpolaci√≥n 7 lado de entrada

REAL

11

L√≠nea poligonal, valor de interpolaci√≥n 8 lado de entrada

REAL

12

L√≠nea poligonal, valor de interpolaci√≥n 9 lado de entrada

REAL

13

L√≠nea poligonal, valor de interpolaci√≥n 10 lado de entrada

REAL

14

L√≠nea poligonal, valor de interpolaci√≥n 11 lado de entrada

REAL

15

L√≠nea poligonal, valor de interpolaci√≥n 12 lado de entrada

REAL

16

L√≠nea poligonal, valor de interpolaci√≥n 13 lado de entrada

REAL

17

L√≠nea poligonal, valor de interpolaci√≥n 1 lado de salida

REAL

18

L√≠nea poligonal, valor de interpolaci√≥n 2 lado de salida

REAL

19

L√≠nea poligonal, valor de interpolaci√≥n 3 lado de salida

REAL

20

L√≠nea poligonal, valor de interpolaci√≥n 4 lado de salida

REAL

21

L√≠nea poligonal, valor de interpolaci√≥n 5 lado de salida

REAL

22

L√≠nea poligonal, valor de interpolaci√≥n 6 lado de salida

REAL

23

L√≠nea poligonal, valor de interpolaci√≥n 7 lado de salida

REAL

24

L√≠nea poligonal, valor de interpolaci√≥n 8 lado de salida

REAL

25

L√≠nea poligonal, valor de interpolaci√≥n 9 lado de salida

REAL

26

L√≠nea poligonal, valor de interpolaci√≥n 10 lado de salida

REAL

27

L√≠nea poligonal, valor de interpolaci√≥n 11 lado de salida

REAL

28

L√≠nea poligonal, valor de interpolaci√≥n 12 lado de salida

REAL

29

L√≠nea poligonal, valor de interpolaci√≥n 13 lado de salida

REAL

30

Tiempo de subida de la rampa para referencia

REAL

31

Consigna de seguridad

REAL

32

Offset de combinaci√≥n de consigna (regulador de relaci√≥n/mixto)

REAL

33

Factor para valor real B (regulador de tres componentes)

REAL

34

Factor para valor real C (regulador de tres componentes)

REAL

35

Offset para combinaci√≥n de valor real (regulador de tres componentes)

REAL

36

Factor para combinaci√≥n de referencia

REAL

37

Punto de operaci√≥n

REAL

38

No se utiliza

REAL

39

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de entrada
A

REAL

40

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de entrada A

REAL

41

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de salida A

REAL

42

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de salida A

REAL

43

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de entrada
B

REAL

44

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de entrada B

REAL

45

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de salida B

REAL

46

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de salida B

REAL

47

Duraci√≥n m√≠nima del impulso

REAL

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
INDEX

Descripci√≥n

48

Duraci√≥n m√≠nima de pausa

49

Selecci√≥n de la referencia SP o SP_RE para el regulador

Tipo de datos
REAL
INT

‚óè -1: Consigna SP_RE de la instrucci√≥n
‚óè 0 a 3: Valor de entrada anal√≥gica 0 a 3
‚óè 16 a 19: Magnitud manipulada (LMN) de regulador 0 a 3
‚óè 32 a 35: Magnitud manipulada A de regulador 0 a 3
‚óè 48 a 51: Magnitud manipulada B de regulador 0 a 3
50

Selecci√≥n de la magnitud reguladora principal valor real A para el regu‚Äê
lador

INT

‚óè -1: Valor real A = 0.0
‚óè 0 a 3: Valor de entrada anal√≥gica 0 a 3
51

Selecci√≥n de la magnitud reguladora auxiliar valor real B para el regula‚Äê
dor

INT

‚óè -1: Valor real B = 0.0
‚óè 0 a 3: Valor de entrada anal√≥gica 0 a 3
52

Selecci√≥n de la magnitud reguladora auxiliar valor real C para el regula‚Äê
dor

INT

‚óè -1: Valor real C = 0.0
‚óè 0 a 3: Valor de entrada anal√≥gica 0 a 3
53

Selecci√≥n de la magnitud reguladora auxiliar valor real D para el regula‚Äê
dor

INT

‚óè -1: Valor real D = 0.0
‚óè 0 a 3: Valor de entrada anal√≥gica 0 a 3
‚óè 16 a 19: Magnitud manipulada (LMN) de regulador 0 a 3
54

Selecci√≥n de la magnitud perturbadora DISV para el regulador

INT

‚óè -1: Magnitud perturbadora = 0.0
‚óè 0 a 3: Valor de entrada anal√≥gica 0 a 3
55

Selecci√≥n en el conmutador de entrada de seguimiento. En el punto de
medida MP TRACKPER se puede leer el valor con tooltip.

INT

‚óè -1: Seguimiento de posici√≥n = 0.0
‚óè 0 a 3: Valor de entrada anal√≥gica 0 a 3
56

Selecci√≥n en el conmutador de entrada de realimentaci√≥n de posici√≥n en
regulador paso a paso con realimentaci√≥n de posici√≥n.

INT

‚óè -1: Seguimiento de posici√≥n = 0.0
‚óè 0 a 3: Valor de entrada anal√≥gica 0 a 3
57

Selecci√≥n de la se√±al para la conmutaci√≥n al valor de seguridad para la
variable manipulada del regulador

INT

‚óè -1: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro
SAFE_ON de la instrucci√≥n FMT_PID
‚óè 0 a 7: Asignaci√≥n predeterminada con el par√°metro SAFE_ON de la
instrucci√≥n FMT_PID predeterminado por la entrada digital 0 a 7

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6717

Instrucciones
4.2 Instrucciones
INDEX

Descripci√≥n

Tipo de datos

58

Selecci√≥n de la se√±al para la conmutaci√≥n a la funci√≥n de seguimiento de
la variable manipulada del regulador

INT

‚óè -1: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro
LMNTRKON de la instrucci√≥n FMT_PID
‚óè 0 a 7: Asignaci√≥n predeterminada con el par√°metro LMNTRKON de
la instrucci√≥n FMT_PID predeterminado por la entrada digital 0 a 7
59

Selecci√≥n de la se√±al para la conmutaci√≥n de la variable manipulada del
regulador a LMN_RE

INT

‚óè -1: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro
LMN_REON de la instrucci√≥n FMT_PID
‚óè 0 a 7: Asignaci√≥n predeterminada con el par√°metro LMN_REON de
la instrucci√≥n FMT_PID predeterminado por la entrada digital 0 a 7
60

Selecci√≥n de la se√±al de tope superior de la realimentaci√≥n de posici√≥n

INT

‚óè -1: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro
LMNRHSRE de la instrucci√≥n FMT_PID
‚óè 0 a 7: Asignaci√≥n predeterminada con el par√°metro LMNRHSRE de
la instrucci√≥n FMT_PID predeterminado por la entrada digital 0 a 7
61

Selecci√≥n de la se√±al de tope inferior de la realimentaci√≥n de posici√≥n

INT

‚óè -1: S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro
LMNRLSRE de la instrucci√≥n FMT_PID
‚óè 0 a 7: Asignaci√≥n predeterminada con el par√°metro LMNRLSRE de la
instrucci√≥n FMT_PID predeterminado por la entrada digital 0 a 7

FMT_DS1
Descripci√≥n de FMT_DS1
Para leer el registro de diagn√≥stico DS1 se dispone de la instrucci√≥n FMT_DS1.

Funcionamiento
Si el par√°metro es READ_DS1 = TRUE, se lee el registro de diagn√≥stico DS1 del FM 355-2 y
se deposita en la estructura DS1 del DB de instancia. A continuaci√≥n se desactiva el par√°metro
de entrada/salida.
Esa lectura s√≥lo tiene sentido si en el DS0 se notifica un error en un canal.

Llamada
FMT_DS1 debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 355-2.
FMT_DS1 no requiere una marcha de inicializaci√≥n.
Para obtener siempre los valores de diagn√≥stico actuales, ponga el par√°metro READ_DS1
c√≠clicamente en TRUE en el OB 82.

6718

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Una vez que la lectura de los valores de diagn√≥stico se ha completado correctamente,
FMT_DS1 desactiva el par√°metro READ_DS1.

Par√°metros de entrada de FMT_DS1
Tabla 4-325
Par√°metro

Direc‚Äê
ci√≥n

MOD_ADDR 0.0

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

INT

256

Descripci√≥n

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configura‚Äê
ci√≥n con STEP 7.

Par√°metros de salida de FMT_DS1
Tabla 4-326
Direc‚Äê
ci√≥n

Tipo de
datos

DS1

2.0

STRU
CT

RET_VALU

16.0

WORD

Par√°metro

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

El registro de diagn√≥stico DS1 se compone de los bytes 0 a 12. Los 4 primeros
bytes son id√©nticos a los del registro de diagn√≥stico DS0.
W#16
#0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de la instrucci√≥n
RDREC.

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)

Par√°metros de entrada/salida de FMT_DS1
Tabla 4-327
Par√°metro

READ_DS1

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

18.0

BOOL

FAL‚Äê
SE

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Descripci√≥n

Si el par√°metro es READ_DS1 = TRUE, se lee el registro de diagn√≥stico DS1 del
FM 355-2 y se deposita en la estructura DS1 del DB de instancia. A continuaci√≥n
se desactiva el par√°metro de entrada/salida.

6719

Instrucciones
4.2 Instrucciones

Ocupaci√≥n de DS1
La siguiente tabla muestra la ocupaci√≥n del registro de diagn√≥stico DS1. Los 4 primeros bytes
son id√©nticos a los del registro de diagn√≥stico DS0. Todos los bits que no se incluyen en la tabla
son irrelevantes y tienen el valor cero.
Byte
0

Bit

Significado

Observaci√≥n

N¬∫ de evento

0

Aver√≠a en m√≥dulo

Se activa en todos los eventos de diagn√≥stico

8:x:00

1

Error interno

Se activa para todos los errores internos:

8:x:01

‚óè Vigilancia de tiempo activada
‚óè Falla la EPROM
‚óè Error ADC/DAC
‚óè Entrada anal√≥gica error de hardware
2

Error externo

Se activa para todos los errores externos:

8:x:02

‚óè Falta tensi√≥n auxiliar externa
‚óè Error de parametrizaci√≥n
‚óè Entrada anal√≥gica rotura de hilo (s√≥lo en el rango de 4 a
20 mA)
‚óè Entrada anal√≥gica Rango de medida rebasado por
defecto
‚óè Entrada anal√≥gica Rango de medida rebasado por exceso
‚óè Salida anal√≥gica Rotura de carga aparente
‚óè Salida anal√≥gica Cortocircuito
3

Error en un canal

Consultar a partir del byte 7 para m√°s detalles sobre la des‚Äê
codificaci√≥n

8:x:03

4

Falta tensi√≥n auxiliar exter‚Äê
na

Fallo de la alimentaci√≥n de 24 V del FM 355-2

8:x:04

6

No utilizado

-

7

Error de parametrizaci√≥n

El m√≥dulo no puede evaluar un par√°metro. Causa: Par√°me‚Äê
tros desconocidos o combinaci√≥n de par√°metros no permiti‚Äê
da.

0 ...
3

Clase de m√≥dulo

Siempre tiene asignado el valor 8.

-

4

Diagn√≥stico espec√≠fico de
canal

Se activa cuando el m√≥dulo puede proporcionar informaci√≥n
de canal adicional y hay un error de canal (ver bytes 7 a 12)

-

2

3

Vigilancia de tiempo activa‚Äê
da (watch dog)

Error de hardware

8:x:33

3

2

Falla la EPROM

M√≥dulo defectuoso

8:x:42

4

Error ADC/DAC

M√≥dulo defectuoso

8:x:44

4

0 ...
7

Tipo de canal

Siempre tiene asignado el valor 75H.

-

5

0 ...
7

Longitud de la informaci√≥n
de diagn√≥stico

Siempre tiene asignado el valor 8.

-

6

0 ...
7

N√∫mero de canales

Siempre tiene asignado el valor 5 (4 reguladores + 1 canal de
referencia)

-

7

0 ...
4

Vector de error de canal

Cada canal tiene asignado un bit (0...3; 4 para canal de refe‚Äê
rencia).

-

1

6720

8:x:07

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Byte
8

Bit
0

Significado

Observaci√≥n

N¬∫ de evento

Entrada anal√≥gica error de
hardware

8:x:B0

1

No utilizado

8:x:B1

2

Entrada anal√≥gica rotura de
hilo (s√≥lo en el rango de 4 a
20 mA)

8:x:B2

3

No utilizado

8:x:B3

4

Entrada anal√≥gica Rango
de medida rebasado por de‚Äê
Diagn√≥stico de canal, canal 0
fecto

8:x:B4

5

Entrada anal√≥gica Rango
de medida rebasado por ex‚Äê
ceso

8:x:B5

6

Salida anal√≥gica Rotura de
hilo

S√≥lo con salida de co‚Äê
rriente del regulador K

8:x:B6

7

Salida anal√≥gica Cortocir‚Äê
cuito

S√≥lo con salida de ten‚Äê
si√≥n del regulador K

8:x:B7

9

0 ...
7

V√©ase el byte 8

Diagn√≥stico de canal, canal 1

V√©ase arriba

10

0 ...
7

V√©ase el byte 8

Diagn√≥stico de canal, canal 2

V√©ase arriba

11

0 ...
7

V√©ase el byte 8

Diagn√≥stico de canal, canal 3

V√©ase arriba

12

0 ...
5

V√©ase el byte 8

Diagn√≥stico para canal de referencia

V√©ase arriba

FMT_TUN
Descripci√≥n de FMT_TUN
Con la instrucci√≥n FMT_TUN se obtiene informaci√≥n detallada adicional (p. ej. par√°metros de
regulador guardados) durante la optimizaci√≥n del regulador.
Nota
No obstante, para realizar una optimizaci√≥n de regulador es suficiente la instrucci√≥n FMT_PID.
Dicha instrucci√≥n permite iniciar la optimizaci√≥n y observar la informaci√≥n de estado.

Llamada
FMT_TUN debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 355-2.
FMT_TUN no requiere una marcha de inicializaci√≥n.
Ponga el par√°metro READ_OUT c√≠clicamente en TRUE para ver los valores actuales en cada
momento.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6721

Instrucciones
4.2 Instrucciones
Una vez que la lectura de los par√°metros se ha completado correctamente, FMT_TUN
desactiva el par√°metro READ_OUT.

Funcionamiento
Tras cargar los par√°metros del regulador con LOAD_PAR = TRUE o los par√°metros de
operaci√≥n con LOAD_OP = TRUE, los par√°metros no son efectivos de forma inmediata. Hasta
que no ha transcurrido el tiempo de ciclo del FM355-2 (hasta 500 ms dependiendo del n√∫mero
de canales), los par√°metros del regulador no podr√°n leerse con READ_PAR ni los par√°metros
de salida con READ_OUT. Lo mismo rige tras la carga de los datos del sistema (transici√≥n de
la CPU de STOP a RUN) o al leer los par√°metros de salida con FMT_TUN.

Llamada en una configuraci√≥n descentralizada
En una configuraci√≥n descentralizada y en caso de llamada simult√°nea de FMT_PID y
FMT_TUN, deben considerarse los siguientes aspectos:
‚óè LOAD_OP no puede activarse simult√°neamente en FMT_PID y FMT_TUN.
‚óè READ_OUT no puede activarse simult√°neamente en FMT_PID y FMT_TUN.
Motivo: Ambas instrucciones acceden al FM355-2 a trav√©s de los mismos registros. Por ello
hay que garantizar que en el mismo momento s√≥lo uno de los dos FBs lea o escriba un registro.

Par√°metros de entrada de FMT_TUN
Tabla 4-328
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

MOD_ADDR 0.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configura‚Äê
ci√≥n con STEP 7.

CHANNEL

INT

0

N√∫mero de canal de regulador al que se refiere el DB de instancia.

2.0

Descripci√≥n

Son v√°lidos los valores entre 0 y 3.

Par√°metros de salida de FMT_TUN
Tabla 4-329
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

PI_GAIN

4.0

REAL

0.0

Par√°metros de regulador PI

PI_TI

8.0

REAL

0.0

Par√°metros de regulador PI

PID_GAIN

12.0

REAL

0.0

Par√°metros de regulador PID

PID_TI

16.0

REAL

0.0

Par√°metros de regulador PID

6722

Descripci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

PID_TD

20.0

REAL

0.0

Par√°metros de regulador PID

SAV_PFAC

24.0

REAL

0.0

Par√°metros de regulador guardados FMT_PID.PAR.PFAC_SP

SAV_GAIN

28.0

REAL

0.0

Par√°metros de regulador guardados FMT_PID.PAR.GAIN

SAV_TI

32.0

REAL

0.0

Par√°metros de regulador guardados FMT_PID.PAR.TI

SAV_TD

36.0

REAL

0.0

Par√°metros de regulador guardados FMT_PID.PAR.TD

SAV_D_F

40.0

REAL

0.0

Par√°metros de regulador guardados FMT_PID.PAR.D_T

SAV_RATI

44.0

REAL

0.0

Par√°metros de regulador guardados FMT_PID.PAR.RATIOFAC

SAV_CONZ

48.0

REAL

0.0

Par√°metros de regulador guardados FMT_PID.PAR.CON_ZONE

SAV_PSEL

52.0

BOOL

FAL‚Äê
SE

Par√°metros de regulador guardados FMT_PID.PAR.P_SEL

SAV_CZON

52.1

BOOL

FAL‚Äê
SE

Par√°metros de regulador guardados FMT_PID.PAR.CONZ_ON

RET_VALU

54.0

WORD

W#16
#0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de la instrucci√≥n
RDREC.

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)

Par√°metros de entrada/salida de FMT_TUN
Tabla 4-330
Par√°metro

READ_OUT

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

56.0

BOOL

FAL‚Äê
SE

Descripci√≥n

Si el par√°metro de entrada/salida READ_OUT est√° activado, el FM 355-2 lee los
par√°metros de salida.

Variables est√°ticas FMT_TUN.OUT
Tabla 4-331
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

vers_nr

58.0

WORD

W#16
#3230

El par√°metro vers_nr no puede ser modificado por el usuario. Identifica el inicio de
los par√°metros de salida que lee el m√≥dulo cuando se activa READ_OUT = TRUE.

PV

60.0

REAL

0.0

Valor real efectivo.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6723

Instrucciones
4.2 Instrucciones
Par√°metro

LMN

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

64.0

REAL

0.0

Descripci√≥n

En la salida LMN se indica la variable manipulada que act√∫a efectivamente.
En el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica, se indica la
acci√≥n P + D ilimitada en la salida LMN.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

QLMNSAFE

68.1

BOOL

FAL‚Äê
SE

Si la salida QLMNSAFE est√° activada, como variable manipulada se indica la
variable manipulada de seguridad.

QLMNTRK

68.3

BOOL

FAL‚Äê
SE

La salida QLMNTRK indica si la variable manipulada se corrige mediante una
entrada anal√≥gica.

QLMN_RE

68.4

BOOL

FAL‚Äê
SE

La salida QLMN_RE indica si LMN_REON est√° activada y si la variable manipu‚Äê
lada externo LMN_RE se aplica como variable manipulada.

QLMNR_HS

68.5

BOOL

FAL‚Äê
SE

QLMNR_HS = TRUE significa: La servov√°lvula se encuentra en el tope superior.
(S√≥lo en regulador paso a paso)

QLMNR_LS

68.6

BOOL

FAL‚Äê
SE

QLMNR_LS = TRUE significa: La servov√°lvula se encuentra en el tope inferior.

QLMNR_ON 68.7

BOOL

FAL‚Äê
SE

QLMNR_ON = TRUE significa:

FAL‚Äê
SE

Regulador paso a paso/regulador de impulsos

QSTEPCON 69.0

BOOL

(S√≥lo en el regulador paso a paso).
Regulador paso a paso con realimentaci√≥n de posici√≥n.
0 = regulador de impulsos o continuo
1 = regulador paso a paso

QSPR

69.1

BOOL

FAL‚Äê
SE

Si la salida QSPR est√° activada, el regulador continuo trabaja en modo de rango
partido.

QMAN_FC

69.3

BOOL

FAL‚Äê
SE

El regulador es un regulador piloto que, mediante la operaci√≥n manual de un
regulador secundario, se corrige seg√∫n el valor real de este √∫ltimo, o cuya acci√≥n
I se detiene porque la consigna o la magnitud manipulada del regulador secun‚Äê
dario est√°n en el l√≠mite.

QH_ALM

70.0

BOOL

FAL‚Äê
SE

L√≠mite m√°s alto H_ALM rebasado por valor real o error de regulaci√≥n.

QH_WRN

70.1

BOOL

FAL‚Äê
SE

Segundo l√≠mite m√°s alto H_WRN rebasado por valor real o error de regulaci√≥n.

QL_WRN

70.2

BOOL

FAL‚Äê
SE

Segundo l√≠mite m√°s bajo L_WRN rebasado por valor real o error de regulaci√≥n.

QL_ALM

70.3

BOOL

FAL‚Äê
SE

L√≠mite m√°s bajo L_ALM rebasado por valor real o error de regulaci√≥n.

QLMN_HLM

70.4

BOOL

FAL‚Äê
SE

La salida QLMN_HLM notifica que se ha alcanzado el l√≠mite superior de la variable
manipulada LMN_HLM.

QLMN_LLM

70.5

BOOL

FAL‚Äê
SE

La salida QLMN_LLM notifica que se ha alcanzado el l√≠mite inferior de la variable
manipulada LMN_LLM.

QPAR_F

70.6

BOOL

FAL‚Äê
SE

El m√≥dulo comprueba la validez de los par√°metros. Un error de parametrizaci√≥n
se indica en la salida QPAR_F.

QCH_F

70.7

BOOL

FAL‚Äê
SE

La salida QCH_F se activa cuando el canal de regulaci√≥n no puede arrojar resul‚Äê
tados v√°lidos. El error de canal (p. ej. rotura de hilo) tambi√©n se activa con
QPAR_F = 1 o QMOD_F = 1. Si QCH_F = TRUE, la informaci√≥n precisa del error
puede verse en el registro de diagn√≥stico DS1 del m√≥dulo.

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica).

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

6724

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

QUPRLM
QDNRLM

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

71.0

BOOL

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada.

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada.

71.1

BOOL

Descripci√≥n

Si la salida QUPRLM est√° activada, se limita la rampa de subida de la consigna.
Si la salida QDNRLM est√° activada, se limita la rampa de bajada de la consigna.

QSP_HLM

71.2

BOOL

FAL‚Äê
SE

La salida QSP_HLM notifica que se ha alcanzado el l√≠mite superior de la consigna
SP_HLM.

QSP_LLM

71.3

BOOL

FAL‚Äê
SE

La salida QSP_LLM notifica que se ha alcanzado el l√≠mite inferior de la consigna
SP_LLM.

QLMNUP

71.4

BOOL

FAL‚Äê
SE

Salida "Se√±al alta de variable manipulada".

FAL‚Äê
SE

Salida "Se√±al baja de variable manipulada".

QLMNDN

71.5

BOOL

(S√≥lo en regulador paso a paso o de impulsos)
(S√≥lo en regulador paso a paso o de impulsos)

QTUN_ON

71.6

BOOL

FAL‚Äê
SE

QTUN_ON = TRUE indica que se est√° produciendo una optimizaci√≥n.

PAR_ACT

71.7

BOOL

FAL‚Äê
SE

Actualizar par√°metros de regulador

SP

72.0

REAL

0.0

Consigna efectiva.

ER

76.0

REAL

0.0

Error de regulaci√≥n

DISV

80.0

REAL

0.0

Magnitud perturbadora efectiva.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

LMN_A

84.0

REAL

0.0

Con el regulador continuo o de impulsos, en la salida LMN_A se muestra la va‚Äê
riable manipulada A de la funci√≥n de rango partido, y con el regulador paso a paso
con realimentaci√≥n de posici√≥n anal√≥gica se muestra la realimentaci√≥n de posi‚Äê
ci√≥n.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

LMN_B

88.0

REAL

0.0

Con el regulador continuo o de impulsos, en la salida LMN_B se indica la variable
manipulada B de la funci√≥n de rango partido.
Se admiten valores comprendidos entre -100.0 y 100.0 (%).

PHASE

92.0

INT

0

Muestra el progreso de la optimizaci√≥n del regulador. *)
0..7

STATUS_H

94.0

INT

0

Valor de diagn√≥stico para b√∫squeda de punto de inversi√≥n en optimizaci√≥n de
calentamiento.
V√©ase Par√°metro FMT_PID.STATUS_H (P√°gina 6710)

STATUS_C

96.0

INT

0

Valor de diagn√≥stico para b√∫squeda de punto de inversi√≥n en optimizaci√≥n de
refrigeraci√≥n.
V√©ase Par√°metro FMT_PID.STATUS_C (P√°gina 6711)

STATUS_D

98.0

INT

0

Valor de diagn√≥stico para dise√±o de regulador en optimizaci√≥n de calentamiento.
V√©ase Par√°metro FMT_PID.STATUS_D (P√°gina 6713)

ZONE_TUN

100.0

WORD

W#16
#0

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

En la representaci√≥n HEX cada una de las cuatro posiciones corresponde a un
canal, en el siguiente orden de izquierda a derecha: Canal 0, 1, 2, 3. ZONE_TUN
= 0 significa que el canal utilizado no puede optimizarse conjuntamente con el
resto de canales. Un valor <> 0000 muestra - con un 1 en cada caso - los canales
que se optimizan conjuntamente.

6725

Instrucciones
4.2 Instrucciones
Par√°metro

GAIN_P

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

152.0

REAL

0.0

Descripci√≥n

Ganancia del proceso identificada (magnitud f√≠sica) /%.
En el tipo de sistema I, se tiende a estimar un valor demasiado bajo para GAIN_P.

TU

156.0

REAL

0.0

Tiempo de retardo identificado del proceso.
TU‚â• 3*Tiempo de muestreo

TA

160.0

REAL

0.0

Tiempo de compensaci√≥n identificado del proceso.
En el tipo de sistema I, se tiende a estimar un valor demasiado bajo para TA.

KIG

164.0

REAL

0.0

Rampa de subida m√°xima posible del valor real. (magnitud f√≠sica) /s
GAIN_P = 0.01 * KIG * TA

N_PTN

168.0

REAL

0.0

Orden del proceso. Tambi√©n se pueden utilizar "valores no enteros".

TM_LAG_P

172.0

REAL

0.0

Constante temporal de un modelo PTN.

T_P_INF

176.0

REAL

0.0

Tiempo desde la excitaci√≥n del proceso hasta el punto de inversi√≥n.

P_INF

180.0

REAL

0.0

Modificaci√≥n del valor real desde la excitaci√≥n del proceso hasta el punto de in‚Äê
versi√≥n.

LMN0

184.0

REAL

0.0

Variable manipulada al principio de la optimizaci√≥n

Se admiten valores comprendidos entre 1.01 y 10.0.
(Valores razonables s√≥lo para N_PTN>=2).

Se calcula en la fase 1 (valor medio)
Se admiten valores comprendidos entre -100.0 y 100.0 (%).
PV0

188.0

REAL

0.0

Valor real al principio de la optimizaci√≥n
Se calcula en la fase 1 (valor medio).

PVDT0

192.0

REAL

0.0

Subida del valor real al iniciar la optimizaci√≥n
Con adaptaci√≥n de signo.
(magnitud f√≠sica) /s

PVDT

196.0

REAL

0.0

Subida actual de valor real
Con adaptaci√≥n de signo.
(magnitud f√≠sica) /s

PVDT_MAX

200.0

REAL

0.0

Cambio m√°ximo de consigna (magnitud f√≠sica) /s
La derivaci√≥n del valor real alcanza un m√°ximo (signo adaptado, siempre > 0), se
utiliza para calcular TU y KIG.

NOI_PVDT

204.0

REAL

0.0

Nivel de ruido en PVDT_MAX en %
Cuanto mayor sea el nivel de ruido, menos precisos (de efecto m√°s suave) ser√°n
los par√°metros del regulador.

NOISE_PV

208.0

REAL

0.0

Ruido absoluto en valor real (magnitud f√≠sica) /s
Diferencia entre el valor real m√°ximo y m√≠nimo en la fase 1.

FIL_CYC

212.0

INT

0

N√∫mero de ciclos del filtro de valores medios
Se calcula un valor medio del valor real a partir de FIL_CYC ciclos. En caso
necesario, FIL_CYC se aumenta autom√°ticamente entre 1 y m√°x. 1024.

POI_CMAX

214.0

INT

0

N√∫mero m√°ximo de ciclos tras el punto de inversi√≥n
Este tiempo se utiliza para encontrar otro punto de inversi√≥n (es decir, uno mejor)
en caso de ruidos de medici√≥n. S√≥lo entonces concluye la optimizaci√≥n.

POI_CYCL

6726

216.0

INT

0

N√∫mero de ciclos tras el punto de inversi√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Par√°metro STATUS_H (P√°gina 6710)
Par√°metro STATUS_C (P√°gina 6711)
Par√°metro STATUS_D (P√°gina 6713)

FMT_PV
Descripci√≥n de FMT_PV
La instrucci√≥n FMT_PV permite leer o escribir valores del proceso (valores de entrada
anal√≥gicos y digitales) para facilitar la puesta en marcha.

Llamada
FMT_PV debe llamarse en el mismo OB que todas las instrucciones restantes que acceden al
mismo FM 355-2.
FMT_PV no requiere una marcha de inicializaci√≥n.
Ponga el par√°metro LOAD_PV c√≠clicamente en TRUE para escribir c√≠clicamente valores de
proceso simulados en FM 355-2.
Ponga el par√°metro READ_PV c√≠clicamente en TRUE para ver los valores del proceso
actuales en cada momento.
Una vez que la lectura o escritura de los valores del proceso se ha completado correctamente,
FMT_PV desactiva el par√°metro LOAD_PV o READ_PV.

Simulaci√≥n de los valores anal√≥gicos (LOAD_PV = TRUE)
La simulaci√≥n de los valores anal√≥gicos para los canales 0 a 3 se activa a trav√©s de los
conmutadores S_AION[ i ] o S_PVON[ i ], donde 0 ‚â§ i ‚â§ 3. En la figura de abajo se representa
en qu√© punto es efectivo el valor anal√≥gico simulado.
Los valores de simulaci√≥n para los canales 0 a 3 se predeterminan a trav√©s de los par√°metros
PV_SIM[ i ].
Los valores de simulaci√≥n pueden hacerse efectivos en dos puntos:
‚óè S_AION[ i ] = TRUE (0 ‚â§ i ‚â§ 3)
En lugar del valor de la entrada anal√≥gica i del m√≥dulo se utiliza el valor PV_SIM[ i ].
‚óè S_PVON[ i ] = TRUE (0 ‚â§ i ‚â§ 3)
En lugar del valor acondicionado de la entrada anal√≥gica i del m√≥dulo se utiliza el valor
PV_SIM[ i ].

Simulaci√≥n de los valores digitales (LOAD_PV = TRUE)
La simulaci√≥n de los valores para las entradas digitales 0 a 7 se activa a trav√©s de los
conmutadores S_DION[ i ], donde 0 ‚â§ i ‚â§ 7.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6727

Instrucciones
4.2 Instrucciones
Los valores de simulaci√≥n se predeterminan a trav√©s de los par√°metros DI_SIM[ i ].
‚óè S_DION[ i ] = TRUE (0 ‚â§ i ‚â§ 7)
En lugar del valor de la entrada digital i del m√≥dulo se utiliza el valor DI_SIM[ i ].
Nota
Los LEDs I0 a I7 muestran siempre el estado de la entrada digital correspondiente, incluso
durante la simulaci√≥n.
9DORUGHVLPXODFL¬µQ
39B6,0>L@

‡∏∑L‡∏∑

$FWLYDUVLPXODFL¬µQ

$FWLYDU
VLPXODFL¬µQ
6B3921>L@

6B$,21>L@
7LSRGHVHQVRU
$

'
)LOWUR

(QWUDGDGH
UHIHUHQFLD
SDUDPHWUL
]DGR

5D¬Ø]
FXDGUDGD

9DORUGHVLPXODFL¬µQ
',B6,0>L@

&RPSHQVDFL¬µQLQWHUQD
SDUDORV
WHUPRSDUHV
-.\(

(QWUDGDGLJLWDO

/¬ØQHD
SROLJRQDO

1RUPDOL]DFL¬µQ
\FRUUHFFL¬µQGH
RIIVHW

9DORU
DQDO¬µJLFR
SUHSDUDGR

$FWLYDUVLPXODFL¬µQ
6B',21>L@




9DORUGLJLWDO

Nota
La conexi√≥n y la preasignaci√≥n de los valores de simulaci√≥n (forzado) no se realizan a
trav√©s del software de configuraci√≥n. Por ello, los conmutadores y las l√≠neas de conexi√≥n
correspondientes se representan rayados.

6728

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Indicaci√≥n de los valores del proceso (READ_PV = TRUE)
Se visualizan los valores siguientes:
‚óè En los par√°metros STAT_DI[0] a STAT_DI[7] se muestra el estado real de las entradas
digitales 0 a 7, aunque sean simuladas.
‚óè En los par√°metros DIAG[0].PV_PER a DIAG[3].PV_PER se muestra el valor de las
entradas anal√≥gicas 0 a 3 en la unidad mA o mV. Si se ha activado la simulaci√≥n del valor
de entrada anal√≥gico, se muestra el valor simulado.
‚óè En los par√°metros DIAG[0].PV_PHY a DIAG[3].PV_PHY se muestra el valor acondicinoado
de entrada anal√≥gica 0 a 3 en unidad f√≠sica. Si se ha activado la simulaci√≥n del valor
anal√≥gico f√≠sico acondicionado, se muestra el valor simulado.
',$*>L@39B3(5

',$*>L@39B3+<

‡∏∑L‡∏∑

7LSRGHVHQVRU
$

'
)LOWUR
&-B7B287

5D¬Ø]
FXDGUDGD

/¬ØQHD
SROLJRQDO

1RUPDO
L]DFL¬µQ\
FRUUHFFL¬µQGH
RIIVHW

9DORU
DQDO¬µJLFR
SUHSDUDGR

(QWUDGDGH
UHIHUHQFLD
SDUDPHWUL]DGR

7HPSHUDWXUDGH
XQL¬µQIU¬ØD

&RPSHQVDFL¬µQ
LQWHUQDSDUDORV
WHUPRSDUHV-.
\(

Nota
La actualizaci√≥n de los valores del proceso puede retrasarse con respecto a la instrucci√≥n
FMT_PID si el FM 355-2 est√° muy cargado.

Arranque
En caso de rearranque del FM 355-2 tras Power OFF, los conmutadores de simulaci√≥n del
FM 355-2 vuelven a estar en FALSE.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6729

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de FMT_PV
Tabla 4-332
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

S_AION

0.0

ARRA
Y [0..3]
of
BOOL

FAL‚Äê
SE

Si p. ej. el conmutador S_AION[1] adopta el estado TRUE, en lugar del valor de
entrada anal√≥gica 1 del m√≥dulo se utiliza el valor PV_SIM[1].

S_PVON

2.0

ARRA
Y [0..3]
of
BOOL

FAL‚Äê
SE

Si p. ej. el selector S_PVON[1] adopta el estado TRUE, en lugar del valor acon‚Äê
dicionado de entrada anal√≥gica 1 del m√≥dulo se utiliza el valor PV_SIM[1].

PV_SIM

4.0

ARRA
Y [0..3]
of
REAL

0.0

En la entrada PV_SIM[1] se predetermina p. ej., el valor de simulaci√≥n para la
entrada anal√≥gica 1. Si S_PVON = TRUE, entonces se especifica aqu√≠ el valor de
entrada anal√≥gica acondicionado. Si S_PVON = FALSE y S_AION = TRUE, en‚Äê
tonces se especifica aqu√≠ el valor de entrada anal√≥gica en mA o mV, que se
convierte en un valor acondicionado mediante funciones de acondicionamiento.
0.0 a 20.0 [mA] o
-1500 hasta +10000 [mV] o rango de valores t√©cnico

S_DION

20.0

ARRA
Y [0..7]
of
BOOL

FAL‚Äê
SE

DI_SIM

22.0

ARRA
Y [0..7]
of
BOOL

FAL‚Äê
SE

INT

256

MOD_ADDR 24.0

Si p. ej. S_DION[1] se pone en TRUE, en lugar de la entrada digital 1 del m√≥dulo
se utiliza el valor DI_SIM[1] como valor digital.

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configura‚Äê
ci√≥n con STEP 7.

Consulte tambi√©n
Par√°metros de salida de FMT_PV (P√°gina 6731)
Par√°metros de entrada/salida de FMT_PV (P√°gina 6731)

6730

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de salida de FMT_PV
Tabla 4-333
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

26.0

ARRA
Y [0..7]
of
BOOL

FAL‚Äê
SE

En los par√°metros STAT_DI se muestran los estados de las entradas digitales 0
a 7.

DIAG[x].PV_ 28+
PER
(N√∫‚Äê
mero
de ca‚Äê
nal x8)

ARRA
Y [0..3]
of
STRU
CT

0.0

En el par√°metro DIAG[x].PV_PER se muestra p. ej. el valor de entrada anal√≥gica
del m√≥dulo en la unidad mA o mV.

DIAG[x].PV_ 32+
PHY
(N√∫‚Äê
mero
de ca‚Äê
nal x8)

ARRA
Y [0..3]
of
STRU
CT

0.0

En el par√°metro DIAG[x].PV_PHY se muestra p. ej. el valor acondicionado de
entrada anal√≥gica del m√≥dulo en unidad f√≠sica.

RET_VALU

WORD

W#16
#0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC.

STAT_DI

60.0

Descripci√≥n

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

Par√°metros de entrada/salida de FMT_PV
Tabla 4-334
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

LOAD_PV

62.0

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida LOAD_PV est√° activado, los valores de simu‚Äê
laci√≥n de PV_SIM y DI_SIM se escriben en el FM 355-2 conforme a las posiciones
de los conmutadores y el par√°metro de entrada/salida se desactiva.

READ_PV

62.1

BOOL

FAL‚Äê
SE

Si el par√°metro READ_PV = TRUE, la temperatura de uni√≥n fr√≠a se lee del m√≥dulo.
A continuaci√≥n se desactiva el par√°metro de entrada/salida.

Consulte tambi√©n
Par√°metros de entrada de FMT_PV (P√°gina 6730)
Par√°metros de salida de FMT_PV (P√°gina 6731)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6731

Instrucciones
4.2 Instrucciones

FMT_CJ_T
Descripci√≥n de FMT_CJ_T
La instrucci√≥n FMT_CJ_T permite leer la temperatura de uni√≥n fr√≠a y cambiar online la
temperatura de uni√≥n fr√≠a parametrizada. Esto es necesario si una regulaci√≥n de temperatura
debe funcionar con varios FM 355-2 con entradas de termopar sin necesidad de conectar un
Pt 100 en cada FM 355-2.

Llamada
FMT_PAR debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 355-2.
Si se utiliza el FM 355-2 en periferia descentralizada, pueden ser necesarios varios ciclos
hasta que el par√°metro se haya transmitido al FM 355-2. Hasta que la transmisi√≥n no haya
finalizado, el par√°metro LOAD_CJ mantiene el valor TRUE. Por ello, para modificar
par√°metros llame FMT_CJ_T de forma repetida hasta que el bloque active LOAD_CJ = FALSE.

Funcionamiento
Si p. ej. en una regulaci√≥n de extrusionador con m√°s de cuatro zonas calientes la temperatura
de las uniones fr√≠as se mide con un FM 355-2, puede leerse con READ_CJ = TRUE en el
par√°metro CJ_T_OUT y parametrizarse en el otro FM 355-2 a trav√©s de CJ_TEMP y LOAD_CJ.
En el par√°metro CJ_T_OUT est√° depositada la temperatura medida en la uni√≥n fr√≠a en grados
¬∞C o ¬∞F (depende de la unidad de temperatura parametrizada).
En el par√°metro CJ_T_OUT se indica 0.0 si:
‚óè No se ha parametrizado un tipo de sensor "Termopar"
‚óè En todas las entradas anal√≥gicas se ha seleccionado la temperatura de uni√≥n fr√≠a
parametrizada
‚óè En todas las entradas anal√≥gicas se ha seleccionado la compensaci√≥n interna

Par√°metros de entrada de FMT_CJ_T
Tabla 4-335
Par√°metro

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

MOD_ADDR 0.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configura‚Äê
ci√≥n con STEP 7.

CJ_TEMP

REAL

0.0

En el par√°metro CJ_TEMP se puede predeterminar la temperatura de las uniones
fr√≠as.

6732

Direc‚Äê
ci√≥n

2.0

Descripci√≥n

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de salida de FMT_CJ_T
Tabla 4-336
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

CJ_T_OUT

6.0

REAL

0.0

En la salida CJ_T_OUT se muestra la temperatura de uni√≥n fr√≠a medida por el
m√≥dulo si se ha parametrizado una entrada de termopar y si la temperatura de
uni√≥n fr√≠a no se predetermina de forma parametrizada.

RET_VALU

10.0

WORD

W#16
#0

RET_VALU contiene los bytes 2¬∫ y 3¬∫ del par√°metro STATUS de las instrucciones
RDREC y WRREC.

Consulte tambi√©n
RDREC: Leer registro (P√°gina 5888)
WRREC: Escribir registro (P√°gina 5890)

Par√°metros de entrada/salida FMT_CJ_T
Tabla 4-337
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

LOAD_CJ

12.0

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida LOAD_CJ est√° activado, la temperatura de
uni√≥n fr√≠a parametrizada en el m√≥dulo se sobrescribe con el valor CJ_TEMP y el
par√°metro de entrada/salida se desactiva.

READ_CJ

12.1

BOOL

FAL‚Äê
SE

Si el par√°metro READ_CJ = TRUE, la temperatura de uni√≥n fr√≠a se lee del m√≥dulo.
A continuaci√≥n se desactiva el par√°metro de entrada/salida.

FM 455 PID Control
PID_FM_455
Descripci√≥n de PID_FM_455
La instrucci√≥n PID_FM_455 permite realizar las siguientes acciones durante el
funcionamiento:
‚óè Transferir par√°metros de operaci√≥n al FM 455
‚óè Transferir par√°metros de regulador al FM 455
‚óè Leer valores del proceso del FM 455
Los par√°metros de operaci√≥n son todos los par√°metros de entrada/salida que se encuentran
en el DB de instancia de la instrucci√≥n entre los par√°metros op_par y cont_par.
Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6733

Instrucciones
4.2 Instrucciones
Los par√°metros de regulaci√≥n son todos los par√°metros de entrada/salida que se encuentran
en el DB de instancia de la instrucci√≥n despu√©s del par√°metro cont_par.
Los valores del proceso son todos los par√°metros de salida de la instrucci√≥n situados despu√©s
del par√°metro out_par.
Los datos necesarios se depositan en un DB de instancia en la CPU. Para cada canal de
regulaci√≥n utilizado se requiere un DB de instancia. Tras generar un DB de instancia, todos los
par√°metros de entrada/salida tienen asignado el valor FALSE.

Llamada
PID_FM_455 se llama generalmente en el OB 35 de alarma c√≠clica y requiere una marcha de
inicializaci√≥n, que se inicia activando el par√°metro COM_RST = TRUE en el arranque de la
CPU. Es posible realizar una llamada de la instrucci√≥n en el OB de arranque, pero no es
necesario. Tras la marcha de inicializaci√≥n, PID_FM_455 pone el par√°metro COM_RST en
FALSE.
PID_FM_455 debe llamarse en el mismo OB que todas las instrucciones restantes que
acceden al mismo FM 455.
Si se efect√∫a una llamada a la instrucci√≥n PID_FM_455 como DB multiinstancia, no se dispone
de interfaz de puesta en servicio. En este caso, los FM 455 se deben poner en servicio a trav√©s
de una tabla de observaci√≥n.

Arranque
En el arranque y en la transici√≥n de STOP a RUN de la CPU, los par√°metros del FM 455 se
sobrescriben con los par√°metros del SDB de la CPU.

Respuesta en caso de error
El par√°metro de salida RET_VALU contiene el valor de respuesta RET_VAL de las
instrucciones RD_REC y WR_REC. RET_VALU puede evaluarse si los par√°metros
READ_VAR y LOAD_PAR no se desactivan.
En la llamada de la instrucci√≥n PID_FM_455 puede producirse un error de acceso a la periferia,
si el FM 455 no est√° insertado o si no recibe suministro de tensi√≥n. En ese caso, la CPU pasa
a STOP si no hay ning√∫n OB 122 cargado en la CPU.

Funcionamiento de PID_FM_455
Influencia de los par√°metros LOAD_OP, READ_VAR y LOAD_PAR
En la marcha de inicializaci√≥n, PID_FM_455 lee los par√°metros de los datos del sistema y los
deposita en el DB de instancia. El DB de instancia y los datos del sistema est√°n sincronizados.

6734

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
La tabla siguiente muestra c√≥mo afectan los par√°metros LOAD_OP, READ_VAR y
LOAD_PAR al funcionamiento de la instrucci√≥n.
Par√°metro

TRUE

FALSE

LOAD_OP

Transferencia de los par√°metros de operaci√≥n de la
CPU al FM 455 con la instrucci√≥n WR_REC

Transferencia de los par√°metros de operaci√≥n de la
CPU al FM 455 con accesos de periferia directos en
el proceso multiplex

Tiempo de operaci√≥n largo

Tiempo de operaci√≥n reducido

Los valores son efectivos tras un ciclo de la CPU o el
FM. Rige el ciclo m√°s largo.

Como m√°ximo se requieren 3 ciclos de la CPU o del
FM para que los valores sean efectivos. Rige el ciclo
m√°s largo

Lectura de los valores del proceso del FM 455 con la
instrucci√≥n RD_REC

Lectura de los par√°metros del proceso del FM 455
con accesos directos a la periferia en el proceso mul‚Äê
tiplex

Tiempo de ejecuci√≥n prolongado

Tiempo de ejecuci√≥n reducido

Todos los par√°metros se leen del FM 455

Los siguientes par√°metros no se leen del FM 455

READ_VAR

‚óè SP (consigna del FM)
‚óè ER (error de regulaci√≥n)
‚óè DISV (magnitud perturbadora)
‚óè LMN_A
‚óè LMN_B
Los siguientes par√°metros se actualizan en cada lla‚Äê Los siguientes par√°metros se actualizan cada cuatro
llamadas de la instrucci√≥n.
mada de la instrucci√≥n.
‚óè PV (valor real)

‚óè PV (valor real)

‚óè LMN (variable manipulada)

‚óè LMN (variable manipulada)

‚óè Las indicaciones binarias

‚óè Las indicaciones binarias

En el arranque de la CPU PID_FM_455 adopta los
siguientes valores del FM 455:

En el arranque de la CPU, los siguientes valores se
leen de la instrucci√≥n y no del FM:

‚óè SP_OP

‚óè SP_OP

‚óè LMN_OP

‚óè LMN_OP

‚óè SP_OP_ON

‚óè SP_OP_ON

‚óè LMNOP_ON

‚óè LMNOP_ON

Si estos valores se han cambiado en la CPU, en el
primer arranque de la CPU se sobrescriben con los
valores del FM 455
LOAD_PAR

Todos los par√°metros de regulaci√≥n de la CPU se
cargan en el FM 455. Esta acci√≥n es conveniente si
los par√°metros de regulaci√≥n deben cambiarse con
dependencia de los estados del proceso.

Sin transmisi√≥n de los par√°metros del regulador

Una vez completada de transmisi√≥n de datos, los par√°metros LOAD_OP, READ_VAR y
LOAD_PAR se vuelven a poner a FALSE.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6735

Instrucciones
4.2 Instrucciones

Particularidades de la transmisi√≥n en el proceso multiplex
La multiplexaci√≥n de los datos que se van a transmitir en el acceso al FM 455 con accesos
directos a la periferia se controla con PID_FM_455. El control de multiplexaci√≥n con
PID_FM_455 no funciona si dos instancias de la instrucci√≥n PID_FM_455 acceden al mismo
n√∫mero de canal de un m√≥dulo. El resultado son par√°metros incorrectos en el FM 455 (p. ej.
consigna y variable manipulada en manual) e indicaciones err√≥neas en los par√°metros de
salida de la instrucci√≥n PID_FM_455.

Almacenamiento de los par√°metros en la EEPROM
En la reparametrizaci√≥n controlada por programa (LOAD_PAR, LOAD_OP) del m√≥dulo
regulador con la instrucci√≥n PID_FM_455, aumenta su tiempo de operaci√≥n. Los par√°metros
nuevos siempre tienen vigencia inmediata y adem√°s se depositan en una memoria no vol√°til
(EEPROM). Tras cada almacenamiento de los par√°metros en la EEPROM, el siguiente se
retrasa 30 minutos, ya que la vida √∫til de la EEPROM est√° limitada por el n√∫mero de procesos
de escritura. Tras una recuperaci√≥n de la tensi√≥n de alimentaci√≥n se pueden guardar nuevos
par√°metros de inmediato en la EEPROM. La selecci√≥n de los par√°metros determina si la
reparametrizaci√≥n del m√≥dulo regulador con la instrucci√≥n PID_FM_455 ser√° con o sin
discontinuidad.

Tiempos de ejecuci√≥n de PID_FM_455
Condiciones marco

Tiempo de ejecuci√≥n en

READ_VAR

LOAD_OP

LOAD_PAR

CPU 414-2DP

FALSE

FALSE

FALSE

0,077 ms

TRUE

FALSE

FALSE

2,36 ms

TRUE*)

TRUE

FALSE

4,48 ms

FALSE

FALSE

TRUE

2,59 ms

TRUE

FALSE

TRUE

5,15 ms

TRUE

TRUE

7,1 ms

TRUE*)

*) Si LOAD_OP = TRUE, PID_FM_455 tambi√©n pone READ_VAR en TRUE.

6736

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de PID_FM_455
Tabla 4-338
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

MOD_ADD
R

0.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

CHANNEL

2.0

INT

1

En la entrada "N√∫mero de canal" se parametriza el n√∫mero del canal de regulador
al que se refiere el DB de instancia.
Se admiten los valores 1 a 16.

PHASE

4.0

INT

0

El par√°metro PHASE puede interconectarse con el par√°metro de salida PHASE de
las instrucciones TUN_EC o TUN_ES (PID Self-Tuner). En el cuadro de di√°logo
"Puesta en servicio" se puede visualizar el estado de fase del PID Self-Tuner en
texto compresible. Este par√°metro es irrelevante para el OP.

Par√°metros de salida de PID_FM_455
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

RET_VALU

6.0

WORD

0

RET_VALU contiene el valor de respuesta RET_VAL de las instrucciones
WR_REC y RD_REC. RET_VALU puede evaluarse si se notifica un error a trav√©s
de QMOD_F.

out_par

8.0

WORD

W#16
#3130

El par√°metro out_par no puede ser modificado por el usuario. Identifica el inicio de
los par√°metros de salida que lee el m√≥dulo cuando se activa READ_VAR = TRUE.

SP

10.0

REAL

0.0

En la salida "Consigna" se indica la consigna que act√∫a efectivamente.

PV

14.0

REAL

0.0

En la salida "Valor real" se indica el valor real que act√∫a efectivamente.

ER

18.0

REAL

0.0

En la salida "Error de regulaci√≥n" se indica el error de regulaci√≥n que act√∫a real‚Äê
mente.

DISV

22.0

REAL

0.0

En la salida "Variable perturbadora" se indica la magnitud perturbadora que act√∫a
efectivamente.
Se admiten valores entre -100 y 100 %.

LMN

26.0

REAL

0.0

En la salida "Variable manipulada" se indica la variable manipulada que act√∫a
efectivamente. En el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥‚Äê
gica, en el par√°metro LMN se indica la acci√≥n P + D ilimitada.
Se admiten valores entre -100 y 100 %.

LMN_A

30.0

REAL

0.0

En la salida "Variable manipulada A de la funci√≥n de rango partido / realimentaci√≥n
de posici√≥n" se indica la variable manipulada A de la funci√≥n de rango partido en
el regulador continuo, y la realimentaci√≥n de posici√≥n en el regulador paso a paso
con realimentaci√≥n de posici√≥n anal√≥gica.
La salida LMN_A s√≥lo puede utilizarse para la indicaci√≥n aproximada de una mag‚Äê
nitud manipulada simulada correspondiente. La variable manipulada LMNRSVAL
de la realimentaci√≥n de posici√≥n simulada debe parametrizarse de la forma co‚Äê
rrespondiente, y es efectivo al activar LMNRS_ON.
Se admiten valores entre -100 y 100 %.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6737

Instrucciones
4.2 Instrucciones
Par√°metro

LMN_B

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

34.0

REAL

0.0

Descripci√≥n

Para el regulador continuo, en la salida "Variable manipulada B de la funci√≥n de
rango partido" se indica la variable manipulada B de la funci√≥n de rango partido.
Se admiten valores entre -100 y 100 %.

QH_ALM

38.0

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Alarma de l√≠mite superior disparada" se notifica el rebase del l√≠mite
H_ALM.

QH_WRN

38.1

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Advertencia de l√≠mite superior disparada" se notifica el rebase del
l√≠mite H_WRN.

QL_WRN

38.2

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Advertencia de l√≠mite inferior disparada" se notifica el rebase por
defecto del l√≠mite L_WRN.

QL_ALM

38.3

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Alarma de l√≠mite inferior disparada" se notifica el rebase por defecto
del l√≠mite L_ALM.

QLMN_HLM 38.4

BOOL

FAL‚Äê
SE

La variable manipulada est√° limitado siempre por un l√≠mite superior y uno inferior.
En la salida "L√≠mite superior de la variable manipulado alcanzado" se notifica el
rebase del l√≠mite superior.

QLMN_LLM

BOOL

FAL‚Äê
SE

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
38.5

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La salida "L√≠mite inferior de la variable manipulada alcanzado" indica el rebase por
defecto del l√≠mite inferior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

QPARA_F

38.6

BOOL

FAL‚Äê
SE

El m√≥dulo comprueba la validez de los par√°metros. Un error de parametrizaci√≥n se
indica en la salida "Error de parametrizaci√≥n". Este error de parametrizaci√≥n tam‚Äê
bi√©n se puede ver en el cuadro de di√°logo "Online y diagn√≥stico" del m√≥dulo.

QCH_F

38.7

BOOL

FAL‚Äê
SE

La salida "Error de canal" se activa cuando el canal de regulaci√≥n no puede arrojar
resultados v√°lidos. El error de canal (p. ej. rotura de hilo) tambi√©n se activa con
QPARA_F = 1 o QMOD_F = 1. Si QCH_F = TRUE, la informaci√≥n precisa del error
puede verse en el registro de diagn√≥stico DS1 del m√≥dulo.

QUPRLM

39.0

BOOL

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada. Si la salida "Limitaci√≥n
positiva de rampa de subida de la consigna" est√° activada, se limita la rampa de
subida de la consigna.

QDNRLM

39.1

BOOL

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada. Si la salida "Limitaci√≥n
negativa de rampa de subida de la consigna" est√° activada, se limita la rampa de
bajada de la consigna.

QSP_HLM

39.2

BOOL

FAL‚Äê
SE

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. En la salida
"L√≠mite superior de consigna alcanzado" se notifica el rebase del l√≠mite superior.

QSP_LLM

39.3

BOOL

FAL‚Äê
SE

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La salida
"L√≠mite inferior de la consigna alcanzado" indica el rebase del l√≠mite inferior.

QLMNUP

39.4

BOOL

FAL‚Äê
SE

Se trata de la salida "Se√±al alta de variable manipulada".

FAL‚Äê
SE

Se trata de la salida "Se√±al baja de variable manipulada".

QLMNDN

6738

39.5

BOOL

(S√≥lo en regulador paso a paso o de impulsos)
(S√≥lo en regulador paso a paso o de impulsos)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

QID

39.6

BOOL

FAL‚Äê
SE

QID = TRUE indica que hay una identificaci√≥n en curso (no que est√© activada). Una
vez completada la identificaci√≥n, el resultado puede verse a trav√©s del par√°metro
IDSTATUS de la instrucci√≥n CH_DIAG_455.

QSPOPON

40.0

BOOL

FAL‚Äê
SE

En la salida "Control manual de consigna activado" se indica si la consigna se
controla mediante la herramienta de configuraci√≥n. Si el bit est√° activado, el valor
SP_OP se aplica como consigna.

QLMNSAFE 40.1

BOOL

FAL‚Äê
SE

Si la salida "Modo de seguridad" est√° activada, como variable manipulada se emite
la variable manipulada de seguridad.

QLMNO‚Äê
PON

40.2

BOOL

FAL‚Äê
SE

En la salida "Control manual de variable manipulada activado" se indica si la va‚Äê
riable manipulada se controla desde la herramienta de configuraci√≥n. Si el bit est√°
activado, el valor LMN_OP se aplica como variable manipulada.

QLMNTRK

40.3

BOOL

FAL‚Äê
SE

La salida "Modo de seguimiento" indica si la variable manipulada se corrige me‚Äê
diante una entrada anal√≥gica.

QLMN_RE

40.4

BOOL

FAL‚Äê
SE

La salida "Manual = 1; Autom√°tico = 0" indica si la variable manipulada adopta la
variable manipulada externa LMN_RE (Manual = 1) o no.

QLMNR_HS 40.5

BOOL

FAL‚Äê
SE

La salida "Se√±al de tope superior de la realimentaci√≥n de posici√≥n" indica si la
servov√°lvula se encuentra en el tope superior. QLMNR_HS = TRUE significa: La
servov√°lvula se encuentra en el tope superior.
(S√≥lo en regulador paso a paso)

QLMNR_LS

40.6

BOOL

FAL‚Äê
SE

La salida "Se√±al de tope inferior de la realimentaci√≥n de posici√≥n" indica si la
servov√°lvula se encuentra en el tope inferior. QLMNR_LS = TRUE significa: La
servov√°lvula se encuentra en el tope inferior.

QLMNR_O
N

40.7

BOOL

FAL‚Äê
SE

La salida "Realimentaci√≥n de posici√≥n activada" indica que est√° activado el modo
de operaci√≥n "Regulador paso a paso con realimentaci√≥n de posici√≥n" o "Regula‚Äê
dor paso a paso sin realimentaci√≥n de posici√≥n".

QFUZZY

41.0

BOOL

FAL‚Äê
SE

Si el par√°metro de salida QFUZZY = 1, el regulador funciona con el algoritmo
difuso.

QSPLEPV

41.1

BOOL

FAL‚Äê
SE

La salida "Indicaci√≥n del regulador difuso: consigna < valor real" se activa con el
regulador difuso si la consigna es menor que el valor real efectivo.

QSPR

41.2

BOOL

FAL‚Äê
SE

Si la salida "Modo de rango partido" est√° activada, el regulador continuo trabaja en
modo de rango partido.

QMAN_FC

41.4

BOOL

FAL‚Äê
SE

La salida "QMAN_FC" se activa en los siguientes casos:

(S√≥lo en regulador paso a paso)

‚óè El regulador secundario est√° en modo manual y el regulador piloto se rige por
el valor real del secundario.
‚óè La acci√≥n I del regulador piloto se detiene porque la consigna o la magnitud
manipulada del regulador secundario est√°n en el l√≠mite o porque el regulador
secundario se encuentra en modo manual.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6739

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

QPARABUB 41.7

BOOL

FAL‚Äê
SE

El FM activa este par√°metro cuando se han cambiado par√°metros de operaci√≥n
desde un OP. Si READ_VAR = TRUE y el FM activa esta indicaci√≥n, la instrucci√≥n
PID_FM_455 lee los par√°metros SP_OP_ON, LMNOP_ON, SP_OP y LMN_OP del
FM y los deposita en el DB de instancia. La instrucci√≥n adopta as√≠ el estado de
operaci√≥n del FM. Tras el proceso de lectura, el par√°metro adopta el estado FAL‚Äê
SE.

QMOD_F

BOOL

FAL‚Äê
SE

La instrucci√≥n comprueba si los procesos de escritura y lectura de un registro han
finalizado correctamente. Si se detectan errores, se activa la salida "Error de m√≥‚Äê
dulo". La causa puede ser: Una direcci√≥n de m√≥dulo incorrecta en el par√°metro
MOD_ADDR, un n√∫mero de canal incorrecto en el par√°metro CHANNEL o un
m√≥dulo defectuoso.

42.0

Descripci√≥n

Consulte tambi√©n
RD_REC: Leer registro de periferia (P√°gina 5922)
WR_REC: Escribir registro en periferia (P√°gina 5927)

Par√°metros de entrada/salida de PID_FM_455
Tabla 4-339
Par√°metro

1)

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

Valores predeterminados del m√≥dulo tras la primera llamada del PID_FM_455 con COM_RST = TRUE

COM_RST

44.0

BOOL

FAL‚Äê
SE

Si el par√°metro es COM_RST = TRUE, la instrucci√≥n PID_FM_455 realiza una
marcha de inicializaci√≥n. En ella se leen del FM los par√°metros del regulador (que
son todos los par√°metros posteriores a cont_par) y se depositan en el DB de
instancia. Adem√°s se comprueba la validez de los par√°metros MOD_ADDR y
CHANNEL. Tras la marcha de inicializaci√≥n, el par√°metro adopta el estado FALSE.

LOAD_OP

44.1

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida "Cargar par√°metros operativos en el FM 455"
est√° activado, los par√°metros operativos se cargan en el m√≥dulo y el par√°metro de
entrada/salida se desactiva.

READ_VAR

44.2

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida "Leer variables del FM 455" est√° activado, los
par√°metros de salida se leen del m√≥dulo y el par√°metro de entrada/salida se de‚Äê
sactiva.

LOAD_PAR

44.3

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida "Cargar par√°metros de regulaci√≥n en el FM 455"
est√° activado, los par√°metros de regulaci√≥n se cargan en el m√≥dulo y el par√°metro
de entrada/salida se desactiva.

op_par

46.0

WORD

W#16
#3130

El par√°metro op_par no puede ser modificado por el usuario. Identifica el inicio de
los par√°metros de operaci√≥n, que se transfieren al m√≥dulo si se activa LOAD_OP
= TRUE. El final de los par√°metros de operaci√≥n se identifica con cont_par.

0.0

En la entrada "Consigna externa" se conecta una consigna externa con el regula‚Äê
dor.

1)

SP_RE

6740

48.0

REAL

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

LMN_RE

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

52.0

REAL

0.0

Descripci√≥n

En la entrada "Variable manipulada externa" se conecta una variable manipulada
externa con el regulador.
Se admiten valores entre -100 y 100 %.

SP_OP_ON

56.0

BOOL

FAL‚Äê
SE

Las instrucciones del PID Self-Tuner tienen acceso al par√°metro de entrada/salida
"Activar control manual de consigna". Si el bit est√° activado, el valor SP_OP se
aplica como consigna.

SAFE_ON

56.1

BOOL

FAL‚Äê
SE

Si la entrada "Adoptar posici√≥n de seguridad" est√° activada, se aplica un valor de
seguridad como variable manipulada.
Nota: El procesamiento de la se√±al de salida con LMNDN_OP, LMNUP_OP y
LMNSOPON en el regulador paso a paso tiene mayor prioridad que la variable
manipulada de seguridad.

LMNOP_ON 56.2

BOOL

FAL‚Äê
SE

Las instrucciones del PID Self-Tuner tienen acceso al par√°metro de entrada/salida
"Activar control manual de variable manipulada". Si el bit est√° activado, el valor
LMN_OP se aplica como variable manipulada.

LMNTRKO
N

BOOL

FAL‚Äê
SE

Si la entrada "Corregir (LMN a trav√©s de EA)" est√° activada, la variable manipulada
se rige por una entrada anal√≥gica (EA).

56.3

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
LMN_REON 56.4

BOOL

FAL‚Äê
SE

Si la entrada "Aplicar variable manipulada externa" est√° activada, se aplica la
variable manipulada externa LMN_RE como variable manipulada.

LMNRHSR
E

BOOL

FAL‚Äê
SE

La se√±al "Servov√°lvula en el tope superior" se interconecta a la entrada "Se√±al de
tope superior de la realimentaci√≥n de posici√≥n". LMNRHSRE = TRUE significa: La
servov√°lvula se encuentra en el tope superior.

56.5

(S√≥lo en regulador paso a paso)
LMNRLSRE 56.6

BOOL

FAL‚Äê
SE

LMNSO‚Äê
PON

BOOL

FAL‚Äê
SE

La se√±al "Servov√°lvula en el tope inferior" se aplica en la entrada "Se√±al de tope
inferior de la realimentaci√≥n de posici√≥n". LMNRLSRE = TRUE significa: La ser‚Äê
vov√°lvula se encuentra en el tope inferior.
(S√≥lo en regulador paso a paso)

56.7

Las instrucciones del PID Self-Tuner tienen acceso a la entrada "Activar control
manual de se√±al de variable manipulada". Si LMNSOPON est√° activado, las se‚Äê
√±ales LMNUP_OP y LMNDN_OP se aplican como se√±ales de variable manipulada.
(S√≥lo en regulador paso a paso)

LMNUP_OP 57.0

BOOL

FAL‚Äê
SE

Las instrucciones del PID Self-Tuner tienen acceso a la entrada "Subir se√±al de
variable manipulada". Si LMNSOPON est√° activado, el valor se adopta como se√±al
de variable manipulada en la entrada "Subir se√±al de variable manipulada".
(S√≥lo en regulador paso a paso)

LMNDN_OP 57.1

BOOL

FAL‚Äê
SE

Las instrucciones del PID Self-Tuner tienen acceso a la entrada "Bajar se√±al de
variable manipulada". Si LMNSOPON est√° activado, el valor se adopta como se√±al
de variable manipulada en la entrada "Bajar se√±al de variable manipulada".
(S√≥lo en regulador paso a paso)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6741

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

LMNRS_ON 57.3

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

BOOL

FAL‚Äê
SE

Descripci√≥n

Si no se dispone de una realimentaci√≥n de posici√≥n, puede simularse. La funci√≥n
"Activar simulaci√≥n de la realimentaci√≥n de posici√≥n" se activa en la entrada. Tam‚Äê
bi√©n las instrucciones del PID Self-Tuner tienen acceso a este par√°metro, ya que
para la optimizaci√≥n se requiere como m√≠nimo una variable manipulada simulada
si se ha parametrizado un regulador paso a paso sin realimentaci√≥n de posici√≥n. El
valor simulado se muestra en el par√°metro LMN_A. Al activar la simulaci√≥n, el valor
del par√°metro LMNRSVAL se activa como valor inicial.
ATENCI√ìN: Con el paso del tiempo, la simulaci√≥n difiere cada vez m√°s de la
realimentaci√≥n de posici√≥n real.
(S√≥lo en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

FUZID_ON

57.4

BOOL

FAL‚Äê
SE

En la entrada "Activar identificaci√≥n de difuso" se activa la identificaci√≥n del algo‚Äê
ritmo difuso.

SP_OP

58.0

REAL

0.0

Las instrucciones del PID Self-Tuner tienen acceso al par√°metro de entrada/salida
"Control manual de consigna". Si el bit SP_OP_ON est√° activado, se aplica el valor
"Control manual de consigna" como consigna.

LMN_OP)

62.0

REAL

0.0

Las instrucciones del PID Self-Tuner tienen acceso al par√°metro de entrada/salida
"Control manual de variable manipulada". Si el bit LMNOP_ON est√° activado, el
valor "Control manual de variable manipulada" se aplica como variable manipula‚Äê
da.

LMNRSVAL

66.0

REAL

0.0

Las instrucciones del PID Self-Tuner tienen acceso a la entrada "Valor inicial de la
realimentaci√≥n de posici√≥n simulada". En ese par√°metro se indica el valor inicial de
la simulaci√≥n.

Se admiten valores entre -100 y 100 %.

(S√≥lo en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores entre -100 y 100 %.
cont_par

70.0

WORD

W#16
#3130

El par√°metro cont_par no puede ser modificado por el usuario. Identifica el inicio de
los par√°metros de regulador, que se leen del FM y se depositan en el DB de
instancia si COM_RST = TRUE, y que se transmiten al FM si LOAD_PAR = TRUE
se activa. El final de los par√°metros de regulador es el final del DB de instancia.

1)

P_SEL

72.0

BOOL

TRUE

En el algoritmo PID las acciones PID se pueden conectar y desconectar indivi‚Äê
dualmente. La acci√≥n proporcional est√° conectada si la entrada "Activar acci√≥n P"
est√° activada.

PFDB_SEL

72.1

BOOL

FAL‚Äê
SE1)

En el algoritmo PID las acciones P y D se pueden incluir en el lazo de realimenta‚Äê
ci√≥n. La acci√≥n proporcional se encuentra en el lazo de realimentaci√≥n si la entrada
"Incluir acci√≥n P en lazo de realimentaci√≥n" est√° activada.

MONER‚Äê
SEL

72.2

BOOL

FAL‚Äê
SE1)

El regulador dispone de un avisador de valor l√≠mite, que puede utilizarse para el
valor real o para el error de regulaci√≥n. Si la entrada "Vigilancia: Valor real = 0, Error
de regulaci√≥n = 1" est√° activada, se vigila el error de regulaci√≥n.

SDB_SEL

72.4

BOOL

FAL‚Äê
SE

SDB_SEL=TRUE: los par√°metros de regulador de la instrucci√≥n PID_FM_455 no
se sobrescriben en el FMx55 con los par√°metros de SDB tras una transici√≥n de
STOP a RUN de la CPU.

D_EL_SEL

74.0

INT

01)

El componente D del algoritmo PID puede depositarse en una entrada separada.
√âsta se selecciona en la entrada "Entrada para componente D".

1)

‚óè 0: Error de regulaci√≥n
‚óè 1 a 16: Entrada anal√≥gica 1 a 16
‚óè 17: Valor real negativo, acci√≥n D en el lazo de realimentaci√≥n

6742

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

SP_HLM

76.0

REAL

100.01) La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La entrada
"L√≠mite superior consigna" indica el l√≠mite superior.

SP_LLM

80.0

REAL

0.0

H_ALM

84.0

REAL

100.01) Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Alarma de l√≠mite superior" indica el l√≠mite m√°s alto.

H_WRN

88.0

REAL

90.01)

L_WRN

92.0

REAL

10.0

L_ALM

96.0

REAL

0.01)

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Alarma de l√≠mite superior" indica el l√≠mite m√°s bajo.

HYS

100.0

REAL

1.01)

Para evitar oscilaciones de las indicaciones de vigilancia, puede parametrizarse
una hist√©resis en la entrada "Hist√©resis".

DEADB_W

104.0

REAL

0.0

1)

1)

SP_HLM > SP_LLM
La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La entrada
"L√≠mite inferior consigna" indica el l√≠mite inferior.

1)

SP_LLM < SP_HLM

H_ALM > H_WRN
Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Advertencia de l√≠mite superior" indica el segundo l√≠mite
m√°s alto.
Se admiten valores entre H_ALM y L_WRN
Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Advertencia de l√≠mite inferior" indica el segundo l√≠mite
m√°s bajo.

1)

Se admiten valores entre H_WRN y L_ALM

L_ALM < L_WRN

HYS ‚â• 0.0
El error de regulaci√≥n se conduce por una zona muerta. La entrada "Ancho de zona
muerta" determina el tama√±o de la zona muerta.
DEADB_W ‚â• 0.0
GAIN

108.0

REAL

1.0

TI

112.0

REAL

3000.
01)

TD

116.0

REAL

0.01)

TM_LAG

120.0

REAL

5.01)

LMN_SAFE

124.0

REAL

0.0

LMN_HLM

128.0

REAL

100.0

La entrada "Ganancia proporcional" indica la ganancia del regulador.
La entrada "Tiempo de integraci√≥n" determina el comportamiento temporal del
integrador. Con TI = 0 el integrador est√° desactivado.
TI = 0.0 o bien TI ‚â• 0.5
La entrada "Tiempo de acci√≥n derivada" determina el comportamiento temporal del
diferenciador. Con TD = 0 el diferenciador est√° desactivado.
TD = 0.0 o bien TD ‚â• 1.0
El algoritmo de la acci√≥n D contiene un retardo que se puede parametrizar en la
entrada "Tiempo de retardo de la acci√≥n D".
TM_LAG ‚â• 0.5
Para la variable manipulada puede parametrizarse un valor de seguridad en la
entrada "Variable manipulada de seguridad".

1)

Se admiten valores entre -100 y 100 %.
1)

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite superior de la variable manipulada" indica el l√≠mite superior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores entre LMN_LLM y 100 %.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6743

Instrucciones
4.2 Instrucciones
Par√°metro

LMN_LLM

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

132.0

REAL

0.01)

Descripci√≥n

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite inferior de la variable manipulada" indica el l√≠mite inferior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores entre -100 y LMN_HLM.

MTR_TM

136.0

REAL

60.0

PULSE_TM

140.0

REAL

0.2

BREAK_TM

144.0

REAL

0.2

1)

En el par√°metro "Tiempo de posicionamiento del motor" se introduce el tiempo de
operaci√≥n de la servov√°lvula de un tope al otro.
(S√≥lo en regulador paso a paso)

1)

En el par√°metro "Duraci√≥n m√≠nima de impulso" se puede parametrizar una dura‚Äê
ci√≥n de impulso m√≠nima.
(S√≥lo en regulador paso a paso o de impulsos)

1)

En el par√°metro "Duraci√≥n m√≠nima de pausa" se puede parametrizar una duraci√≥n
de pausa m√≠nima.
(S√≥lo en regulador paso a paso o de impulsos)

Nota
Con LOAD_PAR = TRUE todos los par√°metros de regulaci√≥n se cargan de forma permanente
en la EEPROM del FM 455.
Con LOAD_OP = TRUE, s√≥lo la consigna SP_RE se carga permanentemente por medio de los
par√°metros operativos en la EEPROM del FM 455. A todos los par√°metros operativos
restantes se les asignan los valores 0 √≥ FALSE en el arranque del FM 455.
La EEPROM del m√≥dulo podr√≠a quedar destruida por un n√∫mero excesivo de procesos de
escritura. Para evitarlo, tras la escritura de la EEPROM el m√≥dulo retrasa una nueva escritura
30 minutos.

Diagramas de bloques de PID_FM_455
Sinopsis
En las siguientes figuras se representan los puntos en los que son efectivos los par√°metros de
la instrucci√≥n PID_FM_455.
Los par√°metros son efectivos en los mismos puntos en los reguladores de tres componentes,
de relaci√≥n, mixtos, de valor fijo o cascada. Esto tambi√©n rige para los par√°metros que est√°n
presentes por igual en el regulador continuo, en el regulador con salida de impulsos y en el
regulador paso a paso. Por ello no se representan todos los diagramas de bloques, y no todos
los par√°metros est√°n incluidos en todos los diagramas.
Sin embargo, todos los par√°metros de la instrucci√≥n PID_FM_455 est√°n contenidos en los
diagramas, excepto los par√°metros MOD_ADDR, CHANNEL, QMOD_F, QPARA_F, QCH_F,
QLMNR_ON, RET_VALU, COM_RST, LOAD_PAR, READ_VAR, LOAD_OP.

6744

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Efecto de los par√°metros de entrada
C√°lculo del error de regulaci√≥n en el regulador de valor fijo o cascada
63B+/0
63B//0

63B23

63B5(
&RQVLJQD

&RQPXWDU
FRQVLJDGH
VHJXULGDG

5DPSD

&RQVLJQD
HIHFWLYD

/LPLWDU

(UURUGH
UHJXODFL¬µQ

63B23B21
021(56(/

9DORUUHDO$

+B$/0
+B:51
/B:51
/B$/0
$ODUPD
+<6

9DORUUHDO
HIHFWLYR
(QWUDGD'
'B(/B6(/

0DJQLWXGSHUWXUEDGRUD

Diagrama de bloques del algoritmo de regulaci√≥n
)8=,'B21

&RQVLJQDHIHFWLYD
9DORUUHDOHIHFWLYR

'($'%B:
(UURUGH
UHJXODFL¬µQ

5HJXODGRUGH
WHPSHUDWXUD

9DORUPDQLSXODGRHIHFWLYR

*$,1 70B/$*
3B6(/
7,
3)'%B6(/
7'

=RQDPXHUWD

(QWUDGD'

6HJXLPLHQWRGHYDORUPDQLSXODGR

0DJQLWXGSHUWXUEDGRUD

salida del regulador K

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6745

Instrucciones
4.2 Instrucciones
/01B5(
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

/01B5(21

/0123B21
/01B23

&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

6$)(B21
/01B6$)(

/01B+/0
/01B//0

9DORU
PDQLSXODGR

/0175.21

&RQPXWDU
VHJXLPLHQWR

&RQPXWDU
/LPLWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

9DORUPDQLSXODGR$

5DQJRSDUWLGR

9DORUPDQLSXODGR%

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORU
PDQLSXODGR

salida del regulador S (modo de operaci√≥n Regulador de impulsos)
9DORU
PDQLSXODGR
H[WHUQR
&RQPXWDU
9DORU
PDQLSXODGR YDORU
PDQLSXODGR
HIHFWLYR
H[WHUQR

9DORU
PDQLSXODGR
&RQPXWDU
VHJXLPLHQWR

/LPLWDU
&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

38/6(B70
%5($.B70

5DQJRSDUWLGR
IRUPDGRUGH
LPSXOVRV

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORUPDQLSXODGR

salida del regulador S (modo de operaci√≥n Regulador paso a paso con realimentaci√≥n de
posici√≥n)

6746

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
9DORU
PDQLSXODGR
H[WHUQR
&RQPXWDU
9DORU
PDQLSXODGR YDORU
PDQLSXODGR
HIHFWLYR
H[WHUQR

075B70
38/6(B70
%5($.B70

9DORU
PDQLSXODGR
&RQPXWDU
VHJXLPLHQWR

/LPLWDU
&RQPXWDU
YDORUPDQLSX
ODGRGH
VHJXULGDG

)RUPD
GRUGH
LPSXO
VRV

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORUPDQLSXODGR

(QWUDGDGHUHVSXHVWDGHSRVLFL¬µQ

salida del regulador S (modo de operaci√≥n Regulador paso a paso sin realimentaci√≥n de
posici√≥n)
/01'1B23
/0183B23
/0162321
/0156B21
075B70
38/6(B70
%5($.B70
/01569$/

9DORUPDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

6H¬≥DOGHVDOLGD
$OWR

%DMD
&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

&RQPXWDUYDORU
PDQLSXODGRGH
VHJXULGDG

)RUPDGRUGH
LPSXOVRV
/015+65(
/015/65(

Generaci√≥n de los par√°metros de salida
En las siguientes figuras se representan los puntos del m√≥dulo en los que se generan los
par√°metros de salida de la instrucci√≥n PID_FM_455.
C√°lculo del error de regulaci√≥n en el regulador de valor fijo o cascada

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6747

Instrucciones
4.2 Instrucciones
4835/0
4'15/0

63B23

63B5(

&RQPXWDU
FRQVLJDGH
VHJXULGDG

&RQVLJQD

463+/0
463//0

5DPSD

/LPLWDU

&RQVLJQD
HIHFWLYD

63
(5

(UURUGH
UHJXODFL¬µQ

39
4632321
$ODUPD

4+B$/0
4+B:51
4/B:51
4/B$/0

9DORUUHDO
HIHFWLYR

9DORUUHDO$

(QWUDGD'

',69
0DJQLWXGSHUWXUEDGRUD

Diagrama de bloques del algoritmo de regulaci√≥n
463/(39

&RQVLJQDHIHFWLYD
9DORUUHDOHIHFWLYR

5HJXODGRUGH
WHPSHUDWXUD

4)8==<

9DORUPDQLSXODGRHIHFWLYR

3,'

(UURUGH
UHJXODFL¬µQ

=RQDPXHUWD

(QWUDGD'

6HJXLPLHQWRGHYDORU
PDQLSXODGR

0DJQLWXGSHUWXUEDGRUD

salida del regulador K

6748

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

4/012321

4/015(

/01B23
&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

4/01B+/0
4/016$)( 4/01B//0 /01
4635
9DORU
PDQLSXODGR

/01B$

4/0175.
&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

&RQPXWDU
VHJXLPLHQWR

/LPLWDU

5DQJRSDUWLGR

9DORUPDQLSXODGR$
/01B%
9DORUPDQLSXODGR%

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORUPDQLSXODGR

salida del regulador S (modo de operaci√≥n Regulador de impulsos)
/01B5(
9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

/01B5(21

/0123B21
/01B23

&RQPXWDU
YDORU
PDQLSXODGR /0175.21
H[WHUQR
&RQPXWDU
VHJXLPLHQWR

6$)(B21
/01B6$)(

/01B+/0
/01B//0

/LPLWDU
&RQPXWDU
YDORU
PDQLSXODGRGH
VHJXULGDG

9DORU
PDQLSXODGR

38/6(B70
%5($.B70
5DQJRSDUWLGR
IRUPDGRUGH
LPSXOVRV

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORUPDQLSXODGR

salida del regulador S (modo de operaci√≥n Regulador paso a paso con realimentaci√≥n de
posici√≥n)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6749

Instrucciones
4.2 Instrucciones
/01B5(

/01B5(21

/0123B21

9DORU
PDQLSXODGR
H[WHUQR
9DORU
PDQLSXODGR
HIHFWLYR

6$)(B21
/01B6$)(

/01B23
&RQPXWDU
YDORU
PDQLSX
ODGR
H[WHUQR

/01B+/0
/01B//0

9DORU
PDQLSXODGR

075B70
38/6(B70
%5($.B70

/0175.21
/LPLWDU
&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

&RQPXWDU
VHJXLPLHQWR

)RUPDGRU
GH
LPSXOVRV

(QWUDGDGHVHJXLPLHQWR

6HJXLPLHQWRGHYDORUPDQLSXODGR

(QWUDGDGHUHVSXHVWDGHSRVLFL¬µQ

salida del regulador S (modo de operaci√≥n Regulador paso a paso sin realimentaci√≥n de
posici√≥n)
4/015+6
4/015/6
9DORUPDQLSXODGR
H[WHUQR

4/0183
4/01'1

9DORU
PDQLSXODGR
HIHFWLYR

&RQPXWDU
YDORU
PDQLSXODGR
H[WHUQR

&RQPXWDU
YDORU
PDQLSXODGR
GHVHJXULGDG

)RUPDGRU
GH
LPSXOVRV

FUZ_455
Descripci√≥n de FUZ_455
La instrucci√≥n FUZ_455 permite leer y escribir par√°metros de regulador del regulador de
temperatura difuso del FM 455.

6750

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Esta funci√≥n es id√≥nea para las siguientes aplicaciones:
‚óè Transmisi√≥n al FM 455 de los par√°metros de regulador determinados por identificaci√≥n tras
un cambio de m√≥dulo
‚óè Adaptaci√≥n del FM 455 a diferentes procesos de regulaci√≥n
Nota
Los par√°metros determinados por el FM 455 mediante una identificaci√≥n no se pueden
cambiar, ya que est√°n optimizados para el sistema regulado.

Funcionamiento
Con los par√°metros READ_PAR y LOAD_PAR se controla el funcionamiento de la instrucci√≥n
FUZ_455.
Si READ_PAR = TRUE, FUZ_455 lee los par√°metros de todos los reguladores de temperatura
del FM 455 y los deposita en el DB de instancia. Una vez que la lectura de los par√°metros del
regulador de temperatura se ha completado correctamente, FUZ_455 pone el par√°metro
READ_PAR en FALSE.
Si LOAD_PAR = TRUE, FUZ_455 escribe los par√°metros de todos los reguladores de
temperatura del FM 455 del DB de instancia en el FM 455. Una vez que la transferencia de los
par√°metros se ha completado correctamente, FUZ_455 pone el par√°metro LOAD_PAR en
FALSE.

Llamada
FUZ_455 no requiere una marcha de inicializaci√≥n.
FUZ_455 debe llamarse en el mismo OB que todas las instrucciones restantes que acceden al
mismo FM 455.

Arranque
En el arranque de la CPU se debe activar el par√°metro LOAD_PAR de la instrucci√≥n FUZ_455,
y a continuaci√≥n llamar el bloque en el programa c√≠clico mientras LOAD_PAR = TRUE.

Par√°metros de entrada de FUZ_455
Tabla 4-340
Par√°metro

MOD_ADD
R

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

0.0

INT

512

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Descripci√≥n

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

6751

Instrucciones
4.2 Instrucciones

Par√°metros de salida de FUZ_455
Tabla 4-341
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

RET_VALU

2.0

WORD

0

RET_VALU contiene el valor de respuesta RET_VAL de las instrucciones
WR_REC y RD_REC. RET_VALU puede evaluarse si se notifica un error a trav√©s
de QMOD_F.

PARAFFUZ

4.0

WORD

0

En el par√°metro PARAFFUZ, un error de parametrizaci√≥n generado por la instruc‚Äê
ci√≥n FUZ_455 se indica de la siguiente manera:
Byte High de PARAFFUZ = 01: Se ha producido un error de parametrizaci√≥n.
Byte High de PARAFFUZ = 00: No se ha producido ning√∫n error de parametriza‚Äê
ci√≥n.
En el byte Low se indica el offset del par√°metro que ha causado el error de para‚Äê
metrizaci√≥n, contado a partir de la variable est√°tica FUZ_PAR[1].
PARAFFUZ = W#16#0104 significa p. ej. que el segundo par√°metro es err√≥neo

Consulte tambi√©n
RD_REC: Leer registro de periferia (P√°gina 5922)
WR_REC: Escribir registro en periferia (P√°gina 5927)

Par√°metros de entrada/salida de FUZ_455
Tabla 4-342
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

READ_PAR

6.0

BOOL

FAL‚Äê
SE

Si el par√°metro READ_PAR se activa, se leen los par√°metros difusos del m√≥dulo
y se depositan en variables est√°ticas del DB de instancia.

LOAD_PAR

6.1

BOOL

FAL‚Äê
SE

Si el par√°metro LOAD_PAR se activa, se leen los par√°metros difusos de las va‚Äê
riables est√°ticas del DB de instancia y se transfieren al m√≥dulo.

FORCE455
Descripci√≥n de FORCE455
La instrucci√≥n FORCE455 permite simular (forzar) los valores de entrada anal√≥gicos y
digitales para facilitar la puesta en marcha.

6752

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Simulaci√≥n de los valores digitales
La simulaci√≥n de los valores para las entradas digitales 1 a 16 se activa a trav√©s de los
conmutadores S_DION[ i ], donde 1 ‚â§ i ‚â§ 16. Los valores de simulaci√≥n se predeterminan a
trav√©s de los par√°metros DI_SIM[ i ]. Si S_DION[i] = TRUE, en lugar del valor de la entrada
digital i del m√≥dulo se utiliza el valor DI_SIM[i]. Los LEDs I1 a I16 muestran siempre el estado
de la entrada digital correspondiente, incluso durante la simulaci√≥n.

Simulaci√≥n de los valores anal√≥gicos
La simulaci√≥n de los valores anal√≥gicos para los canales 1 a 16 se activa a trav√©s de los
conmutadores S_AION[ i ] o S_PVON[ i ], donde 1 ‚â§ i ‚â§ 16.
Los valores de simulaci√≥n para los canales 1 a 16 se predeterminan a trav√©s de los par√°metros
PV_SIM[ i ].
Los valores de simulaci√≥n pueden hacerse efectivos en dos puntos:
‚óè S_AION[ i ] = TRUE (1 ‚â§ i ‚â§ 16)
En lugar del valor de la entrada anal√≥gica i del m√≥dulo se utiliza el valor PV_SIM[ i ].
‚óè S_PVON[ i ] = TRUE (1 ‚â§ i ‚â§ 16)
En lugar del valor acondicionado de la entrada anal√≥gica i del m√≥dulo se utiliza el valor
PV_SIM[ i ].
En la siguiente figura se representa en qu√© punto es efectivo el valor anal√≥gico simulado.
9DORUGHVLPXODFL¬µQ
39B6,0>L@

‡∏∑L‡∏∑

$FWLYDU
VLPXODFL¬µQ
6B$,21>L@

$FWLYDU
VLPXODFL¬µQ
6B3921>L@

7LSRGH
VHQVRU
$

'
)LOWUR

5D¬Ø]
FXDGUDGD

(QWUDGDGH
UHIHUHQFLD
SDUDPHWUL
]DGR
(QWUDGDGLJLWDO

/¬ØQHD
SROLJRQDO

1RUPDOL]DU

9DORU
DQDO¬µJLFR
SUHSDUDGR

$FWLYDUVLPXODFL¬µQ
6B',21>L@
9DORUGHVLPXODFL¬µQ
',B6,0>L@





9DORUGLJLWDO

La conexi√≥n y la preasignaci√≥n de los valores de simulaci√≥n (forzado) no se realizan a trav√©s
de la interfaz de parametrizaci√≥n. Por ello, los conmutadores y las l√≠neas de conexi√≥n
correspondientes se representan rayados.

Llamada
FORCE455 no requiere ninguna fase de inicializaci√≥n y normalmente se llama c√≠clicamente.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6753

Instrucciones
4.2 Instrucciones
FORCE455 debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 455.

Comportamiento en arranque
En caso de rearranque del FM 455 tras Power OFF, los conmutadores de simulaci√≥n del FM
455 vuelven a estar en FALSE.

Par√°metros de entrada de FORCE455
Tabla 4-343
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

S_AION

0.0

ARRA
Y
[1..16]
of
BOOL

FAL‚Äê
SE

Si p. ej. el conmutador S_AION[1] adopta el estado TRUE, en lugar del valor de
entrada anal√≥gica 1 del m√≥dulo se utiliza el valor PV_SIM[1].

S_PVON

2.0

ARRA
Y
[1..16]
of
BOOL

FAL‚Äê
SE

Si p. ej. el selector S_PVON[1] adopta el estado TRUE, en lugar del valor acondi‚Äê
cionado de entrada anal√≥gica 1 del m√≥dulo se utiliza el valor PV_SIM[1].

PV_SIM

4.0

ARRA
Y
[1..16]
of
REAL

0.0

En la entrada PV_SIM[1] se predetermina p. ej., el valor de simulaci√≥n para la
entrada anal√≥gica 1. Si S_PVON = TRUE, entonces se especifica aqu√≠ el valor de
entrada anal√≥gica acondicionado. Si S_PVON = FALSE y S_AION = TRUE, en‚Äê
tonces se especifica aqu√≠ el valor de entrada anal√≥gica en mA o mV, que se con‚Äê
vierte en un valor acondicionado mediante funciones de acondicionamiento.
Se admiten valores entre 0.0 y 20.0 [mA], -1500 a +10000 [mV] o un rango de
valores t√©cnico.

S_DION

68.0

ARRA
Y
[1..16]
of
BOOL

FAL‚Äê
SE

Si p. ej. S_DION[1] se pone en TRUE, en lugar de la entrada digital 1 del m√≥dulo
se utiliza el valor DI_SIM[1] como valor digital.

DI_SIM

70.0

ARRA
Y
[1..16]
of
BOOL

FAL‚Äê
SE

Valor de simulaci√≥n para entrada digital

MOD_ADD
R

72.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configura‚Äê
ci√≥n con STEP 7.

6754

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de salida de FORCE455
Tabla 4-344
Par√°metro

RET_VALU

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

74.0

WORD

0

Descripci√≥n

RET_VALU contiene el valor de respuesta RET_VAL de las instrucciones
WR_REC y RD_REC. RET_VALU puede evaluarse si se notifica un error a trav√©s
de QMOD_F.

Consulte tambi√©n
RD_REC: Leer registro de periferia (P√°gina 5922)
WR_REC: Escribir registro en periferia (P√°gina 5927)

READ_455
Descripci√≥n de READ_455
La instrucci√≥n READ_455 permite leer los valores de entrada digital y anal√≥gicos para ayudar
en la puesta en marcha.
Se visualizan los valores siguientes.
',$*>L@39B3+<

‡∏∑L‡∏∑

',$*>L@39B3(5

7LSRGH
VHQVRU
$

'
)LOWUR

(QWUDGDGH
UHIHUHQFLD
SDUDPHWUL
]DGR

5D¬Ø]
FXDGUDGD

/¬ØQHD
SROLJRQDO

1RUPDOL]DU

9DORU
DQDO¬µJLFR
SUHSDUDGR

&-B7(03

7HPSHUDWXUDGH
XQL¬µQIU¬ØD

Llamada
READ_455 no requiere una marcha de inicializaci√≥n y normalmente se llama c√≠clicamente.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6755

Instrucciones
4.2 Instrucciones
READ_455 debe llamarse en el mismo OB que todas las instrucciones restantes que acceden
al mismo FM 455.

Par√°metros de entrada de READ_455
Tabla 4-345
Par√°metro

MOD_ADD
R

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

0.0

INT

512

Descripci√≥n

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

Par√°metros de salida de READ_455
Tabla 4-346
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

CJ_TEMP

2.0

REAL

0.0

En la salida CJ_TEMP se muestra la temperatura de uni√≥n fr√≠a medida por el
m√≥dulo si se ha parametrizado una entrada de termopar y si la temperatura de
uni√≥n fr√≠a no se predetermina de forma parametrizada.

STAT_DI

6.0

ARRA
Y
[1..16]
of
BOOL

FAL‚Äê
SE

En los par√°metros STAT_DI se muestran los estados de las entradas digitales 1 a
16.

DIAG[x].PV
_PER

(N√∫‚Äê
mero
de ca‚Äê
nal)
x8

ARRA
Y
[1..16]
of
STRU
CT

0.0

En el par√°metro DIAG[1].PV_PER se muestra p. ej. el valor de entrada anal√≥gica
del m√≥dulo en la unidad mA o mV.

DIAG[x].PV
_PHY

(N√∫‚Äê
mero
de ca‚Äê
nal)
x8+4

ARRA
Y
[1..16]
of
STRU
CT

0.0

En el par√°metro DIAG[1].PV_PHY se muestra p. ej. el valor acondicionado de
entrada anal√≥gica del m√≥dulo en unidad f√≠sica.

RET_VALU

136.0

WORD

0

RET_VALU contiene el valor de respuesta RET_VAL de las instrucciones
WR_REC y RD_REC. RET_VALU puede evaluarse si se notifica un error a trav√©s
de QMOD_F.

Consulte tambi√©n
RD_REC: Leer registro de periferia (P√°gina 5922)
WR_REC: Escribir registro en periferia (P√°gina 5927)

6756

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

CH_DIAG_455
Descripci√≥n de CH_DIAG_455
La instrucci√≥n CH_DIAG_455 permite leer del m√≥dulo variables de diagn√≥stico adicionales
espec√≠ficas de canal.

Llamada
CH_DIAG_455 no requiere una marcha de inicializaci√≥n y normalmente se llama c√≠clicamente.
CH_DIAG_455 debe llamarse en el mismo OB que todas las instrucciones restantes que
acceden al mismo FM 455.

Par√°metros de entrada de CH_DIAG_455
Tabla 4-347
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

MOD_ADD
R

0.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

CHANNEL

2.0

INT

1

En la entrada "N√∫mero de canal" se parametriza el n√∫mero del canal de regulador
al que se refiere el DB de instancia.
Se admiten los valores 1 a 16.

Par√°metros de salida de CH_DIAG_455
Tabla 4-348
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

SP_R

4.0

REAL

0.0

Con el regulador de relaci√≥n ajustado, el par√°metro tiene asignado el valor de
entrada de la consigna.

PV_R

8.0

REAL

0.0

El par√°metro s√≥lo tiene asignado el siguiente valor con el regulador de relaci√≥n
ajustado: (Valor real A - Consigna Offset) / Valor real D

DIF_I

12.0

REAL

0.0

En el par√°metro DIF_I se muestra la magnitud de entrada de la acci√≥n D. Esto
resulta conveniente p. ej. si como magnitud de entrada de la acci√≥n D se ha pa‚Äê
rametrizado una entrada anal√≥gica.

TRACKPER 16.0

REAL

0.0

En el par√°metro TRACKPER se muestra la magnitud de entrada con la que se
corrige la magnitud manipulada si el regulador est√° ajustado para seguimiento de
magnitud manipulada.

IDSTATUS

20.0

WORD

0.0

En AUTOHOTSPOT se muestra el estado de la identificaci√≥n

LMN_P

22.0

REAL

0.0

En el par√°metro LMN_P se muestra la acci√≥n P de la magnitud manipulada.

LMN_I

26.0

REAL

0.0

En el par√°metro LMN_I se muestra la acci√≥n I de la magnitud manipulada.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Descripci√≥n

6757

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

LMN_D

30.0

REAL

0.0

En el par√°metro LMN_D se muestra la acci√≥n D de la magnitud manipulada.

RET_VALU

34.0

WORD

0

RET_VALU contiene el valor de respuesta RET_VAL de las instrucciones
WR_REC y RD_REC. RET_VALU puede evaluarse si se notifica un error a trav√©s
de QMOD_F.

Consulte tambi√©n
RD_REC: Leer registro de periferia (P√°gina 5922)
WR_REC: Escribir registro en periferia (P√°gina 5927)

Par√°metro IDSTATUS
El par√°metro IDSTATUS proporciona informaci√≥n sobre el estado de la identificaci√≥n y
contiene los cuatro valores hexadecimales X, A, I y F.

;

$

,

)

 
Valor

Descripci√≥n

X

Irrelevante (siempre 0)

A

N√∫mero de acci√≥n

 

‚óè 0 = modo manual (o bien sin modo de regulaci√≥n);
‚óè 2 = regulaci√≥n;
‚óè 4 = optimizaci√≥n activada (FUZID_ON = true);
‚óè 6 = estado de transici√≥n de modo manual a 2 √≥ 4;
I

Indicaci√≥n "Identificaci√≥n en curso" y "Los par√°metros se han determinado pero a√∫n no se han guardado
en la EEPROM"
‚óè 0 = la identificaci√≥n no se ejecuta, no se han determinado nuevos par√°metros
‚óè 1 = la identificaci√≥n est√° en curso, no se han determinado nuevos par√°metros
‚óè 2 = la identificaci√≥n no se ejecuta, se han determinado nuevos par√°metros, pero a√∫n no se han
guardado en la EEPROM
‚óè 3 = la identificaci√≥n est√° en marcha, se han determinado nuevos par√°metros, pero a√∫n no se han
guardado en la EEPROM

F

N√∫mero de error.
‚óè 0 = no hay error
‚óè 4 = salto excesivo del valor real durante la identificaci√≥n
‚óè 5 = relaci√≥n entre tiempo de retardo y constante de tiempo de proceso excesiva o comportamiento del
proceso regulado muy distante del lineal.
‚óè 6 = ca√≠da o subida de temperatura excesiva en el inicio de la identificaci√≥n. El proceso no tiene la calma
necesaria

6758

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Diagramas de bloques de CH_DIAG_455
Diagramas de bloques de CH_DIAG_455
Se muestran los siguientes valores de diagn√≥stico del error de regulaci√≥n.
63B5

63

0XOWLSOLFDU

&RQVLJQD

&RQPXWDU
YDORUGH
VHJXULGDG

5DPSD

&RQVLJQD
HIHFWLYD

/LPLWDU
QRUPDOL]DU

9DORUUHDO'

(UURUGH
UHJXODFL¬µQ

39B'

$ODUPD
9DORUUHDO$

9DORUUHDO
HIHFWLYR

',)B,
39

(QWUDGD'

0DJQLWXGSHUWXUEDGRUD

Se muestran los siguientes valores del algoritmo de regulaci√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6759

Instrucciones
4.2 Instrucciones
,'67$786

&RQVLJQDHIHFWLYD
9DORUUHDOHIHFWLYR

5HJXODGRUGH
WHPSHUDWXUD

9DORUPDQLSX
ODGRHIHFWLYR

/01B3
/01B,
/01B'
3,'
(UURUGH
UHJXODFL¬µQ

=RQDPXHUWD

(QWUDGD'

6HJXLPLHQWRGHYDORUPDQLSXODGR

0DJQLWXGSHUWXUEDGRUD

Se muestran los siguientes valores del regulador K o S.
9DORU
PDQLSXODGR
H[WHUQR
9DORU
&RQPXWDU
PDQLSXODGR YDORUPDQLSX
HIHFWLYR
ODGRH[WHUQR

9DORU
PDQLSXODGR
&RQPXWDU
&RQPXWDUYDORU /LPLWDU
VHJXLPLHQWR PDQLSXODGRGH
VHJXULGDG
75$&.3(5

(QWUDGDGHVHJXLPLHQWR

5DQJRSDUWLGR

9DORU
PDQLSXODGR$

9DORUPDQLSX
ODGR%

6HJXLPLHQWRGHYDORUPDQLSXODGR

PID_PAR_455
Descripci√≥n de PID_PAR_455
La instrucci√≥n PID_PAR_455 permite modificar par√°metros online que no pueden
predeterminarse con la instrucci√≥n PID_FM_455. Los par√°metros modificables pueden verse
en la tabla Par√°metros modificables.

6760

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Llamada
PID_PAR_455 requiere una marcha de inicializaci√≥n, que se inicia activando el par√°metro
COM_RST = TRUE. Para reducir el tiempo de ejecuci√≥n, PID_PAR_455 no deber√≠a llamarse
c√≠clicamente, sino s√≥lo cuando fuera necesario cambiar par√°metros. En ese caso, COM_RST
debe ser FALSE.
PID_PAR_455 debe llamarse en el mismo OB que todas las instrucciones restantes que
acceden al mismo FM 455.

Funcionamiento
En el curso de la inicializaci√≥n, PID_PAR_455 lee los par√°metros de los datos del sistema y los
deposita en variables est√°ticas. PID_PAR_455 cambia en cada llamada una de estas variables
REAL y una de las variables INT. En el par√°metro de entrada INDEX_R o INDEX_I indique el
n√∫mero de √≠ndice del par√°metro que desea modificar. Indique los nuevos valores en el
par√°metro de entrada VALUE_R o VALUE_I. PID_PAR_455 transfiere el registro completo con
las variables modificadas al FM 455.
Para cambiar otros par√°metros, llame el mismo DB de instancia varias veces seguidas con
COM_RST = FALSE y con diferentes n√∫meros de √≠ndice.
El par√°metro COM_RST es un par√°metro de entrada que no se desactiva con PID_PAR_455.
Nota
Recuerde que los par√°metros que ha cambiado con PID_PAR_455 se sobrescriben en el
arranque con los par√°metros de los datos del sistema.

Arranque
En el arranque de la CPU y en la transici√≥n de STOP a RUN de la CPU, los par√°metros del FM
455 se sobrescriben con los par√°metros del SDB de la CPU.

Ejemplo
Desea cambiar el tiempo de subida de la rampa para la magnitud de referencia durante el
funcionamiento, y adem√°s utilizar diferentes valores de entrada anal√≥gica como valor real
independientemente del estado del proceso.
‚óè En el arranque de la CPU llame PID_PAR_455 con COM_RST = TRUE.
‚óè Para parametrizar el tiempo de subida de la rampa para la referencia a 10.0 llame
PID_PAR_455 durante el funcionamiento con INDEX_R = 30, VALUE_R = 10.0 y INDEX_I
= 0.
‚óè Para parametrizar el valor de entrada anal√≥gica 4 del m√≥dulo como valor real, llame
PID_PAR_455 durante el funcionamiento con INDEX_R = 0, INDEX_I = 50 y VALUE_I = 4.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6761

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de PID_PAR_455
Tabla 4-349
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

COM_RST

0.0

BOOL

TRUE

Si el par√°metro es COM_RST = TRUE, la instrucci√≥n PID_PAR_455 realiza una
marcha de inicializaci√≥n. En ella se leen los par√°metros de los datos del sistema de
la CPU y se depositan en el DB de instancia.

MOD_ADD
R

2.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

CHANNEL

4.0

INT

1

En la entrada "N√∫mero de canal" se parametriza el n√∫mero del canal de regulador
al que se refiere el DB de instancia.
Se admiten los valores 1 a 16.

INDEX_R

6.0

INT

0.0

‚óè 0: No se modifica ning√∫n par√°metro REAL

VALUE_R

8.0

REAL

0.0

En funci√≥n del par√°metro en cuesti√≥n

INDEX_I

12.0

INT

0.0

‚óè 0: No se modifica ning√∫n par√°metro INT

VALUE_I

14.0

INT

0.0

En funci√≥n del par√°metro en cuesti√≥n

‚óè 1 a 48: Cada valor corresponde a un par√°metro REAL modificable.

‚óè 49 a 61: Cada valor corresponde a un par√°metro INT modificable.

Par√°metros de salida de PID_PAR_455
Tabla 4-350
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

RET_VALU

16.0

WORD

0

RET_VALU contiene el valor de respuesta RET_VAL de las instrucciones
WR_REC y RD_REC. RET_VALU puede evaluarse si se notifica un error a trav√©s
de QMOD_F.

BUSY

18.0

BOOL

FAL‚Äê
SE

Si BUSY = TRUE, el m√≥dulo a√∫n no ha adoptado los par√°metros del m√≥dulo. En
ese caso, la llamada de la instrucci√≥n PID_PAR_455 deber√≠a repetirse en el si‚Äê
guiente ciclo.

Consulte tambi√©n
RD_REC: Leer registro de periferia (P√°gina 5922)
WR_REC: Escribir registro en periferia (P√°gina 5927)

6762

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros modificables

Tabla 4-351 Lista de los par√°metros REAL e INT que se pueden modificar con PID_PAR_455 en un FM 455
Tipo de da‚Äê
tos

Descripci√≥n

N√∫mero de √≠ndice

-

Ning√∫n par√°metro seleccionado

0

REAL

Constante de tiempo de filtro para entrada anal√≥gica

1

REAL

Fin de medici√≥n (100%)

2

REAL

Inicio de medici√≥n (0%)

3

REAL

L√≠nea poligonal, valor de interpolaci√≥n 1 lado de entrada

4

REAL

L√≠nea poligonal, valor de interpolaci√≥n 2 lado de entrada

5

REAL

L√≠nea poligonal, valor de interpolaci√≥n 3 lado de entrada

6

REAL

L√≠nea poligonal, valor de interpolaci√≥n 4 lado de entrada

7

REAL

L√≠nea poligonal, valor de interpolaci√≥n 5 lado de entrada

8

REAL

L√≠nea poligonal, valor de interpolaci√≥n 6 lado de entrada

9

REAL

L√≠nea poligonal, valor de interpolaci√≥n 7 lado de entrada

10

REAL

L√≠nea poligonal, valor de interpolaci√≥n 8 lado de entrada

11

REAL

L√≠nea poligonal, valor de interpolaci√≥n 9 lado de entrada

12

REAL

L√≠nea poligonal, valor de interpolaci√≥n 10 lado de entrada

13

REAL

L√≠nea poligonal, valor de interpolaci√≥n 11 lado de entrada

14

REAL

L√≠nea poligonal, valor de interpolaci√≥n 12 lado de entrada

15

REAL

L√≠nea poligonal, valor de interpolaci√≥n 13 lado de entrada

16

REAL

L√≠nea poligonal, valor de interpolaci√≥n 1 lado de salida

17

REAL

L√≠nea poligonal, valor de interpolaci√≥n 2 lado de salida

18

REAL

L√≠nea poligonal, valor de interpolaci√≥n 3 lado de salida

19

REAL

L√≠nea poligonal, valor de interpolaci√≥n 4 lado de salida

20

REAL

L√≠nea poligonal, valor de interpolaci√≥n 5 lado de salida

21

REAL

L√≠nea poligonal, valor de interpolaci√≥n 6 lado de salida

22

REAL

L√≠nea poligonal, valor de interpolaci√≥n 7 lado de salida

23

REAL

L√≠nea poligonal, valor de interpolaci√≥n 8 lado de salida

24

REAL

L√≠nea poligonal, valor de interpolaci√≥n 9 lado de salida

25

REAL

L√≠nea poligonal, valor de interpolaci√≥n 10 lado de salida

26

REAL

L√≠nea poligonal, valor de interpolaci√≥n 11 lado de salida

27

REAL

L√≠nea poligonal, valor de interpolaci√≥n 12 lado de salida

28

REAL

L√≠nea poligonal, valor de interpolaci√≥n 13 lado de salida

29

REAL

Tiempo de subida de la rampa para referencia

30

REAL

Referencia de seguridad o relaci√≥n de referencia de seguridad

31

REAL

Offset de combinaci√≥n de consigna (regulador de relaci√≥n/mixto)

32

REAL

Factor para valor real B (regulador de tres componentes)

33

REAL

Factor para valor real C (regulador de tres componentes)

34

REAL

Offset para combinaci√≥n de valor real (regulador de tres componentes)

35

REAL

Factor para combinaci√≥n de magnitud perturbadora

36

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6763

Instrucciones
4.2 Instrucciones
Tipo de da‚Äê
tos

Descripci√≥n

N√∫mero de √≠ndice

REAL

Punto de operaci√≥n

37

REAL

Agresividad en el regulador difuso

38

REAL

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de entrada A

39

REAL

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de entrada A

40

REAL

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de salida A

41

REAL

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de salida A

42

REAL

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de entrada B

43

REAL

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de entrada B

44

REAL

V√©rtices de la funci√≥n de rango partido: Inicio de rango se√±al de salida B

45

REAL

V√©rtices de la funci√≥n de rango partido: Fin de rango se√±al de salida B

46

REAL

Duraci√≥n m√≠nima del impulso

47

REAL

Duraci√≥n m√≠nima de pausa

48

INT

Selecci√≥n de la referencia SP o SP_RE para el regulador

49

INT

INT

INT

INT

INT

INT

INT

6764

0

Consigna SP_RE de la instrucci√≥n

1 a 16

Valor de entrada anal√≥gica 1 a 16

17 a 32

Magnitud manipulada (LMN) de regulador 1 a 16

Selecci√≥n de la magnitud reguladora principal valor real A para el regulador
0:

Valor real A = 0.0

1 a 16:

Valor de entrada anal√≥gica 1 a 16

Selecci√≥n de la magnitud reguladora auxiliar valor real B para el regulador
0

Valor real B = 0.0

1 a 16

Valor de entrada anal√≥gica 1 a 16

Selecci√≥n de la magnitud reguladora auxiliar valor real C para el regulador
0

Valor real C = 0.0

1 a 16

Valor de entrada anal√≥gica 1 a 16

Selecci√≥n de la magnitud reguladora auxiliar valor real D para el regulador
0

Valor real D = 0.0

1 a 16

Valor de entrada anal√≥gica 1 a 16

17 a 32

Magnitud manipulada (LMN) de regulador 1 a 16

Selecci√≥n de la magnitud perturbadora DISV para el regulador
0

Magnitud perturbadora = 0.0

1 a 16

Valor de entrada anal√≥gica 1 a 16
Seguimiento de posici√≥n = 0.0

1 a 16

Valor de entrada anal√≥gica 1 a 16

Selecci√≥n del seguimiento de posici√≥n LMNR_PER para el regulador
0

Seguimiento de posici√≥n = 0.0

1 a 16

Valor de entrada anal√≥gica 1 a 16

51

52

53

54

Selecci√≥n del seguimiento de posici√≥n TRACK_PER para el regulador
0

50

55

56

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Tipo de da‚Äê
tos

Descripci√≥n

N√∫mero de √≠ndice

INT

Selecci√≥n de la se√±al para la conmutaci√≥n al valor de seguridad para la variable mani‚Äê
pulada del regulador

57

INT

INT

INT

INT

0

S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro SAFE_ON de la
instrucci√≥n PID_FM_455

1 a 16

Asignaci√≥n predeterminada con el par√°metro SAFE_ON de la instrucci√≥n
PID_FM_455 predeterminado por la entrada digital 1 a 16

Selecci√≥n de la se√±al para la conmutaci√≥n a la funci√≥n de seguimiento de la variable
manipulada del regulador
0

S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro LMNTRKON de la
instrucci√≥n PID_FM_455

1 a 16

Asignaci√≥n predeterminada con el par√°metro LMNTRKON de la instrucci√≥n
PID_FM_455 predeterminado por la entrada digital 1 a 16

Selecci√≥n de la se√±al para la conmutaci√≥n de la variable manipulada del regulador a
LMN_RE
0

S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro LMN_REON de la
instrucci√≥n PID_FM_455

1 a 16

Asignaci√≥n predeterminada con el par√°metro LMN_REON de la instrucci√≥n
PID_FM_455 predeterminado por la entrada digital 1 a 16

Selecci√≥n de la se√±al de tope superior de la realimentaci√≥n de posici√≥n
0

S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro LMNRHSRE de la
instrucci√≥n PID_FM_455

1 a 16

Asignaci√≥n predeterminada con el par√°metro LMNRHSRE de la instrucci√≥n
PID_FM_455 predeterminado por la entrada digital 1 a 16

Selecci√≥n de la se√±al de tope inferior de la realimentaci√≥n de posici√≥n
0

S√≥lo asignaci√≥n predeterminada a trav√©s del par√°metro LMNRLSRE de la
instrucci√≥n PID_FM_455

1 a 16

Asignaci√≥n predeterminada con el par√°metro LMNRLSRE de la instrucci√≥n
PID_FM_455 predeterminado por la entrada digital 1 a 16

58

59

60

61

CJ_T_PAR_455
Descripci√≥n de CJ_T_PAR_455
La instrucci√≥n CJ_T_PAR_455 permite cambiar online la temperatura de uni√≥n fr√≠a
parametrizada. Esto es necesario si una regulaci√≥n de temperatura debe funcionar con varios
FM 455 con entradas de termopar sin necesidad de conectar un Pt 100 en cada FM 455.

Llamada
CJ_T_PAR_455 requiere una marcha de inicializaci√≥n. Para ello debe llamarse una sola vez
en el arranque de la CPU con el par√°metro COM_RST = TRUE.
Normalmente, CJ_T_PAR_455 se llama c√≠clicamente. Por motivos relacionados con el tiempo
de operaci√≥n, COM_RST deber√≠a tener el valor FALSE. El par√°metro COM_RST es un
par√°metro de entrada que no se desactiva.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6765

Instrucciones
4.2 Instrucciones
CJ_T_PAR_455 debe llamarse en el mismo OB que todas las instrucciones restantes que
acceden al mismo FM 455.

Ejemplo
Si en una regulaci√≥n de extrusionador con m√°s de 16 zonas de calentamiento la temperatura
de las uniones fr√≠as se mide con un FM 455, puede leerse con READ_455 en el par√°metro
CJ_TEMP y parametrizarse en los FM 455 restantes con CJ_T_PAR_455.

Par√°metros de entrada de CJ_T_PAR_455
Tabla 4-352
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

COM_RST

0.0

BOOL

‚Äì

Si el par√°metro es COM_RST = TRUE, la instrucci√≥n CJ_T_PAR_455 realiza una
marcha de inicializaci√≥n. En ella se leen los par√°metros de los datos del sistema de
la CPU y se depositan en el DB de instancia.

MOD_ADD
R

2.0

INT

256

En esta entrada se encuentra la direcci√≥n del m√≥dulo resultante de la configuraci√≥n
con STEP 7.

CJ_T

4.0

REAL

0.0

En el par√°metro CJ_T se puede predeterminar la temperatura de las uniones fr√≠as.
El rango de valores permitido var√≠a en funci√≥n del tipo de sensor.

Par√°metros de salida de CJ_T_PAR_455
Tabla 4-353
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

RET_VALU

8.0

WORD

0

RET_VALU contiene el valor de respuesta RET_VAL de las instrucciones
WR_REC y RD_REC. RET_VALU puede evaluarse si se notifica un error a trav√©s
de QMOD_F.

BUSY

10.0

BOOL

FAL‚Äê
SE

Si BUSY = TRUE, el m√≥dulo a√∫n no ha adoptado los par√°metros del m√≥dulo. En
ese caso, la llamada de la instrucci√≥n CJ_T_PAR_455 deber√≠a repetirse en el
siguiente ciclo.

Consulte tambi√©n
RD_REC: Leer registro de periferia (P√°gina 5922)
WR_REC: Escribir registro en periferia (P√°gina 5927)

6766

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

LP_ZONE
Descripci√≥n de LP_ZONE
Para un grado de utilizaci√≥n uniforme de la CPU y una ejecuci√≥n equidistante de la instrucci√≥n
ZONE, en una optimizaci√≥n de regulador es necesario utilizar el distribuidor de llamadas de
regulador LP_ZONE.
LP_ZONE garantiza que siempre se ejecute s√≥lo una zona por llamada del OB de alarma
c√≠clica.
La instrucci√≥n LP_ZONE calcula los tiempos de muestreo de las zonas y los transmite a las
instancias de la instrucci√≥n ZONE.

Llamada
LP_ZONE se llama en un OB de arranque o de alarma c√≠clica. Las instrucciones LP_ZONE,
ADM_ZONE y ZONE deben llamarse todas en el mismo nivel de alarma c√≠clica,
preferentemente de forma inmediata en el OB de alarma c√≠clica. No pueden programarse
factores de ciclo de tiempo propios para las instrucciones.
Tras insertar o eliminar una zona o si se cambia el orden de llamada, LP_ZONE requiere una
marcha de inicializaci√≥n. Para ello hay que llamarlo con el par√°metro COM_RST = TRUE. El
bit COM_RST se transmite a trav√©s de la interfaz LP_SCH a las diferentes zonas y al bloque
de gesti√≥n correspondiente.
Los n√∫meros de zona NBR_CALL de las instancias de las instrucciones ZONE y ADM_ZONE
y el n√∫mero m√°ximo de zona MNR_CALL de la instrucci√≥n LP_ZONE se activan
autom√°ticamente seg√∫n el siguiente mecanismo:
Primera ejecuci√≥n del OB de alarma c√≠clica tras la activaci√≥n de COM_RST de la instrucci√≥n
LP_ZONE:
‚óè LP_ZONE pone el contador de llamadas LP_SCH. CALL_CNT a 1.
‚óè ZONE y ADM_ZONE leen el contador de llamadas y escriben el valor en su par√°metro de
entrada/salida NBR_CALL. ZONE aumenta el contador de llamadas en 1. ADM_ZONE no
lo modifica.
Segunda ejecuci√≥n del OB de alarma c√≠clica tras la activaci√≥n de COM_RST de la instrucci√≥n
LP_ZONE:
‚óè LP_ZONE lee el contador de llamadas (n√∫mero de todas las zonas) y escribe el valor en
MNR_CALL.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6767

Instrucciones
4.2 Instrucciones

Funcionamiento
Con cada llamada de la instrucci√≥n LP_ZONE el par√°metro LP_SCH.CALL_CNT aumenta en
1. Cuando el contador alcanza el n√∫mero m√°ximo de zonas de MNR_CALL se vuelve a poner
a 1. En la llamada de la instrucci√≥n ZONE, √©sta primero comprueba el contador
LP_SCH.CALL_CNT. Si coincide con su propio n√∫mero de zona NBR_CALL, ejecuta su
programa. El bloque vuelve a activar los par√°metros MNR_CALL de la instrucci√≥n LP_ZONE
y NBR_CALL de la instrucci√≥n ADM_ZONE y ZONE autom√°ticamente tras un rearranque
completo.
Nota
Interconecte el par√°metro de entrada/salida LP_SCH de las instrucciones ZONE y
ADM_ZONE en la estructura interna LP_SCH del DB de instancia de la instrucci√≥n LP_ZONE.
Interconecte el par√°metro de entrada OB_EXC_FREQ de la instrucci√≥n LP_ZONE con el
par√°metro temporal OBxx_EXC_FREQ del OB de alarma c√≠clica.

Ejemplo
El orden de llamada en el OB 33
OB33
...
call LP_ZONE, DB_LP_ZONE
call ADM_ZONE, DB_ADM_ZONE
call ZONE, DB_ZONE1
call ZONE, DB_ZONE2
call ZONE, DB_ZONE3
‚Ä¶
BE
se traduce en el siguiente desarrollo en el procesamiento de zonas:
2%

)%/3B=21('%B/3B=21(
)%$'0B=21('%B$'0B=21(
)%=21('%B=21(

7LHPSRGHFLFORGH2%



6768







7LHPSR

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de LP_ZONE
Tabla 4-354
Par√°metro

OB_EXC_F
REQ

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

0.0

INT

0

Descripci√≥n

Tiempo de muestreo [msec]; interconecte el par√°metro con las correspondientes
variables locales del OB de alarma c√≠clica.

Par√°metro de salida LP_ZONE
Tabla 4-355
Par√°metro

MNR_CALL

Direc‚Äê
ci√≥n

Tipo
Ajuste
de da‚Äê prede‚Äê
tos
termi‚Äê
nado

2.0

INT

0

Descripci√≥n

N√∫mero de zonas. El formato se determina autom√°ticamente tras un rearranque
completo.

Par√°metros de entrada/salida de LP_ZONE
Tabla 4-356
Par√°metro

COM_RST

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

4.0

BOOL

TRUE

Descripci√≥n

Rearranque completo; aseg√∫rese de que este bit est√° activado en el OB 100.

Variables est√°ticas de LP_ZONE
Tabla 4-357
Par√°metro

LP_SCH

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

6.0

STRU
CT

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

Interfaz entre las instrucciones LP_ZONE y ADM_ZONE o bien ZONE

A continuaci√≥n siguen par√°metros internos que no pueden ser utilizados por el usuario.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6769

Instrucciones
4.2 Instrucciones

ADM_ZONE
Descripci√≥n de ADM_ZONE
Con frecuencia, en la pr√°ctica las zonas de calentamiento y refrigeraci√≥n est√°n construidas de
tal forma que resulta f√°cil que el calor se transmita de una zona a la otra. En esos casos, estas
zonas con acoplamiento t√©rmico deben unificarse en un grupo. La instrucci√≥n ADM_ZONE
gestiona un grupo de zonas de calentamiento/refrigeraci√≥n y se encarga de las siguientes
funciones:
‚óè Conexi√≥n y desconexi√≥n de la calefacci√≥n de todas las zonas
‚óè Conexi√≥n y desconexi√≥n de la optimizaci√≥n del regulador
‚óè Indicaci√≥n de grupo de un error de canal
‚óè Indicaci√≥n de grupo de un error de optimizaci√≥n de regulador
‚óè Indicaci√≥n de grupo de una advertencia de optimizaci√≥n de regulador
‚óè Control del salto com√∫n de la variable manipulada en optimizaci√≥n del regulador

Llamada
Llame las instrucciones LP_ZONE, ADM_ZONE y ZONE todas en el mismo nivel de alarma
c√≠clica, preferentemente de forma inmediata en el OB de alarma c√≠clica. No pueden
programarse factores de ciclo de tiempo propios para las instrucciones. Llame ADM_ZONE
despu√©s de LP_ZONE y antes de ZONE.

Arranque
Active el bit de rearranque completo de ADM_ZONE p. ej. en el OB 100 o en el primer ciclo del
OB de alarma c√≠clica. Tras un rearranque completo se desconectan las calefacciones de las
diferentes zonas y se interrumpe cualquier optimizaci√≥n de regulador en curso.

Funcionamiento
El programa en s√≠ s√≥lo se ejecuta si el contador de llamadas de la instrucci√≥n LP_ZONE tiene
el mismo valor que el n√∫mero de llamadas propio: LP_SCH.CALL_CNT = NBR_CALL.

Conexi√≥n y desconexi√≥n de la calefacci√≥n de todas las zonas
Una modificaci√≥n del selector HEAT_OFF se transmite como control manual a la interfaz
ADMIN, y con ello consecutivamente a las zonas que deben gestionarse. Si no hay control
manual, el resultado se transmite de las zonas ADMIN.QHEAT_OFF al par√°metro de entrada/
salida HEAT_OFF. S√≥lo si la calefacci√≥n est√° desactivada en todas las zonas, el conmutador
de grupo HEAT_OFF adopta el estado TRUE.
Un control manual del selector HEAT_OFF por parte del usuario se indica en el par√°metro
Done QHO_DONE. El estado predeterminado del par√°metro es TRUE. En caso de control
manual, adopta el estado FALSE. Si la calefacci√≥n est√° conectada o desconectada en todas
las zonas correspondientes, QHO_DONE vuelve a adaptar el valor TRUE.

6770

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
La calefacci√≥n de una zona est√° desactivada si rige: cont_FM455.QLMN_RE = TRUE y
cont_FM455.LMN = 0.0

Conexi√≥n y desconexi√≥n de la optimizaci√≥n de regulador de todas las zonas
Una modificaci√≥n del conmutador TUN_ON se transmite como control manual a la interfaz
ADMIN, y con ello sucesivamente a las zonas que deben gestionarse. Si no hay control
manual, el resultado se transmite de las zonas ADMIN.QTUN_ON al par√°metro de entrada/
salida TUN_ON. S√≥lo si la optimizaci√≥n de regulador est√° desactivada en todas las zonas, el
conmutador de grupo TUN_ON vuelve a adoptar el valor FALSE.

Indicaci√≥n de grupo de un error de canal
El bit QCH_F indica si hay un error de canal del FM 455 presente como m√≠nimo en una zona.
Compruebe en qu√© zonas hay un error de canal presente. Si QCH_F = TRUE, la informaci√≥n
precisa del error puede verse en el registro de diagn√≥stico DS1 del m√≥dulo.

Indicaci√≥n de grupo de un error de optimizaci√≥n de regulador
El bit QTUN_ERR indica si como m√≠nimo en un DB de instancia de la instrucci√≥n
ZONESTATUS_H = 3xxxx o STATUS_C = 3xxxx. Compruebe las zonas correspondientes y
subsane el error de la forma descrita en AUTOHOTSPOT.

Indicaci√≥n de grupo de una advertencia de optimizaci√≥n de regulador
El bit QTUN_ERR indica si como m√≠nimo en un DB de instancia de la instrucci√≥n
ZONESTATUS_H = 2xxxx o STATUS_C = 2xxxx. Compruebe las zonas correspondientes y
subsane el error de la forma descrita en AUTOHOTSPOT.

Control de proceso en una optimizaci√≥n de regulador
El bloque de administraci√≥n garantiza que en la optimizaci√≥n de regulador el salto de la
variable manipulada sea simult√°neo en todas las zonas del grupo. Una vez que las diferentes
zonas han encontrado el punto de inversi√≥n, pasan a la fase 7.
Nota
Interconecte el par√°metro de entrada/salida ADMIN de la instrucci√≥n ZONE en la estructura
interna ADMIN del DB de instancia de ADM_ZONE.
ADM_ZONE siempre se utiliza en combinaci√≥n con LP_ZONE.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6771

Instrucciones
4.2 Instrucciones

Par√°metros de salida de ADM_ZONE
Tabla 4-358
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

0.0

BOOL

FAL‚Äê
SE

Aviso de grupo: Error de canal

QTUN_ERR 0.1

BOOL

FAL‚Äê
SE

Aviso de grupo: Error en la optimizaci√≥n del regulador

QTUN_WR
N

0.2

BOOL

FAL‚Äê
SE

Aviso de grupo: Advertencia en la optimizaci√≥n del regulador

QHO_DO‚Äê
NE

0.3

BOOL

TRUE

Respuesta de un contro manual HEAT_OFF

QCH_F

Descripci√≥n

‚óè 0: Se ha iniciado un control manual HEAT_OFF
‚óè 1: Control manual HEAT_OFF efectivo en todas las zonas

NBR_CALL

2.0

INT

0

N√∫mero de llamada; la instrucci√≥n lo registra autom√°ticamente tras un rearranque
completo.

Par√°metros de entrada/salida de ADM_ZONE
Tabla 4-359
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

HEAT_OFF

4.0

BOOL

TRUE

Calefacci√≥n ON/OFF; 1=OFF

TUN_ON

4.1

BOOL

FAL‚Äê
SE

Optimizaci√≥n de regulador ON/OFF; 1=ON

COM_RST

4.2

BOOL

TRUE

Rearranque completo; aseg√∫rese de que este bit est√° activado en el OB 100.

LP_SCH

6.0

STRU
CT

P#P
0.0

Interfaz entre las instrucciones LP_ZONE y ADM_ZONE o bien ZONE

Variables est√°ticas de ADM_ZONE
Tabla 4-360
Par√°metro

ADMIN

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

12.0

STRU
CT

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

Interfaz entre las instrucciones ADM_ZONE y ZONE

A continuaci√≥n siguen par√°metros internos que no pueden ser utilizados por el usuario.

6772

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

ZONE
Descripci√≥n de ZONE
El DB de instancia de la instrucci√≥n ZONE contiene los datos de regulador de una sola zona
de calentamiento o calentamiento/refrigeraci√≥n. La instrucci√≥n ZONE lee y escribe datos en un
canal del FM 455.
Las funciones de regulador del FM 455 se complementan con las siguientes funciones:
‚óè Modo con zona de regulaci√≥n
‚óè Factor de proporci√≥n para zonas de calentamiento/refrigeraci√≥n
‚óè Optimizaci√≥n del regulador
ZONE es por ello especialmente adecuada para regular zonas de calentamiento o
calentamiento/refrigeraci√≥n de un extrusionador.

Requisitos
El canal del FM 455 est√° parametrizado como regulador de impulsos o continuo.
Las instrucciones PID_FM_455 y PID_PAR_455 est√°n copiadas en el programa de usuario.

Llamada
Llame las instrucciones LP_ZONE, ADM_ZONE y ZONE todas en el mismo nivel de alarma
c√≠clica, preferentemente de forma inmediata en el OB de alarma c√≠clica. No pueden
programarse factores de ciclo de tiempo propios para las instrucciones. Es importante que las
zonas asociadas siempre se encuentren en un bloque tras la llamada de la instrucci√≥n
ADM_ZONE.

Arranque
Active el bit de rearranque completo de ZONE en el OB 100. Si se utiliza LP_ZONE, la
activaci√≥n es autom√°tica.
Las siguientes acciones se ejecutan cuando se lanza la rutina de inicializaci√≥n
COM_RST=TRUE
:
‚óè cont_FM455.SDB_SEL = TRUE: los par√°metros de regulador de SDB
cont_FM455.P_SEL...cont_FM455.BREAK_TM no se aplican en el FM 455. Los
par√°metros efectivos en el FM contin√∫an siendo vigentes.
‚óè cont_FM455.SP_OP_ON = FALSE: as√≠ es efectiva la consigna SP_RE.
‚óè cont_FM455.LOAD_PAR = TRUE: los par√°metros de regulador se transmiten del DB de
instancia al FM 455.

Funcionamiento
ZONE contiene las instrucciones PID_FM_455 y PID_PAR_455 como instancias locales.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6773

Instrucciones
4.2 Instrucciones
ZONE activa en cada llamada los par√°metros cont_FM455.LOAD_OP = TRUE y
cont_FM455.READ_VAR = TRUE. Con ello se actualizan todos los par√°metros de operaci√≥n
(cont_FM455.SP_RE...cont_FM455.LMNRSVAL) y todos los valores del proceso
(cont_FM455.SP...cont_FM455.QMOD_F).
Es posible modificar par√°metros de regulador
(cont_FM455.P_SEL...cont_FM455.BREAK_TM) cambiando directamente el valor del DB de
instancia en la CPU y activando el bit cont_FM455.LOAD_PAR durante un ciclo. No se requiere
un DB auxiliar. Una vez que la transmisi√≥n ha concluido con √©xito, el bit se desactiva. Tras el
rearranque completo de la CPU los par√°metros del regulador no se sobrescriben con los
par√°metros de regulador del SDB.
Si trabaja sin LP_ZONE, active el par√°metro NBR_CALL=0.

Par√°metros de la instrucci√≥n PID_FM_455 modificables con ZONE
Tabla 4-361 La siguiente lista contiene los par√°metros de la instrucci√≥n PID_FM_455 que se ven afectados por ZONE:
Par√°metro

Comentario

cont_FM455.READ_VAR

Se pone c√≠clicamente en TRUE

cont_FM455.LOAD_OP

Se pone c√≠clicamente en TRUE

cont_FM455.LOAD_PAR

Adopta el valor TRUE en una reparametrizaci√≥n y en caso de modificaci√≥n de los
par√°metros CONZONE y RATIOFAC.

cont_FM455.MOD_ADDR

Se aplica c√≠clicamente a la entrada MOD_ADDR.

cont_FM455.CHANNEL

Se aplica c√≠clicamente a la entrada CHANNEL.

cont_FM455.SDB_SEL

Adopta el valor TRUE en caso de rearranque completo
En una transici√≥n de RUN a STOP de la CPU el FM 455 no aplica los par√°metros de
regulador (P_SEL...BREAK_TM) del SDB.

cont_FM455.SP_OP_ON

Adopta el valor FALSE en caso de rearranque completo, de modo que SP_RE es
efectivo.

cont_FM455.SP_RE

Se aplica c√≠clicamente en SP_IN

cont_FM455.GAIN

Se activan en caso de optimizaci√≥n de regulador, de nueva carga de los par√°metros
de regulador guardados y de carga de los par√°metros de regulador PI/PID.

cont_FM455.TI
cont_FM455.TD
cont_FM455.TM_LAG
cont_FM455.D_EL_SEL
cont_FM455.PFDB_SEL
cont_FM455.LOAD_PAR
cont_FM455.LMN_LLM

Se activan en caso de modificaci√≥n de RATIOFAC y COOLZONE

cont_FM455.LOAD_PAR
cont_FM455.LMN_REON

Se activan c√≠clicamente

cont_FM455.LMN_RE
cont_FM455.LOAD_OP

6774

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Par√°metros de la instrucci√≥n PID_PAR_455 modificables con ZONE
Tabla 4-362 La siguiente lista contiene los par√°metros de la instrucci√≥n PID_PAR_455, que se ven afectados por ZONE:
Par√°metro

Comentario

pidpar_FM455.COM_RST

Adopta el valor TRUE en caso de rearranque completo

pidpar_FM455.MOD_ADDR

Se aplica c√≠clicamente a la entrada MOD_ADDR.

pidpar_FM455.CHANNEL

Se aplica c√≠clicamente a la entrada CHANNEL.

pidpar_FM455. INDEX_R

Adoptan el valor 43 en caso de modificaci√≥n de RATIOFAC y COOLZONE

pidpar_FM455. VALUE _R

Se activa en caso de modificaci√≥n de RATIOFAC y COOLZONE

Par√°metros de entrada ZONE
Tabla 4-363
Par√°metro

Direc‚Äê
ci√≥n

MOD_ADDR 0.0

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

INT

512

Direcci√≥n del m√≥dulo

CHANNEL

2.0

INT

1

N√∫mero de canal

LPSCH_EN

4.0

BOOL

TRUE

Si LPSCH_EN = TRUE, ZONE se controla con la instrucci√≥n LP_ZONE. El pa‚Äê
r√°metro de entrada/salida LP_SCH debe estar interconectado con la variable
est√°tica LP_SCH de la instrucci√≥n LP_ZONE. De lo contrario la CPU pasa a
STOP con "Error de √°rea al escribir".
Si LPSCH_EN = FALSE, ZONE se ejecuta en cada ciclo de alarma c√≠clica. No es
necesario asignar un valor al par√°metro de entrada/salida LP_SCH. El tiempo de
muestreo debe estar registrado en la variable est√°tica CYCLE.

ADMIN_EN

4.1

BOOL

TRUE

Si ADMIN_EN = TRUE, la instrucci√≥n ADM_ZONE gestiona varias zonas de
calentamiento/refrigeraci√≥n. El par√°metro de entrada/salida ADMIN debe estar
interconectado con la variable est√°tica ADMIN de la instrucci√≥n ADM_ZONE. De
lo contrario la CPU pasa a STOP con "Error de √°rea al escribir".
Si ADMIN_EN = FALSE, ZONE trabaja sin la instrucci√≥n ADM_ZONE. No es
necesario asignar un valor al par√°metro de entrada/salida ADMIN.

Par√°metros de entrada/salida de ZONE
Tabla 4-364
Par√°metro

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste
prede‚Äê
termi‚Äê
nado

LP_SCH

6.0

STRUC P#P
T
0.0

Interfaz entre las instrucciones LP_ZONE y ADM_ZONE o bien ZONE

ADMIN

12.0

STRUC P#P
T
0.0

Interfaz entre las instrucciones ADM_ZONE y ZONE

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Descripci√≥n

6775

Instrucciones
4.2 Instrucciones

Variables est√°ticas de ZONE
Tabla 4-365
Parameter

Direc‚Äê
ci√≥n

cont_FM455 18.0

Tipo de
datos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

FB

Instancia local de la instrucci√≥n PID_FM_455

PID_F
M_455
pid‚Äê
par_FM455

172.0

FB
PID_P
AR_45
5

SP_IN

426.0

REAL

0.0

La entrada SP_IN permite predeterminar una consigna.

CYCLE

430.0

REAL

0.1

Valor predeterminado del tiempo de muestreo para el algoritmo PID. Si se utiliza la
instrucci√≥n LP_ZONE, LP_ZONE calcula autom√°ticamente el tiempo de muestreo.

H_OFF_EN

434.0

BOOL

TRUE

TRUE= conmutador HEAT_OFF es efectivo e influye en los par√°metros MAN_ON
y MAN.

TUN_EN

434.1

BOOL

TRUE

Si en una optimizaci√≥n de regulador TUN_EN=0, no se calculan par√°metros de
regulador nuevos. Atenci√≥n: el salto de la variable manipulada se aplica de todas
formas.

COOLZO‚Äê
NE

434.2

BOOL

FAL‚Äê
SE

COOLZONE = FALSE: zona s√≥lo de calentamiento

PID_ON

434.3

TRUE

En la entrada PID_ON se puede determinar si el regulador optimizado debe tra‚Äê
bajar como regulador PI o PID.

BOOL

Instancia local de la instrucci√≥n PID_PAR_455

COOLZONE = TRUE: zona de calentamiento/refrigeraci√≥n

Regulador PID: PID_ON = TRUE
Regulador PI: PID_ON = FALSE
Puede ocurrir que en algunos tipos de proceso s√≥lo se dise√±e un regulador PI a
pesar de PID_ON = TRUE.
QCH_F

434.4

BOOL

FAL‚Äê
SE

QCH_F = TRUE: en una de las llamadas de la instancia local de la instrucci√≥n
PID_FM_455 (par√°metro cont_FM455.QCH_F) se ha producido un error de canal
del FM 455.

QTUN_ERR 434.5

BOOL

FAL‚Äê
SE

QTUN_ERR = TRUE: se ha producido un error de operaci√≥n en la optimizaci√≥n de
regulador.
STATUS_H o bien STATUS_C = 3xxxx

QTUN_WR
N

434.6

BOOL

FAL‚Äê
SE

QTUN_WRN = TRUE: se ha producido una advertencia en la optimizaci√≥n de
regulador.
STATUS_H o bien STATUS_C = 2xxxx

QTUNSTCP 434.7

BOOL

FAL‚Äê
SE

QTUNSTCP = TRUE: la optimizaci√≥n se ha iniciado desde el estado fr√≠o del pro‚Äê
ceso y tras la optimizaci√≥n debe regularse al punto de operaci√≥n.
MAN_ON = FALSE; MAN = 0 (calefacci√≥n desconectada)
SP_IN > PV0 +10
(Punto de operaci√≥n mayor que el valor real en 10 en el inicio de la optimizaci√≥n)

QCONTINU

435.0

BOOL

TRUE

Indica si la zona est√° preparada para la siguiente fase de la optimizaci√≥n de regu‚Äê
lador.

PHASE

436.0

INT

0

En el par√°metro PHASE se muestra la fase actual de la optimizaci√≥n de regulador
(0..7, 11..13).

6776

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Parameter

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

STATUS_H

438.0

INT

0

El par√°metro STATUS_H indica un valor de diagn√≥stico a trav√©s de la b√∫squeda
del punto de inversi√≥n en el proceso de calentamiento.

STATUS_C

440.0

INT

0

El par√°metro STATUS_C indica un valor de diagn√≥stico a trav√©s de la b√∫squeda
del punto de inversi√≥n en el proceso de refrigeraci√≥n.

STATUS_D

442.0

INT

0

El par√°metro STATUS_D indica un valor de diagn√≥stico a trav√©s del dise√±o del
regulador en el proceso de calentamiento.

PI_CON

444.0

STRU
CT

Par√°metros PI del regulador

GAIN

+0.0 REAL

0.0

Ganancia PI del regulador

TI

+4.0 REAL

0.0

Tiempo de integraci√≥n PI [s]

=8.0 END_S
TRUCT
PID_CON

452.0

STRU
CT

Par√°metros PID del regulador

GAIN

REAL

0.0

Ganancia PID del regulador

TI

REAL

0.0

Tiempo de integraci√≥n PID [s]

TD

REAL

0.0

Tiempo de acci√≥n derivada PID [s]

=12.0 END_S
TRUCT
PAR_SAVE
GAIN

464.0

STRU
CT

+0.0 REAL

En esta estructura se guardan los par√°metros PID.
0.0

Ganancia del regulador

TI

+4.0 REAL

0.0

Tiempo de integraci√≥n [s]

TD

+8.0 REAL

0.0

Tiempo de acci√≥n derivada [s]

TM_LAG

+12. REAL
0

0.0

Retardo de la acci√≥n D [s]

D_EL_SEL

+16. INT
0

0

Entrada para el componente D

PFDB_SEL

+18. BOOL
0

FAL‚Äê
SE

Acci√≥n P en lazo de realimentaci√≥n

CONZ_ON

+18. BOOL
1

FAL‚Äê
SE

Activar zona de regulaci√≥n

CON_ZONE

+20. REAL
0

100.0

Ancho de zona de regulaci√≥n

RATIOFAC

+24. REAL
0

1.0

Relaci√≥n entre ganancia de calentamiento/refrigeraci√≥n del proceso.

FAL‚Äê
SE

TRUE= desconectar la calefacci√≥n

=28. END_S
0 TRUCT
HEAT_OFF

492.0

BOOL

Hay que activar H_OFF_EN = TRUE para que HEAT_OFF sea efectivo.
‚óè Al activar HEAT_OFF, MAN_ON=TRUE y MAN=0.0.
‚óè Al desactivar HEAT_OFF, MAN_ON=FALSE.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6777

Instrucciones
4.2 Instrucciones
Parameter

Direc‚Äê
ci√≥n

Tipo de
datos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

TUN_ON

492.1

BOOL

FAL‚Äê
SE

CTUN_ON

492.2

BOOL

FAL‚Äê
SE

Activar optimizaci√≥n del regulador
Active TUN=TRUE s√≥lo por un ciclo. TUN_ON se desactiva autom√°ticamente tras
la optimizaci√≥n.
Activar s√≥lo la optimizaci√≥n de refrigeraci√≥n
Active CTUN =TRUE s√≥lo por un ciclo. CTUN _ON se desactiva autom√°ticamente
tras la optimizaci√≥n.

COM_RST

492.3

BOOL

FAL‚Äê
SE

Se inicia la rutina de inicializaci√≥n

TUN_LMN

494.0

REAL

80.0

La excitaci√≥n del proceso para la optimizaci√≥n del regulador desde el estado fr√≠o
del proceso se realiza mediante un salto de la variable manipulada de TUN_LMN.

TUN_DLMN

498.0

REAL

20.0

La excitaci√≥n del proceso para la optimizaci√≥n del regulador en el punto de ope‚Äê
raci√≥n se realiza mediante un salto de la variable manipulada de TUN_DLMN.

TUN_CLMN

502.0

REAL

-10.0

Variable manipulada tras iniciar la optimizaci√≥n de la refrigeraci√≥n.

STAT_TM

506.0

REAL

30.0

Tiempo para la condici√≥n de estacionariedad para la fase 1 u 11 de la optimizaci√≥n
del regulador
El proceso se considera estacionario si dentro del tiempo STAT_TM el valor real o
manipulado no cambia m√°s de 2*STAT_D_PV o 2*STATDLMN.

STAT_DPV

510.0

REAL

1.0

STATDLMN

514.0

REAL

4.0

RATIOFAC

518.0

REAL

1.0

Delta de valor real para la condici√≥n de estacionariedad para la fase 1 u 11 de la
optimizaci√≥n de regulador
V√©ase STAT_TM
Delta de variable manipulada para el control manual de estacionariedad para la
fase 1 u 11 de la optimizaci√≥n del regulador
V√©ase STAT_TM
Relaci√≥n entre ganancia de calentamiento/refrigeraci√≥n del proceso.
El l√≠mite inferior de la variable manipulada e "Inicio de rango de se√±al de entrada
de variable manipulada B de la funci√≥n de rango partido" se adaptan autom√°tica‚Äê
mente.

CON_ZONE 522.0

REAL

100.0

Zona de regulaci√≥n
Si ER >= CON_ZONE, entonces LMN = LMN_HLM.
Si ER <= -CON_ZONE (o bien -CON_ZONE /RATIOFAC), entonces LMN =
LMN_LLM.

MAN

526.0

REAL

0.0

Valor manual
Si
H_OFF_EN=TRUE, el par√°metro se ve afectado por HEAT_OFF.

MAN_ON

530.0

BOOL

TRUE

Conmutaci√≥n manual/autom√°tica
Si H_OFF_EN=TRUE, el par√°metro se ve afectado por HEAT_OFF.

CONZ_ON

6778

530.1

BOOL

FAL‚Äê
SE

TRUE = zona de regulaci√≥n activada

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Parameter

Direc‚Äê
ci√≥n

UNDO_PAR 530.2

Tipo de
datos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

BOOL

FAL‚Äê
SE

Copia los par√°metros de regulador de la estructura PAR_SAVE en los par√°metros:
‚óè cont_FM455.GAIN
‚óè cont_FM455.TI
‚óè cont_FM455.TD
‚óè cont_FM455.TM_LAG
‚óè cont_FM455.D_EL_SEL
‚óè cont_FM455.PFDB_SEL
‚óè CONZ_ON
‚óè CON_ZONE
‚óè RATIOFAC
A continuaci√≥n los par√°metros se cargan en el FM 455.
La funci√≥n no se ejecuta en el modo autom√°tico.

SAVE_PAR

530.3

BOOL

FAL‚Äê
SE

Guarda los siguientes par√°metros de regulador en la estructura PAR_SAVE:
‚óè cont_FM455.GAIN
‚óè cont_FM455.TI
‚óè cont_FM455.TD
‚óè cont_FM455.TM_LAG
‚óè cont_FM455.D_EL_SEL
‚óè cont_FM455.PFDB_SEL
‚óè CONZ_ON
‚óè CON_ZONE
‚óè RATIOFAC

LOAD_PID

530.4

BOOL

FAL‚Äê
SE

Cargar par√°metros PI/PID:
Con PID_ON=TRUE copia los par√°metros PID de la estructura PID_CON en los
par√°metros:
‚óè cont_FM455.GAIN
‚óè cont_FM455.TI
‚óè cont_FM455.TD
‚óè cont_FM455.TM_LAG
Con PID_ON=FALSE copia los par√°metros PI de la estructura PI_CON en los
par√°metros:
‚óè cont_FM455.GAIN
‚óè cont_FM455.TI
‚óè cont_FM455.TD = 0.0
‚óè cont_FM455.TM_LAG = 0.5
A continuaci√≥n los par√°metros se cargan en el FM 455.
La funci√≥n no se ejecuta en el modo autom√°tico.

BTUN_DPV

532

REAL

0.0

Diferencia de valor real para la cancelaci√≥n autom√°tica de la optimizaci√≥n.

BTUN_TM

536

REAL

300.0

Tiempo tras el salto de la variable manipulada para la cancelaci√≥n autom√°tica de
la optimizaci√≥n.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6779

Instrucciones
4.2 Instrucciones

Variables para la optimizaci√≥n de regulador ZONE
Tabla 4-366
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste Descripci√≥n
prede‚Äê
termi‚Äê
nado

GAIN_P

540.0

REAL

0.0

Ganancia del proceso identificada.

TU

544.0

REAL

0.0

Tiempo de retardo identificado del proceso.

TA

548.0

REAL

0.0

Tiempo de compensaci√≥n identificado del proceso.

KIG

552.0

REAL

0.0

Rampa m√°xima de subida del valor real en el calentamiento.

KIG_C

556.0

REAL

0.0

Rampa m√°xima de bajada del valor real en la refrigeraci√≥n.

N_PTN

560.0

REAL

0.0

Orden del proceso. Tambi√©n se pueden utilizar "valores no enteros".

TM_LAG_P

564.0

REAL

0.0

Constante temporal de un modelo PTN. (valores razonables s√≥lo para
N_PTN>=2).

T_P_INF

568.0

REAL

0.0

Tiempo desde la excitaci√≥n del proceso hasta el punto de inversi√≥n.

P_INF

572.0

REAL

0.0

Modificaci√≥n del valor real desde la excitaci√≥n del proceso hasta el punto de in‚Äê
versi√≥n.

LMN0

576.0

REAL

0.0

Variable manipulada al iniciar la optimizaci√≥n.
Se calcula en la fase 1 (valor medio).

PV0

580.0

REAL

0.0

Valor real al inicio de la optimizaci√≥n.
Se calcula en la fase 1 (valor medio).

PVDT0

584.0

REAL

0.0

Rampa de subida de valor real al inicio de la optimizaci√≥n.

PVDT

588.0

REAL

0.0

Rampa de subida actual de valor real

PVDT_MAX

592.0

REAL

0.0

Derivaci√≥n m√°xima del valor real en el punto de inversi√≥n (con adaptaci√≥n de
signo, siempre > 0); se utiliza para calcular TU y KIG.

NOI_PVDT

596.0

REAL

0.0

Nivel de ruido en PVDT_MAX en %.
Cuanto mayor sea el nivel de ruido, menos precisos (de efecto m√°s suave) ser√°n
los par√°metros del regulador.

NOISE_PV

600.0

REAL

0.0

Ruido absoluto en el valor real;

FIL_CYC

604.0

INT

1

N√∫mero de ciclos del filtro de valores medios 1 ... 1024;

Diferencia entre el valor real m√°ximo y m√≠nimo en la fase 1.
Se calcula un valor medio del valor real a partir de FIL_CYC ciclos. En caso ne‚Äê
cesario, FIL_CYC se aumenta autom√°ticamente entre 1 y m√°x. 1024.
POI_CMAX

606.0

INT

0

N√∫mero m√°ximo de ciclos tras el punto de inversi√≥n.
Este tiempo se utiliza para encontrar otro punto de inversi√≥n (es decir, uno mejor)
en caso de ruidos de medici√≥n. S√≥lo entonces concluye la optimizaci√≥n.

POI_CYCL

608.0

INT

0

N√∫mero de ciclos tras el punto de inversi√≥n.

NBR_CALL

610.0

INT

-1

N√∫mero de llamada; se registra autom√°ticamente tras un rearranque completo.

A continuaci√≥n siguen par√°metros internos que no pueden ser utilizados por el usuario.

Par√°metros STATUS_H y STATUS_C
STATUS_H indica un valor de diagn√≥stico a trav√©s de la b√∫squeda del punto de inversi√≥n,
STATUS_C en la refrigeraci√≥n.
Si se indica un valor de diagn√≥stico 2xxxx, QTUN_WRN = TRUE.

6780

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Si se indica un valor de diagn√≥stico 3xxxx, QTUN_ERR = TRUE.
STATUS_ H
STATUS_C

Descripci√≥n

0

Par√°metros del regulador predeterminados, ninguno
o ninguno nuevo

10000

Optimizaci√≥n finalizada + par√°metros adecuados en‚Äê
contrados para el regulador

2xxxx

Optimizaci√≥n finalizada + par√°metros del regulador
inseguros

2xx2x

Punto de inversi√≥n no alcanzado
(s√≥lo en caso de optimizaci√≥n desde el estado fr√≠o del
proceso al punto de operaci√≥n QTUNSTCP =TRUE)

Soluci√≥n

Si el regulador oscila, atenuar los par√°metros del re‚Äê
gulador o repetir el ensayo con una diferencia menor
de la variable manipulada TUN_LMN.

2x1xx

Error de estimaci√≥n TU demasiado peque√±o
TU < 3*CYCLE

Reducir CYCLE y repetir el ensayo.
Caso especial, proceso puramente PT1: No repetir el
ensayo, atenuar los par√°metros del regulador si pro‚Äê
cede.

2x2xx

Error de estimaci√≥n T_P_INF demasiado peque√±o
T_P_INF < 72.8*CYCLE

V√©ase 2x1xx

2x3xx

Error de estimaci√≥n TU demasiado peque√±o y error
de estimaci√≥n T_P_INF demasiado peque√±o

V√©ase 2x1xx

3xxxx

La optimizaci√≥n se ha cancelado. No se ha determi‚Äê
nado ning√∫n par√°metro de regulador.

30002

En la optimizaci√≥n de calentamiento:
Diferencia efectiva de la variable manipulada < 5 %

Corregir la diferencia de variable manipulada
TUN_LMN, TUN_DLMN o bien TUN_CLMN.

En la optimizaci√≥n de la refrigeraci√≥n:
TUN_CLMN > -5 %
30003

En la optimizaci√≥n de refrigeraci√≥n el l√≠mite inferior de Ajuste la zona como zona de calentamiento/refrigera‚Äê
la variable manipulada no es correcto:
ci√≥n COOLZONE =TRUE y compruebe
cont_FM455.LMN_LLM > -5.0
cont_FM455.LMN_LLM.

30004

Diferencia efectiva de la variable manipulada limita‚Äê
da por los l√≠mites de rango partido y no por los l√≠mites
de la variable manipulada.

Compruebe los l√≠mites de la variable manipulada y de
rango partido.

El tiempo de muestreo CYCLE difiere en m√°s del 5%
del valor medido.

Compare CYCLE con el tiempo de ciclo del nivel de
alarma c√≠clica y, dado el caso, observe los posibles
distribuidores de llamada.

30005

Corrija la diferencia de la variable manipulada
TUN_LMN, TUN_DLMN o bien TUN_CLMN.

Compruebe el grado de utilizaci√≥n de la CPU. Una
CPU con un grado de utilizaci√≥n excesivo conlleva
tiempos de muestreo excesivos, que no concuerdan
con CYCLE.
30008

Se intenta realizar una optimizaci√≥n de refrigeraci√≥n,
pero antes no se ha llevado a cabo una optimizaci√≥n
de calentamiento (KIG=0.0).

Realizar primero una optimizaci√≥n de calentamiento.

30009

Modo de seguridad: cont_FM455.QLMNSAFE =
TRUE

Finalice el modo de seguridad y vuelva a iniciar la op‚Äê
timizaci√≥n.

30010

Una modificaci√≥n de la potencia de calefacci√≥n/refri‚Äê Compruebe la evoluci√≥n de la se√±al de la variable ma‚Äê
geraci√≥n no provoca un cambio suficiente en la tem‚Äê nipulada y del valor de tiempo. Compruebe si los pa‚Äê
peratura.
r√°metros BTUN_TM y BTUN_DPV son plausibles.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6781

Instrucciones
4.2 Instrucciones

Consulte tambi√©n
Par√°metros de salida de ADM_ZONE (P√°gina 6772)

Par√°metro STATUS_D
STATUS_D

Descripci√≥n

0

No se han calculado par√°metros del regulador

110

N_PTN <= 1.5 tipo de sistema I r√°pido

121

N_PTN > 1.5 tipo de sistema I

200

N_PTN > 1.9 tipo de sistema II (rango de transici√≥n)

310

N_PTN >= 2.1 tipo de sistema III r√°pido

320

N_PTN > 2.6 tipo de sistema III

111, 122, 201, 311, 321

Los par√°metros se han corregido en la fase 7.

Nota
Al final de la fase 1 STATUS_H = 0 se desactiva. Si la optimizaci√≥n se cancela en la fase 2,
entonces STATUS_H = 0. Sin embargo, STATUS_D sigue mostrando el estado del √∫ltimo
c√°lculo del regulador.
Cuanto mayor sea el valor de STATUS_D, mayor ser√° el orden del proceso regulado, mayor
la relaci√≥n TU/TA y m√°s suaves los par√°metros del regulador.

Par√°metro PHASE
PHASE

Descripci√≥n

0

No hay modo de optimizaci√≥n; modo autom√°tico o manual

1

Prueba de estacionariedad; comprobar par√°metros; aplicar una variable manipulada de
calentamiento constante

2

B√∫squeda del punto de inversi√≥n con variable manipulada constante

3 (1 ciclo por instrucci√≥n ZO‚Äê
NE)

Calcular los par√°metros del proceso. Guardar los par√°metros de regulador v√°lidos antes de
la optimizaci√≥n

4 (1 ciclo por instrucci√≥n ZO‚Äê
NE)

Dise√±o del regulador

5 (1 ciclo por instrucci√≥n ZO‚Äê
NE)

Corregir el regulador a la nueva magnitud manipulada

7

Verificaci√≥n del tipo de sistema (s√≥lo con optimizaci√≥n de calefacci√≥n)

10

Optimizaci√≥n de refrigeraci√≥n: Esperar hasta que todas las zonas est√©n en modo autom√°‚Äê
tico (fase > 2).

11

Optimizaci√≥n de refrigeraci√≥n: Prueba de estacionariedad; comprobar par√°metros; aplicar
una variable manipulada de refrigeraci√≥n constante

12

Optimizaci√≥n de refrigeraci√≥n: B√∫squeda de punto de inversi√≥n con variable manipulada
constante

13

Optimizaci√≥n de refrigeraci√≥n: C√°lculo de la relaci√≥n calentamiento/refrigeraci√≥n

6782

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones

Fases de la optimizaci√≥n de calefacci√≥n en el primer arranque
La figura siguiente muestra las fases de una optimizaci√≥n s√≥lo de calentamiento partiendo de
la temperatura ambiente hasta el punto de operaci√≥n:
3+$6(  XQ
FLFORSRUFDGD
LQVWUXFFL¬µQ=21(
3+$6( 

3+$6( 

3+$6( 

3+$6( 

3+$6( 

63

7HPS /01

781B/01

39
/01

3XQWRGH
LQYHUVL¬µQ
(VWDGRIU¬ØR
GHO
SURFHVR
781B21
'HVDFWLYDGRSRUOD
LQVWUXFFL¬µQ=21(

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

(VWDGRFDOLHQWH
GHOSURFHVR
SXQWRGH
RSHUDFL¬µQ

W

W

6783

Instrucciones
4.2 Instrucciones

Fases de la optimizaci√≥n de calentamiento en el punto de operaci√≥n
La figura siguiente muestra las fases de una optimizaci√≥n s√≥lo de calentamiento en el punto de
operaci√≥n:
3+$6( 
FLFORSRUFDGDLQVWUXFFL¬µQ=21(

7HPSHUDWXUD
3+$6( 

3+$6( 

3+$6( 

3XQWR
GH
LQYHUVL
¬µQ

3+$6( 

3+$6( 

39

3XQWRGHRSHUDFL¬µQYDORUUHDO

781B'/01

/01

3XQWRGHRSHUDFL¬µQYDORUPDQLSXODGR

781B21'HVDFWLYDGR
SRU=21(

W
781B21

Al final de la optimizaci√≥n, si la instrucci√≥n vuelve a cambiar a la fase 0 y TUN_ON=FALSE, en
los par√°metros STATUS_H, STATUS_C o QTUN_WRN, QTUN_ERR se puede saber si la
optimizaci√≥n se ha desarrollado sin errores.

DB para HMI
Descripci√≥n de DB 101 a 116
Para poder manejar el FM 455 con el OP en caso de fallo de la CPU se requieren los bloques
de datos 101 a 104. Con MPI se pueden establecer hasta tres conexiones desde el FM 455 a
los OPs.
El manejo del FM 455 con el OP s√≥lo es posible en el estado STOP de la CPU en caso de fallo
de la CPU.
El FM 455 siempre se puede observar con el OP.

6784

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
La interfaz de variables del FM 455 contiene 16 bloques de datos con los n√∫meros de bloque
101 a 116 para los canales de regulador 1 a 16 (vea la siguiente figura).
Nota
El contenido de los bloques de datos 101 a 116 no refleja autom√°ticamente el valor de
par√°metro efectivo en el FM 455. Los par√°metros cambiados con ayuda del OP s√≥lo se aplican
en el FM 455 tras haberse activado los bits de operaci√≥n LOAD_PARo LOAD_OP.
Si se cambia un par√°metro manejando el OP sin activar el bit de operaci√≥n correspondiente,
el valor de par√°metro modificado est√° en el bloque de datos, pero el FM 455 trabaja
internamente con el valor anterior no modificado del par√°metro.
Tras activar los bits de operaci√≥n y aplicar los par√°metros en el FM 455, los bits de operaci√≥n
LOAD_PAR o LOAD_OP son desactivados por el FM 455.

23

0DQHMR\YLVXDOL]DFL¬µQHQ
HVWDGR581GHOD&38

0DQHMRV¬µORHQHVWDGR6723GH
OD&38RHQFDVRGHIDOORGHOD
&38YLVXDOL]DFL¬µQ

&38

)0

'%
KDVWD


)%
3,'B)0

0¬£['%V
GHLQVWDQFLD
GHO)%
3,'B)0




3DU¬£PHWUR

* Controlado por el par√°metro READ_VAR del DB de instancia
** Controlado por los par√°metros LOAD_OP y LOAD_PAR

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6785

Instrucciones
4.2 Instrucciones

Par√°metros de entrada de los DB 101 a 116
Nota
La EPROM del m√≥dulo podr√≠a quedar destruida por un n√∫mero excesivo de procesos de
escritura. Para evitarlo, tras la escritura de la EEPROM el m√≥dulo retrasa una nueva escritura
30 minutos.

Tabla 4-367
Par√°metro

1)

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

par√°metros de regulador; 2) par√°metros operativos

SP_HLM1)

0.0

REAL

100.0

SP_LLM1)

4.0

REAL

0.0

H_ALM1)

8.0

REAL

100.0

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La entrada
"L√≠mite superior consigna" indica el l√≠mite superior.
SP_HLM > SP_LLM
La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La entrada
"L√≠mite inferior consigna" indica el l√≠mite inferior.
SP_LLM < SP_HLM
Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Alarma de l√≠mite superior" indica el l√≠mite m√°s alto.
H_ALM > H_WRN

H_WRN

12.0

1)

REAL

90.0

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Advertencia de l√≠mite superior" indica el segundo l√≠mite
m√°s alto.
Se admiten valores entre H_ALM y L_WRN

L_WRN

1)

16.0

REAL

10.0

20.0

REAL

0.0

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Advertencia de l√≠mite inferior" indica el segundo l√≠mite
m√°s bajo.
Se admiten valores entre H_WRN y L_ALM

L_ALM1)

Para la vigilancia del valor real o del error de regulaci√≥n se pueden parametrizar
cuatro l√≠mites. La entrada "Alarma de l√≠mite superior" indica el l√≠mite m√°s bajo.
L_ALM < L_WRN

HYS

24.0

1)

REAL

1.0

Para evitar oscilaciones de las indicaciones de vigilancia, puede parametrizarse
una hist√©resis en la entrada "Hist√©resis".
HYS ‚â• 0.0

DEADB_W

1)

28.0

REAL

0.0

El error de regulaci√≥n se conduce por una zona muerta. La entrada "Ancho de zona
muerta" determina el tama√±o de la zona muerta.
DEADB_W ‚â• 0.0

GAIN

32.0

REAL

1.0

La entrada "Ganancia proporcional" indica la ganancia del regulador.

TI1)

36.0

REAL

3000.
0

La entrada "Tiempo de integraci√≥n" determina el comportamiento temporal del in‚Äê
tegrador. Con TI = 0 el integrador est√° desactivado.

1)

TI = 0.0 o bien TI ‚â• 0.5

6786

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

TD1)

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

40.0

REAL

0.0

Descripci√≥n

La entrada "Tiempo de acci√≥n derivada" determina el comportamiento temporal del
diferenciador. Con TD = 0 el diferenciador est√° desactivado.
TD = 0.0 o bien TD ‚â• 1.0

TM_LAG

44.0

REAL

5.0

LMN_SA‚Äê
FE1)

48.0

REAL

0.0

LMN_HLM1)

52.0

REAL

100.0

1)

El algoritmo de la acci√≥n D contiene un retardo que se puede parametrizar en la
entrada "Tiempo de retardo de la acci√≥n D".
TM_LAG ‚â• 0.5
Para la variable manipulada puede parametrizarse un valor de seguridad en la
entrada "Variable manipulada de seguridad".
Se admiten valores entre -100 y 100 %.
La variable manipulada est√° limitado siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite superior de la variable manipulada" indica el l√≠mite superior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores entre LMN_LLM y 100 %.

LMN_LLM

1)

56.0

REAL

0.0

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La entrada "L√≠mite inferior de la variable manipulada" indica el l√≠mite inferior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores entre -100 y LMN_HLM.

MTR_TM

1)

60.0

REAL

60.0

En el par√°metro "Tiempo de posicionamiento del motor" se introduce el tiempo de
operaci√≥n de la servov√°lvula de un tope al otro.
(S√≥lo en regulador paso a paso)
MTR_TM ‚â• 0.001

PUL‚Äê
SE_TM1)

64.0

REAL

0.2

En el par√°metro "Duraci√≥n m√≠nima de impulso" se puede parametrizar una duraci√≥n
de impulso m√≠nima.
(S√≥lo en regulador paso a paso o de impulsos)

BREAK_TM
1)

68.0

REAL

0.2

En el par√°metro "Duraci√≥n m√≠nima de pausa" se puede parametrizar una duraci√≥n
de pausa m√≠nima.
(S√≥lo en regulador paso a paso o de impulsos)

SP_RE

72.0

2)

REAL

0.0

En la entrada "Consigna externa" se conecta una consigna externa con el regula‚Äê
dor.
Rango de valores t√©cnico (magnitud f√≠sica)

LMN_RE

76.0

2)

REAL

0.0

En la entrada "Variable manipulada externa" se conecta una variable manipulada
externo con el regulador.
Se admiten valores entre -100 y 100 %.

LMNRSVAL 80.0
2)

REAL

0.0

Desde el cuadro de di√°logo Puesta en marcha se puede acceder a la entrada "Valor
inicial de la realimentaci√≥n de posici√≥n simulada". En ese par√°metro se indica el
valor inicial de la simulaci√≥n.
(S√≥lo en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
Se admiten valores entre -100 y 100 %.

SAFE_ON

2)

84.0

BOOL

FAL‚Äê
SE

Si la entrada "Adoptar posici√≥n de seguridad" est√° activada, se aplica un valor de
seguridad como variable manipulada.
Nota:
El procesamiento de la se√±al de salida con LMNDN_OP, LMNUP_OP y LMNSO‚Äê
PON en el regulador paso a paso tiene mayor prioridad que la variable manipulada
de seguridad.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6787

Instrucciones
4.2 Instrucciones
Par√°metro

LMNTRKO
N2)

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

84.1

BOOL

FAL‚Äê
SE

Descripci√≥n

Si la entrada "Corregir (LMN a trav√©s de EA)" est√° activada, la variable manipulada
se rige por una entrada anal√≥gica (EA).
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

LMN_REON 84.2

BOOL

FAL‚Äê
SE

Si la entrada "Aplicar variable manipulada externa" est√° activada, se aplica la va‚Äê
riable manipulada externa LMN_RE como variable manipulada.

LMNRHSR
E2)

84.3

BOOL

FAL‚Äê
SE

La se√±al "Servov√°lvula en el tope superior" se interconecta a la entrada "Se√±al de
tope superior de la realimentaci√≥n de posici√≥n". LMNRHSRE = TRUE significa: La
servov√°lvula se encuentra en el tope superior.

LMNRLSRE 84.4

BOOL

FAL‚Äê
SE

La se√±al "Servov√°lvula en el tope inferior" se interconecta a la entrada "Se√±al de
tope inferior de la realimentaci√≥n de posici√≥n". LMNRLSRE = TRUE significa: La
servov√°lvula se encuentra en el tope inferior.

2)

(S√≥lo en regulador paso a paso)
2)

(S√≥lo en regulador paso a paso)
LMNSO‚Äê
PON2)

84.5

BOOL

FAL‚Äê
SE

Si el bit de la entrada "Activar control manual de la se√±al de variable manipulada"
est√° activada, las se√±ales LMNUP_OP y LMNDN_OP se aplican como se√±ales de
variable manipulada.
(S√≥lo en regulador paso a paso)

LMNUP_OP 84.6

BOOL

FAL‚Äê
SE

Si LMNSOPON est√° activado, el valor se adopta como se√±al de variable manipu‚Äê
lada en la entrada "Subir se√±al de variable manipulada".

LMNDN_OP 84.7

BOOL

FAL‚Äê
SE

Si LMNSOPON est√° activado, el valor se adopta como se√±al de variable manipu‚Äê
lada en la entrada "Bajar se√±al de variable manipulada".

MONER‚Äê
SEL1)

85.0

BOOL

FAL‚Äê
SE

El regulador dispone de un avisador de valor l√≠mite, que puede utilizarse para el
valor real o para el error de regulaci√≥n. Si la entrada "Vigilancia: Valor real = 0, Error
de regulaci√≥n = 1" est√° activada, se vigila el error de regulaci√≥n.

LMNRS_ON 85.1

BOOL

FAL‚Äê
SE

Si no se dispone de una realimentaci√≥n de posici√≥n, puede simularse. La funci√≥n se
activa en la entrada "Activar simulaci√≥n de la realimentaci√≥n de posici√≥n". ATEN‚Äê
CI√ìN: Con el paso del tiempo, la simulaci√≥n difiere cada vez m√°s de la realimen‚Äê
taci√≥n de posici√≥n real.

2)

(S√≥lo en regulador paso a paso)
2)

(S√≥lo en regulador paso a paso)

2)

(S√≥lo en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
FUZID_ON

85.2

BOOL

FAL‚Äê
SE

En la entrada "Activar identificaci√≥n de difuso" se activa la identificaci√≥n del algo‚Äê
ritmo difuso.

SPINT_EN2) 85.3

BOOL

FAL‚Äê
SE

La entrada "Entrada de control manual: externo = 0, interno = 1" determina la en‚Äê
trada que se transmite al m√≥dulo como consigna.

2)

SPINT_EN = TRUE: se transfiere SP_INT.
SPINT_EN = FALSE: se transfiere SP_RE.
P_SEL1)

6788

85.4

BOOL

TRUE

En el algoritmo PID las acciones PID se pueden conectar y desconectar individual‚Äê
mente. La acci√≥n proporcional est√° conectada si la entrada "Activar acci√≥n P" est√°
activada.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

PFDB_SEL1 85.5

BOOL

FAL‚Äê
SE

En el algoritmo PID las acciones P y D se pueden incluir en el lazo de realimenta‚Äê
ci√≥n. La acci√≥n proporcional se encuentra en el lazo de realimentaci√≥n si la entrada
"Incluir acci√≥n P en lazo de realimentaci√≥n" est√° activada.

D_EL_SEL1) 86.0

INT

0

El componente D del algoritmo PID puede depositarse en una entrada separada.
√âsta se selecciona en la entrada "Entrada para componente D".

)

Descripci√≥n

‚óè 0: Error de regulaci√≥n
‚óè 1 a 16: Entrada anal√≥gica 1 a 16
‚óè 17: Valor real negativo

Par√°metros de salida de los DB 101 a 116
Tabla 4-368
Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

SP

94.0

REAL

0.0

En la salida "Consigna" se indica la consigna que act√∫a efectivamente.

PV

98.0

REAL

0.0

En la salida "Valor real" se indica el valor real que act√∫a efectivamente.

ER

102.0

REAL

0.0

En la salida "Error de regulaci√≥n" se indica el error de regulaci√≥n que act√∫a real‚Äê
mente.

DISV

106.0

REAL

0.0

En la salida "Variable perturbadora" se indica la magnitud perturbadora que act√∫a
efectivamente.

Par√°metro

Descripci√≥n

Se admiten valores entre -100 y 100 %.
LMN

110.0

REAL

0.0

En la salida "Variable manipulada" se indica la variable manipulada que act√∫a
efectivamente. En el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥‚Äê
gica, en el par√°metro LMN se indica la acci√≥n P + D ilimitada.

LMN_A

114.0

REAL

0.0

En la salida "Variable manipulada A de la funci√≥n de rango partido / realimentaci√≥n
de posici√≥n" se indica la variable manipulada A de la funci√≥n de rango partido en
el regulador continuo, y la realimentaci√≥n de posici√≥n en el regulador paso a paso
con realimentaci√≥n de posici√≥n anal√≥gica.

Se admiten valores entre -100 y 100 %.

En el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica se muestra
la realimentaci√≥n de posici√≥n simulada.
Se admiten valores entre -100 y 100 %.
LMN_B

118.0

REAL

0.0

Para el regulador continuo, en la salida "Variable manipulada B de la funci√≥n de
rango partido" se indica la variable manipulada B de la funci√≥n de rango partido.
Se admiten valores entre -100 y 100 %.

QH_ALM

122.0

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Alarma de l√≠mite superior disparada" se notifica el rebase del l√≠mite
H_ALM.

QH_WRN

122.1

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Advertencia de l√≠mite superior disparada" se notifica el rebase del
l√≠mite H_WRN.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6789

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

QL_WRN

122.2

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Advertencia de l√≠mite inferior disparada" se notifica el rebase por
defecto del l√≠mite L_WRN.

QL_ALM

122.3

BOOL

FAL‚Äê
SE

El valor real o la magnitud regulada se somete a un control de cuatro valores l√≠mite.
En la salida "Alarma de l√≠mite inferior disparada" se notifica el rebase por defecto
del l√≠mite L_ALM.

QLMN_HLM 122.4

BOOL

FAL‚Äê
SE

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
En la salida "L√≠mite superior de variable manipulada alcanzado" se notifica el re‚Äê
base del l√≠mite superior.

QLMN_LLM

BOOL

FAL‚Äê
SE

(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)
122.5

La variable manipulada est√° limitada siempre por un l√≠mite superior y uno inferior.
La salida "L√≠mite inferior de la variable manipulada alcanzado" indica el rebase por
defecto del l√≠mite inferior.
(No en el regulador paso a paso sin realimentaci√≥n de posici√≥n anal√≥gica)

QSPINTON

122.6

BOOL

FAL‚Äê
SE

La salida "Consigna interna activada" indica que SP_INT se ha transferido al m√≥‚Äê
dulo.

QPARA_F

123.0

BOOL

FAL‚Äê
SE

El m√≥dulo comprueba la validez de los par√°metros. Un error de parametrizaci√≥n se
indica en la salida "Error de parametrizaci√≥n". Este error de parametrizaci√≥n tam‚Äê
bi√©n se puede ver en el cuadro de di√°logo "Online y diagn√≥stico" del m√≥dulo.

QCH_F

123.1

BOOL

FAL‚Äê
SE

La salida "Error de canal" se activa cuando el canal de regulaci√≥n no puede arrojar
resultados v√°lidos. El error de canal (p. ej. rotura de hilo) tambi√©n se activa con
QPARA_F = 1 o QMOD_F = 1. Si QCH_F = TRUE, la informaci√≥n precisa del error
puede verse en el registro de diagn√≥stico DS1 del m√≥dulo.

QUPRLM

123.2

BOOL

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada. Si la salida "Limitaci√≥n
positiva de rampa de subida de la consigna" est√° activada, se limita la rampa de
subida de la consigna.

QDNRLM

123.3

BOOL

FAL‚Äê
SE

La consigna se limita en las rampas de subida y bajada. Si la salida "Limitaci√≥n
negativa de rampa de subida de la consigna" est√° activada, se limita la rampa de
bajada de la consigna.

QSP_HLM

123.4

BOOL

FAL‚Äê
SE

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. En la salida
"L√≠mite superior de consigna alcanzado" se notifica el rebase del l√≠mite superior.

QSP_LLM

123.5

BOOL

FAL‚Äê
SE

La consigna est√° limitada siempre por un l√≠mite superior y uno inferior. La salida
"L√≠mite inferior de la consigna alcanzado" indica el rebase del l√≠mite inferior.

QSPOPON

123.6

BOOL

FAL‚Äê
SE

En la salida "Control manual de consigna activado" se indica si la consigna se
controla a trav√©s del cuadro de di√°logo "Puesta en servicio". Si el bit est√° activado,
el valor SP_OP se aplica como consigna.

QLMNSAFE 123.7

BOOL

FAL‚Äê
SE

Si la salida "Modo de seguridad" est√° activada, como variable manipulada se emite
la variable manipulada de seguridad.

QLMNO‚Äê
PON

124.0

BOOL

FAL‚Äê
SE

En la salida "Control manual de variable manipulada activado" se indica si la va‚Äê
riable manipulada se controla desde el cuadro de di√°logo "Puesta en servicio". Si
el bit est√° activado, el valor LMN_OP se aplica como variable manipulada.

QLMNTRK

124.1

BOOL

FAL‚Äê
SE

La salida "Modo de seguimiento" indica si la variable manipulada se corrige me‚Äê
diante una entrada anal√≥gica.

QLMN_RE

124.2

BOOL

FAL‚Äê
SE

La salida "Manual = 1; Autom√°tico = 0" indica si la variable manipulada adopta la
variable manipulada externa LMN_RE (Manual = 1) o no.

6790

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

QLMNR_HS 124.3

BOOL

FAL‚Äê
SE

QLMNR_LS

BOOL

FAL‚Äê
SE

Descripci√≥n

La salida "Se√±al de tope superior de la realimentaci√≥n de posici√≥n" indica si la
servov√°lvula se encuentra en el tope superior. QLMNR_HS = TRUE significa: La
servov√°lvula se encuentra en el tope superior.
(S√≥lo en regulador paso a paso)

124.4

La salida "Se√±al de tope inferior de la realimentaci√≥n de posici√≥n" indica si la
servov√°lvula se encuentra en el tope inferior. QLMNR_LS = TRUE significa: La
servov√°lvula se encuentra en el tope inferior.
(S√≥lo en regulador paso a paso)

QLMNR_O
N

124.5

BOOL

FAL‚Äê
SE

La salida "Realimentaci√≥n de posici√≥n activada" indica que est√° activado el modo
de operaci√≥n "Regulador paso a paso con realimentaci√≥n de posici√≥n" o "Regula‚Äê
dor paso a paso sin realimentaci√≥n de posici√≥n".

QFUZZY

124.6

BOOL

FAL‚Äê
SE

Si la salida "Algoritmo PID = 0; Difuso = 1" est√° activada, el regulador trabaja con
el algoritmo difuso.

QSPLEPV

124.7

BOOL

FAL‚Äê
SE

La salida "Indicaci√≥n del regulador difuso: consigna < valor real" se activa con el
regulador difuso si la consigna es menor que el valor real efectivo.

QSPR

125.0

BOOL

FAL‚Äê
SE

Si la salida "Modo de rango partido" est√° activada, el regulador continuo trabaja en
modo de rango partido.

QLMNUP

125.1

BOOL

FAL‚Äê
SE

Se trata de la salida "Se√±al alta de variable manipulada".
(S√≥lo en regulador paso a paso o de impulsos)

QLMNDN

125.2

BOOL

FAL‚Äê
SE

Se trata de la salida "Se√±al baja de variable manipulada".

QBACKUP

125.4

BOOL

FAL‚Äê
SE

‚óè 0= no hay estado de copia de seguridad (CPU en RUN)

(S√≥lo en regulador paso a paso o de impulsos)
‚óè 1= estado de copia de seguridad (CPU e STOP o falla)

QID

125.5

BOOL

FAL‚Äê
SE

QID = TRUE indica que hay una identificaci√≥n en curso (no que est√© activada). Una
vez completada la identificaci√≥n, el resultado puede verse a trav√©s del par√°metro
IDSTATUS de la instrucci√≥n CH_DIAG_455.

QMAN_FC

125.6

BOOL

FAL‚Äê
SE

El regulador es un regulador piloto que, mediante la operaci√≥n manual de un re‚Äê
gulador secundario, se corrige seg√∫n el valor real de este √∫ltimo, o cuya acci√≥n I se
detiene porque la consigna o la magnitud manipulada del regulador secundario
est√°n en el l√≠mite.

RET_VALU

126.0

WORD

0

RET_VALU contiene el valor de respuesta RET_VAL de las instrucciones RD_REC
y WR_REC. RET_VALU puede evaluarse si se notifica un error a trav√©s de
QMOD_F.

Consulte tambi√©n
RD_REC: Leer registro de periferia (P√°gina 5922)
WR_REC: Escribir registro en periferia (P√°gina 5927)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6791

Instrucciones
4.2 Instrucciones

Par√°metros de entrada/salida de DB 101 a 116
Tabla 4-369
Par√°metro

Direc‚Äê
ci√≥n

Tipo
de da‚Äê
tos

Ajuste
prede‚Äê
termi‚Äê
nado

Descripci√≥n

1) Par√°metros operativos
SP_INT

128.0

REAL

0.0

El par√°metro de entrada/salida "Consigna interna" sirve para preseleccionar una
consigna mediante funciones de manejo y visualizaci√≥n.

SP_OP1)

132.0

REAL

0.0

El cuadro de di√°logo "Puesta en servicio" tiene acceso al par√°metro de entrada/
salida "Control manual de consigna" Si el bit SP_OP_ON est√° activado, se aplica
el valor "Control manual de consigna" como consigna.

LMN_OP1)

136.0

REAL

0.0

El cuadro de di√°logo "Puesta en servicio" tiene acceso al par√°metro de entrada/
salida "Control manual de variable manipulada" Si el bit LMNOP_ON est√° activado,
el valor "Control manual de variable manipulada" se aplica como variable manipu‚Äê
lada.
Se admiten valores entre -100 y 100 %.

SP_OP_ON

140.0

BOOL

FAL‚Äê
SE

El cuadro de di√°logo "Puesta en servicio" tiene acceso al par√°metro de entrada/
salida "Activar control manual de consigna" Si el bit est√° activado, el valor SP_OP
se aplica como consigna.

LMNOP_ON 140.1

BOOL

FAL‚Äê
SE

El cuadro de di√°logo "Puesta en servicio" tiene acceso al par√°metro de entrada/
salida "Activar control manual de la variable manipulada" Si el bit est√° activado, el
valor LMN_OP se aplica como variable manipulada.

LOAD_PAR

140.2

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida "Cargar par√°metros de regulaci√≥n en el FM 455"
est√° activado, los par√°metros de regulaci√≥n se cargan en el m√≥dulo y el par√°metro
de entrada/salida se desactiva.

LOAD_OP

140.3

BOOL

FAL‚Äê
SE

Si el par√°metro de entrada/salida "Cargar par√°metros operativos en el FM 455"
est√° activado, los par√°metros operativos se cargan en el m√≥dulo y el par√°metro de
entrada/salida se desactiva.

1)

1)

Nota
La EEPROM del m√≥dulo podr√≠a quedar destruida por un n√∫mero excesivo de procesos de
escritura. Para evitarlo, tras la escritura de la EEPROM el m√≥dulo retrasa una nueva escritura
30 minutos.

4.2.4.4

Funciones 300C

ANALOG: Posicionar con salida anal√≥gica
Descripci√≥n
Utilice la instrucci√≥n "ANALOG" para controlar las funciones de posicionamiento desde el
programa de usuario.

6792

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Una salida anal√≥gica con asignaci√≥n fija controla la etapa de potencia con una tensi√≥n (se√±al
de tensi√≥n) entre ¬±10 V o una intensidad (se√±al de intensidad) de ¬±20 mA.
‚óè Una vez concluida la fase de aceleraci√≥n (RAM_UP) se efect√∫a primero una aproximaci√≥n
al destino a la velocidad (Vnom).
‚óè En el punto de deceleraci√≥n calculado por la CPU se inicia la deceleraci√≥n (RAMP_DN)
hasta el punto de cambio de velocidad.
‚óè Al alcanzarse el punto de cambio de velocidad, se sigue avanzando a velocidad lenta
(Vlenta).
‚óè En el punto de desconexi√≥n se desconecta el accionamiento.
‚óè El punto de cambio de velocidad y el punto de desconexi√≥n se establecen para cada
destino que debe alcanzarse mediante los valores especificados en los par√°metros
(distancia de cambio de velocidad y distancia de desconexi√≥n). Es posible definir valores
distintos para la distancia de cambio de velocidad y la distancia de desconexi√≥n seg√∫n si el
sentido de desplazamiento es hacia delante (positivo) o hacia atr√°s (negativo).
‚óè El desplazamiento finaliza (WORKING = FALSE) cuando se alcanza el punto de
desconexi√≥n. A partir de este momento puede iniciarse otro desplazamiento.
‚óè El destino especificado se alcanza (POS_RCD = TRUE) cuando el valor real de posici√≥n
alcanza la zona de destino. Si el valor real de posici√≥n abandona la zona de destino sin que
se inicie otro desplazamiento, la se√±al "Posici√≥n alcanzada" no se desactiva.
Si la distancia de cambio de velocidad es menor que la distancia de desconexi√≥n, a partir del
punto de deceleraci√≥n se desacelera linealmente hasta la consigna de velocidad 0.

Par√°metros b√°sicos
Aqu√≠ se describen los par√°metros de la instrucci√≥n que son id√©nticos para todos los modos de
operaci√≥n. Los par√°metros espec√≠ficos de cada modo de operaci√≥n se describen en los
distintos modos de operaci√≥n.
Encontrar√° m√°s informaci√≥n sobre los tipos de datos v√°lidos en "Vista general de los tipos de
datos v√°lidos (P√°gina 241)".

Par√°metros
La tabla siguiente muestra los par√°metros de la instrucci√≥n "ANALOG":
Par√°metro

Declaraci√≥n Tipo de
datos

Direcci√≥n
Rango de valores Ajuste predeter‚Äê
(DB de ins‚Äê
minado
tancia)

Descripci√≥n

LADDR

Input

0

Direcci√≥n E/S del subm√≥dulo
que se ha definido en la con‚Äê
figuraci√≥n hardware.

WORD

seg√∫n CPU

W#16#0310

Si las direcciones E y S son
diferentes, debe indicarse la
menor de las dos direcciones.
CHANNEL

Input

INT

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

2

0

0

N√∫mero de canal

6793

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n Tipo de
datos

Direcci√≥n
Rango de valores Ajuste predeter‚Äê
(DB de ins‚Äê
minado
tancia)

Descripci√≥n

STOP

Input

4.4

Detener desplazamiento

BOOL

TRUE/FALSE

FALSE

Si STOP = TRUE es posible
finalizar/interrumpir el despla‚Äê
zamiento anticipadamente.
ERR_A

Input

BOOL

4.5

TRUE/FALSE

FALSE

Acuse de grupo error externo
Con ERR_A = TRUE se acu‚Äê
san errores externos.

SPEED

Input

DINT

12

Velocidad lenta
hasta
1 000 000 impul‚Äê
sos/s

1000

El eje se acelera hasta la ve‚Äê
locidad "Vnom".
No es posible modificar la ve‚Äê
locidad durante el desplaza‚Äê
miento.

Como m√°ximo
hasta la veloci‚Äê
dad m√°xima para‚Äê
metrizada
WORKING

Output

BOOL

16.0

TRUE/FALSE

FALSE

Desplazamiento en curso

ACT_POS

Output

DINT

18

de -5x10 a
+5x108 impulsos

0

Valor real de posici√≥n actual

MODE_OUT

Output

INT

22

0, 1, 3, 4, 5

0

Modo de operaci√≥n activo/
ajustado

ERR

Output

WORD

24

Cada bit

0

Error externo:

8

0√≥1

Bit 2: vigilancia de marca cero
Bit 11: vigilancia de la zona
de desplazamiento (siempre
1)
Bit 12: vigilancia de la zona
de trabajo
Bit 13: vigilancia del valor real
Bit 14: vigilancia de aproxima‚Äê
ci√≥n a destino
Bit 15: vigilancia de la zona
de destino
Bits restantes reservados

6794

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n Tipo de
datos

Direcci√≥n
Rango de valores Ajuste predeter‚Äê
(DB de ins‚Äê
minado
tancia)

Descripci√≥n

ST_ENBLD

Output

26.0

La CPU activa la habilitaci√≥n
de inicio cuando se cumplen
todas las condiciones si‚Äê
guientes:

BOOL

TRUE/FALSE

TRUE

‚óè STOP no est√° presente
(STOP = FALSE)
‚óè No hay ning√∫n error
externo (ERR = 0)
‚óè La habilitaci√≥n del
accionamiento est√°
activada (DRV_EN =
TRUE)
‚óè No hay ning√∫n
posicionamiento activo
(WORKING = FALSE)
ERROR

Output

BOOL

26.1

TRUE/FALSE

FALSE

Error al iniciar/continuar un
desplazamiento

STATUS

Output

WORD

28.0

W#16#0000 a
W#16#FFFF

W#16#0000

N√∫mero de error

Par√°metros no interconectados en el bloque (datos locales est√°ticos):
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
Rango de valo‚Äê
ci√≥n (DB res
de instan‚Äê
cia)

Ajuste prede‚Äê
terminado

Descripci√≥n

ACCEL

STATIC

DINT

30

de 1 a 100 000
impulsos/s2

100

Aceleraci√≥n

de 1 a 100 000
impulsos/s2

100

de 0 a +108 im‚Äê
pulsos

1000

DECEL

CHGDIFF_P

STATIC

STATIC

DINT

DINT

34

38

No se puede modificar durante
el desplazamiento.
Deceleraci√≥n
No se puede modificar durante
el desplazamiento.
Distancia de cambio de veloci‚Äê
dad positiva:
La "distancia de cambio de ve‚Äê
locidad positiva" define el punto
de cambio de velocidad a partir
del cual el accionamiento avan‚Äê
za a marcha lenta.

CUTOFFDIFF_P

STATIC

DINT

42

de 0 a +108 im‚Äê
pulsos

100

Distancia de desconexi√≥n posi‚Äê
tiva:
La "distancia de desconexi√≥n
positiva" define el punto de des‚Äê
conexi√≥n a partir del cual el ac‚Äê
cionamiento desconecta la mar‚Äê
cha lenta al avanzar.

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6795

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
Rango de valo‚Äê
ci√≥n (DB res
de instan‚Äê
cia)

Ajuste prede‚Äê
terminado

Descripci√≥n

CHGDIFF_M

STATIC

DINT

46

1000

Distancia de cambio de veloci‚Äê
dad negativa:

de 0 a +108 im‚Äê
pulsos

La "distancia de conmutaci√≥n
negativa" define el punto de
cambio de velocidad a partir del
cual el accionamiento retrocede
a marcha lenta.
CUTOFFDIFF_M

STATIC

DINT

50

de 0 a +108 im‚Äê
pulsos

100

Distancia de desconexi√≥n nega‚Äê
tiva:
La "distancia de desconexi√≥n
negativa" define el punto a partir
del cual el accionamiento des‚Äê
conecta la marcha lenta al retro‚Äê
ceder.

PARA

STATIC

BOOL

54.0

TRUE/FALSE

FALSE

Eje parametrizado

DIR

STATIC

BOOL

54.1

TRUE/FALSE

FALSE

Sentido actual/√∫ltimo del movi‚Äê
miento
FALSE = adelante (sentido po‚Äê
sitivo)
TRUE = atr√°s (sentido negativo)

CUTOFF

STATIC

BOOL

54.2

TRUE/FALSE

FALSE

Accionamiento en la zona de
desconexi√≥n (desde el punto de
desconexi√≥n hasta iniciar el si‚Äê
guiente desplazamiento)

CHGOVER

STATIC

BOOL

54.3

TRUE/FALSE

FALSE

Accionamiento en la zona de
cambio de velocidad (desde
que se alcanza la velocidad len‚Äê
ta hasta que inicia el siguiente
desplazamiento)

RAMP_DN

STATIC

BOOL

54.4

TRUE/FALSE

FALSE

El accionamiento se desacelera
(desde el punto de deceleraci√≥n
hasta el punto de cambio de ve‚Äê
locidad)

RAMP_UP

STATIC

BOOL

54.5

TRUE/FALSE

FALSE

El accionamiento se acelera
(desde el inicio hasta que se al‚Äê
canza la velocidad SPEED
(Vnom))

6796

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
Rango de valo‚Äê
ci√≥n (DB res
de instan‚Äê
cia)

Ajuste prede‚Äê
terminado

Descripci√≥n

DIST_TO_

STATIC

DINT

56

de -5x108 a
+5x108 impulsos

0

Trayecto residual actual

STATIC

DINT

60

de -5x108 a
+5x108 impulsos

0

Destino √∫ltimo/actual

GO
LAST_TRG

‚óè Modo incremental absoluto:
al iniciar el desplazamiento,
LST_TRG = destino
absoluto actual (TARGET).
‚óè Modo incremental relativo:
al iniciar el desplazamiento,
LST_TRG = LAST_TRG del
desplazamiento anterior +/el recorrido indicado
(TARGET).

Par√°metros del modo de operaci√≥n "Jog"
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
ci√≥n (DB
de ins‚Äê
tancia)

Rango de valores Ajuste prede‚Äê
terminado

Descripci√≥n

DRV_EN

Input

BOOL

4.0

TRUE/FALSE

FALSE

Habilitaci√≥n del accionamiento

DIR_P

Input

BOOL

4.2

TRUE/FALSE

FALSE

Jog en sentido positivo (flanco
ascendente)

DIR_M

Input

BOOL

4.3

TRUE/FALSE

FALSE

Jog en sentido negativo (flanco
ascendente)

MODE_IN

Input

INT

6

0, 1, 3, 4, 5

1

Modo de operaci√≥n, 1 = Jog

WORKING

Output

BOOL

16.0

TRUE/FALSE

FALSE

Desplazamiento en curso

ACT_POS

Output

DINT

18

de -5x108 a
+5x108 impulsos

0

Valor real de posici√≥n actual

MODE_OUT

Output

INT

22

0, 1, 3, 4, 5

0

Modo de operaci√≥n activo/ajus‚Äê
tado

Par√°metros del modo de operaci√≥n "B√∫squeda del punto de referencia"
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
Rango de valo‚Äê
ci√≥n (DB res
de instan‚Äê
cia)

Ajuste prede‚Äê
terminado

Descripci√≥n

DRV_EN

Input

BOOL

4.0

TRUE/FALSE

FALSE

Habilitaci√≥n del accionamiento

DIR_P

Input

BOOL

4.2

TRUE/FALSE

FALSE

B√∫squeda del punto de referen‚Äê
cia en sentido positivo (flanco
ascendente)

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

6797

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
Rango de valo‚Äê
ci√≥n (DB res
de instan‚Äê
cia)

Ajuste prede‚Äê
terminado

Descripci√≥n

DIR_M

Input

BOOL

4.3

TRUE/FALSE

FALSE

B√∫squeda del punto de referen‚Äê
cia en sentido negativo (flanco
ascendente)

MODE_IN

Input

INT

6

0, 1, 3, 4, 5

1

Modo de operaci√≥n, 3 = "B√∫s‚Äê
queda del punto de referencia"

WORKING

Output

BOOL

16.0

TRUE/FALSE

FALSE

Desplazamiento en curso

SYNC

Output

BOOL

16.3

TRUE/FALSE

FALSE

SYNC = TRUE: el eje est√° sin‚Äê
cronizado

ACT_POS

Output

DINT

18

de -5x108 a
+5x108 impulsos

0

Valor real de posici√≥n actual

MODE_OUT

Output

INT

22

0, 1, 3, 4, 5

0

Modo de operaci√≥n activo/ajus‚Äê
tado

Par√°metros del modo de operaci√≥n "Modo incremental relativo"
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
ci√≥n (DB
de ins‚Äê
tancia)

Rango de valores Ajuste prede‚Äê
terminado

Descripci√≥n

DRV_EN

Input

BOOL

4.0

TRUE/FALSE

FALSE

Habilitaci√≥n del accionamiento

DIR_P

Input

BOOL

4.2

TRUE/FALSE

FALSE

Desplazamiento en sentido po‚Äê
sitivo (flanco ascendente)

DIR_M

Input

BOOL

4.3

TRUE/FALSE

FALSE

Desplazamiento en sentido ne‚Äê
gativo (flanco ascendente)

MODE_IN

Input

INT

6

0, 1, 3, 4, 5

1

Modo de operaci√≥n, 4 = Modo
incremental relativo

TARGET

Input

DINT

8

de 0 a 109 impul‚Äê
sos

1000

Recorrido en impulsos (s√≥lo se
admiten valores positivos)

WORKING

Output

BOOL

16.0

TRUE/FALSE

FALSE

Desplazamiento en curso

POS_RCD

Output

BOOL

16.1

TRUE/FALSE

FALSE

Posici√≥n alcanzada

ACT_POS

Output

DINT

18

de -5x10 a
+5x108 impulsos

0

Valor real de posici√≥n actual

MODE_OUT

Output

INT

22

0, 1, 3, 4, 5

0

Modo de operaci√≥n activo/ajus‚Äê
tado

8

Par√°metros del modo de operaci√≥n "Modo incremental absoluto"
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
Rango de valo‚Äê
ci√≥n (DB res
de instan‚Äê
cia)

Ajuste prede‚Äê
terminado

Descripci√≥n

DRV_EN

Input

BOOL

4.0

TRUE/FALSE

FALSE

Habilitaci√≥n del accionamiento

START

Input

BOOL

4.1

TRUE/FALSE

FALSE

Iniciar desplazamiento (flanco
ascendente)

6798

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
Rango de valo‚Äê
ci√≥n (DB res
de instan‚Äê
cia)

Ajuste prede‚Äê
terminado

Descripci√≥n

DIR_P

Input

BOOL

4.2

TRUE/FALSE

FALSE

Desplazamiento en sentido po‚Äê
sitivo (flanco ascendente)

DIR_M

Input

BOOL

4.3

TRUE/FALSE

FALSE

Desplazamiento en sentido ne‚Äê
gativo (flanco ascendente)

MODE_IN

Input

INT

6

0, 1, 3, 4, 5

1

Modo de operaci√≥n, 5 = Modo
incremental absoluto

TARGET

Input

DINT

8

Eje lineal:

1000

Destino en impulsos

de -5x108 a
+5x108
Eje rotativo:
de 0 a fin de eje
rotativo -1
WORKING

Output

BOOL

16.0

TRUE/FALSE

FALSE

Desplazamiento en curso

POS_RCD

Output

BOOL

16.1

TRUE/FALSE

FALSE

Posici√≥n alcanzada

ACT_POS

Output

DINT

18

de -5x108 a
0
+5x108 impulsos

Valor real de posici√≥n actual

MODE_OUT

Output

INT

22

0, 1, 3, 4, 5

0

Modo de operaci√≥n activo/ajus‚Äê
tado

Par√°metros de la petici√≥n "Posicionar el punto de referencia"
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
Rango de valo‚Äê
ci√≥n (DB res
de instan‚Äê
cia)

Ajuste prede‚Äê
terminado

Descripci√≥n

SYNC

Output

BOOL

16.3

FALSE

El eje est√° sincronizado

TRUE/FALSE

Par√°metros no interconectados en el bloque (datos locales est√°ticos):
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
ci√≥n (DB
de ins‚Äê
tancia)

Rango de valo‚Äê
res

Ajuste prede‚Äê
terminado

Descripci√≥n

JOB_REQ

STATIC

BOOL

76.0

TRUE/FALSE

FALSE

Lanzamiento de petici√≥n (flanco
ascendente)

JOB_DONE

STATIC

BOOL

76.1

TRUE/FALSE

TRUE

La nueva petici√≥n puede iniciarse

JOB_ERR

STATIC

BOOL

76.2

TRUE/FALSE

FALSE

Petici√≥n err√≥nea

JOB_ID

STATIC

INT

78

1, 2

0

Petici√≥n, 1 = "Posicionar el punto
de referencia"

JOB_STAT

STATIC

WORD

80

W#16#0000 a
W#16#FFFF

W#16#0000

N√∫mero de error de petici√≥n

JOB_VAL

STATIC

DINT

82

de 5x108 a
0
+5x108 impulsos

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Par√°metros de la petici√≥n Coorde‚Äê
nada del punto de referencia

6799

Instrucciones
4.2 Instrucciones

Par√°metros de la petici√≥n "Borrar trayecto residual"
Par√°metros no interconectados en el bloque (datos locales est√°ticos):
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
Rango de valo‚Äê
ci√≥n (DB res
de instan‚Äê
cia)

Ajuste prede‚Äê
terminado

Descripci√≥n

JOB_REQ

STATIC

BOOL

76.0

TRUE/FALSE

FALSE

Lanzamiento de petici√≥n (flanco
ascendente)

JOB_DONE

STATIC

BOOL

76.1

TRUE/FALSE

TRUE

La nueva petici√≥n puede iniciar‚Äê
se

JOB_ERR

STATIC

BOOL

76.2

TRUE/FALSE

FALSE

Petici√≥n err√≥nea

JOB_ID

STATIC

INT

78

1, 2

0

Petici√≥n, 2 = "Borrar trayecto re‚Äê
sidual"

JOB_STAT

STATIC

WORD

80

W#16#0000 a
W#16#FFFF

W#16#0000

N√∫mero de error de petici√≥n

JOB_VAL

STATIC

DINT

82

-

0

Ajuste cualquiera

Par√°metros de la funci√≥n "Medici√≥n de longitud"
La funci√≥n se inicia mediante un flanco en la entrada digital. No hay par√°metros espec√≠ficos de
entrada.
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
ci√≥n (DB
de ins‚Äê
tancia)

Rango de valores Ajuste prede‚Äê
terminado

Descripci√≥n

MSR_DONE

OUT

BOOL

16.2

TRUE/FALSE

Medici√≥n de longitud finalizada

FALSE

Par√°metros no interconectados en el bloque (datos locales est√°ticos):
Par√°metro

Declaraci√≥n

Tipo de
datos

Direc‚Äê
ci√≥n (DB
de ins‚Äê
tancia)

Rango de valores Ajuste prede‚Äê
terminado

Descripci√≥n

BEG_VAL

STATIC

DINT

64

de -5x108 a
+5x108 impulsos

0

Valor real de posici√≥n para inicio
de medici√≥n de longitud

END_VAL

STATIC

DINT

68

de -5x108 a
+5x108 impulsos

0

Valor real de posici√≥n para fin de
medici√≥n de longitud

LEN_VAL

STATIC

DINT

72

de 0 a 109 impul‚Äê
sos

0

Longitud medida

Par√°metros ERROR y STATUS
Error del modo de operaci√≥n (ERROR = TRUE)

6800

Programaci√≥n del PLC
Manual de programaci√≥n y manejo, 11/2019

Instrucciones
4.2 Instrucciones
Si se detecta un error, el par√°metro de salida ERROR se pone a TRUE. En el par√°metro
STATUS se indica la causa del error.
Clase de even‚Äê Explicaci√≥n
to c√≥digo de
error
W#16#2002

Instrucci√≥n err√≥nea, utilizar la instrucci√≥n "ANALOG"

W#16#2004

N√∫mero de canal err√≥neo (CHANNEL). Ajuste el n√∫mero de canal "0".

W#16#3001

Petici√≥n de desplazamiento no aceptada por tarea err√≥nea en la misma llamada.
Corrija los par√°metros del JOB correspondiente.

W#16#3002

No est√° permitido modificar Output _IN mientras el accionamiento est√° en marcha.
Espere hasta que el posicionamiento haya terminado.

W#16#3003

Modo de operaci√≥n desconocido (MODE_IN). Se admiten 1(Jog), 3 (B√∫squeda del
punto de referencia), 4 (Modo incremental relativo) y 5 (Modo incremental absoluto).

W#16#3004

No debe haber m√°s de una solicitud de inicio activada al mismo tiempo. Las solicitu‚Äê
des de inicio permitidas son DIR_P o DIR_M o START.

W#16#3005

START s√≥lo est√° permitido en el modo de operaci√≥n "Modo incremental absoluto".
Inicie el desplazamiento con DIR_P o DIR_M.

W#16#3006

DIR_P o DIR_M no est√° permitido en un eje lineal con el modo de operaci√≥n "Modo
incremental absoluto". Inicie el desplazamiento con START.

W#16#3007

El eje no est√° sincronizado. "Modo incremental absoluto" s√≥lo es posible con el eje
sincronizado.

W#16#3008

Abandonar la zona de trabajo. El desplazamiento retrocediendo a la zona de trabajo
s√≥lo est√° permitido en modo "Jog".

W#16#3101

No hay habilitaci√≥n de inicio, puesto que el eje no est√° parametrizado. Parametrice el
subm√≥dulo "Posicionar" en HW Config.

W#16#3102

No hay habilitaci√≥n de inicio, puesto que la habilitaci√≥n del accionamiento no est√°
activada. Active la "habilitaci√≥n del accionamiento" en la instrucci√≥n
(DRV_EN=TRUE).

W#16#3103

No hay habilitaci√≥n de inicio, puesto que STOP est√° activado. Borre STOP en la
instrucci√≥n (STOP=FALSE)

W#16#3104

No hay habilitaci√≥n de inicio, puesto que el eje se est√° posicionando (WOR‚Äê
KING=TRUE). Espere hasta que el posicionamiento haya terminado.

W#16#3105

No hay habilitaci√≥n de inicio, puesto que todav√≠a hay por lo menos un error externo no
acusado. Elimine y acuse primero todos los errores externos y reinicie despu√©s el
desplazamiento.

W#16#3202

Ajuste predeterminado de velocidad SPEED err